* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35******************************************************************
    36
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page   3
* EL130.cbl
    38 ENVIRONMENT DIVISION.
    39 DATA DIVISION.
    40 WORKING-STORAGE SECTION.
    41 01  DFH-START PIC X(04).
    42 77  FILLER  PIC X(32)  VALUE '********************************'.
    43 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    44 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    45
    46*    COPY ELCSCTM.
    47******************************************************************
    48*                                                                *
    49*                                                                *
    50*                            ELCSCTM                             *
    51*                            VMOD=2.001                          *
    52*                                                                *
    53*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    54*                                                                *
    55******************************************************************
    56 01  SECURITY-MESSAGE.
    57     12  FILLER                          PIC X(30)
    58            VALUE '** LOGIC SECURITY VIOLATION -'.
    59     12  SM-READ                         PIC X(6).
    60     12  FILLER                          PIC X(5)
    61            VALUE ' PGM='.
    62     12  SM-PGM                          PIC X(6).
    63     12  FILLER                          PIC X(5)
    64            VALUE ' OPR='.
    65     12  SM-PROCESSOR-ID                 PIC X(4).
    66     12  FILLER                          PIC X(6)
    67            VALUE ' TERM='.
    68     12  SM-TERMID                       PIC X(4).
    69     12  FILLER                          PIC XX   VALUE SPACE.
    70     12  SM-JUL-DATE                     PIC 9(5).
    71     12  FILLER                          PIC X    VALUE SPACE.
    72     12  SM-TIME                         PIC 99.99.
    73
    74
    75*    COPY ELCSCRTY.
    76******************************************************************
    77*                                                                *
    78*                                                                *
    79*                            ELCSCRTY                            *
    80*                            VMOD=2.001                          *
    81*                                                                *
    82*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    83*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    84*        SAVED IN PI-SECURITY-ADDRESS.                           *
    85*                                                                *
    86******************************************************************
    87 01  SECURITY-CONTROL.
    88     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    89     12  FILLER                       PIC XX    VALUE 'SC'.
    90     12  SC-CREDIT-CODES.
    91         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    92             20  SC-CREDIT-DISPLAY    PIC X.
    93             20  SC-CREDIT-UPDATE     PIC X.
    94     12  SC-CLAIMS-CODES.
    95         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page   4
* EL130.cbl
    96             20  SC-CLAIMS-DISPLAY    PIC X.
    97             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page   5
* EL130.cbl
    99 01  WS-DATE-AREA.
   100     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   101     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   102     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   103
   104 01  WS-CRI-SSN-WORK-AREA.
   105     05  WS-CRI-SOC-SEC-NO.
   106         10  WS-SS-REPT-CD       PIC X(5).
   107         10  WS-SS-LAST-NAME     PIC X(5).
   108         10  WS-SS-INITIAL       PIC X.
   109
   110     05  WS-CRI-REPORT-CODE.
   111         10  FILLER              PIC X(5).
   112         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   113
   114     05  WS-CRI-LAST-NAME.
   115         10  WS-CRI-NAME-MOVE    PIC X(5).
   116         10  FILLER              PIC X(10).
   117
   118 01  STANDARD-AREAS.
   119     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   120     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   121     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   122     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   123     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   124     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   125     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   126     12  PGM-NAME            PIC X(8).
   127     12  TIME-IN             PIC S9(7).
   128     12  TIME-OUT-R  REDEFINES TIME-IN.
   129         16  FILLER          PIC X.
   130         16  TIME-OUT        PIC 99V99.
   131         16  FILLER          PIC X(2).
   132     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   133     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   134     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   135     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   136     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   137     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   138     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   139     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   140     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   141     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   142     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   143     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   144     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   145     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   146     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   147     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   148     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   149     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   150     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   151     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   152     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   153     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
   154     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   155     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   156     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page   6
* EL130.cbl
   157     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   158     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   159     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   160     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   161     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   162     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   163     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   164     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   165     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   166     12  FILE-ID             PIC X(8).
   167     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   168     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   169     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   170     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   171     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   172     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   173     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   174     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   175     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +550.
   176
   177 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   178     12  M                   PIC S9(7)V99           VALUE ZEROS.
   179     12  L                   PIC S9(7)V99           VALUE ZEROS.
   180     12  N                   PIC S9(3)              VALUE ZEROS.
   181     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   182     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   183     12  I                   PIC S99V9(5)           VALUE ZEROS.
   184     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   185     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   186     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   187     12  R                   PIC S9(3)              VALUE ZEROS.
   188     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   189     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   190     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   191     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   192     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   193     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   194     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   195     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   196     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   197
   198 01  TERM-CALC-WORK-AREA.
   199     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   200     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   201     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   202     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   203     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   204     12  V-EXPONENTS.
   205        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   206     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   207
   208 01  MISC-WORK-AREAS.
   209     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   210     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   211     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
   212     12  QID.
   213         16  QID-TERM        PIC X(4).
   214         16  FILLER          PIC X(4)    VALUE '130A'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page   7
* EL130.cbl
   215     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   216     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   217     12  WS-GROUP-NO.
   218         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   219         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   220
   221     12  WS-RESPONSE         PIC S9(8)   COMP.
   222         88  WS-RESP-NORMAL              VALUE +00.
   223         88  WS-RESP-ERROR               VALUE +01.
   224         88  WS-RESP-NOTFND              VALUE +13.
   225
   226***************************************************************
   227*                                                             *
   228*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   229*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   230*    CHANGES WITH IN MAP EL130A.                              *
   231*                                                             *
   232***************************************************************
   233
   234     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   235     12  WS-SAVE-CLAIM-MASTER.
   236         16  FILLER                    PIC XX.
   237         16  WS-SAVE-CLAIM-KEY.
   238             20  WS-SAVE-COMPANY-CD    PIC X.
   239             20  WS-SAVE-CARRIER       PIC X.
   240             20  WS-SAVE-CLAIM-NO      PIC X(7).
   241             20  WS-SAVE-CERT-NO       PIC X(11).
   242         16  FILLER                    PIC X(328).
   243     12  SAVE-CURRENT-DATE         PIC XX.
   244     12  SAVE-CONTROL              PIC X(39).
   245     12  SAVE-ERACCT-KEY           PIC X(26).
   246     12  SAVE-COUNTER              PIC S9(8)   COMP.
   247     12  SAVE-METHOD               PIC X.
   248     12  SAVE-COMPANY-ID           PIC XXX.
   249     12  SAVE-COMPANY-CD           PIC X.
   250     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   251     12  SAVE-CREDIT-USER          PIC X.
   252     12  SAVE-CLAIM-USER           PIC X.
   253     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   254     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   255     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   256     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   257     12  SAVE-AH-OVERRIDE-L1       PIC X.
   258     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   259     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   260     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   261     12  FILLER                    PIC X.
   262*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   263     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   264     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   265     12  SAVE-EL127-TO-EL130-CNTRL.
   266         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
   267         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   268         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   269             20  SAVE-EL127-CARRIER  PIC X.
   270             20  SAVE-EL127-GROUPING PIC X(6).
   271             20  SAVE-EL127-STATE    PIC X(2).
   272             20  SAVE-EL127-ACCOUNT  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page   8
* EL130.cbl
   273             20  SAVE-EL127-CERT-NO  PIC X(11).
   274             20  SAVE-EL127-EFF-DT   PIC XX.
   275     12  SAVE-EL659-TO-EL130-CNTRL.
   276         16  SAVE-EL659-CARRIER    PIC X.
   277         16  SAVE-EL659-GROUPING   PIC X(6).
   278         16  SAVE-EL659-STATE      PIC XX.
   279         16  SAVE-EL659-ACCOUNT    PIC X(10).
   280     12  DIVIDE-QUOT               PIC 999.
   281     12  DIVIDE-REM                PIC 999.
   282     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   283     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   284     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   285     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   286     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   287     12  WS-RESERVE-CONTROLS       PIC X(9).
   288     12  WS-EXPENSE-CONTROLS       PIC X(7).
   289     12  WS-REIN-TABLE.
   290         16  WS-REIN-1             PIC X            VALUE SPACE.
   291         16  WS-REIN-2             PIC X            VALUE SPACE.
   292         16  WS-REIN-3             PIC X            VALUE SPACE.
   293     12  WS-BENE-CALC-METHOD       PIC X.
   294     12  WS-EARNINGS-CALC          PIC X.
   295     12  WS-LF-EARNINGS-CALC       PIC X.
   296         88 TEX-REG                VALUE '4'.
   297         88 NET-PAY                VALUE '5'.
   298     12  WS-AH-EARNINGS-CALC       PIC X.
   299     12  WS-SPECIAL-CALC-CD        PIC X(01).
   300     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   301     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   302     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   303     12  WS-CLAIM-NUMBER.
   304         16  WS-CN-PREFIX.
   305             20  WS-CN-PRF-A PIC X.
   306             20  WS-CN-PRF-B PIC X.
   307         16  WS-CN-NUMBER    PIC 9(5).
   308     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   309     12  WS-CLAIM-SEQU.
   310         16  FILLER          PIC X    VALUE '('.
   311         16  WS-CURRENT-SEQU PIC Z9.
   312         16  FILLER          PIC X(4) VALUE ' OF '.
   313         16  WS-OF-SEQU      PIC Z9.
   314         16  FILLER          PIC X    VALUE ')'.
   315     12  DATE-WORK.
   316       14  FILLER                PIC XX.
   317       14  DATE-MM               PIC XX.
   318       14  DATE-DD               PIC XX.
   319       14  DATE-YY               PIC XX.
   320     12  CURR-DATE REDEFINES DATE-WORK.
   321         16  CURR-MM.
   322           18  CURR-M1           PIC 9.
   323           18  CURR-M2           PIC 9.
   324         16  FILLER              PIC X(5).
   325         16  CURR-YEAR           PIC 9.
   326     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   327     12  SUB                     PIC 99.
   328     12  MY-DATE.
   329         16  MY-MM               PIC XX.
   330         16  FILLER              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page   9
* EL130.cbl
   331         16  MY-YY               PIC XX.
   332
   333     12  WS-EDIT-BEN-CODE        PIC XX.
   334         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   335                                          '90' THRU '99'.
   336
   337     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   338     12  WS-BEN-HOLD             PIC XX.
   339     12  WS-BEN-ALPHA-HOLD.
   340         15  WS-BEN-ALPHA-2      PIC XX.
   341         15  WS-BEN-ALPHA-1      PIC X.
   342     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   343     12  WS-REC-TYPE             PIC X.
   344     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   345     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   346     12  ARCH-NUMBER             PIC S9(8)   COMP.
   347     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   348         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   349         88  REIN-REC-FOUND                  VALUE 'Y'.
   350
   351     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   352     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   353
   354
   355 01  CSO-WORK-FIELDS.
   356     12  WS-BLANK            PIC X       VALUE ' '.
   357
   358     12  WS-MA-CONTROL-PRIMARY.
   359         16  WS-MA-COMPANY-CD        PIC  X.
   360         16  WS-MA-CARRIER           PIC  X.
   361         16  WS-MA-GROUPING          PIC  X(6).
   362         16  WS-MA-STATE             PIC  XX.
   363         16  WS-MA-ACCOUNT           PIC  X(10).
   364         16  WS-MA-CERT-EFF-DT       PIC  XX.
   365         16  WS-MA-CERT-NO.
   366             20  WS-MA-CERT-PRIME    PIC  X(10).
   367             20  WS-MA-CERT-SFX      PIC  X.
   368
   369     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   370     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   371     12  WS-SOC-SEC-NUMBER.
   372         16  WS-SOC-SEC-NO       PIC 9(9).
   373         16  WS-SOC-SEC-BLANK    PIC X(2).
   374     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   375         16  WS-SSN-1-3          PIC 9(3).
   376         16  WS-SSN-DASH1        PIC X(1).
   377         16  WS-SSN-4-5          PIC 9(2).
   378         16  WS-SSN-DASH2        PIC X(1).
   379         16  WS-SSN-6-9          PIC 9(4).
   380
   381     12  WS-DIAG-VIN-MSG.
   382         16  FILLER          PIC X(11)
   383             VALUE 'VIN NUMBER '.
   384         16  WS-DIAG-VIN     PIC X(17).
   385
   386     12  WS-VERIFY-NOTE      PIC X(34)
   387         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   388
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  10
* EL130.cbl
   389 01  MAP-DATE-AREAS.
   390     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   391     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   392     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   393     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   394     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   395     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   396     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   397     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   398     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   399     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   400     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   401     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   402     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   403     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   404     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   405     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   406     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   407     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   408     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   409         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   410     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   411     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   412     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   413     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   414
   415 01  ACCESS-KEYS.
   416     12  ELACTQ-KEY.
   417         16  ELACTQ-COMPANY-CD       PIC X.
   418         16  ELACTQ-CARRIER          PIC X.
   419         16  ELACTQ-CLAIM-NO         PIC X(7).
   420         16  ELACTQ-CERT-NO          PIC X(11).
   421     12  ELMSTR-KEY.
   422         16  MSTR-COMP-CD            PIC X.
   423         16  MSTR-CARRIER            PIC X.
   424         16  MSTR-CLAIM-NO           PIC X(7).
   425         16  MSTR-CERT-NO.
   426             20  MSTR-CERT-NO-PRIME  PIC X(10).
   427             20  MSTR-CERT-NO-SUFX   PIC X.
   428     12  SAVE-ELMSTR-KEY.
   429         16  SAVE-COMP-CD            PIC X.
   430         16  SAVE-CARRIER            PIC X.
   431         16  SAVE-CLAIM-NO           PIC X(7).
   432         16  SAVE-CERT-NO.
   433             20  SAVE-CERT-NO-PRIME  PIC X(10).
   434             20  SAVE-CERT-NO-SUFX   PIC X.
   435     12  ELMSTR5-KEY.
   436         16  MSTR5-COMP-CD           PIC X.
   437         16  MSTR5-CERT-NO.
   438             20  MSTR5-CERT-NO-PRIME PIC X(10).
   439             20  MSTR5-CERT-NO-SUFX  PIC X.
   440     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   441         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   442         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   443         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   444     12  ELCNTL-KEY.
   445         16  CNTL-COMP-ID    PIC X(3).
   446         16  CNTL-REC-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  11
* EL130.cbl
   447         16  CNTL-ACCESS.
   448             20  FILLER      PIC XX.
   449             20  CNTL-BENEFIT.
   450                 24  FILLER  PIC X.
   451                 24  CNTL-CARRIER PIC X.
   452         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   453     12  ELCERT-KEY.
   454         16  CERT-COMP-CD    PIC X.
   455         16  CERT-CARRIER    PIC X.
   456         16  CERT-GROUPING   PIC X(6).
   457         16  CERT-STATE      PIC X(2).
   458         16  CERT-ACCOUNT.
   459             20  CERT-ACCOUNT-PREFIX PIC X(4).
   460             20  CERT-ACCOUNT-PRIME  PIC X(6).
   461         16  CERT-EFF-DT     PIC XX.
   462         16  CERT-CERT-NO.
   463             20  CERT-CERT-NO-PRIME  PIC X(10).
   464             20  CERT-CERT-NO-SUFX   PIC X.
   465     12  ELCERT-KEY-5.
   466         16  CERT-COMP-CD-5      PIC X.
   467         16  CERT-CERT-5.
   468             20  CERT-CERT-5-PRIME   PIC X(10).
   469             20  CERT-CERT-5-SUFX    PIC X.
   470     12  ERACCT-KEY.
   471         16  ACCT-COMP-CD    PIC X.
   472         16  ACCT-CARRIER    PIC X.
   473         16  ACCT-GROUPING   PIC X(6).
   474         16  ACCT-STATE      PIC X(2).
   475         16  ACCT-ACCOUNT    PIC X(10).
   476         16  ACCT-EXP-DT     PIC XX.
   477     12  ELTRLR-KEY.
   478         16  TRLR-COMP-CD    PIC X.
   479         16  TRLR-CARRIER    PIC X.
   480         16  TRLR-CLAIM-NO   PIC X(7).
   481         16  TRLR-CERT-NO.
   482             20  TRLR-CERT-NO-PRIME  PIC X(10).
   483             20  TRLR-CERT-NO-SUFX   PIC X.
   484         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   485         16  TRLR-TYPE       PIC X.
   486     12  ELBENE-KEY.
   487         16  BENE-COMP-CD    PIC X.
   488         16  BENE-RCD-TYPE   PIC X.
   489         16  BENE-CODE       PIC X(10).
   490     12  ERREIN-KEY.
   491         16  REIN-COMP-CD        PIC X(01).
   492         16  REIN-TYPE           PIC X(01).
   493         16  REIN-TABLE-CO.
   494             20  REIN-CODE-1     PIC X(01).
   495             20  REIN-CODE-2     PIC X(01).
   496             20  REIN-CODE-3     PIC X(01).
   497         16  FILLER              PIC X(03).
   498     12  ELCRTT-KEY.
   499         16  CTRLR-COMP-CD       PIC X.
   500         16  CTRLR-CARRIER       PIC X.
   501         16  CTRLR-GROUPING      PIC X(6).
   502         16  CTRLR-STATE         PIC X(2).
   503         16  CTRLR-ACCOUNT       PIC X(10).
   504         16  CTRLR-EFF-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  12
* EL130.cbl
   505         16  CTRLR-CERT-NO       PIC X(11).
   506         16  CTRLR-REC-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  13
* EL130.cbl
   508 01  ERROR-MESSAGES.
   509     12  ER-0000                 PIC X(4)  VALUE '0000'.
   510     12  ER-0004                 PIC X(4)  VALUE '0004'.
   511     12  ER-0019                 PIC X(4)  VALUE '0019'.
   512     12  ER-0023                 PIC X(4)  VALUE '0023'.
   513     12  ER-0029                 PIC X(4)  VALUE '0029'.
   514     12  ER-0033                 PIC X(4)  VALUE '0033'.
   515     12  ER-0068                 PIC X(4)  VALUE '0068'.
   516     12  ER-0070                 PIC X(4)  VALUE '0070'.
   517     12  ER-0194                 PIC X(4)  VALUE '0194'.
   518     12  ER-0202                 PIC X(4)  VALUE '0202'.
   519     12  ER-0203                 PIC X(4)  VALUE '0203'.
   520     12  ER-0204                 PIC X(4)  VALUE '0204'.
   521     12  ER-0205                 PIC X(4)  VALUE '0205'.
   522     12  ER-0206                 PIC X(4)  VALUE '0206'.
   523     12  ER-0207                 PIC X(4)  VALUE '0207'.
   524     12  ER-0213                 PIC X(4)  VALUE '0213'.
   525     12  ER-0214                 PIC X(4)  VALUE '0214'.
   526     12  ER-0217                 PIC X(4)  VALUE '0217'.
   527     12  ER-0219                 PIC X(4)  VALUE '0219'.
   528     12  ER-0220                 PIC X(4)  VALUE '0220'.
   529     12  ER-0221                 PIC X(4)  VALUE '0221'.
   530     12  ER-0222                 PIC X(4)  VALUE '0222'.
   531     12  ER-0223                 PIC X(4)  VALUE '0223'.
   532     12  ER-0224                 PIC X(4)  VALUE '0224'.
   533     12  ER-0225                 PIC X(4)  VALUE '0225'.
   534     12  ER-0226                 PIC X(4)  VALUE '0226'.
   535     12  ER-0227                 PIC X(4)  VALUE '0227'.
   536     12  ER-0229                 PIC X(4)  VALUE '0229'.
   537     12  ER-0230                 PIC X(4)  VALUE '0230'.
   538     12  ER-0231                 PIC X(4)  VALUE '0231'.
   539     12  ER-0232                 PIC X(4)  VALUE '0232'.
   540     12  ER-0233                 PIC X(4)  VALUE '0233'.
   541     12  ER-0234                 PIC X(4)  VALUE '0234'.
   542     12  ER-0235                 PIC X(4)  VALUE '0235'.
   543     12  ER-0236                 PIC X(4)  VALUE '0236'.
   544     12  ER-0237                 PIC X(4)  VALUE '0237'.
   545     12  ER-0238                 PIC X(4)  VALUE '0238'.
   546     12  ER-0239                 PIC X(4)  VALUE '0239'.
   547     12  ER-0240                 PIC X(4)  VALUE '0240'.
   548     12  ER-0241                 PIC X(4)  VALUE '0241'.
   549     12  ER-0243                 PIC X(4)  VALUE '0243'.
   550     12  ER-0244                 PIC X(4)  VALUE '0244'.
   551     12  ER-0245                 PIC X(4)  VALUE '0245'.
   552     12  ER-0246                 PIC X(4)  VALUE '0246'.
   553     12  ER-0247                 PIC X(4)  VALUE '0247'.
   554     12  ER-0248                 PIC X(4)  VALUE '0248'.
   555     12  ER-0250                 PIC X(4)  VALUE '0250'.
   556     12  ER-0251                 PIC X(4)  VALUE '0251'.
   557     12  ER-0252                 PIC X(4)  VALUE '0252'.
   558     12  ER-0253                 PIC X(4)  VALUE '0253'.
   559     12  ER-0254                 PIC X(4)  VALUE '0254'.
   560     12  ER-0257                 PIC X(4)  VALUE '0257'.
   561     12  ER-0258                 PIC X(4)  VALUE '0258'.
   562     12  ER-0260                 PIC X(4)  VALUE '0260'.
   563     12  ER-0261                 PIC X(4)  VALUE '0261'.
   564     12  ER-0263                 PIC X(4)  VALUE '0263'.
   565     12  ER-0264                 PIC X(4)  VALUE '0264'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  14
* EL130.cbl
   566     12  ER-0265                 PIC X(4)  VALUE '0265'.
   567     12  ER-0266                 PIC X(4)  VALUE '0266'.
   568     12  ER-0267                 PIC X(4)  VALUE '0267'.
   569     12  ER-0334                 PIC X(4)  VALUE '0334'.
   570     12  ER-0337                 PIC X(4)  VALUE '0337'.
   571     12  ER-0412                 PIC X(4)  VALUE '0412'.
   572     12  ER-0413                 PIC X(4)  VALUE '0413'.
   573     12  ER-0428                 PIC X(4)  VALUE '0428'.
   574     12  ER-0429                 PIC X(4)  VALUE '0429'.
   575     12  ER-0430                 PIC X(4)  VALUE '0430'.
   576     12  ER-0433                 PIC X(4)  VALUE '0433'.
   577     12  ER-0434                 PIC X(4)  VALUE '0434'.
   578     12  ER-0458                 PIC X(4)  VALUE '0458'.
   579     12  ER-0489                 PIC X(4)  VALUE '0489'.
   580     12  ER-0509                 PIC X(4)  VALUE '0509'.
   581     12  ER-0510                 PIC X(4)  VALUE '0510'.
   582     12  ER-0511                 PIC X(4)  VALUE '0511'.
   583     12  ER-0512                 PIC X(4)  VALUE '0512'.
   584     12  ER-0516                 PIC X(4)  VALUE '0516'.
   585     12  ER-0517                 PIC X(4)  VALUE '0517'.
   586     12  ER-0518                 PIC X(4)  VALUE '0518'.
   587     12  ER-0519                 PIC X(4)  VALUE '0519'.
   588     12  ER-0520                 PIC X(4)  VALUE '0520'.
   589     12  ER-0521                 PIC X(4)  VALUE '0521'.
   590     12  ER-0522                 PIC X(4)  VALUE '0522'.
   591     12  ER-0523                 PIC X(4)  VALUE '0523'.
   592     12  ER-0544                 PIC X(4)  VALUE '0544'.
   593     12  ER-0546                 PIC X(4)  VALUE '0546'.
   594     12  ER-0558                 PIC X(4)  VALUE '0558'.
   595     12  ER-0560                 PIC X(4)  VALUE '0560'.
   596     12  ER-0562                 PIC X(4)  VALUE '0562'.
   597     12  ER-0565                 PIC X(4)  VALUE '0565'.
   598     12  ER-0569                 PIC X(4)  VALUE '0569'.
   599     12  ER-0693                 PIC X(4)  VALUE '0693'.
   600     12  ER-0715                 PIC X(4)  VALUE '0715'.
   601     12  ER-0840                 PIC X(4)  VALUE '0840'.
   602     12  ER-0841                 PIC X(4)  VALUE '0841'.
   603     12  ER-0842                 PIC X(4)  VALUE '0842'.
   604     12  ER-0843                 PIC X(4)  VALUE '0843'.
   605     12  ER-0878                 PIC X(4)  VALUE '0878'.
   606     12  ER-0887                 PIC X(4)  VALUE '0887'.
   607     12  ER-2280                 PIC X(4)  VALUE '2280'.
   608     12  ER-2370                 PIC X(4)  VALUE '2370'.
   609     12  ER-2371                 PIC X(4)  VALUE '2371'.
   610     12  ER-2378                 PIC X(4)  VALUE '2378'.
   611     12  ER-2380                 PIC X(4)  VALUE '2380'.
   612     12  ER-2566                 PIC X(4)  VALUE '2566'.
   613     12  ER-2848                 PIC X(4)  VALUE '2848'.
   614     12  ER-3548                 PIC X(4)  VALUE '3548'.
   615     12  ER-7008                 PIC X(4)  VALUE '7008'.
   616     12  ER-7319                 PIC X(4)  VALUE '7319'.
   617     12  ER-7321                 PIC X(4)  VALUE '7321'.
   618     12  ER-7352                 PIC X(4)  VALUE '7352'.
   619     12  ER-7353                 PIC X(4)  VALUE '7353'.
   620     12  ER-7575                 PIC X(4)  VALUE '7575'.
   621     12  ER-7634                 PIC X(4)  VALUE '7634'.
   622     12  ER-7635                 PIC X(4)  VALUE '7635'.
   623     12  ER-7636                 PIC X(4)  VALUE '7636'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  15
* EL130.cbl
   624     12  ER-7637                 PIC X(4)  VALUE '7637'.
   625     12  ER-7638                 PIC X(4)  VALUE '7638'.
   626     12  ER-7639                 PIC X(4)  VALUE '7639'.
   627     12  ER-7640                 PIC X(4)  VALUE '7640'.
   628     12  ER-7641                 PIC X(4)  VALUE '7641'.
   629     12  ER-7642                 PIC X(4)  VALUE '7642'.
   630     12  ER-7643                 PIC X(4)  VALUE '7643'.
   631     12  ER-7646                 PIC X(4)  VALUE '7646'.
   632     12  ER-7647                 PIC X(4)  VALUE '7647'.
   633     12  ER-7648                 PIC X(4)  VALUE '7648'.
   634     12  ER-7649                 PIC X(4)  VALUE '7649'.
   635     12  ER-7651                 PIC X(4)  VALUE '7651'.
   636     12  ER-7670                 PIC X(4)  VALUE '7670'.
   637     12  ER-7671                 PIC X(4)  VALUE '7671'.
   638     12  ER-7686                 PIC X(4)  VALUE '7686'.
   639     12  ER-7688                 PIC X(4)  VALUE '7688'.
   640     12  ER-7689                 PIC X(4)  VALUE '7689'.
   641     12  ER-7691                 PIC X(4)  VALUE '7691'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  16
* EL130.cbl
   643*    COPY ELCLNKLT.
   644******************************************************************
   645*                                                                *
   646*                                                                *
   647*                           ELCLNKLT                             *
   648*                            VMOD=2.003                          *
   649*                                                                *
   650*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   651*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   652*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   653*                                                                *
   654*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   655*   COMPLETING THE REQUIRED FIELDS.                              *
   656*                                                                *
   657*   THE CALLING PROGRAM SHOULD CHECK:                            *
   658*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   659*                              9999 INDICATES AN UNKNOWN ABEND   *
   660*                                   WAS DETECTED.                *
   661*                              ALL OTHER VALUES ARE NORMAL ERROR *
   662*                              CODES FOUND IN THE ERROR FILE.    *
   663******************************************************************
   664 01  W-1523-LINKDATA.
   665     12  W-1523-COMMON-PI-DATA.
   666         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   667         16  FILLER              PIC  X(67).
   668         16  W-1523-COMPANY-CD   PIC  X(01).
   669         16  FILLER              PIC  X(10).
   670         16  W-1523-CONTROL-IN-PROGRESS.
   671             20  W-1523-CARRIER  PIC  X(01).
   672             20  W-1523-GROUPING PIC  X(06).
   673             20  W-1523-STATE    PIC  X(02).
   674             20  W-1523-ACCOUNT  PIC  X(10).
   675             20  W-1523-CLAIM-CERT-GRP.
   676                 24  W-1523-CLAIM-NO
   677                                 PIC  X(07).
   678                 24  W-1523-CERT-NO.
   679                     28  W-1523-CERT-PRIME
   680                                 PIC  X(10).
   681                     28  W-1523-CERT-SFX
   682                                 PIC  X(01).
   683                 24  W-1523-CERT-EFF-DT
   684                                 PIC  X(02).
   685         16  FILLER              PIC X(265).
   686
   687     12  W-1523-WORK-AREA.
   688         16  W-1523-FORM-NUMBER  PIC  X(04).
   689         16  W-1523-NUMBER-COPIES
   690                                 PIC  9(01).
   691         16  W-1523-ADDR-TYPE    PIC  X(02).
   692         16  W-1523-FOLLOW-UP-DATE
   693                                 PIC  X(02).
   694         16  W-1523-RESEND-DATE  PIC  X(02).
   695         16  W-1523-ERROR-CODE   PIC  9(04).
   696             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   697             88  W-1523-FATAL-ERROR
   698                                    VALUES  0006 0013 0042
   699                                            0154 0168 0169
   700                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  17
* EL130.cbl
   701                                            0179 0186 0281
   702                                            0332 2055 3697
   703                                            3698 3699 3770
   704                                            3771 3772 7675
   705                                            9106 9808 9883
   706                                            9887.
   707             88  W-1523-STOP-ERRORS
   708                                    VALUES  0013 0042 0154
   709                                            0168 0169 0172
   710                                            0281 0332 2055
   711                                            3698 3699 7675
   712                                            9106 9808 9883
   713                                            9999.
   714         16  W-1523-REASON       PIC  X(70).
   715         16  W-1523-ARCHIVE-NUMBER
   716                                 PIC  9(08).
   717     12  W-1523-POINTER-AREA.
   718         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   719         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   720         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   721         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   722         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  18
* EL130.cbl
   724*    COPY ELCINTF.
   725******************************************************************
   726*                                                                *
   727*                                                                *
   728*                            ELCINTF.                            *
   729*                            VMOD=2.017                          *
   730*                                                                *
   731*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   732*                                                                *
   733*       LENGTH = 1024                                            *
   734*                                                                *
   735******************************************************************
   736*                   C H A N G E   L O G
   737*
   738* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   739*-----------------------------------------------------------------
   740*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   741* EFFECTIVE    NUMBER
   742*-----------------------------------------------------------------
   743* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   744******************************************************************
   745 01  PROGRAM-INTERFACE-BLOCK.
   746     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   747     12  PI-CALLING-PROGRAM              PIC X(8).
   748     12  PI-SAVED-PROGRAM-1              PIC X(8).
   749     12  PI-SAVED-PROGRAM-2              PIC X(8).
   750     12  PI-SAVED-PROGRAM-3              PIC X(8).
   751     12  PI-SAVED-PROGRAM-4              PIC X(8).
   752     12  PI-SAVED-PROGRAM-5              PIC X(8).
   753     12  PI-SAVED-PROGRAM-6              PIC X(8).
   754     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   755     12  PI-COMPANY-ID                   PIC XXX.
   756     12  PI-COMPANY-CD                   PIC X.
   757
   758     12  PI-COMPANY-PASSWORD             PIC X(8).
   759
   760     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   761
   762     12  PI-CONTROL-IN-PROGRESS.
   763         16  PI-CARRIER                  PIC X.
   764         16  PI-GROUPING                 PIC X(6).
   765         16  PI-STATE                    PIC XX.
   766         16  PI-ACCOUNT                  PIC X(10).
   767         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   768                                         PIC X(10).
   769         16  PI-CLAIM-CERT-GRP.
   770             20  PI-CLAIM-NO             PIC X(7).
   771             20  PI-CERT-NO.
   772                 25  PI-CERT-PRIME       PIC X(10).
   773                 25  PI-CERT-SFX         PIC X.
   774             20  PI-CERT-EFF-DT          PIC XX.
   775         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   776             20  PI-PLAN-CODE            PIC X(2).
   777             20  PI-REVISION-NUMBER      PIC X(3).
   778             20  PI-PLAN-EFF-DT          PIC X(2).
   779             20  PI-PLAN-EXP-DT          PIC X(2).
   780             20  FILLER                  PIC X(11).
   781         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  19
* EL130.cbl
   782             20  PI-OE-REFERENCE-1.
   783                 25  PI-OE-REF-1-PRIME   PIC X(18).
   784                 25  PI-OE-REF-1-SUFF    PIC XX.
   785
   786     12  PI-SESSION-IN-PROGRESS          PIC X.
   787         88  CLAIM-SESSION                   VALUE '1'.
   788         88  CREDIT-SESSION                  VALUE '2'.
   789         88  WARRANTY-SESSION                VALUE '3'.
   790         88  MORTGAGE-SESSION                VALUE '4'.
   791         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   792
   793
   794*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   795
   796     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   797     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   798
   799     12  PI-CREDIT-USER                  PIC X.
   800         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   801         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   802
   803     12  PI-CLAIM-USER                   PIC X.
   804         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   805         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   806
   807     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   808         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   809         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   810         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   811         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   812         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   813
   814     12  PI-PROCESSOR-ID                 PIC X(4).
   815
   816     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   817
   818     12  PI-MEMBER-CAPTION               PIC X(10).
   819
   820     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   821         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   822
   823     12  PI-LIFE-OVERRIDE-L1             PIC X.
   824     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   825     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   826     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   827
   828     12  PI-AH-OVERRIDE-L1               PIC X.
   829     12  PI-AH-OVERRIDE-L2               PIC XX.
   830     12  PI-AH-OVERRIDE-L6               PIC X(6).
   831     12  PI-AH-OVERRIDE-L12              PIC X(12).
   832
   833     12  PI-NEW-SYSTEM                   PIC X(2).
   834
   835     12  PI-PRIMARY-CERT-NO              PIC X(11).
   836     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   837         88  PI-USES-PAID-TO                 VALUE '1'.
   838     12  PI-CRDTCRD-SYSTEM.
   839         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  20
* EL130.cbl
   840             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   841             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   842         16  PI-CC-MONTH-END-DT          PIC XX.
   843     12  PI-PROCESSOR-PRINTER            PIC X(4).
   844
   845     12  PI-OE-REFERENCE-2.
   846         16  PI-OE-REF-2-PRIME           PIC X(10).
   847         16  PI-OE-REF-2-SUFF            PIC X.
   848
   849     12  PI-REM-TRM-CALC-OPTION          PIC X.
   850
   851     12  PI-LANGUAGE-TYPE                PIC X.
   852             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   853             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   854             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   855
   856     12  PI-POLICY-LINKAGE-IND           PIC X.
   857         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   858         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   859                                                   LOW-VALUES.
   860
   861     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   862     12  PI-CLAIM-PW-SESSION             PIC X(1).
   863         88  PI-CLAIM-CREDIT                 VALUE '1'.
   864         88  PI-CLAIM-CONVEN                 VALUE '2'.
   865
   866     12  PI-PROCESSOR-CSR-IND            PIC X.
   867         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   868         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   869
   870     12  FILLER                          PIC X(3).
   871
   872     12  PI-SYSTEM-LEVEL                 PIC X(145).
   873
   874     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   875         PI-SYSTEM-LEVEL.
   876
   877         16  PI-ENTRY-CODES.
   878             20  PI-ENTRY-CD-1           PIC X.
   879             20  PI-ENTRY-CD-2           PIC X.
   880
   881         16  PI-RETURN-CODES.
   882             20  PI-RETURN-CD-1          PIC X.
   883             20  PI-RETURN-CD-2          PIC X.
   884
   885         16  PI-UPDATE-STATUS-SAVE.
   886             20  PI-UPDATE-BY            PIC X(4).
   887             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   888
   889         16  PI-LOWER-CASE-LETTERS       PIC X.
   890             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   891
   892*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   893*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   894*            88  CARRIER-CLM-CNTL            VALUE '2'.
   895
   896         16  PI-CERT-ACCESS-CONTROL      PIC X.
   897             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  21
* EL130.cbl
   898             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   899             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   900             88  ACCNT-CNTL                  VALUE '3'.
   901             88  CARR-ACCNT-CNTL             VALUE '4'.
   902
   903         16  PI-PROCESSOR-CAP-LIST.
   904             20  PI-SYSTEM-CONTROLS.
   905                24 PI-SYSTEM-DISPLAY     PIC X.
   906                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   907                24 PI-SYSTEM-MODIFY      PIC X.
   908                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   909             20  FILLER                  PIC XX.
   910             20  PI-DISPLAY-CAP          PIC X.
   911                 88  DISPLAY-CAP             VALUE 'Y'.
   912             20  PI-MODIFY-CAP           PIC X.
   913                 88  MODIFY-CAP              VALUE 'Y'.
   914             20  PI-MSG-AT-LOGON-CAP     PIC X.
   915                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   916             20  PI-FORCE-CAP            PIC X.
   917                 88  FORCE-CAP               VALUE 'Y'.
   918
   919         16  PI-PROGRAM-CONTROLS.
   920             20  PI-PGM-PRINT-OPT        PIC X.
   921             20  PI-PGM-FORMAT-OPT       PIC X.
   922             20  PI-PGM-PROCESS-OPT      PIC X.
   923             20  PI-PGM-TOTALS-OPT       PIC X.
   924
   925         16  PI-HELP-INTERFACE.
   926             20  PI-LAST-ERROR-NO        PIC X(4).
   927             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   928
   929         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   930             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   931
   932         16  PI-CR-CONTROL-IN-PROGRESS.
   933             20  PI-CR-CARRIER           PIC X.
   934             20  PI-CR-GROUPING          PIC X(6).
   935             20  PI-CR-STATE             PIC XX.
   936             20  PI-CR-ACCOUNT           PIC X(10).
   937             20  PI-CR-FIN-RESP          PIC X(10).
   938             20  PI-CR-TYPE              PIC X.
   939
   940         16  PI-CR-BATCH-NUMBER          PIC X(6).
   941
   942         16  PI-CR-MONTH-END-DT          PIC XX.
   943
   944         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   945             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   946             88  PI-ZERO-CARRIER             VALUE '1'.
   947             88  PI-ZERO-GROUPING            VALUE '2'.
   948             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   949
   950         16  PI-CARRIER-SECURITY         PIC X.
   951             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   952
   953         16  PI-ACCOUNT-SECURITY         PIC X(10).
   954             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   955             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  22
* EL130.cbl
   956
   957         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   958             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   959                                         INDEXED BY PI-ACCESS-NDX
   960                                         PIC X.
   961
   962         16  PI-GA-BILLING-CONTROL       PIC X.
   963             88  PI-GA-BILLING               VALUE '1'.
   964
   965         16  PI-MAIL-PROCESSING          PIC X.
   966             88  PI-MAIL-YES                 VALUE 'Y'.
   967
   968         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   969
   970         16  PI-AR-SYSTEM.
   971             20  PI-AR-PROCESSING-CNTL   PIC X.
   972                 88  PI-AR-PROCESSING        VALUE 'Y'.
   973             20  PI-AR-SUMMARY-CODE      PIC X(6).
   974             20  PI-AR-MONTH-END-DT      PIC XX.
   975
   976         16  PI-MP-SYSTEM.
   977             20  PI-MORTGAGE-USER            PIC X.
   978                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   979                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   980             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   981                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   982                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   983                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   984                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   985                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   986             20  PI-MP-MONTH-END-DT          PIC XX.
   987             20  PI-MP-REFERENCE-NO.
   988                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   989                 24  PI-MP-REFERENCE-SFX     PIC XX.
   990
   991         16  PI-LABEL-CONTROL            PIC X(01).
   992             88  PI-CREATE-LABELS                    VALUE 'Y'.
   993             88  PI-BYPASS-LABELS                    VALUE 'N'.
   994
   995         16  PI-BILL-GROUPING-CODE       PIC X(01).
   996             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   997
   998         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   999             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1000             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1001
  1002         16  FILLER                      PIC X(14).
  1003
  1004     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1005******************************************************************
  1006     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1007         16  PI-MSTR-DT               PIC XX.
  1008         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1009         16  PI-TRLR-DT               PIC XX.
  1010         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1011         16  PI-LAST-CLAIM            PIC X(7).
  1012         16  PI-LAST-CARR             PIC X.
  1013         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  23
* EL130.cbl
  1014             20  PI-LAST-CERT-PRIME   PIC X(10).
  1015             20  PI-LAST-CERT-SUFX    PIC X.
  1016         16  PI-LAST-CLAIM-TYPE       PIC X.
  1017         16  PI-CURSOR                PIC S9(4)   COMP.
  1018         16  PI-SAVE-CERT.
  1019             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1020             20  PI-SAVE-CERT-SUFX    PIC X.
  1021         16  PI-SAVE-EFFDT            PIC X(2).
  1022         16  PI-SAVE-ACCOUNT          PIC X(10).
  1023         16  PI-INCURR-SW             PIC X.
  1024         16  PI-PRT-OPT               PIC X.
  1025         16  PI-ALT-PRT               PIC X(4).
  1026         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1027             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1028         16  FILLER                   PIC X(272).
  1029         16  PI-EL127-TO-EL130-CNTRL.
  1030             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1031             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1032             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1033                 24  PI-EL127-CARRIER        PIC X.
  1034                 24  PI-EL127-GROUPING       PIC X(6).
  1035                 24  PI-EL127-STATE          PIC X(2).
  1036                 24  PI-EL127-ACCOUNT        PIC X(10).
  1037                 24  PI-EL127-CERT-NO.
  1038                     28  PI-EL127-CERT-PRIME PIC X(10).
  1039                     28  PI-EL127-CERT-SUFX  PIC X.
  1040                 24  PI-EL127-EFF-DT         PIC XX.
  1041*        16  FILLER                          PIC X(50).
  1042         16  FILLER                          PIC X(31).
  1043         16  PI-EL659-TO-EL130-CNTRL.
  1044             20  PI-EL659-CARRIER            PIC X.
  1045             20  PI-EL659-GROUPING           PIC X(6).
  1046             20  PI-EL659-STATE              PIC XX.
  1047             20  PI-EL659-ACCOUNT            PIC X(10).
  1048
  1049         16  FILLER                          PIC X(19).
  1050
  1051         16  PI-SAVE-INCUR-DT                PIC X(02).
  1052         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1053*         16  FILLER                          PIC X(65).
  1054         16  PI-ST-VFY-2ND-BENE              PIC X.
  1055         16  FILLER                          PIC X(64).
  1056
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  24
* EL130.cbl
  1058*    COPY EL130S.
  1059 01  EL130AI.
  1060     05  FILLER            PIC  X(0012).
  1061*    -------------------------------
  1062     05  RUNDTEL PIC S9(0004) COMP.
  1063     05  RUNDTEF PIC  X(0001).
  1064     05  FILLER REDEFINES RUNDTEF.
  1065         10  RUNDTEA PIC  X(0001).
  1066     05  RUNDTEI PIC  X(0008).
  1067*    -------------------------------
  1068     05  RUNTIMEL PIC S9(0004) COMP.
  1069     05  RUNTIMEF PIC  X(0001).
  1070     05  FILLER REDEFINES RUNTIMEF.
  1071         10  RUNTIMEA PIC  X(0001).
  1072     05  RUNTIMEI PIC  X(0005).
  1073*    -------------------------------
  1074     05  COMPL PIC S9(0004) COMP.
  1075     05  COMPF PIC  X(0001).
  1076     05  FILLER REDEFINES COMPF.
  1077         10  COMPA PIC  X(0001).
  1078     05  COMPI PIC  X(0003).
  1079*    -------------------------------
  1080     05  SEQUL PIC S9(0004) COMP.
  1081     05  SEQUF PIC  X(0001).
  1082     05  FILLER REDEFINES SEQUF.
  1083         10  SEQUA PIC  X(0001).
  1084     05  SEQUI PIC  X(0010).
  1085*    -------------------------------
  1086     05  MAINTL PIC S9(0004) COMP.
  1087     05  MAINTF PIC  X(0001).
  1088     05  FILLER REDEFINES MAINTF.
  1089         10  MAINTA PIC  X(0001).
  1090     05  MAINTI PIC  X(0001).
  1091*    -------------------------------
  1092     05  CLMNOL PIC S9(0004) COMP.
  1093     05  CLMNOF PIC  X(0001).
  1094     05  FILLER REDEFINES CLMNOF.
  1095         10  CLMNOA PIC  X(0001).
  1096     05  CLMNOI PIC  X(0007).
  1097*    -------------------------------
  1098     05  CLMCARRL PIC S9(0004) COMP.
  1099     05  CLMCARRF PIC  X(0001).
  1100     05  FILLER REDEFINES CLMCARRF.
  1101         10  CLMCARRA PIC  X(0001).
  1102     05  CLMCARRI PIC  X(0001).
  1103*    -------------------------------
  1104     05  CLMTYPEL PIC S9(0004) COMP.
  1105     05  CLMTYPEF PIC  X(0001).
  1106     05  FILLER REDEFINES CLMTYPEF.
  1107         10  CLMTYPEA PIC  X(0001).
  1108     05  CLMTYPEI PIC  X(0001).
  1109*    -------------------------------
  1110     05  CERTNOL PIC S9(0004) COMP.
  1111     05  CERTNOF PIC  X(0001).
  1112     05  FILLER REDEFINES CERTNOF.
  1113         10  CERTNOA PIC  X(0001).
  1114     05  CERTNOI PIC  X(0010).
  1115*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  25
* EL130.cbl
  1116     05  SUFXL PIC S9(0004) COMP.
  1117     05  SUFXF PIC  X(0001).
  1118     05  FILLER REDEFINES SUFXF.
  1119         10  SUFXA PIC  X(0001).
  1120     05  SUFXI PIC  X(0001).
  1121*    -------------------------------
  1122     05  PCERTNOL PIC S9(0004) COMP.
  1123     05  PCERTNOF PIC  X(0001).
  1124     05  FILLER REDEFINES PCERTNOF.
  1125         10  PCERTNOA PIC  X(0001).
  1126     05  PCERTNOI PIC  X(0010).
  1127*    -------------------------------
  1128     05  PSUFXL PIC S9(0004) COMP.
  1129     05  PSUFXF PIC  X(0001).
  1130     05  FILLER REDEFINES PSUFXF.
  1131         10  PSUFXA PIC  X(0001).
  1132     05  PSUFXI PIC  X(0001).
  1133*    -------------------------------
  1134     05  INCURL PIC S9(0004) COMP.
  1135     05  INCURF PIC  X(0001).
  1136     05  FILLER REDEFINES INCURF.
  1137         10  INCURA PIC  X(0001).
  1138     05  INCURI PIC  X(0008).
  1139*    -------------------------------
  1140     05  REPORTL PIC S9(0004) COMP.
  1141     05  REPORTF PIC  X(0001).
  1142     05  FILLER REDEFINES REPORTF.
  1143         10  REPORTA PIC  X(0001).
  1144     05  REPORTI PIC  X(0008).
  1145*    -------------------------------
  1146     05  CAUSEL PIC S9(0004) COMP.
  1147     05  CAUSEF PIC  X(0001).
  1148     05  FILLER REDEFINES CAUSEF.
  1149         10  CAUSEA PIC  X(0001).
  1150     05  CAUSEI PIC  X(0006).
  1151*    -------------------------------
  1152     05  ESTENDL PIC S9(0004) COMP.
  1153     05  ESTENDF PIC  X(0001).
  1154     05  FILLER REDEFINES ESTENDF.
  1155         10  ESTENDA PIC  X(0001).
  1156     05  ESTENDI PIC  X(0008).
  1157*    -------------------------------
  1158     05  DIAGL PIC S9(0004) COMP.
  1159     05  DIAGF PIC  X(0001).
  1160     05  FILLER REDEFINES DIAGF.
  1161         10  DIAGA PIC  X(0001).
  1162     05  DIAGI PIC  X(0060).
  1163*    -------------------------------
  1164     05  BENECDL PIC S9(0004) COMP.
  1165     05  BENECDF PIC  X(0001).
  1166     05  FILLER REDEFINES BENECDF.
  1167         10  BENECDA PIC  X(0001).
  1168     05  BENECDI PIC  X(0010).
  1169*    -------------------------------
  1170     05  BIRTHDTL PIC S9(0004) COMP.
  1171     05  BIRTHDTF PIC  X(0001).
  1172     05  FILLER REDEFINES BIRTHDTF.
  1173         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  26
* EL130.cbl
  1174     05  BIRTHDTI PIC  X(0008).
  1175*    -------------------------------
  1176     05  SSNL PIC S9(0004) COMP.
  1177     05  SSNF PIC  X(0001).
  1178     05  FILLER REDEFINES SSNF.
  1179         10  SSNA PIC  X(0001).
  1180     05  SSNI PIC  X(0011).
  1181*    -------------------------------
  1182     05  SEXL PIC S9(0004) COMP.
  1183     05  SEXF PIC  X(0001).
  1184     05  FILLER REDEFINES SEXF.
  1185         10  SEXA PIC  X(0001).
  1186     05  SEXI PIC  X(0001).
  1187*    -------------------------------
  1188     05  OCCCDL PIC S9(0004) COMP.
  1189     05  OCCCDF PIC  X(0001).
  1190     05  FILLER REDEFINES OCCCDF.
  1191         10  OCCCDA PIC  X(0001).
  1192     05  OCCCDI PIC  X(0006).
  1193*    -------------------------------
  1194     05  LSTNMEL PIC S9(0004) COMP.
  1195     05  LSTNMEF PIC  X(0001).
  1196     05  FILLER REDEFINES LSTNMEF.
  1197         10  LSTNMEA PIC  X(0001).
  1198     05  LSTNMEI PIC  X(0015).
  1199*    -------------------------------
  1200     05  FSTNMEL PIC S9(0004) COMP.
  1201     05  FSTNMEF PIC  X(0001).
  1202     05  FILLER REDEFINES FSTNMEF.
  1203         10  FSTNMEA PIC  X(0001).
  1204     05  FSTNMEI PIC  X(0012).
  1205*    -------------------------------
  1206     05  INITL PIC S9(0004) COMP.
  1207     05  INITF PIC  X(0001).
  1208     05  FILLER REDEFINES INITF.
  1209         10  INITA PIC  X(0001).
  1210     05  INITI PIC  X(0001).
  1211*    -------------------------------
  1212     05  LOANNOL PIC S9(0004) COMP.
  1213     05  LOANNOF PIC  X(0001).
  1214     05  FILLER REDEFINES LOANNOF.
  1215         10  LOANNOA PIC  X(0001).
  1216     05  LOANNOI PIC  X(0008).
  1217*    -------------------------------
  1218     05  CRTLNMEL PIC S9(0004) COMP.
  1219     05  CRTLNMEF PIC  X(0001).
  1220     05  FILLER REDEFINES CRTLNMEF.
  1221         10  CRTLNMEA PIC  X(0001).
  1222     05  CRTLNMEI PIC  X(0015).
  1223*    -------------------------------
  1224     05  CRTFNMEL PIC S9(0004) COMP.
  1225     05  CRTFNMEF PIC  X(0001).
  1226     05  FILLER REDEFINES CRTFNMEF.
  1227         10  CRTFNMEA PIC  X(0001).
  1228     05  CRTFNMEI PIC  X(0012).
  1229*    -------------------------------
  1230     05  CRTINITL PIC S9(0004) COMP.
  1231     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  27
* EL130.cbl
  1232     05  FILLER REDEFINES CRTINITF.
  1233         10  CRTINITA PIC  X(0001).
  1234     05  CRTINITI PIC  X(0001).
  1235*    -------------------------------
  1236     05  LOANBALL PIC S9(0004) COMP.
  1237     05  LOANBALF PIC  X(0001).
  1238     05  FILLER REDEFINES LOANBALF.
  1239         10  LOANBALA PIC  X(0001).
  1240     05  LOANBALI PIC  9(7)V99.
  1241*    -------------------------------
  1242     05  MANRSVL PIC S9(0004) COMP.
  1243     05  MANRSVF PIC  X(0001).
  1244     05  FILLER REDEFINES MANRSVF.
  1245         10  MANRSVA PIC  X(0001).
  1246     05  MANRSVI PIC  9(7)V99.
  1247*    -------------------------------
  1248     05  SUPVL PIC S9(0004) COMP.
  1249     05  SUPVF PIC  X(0001).
  1250     05  FILLER REDEFINES SUPVF.
  1251         10  SUPVA PIC  X(0001).
  1252     05  SUPVI PIC  X(0001).
  1253*    -------------------------------
  1254     05  PRICDL PIC S9(0004) COMP.
  1255     05  PRICDF PIC  X(0001).
  1256     05  FILLER REDEFINES PRICDF.
  1257         10  PRICDA PIC  X(0001).
  1258     05  PRICDI PIC  X(0001).
  1259*    -------------------------------
  1260     05  PRODL PIC S9(0004) COMP.
  1261     05  PRODF PIC  X(0001).
  1262     05  FILLER REDEFINES PRODF.
  1263         10  PRODA PIC  X(0001).
  1264     05  PRODI PIC  X(0008).
  1265*    -------------------------------
  1266     05  PRODCDL PIC S9(0004) COMP.
  1267     05  PRODCDF PIC  X(0001).
  1268     05  FILLER REDEFINES PRODCDF.
  1269         10  PRODCDA PIC  X(0001).
  1270     05  PRODCDI PIC  X(0001).
  1271*    -------------------------------
  1272     05  FILETOL PIC S9(0004) COMP.
  1273     05  FILETOF PIC  X(0001).
  1274     05  FILLER REDEFINES FILETOF.
  1275         10  FILETOA PIC  X(0001).
  1276     05  FILETOI PIC  X(0004).
  1277*    -------------------------------
  1278     05  PROCCDL PIC S9(0004) COMP.
  1279     05  PROCCDF PIC  X(0001).
  1280     05  FILLER REDEFINES PROCCDF.
  1281         10  PROCCDA PIC  X(0001).
  1282     05  PROCCDI PIC  X(0004).
  1283*    -------------------------------
  1284     05  RELCLML PIC S9(0004) COMP.
  1285     05  RELCLMF PIC  X(0001).
  1286     05  FILLER REDEFINES RELCLMF.
  1287         10  RELCLMA PIC  X(0001).
  1288     05  RELCLMI PIC  X(0007).
  1289*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  28
* EL130.cbl
  1290     05  PRTOPTL PIC S9(0004) COMP.
  1291     05  PRTOPTF PIC  X(0001).
  1292     05  FILLER REDEFINES PRTOPTF.
  1293         10  PRTOPTA PIC  X(0001).
  1294     05  PRTOPTI PIC  X(0001).
  1295*    -------------------------------
  1296     05  ALTPRTL PIC S9(0004) COMP.
  1297     05  ALTPRTF PIC  X(0001).
  1298     05  FILLER REDEFINES ALTPRTF.
  1299         10  ALTPRTA PIC  X(0001).
  1300     05  ALTPRTI PIC  X(0004).
  1301*    -------------------------------
  1302     05  CERTMTL PIC S9(0004) COMP.
  1303     05  CERTMTF PIC  X(0001).
  1304     05  FILLER REDEFINES CERTMTF.
  1305         10  CERTMTA PIC  X(0001).
  1306     05  CERTMTI PIC  X(0001).
  1307*    -------------------------------
  1308     05  CRTCARRL PIC S9(0004) COMP.
  1309     05  CRTCARRF PIC  X(0001).
  1310     05  FILLER REDEFINES CRTCARRF.
  1311         10  CRTCARRA PIC  X(0001).
  1312     05  CRTCARRI PIC  X(0001).
  1313*    -------------------------------
  1314     05  GROUPL PIC S9(0004) COMP.
  1315     05  GROUPF PIC  X(0001).
  1316     05  FILLER REDEFINES GROUPF.
  1317         10  GROUPA PIC  X(0001).
  1318     05  GROUPI PIC  X(0006).
  1319*    -------------------------------
  1320     05  STATEL PIC S9(0004) COMP.
  1321     05  STATEF PIC  X(0001).
  1322     05  FILLER REDEFINES STATEF.
  1323         10  STATEA PIC  X(0001).
  1324     05  STATEI PIC  X(0002).
  1325*    -------------------------------
  1326     05  ACCOUNTL PIC S9(0004) COMP.
  1327     05  ACCOUNTF PIC  X(0001).
  1328     05  FILLER REDEFINES ACCOUNTF.
  1329         10  ACCOUNTA PIC  X(0001).
  1330     05  ACCOUNTI PIC  X(0010).
  1331*    -------------------------------
  1332     05  EFFDTL PIC S9(0004) COMP.
  1333     05  EFFDTF PIC  X(0001).
  1334     05  FILLER REDEFINES EFFDTF.
  1335         10  EFFDTA PIC  X(0001).
  1336     05  EFFDTI PIC  X(0008).
  1337*    -------------------------------
  1338     05  CRTSSNL PIC S9(0004) COMP.
  1339     05  CRTSSNF PIC  X(0001).
  1340     05  FILLER REDEFINES CRTSSNF.
  1341         10  CRTSSNA PIC  X(0001).
  1342     05  CRTSSNI PIC  X(0011).
  1343*    -------------------------------
  1344     05  MEMCAPL PIC S9(0004) COMP.
  1345     05  MEMCAPF PIC  X(0001).
  1346     05  FILLER REDEFINES MEMCAPF.
  1347         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  29
* EL130.cbl
  1348     05  MEMCAPI PIC  X(0010).
  1349*    -------------------------------
  1350     05  MEMBERL PIC S9(0004) COMP.
  1351     05  MEMBERF PIC  X(0001).
  1352     05  FILLER REDEFINES MEMBERF.
  1353         10  MEMBERA PIC  X(0001).
  1354     05  MEMBERI PIC  X(0012).
  1355*    -------------------------------
  1356     05  REINCDL PIC S9(0004) COMP.
  1357     05  REINCDF PIC  X(0001).
  1358     05  FILLER REDEFINES REINCDF.
  1359         10  REINCDA PIC  X(0001).
  1360     05  REINCDI PIC  X(0001).
  1361*    -------------------------------
  1362     05  ISSAGEL PIC S9(0004) COMP.
  1363     05  ISSAGEF PIC  X(0001).
  1364     05  FILLER REDEFINES ISSAGEF.
  1365         10  ISSAGEA PIC  X(0001).
  1366     05  ISSAGEI PIC  X(0002).
  1367*    -------------------------------
  1368     05  APRL PIC S9(0004) COMP.
  1369     05  APRF PIC  X(0001).
  1370     05  FILLER REDEFINES APRF.
  1371         10  APRA PIC  X(0001).
  1372     05  APRI PIC  9(4)V9(4).
  1373*    -------------------------------
  1374     05  PMTFREQL PIC S9(0004) COMP.
  1375     05  PMTFREQF PIC  X(0001).
  1376     05  FILLER REDEFINES PMTFREQF.
  1377         10  PMTFREQA PIC  X(0001).
  1378     05  PMTFREQI PIC  99.
  1379*    -------------------------------
  1380     05  INDGRPL PIC S9(0004) COMP.
  1381     05  INDGRPF PIC  X(0001).
  1382     05  FILLER REDEFINES INDGRPF.
  1383         10  INDGRPA PIC  X(0001).
  1384     05  INDGRPI PIC  X(0001).
  1385*    -------------------------------
  1386     05  PREMTYPL PIC S9(0004) COMP.
  1387     05  PREMTYPF PIC  X(0001).
  1388     05  FILLER REDEFINES PREMTYPF.
  1389         10  PREMTYPA PIC  X(0001).
  1390     05  PREMTYPI PIC  X(0001).
  1391*    -------------------------------
  1392     05  ADDONDTL PIC S9(0004) COMP.
  1393     05  ADDONDTF PIC  X(0001).
  1394     05  FILLER REDEFINES ADDONDTF.
  1395         10  ADDONDTA PIC  X(0001).
  1396     05  ADDONDTI PIC  X(0008).
  1397*    -------------------------------
  1398     05  JNTLNMEL PIC S9(0004) COMP.
  1399     05  JNTLNMEF PIC  X(0001).
  1400     05  FILLER REDEFINES JNTLNMEF.
  1401         10  JNTLNMEA PIC  X(0001).
  1402     05  JNTLNMEI PIC  X(0015).
  1403*    -------------------------------
  1404     05  JNTFNMEL PIC S9(0004) COMP.
  1405     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  30
* EL130.cbl
  1406     05  FILLER REDEFINES JNTFNMEF.
  1407         10  JNTFNMEA PIC  X(0001).
  1408     05  JNTFNMEI PIC  X(0002).
  1409*    -------------------------------
  1410     05  JNTINITL PIC S9(0004) COMP.
  1411     05  JNTINITF PIC  X(0001).
  1412     05  FILLER REDEFINES JNTINITF.
  1413         10  JNTINITA PIC  X(0001).
  1414     05  JNTINITI PIC  X(0001).
  1415*    -------------------------------
  1416     05  JNTAGEL PIC S9(0004) COMP.
  1417     05  JNTAGEF PIC  X(0001).
  1418     05  FILLER REDEFINES JNTAGEF.
  1419         10  JNTAGEA PIC  X(0001).
  1420     05  JNTAGEI PIC  X(0002).
  1421*    -------------------------------
  1422     05  LCVDSCRL PIC S9(0004) COMP.
  1423     05  LCVDSCRF PIC  X(0001).
  1424     05  FILLER REDEFINES LCVDSCRF.
  1425         10  LCVDSCRA PIC  X(0001).
  1426     05  LCVDSCRI PIC  X(0006).
  1427*    -------------------------------
  1428     05  LCVKINDL PIC S9(0004) COMP.
  1429     05  LCVKINDF PIC  X(0001).
  1430     05  FILLER REDEFINES LCVKINDF.
  1431         10  LCVKINDA PIC  X(0001).
  1432     05  LCVKINDI PIC  X(0003).
  1433*    -------------------------------
  1434     05  LCVCDL PIC S9(0004) COMP.
  1435     05  LCVCDF PIC  X(0001).
  1436     05  FILLER REDEFINES LCVCDF.
  1437         10  LCVCDA PIC  X(0001).
  1438     05  LCVCDI PIC  X(0002).
  1439*    -------------------------------
  1440     05  LCVOTRML PIC S9(0004) COMP.
  1441     05  LCVOTRMF PIC  X(0001).
  1442     05  FILLER REDEFINES LCVOTRMF.
  1443         10  LCVOTRMA PIC  X(0001).
  1444     05  LCVOTRMI PIC  999.
  1445*    -------------------------------
  1446     05  LCVRTRML PIC S9(0004) COMP.
  1447     05  LCVRTRMF PIC  X(0001).
  1448     05  FILLER REDEFINES LCVRTRMF.
  1449         10  LCVRTRMA PIC  X(0001).
  1450     05  LCVRTRMI PIC  X(0003).
  1451*    -------------------------------
  1452     05  LCVRATEL PIC S9(0004) COMP.
  1453     05  LCVRATEF PIC  X(0001).
  1454     05  FILLER REDEFINES LCVRATEF.
  1455         10  LCVRATEA PIC  X(0001).
  1456     05  LCVRATEI PIC  9999V99.
  1457*    -------------------------------
  1458     05  LCVBENEL PIC S9(0004) COMP.
  1459     05  LCVBENEF PIC  X(0001).
  1460     05  FILLER REDEFINES LCVBENEF.
  1461         10  LCVBENEA PIC  X(0001).
  1462     05  LCVBENEI PIC  9(9)V99.
  1463*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  31
* EL130.cbl
  1464     05  LCVFORML PIC S9(0004) COMP.
  1465     05  LCVFORMF PIC  X(0001).
  1466     05  FILLER REDEFINES LCVFORMF.
  1467         10  LCVFORMA PIC  X(0001).
  1468     05  LCVFORMI PIC  X(0012).
  1469*    -------------------------------
  1470     05  LCVCNDTL PIC S9(0004) COMP.
  1471     05  LCVCNDTF PIC  X(0001).
  1472     05  FILLER REDEFINES LCVCNDTF.
  1473         10  LCVCNDTA PIC  X(0001).
  1474     05  LCVCNDTI PIC  X(0008).
  1475*    -------------------------------
  1476     05  LCVEXITL PIC S9(0004) COMP.
  1477     05  LCVEXITF PIC  X(0001).
  1478     05  FILLER REDEFINES LCVEXITF.
  1479         10  LCVEXITA PIC  X(0001).
  1480     05  LCVEXITI PIC  X(0008).
  1481*    -------------------------------
  1482     05  LCVSTATL PIC S9(0004) COMP.
  1483     05  LCVSTATF PIC  X(0001).
  1484     05  FILLER REDEFINES LCVSTATF.
  1485         10  LCVSTATA PIC  X(0001).
  1486     05  LCVSTATI PIC  X(0006).
  1487*    -------------------------------
  1488     05  ACVDSCRL PIC S9(0004) COMP.
  1489     05  ACVDSCRF PIC  X(0001).
  1490     05  FILLER REDEFINES ACVDSCRF.
  1491         10  ACVDSCRA PIC  X(0001).
  1492     05  ACVDSCRI PIC  X(0006).
  1493*    -------------------------------
  1494     05  ACVKINDL PIC S9(0004) COMP.
  1495     05  ACVKINDF PIC  X(0001).
  1496     05  FILLER REDEFINES ACVKINDF.
  1497         10  ACVKINDA PIC  X(0001).
  1498     05  ACVKINDI PIC  X(0003).
  1499*    -------------------------------
  1500     05  ACVCDL PIC S9(0004) COMP.
  1501     05  ACVCDF PIC  X(0001).
  1502     05  FILLER REDEFINES ACVCDF.
  1503         10  ACVCDA PIC  X(0001).
  1504     05  ACVCDI PIC  X(0002).
  1505*    -------------------------------
  1506     05  ACVOTRML PIC S9(0004) COMP.
  1507     05  ACVOTRMF PIC  X(0001).
  1508     05  FILLER REDEFINES ACVOTRMF.
  1509         10  ACVOTRMA PIC  X(0001).
  1510     05  ACVOTRMI PIC  999.
  1511*    -------------------------------
  1512     05  ACVRTRML PIC S9(0004) COMP.
  1513     05  ACVRTRMF PIC  X(0001).
  1514     05  FILLER REDEFINES ACVRTRMF.
  1515         10  ACVRTRMA PIC  X(0001).
  1516     05  ACVRTRMI PIC  X(0003).
  1517*    -------------------------------
  1518     05  ACVRATEL PIC S9(0004) COMP.
  1519     05  ACVRATEF PIC  X(0001).
  1520     05  FILLER REDEFINES ACVRATEF.
  1521         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  32
* EL130.cbl
  1522     05  ACVRATEI PIC  9999V99.
  1523*    -------------------------------
  1524     05  ACVBENEL PIC S9(0004) COMP.
  1525     05  ACVBENEF PIC  X(0001).
  1526     05  FILLER REDEFINES ACVBENEF.
  1527         10  ACVBENEA PIC  X(0001).
  1528     05  ACVBENEI PIC  9(9)V99.
  1529*    -------------------------------
  1530     05  ACVFORML PIC S9(0004) COMP.
  1531     05  ACVFORMF PIC  X(0001).
  1532     05  FILLER REDEFINES ACVFORMF.
  1533         10  ACVFORMA PIC  X(0001).
  1534     05  ACVFORMI PIC  X(0012).
  1535*    -------------------------------
  1536     05  ACVCNDTL PIC S9(0004) COMP.
  1537     05  ACVCNDTF PIC  X(0001).
  1538     05  FILLER REDEFINES ACVCNDTF.
  1539         10  ACVCNDTA PIC  X(0001).
  1540     05  ACVCNDTI PIC  X(0008).
  1541*    -------------------------------
  1542     05  ACVEXITL PIC S9(0004) COMP.
  1543     05  ACVEXITF PIC  X(0001).
  1544     05  FILLER REDEFINES ACVEXITF.
  1545         10  ACVEXITA PIC  X(0001).
  1546     05  ACVEXITI PIC  X(0008).
  1547*    -------------------------------
  1548     05  ACVSTATL PIC S9(0004) COMP.
  1549     05  ACVSTATF PIC  X(0001).
  1550     05  FILLER REDEFINES ACVSTATF.
  1551         10  ACVSTATA PIC  X(0001).
  1552     05  ACVSTATI PIC  X(0006).
  1553*    -------------------------------
  1554     05  ERRMSG1L PIC S9(0004) COMP.
  1555     05  ERRMSG1F PIC  X(0001).
  1556     05  FILLER REDEFINES ERRMSG1F.
  1557         10  ERRMSG1A PIC  X(0001).
  1558     05  ERRMSG1I PIC  X(0072).
  1559*    -------------------------------
  1560     05  ERRMSG2L PIC S9(0004) COMP.
  1561     05  ERRMSG2F PIC  X(0001).
  1562     05  FILLER REDEFINES ERRMSG2F.
  1563         10  ERRMSG2A PIC  X(0001).
  1564     05  ERRMSG2I PIC  X(0072).
  1565*    -------------------------------
  1566     05  BCERT1L PIC S9(0004) COMP.
  1567     05  BCERT1F PIC  X(0001).
  1568     05  FILLER REDEFINES BCERT1F.
  1569         10  BCERT1A PIC  X(0001).
  1570     05  BCERT1I PIC  X(0010).
  1571*    -------------------------------
  1572     05  BSUFX1L PIC S9(0004) COMP.
  1573     05  BSUFX1F PIC  X(0001).
  1574     05  FILLER REDEFINES BSUFX1F.
  1575         10  BSUFX1A PIC  X(0001).
  1576     05  BSUFX1I PIC  X(0001).
  1577*    -------------------------------
  1578     05  BCERT2L PIC S9(0004) COMP.
  1579     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  33
* EL130.cbl
  1580     05  FILLER REDEFINES BCERT2F.
  1581         10  BCERT2A PIC  X(0001).
  1582     05  BCERT2I PIC  X(0010).
  1583*    -------------------------------
  1584     05  BSUFX2L PIC S9(0004) COMP.
  1585     05  BSUFX2F PIC  X(0001).
  1586     05  FILLER REDEFINES BSUFX2F.
  1587         10  BSUFX2A PIC  X(0001).
  1588     05  BSUFX2I PIC  X(0001).
  1589*    -------------------------------
  1590     05  BCERT3L PIC S9(0004) COMP.
  1591     05  BCERT3F PIC  X(0001).
  1592     05  FILLER REDEFINES BCERT3F.
  1593         10  BCERT3A PIC  X(0001).
  1594     05  BCERT3I PIC  X(0010).
  1595*    -------------------------------
  1596     05  BSUFX3L PIC S9(0004) COMP.
  1597     05  BSUFX3F PIC  X(0001).
  1598     05  FILLER REDEFINES BSUFX3F.
  1599         10  BSUFX3A PIC  X(0001).
  1600     05  BSUFX3I PIC  X(0001).
  1601*    -------------------------------
  1602     05  BCERT4L PIC S9(0004) COMP.
  1603     05  BCERT4F PIC  X(0001).
  1604     05  FILLER REDEFINES BCERT4F.
  1605         10  BCERT4A PIC  X(0001).
  1606     05  BCERT4I PIC  X(0010).
  1607*    -------------------------------
  1608     05  BSUFX4L PIC S9(0004) COMP.
  1609     05  BSUFX4F PIC  X(0001).
  1610     05  FILLER REDEFINES BSUFX4F.
  1611         10  BSUFX4A PIC  X(0001).
  1612     05  BSUFX4I PIC  X(0001).
  1613*    -------------------------------
  1614     05  BCERT5L PIC S9(0004) COMP.
  1615     05  BCERT5F PIC  X(0001).
  1616     05  FILLER REDEFINES BCERT5F.
  1617         10  BCERT5A PIC  X(0001).
  1618     05  BCERT5I PIC  X(0010).
  1619*    -------------------------------
  1620     05  BSUFX5L PIC S9(0004) COMP.
  1621     05  BSUFX5F PIC  X(0001).
  1622     05  FILLER REDEFINES BSUFX5F.
  1623         10  BSUFX5A PIC  X(0001).
  1624     05  BSUFX5I PIC  X(0001).
  1625*    -------------------------------
  1626     05  ENTERPFL PIC S9(0004) COMP.
  1627     05  ENTERPFF PIC  X(0001).
  1628     05  FILLER REDEFINES ENTERPFF.
  1629         10  ENTERPFA PIC  X(0001).
  1630     05  ENTERPFI PIC  99.
  1631*    -------------------------------
  1632     05  PF5L PIC S9(0004) COMP.
  1633     05  PF5F PIC  X(0001).
  1634     05  FILLER REDEFINES PF5F.
  1635         10  PF5A PIC  X(0001).
  1636     05  PF5I PIC  X(0013).
  1637 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  34
* EL130.cbl
  1638     05  FILLER            PIC  X(0012).
  1639*    -------------------------------
  1640     05  FILLER            PIC  X(0003).
  1641     05  RUNDTEO PIC  X(0008).
  1642*    -------------------------------
  1643     05  FILLER            PIC  X(0003).
  1644     05  RUNTIMEO PIC  99.99.
  1645*    -------------------------------
  1646     05  FILLER            PIC  X(0003).
  1647     05  COMPO PIC  X(0003).
  1648*    -------------------------------
  1649     05  FILLER            PIC  X(0003).
  1650     05  SEQUO PIC  X(0010).
  1651*    -------------------------------
  1652     05  FILLER            PIC  X(0003).
  1653     05  MAINTO PIC  X(0001).
  1654*    -------------------------------
  1655     05  FILLER            PIC  X(0003).
  1656     05  CLMNOO PIC  X(0007).
  1657*    -------------------------------
  1658     05  FILLER            PIC  X(0003).
  1659     05  CLMCARRO PIC  X(0001).
  1660*    -------------------------------
  1661     05  FILLER            PIC  X(0003).
  1662     05  CLMTYPEO PIC  X(0001).
  1663*    -------------------------------
  1664     05  FILLER            PIC  X(0003).
  1665     05  CERTNOO PIC  X(0010).
  1666*    -------------------------------
  1667     05  FILLER            PIC  X(0003).
  1668     05  SUFXO PIC  X(0001).
  1669*    -------------------------------
  1670     05  FILLER            PIC  X(0003).
  1671     05  PCERTNOO PIC  X(0010).
  1672*    -------------------------------
  1673     05  FILLER            PIC  X(0003).
  1674     05  PSUFXO PIC  X(0001).
  1675*    -------------------------------
  1676     05  FILLER            PIC  X(0003).
  1677     05  INCURO PIC  X(0008).
  1678*    -------------------------------
  1679     05  FILLER            PIC  X(0003).
  1680     05  REPORTO PIC  X(0008).
  1681*    -------------------------------
  1682     05  FILLER            PIC  X(0003).
  1683     05  CAUSEO PIC  X(0006).
  1684*    -------------------------------
  1685     05  FILLER            PIC  X(0003).
  1686     05  ESTENDO PIC  X(0008).
  1687*    -------------------------------
  1688     05  FILLER            PIC  X(0003).
  1689     05  DIAGO PIC  X(0060).
  1690*    -------------------------------
  1691     05  FILLER            PIC  X(0003).
  1692     05  BENECDO PIC  X(0010).
  1693*    -------------------------------
  1694     05  FILLER            PIC  X(0003).
  1695     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  35
* EL130.cbl
  1696*    -------------------------------
  1697     05  FILLER            PIC  X(0003).
  1698     05  SSNO PIC  X(0011).
  1699*    -------------------------------
  1700     05  FILLER            PIC  X(0003).
  1701     05  SEXO PIC  X(0001).
  1702*    -------------------------------
  1703     05  FILLER            PIC  X(0003).
  1704     05  OCCCDO PIC  X(0006).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  LSTNMEO PIC  X(0015).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  FSTNMEO PIC  X(0012).
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  INITO PIC  X(0001).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  LOANNOO PIC  X(0008).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  CRTLNMEO PIC  X(0015).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  CRTFNMEO PIC  X(0012).
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  CRTINITO PIC  X(0001).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  LOANBALO PIC  ZZZZZ9.99.
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  MANRSVO PIC  Z(5)9.99.
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  SUPVO PIC  X(0001).
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  PRICDO PIC  X(0001).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  PRODO PIC  X(0008).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  PRODCDO PIC  X(0001).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  FILETOO PIC  X(0004).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  PROCCDO PIC  X(0004).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  RELCLMO PIC  X(0007).
  1753*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  36
* EL130.cbl
  1754     05  FILLER            PIC  X(0003).
  1755     05  PRTOPTO PIC  X(0001).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  ALTPRTO PIC  X(0004).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  CERTMTO PIC  X(0001).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  CRTCARRO PIC  X(0001).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  GROUPO PIC  X(0006).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  STATEO PIC  X(0002).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  ACCOUNTO PIC  X(0010).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  EFFDTO PIC  X(0008).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  CRTSSNO PIC  X(0011).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  MEMCAPO PIC  X(0010).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  MEMBERO PIC  X(0012).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  REINCDO PIC  X(0001).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  ISSAGEO PIC  X(0002).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  APRO PIC  9(3).9(4).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  PMTFREQO PIC  99.
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  INDGRPO PIC  X(0001).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  PREMTYPO PIC  X(0001).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  ADDONDTO PIC  X(0008).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  JNTLNMEO PIC  X(0015).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  37
* EL130.cbl
  1812     05  JNTFNMEO PIC  X(0002).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  JNTINITO PIC  X(0001).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  JNTAGEO PIC  X(0002).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  LCVDSCRO PIC  X(0006).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  LCVKINDO PIC  X(0003).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  LCVCDO PIC  X(0002).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  LCVOTRMO PIC  999.
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  LCVRTRMO PIC  ZZZ.
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  LCVRATEO PIC  ZZZ.ZZ.
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  LCVFORMO PIC  X(0012).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  LCVCNDTO PIC  X(0008).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  LCVEXITO PIC  X(0008).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  LCVSTATO PIC  X(0006).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  ACVDSCRO PIC  X(0006).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  ACVKINDO PIC  X(0003).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  ACVCDO PIC  X(0002).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  ACVOTRMO PIC  999.
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  ACVRTRMO PIC  ZZZ.
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  38
* EL130.cbl
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  ACVFORMO PIC  X(0012).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  ACVCNDTO PIC  X(0008).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  ACVEXITO PIC  X(0008).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  ACVSTATO PIC  X(0006).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  ERRMSG1O PIC  X(0072).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  ERRMSG2O PIC  X(0072).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  BCERT1O PIC  X(0010).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  BSUFX1O PIC  X(0001).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  BCERT2O PIC  X(0010).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  BSUFX2O PIC  X(0001).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  BCERT3O PIC  X(0010).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  BSUFX3O PIC  X(0001).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  BCERT4O PIC  X(0010).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  BSUFX4O PIC  X(0001).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  BCERT5O PIC  X(0010).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  BSUFX5O PIC  X(0001).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  ENTERPFO PIC  X(0002).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  PF5O PIC  X(0013).
  1927*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  39
* EL130.cbl
  1929*    COPY ELCDATE.
  1930******************************************************************
  1931*                                                                *
  1932*                                                                *
  1933*                            ELCDATE.                            *
  1934*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1935*                            VMOD=2.003
  1936*                                                                *
  1937*                                                                *
  1938*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1939*                 LENGTH = 200                                   *
  1940******************************************************************
  1941
  1942 01  DATE-CONVERSION-DATA.
  1943     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1944     12  DC-OPTION-CODE                PIC X.
  1945         88  BIN-TO-GREG                VALUE ' '.
  1946         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1947         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1948         88  YMD-GREG-TO-BIN            VALUE '3'.
  1949         88  MDY-GREG-TO-BIN            VALUE '4'.
  1950         88  JULIAN-TO-BIN              VALUE '5'.
  1951         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1952         88  FIND-CENTURY               VALUE '7'.
  1953         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1954         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1955         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1956         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1957         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1958         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1959         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1960         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1961         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1962         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1963         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1964         88  BIN-3-TO-GREG              VALUE 'I'.
  1965         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1966         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1967         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1968         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1969         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1970         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1971         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1972         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1973         88  THREE-CHARACTER-BIN
  1974                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1975         88  GREGORIAN-TO-BIN
  1976                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1977         88  BIN-TO-GREGORIAN
  1978                  VALUES ' ' '1' 'I' '8' 'G'.
  1979         88  JULIAN-TO-BINARY
  1980                  VALUES '5' 'C' 'E' 'F'.
  1981     12  DC-ERROR-CODE                 PIC X.
  1982         88  NO-CONVERSION-ERROR        VALUE ' '.
  1983         88  DATE-CONVERSION-ERROR
  1984                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1985         88  DATE-IS-ZERO               VALUE '1'.
  1986         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  40
* EL130.cbl
  1987         88  DATE-IS-INVALID            VALUE '3'.
  1988         88  DATE1-GREATER-DATE2        VALUE '4'.
  1989         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1990         88  DATE-INVALID-OPTION        VALUE '9'.
  1991         88  INVALID-CENTURY            VALUE 'A'.
  1992         88  ONLY-CENTURY               VALUE 'B'.
  1993         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1994         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1995     12  DC-END-OF-MONTH               PIC X.
  1996         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1997     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1998         88  USE-NORMAL-PROCESS         VALUE ' '.
  1999         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2000         88  ADJUST-UP-100-YRS          VALUE '2'.
  2001     12  FILLER                        PIC X.
  2002     12  DC-CONVERSION-DATES.
  2003         16  DC-BIN-DATE-1             PIC XX.
  2004         16  DC-BIN-DATE-2             PIC XX.
  2005         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2006         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2007                       DC-GREG-DATE-1-EDIT.
  2008             20  DC-EDIT1-MONTH        PIC 99.
  2009             20  SLASH1-1              PIC X.
  2010             20  DC-EDIT1-DAY          PIC 99.
  2011             20  SLASH1-2              PIC X.
  2012             20  DC-EDIT1-YEAR         PIC 99.
  2013         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2014         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2015                     DC-GREG-DATE-2-EDIT.
  2016             20  DC-EDIT2-MONTH        PIC 99.
  2017             20  SLASH2-1              PIC X.
  2018             20  DC-EDIT2-DAY          PIC 99.
  2019             20  SLASH2-2              PIC X.
  2020             20  DC-EDIT2-YEAR         PIC 99.
  2021         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2022         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2023                     DC-GREG-DATE-1-YMD.
  2024             20  DC-YMD-YEAR           PIC 99.
  2025             20  DC-YMD-MONTH          PIC 99.
  2026             20  DC-YMD-DAY            PIC 99.
  2027         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2028         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2029                      DC-GREG-DATE-1-MDY.
  2030             20  DC-MDY-MONTH          PIC 99.
  2031             20  DC-MDY-DAY            PIC 99.
  2032             20  DC-MDY-YEAR           PIC 99.
  2033         16  DC-GREG-DATE-1-ALPHA.
  2034             20  DC-ALPHA-MONTH        PIC X(10).
  2035             20  DC-ALPHA-DAY          PIC 99.
  2036             20  FILLER                PIC XX.
  2037             20  DC-ALPHA-CENTURY.
  2038                 24 DC-ALPHA-CEN-N     PIC 99.
  2039             20  DC-ALPHA-YEAR         PIC 99.
  2040         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2041         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2042         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2043         16  DC-JULIAN-DATE            PIC 9(05).
  2044         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  41
* EL130.cbl
  2045                                       PIC 9(05).
  2046         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2047             20  DC-JULIAN-YEAR        PIC 99.
  2048             20  DC-JULIAN-DAYS        PIC 999.
  2049         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2050         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2051         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2052     12  DATE-CONVERSION-VARIBLES.
  2053         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2054         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2055             20  FILLER                PIC 9(3).
  2056             20  HOLD-CEN-1-CCYY.
  2057                 24  HOLD-CEN-1-CC     PIC 99.
  2058                 24  HOLD-CEN-1-YY     PIC 99.
  2059             20  HOLD-CEN-1-MO         PIC 99.
  2060             20  HOLD-CEN-1-DA         PIC 99.
  2061         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2062             20  HOLD-CEN-1-R-MO       PIC 99.
  2063             20  HOLD-CEN-1-R-DA       PIC 99.
  2064             20  HOLD-CEN-1-R-CCYY.
  2065                 24  HOLD-CEN-1-R-CC   PIC 99.
  2066                 24  HOLD-CEN-1-R-YY   PIC 99.
  2067             20  FILLER                PIC 9(3).
  2068         16  HOLD-CENTURY-1-X.
  2069             20  FILLER                PIC X(3)  VALUE SPACES.
  2070             20  HOLD-CEN-1-X-CCYY.
  2071                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2072                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2073             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2074             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2075         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2076             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2077             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2078             20  HOLD-CEN-1-R-X-CCYY.
  2079                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2080                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2081             20  FILLER                PIC XXX.
  2082         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2083         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2084         16  DC-JULIAN-DATE-1          PIC 9(07).
  2085         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2086             20  DC-JULIAN-1-CCYY.
  2087                 24  DC-JULIAN-1-CC    PIC 99.
  2088                 24  DC-JULIAN-1-YR    PIC 99.
  2089             20  DC-JULIAN-DA-1        PIC 999.
  2090         16  DC-JULIAN-DATE-2          PIC 9(07).
  2091         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2092             20  DC-JULIAN-2-CCYY.
  2093                 24  DC-JULIAN-2-CC    PIC 99.
  2094                 24  DC-JULIAN-2-YR    PIC 99.
  2095             20  DC-JULIAN-DA-2        PIC 999.
  2096         16  DC-GREG-DATE-A-EDIT.
  2097             20  DC-EDITA-MONTH        PIC 99.
  2098             20  SLASHA-1              PIC X VALUE '/'.
  2099             20  DC-EDITA-DAY          PIC 99.
  2100             20  SLASHA-2              PIC X VALUE '/'.
  2101             20  DC-EDITA-CCYY.
  2102                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  42
* EL130.cbl
  2103                 24  DC-EDITA-YEAR     PIC 99.
  2104         16  DC-GREG-DATE-B-EDIT.
  2105             20  DC-EDITB-MONTH        PIC 99.
  2106             20  SLASHB-1              PIC X VALUE '/'.
  2107             20  DC-EDITB-DAY          PIC 99.
  2108             20  SLASHB-2              PIC X VALUE '/'.
  2109             20  DC-EDITB-CCYY.
  2110                 24  DC-EDITB-CENT     PIC 99.
  2111                 24  DC-EDITB-YEAR     PIC 99.
  2112         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2113         16  DC-GREG-DATE-CYMD-R REDEFINES
  2114                              DC-GREG-DATE-CYMD.
  2115             20  DC-CYMD-CEN           PIC 99.
  2116             20  DC-CYMD-YEAR          PIC 99.
  2117             20  DC-CYMD-MONTH         PIC 99.
  2118             20  DC-CYMD-DAY           PIC 99.
  2119         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2120         16  DC-GREG-DATE-MDCY-R REDEFINES
  2121                              DC-GREG-DATE-MDCY.
  2122             20  DC-MDCY-MONTH         PIC 99.
  2123             20  DC-MDCY-DAY           PIC 99.
  2124             20  DC-MDCY-CEN           PIC 99.
  2125             20  DC-MDCY-YEAR          PIC 99.
  2126    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2127        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2128    12  DC-EL310-DATE                  PIC X(21).
  2129    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  43
* EL130.cbl
  2131*    COPY ELCCALC.
  2132******************************************************************
  2133*                                                                *
  2134*                           ELCCALC.                            *
  2135*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2136*                            VMOD=2.025                          *
  2137*                                                                *
  2138*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2139*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2140*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2141*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2142*                                                                *
  2143*  PASSED TO ELRTRM                                              *
  2144*  -----------------                                             *
  2145*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2146*  ORIGINAL TERM                                                 *
  2147*  BEGINNING DATE                                                *
  2148*  ENDING DATE                                                   *
  2149*  COMPANY I.D.                                                  *
  2150*  ACCOUNT MASTER USER FIELD                                     *
  2151*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2152*  FREE LOOK DAYS                                                *
  2153*                                                                *
  2154*  RETURNED FROM ELRTRM                                          *
  2155*  ---------------------                                         *
  2156*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2157*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2158*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2159*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2160*----------------------------------------------------------------*
  2161*  PASSED TO ELRAMT                                              *
  2162*  ----------------                                              *
  2163*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2164*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2165*  ORIGINAL AMOUNT                                               *
  2166*  ALTERNATE BENEFIT (BALLON)                                    *
  2167*  A.P.R. - NET PAY ONLY                                         *
  2168*  METHOD
  2169*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2170*  COMPANY I.D.                                                  *
  2171*  BENEFIT TYPE                                                  *
  2172*                                                                *
  2173*  RETURNED FROM ELRAMT                                          *
  2174*  --------------------                                          *
  2175*  REMAINING AMOUNT 1 - CURRENT                                  *
  2176*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2177*  REMAINING AMOUNT FACTOR
  2178*----------------------------------------------------------------*
  2179*  PASSED TO ELRESV                                              *
  2180*  -----------------                                             *
  2181*  CERTIFICATE EFFECTIVE DATE                                    *
  2182*  VALUATION DATE                                                *
  2183*  PAID THRU DATE                                                *
  2184*  BENEFIT                                                       *
  2185*  INCURRED DATE                                                 *
  2186*  REPORTED DATE                                                 *
  2187*  ISSUE AGE                                                     *
  2188*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  44
* EL130.cbl
  2189*  CDT PERCENT                                                   *
  2190*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2191* *CLAIM TYPE (LIFE, A/H)                                        *
  2192* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2193* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2194*                                                                *
  2195*  RETURNED FROM ELRESV                                          *
  2196*  --------------------                                          *
  2197*  CDT TABLE USED                                                *
  2198*  CDT FACTOR USED                                               *
  2199*  PAY TO CURRENT RESERVE                                        *
  2200*  I.B.N.R. - A/H ONLY                                           *
  2201*  FUTURE (ACCRUED) AH ONLY                                      *
  2202*----------------------------------------------------------------*
  2203*  PASSED TO ELRATE                                              *
  2204*  ----------------                                              *
  2205*  CERT ISSUE DATE                                               *
  2206*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2207*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2208*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2209*  STATE CODE (CLIENT DEFINED)                                   *
  2210*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2211*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2212*  DEVIATION CODE                                                *
  2213*  ISSUE AGE                                                     *
  2214*  ORIGINAL BENEFIT AMOUNT                                       *
  2215*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2216*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2217*  BENEFIT KIND (LIFE OR A/H)                                    *
  2218*  A.P.R.                                                        *
  2219*  METHOD
  2220*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2221*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2222*  COMPANY I.D. (3 CHARACTER)                                    *
  2223*  BENEFIT CODE                                                  *
  2224*  BENEFIT OVERRIDE CODE                                         *
  2225*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2226*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2227*  JOINT INDICATOR (CSL ONLY)                                    *
  2228*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2229*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2230*                                                                *
  2231*  RETURNED FROM ELRATE                                          *
  2232*  --------------------                                          *
  2233*  CALCULATED PREMIUM                                            *
  2234*  PREMIUM RATE                                                  *
  2235*  MORTALITY CODE                                                *
  2236*  MAX ATTAINED AGE                                              *
  2237*  MAX AGE                                                       *
  2238*  MAX TERM                                                      *
  2239*  MAX MONTHLY BENEFIT                                           *
  2240*  MAX TOTAL BENIFIT                                             *
  2241*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2242*----------------------------------------------------------------*
  2243*  PASSED TO ELRFND                                              *
  2244*  ----------------                                              *
  2245*  CERT ISSUE DATE                                               *
  2246*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  45
* EL130.cbl
  2247*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2248*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2249*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2250*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2251*  STATE CODE (CLIENT DEFINED)                                   *
  2252*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2253*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2254*  DEVIATION CODE                                                *
  2255*  ISSUE AGE                                                     *
  2256*  ORIGINAL BENEFIT AMOUNT                                       *
  2257*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2258*  PROCESS TYPE (CANCEL)                                         *
  2259*  BENEFIT KIND (LIFE OR A/H)                                    *
  2260*  A.P.R.                                                        *
  2261*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2262*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2263*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2264*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2265*  COMPANY I.D. (3 CHARACTER)                                    *
  2266*  BENEFIT CODE                                                  *
  2267*  BENEFIT OVERRIDE CODE                                         *
  2268*                                                                *
  2269*  RETURNED FROM ELRFND                                          *
  2270*  --------------------                                          *
  2271*  CALCULATED REFUND                                             *
  2272*----------------------------------------------------------------*
  2273*  PASSED TO ELEARN                                              *
  2274*  ----------------                                              *
  2275*  CERT ISSUE DATE                                               *
  2276*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2277*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2278*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2279*  STATE CODE (CLIENT DEFINED)                                   *
  2280*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2281*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2282*  DEVIATION CODE                                                *
  2283*  ISSUE AGE                                                     *
  2284*  ORIGINAL BENEFIT AMOUNT                                       *
  2285*  BENEFIT KIND (LIFE OR A/H)                                    *
  2286*  A.P.R.                                                        *
  2287*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2288*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2289*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2290*  COMPANY I.D. (3 CHARACTER)                                    *
  2291*  BENEFIT CODE                                                  *
  2292*  BENEFIT OVERRIDE CODE                                         *
  2293*                                                                *
  2294*  RETURNED FROM ELEARN                                          *
  2295*  --------------------                                          *
  2296*  INDICATED  EARNINGS                                           *
  2297*----------------------------------------------------------------*
  2298*                 LENGTH = 450                                   *
  2299*                                                                *
  2300******************************************************************
  2301******************************************************************
  2302*                   C H A N G E   L O G
  2303*
  2304* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  46
* EL130.cbl
  2305*-----------------------------------------------------------------
  2306*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2307* EFFECTIVE    NUMBER
  2308*-----------------------------------------------------------------
  2309* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2310* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2311* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2312* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2313* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2314* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2315* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2316* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2317* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2318******************************************************************
  2319
  2320 01  CALCULATION-PASS-AREA.
  2321     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2322                                     COMP.
  2323
  2324     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2325       88  NO-CP-ERROR                             VALUE ZERO.
  2326       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2327                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2328       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2329       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2330       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2331       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2332       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2333       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2334       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2335       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2336       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2337       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2338       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2339       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2340       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2341       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2342       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2343       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2344       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2345
  2346     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2347       88  NO-CP-ERROR-2                           VALUE ZERO.
  2348***********************  INPUT AREAS ****************************
  2349
  2350     12  CP-CALCULATION-AREA.
  2351         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2352         16  CP-CERT-EFF-DT        PIC XX.
  2353         16  CP-VALUATION-DT       PIC XX.
  2354         16  CP-PAID-THRU-DT       PIC XX.
  2355         16  CP-BENEFIT-TYPE       PIC X.
  2356           88  CP-AH                               VALUE 'A' 'D'
  2357                                                   'I' 'U'.
  2358           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2359           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2360         16  CP-INCURRED-DT        PIC XX.
  2361         16  CP-REPORTED-DT        PIC XX.
  2362         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  47
* EL130.cbl
  2363         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2364         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2365                                     COMP-3.
  2366         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2367                                     COMP-3.
  2368         16  CP-CDT-METHOD         PIC X.
  2369           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2370           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2371           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2372         16  CP-CLAIM-TYPE         PIC X.
  2373           88  CP-AH-CLAIM                         VALUE 'A'.
  2374           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2375         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2376                                     COMP-3.
  2377         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2378                                     COMP-3.
  2379         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2380                                     COMP-3.
  2381         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2382                                     COMP-3.
  2383         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2384                                     COMP-3.
  2385         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2386                                     COMP-3.
  2387         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2388                                     COMP-3.
  2389         16  CP-REM-TERM-METHOD    PIC X.
  2390           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2391           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2392           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2393           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2394           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2395           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2396           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2397         16  CP-EARNING-METHOD     PIC X.
  2398           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2399           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2400           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2401           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2402           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2403           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2404           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2405           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2406           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2407           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2408           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2409           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2410           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2411           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2412         16  CP-PROCESS-TYPE       PIC X.
  2413           88  CP-CLAIM                            VALUE '1'.
  2414           88  CP-CANCEL                           VALUE '2'.
  2415           88  CP-ISSUE                            VALUE '3'.
  2416         16  CP-SPECIAL-CALC-CD    PIC X.
  2417           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2418           88  CP-1-MTH-INTEREST               VALUE ' '.
  2419           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2420           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  48
* EL130.cbl
  2421           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2422           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2423           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2424           88  CP-FARM-PLAN                    VALUE 'F'.
  2425           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2426           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2427           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2428           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2429           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2430           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2431           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2432           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2433           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2434           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2435                                                     'W' 'X'.
  2436           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2437           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2438           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2439           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2440           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2441           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2442           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2443           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2444           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2445           88  CP-CSL-METH-1                   VALUE '5'.
  2446           88  CP-CSL-METH-2                   VALUE '6'.
  2447           88  CP-CSL-METH-3                   VALUE '7'.
  2448           88  CP-CSL-METH-4                   VALUE '8'.
  2449
  2450         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2451                                     COMP-3.
  2452         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2453         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2454         16  CP-STATE              PIC XX          VALUE SPACE.
  2455         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2456         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2457           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2458               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2459         16  CP-R78-OPTION         PIC X.
  2460           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2461           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2462
  2463         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2464         16  CP-IBNR-RESERVE-SW    PIC X.
  2465         16  CP-CLAIM-STATUS       PIC X.
  2466         16  CP-RATE-FILE          PIC X.
  2467         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2468                                     COMP-3.
  2469
  2470         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2471         16  CP-AH-OVERRIDE-CODE   PIC X.
  2472
  2473         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2474                                     COMP-3.
  2475         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2476                                   PIC S9(5)V99 COMP-3.
  2477         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2478                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  49
* EL130.cbl
  2479         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2480                                     COMP-3.
  2481         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2482                                     COMP-3.
  2483         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2484                                  PIC S9(7)V99 COMP-3.
  2485
  2486         16  CP-PAID-FROM-DATE     PIC X(02).
  2487         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2488         16  CP-EXT-DAYS-CALC      PIC X.
  2489           88  CP-EXT-NO-CHG                   VALUE ' '.
  2490           88  CP-EXT-CHG-LF                   VALUE '1'.
  2491           88  CP-EXT-CHG-AH                   VALUE '2'.
  2492           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2493         16  CP-DOMICILE-STATE     PIC XX.
  2494         16  CP-CARRIER            PIC X.
  2495         16  CP-REIN-FLAG          PIC X.
  2496         16  CP-REM-TRM-CALC-OPTION PIC X.
  2497           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2498                      '2' '3' '4' '5'.
  2499           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2500           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2501           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2502           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2503           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2504           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2505           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2506           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2507         16  CP-SIG-SWITCH         PIC X.
  2508         16  CP-RATING-METHOD      PIC X.
  2509           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2510           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2511           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2512           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2513           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2514           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2515           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2516           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2517           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2518         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2519                                     COMP-3.
  2520         16  CP-BEN-CATEGORY       PIC X.
  2521         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2522         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2523                                   PIC S99V9(5) COMP-3.
  2524         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2525         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2526                                   PIC S99V9(5) COMP-3.
  2527         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2528         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2529         16  CP-EXPIRE-DT          PIC XX.
  2530         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2531         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2532         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2533         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2534         16  CP-DDF-SPEC-CALC      PIC X.
  2535             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2536             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  50
* EL130.cbl
  2537         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2538         16  CP-CANCEL-REASON      PIC X.
  2539         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2540         16  CP-PMT-MODE           PIC X.
  2541         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2542         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2543         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2544         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2545         16  FILLER                PIC X.
  2546
  2547***************    OUTPUT FROM ELRESV   ************************
  2548
  2549         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2550
  2551         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2552                                     COMP-3.
  2553         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2554                                     COMP-3.
  2555         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2556                                     COMP-3.
  2557         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2558                                     COMP-3.
  2559         16  FILLER                PIC X(09).
  2560***************    OUTPUT FROM ELRTRM   *************************
  2561
  2562         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2563                                     COMP-3.
  2564         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2565                                     COMP-3.
  2566         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2567                                     COMP-3.
  2568         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2569                                     COMP-3.
  2570         16  FILLER                PIC X(12).
  2571
  2572***************    OUTPUT FROM ELRAMT   *************************
  2573
  2574         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2575                                     COMP-3.
  2576         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2577                                     COMP-3.
  2578         16  FILLER                PIC X(12).
  2579
  2580***************    OUTPUT FROM ELRATE   *************************
  2581
  2582         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2583                                     COMP-3.
  2584         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2585                                     COMP-3.
  2586         16  CP-MORTALITY-CODE     PIC X(4).
  2587         16  CP-RATE-EDIT-FLAG     PIC X.
  2588             88  CP-RATES-NEED-APR                  VALUE '1'.
  2589         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2590                                     COMP-3.
  2591         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2592         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2593         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2594                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  51
* EL130.cbl
  2595         16  FILLER                PIC X(07).
  2596
  2597***************    OUTPUT FROM ELRFND   *************************
  2598
  2599         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2600                                     COMP-3.
  2601         16  CP-REFUND-TYPE-USED   PIC X.
  2602           88  CP-R-AS-R78                         VALUE '1'.
  2603           88  CP-R-AS-PRORATA                     VALUE '2'.
  2604           88  CP-R-AS-CALIF                       VALUE '3'.
  2605           88  CP-R-AS-TEXAS                       VALUE '4'.
  2606           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2607           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2608           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2609           88  CP-R-AS-MEAN                        VALUE '8'.
  2610           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2611           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2612           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2613           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2614           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2615           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2616         16  FILLER                PIC X(12).
  2617
  2618***************    OUTPUT FROM ELEARN   *************************
  2619
  2620         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2621                                     COMP-3.
  2622         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2623                                     COMP-3.
  2624         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2625                                     COMP-3.
  2626         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2627                                     COMP-3.
  2628         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2629                                     COMP-3.
  2630         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2631                                     COMP-3.
  2632         16  CP-EARNING-TYPE-USED  PIC X.
  2633           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2634           88  CP-E-AS-R78                         VALUE '1'.
  2635           88  CP-E-AS-PRORATA                     VALUE '2'.
  2636           88  CP-E-AS-TEXAS                       VALUE '4'.
  2637           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2638           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2639           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2640           88  CP-E-AS-MEAN                        VALUE '8'.
  2641           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2642         16  FILLER                PIC X(12).
  2643
  2644***************    OUTPUT FROM ELPMNT   *************************
  2645
  2646         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2647                                     COMP-3.
  2648         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2649                                     COMP-3.
  2650         16  FILLER                PIC X(12).
  2651
  2652***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  52
* EL130.cbl
  2653         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2654                                     COMP-3.
  2655         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2656                                     COMP-3.
  2657         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2658                                     COMP-3.
  2659         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2660                                     COMP-3.
  2661         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2662                                     COMP-3.
  2663         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2664                                     COMP-3.
  2665         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2666             88  OPEN-RATE-FILE                   VALUE 'O'.
  2667             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2668             88  IO-ERROR                         VALUE 'E'.
  2669
  2670         16  CP-FIRST-PAY-DATE     PIC XX.
  2671
  2672         16  CP-JOINT-INDICATOR    PIC X.
  2673
  2674         16  CP-RESERVE-REMAINING-TERM
  2675                                   PIC S9(4)V9    VALUE ZERO
  2676                                     COMP-3.
  2677
  2678         16  CP-INSURED-BIRTH-DT   PIC XX.
  2679
  2680         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2681                                     COMP-3.
  2682
  2683         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2684                                     COMP-3.
  2685
  2686         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2687                                     COMP-3.
  2688
  2689         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2690                                     COMP-3.
  2691
  2692         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2693                                     COMP-3.
  2694
  2695         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2696                                     COMP-3.
  2697
  2698         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2699                                     COMP-3.
  2700
  2701         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2702             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2703
  2704         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2705                                     COMP-3.
  2706         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2707                                     COMP-3.
  2708         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2709         16  FILLER                PIC X(15).
  2710******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  53
* EL130.cbl
  2712*    COPY ELCLOGOF.
  2713******************************************************************
  2714*                                                                *
  2715*                                                                *
  2716*                            ELCLOGOF.                           *
  2717*                            VMOD=2.001                          *
  2718*                                                                *
  2719*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2720*                                                                *
  2721******************************************************************
  2722 01  CLASIC-LOGOFF.
  2723     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2724     12  LOGOFF-TEXT.
  2725         16  FILLER          PIC X(5)    VALUE SPACES.
  2726         16  LOGOFF-MSG.
  2727             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2728             20  FILLER      PIC X       VALUE SPACES.
  2729             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2730         16  FILLER          PIC X(80)
  2731           VALUE '* YOU ARE NOW LOGGED OFF'.
  2732         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2733         16  FILLER          PIC X       VALUE QUOTE.
  2734         16  LOGOFF-SYS-MSG  PIC X(17)
  2735           VALUE 'S CLAS-IC SYSTEM '.
  2736     12  TEXT-MESSAGES.
  2737         16  UNACCESS-MSG    PIC X(29)
  2738             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2739         16  PGMIDERR-MSG    PIC X(17)
  2740             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  54
* EL130.cbl
  2742*    COPY ELCATTR.
  2743******************************************************************
  2744*                                                                *
  2745*                            ELCATTR.                            *
  2746*                            VMOD=2.001                          *
  2747*                                                                *
  2748*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2749*                                                                *
  2750*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2751*                                                                *
  2752*                   POS 1   P=PROTECTED                          *
  2753*                           U=UNPROTECTED                        *
  2754*                           S=ASKIP                              *
  2755*                   POS 2   A=ALPHA/NUMERIC                      *
  2756*                           N=NUMERIC                            *
  2757*                   POS 3   N=NORMAL                             *
  2758*                           B=BRIGHT                             *
  2759*                           D=DARK                               *
  2760*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2761*                           OF=MODIFIED DATA TAG OFF             *
  2762*                                                                *
  2763*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2764******************************************************************
  2765 01  ATTRIBUTE-LIST.
  2766     12  AL-PABOF            PIC X       VALUE 'Y'.
  2767     12  AL-PABON            PIC X       VALUE 'Z'.
  2768     12  AL-PADOF            PIC X       VALUE '%'.
  2769     12  AL-PADON            PIC X       VALUE '_'.
  2770     12  AL-PANOF            PIC X       VALUE '-'.
  2771     12  AL-PANON            PIC X       VALUE '/'.
  2772     12  AL-SABOF            PIC X       VALUE '8'.
  2773     12  AL-SABON            PIC X       VALUE '9'.
  2774     12  AL-SADOF            PIC X       VALUE '@'.
  2775     12  AL-SADON            PIC X       VALUE QUOTE.
  2776     12  AL-SANOF            PIC X       VALUE '0'.
  2777     12  AL-SANON            PIC X       VALUE '1'.
  2778     12  AL-UABOF            PIC X       VALUE 'H'.
  2779     12  AL-UABON            PIC X       VALUE 'I'.
  2780     12  AL-UADOF            PIC X       VALUE '<'.
  2781     12  AL-UADON            PIC X       VALUE '('.
  2782     12  AL-UANOF            PIC X       VALUE ' '.
  2783     12  AL-UANON            PIC X       VALUE 'A'.
  2784     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2785     12  AL-UNBON            PIC X       VALUE 'R'.
  2786     12  AL-UNDOF            PIC X       VALUE '*'.
  2787     12  AL-UNDON            PIC X       VALUE ')'.
  2788     12  AL-UNNOF            PIC X       VALUE '&'.
  2789     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  55
* EL130.cbl
  2791*    COPY ELCEMIB.
  2792******************************************************************
  2793*                                                                *
  2794*                                                                *
  2795*                            ELCEMIB.                            *
  2796*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2797*                            VMOD=2.005                          *
  2798*                                                                *
  2799*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2800*                                                                *
  2801******************************************************************
  2802 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2803     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2804     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2805     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2806     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2807     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2808     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2809     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2810     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2811     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2812         88  EMI-NO-ERRORS                    VALUE '1'.
  2813         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2814         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2815     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2816         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2817     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2818         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2819         88  EMI-AREA1-FULL                   VALUE '2'.
  2820     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2821         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2822         88  EMI-AREA2-FULL                   VALUE '2'.
  2823     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2824         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2825         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2826         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2827         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2828         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2829     12  EMI-ERROR-LINES.
  2830         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2831         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2832         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2833         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2834             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2835                 24  EMI-ERR-NUM         PIC X(4).
  2836                 24  EMI-FILLER          PIC X.
  2837                 24  EMI-SEV             PIC X.
  2838                 24  FILLER              PIC X.
  2839             20  FILLER                  PIC X(02).
  2840     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2841         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2842             20  EMI-ERROR-NUMBER    PIC X(4).
  2843             20  EMI-FILL            PIC X.
  2844             20  EMI-SEVERITY        PIC X.
  2845             20  FILLER              PIC X.
  2846             20  EMI-ERROR-TEXT.
  2847                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2848                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  56
* EL130.cbl
  2849     12  EMI-SEVERITY-SAVE           PIC X.
  2850         88  EMI-NOTE                    VALUE 'N'.
  2851         88  EMI-WARNING                 VALUE 'W'.
  2852         88  EMI-FORCABLE                VALUE 'F'.
  2853         88  EMI-FATAL                   VALUE 'X'.
  2854     12  EMI-MESSAGE-FLAG            PIC X.
  2855         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2856         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2857     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2858     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2859         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2860         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2861         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2862     12  FILLER                      PIC X(137)  VALUE SPACES.
  2863     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2864     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2865     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2866     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  57
* EL130.cbl
  2868*    COPY ELCJPFX.
  2869******************************************************************
  2870*                                                                *
  2871*                                                                *
  2872*                            ELCJPFX.                            *
  2873*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2874*                            VMOD=2.002                          *
  2875*                                                                *
  2876*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2877*                                                                *
  2878*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2879*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2880*        ELCNTL - CONTROL FILE                                   *
  2881*        ELMSTR - CLAIM MASTERS                                  *
  2882*        ELTRLR - ACTIVITY TRAILERS                              *
  2883*        ELCHKQ - CHECK QUE                                      *
  2884******************************************************************
  2885 01  JOURNAL-RECORD.
  2886     12  JP-USER-ID                  PIC X(4).
  2887     12  JP-FILE-ID                  PIC X(8).
  2888     12  JP-PROGRAM-ID               PIC X(8).
  2889     12  JP-RECORD-TYPE              PIC X.
  2890         88 JP-ADD              VALUE 'A'.
  2891         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2892         88 JP-AFTER-CHANGE     VALUE 'C'.
  2893         88 JP-DELETE           VALUE 'D'.
  2894         88 JP-GENERIC-DELETE   VALUE 'G'.
  2895         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2896         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2897     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2898     12  JP-RECORD-AREA
  2899
  2900
  2901         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  58
* EL130.cbl
  2903*    COPY ELCAID.
  2904******************************************************************
  2905*                                                                *
  2906*                            ELCAID.                             *
  2907*                            VMOD=2.001                          *
  2908*                                                                *
  2909*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2910*                                                                *
  2911*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2912*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2913******************************************************************
  2914
  2915 01  DFHAID.
  2916   02  DFHNULL   PIC  X  VALUE  ' '.
  2917   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2918   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2919   02  DFHPEN    PIC  X  VALUE  '='.
  2920   02  DFHOPID   PIC  X  VALUE  'W'.
  2921   02  DFHPA1    PIC  X  VALUE  '%'.
  2922   02  DFHPA2    PIC  X  VALUE  '>'.
  2923   02  DFHPA3    PIC  X  VALUE  ','.
  2924   02  DFHPF1    PIC  X  VALUE  '1'.
  2925   02  DFHPF2    PIC  X  VALUE  '2'.
  2926   02  DFHPF3    PIC  X  VALUE  '3'.
  2927   02  DFHPF4    PIC  X  VALUE  '4'.
  2928   02  DFHPF5    PIC  X  VALUE  '5'.
  2929   02  DFHPF6    PIC  X  VALUE  '6'.
  2930   02  DFHPF7    PIC  X  VALUE  '7'.
  2931   02  DFHPF8    PIC  X  VALUE  '8'.
  2932   02  DFHPF9    PIC  X  VALUE  '9'.
  2933   02  DFHPF10   PIC  X  VALUE  ':'.
  2934   02  DFHPF11   PIC  X  VALUE  '#'.
  2935   02  DFHPF12   PIC  X  VALUE  '@'.
  2936   02  DFHPF13   PIC  X  VALUE  'A'.
  2937   02  DFHPF14   PIC  X  VALUE  'B'.
  2938   02  DFHPF15   PIC  X  VALUE  'C'.
  2939   02  DFHPF16   PIC  X  VALUE  'D'.
  2940   02  DFHPF17   PIC  X  VALUE  'E'.
  2941   02  DFHPF18   PIC  X  VALUE  'F'.
  2942   02  DFHPF19   PIC  X  VALUE  'G'.
  2943   02  DFHPF20   PIC  X  VALUE  'H'.
  2944   02  DFHPF21   PIC  X  VALUE  'I'.
  2945*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2946   02  DFHPF22   PIC  X  VALUE  '['.
  2947   02  DFHPF23   PIC  X  VALUE  '.'.
  2948   02  DFHPF24   PIC  X  VALUE  '<'.
  2949   02  DFHMSRE   PIC  X  VALUE  'X'.
  2950   02  DFHSTRF   PIC  X  VALUE  'h'.
  2951   02  DFHTRIG   PIC  X  VALUE  '"'.
  2952
  2953 01  FILLER    REDEFINES DFHAID.
  2954     12  FILLER              PIC X(8).
  2955     12  PF-VALUES           PIC X       OCCURS 12.
  2956
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  59
* EL130.cbl
  2958****************************************************************
  2959*
  2960* Copyright (c) 2007 by Clerity Solutions, Inc.
  2961* All rights reserved.
  2962*
  2963****************************************************************
  2964 01  DFHEIV.
  2965   02  DFHEIV0               PIC X(35).
  2966   02  DFHEIV1               PIC X(08).
  2967   02  DFHEIV2               PIC X(08).
  2968   02  DFHEIV3               PIC X(08).
  2969   02  DFHEIV4               PIC X(06).
  2970   02  DFHEIV5               PIC X(04).
  2971   02  DFHEIV6               PIC X(04).
  2972   02  DFHEIV7               PIC X(02).
  2973   02  DFHEIV8               PIC X(02).
  2974   02  DFHEIV9               PIC X(01).
  2975   02  DFHEIV10              PIC S9(7) COMP-3.
  2976   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2977   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2978   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2979   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2980   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2981   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2982   02  DFHEIV17              PIC X(04).
  2983   02  DFHEIV18              PIC X(04).
  2984   02  DFHEIV19              PIC X(04).
  2985   02  DFHEIV20              USAGE IS POINTER.
  2986   02  DFHEIV21              USAGE IS POINTER.
  2987   02  DFHEIV22              USAGE IS POINTER.
  2988   02  DFHEIV23              USAGE IS POINTER.
  2989   02  DFHEIV24              USAGE IS POINTER.
  2990   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2991   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2992   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2993   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2994   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2995   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2996   02  FILLER                PIC X(02).
  2997   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2998   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2999   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3000   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3001   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3002 LINKAGE  SECTION.
  3003*****************************************************************
  3004*                                                               *
  3005* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3006* All rights reserved.                                          *
  3007*                                                               *
  3008*****************************************************************
  3009 01  dfheiblk.
  3010     02  eibtime          pic s9(7) comp-3.
  3011     02  eibdate          pic s9(7) comp-3.
  3012     02  eibtrnid         pic x(4).
  3013     02  eibtaskn         pic s9(7) comp-3.
  3014     02  eibtrmid         pic x(4).
  3015     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  60
* EL130.cbl
  3016     02  eibcposn         pic s9(4) comp.
  3017     02  eibcalen         pic s9(4) comp.
  3018     02  eibaid           pic x(1).
  3019     02  eibfiller1       pic x(1).
  3020     02  eibfn            pic x(2).
  3021     02  eibfiller2       pic x(2).
  3022     02  eibrcode         pic x(6).
  3023     02  eibfiller3       pic x(2).
  3024     02  eibds            pic x(8).
  3025     02  eibreqid         pic x(8).
  3026     02  eibrsrce         pic x(8).
  3027     02  eibsync          pic x(1).
  3028     02  eibfree          pic x(1).
  3029     02  eibrecv          pic x(1).
  3030     02  eibsend          pic x(1).
  3031     02  eibatt           pic x(1).
  3032     02  eibeoc           pic x(1).
  3033     02  eibfmh           pic x(1).
  3034     02  eibcompl         pic x(1).
  3035     02  eibsig           pic x(1).
  3036     02  eibconf          pic x(1).
  3037     02  eiberr           pic x(1).
  3038     02  eibrldbk         pic x(1).
  3039     02  eiberrcd         pic x(4).
  3040     02  eibsynrb         pic x(1).
  3041     02  eibnodat         pic x(1).
  3042     02  eibfiller5       pic x(2).
  3043     02  eibresp          pic 9(09) comp.
  3044     02  eibresp2         pic 9(09) comp.
  3045     02  dfheigdj         pic s9(4) comp.
  3046     02  dfheigdk         pic s9(4) comp.
  3047
  3048 01  DFHCOMMAREA             PIC X(1024).
  3049
  3050*01 PARMLIST .
  3051*    02  FILLER              PIC S9(8)   COMP.
  3052*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3053*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3054*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3055*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3056*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3057*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3058*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3059*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3060*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  61
* EL130.cbl
  3062*    COPY ELCMSTR.
  3063******************************************************************
  3064*                                                                *
  3065*                            ELCMSTR.                            *
  3066*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3067*                            VMOD=2.012                          *
  3068*                                                                *
  3069*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3070*                                                                *
  3071*   FILE TYPE = VSAM,KSDS                                        *
  3072*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3073*                                                                *
  3074*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3075*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3076*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3077*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3078*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3079*                                                 RKP=75,LEN=21  *
  3080*                                                                *
  3081*   **** NOTE ****                                               *
  3082*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3083*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3084*                                                                *
  3085*   LOG = YES                                                    *
  3086*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3087******************************************************************
  3088*                   C H A N G E   L O G
  3089*
  3090* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3091*-----------------------------------------------------------------
  3092*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3093* EFFECTIVE    NUMBER
  3094*-----------------------------------------------------------------
  3095* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3096* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3097******************************************************************
  3098 01  CLAIM-MASTER.
  3099     12  CL-RECORD-ID                PIC XX.
  3100         88  VALID-CL-ID         VALUE 'CL'.
  3101
  3102     12  CL-CONTROL-PRIMARY.
  3103         16  CL-COMPANY-CD           PIC X.
  3104         16  CL-CARRIER              PIC X.
  3105         16  CL-CLAIM-NO             PIC X(7).
  3106         16  CL-CERT-NO.
  3107             20  CL-CERT-PRIME       PIC X(10).
  3108             20  CL-CERT-SFX         PIC X.
  3109
  3110     12  CL-CONTROL-BY-NAME.
  3111         16  CL-COMPANY-CD-A1        PIC X.
  3112         16  CL-INSURED-LAST-NAME    PIC X(15).
  3113         16  CL-INSURED-NAME.
  3114             20  CL-INSURED-1ST-NAME PIC X(12).
  3115             20  CL-INSURED-MID-INIT PIC X.
  3116
  3117     12  CL-CONTROL-BY-SSN.
  3118         16  CL-COMPANY-CD-A2        PIC X.
  3119         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  62
* EL130.cbl
  3120             20  CL-SSN-STATE        PIC XX.
  3121             20  CL-SSN-ACCOUNT      PIC X(6).
  3122             20  CL-SSN-LN3          PIC X(3).
  3123
  3124     12  CL-CONTROL-BY-CERT-NO.
  3125         16  CL-COMPANY-CD-A4        PIC X.
  3126         16  CL-CERT-NO-A4.
  3127             20  CL-CERT-A4-PRIME    PIC X(10).
  3128             20  CL-CERT-A4-SFX      PIC X.
  3129
  3130     12  CL-CONTROL-BY-CCN.
  3131         16  CL-COMPANY-CD-A5        PIC X.
  3132         16  CL-CCN-A5.
  3133             20  CL-CCN.
  3134                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3135                 24  CL-CCN-PRIME-A5 PIC X(12).
  3136             20  CL-CCN-FILLER-A5    PIC X(4).
  3137
  3138     12  CL-INSURED-PROFILE-DATA.
  3139         16  CL-INSURED-BIRTH-DT     PIC XX.
  3140         16  CL-INSURED-SEX-CD       PIC X.
  3141             88  INSURED-IS-MALE        VALUE 'M'.
  3142             88  INSURED-IS-FEMALE      VALUE 'F'.
  3143             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3144         16  CL-INSURED-OCC-CD       PIC X(6).
  3145         16  FILLER                  PIC X(5).
  3146
  3147     12  CL-PROCESSING-INFO.
  3148         16  CL-PROCESSOR-ID         PIC X(4).
  3149         16  CL-CLAIM-STATUS         PIC X.
  3150             88  CLAIM-IS-OPEN          VALUE 'O'.
  3151             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3152         16  CL-CLAIM-TYPE           PIC X.
  3153*            88  AH-CLAIM               VALUE 'A'.
  3154*            88  LIFE-CLAIM             VALUE 'L'.
  3155*            88  PROPERTY-CLAIM         VALUE 'P'.
  3156*            88  IUI-CLAIM              VALUE 'I'.
  3157*            88  GAP-CLAIM              VALUE 'G'.
  3158         16  CL-CLAIM-PREM-TYPE      PIC X.
  3159             88  SINGLE-PREMIUM         VALUE '1'.
  3160             88  O-B-COVERAGE           VALUE '2'.
  3161             88  OPEN-END-COVERAGE      VALUE '3'.
  3162         16  CL-INCURRED-DT          PIC XX.
  3163         16  CL-REPORTED-DT          PIC XX.
  3164         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3165         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3166         16  CL-LAST-PMT-DT          PIC XX.
  3167         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3168         16  CL-PAID-THRU-DT         PIC XX.
  3169         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3170         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3171         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3172         16  CL-PMT-CALC-METHOD      PIC X.
  3173             88  CL-360-DAY-YR          VALUE '1'.
  3174             88  CL-365-DAY-YR          VALUE '2'.
  3175             88  CL-FULL-MONTHS         VALUE '3'.
  3176         16  CL-CAUSE-CD             PIC X(6).
  3177
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  63
* EL130.cbl
  3178         16  CL-PRIME-CERT-NO.
  3179             20  CL-PRIME-CERT-PRIME PIC X(10).
  3180             20  CL-PRIME-CERT-SFX   PIC X.
  3181
  3182         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3183             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3184             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3185
  3186         16  CL-MICROFILM-NO         PIC X(10).
  3187         16  CL-PROG-FORM-TYPE       PIC X.
  3188         16  CL-LAST-ADD-ON-DT       PIC XX.
  3189
  3190         16  CL-LAST-REOPEN-DT       PIC XX.
  3191         16  CL-LAST-CLOSE-DT        PIC XX.
  3192         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3193             88  FINAL-PAID             VALUE '1'.
  3194             88  CLAIM-DENIED           VALUE '2'.
  3195             88  AUTO-CLOSE             VALUE '3'.
  3196             88  MANUAL-CLOSE           VALUE '4'.
  3197             88  BENEFITS-CHANGED       VALUE 'C'.
  3198             88  SETUP-ERRORS           VALUE 'E'.
  3199         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3200         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3201         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3202             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3203         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3204         16  FILLER                  PIC X.
  3205
  3206     12  CL-CERTIFICATE-DATA.
  3207         16  CL-CERT-ORIGIN          PIC X.
  3208             88  CERT-WAS-ONLINE        VALUE '1'.
  3209             88  CERT-WAS-CREATED       VALUE '2'.
  3210             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3211         16  CL-CERT-KEY-DATA.
  3212             20  CL-CERT-CARRIER     PIC X.
  3213             20  CL-CERT-GROUPING    PIC X(6).
  3214             20  CL-CERT-STATE       PIC XX.
  3215             20  CL-CERT-ACCOUNT.
  3216                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3217                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3218             20  CL-CERT-EFF-DT      PIC XX.
  3219
  3220     12  CL-STATUS-CONTROLS.
  3221         16  CL-PRIORITY-CD          PIC X.
  3222             88  CONFIDENTIAL-DATA      VALUE '8'.
  3223             88  HIGHEST-PRIORITY       VALUE '9'.
  3224         16  CL-SUPV-ATTN-CD         PIC X.
  3225             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3226             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3227         16  CL-PURGED-DT            PIC XX.
  3228         16  CL-RESTORED-DT          PIC XX.
  3229         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3230         16  CL-NEXT-RESEND-DT       PIC XX.
  3231         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3232         16  FILLER                  PIC XX.
  3233         16  CL-LAST-MAINT-DT        PIC XX.
  3234         16  CL-LAST-MAINT-USER      PIC X(4).
  3235         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  64
* EL130.cbl
  3236         16  CL-LAST-MAINT-TYPE      PIC X.
  3237             88  CLAIM-SET-UP           VALUE ' '.
  3238             88  PAYMENT-MADE           VALUE '1'.
  3239             88  LETTER-SENT            VALUE '2'.
  3240             88  MASTER-WAS-ALTERED     VALUE '3'.
  3241             88  MASTER-WAS-RESTORED    VALUE '4'.
  3242             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3243             88  FILE-CONVERTED         VALUE '6'.
  3244             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3245             88  ERROR-CORRECTION       VALUE 'E'.
  3246         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3247         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3248         16  CL-BENEFICIARY          PIC X(10).
  3249         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3250         16  CL-DENIAL-TYPE          PIC X.
  3251             88  CL-TYPE-DENIAL          VALUE '1'.
  3252             88  CL-TYPE-RESCISSION      VALUE '2'.
  3253             88  CL-TYPE-REFORMATION     VALUE '3'.
  3254             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3255             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3256         16  FILLER                  PIC X(5).
  3257
  3258     12  CL-TRAILER-CONTROLS.
  3259         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3260             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3261             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3262             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3263         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3264         16  FILLER                  PIC XX.
  3265         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3266         16  CL-ADDRESS-TRAILER-CNT.
  3267             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3268                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3269             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3270                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3271             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3272                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3273             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3274                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3275             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3276                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3277             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3278                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3279             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3280                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3281
  3282     12  CL-CV-REFERENCE-NO.
  3283         16  CL-CV-REFNO-PRIME       PIC X(18).
  3284         16  CL-CV-REFNO-SFX         PIC XX.
  3285
  3286     12  CL-FILE-LOCATION            PIC X(4).
  3287
  3288     12  CL-PROCESS-ERRORS.
  3289         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3290             88  NO-FATAL-ERRORS        VALUE ZERO.
  3291         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3292             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3293
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  65
* EL130.cbl
  3294     12  CL-PRODUCT-CD               PIC X.
  3295
  3296     12  CL-CURRENT-KEY-DATA.
  3297         16  CL-CURRENT-CARRIER      PIC X.
  3298         16  CL-CURRENT-GROUPING     PIC X(6).
  3299         16  CL-CURRENT-STATE        PIC XX.
  3300         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3301
  3302     12  CL-ASSOCIATES               PIC X.
  3303         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3304         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3305         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3306         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3307
  3308     12  CL-ACTIVITY-CODE            PIC 99.
  3309     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3310     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3311
  3312     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3313     12  CL-LAG-REPORT-CODE          PIC 9.
  3314     12  CL-LOAN-TYPE                PIC XX.
  3315     12  CL-LEGAL-STATE              PIC XX.
  3316
  3317*    12  FILLER                      PIC X(5).
  3318     12  CL-YESNOSW                  PIC X.
  3319     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  66
* EL130.cbl
  3321*    COPY ELCCNTL.
  3322******************************************************************
  3323*                                                                *
  3324*                                                                *
  3325*                            ELCCNTL.                            *
  3326*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3327*                            VMOD=2.059                          *
  3328*                                                                *
  3329*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3330*                                                                *
  3331*   FILE TYPE = VSAM,KSDS                                        *
  3332*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3333*                                                                *
  3334*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3335*       ALTERNATE INDEX = NONE                                   *
  3336*                                                                *
  3337*   LOG = YES                                                    *
  3338*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3339******************************************************************
  3340*                   C H A N G E   L O G
  3341*
  3342* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3343*-----------------------------------------------------------------
  3344*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3345* EFFECTIVE    NUMBER
  3346*-----------------------------------------------------------------
  3347* 082503                   PEMA  ADD BENEFIT GROUP
  3348* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3349* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3350* 092705    2005050300006  PEMA  ADD SPP LEASES
  3351* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3352* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3353* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3354* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3355* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3356* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3357******************************************************************
  3358*
  3359 01  CONTROL-FILE.
  3360     12  CF-RECORD-ID                       PIC XX.
  3361         88  VALID-CF-ID                        VALUE 'CF'.
  3362
  3363     12  CF-CONTROL-PRIMARY.
  3364         16  CF-COMPANY-ID                  PIC XXX.
  3365         16  CF-RECORD-TYPE                 PIC X.
  3366             88  CF-COMPANY-MASTER              VALUE '1'.
  3367             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3368             88  CF-STATE-MASTER                VALUE '3'.
  3369             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3370             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3371             88  CF-CARRIER-MASTER              VALUE '6'.
  3372             88  CF-MORTALITY-MASTER            VALUE '7'.
  3373             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3374             88  CF-TERMINAL-MASTER             VALUE '9'.
  3375             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3376             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3377             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3378             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  67
* EL130.cbl
  3379             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3380             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3381             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3382             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3383             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3384         16  CF-ACCESS-CD-GENL              PIC X(4).
  3385         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3386             20  CF-PROCESSOR               PIC X(4).
  3387         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3388             20  CF-STATE-CODE              PIC XX.
  3389             20  FILLER                     PIC XX.
  3390         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3391             20  FILLER                     PIC XX.
  3392             20  CF-HI-BEN-IN-REC           PIC XX.
  3393         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3394             20  FILLER                     PIC XXX.
  3395             20  CF-CARRIER-CNTL            PIC X.
  3396         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3397             20  FILLER                     PIC XX.
  3398             20  CF-HI-TYPE-IN-REC          PIC 99.
  3399         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3400             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3401                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3402             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3403             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3404         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3405             20  FILLER                     PIC X.
  3406             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3407         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3408             20  FILLER                     PIC XX.
  3409             20  CF-MORTGAGE-PLAN           PIC XX.
  3410         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3411
  3412     12  CF-LAST-MAINT-DT                   PIC XX.
  3413     12  CF-LAST-MAINT-BY                   PIC X(4).
  3414     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3415
  3416     12  CF-RECORD-BODY                     PIC X(728).
  3417
  3418
  3419****************************************************************
  3420*             COMPANY MASTER RECORD                            *
  3421****************************************************************
  3422
  3423     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3424         16  CF-COMPANY-ADDRESS.
  3425             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3426             20  CF-CL-IN-CARE-OF           PIC X(30).
  3427             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3428             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3429             20  CF-CL-CITY-STATE           PIC X(30).
  3430             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3431             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3432         16  CF-COMPANY-CD                  PIC X.
  3433         16  CF-COMPANY-PASSWORD            PIC X(8).
  3434         16  CF-SECURITY-OPTION             PIC X.
  3435             88  ALL-SECURITY                   VALUE '1'.
  3436             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  68
* EL130.cbl
  3437             88  PROCESSOR-VERIFY               VALUE '3'.
  3438             88  NO-SECURITY                    VALUE '4'.
  3439             88  ALL-BUT-TERM                   VALUE '5'.
  3440         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3441             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3442         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3443             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3444         16  CF-INFORCE-LOCATION            PIC X.
  3445             88  CERTS-ARE-ONLINE               VALUE '1'.
  3446             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3447             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3448         16  CF-LOWER-CASE-LETTERS          PIC X.
  3449         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3450             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3451             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3452             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3453             88  CF-ACCNT-CNTL                  VALUE '3'.
  3454             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3455
  3456         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3457         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3458
  3459         16  CF-LGX-CREDIT-USER             PIC X.
  3460             88  CO-IS-NOT-USER                 VALUE 'N'.
  3461             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3462
  3463         16 CF-CREDIT-CALC-CODES.
  3464             20  CF-CR-REM-TERM-CALC PIC X.
  3465               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3466               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3467               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3468               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3469               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3470               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3471               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3472             20  CF-CR-R78-METHOD           PIC X.
  3473               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3474               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3475
  3476         16  CF-CLAIM-CONTROL-COUNTS.
  3477             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3478                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3479
  3480             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3481                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3482
  3483             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3484                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3485
  3486             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3487                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3488
  3489         16  CF-CURRENT-MONTH-END           PIC XX.
  3490
  3491         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3492             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3493             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3494             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  69
* EL130.cbl
  3495             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3496                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3497                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3498             20  CF-CO-PREM-REJECT-SW       PIC X.
  3499                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3500                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3501             20  CF-CO-REF-REJECT-SW        PIC X.
  3502                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3503                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3504
  3505         16  CF-CO-REPORTING-DT             PIC XX.
  3506         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3507         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3508           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3509           88  CF-CO-MONTH-END                  VALUE '1'.
  3510
  3511         16  CF-LGX-CLAIM-USER              PIC X.
  3512             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3513             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3514
  3515         16  CF-CREDIT-EDIT-CONTROLS.
  3516             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3517             20  CF-MIN-AGE                 PIC 99.
  3518             20  CF-DEFAULT-AGE             PIC 99.
  3519             20  CF-MIN-TERM                PIC S999      COMP-3.
  3520             20  CF-MAX-TERM                PIC S999      COMP-3.
  3521             20  CF-DEFAULT-SEX             PIC X.
  3522             20  CF-JOINT-AGE-INPUT         PIC X.
  3523                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3524             20  CF-BIRTH-DATE-INPUT        PIC X.
  3525                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3526             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3527                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3528                 88  CF-ZERO-CARRIER            VALUE '1'.
  3529                 88  CF-ZERO-GROUPING           VALUE '2'.
  3530                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3531             20  CF-EDIT-SW                 PIC X.
  3532                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3533             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3534             20  CF-CR-PR-METHOD            PIC X.
  3535               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3536               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3537             20  FILLER                     PIC X.
  3538
  3539         16  CF-CREDIT-MISC-CONTROLS.
  3540             20  CF-REIN-TABLE-SW           PIC X.
  3541                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3542             20  CF-COMP-TABLE-SW           PIC X.
  3543                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3544             20  CF-EXPERIENCE-RETENTION-AGE
  3545                                            PIC S9        COMP-3.
  3546             20  CF-CONVERSION-DT           PIC XX.
  3547             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3548             20  CF-RUN-FREQUENCY-SW        PIC X.
  3549                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3550                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3551
  3552             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  70
* EL130.cbl
  3553                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3554                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3555                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3556                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3557                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3558                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3559
  3560                 24  CF-CR-CHECK-COUNT       REDEFINES
  3561                     CF-CR-CHECK-COUNTER      PIC X(4).
  3562
  3563                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3564                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3565
  3566                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3567                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3568                 24  CF-MAIL-PROCESSING       PIC X.
  3569                     88  MAIL-PROCESSING          VALUE 'Y'.
  3570
  3571         16  CF-MISC-SYSTEM-CONTROL.
  3572             20  CF-SYSTEM-C                 PIC X.
  3573                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3574             20  CF-SYSTEM-D                 PIC X.
  3575                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3576             20  CF-SOC-SEC-NO-SW            PIC X.
  3577                 88  SOC-SEC-NO-USED             VALUE '1'.
  3578             20  CF-MEMBER-NO-SW             PIC X.
  3579                 88  MEMBER-NO-USED              VALUE '1'.
  3580             20  CF-TAX-ID-NUMBER            PIC X(11).
  3581             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3582             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3583                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3584                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3585                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3586                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3587             20  CF-SYSTEM-E                 PIC X.
  3588                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3589
  3590         16  CF-LGX-LIFE-USER               PIC X.
  3591             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3592             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3593
  3594         16  CF-CR-MONTH-END-DT             PIC XX.
  3595
  3596         16  CF-FILE-MAINT-DATES.
  3597             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3598                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3599             20  CF-LAST-BATCH       REDEFINES
  3600                 CF-LAST-BATCH-NO               PIC X(4).
  3601             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3602             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3603             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3604             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3605             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3606             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3607             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3608             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3609             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3610             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  71
* EL130.cbl
  3611
  3612         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3613         16  FILLER                         PIC X.
  3614
  3615         16  CF-ALT-MORT-CODE               PIC X(4).
  3616         16  CF-MEMBER-CAPTION              PIC X(10).
  3617
  3618         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3619             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3620             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3621             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3622             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3623             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3624
  3625         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3626
  3627         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3628         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3629         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3630         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3631
  3632         16  CF-AH-OVERRIDE-L1              PIC X.
  3633         16  CF-AH-OVERRIDE-L2              PIC XX.
  3634         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3635         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3636
  3637         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3638         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3639
  3640         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3641         16  CF-AR-LAST-EL860-DT            PIC XX.
  3642         16  CF-MP-MONTH-END-DT             PIC XX.
  3643
  3644         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3645         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3646             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3647
  3648         16  CF-AR-MONTH-END-DT             PIC XX.
  3649
  3650         16  CF-CRDTCRD-USER                PIC X.
  3651             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3652             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3653
  3654         16  CF-CC-MONTH-END-DT             PIC XX.
  3655
  3656         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3657
  3658         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3659             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3660             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3661             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3662         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3663         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3664         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3665         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3666             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3667             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3668         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  72
* EL130.cbl
  3669         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3670         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3671             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3672         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3673
  3674         16  CF-CL-ZIP-CODE.
  3675             20  CF-CL-ZIP-PRIME.
  3676                 24  CF-CL-ZIP-1ST          PIC X.
  3677                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3678                 24  FILLER                 PIC X(4).
  3679             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3680         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3681             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3682             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3683             20  FILLER                     PIC XXX.
  3684
  3685         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3686         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3687         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3688         16  CF-CO-OPTION-START-DATE        PIC XX.
  3689         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3690           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3691                                                      '3' '4'.
  3692           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3693           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3694           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3695           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3696           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3697           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3698
  3699         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3700
  3701         16  CF-PAYMENT-APPROVAL-LEVELS.
  3702             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3703             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3704             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3705             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3706             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3707             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3708
  3709         16  CF-END-USER-REPORTING-USER     PIC X.
  3710             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3711             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3712
  3713         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3714             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3715             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3716
  3717         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3718
  3719         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3720         16  FILLER                         PIC X.
  3721
  3722         16  CF-CREDIT-ARCHIVE-CNTL.
  3723             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3724             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3725             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3726
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  73
* EL130.cbl
  3727         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3728
  3729         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3730             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3731             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3732
  3733         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3734             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3735             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3736
  3737         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3738
  3739         16  CF-CO-ACH-ID-CODE              PIC  X.
  3740             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3741             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3742             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3743         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3744         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3745         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3746         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3747         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3748         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3749         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3750         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3751         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3752                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3753         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3754                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3755
  3756         16  CF-CO-OVER-SHORT.
  3757             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3758             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3759
  3760*         16  FILLER                         PIC X(102).
  3761         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3762             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3763             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3764
  3765         16  CF-AH-APPROVAL-DAYS.
  3766             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3767             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3768             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3769             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3770
  3771         16  FILLER                         PIC X(82).
  3772****************************************************************
  3773*             PROCESSOR/USER RECORD                            *
  3774****************************************************************
  3775
  3776     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3777         16  CF-PROCESSOR-NAME              PIC X(30).
  3778         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3779         16  CF-PROCESSOR-TITLE             PIC X(26).
  3780         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3781                 88  MESSAGE-YES                VALUE 'Y'.
  3782                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3783
  3784*****************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  74
* EL130.cbl
  3785****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3786****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3787****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3788****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3789*****************************************************
  3790
  3791         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3792             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3793             20  CF-APPLICATION-FORCE       PIC X.
  3794             20  CF-INDIVIDUAL-APP.
  3795                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3796                     28  CF-BROWSE-APP      PIC X.
  3797                     28  CF-UPDATE-APP      PIC X.
  3798
  3799         16  CF-CURRENT-TERM-ON             PIC X(4).
  3800         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3801             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3802             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3803             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3804             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3805             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3806             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3807             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3808         16  CF-PROCESSOR-CARRIER           PIC X.
  3809             88  NO-CARRIER-SECURITY            VALUE ' '.
  3810         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3811             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3812         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3813             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3814         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3815             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3816
  3817         16  CF-PROC-SYS-ACCESS-SW.
  3818             20  CF-PROC-CREDIT-CLAIMS-SW.
  3819                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3820                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3821                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3822                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3823             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3824                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3825                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3826             20  CF-PROC-LIFE-GNRLDGR-SW.
  3827                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3828                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3829                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3830                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3831             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3832                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3833                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3834         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3835             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3836             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3837         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3838
  3839         16  CF-APPROVAL-LEVEL                  PIC X.
  3840             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3841             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3842             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  75
* EL130.cbl
  3843             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3844
  3845         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3846
  3847         16  CF-LANGUAGE-TYPE                   PIC X.
  3848             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3849             88  CF-LANG-IS-FR                      VALUE 'F'.
  3850
  3851         16  CF-CSR-IND                         PIC X.
  3852         16  FILLER                             PIC X(239).
  3853
  3854****************************************************************
  3855*             PROCESSOR/REMINDERS RECORD                       *
  3856****************************************************************
  3857
  3858     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3859         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3860             20  CF-START-REMIND-DT         PIC XX.
  3861             20  CF-END-REMIND-DT           PIC XX.
  3862             20  CF-REMINDER-TEXT           PIC X(50).
  3863         16  FILLER                         PIC X(296).
  3864
  3865
  3866****************************************************************
  3867*             STATE MASTER RECORD                              *
  3868****************************************************************
  3869
  3870     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3871         16  CF-STATE-ABBREVIATION          PIC XX.
  3872         16  CF-STATE-NAME                  PIC X(25).
  3873         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3874         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3875             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3876             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3877             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3878             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3879                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3880                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3881             20  CF-ST-PREM-REJECT-SW       PIC X.
  3882                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3883                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3884             20  CF-ST-REF-REJECT-SW        PIC X.
  3885                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3886                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3887         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3888         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3889         16  CF-ST-REFUND-RULES.
  3890             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3891             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3892             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3893         16  CF-ST-FST-PMT-EXTENSION.
  3894             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3895             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3896                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3897                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3898                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3899                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3900         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  76
* EL130.cbl
  3901             20  CF-ST-CALL-UNEARNED        PIC X.
  3902             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3903             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3904         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3905             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3906             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3907         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3908         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3909         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3910         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3911         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3912         16  FILLER                         PIC X.
  3913         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3914             20  CF-ST-BENEFIT-CD           PIC XX.
  3915             20  CF-ST-BENEFIT-KIND         PIC X.
  3916                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3917                 88  CF-ST-AH-KIND              VALUE 'A'.
  3918             20  CF-ST-REM-TERM-CALC        PIC X.
  3919                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3920                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3921                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3922                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3923                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3924                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3925                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3926                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3927
  3928             20  CF-ST-REFUND-CALC          PIC X.
  3929                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3930                 88  ST-REFD-BY-R78             VALUE '1'.
  3931                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3932                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3933                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3934                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3935                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3936                 88  ST-REFD-UTAH               VALUE '7'.
  3937                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3938                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3939                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3940
  3941             20  CF-ST-EARNING-CALC         PIC X.
  3942                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3943                 88  ST-EARN-BY-R78             VALUE '1'.
  3944                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3945                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3946                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3947                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3948                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3949                 88  ST-EARN-MEAN               VALUE '8'.
  3950                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3951
  3952             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3953                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3954                 88  ST-OVRD-BY-R78             VALUE '1'.
  3955                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3956                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3957                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3958                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  77
* EL130.cbl
  3959                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3960                 88  ST-OVRD-MEAN               VALUE '8'.
  3961                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3962             20  FILLER                     PIC X.
  3963
  3964         16  CF-ST-COMMISSION-CAPS.
  3965             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3966             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3967             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3968             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3969         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3970                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3971
  3972         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3973
  3974         16  CF-ST-STATUTORY-INTEREST.
  3975             20  CF-ST-STAT-DATE-FROM       PIC X.
  3976                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3977                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3978             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3979             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3980             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3981             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3982             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3983
  3984         16  CF-ST-OVER-SHORT.
  3985             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3986             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3987
  3988         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3989
  3990         16  CF-ST-RT-CALC                  PIC X.
  3991
  3992         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3993         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3994         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3995         16  CF-ST-RF-LR-CALC               PIC X.
  3996         16  CF-ST-RF-LL-CALC               PIC X.
  3997         16  CF-ST-RF-LN-CALC               PIC X.
  3998         16  CF-ST-RF-AH-CALC               PIC X.
  3999         16  CF-ST-RF-CP-CALC               PIC X.
  4000*        16  FILLER                         PIC X(206).
  4001*CIDMOD         16  FILLER                         PIC X(192).
  4002         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4003             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4004         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4005         16  CF-ST-VFY-2ND-BENE             PIC X.
  4006         16  FILLER                         PIC X(186).
  4007
  4008****************************************************************
  4009*             BENEFIT MASTER RECORD                            *
  4010****************************************************************
  4011
  4012     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4013         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4014             20  CF-BENEFIT-CODE            PIC XX.
  4015             20  CF-BENEFIT-NUMERIC  REDEFINES
  4016                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  78
* EL130.cbl
  4017             20  CF-BENEFIT-ALPHA           PIC XXX.
  4018             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4019             20  CF-BENEFIT-COMMENT         PIC X(10).
  4020
  4021             20  CF-LF-COVERAGE-TYPE        PIC X.
  4022                 88  CF-REDUCING                VALUE 'R'.
  4023                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4024
  4025             20  CF-SPECIAL-CALC-CD         PIC X.
  4026                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4027                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4028                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4029                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4030                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4031                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4032                 88  CF-FARM-PLAN               VALUE 'F'.
  4033                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4034                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4035                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4036                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4037                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4038                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4039                 88  CF-PRUDENTIAL              VALUE 'P'.
  4040                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4041                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4042                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4043                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4044                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4045                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4046
  4047             20  CF-JOINT-INDICATOR         PIC X.
  4048                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4049
  4050*            20  FILLER                     PIC X(12).
  4051             20  FILLER                     PIC X(11).
  4052             20  CF-BENEFIT-CATEGORY        PIC X.
  4053             20  CF-LOAN-TYPE               PIC X(8).
  4054
  4055             20  CF-CO-REM-TERM-CALC        PIC X.
  4056                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4057                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4058                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4059                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4060                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4061
  4062             20  CF-CO-EARNINGS-CALC        PIC X.
  4063                 88  CO-EARN-BY-R78             VALUE '1'.
  4064                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4065                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4066                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4067                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4068                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4069                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4070                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4071
  4072             20  CF-CO-REFUND-CALC          PIC X.
  4073                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4074                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  79
* EL130.cbl
  4075                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4076                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4077                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4078                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4079                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4080                 88  CO-REFD-MEAN               VALUE '8'.
  4081                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4082                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4083                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4084
  4085             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4086                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4087                 88  CO-OVRD-BY-R78             VALUE '1'.
  4088                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4089                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4090                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4091                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4092                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4093                 88  CO-OVRD-MEAN               VALUE '8'.
  4094                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4095
  4096             20  CF-CO-BEN-I-G-CD           PIC X.
  4097                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4098                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4099                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4100
  4101         16  FILLER                         PIC X(304).
  4102
  4103
  4104****************************************************************
  4105*             CARRIER MASTER RECORD                            *
  4106****************************************************************
  4107
  4108     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4109         16  CF-ADDRESS-DATA.
  4110             20  CF-MAIL-TO-NAME            PIC X(30).
  4111             20  CF-IN-CARE-OF              PIC X(30).
  4112             20  CF-ADDRESS-LINE-1          PIC X(30).
  4113             20  CF-ADDRESS-LINE-2          PIC X(30).
  4114             20  CF-CITY-STATE              PIC X(30).
  4115             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4116             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4117
  4118         16  CF-CLAIM-NO-CONTROL.
  4119             20  CF-CLAIM-NO-METHOD         PIC X.
  4120                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4121                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4122                 88  CLAIM-NO-SEQ               VALUE '3'.
  4123                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4124             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4125                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4126                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4127                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4128
  4129         16  CF-CHECK-NO-CONTROL.
  4130             20  CF-CHECK-NO-METHOD         PIC X.
  4131                 88  CHECK-NO-MANUAL            VALUE '1'.
  4132                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  80
* EL130.cbl
  4133                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4134                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4135             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4136                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4137
  4138         16  CF-DOMICILE-STATE              PIC XX.
  4139
  4140         16  CF-EXPENSE-CONTROLS.
  4141             20  CF-EXPENSE-METHOD          PIC X.
  4142                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4143                 88  DOLLARS-PER-PMT            VALUE '2'.
  4144                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4145                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4146             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4147             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4148
  4149         16  CF-CORRESPONDENCE-CONTROL.
  4150             20  CF-LETTER-RESEND-OPT       PIC X.
  4151                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4152                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4153             20  FILLER                     PIC X(4).
  4154
  4155         16  CF-RESERVE-CONTROLS.
  4156             20  CF-MANUAL-SW               PIC X.
  4157                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4158             20  CF-FUTURE-SW               PIC X.
  4159                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4160             20  CF-PTC-SW                  PIC X.
  4161                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4162             20  CF-IBNR-SW                 PIC X.
  4163                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4164             20  CF-PTC-LF-SW               PIC X.
  4165                 88  CF-LF-PTC-USED             VALUE '1'.
  4166             20  CF-CDT-ACCESS-METHOD       PIC X.
  4167                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4168                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4169                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4170             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4171
  4172         16  CF-CLAIM-CALC-METHOD           PIC X.
  4173             88  360-PLUS-MONTHS                VALUE '1'.
  4174             88  365-PLUS-MONTHS                VALUE '2'.
  4175             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4176             88  360-DAILY                      VALUE '4'.
  4177             88  365-DAILY                      VALUE '5'.
  4178
  4179         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4180         16  FILLER                         PIC X(11).
  4181
  4182         16  CF-LIMIT-AMOUNTS.
  4183             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4184             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4185             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4186             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4187             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4188             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4189             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4190             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  81
* EL130.cbl
  4191             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4192             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4193
  4194         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4195         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4196         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4197
  4198         16  CF-ZIP-CODE.
  4199             20  CF-ZIP-PRIME.
  4200                 24  CF-ZIP-1ST             PIC X.
  4201                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4202                 24  FILLER                 PIC X(4).
  4203             20  CF-ZIP-PLUS4               PIC X(4).
  4204         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4205             20  CF-CAN-POSTAL-1            PIC XXX.
  4206             20  CF-CAN-POSTAL-2            PIC XXX.
  4207             20  FILLER                     PIC XXX.
  4208
  4209         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4210         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4211         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4212
  4213         16  CF-RATING-SWITCH               PIC X.
  4214             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4215             88  CF-NO-RATING                   VALUE 'N'.
  4216
  4217         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4218
  4219         16  CF-CARRIER-OVER-SHORT.
  4220             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4221             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4222
  4223         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4224         16  CF-SECPAY-SWITCH               PIC X.
  4225             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4226             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4227         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4228         16  FILLER                         PIC X(448).
  4229*        16  FILLER                         PIC X(452).
  4230
  4231
  4232****************************************************************
  4233*             MORTALITY MASTER RECORD                          *
  4234****************************************************************
  4235
  4236     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4237         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4238                                INDEXED BY CF-MORT-NDX.
  4239             20  CF-MORT-TABLE              PIC X(5).
  4240             20  CF-MORT-TABLE-TYPE         PIC X.
  4241                 88  CF-MORT-JOINT              VALUE 'J'.
  4242                 88  CF-MORT-SINGLE             VALUE 'S'.
  4243                 88  CF-MORT-COMBINED           VALUE 'C'.
  4244                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4245                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4246             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4247             20  CF-MORT-AGE-METHOD         PIC XX.
  4248                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  82
* EL130.cbl
  4249                 88  CF-AGE-NEAR                VALUE 'AN'.
  4250             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4251             20  CF-MORT-ADJUSTMENT-DIRECTION
  4252                                            PIC X.
  4253                 88  CF-MINUS                   VALUE '-'.
  4254                 88  CF-PLUS                    VALUE '+'.
  4255             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4256             20  CF-MORT-JOINT-CODE         PIC X.
  4257                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4258             20  CF-MORT-PC-Q               PIC X.
  4259                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4260             20  CF-MORT-TABLE-CODE         PIC X(4).
  4261             20  CF-MORT-COMMENTS           PIC X(15).
  4262             20  FILLER                     PIC X(14).
  4263
  4264         16  FILLER                         PIC X(251).
  4265
  4266
  4267****************************************************************
  4268*             BUSSINESS TYPE MASTER RECORD                     *
  4269****************************************************************
  4270
  4271     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4272* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4273* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4274* AND RECORD 05 IS TYPES 81-99
  4275         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4276             20  CF-BUSINESS-TITLE          PIC  X(19).
  4277             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4278                                            PIC S9V9(4) COMP-3.
  4279             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4280             20  FILLER                     PIC  X.
  4281         16  FILLER                         PIC  X(248).
  4282
  4283
  4284****************************************************************
  4285*             TERMINAL MASTER RECORD                           *
  4286****************************************************************
  4287
  4288     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4289
  4290         16  CF-COMPANY-TERMINALS.
  4291             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4292                                  PIC X(4).
  4293         16  FILLER               PIC X(248).
  4294
  4295
  4296****************************************************************
  4297*             LIFE EDIT MASTER RECORD                          *
  4298****************************************************************
  4299
  4300     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4301         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4302             20  CF-LIFE-CODE-IN            PIC XX.
  4303             20  CF-LIFE-CODE-OUT           PIC XX.
  4304         16  FILLER                         PIC X(248).
  4305
  4306
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  83
* EL130.cbl
  4307****************************************************************
  4308*             AH EDIT MASTER RECORD                            *
  4309****************************************************************
  4310
  4311     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4312         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4313             20  CF-AH-CODE-IN              PIC XXX.
  4314             20  CF-AH-CODE-OUT             PIC XX.
  4315         16  FILLER                         PIC X(248).
  4316
  4317
  4318****************************************************************
  4319*             CREDIBILITY TABLES                               *
  4320****************************************************************
  4321
  4322     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4323         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4324                             INDEXED BY CF-CRDB-NDX.
  4325             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4326             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4327             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4328         16  FILLER                         PIC  X(332).
  4329
  4330
  4331****************************************************************
  4332*             REPORT CUSTOMIZATION RECORD                      *
  4333****************************************************************
  4334
  4335     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4336         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4337             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4338             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4339             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4340**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4341****       A T-TRANSFER.                                   ****
  4342             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4343
  4344         16  FILLER                         PIC XX.
  4345
  4346         16  CF-CARRIER-CNTL-OPT.
  4347             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4348                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4349                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4350             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4351                                            PIC X.
  4352         16  CF-GROUP-CNTL-OPT.
  4353             20  CF-GROUP-OPT-SEQ           PIC 9.
  4354                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4355                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4356             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4357                                            PIC X(6).
  4358         16  CF-STATE-CNTL-OPT.
  4359             20  CF-STATE-OPT-SEQ           PIC 9.
  4360                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4361                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4362             20  CF-STATE-SELECT OCCURS 3 TIMES
  4363                                            PIC XX.
  4364         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  84
* EL130.cbl
  4365             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4366                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4367                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4368             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4369                                            PIC X(10).
  4370         16  CF-BUS-TYP-CNTL-OPT.
  4371             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4372                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4373                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4374             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4375                                            PIC XX.
  4376         16  CF-LF-TYP-CNTL-OPT.
  4377             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4378                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4379                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4380             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4381                                            PIC XX.
  4382         16  CF-AH-TYP-CNTL-OPT.
  4383             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4384                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4385                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4386             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4387                                            PIC XX.
  4388         16  CF-REPTCD1-CNTL-OPT.
  4389             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4390                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4391                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4392             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4393                                            PIC X(10).
  4394         16  CF-REPTCD2-CNTL-OPT.
  4395             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4396                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4397                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4398             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4399                                            PIC X(10).
  4400         16  CF-USER1-CNTL-OPT.
  4401             20  CF-USER1-OPT-SEQ           PIC 9.
  4402                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4403                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4404             20  CF-USER1-SELECT OCCURS 3 TIMES
  4405                                            PIC X(10).
  4406         16  CF-USER2-CNTL-OPT.
  4407             20  CF-USER2-OPT-SEQ           PIC 9.
  4408                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4409                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4410             20  CF-USER2-SELECT OCCURS 3 TIMES
  4411                                            PIC X(10).
  4412         16  CF-USER3-CNTL-OPT.
  4413             20  CF-USER3-OPT-SEQ           PIC 9.
  4414                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4415                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4416             20  CF-USER3-SELECT OCCURS 3 TIMES
  4417                                            PIC X(10).
  4418         16  CF-USER4-CNTL-OPT.
  4419             20  CF-USER4-OPT-SEQ           PIC 9.
  4420                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4421                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4422             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  85
* EL130.cbl
  4423                                            PIC X(10).
  4424         16  CF-USER5-CNTL-OPT.
  4425             20  CF-USER5-OPT-SEQ           PIC 9.
  4426                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4427                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4428             20  CF-USER5-SELECT OCCURS 3 TIMES
  4429                                            PIC X(10).
  4430         16  CF-REINS-CNTL-OPT.
  4431             20  CF-REINS-OPT-SEQ           PIC 9.
  4432                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4433                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4434             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4435                 24  CF-REINS-PRIME         PIC XXX.
  4436                 24  CF-REINS-SUB           PIC XXX.
  4437
  4438         16  CF-AGENT-CNTL-OPT.
  4439             20  CF-AGENT-OPT-SEQ           PIC 9.
  4440                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4441                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4442             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4443                                            PIC X(10).
  4444
  4445         16  FILLER                         PIC X(43).
  4446
  4447         16  CF-LOSS-RATIO-SELECT.
  4448             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4449             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4450         16  CF-ENTRY-DATE-SELECT.
  4451             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4452             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4453         16  CF-EFFECTIVE-DATE-SELECT.
  4454             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4455             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4456
  4457         16  CF-EXCEPTION-LIST-IND          PIC X.
  4458             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4459
  4460         16  FILLER                         PIC X(318).
  4461
  4462****************************************************************
  4463*                  EXCEPTION REPORTING RECORD                  *
  4464****************************************************************
  4465
  4466     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4467         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4468             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4469
  4470         16  CF-COMBINED-LIFE-AH-OPT.
  4471             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4472             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4473             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4474             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4475
  4476         16  CF-LIFE-OPT.
  4477             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4478             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4479             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4480             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  86
* EL130.cbl
  4481             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4482             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4483             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4484             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4485             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4486             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4487
  4488         16  CF-AH-OPT.
  4489             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4490             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4491             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4492             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4493             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4494             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4495             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4496             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4497             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4498             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4499
  4500         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4501             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4502             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4503             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4504
  4505         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4506
  4507         16  FILLER                         PIC X(673).
  4508
  4509
  4510****************************************************************
  4511*             MORTGAGE SYSTEM PLAN RECORD                      *
  4512****************************************************************
  4513
  4514     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4515         16  CF-PLAN-TYPE                   PIC X.
  4516             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4517             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4518             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4519         16  CF-PLAN-ABBREV                 PIC XXX.
  4520         16  CF-PLAN-DESCRIPT               PIC X(10).
  4521         16  CF-PLAN-NOTES                  PIC X(20).
  4522         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4523         16  CF-PLAN-UNDERWRITING.
  4524             20  CF-PLAN-TERM-DATA.
  4525                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4526                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4527             20  CF-PLAN-AGE-DATA.
  4528                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4529                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4530                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4531             20  CF-PLAN-BENEFIT-DATA.
  4532                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4533                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4534                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4535                                            PIC S9(7)V99  COMP-3.
  4536         16  CF-PLAN-POLICY-FORMS.
  4537             20  CF-POLICY-FORM             PIC X(12).
  4538             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  87
* EL130.cbl
  4539             20  CF-MASTER-POLICY           PIC X(12).
  4540         16  CF-PLAN-RATING.
  4541             20  CF-RATE-CODE               PIC X(5).
  4542             20  CF-SEX-RATING              PIC X.
  4543                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4544                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4545             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4546             20  CF-SUB-STD-TYPE            PIC X.
  4547                 88  CF-PCT-OF-PREM            VALUE '1'.
  4548                 88  CF-PCT-OF-BENE            VALUE '2'.
  4549         16  CF-PLAN-PREM-TOLERANCES.
  4550             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4551             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4552         16  CF-PLAN-PYMT-TOLERANCES.
  4553             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4554             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4555         16  CF-PLAN-MISC-DATA.
  4556             20  FILLER                     PIC X.
  4557             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4558             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4559         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4560         16  CF-PLAN-IND-GRP                PIC X.
  4561             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4562                                                     '1'.
  4563             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4564                                                     '2'.
  4565         16  CF-MIB-SEARCH-SW               PIC X.
  4566             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4567             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4568             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4569             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4570         16  CF-ALPHA-SEARCH-SW             PIC X.
  4571             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4572             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4573             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4574             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4575             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4576             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4577             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4578             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4579             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4580             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4581                                                     'A' 'B' 'C'
  4582                                                     'X' 'Y' 'Z'.
  4583         16  CF-EFF-DT-RULE-SW              PIC X.
  4584             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4585             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4586             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4587             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4588             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4589         16  FILLER                         PIC X(4).
  4590         16  CF-HEALTH-QUESTIONS            PIC X.
  4591             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4592         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4593         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4594         16  CF-PLAN-SNGL-JNT               PIC X.
  4595             88  CF-COMBINED-PLAN              VALUE 'C'.
  4596             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  88
* EL130.cbl
  4597             88  CF-SNGL-PLAN                  VALUE 'S'.
  4598         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4599         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4600         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4601         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4602         16  CF-RERATE-CNTL                 PIC  X.
  4603             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4604             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4605             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4606             88  CF-AUTO-RECALC                 VALUE '4'.
  4607         16  CF-BENEFIT-TYPE                PIC  X.
  4608             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4609             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4610         16  CF-POLICY-FEE                  PIC S999V99
  4611                                                    COMP-3.
  4612         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4613         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4614         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4615         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4616         16  FILLER                         PIC  X(32).
  4617         16  CF-TERMINATION-FORM            PIC  X(04).
  4618         16  FILLER                         PIC  X(08).
  4619         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4620                                                       COMP-3.
  4621         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4622         16  CF-ISSUE-LETTER                PIC  X(4).
  4623         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4624         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4625             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4626             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4627         16  CF-MP-REFUND-CALC              PIC X.
  4628             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4629             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4630             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4631             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4632             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4633             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4634             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4635             88  CF-MP-REFD-MEAN                VALUE '8'.
  4636         16  CF-ALT-RATE-CODE               PIC  X(5).
  4637
  4638
  4639         16  FILLER                         PIC X(498).
  4640****************************************************************
  4641*             MORTGAGE COMPANY MASTER RECORD                   *
  4642****************************************************************
  4643
  4644     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4645         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4646         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4647             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4648             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4649             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4650             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4651             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4652
  4653         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4654         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  89
* EL130.cbl
  4655         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4656         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4657         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4658
  4659         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4660             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4661         16  CF-MP-RECON-USE-IND            PIC X(1).
  4662             88  CF-MP-USE-RECON             VALUE 'Y'.
  4663         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4664             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4665         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4666             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4667             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4668         16  FILLER                         PIC X(1).
  4669         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4670             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4671         16  CF-MORTG-MIB-VERSION           PIC X.
  4672             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4673             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4674             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4675         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4676             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4677                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4678             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4679                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4680             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4681                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4682             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4683                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4684             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4685                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4686             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4687                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4688         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4689         16  FILLER                         PIC X(7).
  4690         16  CF-MORTG-DESTINATION-SYMBOL.
  4691             20  CF-MORTG-MIB-COMM          PIC X(5).
  4692             20  CF-MORTG-MIB-TERM          PIC X(5).
  4693         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4694             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4695         16  FILLER                         PIC X(03).
  4696         16  CF-MP-CHECK-NO-CONTROL.
  4697             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4698                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4699                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4700                                                ' ' LOW-VALUES.
  4701                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4702                                               VALUE '3'.
  4703         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4704         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4705         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4706             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4707                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4708             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4709                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4710             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4711                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4712             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  90
* EL130.cbl
  4713                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4714             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4715                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4716             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4717                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4718         16  CF-MORTG-BILLING-AREA.
  4719             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4720                                            PIC X.
  4721         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4722         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4723         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4724         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4725             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4726             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4727         16  FILLER                         PIC X.
  4728         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4729             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4730             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4731         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4732         16  FILLER                         PIC X(8).
  4733         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4734         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4735         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4736         16  CF-ACH-COMPANY-ID.
  4737             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4738                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4739                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4740                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4741             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4742         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4743             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4744         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4745             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4746             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4747         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4748         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4749         16  FILLER                         PIC X(536).
  4750
  4751****************************************************************
  4752*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4753****************************************************************
  4754
  4755     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4756         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4757             20  CF-FEMALE-HEIGHT.
  4758                 24  CF-FEMALE-FT           PIC 99.
  4759                 24  CF-FEMALE-IN           PIC 99.
  4760             20  CF-FEMALE-MIN-WT           PIC 999.
  4761             20  CF-FEMALE-MAX-WT           PIC 999.
  4762         16  FILLER                         PIC X(428).
  4763
  4764     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4765         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4766             20  CF-MALE-HEIGHT.
  4767                 24  CF-MALE-FT             PIC 99.
  4768                 24  CF-MALE-IN             PIC 99.
  4769             20  CF-MALE-MIN-WT             PIC 999.
  4770             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  91
* EL130.cbl
  4771         16  FILLER                         PIC X(428).
  4772******************************************************************
  4773*             AUTOMATIC ACTIVITY RECORD                          *
  4774******************************************************************
  4775     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4776         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4777             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4778             20  CF-SYS-LETTER-ID           PIC X(04).
  4779             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4780             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4781             20  CF-SYS-RESET-SW            PIC X(01).
  4782             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4783             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4784
  4785         16  FILLER                         PIC X(50).
  4786
  4787         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4788             20  CF-USER-ACTIVE-SW          PIC X(01).
  4789             20  CF-USER-LETTER-ID          PIC X(04).
  4790             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4791             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4792             20  CF-USER-RESET-SW           PIC X(01).
  4793             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4794             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4795             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4796
  4797         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  92
* EL130.cbl
  4799*    COPY ELCCERT.
  4800******************************************************************
  4801*                                                                *
  4802*                            ELCCERT.                            *
  4803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4804*                            VMOD=2.013                          *
  4805*                                                                *
  4806*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4807*                                                                *
  4808*   FILE TYPE = VSAM,KSDS                                        *
  4809*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4810*                                                                *
  4811*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4812*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4813*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4814*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4815*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4816*                                                                *
  4817*   LOG = YES                                                    *
  4818*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4819******************************************************************
  4820*                   C H A N G E   L O G
  4821*
  4822* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4823*-----------------------------------------------------------------
  4824*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4825* EFFECTIVE    NUMBER
  4826*-----------------------------------------------------------------
  4827* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4828* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4829* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4830* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4831* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4832* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4833* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4834* 032612  CR2011110200001  PEMA  AHL CHANGES
  4835******************************************************************
  4836
  4837 01  CERTIFICATE-MASTER.
  4838     12  CM-RECORD-ID                      PIC XX.
  4839         88  VALID-CM-ID                      VALUE 'CM'.
  4840
  4841     12  CM-CONTROL-PRIMARY.
  4842         16  CM-COMPANY-CD                 PIC X.
  4843         16  CM-CARRIER                    PIC X.
  4844         16  CM-GROUPING.
  4845             20  CM-GROUPING-PREFIX        PIC X(3).
  4846             20  CM-GROUPING-PRIME         PIC X(3).
  4847         16  CM-STATE                      PIC XX.
  4848         16  CM-ACCOUNT.
  4849             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4850             20  CM-ACCOUNT-PRIME          PIC X(6).
  4851         16  CM-CERT-EFF-DT                PIC XX.
  4852         16  CM-CERT-NO.
  4853             20  CM-CERT-PRIME             PIC X(10).
  4854             20  CM-CERT-SFX               PIC X.
  4855
  4856     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  93
* EL130.cbl
  4857         16  CM-COMPANY-CD-A1              PIC X.
  4858         16  CM-INSURED-LAST-NAME          PIC X(15).
  4859         16  CM-INSURED-INITIALS.
  4860             20  CM-INSURED-INITIAL1       PIC X.
  4861             20  CM-INSURED-INITIAL2       PIC X.
  4862
  4863     12  CM-CONTROL-BY-SSN.
  4864         16  CM-COMPANY-CD-A2              PIC X.
  4865         16  CM-SOC-SEC-NO.
  4866             20  CM-SSN-STATE              PIC XX.
  4867             20  CM-SSN-ACCOUNT            PIC X(6).
  4868             20  CM-SSN-LN3.
  4869                 25  CM-INSURED-INITIALS-A2.
  4870                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4871                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4872                 25 CM-PART-LAST-NAME-A2         PIC X.
  4873
  4874     12  CM-CONTROL-BY-CERT-NO.
  4875         16  CM-COMPANY-CD-A4              PIC X.
  4876         16  CM-CERT-NO-A4                 PIC X(11).
  4877
  4878     12  CM-CONTROL-BY-MEMB.
  4879         16  CM-COMPANY-CD-A5              PIC X.
  4880         16  CM-MEMBER-NO.
  4881             20  CM-MEMB-STATE             PIC XX.
  4882             20  CM-MEMB-ACCOUNT           PIC X(6).
  4883             20  CM-MEMB-LN4.
  4884                 25  CM-INSURED-INITIALS-A5.
  4885                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4886                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4887                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4888
  4889     12  CM-INSURED-PROFILE-DATA.
  4890         16  CM-INSURED-FIRST-NAME.
  4891             20  CM-INSURED-1ST-INIT       PIC X.
  4892             20  FILLER                    PIC X(9).
  4893         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4894         16  CM-INSURED-SEX                PIC X.
  4895             88  CM-SEX-MALE                  VALUE 'M'.
  4896             88  CM-SEX-FEMAL                 VALUE 'F'.
  4897         16  CM-INSURED-JOINT-AGE          PIC 99.
  4898         16  CM-JOINT-INSURED-NAME.
  4899             20  CM-JT-LAST-NAME           PIC X(15).
  4900             20  CM-JT-FIRST-NAME.
  4901                 24  CM-JT-1ST-INIT        PIC X.
  4902                 24  FILLER                PIC X(9).
  4903             20  CM-JT-INITIAL             PIC X.
  4904
  4905     12  CM-LIFE-DATA.
  4906         16  CM-LF-BENEFIT-CD              PIC XX.
  4907         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4908         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4909         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4910         16  CM-LF-DEV-CODE                PIC XXX.
  4911         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4912         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4913         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4914         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  94
* EL130.cbl
  4915         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4916         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4917         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4918         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4919         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4920         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4921         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4922         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4923         16  FILLER                        PIC XX.
  4924
  4925     12  CM-AH-DATA.
  4926         16  CM-AH-BENEFIT-CD              PIC XX.
  4927         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4928         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4929         16  CM-AH-DEV-CODE                PIC XXX.
  4930         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4931         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4932         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4933         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4934         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4935         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4936         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4937         16  CM-AH-PAID-THRU-DT            PIC XX.
  4938             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4939         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4940         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4941         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4942         16  FILLER                        PIC X.
  4943
  4944     12  CM-LOAN-INFORMATION.
  4945         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4946         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4947                                           PIC S9(5)V99  COMP-3.
  4948         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4949         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4950         16  CM-PAY-FREQUENCY              PIC S99.
  4951         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4952         16  CM-RATE-CLASS                 PIC XX.
  4953         16  CM-BENEFICIARY                PIC X(25).
  4954         16  CM-POLICY-FORM-NO             PIC X(12).
  4955         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4956         16  CM-LAST-ADD-ON-DT             PIC XX.
  4957         16  CM-DEDUCTIBLE-AMOUNTS.
  4958             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4959             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4960         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4961             20  CM-RESIDENT-STATE         PIC XX.
  4962             20  CM-RATE-CODE              PIC X(4).
  4963             20  FILLER                    PIC XX.
  4964         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4965             20  CM-LOAN-OFFICER           PIC X(5).
  4966             20  FILLER                    PIC XXX.
  4967         16  CM-CSR-CODE                   PIC XXX.
  4968         16  CM-UNDERWRITING-CODE          PIC X.
  4969             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4970         16  CM-POST-CARD-IND              PIC X.
  4971         16  CM-NH-INTERFACE-SW            PIC X.
  4972         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  95
* EL130.cbl
  4973             88  CM-SING-PRM                  VALUE '1'.
  4974             88  CM-O-B-COVERAGE              VALUE '2'.
  4975             88  CM-OPEN-END                  VALUE '3'.
  4976         16  CM-IND-GRP-TYPE               PIC X.
  4977             88  CM-INDIVIDUAL                VALUE 'I'.
  4978             88  CM-GROUP                     VALUE 'G'.
  4979         16  CM-SKIP-CODE                  PIC X.
  4980             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4981             88  SKIP-JULY                    VALUE '1'.
  4982             88  SKIP-AUGUST                  VALUE '2'.
  4983             88  SKIP-SEPTEMBER               VALUE '3'.
  4984             88  SKIP-JULY-AUG                VALUE '4'.
  4985             88  SKIP-AUG-SEPT                VALUE '5'.
  4986             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4987             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4988             88  SKIP-JUNE                    VALUE '8'.
  4989             88  SKIP-JUNE-JULY               VALUE '9'.
  4990             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4991             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4992         16  CM-PAYMENT-MODE               PIC X.
  4993             88  PAY-MONTHLY                  VALUE SPACE.
  4994             88  PAY-WEEKLY                   VALUE '1'.
  4995             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4996             88  PAY-BI-WEEKLY                VALUE '3'.
  4997             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4998         16  CM-LOAN-NUMBER                PIC X(8).
  4999         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5000         16  CM-OLD-LOF                    PIC XXX.
  5001*        16  CM-LOAN-OFFICER               PIC XXX.
  5002         16  CM-REIN-TABLE                 PIC XXX.
  5003         16  CM-SPECIAL-REIN-CODE          PIC X.
  5004         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5005         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5006         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5007
  5008     12  CM-STATUS-DATA.
  5009         16  CM-ENTRY-STATUS               PIC X.
  5010         16  CM-ENTRY-DT                   PIC XX.
  5011
  5012         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5013         16  CM-LF-CANCEL-DT               PIC XX.
  5014         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5015
  5016         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5017         16  CM-LF-DEATH-DT                PIC XX.
  5018         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5019
  5020         16  CM-LF-CURRENT-STATUS          PIC X.
  5021             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5022                                                'M' '4' '5' '9'.
  5023             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5024             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5025             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5026             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5027             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5028             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5029             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5030             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  96
* EL130.cbl
  5031             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5032             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5033             88  CM-LF-DECLINED               VALUE 'D'.
  5034             88  CM-LF-VOIDED                 VALUE 'V'.
  5035
  5036         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5037         16  CM-AH-CANCEL-DT               PIC XX.
  5038         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5039
  5040         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5041         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5042         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5043
  5044         16  CM-AH-CURRENT-STATUS          PIC X.
  5045             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5046                                                'M' '4' '5' '9'.
  5047             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5048             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5049             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5050             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5051             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5052             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5053             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5054             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5055             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5056             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5057             88  CM-AH-DECLINED               VALUE 'D'.
  5058             88  CM-AH-VOIDED                 VALUE 'V'.
  5059
  5060         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5061             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5062             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5063             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5064         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5065
  5066         16  CM-ENTRY-BATCH                PIC X(6).
  5067         16  CM-LF-EXIT-BATCH              PIC X(6).
  5068         16  CM-AH-EXIT-BATCH              PIC X(6).
  5069         16  CM-LAST-MONTH-END             PIC XX.
  5070
  5071     12  CM-NOTE-SW                        PIC X.
  5072         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5073         88  CERT-NOTES-PRESENT               VALUE '1'.
  5074         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5075         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5076         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5077         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5078         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5079         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5080     12  CM-COMP-EXCP-SW                   PIC X.
  5081         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5082         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5083     12  CM-INSURED-ADDRESS-SW             PIC X.
  5084         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5085         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5086
  5087*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5088     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  97
* EL130.cbl
  5089     12  FILLER                            PIC X.
  5090
  5091*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5092     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5093     12  FILLER                            PIC X.
  5094*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5095     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5096
  5097     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5098         88  CERT-ADDED-BATCH                 VALUE ' '.
  5099         88  CERT-ADDED-ONLINE                VALUE '1'.
  5100         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5101         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5102         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5103     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5104         88  CERT-AS-LOADED                   VALUE ' '.
  5105         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5106         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5107         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5108         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5109         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5110         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5111         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5112
  5113     12  CM-ACCOUNT-COMM-PCTS.
  5114         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5115         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5116
  5117     12  CM-USER-FIELD                     PIC X.
  5118     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5119     12  CM-CLP-STATE                      PIC XX.
  5120     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5121     12  CM-USER-RESERVED                  PIC XXX.
  5122     12  FILLER REDEFINES CM-USER-RESERVED.
  5123         16  CM-AH-CLASS-CD                PIC XX.
  5124         16  F                             PIC X.
  5125******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  98
* EL130.cbl
  5127*    COPY ERCACCT.
  5128******************************************************************
  5129*                                                                *
  5130*                                                                *
  5131*                            ERCACCT                             *
  5132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5133*                            VMOD=2.031                          *
  5134*                                                                *
  5135*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5136*                                                                *
  5137*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5138*   VSAM ACCOUNT MASTER FILES.                                   *
  5139*                                                                *
  5140*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5141*                                                                *
  5142*   FILE TYPE = VSAM,KSDS                                        *
  5143*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5144*                                                                *
  5145*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5146*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5147*                                                                *
  5148*   LOG = NO                                                     *
  5149*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5150*                                                                *
  5151*                                                                *
  5152******************************************************************
  5153*                   C H A N G E   L O G
  5154*
  5155* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5156*-----------------------------------------------------------------
  5157*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5158* EFFECTIVE    NUMBER
  5159*-----------------------------------------------------------------
  5160* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5161* 092705    2005050300006  PEMA  ADD SPP LEASES
  5162* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5163* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5164* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5165* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5166* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5167******************************************************************
  5168
  5169 01  ACCOUNT-MASTER.
  5170     12  AM-RECORD-ID                      PIC XX.
  5171         88  VALID-AM-ID                      VALUE 'AM'.
  5172
  5173     12  AM-CONTROL-PRIMARY.
  5174         16  AM-COMPANY-CD                 PIC X.
  5175         16  AM-MSTR-CNTRL.
  5176             20  AM-CONTROL-A.
  5177                 24  AM-CARRIER            PIC X.
  5178                 24  AM-GROUPING.
  5179                     28 AM-GROUPING-PREFIX PIC XXX.
  5180                     28 AM-GROUPING-PRIME  PIC XXX.
  5181                 24  AM-STATE              PIC XX.
  5182                 24  AM-ACCOUNT.
  5183                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5184                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page  99
* EL130.cbl
  5185             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5186                                           PIC X(19).
  5187             20  AM-CNTRL-B.
  5188                 24  AM-EXPIRATION-DT      PIC XX.
  5189                 24  FILLER                PIC X(4).
  5190             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5191                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5192
  5193     12  AM-CONTROL-BY-VAR-GRP.
  5194         16  AM-COMPANY-CD-A1              PIC X.
  5195         16  AM-VG-CARRIER                 PIC X.
  5196         16  AM-VG-GROUPING                PIC X(6).
  5197         16  AM-VG-STATE                   PIC XX.
  5198         16  AM-VG-ACCOUNT                 PIC X(10).
  5199         16  AM-VG-DATE.
  5200             20  AM-VG-EXPIRATION-DT       PIC XX.
  5201             20  FILLER                    PIC X(4).
  5202         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5203                                           PIC 9(11)      COMP-3.
  5204     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5205         16  FILLER                        PIC X(10).
  5206         16  AM-VG-KEY3.
  5207             20  AM-VG3-ACCOUNT            PIC X(10).
  5208             20  AM-VG3-EXP-DT             PIC XX.
  5209         16  FILLER                        PIC X(4).
  5210     12  AM-MAINT-INFORMATION.
  5211         16  AM-LAST-MAINT-DT              PIC XX.
  5212         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5213         16  AM-LAST-MAINT-USER            PIC X(4).
  5214         16  FILLER                        PIC XX.
  5215
  5216     12  AM-EFFECTIVE-DT                   PIC XX.
  5217     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5218
  5219     12  AM-PREV-DATES  COMP-3.
  5220         16  AM-PREV-EXP-DT                PIC 9(11).
  5221         16  AM-PREV-EFF-DT                PIC 9(11).
  5222
  5223     12  AM-REPORT-CODE-1                  PIC X(10).
  5224     12  AM-REPORT-CODE-2                  PIC X(10).
  5225
  5226     12  AM-CITY-CODE                      PIC X(4).
  5227     12  AM-COUNTY-PARISH                  PIC X(6).
  5228
  5229     12  AM-NAME                           PIC X(30).
  5230     12  AM-PERSON                         PIC X(30).
  5231     12  AM-ADDRS                          PIC X(30).
  5232     12  AM-CITY.
  5233         16  AM-ADDR-CITY                  PIC X(28).
  5234         16  AM-ADDR-STATE                 PIC XX.
  5235     12  AM-ZIP.
  5236         16  AM-ZIP-PRIME.
  5237             20  AM-ZIP-PRI-1ST            PIC X.
  5238                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5239             20  FILLER                    PIC X(4).
  5240         16  AM-ZIP-PLUS4                  PIC X(4).
  5241     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5242         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 100
* EL130.cbl
  5243         16  AM-CAN-POSTAL-2               PIC XXX.
  5244         16  FILLER                        PIC XXX.
  5245     12  AM-TEL-NO.
  5246         16  AM-AREA-CODE                  PIC 999.
  5247         16  AM-TEL-PRE                    PIC 999.
  5248         16  AM-TEL-NBR                    PIC 9(4).
  5249     12  AM-TEL-LOC                        PIC X.
  5250         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5251         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5252
  5253     12  AM-COMM-STRUCTURE.
  5254         16  AM-DEFN-1.
  5255             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5256                 24  AM-AGT.
  5257                     28  AM-AGT-PREFIX     PIC X(4).
  5258                     28  AM-AGT-PRIME      PIC X(6).
  5259                 24  AM-COM-TYP            PIC X.
  5260                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5261                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5262                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5263                 24  AM-RECALC-LV-INDIC    PIC X.
  5264                 24  AM-RETRO-LV-INDIC     PIC X.
  5265                 24  AM-GL-CODES           PIC X.
  5266                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5267                 24  FILLER                PIC X(01).
  5268         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5269             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5270                 24  FILLER                PIC X(11).
  5271                 24  AM-L-COMA             PIC XXX.
  5272                 24  AM-J-COMA             PIC XXX.
  5273                 24  AM-A-COMA             PIC XXX.
  5274                 24  FILLER                PIC X(6).
  5275
  5276     12  AM-COMM-CHANGE-STATUS             PIC X.
  5277         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5278
  5279     12  AM-CSR-CODE                       PIC X(4).
  5280
  5281     12  AM-BILLING-STATUS                 PIC X.
  5282         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5283         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5284     12  AM-AUTO-REFUND-SW                 PIC X.
  5285         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5286         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5287     12  AM-GPCD                           PIC 99.
  5288     12  AM-IG                             PIC X.
  5289         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5290         88  AM-HAS-GROUP                     VALUE '2'.
  5291     12  AM-STATUS                         PIC X.
  5292         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5293         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5294         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5295         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5296         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5297         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5298     12  AM-REMIT-TO                       PIC 99.
  5299     12  AM-ID-NO                          PIC X(11).
  5300
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 101
* EL130.cbl
  5301     12  AM-CAL-TABLE                      PIC XX.
  5302     12  AM-LF-DEVIATION                   PIC XXX.
  5303     12  AM-AH-DEVIATION                   PIC XXX.
  5304     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5305     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5306     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5307     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5308     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5309     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5310
  5311     12  AM-USER-FIELDS.
  5312         16  AM-FLD-1                      PIC XX.
  5313         16  AM-FLD-2                      PIC XX.
  5314         16  AM-FLD-3                      PIC XX.
  5315         16  AM-FLD-4                      PIC XX.
  5316         16  AM-FLD-5                      PIC XX.
  5317
  5318     12  AM-1ST-PROD-DATE.
  5319         16  AM-1ST-PROD-YR                PIC XX.
  5320         16  AM-1ST-PROD-MO                PIC XX.
  5321         16  AM-1ST-PROD-DA                PIC XX.
  5322     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5323     12  AM-CERTS-PURGED-DATE.
  5324         16  AM-PUR-YR                     PIC XX.
  5325         16  AM-PUR-MO                     PIC XX.
  5326         16  AM-PUR-DA                     PIC XX.
  5327     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5328     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5329     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5330     12  AM-INACTIVE-DATE.
  5331         16  AM-INA-MO                     PIC 99.
  5332         16  AM-INA-DA                     PIC 99.
  5333         16  AM-INA-YR                     PIC 99.
  5334     12  AM-AR-HI-CERT-DATE                PIC XX.
  5335
  5336     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5337     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5338
  5339     12  AM-OB-PAYMENT-MODE                PIC X.
  5340         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5341         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5342         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5343         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5344
  5345     12  AM-AH-ONLY-INDICATOR              PIC X.
  5346         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5347         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5348
  5349     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5350
  5351     12  AM-OVER-SHORT.
  5352         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5353         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5354
  5355     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5356     12  AM-DCC-CLP-STATE                  PIC XX.
  5357
  5358     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 102
* EL130.cbl
  5359     12  AM-RECALC-REIN                    PIC X.
  5360
  5361     12  AM-REI-TABLE                      PIC XXX.
  5362     12  AM-REI-ET-LF                      PIC X.
  5363     12  AM-REI-ET-AH                      PIC X.
  5364     12  AM-REI-PE-LF                      PIC X.
  5365     12  AM-REI-PE-AH                      PIC X.
  5366     12  AM-REI-PRT-ST                     PIC X.
  5367     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5368     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5369     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5370     12  AM-REI-GROUP-A                    PIC X(6).
  5371     12  AM-REI-MORT                       PIC X(4).
  5372     12  AM-REI-PRT-OW                     PIC X.
  5373     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5374     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5375     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5376     12  AM-REI-GROUP-B                    PIC X(6).
  5377
  5378     12  AM-TRUST-TYPE                     PIC X(2).
  5379
  5380     12  AM-EMPLOYER-STMT-USED             PIC X.
  5381     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5382
  5383     12  AM-STD-AH-TYPE                    PIC XX.
  5384     12  AM-EARN-METHODS.
  5385         16  AM-EARN-METHOD-R              PIC X.
  5386             88 AM-REF-RL-R78                 VALUE 'R'.
  5387             88 AM-REF-RL-PR                  VALUE 'P'.
  5388             88 AM-REF-RL-MEAN                VALUE 'M'.
  5389             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5390         16  AM-EARN-METHOD-L              PIC X.
  5391             88 AM-REF-LL-R78                 VALUE 'R'.
  5392             88 AM-REF-LL-PR                  VALUE 'P'.
  5393             88 AM-REF-LL-MEAN                VALUE 'M'.
  5394             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5395         16  AM-EARN-METHOD-A              PIC X.
  5396             88 AM-REF-AH-R78                 VALUE 'R'.
  5397             88 AM-REF-AH-PR                  VALUE 'P'.
  5398             88 AM-REF-AH-MEAN                VALUE 'M'.
  5399             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5400             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5401             88 AM-REF-AH-NET                 VALUE 'N'.
  5402
  5403     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5404     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5405     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5406
  5407     12  AM-RET-Y-N                        PIC X.
  5408     12  AM-RET-P-E                        PIC X.
  5409     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5410     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5411     12  AM-RET-GRP                        PIC X(6).
  5412     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5413         16  AM-POOL-PRIME                 PIC XXX.
  5414         16  AM-POOL-SUB                   PIC XXX.
  5415     12  AM-RETRO-EARNINGS.
  5416         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 103
* EL130.cbl
  5417         16  AM-RET-EARN-L                 PIC X.
  5418         16  AM-RET-EARN-A                 PIC X.
  5419     12  AM-RET-ST-TAX-USE                 PIC X.
  5420         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5421         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5422     12  AM-RETRO-BEG-EARNINGS.
  5423         16  AM-RET-BEG-EARN-R             PIC X.
  5424         16  AM-RET-BEG-EARN-L             PIC X.
  5425         16  AM-RET-BEG-EARN-A             PIC X.
  5426     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5427     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5428
  5429     12  AM-USER-SELECT-OPTIONS.
  5430         16  AM-USER-SELECT-1              PIC X(10).
  5431         16  AM-USER-SELECT-2              PIC X(10).
  5432         16  AM-USER-SELECT-3              PIC X(10).
  5433         16  AM-USER-SELECT-4              PIC X(10).
  5434         16  AM-USER-SELECT-5              PIC X(10).
  5435
  5436     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5437
  5438     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5439
  5440     12  AM-RPT045A-SWITCH                 PIC X.
  5441         88  RPT045A-OFF                   VALUE 'N'.
  5442
  5443     12  AM-INSURANCE-LIMITS.
  5444         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5445         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5446
  5447     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5448         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5449
  5450     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5451         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5452         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5453
  5454     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5455
  5456     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5457     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5458     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5459     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5460     12  AM-DCC-UEF-STATE                  PIC XX.
  5461     12  FILLER                            PIC XXX.
  5462     12  AM-REPORT-CODE-3                  PIC X(10).
  5463*    12  FILLER                            PIC X(22).
  5464
  5465     12  AM-RESERVE-DATE.
  5466         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5467         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5468         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5469
  5470     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5471     12  AM-NOTIFICATION-TYPES.
  5472         16  AM-NOTIF-OF-LETTERS           PIC X.
  5473         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5474         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 104
* EL130.cbl
  5475         16  AM-NOTIF-OF-STATUS            PIC X.
  5476
  5477     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5478         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5479         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5480         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5481         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5482
  5483     12  AM-BENEFIT-CONTROLS.
  5484         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5485             20  AM-BENEFIT-CODE           PIC XX.
  5486             20  AM-BENEFIT-TYPE           PIC X.
  5487             20  AM-BENEFIT-REVISION       PIC XXX.
  5488             20  AM-BENEFIT-REM-TERM       PIC X.
  5489             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5490             20  FILLER                    PIC XX.
  5491         16  FILLER                        PIC X(80).
  5492
  5493     12  AM-TRANSFER-DATA.
  5494         16  AM-TRANSFERRED-FROM.
  5495             20  AM-TRNFROM-CARRIER        PIC X.
  5496             20  AM-TRNFROM-GROUPING.
  5497                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5498                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5499             20  AM-TRNFROM-STATE          PIC XX.
  5500             20  AM-TRNFROM-ACCOUNT.
  5501                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5502                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5503             20  AM-TRNFROM-DTE            PIC XX.
  5504         16  AM-TRANSFERRED-TO.
  5505             20  AM-TRNTO-CARRIER          PIC X.
  5506             20  AM-TRNTO-GROUPING.
  5507                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5508                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5509             20  AM-TRNTO-STATE            PIC XX.
  5510             20  AM-TRNTO-ACCOUNT.
  5511                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5512                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5513             20  AM-TRNTO-DTE              PIC XX.
  5514         16  FILLER                        PIC X(10).
  5515
  5516     12  AM-SAVED-REMIT-TO                 PIC 99.
  5517
  5518     12  AM-COMM-STRUCTURE-SAVED.
  5519         16  AM-DEFN-1-SAVED.
  5520             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5521                 24  AM-AGT-SV             PIC X(10).
  5522                 24  AM-COM-TYP-SV         PIC X.
  5523                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5524                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5525                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5526                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5527                 24  FILLER                PIC X.
  5528                 24  AM-GL-CODES-SV        PIC X.
  5529                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5530                 24  FILLER                PIC X.
  5531         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5532             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 105
* EL130.cbl
  5533                 24  FILLER                PIC X(11).
  5534                 24  AM-L-COMA-SV          PIC XXX.
  5535                 24  AM-J-COMA-SV          PIC XXX.
  5536                 24  AM-A-COMA-SV          PIC XXX.
  5537                 24  FILLER                PIC X(6).
  5538
  5539     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5540         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5541            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5542            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5543            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5544
  5545     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5546     12  FILLER                            PIC X(120).
  5547
  5548     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5549         16  AM-CONTROL-NAME               PIC X(30).
  5550         16  AM-EXECUTIVE-ONE.
  5551             20  AM-EXEC1-NAME             PIC X(15).
  5552             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5553                                                          COMP-3.
  5554             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5555                                                          COMP-3.
  5556         16  AM-EXECUTIVE-TWO.
  5557             20  AM-EXEC2-NAME             PIC X(15).
  5558             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5559                                                          COMP-3.
  5560             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5561                                                          COMP-3.
  5562
  5563     12  AM-RETRO-ADDITIONAL-DATA.
  5564         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5565         16  AM-RETRO-PREM-P-E             PIC X.
  5566         16  AM-RETRO-CLMS-P-I             PIC X.
  5567         16  AM-RETRO-RET-BRACKET-LF.
  5568             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5569                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5570                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5571             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5572                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5573                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5574             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5575                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5576                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5577         16  AM-RETRO-RET-BRACKET-AH.
  5578             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5579                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5580                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5581                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5582             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5583                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5584                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5585             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5586                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5587                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5588
  5589     12  AM-COMMENTS.
  5590         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 106
* EL130.cbl
  5591
  5592     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5593         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5594         16  AM-FLI-BILLING-CODE           PIC X.
  5595         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5596         16  AM-FLI-UNITED-IDENT           PIC X.
  5597         16  AM-FLI-INTEREST-LOST-DATA.
  5598             20  AM-FLI-BANK-NO            PIC X(5).
  5599             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5600             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5601             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5602         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5603             20  AM-FLI-AGT                PIC X(9).
  5604             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5605             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5606         16  FILLER                        PIC X(102).
  5607
  5608     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5609         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5610             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5611             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5612             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5613             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5614             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5615         16  FILLER                          PIC X(10).
  5616******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 107
* EL130.cbl
  5618*    COPY ELCTRLR.
  5619******************************************************************
  5620*                                                                *
  5621*                            ELCTRLR.                            *
  5622*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5623*                            VMOD=2.014                          *
  5624*                                                                *
  5625*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5626*                                                                *
  5627*   FILE TYPE = VSAM,KSDS                                        *
  5628*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5629*                                                                *
  5630*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5631*       ALTERNATE INDEX = NONE                                   *
  5632*                                                                *
  5633*   LOG = YES                                                    *
  5634*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5635******************************************************************
  5636*                   C H A N G E   L O G
  5637*
  5638* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5639*-----------------------------------------------------------------
  5640*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5641* EFFECTIVE    NUMBER
  5642*-----------------------------------------------------------------
  5643* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5644* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5645* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5646* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5647* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5648* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5649* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5650* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5651* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5652* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5653* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5654* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5655* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5656******************************************************************
  5657 01  ACTIVITY-TRAILERS.
  5658     12  AT-RECORD-ID                    PIC XX.
  5659         88  VALID-AT-ID                       VALUE 'AT'.
  5660
  5661     12  AT-CONTROL-PRIMARY.
  5662         16  AT-COMPANY-CD               PIC X.
  5663         16  AT-CARRIER                  PIC X.
  5664         16  AT-CLAIM-NO                 PIC X(7).
  5665         16  AT-CERT-NO.
  5666             20  AT-CERT-PRIME           PIC X(10).
  5667             20  AT-CERT-SFX             PIC X.
  5668         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5669             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5670             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5671             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5672             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5673             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5674             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5675             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 108
* EL130.cbl
  5676             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5677             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5678             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5679             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5680             88  AT-BENEFICIARY-TRL           VALUE +91.
  5681             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5682             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5683
  5684     12  AT-TRAILER-TYPE                 PIC X.
  5685         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5686         88  PAYMENT-TR                       VALUE '2'.
  5687         88  AUTO-PAY-TR                      VALUE '3'.
  5688         88  CORRESPONDENCE-TR                VALUE '4'.
  5689         88  ADDRESS-TR                       VALUE '5'.
  5690         88  GENERAL-INFO-TR                  VALUE '6'.
  5691         88  AUTO-PROMPT-TR                   VALUE '7'.
  5692         88  DENIAL-TR                        VALUE '8'.
  5693         88  INCURRED-CHG-TR                  VALUE '9'.
  5694         88  FORM-CONTROL-TR                  VALUE 'A'.
  5695
  5696     12  AT-RECORDED-DT                  PIC XX.
  5697     12  AT-RECORDED-BY                  PIC X(4).
  5698     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5699
  5700     12  AT-TRAILER-BODY                 PIC X(165).
  5701
  5702     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5703         16  AT-RESERVE-CONTROLS.
  5704             20  AT-MANUAL-SW            PIC X.
  5705                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5706             20  AT-FUTURE-SW            PIC X.
  5707                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5708             20  AT-PTC-SW               PIC X.
  5709                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5710             20  AT-IBNR-SW              PIC X.
  5711                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5712             20  AT-PTC-LF-SW            PIC X.
  5713                 88  AT-LF-PTC-USED          VALUE '1'.
  5714             20  AT-CDT-ACCESS-METHOD    PIC X.
  5715                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5716                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5717                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5718             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5719         16  AT-LAST-COMPUTED-DT         PIC XX.
  5720         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5721         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5722         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5723         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5724         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5725         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5726         16  AT-EXPENSE-CONTROLS.
  5727             20  AT-EXPENSE-METHOD       PIC X.
  5728                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5729                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5730                 88  PERCENT-OF-PMT           VALUE '3'.
  5731                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5732             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5733             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 109
* EL130.cbl
  5734         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5735         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5736
  5737         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5738         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5739
  5740*        16  FILLER                      PIC X(53).
  5741         16  FILLER                      PIC X(47).
  5742
  5743         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5744         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5745
  5746         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5747             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5748             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5749*                    C = CLOSED
  5750*                    O = OPEN
  5751             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5752*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5753
  5754     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5755         16  AT-PAYMENT-TYPE             PIC X.
  5756             88  PARTIAL-PAYMENT                VALUE '1'.
  5757             88  FINAL-PAYMENT                  VALUE '2'.
  5758             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5759             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5760             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5761             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5762             88  VOIDED-PAYMENT                 VALUE '9'.
  5763             88  TRANSFER                       VALUE 'T'.
  5764             88  LIFE-INTEREST                  VALUE 'I'.
  5765
  5766         16  AT-CLAIM-TYPE               PIC X.
  5767             88  PAID-FOR-AH                    VALUE 'A'.
  5768             88  PAID-FOR-LIFE                  VALUE 'L'.
  5769             88  PAID-FOR-IUI                   VALUE 'I'.
  5770             88  PAID-FOR-GAP                   VALUE 'G'.
  5771         16  AT-CLAIM-PREM-TYPE          PIC X.
  5772             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5773             88  AT-O-B-COVERAGE                VALUE '2'.
  5774             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5775         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5776         16  AT-CHECK-NO                 PIC X(7).
  5777         16  AT-PAID-FROM-DT             PIC XX.
  5778         16  AT-PAID-THRU-DT             PIC XX.
  5779         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5780         16  FILLER                      PIC X.
  5781         16  AT-PAYEES-NAME              PIC X(30).
  5782         16  AT-PAYMENT-ORIGIN           PIC X.
  5783             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5784             88  ONLINE-AUTO-PMT                VALUE '2'.
  5785             88  OFFLINE-PMT                    VALUE '3'.
  5786         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5787         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5788         16  AT-VOID-DATA.
  5789             20  AT-VOID-DT              PIC XX.
  5790*00144       20  AT-VOID-REASON          PIC X(30).
  5791             20  AT-VOID-REASON          PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 110
* EL130.cbl
  5792         16  AT-PMT-APPROVED-BY          PIC X(04).
  5793         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5794         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5795         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5796                                         PIC S99V9(5)  COMP-3.
  5797         16  AT-CREDIT-INTERFACE.
  5798             20  AT-PMT-SELECT-DT        PIC XX.
  5799                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5800             20  AT-PMT-ACCEPT-DT        PIC XX.
  5801                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5802             20  AT-VOID-SELECT-DT       PIC XX.
  5803                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5804             20  AT-VOID-ACCEPT-DT       PIC XX.
  5805                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5806
  5807         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5808                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5809                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5810         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5811
  5812         16  AT-FORCE-CONTROL            PIC X.
  5813             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5814         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5815         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5816         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5817         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5818         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5819         16  AT-BENEFIT-TYPE             PIC X.
  5820
  5821         16  AT-EXPENSE-TYPE             PIC X.
  5822         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5823
  5824         16  AT-PAYEE-TYPE-CD.
  5825             20  AT-PAYEE-TYPE           PIC X.
  5826                 88  INSURED-PAID           VALUE 'I'.
  5827                 88  BENEFICIARY-PAID       VALUE 'B'.
  5828                 88  ACCOUNT-PAID           VALUE 'A'.
  5829                 88  OTHER-1-PAID           VALUE 'O'.
  5830                 88  OTHER-2-PAID           VALUE 'Q'.
  5831                 88  DOCTOR-PAID            VALUE 'P'.
  5832                 88  EMPLOYER-PAID          VALUE 'E'.
  5833             20  AT-PAYEE-SEQ            PIC X.
  5834
  5835         16  AT-CASH-PAYMENT             PIC X.
  5836         16  AT-GROUPED-PAYMENT          PIC X.
  5837         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5838         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5839         16  AT-APPROVED-LEVEL           PIC X.
  5840         16  AT-VOID-TYPE                PIC X.
  5841             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5842             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5843         16  AT-AIG-UNEMP-IND            PIC X.
  5844             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5845         16  AT-ASSOCIATES               PIC X.
  5846             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5847             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5848
  5849         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 111
* EL130.cbl
  5850         16  AT-CV-PMT-CODE              PIC X.
  5851             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5852             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5853             88  FULL-ADD-PAYMENT           VALUE '3'.
  5854             88  HALF-ADD-PAYMENT           VALUE '4'.
  5855             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5856             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5857             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5858             88  ADDL-PAYMENT               VALUE '8'.
  5859
  5860         16  AT-EOB-CODE1                PIC XXX.
  5861         16  AT-EOB-CODE2                PIC XXX.
  5862         16  AT-EOB-CODE3                PIC XXX.
  5863         16  AT-EOB-CODE4                PIC XXX.
  5864         16  FILLER REDEFINES AT-EOB-CODE4.
  5865             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5866             20  FILLER                  PIC X.
  5867         16  AT-EOB-CODE5                PIC XXX.
  5868         16  FILLER REDEFINES AT-EOB-CODE5.
  5869             20  AT-PMT-PROOF-DT         PIC XX.
  5870             20  FILLER                  PIC X.
  5871
  5872         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5873             88  AT-PRINT-EOB            VALUE 'Y'.
  5874
  5875         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5876         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5877
  5878     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5879         16  AT-SCHEDULE-START-DT        PIC XX.
  5880         16  AT-SCHEDULE-END-DT          PIC XX.
  5881         16  AT-TERMINATED-DT            PIC XX.
  5882         16  AT-LAST-PMT-TYPE            PIC X.
  5883             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5884             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5885         16  AT-FIRST-PMT-DATA.
  5886             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5887             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5888             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5889         16  AT-REGULAR-PMT-DATA.
  5890             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5891             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5892             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5893         16  AT-AUTO-PAYEE-CD.
  5894             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5895                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5896                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5897                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5898                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5899                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5900             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5901         16  AT-AUTO-PAY-DAY             PIC 99.
  5902         16  AT-AUTO-CASH                PIC X.
  5903             88  AT-CASH                      VALUE 'Y'.
  5904             88  AT-NON-CASH                  VALUE 'N'.
  5905*        16  FILLER                      PIC X(129).
  5906         16  AT-AUTO-END-LETTER          PIC X(4).
  5907         16  FILLER                      PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 112
* EL130.cbl
  5908
  5909         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  5910         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5911
  5912     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5913         16  AT-LETTER-SENT-DT           PIC XX.
  5914         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5915         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5916         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5917         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5918         16  AT-LETTER-ORIGIN            PIC X.
  5919             88  ONLINE-CREATION              VALUE '1' '3'.
  5920             88  OFFLINE-CREATION             VALUE '2' '4'.
  5921             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5922             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5923         16  AT-STD-LETTER-FORM          PIC X(4).
  5924         16  AT-REASON-TEXT              PIC X(70).
  5925         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5926         16  AT-ADDRESEE-TYPE            PIC X.
  5927              88  INSURED-ADDRESEE            VALUE 'I'.
  5928              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5929              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5930              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5931              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5932              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5933              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5934         16  AT-ADDRESSEE-NAME           PIC X(30).
  5935         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5936         16  AT-RESEND-PRINT-DATE        PIC XX.
  5937         16  AT-CORR-SOL-UNSOL           PIC X.
  5938         16  AT-LETTER-PURGED-DT         PIC XX.
  5939*
  5940*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5941*
  5942         16  AT-CSO-REDEFINITION.
  5943             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5944             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5945             20  AT-LETTER-TO-BENE       PIC X(1).
  5946             20  AT-STOP-LETTER-DT       PIC X(2).
  5947             20  FILLER                  PIC X(19).
  5948*             20  FILLER                  PIC X(27).
  5949             20  AT-CSO-LETTER-STATUS    PIC X.
  5950                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5951                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  5952                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5953             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5954             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5955*
  5956*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5957*
  5958*        16  FILLER                      PIC X(26).
  5959*
  5960*        16  AT-DMD-BSR-CODE             PIC X.
  5961*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  5962*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  5963*
  5964*        16  AT-DMD-LETTER-STATUS        PIC X.
  5965*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 113
* EL130.cbl
  5966*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  5967*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  5968*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  5969*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  5970
  5971         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  5972         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  5973
  5974     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  5975         16  AT-ADDRESS-TYPE             PIC X.
  5976             88  INSURED-ADDRESS               VALUE 'I'.
  5977             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  5978             88  ACCOUNT-ADDRESS               VALUE 'A'.
  5979             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  5980             88  EMPLOYER-ADDRESS              VALUE 'E'.
  5981             88  OTHER-ADDRESS-1               VALUE 'O'.
  5982             88  OTHER-ADDRESS-2               VALUE 'Q'.
  5983         16  AT-MAIL-TO-NAME             PIC X(30).
  5984         16  AT-ADDRESS-LINE-1           PIC X(30).
  5985         16  AT-ADDRESS-LINE-2           PIC X(30).
  5986         16  AT-CITY-STATE.
  5987             20  AT-CITY                 PIC X(28).
  5988             20  AT-STATE                PIC XX.
  5989         16  AT-ZIP.
  5990             20  AT-ZIP-CODE.
  5991                 24  AT-ZIP-1ST          PIC X.
  5992                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5993                 24  FILLER              PIC X(4).
  5994             20  AT-ZIP-PLUS4            PIC X(4).
  5995         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  5996             20  AT-CAN-POSTAL-1         PIC XXX.
  5997             20  AT-CAN-POSTAL-2         PIC XXX.
  5998             20  FILLER                  PIC XXX.
  5999         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6000*         16  FILLER                      PIC X(23).
  6001         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6002         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6003         16  FILLER                      PIC X(13).
  6004         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6005         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6006
  6007     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6008         16  AT-INFO-LINE-1              PIC X(60).
  6009         16  AT-INFO-LINE-2              PIC X(60).
  6010         16  AT-INFO-TRAILER-TYPE        PIC X.
  6011             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6012             88  AT-CALL-NOTE            VALUE 'C'.
  6013             88  AT-MAINT-NOTE           VALUE 'M'.
  6014             88  AT-CERT-CHANGE          VALUE 'X'.
  6015             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6016             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6017         16  AT-CALL-TYPE                PIC X.
  6018             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6019             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6020         16  AT-NOTE-CONTINUATION        PIC X.
  6021             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6022         16  AT-EOB-CODES-EXIST          PIC X.
  6023             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 114
* EL130.cbl
  6024         16  FILLER                      PIC X(35).
  6025         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6026         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6027
  6028     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6029         16  AT-PROMPT-LINE-1            PIC X(60).
  6030         16  AT-PROMPT-LINE-2            PIC X(60).
  6031         16  AT-PROMPT-START-DT          PIC XX.
  6032         16  AT-PROMPT-END-DT            PIC XX.
  6033         16  FILLER                      PIC X(35).
  6034         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6035         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6036
  6037     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6038         16  AT-DENIAL-INFO-1            PIC X(60).
  6039         16  AT-DENIAL-INFO-2            PIC X(60).
  6040         16  AT-DENIAL-DT                PIC XX.
  6041         16  AT-RETRACTION-DT            PIC XX.
  6042         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6043*         16  FILLER                      PIC X(31).
  6044         16  AT-DENIAL-PROOF-DT          PIC XX.
  6045         16  FILLER                      PIC X(29).
  6046         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6047         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6048
  6049     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6050         16  AT-OLD-INCURRED-DT          PIC XX.
  6051         16  AT-OLD-REPORTED-DT          PIC XX.
  6052         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6053         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6054         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6055         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6056         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6057         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6058         16  FILLER                      PIC X(26).
  6059         16  AT-OLD-DIAG-CODE            PIC X(6).
  6060         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6061         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6062         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6063         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6064         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6065         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6066         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6067         16  FILLER                      PIC X(25).
  6068         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6069
  6070     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6071         16  AT-FORM-SEND-ON-DT          PIC XX.
  6072         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6073         16  AT-FORM-RE-SEND-DT          PIC XX.
  6074         16  AT-FORM-ANSWERED-DT         PIC XX.
  6075         16  AT-FORM-PRINTED-DT          PIC XX.
  6076         16  AT-FORM-REPRINT-DT          PIC XX.
  6077         16  AT-FORM-TYPE                PIC X.
  6078             88  INITIAL-FORM                  VALUE '1'.
  6079             88  PROGRESS-FORM                 VALUE '2'.
  6080         16  AT-INSTRUCT-LN-1            PIC X(28).
  6081         16  AT-INSTRUCT-LN-2            PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 115
* EL130.cbl
  6082         16  AT-INSTRUCT-LN-3            PIC X(28).
  6083         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6084         16  AT-FORM-ADDRESS             PIC X.
  6085             88  FORM-TO-INSURED              VALUE 'I'.
  6086             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6087             88  FORM-TO-OTHER-1              VALUE 'O'.
  6088             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6089         16  AT-RELATED-1.
  6090             20 AT-REL-CARR-1            PIC X.
  6091             20 AT-REL-CLAIM-1           PIC X(7).
  6092             20 AT-REL-CERT-1            PIC X(11).
  6093         16  AT-RELATED-2.
  6094             20 AT-REL-CARR-2            PIC X.
  6095             20 AT-REL-CLAIM-2           PIC X(7).
  6096             20 AT-REL-CERT-2            PIC X(11).
  6097         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6098         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6099         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6100         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6101         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6102         16  AT-STOP-FORM-DT             PIC X(2).
  6103
  6104         16  FILLER                      PIC X(09).
  6105         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6106         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6107******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 116
* EL130.cbl
  6109*    COPY ELCBENE.
  6110******************************************************************
  6111*                                                                *
  6112*                            ELCBENE.                            *
  6113*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6114*                            VMOD=2.006                          *
  6115*                                                                *
  6116*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6117*                                                                *
  6118*   FILE TYPE = VSAM,KSDS                                        *
  6119*   RECORD SIZE = 500   RECFORM = FIX                            *
  6120*                                                                *
  6121*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6122*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6123*                                                                *
  6124*   LOG = YES                                                    *
  6125*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6126*                                                                *
  6127*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6128******************************************************************
  6129
  6130 01  BENEFICIARY-MASTER.
  6131     12  BE-RECORD-ID                PIC XX.
  6132         88  VALID-BE-ID                VALUE 'BE'.
  6133
  6134     12  BE-CONTROL-PRIMARY.
  6135         16  BE-COMPANY-CD           PIC X.
  6136         16  BE-RECORD-TYPE          PIC X.
  6137             88  BENEFICIARY-RECORD  VALUE 'B'.
  6138             88  ADJUSTOR-RECORD     VALUE 'A'.
  6139         16  BE-BENEFICIARY          PIC X(10).
  6140     12  BE-CONTROL-BY-NAME.
  6141         16  BE-COMPANY-CD-A1        PIC X.
  6142         16  BE-RECORD-TYPE-A1       PIC X.
  6143         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6144         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6145
  6146     12  BE-LAST-MAINT-DT            PIC XX.
  6147     12  BE-LAST-MAINT-BY            PIC X(4).
  6148     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6149
  6150     12  BE-ADDRESS-DATA.
  6151         16  BE-MAIL-TO-NAME         PIC X(30).
  6152         16  BE-ADDRESS-LINE-1       PIC X(30).
  6153         16  BE-ADDRESS-LINE-2       PIC X(30).
  6154         16  BE-ADDRESS-LINE-3       PIC X(30).
  6155         16  BE-CITY-STATE.
  6156             20  BE-CITY             PIC X(28).
  6157             20  BE-STATE            PIC XX.
  6158         16  BE-ZIP-CODE.
  6159             20  BE-ZIP-PRIME.
  6160                 24  BE-ZIP-1ST      PIC X.
  6161                     88  BE-CANADIAN-POST-CODE
  6162                                         VALUE 'A' THRU 'Z'.
  6163                 24  FILLER          PIC X(4).
  6164             20  BE-ZIP-PLUS4        PIC X(4).
  6165         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6166             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 117
* EL130.cbl
  6167             20  BE-CAN-POSTAL-2     PIC XXX.
  6168             20  FILLER              PIC XXX.
  6169         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6170         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6171
  6172******************************************************************
  6173*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6174*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6175******************************************************************
  6176     12  BE-CARRIER                  PIC X.
  6177
  6178     12  BE-ADDRESS-DATA2.
  6179         16  BE-MAIL-TO-NAME2        PIC X(30).
  6180         16  BE-ADDRESS-LINE-12      PIC X(30).
  6181         16  BE-ADDRESS-LINE-22      PIC X(30).
  6182         16  BE-ADDRESS-LINE-32      PIC X(30).
  6183         16  BE-CITY-STATE2.
  6184             20  BE-CITY2            PIC X(28).
  6185             20  BE-STATE2           PIC XX.
  6186         16  BE-ZIP-CODE2.
  6187             20  BE-ZIP-PRIME2.
  6188                 24  BE-ZIP-1ST2     PIC X.
  6189                     88  BE-CANADIAN-POST-CODE2
  6190                                         VALUE 'A' THRU 'Z'.
  6191                 24  FILLER          PIC X(4).
  6192             20  BE-ZIP-PLUS42       PIC X(4).
  6193         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6194             20  BE-CAN-POSTAL-12    PIC XXX.
  6195             20  BE-CAN-POSTAL-22    PIC XXX.
  6196             20  FILLER              PIC XXX.
  6197         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6198         16  BE-BILLING-STMT-DATA.
  6199             20  BE-BSR              PIC X.
  6200                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6201                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6202             20  BE-BSR-FROM         PIC X(30).
  6203             20  BE-BSR-DEPT         PIC X(30).
  6204             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6205             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6206             20  BE-OUTPUT-TYPE      PIC X.
  6207                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6208                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6209
  6210     12  FILLER                      PIC X(28).
  6211******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 118
* EL130.cbl
  6213*    COPY ELCDAR.
  6214******************************************************************
  6215*                                                                *
  6216*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6217*   FILE TYPE = VSAM,KSDS                                        *
  6218*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6219*   BASE CLUSTER = DLYACTV                                       *
  6220*   LOG = YES                                                    *
  6221*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6222*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6223*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6224*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6225*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6226*               BY PROGRAM "LGINFCE".                            *
  6227*                                                                *
  6228******************************************************************
  6229 01  DAILY-ACTIVITY-RECORD.
  6230     05  DA-KEY.
  6231         10  DA-COMP-CD          PIC X.
  6232         10  DA-CARRIER          PIC X.
  6233         10  DA-CLAIM-NO         PIC X(7).
  6234         10  DA-CERT-NO.
  6235             15  DA-CERT-PRIME   PIC X(10).
  6236             15  DA-CERT-SFX     PIC X.
  6237     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6238     05  DA-RECORD-TYPE          PIC X.
  6239     05  FILLER                  PIC X(2).
  6240******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 119
* EL130.cbl
  6242*    COPY ELCACTQ.
  6243******************************************************************
  6244*                                                                *
  6245*                            ELCACTQ.                            *
  6246*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6247*                            VMOD=2.004                          *
  6248*                                                                *
  6249*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6250*                                                                *
  6251*   FILE TYPE = VSAM,KSDS                                        *
  6252*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6253*                                                                *
  6254*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6255*       ALTERNATE INDEX = NONE                                   *
  6256*                                                                *
  6257*   LOG = YES                                                    *
  6258*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6259*                                                                *
  6260*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6261******************************************************************
  6262
  6263 01  ACTIVITY-QUE.
  6264     12  AQ-RECORD-ID                PIC XX.
  6265         88  VALID-AQ-ID                VALUE 'AQ'.
  6266
  6267     12  AQ-CONTROL-PRIMARY.
  6268         16  AQ-COMPANY-CD           PIC X.
  6269         16  AQ-CARRIER              PIC X.
  6270         16  AQ-CLAIM-NO             PIC X(7).
  6271         16  AQ-CERT-NO.
  6272             20  AQ-CERT-PRIME       PIC X(10).
  6273             20  AQ-CERT-SFX         PIC X.
  6274
  6275     12  AQ-PENDING-ACTIVITY-FLAGS.
  6276         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6277         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6278             88  PENDING-PAYMENTS       VALUE '1'.
  6279         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6280             88  PENDING-FULL-PRINT     VALUE '1'.
  6281             88  PENDING-PART-PRINT     VALUE '2'.
  6282         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6283             88  PENDING-LETTERS        VALUE '1'.
  6284         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6285             88  PENDING-RESTORE        VALUE 'C'.
  6286             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6287
  6288     12  FILLER                      PIC X(20).
  6289
  6290     12  AQ-RESEND-DATE              PIC XX.
  6291     12  AQ-FOLLOWUP-DATE            PIC XX.
  6292     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6293     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6294     12  AQ-AUTO-LETTER              PIC X(4).
  6295     12  FILLER                      PIC XX.
  6296     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6297*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 120
* EL130.cbl
  6299*    COPY ELCARCH.
  6300******************************************************************
  6301*                                                                *
  6302*                            ELCARCH.                            *
  6303*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6304*                            VMOD=2.007                          *
  6305*                                                                *
  6306*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6307*                                                                *
  6308*   FILE TYPE = VSAM,KSDS                                        *
  6309*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6310*                                                                *
  6311*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6312*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6313*                                                                *
  6314*   LOG = NO                                                     *
  6315*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6316*                                                                *
  6317*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6318******************************************************************
  6319 01  LETTER-ARCHIVE.
  6320     12  LA-RECORD-ID                PIC XX.
  6321         88  VALID-LA-ID                VALUE 'LA'.
  6322
  6323     12  LA-CONTROL-PRIMARY.
  6324         16  LA-COMPANY-CD           PIC X.
  6325         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6326         16  LA-RECORD-TYPE          PIC X.
  6327             88  LA-HEADER-DATA         VALUE '1'.
  6328             88  LA-ADDRESS-DATA        VALUE '2'.
  6329             88  LA-TEXT-DATA           VALUE '3'.
  6330             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6331         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6332
  6333     12  LA-CONTROL-BY-TYPE.
  6334         16  LA-COMPANY-CD-A1        PIC X.
  6335         16  LA-RECORD-TYPE-A1       PIC X.
  6336         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6337         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6338
  6339     12  LA-TEXT-RECORD.
  6340         16  LA-SKIP-CONTROL         PIC XX.
  6341             88  NO-LINES-SKIPPED       VALUE SPACES.
  6342             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6343         16  LA-TEXT-LINE            PIC X(70).
  6344
  6345     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6346         16  FILLER                  PIC XX.
  6347         16  LA-ADDRESS-LINE         PIC X(30).
  6348         16  FILLER                  PIC X(40).
  6349
  6350     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6351         16  FILLER                  PIC XX.
  6352         16  LA-CARRIER              PIC X.
  6353         16  LA-CLAIM-NO             PIC X(7).
  6354         16  LA-CERT-NO.
  6355             20  LA-CERT-PRIME       PIC X(10).
  6356             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 121
* EL130.cbl
  6357         16  LA-NO-OF-COPIES         PIC S9.
  6358         16  LA-RESEND-DATE          PIC XX.
  6359         16  LA-PROCESSOR-CD         PIC X(4).
  6360         16  LA-CREATION-DT          PIC XX.
  6361         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6362         16  LA-RESEND-PRINT-DATE    PIC XX.
  6363         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6364         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6365*
  6366* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6367*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6368*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6369*   I        20  LA-DMD-RES-ST           PIC XX.
  6370*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6371*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6372*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6373*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6374*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6375*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6376*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6377*   I        20  LA-DMD-UND-CODE         PIC XX.
  6378*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6379*   V    16  FILLER                  PIC X(15).
  6380* -----
  6381*
  6382* REINSERTED  CSO  MODS
  6383*
  6384         16  FILLER.
  6385             20  FILLER                  PIC X(29).
  6386             20  LA-CSO-LETTER-STATUS    PIC X.
  6387                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6388                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6389                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6390             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6391             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6392*
  6393
  6394     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6395         16  FILLER                  PIC XX.
  6396         16  LA4-CARRIER             PIC X.
  6397         16  LA4-CLAIM-NO            PIC X(7).
  6398         16  LA4-CERT-NO.
  6399             20  LA4-CERT-PRIME      PIC X(10).
  6400             20  LA4-CERT-SFX        PIC X.
  6401         16  LA4-NO-OF-COPIES        PIC S9.
  6402         16  LA4-RESEND-DATE         PIC XX.
  6403         16  LA4-PROCESSOR-CD        PIC X(4).
  6404         16  LA4-CREATION-DT         PIC XX.
  6405         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6406         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6407         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6408         16  LA4-FORM-TYPE           PIC X.
  6409             88  LA4-INITIAL-FORM    VALUE '1'.
  6410             88  LA4-PROGRESS-FORM   VALUE '2'.
  6411         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6412         16  LA4-STATE               PIC X(02).
  6413         16  FILLER                  PIC X(31).
  6414******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 122
* EL130.cbl
  6416*    COPY ERCREIN.
  6417******************************************************************
  6418*                                                                *
  6419*                            ERCREIN                             *
  6420*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6421*                            VMOD=2.010                          *
  6422*                                                                *
  6423*   ONLINE CREDIT SYSTEM                                         *
  6424*                                                                *
  6425*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6426*                                                                *
  6427*   FILE TYPE = VSAM,KSDS                                        *
  6428*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6429*                                                                *
  6430*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6431*       ALTERNATE PATH = NONE                                    *
  6432*                                                                *
  6433*   LOG = NO                                                     *
  6434*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6435*                                                                *
  6436******************************************************************
  6437*                   C H A N G E   L O G
  6438*
  6439* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6440*-----------------------------------------------------------------
  6441*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6442* EFFECTIVE    NUMBER
  6443*-----------------------------------------------------------------
  6444* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6445* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6446******************************************************************
  6447 01  REINSURANCE-RECORD.
  6448     12  RE-RECORD-ID                      PIC XX.
  6449         88  VALID-RE-ID                      VALUE 'RE'.
  6450
  6451     12  RE-CONTROL-PRIMARY.
  6452         16  RE-COMPANY-CD                 PIC X.
  6453         16  RE-KEY.
  6454             20  RE-CODE                   PIC X.
  6455                 88  RE-TABLE-RECORD          VALUE 'A'.
  6456                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6457             20  RE-TABLE                  PIC XXX.
  6458             20  FILLER                    PIC XXX.
  6459         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6460             20  FILLER                    PIC X.
  6461             20  RE-COMPANY.
  6462                 24  RE-COMP-PRIME         PIC XXX.
  6463                 24  RE-COMP-SUB           PIC XXX.
  6464
  6465     12  RE-MAINT-INFORMATION.
  6466         16  RE-LAST-MAINT-DT              PIC XX.
  6467         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6468         16  RE-LAST-MAINT-USER            PIC X(4).
  6469         16  FILLER                        PIC X(10).
  6470
  6471     12  RE-TABLE-DATA.
  6472         16  RE-100-COMP                   PIC 99.
  6473
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 123
* EL130.cbl
  6474         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6475             20  RE-REI-COMP-NO.
  6476                 24  RE-REI-COMP           PIC XXX.
  6477                 24  RE-REI-COMP-SUB       PIC XXX.
  6478             20  RE-LF-QC                  PIC X.
  6479             20  RE-AH-QC                  PIC X.
  6480             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6481             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6482             20  RE-LFAGE-LO               PIC 99.
  6483             20  RE-LFAGE-HI               PIC 99.
  6484             20  RE-AHAGE-LO               PIC 99.
  6485             20  RE-AHAGE-HI               PIC 99.
  6486             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6487             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6488             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6489             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6490             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6491             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6492             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6493             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6494             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6495             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6496             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6497             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6498             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6499             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6500             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6501             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6502             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6503             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6504             20  RE-LF-BEN-CODE            PIC X.
  6505             20  RE-AH-BEN-CODE            PIC X.
  6506             20  RE-INTERACTIVE            PIC X.
  6507             20  RE-REMAINING              PIC X.
  6508             20  RE-LF-RUNOFF-SW           PIC X.
  6509             20  RE-AH-RUNOFF-SW           PIC X.
  6510             20  FILLER                    PIC X(19).
  6511
  6512         16  RE-COMP-INFO-END              PIC X(6).
  6513         16  RE-NSP-ST-CD-LF               PIC XX.
  6514         16  RE-NSP-ST-CD-AH               PIC XX.
  6515         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6516             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6517
  6518         16  FILLER                        PIC X(27).
  6519
  6520     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6521         16  RE-NAME                       PIC X(30).
  6522         16  RE-LF-PE                      PIC X.
  6523         16  RE-AH-PE                      PIC X.
  6524         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6525         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6526         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6527         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6528         16  RE-PRT-ST                     PIC X.
  6529         16  RE-PRT-OW                     PIC X.
  6530         16  RE-MORT-CODE                  PIC X(4).
  6531         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 124
* EL130.cbl
  6532         16  RE-ZERO-LF-FEE                PIC X.
  6533         16  RE-ZERO-AH-FEE                PIC X.
  6534         16  RE-CEDE-NAME                  PIC X(30).
  6535         16  RE-LF-COMM                    PIC X.
  6536         16  RE-AH-COMM                    PIC X.
  6537         16  RE-LF-TAX                     PIC X.
  6538         16  RE-AH-TAX                     PIC X.
  6539         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6540         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6541         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6542
  6543         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6544             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6545
  6546         16  RE-LF-CEDING-FEE-BRACKETS.
  6547             20  RE-LF-FEE-METHOD          PIC X.
  6548                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6549                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6550                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6551                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6552             20  RE-LF-FEE-BASIS           PIC X.
  6553                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6554                 88  RE-LF-NET-CEDED               VALUE '2'.
  6555                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6556                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6557                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6558                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6559                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6560                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6561             20  FILLER                    PIC XXX.
  6562             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6563                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6564                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6565
  6566         16  RE-AH-CEDING-FEE-BRACKETS.
  6567             20  RE-AH-FEE-METHOD          PIC X.
  6568                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6569                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6570                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6571                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6572             20  RE-AH-FEE-BASIS           PIC X.
  6573                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6574                 88  RE-AH-NET-CEDED               VALUE '2'.
  6575                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6576                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6577                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6578                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6579                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6580                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6581             20  FILLER                    PIC XXX.
  6582             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6583                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6584                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6585
  6586         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6587
  6588         16  RE-OLD-CEDING-STMT            PIC X.
  6589
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 125
* EL130.cbl
  6590         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6591         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6592         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6593         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6594         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6595         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6596         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6597         16  RE-MORT-SW                    PIC X.
  6598         16  RE-CEDING-TYPE-FLAG           PIC X.
  6599             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6600             88  RE-CEDED                          VALUE 'C'.
  6601             88  RE-ASSUMED                        VALUE 'A'.
  6602             88  RE-PHANTOM                        VALUE 'P'.
  6603
  6604         16  RE-CEDING-STMT-OPT-A          PIC X.
  6605             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6606         16  RE-CEDING-STMT-OPT-B          PIC X.
  6607             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6608         16  RE-CEDING-STMT-OPT-C          PIC X.
  6609             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6610         16  RE-CEDING-STMT-OPT-D          PIC X.
  6611             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6612         16  RE-CEDING-STMT-OPT-E          PIC X.
  6613             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6614
  6615         16  RE-PRT-CRSV                   PIC X.
  6616
  6617         16  RE-GL-CENTER                  PIC X(4).
  6618
  6619         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6620
  6621         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6622
  6623         16  RE-EARN-STOP-CODE             PIC X.
  6624             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6625             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6626
  6627         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6628             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6629
  6630         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6631         16  FILLER                        PIC X(2281).
  6632
  6633         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6634
  6635******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 126
* EL130.cbl
  6637*    COPY ERCMAIL.
  6638******************************************************************
  6639*                                                                *
  6640*                                                                *
  6641*                            ERCMAIL                             *
  6642*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6643*                            VMOD=2.003                          *
  6644*                                                                *
  6645*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6646*                                                                *
  6647*   FILE TYPE = VSAM,KSDS                                        *
  6648*   RECORD SIZE = 374   RECFORM = FIX                            *
  6649*                                                                *
  6650*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6651*   ALTERNATE PATH    = NOT USED                                 *
  6652*                                                                *
  6653*   LOG = YES                                                    *
  6654*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6655******************************************************************
  6656*                   C H A N G E   L O G
  6657*
  6658* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6659*-----------------------------------------------------------------
  6660*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6661* EFFECTIVE    NUMBER
  6662*-----------------------------------------------------------------
  6663* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6664* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6665* 111108                   PEMA  ADD CRED BENE ADDR2
  6666******************************************************************
  6667
  6668 01  MAILING-DATA.
  6669     12  MA-RECORD-ID                      PIC XX.
  6670         88  VALID-MA-ID                       VALUE 'MA'.
  6671
  6672     12  MA-CONTROL-PRIMARY.
  6673         16  MA-COMPANY-CD                 PIC X.
  6674         16  MA-CARRIER                    PIC X.
  6675         16  MA-GROUPING.
  6676             20  MA-GROUPING-PREFIX        PIC XXX.
  6677             20  MA-GROUPING-PRIME         PIC XXX.
  6678         16  MA-STATE                      PIC XX.
  6679         16  MA-ACCOUNT.
  6680             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6681             20  MA-ACCOUNT-PRIME          PIC X(6).
  6682         16  MA-CERT-EFF-DT                PIC XX.
  6683         16  MA-CERT-NO.
  6684             20  MA-CERT-PRIME             PIC X(10).
  6685             20  MA-CERT-SFX               PIC X.
  6686
  6687     12  FILLER                            PIC XX.
  6688
  6689     12  MA-ACCESS-CONTROL.
  6690         16  MA-SOURCE-SYSTEM              PIC XX.
  6691             88  MA-FROM-CREDIT                VALUE 'CR'.
  6692             88  MA-FROM-VSI                   VALUE 'VS'.
  6693             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6694             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 127
* EL130.cbl
  6695         16  MA-RECORD-ADD-DT              PIC XX.
  6696         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6697         16  MA-LAST-MAINT-DT              PIC XX.
  6698         16  MA-LAST-MAINT-BY              PIC XXXX.
  6699         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6700
  6701     12  MA-PROFILE-INFO.
  6702         16  MA-QUALIFY-CODE-1             PIC XX.
  6703         16  MA-QUALIFY-CODE-2             PIC XX.
  6704         16  MA-QUALIFY-CODE-3             PIC XX.
  6705         16  MA-QUALIFY-CODE-4             PIC XX.
  6706         16  MA-QUALIFY-CODE-5             PIC XX.
  6707
  6708         16  MA-INSURED-LAST-NAME          PIC X(15).
  6709         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6710         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6711         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6712         16  MA-INSURED-BIRTH-DT           PIC XX.
  6713         16  MA-INSURED-SEX                PIC X.
  6714             88  MA-SEX-MALE                   VALUE 'M'.
  6715             88  MA-SEX-FEMALE                 VALUE 'F'.
  6716         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6717
  6718         16  MA-ADDRESS-CORRECTED          PIC X.
  6719         16  MA-JOINT-BIRTH-DT             PIC XX.
  6720*        16  FILLER                        PIC X(12).
  6721
  6722         16  MA-ADDRESS-LINE-1             PIC X(30).
  6723         16  MA-ADDRESS-LINE-2             PIC X(30).
  6724         16  MA-CITY-STATE.
  6725             20  MA-CITY                   PIC X(28).
  6726             20  MA-ADDR-STATE             PIC XX.
  6727         16  MA-ZIP.
  6728             20  MA-ZIP-CODE.
  6729                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6730                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6731                 24  FILLER                PIC X(4).
  6732             20  MA-ZIP-PLUS4              PIC X(4).
  6733         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6734             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6735             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6736             20  FILLER                    PIC X(3).
  6737
  6738         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6739
  6740         16  FILLER                        PIC XXX.
  6741*        16  FILLER                        PIC X(10).
  6742
  6743     12  MA-CRED-BENE-INFO.
  6744         16  MA-CRED-BENE-NAME                 PIC X(25).
  6745         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6746         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6747         16  MA-CRED-BENE-CTYST.
  6748             20  MA-CRED-BENE-CITY             PIC X(28).
  6749             20  MA-CRED-BENE-STATE            PIC XX.
  6750         16  MA-CRED-BENE-ZIP.
  6751             20  MA-CB-ZIP-CODE.
  6752                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 128
* EL130.cbl
  6753                     88  MA-CB-CANADIAN-POST-CODE
  6754                                           VALUE 'A' THRU 'Z'.
  6755                 24  FILLER                    PIC X(4).
  6756             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6757         16  MA-CB-CANADIAN-POSTAL-CODE
  6758                            REDEFINES MA-CRED-BENE-ZIP.
  6759             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6760             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6761             20  FILLER                        PIC X(3).
  6762     12  MA-POST-CARD-MAIL-DATA.
  6763         16  MA-MAIL-DATA OCCURS 7.
  6764             20  MA-MAIL-TYPE              PIC X.
  6765                 88  MA-12MO-MAILING           VALUE '1'.
  6766                 88  MA-EXP-MAILING            VALUE '2'.
  6767             20  MA-MAIL-STATUS            PIC X.
  6768                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6769                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6770                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6771             20  MA-MAIL-DATE              PIC XX.
  6772     12  FILLER                            PIC XX.
  6773     12  FILLER                            PIC XX.
  6774*    12  FILLER                            PIC X(30).
  6775******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 129
* EL130.cbl
  6777*    COPY ELCCRTT.
  6778******************************************************************
  6779*                                                                *
  6780*                            ELCCRTT.                            *
  6781*                                                                *
  6782*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  6783*                                                                *
  6784*   FILE TYPE = VSAM,KSDS                                        *
  6785*   RECORD SIZE = 552  RECFORM = FIXED                           *
  6786*                                                                *
  6787*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  6788*                                                                *
  6789*   LOG = YES                                                    *
  6790*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6791******************************************************************
  6792*                   C H A N G E   L O G
  6793*
  6794* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6795*-----------------------------------------------------------------
  6796*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6797* EFFECTIVE    NUMBER
  6798*-----------------------------------------------------------------
  6799* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  6800* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  6801* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  6802* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  6803******************************************************************
  6804
  6805 01  CERTIFICATE-TRAILERS.
  6806     12  CS-RECORD-ID                      PIC XX.
  6807         88  VALID-CS-ID                      VALUE 'CS'.
  6808
  6809     12  CS-CONTROL-PRIMARY.
  6810         16  CS-COMPANY-CD                 PIC X.
  6811         16  CS-CARRIER                    PIC X.
  6812         16  CS-GROUPING                   PIC X(6).
  6813         16  CS-STATE                      PIC XX.
  6814         16  CS-ACCOUNT                    PIC X(10).
  6815         16  CS-CERT-EFF-DT                PIC XX.
  6816         16  CS-CERT-NO.
  6817             20  CS-CERT-PRIME             PIC X(10).
  6818             20  CS-CERT-SFX               PIC X.
  6819         16  CS-TRAILER-TYPE               PIC X.
  6820             88  COMM-TRLR           VALUE 'A'.
  6821             88  FUTURE-TRLR         VALUE 'B'.
  6822             88  CERT-DATA-TRLR      VALUE 'C'.
  6823
  6824     12  CS-DATA-AREA                      PIC X(516).
  6825
  6826     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  6827         16  CS-BANK-COMMISSION-AREA.
  6828             20  CS-BANK-COMMS       OCCURS 10.
  6829                 24  CS-AGT                PIC X(10).
  6830                 24  CS-COM-TYP            PIC X.
  6831                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  6832                 24  CS-RECALC-LV-INDIC    PIC X.
  6833                 24  FILLER                PIC X(10).
  6834         16  FILLER                        PIC X(256).
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 130
* EL130.cbl
  6835
  6836     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  6837         16  CS-VIN-NUMBER                 PIC X(17).
  6838         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  6839         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  6840         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  6841         16  FILLER                        PIC X(496).
  6842******************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 131
* EL130.cbl
  6844
  6845 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  6846                          CONTROL-FILE CERTIFICATE-MASTER
  6847                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  6848                          BENEFICIARY-MASTER
  6849                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  6850                          LETTER-ARCHIVE REINSURANCE-RECORD
  6851                          MAILING-DATA CERTIFICATE-TRAILERS.
  6852 0000-DFHEXIT SECTION.
  6853     MOVE '9#                    $   ' TO DFHEIV0.
  6854     MOVE 'EL130' TO DFHEIV1.
  6855     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6856     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6857     MOVE '5'                    TO DC-OPTION-CODE.
  6858     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6859     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6860     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6861
  6862     IF EIBCALEN = ZERO
  6863         GO TO 8800-UNAUTHORIZED-ACCESS
  6864     END-IF.
  6865
  6866     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6867     MOVE EIBTRMID               TO QID-TERM.
  6868     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  6869     MOVE '2'                    TO EMI-SWITCH2.
  6870     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6871     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6872
  6873
  6874
  6875* EXEC CICS HANDLE CONDITION
  6876*        QIDERR     (0100-TEST-ENTRY)
  6877*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  6878*        PGMIDERR   (9600-PGMID-ERROR)
  6879*        TERMIDERR  (8820-TERM-ERROR)
  6880*        TRANSIDERR (8830-TRAN-ERROR)
  6881*        ERROR      (9990-ABEND)
  6882*    END-EXEC.
  6883*    MOVE '"$N?L[\.              ! " #00006870' TO DFHEIV0
  6884     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  6885     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6886     MOVE X'2220233030303036383730' TO DFHEIV0(25:11)
  6887     CALL 'kxdfhei1' USING DFHEIV0
  6888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6889
  6890
  6891     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  6892        PI-CALLING-PROGRAM   = XCTL-6592
  6893         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  6894     ELSE
  6895         MOVE SPACES             TO RETURNED-FROM
  6896     END-IF.
  6897
  6898     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6899         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6900             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6901             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 132
* EL130.cbl
  6902             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6903             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6904             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6905             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6906             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6907             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6908         ELSE
  6909             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6910             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6911             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6912             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6913             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6914             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6915             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6916             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6917         END-IF
  6918     END-IF.
  6919
  6920     IF EIBTRNID = TRANS-ID
  6921         IF EIBAID = DFHCLEAR
  6922             GO TO 9400-CLEAR
  6923         ELSE
  6924             GO TO 0200-RECEIVE
  6925         END-IF
  6926     END-IF.
  6927
  6928     IF RETURNED-FROM NOT = SPACES
  6929         GO TO 0600-RECOVER-TEMP-STORAGE
  6930     END-IF.
  6931
  6932     MOVE LOW-VALUES TO EL130AO.
  6933
  6934
  6935
  6936* EXEC CICS DELETEQ TS
  6937*         QUEUE   (QID)
  6938*    END-EXEC.
  6939*    MOVE '*&                    #   #00006923' TO DFHEIV0
  6940     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6941     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6942     MOVE X'2020233030303036393233' TO DFHEIV0(25:11)
  6943     CALL 'kxdfhei1' USING DFHEIV0,
  6944           QID,
  6945           DFHEIV99
  6946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6947
  6948
  6949 0100-TEST-ENTRY.
  6950     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  6951         GO TO 0650-FROM-EL127
  6952     ELSE
  6953         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  6954                                    PI-CERT-PROCESSED
  6955                                    PI-LETTER-ERROR-CODE
  6956     END-IF.
  6957
  6958     IF PI-RETURN-TO-PROGRAM = XCTL-132
  6959         GO TO 0640-FROM-EL132
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 133
* EL130.cbl
  6960     END-IF.
  6961
  6962     GO TO 8100-SEND-INITIAL-MAP.
  6963
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 134
* EL130.cbl
  6965 0200-RECEIVE.
  6966     MOVE LOW-VALUES             TO EL130AI.
  6967
  6968     IF PI-PROCESSOR-ID = 'LGXX'
  6969*        NEXT SENTENCE
  6970         CONTINUE
  6971     ELSE
  6972
  6973* EXEC CICS READQ TS
  6974*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6975*            INTO    (SECURITY-CONTROL)
  6976*            LENGTH  (SC-COMM-LENGTH)
  6977*            ITEM    (SC-ITEM)
  6978*        END-EXEC
  6979*    MOVE '*$II   L              ''   #00006950' TO DFHEIV0
  6980     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6981     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6982     MOVE X'2020233030303036393530' TO DFHEIV0(25:11)
  6983     CALL 'kxdfhei1' USING DFHEIV0,
  6984           PI-SECURITY-TEMP-STORE-ID,
  6985           SECURITY-CONTROL,
  6986           SC-COMM-LENGTH,
  6987           SC-ITEM,
  6988           DFHEIV99,
  6989           DFHEIV99
  6990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6991         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  6992         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  6993         IF NOT DISPLAY-CAP
  6994             MOVE 'READ'              TO  SM-READ
  6995             PERFORM 9995-SECURITY-VIOLATION
  6996             MOVE ER-0070             TO  EMI-ERROR
  6997             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6998             GO TO 8100-SEND-INITIAL-MAP
  6999         END-IF
  7000     END-IF.
  7001
  7002     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7003         MOVE ER-7008 TO EMI-ERROR
  7004         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7005         MOVE -1 TO MAINTL
  7006         GO TO 8200-SEND-DATAONLY
  7007     END-IF.
  7008
  7009
  7010
  7011* EXEC CICS RECEIVE
  7012*         MAP     (MAP-NAME)
  7013*         MAPSET  (MAPSET-NAME)
  7014*         INTO    (EL130AI)
  7015*    END-EXEC.
  7016     MOVE LENGTH OF
  7017      EL130AI
  7018       TO DFHEIV11
  7019*    MOVE '8"T I  L              ''   #00006975' TO DFHEIV0
  7020     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7021     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7022     MOVE X'2020233030303036393735' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 135
* EL130.cbl
  7023     CALL 'kxdfhei1' USING DFHEIV0,
  7024           MAP-NAME,
  7025           EL130AI,
  7026           DFHEIV11,
  7027           MAPSET-NAME,
  7028           DFHEIV99,
  7029           DFHEIV99
  7030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7031
  7032
  7033     IF NOT PI-NO-CARRIER-SECURITY
  7034        MOVE +1                  TO CLMCARRL
  7035        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7036     END-IF.
  7037
  7038     IF ENTERPFL = ZERO
  7039         GO TO 0300-CHECK-PFKEYS
  7040     END-IF.
  7041
  7042     IF EIBAID NOT = DFHENTER
  7043         MOVE ER-0004            TO EMI-ERROR
  7044         GO TO 0320-INPUT-ERROR
  7045     END-IF.
  7046
  7047     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7048         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7049     ELSE
  7050         MOVE ER-0029            TO EMI-ERROR
  7051         GO TO 0320-INPUT-ERROR
  7052     END-IF.
  7053
  7054 0300-CHECK-PFKEYS.
  7055     IF EIBAID = DFHPF23
  7056         GO TO 8810-PF23
  7057     END-IF.
  7058
  7059     IF EIBAID = DFHPF24
  7060         GO TO 9200-RETURN-MAIN-MENU
  7061     END-IF.
  7062
  7063     IF EIBAID = DFHPF12
  7064         GO TO 9500-PF12
  7065     END-IF.
  7066
  7067     IF EIBAID = DFHPF3
  7068         MOVE SPACES              TO MAINTI
  7069         MOVE ZEROS               TO MAINTL
  7070         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7071         MOVE XCTL-127            TO PGM-NAME
  7072         GO TO 9300-XCTL
  7073     END-IF.
  7074
  7075     IF EIBAID = DFHPF4
  7076         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7077         MOVE XCTL-132            TO PGM-NAME
  7078         GO TO 9300-XCTL
  7079     END-IF.
  7080
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 136
* EL130.cbl
  7081     IF EIBAID = DFHPF13
  7082         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7083             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7084             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7085             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7086             MOVE PI-STATE            TO  PI-CR-STATE
  7087             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7088             MOVE XCTL-650            TO  PGM-NAME
  7089             GO TO 9300-XCTL
  7090         ELSE
  7091             MOVE -1                  TO  ENTERPFL
  7092             MOVE ER-2566             TO  EMI-ERROR
  7093             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7094             GO TO 8100-SEND-INITIAL-MAP
  7095         END-IF
  7096     END-IF.
  7097
  7098     IF EIBAID = DFHPF5
  7099         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7100             ADD +1 TO PI-CERT-PROCESSED
  7101             GO TO 0650-FROM-EL127
  7102         ELSE
  7103             MOVE ER-7686         TO EMI-ERROR
  7104             GO TO 0320-INPUT-ERROR
  7105         END-IF
  7106     END-IF.
  7107
  7108     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7109         GO TO 0800-TEST-PREVIOUS-CONTROL
  7110     END-IF.
  7111
  7112     IF PI-HAS-CLAS-IC-CRDTCRD
  7113         IF EIBAID = DFHPF10
  7114             MOVE XCTL-725          TO PGM-NAME
  7115             GO TO 9300-XCTL
  7116         END-IF
  7117     END-IF.
  7118
  7119     IF EIBAID = DFHPF14
  7120         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7121         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7122         MOVE XCTL-659            TO PGM-NAME
  7123         GO TO 9300-XCTL
  7124     END-IF.
  7125
  7126     IF EIBAID = DFHPF15
  7127         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7128         MOVE XCTL-114            TO PGM-NAME
  7129         GO TO 9300-XCTL
  7130     END-IF.
  7131
  7132     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7133         GO TO 0330-EDIT-DATA
  7134     END-IF.
  7135
  7136     MOVE ER-0029                TO EMI-ERROR.
  7137
  7138 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 137
* EL130.cbl
  7139     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7140
  7141     MOVE AL-UNBON               TO ENTERPFA.
  7142
  7143     IF ENTERPFL = ZERO
  7144         MOVE -1                 TO MAINTL
  7145     ELSE
  7146         MOVE -1                 TO ENTERPFL
  7147     END-IF.
  7148
  7149     GO TO 8200-SEND-DATAONLY.
  7150
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 138
* EL130.cbl
  7152 0330-EDIT-DATA.
  7153
  7154     IF MAINTI = 'S'
  7155         IF PRTOPTL GREATER THAN 0
  7156             IF PRTOPTI NOT = 'N' AND 'L'
  7157                 MOVE AL-UABON   TO  PRTOPTA
  7158                 MOVE -1         TO  PRTOPTL
  7159                 MOVE ER-0334    TO  EMI-ERROR
  7160                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7161                 GO TO 8200-SEND-DATAONLY
  7162             ELSE
  7163                 IF PRTOPTI = 'L'
  7164                     GO TO 0400-CREATE-ELACTQ
  7165                 ELSE
  7166                     GO TO 0480-PRINT-NOW
  7167                 END-IF
  7168             END-IF
  7169         ELSE
  7170             GO TO 1000-SHOW-CLAIM
  7171         END-IF
  7172     END-IF.
  7173
  7174     IF NOT MODIFY-CAP
  7175         MOVE 'UPDATE'       TO  SM-READ
  7176         PERFORM 9995-SECURITY-VIOLATION
  7177         MOVE ER-0070        TO  EMI-ERROR
  7178         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7179         GO TO 8100-SEND-INITIAL-MAP
  7180     END-IF.
  7181
  7182     IF MAINTI = 'D'
  7183         GO TO 2000-DELETE-CLAIM
  7184     END-IF.
  7185
  7186     IF MAINTI = 'A'
  7187         GO TO 3000-ADD-CLAIM
  7188     END-IF.
  7189
  7190     IF MAINTI = 'I'
  7191         GO TO 5000-INCURRED-CHANGE
  7192     END-IF.
  7193
  7194     MOVE ER-0023                TO EMI-ERROR.
  7195     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7196     MOVE -1                     TO MAINTL.
  7197     MOVE AL-UABON               TO MAINTA.
  7198
  7199     GO TO 8200-SEND-DATAONLY.
  7200
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 139
* EL130.cbl
  7202 0400-CREATE-ELACTQ.
  7203     IF CLMNOI   = PI-LAST-CLAIM      AND
  7204        CLMCARRI = PI-LAST-CARR       AND
  7205        CERTNOI  = PI-LAST-CERT-PRIME AND
  7206        SUFXI    = PI-LAST-CERT-SUFX
  7207         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7208         MOVE PI-LAST-CARR       TO PI-CARRIER
  7209         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7210     ELSE
  7211         MOVE ER-0207            TO EMI-ERROR
  7212         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7213         MOVE -1                 TO MAINTL
  7214         GO TO 8200-SEND-DATAONLY
  7215     END-IF.
  7216
  7217     IF (NOT PI-NO-CARRIER-SECURITY OR
  7218         NOT PI-NO-ACCOUNT-SECURITY)
  7219         MOVE AL-UABON      TO  PRTOPTA
  7220         MOVE -1            TO  PRTOPTL
  7221         MOVE ER-2378       TO  EMI-ERROR
  7222         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7223         GO TO 8200-SEND-DATAONLY
  7224     END-IF.
  7225
  7226     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7227     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7228     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7229     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7230
  7231
  7232
  7233* EXEC CICS HANDLE CONDITION
  7234*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7235*    END-EXEC.
  7236*    MOVE '"$I                   ! # #00007180' TO DFHEIV0
  7237     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7238     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7239     MOVE X'2320233030303037313830' TO DFHEIV0(25:11)
  7240     CALL 'kxdfhei1' USING DFHEIV0
  7241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7242
  7243
  7244
  7245
  7246* EXEC CICS READ
  7247*         UPDATE
  7248*         DATASET    (ELACTQ-DSID)
  7249*         SET        (ADDRESS OF ACTIVITY-QUE)
  7250*         RIDFLD     (ELACTQ-KEY)
  7251*    END-EXEC.
  7252*    MOVE '&"S        EU         (   #00007185' TO DFHEIV0
  7253     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7254     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7255     MOVE X'2020233030303037313835' TO DFHEIV0(25:11)
  7256     CALL 'kxdfhei1' USING DFHEIV0,
  7257           ELACTQ-DSID,
  7258           DFHEIV20,
  7259           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 140
* EL130.cbl
  7260           ELACTQ-KEY,
  7261           DFHEIV99,
  7262           DFHEIV99,
  7263           DFHEIV99
  7264     SET ADDRESS OF ACTIVITY-QUE TO
  7265         DFHEIV20
  7266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7267
  7268
  7269     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7270     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7271
  7272
  7273
  7274* EXEC CICS REWRITE
  7275*         DATASET     (ELACTQ-DSID)
  7276*         FROM        (ACTIVITY-QUE)
  7277*    END-EXEC.
  7278     MOVE LENGTH OF
  7279      ACTIVITY-QUE
  7280       TO DFHEIV11
  7281*    MOVE '&& L                  %   #00007196' TO DFHEIV0
  7282     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7283     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7284     MOVE X'2020233030303037313936' TO DFHEIV0(25:11)
  7285     CALL 'kxdfhei1' USING DFHEIV0,
  7286           ELACTQ-DSID,
  7287           ACTIVITY-QUE,
  7288           DFHEIV11,
  7289           DFHEIV99
  7290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7291
  7292
  7293     GO TO 0470-STATUS-FINISH.
  7294
  7295 0450-ADD-ELACTQ-RECORD.
  7296
  7297
  7298* EXEC CICS GETMAIN
  7299*        SET     (ADDRESS OF ACTIVITY-QUE)
  7300*        LENGTH  (ELACTQ-LENGTH)
  7301*        INITIMG (GETMAIN-SPACE)
  7302*    END-EXEC.
  7303*    MOVE ',"IL                  $   #00007205' TO DFHEIV0
  7304     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7305     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7306     MOVE X'2020233030303037323035' TO DFHEIV0(25:11)
  7307     CALL 'kxdfhei1' USING DFHEIV0,
  7308           DFHEIV20,
  7309           ELACTQ-LENGTH,
  7310           GETMAIN-SPACE
  7311     SET ADDRESS OF ACTIVITY-QUE TO
  7312         DFHEIV20
  7313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7314
  7315
  7316     MOVE 'AQ'              TO AQ-RECORD-ID.
  7317     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 141
* EL130.cbl
  7318     MOVE +0                TO AQ-PAYMENT-COUNTER
  7319                               AQ-PMT-UNAPPROVED-COUNT.
  7320     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7321                               AQ-FOLLOWUP-DATE.
  7322     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7323     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7324
  7325
  7326
  7327* EXEC CICS WRITE
  7328*         DATASET     (ELACTQ-DSID)
  7329*         FROM        (ACTIVITY-QUE)
  7330*         RIDFLD      (ELACTQ-KEY)
  7331*    END-EXEC.
  7332     MOVE LENGTH OF
  7333      ACTIVITY-QUE
  7334       TO DFHEIV11
  7335*    MOVE '&$ L                  ''   #00007221' TO DFHEIV0
  7336     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7337     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7338     MOVE X'2020233030303037323231' TO DFHEIV0(25:11)
  7339     CALL 'kxdfhei1' USING DFHEIV0,
  7340           ELACTQ-DSID,
  7341           ACTIVITY-QUE,
  7342           DFHEIV11,
  7343           ELACTQ-KEY,
  7344           DFHEIV99,
  7345           DFHEIV99
  7346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7347
  7348
  7349 0470-STATUS-FINISH.
  7350     MOVE AL-UANOF               TO  PRTOPTA
  7351                                     ALTPRTA.
  7352
  7353     MOVE SPACES                 TO  PRTOPTO
  7354                                     ALTPRTO.
  7355
  7356     MOVE ER-0000                TO EMI-ERROR.
  7357     MOVE -1                     TO MAINTL.
  7358     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7359     GO TO 8100-SEND-INITIAL-MAP.
  7360
  7361 0480-PRINT-NOW.
  7362
  7363
  7364* EXEC CICS HANDLE CONDITION
  7365*        TERMIDERR   (8820-TERM-ERROR)
  7366*        TRANSIDERR  (8830-TRAN-ERROR)
  7367*    END-EXEC.
  7368*    MOVE '"$[\                  ! $ #00007241' TO DFHEIV0
  7369     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7371     MOVE X'2420233030303037323431' TO DFHEIV0(25:11)
  7372     CALL 'kxdfhei1' USING DFHEIV0
  7373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7374
  7375
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 142
* EL130.cbl
  7376     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7377     MOVE '1'                    TO  CNTL-REC-TYPE.
  7378     MOVE SPACES                 TO  CNTL-ACCESS.
  7379     MOVE +0                     TO  CNTL-SEQ-NO.
  7380     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7381
  7382     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7383
  7384     IF CF-FORMS-PRINTER-ID = SPACES
  7385         IF ALTPRTL NOT GREATER THAN 0
  7386             MOVE ER-0337        TO  EMI-ERROR
  7387             MOVE -1             TO  ALTPRTL
  7388             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7389             GO TO 8200-SEND-DATAONLY
  7390         END-IF
  7391     END-IF.
  7392
  7393     IF ALTPRTL GREATER THAN 0
  7394         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7395     END-IF.
  7396
  7397     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7398     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7399     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7400
  7401
  7402
  7403* EXEC CICS START
  7404*        TRANSID   (START-TRANS-ID)
  7405*        TERMID    (CF-FORMS-PRINTER-ID)
  7406*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7407*        LENGTH    (PI-COMM-LENGTH)
  7408*    END-EXEC.
  7409*    MOVE '0( LFT                1   #00007272' TO DFHEIV0
  7410     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7411     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7412     MOVE X'2020233030303037323732' TO DFHEIV0(25:11)
  7413     CALL 'kxdfhei1' USING DFHEIV0,
  7414           DFHEIV99,
  7415           START-TRANS-ID,
  7416           DFHEIV99,
  7417           PROGRAM-INTERFACE-BLOCK,
  7418           PI-COMM-LENGTH,
  7419           CF-FORMS-PRINTER-ID,
  7420           DFHEIV99,
  7421           DFHEIV99,
  7422           DFHEIV99,
  7423           DFHEIV99,
  7424           DFHEIV99,
  7425           DFHEIV99,
  7426           DFHEIV99,
  7427           DFHEIV99,
  7428           DFHEIV99,
  7429           DFHEIV99
  7430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7431
  7432
  7433     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 143
* EL130.cbl
  7434                                     ALTPRTA.
  7435
  7436     MOVE SPACES                 TO  PRTOPTO
  7437                                     ALTPRTO.
  7438
  7439     MOVE ER-0000                TO  EMI-ERROR.
  7440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7441     MOVE -1                     TO  MAINTL.
  7442     GO TO 8100-SEND-INITIAL-MAP.
  7443
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 144
* EL130.cbl
  7445 0500-CREATE-TEMP-STORAGE.
  7446     MOVE EIBCPOSN               TO PI-CURSOR.
  7447
  7448
  7449
  7450* EXEC CICS WRITEQ TS
  7451*        QUEUE   (QID)
  7452*        FROM    (EL130AI)
  7453*        LENGTH  (QID-MAP-LENGTH)
  7454*    END-EXEC.
  7455*    MOVE '*"                    ''   #00007295' TO DFHEIV0
  7456     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7457     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7458     MOVE X'2020233030303037323935' TO DFHEIV0(25:11)
  7459     CALL 'kxdfhei1' USING DFHEIV0,
  7460           QID,
  7461           EL130AI,
  7462           QID-MAP-LENGTH,
  7463           DFHEIV99,
  7464           DFHEIV99,
  7465           DFHEIV99
  7466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7467
  7468
  7469
  7470
  7471* EXEC CICS WRITEQ TS
  7472*        QUEUE    (QID)
  7473*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7474*        LENGTH   (PI-COMM-LENGTH)
  7475*    END-EXEC.
  7476*    MOVE '*"                    ''   #00007302' TO DFHEIV0
  7477     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7478     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7479     MOVE X'2020233030303037333032' TO DFHEIV0(25:11)
  7480     CALL 'kxdfhei1' USING DFHEIV0,
  7481           QID,
  7482           PROGRAM-INTERFACE-BLOCK,
  7483           PI-COMM-LENGTH,
  7484           DFHEIV99,
  7485           DFHEIV99,
  7486           DFHEIV99
  7487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7488
  7489
  7490 0599-EXIT.
  7491      EXIT.
  7492
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 145
* EL130.cbl
  7494 0600-RECOVER-TEMP-STORAGE.
  7495     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7496     MOVE PI-EL127-TO-EL130-CNTRL
  7497                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7498     MOVE PI-EL659-TO-EL130-CNTRL
  7499                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7500     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7501     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7502     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7503     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7504     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7505     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7506     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7507     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7508     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7509     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7510     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7511     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7512     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7513     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7514     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7515     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7516                                 TO SAVE-BENEFICIARY
  7517
  7518
  7519
  7520* EXEC CICS HANDLE CONDITION
  7521*        NOTFND  (0660-NOT-FOUND)
  7522*        QIDERR  (0670-QIDERR)
  7523*    END-EXEC.
  7524*    MOVE '"$IN                  ! % #00007337' TO DFHEIV0
  7525     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7527     MOVE X'2520233030303037333337' TO DFHEIV0(25:11)
  7528     CALL 'kxdfhei1' USING DFHEIV0
  7529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7530
  7531
  7532
  7533
  7534* EXEC CICS READQ TS
  7535*        QUEUE    (QID)
  7536*        INTO     (EL130AI)
  7537*        LENGTH   (QID-MAP-LENGTH)
  7538*    END-EXEC.
  7539*    MOVE '*$I    L              ''   #00007343' TO DFHEIV0
  7540     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7541     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7542     MOVE X'2020233030303037333433' TO DFHEIV0(25:11)
  7543     CALL 'kxdfhei1' USING DFHEIV0,
  7544           QID,
  7545           EL130AI,
  7546           QID-MAP-LENGTH,
  7547           DFHEIV99,
  7548           DFHEIV99,
  7549           DFHEIV99
  7550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7551
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 146
* EL130.cbl
  7552
  7553     IF RETURNED-FROM = XCTL-131
  7554        IF CLAIM-DELETED-BY-EL131
  7555            MOVE LOW-VALUES      TO CERTNOI
  7556                                    SUFXI
  7557            MOVE ZEROS           TO CERTNOL
  7558                                    SUFXL
  7559         END-IF
  7560     END-IF.
  7561
  7562     IF RETURNED-FROM = XCTL-131
  7563         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7564         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7565                                    PI-CERT-PROCESSED
  7566     ELSE
  7567
  7568
  7569* EXEC CICS READQ TS
  7570*             QUEUE   (QID)
  7571*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7572*             LENGTH  (PI-COMM-LENGTH)
  7573*        END-EXEC
  7574*    MOVE '*$I    L              ''   #00007364' TO DFHEIV0
  7575     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7576     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7577     MOVE X'2020233030303037333634' TO DFHEIV0(25:11)
  7578     CALL 'kxdfhei1' USING DFHEIV0,
  7579           QID,
  7580           PROGRAM-INTERFACE-BLOCK,
  7581           PI-COMM-LENGTH,
  7582           DFHEIV99,
  7583           DFHEIV99,
  7584           DFHEIV99
  7585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7586     END-IF.
  7587
  7588
  7589* EXEC CICS DELETEQ TS
  7590*        QUEUE   (QID)
  7591*    END-EXEC.
  7592*    MOVE '*&                    #   #00007371' TO DFHEIV0
  7593     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7594     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7595     MOVE X'2020233030303037333731' TO DFHEIV0(25:11)
  7596     CALL 'kxdfhei1' USING DFHEIV0,
  7597           QID,
  7598           DFHEIV99
  7599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7600
  7601
  7602     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7603
  7604     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7605         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7606         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7607         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7608         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7609         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 147
* EL130.cbl
  7610         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7611         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7612         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7613         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7614         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7615         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7616         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7617         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7618         MOVE SAVE-CERT-ACCESS-CONTROL
  7619                                    TO PI-CERT-ACCESS-CONTROL
  7620         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7621                                    TO PI-CARRIER-CONTROL-LEVEL
  7622     END-IF.
  7623
  7624     IF RETURNED-FROM = XCTL-127
  7625         MOVE SAVE-EL127-TO-EL130-CNTRL
  7626                                 TO PI-EL127-TO-EL130-CNTRL
  7627     END-IF.
  7628
  7629     IF RETURNED-FROM = XCTL-6592
  7630        MOVE SAVE-EL659-TO-EL130-CNTRL
  7631                                 TO PI-EL659-TO-EL130-CNTRL
  7632     END-IF.
  7633
  7634     IF RETURNED-FROM = XCTL-114
  7635        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7636           MOVE SAVE-BENEFICIARY TO BENECDI
  7637           MOVE +10              TO BENECDL
  7638           MOVE -1               TO BIRTHDTL
  7639        END-IF
  7640     END-IF.
  7641     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7642
  7643     IF MAINTL NOT = ZERO
  7644         MOVE AL-UANON           TO MAINTA
  7645     END-IF.
  7646
  7647     IF ENTERPFL NOT = ZERO
  7648         MOVE AL-UNNON           TO ENTERPFA
  7649     END-IF.
  7650
  7651     IF RETURNED-FROM = XCTL-127
  7652         GO TO 0650-FROM-EL127
  7653     END-IF.
  7654
  7655     IF RETURNED-FROM = XCTL-132
  7656         GO TO 0640-FROM-EL132
  7657     END-IF.
  7658
  7659     IF RETURNED-FROM = XCTL-650
  7660         MOVE AL-SABON           TO PF5A
  7661         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
  7662     END-IF.
  7663
  7664     IF RETURNED-FROM = XCTL-6592
  7665         GO TO 0630-FROM-EL6592
  7666     END-IF.
  7667
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 148
* EL130.cbl
  7668     IF MAINTI = 'S' OR 'I'
  7669        GO TO 1000-SHOW-CLAIM
  7670     END-IF.
  7671
  7672     GO TO 8100-SEND-INITIAL-MAP.
  7673
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 149
* EL130.cbl
  7675 0630-FROM-EL6592.
  7676     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7677     MOVE PI-EL659-GROUPING      TO GROUPO.
  7678     MOVE PI-EL659-STATE         TO STATEO.
  7679     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7680
  7681     MOVE AL-UANON               TO CRTCARRA
  7682                                    GROUPA
  7683                                    STATEA
  7684                                    ACCOUNTA.
  7685     GO TO 8100-SEND-INITIAL-MAP.
  7686
  7687 0640-FROM-EL132.
  7688     IF PI-CLAIM-NO = SPACES
  7689         GO TO 0645-NO-CLAIM-SELECTED
  7690     END-IF.
  7691
  7692     MOVE LOW-VALUES             TO EL130AI.
  7693     MOVE 'MSTR'                 TO FILE-SWITCH.
  7694     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7695     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7696     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7697                                    CLMNOO.
  7698     MOVE AL-UANON               TO CLMNOA.
  7699     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7700
  7701
  7702
  7703* EXEC CICS HANDLE CONDITION
  7704*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7705*    END-EXEC.
  7706*    MOVE '"$I                   ! & #00007475' TO DFHEIV0
  7707     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7708     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7709     MOVE X'2620233030303037343735' TO DFHEIV0(25:11)
  7710     CALL 'kxdfhei1' USING DFHEIV0
  7711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7712
  7713
  7714     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7715     MOVE 'X'                    TO CLAIM-SWITCH.
  7716     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7717     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7718     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7719     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7720
  7721     MOVE ER-0213                TO EMI-ERROR.
  7722     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7723     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7724     GO TO 8100-SEND-INITIAL-MAP.
  7725
  7726 0645-NO-CLAIM-SELECTED.
  7727
  7728     IF MAINTI = 'S' OR 'I'
  7729        GO TO 1000-SHOW-CLAIM
  7730     END-IF.
  7731
  7732     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 150
* EL130.cbl
  7733
  7734 0650-FROM-EL127.
  7735
  7736     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7737         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7738                                    PI-CERT-PROCESSED
  7739     END-IF.
  7740
  7741     IF PI-RETURN-TO-PROGRAM = XCTL-727
  7742         MOVE +1                 TO PI-CERT-SELECT-CNT
  7743                                    PI-CERT-PROCESSED
  7744         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  7745         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  7746         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  7747         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  7748         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  7749         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  7750     END-IF.
  7751
  7752     IF PI-CERT-SELECT-CNT = ZERO
  7753         IF CERTNOI NOT = SPACES AND LOW-VALUES
  7754             MOVE CERTNOI        TO PI-CERT-NO
  7755             MOVE SUFXI          TO PI-CERT-SFX
  7756             GO TO 3000-READ-CERT
  7757         ELSE
  7758             GO TO 8100-SEND-INITIAL-MAP
  7759         END-IF
  7760     END-IF.
  7761
  7762     MOVE AL-SABON               TO PF5A.
  7763
  7764     IF PI-CERT-PROCESSED = 1
  7765         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  7766     END-IF.
  7767
  7768     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  7769     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  7770
  7771     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  7772     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  7773                                 TO CERT-CARRIER
  7774                                    PI-CARRIER.
  7775     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  7776                                 TO CERT-GROUPING
  7777                                    PI-GROUPING.
  7778     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  7779                                 TO CERT-STATE
  7780                                    PI-STATE.
  7781     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  7782                                 TO CERT-ACCOUNT
  7783                                    PI-ACCOUNT.
  7784     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  7785                                 TO CERT-EFF-DT
  7786                                    PI-CERT-EFF-DT.
  7787     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  7788                                 TO CERT-CERT-NO
  7789                                    PI-CERT-NO.
  7790
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 151
* EL130.cbl
  7791     MOVE 'CERT'                 TO FILE-SWITCH.
  7792     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  7793
  7794     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  7795     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  7796     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  7797
  7798     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  7799         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  7800         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  7801         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  7802         IF INCURRED-DATE-MATCH
  7803             MOVE ER-7352        TO EMI-ERROR
  7804             MOVE -1             TO CERTNOL
  7805             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7806         ELSE
  7807             IF NO-CLAIMS-FOR-CERT
  7808                 MOVE ER-7353    TO EMI-ERROR
  7809                 MOVE -1         TO CERTNOL
  7810                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7811             ELSE
  7812                 MOVE ER-0558    TO EMI-ERROR
  7813                 MOVE -1         TO CERTNOL
  7814                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7815             END-IF
  7816         END-IF
  7817     END-IF.
  7818
  7819     MOVE SPACES                 TO PI-PRT-OPT
  7820                                    PI-ALT-PRT.
  7821
  7822     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7823
  7824     IF LSTNMEL NOT GREATER ZERO
  7825        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  7826         MOVE CRTLNMEI           TO  LSTNMEO
  7827         MOVE CRTFNMEI           TO  FSTNMEO
  7828         MOVE CRTINITI           TO  INITO
  7829         MOVE AL-UANON           TO  LSTNMEA
  7830                                     FSTNMEA
  7831                                     INITA
  7832     END-IF.
  7833
  7834     IF SSNL GREATER ZERO
  7835         GO TO 0655-SKIP-SOCIAL-SECURITY
  7836     END-IF.
  7837
  7838     IF CRTSSNI = SPACES OR LOW-VALUES
  7839         GO TO 0655-SKIP-SOCIAL-SECURITY
  7840     END-IF.
  7841
  7842     IF CM-SSN-STATE   = CM-STATE AND
  7843        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  7844            GO TO 0655-SKIP-SOCIAL-SECURITY
  7845     END-IF.
  7846
  7847     MOVE CRTSSNI                TO SSNO
  7848     MOVE AL-UANON               TO SSNA.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 152
* EL130.cbl
  7849
  7850 0655-SKIP-SOCIAL-SECURITY.
  7851
  7852     IF CLMCARRL NOT = ZERO  AND
  7853        CLMCARRI NOT = CRTCARRI
  7854        MOVE ER-0562             TO EMI-ERROR
  7855        MOVE AL-UABON            TO CLMCARRA
  7856        MOVE -1                  TO CLMCARRL
  7857        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7858     END-IF.
  7859
  7860     IF CLMCARRL = ZERO
  7861        MOVE AL-UANON            TO CLMCARRA
  7862        MOVE CRTCARRI            TO CLMCARRI
  7863     END-IF.
  7864
  7865     MOVE 'A'                    TO MAINTO.
  7866     MOVE AL-UANON               TO MAINTA.
  7867
  7868     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7869        GO TO 8100-SEND-INITIAL-MAP
  7870     ELSE
  7871        GO TO 8150-SEND-MAP-CURSOR
  7872     END-IF.
  7873
  7874 0660-NOT-FOUND.
  7875     MOVE ER-0214                TO EMI-ERROR.
  7876     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7877     GO TO 8100-SEND-INITIAL-MAP.
  7878
  7879 0670-QIDERR.
  7880     MOVE ER-0033                TO EMI-ERROR.
  7881     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7882     GO TO 8100-SEND-INITIAL-MAP.
  7883
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 153
* EL130.cbl
  7885 0680-PLUG-SELECTED-CERTS.
  7886
  7887     MOVE AL-SANON               TO BCERT1A
  7888                                    BSUFX1A
  7889                                    BCERT2A
  7890                                    BSUFX2A
  7891                                    BCERT3A
  7892                                    BSUFX3A
  7893                                    BCERT4A
  7894                                    BSUFX4A
  7895                                    BCERT5A
  7896                                    BSUFX5A.
  7897
  7898     IF PCERTNOO = SPACES OR LOW-VALUES
  7899         MOVE PI-EL127-CERT-PRIME (1)
  7900                                 TO PCERTNOO
  7901         MOVE PI-EL127-CERT-SUFX  (1)
  7902                                 TO PSUFXO
  7903     END-IF.
  7904
  7905     MOVE PI-EL127-CERT-PRIME (1)
  7906                                 TO BCERT1O.
  7907     MOVE PI-EL127-CERT-SUFX  (1)
  7908                                 TO BSUFX1O.
  7909
  7910     IF PI-CERT-SELECT-CNT GREATER THAN 1
  7911         MOVE PI-EL127-CERT-PRIME (2)
  7912                                 TO BCERT2O
  7913         MOVE PI-EL127-CERT-SUFX  (2)
  7914                                 TO BSUFX2O
  7915     ELSE
  7916         MOVE LOW-VALUES         TO BCERT2O
  7917                                    BSUFX2O
  7918     END-IF.
  7919
  7920     IF PI-CERT-SELECT-CNT GREATER THAN 2
  7921         MOVE PI-EL127-CERT-PRIME (3)
  7922                                 TO BCERT3O
  7923         MOVE PI-EL127-CERT-SUFX  (3)
  7924                                 TO BSUFX3O
  7925     ELSE
  7926         MOVE LOW-VALUES         TO BCERT3O
  7927                                    BSUFX3O
  7928     END-IF.
  7929
  7930     IF PI-CERT-SELECT-CNT GREATER THAN 3
  7931         MOVE PI-EL127-CERT-PRIME (4)
  7932                                 TO BCERT4O
  7933         MOVE PI-EL127-CERT-SUFX  (4)
  7934                                 TO BSUFX4O
  7935     ELSE
  7936         MOVE LOW-VALUES         TO BCERT4O
  7937                                    BSUFX4O
  7938     END-IF.
  7939
  7940     IF PI-CERT-SELECT-CNT GREATER THAN 4
  7941         MOVE PI-EL127-CERT-PRIME (5)
  7942                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 154
* EL130.cbl
  7943         MOVE PI-EL127-CERT-SUFX  (5)
  7944                                 TO BSUFX5O
  7945     ELSE
  7946         MOVE LOW-VALUES         TO BCERT5O
  7947                                    BSUFX5O
  7948     END-IF.
  7949
  7950 0680-EXIT.
  7951     EXIT.
  7952
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 155
* EL130.cbl
  7954 0690-HIGHLIGHT-CERTS.
  7955
  7956     MOVE AL-UANON               TO PCERTNOA
  7957                                    PSUFXA.
  7958
  7959     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7960        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7961            MOVE AL-SABON        TO BCERT1A
  7962                                    BSUFX1A
  7963     ELSE
  7964         MOVE AL-SANON           TO BCERT1A
  7965                                    BSUFX1A
  7966     END-IF.
  7967
  7968     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7969        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7970            MOVE AL-SABON        TO BCERT2A
  7971                                    BSUFX2A
  7972     ELSE
  7973         MOVE AL-SANON           TO BCERT2A
  7974                                    BSUFX2A
  7975     END-IF.
  7976
  7977     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7978        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7979            MOVE AL-SABON        TO BCERT3A
  7980                                    BSUFX3A
  7981     ELSE
  7982         MOVE AL-SANON           TO BCERT3A
  7983                                    BSUFX3A
  7984     END-IF.
  7985
  7986     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7987        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7988            MOVE AL-SABON        TO BCERT4A
  7989                                    BSUFX4A
  7990     ELSE
  7991         MOVE AL-SANON           TO BCERT4A
  7992                                    BSUFX4A
  7993     END-IF.
  7994
  7995     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7996        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7997            MOVE AL-SABON        TO BCERT5A
  7998                                    BSUFX5A
  7999     ELSE
  8000         MOVE AL-SANON           TO BCERT5A
  8001                                    BSUFX5A
  8002     END-IF.
  8003
  8004 0690-EXIT.
  8005     EXIT.
  8006
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 156
* EL130.cbl
  8008 0800-TEST-PREVIOUS-CONTROL.
  8009     IF CLMNOI   = PI-LAST-CLAIM       AND
  8010        CLMCARRI = PI-LAST-CARR        AND
  8011        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8012        SUFXI    = PI-LAST-CERT-SUFX
  8013*        NEXT SENTENCE
  8014         CONTINUE
  8015     ELSE
  8016         MOVE ER-0207            TO EMI-ERROR
  8017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8018         MOVE -1                 TO MAINTL
  8019         GO TO 8200-SEND-DATAONLY
  8020     END-IF.
  8021
  8022     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8023
  8024     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8025     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8026     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8027
  8028     IF EIBAID = DFHPF7
  8029         MOVE XCTL-157           TO PGM-NAME
  8030     END-IF.
  8031
  8032     IF EIBAID = DFHPF8
  8033         MOVE XCTL-141           TO PGM-NAME
  8034     END-IF.
  8035
  8036     IF EIBAID = DFHPF9
  8037        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8038                                    PI-SAVED-PROGRAM-2
  8039                                    PI-SAVED-PROGRAM-3
  8040                                    PI-SAVED-PROGRAM-4
  8041                                    PI-SAVED-PROGRAM-5
  8042                                    PI-SAVED-PROGRAM-6
  8043        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8044        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8045        MOVE XCTL-150            TO PGM-NAME
  8046     END-IF.
  8047
  8048     GO TO 9300-XCTL.
  8049
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 157
* EL130.cbl
  8051 1000-SHOW-CLAIM.
  8052
  8053     IF CLMNOL = ZERO
  8054         MOVE -1                 TO CLMNOL
  8055         MOVE AL-UABON           TO CLMNOA
  8056         MOVE ER-0202            TO EMI-ERROR
  8057         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8058     ELSE
  8059         MOVE AL-UANON           TO CLMNOA
  8060     END-IF.
  8061
  8062     IF PI-NO-CARRIER-SECURITY
  8063        IF CLMCARRL = ZERO
  8064             MOVE -1             TO CLMCARRL
  8065             MOVE AL-UABON       TO CLMCARRA
  8066             MOVE ER-0194        TO EMI-ERROR
  8067             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8068         ELSE
  8069             MOVE AL-UANON       TO CLMCARRA
  8070         END-IF
  8071     END-IF.
  8072
  8073     IF SUFXL = ZERO
  8074         MOVE SPACES             TO SUFXI
  8075         MOVE AL-UANON           TO SUFXA
  8076     ELSE
  8077         MOVE AL-UANON           TO SUFXA
  8078     END-IF.
  8079
  8080     IF NOT EMI-NO-ERRORS
  8081         GO TO 1050-SEND-CHECK
  8082     END-IF.
  8083
  8084
  8085
  8086* EXEC CICS HANDLE CONDITION
  8087*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8088*    END-EXEC.
  8089*    MOVE '"$I                   ! '' #00007850' TO DFHEIV0
  8090     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8091     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8092     MOVE X'2720233030303037383530' TO DFHEIV0(25:11)
  8093     CALL 'kxdfhei1' USING DFHEIV0
  8094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8095
  8096
  8097     MOVE 'MSTR'                 TO FILE-SWITCH
  8098     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8099
  8100     MOVE CLMCARRI               TO MSTR-CARRIER.
  8101     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8102
  8103     IF CERTNOL = ZERO     OR
  8104        CERTNOI = SPACES   OR
  8105        CERTNOI = LOW-VALUES
  8106         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8107         MOVE AL-SANON        TO CERTNOA
  8108                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 158
* EL130.cbl
  8109     ELSE
  8110         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8111     END-IF.
  8112
  8113     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8114     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8115
  8116
  8117
  8118* EXEC CICS HANDLE CONDITION
  8119*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8120*    END-EXEC.
  8121*    MOVE '"$I                   ! ( #00007874' TO DFHEIV0
  8122     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8123     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8124     MOVE X'2820233030303037383734' TO DFHEIV0(25:11)
  8125     CALL 'kxdfhei1' USING DFHEIV0
  8126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8127
  8128
  8129     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8130
  8131     IF NOT PI-NO-ACCOUNT-SECURITY
  8132         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8133           MOVE ER-2371          TO EMI-ERROR
  8134           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8135           MOVE -1               TO MAINTL
  8136           GO TO 8200-SEND-DATAONLY
  8137         END-IF
  8138     END-IF.
  8139
  8140
  8141
  8142* EXEC CICS HANDLE CONDITION
  8143*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8144*    END-EXEC.
  8145*    MOVE '"$I                   ! ) #00007890' TO DFHEIV0
  8146     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8147     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8148     MOVE X'2920233030303037383930' TO DFHEIV0(25:11)
  8149     CALL 'kxdfhei1' USING DFHEIV0
  8150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8151
  8152
  8153     MOVE 'Y'                    TO CLAIM-SWITCH.
  8154     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8155     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8156     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8157
  8158 1000-SHOW-END-OF-PERFORM.
  8159
  8160     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8161     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8162     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8163     MOVE CL-CERT-STATE          TO CERT-STATE.
  8164     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8165     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8166     MOVE CL-CERT-NO             TO CERT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 159
* EL130.cbl
  8167
  8168     MOVE 'CERT'                 TO FILE-SWITCH.
  8169
  8170     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8171
  8172     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8173     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8174     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8175     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8176     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8177     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8178     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8179     MOVE CLMCARRI               TO PI-LAST-CARR.
  8180
  8181     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8182
  8183     IF MAINTI = 'I'
  8184         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8185                 BIRTHDTA  LSTNMEA   RELCLMA   OCCCDA
  8186                 LOANNOA   LOANBALA  BENECDA
  8187         MOVE AL-SANON TO  SSNA
  8188         MOVE SPACES   TO  INCURI    REPORTI  ESTENDI
  8189         MOVE 'Y'      TO PI-INCURR-SW
  8190         MOVE ER-0522  TO EMI-ERROR
  8191         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8192     ELSE
  8193         MOVE ' '      TO PI-INCURR-SW
  8194     END-IF.
  8195
  8196     MOVE -1                     TO MAINTL.
  8197     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8198     MOVE CERT-GROUPING          TO PI-GROUPING.
  8199     MOVE CERT-STATE             TO PI-STATE.
  8200     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8201     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8202     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8203     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8204
  8205     IF RETURNED-FROM NOT = SPACES
  8206         GO TO 8100-SEND-INITIAL-MAP
  8207     ELSE
  8208         GO TO 8200-SEND-DATAONLY
  8209     END-IF.
  8210
  8211 1025-SHOW-RECORD-NOT-FOUND.
  8212
  8213     IF FILE-SWITCH = 'MSTR'
  8214         MOVE ER-0204            TO EMI-ERROR
  8215     ELSE
  8216         IF FILE-SWITCH = 'TRLR'
  8217             MOVE ER-0205        TO EMI-ERROR
  8218         ELSE
  8219             MOVE ER-0206        TO EMI-ERROR
  8220         END-IF
  8221     END-IF.
  8222
  8223     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8224
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 160
* EL130.cbl
  8225 1050-SEND-CHECK.
  8226
  8227     IF RETURNED-FROM NOT = SPACES
  8228         GO TO 8100-SEND-INITIAL-MAP
  8229     ELSE
  8230         MOVE -1                 TO MAINTL
  8231         GO TO 8200-SEND-DATAONLY
  8232     END-IF.
  8233
  8234 2000-DELETE-CLAIM.
  8235     IF NOT MODIFY-CAP
  8236         MOVE ER-0070            TO EMI-ERROR
  8237         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8238         MOVE -1                 TO MAINTL
  8239         GO TO 8200-SEND-DATAONLY
  8240     END-IF.
  8241
  8242     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8243        CLMCARRI NOT = PI-LAST-CARR        OR
  8244        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8245        SUFXI    NOT = PI-LAST-CERT-SUFX
  8246         MOVE ER-0207            TO EMI-ERROR
  8247         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8248         MOVE -1                 TO MAINTL
  8249         GO TO 8200-SEND-DATAONLY
  8250     END-IF.
  8251
  8252
  8253
  8254* EXEC CICS HANDLE CONDITION
  8255*        NOTFND   (2050-DELETE-NOT-FOUND)
  8256*    END-EXEC.
  8257*    MOVE '"$I                   ! * #00007994' TO DFHEIV0
  8258     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8259     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8260     MOVE X'2A20233030303037393934' TO DFHEIV0(25:11)
  8261     CALL 'kxdfhei1' USING DFHEIV0
  8262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8263
  8264
  8265     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8266
  8267     MOVE CLMCARRI               TO MSTR-CARRIER.
  8268     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8269     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8270     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8271
  8272     MOVE 'MSTR'                 TO FILE-SWITCH.
  8273     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8274
  8275     MOVE 'Y'                    TO CLAIM-SWITCH.
  8276
  8277     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8278        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8279         MOVE ER-0068        TO EMI-ERROR
  8280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8281         MOVE -1             TO MAINTL
  8282         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 161
* EL130.cbl
  8283     END-IF.
  8284
  8285     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8286         MOVE ER-0569            TO EMI-ERROR
  8287         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8288         MOVE -1                 TO MAINTL
  8289         GO TO 8200-SEND-DATAONLY
  8290     END-IF.
  8291
  8292     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8293         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8294     END-IF.
  8295
  8296     IF CL-PURGED-DT NOT = LOW-VALUES
  8297         MOVE ER-7691            TO EMI-ERROR
  8298         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8299         MOVE -1                 TO MAINTL
  8300         GO TO 8200-SEND-DATAONLY
  8301     END-IF.
  8302
  8303     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8304     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8305     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8306     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8307     MOVE +0                     TO TRLR-SEQ-NO.
  8308     MOVE '1'                    TO TRLR-TYPE.
  8309
  8310     MOVE 'TRLR'                 TO FILE-SWITCH.
  8311
  8312
  8313
  8314* EXEC CICS READ
  8315*        UPDATE
  8316*        DATASET  (ELTRLR-DSID)
  8317*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8318*        RIDFLD   (ELTRLR-KEY)
  8319*    END-EXEC.
  8320*    MOVE '&"S        EU         (   #00008046' TO DFHEIV0
  8321     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8322     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8323     MOVE X'2020233030303038303436' TO DFHEIV0(25:11)
  8324     CALL 'kxdfhei1' USING DFHEIV0,
  8325           ELTRLR-DSID,
  8326           DFHEIV20,
  8327           DFHEIV99,
  8328           ELTRLR-KEY,
  8329           DFHEIV99,
  8330           DFHEIV99,
  8331           DFHEIV99
  8332     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8333         DFHEIV20
  8334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8335
  8336
  8337     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8338        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
  8339         MOVE ER-0068        TO EMI-ERROR
  8340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 162
* EL130.cbl
  8341         MOVE -1             TO MAINTL
  8342         GO TO 8200-SEND-DATAONLY
  8343     END-IF.
  8344
  8345
  8346
  8347* EXEC CICS DELETE
  8348*        DATASET   (ELTRLR-DSID)
  8349*    END-EXEC.
  8350*    MOVE '&(                    &   #00008062' TO DFHEIV0
  8351     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8352     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8353     MOVE X'2020233030303038303632' TO DFHEIV0(25:11)
  8354     CALL 'kxdfhei1' USING DFHEIV0,
  8355           ELTRLR-DSID,
  8356           DFHEIV99,
  8357           DFHEIV99,
  8358           DFHEIV99,
  8359           DFHEIV99
  8360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8361
  8362
  8363     MOVE +90                    TO TRLR-SEQ-NO.
  8364     MOVE '6'                    TO TRLR-TYPE.
  8365
  8366
  8367
  8368* EXEC CICS READ
  8369*        UPDATE
  8370*        DATASET  (ELTRLR-DSID)
  8371*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8372*        RIDFLD   (ELTRLR-KEY)
  8373*    END-EXEC.
  8374*    MOVE '&"S        EU         (   #00008070' TO DFHEIV0
  8375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8376     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8377     MOVE X'2020233030303038303730' TO DFHEIV0(25:11)
  8378     CALL 'kxdfhei1' USING DFHEIV0,
  8379           ELTRLR-DSID,
  8380           DFHEIV20,
  8381           DFHEIV99,
  8382           ELTRLR-KEY,
  8383           DFHEIV99,
  8384           DFHEIV99,
  8385           DFHEIV99
  8386     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8387         DFHEIV20
  8388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8389
  8390
  8391
  8392
  8393* EXEC CICS DELETE
  8394*        DATASET   (ELTRLR-DSID)
  8395*    END-EXEC.
  8396*    MOVE '&(                    &   #00008078' TO DFHEIV0
  8397     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8398     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 163
* EL130.cbl
  8399     MOVE X'2020233030303038303738' TO DFHEIV0(25:11)
  8400     CALL 'kxdfhei1' USING DFHEIV0,
  8401           ELTRLR-DSID,
  8402           DFHEIV99,
  8403           DFHEIV99,
  8404           DFHEIV99,
  8405           DFHEIV99
  8406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8407
  8408
  8409     MOVE +91                    TO TRLR-SEQ-NO.
  8410     MOVE '6'                    TO TRLR-TYPE.
  8411
  8412
  8413
  8414* EXEC CICS READ
  8415*        UPDATE
  8416*        DATASET  (ELTRLR-DSID)
  8417*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8418*        RIDFLD   (ELTRLR-KEY)
  8419*        RESP     (WS-RESPONSE)
  8420*    END-EXEC
  8421*    MOVE '&"S        EU         (  N#00008086' TO DFHEIV0
  8422     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8423     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8424     MOVE X'204E233030303038303836' TO DFHEIV0(25:11)
  8425     CALL 'kxdfhei1' USING DFHEIV0,
  8426           ELTRLR-DSID,
  8427           DFHEIV20,
  8428           DFHEIV99,
  8429           ELTRLR-KEY,
  8430           DFHEIV99,
  8431           DFHEIV99,
  8432           DFHEIV99
  8433     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8434         DFHEIV20
  8435     MOVE EIBRESP  TO WS-RESPONSE
  8436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8437
  8438     IF WS-RESP-NORMAL
  8439
  8440* EXEC CICS DELETE
  8441*          DATASET   (ELTRLR-DSID)
  8442*       END-EXEC
  8443*    MOVE '&(                    &   #00008095' TO DFHEIV0
  8444     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8445     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8446     MOVE X'2020233030303038303935' TO DFHEIV0(25:11)
  8447     CALL 'kxdfhei1' USING DFHEIV0,
  8448           ELTRLR-DSID,
  8449           DFHEIV99,
  8450           DFHEIV99,
  8451           DFHEIV99,
  8452           DFHEIV99
  8453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8454     END-IF.
  8455
  8456     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 164
* EL130.cbl
  8457     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8458     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8459     MOVE CL-CERT-STATE          TO CERT-STATE.
  8460     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8461     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8462     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8463
  8464     MOVE 'CERT'                 TO FILE-SWITCH.
  8465
  8466     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8467
  8468     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8469
  8470     IF WS-NUM-HOLD NOT = +0
  8471         GO TO 2005-REWRITE-CERT
  8472     END-IF.
  8473
  8474     IF NOT CERT-WAS-CREATED
  8475         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8476         GO TO 2005-REWRITE-CERT
  8477     END-IF.
  8478
  8479
  8480
  8481* EXEC CICS DELETE
  8482*        DATASET   (ELCERT-DSID)
  8483*    END-EXEC.
  8484*    MOVE '&(                    &   #00008124' TO DFHEIV0
  8485     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8486     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8487     MOVE X'2020233030303038313234' TO DFHEIV0(25:11)
  8488     CALL 'kxdfhei1' USING DFHEIV0,
  8489           ELCERT-DSID,
  8490           DFHEIV99,
  8491           DFHEIV99,
  8492           DFHEIV99,
  8493           DFHEIV99
  8494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8495
  8496
  8497     GO TO 2010-DELETE-CL.
  8498
  8499 2005-REWRITE-CERT.
  8500
  8501     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8502
  8503
  8504
  8505* EXEC CICS HANDLE CONDITION
  8506*         DUPKEY   (2010-DELETE-CL)
  8507*    END-EXEC.
  8508*    MOVE '"$$                   ! + #00008135' TO DFHEIV0
  8509     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8510     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8511     MOVE X'2B20233030303038313335' TO DFHEIV0(25:11)
  8512     CALL 'kxdfhei1' USING DFHEIV0
  8513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8514
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 165
* EL130.cbl
  8515
  8516
  8517
  8518* EXEC CICS REWRITE
  8519*        DATASET  (ELCERT-DSID)
  8520*        FROM     (CERTIFICATE-MASTER)
  8521*    END-EXEC.
  8522     MOVE LENGTH OF
  8523      CERTIFICATE-MASTER
  8524       TO DFHEIV11
  8525*    MOVE '&& L                  %   #00008140' TO DFHEIV0
  8526     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8527     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8528     MOVE X'2020233030303038313430' TO DFHEIV0(25:11)
  8529     CALL 'kxdfhei1' USING DFHEIV0,
  8530           ELCERT-DSID,
  8531           CERTIFICATE-MASTER,
  8532           DFHEIV11,
  8533           DFHEIV99
  8534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8535
  8536
  8537 2010-DELETE-CL.
  8538
  8539
  8540
  8541* EXEC CICS DELETE
  8542*        DATASET  (ELMSTR-DSID)
  8543*    END-EXEC.
  8544*    MOVE '&(                    &   #00008148' TO DFHEIV0
  8545     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8546     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8547     MOVE X'2020233030303038313438' TO DFHEIV0(25:11)
  8548     CALL 'kxdfhei1' USING DFHEIV0,
  8549           ELMSTR-DSID,
  8550           DFHEIV99,
  8551           DFHEIV99,
  8552           DFHEIV99,
  8553           DFHEIV99
  8554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8555
  8556
  8557     MOVE -1                     TO ONE-OR-MIN1.
  8558     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8559
  8560     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8561         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8562                                    WS-SAVE-CLAIM-KEY
  8563         MOVE +1                 TO ONE-OR-MIN1
  8564         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8565     END-IF.
  8566
  8567     MOVE ER-0000                TO EMI-ERROR.
  8568     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8569     MOVE LOW-VALUES             TO EL130AO.
  8570     MOVE -1                     TO MAINTL.
  8571     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8572     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 166
* EL130.cbl
  8573                                    PI-CERT-PROCESSED
  8574                                    PI-LETTER-ERROR-CODE.
  8575     GO TO 8100-SEND-INITIAL-MAP.
  8576
  8577 2050-DELETE-NOT-FOUND.
  8578     IF FILE-SWITCH = 'MSTR'
  8579         MOVE -1                 TO CLMNOL
  8580         MOVE ER-0204            TO EMI-ERROR
  8581     ELSE
  8582         IF FILE-SWITCH = 'TRLR'
  8583             MOVE -1             TO MAINTL
  8584             MOVE ER-0205        TO EMI-ERROR
  8585         ELSE
  8586             MOVE -1             TO CERTNOL
  8587             MOVE ER-0206        TO EMI-ERROR
  8588         END-IF
  8589     END-IF.
  8590
  8591     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8592     GO TO 8200-SEND-DATAONLY.
  8593
  8594 3000-ADD-CLAIM.
  8595     IF NOT MODIFY-CAP
  8596         MOVE ER-0070            TO EMI-ERROR
  8597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8598         MOVE -1                 TO MAINTL
  8599         GO TO 8200-SEND-DATAONLY
  8600     END-IF.
  8601
  8602     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8603
  8604     IF CERTMTI = 'S'
  8605         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8606            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8607            WS-EFFDT = PI-SAVE-EFFDT       AND
  8608            ACCOUNTI = PI-SAVE-ACCOUNT
  8609             IF EMI-ERROR = 0
  8610                 GO TO 3010-TEST-FOR-ERRORS
  8611             ELSE
  8612                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8613                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8614                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8615                 MOVE PI-STATE         TO  CERT-STATE
  8616                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8617                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8618                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8619
  8620
  8621* EXEC CICS HANDLE CONDITION
  8622*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8623*                END-EXEC
  8624*    MOVE '"$I                   ! , #00008215' TO DFHEIV0
  8625     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8626     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8627     MOVE X'2C20233030303038323135' TO DFHEIV0(25:11)
  8628     CALL 'kxdfhei1' USING DFHEIV0
  8629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8630                 PERFORM 7940-READ-CERT THRU 7940-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 167
* EL130.cbl
  8631                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8632                 GO TO 3010-TEST-FOR-ERRORS
  8633             END-IF
  8634         END-IF
  8635     END-IF.
  8636
  8637     IF CERTMTI = 'A'
  8638         IF NOT PI-NO-CARRIER-SECURITY OR
  8639             NOT PI-NO-ACCOUNT-SECURITY
  8640             MOVE ER-2370          TO EMI-ERROR
  8641             MOVE -1               TO MAINTL
  8642             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8643             GO TO 8200-SEND-DATAONLY
  8644         ELSE
  8645             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8646             GO TO 3010-TEST-FOR-ERRORS
  8647         END-IF
  8648     END-IF.
  8649
  8650     IF CERTNOL = ZEROS
  8651        GO TO 3010-TEST-FOR-ERRORS
  8652     END-IF.
  8653
  8654 3000-READ-CERT.
  8655
  8656     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8657                                    MSTR5-COMP-CD.
  8658     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8659                                    MSTR5-CERT-NO-PRIME.
  8660     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8661                                    MSTR5-CERT-NO-SUFX.
  8662
  8663
  8664
  8665* EXEC CICS HANDLE CONDITION
  8666*         DUPKEY   (3008-DUP-ERROR)
  8667*         NOTFND   (3009-NOT-FOUND)
  8668*    END-EXEC
  8669*    MOVE '"$$I                  ! - #00008252' TO DFHEIV0
  8670     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8672     MOVE X'2D20233030303038323532' TO DFHEIV0(25:11)
  8673     CALL 'kxdfhei1' USING DFHEIV0
  8674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8675
  8676     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8677
  8678     IF NOT PI-NO-ACCOUNT-SECURITY
  8679         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8680             MOVE ER-2371          TO EMI-ERROR
  8681             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8682             MOVE -1               TO MAINTL
  8683             GO TO 8200-SEND-DATAONLY
  8684         END-IF
  8685     END-IF.
  8686
  8687     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8688     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 168
* EL130.cbl
  8689     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8690     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8691     MOVE CM-CARRIER             TO PI-CARRIER.
  8692     MOVE CM-GROUPING            TO PI-GROUPING.
  8693     MOVE CM-STATE               TO PI-STATE.
  8694     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8695     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8696     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8697     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8698
  8699     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8700         IF LSTNMEO = SPACES OR LOW-VALUES
  8701             MOVE CRTLNMEI       TO  LSTNMEO
  8702             MOVE AL-UANON       TO  LSTNMEA
  8703         END-IF
  8704     END-IF.
  8705
  8706     MOVE 'S'                    TO CERTMTO.
  8707*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8708     MOVE AL-SANON               TO CERTNOA.
  8709     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8710                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8711     IF EMI-NO-ERRORS
  8712         MOVE -1                  TO MAINTL
  8713     END-IF.
  8714
  8715     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8716         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8717         IF INCURRED-DATE-MATCH
  8718             MOVE ER-7352         TO EMI-ERROR
  8719             MOVE -1              TO CERTNOL
  8720             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8721         ELSE
  8722             IF NO-CLAIMS-FOR-CERT
  8723                 MOVE ER-7353     TO EMI-ERROR
  8724                 MOVE -1          TO CERTNOL
  8725                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8726             ELSE
  8727                 MOVE ER-0558     TO EMI-ERROR
  8728                 MOVE -1          TO CERTNOL
  8729                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8730                 GO TO 3010-TEST-FOR-ERRORS
  8731             END-IF
  8732         END-IF
  8733     END-IF.
  8734
  8735 3007-SEND-SCREEN.
  8736     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8737         GO TO 8150-SEND-MAP-CURSOR
  8738     ELSE
  8739         GO TO 8200-SEND-DATAONLY
  8740     END-IF.
  8741
  8742 3008-DUP-ERROR.
  8743     MOVE ER-0560                TO EMI-ERROR.
  8744     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8745     MOVE -1                     TO CERTNOL.
  8746     GO TO 3007-SEND-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 169
* EL130.cbl
  8747
  8748 3009-NOT-FOUND.
  8749     MOVE ER-0214                TO EMI-ERROR.
  8750     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8751     MOVE -1                     TO CERTNOL.
  8752     GO TO 3007-SEND-SCREEN.
  8753
  8754 3010-TEST-FOR-ERRORS.
  8755
  8756     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  8757     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  8758
  8759     IF CERTMTI NOT = 'A'
  8760         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8761             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  8762             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  8763             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  8764             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8765             IF INCURRED-DATE-MATCH
  8766                 MOVE ER-7352         TO EMI-ERROR
  8767                 MOVE -1              TO CERTNOL
  8768                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8769             ELSE
  8770                 IF NO-CLAIMS-FOR-CERT
  8771                     MOVE ER-7353     TO EMI-ERROR
  8772                     MOVE -1          TO CERTNOL
  8773                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8774                 ELSE
  8775                     MOVE ER-0558     TO EMI-ERROR
  8776                     MOVE -1          TO CERTNOL
  8777                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8778                 END-IF
  8779             END-IF
  8780         END-IF
  8781     END-IF.
  8782
  8783     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  8784         MOVE ER-0433             TO EMI-ERROR
  8785         MOVE -1                  TO MAINTL
  8786         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8787         GO TO 8200-SEND-DATAONLY
  8788     END-IF.
  8789
  8790     IF EMI-NO-ERRORS
  8791         GO TO 3015-TRY-TO-BUILD
  8792     END-IF.
  8793
  8794     IF EIBAID = DFHPF6
  8795         IF EMI-FATAL-CTR NOT EQUAL ZERO
  8796             MOVE ER-0434         TO EMI-ERROR
  8797             MOVE -1              TO MAINTL
  8798             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8799             GO TO 8200-SEND-DATAONLY
  8800         ELSE
  8801             MOVE +1              TO INCURL
  8802             GO TO 3015-TRY-TO-BUILD
  8803         END-IF
  8804     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 170
* EL130.cbl
  8805
  8806     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8807         GO TO 8150-SEND-MAP-CURSOR
  8808     ELSE
  8809         GO TO 8200-SEND-DATAONLY
  8810     END-IF.
  8811
  8812 3015-TRY-TO-BUILD.
  8813     IF CLMNOL EQUAL ZERO
  8814         GO TO 3030-BUILD-CONT
  8815     END-IF.
  8816
  8817
  8818
  8819* EXEC CICS HANDLE CONDITION
  8820*        NOTFND   (3030-BUILD-CONT)
  8821*    END-EXEC.
  8822*    MOVE '"$I                   ! . #00008399' TO DFHEIV0
  8823     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8824     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8825     MOVE X'2E20233030303038333939' TO DFHEIV0(25:11)
  8826     CALL 'kxdfhei1' USING DFHEIV0
  8827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8828
  8829
  8830     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8831
  8832     MOVE CLMCARRI               TO MSTR-CARRIER.
  8833     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8834     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8835     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8836
  8837     MOVE 'MSTR'                 TO FILE-SWITCH.
  8838
  8839     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8840
  8841     MOVE ER-0221                TO EMI-ERROR.
  8842
  8843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8844     MOVE -1                     TO MAINTL.
  8845     GO TO 8200-SEND-DATAONLY.
  8846
  8847 3030-BUILD-CONT.
  8848     IF CERTMTI NOT = 'A'
  8849         GO TO 3060-BUILD-CONT
  8850     END-IF.
  8851
  8852
  8853
  8854* EXEC CICS HANDLE CONDITION
  8855*        NOTFND   (3033-ACCT-NOT-FOUND)
  8856*        ENDFILE  (3033-ACCT-NOT-FOUND)
  8857*    END-EXEC.
  8858*    MOVE '"$I''                  ! / #00008426' TO DFHEIV0
  8859     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8861     MOVE X'2F20233030303038343236' TO DFHEIV0(25:11)
  8862     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 171
* EL130.cbl
  8863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8864
  8865
  8866     MOVE SPACES                 TO ERACCT-KEY.
  8867
  8868     IF CARR-GROUP-ST-ACCNT-CNTL
  8869         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  8870         MOVE CRTCARRI           TO ACCT-CARRIER
  8871         MOVE GROUPI             TO ACCT-GROUPING
  8872         MOVE STATEI             TO ACCT-STATE
  8873         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  8874         GO TO 3031-MOVE-ACCT-KEY
  8875     END-IF.
  8876
  8877     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  8878     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  8879
  8880     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  8881         MOVE STATEI             TO ACCT-STATE
  8882     END-IF.
  8883
  8884     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  8885         MOVE CRTCARRI           TO ACCT-CARRIER
  8886     END-IF.
  8887
  8888 3031-MOVE-ACCT-KEY.
  8889     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  8890
  8891
  8892
  8893* EXEC CICS STARTBR
  8894*        DATASET     (ERACCT2-DSID)
  8895*        RIDFLD      (SAVE-ERACCT-KEY)
  8896*        GENERIC
  8897*        KEYLENGTH   (20)
  8898*    END-EXEC.
  8899     MOVE 20
  8900       TO DFHEIV11
  8901     MOVE 0
  8902       TO DFHEIV12
  8903*    MOVE '&,   KG    G          &   #00008457' TO DFHEIV0
  8904     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  8905     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8906     MOVE X'2020233030303038343537' TO DFHEIV0(25:11)
  8907     CALL 'kxdfhei1' USING DFHEIV0,
  8908           ERACCT2-DSID,
  8909           SAVE-ERACCT-KEY,
  8910           DFHEIV11,
  8911           DFHEIV12,
  8912           DFHEIV99
  8913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8914
  8915
  8916
  8917
  8918* EXEC CICS HANDLE CONDITION
  8919*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  8920*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 172
* EL130.cbl
  8921*    MOVE '"$''                   ! 0 #00008465' TO DFHEIV0
  8922     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8923     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8924     MOVE X'3020233030303038343635' TO DFHEIV0(25:11)
  8925     CALL 'kxdfhei1' USING DFHEIV0
  8926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8927
  8928
  8929 3031-READ-ACCT-LOOP.
  8930
  8931
  8932* EXEC CICS READNEXT
  8933*        DATASET   (ERACCT2-DSID)
  8934*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8935*        RIDFLD    (SAVE-ERACCT-KEY)
  8936*    END-EXEC.
  8937     MOVE 0
  8938       TO DFHEIV11
  8939*    MOVE '&.S                   )   #00008471' TO DFHEIV0
  8940     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8941     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8942     MOVE X'2020233030303038343731' TO DFHEIV0(25:11)
  8943     CALL 'kxdfhei1' USING DFHEIV0,
  8944           ERACCT2-DSID,
  8945           DFHEIV20,
  8946           DFHEIV99,
  8947           SAVE-ERACCT-KEY,
  8948           DFHEIV99,
  8949           DFHEIV11,
  8950           DFHEIV99,
  8951           DFHEIV99
  8952     SET ADDRESS OF ACCOUNT-MASTER TO
  8953         DFHEIV20
  8954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8955
  8956
  8957     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  8958        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  8959        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  8960        ACCT-STATE    NOT = AM-VG-STATE       OR
  8961        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  8962         GO TO 3033-ACCT-NOT-FOUND
  8963     END-IF.
  8964
  8965     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  8966        WS-EFFDT LESS AM-EXPIRATION-DT
  8967         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  8968         MOVE AM-CARRIER       TO CERT-CARRIER
  8969         MOVE AM-GROUPING      TO CERT-GROUPING
  8970         MOVE AM-STATE         TO CERT-STATE
  8971         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  8972         MOVE WS-EFFDT         TO CERT-EFF-DT
  8973         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  8974         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  8975         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  8976         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  8977     END-IF.
  8978
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 173
* EL130.cbl
  8979     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  8980         GO TO 3031-READ-ACCT-LOOP
  8981     END-IF.
  8982
  8983 3032-NOT-IN-DT-RANGE.
  8984     MOVE ER-0226                TO EMI-ERROR.
  8985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8986     MOVE -1                     TO EFFDTL.
  8987     GO TO 8200-SEND-DATAONLY.
  8988
  8989 3033-ACCT-NOT-FOUND.
  8990     MOVE ER-0226 TO EMI-ERROR.
  8991     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8992     MOVE -1                     TO ACCOUNTL.
  8993     GO TO 8200-SEND-DATAONLY.
  8994
  8995 3034-CHECK-EMPLOYER-STATEMENT.
  8996
  8997     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  8998*        NEXT SENTENCE
  8999         CONTINUE
  9000     ELSE
  9001         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9002     END-IF.
  9003
  9004     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9005     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9006     MOVE '1'                    TO  DC-OPTION-CODE.
  9007     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9008                                     DC-ELAPSED-DAYS.
  9009     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9010
  9011     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9012         DC-ELAPSED-DAYS LESS THAN +31)
  9013                      OR
  9014        (AM-EMPLOYER-STMT-USED = '2' AND
  9015         DC-ELAPSED-DAYS LESS THAN +61)
  9016                      OR
  9017        (AM-EMPLOYER-STMT-USED = '3' AND
  9018         DC-ELAPSED-DAYS LESS THAN +91)
  9019            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9020     END-IF.
  9021
  9022 3034-CHECK-ACCOUNT-LIMITS.
  9023
  9024     IF CERTMTI NOT = 'A'
  9025         GO TO 3060-BUILD-CONT
  9026     END-IF.
  9027
  9028     IF AM-STATUS NOT = '0'
  9029         MOVE ER-0225                TO EMI-ERROR
  9030         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9031         MOVE -1                     TO ACCOUNTL
  9032     END-IF.
  9033
  9034     IF EIBAID = DFHPF6
  9035         IF EMI-FATAL-CTR NOT = ZERO
  9036             MOVE ER-0434         TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 174
* EL130.cbl
  9037             MOVE -1              TO MAINTL
  9038             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9039             GO TO 8200-SEND-DATAONLY
  9040         END-IF
  9041     END-IF.
  9042
  9043*    IF PI-COMPANY-ID NOT = 'CRI'
  9044*        GO TO 3035-END-BROWSE
  9045*    END-IF.
  9046
  9047 3035-END-BROWSE.
  9048
  9049
  9050* EXEC CICS ENDBR
  9051*        DATASET    (ERACCT2-DSID)
  9052*    END-EXEC.
  9053     MOVE 0
  9054       TO DFHEIV11
  9055*    MOVE '&2                    $   #00008569' TO DFHEIV0
  9056     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9057     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9058     MOVE X'2020233030303038353639' TO DFHEIV0(25:11)
  9059     CALL 'kxdfhei1' USING DFHEIV0,
  9060           ERACCT2-DSID,
  9061           DFHEIV11,
  9062           DFHEIV99
  9063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9064
  9065
  9066 3040-CHECK-CERT-ALREADY-ON.
  9067
  9068
  9069* EXEC CICS HANDLE CONDITION
  9070*        NOTFND   (3070-BUILD-CONT)
  9071*    END-EXEC.
  9072*    MOVE '"$I                   ! 1 #00008575' TO DFHEIV0
  9073     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9074     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9075     MOVE X'3120233030303038353735' TO DFHEIV0(25:11)
  9076     CALL 'kxdfhei1' USING DFHEIV0
  9077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9078
  9079
  9080     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9081
  9082     MOVE ER-0229                TO EMI-ERROR.
  9083     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9084     MOVE -1                     TO MAINTL.
  9085     GO TO 8200-SEND-DATAONLY.
  9086
  9087 3060-BUILD-CONT.
  9088     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9089     MOVE CRTCARRI               TO CERT-CARRIER.
  9090     MOVE GROUPI                 TO CERT-GROUPING.
  9091     MOVE STATEI                 TO CERT-STATE.
  9092     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9093     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9094     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 175
* EL130.cbl
  9095     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9096
  9097
  9098
  9099* EXEC CICS HANDLE CONDITION
  9100*        NOTFND  (3065-CERT-NOT-FOUND)
  9101*    END-EXEC.
  9102*    MOVE '"$I                   ! 2 #00008597' TO DFHEIV0
  9103     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9105     MOVE X'3220233030303038353937' TO DFHEIV0(25:11)
  9106     CALL 'kxdfhei1' USING DFHEIV0
  9107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9108
  9109
  9110     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9111
  9112     GO TO 3070-BUILD-CONT.
  9113
  9114 3065-CERT-NOT-FOUND.
  9115     MOVE ER-0244                TO EMI-ERROR.
  9116     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9117     MOVE -1                     TO CERTNOL.
  9118     GO TO 8200-SEND-DATAONLY.
  9119
  9120 3070-BUILD-CONT.
  9121     IF CLMNOL NOT = ZERO
  9122         GO TO 3200-BUILD-ZERO-TRAILER
  9123     END-IF.
  9124
  9125     MOVE SPACES                 TO ELCNTL-KEY.
  9126
  9127     IF CONTROL-IS-ACTUAL-CARRIER
  9128         MOVE PI-CARRIER         TO CNTL-CARRIER
  9129     ELSE
  9130         MOVE PI-CARRIER-CONTROL-LEVEL
  9131                                 TO CNTL-CARRIER
  9132     END-IF.
  9133
  9134     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9135     MOVE '6'                    TO CNTL-REC-TYPE.
  9136     MOVE +0                     TO CNTL-SEQ-NO.
  9137
  9138
  9139
  9140* EXEC CICS HANDLE CONDITION
  9141*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9142*    END-EXEC.
  9143*    MOVE '"$I                   ! 3 #00008630' TO DFHEIV0
  9144     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9145     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9146     MOVE X'3320233030303038363330' TO DFHEIV0(25:11)
  9147     CALL 'kxdfhei1' USING DFHEIV0
  9148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9149
  9150
  9151
  9152
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 176
* EL130.cbl
  9153* EXEC CICS READ
  9154*        UPDATE
  9155*        DATASET   (ELCNTL-DSID)
  9156*        SET       (ADDRESS OF CONTROL-FILE)
  9157*        RIDFLD    (ELCNTL-KEY)
  9158*    END-EXEC.
  9159*    MOVE '&"S        EU         (   #00008635' TO DFHEIV0
  9160     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9161     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9162     MOVE X'2020233030303038363335' TO DFHEIV0(25:11)
  9163     CALL 'kxdfhei1' USING DFHEIV0,
  9164           ELCNTL-DSID,
  9165           DFHEIV20,
  9166           DFHEIV99,
  9167           ELCNTL-KEY,
  9168           DFHEIV99,
  9169           DFHEIV99,
  9170           DFHEIV99
  9171     SET ADDRESS OF CONTROL-FILE TO
  9172         DFHEIV20
  9173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9174
  9175
  9176     IF CLAIM-NO-MANUAL
  9177         GO TO 3120-CLAIM-MUST-BE-INPUT
  9178     END-IF.
  9179
  9180     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9181     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9182
  9183     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9184         CONTINUE
  9185     ELSE
  9186         GO TO 3080-ASSIGN-LOOP
  9187     END-IF.
  9188
  9189
  9190
  9191* EXEC CICS UNLOCK
  9192*        DATASET   (ELCNTL-DSID)
  9193*    END-EXEC.
  9194*    MOVE '&*                    #   #00008656' TO DFHEIV0
  9195     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9196     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9197     MOVE X'2020233030303038363536' TO DFHEIV0(25:11)
  9198     CALL 'kxdfhei1' USING DFHEIV0,
  9199           ELCNTL-DSID,
  9200           DFHEIV99
  9201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9202
  9203
  9204     MOVE '1'                    TO CNTL-REC-TYPE.
  9205     MOVE SPACES                 TO CNTL-ACCESS.
  9206
  9207     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9208
  9209
  9210
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 177
* EL130.cbl
  9211* EXEC CICS HANDLE CONDITION
  9212*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9213*    END-EXEC.
  9214*    MOVE '"$I                   ! 4 #00008666' TO DFHEIV0
  9215     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9216     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9217     MOVE X'3420233030303038363636' TO DFHEIV0(25:11)
  9218     CALL 'kxdfhei1' USING DFHEIV0
  9219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9220
  9221
  9222     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9223
  9224     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9225
  9226 3080-ASSIGN-LOOP.
  9227     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9228        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9229         MOVE +0                 TO SAVE-COUNTER
  9230     END-IF.
  9231
  9232     ADD +1 TO SAVE-COUNTER.
  9233
  9234     IF SAVE-METHOD  = '3'
  9235         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9236         GO TO 3090-SET-COMP
  9237     END-IF.
  9238
  9239     IF SAVE-METHOD  = '4'
  9240         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9241         MOVE CLMCARRI           TO WS-CN-PRF-A
  9242         GO TO 3090-SET-COMP
  9243     END-IF.
  9244
  9245     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9246     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9247     MOVE SAVE-DATE              TO CURR-DATE.
  9248
  9249     IF CURR-MM LESS '10'
  9250         MOVE CURR-M2             TO WS-CN-PRF-B
  9251     END-IF.
  9252
  9253     IF CURR-MM = '10'
  9254        MOVE 'A'                 TO WS-CN-PRF-B
  9255     END-IF.
  9256     IF CURR-MM = '11'
  9257        MOVE 'B'                 TO WS-CN-PRF-B
  9258     END-IF.
  9259     IF CURR-MM = '12'
  9260        MOVE 'C'                 TO WS-CN-PRF-B
  9261     END-IF.
  9262
  9263     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9264
  9265 3090-SET-COMP.
  9266
  9267     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9268     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 178
* EL130.cbl
  9269                                    CLMNOO.
  9270     MOVE AL-UANON               TO CLMNOA.
  9271     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9272     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9273     MOVE CLMCARRI               TO MSTR-CARRIER.
  9274
  9275
  9276
  9277* EXEC CICS HANDLE CONDITION
  9278*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9279*    END-EXEC.
  9280*    MOVE '"$I                   ! 5 #00008724' TO DFHEIV0
  9281     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9283     MOVE X'3520233030303038373234' TO DFHEIV0(25:11)
  9284     CALL 'kxdfhei1' USING DFHEIV0
  9285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9286
  9287
  9288     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9289
  9290     GO TO 3080-ASSIGN-LOOP.
  9291
  9292 3100-CARRIER-NOT-FOUND.
  9293     MOVE ER-0252                TO EMI-ERROR.
  9294     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9295     MOVE -1                     TO CLMCARRL.
  9296     GO TO 8200-SEND-DATAONLY.
  9297
  9298 3110-COMPANY-NOT-FOUND.
  9299     MOVE ER-0254                TO EMI-ERROR.
  9300     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9301     MOVE -1                     TO MAINTL.
  9302     GO TO 8200-SEND-DATAONLY.
  9303
  9304 3120-CLAIM-MUST-BE-INPUT.
  9305     MOVE ER-0264                TO EMI-ERROR.
  9306     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9307     MOVE -1                     TO CLMNOL.
  9308     GO TO 8200-SEND-DATAONLY.
  9309
  9310 3200-BUILD-ZERO-TRAILER.
  9311
  9312
  9313* EXEC CICS HANDLE CONDITION
  9314*        NOTFND
  9315*    END-EXEC.
  9316*    MOVE '"$                   ! 6 #00008752' TO DFHEIV0
  9317     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9318     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9319     MOVE X'3620233030303038373532' TO DFHEIV0(25:11)
  9320     CALL 'kxdfhei1' USING DFHEIV0
  9321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9322
  9323
  9324
  9325
  9326* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 179
* EL130.cbl
  9327*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9328*        LENGTH  (ELTRLR-LENGTH)
  9329*    END-EXEC.
  9330*    MOVE '," L                  $   #00008757' TO DFHEIV0
  9331     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9332     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9333     MOVE X'2020233030303038373537' TO DFHEIV0(25:11)
  9334     CALL 'kxdfhei1' USING DFHEIV0,
  9335           DFHEIV20,
  9336           ELTRLR-LENGTH,
  9337           DFHEIV99
  9338     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9339         DFHEIV20
  9340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9341
  9342
  9343     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9344     MOVE 'AT'                   TO AT-RECORD-ID.
  9345
  9346     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9347     MOVE CLMCARRI               TO AT-CARRIER.
  9348     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9349     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9350     MOVE +0                     TO AT-SEQUENCE-NO.
  9351     MOVE '1'                    TO AT-TRAILER-TYPE.
  9352
  9353     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9354     MOVE '5'                    TO DC-OPTION-CODE.
  9355     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9356     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9357                                    AT-RESERVES-LAST-MAINT-DT.
  9358
  9359     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9360                                    AT-RESERVES-LAST-UPDATED-BY.
  9361
  9362     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9363
  9364     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9365
  9366     MOVE +0                     TO AT-FUTURE-RESERVE
  9367                                    AT-IBNR-RESERVE
  9368                                    AT-PAY-CURRENT-RESERVE
  9369                                    AT-INITIAL-MANUAL-RESERVE
  9370                                    AT-CURRENT-MANUAL-RESERVE
  9371                                    AT-ITD-LIFE-REFUNDS
  9372                                    AT-ITD-AH-REFUNDS
  9373                                    AT-ITD-ADDITIONAL-RESERVE.
  9374
  9375     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9376
  9377     IF MANRSVL NOT = ZERO
  9378         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9379                                    AT-CURRENT-MANUAL-RESERVE
  9380     END-IF.
  9381
  9382     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9383
  9384     MOVE +0                     TO AT-ITD-PAID-EXPENSES
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 180
* EL130.cbl
  9385                                    AT-ITD-CHARGEABLE-EXPENSE.
  9386
  9387     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9388     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9389     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9390
  9391
  9392
  9393* EXEC CICS WRITE
  9394*        DATASET   (ELTRLR-DSID)
  9395*        FROM      (ACTIVITY-TRAILERS)
  9396*        RIDFLD    (AT-CONTROL-PRIMARY)
  9397*    END-EXEC.
  9398     MOVE LENGTH OF
  9399      ACTIVITY-TRAILERS
  9400       TO DFHEIV11
  9401*    MOVE '&$ L                  ''   #00008811' TO DFHEIV0
  9402     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9403     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9404     MOVE X'2020233030303038383131' TO DFHEIV0(25:11)
  9405     CALL 'kxdfhei1' USING DFHEIV0,
  9406           ELTRLR-DSID,
  9407           ACTIVITY-TRAILERS,
  9408           DFHEIV11,
  9409           AT-CONTROL-PRIMARY,
  9410           DFHEIV99,
  9411           DFHEIV99
  9412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9413
  9414
  9415     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9416
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 181
* EL130.cbl
  9418
  9419 3250-BUILD-I1-ADDRESS-TRAILER.
  9420
  9421     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9422     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9423     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9424     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9425     MOVE GROUPI                 TO WS-MA-GROUPING.
  9426     MOVE STATEI                 TO WS-MA-STATE.
  9427     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9428     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9429     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9430     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9431
  9432
  9433* EXEC CICS HANDLE CONDITION
  9434*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9435*    END-EXEC.
  9436*    MOVE '"$I                   ! 7 #00008834' TO DFHEIV0
  9437     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9439     MOVE X'3720233030303038383334' TO DFHEIV0(25:11)
  9440     CALL 'kxdfhei1' USING DFHEIV0
  9441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9442
  9443
  9444
  9445* EXEC CICS READ
  9446*        EQUAL
  9447*        DATASET   (ERMAIL-DSID)
  9448*        SET       (ADDRESS OF MAILING-DATA)
  9449*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9450*    END-EXEC.
  9451*    MOVE '&"S        E          (   #00008838' TO DFHEIV0
  9452     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9454     MOVE X'2020233030303038383338' TO DFHEIV0(25:11)
  9455     CALL 'kxdfhei1' USING DFHEIV0,
  9456           ERMAIL-DSID,
  9457           DFHEIV20,
  9458           DFHEIV99,
  9459           WS-MA-CONTROL-PRIMARY,
  9460           DFHEIV99,
  9461           DFHEIV99,
  9462           DFHEIV99
  9463     SET ADDRESS OF MAILING-DATA TO
  9464         DFHEIV20
  9465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9466
  9467
  9468     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9469         GO TO 3290-NO-INSURED-ADDRESS
  9470     END-IF.
  9471
  9472     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9473     MOVE 'AT'                   TO AT-RECORD-ID.
  9474
  9475     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 182
* EL130.cbl
  9476     MOVE CLMCARRI               TO AT-CARRIER.
  9477     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9478     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9479     MOVE +1                     TO AT-SEQUENCE-NO.
  9480     MOVE '5'                    TO AT-TRAILER-TYPE.
  9481
  9482     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9483     IF MA-INSURED-MIDDLE-INIT > SPACES
  9484        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9485               ' ' DELIMITED BY SIZE
  9486               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9487               ' ' DELIMITED BY SIZE
  9488               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9489        INTO AT-MAIL-TO-NAME
  9490     ELSE
  9491        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9492               ' ' DELIMITED BY SIZE
  9493               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9494        INTO AT-MAIL-TO-NAME
  9495     END-IF.
  9496     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9497     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9498*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9499     MOVE MA-CITY                TO AT-CITY
  9500     MOVE MA-ADDR-STATE          TO AT-STATE
  9501     MOVE MA-ZIP                 TO AT-ZIP
  9502     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9503
  9504     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9505                                    AT-ADDRESS-LAST-MAINT-DT.
  9506
  9507     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9508                                    AT-ADDRESS-LAST-UPDATED-BY.
  9509
  9510     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9511
  9512
  9513* EXEC CICS WRITE
  9514*        DATASET   (ELTRLR-DSID)
  9515*        FROM      (ACTIVITY-TRAILERS)
  9516*        RIDFLD    (AT-CONTROL-PRIMARY)
  9517*    END-EXEC.
  9518     MOVE LENGTH OF
  9519      ACTIVITY-TRAILERS
  9520       TO DFHEIV11
  9521*    MOVE '&$ L                  ''   #00008889' TO DFHEIV0
  9522     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9523     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9524     MOVE X'2020233030303038383839' TO DFHEIV0(25:11)
  9525     CALL 'kxdfhei1' USING DFHEIV0,
  9526           ELTRLR-DSID,
  9527           ACTIVITY-TRAILERS,
  9528           DFHEIV11,
  9529           AT-CONTROL-PRIMARY,
  9530           DFHEIV99,
  9531           DFHEIV99
  9532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9533
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 183
* EL130.cbl
  9534
  9535     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9536     GO TO 3300-BUILD-NINETY-TRAILER.
  9537
  9538 3290-NO-INSURED-ADDRESS.
  9539      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9540
  9541 3300-BUILD-NINETY-TRAILER.
  9542
  9543     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9544     MOVE 'AT'                   TO AT-RECORD-ID.
  9545
  9546     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9547     MOVE CLMCARRI               TO AT-CARRIER.
  9548
  9549     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9550     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9551     MOVE +90                    TO AT-SEQUENCE-NO.
  9552     MOVE '6'                    TO AT-TRAILER-TYPE.
  9553
  9554     IF DIAGL NOT = ZERO
  9555         MOVE DIAGI              TO AT-INFO-LINE-1
  9556     END-IF.
  9557
  9558     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9559                                    AT-GEN-INFO-LAST-MAINT-DT.
  9560
  9561     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9562                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9563     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9564
  9565
  9566
  9567* EXEC CICS WRITE
  9568*        DATASET   (ELTRLR-DSID)
  9569*        FROM      (ACTIVITY-TRAILERS)
  9570*        RIDFLD    (AT-CONTROL-PRIMARY)
  9571*    END-EXEC.
  9572     MOVE LENGTH OF
  9573      ACTIVITY-TRAILERS
  9574       TO DFHEIV11
  9575*    MOVE '&$ L                  ''   #00008926' TO DFHEIV0
  9576     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9577     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9578     MOVE X'2020233030303038393236' TO DFHEIV0(25:11)
  9579     CALL 'kxdfhei1' USING DFHEIV0,
  9580           ELTRLR-DSID,
  9581           ACTIVITY-TRAILERS,
  9582           DFHEIV11,
  9583           AT-CONTROL-PRIMARY,
  9584           DFHEIV99,
  9585           DFHEIV99
  9586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9587
  9588
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 184
* EL130.cbl
  9590 3400-CHECK-CERT-MAINT.
  9591
  9592     IF CERTMTI = 'A'
  9593         GO TO 3600-BUILD-NEW-CERT
  9594     END-IF.
  9595
  9596     IF NO-CLAIM-ATTACHED
  9597         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9598     END-IF.
  9599
  9600     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9601
  9602     IF CM-LF-CURRENT-STATUS = '2' OR
  9603        CM-AH-CURRENT-STATUS = '2'
  9604         GO TO 3400-REWRITE-CERT
  9605     END-IF.
  9606
  9607     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9608
  9609 3400-REWRITE-CERT.
  9610
  9611
  9612
  9613* EXEC CICS HANDLE CONDITION
  9614*        DUPKEY (3410-DUP-KEY)
  9615*    END-EXEC.
  9616*    MOVE '"$$                   ! 8 #00008955' TO DFHEIV0
  9617     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9619     MOVE X'3820233030303038393535' TO DFHEIV0(25:11)
  9620     CALL 'kxdfhei1' USING DFHEIV0
  9621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9622
  9623
  9624
  9625
  9626* EXEC CICS REWRITE
  9627*        DATASET   (ELCERT-DSID)
  9628*        FROM      (CERTIFICATE-MASTER)
  9629*    END-EXEC.
  9630     MOVE LENGTH OF
  9631      CERTIFICATE-MASTER
  9632       TO DFHEIV11
  9633*    MOVE '&& L                  %   #00008960' TO DFHEIV0
  9634     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9635     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9636     MOVE X'2020233030303038393630' TO DFHEIV0(25:11)
  9637     CALL 'kxdfhei1' USING DFHEIV0,
  9638           ELCERT-DSID,
  9639           CERTIFICATE-MASTER,
  9640           DFHEIV11,
  9641           DFHEIV99
  9642     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9643
  9644
  9645 3410-DUP-KEY.
  9646     GO TO 3800-BUILD-NEW-CLAIM.
  9647
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 185
* EL130.cbl
  9648 3600-BUILD-NEW-CERT.
  9649
  9650
  9651* EXEC CICS GETMAIN
  9652*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9653*        LENGTH   (ELCERT-LENGTH)
  9654*    END-EXEC.
  9655*    MOVE '," L                  $   #00008970' TO DFHEIV0
  9656     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9657     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9658     MOVE X'2020233030303038393730' TO DFHEIV0(25:11)
  9659     CALL 'kxdfhei1' USING DFHEIV0,
  9660           DFHEIV20,
  9661           ELCERT-LENGTH,
  9662           DFHEIV99
  9663     SET ADDRESS OF CERTIFICATE-MASTER TO
  9664         DFHEIV20
  9665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9666
  9667
  9668     MOVE SPACES                 TO CERTIFICATE-MASTER.
  9669
  9670     MOVE 'CM'                   TO CM-RECORD-ID.
  9671
  9672     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
  9673                                    CM-COMPANY-CD-A1
  9674                                    CM-COMPANY-CD-A2
  9675                                    CM-COMPANY-CD-A4
  9676                                    CM-COMPANY-CD-A5.
  9677
  9678     MOVE CERT-CARRIER           TO CM-CARRIER.
  9679     MOVE CERT-GROUPING          TO CM-GROUPING.
  9680     MOVE CERT-STATE             TO CM-STATE.
  9681     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
  9682     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
  9683     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
  9684
  9685     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
  9686                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
  9687                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
  9688                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
  9689                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
  9690                       CM-LIVES              CM-LOAN-TERM
  9691                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
  9692                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
  9693                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
  9694                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
  9695                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
  9696                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
  9697                       CM-LF-ALT-PREMIUM-RATE
  9698                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
  9699                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
  9700                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
  9701                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
  9702                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
  9703
  9704     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
  9705                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 186
* EL130.cbl
  9706                                    CM-AH-SETTLEMENT-DT
  9707                                    CM-AH-CANCEL-EXIT-DT
  9708                                    CM-AH-SETTLEMENT-EXIT-DT
  9709                                    CM-LF-LOAN-EXPIRE-DT
  9710                                    CM-LF-CANCEL-DT
  9711                                    CM-LF-DEATH-DT
  9712                                    CM-LF-CANCEL-EXIT-DT
  9713                                    CM-LF-DEATH-EXIT-DT
  9714                                    CM-LAST-ADD-ON-DT
  9715                                    CM-ENTRY-DT.
  9716
  9717     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
  9718     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
  9719     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
  9720
  9721     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
  9722                                    CM-PART-LAST-NAME-A2
  9723                                    CM-PART-LAST-NAME-A5.
  9724
  9725     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
  9726                                    CM-INSURED-INITIAL1-A2
  9727                                    CM-INSURED-INITIAL1-A5
  9728                                    CM-INSURED-FIRST-NAME.
  9729
  9730     IF CRTINITL GREATER ZERO
  9731         MOVE CRTINITI           TO CM-INSURED-INITIAL2
  9732                                    CM-INSURED-INITIAL2-A2
  9733                                    CM-INSURED-INITIAL2-A5
  9734     ELSE
  9735         MOVE SPACES             TO CM-INSURED-INITIAL2
  9736                                    CM-INSURED-INITIAL2-A2
  9737                                    CM-INSURED-INITIAL2-A5
  9738     END-IF.
  9739
  9740     IF CM-INSURED-INITIALS = SPACES
  9741         MOVE '**'               TO CM-INSURED-INITIALS
  9742     END-IF.
  9743
  9744     IF MEMBERL GREATER ZERO
  9745         MOVE MEMBERI              TO CM-MEMBER-NO
  9746     ELSE
  9747         MOVE CERT-STATE           TO CM-MEMB-STATE
  9748         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
  9749         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
  9750         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
  9751     END-IF.
  9752
  9753     IF JNTLNMEL GREATER ZERO
  9754         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
  9755     END-IF.
  9756
  9757     IF JNTFNMEL GREATER ZERO
  9758         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
  9759     END-IF.
  9760
  9761     IF JNTINITL GREATER ZERO
  9762         MOVE JNTINITI           TO CM-JT-INITIAL
  9763     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 187
* EL130.cbl
  9764
  9765     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9766
  9767
  9768
  9769* EXEC CICS HANDLE CONDITION
  9770*        DUPKEY   (3690-CERT-WRITTEN)
  9771*    END-EXEC.
  9772*    MOVE '"$$                   ! 9 #00009075' TO DFHEIV0
  9773     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9775     MOVE X'3920233030303039303735' TO DFHEIV0(25:11)
  9776     CALL 'kxdfhei1' USING DFHEIV0
  9777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9778
  9779
  9780
  9781
  9782* EXEC CICS WRITE
  9783*        DATASET   (ELCERT-DSID)
  9784*        FROM      (CERTIFICATE-MASTER)
  9785*        RIDFLD    (CM-CONTROL-PRIMARY)
  9786*    END-EXEC.
  9787     MOVE LENGTH OF
  9788      CERTIFICATE-MASTER
  9789       TO DFHEIV11
  9790*    MOVE '&$ L                  ''   #00009080' TO DFHEIV0
  9791     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9792     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9793     MOVE X'2020233030303039303830' TO DFHEIV0(25:11)
  9794     CALL 'kxdfhei1' USING DFHEIV0,
  9795           ELCERT-DSID,
  9796           CERTIFICATE-MASTER,
  9797           DFHEIV11,
  9798           CM-CONTROL-PRIMARY,
  9799           DFHEIV99,
  9800           DFHEIV99
  9801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9802
  9803
  9804 3690-CERT-WRITTEN.
  9805
  9806     GO TO 3800-BUILD-NEW-CLAIM.
  9807
  9808 3690-EXIT.
  9809      EXIT.
  9810
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 188
* EL130.cbl
  9812 3700-BUILD-CERT.
  9813
  9814     IF CERTMTI NOT = 'A'
  9815         GO TO 3700-FINISH-CERT-BUILD
  9816     END-IF.
  9817
  9818     IF CERTMTI = 'A'
  9819         IF LCVCDL = ZEROS
  9820             MOVE ZEROS          TO CM-LF-BENEFIT-CD
  9821                                    CM-LF-ORIG-TERM
  9822                                    CM-LF-BENEFIT-AMT
  9823                                    CM-LF-PREMIUM-RATE
  9824             GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9825         END-IF
  9826     END-IF.
  9827
  9828     IF LCVCDL GREATER ZERO
  9829         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
  9830     END-IF.
  9831
  9832     IF LCVOTRML GREATER ZERO
  9833         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
  9834     END-IF.
  9835
  9836     IF LCVBENEL GREATER ZERO
  9837         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
  9838     END-IF.
  9839
  9840     IF LCVRATEL GREATER ZERO
  9841         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
  9842     END-IF.
  9843
  9844     IF WS-EXPIRE NOT = LOW-VALUES
  9845         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
  9846     END-IF.
  9847
  9848     IF LCVFORML GREATER ZERO
  9849         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
  9850     END-IF.
  9851
  9852     IF LCVCNDTL = ZERO
  9853        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9854     END-IF.
  9855
  9856     IF WS-LCVCNDT NOT = LOW-VALUES
  9857        MOVE '8'                 TO CM-LF-CURRENT-STATUS
  9858        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
  9859        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9860     END-IF.
  9861
  9862     IF CM-LF-CURRENT-STATUS = '7'
  9863        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
  9864        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
  9865        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
  9866                                    CM-LF-DEATH-DT
  9867        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9868     END-IF.
  9869
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 189
* EL130.cbl
  9870     IF CM-LF-CURRENT-STATUS = '8'
  9871        MOVE '1'                 TO CM-LF-CURRENT-STATUS
  9872        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
  9873     END-IF.
  9874
  9875 3700-BUILD-AH-COVERAGE-SIDE.
  9876
  9877     IF CERTMTI = 'A'
  9878         IF ACVCDL = ZEROS
  9879             MOVE ZEROS          TO CM-AH-BENEFIT-CD
  9880                                    CM-AH-ORIG-TERM
  9881                                    CM-AH-BENEFIT-AMT
  9882                                    CM-AH-PREMIUM-RATE
  9883             GO TO 3700-COVERAGE-BUILT
  9884         END-IF
  9885     END-IF.
  9886
  9887     IF ACVCDL GREATER ZERO
  9888         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
  9889     END-IF.
  9890
  9891     IF ACVOTRML GREATER ZERO
  9892         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
  9893     END-IF.
  9894
  9895     IF ACVBENEL GREATER ZERO
  9896         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
  9897     END-IF.
  9898
  9899     IF ACVRATEL GREATER ZERO
  9900         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
  9901     END-IF.
  9902
  9903     IF WS-EXPIRE NOT = LOW-VALUES
  9904         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
  9905     END-IF.
  9906
  9907     IF ACVFORML GREATER ZERO
  9908         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
  9909     END-IF.
  9910
  9911     IF ACVCNDTL = ZERO
  9912        GO TO 3700-COVERAGE-BUILT
  9913     END-IF.
  9914
  9915     IF WS-ACVCNDT NOT = LOW-VALUES
  9916        MOVE '8'                 TO CM-AH-CURRENT-STATUS
  9917        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
  9918        GO TO 3700-COVERAGE-BUILT
  9919     END-IF.
  9920
  9921     IF CM-AH-CURRENT-STATUS = '6'
  9922        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
  9923        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
  9924        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
  9925        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
  9926        GO TO 3700-COVERAGE-BUILT
  9927     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 190
* EL130.cbl
  9928
  9929     IF CM-AH-CURRENT-STATUS = '8'
  9930        MOVE '1'                 TO CM-AH-CURRENT-STATUS
  9931        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
  9932     END-IF.
  9933
  9934 3700-COVERAGE-BUILT.
  9935     IF ISSAGEL GREATER ZERO
  9936         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
  9937     END-IF.
  9938
  9939     IF JNTAGEL GREATER ZERO
  9940         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
  9941     END-IF.
  9942
  9943     IF SEXL GREATER ZERO
  9944         MOVE SEXI               TO CM-INSURED-SEX
  9945     END-IF.
  9946
  9947     IF APRL GREATER ZERO
  9948         MOVE WS-APR             TO CM-LOAN-APR
  9949     END-IF.
  9950
  9951     IF PMTFREQL GREATER ZERO
  9952         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
  9953     END-IF.
  9954
  9955     IF INDGRPL GREATER ZERO
  9956         MOVE INDGRPI            TO CM-IND-GRP-TYPE
  9957     END-IF.
  9958
  9959     IF CERTMTI = 'A'
  9960         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9961     END-IF.
  9962
  9963     IF REINCDL GREATER ZERO
  9964         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
  9965                                    WS-REIN-1
  9966                                    WS-REIN-2
  9967                                    WS-REIN-3
  9968         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9969     END-IF.
  9970
  9971     IF WS-ADD-ON-DT NOT = LOW-VALUES
  9972         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
  9973     END-IF.
  9974
  9975     IF CRTSSNL GREATER ZERO
  9976         MOVE CRTSSNI            TO CM-SOC-SEC-NO
  9977     ELSE
  9978         IF SSNL GREATER ZERO
  9979             MOVE SSNI           TO CM-SOC-SEC-NO
  9980         END-IF
  9981     END-IF.
  9982
  9983     IF CRTSSNL = ZERO AND
  9984        SSNL    = ZERO
  9985         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 191
* EL130.cbl
  9986         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
  9987         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
  9988         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
  9989     END-IF.
  9990
  9991     IF CM-LF-CURRENT-STATUS = SPACES
  9992         MOVE '1'                TO CM-LF-CURRENT-STATUS
  9993     END-IF.
  9994
  9995     IF CM-AH-CURRENT-STATUS = SPACES
  9996         MOVE '1'                TO CM-AH-CURRENT-STATUS
  9997     END-IF.
  9998
  9999     IF CERTMTI = 'A'
 10000         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10001     END-IF.
 10002
 10003 3700-FINISH-CERT-BUILD.
 10004
 10005     IF LOANNOL GREATER ZERO
 10006         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10007     END-IF.
 10008
 10009     IF LOANBALL GREATER ZERO
 10010         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10011     END-IF.
 10012
 10013     IF PREMTYPL GREATER ZERO
 10014         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10015     END-IF.
 10016
 10017 3700-EXIT.
 10018      EXIT.
 10019
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 192
* EL130.cbl
 10021 3800-BUILD-NEW-CLAIM.
 10022
 10023*************************************************************
 10024*****           START OF ACTIVITY FILE PROCESSING          **
 10025*************************************************************
 10026     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10027         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10028                 6700-EXIT
 10029     END-IF.
 10030*************************************************************
 10031*****            END OF ACTIVITY FILE PROCESSING           **
 10032*************************************************************
 10033
 10034
 10035
 10036
 10037* EXEC CICS GETMAIN
 10038*        SET     (ADDRESS OF CLAIM-MASTER)
 10039*        LENGTH  (ELMSTR-LENGTH)
 10040*    END-EXEC.
 10041*    MOVE '," L                  $   #00009318' TO DFHEIV0
 10042     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10043     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10044     MOVE X'2020233030303039333138' TO DFHEIV0(25:11)
 10045     CALL 'kxdfhei1' USING DFHEIV0,
 10046           DFHEIV20,
 10047           ELMSTR-LENGTH,
 10048           DFHEIV99
 10049     SET ADDRESS OF CLAIM-MASTER TO
 10050         DFHEIV20
 10051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10052
 10053
 10054     MOVE SPACES TO CLAIM-MASTER.
 10055
 10056     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10057         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10058         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10059         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10060         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10061         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10062         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10063         CL-ACTIVITY-MAINT-DT.
 10064
 10065     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10066             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10067             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10068             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10069             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10070             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10071             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10072             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10073             CL-FORCEABLE-ERROR-CNT.
 10074
 10075     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10076
 10077     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10078                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 193
* EL130.cbl
 10079                                    CL-LAG-REPORT-CODE.
 10080
 10081     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10082     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10083
 10084     IF BENECDL NOT = ZEROS
 10085        MOVE BENECDI             TO CL-BENEFICIARY
 10086     END-IF.
 10087
 10088     MOVE 'CL'                   TO CL-RECORD-ID.
 10089     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10090
 10091     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10092                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10093                             CL-COMPANY-CD-A5.
 10094
 10095     MOVE CLMCARRI               TO CL-CARRIER.
 10096
 10097     IF CLMNOL = ZERO
 10098         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10099     ELSE
 10100         MOVE CLMNOI             TO CL-CLAIM-NO
 10101     END-IF.
 10102
 10103     MOVE CERTNOI                TO CL-CERT-PRIME
 10104                                    CL-CERT-A4-PRIME.
 10105
 10106     MOVE SUFXI                  TO CL-CERT-SFX
 10107                                    CL-CERT-A4-SFX.
 10108
 10109     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10110
 10111     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10112
 10113     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10114
 10115     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10116
 10117     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10118     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10119
 10120     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10121
 10122     IF CERTMTI = 'A'
 10123         MOVE '2'                TO CL-CERT-ORIGIN
 10124     ELSE
 10125         MOVE '1'                TO CL-CERT-ORIGIN
 10126     END-IF.
 10127
 10128     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10129     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10130     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10131     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10132     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10133
 10134 3820-REWRITE-CONTROL-FILE.
 10135
 10136     IF CLMNOL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 194
* EL130.cbl
 10137         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10138     END-IF.
 10139
 10140     IF CF-RECORD-TYPE = '6'
 10141         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10142     ELSE
 10143         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10144     END-IF.
 10145
 10146
 10147
 10148* EXEC CICS REWRITE
 10149*        DATASET   (ELCNTL-DSID)
 10150*        FROM      (CONTROL-FILE)
 10151*    END-EXEC.
 10152     MOVE LENGTH OF
 10153      CONTROL-FILE
 10154       TO DFHEIV11
 10155*    MOVE '&& L                  %   #00009416' TO DFHEIV0
 10156     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10157     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10158     MOVE X'2020233030303039343136' TO DFHEIV0(25:11)
 10159     CALL 'kxdfhei1' USING DFHEIV0,
 10160           ELCNTL-DSID,
 10161           CONTROL-FILE,
 10162           DFHEIV11,
 10163           DFHEIV99
 10164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10165
 10166
 10167 3830-SEQUENCE-CLAIM-RECORDS.
 10168
 10169     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10170     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10171     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10172
 10173     IF WS-ASSOC-CERT-TOTAL = ZERO
 10174         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10175                                    CL-ASSOC-CERT-TOTAL
 10176         GO TO 3840-WRITE-CLAIM-MASTER
 10177     END-IF.
 10178
 10179     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10180         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10181     ELSE
 10182         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10183     END-IF.
 10184
 10185     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10186     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10187     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10188
 10189 3840-WRITE-CLAIM-MASTER.
 10190
 10191     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
 10192     IF WS-REC-FOUND-SW = 'Y'
 10193         MOVE 01                 TO  CL-ACTIVITY-CODE
 10194         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 195
* EL130.cbl
 10195         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10196     END-IF.
 10197
 10198
 10199
 10200* EXEC CICS HANDLE CONDITION
 10201*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10202*    END-EXEC.
 10203*    MOVE '"$$                   ! : #00009453' TO DFHEIV0
 10204     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10206     MOVE X'3A20233030303039343533' TO DFHEIV0(25:11)
 10207     CALL 'kxdfhei1' USING DFHEIV0
 10208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10209
 10210
 10211** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10212     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10213
 10214
 10215
 10216* EXEC CICS WRITE
 10217*        DATASET   (ELMSTR-DSID)
 10218*        FROM      (CLAIM-MASTER)
 10219*        RIDFLD    (CL-CONTROL-PRIMARY)
 10220*    END-EXEC.
 10221     MOVE LENGTH OF
 10222      CLAIM-MASTER
 10223       TO DFHEIV11
 10224*    MOVE '&$ L                  ''   #00009461' TO DFHEIV0
 10225     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10226     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10227     MOVE X'2020233030303039343631' TO DFHEIV0(25:11)
 10228     CALL 'kxdfhei1' USING DFHEIV0,
 10229           ELMSTR-DSID,
 10230           CLAIM-MASTER,
 10231           DFHEIV11,
 10232           CL-CONTROL-PRIMARY,
 10233           DFHEIV99,
 10234           DFHEIV99
 10235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10236
 10237
 10238 3850-CLAIM-MSTR-WRITTEN.
 10239
 10240     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10241         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10242     END-IF.
 10243
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 196
* EL130.cbl
 10245 3990-ADD-DONE.
 10246     MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10247                                   EMI-SUB      EMI-SWITCH-AREA-2.
 10248     MOVE SPACES                TO EMI-ACTION-SWITCH
 10249                                   EMI-ERROR-LINES.
 10250
 10251     IF CLMNOL = ZERO
 10252         MOVE ER-0265            TO EMI-ERROR
 10253         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10254         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (1)
 10255                                    PI-LAST-CLAIM
 10256     ELSE
 10257         MOVE CLMNOI             TO PI-LAST-CLAIM
 10258         MOVE ER-0000            TO EMI-ERROR
 10259         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10260     END-IF.
 10261
 10262     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10263       AND PI-ST-VFY-2ND-BENE = 'Y'
 10264         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10265         MOVE ER-7575            TO EMI-ERROR
 10266         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10267     END-IF.
 10268
 10269     IF WS-NO-INSURED-ADDRESS = 'Y'
 10270         MOVE ER-3548            TO EMI-ERROR
 10271         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10272     END-IF.
 10273
 10274     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10275     MOVE CLMCARRI                   TO  PI-CARRIER.
 10276     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10277     MOVE SUFXI                      TO  PI-CERT-SFX.
 10278
 10279     IF WS-LETTER-SW = 'Y'
 10280         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10281         IF W-1523-ERROR-CODE NOT = ZEROS
 10282             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10283             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10284         END-IF
 10285     END-IF.
 10286
 10287     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10288     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10289     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10290     MOVE CLMCARRI               TO PI-LAST-CARR.
 10291
 10292     IF PRTOPTL GREATER THAN 0
 10293         MOVE PRTOPTI            TO PI-PRT-OPT
 10294     END-IF.
 10295     IF ALTPRTL GREATER THAN 0
 10296         MOVE ALTPRTI            TO PI-ALT-PRT
 10297     END-IF.
 10298
 10299     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10300         MOVE LOW-VALUES         TO EL130AI
 10301         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10302         MOVE AL-SANON           TO CERTNOA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 197
* EL130.cbl
 10303         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10304         MOVE AL-SANON           TO SUFXA
 10305         MOVE PI-LAST-CARR       TO CLMCARRO
 10306         MOVE AL-UANON           TO CLMCARRA
 10307         MOVE PI-LAST-CLAIM      TO CLMNOO
 10308         MOVE AL-UANON           TO CLMNOA
 10309         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10310         MOVE AL-UANON           TO CLMTYPEA
 10311     ELSE
 10312         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10313         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10314     END-IF.
 10315
 10316     IF PI-PRT-OPT = 'N' OR 'L'
 10317         MOVE PI-PRT-OPT         TO PRTOPTO
 10318         MOVE 1                  TO PRTOPTL
 10319     END-IF.
 10320
 10321     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10322         MOVE PI-ALT-PRT         TO ALTPRTO
 10323         MOVE 4                  TO ALTPRTL
 10324     END-IF.
 10325
 10326     IF PRTOPTL GREATER THAN 0
 10327         IF PRTOPTI = 'L'
 10328             GO TO 0400-CREATE-ELACTQ
 10329         ELSE
 10330             GO TO 0480-PRINT-NOW
 10331         END-IF
 10332     END-IF.
 10333
 10334     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10335         GO TO 8100-SEND-INITIAL-MAP
 10336     ELSE
 10337         MOVE LOW-VALUES         TO MAINTO
 10338         MOVE -1                 TO MAINTL
 10339         GO TO 8200-SEND-DATAONLY
 10340     END-IF.
 10341
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 198
* EL130.cbl
 10343 3993-MODIFY-SCREEN-ATTRB.
 10344
 10345     IF CERTMTL GREATER ZERO
 10346         MOVE AL-UANON           TO CERTMTA
 10347     END-IF.
 10348
 10349     IF EFFDTL GREATER ZERO
 10350         MOVE AL-UANON           TO EFFDTA
 10351     END-IF.
 10352
 10353     IF ACCOUNTL GREATER ZERO
 10354         MOVE AL-UANON           TO ACCOUNTA
 10355     END-IF.
 10356
 10357     IF STATEL GREATER ZERO
 10358         MOVE AL-UANON           TO STATEA
 10359     END-IF.
 10360
 10361     IF CRTCARRL GREATER ZERO
 10362         MOVE AL-UANON           TO CRTCARRA
 10363     END-IF.
 10364
 10365     IF GROUPL GREATER ZERO
 10366         MOVE AL-UANON           TO GROUPA
 10367     END-IF.
 10368
 10369     IF CRTLNMEL GREATER ZERO
 10370         MOVE AL-UANON           TO CRTLNMEA
 10371     END-IF.
 10372
 10373     IF CRTFNMEL GREATER ZERO
 10374         MOVE AL-UANON           TO CRTFNMEA
 10375     END-IF.
 10376
 10377     IF CRTINITL GREATER ZERO
 10378         MOVE AL-UANON           TO CRTINITA
 10379     END-IF.
 10380
 10381     IF ISSAGEL GREATER ZERO
 10382         MOVE AL-UNNON           TO ISSAGEA
 10383     END-IF.
 10384
 10385     IF JNTLNMEL GREATER ZERO
 10386         MOVE AL-UANON           TO JNTLNMEA
 10387     END-IF.
 10388
 10389     IF JNTFNMEL GREATER ZERO
 10390         MOVE AL-UANON           TO JNTFNMEA
 10391     END-IF.
 10392
 10393     IF JNTINITL GREATER ZERO
 10394         MOVE AL-UANON           TO JNTINITA
 10395     END-IF.
 10396
 10397     IF JNTAGEL GREATER ZERO
 10398         MOVE AL-UNNON           TO JNTAGEA
 10399     END-IF.
 10400
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 199
* EL130.cbl
 10401     IF CRTSSNL GREATER ZERO
 10402         MOVE AL-UANON           TO CRTSSNA
 10403     END-IF.
 10404
 10405     IF ACVDSCRL GREATER ZERO
 10406         MOVE AL-SANON           TO ACVDSCRA
 10407     END-IF.
 10408
 10409     IF ACVKINDL GREATER ZERO
 10410         MOVE AL-SANON           TO ACVKINDA
 10411     END-IF.
 10412
 10413     IF ACVCDL GREATER ZERO
 10414         MOVE AL-UANON           TO ACVCDA
 10415     END-IF.
 10416
 10417     IF ACVOTRML GREATER ZERO
 10418         MOVE AL-UNNON           TO ACVOTRMA
 10419     END-IF.
 10420
 10421     IF ACVRTRML GREATER ZERO
 10422         MOVE AL-UNNON           TO ACVRTRMA
 10423     END-IF.
 10424
 10425     IF ACVRATEL GREATER ZERO
 10426         MOVE AL-UNNON           TO ACVRATEA
 10427     END-IF.
 10428
 10429     IF ACVBENEL GREATER ZERO
 10430         MOVE AL-UNNON           TO ACVBENEA
 10431     END-IF.
 10432
 10433     IF ACVFORML GREATER ZERO
 10434         MOVE AL-UANON           TO ACVFORMA
 10435     END-IF.
 10436
 10437     IF ACVCNDTL GREATER ZERO
 10438         MOVE AL-UANON           TO ACVCNDTA
 10439     END-IF.
 10440
 10441     IF ACVEXITL GREATER ZERO
 10442         MOVE AL-UANON           TO ACVEXITA
 10443     END-IF.
 10444
 10445     IF ACVSTATL GREATER ZERO
 10446         MOVE AL-UANON           TO ACVSTATA
 10447     END-IF.
 10448
 10449     IF LCVDSCRL GREATER ZERO
 10450         MOVE AL-SANON           TO LCVDSCRA
 10451     END-IF.
 10452
 10453     IF LCVKINDL GREATER ZERO
 10454         MOVE AL-SANON           TO LCVKINDA
 10455     END-IF.
 10456
 10457     IF LCVCDL GREATER ZERO
 10458         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 200
* EL130.cbl
 10459     END-IF.
 10460
 10461     IF LCVOTRML GREATER ZERO
 10462         MOVE AL-UNNON           TO LCVOTRMA
 10463     END-IF.
 10464
 10465     IF LCVRTRML GREATER ZERO
 10466         MOVE AL-UNNON           TO LCVRTRMA
 10467     END-IF.
 10468
 10469     IF LCVRATEL GREATER ZERO
 10470         MOVE AL-UNNON           TO LCVRATEA
 10471     END-IF.
 10472
 10473     IF LCVBENEL GREATER ZERO
 10474         MOVE AL-UNNON           TO LCVBENEA
 10475     END-IF.
 10476
 10477     IF LCVFORML GREATER ZERO
 10478         MOVE AL-UANON           TO LCVFORMA
 10479     END-IF.
 10480
 10481     IF LCVCNDTL GREATER ZERO
 10482         MOVE AL-UANON           TO LCVCNDTA
 10483     END-IF.
 10484
 10485     IF LCVEXITL GREATER ZERO
 10486         MOVE AL-UANON           TO LCVEXITA
 10487     END-IF.
 10488
 10489     IF LCVSTATL GREATER ZERO
 10490         MOVE AL-UANON           TO LCVSTATA
 10491     END-IF.
 10492
 10493     IF MEMCAPL GREATER ZERO
 10494         MOVE AL-UANON           TO MEMCAPA
 10495     END-IF.
 10496
 10497     IF APRL GREATER ZERO
 10498         MOVE AL-UNNON           TO APRA
 10499     END-IF.
 10500
 10501     IF PMTFREQL GREATER ZERO
 10502         MOVE AL-UNNON           TO PMTFREQA
 10503     END-IF.
 10504
 10505     IF INDGRPL GREATER ZERO
 10506         MOVE AL-UANON           TO INDGRPA
 10507     END-IF.
 10508
 10509     IF PREMTYPL GREATER ZERO
 10510         MOVE AL-UANON           TO PREMTYPA
 10511     END-IF.
 10512
 10513     IF REINCDL GREATER ZERO
 10514         MOVE AL-UANON           TO REINCDA
 10515     END-IF.
 10516
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 201
* EL130.cbl
 10517     IF ADDONDTL GREATER ZERO
 10518         MOVE AL-UANON           TO ADDONDTA
 10519     END-IF.
 10520
 10521     IF MEMBERL GREATER ZERO
 10522         MOVE AL-UANON           TO MEMBERA
 10523     END-IF.
 10524
 10525     IF BCERT1L GREATER ZERO
 10526         MOVE AL-SANON           TO BCERT1A
 10527                                    BSUFX1A
 10528     END-IF.
 10529
 10530     IF BCERT2L GREATER ZERO
 10531         MOVE AL-SANON           TO BCERT2A
 10532                                    BSUFX2A
 10533     END-IF.
 10534
 10535     IF BCERT3L GREATER ZERO
 10536         MOVE AL-SANON           TO BCERT3A
 10537                                    BSUFX3A
 10538     END-IF.
 10539
 10540     IF BCERT4L GREATER ZERO
 10541         MOVE AL-SANON           TO BCERT4A
 10542                                    BSUFX4A
 10543     END-IF.
 10544
 10545     IF BCERT5L GREATER ZERO
 10546         MOVE AL-SANON           TO BCERT5A
 10547                                    BSUFX5A
 10548     END-IF.
 10549
 10550 3993-MODIFY-CLAIM-ATTRB.
 10551
 10552     IF PCERTNOL GREATER ZERO
 10553         MOVE AL-UANON           TO PCERTNOA
 10554     END-IF.
 10555
 10556     IF PSUFXL GREATER ZERO
 10557         MOVE AL-UANON           TO PSUFXA
 10558     END-IF.
 10559
 10560     IF LSTNMEL GREATER ZERO
 10561         MOVE AL-UANON           TO LSTNMEA
 10562     END-IF.
 10563
 10564     IF FSTNMEL GREATER ZERO
 10565         MOVE AL-UANON           TO FSTNMEA
 10566     END-IF.
 10567
 10568     IF INITL GREATER ZERO
 10569         MOVE AL-UANON           TO INITA
 10570     END-IF.
 10571
 10572     IF SEXL GREATER ZERO
 10573         MOVE AL-UANON           TO SEXA
 10574     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 202
* EL130.cbl
 10575
 10576     IF OCCCDL GREATER ZERO
 10577         MOVE AL-UANON           TO OCCCDA
 10578     END-IF.
 10579
 10580     IF BIRTHDTL GREATER ZERO
 10581         MOVE AL-UANON           TO BIRTHDTA
 10582     END-IF.
 10583
 10584     IF SSNL GREATER ZERO
 10585         MOVE AL-UANON           TO SSNA
 10586     END-IF.
 10587
 10588     IF INCURL GREATER ZERO
 10589         MOVE AL-UANON           TO INCURA
 10590     END-IF.
 10591
 10592     IF REPORTL GREATER ZERO
 10593         MOVE AL-UANON           TO REPORTA
 10594     END-IF.
 10595
 10596     IF ESTENDL GREATER ZERO
 10597         MOVE AL-UANON           TO ESTENDA
 10598     END-IF.
 10599
 10600     IF DIAGL GREATER ZERO
 10601         MOVE AL-UANON           TO DIAGA
 10602     END-IF.
 10603
 10604     IF CAUSEL GREATER ZERO
 10605         MOVE AL-UANON           TO CAUSEA
 10606     END-IF.
 10607
 10608     IF MANRSVL GREATER ZERO
 10609         MOVE AL-UNNON           TO MANRSVA
 10610     END-IF.
 10611
 10612     IF RELCLML GREATER ZERO
 10613         MOVE AL-UANON           TO RELCLMA
 10614     END-IF.
 10615
 10616     IF LOANNOL GREATER ZERO
 10617         MOVE AL-UANON           TO LOANNOA
 10618     END-IF.
 10619
 10620     IF LOANBALL GREATER ZERO
 10621         MOVE AL-UNNON           TO LOANBALA
 10622     END-IF.
 10623
 10624     IF PROCCDL GREATER ZERO
 10625         MOVE AL-UANON           TO PROCCDA
 10626     END-IF.
 10627
 10628     IF BENECDL GREATER THAN ZERO
 10629         MOVE AL-UANON           TO  BENECDA
 10630     END-IF.
 10631
 10632     IF PRICDL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 203
* EL130.cbl
 10633         MOVE AL-UANON           TO PRICDA
 10634     END-IF.
 10635
 10636     IF SUPVL GREATER ZERO
 10637         MOVE AL-UANON           TO SUPVA
 10638     END-IF.
 10639
 10640     IF FILETOL GREATER ZERO
 10641         MOVE AL-UANON           TO FILETOA
 10642     END-IF.
 10643
 10644
 10645 3993-MODIFY-CLAIM-KEY-ATTRB.
 10646
 10647     IF CLMNOL GREATER ZERO
 10648         MOVE AL-UANON           TO CLMNOA
 10649     END-IF.
 10650
 10651     IF CLMCARRL GREATER ZERO
 10652         MOVE AL-UANON           TO CLMCARRA
 10653     END-IF.
 10654
 10655     IF CLMTYPEL GREATER ZERO
 10656         MOVE AL-UANON           TO CLMTYPEA
 10657     END-IF.
 10658
 10659     IF CERTNOL GREATER ZERO
 10660         MOVE AL-SANON           TO CERTNOA
 10661     END-IF.
 10662
 10663     IF SUFXL GREATER ZERO
 10664         MOVE AL-SANON           TO SUFXA
 10665     END-IF.
 10666
 10667 3993-EXIT.
 10668     EXIT.
 10669
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 204
* EL130.cbl
 10671 3994-BUILD-NINETY-THREE-TRAILER.
 10672
 10673     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 10674     MOVE 'AT'                   TO AT-RECORD-ID.
 10675
 10676     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 10677     MOVE CLMCARRI               TO AT-CARRIER.
 10678
 10679     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 10680     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 10681     MOVE +93                    TO AT-SEQUENCE-NO.
 10682     MOVE '6'                    TO AT-TRAILER-TYPE.
 10683     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 10684
 10685     MOVE WS-VERIFY-NOTE         TO AT-INFO-LINE-1.
 10686
 10687     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 10688                                    AT-GEN-INFO-LAST-MAINT-DT.
 10689
 10690     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10691                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10692     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10693
 10694
 10695
 10696* EXEC CICS WRITE
 10697*        DATASET   (ELTRLR-DSID)
 10698*        FROM      (ACTIVITY-TRAILERS)
 10699*        RIDFLD    (AT-CONTROL-PRIMARY)
 10700*    END-EXEC.
 10701     MOVE LENGTH OF
 10702      ACTIVITY-TRAILERS
 10703       TO DFHEIV11
 10704*    MOVE '&$ L                  ''   #00009924' TO DFHEIV0
 10705     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10706     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10707     MOVE X'2020233030303039393234' TO DFHEIV0(25:11)
 10708     CALL 'kxdfhei1' USING DFHEIV0,
 10709           ELTRLR-DSID,
 10710           ACTIVITY-TRAILERS,
 10711           DFHEIV11,
 10712           AT-CONTROL-PRIMARY,
 10713           DFHEIV99,
 10714           DFHEIV99
 10715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10716
 10717
 10718 3994-EXIT.
 10719     EXIT.
 10720
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 205
* EL130.cbl
 10722 3995-BUILD-CLAIM-RECORD.
 10723
 10724     IF PROCCDL GREATER ZERO
 10725         MOVE PROCCDI            TO CL-PROCESSOR-ID
 10726     ELSE
 10727         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 10728     END-IF.
 10729
 10730     IF FSTNMEL GREATER ZERO
 10731         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 10732     END-IF.
 10733
 10734     IF INITL GREATER ZERO
 10735         MOVE INITI              TO CL-INSURED-MID-INIT
 10736     END-IF.
 10737
 10738     IF BIRTHDTL GREATER ZERO
 10739         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 10740     END-IF.
 10741
 10742     IF SEXL GREATER ZERO
 10743         MOVE SEXI               TO CL-INSURED-SEX-CD
 10744     END-IF.
 10745
 10746     IF OCCCDL GREATER ZERO
 10747         MOVE OCCCDI             TO CL-INSURED-OCC-CD
 10748     END-IF.
 10749
 10750     MOVE 'O'                    TO CL-CLAIM-STATUS.
 10751
 10752*    IF CLMTYPEL GREATER ZERO
 10753     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 10754*    END-IF.
 10755
 10756     IF PREMTYPL GREATER ZERO
 10757         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 10758     END-IF.
 10759
 10760     IF INCURL GREATER ZERO
 10761         MOVE WS-INCUR           TO CL-INCURRED-DT
 10762     END-IF.
 10763
 10764     IF REPORTL GREATER ZERO
 10765         MOVE WS-REPORT          TO CL-REPORTED-DT
 10766     END-IF.
 10767
 10768     IF EIBAID = DFHPF6
 10769         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
 10770             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 10771                 IF EMI-FORCABLE-CTR = +1
 10772                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 10773                 END-IF
 10774         END-IF
 10775     END-IF.
 10776
 10777     IF ESTENDL GREATER ZERO
 10778        MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 10779     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 206
* EL130.cbl
 10780
 10781     IF ADDONDTL GREATER ZERO
 10782         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 10783     END-IF.
 10784
 10785     IF CAUSEL GREATER ZERO
 10786         MOVE CAUSEI             TO CL-CAUSE-CD
 10787     END-IF.
 10788
 10789     IF SSNL GREATER ZERO
 10790         MOVE SSNI               TO CL-SOC-SEC-NO
 10791     ELSE
 10792         MOVE CERT-STATE         TO CL-SSN-STATE
 10793         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 10794         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 10795     END-IF.
 10796
 10797     IF PRICDL GREATER ZERO
 10798         MOVE PRICDI             TO CL-PRIORITY-CD
 10799     END-IF.
 10800
 10801     IF SUPVL GREATER ZERO
 10802         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 10803     END-IF.
 10804
 10805     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 10806     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 10807     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 10808
 10809     IF RELCLML GREATER ZERO
 10810         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 10811     END-IF.
 10812
 10813     IF FILETOL GREATER ZERO
 10814         MOVE FILETOI            TO CL-FILE-LOCATION
 10815     END-IF.
 10816
 10817 3995-EXIT.
 10818      EXIT.
 10819
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 207
* EL130.cbl
 10821 4000-CALCULATE-CERT-TERM.
 10822
 10823     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 10824
 10825     MOVE N                      TO WS-TERM.
 10826
 10827     IF WS-TERM GREATER 120
 10828         MOVE 120                TO WS-TERM
 10829     END-IF.
 10830
 10831 4000-CALC-TERM-EXIT.
 10832      EXIT.
 10833
 10834 4100-CALC-GROSS-TERM.
 10835     MOVE HOLD-LOAN-BAL           TO L.
 10836     MOVE WS-ACVBENE              TO M.
 10837     COMPUTE N = L / M.
 10838     IF N LESS 1
 10839         MOVE 1  TO N
 10840     END-IF.
 10841
 10842     IF LCVCDL GREATER ZERO
 10843         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 10844     ELSE
 10845         MOVE ZEROS               TO WS-LF-RATE
 10846     END-IF.
 10847
 10848     IF ACVCDL GREATER ZERO
 10849         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 10850     ELSE
 10851         MOVE ZEROS               TO WS-AH-RATE
 10852     END-IF.
 10853
 10854     COMPUTE I = WS-APR / +1200.
 10855
 10856 4105-LOOP.
 10857     IF N GREATER 240
 10858         GO TO 4200-EXIT
 10859     END-IF.
 10860
 10861     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 10862
 10863     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 10864         ADD 1 TO N
 10865         GO TO 4105-LOOP
 10866     END-IF.
 10867
 10868 4200-EXIT.
 10869      EXIT.
 10870
 10871 4210-CALC-LEFT-RIGHTONE.
 10872      MOVE L         TO LEFT-TOT-1.
 10873      SUBTRACT 1 FROM N.
 10874      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10875      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 10876      ADD 1 TO N.
 10877
 10878 4211-CALC-TERM1.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 208
* EL130.cbl
 10879      MOVE N         TO TERM1.
 10880      MULTIPLY M BY TERM1.
 10881
 10882 4212-LOOP.
 10883      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 10884      ADD 1 TO A-N.
 10885      MULTIPLY A-N BY TERM1.
 10886      SUBTRACT 1 FROM A-N.
 10887      ADD TERM1 TO LEFT-TOT-1.
 10888
 10889 4213-CALC-TERM2.
 10890      MOVE M         TO TERM2.
 10891      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 10892      MULTIPLY IA-N BY TERM2.
 10893      SUBTRACT TERM2 FROM LEFT-TOT-1.
 10894
 10895 4215-CALC-RIGHTONE.
 10896      MOVE M         TO RIGHT-TOT-1.
 10897      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10898      MULTIPLY A-N BY RIGHT-TOT-1.
 10899
 10900 4220-EXIT.
 10901      EXIT.
 10902
 10903 4300-CALC-A-N.
 10904     IF N LESS 1
 10905         MOVE 0     TO A-N
 10906         GO TO 4300-EXIT
 10907     END-IF.
 10908
 10909     IF I = 0
 10910         MOVE .00001 TO I
 10911     END-IF.
 10912
 10913     ADD 1 TO I.
 10914     DIVIDE I INTO 1 GIVING V.
 10915     SUBTRACT 1 FROM I.
 10916     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 10917     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 10918     DIVIDE I INTO TERM3 GIVING A-N.
 10919
 10920 4300-EXIT.
 10921      EXIT.
 10922
 10923 4350-CALC-IA-N.
 10924     IF N LESS 1
 10925         MOVE 0      TO IA-N
 10926         GO TO 4400-EXIT
 10927     END-IF.
 10928
 10929     ADD 1 TO N.
 10930     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 10931     SUBTRACT 1 FROM N.
 10932     MULTIPLY N BY V-EX-N GIVING TERM3.
 10933     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 10934     SUBTRACT V FROM 1 GIVING TERM4.
 10935     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 10936
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 209
* EL130.cbl
 10937 4400-EXIT.
 10938      EXIT.
 10939
 10940 4450-CALC-V-EX-N.
 10941     IF N LESS 1
 10942         MOVE 1    TO V-EX-N
 10943         GO TO 4490-EXIT
 10944     END-IF.
 10945
 10946     MOVE N        TO NV-STORE.
 10947
 10948     IF V-EX-ONETIME = 1  OR
 10949        V NOT = V-EXPONENT (1)
 10950          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 10951     END-IF.
 10952
 10953 4460-LOOP.
 10954     IF N GREATER 248
 10955         MOVE 248 TO N
 10956     END-IF.
 10957
 10958     IF N = 1
 10959         MOVE V               TO V-EX-N
 10960     ELSE
 10961         MOVE V-EXPONENT (N)  TO V-EX-N
 10962     END-IF.
 10963
 10964     GO TO 4490-EXIT.
 10965
 10966 4470-BUILD-V-EX-TABLE.
 10967     MOVE 2      TO N.
 10968     MOVE V      TO V-EXPONENT (1)
 10969                    V-EX-N.
 10970
 10971 4471-LOOP.
 10972     MULTIPLY V BY V-EX-N.
 10973     MOVE V-EX-N   TO V-EXPONENT (N).
 10974
 10975     ADD 1 TO N.
 10976     IF N LESS 248
 10977         GO TO 4471-LOOP
 10978     END-IF.
 10979
 10980     MOVE NV-STORE     TO N.
 10981     MOVE ZERO         TO V-EX-ONETIME.
 10982
 10983 4480-EXIT.
 10984      EXIT.
 10985
 10986 4490-EXIT.
 10987      EXIT.
 10988
 10989 4500-CALC-NET-TERM.
 10990     MOVE HOLD-LOAN-BAL           TO L.
 10991     MOVE WS-ACVBENE              TO M.
 10992     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 10993
 10994     IF WS-REMAIN GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 210
* EL130.cbl
 10995         ADD 1 TO N
 10996     END-IF.
 10997
 10998     IF N = 0
 10999         MOVE 1 TO N
 11000     END-IF.
 11001
 11002 4700-EXIT.
 11003      EXIT.
 11004
 11005 4999-CALC-TERM-EXIT.
 11006     EXIT.
 11007
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 211
* EL130.cbl
 11009 5000-INCURRED-CHANGE.
 11010     IF NOT MODIFY-CAP
 11011         MOVE ER-0070            TO EMI-ERROR
 11012         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11013         MOVE -1                 TO MAINTL
 11014         GO TO 8200-SEND-DATAONLY
 11015     END-IF.
 11016
 11017     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 11018        CLMCARRI     NOT = PI-LAST-CARR        OR
 11019        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 11020        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 11021        PI-INCURR-SW NOT = 'Y'
 11022          GO TO 1000-SHOW-CLAIM
 11023     END-IF.
 11024
 11025     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 11026     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 11027     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 11028
 11029     IF EMI-NO-ERRORS
 11030         GO TO 5000-TRY-TO-BUILD
 11031     END-IF.
 11032
 11033     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 11034        MOVE ER-0433             TO EMI-ERROR
 11035        MOVE -1                  TO MAINTL
 11036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11037        GO TO 8200-SEND-DATAONLY
 11038     END-IF.
 11039
 11040     IF EIBAID = DFHPF6
 11041         IF EMI-FATAL-CTR NOT EQUAL ZERO
 11042            MOVE ER-0434         TO EMI-ERROR
 11043            MOVE -1              TO MAINTL
 11044            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11045            GO TO 8200-SEND-DATAONLY
 11046         ELSE
 11047            MOVE +1              TO INCURL
 11048            GO TO 5000-TRY-TO-BUILD
 11049         END-IF
 11050     END-IF.
 11051
 11052     GO TO 8200-SEND-DATAONLY.
 11053
 11054 5000-TRY-TO-BUILD.
 11055
 11056     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 11057
 11058     MOVE CLMCARRI               TO MSTR-CARRIER.
 11059
 11060     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 11061     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 11062     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 11063
 11064     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 11065
 11066     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 212
* EL130.cbl
 11067         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 11068     END-IF.
 11069
 11070     IF CL-PURGED-DT NOT = LOW-VALUES
 11071
 11072
 11073* EXEC CICS UNLOCK
 11074*            DATASET   (ELMSTR-DSID)
 11075*        END-EXEC
 11076*    MOVE '&*                    #   #00010284' TO DFHEIV0
 11077     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11078     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11079     MOVE X'2020233030303130323834' TO DFHEIV0(25:11)
 11080     CALL 'kxdfhei1' USING DFHEIV0,
 11081           ELMSTR-DSID,
 11082           DFHEIV99
 11083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11084         MOVE ER-7691            TO EMI-ERROR
 11085         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11086         MOVE -1                 TO MAINTL
 11087         GO TO 8200-SEND-DATAONLY
 11088     END-IF.
 11089
 11090     IF CL-AUTO-PAY-SEQ NOT = ZERO
 11091
 11092
 11093* EXEC CICS UNLOCK
 11094*            DATASET   (ELMSTR-DSID)
 11095*       END-EXEC
 11096*    MOVE '&*                    #   #00010295' TO DFHEIV0
 11097     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11098     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11099     MOVE X'2020233030303130323935' TO DFHEIV0(25:11)
 11100     CALL 'kxdfhei1' USING DFHEIV0,
 11101           ELMSTR-DSID,
 11102           DFHEIV99
 11103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11104         MOVE ER-0523             TO EMI-ERROR
 11105         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11106         MOVE -1                  TO MAINTL
 11107         GO TO 8200-SEND-DATAONLY
 11108     END-IF.
 11109
 11110     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 11111
 11112     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 11113     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 11114     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 11115     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 11116     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 11117
 11118     IF MANRSVL GREATER ZERO
 11119        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 11120                                    AT-CURRENT-MANUAL-RESERVE
 11121     END-IF.
 11122     MOVE 1                      TO SUB.
 11123
 11124 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 213
* EL130.cbl
 11125     IF SUB = 1
 11126        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 11127        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 11128        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 11129     ELSE
 11130        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 11131        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 11132                                    AT-OPEN-CLOSE-REASON (SUB)
 11133     END-IF.
 11134
 11135     IF SUB NOT = 6
 11136        ADD 1                    TO SUB
 11137        GO TO 5010-LOOP
 11138     END-IF.
 11139
 11140 5020-UPDATE.
 11141
 11142     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11143
 11144     IF DIAGL = ZERO
 11145         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 11146         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 11147         GO TO 5025-BYPASS-UPDATE
 11148     END-IF.
 11149
 11150     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 11151
 11152     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 11153     MOVE DIAGI                  TO AT-INFO-LINE-1.
 11154
 11155     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11156
 11157 5025-BYPASS-UPDATE.
 11158
 11159
 11160
 11161* EXEC CICS GETMAIN
 11162*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11163*        LENGTH   (ELTRLR-LENGTH)
 11164*    END-EXEC.
 11165*    MOVE '," L                  $   #00010354' TO DFHEIV0
 11166     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11167     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11168     MOVE X'2020233030303130333534' TO DFHEIV0(25:11)
 11169     CALL 'kxdfhei1' USING DFHEIV0,
 11170           DFHEIV20,
 11171           ELTRLR-LENGTH,
 11172           DFHEIV99
 11173     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11174         DFHEIV20
 11175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11176
 11177
 11178     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11179     MOVE 'AT'                   TO AT-RECORD-ID.
 11180
 11181     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11182     MOVE MSTR-CARRIER           TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 214
* EL130.cbl
 11183     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11184     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 11185     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 11186     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 11187     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11188     MOVE '9'                    TO AT-TRAILER-TYPE.
 11189     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11190     MOVE '5'                    TO DC-OPTION-CODE.
 11191     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11192     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 11193
 11194     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 11195     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11196
 11197     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 11198     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 11199     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 11200     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 11201     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 11202     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 11203     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 11204     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 11205     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 11206     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 11207
 11208     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 11209     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 11210     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 11211     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 11212     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 11213
 11214
 11215
 11216* EXEC CICS WRITE
 11217*        DATASET   (ELTRLR-DSID)
 11218*        FROM      (ACTIVITY-TRAILERS)
 11219*        RIDFLD    (AT-CONTROL-PRIMARY)
 11220*    END-EXEC.
 11221     MOVE LENGTH OF
 11222      ACTIVITY-TRAILERS
 11223       TO DFHEIV11
 11224*    MOVE '&$ L                  ''   #00010396' TO DFHEIV0
 11225     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11226     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11227     MOVE X'2020233030303130333936' TO DFHEIV0(25:11)
 11228     CALL 'kxdfhei1' USING DFHEIV0,
 11229           ELTRLR-DSID,
 11230           ACTIVITY-TRAILERS,
 11231           DFHEIV11,
 11232           AT-CONTROL-PRIMARY,
 11233           DFHEIV99,
 11234           DFHEIV99
 11235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11236
 11237
 11238     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 11239     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 11240     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 215
* EL130.cbl
 11241     MOVE CL-CERT-STATE          TO CERT-STATE.
 11242     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 11243     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 11244     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 11245
 11246
 11247
 11248* EXEC CICS HANDLE CONDITION
 11249*        NOTFND   (5050-CERT-NOT-FOUND)
 11250*    END-EXEC.
 11251*    MOVE '"$I                   ! ; #00010411' TO DFHEIV0
 11252     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11253     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11254     MOVE X'3B20233030303130343131' TO DFHEIV0(25:11)
 11255     CALL 'kxdfhei1' USING DFHEIV0
 11256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11257
 11258
 11259     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 11260
 11261     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 11262
 11263
 11264
 11265* EXEC CICS HANDLE CONDITION
 11266*         DUPKEY   (5030-CERT-WRITTEN)
 11267*    END-EXEC.
 11268*    MOVE '"$$                   ! < #00010420' TO DFHEIV0
 11269     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11271     MOVE X'3C20233030303130343230' TO DFHEIV0(25:11)
 11272     CALL 'kxdfhei1' USING DFHEIV0
 11273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11274
 11275
 11276
 11277
 11278* EXEC CICS REWRITE
 11279*        DATASET  (ELCERT-DSID)
 11280*        FROM     (CERTIFICATE-MASTER)
 11281*    END-EXEC.
 11282     MOVE LENGTH OF
 11283      CERTIFICATE-MASTER
 11284       TO DFHEIV11
 11285*    MOVE '&& L                  %   #00010425' TO DFHEIV0
 11286     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11287     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11288     MOVE X'2020233030303130343235' TO DFHEIV0(25:11)
 11289     CALL 'kxdfhei1' USING DFHEIV0,
 11290           ELCERT-DSID,
 11291           CERTIFICATE-MASTER,
 11292           DFHEIV11,
 11293           DFHEIV99
 11294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11295
 11296
 11297 5030-CERT-WRITTEN.
 11298
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 216
* EL130.cbl
 11299     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 11300                                    CL-INCURRED-DT
 11301                                    CL-REPORTED-DT
 11302                                    CL-EST-END-OF-DISAB-DT
 11303                                    CL-PAID-THRU-DT.
 11304
 11305     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 11306                                    CL-NO-OF-PMTS-MADE
 11307                                    CL-NO-OF-DAYS-PAID.
 11308
 11309     IF CLAIM-IS-CLOSED
 11310        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 11311        MOVE 'O'                 TO CL-CLAIM-STATUS
 11312     END-IF.
 11313
 11314     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 11315     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 11316     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11317
 11318
 11319
 11320* EXEC CICS HANDLE CONDITION
 11321*         DUPKEY   (5035-CLAIM-WRITTEN)
 11322*    END-EXEC.
 11323*    MOVE '"$$                   ! = #00010452' TO DFHEIV0
 11324     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11325     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11326     MOVE X'3D20233030303130343532' TO DFHEIV0(25:11)
 11327     CALL 'kxdfhei1' USING DFHEIV0
 11328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11329
 11330
 11331
 11332
 11333* EXEC CICS REWRITE
 11334*        DATASET   (ELMSTR-DSID)
 11335*        FROM      (CLAIM-MASTER)
 11336*    END-EXEC.
 11337     MOVE LENGTH OF
 11338      CLAIM-MASTER
 11339       TO DFHEIV11
 11340*    MOVE '&& L                  %   #00010457' TO DFHEIV0
 11341     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11342     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11343     MOVE X'2020233030303130343537' TO DFHEIV0(25:11)
 11344     CALL 'kxdfhei1' USING DFHEIV0,
 11345           ELMSTR-DSID,
 11346           CLAIM-MASTER,
 11347           DFHEIV11,
 11348           DFHEIV99
 11349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11350
 11351
 11352 5035-CLAIM-WRITTEN.
 11353
 11354     MOVE ER-0000                TO EMI-ERROR.
 11355     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11356
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 217
* EL130.cbl
 11357     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 11358     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 11359     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 11360     MOVE CLMCARRI               TO PI-LAST-CARR.
 11361
 11362     IF PRTOPTL GREATER ZERO
 11363         MOVE PRTOPTI            TO PI-PRT-OPT
 11364     END-IF.
 11365
 11366     IF ALTPRTL GREATER ZERO
 11367         MOVE ALTPRTI            TO PI-ALT-PRT
 11368     END-IF.
 11369
 11370     MOVE LOW-VALUES             TO EL130AI.
 11371
 11372     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 11373     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 11374     MOVE PI-LAST-CARR           TO CLMCARRO.
 11375     MOVE PI-LAST-CLAIM          TO CLMNOO.
 11376
 11377     IF PI-PRT-OPT = 'N' OR 'L'
 11378         MOVE PI-PRT-OPT         TO PRTOPTO
 11379         MOVE 1                  TO PRTOPTL
 11380     END-IF.
 11381
 11382     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 11383         MOVE PI-ALT-PRT         TO ALTPRTO
 11384         MOVE 4                  TO ALTPRTL
 11385     END-IF.
 11386
 11387     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 11388     MOVE AL-SANON               TO CERTNOA SUFXA.
 11389
 11390     MOVE SPACES                 TO PI-INCURR-SW.
 11391
 11392     IF PRTOPTL GREATER ZERO
 11393         IF PRTOPTI = 'L'
 11394             GO TO 0400-CREATE-ELACTQ
 11395         ELSE
 11396             GO TO 0480-PRINT-NOW
 11397         END-IF
 11398     END-IF.
 11399
 11400     GO TO 8100-SEND-INITIAL-MAP.
 11401
 11402 5050-CERT-NOT-FOUND.
 11403
 11404     MOVE ER-0244                TO EMI-ERROR.
 11405     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11406     MOVE -1                     TO CERTNOL.
 11407     GO TO 8200-SEND-DATAONLY.
 11408
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 218
* EL130.cbl
 11410 5500-BUILD-FORM-TRAILER.
 11411*************************************************************
 11412*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11413*************************************************************
 11414
 11415     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 11416
 11417     IF  WS-BEN-ALPHA-2 = '30'
 11418         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 11419         MOVE '6'                TO DC-OPTION-CODE
 11420         IF CL-CARRIER = 'C'
 11421             MOVE +14            TO DC-ELAPSED-DAYS
 11422             MOVE +0             TO DC-ELAPSED-MONTHS
 11423             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11424             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 11425         ELSE
 11426             MOVE +21            TO DC-ELAPSED-DAYS
 11427             MOVE +0             TO DC-ELAPSED-MONTHS
 11428             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11429             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 11430         END-IF
 11431     END-IF.
 11432
 11433
 11434
 11435* EXEC CICS GETMAIN
 11436*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11437*         LENGTH   (ELTRLR-LENGTH)
 11438*         INITIMG  (GETMAIN-SPACE)
 11439*    END-EXEC.
 11440*    MOVE ',"IL                  $   #00010544' TO DFHEIV0
 11441     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11442     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11443     MOVE X'2020233030303130353434' TO DFHEIV0(25:11)
 11444     CALL 'kxdfhei1' USING DFHEIV0,
 11445           DFHEIV20,
 11446           ELTRLR-LENGTH,
 11447           GETMAIN-SPACE
 11448     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11449         DFHEIV20
 11450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11451
 11452
 11453     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 11454     MOVE 'AT'                   TO AT-RECORD-ID.
 11455
 11456     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 11457     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11458     MOVE 'A'                    TO AT-TRAILER-TYPE.
 11459     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 11460                                    AT-FORM-LAST-MAINT-DT.
 11461     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11462                                    AT-FORM-LAST-UPDATED-BY.
 11463     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11464     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 11465     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 11466                                    AT-FORM-RE-SEND-DT
 11467                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 219
* EL130.cbl
 11468                                    AT-EMP-FORM-ANSWERED-DT
 11469                                    AT-PHY-FORM-ANSWERED-DT
 11470                                    AT-EMP-FORM-SEND-ON-DT
 11471                                    AT-FORM-PRINTED-DT
 11472                                    AT-FORM-REPRINT-DT.
 11473     MOVE '1'                    TO AT-FORM-TYPE.
 11474
 11475     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 11476                                    AT-INSTRUCT-LN-2
 11477                                    AT-INSTRUCT-LN-3.
 11478
 11479     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 11480     MOVE 'I'                    TO AT-FORM-ADDRESS.
 11481
 11482     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 11483
 11484     IF AM-EMPLOYER-STMT-USED = 'Y'
 11485        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 11486     END-IF.
 11487
 11488
 11489
 11490* EXEC CICS WRITE
 11491*         DATASET  (ELTRLR-DSID)
 11492*         FROM     (ACTIVITY-TRAILERS)
 11493*         RIDFLD   (AT-CONTROL-PRIMARY)
 11494*    END-EXEC.
 11495     MOVE LENGTH OF
 11496      ACTIVITY-TRAILERS
 11497       TO DFHEIV11
 11498*    MOVE '&$ L                  ''   #00010586' TO DFHEIV0
 11499     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11500     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11501     MOVE X'2020233030303130353836' TO DFHEIV0(25:11)
 11502     CALL 'kxdfhei1' USING DFHEIV0,
 11503           ELTRLR-DSID,
 11504           ACTIVITY-TRAILERS,
 11505           DFHEIV11,
 11506           AT-CONTROL-PRIMARY,
 11507           DFHEIV99,
 11508           DFHEIV99
 11509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11510
 11511
 11512 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 220
* EL130.cbl
 11514*************************************************************
 11515*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11516*************************************************************
 11517
 11518 5700-BUILD-ARCHIVE-HEADER.
 11519
 11520     MOVE '1'                    TO CNTL-REC-TYPE.
 11521     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11522     MOVE SPACES                 TO CNTL-ACCESS.
 11523
 11524
 11525
 11526* EXEC CICS READ
 11527*         DATASET  (ELCNTL-DSID)
 11528*         SET      (ADDRESS OF CONTROL-FILE)
 11529*         RIDFLD   (ELCNTL-KEY)
 11530*         UPDATE
 11531*    END-EXEC.
 11532*    MOVE '&"S        EU         (   #00010605' TO DFHEIV0
 11533     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11534     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11535     MOVE X'2020233030303130363035' TO DFHEIV0(25:11)
 11536     CALL 'kxdfhei1' USING DFHEIV0,
 11537           ELCNTL-DSID,
 11538           DFHEIV20,
 11539           DFHEIV99,
 11540           ELCNTL-KEY,
 11541           DFHEIV99,
 11542           DFHEIV99,
 11543           DFHEIV99
 11544     SET ADDRESS OF CONTROL-FILE TO
 11545         DFHEIV20
 11546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11547
 11548
 11549     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 11550
 11551     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 11552
 11553
 11554
 11555* EXEC CICS REWRITE
 11556*         FROM     (CONTROL-FILE)
 11557*         DATASET  (ELCNTL-DSID)
 11558*    END-EXEC.
 11559     MOVE LENGTH OF
 11560      CONTROL-FILE
 11561       TO DFHEIV11
 11562*    MOVE '&& L                  %   #00010617' TO DFHEIV0
 11563     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11564     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11565     MOVE X'2020233030303130363137' TO DFHEIV0(25:11)
 11566     CALL 'kxdfhei1' USING DFHEIV0,
 11567           ELCNTL-DSID,
 11568           CONTROL-FILE,
 11569           DFHEIV11,
 11570           DFHEIV99
 11571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 221
* EL130.cbl
 11572
 11573
 11574
 11575
 11576* EXEC CICS HANDLE CONDITION
 11577*         NOTOPEN  (9990-ABEND)
 11578*         DUPKEY   (5799-EXIT)
 11579*    END-EXEC.
 11580*    MOVE '"$J$                  ! > #00010623' TO DFHEIV0
 11581     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 11582     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11583     MOVE X'3E20233030303130363233' TO DFHEIV0(25:11)
 11584     CALL 'kxdfhei1' USING DFHEIV0
 11585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11586
 11587
 11588
 11589
 11590* EXEC CICS GETMAIN
 11591*         SET     (ADDRESS OF LETTER-ARCHIVE)
 11592*         LENGTH  (ELARCH-LENGTH)
 11593*    END-EXEC.
 11594*    MOVE '," L                  $   #00010629' TO DFHEIV0
 11595     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11596     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11597     MOVE X'2020233030303130363239' TO DFHEIV0(25:11)
 11598     CALL 'kxdfhei1' USING DFHEIV0,
 11599           DFHEIV20,
 11600           ELARCH-LENGTH,
 11601           DFHEIV99
 11602     SET ADDRESS OF LETTER-ARCHIVE TO
 11603         DFHEIV20
 11604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11605
 11606
 11607     MOVE SPACES                 TO LETTER-ARCHIVE.
 11608     MOVE 'LA'                   TO LA-RECORD-ID.
 11609     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 11610                                    LA-ARCHIVE-NO-A1.
 11611     MOVE '4'                    TO LA-RECORD-TYPE
 11612                                    LA-RECORD-TYPE-A1.
 11613     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 11614                                    LA-LINE-SEQ-NO-A1.
 11615     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 11616                                    LA-COMPANY-CD-A1.
 11617     MOVE CL-CARRIER             TO LA4-CARRIER.
 11618     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 11619     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 11620     MOVE CL-CERT-STATE          TO LA4-STATE.
 11621     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 11622     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 11623     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 11624     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 11625                                    LA4-RESEND-PRINT-DATE
 11626                                    LA4-FORM-REM-PRINT-DT
 11627                                    LA4-RESEND-DATE.
 11628     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 11629     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 222
* EL130.cbl
 11630
 11631
 11632
 11633* EXEC CICS WRITE
 11634*         DATASET  (ELARCH-DSID)
 11635*         FROM     (LETTER-ARCHIVE)
 11636*         RIDFLD   (LA-CONTROL-PRIMARY)
 11637*    END-EXEC.
 11638     MOVE LENGTH OF
 11639      LETTER-ARCHIVE
 11640       TO DFHEIV11
 11641*    MOVE '&$ L                  ''   #00010659' TO DFHEIV0
 11642     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11643     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11644     MOVE X'2020233030303130363539' TO DFHEIV0(25:11)
 11645     CALL 'kxdfhei1' USING DFHEIV0,
 11646           ELARCH-DSID,
 11647           LETTER-ARCHIVE,
 11648           DFHEIV11,
 11649           LA-CONTROL-PRIMARY,
 11650           DFHEIV99,
 11651           DFHEIV99
 11652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11653
 11654
 11655 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 223
* EL130.cbl
 11657 6000-EDIT-CLAIM-DATA.
 11658
 11659     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 11660     MOVE '2'                    TO DC-OPTION-CODE.
 11661     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11662     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 11663
 11664     IF CLMNOL GREATER ZERO
 11665         IF CLMNOI = SPACES OR LOW-VALUES
 11666             MOVE -1             TO CLMNOL
 11667             MOVE AL-UABON       TO CLMNOA
 11668             MOVE ER-7688        TO EMI-ERROR
 11669             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11670         ELSE
 11671             MOVE AL-UANON       TO CLMNOA
 11672         END-IF
 11673     END-IF.
 11674
 11675     IF CERTNOL = ZERO
 11676         MOVE -1                 TO CERTNOL
 11677         MOVE AL-SABON           TO CERTNOA
 11678         MOVE ER-0203            TO EMI-ERROR
 11679         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11680     ELSE
 11681         MOVE AL-SANON           TO CERTNOA
 11682     END-IF.
 11683
 11684     IF SUFXL = ZERO
 11685         MOVE SPACES             TO SUFXI
 11686         MOVE AL-SANON           TO SUFXA
 11687     ELSE
 11688         MOVE AL-SANON           TO SUFXA
 11689     END-IF.
 11690
 11691     IF CLMCARRL = ZERO
 11692         MOVE -1                 TO CLMCARRL
 11693         MOVE ER-0194            TO EMI-ERROR
 11694         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11695     ELSE
 11696         MOVE CLMCARRI           TO PI-CARRIER
 11697         IF PI-NO-CARRIER-SECURITY
 11698             MOVE AL-UANON       TO CLMCARRA
 11699         END-IF
 11700     END-IF.
 11701
 11702     IF CLMTYPEL > ZERO
 11703        IF ((PI-COMPANY-ID = 'DCC')
 11704           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11705              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G'))
 11706                        OR
 11707           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 11708           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11709              AND PI-AH-OVERRIDE-L1))
 11710              MOVE -1             TO CLMTYPEL
 11711              MOVE AL-UABON       TO CLMTYPEA
 11712              MOVE ER-7634        TO EMI-ERROR
 11713              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11714        ELSE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 224
* EL130.cbl
 11715           MOVE AL-UANON       TO CLMTYPEA
 11716        END-IF
 11717     ELSE
 11718        IF MAINTI = 'A'
 11719           MOVE -1             TO CLMTYPEL
 11720           MOVE AL-UABON       TO CLMTYPEA
 11721           MOVE ER-0546        TO EMI-ERROR
 11722           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11723        END-IF
 11724     END-IF
 11725
 11726     IF PCERTNOL = ZERO
 11727        MOVE CERTNOI             TO PCERTNOI
 11728        MOVE CERTNOL             TO PCERTNOL
 11729        MOVE AL-UANON            TO PCERTNOA
 11730     ELSE
 11731        MOVE AL-UANON            TO PCERTNOA
 11732     END-IF.
 11733
 11734     IF PSUFXL = ZERO
 11735        MOVE SUFXI               TO PSUFXI
 11736        MOVE SUFXL               TO PSUFXL
 11737        MOVE AL-UANON            TO PSUFXA
 11738     ELSE
 11739        MOVE AL-UANON            TO PSUFXA
 11740     END-IF.
 11741
 11742     IF MAINTI = 'I'
 11743         GO TO 6020-EDIT
 11744     END-IF.
 11745
 11746     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 11747         MOVE -1                 TO LSTNMEL
 11748         MOVE ER-0236            TO EMI-ERROR
 11749         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11750     ELSE
 11751         MOVE AL-UANON           TO LSTNMEA
 11752     END-IF.
 11753     IF SEXL > ZEROS
 11754        IF SEXI = 'M' OR 'F'
 11755           CONTINUE
 11756        ELSE
 11757           MOVE -1               TO SEXL
 11758           MOVE AL-UABON         TO SEXA
 11759           MOVE ER-0219          TO EMI-ERROR
 11760           PERFORM 9900-ERROR-FORMAT
 11761                                 THRU 9900-EXIT
 11762        END-IF
 11763     ELSE
 11764        IF MAINTI = 'A'
 11765           MOVE -1               TO SEXL
 11766           MOVE AL-UABON         TO SEXA
 11767           MOVE ER-0219          TO EMI-ERROR
 11768           PERFORM 9900-ERROR-FORMAT
 11769                                 THRU 9900-EXIT
 11770        END-IF
 11771     END-IF
 11772*    IF SEXI NOT = 'M' AND 'F'
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 225
* EL130.cbl
 11773*        MOVE -1                 TO SEXL
 11774*        MOVE AL-UABON           TO SEXA
 11775*        MOVE ER-0219            TO EMI-ERROR
 11776*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11777*    ELSE
 11778*        MOVE AL-UANON           TO SEXA
 11779*    END-IF.
 11780
 11781     IF SSNL GREATER THAN ZERO
 11782         MOVE SSNI TO WS-SOC-SEC-NUMBER
 11783         IF WS-SOC-SEC-NO NUMERIC AND
 11784           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 11785             NEXT SENTENCE
 11786         ELSE
 11787            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 11788               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 11789               WS-SSN-DASH2 = '-'
 11790                 NEXT SENTENCE
 11791            ELSE
 11792                 MOVE ER-0887        TO  EMI-ERROR
 11793                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11794                 MOVE AL-UABON       TO  SSNA
 11795                 MOVE -1             TO  SSNL
 11796            END-IF
 11797        END-IF
 11798     END-IF.
 11799
 11800     IF BIRTHDTL = ZERO
 11801         GO TO 6020-EDIT
 11802     END-IF.
 11803
 11804     IF BIRTHDTL GREATER ZERO
 11805         MOVE BIRTHDTI           TO DATE-WORK
 11806         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11807         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11808         MOVE '4'                TO DC-OPTION-CODE
 11809         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11810         IF DATE-CONVERSION-ERROR
 11811             MOVE AL-UABON       TO BIRTHDTA
 11812             MOVE -1             TO BIRTHDTL
 11813             MOVE ER-0220        TO EMI-ERROR
 11814             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11815             GO TO 6020-EDIT
 11816         END-IF
 11817     END-IF.
 11818
 11819******************************************************************
 11820**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 11821**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 11822**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 11823******************************************************************
 11824
 11825     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 11826         MOVE BIRTHDTI           TO  DATE-WORK
 11827         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11828         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 11829         MOVE '4'                TO  DC-OPTION-CODE
 11830         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 226
* EL130.cbl
 11831         MOVE +0                 TO  DC-ELAPSED-MONTHS
 11832                                     DC-ELAPSED-DAYS
 11833         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11834         IF DATE-CONVERSION-ERROR
 11835             MOVE AL-UABON       TO  BIRTHDTA
 11836             MOVE -1             TO  BIRTHDTL
 11837             MOVE ER-0220        TO  EMI-ERROR
 11838             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11839             GO TO 6020-EDIT
 11840         END-IF
 11841     END-IF.
 11842
 11843     MOVE AL-UANON               TO  BIRTHDTA.
 11844     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 11845     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 11846     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 11847
 11848 6020-EDIT.
 11849     IF INCURL GREATER ZERO
 11850         MOVE INCURI             TO DATE-WORK
 11851         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11852         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11853         MOVE '4'                TO DC-OPTION-CODE
 11854         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11855         IF DATE-CONVERSION-ERROR
 11856             MOVE AL-UABON       TO INCURA
 11857             MOVE -1             TO INCURL
 11858             MOVE ER-0222        TO EMI-ERROR
 11859             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11860         ELSE
 11861             MOVE AL-UANON       TO INCURA
 11862             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 11863             MOVE DC-BIN-DATE-1  TO WS-INCUR
 11864                                    PI-SAVE-INCUR-DT
 11865             IF WS-INCUR GREATER THAN WS-TODAY-DT
 11866                 MOVE ER-0511     TO EMI-ERROR
 11867                 MOVE -1          TO INCURL
 11868                 MOVE AL-UABON    TO INCURA
 11869                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11870             ELSE
 11871*                NEXT SENTENCE
 11872                 CONTINUE
 11873             END-IF
 11874         END-IF
 11875     ELSE
 11876         MOVE ER-0516         TO EMI-ERROR
 11877         MOVE AL-UABON        TO INCURA
 11878         MOVE -1              TO INCURL
 11879         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11880     END-IF.
 11881
 11882     IF REPORTL GREATER ZERO
 11883         MOVE REPORTI            TO DATE-WORK
 11884         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11885         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11886         MOVE '4'                TO DC-OPTION-CODE
 11887         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11888         IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 227
* EL130.cbl
 11889             MOVE AL-UABON       TO REPORTA
 11890             MOVE -1             TO REPORTL
 11891             MOVE ER-0223        TO EMI-ERROR
 11892             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11893         ELSE
 11894             MOVE AL-UANON       TO REPORTA
 11895             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 11896             MOVE DC-BIN-DATE-1  TO WS-REPORT
 11897             IF WS-REPORT GREATER THAN WS-TODAY-DT
 11898                 MOVE ER-0512     TO EMI-ERROR
 11899                 MOVE -1          TO REPORTL
 11900                 MOVE AL-UABON    TO REPORTA
 11901                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11902             ELSE
 11903*                NEXT SENTENCE
 11904                 CONTINUE
 11905             END-IF
 11906         END-IF
 11907     ELSE
 11908         MOVE ER-0517         TO EMI-ERROR
 11909         MOVE -1              TO REPORTL
 11910         MOVE AL-UABON        TO REPORTA
 11911         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11912     END-IF.
 11913
 11914     IF WS-REPORT NOT = LOW-VALUES
 11915         IF WS-INCUR GREATER THAN WS-REPORT
 11916             MOVE AL-UABON       TO REPORTA
 11917             MOVE -1             TO REPORTL
 11918             MOVE ER-0509        TO EMI-ERROR
 11919             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11920         END-IF
 11921     END-IF.
 11922
 11923     IF ESTENDL GREATER ZERO
 11924         MOVE ESTENDI            TO DATE-WORK
 11925         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11926         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11927         MOVE '4'                TO DC-OPTION-CODE
 11928         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11929         IF DATE-CONVERSION-ERROR
 11930             MOVE AL-UABON       TO ESTENDA
 11931             MOVE -1             TO ESTENDL
 11932             MOVE ER-0224        TO EMI-ERROR
 11933             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11934         ELSE
 11935             MOVE AL-UANON       TO ESTENDA
 11936             MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 11937             MOVE DC-BIN-DATE-1  TO WS-ESTEND
 11938             IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11939                MOVE AL-UABON    TO ESTENDA
 11940                MOVE -1          TO ESTENDL
 11941                MOVE ER-0544     TO EMI-ERROR
 11942                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11943             END-IF
 11944         END-IF
 11945     END-IF.
 11946
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 228
* EL130.cbl
 11947     IF WS-ESTEND NOT = LOW-VALUES
 11948         IF WS-INCUR GREATER THAN WS-ESTEND
 11949             MOVE AL-UABON       TO ESTENDA
 11950             MOVE -1             TO ESTENDL
 11951             MOVE ER-0510        TO EMI-ERROR
 11952             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11953         END-IF
 11954     END-IF.
 11955
 11956     IF PRTOPTL GREATER ZERO
 11957         IF PRTOPTI NOT = 'N' AND 'L'
 11958             MOVE AL-UABON       TO PRTOPTA
 11959             MOVE -1             TO PRTOPTL
 11960             MOVE ER-0334        TO EMI-ERROR
 11961             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11962         END-IF
 11963     END-IF.
 11964
 11965     IF MANRSVL GREATER ZERO
 11966
 11967* EXEC CICS BIF DEEDIT
 11968*            FIELD   (MANRSVI)
 11969*            LENGTH  (9)
 11970*        END-EXEC
 11971     MOVE 9
 11972       TO DFHEIV11
 11973*    MOVE '@"L                   #   #00010976' TO DFHEIV0
 11974     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 11975     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11976     MOVE X'2020233030303130393736' TO DFHEIV0(25:11)
 11977     CALL 'kxdfhei1' USING DFHEIV0,
 11978           MANRSVI,
 11979           DFHEIV11
 11980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11981         IF MANRSVI NOT NUMERIC
 11982             MOVE AL-UNBON       TO MANRSVA
 11983             MOVE -1             TO MANRSVL
 11984             MOVE ER-0489        TO EMI-ERROR
 11985             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11986         ELSE
 11987             MOVE AL-UNNON       TO MANRSVA
 11988             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 11989         END-IF
 11990     END-IF.
 11991
 11992     MOVE SPACES                 TO ELCNTL-KEY.
 11993
 11994     IF CONTROL-IS-ACTUAL-CARRIER
 11995         MOVE PI-CARRIER         TO CNTL-CARRIER
 11996     ELSE
 11997         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 11998     END-IF.
 11999
 12000     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12001     MOVE '6'                    TO CNTL-REC-TYPE.
 12002     MOVE +0                     TO CNTL-SEQ-NO.
 12003
 12004
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 229
* EL130.cbl
 12005
 12006* EXEC CICS HANDLE CONDITION
 12007*        NOTFND   (3100-CARRIER-NOT-FOUND)
 12008*    END-EXEC.
 12009*    MOVE '"$I                   ! ? #00011004' TO DFHEIV0
 12010     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12012     MOVE X'3F20233030303131303034' TO DFHEIV0(25:11)
 12013     CALL 'kxdfhei1' USING DFHEIV0
 12014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12015
 12016
 12017     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12018
 12019     IF NOT CF-MANUAL-RESERVES-USED AND
 12020           WS-MANRSV GREATER ZERO
 12021         MOVE ER-0518             TO EMI-ERROR
 12022         MOVE -1                  TO MANRSVL
 12023         MOVE AL-UNBON            TO MANRSVA
 12024         MOVE ZEROS               TO WS-MANRSV
 12025         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12026     END-IF.
 12027
 12028     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 12029     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
 12030
 12031     IF SUPVL GREATER ZERO
 12032         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 12033             MOVE -1             TO SUPVL
 12034             MOVE AL-UABON       TO SUPVA
 12035             MOVE ER-0230        TO EMI-ERROR
 12036             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12037         ELSE
 12038             MOVE AL-UANON       TO SUPVA
 12039         END-IF
 12040     END-IF.
 12041
 12042     IF PROCCDL = ZERO
 12043        GO TO 6050-CONTINUE-EDITS
 12044     END-IF.
 12045
 12046     MOVE SPACES                 TO ELCNTL-KEY.
 12047     MOVE PROCCDI                TO CNTL-ACCESS.
 12048
 12049     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12050     MOVE '2'                    TO CNTL-REC-TYPE.
 12051     MOVE +0                     TO CNTL-SEQ-NO.
 12052
 12053
 12054
 12055* EXEC CICS HANDLE CONDITION
 12056*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 12057*    END-EXEC.
 12058*    MOVE '"$I                   ! @ #00011045' TO DFHEIV0
 12059     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12060     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12061     MOVE X'4020233030303131303435' TO DFHEIV0(25:11)
 12062     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 230
* EL130.cbl
 12063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12064
 12065
 12066     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12067
 12068     GO TO 6050-CONTINUE-EDITS.
 12069
 12070 6040-NO-PROCESSOR-RECORD.
 12071     MOVE ER-0019                TO EMI-ERROR.
 12072     MOVE -1                     TO PROCCDL.
 12073     MOVE AL-UABON               TO PROCCDA.
 12074     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12075
 12076 6050-CONTINUE-EDITS.
 12077     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 12078           GO TO 6070-CONTINUE-EDITS
 12079     END-IF.
 12080
 12081     MOVE BENECDI                TO BENE-CODE.
 12082     MOVE 'B'                    TO BENE-RCD-TYPE.
 12083     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 12084
 12085
 12086
 12087* EXEC CICS HANDLE CONDITION
 12088*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 12089*    END-EXEC.
 12090*    MOVE '"$I                   ! A #00011069' TO DFHEIV0
 12091     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12092     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12093     MOVE X'4120233030303131303639' TO DFHEIV0(25:11)
 12094     CALL 'kxdfhei1' USING DFHEIV0
 12095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12096
 12097
 12098
 12099* EXEC CICS READ
 12100*         DATASET   (ELBENE-DSID)
 12101*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 12102*         RIDFLD    (ELBENE-KEY)
 12103*    END-EXEC.
 12104*    MOVE '&"S        E          (   #00011073' TO DFHEIV0
 12105     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12107     MOVE X'2020233030303131303733' TO DFHEIV0(25:11)
 12108     CALL 'kxdfhei1' USING DFHEIV0,
 12109           ELBENE-DSID,
 12110           DFHEIV20,
 12111           DFHEIV99,
 12112           ELBENE-KEY,
 12113           DFHEIV99,
 12114           DFHEIV99,
 12115           DFHEIV99
 12116     SET ADDRESS OF BENEFICIARY-MASTER TO
 12117         DFHEIV20
 12118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12119
 12120
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 231
* EL130.cbl
 12121     GO TO 6070-CONTINUE-EDITS.
 12122
 12123 6060-NO-BENEFICIARY-RECORD.
 12124     MOVE ER-0565                TO EMI-ERROR.
 12125     MOVE -1                     TO BENECDL.
 12126     MOVE AL-UABON               TO BENECDA.
 12127     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12128
 12129
 12130 6070-CONTINUE-EDITS.
 12131     IF CERTMTL GREATER ZERO
 12132         IF CERTMTI NOT = 'A' AND 'S'
 12133             MOVE -1             TO CERTMTL
 12134             MOVE AL-UABON       TO CERTMTA
 12135             MOVE ER-0267        TO EMI-ERROR
 12136             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12137         ELSE
 12138             MOVE AL-UANON       TO CERTMTA
 12139         END-IF
 12140     ELSE
 12141         GO TO 6000-EXIT
 12142     END-IF.
 12143
 12144     IF EFFDTL GREATER ZERO
 12145         MOVE EFFDTI             TO DATE-WORK
 12146         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12147         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12148         MOVE '4'                TO DC-OPTION-CODE
 12149         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12150         IF DATE-CONVERSION-ERROR
 12151             MOVE AL-UABON       TO EFFDTA
 12152             MOVE -1             TO EFFDTL
 12153             MOVE ER-0231        TO EMI-ERROR
 12154             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12155         ELSE
 12156             MOVE AL-UANON       TO EFFDTA
 12157             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 12158             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 12159         END-IF
 12160     ELSE
 12161         MOVE ER-0231            TO EMI-ERROR
 12162         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12163         MOVE -1                 TO EFFDTL
 12164         MOVE AL-UABON           TO EFFDTA
 12165     END-IF.
 12166
 12167     IF ACCOUNTL = ZERO
 12168         MOVE ER-0232            TO EMI-ERROR
 12169         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12170         MOVE AL-UABON           TO ACCOUNTA
 12171         MOVE -1                 TO ACCOUNTL
 12172     ELSE
 12173         MOVE AL-UANON           TO ACCOUNTA
 12174     END-IF.
 12175
 12176     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 12177        (STATEL = ZERO)
 12178         MOVE ER-0233        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 232
* EL130.cbl
 12179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12180         MOVE AL-UABON       TO STATEA
 12181         MOVE -1             TO STATEL
 12182     ELSE
 12183         MOVE AL-UANON       TO STATEA
 12184     END-IF.
 12185
 12186     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 12187        (CRTCARRL = ZERO)
 12188         MOVE ER-0234        TO EMI-ERROR
 12189         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12190         MOVE AL-UABON       TO CRTCARRA
 12191         MOVE -1             TO CRTCARRL
 12192     ELSE
 12193         MOVE AL-UANON       TO CRTCARRA
 12194     END-IF.
 12195
 12196     IF PI-CERT-ACCESS-CONTROL = '1' AND
 12197        GROUPL = ZERO
 12198         MOVE ER-0235            TO EMI-ERROR
 12199         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12200         MOVE AL-UABON           TO GROUPA
 12201         MOVE -1                 TO GROUPL
 12202     ELSE
 12203         MOVE AL-UANON           TO GROUPA
 12204     END-IF.
 12205
 12206     IF CRTLNMEL = ZERO
 12207         IF LSTNMEI = SPACES OR LOW-VALUES
 12208             MOVE ER-0236            TO  EMI-ERROR
 12209             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12210             MOVE AL-UABON           TO  CRTLNMEA
 12211             MOVE -1                 TO  CRTLNMEL
 12212         ELSE
 12213             MOVE LSTNMEI            TO  CRTLNMEI
 12214             MOVE AL-UANON           TO  CRTLNMEA
 12215         END-IF
 12216     ELSE
 12217         MOVE AL-UANON               TO  CRTLNMEA
 12218     END-IF.
 12219
 12220     IF CRTFNMEL = ZERO
 12221         IF FSTNMEI = SPACES OR LOW-VALUES
 12222*            NEXT SENTENCE
 12223             CONTINUE
 12224         ELSE
 12225             MOVE FSTNMEI            TO  CRTFNMEI
 12226             MOVE AL-UANON           TO  CRTFNMEA
 12227         END-IF
 12228     END-IF.
 12229
 12230     IF CRTINITL = ZERO
 12231         IF INITI = SPACES OR LOW-VALUES
 12232*            NEXT SENTENCE
 12233             CONTINUE
 12234         ELSE
 12235             MOVE INITI              TO  CRTINITI
 12236             MOVE AL-UANON           TO  CRTINITA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 233
* EL130.cbl
 12237         END-IF
 12238     END-IF.
 12239
 12240 6000-EXIT.
 12241     EXIT.
 12242
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 234
* EL130.cbl
 12244 6200-EDIT-CERT-DATA.
 12245     IF ISSAGEL GREATER ZERO
 12246         IF ISSAGEI NOT NUMERIC
 12247             MOVE ER-0237        TO EMI-ERROR
 12248             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12249             MOVE -1             TO ISSAGEL
 12250             MOVE AL-UNBON       TO ISSAGEA
 12251         ELSE
 12252             MOVE AL-UNNON       TO ISSAGEA
 12253         END-IF
 12254     END-IF.
 12255
 12256     IF JNTAGEL GREATER ZERO
 12257         IF JNTAGEI NOT NUMERIC
 12258             MOVE ER-0238        TO EMI-ERROR
 12259             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12260             MOVE -1             TO JNTAGEL
 12261             MOVE AL-UNBON       TO JNTAGEA
 12262         ELSE
 12263             MOVE AL-UNNON       TO JNTAGEA
 12264         END-IF
 12265     END-IF.
 12266
 12267     IF LCVCDL GREATER ZERO
 12268         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 12269         IF INVALID-BENEFIT-CODE
 12270             MOVE ER-7635        TO EMI-ERROR
 12271             MOVE -1             TO LCVCDL
 12272             MOVE AL-UABON       TO LCVCDA
 12273             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12274         ELSE
 12275             MOVE LCVCDI         TO WS-BEN-HOLD
 12276             MOVE '4'            TO WS-REC-TYPE
 12277             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12278             IF WS-BEN-ALPHA-HOLD = SPACES
 12279                MOVE ER-7635     TO EMI-ERROR
 12280                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12281                MOVE -1          TO LCVCDL
 12282                MOVE AL-UABON    TO LCVCDA
 12283             ELSE
 12284                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 12285                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 12286                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 12287                MOVE AL-UANON           TO LCVCDA
 12288             END-IF
 12289         END-IF
 12290     END-IF.
 12291
 12292     IF ACVCDL GREATER ZERO
 12293         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 12294         IF INVALID-BENEFIT-CODE
 12295             MOVE ER-7635        TO EMI-ERROR
 12296             MOVE -1             TO ACVCDL
 12297             MOVE AL-UABON       TO ACVCDA
 12298             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12299         ELSE
 12300             MOVE ACVCDI         TO WS-BEN-HOLD
 12301             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 235
* EL130.cbl
 12302             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12303             IF WS-BEN-ALPHA-HOLD = SPACES
 12304                MOVE ER-7635     TO EMI-ERROR
 12305                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12306                MOVE -1          TO ACVCDL
 12307                MOVE AL-UABON    TO ACVCDA
 12308             ELSE
 12309                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 12310                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 12311                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 12312                MOVE AL-UANON           TO ACVCDA
 12313             END-IF
 12314         END-IF
 12315     END-IF.
 12316
 12317     IF LCVOTRML GREATER ZERO
 12318         IF LCVOTRMI NOT NUMERIC
 12319             MOVE ER-7636        TO EMI-ERROR
 12320             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12321             MOVE -1             TO LCVOTRML
 12322             MOVE AL-UNBON       TO LCVOTRMA
 12323         ELSE
 12324             MOVE AL-UNNON       TO LCVOTRMA
 12325         END-IF
 12326     END-IF.
 12327
 12328     IF ACVOTRML GREATER ZERO
 12329         IF ACVOTRMI NOT NUMERIC
 12330             MOVE ER-7636        TO EMI-ERROR
 12331             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12332             MOVE -1             TO ACVOTRML
 12333             MOVE AL-UNBON       TO ACVOTRMA
 12334         ELSE
 12335             MOVE AL-UNNON       TO ACVOTRMA
 12336         END-IF
 12337     END-IF.
 12338
 12339     IF LCVRATEL GREATER ZERO
 12340
 12341* EXEC CICS BIF DEEDIT
 12342*            FIELD    (LCVRATEI)
 12343*            LENGTH   (06)
 12344*        END-EXEC
 12345     MOVE 06
 12346       TO DFHEIV11
 12347*    MOVE '@"L                   #   #00011298' TO DFHEIV0
 12348     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12349     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12350     MOVE X'2020233030303131323938' TO DFHEIV0(25:11)
 12351     CALL 'kxdfhei1' USING DFHEIV0,
 12352           LCVRATEI,
 12353           DFHEIV11
 12354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12355         IF LCVRATEI NOT NUMERIC
 12356             MOVE AL-UNBON       TO LCVRATEA
 12357             MOVE -1             TO LCVRATEL
 12358             MOVE ER-2280        TO EMI-ERROR
 12359             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 236
* EL130.cbl
 12360         ELSE
 12361             MOVE AL-UNNON       TO LCVRATEA
 12362             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 12363         END-IF
 12364     END-IF.
 12365
 12366     IF ACVRATEL GREATER ZERO
 12367
 12368* EXEC CICS BIF DEEDIT
 12369*            FIELD    (ACVRATEI)
 12370*            LENGTH   (06)
 12371*        END-EXEC
 12372     MOVE 06
 12373       TO DFHEIV11
 12374*    MOVE '@"L                   #   #00011314' TO DFHEIV0
 12375     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12376     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12377     MOVE X'2020233030303131333134' TO DFHEIV0(25:11)
 12378     CALL 'kxdfhei1' USING DFHEIV0,
 12379           ACVRATEI,
 12380           DFHEIV11
 12381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12382         IF ACVRATEI NOT NUMERIC
 12383             MOVE AL-UNBON       TO ACVRATEA
 12384             MOVE -1             TO ACVRATEL
 12385             MOVE ER-2280        TO EMI-ERROR
 12386             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12387         ELSE
 12388             MOVE AL-UNNON       TO ACVRATEA
 12389             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 12390         END-IF
 12391     END-IF.
 12392
 12393     IF LCVBENEL GREATER ZERO
 12394
 12395* EXEC CICS BIF DEEDIT
 12396*            FIELD    (LCVBENEI)
 12397*            LENGTH   (11)
 12398*        END-EXEC
 12399     MOVE 11
 12400       TO DFHEIV11
 12401*    MOVE '@"L                   #   #00011330' TO DFHEIV0
 12402     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12403     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12404     MOVE X'2020233030303131333330' TO DFHEIV0(25:11)
 12405     CALL 'kxdfhei1' USING DFHEIV0,
 12406           LCVBENEI,
 12407           DFHEIV11
 12408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12409         IF LCVBENEI NOT NUMERIC
 12410             MOVE AL-UNBON       TO LCVBENEA
 12411             MOVE -1             TO LCVBENEL
 12412             MOVE ER-7637        TO EMI-ERROR
 12413             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12414         ELSE
 12415             MOVE AL-UNNON       TO LCVBENEA
 12416             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 12417         END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 237
* EL130.cbl
 12418     END-IF.
 12419
 12420     IF ACVBENEL GREATER ZERO
 12421
 12422* EXEC CICS BIF DEEDIT
 12423*            FIELD    (ACVBENEI)
 12424*            LENGTH   (11)
 12425*        END-EXEC
 12426     MOVE 11
 12427       TO DFHEIV11
 12428*    MOVE '@"L                   #   #00011346' TO DFHEIV0
 12429     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12430     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12431     MOVE X'2020233030303131333436' TO DFHEIV0(25:11)
 12432     CALL 'kxdfhei1' USING DFHEIV0,
 12433           ACVBENEI,
 12434           DFHEIV11
 12435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12436         IF ACVBENEI NOT NUMERIC
 12437             MOVE AL-UNBON       TO ACVBENEA
 12438             MOVE -1             TO ACVBENEL
 12439             MOVE ER-7637        TO EMI-ERROR
 12440             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12441         ELSE
 12442             MOVE AL-UNNON       TO ACVBENEA
 12443             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 12444         END-IF
 12445     END-IF.
 12446
 12447     IF LCVCNDTL GREATER ZERO
 12448         IF LCVCNDTI NOT = SPACES
 12449             MOVE LCVCNDTI        TO DATE-WORK
 12450             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12451             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12452             MOVE '4'             TO DC-OPTION-CODE
 12453             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12454             IF DATE-CONVERSION-ERROR
 12455                 MOVE AL-UABON    TO LCVCNDTA
 12456                 MOVE -1          TO LCVCNDTL
 12457                 MOVE ER-7638     TO EMI-ERROR
 12458                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12459             ELSE
 12460                 MOVE AL-UANON    TO LCVCNDTA
 12461                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 12462                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 12463             END-IF
 12464         END-IF
 12465     END-IF.
 12466
 12467     IF ACVCNDTL GREATER ZERO
 12468         IF ACVCNDTI NOT = SPACES
 12469             MOVE ACVCNDTI        TO DATE-WORK
 12470             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12471             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12472             MOVE '4'             TO DC-OPTION-CODE
 12473             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12474             IF DATE-CONVERSION-ERROR
 12475                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 238
* EL130.cbl
 12476                 MOVE -1          TO ACVCNDTL
 12477                 MOVE ER-7638     TO EMI-ERROR
 12478                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12479             ELSE
 12480                 MOVE AL-UANON    TO ACVCNDTA
 12481                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 12482                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 12483             END-IF
 12484         END-IF
 12485     END-IF.
 12486
 12487     IF ADDONDTL GREATER ZERO
 12488         MOVE ADDONDTI        TO DATE-WORK
 12489         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12490         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12491         MOVE '4'             TO DC-OPTION-CODE
 12492         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12493         IF DATE-CONVERSION-ERROR
 12494             MOVE AL-UABON    TO ADDONDTA
 12495             MOVE -1          TO ADDONDTL
 12496             MOVE ER-7651     TO EMI-ERROR
 12497             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12498         ELSE
 12499             MOVE AL-UANON    TO ADDONDTA
 12500             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 12501             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 12502         END-IF
 12503     END-IF.
 12504
 12505     IF APRL GREATER ZERO
 12506
 12507* EXEC CICS BIF DEEDIT
 12508*            FIELD    (APRI)
 12509*            LENGTH   (8)
 12510*        END-EXEC
 12511     MOVE 8
 12512       TO DFHEIV11
 12513*    MOVE '@"L                   #   #00011420' TO DFHEIV0
 12514     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12515     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12516     MOVE X'2020233030303131343230' TO DFHEIV0(25:11)
 12517     CALL 'kxdfhei1' USING DFHEIV0,
 12518           APRI,
 12519           DFHEIV11
 12520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12521         IF APRI NOT NUMERIC
 12522             MOVE AL-UNBON       TO APRA
 12523             MOVE -1             TO APRL
 12524             MOVE ER-0248        TO EMI-ERROR
 12525             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12526         ELSE
 12527             MOVE AL-UNNON       TO APRA
 12528             MOVE APRI           TO WS-APR APRO
 12529         END-IF
 12530     END-IF.
 12531
 12532     IF PMTFREQL GREATER ZERO
 12533
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 239
* EL130.cbl
 12534* EXEC CICS BIF DEEDIT
 12535*            FIELD   (PMTFREQI)
 12536*            LENGTH  (2)
 12537*        END-EXEC
 12538     MOVE 2
 12539       TO DFHEIV11
 12540*    MOVE '@"L                   #   #00011436' TO DFHEIV0
 12541     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12542     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12543     MOVE X'2020233030303131343336' TO DFHEIV0(25:11)
 12544     CALL 'kxdfhei1' USING DFHEIV0,
 12545           PMTFREQI,
 12546           DFHEIV11
 12547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12548         IF PMTFREQI NOT NUMERIC
 12549             MOVE -1             TO PMTFREQL
 12550             MOVE AL-UNBON       TO PMTFREQA
 12551             MOVE ER-0258        TO EMI-ERROR
 12552             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12553         ELSE
 12554             MOVE AL-UNNON       TO PMTFREQA
 12555             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 12556         END-IF
 12557     END-IF.
 12558
 12559     IF INDGRPL GREATER ZERO
 12560         IF INDGRPI = 'I' OR 'G'
 12561             MOVE AL-UANON       TO INDGRPA
 12562         ELSE
 12563             MOVE -1 TO INDGRPL
 12564             MOVE AL-UABON       TO INDGRPA
 12565             MOVE ER-0260        TO EMI-ERROR
 12566             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12567         END-IF
 12568     END-IF.
 12569
 12570     IF LOANBALL GREATER ZERO
 12571         MOVE LOANBALI           TO DEEDIT-FIELD
 12572
 12573* EXEC CICS BIF DEEDIT
 12574*            FIELD   (DEEDIT-FIELD)
 12575*            LENGTH  (12)
 12576*        END-EXEC
 12577     MOVE 12
 12578       TO DFHEIV11
 12579*    MOVE '@"L                   #   #00011464' TO DFHEIV0
 12580     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12581     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12582     MOVE X'2020233030303131343634' TO DFHEIV0(25:11)
 12583     CALL 'kxdfhei1' USING DFHEIV0,
 12584           DEEDIT-FIELD,
 12585           DFHEIV11
 12586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12587         IF DEEDIT-FIELD NOT NUMERIC
 12588             MOVE AL-UNBON       TO LOANBALA
 12589             MOVE -1             TO LOANBALL
 12590             MOVE ER-0247        TO EMI-ERROR
 12591             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 240
* EL130.cbl
 12592         ELSE
 12593             MOVE AL-UNNON       TO LOANBALA
 12594             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 12595         END-IF
 12596     END-IF.
 12597
 12598     IF PREMTYPL GREATER ZERO
 12599         IF (PREMTYPI = '1' OR '2' OR '3')
 12600             MOVE AL-UANON       TO PREMTYPA
 12601         ELSE
 12602             MOVE -1             TO PREMTYPL
 12603             MOVE AL-UABON       TO PREMTYPA
 12604             MOVE ER-0227        TO EMI-ERROR
 12605             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12606         END-IF
 12607     END-IF.
 12608
 12609     IF REINCDL GREATER ZERO
 12610         MOVE LOW-VALUES         TO  ERREIN-KEY
 12611         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 12612         MOVE REINCDI            TO  REIN-CODE-1
 12613                                     REIN-CODE-2
 12614                                     REIN-CODE-3
 12615         MOVE 'A'                TO  REIN-TYPE
 12616         PERFORM 7992-READ-REIN THRU 7992-EXIT
 12617         IF REIN-REC-NOT-FOUND
 12618             MOVE ER-0266        TO  EMI-ERROR
 12619             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12620             MOVE -1             TO  REINCDL
 12621             MOVE AL-UABON       TO  REINCDA
 12622         ELSE
 12623             MOVE AL-UANON       TO  REINCDA
 12624         END-IF
 12625     END-IF.
 12626
 12627     IF CERTMTI NOT = 'A'
 12628        GO TO 6200-EXIT
 12629     END-IF.
 12630
 12631     IF PREMTYPI = '1'
 12632         IF LCVCDL GREATER ZERO
 12633             IF WS-LF-SPECIAL-CALC-CD = 'O'
 12634                 MOVE ER-0841        TO  EMI-ERROR
 12635                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12636                 MOVE -1             TO  PREMTYPL
 12637                 MOVE AL-UABON       TO  PREMTYPA
 12638             END-IF
 12639         END-IF
 12640     END-IF.
 12641
 12642     IF PREMTYPI = '1'
 12643         IF ACVCDL GREATER ZERO
 12644             IF WS-AH-SPECIAL-CALC-CD = 'O'
 12645                 MOVE ER-0841        TO  EMI-ERROR
 12646                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12647                 MOVE -1             TO  PREMTYPL
 12648                 MOVE AL-UABON       TO  PREMTYPA
 12649             END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 241
* EL130.cbl
 12650         END-IF
 12651     END-IF.
 12652
 12653     IF PREMTYPI = '2'
 12654         IF LCVCDL GREATER ZERO
 12655             IF (PI-COMPANY-ID = 'HAN') AND
 12656                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 12657                        OR
 12658                 WS-LF-SPECIAL-CALC-CD = 'O'
 12659*                NEXT SENTENCE
 12660                 CONTINUE
 12661             ELSE
 12662                 MOVE ER-0840        TO  EMI-ERROR
 12663                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12664                 MOVE -1             TO  PREMTYPL
 12665                 MOVE AL-UABON       TO  PREMTYPA
 12666             END-IF
 12667         END-IF
 12668     END-IF.
 12669
 12670     IF PREMTYPI = '2'
 12671         IF ACVCDL GREATER ZERO
 12672             IF (PI-COMPANY-ID = 'HAN')  AND
 12673                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 12674                        OR
 12675                 WS-AH-SPECIAL-CALC-CD = 'O'
 12676*                NEXT SENTENCE
 12677                 CONTINUE
 12678             ELSE
 12679                 MOVE ER-0840        TO  EMI-ERROR
 12680                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12681                 MOVE -1             TO  PREMTYPL
 12682                 MOVE AL-UABON       TO  PREMTYPA
 12683             END-IF
 12684         END-IF
 12685     END-IF.
 12686
 12687     IF LCVCDL = ZEROS
 12688        GO TO 6200-EXIT
 12689     END-IF.
 12690
 12691     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 12692         IF PMTFREQI NOT = ZEROS
 12693             MOVE ER-0428        TO EMI-ERROR
 12694             MOVE -1             TO PMTFREQL
 12695             MOVE AL-UNBON       TO PMTFREQA
 12696             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12697             GO TO 6200-CHECK-APR
 12698         END-IF
 12699     END-IF.
 12700
 12701     IF PMTFREQL = ZEROS AND TEX-REG
 12702         MOVE ER-0429            TO EMI-ERROR
 12703         MOVE -1                 TO PMTFREQL
 12704         MOVE AL-UNBON           TO PMTFREQA
 12705         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12706         GO TO 6200-CHECK-APR
 12707     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 242
* EL130.cbl
 12708
 12709     IF LCVOTRMI NOT NUMERIC
 12710         GO TO 6200-CHECK-APR
 12711     END-IF.
 12712
 12713     IF WS-PMTFREQ NOT = ZERO
 12714         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 12715         GIVING DIVIDE-QUOT
 12716         REMAINDER DIVIDE-REM
 12717         IF DIVIDE-REM GREATER ZERO
 12718             MOVE ER-0430            TO EMI-ERROR
 12719             MOVE -1                 TO PMTFREQL
 12720             MOVE AL-UNBON           TO PMTFREQA
 12721             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12722         END-IF
 12723     END-IF.
 12724
 12725 6200-CHECK-APR.
 12726     IF NET-PAY AND APRL = ZEROS
 12727        MOVE ER-0257             TO EMI-ERROR
 12728        MOVE -1                  TO APRL
 12729        MOVE AL-UABON            TO APRA
 12730        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12731     END-IF.
 12732
 12733 6200-EXIT.
 12734     EXIT.
 12735
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 243
* EL130.cbl
 12737 6300-REQUIRED-CERT-EDIT.
 12738
 12739     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12740        GO TO 6300-REQUIRED-AH-EDIT
 12741     END-IF
 12742
 12743     IF LCVCDL = ZERO
 12744        MOVE ER-7639             TO EMI-ERROR
 12745        MOVE -1                  TO LCVCDL
 12746        MOVE AL-UABON            TO LCVCDA
 12747        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12748     END-IF.
 12749
 12750     IF LCVOTRML = ZERO
 12751        MOVE ER-7670             TO EMI-ERROR
 12752        MOVE -1                  TO LCVOTRML
 12753        MOVE AL-UNBON            TO LCVOTRMA
 12754        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12755     END-IF.
 12756
 12757     IF LCVBENEL = ZERO
 12758        MOVE ER-7671             TO EMI-ERROR
 12759        MOVE -1                  TO LCVBENEL
 12760        MOVE AL-UNBON            TO LCVBENEA
 12761        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12762     END-IF.
 12763
 12764     GO TO 6399-EXIT.
 12765
 12766 6300-REQUIRED-AH-EDIT.
 12767
 12768     IF ACVCDL = ZERO
 12769        MOVE ER-7639             TO EMI-ERROR
 12770        MOVE -1                  TO ACVCDL
 12771        MOVE AL-UABON            TO ACVCDA
 12772        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12773     END-IF.
 12774
 12775     IF ACVOTRML = ZERO
 12776         MOVE ER-7670             TO EMI-ERROR
 12777         MOVE -1                  TO ACVOTRML
 12778         MOVE AL-UNBON            TO ACVOTRMA
 12779         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12780     END-IF.
 12781
 12782     IF ACVBENEL = ZERO
 12783        MOVE ER-7671             TO EMI-ERROR
 12784        MOVE -1                  TO ACVBENEL
 12785        MOVE AL-UNBON            TO ACVBENEA
 12786        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12787     END-IF.
 12788
 12789 6399-EXIT.
 12790      EXIT.
 12791
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 244
* EL130.cbl
 12793 6400-TEST-CLAIM-REASONABILITY.
 12794
 12795     IF WS-INCUR = LOW-VALUES
 12796        GO TO 6499-EXIT
 12797     END-IF.
 12798
 12799     IF WS-EFFDT NOT = LOW-VALUES
 12800         IF WS-INCUR LESS WS-EFFDT
 12801             MOVE ER-0458          TO EMI-ERROR
 12802             MOVE -1               TO INCURL
 12803             MOVE AL-UABON         TO INCURA
 12804             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12805         END-IF
 12806     END-IF.
 12807
 12808     IF CERTMTI = 'A'
 12809        GO TO 6460-TEST-NEW-CERT
 12810     END-IF.
 12811
 12812     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12813     MOVE CRTCARRI               TO CERT-CARRIER.
 12814     MOVE GROUPI                 TO CERT-GROUPING.
 12815     MOVE STATEI                 TO CERT-STATE.
 12816     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 12817     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 12818     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 12819
 12820
 12821
 12822* EXEC CICS HANDLE CONDITION
 12823*         DUPKEY   (6499-EXIT)
 12824*         NOTFND   (6499-EXIT)
 12825*    END-EXEC.
 12826*    MOVE '"$$I                  ! B #00011702' TO DFHEIV0
 12827     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 12828     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12829     MOVE X'4220233030303131373032' TO DFHEIV0(25:11)
 12830     CALL 'kxdfhei1' USING DFHEIV0
 12831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12832
 12833
 12834     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 12835
 12836     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 12837        'I' OR 'G')
 12838        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12839     ELSE
 12840        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12841     END-IF.
 12842
 12843     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12844     MOVE '6'                    TO DC-OPTION-CODE.
 12845     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12846
 12847     IF WS-INCUR GREATER THAN DC-BIN-DATE-2
 12848        MOVE ER-0519             TO EMI-ERROR
 12849        MOVE -1                  TO INCURL
 12850        MOVE AL-UABON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 245
* EL130.cbl
 12851        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12852     END-IF.
 12853
 12854     IF CLMCARRI NOT = CRTCARRI
 12855        MOVE ER-0562             TO EMI-ERROR
 12856        MOVE AL-UABON            TO CLMCARRA
 12857        MOVE -1                  TO CLMCARRL
 12858        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12859     END-IF.
 12860
 12861     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12862        CM-AH-BENEFIT-CD = '00')
 12863                  OR
 12864        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12865        CM-LF-BENEFIT-CD = '00')
 12866         MOVE ER-0521         TO EMI-ERROR
 12867         MOVE AL-UABON        TO CLMTYPEA
 12868         MOVE -1              TO CLMTYPEL
 12869         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12870     END-IF.
 12871*    IF CLMTYPEI = 'I' AND
 12872*       CM-AH-CRITICAL-PERIOD = +0
 12873*        MOVE ER-0521         TO EMI-ERROR
 12874*        MOVE AL-UABON        TO CLMTYPEA
 12875*        MOVE -1              TO CLMTYPEL
 12876*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12877*    END-IF
 12878
 12879*    IF PI-COMPANY-ID = 'CRI'
 12880*        IF MAINTI = 'A'
 12881*            IF CERT-PEND-ISSUE-ERROR  OR
 12882*               CERT-PEND-ISSUE-RETURNED
 12883*                MOVE -1                 TO CERTNOL
 12884*                MOVE AL-UABON           TO CERTNOA
 12885*                MOVE ER-7640            TO EMI-ERROR
 12886*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12887*            END-IF
 12888*        END-IF
 12889*    END-IF.
 12890
 12891     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 12892         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 12893         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 12894             GO TO 6450-DATE-ERROR
 12895         END-IF
 12896     END-IF.
 12897
 12898     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 12899         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 12900         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 12901             GO TO 6450-DATE-ERROR
 12902         END-IF
 12903     END-IF.
 12904
 12905     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 12906         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 12907             GO TO 6450-DATE-ERROR
 12908         END-IF
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 246
* EL130.cbl
 12909     END-IF.
 12910
 12911     GO TO 6499-EXIT.
 12912
 12913 6450-DATE-ERROR.
 12914     MOVE ER-0520                TO EMI-ERROR.
 12915     MOVE -1                     TO INCURL.
 12916     MOVE AL-UABON               TO INCURA.
 12917     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12918
 12919*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 12920*       (EMI-SEVERITY-SAVE = 'X')
 12921*        ADD 1                TO EMI-FORCABLE-CTR
 12922*        SUBTRACT 1 FROM EMI-FATAL-CTR
 12923*    END-IF.
 12924
 12925     GO TO 6499-EXIT.
 12926
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 247
* EL130.cbl
 12928 6460-TEST-NEW-CERT.
 12929
 12930     IF NOT EMI-NO-ERRORS
 12931        GO TO 6499-EXIT
 12932     END-IF.
 12933
 12934     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12935
 12936     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12937         ACVOTRML GREATER ZERO)
 12938        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 12939     END-IF.
 12940
 12941     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12942         LCVOTRML GREATER ZERO
 12943        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 12944     END-IF.
 12945
 12946     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 12947
 12948*    IF PI-COMPANY-ID = 'HAN'
 12949*        IF ADDONDTL GREATER ZERO
 12950*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 12951*            IF CLMTYPEI = 'A'
 12952*                IF ACVOTRMI NOT = ZEROS
 12953*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 12954*                ELSE
 12955*                    NEXT SENTENCE
 12956*                    CONTINUE
 12957*                END-IF
 12958*            ELSE
 12959*                IF LCVOTRMI NOT = ZEROS
 12960*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 12961*                END-IF
 12962*            END-IF
 12963*        END-IF
 12964*    END-IF.
 12965
 12966     MOVE '6'                    TO DC-OPTION-CODE.
 12967     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12968
 12969     IF NO-CONVERSION-ERROR
 12970         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 12971     END-IF.
 12972
 12973     IF WS-INCUR GREATER THAN WS-EXPIRE
 12974        MOVE ER-0519             TO EMI-ERROR
 12975        MOVE -1                  TO INCURL
 12976        MOVE AL-UABON            TO INCURA
 12977        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12978     END-IF.
 12979
 12980     IF CLMCARRI NOT = CRTCARRI
 12981        MOVE ER-0562             TO EMI-ERROR
 12982        MOVE AL-UABON            TO CLMCARRA
 12983        MOVE -1                  TO CLMCARRL
 12984        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12985     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 248
* EL130.cbl
 12986
 12987     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12988         ACVCDL = ZEROS)
 12989             MOVE ER-0521        TO EMI-ERROR
 12990             MOVE AL-UABON       TO CLMTYPEA
 12991             MOVE -1             TO CLMTYPEL
 12992             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12993     END-IF.
 12994
 12995     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12996         LCVCDL = ZEROS
 12997             MOVE ER-0521        TO EMI-ERROR
 12998             MOVE AL-UABON       TO CLMTYPEA
 12999             MOVE -1             TO CLMTYPEL
 13000             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13001     END-IF.
 13002
 13003     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13004         IF LCVCNDTL GREATER ZERO
 13005             IF WS-INCUR GREATER THAN WS-LCVCNDT
 13006                 GO TO 6450-DATE-ERROR
 13007             END-IF
 13008         END-IF
 13009     END-IF.
 13010
 13011     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 13012         IF ACVCNDTL GREATER ZERO
 13013             IF WS-INCUR GREATER THAN WS-ACVCNDT
 13014                 GO TO 6450-DATE-ERROR
 13015             END-IF
 13016         END-IF
 13017     END-IF.
 13018
 13019 6499-EXIT.
 13020     EXIT.
 13021
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 249
* EL130.cbl
 13023 6600-CHECK-AUTO-ACTIVITY.
 13024
 13025
 13026* EXEC CICS HANDLE CONDITION
 13027*        NOTFND   (6600-NOT-FOUND)
 13028*    END-EXEC.
 13029*    MOVE '"$I                   ! C #00011898' TO DFHEIV0
 13030     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13031     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13032     MOVE X'4320233030303131383938' TO DFHEIV0(25:11)
 13033     CALL 'kxdfhei1' USING DFHEIV0
 13034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13035
 13036
 13037     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 13038     MOVE 'T'                        TO  CNTL-REC-TYPE.
 13039     MOVE SPACES                     TO  CNTL-ACCESS.
 13040     MOVE +0                         TO  CNTL-SEQ-NO.
 13041
 13042     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13043
 13044     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 13045         MOVE 'N'                    TO  WS-REC-FOUND-SW
 13046                                         WS-LETTER-SW
 13047         GO TO 6600-EXIT
 13048     END-IF.
 13049
 13050     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 13051         MOVE 'N'                     TO  WS-LETTER-SW
 13052     ELSE
 13053         MOVE 'Y'                     TO  WS-LETTER-SW
 13054     END-IF.
 13055
 13056     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 13057     GO TO 6600-EXIT.
 13058
 13059 6600-START-AUTO-LETTER-WRITER.
 13060
 13061     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 13062     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 13063
 13064     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 13065
 13066     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 13067         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 13068         MOVE '6'                     TO  DC-OPTION-CODE
 13069         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 13070         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13071         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13072         IF NO-CONVERSION-ERROR
 13073             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 13074         ELSE
 13075             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 13076         END-IF
 13077     END-IF.
 13078
 13079     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
 13080         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 250
* EL130.cbl
 13081         MOVE '6'                     TO  DC-OPTION-CODE
 13082         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 13083         MOVE +0                      TO  DC-ELAPSED-MONTHS
 13084         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13085         IF NO-CONVERSION-ERROR
 13086             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 13087         ELSE
 13088             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 13089         END-IF
 13090     END-IF.
 13091
 13092
 13093
 13094* EXEC CICS LINK
 13095*        PROGRAM    (LINK-1523)
 13096*        COMMAREA   (W-1523-LINKDATA)
 13097*        LENGTH     (W-1523-COMM-LENGTH)
 13098*    END-EXEC.
 13099*    MOVE '."C                   (   #00011958' TO DFHEIV0
 13100     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13101     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13102     MOVE X'2020233030303131393538' TO DFHEIV0(25:11)
 13103     CALL 'kxdfhei1' USING DFHEIV0,
 13104           LINK-1523,
 13105           W-1523-LINKDATA,
 13106           W-1523-COMM-LENGTH,
 13107           DFHEIV99,
 13108           DFHEIV99,
 13109           DFHEIV99,
 13110           DFHEIV99
 13111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13112
 13113
 13114     GO TO 6600-EXIT.
 13115
 13116 6600-NOT-FOUND.
 13117     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 13118
 13119 6600-EXIT.
 13120     EXIT.
 13121
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 251
* EL130.cbl
 13122/
 13123*************************************************************
 13124*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 13125*************************************************************
 13126
 13127 6700-OUTPUT-ACTIVITY-RECORD.
 13128
 13129
 13130
 13131* EXEC CICS GETMAIN
 13132*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 13133*        LENGTH (DLYACTV-LENGTH)
 13134*        INITIMG (WS-BLANK)
 13135*    END-EXEC.
 13136*    MOVE ',"IL                  $   #00011980' TO DFHEIV0
 13137     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13138     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13139     MOVE X'2020233030303131393830' TO DFHEIV0(25:11)
 13140     CALL 'kxdfhei1' USING DFHEIV0,
 13141           DFHEIV20,
 13142           DLYACTV-LENGTH,
 13143           WS-BLANK
 13144     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 13145         DFHEIV20
 13146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13147
 13148
 13149     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 13150     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 13151     MOVE CLMCARRI               TO DA-CARRIER.
 13152     IF CLMNOL EQUAL ZERO
 13153         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 13154     ELSE
 13155         MOVE CLMNOI             TO DA-CLAIM-NO
 13156     END-IF.
 13157     MOVE CERTNOI                TO DA-CERT-PRIME.
 13158     MOVE SUFXI                  TO DA-CERT-SFX.
 13159     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 13160     MOVE 'A'                    TO DA-RECORD-TYPE.
 13161
 13162
 13163* EXEC CICS HANDLE CONDITION
 13164*        NOTOPEN (6700-NOTOPEN-ERROR)
 13165*        DUPREC (6700-EXIT)
 13166*    END-EXEC.
 13167*    MOVE '"$J%                  ! D #00011999' TO DFHEIV0
 13168     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 13169     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13170     MOVE X'4420233030303131393939' TO DFHEIV0(25:11)
 13171     CALL 'kxdfhei1' USING DFHEIV0
 13172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13173
 13174
 13175
 13176* EXEC CICS WRITE
 13177*        DATASET (DLYACTV-DSID)
 13178*        RIDFLD (DA-KEY)
 13179*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 252
* EL130.cbl
 13180*        LENGTH (DLYACTV-LENGTH)
 13181*    END-EXEC.
 13182*    MOVE '&$ L                  ''   #00012004' TO DFHEIV0
 13183     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13184     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13185     MOVE X'2020233030303132303034' TO DFHEIV0(25:11)
 13186     CALL 'kxdfhei1' USING DFHEIV0,
 13187           DLYACTV-DSID,
 13188           DAILY-ACTIVITY-RECORD,
 13189           DLYACTV-LENGTH,
 13190           DA-KEY,
 13191           DFHEIV99,
 13192           DFHEIV99
 13193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13194
 13195     GO TO 6700-EXIT.
 13196
 13197 6700-NOTOPEN-ERROR.
 13198     MOVE '2955'                 TO EMI-ERROR.
 13199     MOVE -1                     TO MAINTL.
 13200     MOVE AL-UANON               TO MAINTA.
 13201     PERFORM 9900-ERROR-FORMAT THRU
 13202             9900-EXIT.
 13203     GO TO 8200-SEND-DATAONLY.
 13204
 13205 6700-EXIT.
 13206     EXIT.
 13207
 13208*************************************************************
 13209*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 13210*************************************************************
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 253
* EL130.cbl
 13211/
 13212 6990-DEEDIT-DATE.
 13213
 13214
 13215* EXEC CICS BIF DEEDIT
 13216*        FIELD   (DATE-WORK)
 13217*        LENGTH  (8)
 13218*    END-EXEC.
 13219     MOVE 8
 13220       TO DFHEIV11
 13221*    MOVE '@"L                   #   #00012029' TO DFHEIV0
 13222     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13223     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13224     MOVE X'2020233030303132303239' TO DFHEIV0(25:11)
 13225     CALL 'kxdfhei1' USING DFHEIV0,
 13226           DATE-WORK,
 13227           DFHEIV11
 13228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13229
 13230 6990-EXIT.
 13231     EXIT.
 13232
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 254
* EL130.cbl
 13234 7000-BUILD-OUTPUT-MAP.
 13235
 13236     IF CLAIM-SWITCH = 'N'
 13237         GO TO 7050-BUILD-MAP-CERT-DATA
 13238     END-IF.
 13239
 13240     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 13241         MOVE SPACES                 TO SEQUO
 13242         MOVE AL-SABOF               TO SEQUA
 13243     ELSE
 13244         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 13245         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 13246         MOVE WS-CLAIM-SEQU          TO SEQUO
 13247         MOVE AL-SABON               TO SEQUA
 13248     END-IF.
 13249
 13250     MOVE CL-CARRIER             TO CLMCARRO.
 13251     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 13252     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13253     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13254     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13255     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13256     MOVE CL-INSURED-MID-INIT    TO INITO.
 13257     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13258     MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 13259
 13260     MOVE AL-UANON               TO CLMCARRA
 13261                                    CLMTYPEA
 13262                                    PCERTNOA
 13263                                    PSUFXA
 13264                                    LSTNMEA
 13265                                    FSTNMEA
 13266                                    INITA
 13267                                    SEXA
 13268                                    OCCCDA.
 13269
 13270     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 13271
 13272     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 13273         MOVE ' '                 TO DC-OPTION-CODE
 13274         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13275         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13276         IF NOT DATE-CONVERSION-ERROR
 13277             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 13278             MOVE AL-UANON            TO BIRTHDTA
 13279         END-IF
 13280     END-IF.
 13281
 13282     MOVE CL-SOC-SEC-NO          TO SSNO.
 13283     MOVE AL-UANON               TO SSNA.
 13284
 13285     IF CL-INCURRED-DT NOT = LOW-VALUES
 13286         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13287         MOVE ' '                TO DC-OPTION-CODE
 13288         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13289         IF NOT DATE-CONVERSION-ERROR
 13290             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 13291             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 255
* EL130.cbl
 13292         END-IF
 13293     END-IF.
 13294
 13295     IF CL-REPORTED-DT NOT = LOW-VALUES
 13296         MOVE ' '                TO DC-OPTION-CODE
 13297         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 13298         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13299         IF NOT DATE-CONVERSION-ERROR
 13300             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 13301             MOVE AL-UANON            TO REPORTA
 13302         END-IF
 13303     END-IF.
 13304
 13305     IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 13306         MOVE ' '                 TO DC-OPTION-CODE
 13307         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13308         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13309         IF NOT DATE-CONVERSION-ERROR
 13310             MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 13311             MOVE AL-UANON            TO ESTENDA
 13312         END-IF
 13313     END-IF.
 13314
 13315     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 13316     MOVE CL-CAUSE-CD            TO CAUSEO.
 13317     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 13318     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 13319     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 13320     MOVE CL-PRIORITY-CD         TO PRICDO.
 13321     MOVE AL-UANON               TO DIAGA
 13322                                    CAUSEA
 13323                                    RELCLMA
 13324                                    PROCCDA
 13325                                    PRICDA.
 13326     MOVE AL-UNNON               TO MANRSVA.
 13327
 13328*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 13329*        MOVE CL-PRODUCT-CD          TO PRODCDO
 13330*        MOVE AL-UANON               TO PRODCDA
 13331*    END-IF.
 13332
 13333     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 13334     MOVE CL-FILE-LOCATION       TO FILETOO.
 13335     MOVE CL-BENEFICIARY         TO BENECDO.
 13336     MOVE AL-UANON               TO SUPVA
 13337                                    FILETOA
 13338                                    BENECDA.
 13339
 13340     IF CLAIM-SWITCH = 'X'
 13341         GO TO 7099-EXIT
 13342     END-IF.
 13343
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 256
* EL130.cbl
 13345 7050-BUILD-MAP-CERT-DATA.
 13346     MOVE CM-CERT-PRIME          TO CERTNOO.
 13347     MOVE CM-CERT-SFX            TO SUFXO.
 13348     MOVE AL-SANON               TO CERTNOA
 13349                                    SUFXA.
 13350
 13351     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 13352         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 13353         MOVE ' '                TO DC-OPTION-CODE
 13354         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13355         IF NOT DATE-CONVERSION-ERROR
 13356             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 13357         END-IF
 13358     END-IF.
 13359
 13360     MOVE CM-ACCOUNT             TO ACCOUNTO.
 13361     MOVE CM-STATE               TO STATEO.
 13362     MOVE CM-CARRIER             TO CRTCARRO.
 13363     MOVE CM-GROUPING            TO GROUPO.
 13364     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 13365     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 13366     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 13367     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 13368     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 13369     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 13370     MOVE CM-JT-INITIAL          TO JNTINITO.
 13371     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 13372     MOVE AL-UANON               TO ACCOUNTA
 13373                                    STATEA
 13374                                    CRTCARRA
 13375                                    GROUPA
 13376                                    CRTLNMEA
 13377                                    CRTFNMEA
 13378                                    CRTINITA
 13379                                    JNTLNMEA
 13380                                    JNTFNMEA
 13381                                    JNTINITA.
 13382     MOVE AL-UNNON               TO ISSAGEA
 13383                                    JNTAGEA.
 13384
 13385     IF CM-SSN-STATE   = CM-STATE AND
 13386        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 13387*        NEXT SENTENCE
 13388         CONTINUE
 13389     ELSE
 13390         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 13391     END-IF.
 13392
 13393     MOVE AL-UANON               TO CRTSSNA.
 13394
 13395     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 13396     MOVE '2'                    TO DC-OPTION-CODE.
 13397     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13398     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 13399
 13400*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 13401     MOVE SPACES                 TO ELCNTL-KEY.
 13402     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 257
* EL130.cbl
 13403     MOVE '3'                    TO CNTL-REC-TYPE.
 13404     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13405     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13406
 13407
 13408
 13409* EXEC CICS READ
 13410*        DATASET  (ELCNTL-DSID)
 13411*        SET      (ADDRESS OF CONTROL-FILE)
 13412*        RIDFLD   (ELCNTL-KEY)
 13413*        RESP     (WS-RESPONSE)
 13414*    END-EXEC.
 13415*    MOVE '&"S        E          (  N#00012211' TO DFHEIV0
 13416     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13417     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13418     MOVE X'204E233030303132323131' TO DFHEIV0(25:11)
 13419     CALL 'kxdfhei1' USING DFHEIV0,
 13420           ELCNTL-DSID,
 13421           DFHEIV20,
 13422           DFHEIV99,
 13423           ELCNTL-KEY,
 13424           DFHEIV99,
 13425           DFHEIV99,
 13426           DFHEIV99
 13427     SET ADDRESS OF CONTROL-FILE TO
 13428         DFHEIV20
 13429     MOVE EIBRESP  TO WS-RESPONSE
 13430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13431
 13432
 13433     IF WS-RESP-NOTFND
 13434          MOVE ER-2848           TO EMI-ERROR
 13435          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13436          GO TO 8100-SEND-INITIAL-MAP
 13437     END-IF.
 13438
 13439     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 13440     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 258
* EL130.cbl
 13442     IF CM-LF-BENEFIT-CD = '00'
 13443         MOVE ZEROS              TO LCVOTRMO
 13444                                    LCVRTRMO
 13445                                    LCVRATEO
 13446                                    LCVBENEO
 13447         MOVE SPACES             TO LCVDSCRO
 13448                                    LCVCDO
 13449                                    LCVKINDO
 13450                                    LCVFORMO
 13451                                    LCVCNDTO
 13452                                    LCVEXITO
 13453                                    LCVSTATO
 13454         IF CLMTYPEL GREATER THAN ZERO AND
 13455            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13456                MOVE ER-0521     TO EMI-ERROR
 13457                MOVE AL-UABON    TO CLMTYPEA
 13458                MOVE -1          TO CLMTYPEL
 13459                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13460                GO TO 7060-FILL-AH-COVERAGE
 13461         ELSE
 13462             GO TO 7060-FILL-AH-COVERAGE
 13463         END-IF
 13464     END-IF.
 13465
 13466     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 13467     MOVE AL-UANON               TO LCVDSCRA.
 13468     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 13469     MOVE '4'                    TO WS-REC-TYPE.
 13470     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13471     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 13472     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 13473     MOVE AL-UANON               TO LCVCDA.
 13474     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 13475                                    CP-ORIGINAL-TERM.
 13476     MOVE AL-UNNON               TO LCVOTRMA.
 13477     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13478     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13479     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13480     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13481     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13482     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13483
 13484     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13485     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 13486
 13487     IF CM-LF-PREMIUM-RATE NUMERIC
 13488         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 13489     ELSE
 13490         MOVE ZEROS              TO LCVRATEO
 13491     END-IF.
 13492
 13493     MOVE AL-UNNON               TO LCVRATEA.
 13494
 13495     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 13496         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 13497     END-IF.
 13498
 13499     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 259
* EL130.cbl
 13500
 13501     MOVE AL-UNNON               TO LCVBENEA.
 13502
 13503     IF CM-POLICY-FORM-NO NOT = SPACES
 13504         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 13505     ELSE
 13506         MOVE WS-FORM-HOLD       TO LCVFORMO
 13507     END-IF.
 13508
 13509     MOVE SPACES                 TO WS-FORM-HOLD.
 13510     MOVE 'L'                    TO WS-REC-TYPE.
 13511     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 13512
 13513     IF WS-FORM-HOLD NOT = SPACES
 13514         MOVE WS-FORM-HOLD       TO LCVFORMO
 13515         MOVE AL-UANON           TO LCVFORMA
 13516     END-IF.
 13517
 13518     IF CM-LF-CURRENT-STATUS = '8'
 13519         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 13520             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 13521             MOVE ' '             TO DC-OPTION-CODE
 13522             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13523             IF NOT DATE-CONVERSION-ERROR
 13524                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13525                 MOVE AL-UANON            TO LCVCNDTA
 13526             END-IF
 13527         END-IF
 13528     END-IF.
 13529
 13530     IF CM-LF-CURRENT-STATUS = '7'
 13531         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13532             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 13533             MOVE ' '            TO DC-OPTION-CODE
 13534             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13535             IF NOT DATE-CONVERSION-ERROR
 13536                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13537                 MOVE AL-UANON   TO LCVCNDTA
 13538             END-IF
 13539         END-IF
 13540     END-IF.
 13541
 13542     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 13543         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 13544             MOVE ' '            TO DC-OPTION-CODE
 13545             MOVE CM-LF-DEATH-EXIT-DT
 13546                                 TO DC-BIN-DATE-1
 13547             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13548             IF NOT DATE-CONVERSION-ERROR
 13549                 MOVE DC-GREG-DATE-1-EDIT
 13550                                 TO LCVEXITO
 13551             END-IF
 13552         END-IF
 13553     END-IF.
 13554
 13555     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 13556         IF CP-REMAINING-TERM-3 = ZEROS
 13557             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 260
* EL130.cbl
 13558         ELSE
 13559             MOVE 'ACTIVE'       TO LCVSTATO
 13560         END-IF
 13561     END-IF.
 13562
 13563     IF CM-LF-CURRENT-STATUS = '2'
 13564        MOVE 'PEND  '            TO LCVSTATO
 13565     END-IF.
 13566     IF CM-LF-CURRENT-STATUS = '3'
 13567        MOVE 'RESTORE'           TO LCVSTATO
 13568     END-IF.
 13569     IF CM-LF-CURRENT-STATUS = '5'
 13570        MOVE 'REISSUE'           TO LCVSTATO
 13571     END-IF.
 13572     IF CM-LF-CURRENT-STATUS = '6'
 13573        MOVE 'LMP DIS'           TO LCVSTATO
 13574     END-IF.
 13575     IF CM-LF-CURRENT-STATUS = '7'
 13576        MOVE 'DEATH  '           TO LCVSTATO
 13577     END-IF.
 13578     IF CM-LF-CURRENT-STATUS = '8'
 13579        MOVE 'CANCEL '           TO LCVSTATO
 13580     END-IF.
 13581     IF CM-LF-CURRENT-STATUS = '9'
 13582        MOVE 'RE-ONLY'           TO LCVSTATO
 13583     END-IF.
 13584     IF CM-LF-CURRENT-STATUS = 'V'
 13585        MOVE 'VOID   '           TO LCVSTATO
 13586     END-IF.
 13587     IF CM-LF-CURRENT-STATUS = 'D'
 13588        MOVE 'DECLINE'           TO LCVSTATO
 13589     END-IF.
 13590
 13591     IF PI-COMPANY-ID = 'CID'
 13592         IF CM-LF-BENEFIT-CD >= '2O' AND
 13593            CM-LF-BENEFIT-CD <= '2V'
 13594             MOVE ER-0878       TO EMI-ERROR
 13595             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13596         END-IF
 13597     END-IF.
 13598
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 261
* EL130.cbl
 13600 7060-FILL-AH-COVERAGE.
 13601
 13602     IF CM-AH-BENEFIT-CD = '00'
 13603         MOVE ZEROS              TO ACVOTRMO
 13604                                    ACVRTRMO
 13605                                    ACVRATEO
 13606                                    ACVBENEO
 13607         MOVE SPACES             TO ACVDSCRO
 13608                                    ACVCDO
 13609                                    ACVKINDO
 13610                                    ACVFORMO
 13611                                    ACVCNDTO
 13612                                    ACVEXITO
 13613                                    ACVSTATO
 13614         IF (CLMTYPEL GREATER THAN ZERO AND
 13615             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 13616             MOVE ER-0521     TO EMI-ERROR
 13617             MOVE AL-UABON    TO CLMTYPEA
 13618             MOVE -1          TO CLMTYPEL
 13619             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13620             GO TO 7070-BUILD-MAP-FINISH
 13621         ELSE
 13622             GO TO 7070-BUILD-MAP-FINISH
 13623         END-IF
 13624     END-IF.
 13625
 13626     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13627     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 13628     MOVE AL-UANON               TO ACVDSCRA
 13629                                    ACVCDA.
 13630     MOVE '5'                    TO WS-REC-TYPE.
 13631     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13632     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 13633
 13634     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 13635                                    CP-ORIGINAL-TERM.
 13636     MOVE AL-UNNON               TO ACVOTRMA.
 13637
 13638     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13639     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13640     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13641     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13642     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13643     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13644
 13645     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13646     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13647
 13648     IF CM-AH-PREMIUM-RATE NUMERIC
 13649         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13650     ELSE
 13651         MOVE ZEROS              TO ACVRATEO
 13652     END-IF.
 13653
 13654     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 13655     MOVE AL-UNNON               TO ACVRATEA
 13656                                    ACVBENEA.
 13657
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 262
* EL130.cbl
 13658     IF CM-POLICY-FORM-NO NOT = SPACES
 13659         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 13660     ELSE
 13661         MOVE WS-FORM-HOLD       TO ACVFORMO
 13662         MOVE SPACES TO WS-FORM-HOLD
 13663         MOVE 'A'                TO WS-REC-TYPE
 13664         PERFORM 7400-READ-STATE THRU 7499-EXIT
 13665         IF WS-FORM-HOLD NOT = SPACES
 13666             MOVE WS-FORM-HOLD   TO ACVFORMO
 13667         END-IF
 13668     END-IF.
 13669
 13670     MOVE AL-UANON               TO ACVFORMA.
 13671
 13672     IF CM-AH-CURRENT-STATUS = '8'
 13673         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 13674             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13675             MOVE ' '             TO DC-OPTION-CODE
 13676             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13677             IF NOT DATE-CONVERSION-ERROR
 13678                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13679                MOVE AL-UANON    TO ACVCNDTA
 13680             END-IF
 13681         END-IF
 13682     END-IF.
 13683
 13684     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13685         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13686             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 13687             MOVE ' '             TO DC-OPTION-CODE
 13688             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13689             IF NOT DATE-CONVERSION-ERROR
 13690                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13691                MOVE AL-UANON            TO ACVCNDTA
 13692             END-IF
 13693         END-IF
 13694     END-IF.
 13695
 13696     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13697         MOVE ' '                TO DC-OPTION-CODE
 13698         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13699         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13700         IF NOT DATE-CONVERSION-ERROR
 13701             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 13702         END-IF
 13703     END-IF.
 13704
 13705     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13706         IF CP-REMAINING-TERM-3 = ZEROS
 13707             MOVE 'EXPIRED'      TO ACVSTATO
 13708         ELSE
 13709             MOVE 'ACTIVE'       TO ACVSTATO
 13710         END-IF
 13711     END-IF.
 13712
 13713     IF CM-AH-CURRENT-STATUS = '2'
 13714         MOVE 'PEND  '           TO ACVSTATO
 13715     END-IF.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 263
* EL130.cbl
 13716     IF CM-AH-CURRENT-STATUS = '3'
 13717         MOVE 'RESTORE'          TO ACVSTATO
 13718     END-IF.
 13719     IF CM-AH-CURRENT-STATUS = '5'
 13720         MOVE 'REISSUE'          TO ACVSTATO
 13721     END-IF.
 13722     IF CM-AH-CURRENT-STATUS = '6'
 13723         MOVE 'LMP DIS'          TO ACVSTATO
 13724     END-IF.
 13725     IF CM-AH-CURRENT-STATUS = '7'
 13726         MOVE 'DEATH  '          TO ACVSTATO
 13727     END-IF.
 13728     IF CM-AH-CURRENT-STATUS = '8'
 13729         MOVE 'CANCEL '          TO ACVSTATO
 13730     END-IF.
 13731     IF CM-AH-CURRENT-STATUS = '9'
 13732         MOVE 'RE-ONLY'          TO ACVSTATO
 13733     END-IF.
 13734     IF CM-AH-CURRENT-STATUS = 'V'
 13735         MOVE 'VOID   '          TO ACVSTATO
 13736     END-IF.
 13737     IF CM-AH-CURRENT-STATUS = 'D'
 13738         MOVE 'DECLINE'          TO ACVSTATO
 13739     END-IF.
 13740
 13741     IF PI-COMPANY-ID = 'DCC'
 13742        IF CM-ACCOUNT (9:2) = 'BI'
 13743           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 13744           MOVE CM-CARRIER       TO CTRLR-CARRIER
 13745           MOVE CM-GROUPING      TO CTRLR-GROUPING
 13746           MOVE CM-STATE         TO CTRLR-STATE
 13747           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 13748           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 13749           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 13750           MOVE 'C'              TO CTRLR-REC-TYPE
 13751
 13752* EXEC CICS READ
 13753*            DATASET  (ELCRTT-DSID)
 13754*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13755*            RIDFLD   (ELCRTT-KEY)
 13756*            RESP     (WS-RESPONSE)
 13757*          END-EXEC
 13758*    MOVE '&"S        E          (  N#00012536' TO DFHEIV0
 13759     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13760     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13761     MOVE X'204E233030303132353336' TO DFHEIV0(25:11)
 13762     CALL 'kxdfhei1' USING DFHEIV0,
 13763           ELCRTT-DSID,
 13764           DFHEIV20,
 13765           DFHEIV99,
 13766           ELCRTT-KEY,
 13767           DFHEIV99,
 13768           DFHEIV99,
 13769           DFHEIV99
 13770     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13771         DFHEIV20
 13772     MOVE EIBRESP  TO WS-RESPONSE
 13773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 264
* EL130.cbl
 13774           IF WS-RESP-NORMAL
 13775               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 13776               MOVE WS-DIAG-VIN-MSG TO DIAGO
 13777               MOVE AL-UANON        TO DIAGA
 13778           END-IF
 13779        END-IF
 13780     END-IF.
 13781
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 265
* EL130.cbl
 13783 7070-BUILD-MAP-FINISH.
 13784     MOVE CM-LOAN-APR            TO APRO.
 13785     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 13786     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 13787     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 13788     MOVE AL-UNNON               TO APRA
 13789                                    PMTFREQA.
 13790     MOVE AL-UANON               TO INDGRPA
 13791                                    PREMTYPA.
 13792
 13793     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 13794         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 13795         MOVE AL-UANON               TO REINCDA
 13796     END-IF.
 13797
 13798     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 13799*        NEXT SENTENCE
 13800         CONTINUE
 13801     ELSE
 13802         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 13803         MOVE ' '                TO DC-OPTION-CODE
 13804         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13805         IF NOT DATE-CONVERSION-ERROR
 13806             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 13807             MOVE AL-UANON            TO ADDONDTA
 13808         END-IF
 13809     END-IF.
 13810
 13811     IF CLAIM-SWITCH = 'N'
 13812         IF SEXL = ZEROS
 13813             MOVE CM-INSURED-SEX TO SEXO
 13814*            MOVE AL-UANON       TO SEXA
 13815         END-IF
 13816     END-IF.
 13817
 13818     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 13819         MOVE CM-MEMBER-NO       TO MEMBERO
 13820         MOVE AL-UANON           TO MEMBERA
 13821     END-IF.
 13822
 13823     IF MAINTI = 'A'
 13824         IF (LOANNOL = ZEROS OR
 13825             EIBAID = DFHPF5)
 13826             MOVE CM-LOAN-NUMBER TO LOANNOO
 13827             MOVE AL-UANON       TO LOANNOA
 13828         ELSE
 13829*            NEXT SENTENCE
 13830             CONTINUE
 13831         END-IF
 13832     ELSE
 13833         MOVE CM-LOAN-NUMBER     TO LOANNOO
 13834         MOVE AL-UANON           TO LOANNOA
 13835     END-IF.
 13836
 13837     IF MAINTI = 'A'
 13838         IF (LOANBALL = ZEROS OR
 13839             EIBAID = DFHPF5)
 13840             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 266
* EL130.cbl
 13841             MOVE AL-UNNON       TO LOANBALA
 13842         ELSE
 13843*            NEXT SENTENCE
 13844             CONTINUE
 13845         END-IF
 13846     ELSE
 13847         MOVE CM-LOAN-BALANCE    TO LOANBALO
 13848         MOVE AL-UNNON           TO LOANBALA
 13849     END-IF.
 13850
 13851     IF CM-PREMIUM-TYPE NOT = '3'
 13852         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 13853             PERFORM 7200-PROTECT-CERT-FIELDS
 13854         ELSE
 13855             PERFORM 7300-RESET-KEY-ATTRBS
 13856         END-IF
 13857     ELSE
 13858         PERFORM 7300-RESET-KEY-ATTRBS
 13859     END-IF.
 13860
 13861*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 13862*        NEXT SENTENCE
 13863*        CONTINUE
 13864*    ELSE
 13865         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 13866*    END-IF.
 13867
 13868 7099-EXIT.
 13869     EXIT.
 13870
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 267
* EL130.cbl
 13872 7100-READ-BENEFIT.
 13873
 13874
 13875* EXEC CICS HANDLE CONDITION
 13876*         NOTFND   (7120-NOT-FOUND)
 13877*    END-EXEC.
 13878*    MOVE '"$I                   ! E #00012642' TO DFHEIV0
 13879     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13881     MOVE X'4520233030303132363432' TO DFHEIV0(25:11)
 13882     CALL 'kxdfhei1' USING DFHEIV0
 13883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13884
 13885
 13886     MOVE SPACES                 TO ELCNTL-KEY.
 13887     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 13888     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 13889     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13890     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13891
 13892 7105-READ-FILE.
 13893     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 13894
 13895     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 13896        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 13897          GO TO 7120-NOT-FOUND
 13898     END-IF.
 13899
 13900     MOVE 1                      TO SUB.
 13901 7110-LOOP.
 13902     IF SUB = 9
 13903         GO TO 7120-NOT-FOUND
 13904     END-IF.
 13905
 13906     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 13907         ADD 1                   TO SUB
 13908         GO TO 7110-LOOP
 13909     END-IF.
 13910
 13911     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 13912     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 13913     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 13914
 13915     GO TO 7199-EXIT.
 13916
 13917 7120-NOT-FOUND.
 13918     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 13919                                    WS-FORM-HOLD.
 13920
 13921 7199-EXIT.
 13922      EXIT.
 13923
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 268
* EL130.cbl
 13925 7200-PROTECT-CERT-FIELDS.
 13926     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 13927                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 13928                                LCVFORMA ACVFORMA JNTLNMEA
 13929                                JNTFNMEA JNTINITA.
 13930
 13931     IF CM-LF-CURRENT-STATUS = '2' OR
 13932        CM-AH-CURRENT-STATUS = '2'
 13933         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 13934     END-IF.
 13935
 13936     MOVE AL-SANOF TO
 13937            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 13938            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 13939            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 13940            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 13941            LCVRATEA   ACVRATEA.
 13942
 13943     MOVE 'S'                    TO CERTMTI.
 13944
 13945 7300-RESET-KEY-ATTRBS.
 13946     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 13947                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 13948                                LCVFORMA ACVFORMA JNTLNMEA
 13949                                JNTFNMEA JNTINITA.
 13950
 13951     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 13952         MOVE AL-SANOF           TO REINCDA
 13953     END-IF.
 13954
 13955     MOVE 'S'                    TO CERTMTI.
 13956
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 269
* EL130.cbl
 13958 7400-READ-STATE.
 13959
 13960
 13961* EXEC CICS HANDLE CONDITION
 13962*         NOTFND   (7499-EXIT)
 13963*    END-EXEC.
 13964*    MOVE '"$I                   ! F #00012720' TO DFHEIV0
 13965     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13966     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13967     MOVE X'4620233030303132373230' TO DFHEIV0(25:11)
 13968     CALL 'kxdfhei1' USING DFHEIV0
 13969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13970
 13971
 13972     MOVE SPACES                 TO ELCNTL-KEY.
 13973     MOVE CM-STATE               TO CNTL-ACCESS.
 13974     MOVE '3'                    TO CNTL-REC-TYPE.
 13975     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13976     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13977
 13978     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13979
 13980     MOVE 1                      TO SUB.
 13981
 13982 7410-LOOP.
 13983     IF SUB = 21
 13984        GO TO 7499-EXIT
 13985     END-IF.
 13986
 13987*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 13988*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 13989*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 13990*        GO TO 7499-EXIT.
 13991
 13992     ADD 1                       TO SUB.
 13993     GO TO 7410-LOOP.
 13994
 13995 7499-EXIT.
 13996      EXIT.
 13997
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 270
* EL130.cbl
 13999 7500-BROWSE-FOR-DUPLICATE.
 14000
 14001     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 14002
 14003
 14004
 14005* EXEC CICS HANDLE CONDITION
 14006*        NOTFND   (7500-EXIT)
 14007*        DUPKEY   (7500-DUPLICATE-KEY)
 14008*        ENDFILE  (7500-EXIT)
 14009*    END-EXEC.
 14010*    MOVE '"$I$''                 ! G #00012756' TO DFHEIV0
 14011     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 14012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14013     MOVE X'4720233030303132373536' TO DFHEIV0(25:11)
 14014     CALL 'kxdfhei1' USING DFHEIV0
 14015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14016
 14017
 14018
 14019
 14020* EXEC CICS STARTBR
 14021*        DATASET    (ELMSTR5-DSID)
 14022*        RIDFLD     (ELMSTR5-KEY)
 14023*    END-EXEC.
 14024     MOVE 0
 14025       TO DFHEIV11
 14026*    MOVE '&,         G          &   #00012763' TO DFHEIV0
 14027     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14028     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14029     MOVE X'2020233030303132373633' TO DFHEIV0(25:11)
 14030     CALL 'kxdfhei1' USING DFHEIV0,
 14031           ELMSTR5-DSID,
 14032           ELMSTR5-KEY,
 14033           DFHEIV99,
 14034           DFHEIV11,
 14035           DFHEIV99
 14036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14037
 14038
 14039
 14040
 14041* EXEC CICS HANDLE CONDITION
 14042*        ENDFILE  (7500-END-BROWSE)
 14043*    END-EXEC.
 14044*    MOVE '"$''                   ! H #00012769' TO DFHEIV0
 14045     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14047     MOVE X'4820233030303132373639' TO DFHEIV0(25:11)
 14048     CALL 'kxdfhei1' USING DFHEIV0
 14049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14050
 14051
 14052 7500-READ-CLAIM-LOOP.
 14053
 14054
 14055
 14056* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 271
* EL130.cbl
 14057*        DATASET   (ELMSTR5-DSID)
 14058*        SET       (ADDRESS OF CLAIM-MASTER)
 14059*        RIDFLD    (ELMSTR5-KEY)
 14060*    END-EXEC.
 14061     MOVE 0
 14062       TO DFHEIV11
 14063*    MOVE '&.S                   )   #00012776' TO DFHEIV0
 14064     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14065     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14066     MOVE X'2020233030303132373736' TO DFHEIV0(25:11)
 14067     CALL 'kxdfhei1' USING DFHEIV0,
 14068           ELMSTR5-DSID,
 14069           DFHEIV20,
 14070           DFHEIV99,
 14071           ELMSTR5-KEY,
 14072           DFHEIV99,
 14073           DFHEIV11,
 14074           DFHEIV99,
 14075           DFHEIV99
 14076     SET ADDRESS OF CLAIM-MASTER TO
 14077         DFHEIV20
 14078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14079
 14080
 14081 7500-DUPLICATE-KEY.
 14082
 14083     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 14084        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 14085        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 14086        CL-CERT-STATE     NOT = CM-STATE       OR
 14087        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 14088        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 14089        CL-CERT-NO        NOT = CM-CERT-NO
 14090           GO TO 7500-CHECK-MATCH-COUNT
 14091     END-IF.
 14092
 14093     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 14094
 14095     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 14096        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 14097        GO TO 7500-END-BROWSE
 14098     ELSE
 14099        GO TO 7500-READ-CLAIM-LOOP
 14100     END-IF.
 14101
 14102 7500-CHECK-MATCH-COUNT.
 14103
 14104     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 14105        CL-CERT-NO    = CM-CERT-NO
 14106          GO TO 7500-READ-CLAIM-LOOP
 14107     END-IF.
 14108
 14109 7500-END-BROWSE.
 14110
 14111
 14112
 14113* EXEC CICS ENDBR
 14114*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 272
* EL130.cbl
 14115*    END-EXEC.
 14116     MOVE 0
 14117       TO DFHEIV11
 14118*    MOVE '&2                    $   #00012813' TO DFHEIV0
 14119     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14120     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14121     MOVE X'2020233030303132383133' TO DFHEIV0(25:11)
 14122     CALL 'kxdfhei1' USING DFHEIV0,
 14123           ELMSTR5-DSID,
 14124           DFHEIV11,
 14125           DFHEIV99
 14126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14127
 14128
 14129 7500-EXIT.
 14130     EXIT.
 14131
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 273
* EL130.cbl
 14133 7550-FALL-THRU-PARA.
 14134
 14135
 14136
 14137* EXEC CICS DUMP
 14138*         DUMPCODE ('E130')
 14139*         TASK
 14140*    END-EXEC.
 14141     MOVE 'E130' TO DFHEIV5
 14142*    MOVE '<"   T                $   #00012824' TO DFHEIV0
 14143     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 14144     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14145     MOVE X'2020233030303132383234' TO DFHEIV0(25:11)
 14146     CALL 'kxdfhei1' USING DFHEIV0,
 14147           DFHEIV5,
 14148           DFHEIV99,
 14149           DFHEIV99
 14150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14151
 14152
 14153
 14154
 14155* EXEC CICS RETURN
 14156*    END-EXEC.
 14157*    MOVE '.(                    ''   #00012830' TO DFHEIV0
 14158     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 14159     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14160     MOVE X'2020233030303132383330' TO DFHEIV0(25:11)
 14161     CALL 'kxdfhei1' USING DFHEIV0,
 14162           DFHEIV99,
 14163           DFHEIV99,
 14164           DFHEIV99,
 14165           DFHEIV99,
 14166           DFHEIV99,
 14167           DFHEIV99
 14168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14169
 14170
 14171 7600-BROWSE-CLAIM.
 14172
 14173
 14174
 14175* EXEC CICS READ
 14176*        DATASET(ELMSTR-DSID)
 14177*        SET    (ADDRESS OF CLAIM-MASTER)
 14178*        RIDFLD (ELMSTR-KEY)
 14179*        GENERIC
 14180*        EQUAL
 14181*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14182*    END-EXEC.
 14183*    MOVE '&"S  KG    E          (   #00012836' TO DFHEIV0
 14184     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14185     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14186     MOVE X'2020233030303132383336' TO DFHEIV0(25:11)
 14187     CALL 'kxdfhei1' USING DFHEIV0,
 14188           ELMSTR-DSID,
 14189           DFHEIV20,
 14190           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 274
* EL130.cbl
 14191           ELMSTR-KEY,
 14192           ELMSTR-GENERIC-LENGTH,
 14193           DFHEIV99,
 14194           DFHEIV99
 14195     SET ADDRESS OF CLAIM-MASTER TO
 14196         DFHEIV20
 14197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14198
 14199
 14200     MOVE CL-CERT-PRIME          TO CERTNOI.
 14201     MOVE CL-CERT-SFX            TO SUFXI.
 14202
 14203 7610-BROWSE-CLAIM-LOOP.
 14204
 14205     MOVE LOW-VALUES             TO BCERT1O
 14206                                    BSUFX1O
 14207                                    BCERT2O
 14208                                    BSUFX2O
 14209                                    BCERT3O
 14210                                    BSUFX3O
 14211                                    BCERT4O
 14212                                    BSUFX4O
 14213                                    BCERT5O
 14214                                    BSUFX5O.
 14215
 14216     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 14217
 14218
 14219
 14220* EXEC CICS HANDLE CONDITION
 14221*        ENDFILE  (7630-END-BROWSE)
 14222*    END-EXEC.
 14223*    MOVE '"$''                   ! I #00012864' TO DFHEIV0
 14224     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14225     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14226     MOVE X'4920233030303132383634' TO DFHEIV0(25:11)
 14227     CALL 'kxdfhei1' USING DFHEIV0
 14228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14229
 14230
 14231
 14232
 14233* EXEC CICS STARTBR
 14234*        DATASET    (ELMSTR-DSID)
 14235*        RIDFLD     (ELMSTR-KEY)
 14236*    END-EXEC.
 14237     MOVE 0
 14238       TO DFHEIV11
 14239*    MOVE '&,         G          &   #00012869' TO DFHEIV0
 14240     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14241     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14242     MOVE X'2020233030303132383639' TO DFHEIV0(25:11)
 14243     CALL 'kxdfhei1' USING DFHEIV0,
 14244           ELMSTR-DSID,
 14245           ELMSTR-KEY,
 14246           DFHEIV99,
 14247           DFHEIV11,
 14248           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 275
* EL130.cbl
 14249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14250
 14251
 14252     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14253
 14254 7620-READ-CLAIM-LOOP.
 14255
 14256
 14257
 14258* EXEC CICS READNEXT
 14259*        DATASET   (ELMSTR-DSID)
 14260*        SET       (ADDRESS OF CLAIM-MASTER)
 14261*        RIDFLD    (ELMSTR-KEY)
 14262*    END-EXEC.
 14263     MOVE 0
 14264       TO DFHEIV11
 14265*    MOVE '&.S                   )   #00012879' TO DFHEIV0
 14266     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14267     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14268     MOVE X'2020233030303132383739' TO DFHEIV0(25:11)
 14269     CALL 'kxdfhei1' USING DFHEIV0,
 14270           ELMSTR-DSID,
 14271           DFHEIV20,
 14272           DFHEIV99,
 14273           ELMSTR-KEY,
 14274           DFHEIV99,
 14275           DFHEIV11,
 14276           DFHEIV99,
 14277           DFHEIV99
 14278     SET ADDRESS OF CLAIM-MASTER TO
 14279         DFHEIV20
 14280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14281
 14282
 14283     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 14284        CL-CARRIER     NOT = CLMCARRI       OR
 14285        CL-CLAIM-NO    NOT = CLMNOI
 14286          GO TO 7630-END-BROWSE
 14287     END-IF.
 14288
 14289     IF WS-ASSOCIATED-CERTS = 1
 14290         MOVE CL-CERT-PRIME      TO BCERT1O
 14291         MOVE CL-CERT-SFX        TO BSUFX1O
 14292     END-IF.
 14293
 14294     IF WS-ASSOCIATED-CERTS = 2
 14295         MOVE CL-CERT-PRIME      TO BCERT2O
 14296         MOVE CL-CERT-SFX        TO BSUFX2O
 14297     END-IF.
 14298
 14299     IF WS-ASSOCIATED-CERTS = 3
 14300         MOVE CL-CERT-PRIME      TO BCERT3O
 14301         MOVE CL-CERT-SFX        TO BSUFX3O
 14302     END-IF.
 14303
 14304     IF WS-ASSOCIATED-CERTS = 4
 14305         MOVE CL-CERT-PRIME      TO BCERT4O
 14306         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 276
* EL130.cbl
 14307     END-IF.
 14308
 14309     IF WS-ASSOCIATED-CERTS = 5
 14310         MOVE CL-CERT-PRIME      TO BCERT5O
 14311         MOVE CL-CERT-SFX        TO BSUFX5O
 14312     ELSE
 14313         ADD +1                  TO WS-ASSOCIATED-CERTS
 14314         GO TO 7620-READ-CLAIM-LOOP
 14315     END-IF.
 14316
 14317 7630-END-BROWSE.
 14318
 14319
 14320
 14321* EXEC CICS ENDBR
 14322*        DATASET   (ELMSTR-DSID)
 14323*    END-EXEC.
 14324     MOVE 0
 14325       TO DFHEIV11
 14326*    MOVE '&2                    $   #00012922' TO DFHEIV0
 14327     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14328     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14329     MOVE X'2020233030303132393232' TO DFHEIV0(25:11)
 14330     CALL 'kxdfhei1' USING DFHEIV0,
 14331           ELMSTR-DSID,
 14332           DFHEIV11,
 14333           DFHEIV99
 14334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14335
 14336
 14337 7640-HIGHLIGHT-CERT-DISPLAYED.
 14338
 14339     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 14340     MOVE AL-SANON               TO BCERT1A
 14341                                    BSUFX1A
 14342                                    BCERT2A
 14343                                    BSUFX2A
 14344                                    BCERT3A
 14345                                    BSUFX3A
 14346                                    BCERT4A
 14347                                    BSUFX4A
 14348                                    BCERT5A
 14349                                    BSUFX5A.
 14350
 14351     IF BCERT1O = CERTNOI AND
 14352        BSUFX1O = SUFXI
 14353            MOVE AL-SABON        TO BCERT1A
 14354                                    BSUFX1A
 14355     END-IF.
 14356
 14357     IF BCERT2O = CERTNOI AND
 14358        BSUFX2O = SUFXI
 14359            MOVE AL-SABON        TO BCERT2A
 14360                                    BSUFX2A
 14361     END-IF.
 14362
 14363     IF BCERT3O = CERTNOI AND
 14364        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 277
* EL130.cbl
 14365            MOVE AL-SABON        TO BCERT3A
 14366                                    BSUFX3A
 14367     END-IF.
 14368
 14369     IF BCERT4O = CERTNOI AND
 14370        BSUFX4O = SUFXI
 14371            MOVE AL-SABON        TO BCERT4A
 14372                                    BSUFX4A
 14373     END-IF.
 14374
 14375     IF BCERT5O = CERTNOI AND
 14376        BSUFX5O = SUFXI
 14377            MOVE AL-SABON        TO BCERT5A
 14378                                    BSUFX5A
 14379     END-IF.
 14380
 14381 7699-EXIT.
 14382     EXIT.
 14383
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 278
* EL130.cbl
 14385 7700-CHECK-SEQUENCE.
 14386
 14387
 14388
 14389* EXEC CICS HANDLE CONDITION
 14390*        ENDFILE  (7799-EXIT)
 14391*        NOTFND   (7799-EXIT)
 14392*    END-EXEC.
 14393*    MOVE '"$''I                  ! J #00012977' TO DFHEIV0
 14394     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14395     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14396     MOVE X'4A20233030303132393737' TO DFHEIV0(25:11)
 14397     CALL 'kxdfhei1' USING DFHEIV0
 14398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14399
 14400
 14401
 14402
 14403* EXEC CICS READ
 14404*        DATASET(ELMSTR-DSID)
 14405*        SET    (ADDRESS OF CLAIM-MASTER)
 14406*        RIDFLD (ELMSTR-KEY)
 14407*        GENERIC
 14408*        EQUAL
 14409*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14410*    END-EXEC.
 14411*    MOVE '&"S  KG    E          (   #00012983' TO DFHEIV0
 14412     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14413     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14414     MOVE X'2020233030303132393833' TO DFHEIV0(25:11)
 14415     CALL 'kxdfhei1' USING DFHEIV0,
 14416           ELMSTR-DSID,
 14417           DFHEIV20,
 14418           DFHEIV99,
 14419           ELMSTR-KEY,
 14420           ELMSTR-GENERIC-LENGTH,
 14421           DFHEIV99,
 14422           DFHEIV99
 14423     SET ADDRESS OF CLAIM-MASTER TO
 14424         DFHEIV20
 14425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14426
 14427
 14428     COMPUTE WS-ASSOC-CERT-TOTAL =
 14429             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14430
 14431     GO TO 7799-EXIT.
 14432
 14433 7710-RESEQUENCE-CLAIMS.
 14434
 14435
 14436
 14437* EXEC CICS HANDLE CONDITION
 14438*        ENDFILE  (7790-END-BROWSE)
 14439*    END-EXEC.
 14440*    MOVE '"$''                   ! K #00013000' TO DFHEIV0
 14441     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14442     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 279
* EL130.cbl
 14443     MOVE X'4B20233030303133303030' TO DFHEIV0(25:11)
 14444     CALL 'kxdfhei1' USING DFHEIV0
 14445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14446
 14447
 14448
 14449
 14450* EXEC CICS STARTBR
 14451*        DATASET    (ELMSTR-DSID)
 14452*        RIDFLD     (ELMSTR-KEY)
 14453*    END-EXEC.
 14454     MOVE 0
 14455       TO DFHEIV11
 14456*    MOVE '&,         G          &   #00013005' TO DFHEIV0
 14457     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14458     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14459     MOVE X'2020233030303133303035' TO DFHEIV0(25:11)
 14460     CALL 'kxdfhei1' USING DFHEIV0,
 14461           ELMSTR-DSID,
 14462           ELMSTR-KEY,
 14463           DFHEIV99,
 14464           DFHEIV11,
 14465           DFHEIV99
 14466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14467
 14468
 14469     ADD +1 TO WS-ASSOC-CERT-SEQU
 14470               WS-READNEXT-SWITCH.
 14471
 14472 7720-READ-CLAIM-LOOP.
 14473
 14474
 14475
 14476* EXEC CICS READNEXT
 14477*        DATASET   (ELMSTR-DSID)
 14478*        SET       (ADDRESS OF CLAIM-MASTER)
 14479*        RIDFLD    (ELMSTR-KEY)
 14480*    END-EXEC.
 14481     MOVE 0
 14482       TO DFHEIV11
 14483*    MOVE '&.S                   )   #00013016' TO DFHEIV0
 14484     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14485     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14486     MOVE X'2020233030303133303136' TO DFHEIV0(25:11)
 14487     CALL 'kxdfhei1' USING DFHEIV0,
 14488           ELMSTR-DSID,
 14489           DFHEIV20,
 14490           DFHEIV99,
 14491           ELMSTR-KEY,
 14492           DFHEIV99,
 14493           DFHEIV11,
 14494           DFHEIV99,
 14495           DFHEIV99
 14496     SET ADDRESS OF CLAIM-MASTER TO
 14497         DFHEIV20
 14498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14499
 14500
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 280
* EL130.cbl
 14501     IF WS-READNEXT-SWITCH = 1
 14502         ADD 1 TO WS-READNEXT-SWITCH
 14503         GO TO 7720-READ-CLAIM-LOOP
 14504     END-IF.
 14505
 14506 7730-END-BROWSE.
 14507
 14508
 14509
 14510* EXEC CICS ENDBR
 14511*        DATASET   (ELMSTR-DSID)
 14512*    END-EXEC.
 14513     MOVE 0
 14514       TO DFHEIV11
 14515*    MOVE '&2                    $   #00013030' TO DFHEIV0
 14516     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14517     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14518     MOVE X'2020233030303133303330' TO DFHEIV0(25:11)
 14519     CALL 'kxdfhei1' USING DFHEIV0,
 14520           ELMSTR-DSID,
 14521           DFHEIV11,
 14522           DFHEIV99
 14523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14524
 14525
 14526 7740-READ-CLAIM-UPDATE.
 14527
 14528     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 14529        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 14530        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 14531          GO TO 7799-EXIT
 14532     ELSE
 14533          MOVE ZERO              TO WS-READNEXT-SWITCH
 14534     END-IF.
 14535
 14536
 14537
 14538* EXEC CICS READ
 14539*        DATASET(ELMSTR-DSID)
 14540*        SET    (ADDRESS OF CLAIM-MASTER)
 14541*        RIDFLD (ELMSTR-KEY)
 14542*        UPDATE
 14543*    END-EXEC.
 14544*    MOVE '&"S        EU         (   #00013045' TO DFHEIV0
 14545     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14546     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14547     MOVE X'2020233030303133303435' TO DFHEIV0(25:11)
 14548     CALL 'kxdfhei1' USING DFHEIV0,
 14549           ELMSTR-DSID,
 14550           DFHEIV20,
 14551           DFHEIV99,
 14552           ELMSTR-KEY,
 14553           DFHEIV99,
 14554           DFHEIV99,
 14555           DFHEIV99
 14556     SET ADDRESS OF CLAIM-MASTER TO
 14557         DFHEIV20
 14558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 281
* EL130.cbl
 14559
 14560
 14561     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 14562     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 14563
 14564
 14565
 14566* EXEC CICS REWRITE
 14567*         DATASET     (ELMSTR-DSID)
 14568*         FROM        (CLAIM-MASTER)
 14569*    END-EXEC.
 14570     MOVE LENGTH OF
 14571      CLAIM-MASTER
 14572       TO DFHEIV11
 14573*    MOVE '&& L                  %   #00013056' TO DFHEIV0
 14574     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14575     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14576     MOVE X'2020233030303133303536' TO DFHEIV0(25:11)
 14577     CALL 'kxdfhei1' USING DFHEIV0,
 14578           ELMSTR-DSID,
 14579           CLAIM-MASTER,
 14580           DFHEIV11,
 14581           DFHEIV99
 14582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14583
 14584
 14585     GO TO 7710-RESEQUENCE-CLAIMS.
 14586
 14587 7790-END-BROWSE.
 14588
 14589
 14590
 14591* EXEC CICS ENDBR
 14592*        DATASET   (ELMSTR-DSID)
 14593*    END-EXEC.
 14594     MOVE 0
 14595       TO DFHEIV11
 14596*    MOVE '&2                    $   #00013066' TO DFHEIV0
 14597     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14598     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14599     MOVE X'2020233030303133303636' TO DFHEIV0(25:11)
 14600     CALL 'kxdfhei1' USING DFHEIV0,
 14601           ELMSTR-DSID,
 14602           DFHEIV11,
 14603           DFHEIV99
 14604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14605
 14606
 14607 7799-EXIT.
 14608     EXIT.
 14609
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 282
* EL130.cbl
 14611************************************************
 14612*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 14613************************************************
 14614
 14615 7900-READ-ACTV-UPDATE.
 14616     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14617     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14618     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14619     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14620     MOVE +0                     TO TRLR-SEQ-NO.
 14621     MOVE '1'                    TO TRLR-TYPE.
 14622     GO TO 7900-READ-TRAILER-UPDATE.
 14623
 14624 7900-READ-NINETY-UPDATE.
 14625     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14626     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14627     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14628     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14629     MOVE +90                    TO TRLR-SEQ-NO.
 14630     MOVE '6'                    TO TRLR-TYPE.
 14631
 14632 7900-READ-TRAILER-UPDATE.
 14633
 14634
 14635* EXEC CICS READ  UPDATE
 14636*        DATASET    (ELTRLR-DSID)
 14637*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 14638*        RIDFLD     (ELTRLR-KEY)
 14639*    END-EXEC.
 14640*    MOVE '&"S        EU         (   #00013097' TO DFHEIV0
 14641     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14642     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14643     MOVE X'2020233030303133303937' TO DFHEIV0(25:11)
 14644     CALL 'kxdfhei1' USING DFHEIV0,
 14645           ELTRLR-DSID,
 14646           DFHEIV20,
 14647           DFHEIV99,
 14648           ELTRLR-KEY,
 14649           DFHEIV99,
 14650           DFHEIV99,
 14651           DFHEIV99
 14652     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14653         DFHEIV20
 14654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14655
 14656
 14657 7900-EXIT.
 14658      EXIT.
 14659
 14660 7910-READ-ACTV.
 14661     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14662     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14663     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14664     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14665     MOVE +0                     TO TRLR-SEQ-NO.
 14666     MOVE '1'                    TO TRLR-TYPE.
 14667     GO TO 7910-READ-TRAILER.
 14668
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 283
* EL130.cbl
 14669 7910-READ-NINETY.
 14670     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14671     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14672     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14673     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14674     MOVE +90                    TO TRLR-SEQ-NO.
 14675     MOVE '6'                    TO TRLR-TYPE.
 14676
 14677 7910-READ-TRAILER.
 14678     MOVE 'TRLR'                 TO FILE-SWITCH.
 14679
 14680
 14681
 14682* EXEC CICS READ
 14683*        DATASET   (ELTRLR-DSID)
 14684*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14685*        RIDFLD    (ELTRLR-KEY)
 14686*    END-EXEC.
 14687*    MOVE '&"S        E          (   #00013127' TO DFHEIV0
 14688     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14689     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14690     MOVE X'2020233030303133313237' TO DFHEIV0(25:11)
 14691     CALL 'kxdfhei1' USING DFHEIV0,
 14692           ELTRLR-DSID,
 14693           DFHEIV20,
 14694           DFHEIV99,
 14695           ELTRLR-KEY,
 14696           DFHEIV99,
 14697           DFHEIV99,
 14698           DFHEIV99
 14699     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14700         DFHEIV20
 14701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14702
 14703
 14704 7910-EXIT.
 14705      EXIT.
 14706
 14707 7915-REWRITE-TRAILER.
 14708
 14709
 14710* EXEC CICS REWRITE
 14711*        DATASET   (ELTRLR-DSID)
 14712*        FROM      (ACTIVITY-TRAILERS)
 14713*    END-EXEC.
 14714     MOVE LENGTH OF
 14715      ACTIVITY-TRAILERS
 14716       TO DFHEIV11
 14717*    MOVE '&& L                  %   #00013138' TO DFHEIV0
 14718     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14719     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14720     MOVE X'2020233030303133313338' TO DFHEIV0(25:11)
 14721     CALL 'kxdfhei1' USING DFHEIV0,
 14722           ELTRLR-DSID,
 14723           ACTIVITY-TRAILERS,
 14724           DFHEIV11,
 14725           DFHEIV99
 14726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 284
* EL130.cbl
 14727
 14728
 14729 7915-EXIT.
 14730      EXIT.
 14731
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 285
* EL130.cbl
 14733********************************************
 14734*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 14735********************************************
 14736
 14737 7920-READ-CLAIM-UPDATE.
 14738
 14739
 14740
 14741* EXEC CICS READ
 14742*        UPDATE
 14743*        DATASET   (ELMSTR-DSID)
 14744*        SET       (ADDRESS OF CLAIM-MASTER)
 14745*        RIDFLD    (ELMSTR-KEY)
 14746*    END-EXEC.
 14747*    MOVE '&"S        EU         (   #00013154' TO DFHEIV0
 14748     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14749     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14750     MOVE X'2020233030303133313534' TO DFHEIV0(25:11)
 14751     CALL 'kxdfhei1' USING DFHEIV0,
 14752           ELMSTR-DSID,
 14753           DFHEIV20,
 14754           DFHEIV99,
 14755           ELMSTR-KEY,
 14756           DFHEIV99,
 14757           DFHEIV99,
 14758           DFHEIV99
 14759     SET ADDRESS OF CLAIM-MASTER TO
 14760         DFHEIV20
 14761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14762
 14763
 14764 7920-EXIT.
 14765      EXIT.
 14766
 14767 7950-READ-CLAIM.
 14768
 14769
 14770* EXEC CICS READ
 14771*        DATASET   (ELMSTR-DSID)
 14772*        SET       (ADDRESS OF CLAIM-MASTER)
 14773*        RIDFLD    (ELMSTR-KEY)
 14774*    END-EXEC.
 14775*    MOVE '&"S        E          (   #00013166' TO DFHEIV0
 14776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14777     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14778     MOVE X'2020233030303133313636' TO DFHEIV0(25:11)
 14779     CALL 'kxdfhei1' USING DFHEIV0,
 14780           ELMSTR-DSID,
 14781           DFHEIV20,
 14782           DFHEIV99,
 14783           ELMSTR-KEY,
 14784           DFHEIV99,
 14785           DFHEIV99,
 14786           DFHEIV99
 14787     SET ADDRESS OF CLAIM-MASTER TO
 14788         DFHEIV20
 14789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14790
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 286
* EL130.cbl
 14791
 14792 7950-EXIT.
 14793      EXIT.
 14794
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 287
* EL130.cbl
 14796***************************************
 14797*  I/O REQUESTS AGAINST CONTROL FILE  *
 14798***************************************
 14799
 14800 7960-READ-CNTL-UPDATE.
 14801
 14802
 14803* EXEC CICS READ
 14804*        UPDATE
 14805*        DATASET  (ELCNTL-DSID)
 14806*        SET      (ADDRESS OF CONTROL-FILE)
 14807*        RIDFLD   (ELCNTL-KEY)
 14808*    END-EXEC.
 14809*    MOVE '&"S        EU         (   #00013182' TO DFHEIV0
 14810     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14811     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14812     MOVE X'2020233030303133313832' TO DFHEIV0(25:11)
 14813     CALL 'kxdfhei1' USING DFHEIV0,
 14814           ELCNTL-DSID,
 14815           DFHEIV20,
 14816           DFHEIV99,
 14817           ELCNTL-KEY,
 14818           DFHEIV99,
 14819           DFHEIV99,
 14820           DFHEIV99
 14821     SET ADDRESS OF CONTROL-FILE TO
 14822         DFHEIV20
 14823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14824
 14825
 14826 7960-EXIT.
 14827      EXIT.
 14828
 14829 7970-READ-CNTL.
 14830
 14831
 14832* EXEC CICS READ
 14833*        DATASET  (ELCNTL-DSID)
 14834*        SET      (ADDRESS OF CONTROL-FILE)
 14835*        RIDFLD   (ELCNTL-KEY)
 14836*    END-EXEC.
 14837*    MOVE '&"S        E          (   #00013194' TO DFHEIV0
 14838     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14839     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14840     MOVE X'2020233030303133313934' TO DFHEIV0(25:11)
 14841     CALL 'kxdfhei1' USING DFHEIV0,
 14842           ELCNTL-DSID,
 14843           DFHEIV20,
 14844           DFHEIV99,
 14845           ELCNTL-KEY,
 14846           DFHEIV99,
 14847           DFHEIV99,
 14848           DFHEIV99
 14849     SET ADDRESS OF CONTROL-FILE TO
 14850         DFHEIV20
 14851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14852
 14853
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 288
* EL130.cbl
 14854 7970-EXIT.
 14855      EXIT.
 14856
 14857 7975-READ-CNTL-GTEQ.
 14858
 14859
 14860* EXEC CICS READ
 14861*         DATASET   (ELCNTL-DSID)
 14862*         SET       (ADDRESS OF CONTROL-FILE)
 14863*         RIDFLD    (ELCNTL-KEY)
 14864*         GTEQ
 14865*     END-EXEC.
 14866*    MOVE '&"S        G          (   #00013205' TO DFHEIV0
 14867     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14869     MOVE X'2020233030303133323035' TO DFHEIV0(25:11)
 14870     CALL 'kxdfhei1' USING DFHEIV0,
 14871           ELCNTL-DSID,
 14872           DFHEIV20,
 14873           DFHEIV99,
 14874           ELCNTL-KEY,
 14875           DFHEIV99,
 14876           DFHEIV99,
 14877           DFHEIV99
 14878     SET ADDRESS OF CONTROL-FILE TO
 14879         DFHEIV20
 14880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14881
 14882
 14883 7975-EXIT.
 14884      EXIT.
 14885
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 289
* EL130.cbl
 14887**************************************************
 14888*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 14889**************************************************
 14890
 14891 7980-READ-CERT5.
 14892
 14893
 14894* EXEC CICS READ
 14895*         DATASET  (ELCERT5-DSID)
 14896*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14897*         RIDFLD   (ELCERT-KEY-5)
 14898*     END-EXEC.
 14899*    MOVE '&"S        E          (   #00013222' TO DFHEIV0
 14900     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14901     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14902     MOVE X'2020233030303133323232' TO DFHEIV0(25:11)
 14903     CALL 'kxdfhei1' USING DFHEIV0,
 14904           ELCERT5-DSID,
 14905           DFHEIV20,
 14906           DFHEIV99,
 14907           ELCERT-KEY-5,
 14908           DFHEIV99,
 14909           DFHEIV99,
 14910           DFHEIV99
 14911     SET ADDRESS OF CERTIFICATE-MASTER TO
 14912         DFHEIV20
 14913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14914
 14915
 14916 7980-EXIT.
 14917      EXIT.
 14918
 14919 7930-READ-CERT-UPDATE.
 14920
 14921
 14922* EXEC CICS READ
 14923*        DATASET  (ELCERT-DSID)
 14924*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 14925*        RIDFLD   (ELCERT-KEY)
 14926*        UPDATE
 14927*    END-EXEC.
 14928*    MOVE '&"S        EU         (   #00013233' TO DFHEIV0
 14929     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14930     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14931     MOVE X'2020233030303133323333' TO DFHEIV0(25:11)
 14932     CALL 'kxdfhei1' USING DFHEIV0,
 14933           ELCERT-DSID,
 14934           DFHEIV20,
 14935           DFHEIV99,
 14936           ELCERT-KEY,
 14937           DFHEIV99,
 14938           DFHEIV99,
 14939           DFHEIV99
 14940     SET ADDRESS OF CERTIFICATE-MASTER TO
 14941         DFHEIV20
 14942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14943
 14944
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 290
* EL130.cbl
 14945 7930-EXIT.
 14946      EXIT.
 14947
 14948 7940-READ-CERT.
 14949
 14950
 14951* EXEC CICS READ
 14952*        DATASET  (ELCERT-DSID)
 14953*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 14954*        RIDFLD   (ELCERT-KEY)
 14955*    END-EXEC.
 14956*    MOVE '&"S        E          (   #00013245' TO DFHEIV0
 14957     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14958     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14959     MOVE X'2020233030303133323435' TO DFHEIV0(25:11)
 14960     CALL 'kxdfhei1' USING DFHEIV0,
 14961           ELCERT-DSID,
 14962           DFHEIV20,
 14963           DFHEIV99,
 14964           ELCERT-KEY,
 14965           DFHEIV99,
 14966           DFHEIV99,
 14967           DFHEIV99
 14968     SET ADDRESS OF CERTIFICATE-MASTER TO
 14969         DFHEIV20
 14970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14971
 14972
 14973 7940-EXIT.
 14974      EXIT.
 14975
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 291
* EL130.cbl
 14977**************************************************
 14978*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 14979**************************************************
 14980
 14981 7991-READ-BENE.
 14982
 14983
 14984* EXEC CICS READ
 14985*         DATASET   (ELBENE-DSID)
 14986*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 14987*         RIDFLD    (ELBENE-KEY)
 14988*     END-EXEC.
 14989*    MOVE '&"S        E          (   #00013261' TO DFHEIV0
 14990     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14992     MOVE X'2020233030303133323631' TO DFHEIV0(25:11)
 14993     CALL 'kxdfhei1' USING DFHEIV0,
 14994           ELBENE-DSID,
 14995           DFHEIV20,
 14996           DFHEIV99,
 14997           ELBENE-KEY,
 14998           DFHEIV99,
 14999           DFHEIV99,
 15000           DFHEIV99
 15001     SET ADDRESS OF BENEFICIARY-MASTER TO
 15002         DFHEIV20
 15003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15004
 15005
 15006 7991-EXIT.
 15007      EXIT.
 15008
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 292
* EL130.cbl
 15010**************************************************
 15011*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 15012**************************************************
 15013
 15014 7992-READ-REIN.
 15015
 15016
 15017
 15018* EXEC CICS HANDLE CONDITION
 15019*        NOTFND   (7992-NOT-FOUND)
 15020*    END-EXEC.
 15021*    MOVE '"$I                   ! L #00013278' TO DFHEIV0
 15022     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15023     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15024     MOVE X'4C20233030303133323738' TO DFHEIV0(25:11)
 15025     CALL 'kxdfhei1' USING DFHEIV0
 15026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15027
 15028
 15029
 15030
 15031* EXEC CICS READ
 15032*        DATASET   (ERREIN-DSID)
 15033*        SET       (ADDRESS OF REINSURANCE-RECORD)
 15034*        RIDFLD    (ERREIN-KEY)
 15035*    END-EXEC.
 15036*    MOVE '&"S        E          (   #00013283' TO DFHEIV0
 15037     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15038     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15039     MOVE X'2020233030303133323833' TO DFHEIV0(25:11)
 15040     CALL 'kxdfhei1' USING DFHEIV0,
 15041           ERREIN-DSID,
 15042           DFHEIV20,
 15043           DFHEIV99,
 15044           ERREIN-KEY,
 15045           DFHEIV99,
 15046           DFHEIV99,
 15047           DFHEIV99
 15048     SET ADDRESS OF REINSURANCE-RECORD TO
 15049         DFHEIV20
 15050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15051
 15052
 15053     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 15054
 15055     GO TO 7992-EXIT.
 15056
 15057 7992-NOT-FOUND.
 15058     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 15059
 15060 7992-EXIT.
 15061     EXIT.
 15062
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 293
* EL130.cbl
 15064 8000-LOAD-ERROR-MESSAGES.
 15065     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 15066
 15067     IF EMI-NO-ERRORS
 15068         GO TO 8000-EXIT
 15069     END-IF.
 15070
 15071     IF EMI-NUMBER-OF-LINES = 1
 15072         MOVE EMI-LINE1          TO ERRMSG1O
 15073         GO TO 8000-EXIT
 15074     END-IF.
 15075
 15076     IF EMI-NUMBER-OF-LINES = 2
 15077          MOVE EMI-LINE1         TO ERRMSG1O
 15078          MOVE EMI-LINE2         TO ERRMSG2O
 15079          GO TO 8000-EXIT
 15080     END-IF.
 15081
 15082     MOVE EMI-LINE1              TO ERRMSG1O.
 15083
 15084 8000-EXIT.
 15085     EXIT.
 15086
 15087 8100-SEND-INITIAL-MAP.
 15088     MOVE SAVE-DATE              TO RUNDTEO.
 15089     MOVE EIBTIME                TO TIME-IN.
 15090     MOVE TIME-OUT               TO RUNTIMEO.
 15091     IF RETURNED-FROM = XCTL-114
 15092        CONTINUE
 15093     ELSE
 15094        MOVE -1                  TO MAINTL
 15095     END-IF.
 15096
 15097*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15098         MOVE SPACES             TO PRODO.
 15099         MOVE AL-SANOF           TO PRODCDA.
 15100*    END-IF.
 15101
 15102     MOVE PI-COMPANY-ID          TO COMPO.
 15103     MOVE AL-PABOF               TO COMPA.
 15104     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15105     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15106     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15107
 15108     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15109
 15110     IF NOT PI-NO-CARRIER-SECURITY
 15111        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 15112        MOVE AL-SABOF            TO CLMCARRA
 15113     END-IF.
 15114
 15115     IF PI-PROCESSOR-ID = 'PEMA'
 15116        MOVE AL-UANON            TO CERTNOA
 15117                                    SUFXA
 15118     END-IF.
 15119*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15120*        NEXT SENTENCE
 15121*        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 294
* EL130.cbl
 15122*    ELSE
 15123         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15124*    END-IF.
 15125
 15126
 15127
 15128* EXEC CICS SEND
 15129*        MAP     (MAP-NAME)
 15130*        MAPSET  (MAPSET-NAME)
 15131*        FROM    (EL130AO)
 15132*        ERASE
 15133*        CURSOR
 15134*    END-EXEC.
 15135     MOVE LENGTH OF
 15136      EL130AO
 15137       TO DFHEIV12
 15138     MOVE -1
 15139       TO DFHEIV11
 15140*    MOVE '8$     CT  E    H L F ,   #00013363' TO DFHEIV0
 15141     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15142     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15143     MOVE X'2020233030303133333633' TO DFHEIV0(25:11)
 15144     CALL 'kxdfhei1' USING DFHEIV0,
 15145           MAP-NAME,
 15146           EL130AO,
 15147           DFHEIV12,
 15148           MAPSET-NAME,
 15149           DFHEIV99,
 15150           DFHEIV99,
 15151           DFHEIV99,
 15152           DFHEIV11,
 15153           DFHEIV99,
 15154           DFHEIV99,
 15155           DFHEIV99
 15156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15157
 15158
 15159     GO TO 9100-RETURN-TRAN.
 15160
 15161 8150-SEND-MAP-CURSOR.
 15162     MOVE SAVE-DATE              TO RUNDTEO.
 15163     MOVE EIBTIME                TO TIME-IN.
 15164     MOVE TIME-OUT               TO RUNTIMEO.
 15165     MOVE PI-COMPANY-ID          TO COMPO.
 15166     MOVE AL-PABOF               TO COMPA
 15167     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15168     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15169     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15170
 15171*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15172         MOVE SPACES             TO PRODO.
 15173         MOVE AL-SANOF           TO PRODCDA.
 15174*    END-IF.
 15175
 15176     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15177
 15178     IF NOT PI-NO-CARRIER-SECURITY
 15179         MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 295
* EL130.cbl
 15180         MOVE AL-SABOF            TO CLMCARRA
 15181     END-IF.
 15182
 15183     IF PI-PROCESSOR-ID = 'PEMA'
 15184        MOVE AL-UANON            TO CERTNOA
 15185                                    SUFXA
 15186     END-IF.
 15187*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15188*        NEXT SENTENCE
 15189*        CONTINUE
 15190*    ELSE
 15191         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15192*    END-IF.
 15193
 15194
 15195
 15196* EXEC CICS SEND
 15197*        MAP      (MAP-NAME)
 15198*        MAPSET   (MAPSET-NAME)
 15199*        FROM     (EL130AO)
 15200*        CURSOR   (PI-CURSOR)
 15201*        ERASE
 15202*    END-EXEC.
 15203     MOVE LENGTH OF
 15204      EL130AO
 15205       TO DFHEIV11
 15206*    MOVE '8$     CT  E    H L F ,   #00013407' TO DFHEIV0
 15207     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15208     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15209     MOVE X'2020233030303133343037' TO DFHEIV0(25:11)
 15210     CALL 'kxdfhei1' USING DFHEIV0,
 15211           MAP-NAME,
 15212           EL130AO,
 15213           DFHEIV11,
 15214           MAPSET-NAME,
 15215           DFHEIV99,
 15216           DFHEIV99,
 15217           DFHEIV99,
 15218           PI-CURSOR,
 15219           DFHEIV99,
 15220           DFHEIV99,
 15221           DFHEIV99
 15222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15223
 15224
 15225     GO TO 9100-RETURN-TRAN.
 15226
 15227 8200-SEND-DATAONLY.
 15228     IF EIBAID = DFHPF11
 15229        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 15230        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15231     END-IF.
 15232
 15233     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15234
 15235 8200-BYPASS-ERROR.
 15236     MOVE SAVE-DATE              TO RUNDTEO.
 15237     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 296
* EL130.cbl
 15238     MOVE TIME-OUT               TO RUNTIMEO.
 15239     MOVE PI-COMPANY-ID          TO COMPO.
 15240     MOVE AL-PABOF               TO COMPA
 15241     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15242
 15243*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15244         MOVE SPACES             TO PRODO.
 15245         MOVE AL-SANOF           TO PRODCDA.
 15246*    END-IF.
 15247
 15248     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15249     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15250
 15251     IF PI-PROCESSOR-ID = 'PEMA'
 15252        MOVE AL-UANON            TO CERTNOA
 15253                                    SUFXA
 15254     END-IF.
 15255     IF NOT PI-NO-CARRIER-SECURITY
 15256        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 15257        MOVE AL-SABOF            TO CLMCARRA
 15258     END-IF.
 15259
 15260*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15261*        NEXT SENTENCE
 15262*        CONTINUE
 15263*    ELSE
 15264         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15265*    END-IF.
 15266
 15267*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 15268         MOVE AL-SANOF           TO PRODCDA.
 15269*    END-IF.
 15270
 15271
 15272
 15273* EXEC CICS SEND
 15274*        MAP      (MAP-NAME)
 15275*        MAPSET   (MAPSET-NAME)
 15276*        FROM     (EL130AO)
 15277*        DATAONLY
 15278*        CURSOR
 15279*    END-EXEC.
 15280     MOVE LENGTH OF
 15281      EL130AO
 15282       TO DFHEIV12
 15283     MOVE -1
 15284       TO DFHEIV11
 15285*    MOVE '8$D    CT       H L F ,   #00013462' TO DFHEIV0
 15286     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15287     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15288     MOVE X'2020233030303133343632' TO DFHEIV0(25:11)
 15289     CALL 'kxdfhei1' USING DFHEIV0,
 15290           MAP-NAME,
 15291           EL130AO,
 15292           DFHEIV12,
 15293           MAPSET-NAME,
 15294           DFHEIV99,
 15295           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 297
* EL130.cbl
 15296           DFHEIV99,
 15297           DFHEIV11,
 15298           DFHEIV99,
 15299           DFHEIV99,
 15300           DFHEIV99
 15301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15302
 15303
 15304     GO TO 9100-RETURN-TRAN.
 15305
 15306 8300-SEND-TEXT.
 15307
 15308
 15309* EXEC CICS SEND TEXT
 15310*        FROM     (LOGOFF-TEXT)
 15311*        LENGTH   (LOGOFF-LENGTH)
 15312*        ERASE
 15313*        FREEKB
 15314*    END-EXEC.
 15315*    MOVE '8&      T  E F  H   F -   #00013474' TO DFHEIV0
 15316     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15317     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15318     MOVE X'2020233030303133343734' TO DFHEIV0(25:11)
 15319     CALL 'kxdfhei1' USING DFHEIV0,
 15320           LOGOFF-TEXT,
 15321           LOGOFF-LENGTH,
 15322           DFHEIV99,
 15323           DFHEIV99,
 15324           DFHEIV99,
 15325           DFHEIV99,
 15326           DFHEIV99,
 15327           DFHEIV99,
 15328           DFHEIV99,
 15329           DFHEIV99,
 15330           DFHEIV99,
 15331           DFHEIV99
 15332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15333
 15334
 15335
 15336
 15337* EXEC CICS RETURN
 15338*    END-EXEC.
 15339*    MOVE '.(                    ''   #00013482' TO DFHEIV0
 15340     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15341     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15342     MOVE X'2020233030303133343832' TO DFHEIV0(25:11)
 15343     CALL 'kxdfhei1' USING DFHEIV0,
 15344           DFHEIV99,
 15345           DFHEIV99,
 15346           DFHEIV99,
 15347           DFHEIV99,
 15348           DFHEIV99,
 15349           DFHEIV99
 15350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15351
 15352
 15353 8800-UNAUTHORIZED-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 298
* EL130.cbl
 15354     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 15355     GO TO 8300-SEND-TEXT.
 15356
 15357 8810-PF23.
 15358     MOVE EIBAID TO PI-ENTRY-CD-1.
 15359     MOVE XCTL-005               TO PGM-NAME.
 15360     GO TO 9300-XCTL.
 15361
 15362 8820-TERM-ERROR.
 15363     MOVE ER-0412                TO EMI-ERROR.
 15364     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15365     MOVE -1                     TO MAINTL.
 15366     GO TO 8200-SEND-DATAONLY.
 15367
 15368 8830-TRAN-ERROR.
 15369     MOVE ER-0413                TO EMI-ERROR.
 15370     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15371     MOVE -1                     TO MAINTL.
 15372     GO TO 8200-SEND-DATAONLY.
 15373
 15374 9000-RETURN-CICS.
 15375
 15376
 15377* EXEC CICS RETURN
 15378*    END-EXEC.
 15379*    MOVE '.(                    ''   #00013508' TO DFHEIV0
 15380     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15381     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15382     MOVE X'2020233030303133353038' TO DFHEIV0(25:11)
 15383     CALL 'kxdfhei1' USING DFHEIV0,
 15384           DFHEIV99,
 15385           DFHEIV99,
 15386           DFHEIV99,
 15387           DFHEIV99,
 15388           DFHEIV99,
 15389           DFHEIV99
 15390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15391
 15392
 15393 9100-RETURN-TRAN.
 15394     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15395     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 15396
 15397
 15398
 15399* EXEC CICS RETURN
 15400*        TRANSID   (TRANS-ID)
 15401*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15402*        LENGTH    (PI-COMM-LENGTH)
 15403*    END-EXEC.
 15404*    MOVE '.(CT                  ''   #00013516' TO DFHEIV0
 15405     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15406     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15407     MOVE X'2020233030303133353136' TO DFHEIV0(25:11)
 15408     CALL 'kxdfhei1' USING DFHEIV0,
 15409           TRANS-ID,
 15410           PROGRAM-INTERFACE-BLOCK,
 15411           PI-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 299
* EL130.cbl
 15412           DFHEIV99,
 15413           DFHEIV99,
 15414           DFHEIV99
 15415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15416
 15417
 15418 9200-RETURN-MAIN-MENU.
 15419     MOVE XCTL-126               TO PGM-NAME.
 15420     GO TO 9300-XCTL.
 15421
 15422 9300-XCTL.
 15423
 15424
 15425* EXEC CICS XCTL
 15426*        PROGRAM   (PGM-NAME)
 15427*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15428*        LENGTH    (PI-COMM-LENGTH)
 15429*    END-EXEC.
 15430*    MOVE '.$C                   %   #00013528' TO DFHEIV0
 15431     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15432     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15433     MOVE X'2020233030303133353238' TO DFHEIV0(25:11)
 15434     CALL 'kxdfhei1' USING DFHEIV0,
 15435           PGM-NAME,
 15436           PROGRAM-INTERFACE-BLOCK,
 15437           PI-COMM-LENGTH,
 15438           DFHEIV99
 15439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15440
 15441
 15442 9400-CLEAR.
 15443     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 15444     GO TO 9300-XCTL.
 15445
 15446 9500-PF12.
 15447     MOVE XCTL-010               TO PGM-NAME.
 15448     GO TO 9300-XCTL.
 15449
 15450 9600-PGMID-ERROR.
 15451
 15452
 15453* EXEC CICS HANDLE CONDITION
 15454*        PGMIDERR  (8300-SEND-TEXT)
 15455*    END-EXEC.
 15456*    MOVE '"$L                   ! M #00013544' TO DFHEIV0
 15457     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15459     MOVE X'4D20233030303133353434' TO DFHEIV0(25:11)
 15460     CALL 'kxdfhei1' USING DFHEIV0
 15461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15462
 15463
 15464     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 15465     MOVE ' '                    TO PI-ENTRY-CD-1.
 15466     MOVE XCTL-005               TO PGM-NAME.
 15467     MOVE PGM-NAME               TO LOGOFF-PGM.
 15468     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 15469     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 300
* EL130.cbl
 15470
 15471 9700-LINK-DATE-CONVERT.
 15472     MOVE LINK-ELDATCV           TO PGM-NAME.
 15473
 15474
 15475* EXEC CICS LINK
 15476*        PROGRAM    (PGM-NAME)
 15477*        COMMAREA   (DATE-CONVERSION-DATA)
 15478*        LENGTH     (DC-COMM-LENGTH)
 15479*    END-EXEC.
 15480*    MOVE '."C                   (   #00013558' TO DFHEIV0
 15481     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15483     MOVE X'2020233030303133353538' TO DFHEIV0(25:11)
 15484     CALL 'kxdfhei1' USING DFHEIV0,
 15485           PGM-NAME,
 15486           DATE-CONVERSION-DATA,
 15487           DC-COMM-LENGTH,
 15488           DFHEIV99,
 15489           DFHEIV99,
 15490           DFHEIV99,
 15491           DFHEIV99
 15492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15493
 15494
 15495 9700-EXIT.
 15496     EXIT.
 15497
 15498 9800-LINK-REM-TERM.
 15499     MOVE LINK-ELRTRM            TO PGM-NAME.
 15500
 15501
 15502* EXEC CICS LINK
 15503*        PROGRAM    (PGM-NAME)
 15504*        COMMAREA   (CALCULATION-PASS-AREA)
 15505*        LENGTH     (CP-COMM-LENGTH)
 15506*    END-EXEC.
 15507*    MOVE '."C                   (   #00013570' TO DFHEIV0
 15508     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15509     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15510     MOVE X'2020233030303133353730' TO DFHEIV0(25:11)
 15511     CALL 'kxdfhei1' USING DFHEIV0,
 15512           PGM-NAME,
 15513           CALCULATION-PASS-AREA,
 15514           CP-COMM-LENGTH,
 15515           DFHEIV99,
 15516           DFHEIV99,
 15517           DFHEIV99,
 15518           DFHEIV99
 15519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15520
 15521
 15522 9800-EXIT.
 15523     EXIT.
 15524
 15525 9900-ERROR-FORMAT.
 15526     IF NOT EMI-ERRORS-COMPLETE
 15527         MOVE LINK-001           TO PGM-NAME
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 301
* EL130.cbl
 15528
 15529* EXEC CICS LINK
 15530*            PROGRAM   (PGM-NAME)
 15531*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 15532*            LENGTH    (EMI-COMM-LENGTH)
 15533*        END-EXEC
 15534*    MOVE '."C                   (   #00013582' TO DFHEIV0
 15535     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15537     MOVE X'2020233030303133353832' TO DFHEIV0(25:11)
 15538     CALL 'kxdfhei1' USING DFHEIV0,
 15539           PGM-NAME,
 15540           ERROR-MESSAGE-INTERFACE-BLOCK,
 15541           EMI-COMM-LENGTH,
 15542           DFHEIV99,
 15543           DFHEIV99,
 15544           DFHEIV99,
 15545           DFHEIV99
 15546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15547     END-IF.
 15548
 15549 9900-EXIT.
 15550     EXIT.
 15551
 15552 9990-ABEND.
 15553     MOVE -1                     TO MAINTL.
 15554     MOVE LINK-004               TO PGM-NAME.
 15555     MOVE DFHEIBLK               TO EMI-LINE1.
 15556
 15557
 15558* EXEC CICS LINK
 15559*        PROGRAM   (PGM-NAME)
 15560*        COMMAREA  (EMI-LINE1)
 15561*        LENGTH    (72)
 15562*    END-EXEC.
 15563     MOVE 72
 15564       TO DFHEIV11
 15565*    MOVE '."C                   (   #00013597' TO DFHEIV0
 15566     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15567     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15568     MOVE X'2020233030303133353937' TO DFHEIV0(25:11)
 15569     CALL 'kxdfhei1' USING DFHEIV0,
 15570           PGM-NAME,
 15571           EMI-LINE1,
 15572           DFHEIV11,
 15573           DFHEIV99,
 15574           DFHEIV99,
 15575           DFHEIV99,
 15576           DFHEIV99
 15577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15578
 15579
 15580     MOVE EMI-LINE1              TO ERRMSG2O.
 15581
 15582     GO TO 8200-BYPASS-ERROR.
 15583
 15584
 15585
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 302
* EL130.cbl
 15586* GOBACK.
 15587     MOVE '9%                    "   ' TO DFHEIV0
 15588     MOVE 'EL130' TO DFHEIV1
 15589     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15590     GOBACK.
 15591
 15592 9995-SECURITY-VIOLATION.
 15593*             COPY ELCSCTP.
 15594******************************************************************
 15595*                                                                *
 15596*                            ELCSCTP                             *
 15597*                            VMOD=2.001                          *
 15598*                                                                *
 15599*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 15600******************************************************************
 15601
 15602
 15603     MOVE EIBDATE          TO SM-JUL-DATE.
 15604     MOVE EIBTRMID         TO SM-TERMID.
 15605     MOVE THIS-PGM         TO SM-PGM.
 15606     MOVE EIBTIME          TO TIME-IN.
 15607     MOVE TIME-OUT         TO SM-TIME.
 15608     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 15609
 15610
 15611* EXEC CICS LINK
 15612*         PROGRAM  ('EL003')
 15613*         COMMAREA (SECURITY-MESSAGE)
 15614*         LENGTH   (80)
 15615*    END-EXEC.
 15616     MOVE 'EL003' TO DFHEIV1
 15617     MOVE 80
 15618       TO DFHEIV11
 15619*    MOVE '."C                   (   #00013628' TO DFHEIV0
 15620     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15621     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15622     MOVE X'2020233030303133363238' TO DFHEIV0(25:11)
 15623     CALL 'kxdfhei1' USING DFHEIV0,
 15624           DFHEIV1,
 15625           SECURITY-MESSAGE,
 15626           DFHEIV11,
 15627           DFHEIV99,
 15628           DFHEIV99,
 15629           DFHEIV99,
 15630           DFHEIV99
 15631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15632
 15633
 15634******************************************************************
 15635
 15636
 15637 9995-EXIT.
 15638     EXIT.
 15639
 15640
 15641 9999-DFHBACK SECTION.
 15642     MOVE '9%                    "   ' TO DFHEIV0
 15643     MOVE 'EL130' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 303
* EL130.cbl
 15644     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15645     GOBACK.
 15646 9999-DFHEXIT.
 15647     IF DFHEIGDJ EQUAL 0001
 15648         NEXT SENTENCE
 15649     ELSE IF DFHEIGDJ EQUAL 2
 15650         GO TO 0100-TEST-ENTRY,
 15651               8100-SEND-INITIAL-MAP,
 15652               9600-PGMID-ERROR,
 15653               8820-TERM-ERROR,
 15654               8830-TRAN-ERROR,
 15655               9990-ABEND
 15656         DEPENDING ON DFHEIGDI
 15657     ELSE IF DFHEIGDJ EQUAL 3
 15658         GO TO 0450-ADD-ELACTQ-RECORD
 15659         DEPENDING ON DFHEIGDI
 15660     ELSE IF DFHEIGDJ EQUAL 4
 15661         GO TO 8820-TERM-ERROR,
 15662               8830-TRAN-ERROR
 15663         DEPENDING ON DFHEIGDI
 15664     ELSE IF DFHEIGDJ EQUAL 5
 15665         GO TO 0660-NOT-FOUND,
 15666               0670-QIDERR
 15667         DEPENDING ON DFHEIGDI
 15668     ELSE IF DFHEIGDJ EQUAL 6
 15669         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15670         DEPENDING ON DFHEIGDI
 15671     ELSE IF DFHEIGDJ EQUAL 7
 15672         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15673         DEPENDING ON DFHEIGDI
 15674     ELSE IF DFHEIGDJ EQUAL 8
 15675         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15676         DEPENDING ON DFHEIGDI
 15677     ELSE IF DFHEIGDJ EQUAL 9
 15678         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15679         DEPENDING ON DFHEIGDI
 15680     ELSE IF DFHEIGDJ EQUAL 10
 15681         GO TO 2050-DELETE-NOT-FOUND
 15682         DEPENDING ON DFHEIGDI
 15683     ELSE IF DFHEIGDJ EQUAL 11
 15684         GO TO 2010-DELETE-CL
 15685         DEPENDING ON DFHEIGDI
 15686     ELSE IF DFHEIGDJ EQUAL 12
 15687         GO TO 3010-TEST-FOR-ERRORS
 15688         DEPENDING ON DFHEIGDI
 15689     ELSE IF DFHEIGDJ EQUAL 13
 15690         GO TO 3008-DUP-ERROR,
 15691               3009-NOT-FOUND
 15692         DEPENDING ON DFHEIGDI
 15693     ELSE IF DFHEIGDJ EQUAL 14
 15694         GO TO 3030-BUILD-CONT
 15695         DEPENDING ON DFHEIGDI
 15696     ELSE IF DFHEIGDJ EQUAL 15
 15697         GO TO 3033-ACCT-NOT-FOUND,
 15698               3033-ACCT-NOT-FOUND
 15699         DEPENDING ON DFHEIGDI
 15700     ELSE IF DFHEIGDJ EQUAL 16
 15701         GO TO 3032-NOT-IN-DT-RANGE
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 304
* EL130.cbl
 15702         DEPENDING ON DFHEIGDI
 15703     ELSE IF DFHEIGDJ EQUAL 17
 15704         GO TO 3070-BUILD-CONT
 15705         DEPENDING ON DFHEIGDI
 15706     ELSE IF DFHEIGDJ EQUAL 18
 15707         GO TO 3065-CERT-NOT-FOUND
 15708         DEPENDING ON DFHEIGDI
 15709     ELSE IF DFHEIGDJ EQUAL 19
 15710         GO TO 3100-CARRIER-NOT-FOUND
 15711         DEPENDING ON DFHEIGDI
 15712     ELSE IF DFHEIGDJ EQUAL 20
 15713         GO TO 3110-COMPANY-NOT-FOUND
 15714         DEPENDING ON DFHEIGDI
 15715     ELSE IF DFHEIGDJ EQUAL 21
 15716         GO TO 3200-BUILD-ZERO-TRAILER
 15717         DEPENDING ON DFHEIGDI
 15718     ELSE IF DFHEIGDJ EQUAL 22
 15719         GO TO 9999-DFHBACK
 15720         DEPENDING ON DFHEIGDI
 15721     ELSE IF DFHEIGDJ EQUAL 23
 15722         GO TO 3290-NO-INSURED-ADDRESS
 15723         DEPENDING ON DFHEIGDI
 15724     ELSE IF DFHEIGDJ EQUAL 24
 15725         GO TO 3410-DUP-KEY
 15726         DEPENDING ON DFHEIGDI
 15727     ELSE IF DFHEIGDJ EQUAL 25
 15728         GO TO 3690-CERT-WRITTEN
 15729         DEPENDING ON DFHEIGDI
 15730     ELSE IF DFHEIGDJ EQUAL 26
 15731         GO TO 3850-CLAIM-MSTR-WRITTEN
 15732         DEPENDING ON DFHEIGDI
 15733     ELSE IF DFHEIGDJ EQUAL 27
 15734         GO TO 5050-CERT-NOT-FOUND
 15735         DEPENDING ON DFHEIGDI
 15736     ELSE IF DFHEIGDJ EQUAL 28
 15737         GO TO 5030-CERT-WRITTEN
 15738         DEPENDING ON DFHEIGDI
 15739     ELSE IF DFHEIGDJ EQUAL 29
 15740         GO TO 5035-CLAIM-WRITTEN
 15741         DEPENDING ON DFHEIGDI
 15742     ELSE IF DFHEIGDJ EQUAL 30
 15743         GO TO 9990-ABEND,
 15744               5799-EXIT
 15745         DEPENDING ON DFHEIGDI
 15746     ELSE IF DFHEIGDJ EQUAL 31
 15747         GO TO 3100-CARRIER-NOT-FOUND
 15748         DEPENDING ON DFHEIGDI
 15749     ELSE IF DFHEIGDJ EQUAL 32
 15750         GO TO 6040-NO-PROCESSOR-RECORD
 15751         DEPENDING ON DFHEIGDI
 15752     ELSE IF DFHEIGDJ EQUAL 33
 15753         GO TO 6060-NO-BENEFICIARY-RECORD
 15754         DEPENDING ON DFHEIGDI
 15755     ELSE IF DFHEIGDJ EQUAL 34
 15756         GO TO 6499-EXIT,
 15757               6499-EXIT
 15758         DEPENDING ON DFHEIGDI
 15759     ELSE IF DFHEIGDJ EQUAL 35
* Micro Focus Server Express         V5.1 revision 000 05-Feb-13 13:48 Page 305
* EL130.cbl
 15760         GO TO 6600-NOT-FOUND
 15761         DEPENDING ON DFHEIGDI
 15762     ELSE IF DFHEIGDJ EQUAL 36
 15763         GO TO 6700-NOTOPEN-ERROR,
 15764               6700-EXIT
 15765         DEPENDING ON DFHEIGDI
 15766     ELSE IF DFHEIGDJ EQUAL 37
 15767         GO TO 7120-NOT-FOUND
 15768         DEPENDING ON DFHEIGDI
 15769     ELSE IF DFHEIGDJ EQUAL 38
 15770         GO TO 7499-EXIT
 15771         DEPENDING ON DFHEIGDI
 15772     ELSE IF DFHEIGDJ EQUAL 39
 15773         GO TO 7500-EXIT,
 15774               7500-DUPLICATE-KEY,
 15775               7500-EXIT
 15776         DEPENDING ON DFHEIGDI
 15777     ELSE IF DFHEIGDJ EQUAL 40
 15778         GO TO 7500-END-BROWSE
 15779         DEPENDING ON DFHEIGDI
 15780     ELSE IF DFHEIGDJ EQUAL 41
 15781         GO TO 7630-END-BROWSE
 15782         DEPENDING ON DFHEIGDI
 15783     ELSE IF DFHEIGDJ EQUAL 42
 15784         GO TO 7799-EXIT,
 15785               7799-EXIT
 15786         DEPENDING ON DFHEIGDI
 15787     ELSE IF DFHEIGDJ EQUAL 43
 15788         GO TO 7790-END-BROWSE
 15789         DEPENDING ON DFHEIGDI
 15790     ELSE IF DFHEIGDJ EQUAL 44
 15791         GO TO 7992-NOT-FOUND
 15792         DEPENDING ON DFHEIGDI
 15793     ELSE IF DFHEIGDJ EQUAL 45
 15794         GO TO 8300-SEND-TEXT
 15795         DEPENDING ON DFHEIGDI.
 15796     MOVE '9%                    "   ' TO DFHEIV0
 15797     MOVE 'EL130' TO DFHEIV1
 15798     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15799     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       10512     Code:       48604
