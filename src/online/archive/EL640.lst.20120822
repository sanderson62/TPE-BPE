* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   1
* EL640.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL640.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL640.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL640.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 15:38:12.
     7*                            VMOD=2.040
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   2
* EL640.cbl
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22*
    23*REMARKS.    TRANSACTION - EXC1 - ACCOUNT BILLING.
    24*
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    34*                              ADJUSTED REDEFINES EL640AO FILLER
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 083104    2004083000002  PEMA PREVENT ONLINE BILLING
    37* 072105    2004120100002  PEMA FIX ONLINE BILLING FOR DCC SPP
    38* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    39******************************************************************
    40 ENVIRONMENT DIVISION.
    41
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   3
* EL640.cbl
    43 DATA DIVISION.
    44 WORKING-STORAGE SECTION.
    45 01  DFH-START PIC X(04).
    46 77  FILLER  PIC X(32)  VALUE '********************************'.
    47 77  FILLER  PIC X(32)  VALUE '*    EL640 WORKING STORAGE     *'.
    48 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.040 ************'.
    49 77  CNC-FACT                    PIC S999V9(7) COMP-3 VALUE +0.
    50 77  S1                          PIC S999 COMP-3 VALUE +0.
    51
    52*    COPY ELCSCTM.
    53******************************************************************
    54*                                                                *
    55*                                                                *
    56*                            ELCSCTM                             *
    57*                            VMOD=2.001                          *
    58*                                                                *
    59*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    60*                                                                *
    61******************************************************************
    62 01  SECURITY-MESSAGE.
    63     12  FILLER                          PIC X(30)
    64            VALUE '** LOGIC SECURITY VIOLATION -'.
    65     12  SM-READ                         PIC X(6).
    66     12  FILLER                          PIC X(5)
    67            VALUE ' PGM='.
    68     12  SM-PGM                          PIC X(6).
    69     12  FILLER                          PIC X(5)
    70            VALUE ' OPR='.
    71     12  SM-PROCESSOR-ID                 PIC X(4).
    72     12  FILLER                          PIC X(6)
    73            VALUE ' TERM='.
    74     12  SM-TERMID                       PIC X(4).
    75     12  FILLER                          PIC XX   VALUE SPACE.
    76     12  SM-JUL-DATE                     PIC 9(5).
    77     12  FILLER                          PIC X    VALUE SPACE.
    78     12  SM-TIME                         PIC 99.99.
    79
    80*    COPY ELCSCRTY.
    81******************************************************************
    82*                                                                *
    83*                                                                *
    84*                            ELCSCRTY                            *
    85*                            VMOD=2.001                          *
    86*                                                                *
    87*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    88*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    89*        SAVED IN PI-SECURITY-ADDRESS.                           *
    90*                                                                *
    91******************************************************************
    92 01  SECURITY-CONTROL.
    93     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    94     12  FILLER                       PIC XX    VALUE 'SC'.
    95     12  SC-CREDIT-CODES.
    96         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    97             20  SC-CREDIT-DISPLAY    PIC X.
    98             20  SC-CREDIT-UPDATE     PIC X.
    99     12  SC-CLAIMS-CODES.
   100         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   4
* EL640.cbl
   101             20  SC-CLAIMS-DISPLAY    PIC X.
   102             20  SC-CLAIMS-UPDATE     PIC X.
   103
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   5
* EL640.cbl
   105 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   106     88  RESP-NORMAL               VALUE +0.
   107     88  RESP-NOTFND               VALUE +13.
   108     88  RESP-NOTOPEN              VALUE +19.
   109     88  RESP-ENDFILE              VALUE +20.
   110
   111 01  STANDARD-AREAS.
   112     12  WS-AH-CATEGORY              PIC X       VALUE ' '.
   113     12  CLAS-LOOK                   PIC XX      VALUE '  '.
   114     12  SC-ITEM             PIC S9(4) COMP VALUE +1.
   115
   116     12  W-TRANSFER-CONTROL.
   117         16  WT-CR-CARRIER           PIC X     VALUE SPACES.
   118         16  WT-CR-GROUPING          PIC X(6)  VALUE SPACES.
   119         16  WT-CR-STATE             PIC XX    VALUE SPACES.
   120         16  WT-CR-ACCOUNT           PIC X(10) VALUE SPACES.
   121         16  WT-CR-FIN-RESP          PIC X(10) VALUE SPACES.
   122         16  WT-CR-TYPE              PIC X     VALUE SPACES.
   123
   124     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   125     12  MAP-NAME            PIC X(8)    VALUE 'EL640A'.
   126     12  MAPSET-NAME         PIC X(8)    VALUE 'EL640S'.
   127     12  SCREEN-NUMBER       PIC X(4)    VALUE '640A'.
   128     12  TRANS-ID            PIC X(4)    VALUE 'EXC1'.
   129     12  EL6311-TRANS-ID     PIC X(4)    VALUE 'EXB1'.
   130     12  EL633-TRANS-ID      PIC X(4)    VALUE 'EXB7'.
   131     12  EL633DMD-TRANS-ID   PIC X(4)    VALUE 'EX1F'.
   132     12  EL635-TRANS-ID      PIC X(4)    VALUE 'EXJ4'.
   133     12  EL650-TRANS-ID      PIC X(4)    VALUE 'EXC4'.
   134     12  EL652-TRANS-ID      PIC X(4)    VALUE 'EXD4'.
   135     12  EL658-TRANS-ID      PIC X(4)    VALUE 'EXJ3'.
   136     12  THIS-PGM            PIC X(8)    VALUE 'EL640'.
   137     12  EL640A              PIC X(8)    VALUE 'EL640A'.
   138     12  EL640B              PIC X(8)    VALUE 'EL640B'.
   139     12  PGM-NAME            PIC X(8).
   140     12  TIME-IN             PIC S9(7).
   141     12  TIME-OUT-R  REDEFINES TIME-IN.
   142         16  FILLER          PIC X.
   143         16  TIME-OUT        PIC 99V99.
   144         16  FILLER          PIC XX.
   145
   146     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   147     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   148     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   149     12  XCTL-633            PIC X(8)    VALUE 'EL633'.
   150     12  XCTL-633DMD         PIC X(8)    VALUE 'EL633DMD'.
   151     12  XCTL-635            PIC X(8)    VALUE 'EL635'.
   152     12  XCTL-PYAJ           PIC X(8)    VALUE 'EL633'.
   153     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   154     12  XCTL-652            PIC X(8)    VALUE 'EL652'.
   155     12  XCTL-658            PIC X(8)    VALUE 'EL658'.
   156     12  XCTL-6401           PIC X(8)    VALUE 'EL6401'.
   157     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   158     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   159     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   160     12  ERPNDB-ALT-FILE-ID  PIC X(8)    VALUE 'ERPNDB2'.
   161     12  ERPNDB-FILE-ID      PIC X(8)    VALUE 'ERPNDB'.
   162     12  ELCNTL-FILE-ID      PIC X(8)    VALUE 'ELCNTL'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   6
* EL640.cbl
   163     12  ELLETR-FILE-ID      PIC X(8)    VALUE 'ELLETR'.
   164     12  ERCOMP-FILE-ID      PIC X(8)    VALUE 'ERCOMP'.
   165     12  ERPYAJ-FILE-ID      PIC X(8)    VALUE 'ERPYAJ'.
   166     12  ERACCT-ALT-FILE-ID  PIC X(8)    VALUE 'ERACCT2'.
   167     12  ERACCT-FILE-ID      PIC X(8)    VALUE 'ERACCT'.
   168     12  ERBILL-FILE-ID      PIC X(8)    VALUE 'ERBILL'.
   169     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   170     12  QID.
   171         16  QID-TERM        PIC X(4).
   172         16  FILLER          PIC X(4)    VALUE '640A'.
   173     12  CLIENT-ITY          PIC XXX     VALUE 'ITY'.
   174
   175 01  WORK-AREA.
   176     12  W-LETTER-IND            PIC X     VALUE SPACE.
   177         88  W-LETTER-NOT-FOUND    VALUE 'Y'.
   178     12  FIRST-TIME-SW           PIC X     VALUE 'Y'.
   179         88  FIRST-TIME            VALUE 'Y'.
   180     12  C-RECORD-FOUND-SW       PIC X     VALUE 'Y'.
   181         88  C-RECORD-FOUND        VALUE 'Y'.
   182     12  ACCOUNT-FIN-RESP-SW     PIC X     VALUE ' '.
   183         88  ACCOUNT-FIN-RESP      VALUE 'Y'.
   184         88  ACCOUNT-NOT-FIN-RESP  VALUE 'N'.
   185     12  VALID-BILL-TYPE-VALUES  PIC X     VALUE SPACE.
   186         88  VALID-BILL-TYPE       VALUE  '1' '2'.
   187*        88  VALID-BILL-TYPE       VALUE  '1' '2' '3' '4' '5'.
   188     12  BILL-BATCH-TRAILER-SW   PIC X     VALUE SPACE.
   189         88  BILL-BATCH-TRAILER    VALUE 'Y'.
   190     12  PNDB-EOF-SW             PIC X     VALUE SPACE.
   191         88  PNDB-EOF              VALUE 'Y'.
   192     12  PYAJ-EOF-SW             PIC X     VALUE SPACE.
   193         88  PYAJ-EOF              VALUE 'Y'.
   194     12  COMP-UPDATE-SW          PIC X     VALUE SPACE.
   195         88  UPDATE-COMP-TOTALS    VALUE 'Y'.
   196     12  LIMIT-BILLING-SW        PIC X     VALUE SPACE.
   197         88  LIMIT-BILLING         VALUE 'Y'.
   198     12  WS-PROCESS-SW           PIC X     VALUE SPACE.
   199         88  DO-NOT-BILL-THIS-ACCT VALUE 'Y'.
   200     12  WS-CHARGEBACK-LF-SW     PIC X     VALUE SPACE.
   201         88  CHARGEBACK-CAN-LF     VALUE 'Y'.
   202         88  NO-CHARGEBACK-LF      VALUE 'N'.
   203     12  WS-CHARGEBACK-AH-SW     PIC X     VALUE SPACE.
   204         88  CHARGEBACK-CAN-AH     VALUE 'Y'.
   205         88  NO-CHARGEBACK-AH      VALUE 'N'.
   206     12  NO-BILL-REC-SW          PIC X     VALUE SPACE.
   207         88  NO-BILL-RECS          VALUE 'Y'.
   208     12  DATA-VOIDED-SW          PIC X     VALUE SPACE.
   209         88  DATA-VOIDED           VALUE 'Y'.
   210     12  BATCHES-PROCESSED-SW    PIC X     VALUE SPACE.
   211         88  MORE-THAN-6-BATCHES   VALUE 'Y'.
   212     12  BILLING-DETAIL-TYPE     PIC XX    VALUE SPACES.
   213         88  TOTAL-STATEMENT       VALUE 'TS'.
   214         88  BILLING-DETAIL        VALUE 'BD'.
   215         88  CARRIER-ADDRESS       VALUE 'CA'.
   216         88  GEN-AGT-ADDRESS       VALUE 'GA'.
   217     12  ELCNTL-UPDATE-SW        PIC X     VALUE SPACE.
   218         88  ELCNTL-UPDATE         VALUE 'Y'.
   219     12  WS-ENTERED-FROM-MAP     PIC X     VALUE 'A'.
   220         88  WS-ENTERED-FROM-A     VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   7
* EL640.cbl
   221
   222     12  ACCOM-SUB               PIC 99    VALUE ZEROS.
   223     12  SUB                     PIC S999  COMP-3  VALUE ZEROS.
   224
   225     12  WORK-ZIP                PIC 9(9)  VALUE ZEROS.
   226     12  WORK-ZIPR1 REDEFINES WORK-ZIP.
   227         16  WORK-ZIPR1-4        PIC 9(4).
   228         16  WORK-ZIPR1-5        PIC 9(5).
   229     12  WORK-ZIPR2 REDEFINES WORK-ZIP.
   230         16  WORK-ZIPR2-5        PIC 9(5).
   231         16  WORK-ZIPR2-4        PIC 9(4).
   232     12  WS-AM-ZIP.
   233         16  WS-AM-ZIP-PRIME     PIC X(5).
   234         16  WS-AM-ZIP-DASH      PIC X.
   235         16  WS-AM-ZIP-PLUS4     PIC X(4).
   236     12  WS-AM-CANADIAN-ZIP  REDEFINES  WS-AM-ZIP.
   237         16  WS-AM-CAN-POST-1    PIC XXX.
   238         16  FILLER              PIC X.
   239         16  WS-AM-CAN-POST-2    PIC XXX.
   240         16  FILLER              PIC XXX.
   241     12  WS-CF-ZIP.
   242         16  WS-CF-ZIP-PRIME     PIC X(5) VALUE SPACES.
   243         16  WS-CF-ZIP-DASH      PIC X    VALUE SPACES.
   244         16  WS-CF-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   245     12  WS-CF-CANADIAN-ZIP  REDEFINES  WS-CF-ZIP.
   246         16  WS-CF-CAN-POST-1    PIC XXX.
   247         16  FILLER              PIC X.
   248         16  WS-CF-CAN-POST-2    PIC XXX.
   249         16  FILLER              PIC XXX.
   250     12  WS-CO-ZIP.
   251         16  WS-CO-ZIP-PRIME     PIC X(5) VALUE SPACES.
   252         16  WS-CO-ZIP-DASH      PIC X    VALUE SPACES.
   253         16  WS-CO-ZIP-PLUS4     PIC X(4) VALUE SPACES.
   254     12  WS-CO-CANADIAN-ZIP  REDEFINES  WS-CO-ZIP.
   255         16  WS-CO-CAN-POST-1    PIC XXX.
   256         16  FILLER              PIC X.
   257         16  WS-CO-CAN-POST-2    PIC XXX.
   258         16  FILLER              PIC XXX.
   259
   260     12  WORK-SEQ-NO             PIC S9(9)   COMP-3 VALUE +0.
   261     12  WS-ERROR-MSG.
   262         16  WS-ERROR-TEXT       PIC X(35) VALUE SPACES.
   263         16  WS-ERROR-BATCH      PIC X(6)  VALUE SPACES.
   264         16  FILLER              PIC X(24) VALUE SPACES.
   265     12  WS-WORK-DATE.
   266         16  WS-MONTH            PIC 99    VALUE ZEROS.
   267         16  WS-DAY              PIC 99    VALUE ZEROS.
   268         16  WS-YEAR             PIC 99    VALUE ZEROS.
   269     12  WS-MONTH-END-DATE.
   270         16  WS-ME-YEAR          PIC 99    VALUE ZEROS.
   271         16  WS-ME-MONTH         PIC 99    VALUE ZEROS.
   272         16  WS-ME-DAY           PIC 99    VALUE ZEROS.
   273     12  WS-CURRENT-DATE         PIC XX    VALUE SPACES.
   274     12  WS-CURRENT-DATE-MDY     PIC X(6)  VALUE SPACES.
   275     12  WS-CURRENT-DATE-EDIT    PIC X(8)  VALUE SPACES.
   276     12  WS-PREV-BILL-DATE       PIC XX    VALUE LOW-VALUES.
   277     12  WS-BEGIN-DATE.
   278         16  FILLER              PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   8
* EL640.cbl
   279         16  WS-BEGIN-DAY        PIC XX    VALUE SPACES.
   280         16  FILLER              PIC X(3)  VALUE SPACES.
   281     12  PRINT-CONTROL.
   282         16  SINGLE-SPACE        PIC X     VALUE SPACE.
   283         16  DOUBLE-SPACE        PIC X     VALUE ZERO.
   284         16  TRIPLE-SPACE        PIC X     VALUE '-'.
   285         16  SUPPRESS-SPACE      PIC X     VALUE '+'.
   286         16  TOP-OF-PAGE         PIC X     VALUE '1'.
   287     12  WS-EXP-DATE.
   288         16  WS-SAV-EXP-DT     OCCURS 10 TIMES
   289                               INDEXED BY DTNDX  PIC XX.
   290     12  WS-REMIT-TO.
   291         16  WS-SAV-REMIT-TO   OCCURS 10 TIMES
   292                               INDEXED BY RTNDX  PIC X(10).
   293     12  WORK-REMIT-TO           PIC X(10) VALUE SPACES.
   294     12  WS-REMITTED             PIC S9(6)V99 VALUE ZEROS.
   295     12  WS-LINECTR              PIC 99    VALUE ZEROS.
   296     12  WS-PGECTR               PIC 999   VALUE 1.
   297     12  WS-LINE-SEQ-NO          PIC S9(4) COMP VALUE +1.
   298     12  WS-CARR-COMP.
   299         16  WS-CARRIER          PIC X     VALUE SPACE.
   300         16  WS-COMP             PIC X(6)  VALUE SPACES.
   301
   302     12  REPORT-TOTALS.
   303         16  TOT-REPT-LF-PREM    PIC S9(7)V99   VALUE ZEROS.
   304         16  TOT-REPT-LF-REF     PIC S9(7)V99   VALUE ZEROS.
   305         16  TOT-REPT-LF-COMP    PIC S9(7)V99   VALUE ZEROS.
   306         16  TOT-REPT-LF-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   307         16  TOT-REPT-AH-PREM    PIC S9(7)V99   VALUE ZEROS.
   308         16  TOT-REPT-AH-REF     PIC S9(7)V99   VALUE ZEROS.
   309         16  TOT-REPT-AH-COMP    PIC S9(7)V99   VALUE ZEROS.
   310         16  TOT-REPT-AH-COMP-R  PIC S9(7)V99   VALUE ZEROS.
   311         16  TOT-LF-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   312         16  TOT-AH-REPT-FACE-AMT   PIC S9(7)V99   VALUE ZEROS.
   313         16  TOT-REPT-PREM       PIC S9(7)V99   VALUE ZEROS.
   314         16  TOT-REPT-CANCEL-FEE PIC S9(7)V99   VALUE ZEROS.
   315     12  WORK-AMT                PIC S9(7)V99   VALUE ZEROS.
   316     12  WORK-CHECK-AMT          PIC S9(7)V99   VALUE ZEROS.
   317     12  WORK-CANCEL-FEE         PIC S9(7)V99   VALUE ZEROS.
   318     12  WS-I-LF-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   319     12  WS-I-LF-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   320     12  WS-I-AH-PREMIUM-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   321     12  WS-I-AH-BENEFIT-AMT     PIC S9(7)V99   COMP-3 VALUE +0.
   322     12  WS-C-LF-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   323     12  WS-C-AH-CANCEL-AMT      PIC S9(5)V99   COMP-3 VALUE +0.
   324     12  WS-C-CANCEL-FEE         PIC S9(5)V99   COMP-3 VALUE +0.
   325     12  WS-LF-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   326     12  WS-AH-CAN-COMP          PIC S9(6)V99   COMP-3 VALUE +0.
   327     12  WS-PAY-ADJ              PIC S9(6)V99   COMP-3 VALUE +0.
   328     12  WS-CI-LIFE-BENEFIT      PIC S9(7)V99   COMP-3 VALUE +0.
   329     12  LF-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   330     12  JT-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   331     12  AH-COMM-TBL-NO          PIC X(3)       VALUE SPACES.
   332     12  AGENT-OWES              PIC X(18)
   333                         VALUE 'AGENT OWES       ='.
   334     12  OWED-TO-AGENT           PIC X(18)
   335                         VALUE 'OWED TO AGENT    ='.
   336     12  WS-PY-ENTRY-COMMENT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page   9
* EL640.cbl
   337         16  WS-PY-CURRENT-DATE      PIC X(6) VALUE SPACES.
   338         16  FILLER                  PIC X(14) VALUE
   339             ' CHK TO AGENT'.
   340
   341     12  WS-ITY-COMMENT.
   342         16  WS-PY-BEGIN-DT          PIC X(8) VALUE SPACES.
   343         16  FILLER                  PIC X(06) VALUE
   344             ' THRU '.
   345         16  WS-PY-END-DT            PIC X(8) VALUE SPACES.
   346
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  10
* EL640.cbl
   348     12  WS-ACCT-ADDR-AREA.
   349         16  WS-ACCT-LINES OCCURS 6 TIMES INDEXED BY A-INDX.
   350           18  WS-ACCT-ZIP           PIC X(10) VALUE SPACES.
   351           18  FILLER                PIC X(10) VALUE SPACES.
   352           18  WS-A-LAST-ZIP         PIC X(10) VALUE SPACES.
   353
   354     12  WS-REMIT-ADDR-AREA.
   355         16  WS-REMIT-ACCT           PIC X(10) VALUE SPACES.
   356         16  WS-REMIT-LINES OCCURS 6 TIMES INDEXED BY R-INDX.
   357           18  WS-REMIT-ZIP          PIC X(10) VALUE SPACES.
   358           18  FILLER                PIC X(10) VALUE SPACES.
   359           18  WS-R-LAST-ZIP         PIC X(10) VALUE SPACES.
   360
   361     12  WS-EFFECT-DATE.
   362         16  WS-EFFECT-YR            PIC 99 VALUE ZEROS.
   363         16  WS-EFFECT-MO            PIC 99 VALUE ZEROS.
   364         16  WS-EFFECT-DA            PIC 99 VALUE ZEROS.
   365
   366     12  WS-LIFE-CANCEL-DT.
   367         16  WS-LF-CANCEL-YR         PIC 99 VALUE ZEROS.
   368         16  WS-LF-CANCEL-MO         PIC 99 VALUE ZEROS.
   369         16  WS-LF-CANCEL-DA         PIC 99 VALUE ZEROS.
   370
   371     12  WS-AH-CANCEL-DT.
   372         16  WS-AH-CANCEL-YR         PIC 99 VALUE ZEROS.
   373         16  WS-AH-CANCEL-MO         PIC 99 VALUE ZEROS.
   374         16  WS-AH-CANCEL-DA         PIC 99 VALUE ZEROS.
   375
   376     12  MONTHS-DIFF-LF            PIC S9(05)  VALUE ZEROS.
   377     12  MONTHS-DIFF-AH            PIC S9(05)  VALUE ZEROS.
   378
   379     12  WS-BENEFIT.
   380         16  FILLER                PIC X   VALUE SPACES.
   381         16  WS-BENE-CD            PIC XX  VALUE SPACES.
   382
   383     12  WS-DESC.
   384         16 WS-BATCH-DESC        PIC X(10) VALUE SPACES.
   385         16 WS-BATCH-NBR         PIC X(6)  VALUE SPACES.
   386         16 FILLER               PIC X(4)  VALUE SPACES.
   387     12  WS-NON-PREM             PIC S9(7)V99   COMP-3.
   388     12  WS-NON-COMM             PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  11
* EL640.cbl
   390 01  ACCESS-KEYS.
   391     12  ERPNDB-PRIME-KEY.
   392         16  ERPNDB-CO-CD        PIC X     VALUE SPACES.
   393         16  ERPNDB-BATCH        PIC X(6)  VALUE SPACES.
   394         16  ERPNDB-SEQ-NO       PIC S9(4) COMP VALUE +0.
   395         16  ERPNDB-CHG-SEQ-NO   PIC S9(4) COMP VALUE +0.
   396
   397     12  ERPNDB-LENGTH           PIC S9(4) COMP VALUE +585.
   398
   399     12  ERPNDB-ALT-KEY.
   400         16  ERPNDB-CO-CD-A1     PIC X     VALUE SPACES.
   401         16  ERPNDB-CARR         PIC X     VALUE SPACES.
   402         16  ERPNDB-GROUP        PIC X(6)  VALUE SPACES.
   403         16  ERPNDB-STATE        PIC XX    VALUE SPACES.
   404         16  ERPNDB-ACCT         PIC X(10) VALUE SPACES.
   405         16  ERPNDB-EFF-DT       PIC XX    VALUE SPACES.
   406         16  ERPNDB-CERT.
   407             20  ERPNDB-CERT-PRM PIC X(10) VALUE SPACES.
   408             20  ERPNDB-CERTSFX  PIC X     VALUE SPACES.
   409         16  ERPNDB-ACHG-SEQ-NO  PIC S9(4) COMP.
   410         16  ERPNDB-REC-TYPE     PIC X     VALUE SPACES.
   411
   412     12  ELCNTL-KEY.
   413         16  ELCNTL-COMPANY-ID   PIC XXX   VALUE SPACES.
   414         16  ELCNTL-REC-TYPE     PIC X     VALUE SPACES.
   415         16  ELCNTL-ACCESS.
   416             20  ELCNTL-FILLER   PIC X(3)  VALUE SPACES.
   417             20  ELCNTL-CARRIER  PIC X     VALUE SPACES.
   418         16  ELCNTL-SEQ-NO       PIC S9(4) COMP VALUE ZEROS.
   419
   420     12  ELCNTL-LENGTH           PIC S9(4) COMP VALUE +504.
   421
   422     12  ERCOMP-KEY.
   423         16  ERCOMP-COMP-CD      PIC X     VALUE SPACE.
   424         16  ERCOMP-CARRIER      PIC X     VALUE SPACES.
   425         16  ERCOMP-GROUPING     PIC X(6)  VALUE SPACES.
   426         16  ERCOMP-FIN-RESP     PIC X(10) VALUE SPACES.
   427         16  ERCOMP-ACCT         PIC X(10) VALUE SPACES.
   428         16  ERCOMP-RECORD-TYPE  PIC X     VALUE SPACES.
   429
   430     12  ERPYAJ-BROWSE-COMP-KEY.
   431         16  ERPYAJ-BR-COMP-CD   PIC X     VALUE SPACE.
   432         16  ERPYAJ-BR-CARRIER   PIC X     VALUE SPACES.
   433         16  ERPYAJ-BR-GROUPING  PIC X(6)  VALUE SPACES.
   434         16  ERPYAJ-BR-FIN-RESP  PIC X(10) VALUE SPACES.
   435         16  ERPYAJ-BR-ACCOUNT   PIC X(10) VALUE SPACES.
   436
   437     12  ERCOMP-LENGTH           PIC S9(4) COMP VALUE +700.
   438
   439     12  ERPYAJ-KEY.
   440         16  ERPYAJ-COMP-CD      PIC X     VALUE SPACE.
   441         16  ERPYAJ-CARRIER      PIC X     VALUE SPACES.
   442         16  ERPYAJ-GROUPING     PIC X(6)  VALUE SPACES.
   443         16  ERPYAJ-FIN-RESP     PIC X(10) VALUE SPACES.
   444         16  ERPYAJ-ACCOUNT      PIC X(10) VALUE SPACES.
   445         16  ERPYAJ-FILE-SEQ-NO  PIC S9(8) VALUE +0 COMP.
   446         16  ERPYAJ-RECORD-TYPE  PIC X     VALUE SPACES.
   447
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  12
* EL640.cbl
   448     12  ERPYAJ-LENGTH           PIC S9(4) COMP VALUE +200.
   449
   450     12  ERACCT-PRIME-KEY.
   451         16  ERACCT-P-CO-CD      PIC X     VALUE SPACES.
   452         16  ERACCT-P-CARRIER    PIC X     VALUE SPACES.
   453         16  ERACCT-P-GROUPING   PIC X(6)  VALUE SPACES.
   454         16  ERACCT-P-STATE      PIC XX    VALUE SPACES.
   455         16  ERACCT-P-ACCOUNT    PIC X(10) VALUE SPACES.
   456         16  ERACCT-P-EXP-DATE   PIC XX    VALUE SPACES.
   457         16  FILLER              PIC X(4)  VALUE SPACES.
   458
   459     12  ERACCT-LENGTH           PIC S9(4) COMP VALUE +2000.
   460
   461     12  ERACCT-ALT-KEY.
   462         16  ERACCT-A-CO-CD      PIC X     VALUE SPACES.
   463         16  ERACCT-A-CARRIER    PIC X     VALUE SPACES.
   464         16  ERACCT-A-GROUPING   PIC X(6)  VALUE SPACES.
   465         16  ERACCT-A-STATE      PIC XX    VALUE SPACES.
   466         16  ERACCT-A-ACCOUNT    PIC X(10) VALUE SPACES.
   467         16  ERACCT-A-EXP-DATE   PIC XX    VALUE SPACES.
   468         16  FILLER              PIC X(4)  VALUE SPACES.
   469
   470     12  ERBILL-KEY.
   471         16  ERBILL-CO-CD        PIC X.
   472         16  ERBILL-CARRIER      PIC X.
   473         16  ERBILL-GROUP        PIC X(6).
   474         16  ERBILL-ACCT         PIC X(10).
   475         16  ERBILL-FIN-RESP     PIC X(10).
   476         16  ERBILL-REC-TYPE     PIC X.
   477         16  ERBILL-LINE-SEQ-NO  PIC S9(4) COMP.
   478
   479     12  ERBILL-LENGTH           PIC S9(4) COMP VALUE +210.
   480
   481     12  ELLETR-KEY.
   482         16  ELLETR-COMPANY-CD   PIC  X      VALUE SPACE.
   483         16  ELLETR-FORM-NO      PIC  X(12)  VALUE SPACES.
   484         16  ELLETR-LINE-SEQ     PIC S9(04)  VALUE +0 COMP.
   485
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  13
* EL640.cbl
   487
   488 01  ERROR-NUMBERS.
   489     12  ER-0004                 PIC X(4)  VALUE '0004'.
   490     12  ER-0008                 PIC X(4)  VALUE '0008'.
   491     12  ER-0013                 PIC X(4)  VALUE '0013'.
   492     12  ER-0022                 PIC X(4)  VALUE '0022'.
   493     12  ER-0029                 PIC X(4)  VALUE '0029'.
   494     12  ER-0070                 PIC X(4)  VALUE '0070'.
   495     12  ER-0194                 PIC X(4)  VALUE '0194'.
   496     12  ER-0195                 PIC X(4)  VALUE '0195'.
   497     12  ER-0196                 PIC X(4)  VALUE '0196'.
   498     12  ER-0197                 PIC X(4)  VALUE '0197'.
   499     12  ER-2208                 PIC X(4)  VALUE '2208'.
   500     12  ER-2210                 PIC X(4)  VALUE '2210'.
   501     12  ER-2212                 PIC X(4)  VALUE '2212'.
   502     12  ER-2215                 PIC X(4)  VALUE '2215'.
   503     12  ER-2230                 PIC X(4)  VALUE '2230'.
   504     12  ER-2233                 PIC X(4)  VALUE '2233'.
   505     12  ER-2249                 PIC X(4)  VALUE '2249'.
   506     12  ER-2250                 PIC X(4)  VALUE '2250'.
   507     12  ER-2370                 PIC X(4)  VALUE '2370'.
   508     12  ER-2371                 PIC X(4)  VALUE '2371'.
   509     12  ER-2383                 PIC X(4)  VALUE '2383'.
   510     12  ER-2385                 PIC X(4)  VALUE '2385'.
   511     12  ER-2401                 PIC X(4)  VALUE '2401'.
   512     12  ER-2403                 PIC X(4)  VALUE '2403'.
   513     12  ER-2404                 PIC X(4)  VALUE '2404'.
   514     12  ER-2405                 PIC X(4)  VALUE '2405'.
   515     12  ER-2406                 PIC X(4)  VALUE '2406'.
   516     12  ER-2407                 PIC X(4)  VALUE '2407'.
   517     12  ER-2408                 PIC X(4)  VALUE '2408'.
   518     12  ER-2409                 PIC X(4)  VALUE '2409'.
   519     12  ER-2411                 PIC X(4)  VALUE '2411'.
   520     12  ER-2421                 PIC X(4)  VALUE '2421'.
   521     12  ER-2434                 PIC X(4)  VALUE '2434'.
   522     12  ER-2435                 PIC X(4)  VALUE '2435'.
   523     12  ER-2436                 PIC X(4)  VALUE '2436'.
   524     12  ER-2438                 PIC X(4)  VALUE '2438'.
   525     12  ER-2439                 PIC X(4)  VALUE '2439'.
   526     12  ER-2443                 PIC X(4)  VALUE '2443'.
   527     12  ER-2472                 PIC X(4)  VALUE '2472'.
   528     12  ER-2539                 PIC X(4)  VALUE '2539'.
   529     12  ER-2564                 PIC X(4)  VALUE '2564'.
   530     12  ER-2570                 PIC X(4)  VALUE '2570'.
   531     12  ER-2571                 PIC X(4)  VALUE '2571'.
   532     12  ER-2597                 PIC X(4)  VALUE '2597'.
   533     12  ER-3145                 PIC X(4)  VALUE '3145'.
   534     12  ER-3165                 PIC X(4)  VALUE '3165'.
   535     12  ER-3188                 PIC X(4)  VALUE '3188'.
   536     12  ER-7389                 PIC X(4)  VALUE '7389'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  14
* EL640.cbl
   538 01  BI-REPORT-HEADINGS.
   539     12  BI-PREVIEW-HD.
   540         16  FILLER          PIC X(42)           VALUE SPACES.
   541         16  FILLER          PIC X(47)           VALUE
   542                '**** STATEMENT IS FOR REVIEW PURPOSES ONLY ****'.
   543         16  FILLER          PIC X(43)           VALUE SPACES.
   544
   545     12  BI-HD1.
   546         16  FILLER          PIC X(44)           VALUE SPACES.
   547         16  FILLER          PIC X(44)           VALUE
   548                 '  CREDIT LIFE, ACCIDENT & HEALTH STATEMENT  '.
   549         16  FILLER          PIC X(36)           VALUE SPACES.
   550         16  FILLER          PIC X(8)            VALUE ' EL640 '.
   551
   552     12  BI-HD2.
   553         16  FILLER          PIC X(51)           VALUE SPACES.
   554         16  BI-HD-CO        PIC X(30).
   555         16  FILLER          PIC X(43)           VALUE SPACES.
   556         16  BI-HD-RUN-DT    PIC X(8)            VALUE SPACES.
   557
   558     12  BI-HD3.
   559         16  FILLER          PIC X(57)           VALUE SPACES.
   560         16  BI-HD-BILL-DT   PIC X(18).
   561         16  FILLER          PIC X(37)           VALUE SPACES.
   562         16  FILLER          PIC X(5)            VALUE 'PAGE'.
   563         16  BI-HD-PG        PIC ZZ,ZZ9.
   564
   565     12  BI-HD4.
   566         16  FILLER          PIC  X(44)      VALUE
   567             '                               CERTIFICATE  '.
   568         16  FILLER          PIC  X(44)      VALUE
   569             'EFFECTIVE   CANCEL       BEN.      WRITTEN  '.
   570         12  FILLER          PIC  X(44)      VALUE
   571             '    COMP.                    FACE AMOUNT /  '.
   572
   573     12  BI-HD5.
   574         16  FILLER          PIC  X(44)      VALUE
   575             '       NAME OF INSURED            NUMBER    '.
   576         16  FILLER          PIC  X(44)      VALUE
   577             '  DATE       DATE   TERM TYPE      PREMIUM  '.
   578         16  FILLER          PIC  X(44)      VALUE
   579             '     PCT.    COMPENSATION        BENEFIT    '.
   580
   581     12  BI-HD6.
   582         16  FILLER          PIC  X(44)      VALUE SPACES.
   583         16  FILLER          PIC  X(37)      VALUE SPACES.
   584         16  FILLER          PIC  X(45)      VALUE
   585             '     PROCESSED                  NON-PROCESSED'.
   586         16  FILLER          PIC  X(07)      VALUE SPACES.
   587     12  BI-HD7.
   588         16  FILLER          PIC  X(44)      VALUE SPACES.
   589         16  FILLER          PIC  X(35)      VALUE SPACES.
   590         16  FILLER          PIC  X(45)      VALUE
   591             ' PREMIUM     COMMISSION        PREMIUM     CO'.
   592         16  FILLER          PIC  X(09)      VALUE
   593             'MMISSION'.
   594
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  15
* EL640.cbl
   596
   597*                            COPY ELCDATE.
   598******************************************************************
   599*                                                                *
   600*                                                                *
   601*                            ELCDATE.                            *
   602*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   603*                            VMOD=2.003
   604*                                                                *
   605*                                                                *
   606*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   607*                 LENGTH = 200                                   *
   608******************************************************************
   609
   610 01  DATE-CONVERSION-DATA.
   611     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   612     12  DC-OPTION-CODE                PIC X.
   613         88  BIN-TO-GREG                VALUE ' '.
   614         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   615         88  EDIT-GREG-TO-BIN           VALUE '2'.
   616         88  YMD-GREG-TO-BIN            VALUE '3'.
   617         88  MDY-GREG-TO-BIN            VALUE '4'.
   618         88  JULIAN-TO-BIN              VALUE '5'.
   619         88  BIN-PLUS-ELAPSED           VALUE '6'.
   620         88  FIND-CENTURY               VALUE '7'.
   621         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   622         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   623         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   624         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   625         88  JULIAN-TO-BIN-3            VALUE 'C'.
   626         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   627         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   628         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   629         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   630         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   631         88  CHECK-LEAP-YEAR            VALUE 'H'.
   632         88  BIN-3-TO-GREG              VALUE 'I'.
   633         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   634         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   635         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   636         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   637         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   638         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   639         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   640         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   641         88  THREE-CHARACTER-BIN
   642                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   643         88  GREGORIAN-TO-BIN
   644                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   645         88  BIN-TO-GREGORIAN
   646                  VALUES ' ' '1' 'I' '8' 'G'.
   647         88  JULIAN-TO-BINARY
   648                  VALUES '5' 'C' 'E' 'F'.
   649     12  DC-ERROR-CODE                 PIC X.
   650         88  NO-CONVERSION-ERROR        VALUE ' '.
   651         88  DATE-CONVERSION-ERROR
   652                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   653         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  16
* EL640.cbl
   654         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   655         88  DATE-IS-INVALID            VALUE '3'.
   656         88  DATE1-GREATER-DATE2        VALUE '4'.
   657         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   658         88  DATE-INVALID-OPTION        VALUE '9'.
   659         88  INVALID-CENTURY            VALUE 'A'.
   660         88  ONLY-CENTURY               VALUE 'B'.
   661         88  ONLY-LEAP-YEAR             VALUE 'C'.
   662         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   663     12  DC-END-OF-MONTH               PIC X.
   664         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   665     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   666         88  USE-NORMAL-PROCESS         VALUE ' '.
   667         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   668         88  ADJUST-UP-100-YRS          VALUE '2'.
   669     12  FILLER                        PIC X.
   670     12  DC-CONVERSION-DATES.
   671         16  DC-BIN-DATE-1             PIC XX.
   672         16  DC-BIN-DATE-2             PIC XX.
   673         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   674         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   675                       DC-GREG-DATE-1-EDIT.
   676             20  DC-EDIT1-MONTH        PIC 99.
   677             20  SLASH1-1              PIC X.
   678             20  DC-EDIT1-DAY          PIC 99.
   679             20  SLASH1-2              PIC X.
   680             20  DC-EDIT1-YEAR         PIC 99.
   681         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   682         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   683                     DC-GREG-DATE-2-EDIT.
   684             20  DC-EDIT2-MONTH        PIC 99.
   685             20  SLASH2-1              PIC X.
   686             20  DC-EDIT2-DAY          PIC 99.
   687             20  SLASH2-2              PIC X.
   688             20  DC-EDIT2-YEAR         PIC 99.
   689         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   690         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   691                     DC-GREG-DATE-1-YMD.
   692             20  DC-YMD-YEAR           PIC 99.
   693             20  DC-YMD-MONTH          PIC 99.
   694             20  DC-YMD-DAY            PIC 99.
   695         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   696         16  DC-GREG-DATE-1-MDY-R REDEFINES
   697                      DC-GREG-DATE-1-MDY.
   698             20  DC-MDY-MONTH          PIC 99.
   699             20  DC-MDY-DAY            PIC 99.
   700             20  DC-MDY-YEAR           PIC 99.
   701         16  DC-GREG-DATE-1-ALPHA.
   702             20  DC-ALPHA-MONTH        PIC X(10).
   703             20  DC-ALPHA-DAY          PIC 99.
   704             20  FILLER                PIC XX.
   705             20  DC-ALPHA-CENTURY.
   706                 24 DC-ALPHA-CEN-N     PIC 99.
   707             20  DC-ALPHA-YEAR         PIC 99.
   708         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   709         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   710         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   711         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  17
* EL640.cbl
   712         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   713                                       PIC 9(05).
   714         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   715             20  DC-JULIAN-YEAR        PIC 99.
   716             20  DC-JULIAN-DAYS        PIC 999.
   717         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   718         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   719         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   720     12  DATE-CONVERSION-VARIBLES.
   721         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   722         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   723             20  FILLER                PIC 9(3).
   724             20  HOLD-CEN-1-CCYY.
   725                 24  HOLD-CEN-1-CC     PIC 99.
   726                 24  HOLD-CEN-1-YY     PIC 99.
   727             20  HOLD-CEN-1-MO         PIC 99.
   728             20  HOLD-CEN-1-DA         PIC 99.
   729         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   730             20  HOLD-CEN-1-R-MO       PIC 99.
   731             20  HOLD-CEN-1-R-DA       PIC 99.
   732             20  HOLD-CEN-1-R-CCYY.
   733                 24  HOLD-CEN-1-R-CC   PIC 99.
   734                 24  HOLD-CEN-1-R-YY   PIC 99.
   735             20  FILLER                PIC 9(3).
   736         16  HOLD-CENTURY-1-X.
   737             20  FILLER                PIC X(3)  VALUE SPACES.
   738             20  HOLD-CEN-1-X-CCYY.
   739                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   740                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   741             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   742             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   743         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   744             20  HOLD-CEN-1-R-X-MO     PIC XX.
   745             20  HOLD-CEN-1-R-X-DA     PIC XX.
   746             20  HOLD-CEN-1-R-X-CCYY.
   747                 24  HOLD-CEN-1-R-X-CC PIC XX.
   748                 24  HOLD-CEN-1-R-X-YY PIC XX.
   749             20  FILLER                PIC XXX.
   750         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   751         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   752         16  DC-JULIAN-DATE-1          PIC 9(07).
   753         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   754             20  DC-JULIAN-1-CCYY.
   755                 24  DC-JULIAN-1-CC    PIC 99.
   756                 24  DC-JULIAN-1-YR    PIC 99.
   757             20  DC-JULIAN-DA-1        PIC 999.
   758         16  DC-JULIAN-DATE-2          PIC 9(07).
   759         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   760             20  DC-JULIAN-2-CCYY.
   761                 24  DC-JULIAN-2-CC    PIC 99.
   762                 24  DC-JULIAN-2-YR    PIC 99.
   763             20  DC-JULIAN-DA-2        PIC 999.
   764         16  DC-GREG-DATE-A-EDIT.
   765             20  DC-EDITA-MONTH        PIC 99.
   766             20  SLASHA-1              PIC X VALUE '/'.
   767             20  DC-EDITA-DAY          PIC 99.
   768             20  SLASHA-2              PIC X VALUE '/'.
   769             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  18
* EL640.cbl
   770                 24  DC-EDITA-CENT     PIC 99.
   771                 24  DC-EDITA-YEAR     PIC 99.
   772         16  DC-GREG-DATE-B-EDIT.
   773             20  DC-EDITB-MONTH        PIC 99.
   774             20  SLASHB-1              PIC X VALUE '/'.
   775             20  DC-EDITB-DAY          PIC 99.
   776             20  SLASHB-2              PIC X VALUE '/'.
   777             20  DC-EDITB-CCYY.
   778                 24  DC-EDITB-CENT     PIC 99.
   779                 24  DC-EDITB-YEAR     PIC 99.
   780         16  DC-GREG-DATE-CYMD         PIC 9(08).
   781         16  DC-GREG-DATE-CYMD-R REDEFINES
   782                              DC-GREG-DATE-CYMD.
   783             20  DC-CYMD-CEN           PIC 99.
   784             20  DC-CYMD-YEAR          PIC 99.
   785             20  DC-CYMD-MONTH         PIC 99.
   786             20  DC-CYMD-DAY           PIC 99.
   787         16  DC-GREG-DATE-MDCY         PIC 9(08).
   788         16  DC-GREG-DATE-MDCY-R REDEFINES
   789                              DC-GREG-DATE-MDCY.
   790             20  DC-MDCY-MONTH         PIC 99.
   791             20  DC-MDCY-DAY           PIC 99.
   792             20  DC-MDCY-CEN           PIC 99.
   793             20  DC-MDCY-YEAR          PIC 99.
   794    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   795        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   796    12  DC-EL310-DATE                  PIC X(21).
   797    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  19
* EL640.cbl
   799*                            COPY ELCLOGOF.
   800******************************************************************
   801*                                                                *
   802*                                                                *
   803*                            ELCLOGOF.                           *
   804*                            VMOD=2.001                          *
   805*                                                                *
   806*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   807*                                                                *
   808******************************************************************
   809 01  CLASIC-LOGOFF.
   810     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   811     12  LOGOFF-TEXT.
   812         16  FILLER          PIC X(5)    VALUE SPACES.
   813         16  LOGOFF-MSG.
   814             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   815             20  FILLER      PIC X       VALUE SPACES.
   816             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   817         16  FILLER          PIC X(80)
   818           VALUE '* YOU ARE NOW LOGGED OFF'.
   819         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   820         16  FILLER          PIC X       VALUE QUOTE.
   821         16  LOGOFF-SYS-MSG  PIC X(17)
   822           VALUE 'S CLAS-IC SYSTEM '.
   823     12  TEXT-MESSAGES.
   824         16  UNACCESS-MSG    PIC X(29)
   825             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   826         16  PGMIDERR-MSG    PIC X(17)
   827             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  20
* EL640.cbl
   829*                            COPY ELCATTR.
   830******************************************************************
   831*                                                                *
   832*                            ELCATTR.                            *
   833*                            VMOD=2.001                          *
   834*                                                                *
   835*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   836*                                                                *
   837*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   838*                                                                *
   839*                   POS 1   P=PROTECTED                          *
   840*                           U=UNPROTECTED                        *
   841*                           S=ASKIP                              *
   842*                   POS 2   A=ALPHA/NUMERIC                      *
   843*                           N=NUMERIC                            *
   844*                   POS 3   N=NORMAL                             *
   845*                           B=BRIGHT                             *
   846*                           D=DARK                               *
   847*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   848*                           OF=MODIFIED DATA TAG OFF             *
   849*                                                                *
   850*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   851******************************************************************
   852 01  ATTRIBUTE-LIST.
   853     12  AL-PABOF            PIC X       VALUE 'Y'.
   854     12  AL-PABON            PIC X       VALUE 'Z'.
   855     12  AL-PADOF            PIC X       VALUE '%'.
   856     12  AL-PADON            PIC X       VALUE '_'.
   857     12  AL-PANOF            PIC X       VALUE '-'.
   858     12  AL-PANON            PIC X       VALUE '/'.
   859     12  AL-SABOF            PIC X       VALUE '8'.
   860     12  AL-SABON            PIC X       VALUE '9'.
   861     12  AL-SADOF            PIC X       VALUE '@'.
   862     12  AL-SADON            PIC X       VALUE QUOTE.
   863     12  AL-SANOF            PIC X       VALUE '0'.
   864     12  AL-SANON            PIC X       VALUE '1'.
   865     12  AL-UABOF            PIC X       VALUE 'H'.
   866     12  AL-UABON            PIC X       VALUE 'I'.
   867     12  AL-UADOF            PIC X       VALUE '<'.
   868     12  AL-UADON            PIC X       VALUE '('.
   869     12  AL-UANOF            PIC X       VALUE ' '.
   870     12  AL-UANON            PIC X       VALUE 'A'.
   871     12  AL-UNBOF            PIC X       VALUE 'Q'.
   872     12  AL-UNBON            PIC X       VALUE 'R'.
   873     12  AL-UNDOF            PIC X       VALUE '*'.
   874     12  AL-UNDON            PIC X       VALUE ')'.
   875     12  AL-UNNOF            PIC X       VALUE '&'.
   876     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  21
* EL640.cbl
   878*                            COPY ELCEMIB.
   879******************************************************************
   880*                                                                *
   881*                                                                *
   882*                            ELCEMIB.                            *
   883*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   884*                            VMOD=2.005                          *
   885*                                                                *
   886*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   887*                                                                *
   888******************************************************************
   889 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   890     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   891     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   892     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   893     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   894     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   895     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   896     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   897     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   898     12  EMI-SWITCH1             PIC X        VALUE '1'.
   899         88  EMI-NO-ERRORS                    VALUE '1'.
   900         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   901         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   902     12  EMI-SWITCH2             PIC X        VALUE '1'.
   903         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   904     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   905         88  EMI-AREA1-EMPTY                  VALUE '1'.
   906         88  EMI-AREA1-FULL                   VALUE '2'.
   907     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   908         88  EMI-AREA2-EMPTY                  VALUE '1'.
   909         88  EMI-AREA2-FULL                   VALUE '2'.
   910     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   911         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   912         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   913         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   914         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   915         88  EMI-BYPASS-FATALS                VALUE 'X'.
   916     12  EMI-ERROR-LINES.
   917         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   918         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   919         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   920         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   921             20  EMI-ERR-CODES OCCURS 10 TIMES.
   922                 24  EMI-ERR-NUM         PIC X(4).
   923                 24  EMI-FILLER          PIC X.
   924                 24  EMI-SEV             PIC X.
   925                 24  FILLER              PIC X.
   926             20  FILLER                  PIC X(02).
   927     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   928         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   929             20  EMI-ERROR-NUMBER    PIC X(4).
   930             20  EMI-FILL            PIC X.
   931             20  EMI-SEVERITY        PIC X.
   932             20  FILLER              PIC X.
   933             20  EMI-ERROR-TEXT.
   934                 24  EMI-TEXT-VARIABLE   PIC X(10).
   935                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  22
* EL640.cbl
   936     12  EMI-SEVERITY-SAVE           PIC X.
   937         88  EMI-NOTE                    VALUE 'N'.
   938         88  EMI-WARNING                 VALUE 'W'.
   939         88  EMI-FORCABLE                VALUE 'F'.
   940         88  EMI-FATAL                   VALUE 'X'.
   941     12  EMI-MESSAGE-FLAG            PIC X.
   942         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   943         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   944     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   945     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   946         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   947         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   948         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   949     12  FILLER                      PIC X(137)  VALUE SPACES.
   950     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   951     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   952     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   953     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  23
* EL640.cbl
   955*                            COPY ELCINTF.
   956******************************************************************
   957*                                                                *
   958*                                                                *
   959*                            ELCINTF.                            *
   960*                            VMOD=2.017                          *
   961*                                                                *
   962*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   963*                                                                *
   964*       LENGTH = 1024                                            *
   965*                                                                *
   966******************************************************************
   967 01  PROGRAM-INTERFACE-BLOCK.
   968     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   969     12  PI-CALLING-PROGRAM              PIC X(8).
   970     12  PI-SAVED-PROGRAM-1              PIC X(8).
   971     12  PI-SAVED-PROGRAM-2              PIC X(8).
   972     12  PI-SAVED-PROGRAM-3              PIC X(8).
   973     12  PI-SAVED-PROGRAM-4              PIC X(8).
   974     12  PI-SAVED-PROGRAM-5              PIC X(8).
   975     12  PI-SAVED-PROGRAM-6              PIC X(8).
   976     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   977     12  PI-COMPANY-ID                   PIC XXX.
   978     12  PI-COMPANY-CD                   PIC X.
   979
   980     12  PI-COMPANY-PASSWORD             PIC X(8).
   981
   982     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   983
   984     12  PI-CONTROL-IN-PROGRESS.
   985         16  PI-CARRIER                  PIC X.
   986         16  PI-GROUPING                 PIC X(6).
   987         16  PI-STATE                    PIC XX.
   988         16  PI-ACCOUNT                  PIC X(10).
   989         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   990                                         PIC X(10).
   991         16  PI-CLAIM-CERT-GRP.
   992             20  PI-CLAIM-NO             PIC X(7).
   993             20  PI-CERT-NO.
   994                 25  PI-CERT-PRIME       PIC X(10).
   995                 25  PI-CERT-SFX         PIC X.
   996             20  PI-CERT-EFF-DT          PIC XX.
   997         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   998             20  PI-PLAN-CODE            PIC X(2).
   999             20  PI-REVISION-NUMBER      PIC X(3).
  1000             20  PI-PLAN-EFF-DT          PIC X(2).
  1001             20  PI-PLAN-EXP-DT          PIC X(2).
  1002             20  FILLER                  PIC X(11).
  1003         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1004             20  PI-OE-REFERENCE-1.
  1005                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1006                 25  PI-OE-REF-1-SUFF    PIC XX.
  1007
  1008     12  PI-SESSION-IN-PROGRESS          PIC X.
  1009         88  CLAIM-SESSION                   VALUE '1'.
  1010         88  CREDIT-SESSION                  VALUE '2'.
  1011         88  WARRANTY-SESSION                VALUE '3'.
  1012         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  24
* EL640.cbl
  1013         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1014
  1015
  1016*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1017
  1018     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1019     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1020
  1021     12  PI-CREDIT-USER                  PIC X.
  1022         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1023         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1024
  1025     12  PI-CLAIM-USER                   PIC X.
  1026         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1027         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1028
  1029     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1030         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1031         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1032         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1033         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1034         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1035
  1036     12  PI-PROCESSOR-ID                 PIC X(4).
  1037
  1038     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1039
  1040     12  PI-MEMBER-CAPTION               PIC X(10).
  1041
  1042     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1043         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1044
  1045     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1046     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1047     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1048     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1049
  1050     12  PI-AH-OVERRIDE-L1               PIC X.
  1051     12  PI-AH-OVERRIDE-L2               PIC XX.
  1052     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1053     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1054
  1055     12  PI-NEW-SYSTEM                   PIC X(2).
  1056
  1057     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1058     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1059         88  PI-USES-PAID-TO                 VALUE '1'.
  1060     12  PI-CRDTCRD-SYSTEM.
  1061         16  PI-CRDTCRD-USER             PIC X.
  1062             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1063             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1064         16  PI-CC-MONTH-END-DT          PIC XX.
  1065     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1066
  1067     12  PI-OE-REFERENCE-2.
  1068         16  PI-OE-REF-2-PRIME           PIC X(10).
  1069         16  PI-OE-REF-2-SUFF            PIC X.
  1070
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  25
* EL640.cbl
  1071     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1072
  1073     12  PI-LANGUAGE-TYPE                PIC X.
  1074             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1075             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1076             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1077
  1078     12  PI-POLICY-LINKAGE-IND           PIC X.
  1079         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1080         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1081                                                   LOW-VALUES.
  1082
  1083     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1084     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1085         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1086         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1087     12  FILLER                          PIC X(4).
  1088
  1089     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1090
  1091     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1092         PI-SYSTEM-LEVEL.
  1093
  1094         16  PI-ENTRY-CODES.
  1095             20  PI-ENTRY-CD-1           PIC X.
  1096             20  PI-ENTRY-CD-2           PIC X.
  1097
  1098         16  PI-RETURN-CODES.
  1099             20  PI-RETURN-CD-1          PIC X.
  1100             20  PI-RETURN-CD-2          PIC X.
  1101
  1102         16  PI-UPDATE-STATUS-SAVE.
  1103             20  PI-UPDATE-BY            PIC X(4).
  1104             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1105
  1106         16  PI-LOWER-CASE-LETTERS       PIC X.
  1107             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1108
  1109*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1110*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1111*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1112
  1113         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1114             88  ST-ACCNT-CNTL               VALUE ' '.
  1115             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1116             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1117             88  ACCNT-CNTL                  VALUE '3'.
  1118             88  CARR-ACCNT-CNTL             VALUE '4'.
  1119
  1120         16  PI-PROCESSOR-CAP-LIST.
  1121             20  PI-SYSTEM-CONTROLS.
  1122                24 PI-SYSTEM-DISPLAY     PIC X.
  1123                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1124                24 PI-SYSTEM-MODIFY      PIC X.
  1125                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1126             20  FILLER                  PIC XX.
  1127             20  PI-DISPLAY-CAP          PIC X.
  1128                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  26
* EL640.cbl
  1129             20  PI-MODIFY-CAP           PIC X.
  1130                 88  MODIFY-CAP              VALUE 'Y'.
  1131             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1132                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1133             20  PI-FORCE-CAP            PIC X.
  1134                 88  FORCE-CAP               VALUE 'Y'.
  1135
  1136         16  PI-PROGRAM-CONTROLS.
  1137             20  PI-PGM-PRINT-OPT        PIC X.
  1138             20  PI-PGM-FORMAT-OPT       PIC X.
  1139             20  PI-PGM-PROCESS-OPT      PIC X.
  1140             20  PI-PGM-TOTALS-OPT       PIC X.
  1141
  1142         16  PI-HELP-INTERFACE.
  1143             20  PI-LAST-ERROR-NO        PIC X(4).
  1144             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1145
  1146         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1147             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1148
  1149         16  PI-CR-CONTROL-IN-PROGRESS.
  1150             20  PI-CR-CARRIER           PIC X.
  1151             20  PI-CR-GROUPING          PIC X(6).
  1152             20  PI-CR-STATE             PIC XX.
  1153             20  PI-CR-ACCOUNT           PIC X(10).
  1154             20  PI-CR-FIN-RESP          PIC X(10).
  1155             20  PI-CR-TYPE              PIC X.
  1156
  1157         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1158
  1159         16  PI-CR-MONTH-END-DT          PIC XX.
  1160
  1161         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1162             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1163             88  PI-ZERO-CARRIER             VALUE '1'.
  1164             88  PI-ZERO-GROUPING            VALUE '2'.
  1165             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1166
  1167         16  PI-CARRIER-SECURITY         PIC X.
  1168             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1169
  1170         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1171             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1172             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1173
  1174         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1175             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1176                                         INDEXED BY PI-ACCESS-NDX
  1177                                         PIC X.
  1178
  1179         16  PI-GA-BILLING-CONTROL       PIC X.
  1180             88  PI-GA-BILLING               VALUE '1'.
  1181
  1182         16  PI-MAIL-PROCESSING          PIC X.
  1183             88  PI-MAIL-YES                 VALUE 'Y'.
  1184
  1185         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1186
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  27
* EL640.cbl
  1187         16  PI-AR-SYSTEM.
  1188             20  PI-AR-PROCESSING-CNTL   PIC X.
  1189                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1190             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1191             20  PI-AR-MONTH-END-DT      PIC XX.
  1192
  1193         16  PI-MP-SYSTEM.
  1194             20  PI-MORTGAGE-USER            PIC X.
  1195                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1196                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1197             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1198                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1199                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1200                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1201                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1202                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1203             20  PI-MP-MONTH-END-DT          PIC XX.
  1204             20  PI-MP-REFERENCE-NO.
  1205                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1206                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1207
  1208         16  PI-LABEL-CONTROL            PIC X(01).
  1209             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1210             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1211
  1212         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1213             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1214
  1215         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1216             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1217             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1218
  1219         16  FILLER                      PIC X(14).
  1220
  1221     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1222******************************************************************
  1223     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1224         16  PI-MAP-NAME         PIC X(8).
  1225         16  PI-ACCT-NAME        PIC X(30).
  1226         16  PI-SAV-REMIT-TO     PIC X(10).
  1227         16  PI-SAV-ACCT         PIC X(10).
  1228         16  PI-SAV-CARR         PIC X.
  1229         16  PI-SAV-GROUP        PIC X(6).
  1230         16  PI-SAV-STATE        PIC XX.
  1231         16  PI-SAV-EXP-DT       PIC XX.
  1232         16  PI-BAL-FRWD-GA      PIC S9(7)V99   COMP-3.
  1233         16  PI-BAL-FRWD         PIC S9(7)V99   COMP-3.
  1234         16  PI-PREMIUM          PIC S9(7)V99   COMP-3.
  1235         16  PI-REMITTED         PIC S9(7)V99   COMP-3.
  1236         16  PI-TOT-ISS-COMP     PIC S9(7)V99   COMP-3.
  1237         16  PI-TOT-CAN-COMP     PIC S9(7)V99   COMP-3.
  1238         16  PI-ADJUSTMENTS      PIC S9(7)V99   COMP-3.
  1239         16  PI-DISBURSED        PIC S9(7)V99   COMP-3.
  1240         16  PI-END-BAL          PIC S9(7)V99   COMP-3.
  1241         16  PI-LF-ISS-COMP      PIC S9(7)V99   COMP-3.
  1242         16  PI-AH-ISS-COMP      PIC S9(7)V99   COMP-3.
  1243         16  PI-LF-CAN-COMP      PIC S9(7)V99   COMP-3.
  1244         16  PI-AH-CAN-COMP      PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  28
* EL640.cbl
  1245         16  PI-LIMIT-BILLING-BTCHS.
  1246             20  PI-BILLING-BATCHES   OCCURS 3 TIMES
  1247                                 PIC X(6).
  1248         16  PI-BILL-TYPE        PIC X.
  1249             88  PI-PREV-BILL        VALUE '1'.
  1250             88  PI-PREV-REBILL      VALUE '2'.
  1251             88  PI-PREVIEW          VALUE '1' '2'.
  1252             88  PI-BILL             VALUE '3'.
  1253             88  PI-REBILLING        VALUE '4'.
  1254             88  PI-VOID-BILL        VALUE '5'.
  1255             88  PI-TOT-REBILL       VALUE '2' '4'.
  1256             88  PI-UPDATE-FILES     VALUE '3' '4' '5'.
  1257             88  PI-BILLING-FUNCTION VALUE '1' '2' '3' '4'.
  1258         16  PI-BILL-ERRS        PIC X.
  1259         16  PI-CHECK-SW         PIC X.
  1260             88  PI-CHECK-PRODUCED   VALUE 'Y'.
  1261         16  PI-DATA-BILLED-SW   PIC X.
  1262             88  PI-DATA-BILLED      VALUE 'Y'.
  1263         16  PI-MONTH-END-DATE.
  1264             20  PI-ME-MONTH     PIC 99.
  1265             20  FILLER          PIC X.
  1266             20  PI-ME-DAY       PIC 99.
  1267             20  FILLER          PIC X.
  1268             20  PI-ME-YEAR      PIC 99.
  1269         16  PI-BILLING-COUNTS.
  1270             20  FILLER OCCURS 6 TIMES INDEXED BY PINDX.
  1271                 24  PI-BATCH    PIC X(6).
  1272                 24  PI-BILLED   PIC 9(6)  COMP-3.
  1273                 24  PI-PREV     PIC 9(6)  COMP-3.
  1274                 24  PI-NOBILL   PIC 9(6)  COMP-3.
  1275                 24  PI-PREM     PIC S9(7)V99   COMP-3.
  1276                 24  PI-COMM     PIC S9(7)V99   COMP-3.
  1277                 24  PI-NON-PREM PIC S9(7)V99   COMP-3.
  1278                 24  PI-NON-COMM PIC S9(7)V99   COMP-3.
  1279         16  PI-COMP-CONTROL.
  1280             20  PI-COMP-CARRIER     PIC X.
  1281             20  PI-COMP-GROUPING    PIC X(6).
  1282             20  PI-COMP-FIN-RESP    PIC X(10).
  1283         16  PI-SCRN-CONTROL.
  1284             20  PI-SCR-CARRIER      PIC X.
  1285             20  PI-SCR-GROUPING     PIC X(6).
  1286             20  PI-SCR-STATE        PIC X(02).
  1287             20  PI-SCR-ACCOUNT      PIC X(10).
  1288             20  PI-SCR-FIN-RESP     PIC X(10).
  1289             20  PI-SCR-TYPE         PIC X.
  1290         16  PI-TRANSFER-SW          PIC X.
  1291             88  PI-TRANSFER-BEFORE-ACT   VALUE 'Y'.
  1292         16  FILLER                  PIC X(200).
  1293
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  29
* EL640.cbl
  1295*                            COPY ELCJPFX.
  1296******************************************************************
  1297*                                                                *
  1298*                                                                *
  1299*                            ELCJPFX.                            *
  1300*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1301*                            VMOD=2.002                          *
  1302*                                                                *
  1303*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1304*                                                                *
  1305*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1306*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1307*        ELCNTL - CONTROL FILE                                   *
  1308*        ELMSTR - CLAIM MASTERS                                  *
  1309*        ELTRLR - ACTIVITY TRAILERS                              *
  1310*        ELCHKQ - CHECK QUE                                      *
  1311******************************************************************
  1312 01  JOURNAL-RECORD.
  1313     12  JP-USER-ID                  PIC X(4).
  1314     12  JP-FILE-ID                  PIC X(8).
  1315     12  JP-PROGRAM-ID               PIC X(8).
  1316     12  JP-RECORD-TYPE              PIC X.
  1317         88 JP-ADD              VALUE 'A'.
  1318         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1319         88 JP-AFTER-CHANGE     VALUE 'C'.
  1320         88 JP-DELETE           VALUE 'D'.
  1321         88 JP-GENERIC-DELETE   VALUE 'G'.
  1322         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1323         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1324     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1325     12  JP-RECORD-AREA
  1326
  1327
  1328                             PIC X(1464).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  30
* EL640.cbl
  1330*                            COPY ELCAID.
  1331******************************************************************
  1332*                                                                *
  1333*                            ELCAID.                             *
  1334*                            VMOD=2.001                          *
  1335*                                                                *
  1336*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1337*                                                                *
  1338*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1339*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1340******************************************************************
  1341
  1342 01  DFHAID.
  1343   02  DFHNULL   PIC  X  VALUE  ' '.
  1344   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1345   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1346   02  DFHPEN    PIC  X  VALUE  '='.
  1347   02  DFHOPID   PIC  X  VALUE  'W'.
  1348   02  DFHPA1    PIC  X  VALUE  '%'.
  1349   02  DFHPA2    PIC  X  VALUE  '>'.
  1350   02  DFHPA3    PIC  X  VALUE  ','.
  1351   02  DFHPF1    PIC  X  VALUE  '1'.
  1352   02  DFHPF2    PIC  X  VALUE  '2'.
  1353   02  DFHPF3    PIC  X  VALUE  '3'.
  1354   02  DFHPF4    PIC  X  VALUE  '4'.
  1355   02  DFHPF5    PIC  X  VALUE  '5'.
  1356   02  DFHPF6    PIC  X  VALUE  '6'.
  1357   02  DFHPF7    PIC  X  VALUE  '7'.
  1358   02  DFHPF8    PIC  X  VALUE  '8'.
  1359   02  DFHPF9    PIC  X  VALUE  '9'.
  1360   02  DFHPF10   PIC  X  VALUE  ':'.
  1361   02  DFHPF11   PIC  X  VALUE  '#'.
  1362   02  DFHPF12   PIC  X  VALUE  '@'.
  1363   02  DFHPF13   PIC  X  VALUE  'A'.
  1364   02  DFHPF14   PIC  X  VALUE  'B'.
  1365   02  DFHPF15   PIC  X  VALUE  'C'.
  1366   02  DFHPF16   PIC  X  VALUE  'D'.
  1367   02  DFHPF17   PIC  X  VALUE  'E'.
  1368   02  DFHPF18   PIC  X  VALUE  'F'.
  1369   02  DFHPF19   PIC  X  VALUE  'G'.
  1370   02  DFHPF20   PIC  X  VALUE  'H'.
  1371   02  DFHPF21   PIC  X  VALUE  'I'.
  1372*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1373   02  DFHPF22   PIC  X  VALUE  '['.
  1374   02  DFHPF23   PIC  X  VALUE  '.'.
  1375   02  DFHPF24   PIC  X  VALUE  '<'.
  1376   02  DFHMSRE   PIC  X  VALUE  'X'.
  1377   02  DFHSTRF   PIC  X  VALUE  'h'.
  1378   02  DFHTRIG   PIC  X  VALUE  '"'.
  1379 01  FILLER    REDEFINES DFHAID.
  1380     12  FILLER              PIC X(8).
  1381     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  31
* EL640.cbl
  1383*                                         COPY EL640S.
  1384 01  EL640AI.
  1385     05  FILLER            PIC  X(0012).
  1386*    -------------------------------
  1387     05  ADATEL PIC S9(0004) COMP.
  1388     05  ADATEF PIC  X(0001).
  1389     05  FILLER REDEFINES ADATEF.
  1390         10  ADATEA PIC  X(0001).
  1391     05  ADATEI PIC  X(0008).
  1392*    -------------------------------
  1393     05  ATIMEL PIC S9(0004) COMP.
  1394     05  ATIMEF PIC  X(0001).
  1395     05  FILLER REDEFINES ATIMEF.
  1396         10  ATIMEA PIC  X(0001).
  1397     05  ATIMEI PIC  X(0005).
  1398*    -------------------------------
  1399     05  CMPNYIDL PIC S9(0004) COMP.
  1400     05  CMPNYIDF PIC  X(0001).
  1401     05  FILLER REDEFINES CMPNYIDF.
  1402         10  CMPNYIDA PIC  X(0001).
  1403     05  CMPNYIDI PIC  X(0003).
  1404*    -------------------------------
  1405     05  USERIDL PIC S9(0004) COMP.
  1406     05  USERIDF PIC  X(0001).
  1407     05  FILLER REDEFINES USERIDF.
  1408         10  USERIDA PIC  X(0001).
  1409     05  USERIDI PIC  X(0004).
  1410*    -------------------------------
  1411     05  AACTNAML PIC S9(0004) COMP.
  1412     05  AACTNAMF PIC  X(0001).
  1413     05  FILLER REDEFINES AACTNAMF.
  1414         10  AACTNAMA PIC  X(0001).
  1415     05  AACTNAMI PIC  X(0030).
  1416*    -------------------------------
  1417     05  ACARHDGL PIC S9(0004) COMP.
  1418     05  ACARHDGF PIC  X(0001).
  1419     05  FILLER REDEFINES ACARHDGF.
  1420         10  ACARHDGA PIC  X(0001).
  1421     05  ACARHDGI PIC  X(0007).
  1422*    -------------------------------
  1423     05  AGRPHDGL PIC S9(0004) COMP.
  1424     05  AGRPHDGF PIC  X(0001).
  1425     05  FILLER REDEFINES AGRPHDGF.
  1426         10  AGRPHDGA PIC  X(0001).
  1427     05  AGRPHDGI PIC  X(0005).
  1428*    -------------------------------
  1429     05  ASTHDGL PIC S9(0004) COMP.
  1430     05  ASTHDGF PIC  X(0001).
  1431     05  FILLER REDEFINES ASTHDGF.
  1432         10  ASTHDGA PIC  X(0001).
  1433     05  ASTHDGI PIC  X(0005).
  1434*    -------------------------------
  1435     05  AACCTL PIC S9(0004) COMP.
  1436     05  AACCTF PIC  X(0001).
  1437     05  FILLER REDEFINES AACCTF.
  1438         10  AACCTA PIC  X(0001).
  1439     05  AACCTI PIC  X(0010).
  1440*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  32
* EL640.cbl
  1441     05  ACARIERL PIC S9(0004) COMP.
  1442     05  ACARIERF PIC  X(0001).
  1443     05  FILLER REDEFINES ACARIERF.
  1444         10  ACARIERA PIC  X(0001).
  1445     05  ACARIERI PIC  X(0001).
  1446*    -------------------------------
  1447     05  AGROUPL PIC S9(0004) COMP.
  1448     05  AGROUPF PIC  X(0001).
  1449     05  FILLER REDEFINES AGROUPF.
  1450         10  AGROUPA PIC  X(0001).
  1451     05  AGROUPI PIC  X(0006).
  1452*    -------------------------------
  1453     05  ASTATEL PIC S9(0004) COMP.
  1454     05  ASTATEF PIC  X(0001).
  1455     05  FILLER REDEFINES ASTATEF.
  1456         10  ASTATEA PIC  X(0001).
  1457     05  ASTATEI PIC  X(0002).
  1458*    -------------------------------
  1459     05  ABALFWDL PIC S9(0004) COMP.
  1460     05  ABALFWDF PIC  X(0001).
  1461     05  FILLER REDEFINES ABALFWDF.
  1462         10  ABALFWDA PIC  X(0001).
  1463     05  ABALFWDI PIC  X(0011).
  1464*    -------------------------------
  1465     05  APREMUML PIC S9(0004) COMP.
  1466     05  APREMUMF PIC  X(0001).
  1467     05  FILLER REDEFINES APREMUMF.
  1468         10  APREMUMA PIC  X(0001).
  1469     05  APREMUMI PIC  X(0011).
  1470*    -------------------------------
  1471     05  AHD1L PIC S9(0004) COMP.
  1472     05  AHD1F PIC  X(0001).
  1473     05  FILLER REDEFINES AHD1F.
  1474         10  AHD1A PIC  X(0001).
  1475     05  AHD1I PIC  X(0018).
  1476*    -------------------------------
  1477     05  AREMITL PIC S9(0004) COMP.
  1478     05  AREMITF PIC  X(0001).
  1479     05  FILLER REDEFINES AREMITF.
  1480         10  AREMITA PIC  X(0001).
  1481     05  AREMITI PIC  X(0011).
  1482*    -------------------------------
  1483     05  ABATCH1L PIC S9(0004) COMP.
  1484     05  ABATCH1F PIC  X(0001).
  1485     05  FILLER REDEFINES ABATCH1F.
  1486         10  ABATCH1A PIC  X(0001).
  1487     05  ABATCH1I PIC  X(0006).
  1488*    -------------------------------
  1489     05  ABILL1L PIC S9(0004) COMP.
  1490     05  ABILL1F PIC  X(0001).
  1491     05  FILLER REDEFINES ABILL1F.
  1492         10  ABILL1A PIC  X(0001).
  1493     05  ABILL1I PIC  X(0006).
  1494*    -------------------------------
  1495     05  APREV1L PIC S9(0004) COMP.
  1496     05  APREV1F PIC  X(0001).
  1497     05  FILLER REDEFINES APREV1F.
  1498         10  APREV1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  33
* EL640.cbl
  1499     05  APREV1I PIC  X(0006).
  1500*    -------------------------------
  1501     05  ANOBIL1L PIC S9(0004) COMP.
  1502     05  ANOBIL1F PIC  X(0001).
  1503     05  FILLER REDEFINES ANOBIL1F.
  1504         10  ANOBIL1A PIC  X(0001).
  1505     05  ANOBIL1I PIC  X(0006).
  1506*    -------------------------------
  1507     05  AHD2L PIC S9(0004) COMP.
  1508     05  AHD2F PIC  X(0001).
  1509     05  FILLER REDEFINES AHD2F.
  1510         10  AHD2A PIC  X(0001).
  1511     05  AHD2I PIC  X(0018).
  1512*    -------------------------------
  1513     05  ACOMPISL PIC S9(0004) COMP.
  1514     05  ACOMPISF PIC  X(0001).
  1515     05  FILLER REDEFINES ACOMPISF.
  1516         10  ACOMPISA PIC  X(0001).
  1517     05  ACOMPISI PIC  X(0011).
  1518*    -------------------------------
  1519     05  ABATCH2L PIC S9(0004) COMP.
  1520     05  ABATCH2F PIC  X(0001).
  1521     05  FILLER REDEFINES ABATCH2F.
  1522         10  ABATCH2A PIC  X(0001).
  1523     05  ABATCH2I PIC  X(0006).
  1524*    -------------------------------
  1525     05  ABILL2L PIC S9(0004) COMP.
  1526     05  ABILL2F PIC  X(0001).
  1527     05  FILLER REDEFINES ABILL2F.
  1528         10  ABILL2A PIC  X(0001).
  1529     05  ABILL2I PIC  X(0006).
  1530*    -------------------------------
  1531     05  APREV2L PIC S9(0004) COMP.
  1532     05  APREV2F PIC  X(0001).
  1533     05  FILLER REDEFINES APREV2F.
  1534         10  APREV2A PIC  X(0001).
  1535     05  APREV2I PIC  X(0006).
  1536*    -------------------------------
  1537     05  ANOBIL2L PIC S9(0004) COMP.
  1538     05  ANOBIL2F PIC  X(0001).
  1539     05  FILLER REDEFINES ANOBIL2F.
  1540         10  ANOBIL2A PIC  X(0001).
  1541     05  ANOBIL2I PIC  X(0006).
  1542*    -------------------------------
  1543     05  AHD3L PIC S9(0004) COMP.
  1544     05  AHD3F PIC  X(0001).
  1545     05  FILLER REDEFINES AHD3F.
  1546         10  AHD3A PIC  X(0001).
  1547     05  AHD3I PIC  X(0018).
  1548*    -------------------------------
  1549     05  ACOMCANL PIC S9(0004) COMP.
  1550     05  ACOMCANF PIC  X(0001).
  1551     05  FILLER REDEFINES ACOMCANF.
  1552         10  ACOMCANA PIC  X(0001).
  1553     05  ACOMCANI PIC  X(0011).
  1554*    -------------------------------
  1555     05  ABATCH3L PIC S9(0004) COMP.
  1556     05  ABATCH3F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  34
* EL640.cbl
  1557     05  FILLER REDEFINES ABATCH3F.
  1558         10  ABATCH3A PIC  X(0001).
  1559     05  ABATCH3I PIC  X(0006).
  1560*    -------------------------------
  1561     05  ABILL3L PIC S9(0004) COMP.
  1562     05  ABILL3F PIC  X(0001).
  1563     05  FILLER REDEFINES ABILL3F.
  1564         10  ABILL3A PIC  X(0001).
  1565     05  ABILL3I PIC  X(0006).
  1566*    -------------------------------
  1567     05  APREV3L PIC S9(0004) COMP.
  1568     05  APREV3F PIC  X(0001).
  1569     05  FILLER REDEFINES APREV3F.
  1570         10  APREV3A PIC  X(0001).
  1571     05  APREV3I PIC  X(0006).
  1572*    -------------------------------
  1573     05  ANOBIL3L PIC S9(0004) COMP.
  1574     05  ANOBIL3F PIC  X(0001).
  1575     05  FILLER REDEFINES ANOBIL3F.
  1576         10  ANOBIL3A PIC  X(0001).
  1577     05  ANOBIL3I PIC  X(0006).
  1578*    -------------------------------
  1579     05  AHD4L PIC S9(0004) COMP.
  1580     05  AHD4F PIC  X(0001).
  1581     05  FILLER REDEFINES AHD4F.
  1582         10  AHD4A PIC  X(0001).
  1583     05  AHD4I PIC  X(0018).
  1584*    -------------------------------
  1585     05  AADJUSTL PIC S9(0004) COMP.
  1586     05  AADJUSTF PIC  X(0001).
  1587     05  FILLER REDEFINES AADJUSTF.
  1588         10  AADJUSTA PIC  X(0001).
  1589     05  AADJUSTI PIC  X(0011).
  1590*    -------------------------------
  1591     05  ABATCH4L PIC S9(0004) COMP.
  1592     05  ABATCH4F PIC  X(0001).
  1593     05  FILLER REDEFINES ABATCH4F.
  1594         10  ABATCH4A PIC  X(0001).
  1595     05  ABATCH4I PIC  X(0006).
  1596*    -------------------------------
  1597     05  ABILL4L PIC S9(0004) COMP.
  1598     05  ABILL4F PIC  X(0001).
  1599     05  FILLER REDEFINES ABILL4F.
  1600         10  ABILL4A PIC  X(0001).
  1601     05  ABILL4I PIC  X(0006).
  1602*    -------------------------------
  1603     05  APREV4L PIC S9(0004) COMP.
  1604     05  APREV4F PIC  X(0001).
  1605     05  FILLER REDEFINES APREV4F.
  1606         10  APREV4A PIC  X(0001).
  1607     05  APREV4I PIC  X(0006).
  1608*    -------------------------------
  1609     05  ANOBIL4L PIC S9(0004) COMP.
  1610     05  ANOBIL4F PIC  X(0001).
  1611     05  FILLER REDEFINES ANOBIL4F.
  1612         10  ANOBIL4A PIC  X(0001).
  1613     05  ANOBIL4I PIC  X(0006).
  1614*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  35
* EL640.cbl
  1615     05  AHD5L PIC S9(0004) COMP.
  1616     05  AHD5F PIC  X(0001).
  1617     05  FILLER REDEFINES AHD5F.
  1618         10  AHD5A PIC  X(0001).
  1619     05  AHD5I PIC  X(0018).
  1620*    -------------------------------
  1621     05  ADISBURL PIC S9(0004) COMP.
  1622     05  ADISBURF PIC  X(0001).
  1623     05  FILLER REDEFINES ADISBURF.
  1624         10  ADISBURA PIC  X(0001).
  1625     05  ADISBURI PIC  X(0011).
  1626*    -------------------------------
  1627     05  ABATCH5L PIC S9(0004) COMP.
  1628     05  ABATCH5F PIC  X(0001).
  1629     05  FILLER REDEFINES ABATCH5F.
  1630         10  ABATCH5A PIC  X(0001).
  1631     05  ABATCH5I PIC  X(0006).
  1632*    -------------------------------
  1633     05  ABILL5L PIC S9(0004) COMP.
  1634     05  ABILL5F PIC  X(0001).
  1635     05  FILLER REDEFINES ABILL5F.
  1636         10  ABILL5A PIC  X(0001).
  1637     05  ABILL5I PIC  X(0006).
  1638*    -------------------------------
  1639     05  APREV5L PIC S9(0004) COMP.
  1640     05  APREV5F PIC  X(0001).
  1641     05  FILLER REDEFINES APREV5F.
  1642         10  APREV5A PIC  X(0001).
  1643     05  APREV5I PIC  X(0006).
  1644*    -------------------------------
  1645     05  ANOBIL5L PIC S9(0004) COMP.
  1646     05  ANOBIL5F PIC  X(0001).
  1647     05  FILLER REDEFINES ANOBIL5F.
  1648         10  ANOBIL5A PIC  X(0001).
  1649     05  ANOBIL5I PIC  X(0006).
  1650*    -------------------------------
  1651     05  AENDHDGL PIC S9(0004) COMP.
  1652     05  AENDHDGF PIC  X(0001).
  1653     05  FILLER REDEFINES AENDHDGF.
  1654         10  AENDHDGA PIC  X(0001).
  1655     05  AENDHDGI PIC  X(0018).
  1656*    -------------------------------
  1657     05  ANETDUEL PIC S9(0004) COMP.
  1658     05  ANETDUEF PIC  X(0001).
  1659     05  FILLER REDEFINES ANETDUEF.
  1660         10  ANETDUEA PIC  X(0001).
  1661     05  ANETDUEI PIC  X(0011).
  1662*    -------------------------------
  1663     05  ABATCH6L PIC S9(0004) COMP.
  1664     05  ABATCH6F PIC  X(0001).
  1665     05  FILLER REDEFINES ABATCH6F.
  1666         10  ABATCH6A PIC  X(0001).
  1667     05  ABATCH6I PIC  X(0006).
  1668*    -------------------------------
  1669     05  ABILL6L PIC S9(0004) COMP.
  1670     05  ABILL6F PIC  X(0001).
  1671     05  FILLER REDEFINES ABILL6F.
  1672         10  ABILL6A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  36
* EL640.cbl
  1673     05  ABILL6I PIC  X(0006).
  1674*    -------------------------------
  1675     05  APREV6L PIC S9(0004) COMP.
  1676     05  APREV6F PIC  X(0001).
  1677     05  FILLER REDEFINES APREV6F.
  1678         10  APREV6A PIC  X(0001).
  1679     05  APREV6I PIC  X(0006).
  1680*    -------------------------------
  1681     05  ANOBIL6L PIC S9(0004) COMP.
  1682     05  ANOBIL6F PIC  X(0001).
  1683     05  FILLER REDEFINES ANOBIL6F.
  1684         10  ANOBIL6A PIC  X(0001).
  1685     05  ANOBIL6I PIC  X(0006).
  1686*    -------------------------------
  1687     05  ABILTYPL PIC S9(0004) COMP.
  1688     05  ABILTYPF PIC  X(0001).
  1689     05  FILLER REDEFINES ABILTYPF.
  1690         10  ABILTYPA PIC  X(0001).
  1691     05  ABILTYPI PIC  X(0001).
  1692*    -------------------------------
  1693     05  APRODSWL PIC S9(0004) COMP.
  1694     05  APRODSWF PIC  X(0001).
  1695     05  FILLER REDEFINES APRODSWF.
  1696         10  APRODSWA PIC  X(0001).
  1697     05  APRODSWI PIC  X(0001).
  1698*    -------------------------------
  1699     05  ABILERRL PIC S9(0004) COMP.
  1700     05  ABILERRF PIC  X(0001).
  1701     05  FILLER REDEFINES ABILERRF.
  1702         10  ABILERRA PIC  X(0001).
  1703     05  ABILERRI PIC  X(0001).
  1704*    -------------------------------
  1705     05  ABTCH1L PIC S9(0004) COMP.
  1706     05  ABTCH1F PIC  X(0001).
  1707     05  FILLER REDEFINES ABTCH1F.
  1708         10  ABTCH1A PIC  X(0001).
  1709     05  ABTCH1I PIC  X(0006).
  1710*    -------------------------------
  1711     05  ABTCH2L PIC S9(0004) COMP.
  1712     05  ABTCH2F PIC  X(0001).
  1713     05  FILLER REDEFINES ABTCH2F.
  1714         10  ABTCH2A PIC  X(0001).
  1715     05  ABTCH2I PIC  X(0006).
  1716*    -------------------------------
  1717     05  ABTCH3L PIC S9(0004) COMP.
  1718     05  ABTCH3F PIC  X(0001).
  1719     05  FILLER REDEFINES ABTCH3F.
  1720         10  ABTCH3A PIC  X(0001).
  1721     05  ABTCH3I PIC  X(0006).
  1722*    -------------------------------
  1723     05  AERMSG1L PIC S9(0004) COMP.
  1724     05  AERMSG1F PIC  X(0001).
  1725     05  FILLER REDEFINES AERMSG1F.
  1726         10  AERMSG1A PIC  X(0001).
  1727     05  AERMSG1I PIC  X(0076).
  1728*    -------------------------------
  1729     05  AERMSG2L PIC S9(0004) COMP.
  1730     05  AERMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  37
* EL640.cbl
  1731     05  FILLER REDEFINES AERMSG2F.
  1732         10  AERMSG2A PIC  X(0001).
  1733     05  AERMSG2I PIC  X(0076).
  1734*    -------------------------------
  1735     05  APFNTERL PIC S9(0004) COMP.
  1736     05  APFNTERF PIC  X(0001).
  1737     05  FILLER REDEFINES APFNTERF.
  1738         10  APFNTERA PIC  X(0001).
  1739     05  APFNTERI PIC  9(2).
  1740*    -------------------------------
  1741     05  APF5HDGL PIC S9(0004) COMP.
  1742     05  APF5HDGF PIC  X(0001).
  1743     05  FILLER REDEFINES APF5HDGF.
  1744         10  APF5HDGA PIC  X(0001).
  1745     05  APF5HDGI PIC  X(0020).
  1746*    -------------------------------
  1747     05  AGAHDGL PIC S9(0004) COMP.
  1748     05  AGAHDGF PIC  X(0001).
  1749     05  FILLER REDEFINES AGAHDGF.
  1750         10  AGAHDGA PIC  X(0001).
  1751     05  AGAHDGI PIC  X(0025).
  1752 01  EL640AO REDEFINES EL640AI.
  1753     05  FILLER            PIC  X(0012).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  ADATEO PIC  X(0008).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  ATIMEO PIC  99.99.
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  CMPNYIDO PIC  X(0003).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  USERIDO PIC  X(0004).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  AACTNAMO PIC  X(0030).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  ACARHDGO PIC  X(0007).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  AGRPHDGO PIC  X(0005).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  ASTHDGO PIC  X(0005).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  AACCTO PIC  X(0010).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  ACARIERO PIC  X(0001).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  AGROUPO PIC  X(0006).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  38
* EL640.cbl
  1789     05  ASTATEO PIC  X(0002).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  ABALFWDO PIC  ZZZZZZ9.99-.
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  APREMUMO PIC  ZZZZZZ9.99-.
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  AHD1O PIC  X(0018).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  AREMITO PIC  ZZZZZZ9.99-.
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  ABATCH1O PIC  X(0006).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  ABILL1O PIC  Z(5)9.
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  APREV1O PIC  Z(5)9.
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  ANOBIL1O PIC  Z(5)9.
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  AHD2O PIC  X(0018).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  ACOMPISO PIC  ZZZZZZ9.99-.
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  ABATCH2O PIC  X(0006).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  ABILL2O PIC  Z(5)9.
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  APREV2O PIC  Z(5)9.
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  ANOBIL2O PIC  Z(5)9.
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  AHD3O PIC  X(0018).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  ACOMCANO PIC  ZZZZZZ9.99-.
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  ABATCH3O PIC  X(0006).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  ABILL3O PIC  Z(5)9.
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  APREV3O PIC  Z(5)9.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  39
* EL640.cbl
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  ANOBIL3O PIC  Z(5)9.
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  AHD4O PIC  X(0018).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  AADJUSTO PIC  ZZZZZZ9.99-.
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  ABATCH4O PIC  X(0006).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  ABILL4O PIC  Z(5)9.
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  APREV4O PIC  Z(5)9.
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  ANOBIL4O PIC  Z(5)9.
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  AHD5O PIC  X(0018).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  ADISBURO PIC  ZZZZZZ9.99-.
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  ABATCH5O PIC  X(0006).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  ABILL5O PIC  Z(5)9.
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  APREV5O PIC  Z(5)9.
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  ANOBIL5O PIC  Z(5)9.
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  AENDHDGO PIC  X(0018).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  ANETDUEO PIC  ZZZZZZ9.99-.
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  ABATCH6O PIC  X(0006).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  ABILL6O PIC  Z(5)9.
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  APREV6O PIC  Z(5)9.
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  ANOBIL6O PIC  Z(5)9.
  1904*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  40
* EL640.cbl
  1905     05  FILLER            PIC  X(0003).
  1906     05  ABILTYPO PIC  X(0001).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  APRODSWO PIC  X(0001).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  ABILERRO PIC  X(0001).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  ABTCH1O PIC  X(0006).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  ABTCH2O PIC  X(0006).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  ABTCH3O PIC  X(0006).
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  AERMSG1O PIC  X(0076).
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  AERMSG2O PIC  X(0076).
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  APFNTERO PIC  99.
  1931*    -------------------------------
  1932     05  FILLER            PIC  X(0003).
  1933     05  APF5HDGO PIC  X(0020).
  1934*    -------------------------------
  1935     05  FILLER            PIC  X(0003).
  1936     05  AGAHDGO PIC  X(0025).
  1937*    -------------------------------
  1938 01  EL640BI REDEFINES EL640AI.
  1939     05  FILLER            PIC  X(0012).
  1940*    -------------------------------
  1941     05  BDATEL PIC S9(0004) COMP.
  1942     05  BDATEF PIC  X(0001).
  1943     05  FILLER REDEFINES BDATEF.
  1944         10  BDATEA PIC  X(0001).
  1945     05  BDATEI PIC  X(0008).
  1946*    -------------------------------
  1947     05  BTIMEL PIC S9(0004) COMP.
  1948     05  BTIMEF PIC  X(0001).
  1949     05  FILLER REDEFINES BTIMEF.
  1950         10  BTIMEA PIC  X(0001).
  1951     05  BTIMEI PIC  X(0005).
  1952*    -------------------------------
  1953     05  BCMPNYL PIC S9(0004) COMP.
  1954     05  BCMPNYF PIC  X(0001).
  1955     05  FILLER REDEFINES BCMPNYF.
  1956         10  BCMPNYA PIC  X(0001).
  1957     05  BCMPNYI PIC  X(0003).
  1958*    -------------------------------
  1959     05  BUSERIDL PIC S9(0004) COMP.
  1960     05  BUSERIDF PIC  X(0001).
  1961     05  FILLER REDEFINES BUSERIDF.
  1962         10  BUSERIDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  41
* EL640.cbl
  1963     05  BUSERIDI PIC  X(0004).
  1964*    -------------------------------
  1965     05  BCHKNOL PIC S9(0004) COMP.
  1966     05  BCHKNOF PIC  X(0001).
  1967     05  FILLER REDEFINES BCHKNOF.
  1968         10  BCHKNOA PIC  X(0001).
  1969     05  BCHKNOI PIC  9(6).
  1970*    -------------------------------
  1971     05  BNAMEL PIC S9(0004) COMP.
  1972     05  BNAMEF PIC  X(0001).
  1973     05  FILLER REDEFINES BNAMEF.
  1974         10  BNAMEA PIC  X(0001).
  1975     05  BNAMEI PIC  X(0029).
  1976*    -------------------------------
  1977     05  BCHKAMTL PIC S9(0004) COMP.
  1978     05  BCHKAMTF PIC  X(0001).
  1979     05  FILLER REDEFINES BCHKAMTF.
  1980         10  BCHKAMTA PIC  X(0001).
  1981     05  BCHKAMTI PIC  S9(9)V99.
  1982*    -------------------------------
  1983     05  BADDR1L PIC S9(0004) COMP.
  1984     05  BADDR1F PIC  X(0001).
  1985     05  FILLER REDEFINES BADDR1F.
  1986         10  BADDR1A PIC  X(0001).
  1987     05  BADDR1I PIC  X(0029).
  1988*    -------------------------------
  1989     05  BADDR2L PIC S9(0004) COMP.
  1990     05  BADDR2F PIC  X(0001).
  1991     05  FILLER REDEFINES BADDR2F.
  1992         10  BADDR2A PIC  X(0001).
  1993     05  BADDR2I PIC  X(0029).
  1994*    -------------------------------
  1995     05  BPAYDT1L PIC S9(0004) COMP.
  1996     05  BPAYDT1F PIC  X(0001).
  1997     05  FILLER REDEFINES BPAYDT1F.
  1998         10  BPAYDT1A PIC  X(0001).
  1999     05  BPAYDT1I PIC  X(0008).
  2000*    -------------------------------
  2001     05  BCITYSTL PIC S9(0004) COMP.
  2002     05  BCITYSTF PIC  X(0001).
  2003     05  FILLER REDEFINES BCITYSTF.
  2004         10  BCITYSTA PIC  X(0001).
  2005     05  BCITYSTI PIC  X(0029).
  2006*    -------------------------------
  2007     05  BPAYDT2L PIC S9(0004) COMP.
  2008     05  BPAYDT2F PIC  X(0001).
  2009     05  FILLER REDEFINES BPAYDT2F.
  2010         10  BPAYDT2A PIC  X(0001).
  2011     05  BPAYDT2I PIC  X(0008).
  2012*    -------------------------------
  2013     05  BZIPL PIC S9(0004) COMP.
  2014     05  BZIPF PIC  X(0001).
  2015     05  FILLER REDEFINES BZIPF.
  2016         10  BZIPA PIC  X(0001).
  2017     05  BZIPI PIC  X(0010).
  2018*    -------------------------------
  2019     05  BACCNAML PIC S9(0004) COMP.
  2020     05  BACCNAMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  42
* EL640.cbl
  2021     05  FILLER REDEFINES BACCNAMF.
  2022         10  BACCNAMA PIC  X(0001).
  2023     05  BACCNAMI PIC  X(0030).
  2024*    -------------------------------
  2025     05  BACCTL PIC S9(0004) COMP.
  2026     05  BACCTF PIC  X(0001).
  2027     05  FILLER REDEFINES BACCTF.
  2028         10  BACCTA PIC  X(0001).
  2029     05  BACCTI PIC  X(0010).
  2030*    -------------------------------
  2031     05  BCARIERL PIC S9(0004) COMP.
  2032     05  BCARIERF PIC  X(0001).
  2033     05  FILLER REDEFINES BCARIERF.
  2034         10  BCARIERA PIC  X(0001).
  2035     05  BCARIERI PIC  X(0001).
  2036*    -------------------------------
  2037     05  BGROUPL PIC S9(0004) COMP.
  2038     05  BGROUPF PIC  X(0001).
  2039     05  FILLER REDEFINES BGROUPF.
  2040         10  BGROUPA PIC  X(0001).
  2041     05  BGROUPI PIC  X(0006).
  2042*    -------------------------------
  2043     05  BSTATEL PIC S9(0004) COMP.
  2044     05  BSTATEF PIC  X(0001).
  2045     05  FILLER REDEFINES BSTATEF.
  2046         10  BSTATEA PIC  X(0001).
  2047     05  BSTATEI PIC  X(0002).
  2048*    -------------------------------
  2049     05  BFORM1L PIC S9(0004) COMP.
  2050     05  BFORM1F PIC  X(0001).
  2051     05  FILLER REDEFINES BFORM1F.
  2052         10  BFORM1A PIC  X(0001).
  2053     05  BFORM1I PIC  X(0004).
  2054*    -------------------------------
  2055     05  BFORM2L PIC S9(0004) COMP.
  2056     05  BFORM2F PIC  X(0001).
  2057     05  FILLER REDEFINES BFORM2F.
  2058         10  BFORM2A PIC  X(0001).
  2059     05  BFORM2I PIC  X(0004).
  2060*    -------------------------------
  2061     05  BFORM3L PIC S9(0004) COMP.
  2062     05  BFORM3F PIC  X(0001).
  2063     05  FILLER REDEFINES BFORM3F.
  2064         10  BFORM3A PIC  X(0001).
  2065     05  BFORM3I PIC  X(0004).
  2066*    -------------------------------
  2067     05  BALAMTL PIC S9(0004) COMP.
  2068     05  BALAMTF PIC  X(0001).
  2069     05  FILLER REDEFINES BALAMTF.
  2070         10  BALAMTA PIC  X(0001).
  2071     05  BALAMTI PIC  X(0011).
  2072*    -------------------------------
  2073     05  BERMSGL PIC S9(0004) COMP.
  2074     05  BERMSGF PIC  X(0001).
  2075     05  FILLER REDEFINES BERMSGF.
  2076         10  BERMSGA PIC  X(0001).
  2077     05  BERMSGI PIC  X(0078).
  2078*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  43
* EL640.cbl
  2079     05  BPFNTERL PIC S9(0004) COMP.
  2080     05  BPFNTERF PIC  X(0001).
  2081     05  FILLER REDEFINES BPFNTERF.
  2082         10  BPFNTERA PIC  X(0001).
  2083     05  BPFNTERI PIC  9(2).
  2084 01  EL640BO REDEFINES EL640AI.
  2085     05  FILLER            PIC  X(0012).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  BDATEO PIC  X(0008).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  BTIMEO PIC  99.99.
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  BCMPNYO PIC  X(0003).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  BUSERIDO PIC  X(0004).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  BCHKNOO PIC  X(0006).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  BNAMEO PIC  X(0029).
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  BCHKAMTO PIC  Z(7).ZZ-.
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  BADDR1O PIC  X(0029).
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  BADDR2O PIC  X(0029).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  BPAYDT1O PIC  X(0008).
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  BCITYSTO PIC  X(0029).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  BPAYDT2O PIC  X(0008).
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  BZIPO PIC  X(0010).
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  BACCNAMO PIC  X(0030).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  BACCTO PIC  X(0010).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  BCARIERO PIC  X(0001).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  BGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  44
* EL640.cbl
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  BSTATEO PIC  X(0002).
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  BFORM1O PIC  X(0004).
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  BFORM2O PIC  X(0004).
  2146*    -------------------------------
  2147     05  FILLER            PIC  X(0003).
  2148     05  BFORM3O PIC  X(0004).
  2149*    -------------------------------
  2150     05  FILLER            PIC  X(0003).
  2151     05  BALAMTO PIC  Z(7).99-.
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  BERMSGO PIC  X(0078).
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  BPFNTERO PIC  9(2).
  2158*    -------------------------------
  2159 01  MAP-A REDEFINES EL640AO.
  2160     12  FILLER                  PIC X(162).
  2161     12  FILLER OCCURS 6 TIMES INDEXED BY ANDX.
  2162         16  FILLER              PIC X(35).
  2163         16  BATCH-LEN           PIC S9(4)   COMP.
  2164         16  BATCH-ATTRB         PIC X.
  2165         16  BATCH               PIC X(6).
  2166         16  BILL-LEN            PIC S9(4)   COMP.
  2167         16  BILL-ATTRB          PIC X.
  2168         16  BILL                PIC Z(6).
  2169         16  PREV-LEN            PIC S9(4)   COMP.
  2170         16  PREV-ATTRB          PIC X.
  2171         16  PREV                PIC Z(6).
  2172         16  NOBILL-LEN          PIC S9(4)   COMP.
  2173         16  NOBILL-ATTRB        PIC X.
  2174         16  NOBILL              PIC Z(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  45
* EL640.cbl
  2176****************************************************************
  2177*
  2178* Copyright (c) 2007 by Clerity Solutions, Inc.
  2179* All rights reserved.
  2180*
  2181****************************************************************
  2182 01  DFHEIV.
  2183   02  DFHEIV0               PIC X(35).
  2184   02  DFHEIV1               PIC X(08).
  2185   02  DFHEIV2               PIC X(08).
  2186   02  DFHEIV3               PIC X(08).
  2187   02  DFHEIV4               PIC X(06).
  2188   02  DFHEIV5               PIC X(04).
  2189   02  DFHEIV6               PIC X(04).
  2190   02  DFHEIV7               PIC X(02).
  2191   02  DFHEIV8               PIC X(02).
  2192   02  DFHEIV9               PIC X(01).
  2193   02  DFHEIV10              PIC S9(7) COMP-3.
  2194   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2195   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2196   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2197   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2198   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2199   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2200   02  DFHEIV17              PIC X(04).
  2201   02  DFHEIV18              PIC X(04).
  2202   02  DFHEIV19              PIC X(04).
  2203   02  DFHEIV20              USAGE IS POINTER.
  2204   02  DFHEIV21              USAGE IS POINTER.
  2205   02  DFHEIV22              USAGE IS POINTER.
  2206   02  DFHEIV23              USAGE IS POINTER.
  2207   02  DFHEIV24              USAGE IS POINTER.
  2208   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2209   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2210   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2211   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2212   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2213   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2214   02  FILLER                PIC X(02).
  2215   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2216   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2217   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2218   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2219   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2220 LINKAGE  SECTION.
  2221*****************************************************************
  2222*                                                               *
  2223* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2224* All rights reserved.                                          *
  2225*                                                               *
  2226*****************************************************************
  2227 01  dfheiblk.
  2228     02  eibtime          pic s9(7) comp-3.
  2229     02  eibdate          pic s9(7) comp-3.
  2230     02  eibtrnid         pic x(4).
  2231     02  eibtaskn         pic s9(7) comp-3.
  2232     02  eibtrmid         pic x(4).
  2233     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  46
* EL640.cbl
  2234     02  eibcposn         pic s9(4) comp.
  2235     02  eibcalen         pic s9(4) comp.
  2236     02  eibaid           pic x(1).
  2237     02  eibfiller1       pic x(1).
  2238     02  eibfn            pic x(2).
  2239     02  eibfiller2       pic x(2).
  2240     02  eibrcode         pic x(6).
  2241     02  eibfiller3       pic x(2).
  2242     02  eibds            pic x(8).
  2243     02  eibreqid         pic x(8).
  2244     02  eibrsrce         pic x(8).
  2245     02  eibsync          pic x(1).
  2246     02  eibfree          pic x(1).
  2247     02  eibrecv          pic x(1).
  2248     02  eibsend          pic x(1).
  2249     02  eibatt           pic x(1).
  2250     02  eibeoc           pic x(1).
  2251     02  eibfmh           pic x(1).
  2252     02  eibcompl         pic x(1).
  2253     02  eibsig           pic x(1).
  2254     02  eibconf          pic x(1).
  2255     02  eiberr           pic x(1).
  2256     02  eibrldbk         pic x(1).
  2257     02  eiberrcd         pic x(4).
  2258     02  eibsynrb         pic x(1).
  2259     02  eibnodat         pic x(1).
  2260     02  eibfiller5       pic x(2).
  2261     02  eibresp          pic 9(09) comp.
  2262     02  eibresp2         pic 9(09) comp.
  2263     02  dfheigdj         pic s9(4) comp.
  2264     02  dfheigdk         pic s9(4) comp.
  2265 01  DFHCOMMAREA             PIC X(1024).
  2266
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  47
* EL640.cbl
  2269*                            COPY ERCPNDB.
  2270******************************************************************
  2271*                                                                *
  2272*                                                                *
  2273*                            ERCPNDB.                            *
  2274*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2275*                            VMOD=2.025                          *
  2276*                                                                *
  2277*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2278*                                                                *
  2279******************************************************************
  2280*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2281*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2282******************************************************************
  2283*                                                                *
  2284*                                                                *
  2285*   FILE TYPE = VSAM,KSDS                                        *
  2286*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2287*                                                                *
  2288*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2289*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2290*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2291*                                                 RKP=13,LEN=36  *
  2292*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2293*                                      AND CHG-SEQ.)             *
  2294*                                                RKP=49,LEN=11   *
  2295*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2296*                                      AND CHG-SEQ.)             *
  2297*                                                RKP=60,LEN=15   *
  2298*                                                                *
  2299*   LOG = NO                                                     *
  2300*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2301******************************************************************
  2302******************************************************************
  2303*                   C H A N G E   L O G
  2304*
  2305* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2306*-----------------------------------------------------------------
  2307*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2308* EFFECTIVE    NUMBER
  2309*-----------------------------------------------------------------
  2310* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2311* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2312* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2313* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2314* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2315* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2316* 032306                   PEMA  ADD BOW LOAN NUMBER
  2317* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2318* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2319* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2320* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2321* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2322* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2323* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2324******************************************************************
  2325
  2326 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  48
* EL640.cbl
  2327     12  PB-RECORD-ID                     PIC XX.
  2328         88  VALID-PB-ID                        VALUE 'PB'.
  2329
  2330     12  PB-CONTROL-PRIMARY.
  2331         16  PB-COMPANY-CD                PIC X.
  2332         16  PB-ENTRY-BATCH               PIC X(6).
  2333         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2334         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2335
  2336     12  PB-CONTROL-BY-ACCOUNT.
  2337         16  PB-COMPANY-CD-A1             PIC X.
  2338         16  PB-CARRIER                   PIC X.
  2339         16  PB-GROUPING.
  2340             20  PB-GROUPING-PREFIX       PIC XXX.
  2341             20  PB-GROUPING-PRIME        PIC XXX.
  2342         16  PB-STATE                     PIC XX.
  2343         16  PB-ACCOUNT.
  2344             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2345             20  PB-ACCOUNT-PRIME         PIC X(6).
  2346         16  PB-CERT-EFF-DT               PIC XX.
  2347         16  PB-CERT-NO.
  2348             20  PB-CERT-PRIME            PIC X(10).
  2349             20  PB-CERT-SFX              PIC X.
  2350         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2351
  2352         16  PB-RECORD-TYPE               PIC X.
  2353             88  PB-MAILING-DATA                VALUE '0'.
  2354             88  PB-ISSUE                       VALUE '1'.
  2355             88  PB-CANCELLATION                VALUE '2'.
  2356             88  PB-BATCH-TRAILER               VALUE '9'.
  2357
  2358     12  PB-CONTROL-BY-ORIG-BATCH.
  2359         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2360         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2361         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2362         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2363
  2364     12  PB-CONTROL-BY-CSR.
  2365         16  PB-CSR-COMPANY-CD            PIC X.
  2366         16  PB-CSR-ID                    PIC X(4).
  2367         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2368         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2369         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2370******************************************************************
  2371*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2372******************************************************************
  2373
  2374     12  PB-LAST-MAINT-DT                 PIC XX.
  2375     12  PB-LAST-MAINT-BY                 PIC X(4).
  2376     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2377
  2378     12  PB-RECORD-BODY                   PIC X(375).
  2379
  2380     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2381         16  PB-CERT-ORIGIN               PIC X.
  2382             88  CLASIC-CREATED-CERT         VALUE '1'.
  2383         16  PB-I-NAME.
  2384             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  49
* EL640.cbl
  2385             20  PB-I-INSURED-FIRST-NAME.
  2386                 24  PB-I-INSURED-1ST-INIT PIC X.
  2387                 24  FILLER                PIC X(9).
  2388             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2389         16  PB-I-AGE                     PIC S99   COMP-3.
  2390         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2391         16  PB-I-BIRTHDAY                PIC XX.
  2392         16  PB-I-INSURED-SEX             PIC X.
  2393             88  PB-SEX-MALE     VALUE 'M'.
  2394             88  PB-SEX-FEMALE   VALUE 'F'.
  2395
  2396         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2397         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2398         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2399         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2400         16  PB-I-SKIP-CODE               PIC X.
  2401             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2402             88  PB-SKIP-JULY              VALUE '1'.
  2403             88  PB-SKIP-AUGUST            VALUE '2'.
  2404             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2405             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2406             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2407             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2408             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2409             88  PB-SKIP-JUNE              VALUE '8'.
  2410             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2411             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2412             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2413         16  PB-I-TERM-TYPE               PIC X.
  2414             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2415             88  PB-PAID-WEEKLY            VALUE 'W'.
  2416             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2417             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2418             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2419         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2420         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2421         16  PB-I-DATA-ENTRY-SW           PIC X.
  2422             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2423             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2424             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2425             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2426         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2427         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2428*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2429         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2430         16  FILLER                       PIC X.
  2431
  2432         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2433             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2434             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2435                                                   '90' THRU '99'.
  2436         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2437                                          PIC XX.
  2438         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2439         16  PB-I-AMOUNT-FINANCED REDEFINES
  2440                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2441         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2442         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  50
* EL640.cbl
  2443                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2444         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2445         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2446         16  PB-I-CLP-AMOUNT REDEFINES
  2447                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2448         16  PB-I-LF-CALC-FLAG            PIC X.
  2449             88 PB-COMP-LF-PREM               VALUE '?'.
  2450         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2451         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2452         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2453         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2454         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2455         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2456         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2457         16  PB-I-LF-ABBR                 PIC XXX.
  2458         16  PB-I-LF-INPUT-CD             PIC XX.
  2459
  2460         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2461             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2462             88  PB-INVALID-AH               VALUE '  ' '00'
  2463                                                   '90' THRU '99'.
  2464         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2465         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2466         16  PB-I-AH-CALC-FLAG            PIC X.
  2467             88 PB-COMP-AH-PREM                  VALUE '?'.
  2468         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2469         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2470         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2471         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2472         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2473         16  PB-I-AH-ABBR                 PIC XXX.
  2474         16  PB-I-AH-INPUT-CD             PIC XXX.
  2475
  2476         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2477         16  PB-I-REIN-TABLE              PIC XXX.
  2478         16  PB-I-BUSINESS-TYPE           PIC 99.
  2479         16  PB-I-INDV-GRP-CD             PIC X.
  2480         16  PB-I-MORT-CODE.
  2481             20  PB-I-TABLE               PIC X.
  2482             20  PB-I-INTEREST            PIC XX.
  2483             20  PB-I-MORT-TYP            PIC X.
  2484         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2485         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2486         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2487         16  PB-I-INDV-GRP-OVRD           PIC X.
  2488         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2489         16  PB-I-SIG-SW                  PIC X.
  2490             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2491         16  PB-I-RATE-CLASS              PIC XX.
  2492         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2493         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2494         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2495         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2496         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2497         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2498         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  2499         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2500         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  51
* EL640.cbl
  2501             88  PB-I-OB                      VALUE 'B'.
  2502             88  PB-I-SUMMARY                 VALUE 'Z'.
  2503         16  PB-I-ENTRY-STATUS            PIC X.
  2504             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2505                                              'M' '5' '9' '2'.
  2506             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2507             88  PB-I-POLICY-PENDING          VALUE '2'.
  2508             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2509             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2510             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2511             88  PB-I-REIN-ONLY               VALUE '9'.
  2512             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2513             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2514             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2515             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2516         16  PB-I-INT-CODE                PIC X.
  2517             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2518             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2519         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2520         16  PB-I-SOC-SEC-NO              PIC X(11).
  2521         16  PB-I-MEMBER-NO               PIC X(12).
  2522         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2523*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2524         16  PB-I-OLD-LOF                 PIC XXX.
  2525         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2526         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2527         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2528         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2529         16  PB-I-LIFE-INDICATOR          PIC X.
  2530             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2531         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2532         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2533             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2534             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2535         16  PB-I-1ST-PMT-DT              PIC XX.
  2536         16  PB-I-JOINT-INSURED.
  2537             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2538             20 PB-I-JOINT-FIRST-NAME.
  2539                24  PB-I-JOINT-FIRST-INIT PIC X.
  2540                24  FILLER                PIC X(9).
  2541             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2542*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2543         16  PB-I-BENEFICIARY-NAME.
  2544             20  PB-I-BANK-NUMBER         PIC X(10).
  2545             20  FILLER                   PIC X(15).
  2546         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2547         16  PB-I-REFERENCE               PIC X(12).
  2548         16  FILLER REDEFINES PB-I-REFERENCE.
  2549             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2550             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2551             20  PB-I-CLP-STATE           PIC XX.
  2552         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2553             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  2554             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2555             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2556         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2557         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2558         16  PB-I-RESIDENT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  52
* EL640.cbl
  2559         16  PB-I-RATE-CODE               PIC X(4).
  2560         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2561         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2562         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2563         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2564         16  PB-I-BANK-NOCHRGB            PIC 99.
  2565         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2566         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2567
  2568     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2569         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2570             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2571         16  PB-C-CANCEL-ORIGIN           PIC X.
  2572             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2573         16  PB-C-LF-CANCEL-DT            PIC XX.
  2574         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2575         16  PB-C-LF-CALC-REQ             PIC X.
  2576             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2577         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2578         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2579         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2580             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2581         16  PB-C-AH-CANCEL-DT            PIC XX.
  2582         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2583         16  PB-C-AH-CALC-REQ             PIC X.
  2584             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2585         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2586         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2587         16  PB-C-LAST-NAME               PIC X(15).
  2588         16  PB-C-REFUND-SW               PIC X.
  2589             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2590             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2591         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2592         16  PB-C-PAYEE-CODE              PIC X(6).
  2593         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2594         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2595         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2596         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2597         16  PB-C-REFERENCE               PIC X(12).
  2598         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2599         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2600         16  PB-C-POST-CARD-IND           PIC X.
  2601         16  PB-C-CANCEL-REASON           PIC X.
  2602         16  PB-C-REF-INTERFACE-SW        PIC X.
  2603         16  FILLER                       PIC X(09).
  2604*        16  FILLER                       PIC X(18).
  2605         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2606*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2607         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2608         16  PB-CANCELED-CERT-DATA.
  2609             20  PB-CI-INSURED-NAME.
  2610                 24  PB-CI-LAST-NAME      PIC X(15).
  2611                 24  PB-CI-INITIALS       PIC XX.
  2612             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2613             20  PB-CI-INSURED-SEX        PIC X.
  2614             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2615             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2616             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  53
* EL640.cbl
  2617             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2618             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2619             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2620             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2621             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2622             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2623             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2624             20  PB-CI-RATE-CLASS         PIC XX.
  2625             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2626             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2627             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2628             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2629             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2630             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2631             20  PB-CI-LF-ABBR            PIC X(3).
  2632             20  PB-CI-AH-ABBR            PIC X(3).
  2633             20  PB-CI-OB-FLAG            PIC X.
  2634                 88  PB-CI-OB                VALUE 'B'.
  2635             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2636                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2637                                           'M' '4' '5' '9' '2'.
  2638                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2639                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2640                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2641                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2642                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2643                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2644                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2645                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2646                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2647                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2648                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2649                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2650             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2651                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2652                                           'M' '4' '5' '9' '2'.
  2653                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2654                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2655                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2656                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2657                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2658                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2659                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2660                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2661                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2662                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2663                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2664                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2665             20  PB-CI-PAY-FREQUENCY      PIC 99.
  2666             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2667             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2668             20  PB-CI-MEMBER-NO          PIC X(12).
  2669             20  PB-CI-INT-CODE           PIC X.
  2670                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2671                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2672             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2673             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2674             20  PB-CI-COMP-EXCP-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  54
* EL640.cbl
  2675                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2676                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2677             20  PB-CI-ENTRY-STATUS       PIC X.
  2678             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2679             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2680             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2681             20  PB-CI-DEATH-DT           PIC XX.
  2682             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2683             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2684             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2685             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2686             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2687             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2688             20  PB-CI-ENTRY-DT              PIC XX.
  2689             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2690             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2691             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2692             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2693             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2694             20  PB-CI-OLD-LOF               PIC XXX.
  2695*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2696             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2697             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2698             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2699             20  PB-CI-INDV-GRP-CD           PIC X.
  2700             20  PB-CI-BENEFICIARY-NAME.
  2701                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2702                 24  FILLER                  PIC X(15).
  2703             20  PB-CI-NOTE-SW               PIC X.
  2704             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2705             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2706             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2707             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2708             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2709             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2710             20  PB-CI-FIRST-NAME            PIC X(10).
  2711
  2712         16  FILLER                       PIC X(17).
  2713*032306  16  FILLER                       PIC X(27).
  2714*        16  FILLER                       PIC X(46).
  2715
  2716     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2717         16  FILLER                       PIC X(10).
  2718         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2719         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2720         16  PB-M-INSURED-MID-INIT        PIC X.
  2721         16  PB-M-INSURED-AGE             PIC 99.
  2722         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  2723         16  PB-M-INSURED-SEX             PIC X.
  2724         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2725         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2726         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2727         16  PB-M-INSURED-CITY-STATE.
  2728             20  PB-M-INSURED-CITY        PIC X(28).
  2729             20  PB-M-INSURED-STATE       PIC XX.
  2730         16  PB-M-INSURED-ZIP-CODE.
  2731             20  PB-M-INSURED-ZIP-PRIME.
  2732                 24  PB-M-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  55
* EL640.cbl
  2733                     88  PB-M-CANADIAN-POST-CODE
  2734                                             VALUE 'A' THRU 'Z'.
  2735                 24  FILLER               PIC X(4).
  2736             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2737         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2738                                        PB-M-INSURED-ZIP-CODE.
  2739             20  PM-M-INS-CAN-POST1       PIC XXX.
  2740             20  PM-M-INS-CAN-POST2       PIC XXX.
  2741             20  FILLER                   PIC XXX.
  2742         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2743         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2744         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2745         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2746         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2747         16  PB-M-CRED-BENE-CITYST.
  2748             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2749             20  PB-M-CRED-BENE-STATE     PIC XX.
  2750         16  FILLER                       PIC X(92).
  2751
  2752     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2753         16  FILLER                       PIC X(10).
  2754         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2755         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2756         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2757         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2758         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2759         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2760         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2761         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2762         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2763         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2764         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2765         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2766         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2767         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2768         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2769         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2770         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2771         16  PB-ACCOUNT-NAME              PIC X(30).
  2772         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2773         16  PB-REFERENCE                 PIC X(12).
  2774         16  PB-B-RECEIVED-DT             PIC XX.
  2775         16  FILLER                       PIC X(234).
  2776
  2777     12  PB-RECORD-STATUS.
  2778         16  PB-CREDIT-SELECT-DT          PIC XX.
  2779         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2780         16  PB-BILLED-DT                 PIC XX.
  2781         16  PB-BILLING-STATUS            PIC X.
  2782             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2783             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2784             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2785         16  PB-RECORD-BILL               PIC X.
  2786             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2787             88  PB-RECORD-RETURNED           VALUE 'R'.
  2788             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2789             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2790             88  PB-OVERRIDE-AH               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  56
* EL640.cbl
  2791             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2792         16  PB-BATCH-ENTRY               PIC X.
  2793             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2794             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2795             88  PB-REISSUED-CERT             VALUE 'E'.
  2796             88  PB-MONTHLY-CERT              VALUE 'M'.
  2797             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2798             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2799             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2800         16  PB-FORCE-CODE                PIC X.
  2801             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2802             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2803             88  PB-CANCEL-FORCE              VALUE '8'.
  2804             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2805             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2806             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2807             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2808             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2809             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2810             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2811         16  PB-FATAL-FLAG                PIC X.
  2812             88  PB-FATAL-ERRORS              VALUE 'X'.
  2813         16  PB-FORCE-ER-CD               PIC X.
  2814             88  PB-FORCE-ERRORS              VALUE 'F'.
  2815             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2816         16  PB-WARN-ER-CD                PIC X.
  2817             88  PB-WARNING-ERRORS            VALUE 'W'.
  2818         16  FILLER                       PIC X.
  2819         16  PB-OUT-BAL-CD                PIC X.
  2820             88  PB-OUT-OF-BAL                VALUE 'O'.
  2821         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2822         16  PB-AH-OVERRIDE-L1            PIC X.
  2823         16  PB-INPUT-DT                  PIC XX.
  2824         16  PB-INPUT-BY                  PIC X(4).
  2825         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2826         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2827         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2828         16  PB-LF-EARNING-METHOD         PIC X.
  2829         16  PB-AH-EARNING-METHOD         PIC X.
  2830         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2831         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2832         16  PB-REIN-CD                   PIC XXX.
  2833         16  PB-LF-REFUND-TYPE            PIC X.
  2834         16  PB-AH-REFUND-TYPE            PIC X.
  2835         16  PB-ACCT-EFF-DT               PIC XX.
  2836         16  PB-ACCT-EXP-DT               PIC XX.
  2837         16  PB-COMPANY-ID                PIC X(3).
  2838         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2839         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2840         16  PB-SV-CARRIER                PIC X.
  2841         16  PB-SV-GROUPING               PIC X(6).
  2842         16  PB-SV-STATE                  PIC XX.
  2843         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2844         16  PB-GA-BILLING-INFO.
  2845             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2846                                          PIC XX.
  2847         16  PB-SV-REMIT-TO  REDEFINES
  2848             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  57
* EL640.cbl
  2849         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2850         16  PB-I-LOAN-OFFICER            PIC X(5).
  2851         16  PB-I-VIN                     PIC X(17).
  2852
  2853         16  FILLER                       PIC X(04).
  2854         16  IMNET-BYPASS-SW              PIC X.
  2855
  2856******************************************************************
  2857*                COMMON EDIT ERRORS                              *
  2858******************************************************************
  2859
  2860     12  PB-COMMON-ERRORS.
  2861         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2862                                           PIC S9(4)     COMP.
  2863
  2864******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  58
* EL640.cbl
  2866*                            COPY ELCCNTL.
  2867******************************************************************
  2868*                                                                *
  2869*                                                                *
  2870*                            ELCCNTL.                            *
  2871*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2872*                            VMOD=2.059                          *
  2873*                                                                *
  2874*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2875*                                                                *
  2876*   FILE TYPE = VSAM,KSDS                                        *
  2877*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2878*                                                                *
  2879*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2880*       ALTERNATE INDEX = NONE                                   *
  2881*                                                                *
  2882*   LOG = YES                                                    *
  2883*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2884******************************************************************
  2885*                   C H A N G E   L O G
  2886*
  2887* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2888*-----------------------------------------------------------------
  2889*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2890* EFFECTIVE    NUMBER
  2891*-----------------------------------------------------------------
  2892* 082503                   PEMA  ADD BENEFIT GROUP
  2893* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2894* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2895* 092705    2005050300006  PEMA  ADD SPP LEASES
  2896* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2897* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2898* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2899* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2900******************************************************************
  2901*
  2902 01  CONTROL-FILE.
  2903     12  CF-RECORD-ID                       PIC XX.
  2904         88  VALID-CF-ID                        VALUE 'CF'.
  2905
  2906     12  CF-CONTROL-PRIMARY.
  2907         16  CF-COMPANY-ID                  PIC XXX.
  2908         16  CF-RECORD-TYPE                 PIC X.
  2909             88  CF-COMPANY-MASTER              VALUE '1'.
  2910             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2911             88  CF-STATE-MASTER                VALUE '3'.
  2912             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2913             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2914             88  CF-CARRIER-MASTER              VALUE '6'.
  2915             88  CF-MORTALITY-MASTER            VALUE '7'.
  2916             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2917             88  CF-TERMINAL-MASTER             VALUE '9'.
  2918             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2919             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2920             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2921             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2922             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2923             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  59
* EL640.cbl
  2924             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2925             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2926             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2927         16  CF-ACCESS-CD-GENL              PIC X(4).
  2928         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2929             20  CF-PROCESSOR               PIC X(4).
  2930         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2931             20  CF-STATE-CODE              PIC XX.
  2932             20  FILLER                     PIC XX.
  2933         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2934             20  FILLER                     PIC XX.
  2935             20  CF-HI-BEN-IN-REC           PIC XX.
  2936         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2937             20  FILLER                     PIC XXX.
  2938             20  CF-CARRIER-CNTL            PIC X.
  2939         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2940             20  FILLER                     PIC XX.
  2941             20  CF-HI-TYPE-IN-REC          PIC 99.
  2942         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2943             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2944                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2945             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2946             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2947         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2948             20  FILLER                     PIC X.
  2949             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2950         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2951             20  FILLER                     PIC XX.
  2952             20  CF-MORTGAGE-PLAN           PIC XX.
  2953         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2954
  2955     12  CF-LAST-MAINT-DT                   PIC XX.
  2956     12  CF-LAST-MAINT-BY                   PIC X(4).
  2957     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2958
  2959     12  CF-RECORD-BODY                     PIC X(728).
  2960
  2961
  2962****************************************************************
  2963*             COMPANY MASTER RECORD                            *
  2964****************************************************************
  2965
  2966     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2967         16  CF-COMPANY-ADDRESS.
  2968             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2969             20  CF-CL-IN-CARE-OF           PIC X(30).
  2970             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2971             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2972             20  CF-CL-CITY-STATE           PIC X(30).
  2973             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2974             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2975         16  CF-COMPANY-CD                  PIC X.
  2976         16  CF-COMPANY-PASSWORD            PIC X(8).
  2977         16  CF-SECURITY-OPTION             PIC X.
  2978             88  ALL-SECURITY                   VALUE '1'.
  2979             88  COMPANY-VERIFY                 VALUE '2'.
  2980             88  PROCESSOR-VERIFY               VALUE '3'.
  2981             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  60
* EL640.cbl
  2982             88  ALL-BUT-TERM                   VALUE '5'.
  2983         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2984             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2985         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2986             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2987         16  CF-INFORCE-LOCATION            PIC X.
  2988             88  CERTS-ARE-ONLINE               VALUE '1'.
  2989             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2990             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2991         16  CF-LOWER-CASE-LETTERS          PIC X.
  2992         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2993             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2994             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2995             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2996             88  CF-ACCNT-CNTL                  VALUE '3'.
  2997             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2998
  2999         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3000         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3001
  3002         16  CF-LGX-CREDIT-USER             PIC X.
  3003             88  CO-IS-NOT-USER                 VALUE 'N'.
  3004             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3005
  3006         16 CF-CREDIT-CALC-CODES.
  3007             20  CF-CR-REM-TERM-CALC PIC X.
  3008               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3009               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3010               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3011               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3012               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3013               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3014               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3015             20  CF-CR-R78-METHOD           PIC X.
  3016               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3017               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3018
  3019         16  CF-CLAIM-CONTROL-COUNTS.
  3020             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3021                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3022
  3023             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3024                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3025
  3026             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3027                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3028
  3029             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3030                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3031
  3032         16  CF-CURRENT-MONTH-END           PIC XX.
  3033
  3034         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3035             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3036             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3037             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3038             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3039                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  61
* EL640.cbl
  3040                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3041             20  CF-CO-PREM-REJECT-SW       PIC X.
  3042                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3043                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3044             20  CF-CO-REF-REJECT-SW        PIC X.
  3045                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3046                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3047
  3048         16  CF-CO-REPORTING-DT             PIC XX.
  3049         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3050         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3051           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3052           88  CF-CO-MONTH-END                  VALUE '1'.
  3053
  3054         16  CF-LGX-CLAIM-USER              PIC X.
  3055             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3056             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3057
  3058         16  CF-CREDIT-EDIT-CONTROLS.
  3059             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3060             20  CF-MIN-AGE                 PIC 99.
  3061             20  CF-DEFAULT-AGE             PIC 99.
  3062             20  CF-MIN-TERM                PIC S999      COMP-3.
  3063             20  CF-MAX-TERM                PIC S999      COMP-3.
  3064             20  CF-DEFAULT-SEX             PIC X.
  3065             20  CF-JOINT-AGE-INPUT         PIC X.
  3066                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3067             20  CF-BIRTH-DATE-INPUT        PIC X.
  3068                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3069             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3070                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3071                 88  CF-ZERO-CARRIER            VALUE '1'.
  3072                 88  CF-ZERO-GROUPING           VALUE '2'.
  3073                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3074             20  CF-EDIT-SW                 PIC X.
  3075                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3076             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3077             20  CF-CR-PR-METHOD            PIC X.
  3078               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3079               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3080             20  FILLER                     PIC X.
  3081
  3082         16  CF-CREDIT-MISC-CONTROLS.
  3083             20  CF-REIN-TABLE-SW           PIC X.
  3084                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3085             20  CF-COMP-TABLE-SW           PIC X.
  3086                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3087             20  CF-EXPERIENCE-RETENTION-AGE
  3088                                            PIC S9        COMP-3.
  3089             20  CF-CONVERSION-DT           PIC XX.
  3090             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3091             20  CF-RUN-FREQUENCY-SW        PIC X.
  3092                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3093                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3094
  3095             20  CF-CR-CHECK-NO-CONTROL.
  3096                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3097                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  62
* EL640.cbl
  3098                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3099                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3100                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3101                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3102
  3103                 24  CF-CR-CHECK-COUNT       REDEFINES
  3104                     CF-CR-CHECK-COUNTER      PIC X(4).
  3105
  3106                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3107                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3108
  3109                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3110                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3111                 24  CF-MAIL-PROCESSING       PIC X.
  3112                     88  MAIL-PROCESSING          VALUE 'Y'.
  3113
  3114         16  CF-MISC-SYSTEM-CONTROL.
  3115             20  CF-SYSTEM-C                 PIC X.
  3116                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3117             20  CF-SYSTEM-D                 PIC X.
  3118                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3119             20  CF-SOC-SEC-NO-SW            PIC X.
  3120                 88  SOC-SEC-NO-USED             VALUE '1'.
  3121             20  CF-MEMBER-NO-SW             PIC X.
  3122                 88  MEMBER-NO-USED              VALUE '1'.
  3123             20  CF-TAX-ID-NUMBER            PIC X(11).
  3124             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3125             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3126                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3127                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3128                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3129                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3130             20  CF-SYSTEM-E                 PIC X.
  3131                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3132
  3133         16  CF-LGX-LIFE-USER               PIC X.
  3134             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3135             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3136
  3137         16  CF-CR-MONTH-END-DT             PIC XX.
  3138
  3139         16  CF-FILE-MAINT-DATES.
  3140             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3141                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3142             20  CF-LAST-BATCH       REDEFINES
  3143                 CF-LAST-BATCH-NO               PIC X(4).
  3144             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3145             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3146             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3147             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3148             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3149             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3150             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3151             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3152             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3153             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3154
  3155         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  63
* EL640.cbl
  3156         16  FILLER                         PIC X.
  3157
  3158         16  CF-ALT-MORT-CODE               PIC X(4).
  3159         16  CF-MEMBER-CAPTION              PIC X(10).
  3160
  3161         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3162             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3163             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3164             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3165             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3166             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3167
  3168         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3169
  3170         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3171         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3172         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3173         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3174
  3175         16  CF-AH-OVERRIDE-L1              PIC X.
  3176         16  CF-AH-OVERRIDE-L2              PIC XX.
  3177         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3178         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3179
  3180         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3181         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3182
  3183         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3184         16  CF-AR-LAST-EL860-DT            PIC XX.
  3185         16  CF-MP-MONTH-END-DT             PIC XX.
  3186
  3187         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3188         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3189             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3190
  3191         16  CF-AR-MONTH-END-DT             PIC XX.
  3192
  3193         16  CF-CRDTCRD-USER                PIC X.
  3194             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3195             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3196
  3197         16  CF-CC-MONTH-END-DT             PIC XX.
  3198
  3199         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3200
  3201         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3202             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3203             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3204             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3205         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3206         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3207         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3208         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3209             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3210             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3211         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3212         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3213         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  64
* EL640.cbl
  3214             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3215         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3216
  3217         16  CF-CL-ZIP-CODE.
  3218             20  CF-CL-ZIP-PRIME.
  3219                 24  CF-CL-ZIP-1ST          PIC X.
  3220                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3221                 24  FILLER                 PIC X(4).
  3222             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3223         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3224             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3225             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3226             20  FILLER                     PIC XXX.
  3227
  3228         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3229         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3230         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3231         16  CF-CO-OPTION-START-DATE        PIC XX.
  3232         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3233           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3234                                                      '3' '4'.
  3235           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3236           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3237           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3238           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3239           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3240           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3241
  3242         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3243
  3244         16  CF-PAYMENT-APPROVAL-LEVELS.
  3245             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3246             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3247             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3248             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3249             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3250             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3251
  3252         16  CF-END-USER-REPORTING-USER     PIC X.
  3253             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3254             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3255
  3256         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3257             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3258             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3259
  3260         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3261
  3262         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3263         16  FILLER                         PIC X.
  3264
  3265         16  CF-CREDIT-ARCHIVE-CNTL.
  3266             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3267             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3268             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3269
  3270         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3271
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  65
* EL640.cbl
  3272         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3273             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3274             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3275
  3276         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3277             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3278             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3279
  3280         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3281
  3282         16  CF-CO-ACH-ID-CODE              PIC  X.
  3283             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3284             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3285             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3286         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3287         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3288         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3289         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3290         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3291         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3292         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3293         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3294         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3295                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3296         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3297                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3298
  3299         16  CF-CO-OVER-SHORT.
  3300             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3301             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3302
  3303*         16  FILLER                         PIC X(102).
  3304         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3305             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3306             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3307
  3308         16  CF-AH-APPROVAL-DAYS.
  3309             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3310             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3311             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3312             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3313
  3314         16  FILLER                         PIC X(82).
  3315****************************************************************
  3316*             PROCESSOR/USER RECORD                            *
  3317****************************************************************
  3318
  3319     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3320         16  CF-PROCESSOR-NAME              PIC X(30).
  3321         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3322         16  CF-PROCESSOR-TITLE             PIC X(26).
  3323         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3324                 88  MESSAGE-YES                VALUE 'Y'.
  3325                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3326
  3327*****************************************************
  3328****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3329****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  66
* EL640.cbl
  3330****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3331****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3332*****************************************************
  3333
  3334         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3335             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3336             20  CF-APPLICATION-FORCE       PIC X.
  3337             20  CF-INDIVIDUAL-APP.
  3338                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3339                     28  CF-BROWSE-APP      PIC X.
  3340                     28  CF-UPDATE-APP      PIC X.
  3341
  3342         16  CF-CURRENT-TERM-ON             PIC X(4).
  3343         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3344             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3345             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3346             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3347             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3348             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3349             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3350             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3351         16  CF-PROCESSOR-CARRIER           PIC X.
  3352             88  NO-CARRIER-SECURITY            VALUE ' '.
  3353         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3354             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3355         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3356             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3357         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3358             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3359
  3360         16  CF-PROC-SYS-ACCESS-SW.
  3361             20  CF-PROC-CREDIT-CLAIMS-SW.
  3362                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3363                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3364                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3365                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3366             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3367                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3368                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3369             20  CF-PROC-LIFE-GNRLDGR-SW.
  3370                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3371                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3372                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3373                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3374             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3375                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3376                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3377         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3378             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3379             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3380         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3381
  3382         16  CF-APPROVAL-LEVEL                  PIC X.
  3383             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3384             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3385             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3386             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3387
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  67
* EL640.cbl
  3388         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3389
  3390         16  CF-LANGUAGE-TYPE                   PIC X.
  3391             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3392             88  CF-LANG-IS-FR                      VALUE 'F'.
  3393         16  FILLER                             PIC  X(240).
  3394
  3395****************************************************************
  3396*             PROCESSOR/REMINDERS RECORD                       *
  3397****************************************************************
  3398
  3399     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3400         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3401             20  CF-START-REMIND-DT         PIC XX.
  3402             20  CF-END-REMIND-DT           PIC XX.
  3403             20  CF-REMINDER-TEXT           PIC X(50).
  3404         16  FILLER                         PIC X(296).
  3405
  3406
  3407****************************************************************
  3408*             STATE MASTER RECORD                              *
  3409****************************************************************
  3410
  3411     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3412         16  CF-STATE-ABBREVIATION          PIC XX.
  3413         16  CF-STATE-NAME                  PIC X(25).
  3414         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3415         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3416             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3417             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3418             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3419             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3420                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3421                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3422             20  CF-ST-PREM-REJECT-SW       PIC X.
  3423                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3424                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3425             20  CF-ST-REF-REJECT-SW        PIC X.
  3426                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3427                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3428         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3429         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3430         16  CF-ST-REFUND-RULES.
  3431             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3432             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3433             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3434         16  CF-ST-FST-PMT-EXTENSION.
  3435             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3436             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3437                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3438                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3439                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3440                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3441         16  CF-ST-STATE-CALL.
  3442             20  CF-ST-CALL-UNEARNED        PIC X.
  3443             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3444             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3445         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  68
* EL640.cbl
  3446             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3447             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3448         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3449         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3450         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3451         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3452         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3453         16  FILLER                         PIC X.
  3454         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3455             20  CF-ST-BENEFIT-CD           PIC XX.
  3456             20  CF-ST-BENEFIT-KIND         PIC X.
  3457                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3458                 88  CF-ST-AH-KIND              VALUE 'A'.
  3459             20  CF-ST-REM-TERM-CALC        PIC X.
  3460                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3461                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3462                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3463                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3464                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3465                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3466                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3467                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3468
  3469             20  CF-ST-REFUND-CALC          PIC X.
  3470                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3471                 88  ST-REFD-BY-R78             VALUE '1'.
  3472                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3473                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3474                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3475                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3476                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3477                 88  ST-REFD-UTAH               VALUE '7'.
  3478                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3479                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3480                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3481
  3482             20  CF-ST-EARNING-CALC         PIC X.
  3483                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3484                 88  ST-EARN-BY-R78             VALUE '1'.
  3485                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3486                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3487                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3488                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3489                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3490                 88  ST-EARN-MEAN               VALUE '8'.
  3491                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3492
  3493             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3494                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3495                 88  ST-OVRD-BY-R78             VALUE '1'.
  3496                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3497                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3498                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3499                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3500                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3501                 88  ST-OVRD-MEAN               VALUE '8'.
  3502                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3503             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  69
* EL640.cbl
  3504
  3505         16  CF-ST-COMMISSION-CAPS.
  3506             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3507             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3508             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3509             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3510         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3511                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3512
  3513         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3514
  3515         16  CF-ST-STATUTORY-INTEREST.
  3516             20  CF-ST-STAT-DATE-FROM       PIC X.
  3517                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3518                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3519             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3520             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3521             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3522             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3523             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3524
  3525         16  CF-ST-OVER-SHORT.
  3526             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3527             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3528
  3529         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3530
  3531         16  CF-ST-RT-CALC                  PIC X.
  3532
  3533         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3534         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3535         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3536         16  CF-ST-RF-LR-CALC               PIC X.
  3537         16  CF-ST-RF-LL-CALC               PIC X.
  3538         16  CF-ST-RF-LN-CALC               PIC X.
  3539         16  CF-ST-RF-AH-CALC               PIC X.
  3540         16  CF-ST-RF-CP-CALC               PIC X.
  3541*        16  FILLER                         PIC X(206).
  3542*CIDMOD         16  FILLER                         PIC X(192).
  3543         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3544             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3545         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3546         16  FILLER                         PIC X(187).
  3547
  3548****************************************************************
  3549*             BENEFIT MASTER RECORD                            *
  3550****************************************************************
  3551
  3552     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3553         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3554             20  CF-BENEFIT-CODE            PIC XX.
  3555             20  CF-BENEFIT-NUMERIC  REDEFINES
  3556                 CF-BENEFIT-CODE            PIC XX.
  3557             20  CF-BENEFIT-ALPHA           PIC XXX.
  3558             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3559             20  CF-BENEFIT-COMMENT         PIC X(10).
  3560
  3561             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  70
* EL640.cbl
  3562                 88  CF-REDUCING                VALUE 'R'.
  3563                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3564
  3565             20  CF-SPECIAL-CALC-CD         PIC X.
  3566                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3567                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3568                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3569                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3570                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3571                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3572                 88  CF-FARM-PLAN               VALUE 'F'.
  3573                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3574                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3575                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3576                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3577                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3578                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3579                 88  CF-PRUDENTIAL              VALUE 'P'.
  3580                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3581                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3582                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3583                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3584                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3585                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3586
  3587             20  CF-JOINT-INDICATOR         PIC X.
  3588                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3589
  3590*            20  FILLER                     PIC X(12).
  3591             20  FILLER                     PIC X(11).
  3592             20  CF-BENEFIT-CATEGORY        PIC X.
  3593             20  CF-LOAN-TYPE               PIC X(8).
  3594
  3595             20  CF-CO-REM-TERM-CALC        PIC X.
  3596                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3597                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3598                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3599                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3600                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3601
  3602             20  CF-CO-EARNINGS-CALC        PIC X.
  3603                 88  CO-EARN-BY-R78             VALUE '1'.
  3604                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3605                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3606                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3607                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3608                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3609                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3610                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3611
  3612             20  CF-CO-REFUND-CALC          PIC X.
  3613                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3614                 88  CO-REFD-BY-R78             VALUE '1'.
  3615                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3616                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3617                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3618                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3619                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  71
* EL640.cbl
  3620                 88  CO-REFD-MEAN               VALUE '8'.
  3621                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3622                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3623                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3624
  3625             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3626                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3627                 88  CO-OVRD-BY-R78             VALUE '1'.
  3628                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3629                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3630                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3631                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3632                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3633                 88  CO-OVRD-MEAN               VALUE '8'.
  3634                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3635
  3636             20  CF-CO-BEN-I-G-CD           PIC X.
  3637                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3638                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3639                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3640
  3641         16  FILLER                         PIC X(304).
  3642
  3643
  3644****************************************************************
  3645*             CARRIER MASTER RECORD                            *
  3646****************************************************************
  3647
  3648     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3649         16  CF-ADDRESS-DATA.
  3650             20  CF-MAIL-TO-NAME            PIC X(30).
  3651             20  CF-IN-CARE-OF              PIC X(30).
  3652             20  CF-ADDRESS-LINE-1          PIC X(30).
  3653             20  CF-ADDRESS-LINE-2          PIC X(30).
  3654             20  CF-CITY-STATE              PIC X(30).
  3655             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3656             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3657
  3658         16  CF-CLAIM-NO-CONTROL.
  3659             20  CF-CLAIM-NO-METHOD         PIC X.
  3660                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3661                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3662                 88  CLAIM-NO-SEQ               VALUE '3'.
  3663                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3664             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3665                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3666                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3667                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3668
  3669         16  CF-CHECK-NO-CONTROL.
  3670             20  CF-CHECK-NO-METHOD         PIC X.
  3671                 88  CHECK-NO-MANUAL            VALUE '1'.
  3672                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3673                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3674                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3675             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3676                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3677
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  72
* EL640.cbl
  3678         16  CF-DOMICILE-STATE              PIC XX.
  3679
  3680         16  CF-EXPENSE-CONTROLS.
  3681             20  CF-EXPENSE-METHOD          PIC X.
  3682                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3683                 88  DOLLARS-PER-PMT            VALUE '2'.
  3684                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3685                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3686             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3687             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3688
  3689         16  CF-CORRESPONDENCE-CONTROL.
  3690             20  CF-LETTER-RESEND-OPT       PIC X.
  3691                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3692                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3693             20  FILLER                     PIC X(4).
  3694
  3695         16  CF-RESERVE-CONTROLS.
  3696             20  CF-MANUAL-SW               PIC X.
  3697                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3698             20  CF-FUTURE-SW               PIC X.
  3699                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3700             20  CF-PTC-SW                  PIC X.
  3701                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3702             20  CF-IBNR-SW                 PIC X.
  3703                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3704             20  CF-PTC-LF-SW               PIC X.
  3705                 88  CF-LF-PTC-USED             VALUE '1'.
  3706             20  CF-CDT-ACCESS-METHOD       PIC X.
  3707                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3708                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3709                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3710             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3711
  3712         16  CF-CLAIM-CALC-METHOD           PIC X.
  3713             88  360-PLUS-MONTHS                VALUE '1'.
  3714             88  365-PLUS-MONTHS                VALUE '2'.
  3715             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3716             88  360-DAILY                      VALUE '4'.
  3717             88  365-DAILY                      VALUE '5'.
  3718
  3719         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3720         16  FILLER                         PIC X(11).
  3721
  3722         16  CF-LIMIT-AMOUNTS.
  3723             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3724             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3725             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3726             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3727             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3728             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3729             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3730             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3731             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3732             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3733
  3734         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3735         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  73
* EL640.cbl
  3736         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3737
  3738         16  CF-ZIP-CODE.
  3739             20  CF-ZIP-PRIME.
  3740                 24  CF-ZIP-1ST             PIC X.
  3741                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3742                 24  FILLER                 PIC X(4).
  3743             20  CF-ZIP-PLUS4               PIC X(4).
  3744         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3745             20  CF-CAN-POSTAL-1            PIC XXX.
  3746             20  CF-CAN-POSTAL-2            PIC XXX.
  3747             20  FILLER                     PIC XXX.
  3748
  3749         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3750         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3751         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3752
  3753         16  CF-RATING-SWITCH               PIC X.
  3754             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3755             88  CF-NO-RATING                   VALUE 'N'.
  3756
  3757         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3758
  3759         16  CF-CARRIER-OVER-SHORT.
  3760             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3761             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3762
  3763         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3764         16  CF-SECPAY-SWITCH               PIC X.
  3765             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3766             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3767         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3768         16  FILLER                         PIC X(448).
  3769*        16  FILLER                         PIC X(452).
  3770
  3771
  3772****************************************************************
  3773*             MORTALITY MASTER RECORD                          *
  3774****************************************************************
  3775
  3776     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3777         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3778                                INDEXED BY CF-MORT-NDX.
  3779             20  CF-MORT-TABLE              PIC X(5).
  3780             20  CF-MORT-TABLE-TYPE         PIC X.
  3781                 88  CF-MORT-JOINT              VALUE 'J'.
  3782                 88  CF-MORT-SINGLE             VALUE 'S'.
  3783                 88  CF-MORT-COMBINED           VALUE 'C'.
  3784                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3785                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3786             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3787             20  CF-MORT-AGE-METHOD         PIC XX.
  3788                 88  CF-AGE-LAST                VALUE 'AL'.
  3789                 88  CF-AGE-NEAR                VALUE 'AN'.
  3790             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3791             20  CF-MORT-ADJUSTMENT-DIRECTION
  3792                                            PIC X.
  3793                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  74
* EL640.cbl
  3794                 88  CF-PLUS                    VALUE '+'.
  3795             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3796             20  CF-MORT-JOINT-CODE         PIC X.
  3797                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3798             20  CF-MORT-PC-Q               PIC X.
  3799                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3800             20  CF-MORT-TABLE-CODE         PIC X(4).
  3801             20  CF-MORT-COMMENTS           PIC X(15).
  3802             20  FILLER                     PIC X(14).
  3803
  3804         16  FILLER                         PIC X(251).
  3805
  3806
  3807****************************************************************
  3808*             BUSSINESS TYPE MASTER RECORD                     *
  3809****************************************************************
  3810
  3811     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3812* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3813* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3814* AND RECORD 05 IS TYPES 81-99
  3815         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3816             20  CF-BUSINESS-TITLE          PIC  X(19).
  3817             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3818                                            PIC S9V9(4) COMP-3.
  3819             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3820             20  FILLER                     PIC  X.
  3821         16  FILLER                         PIC  X(248).
  3822
  3823
  3824****************************************************************
  3825*             TERMINAL MASTER RECORD                           *
  3826****************************************************************
  3827
  3828     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3829
  3830         16  CF-COMPANY-TERMINALS.
  3831             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3832                                  PIC X(4).
  3833         16  FILLER               PIC X(248).
  3834
  3835
  3836****************************************************************
  3837*             LIFE EDIT MASTER RECORD                          *
  3838****************************************************************
  3839
  3840     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3841         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3842             20  CF-LIFE-CODE-IN            PIC XX.
  3843             20  CF-LIFE-CODE-OUT           PIC XX.
  3844         16  FILLER                         PIC X(248).
  3845
  3846
  3847****************************************************************
  3848*             AH EDIT MASTER RECORD                            *
  3849****************************************************************
  3850
  3851     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  75
* EL640.cbl
  3852         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3853             20  CF-AH-CODE-IN              PIC XXX.
  3854             20  CF-AH-CODE-OUT             PIC XX.
  3855         16  FILLER                         PIC X(248).
  3856
  3857
  3858****************************************************************
  3859*             CREDIBILITY TABLES                               *
  3860****************************************************************
  3861
  3862     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3863         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3864                             INDEXED BY CF-CRDB-NDX.
  3865             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3866             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3867             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3868         16  FILLER                         PIC  X(332).
  3869
  3870
  3871****************************************************************
  3872*             REPORT CUSTOMIZATION RECORD                      *
  3873****************************************************************
  3874
  3875     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3876         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3877             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3878             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3879             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3880**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3881****       A T-TRANSFER.                                   ****
  3882             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3883
  3884         16  FILLER                         PIC XX.
  3885
  3886         16  CF-CARRIER-CNTL-OPT.
  3887             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3888                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3889                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3890             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3891                                            PIC X.
  3892         16  CF-GROUP-CNTL-OPT.
  3893             20  CF-GROUP-OPT-SEQ           PIC 9.
  3894                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3895                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3896             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3897                                            PIC X(6).
  3898         16  CF-STATE-CNTL-OPT.
  3899             20  CF-STATE-OPT-SEQ           PIC 9.
  3900                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3901                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3902             20  CF-STATE-SELECT OCCURS 3 TIMES
  3903                                            PIC XX.
  3904         16  CF-ACCOUNT-CNTL-OPT.
  3905             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3906                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3907                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3908             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3909                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  76
* EL640.cbl
  3910         16  CF-BUS-TYP-CNTL-OPT.
  3911             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3912                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3913                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3914             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3915                                            PIC XX.
  3916         16  CF-LF-TYP-CNTL-OPT.
  3917             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3918                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3919                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3920             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3921                                            PIC XX.
  3922         16  CF-AH-TYP-CNTL-OPT.
  3923             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3924                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3925                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3926             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3927                                            PIC XX.
  3928         16  CF-REPTCD1-CNTL-OPT.
  3929             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3930                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3931                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3932             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3933                                            PIC X(10).
  3934         16  CF-REPTCD2-CNTL-OPT.
  3935             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3936                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3937                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3938             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3939                                            PIC X(10).
  3940         16  CF-USER1-CNTL-OPT.
  3941             20  CF-USER1-OPT-SEQ           PIC 9.
  3942                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3943                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3944             20  CF-USER1-SELECT OCCURS 3 TIMES
  3945                                            PIC X(10).
  3946         16  CF-USER2-CNTL-OPT.
  3947             20  CF-USER2-OPT-SEQ           PIC 9.
  3948                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3949                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3950             20  CF-USER2-SELECT OCCURS 3 TIMES
  3951                                            PIC X(10).
  3952         16  CF-USER3-CNTL-OPT.
  3953             20  CF-USER3-OPT-SEQ           PIC 9.
  3954                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3955                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3956             20  CF-USER3-SELECT OCCURS 3 TIMES
  3957                                            PIC X(10).
  3958         16  CF-USER4-CNTL-OPT.
  3959             20  CF-USER4-OPT-SEQ           PIC 9.
  3960                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3961                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3962             20  CF-USER4-SELECT OCCURS 3 TIMES
  3963                                            PIC X(10).
  3964         16  CF-USER5-CNTL-OPT.
  3965             20  CF-USER5-OPT-SEQ           PIC 9.
  3966                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3967                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  77
* EL640.cbl
  3968             20  CF-USER5-SELECT OCCURS 3 TIMES
  3969                                            PIC X(10).
  3970         16  CF-REINS-CNTL-OPT.
  3971             20  CF-REINS-OPT-SEQ           PIC 9.
  3972                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3973                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3974             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3975                 24  CF-REINS-PRIME         PIC XXX.
  3976                 24  CF-REINS-SUB           PIC XXX.
  3977
  3978         16  CF-AGENT-CNTL-OPT.
  3979             20  CF-AGENT-OPT-SEQ           PIC 9.
  3980                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3981                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3982             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3983                                            PIC X(10).
  3984
  3985         16  FILLER                         PIC X(43).
  3986
  3987         16  CF-LOSS-RATIO-SELECT.
  3988             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3989             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3990         16  CF-ENTRY-DATE-SELECT.
  3991             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3992             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3993         16  CF-EFFECTIVE-DATE-SELECT.
  3994             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3995             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3996
  3997         16  CF-EXCEPTION-LIST-IND          PIC X.
  3998             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3999
  4000         16  FILLER                         PIC X(318).
  4001
  4002****************************************************************
  4003*                  EXCEPTION REPORTING RECORD                  *
  4004****************************************************************
  4005
  4006     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4007         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4008             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4009
  4010         16  CF-COMBINED-LIFE-AH-OPT.
  4011             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4012             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4013             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4014             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4015
  4016         16  CF-LIFE-OPT.
  4017             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4018             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4019             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4020             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4021             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4022             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4023             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4024             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4025             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  78
* EL640.cbl
  4026             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4027
  4028         16  CF-AH-OPT.
  4029             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4030             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4031             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4032             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4033             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4034             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4035             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4036             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4037             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4038             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4039
  4040         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4041             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4042             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4043             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4044
  4045         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4046
  4047         16  FILLER                         PIC X(673).
  4048
  4049
  4050****************************************************************
  4051*             MORTGAGE SYSTEM PLAN RECORD                      *
  4052****************************************************************
  4053
  4054     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4055         16  CF-PLAN-TYPE                   PIC X.
  4056             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4057             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4058             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4059         16  CF-PLAN-ABBREV                 PIC XXX.
  4060         16  CF-PLAN-DESCRIPT               PIC X(10).
  4061         16  CF-PLAN-NOTES                  PIC X(20).
  4062         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4063         16  CF-PLAN-UNDERWRITING.
  4064             20  CF-PLAN-TERM-DATA.
  4065                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4066                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4067             20  CF-PLAN-AGE-DATA.
  4068                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4069                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4070                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4071             20  CF-PLAN-BENEFIT-DATA.
  4072                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4073                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4074                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4075                                            PIC S9(7)V99  COMP-3.
  4076         16  CF-PLAN-POLICY-FORMS.
  4077             20  CF-POLICY-FORM             PIC X(12).
  4078             20  CF-MASTER-APPLICATION      PIC X(12).
  4079             20  CF-MASTER-POLICY           PIC X(12).
  4080         16  CF-PLAN-RATING.
  4081             20  CF-RATE-CODE               PIC X(5).
  4082             20  CF-SEX-RATING              PIC X.
  4083                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  79
* EL640.cbl
  4084                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4085             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4086             20  CF-SUB-STD-TYPE            PIC X.
  4087                 88  CF-PCT-OF-PREM            VALUE '1'.
  4088                 88  CF-PCT-OF-BENE            VALUE '2'.
  4089         16  CF-PLAN-PREM-TOLERANCES.
  4090             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4091             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4092         16  CF-PLAN-PYMT-TOLERANCES.
  4093             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4094             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4095         16  CF-PLAN-MISC-DATA.
  4096             20  FILLER                     PIC X.
  4097             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4098             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4099         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4100         16  CF-PLAN-IND-GRP                PIC X.
  4101             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4102                                                     '1'.
  4103             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4104                                                     '2'.
  4105         16  CF-MIB-SEARCH-SW               PIC X.
  4106             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4107             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4108             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4109             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4110         16  CF-ALPHA-SEARCH-SW             PIC X.
  4111             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4112             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4113             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4114             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4115             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4116             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4117             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4118             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4119             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4120             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4121                                                     'A' 'B' 'C'
  4122                                                     'X' 'Y' 'Z'.
  4123         16  CF-EFF-DT-RULE-SW              PIC X.
  4124             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4125             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4126             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4127             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4128             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4129         16  FILLER                         PIC X(4).
  4130         16  CF-HEALTH-QUESTIONS            PIC X.
  4131             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4132         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4133         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4134         16  CF-PLAN-SNGL-JNT               PIC X.
  4135             88  CF-COMBINED-PLAN              VALUE 'C'.
  4136             88  CF-JNT-PLAN                   VALUE 'J'.
  4137             88  CF-SNGL-PLAN                  VALUE 'S'.
  4138         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4139         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4140         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4141         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  80
* EL640.cbl
  4142         16  CF-RERATE-CNTL                 PIC  X.
  4143             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4144             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4145             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4146             88  CF-AUTO-RECALC                 VALUE '4'.
  4147         16  CF-BENEFIT-TYPE                PIC  X.
  4148             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4149             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4150         16  CF-POLICY-FEE                  PIC S999V99
  4151                                                    COMP-3.
  4152         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4153         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4154         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4155         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4156         16  FILLER                         PIC  X(32).
  4157         16  CF-TERMINATION-FORM            PIC  X(04).
  4158         16  FILLER                         PIC  X(08).
  4159         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4160                                                       COMP-3.
  4161         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4162         16  CF-ISSUE-LETTER                PIC  X(4).
  4163         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4164         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4165             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4166             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4167         16  CF-MP-REFUND-CALC              PIC X.
  4168             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4169             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4170             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4171             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4172             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4173             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4174             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4175             88  CF-MP-REFD-MEAN                VALUE '8'.
  4176         16  CF-ALT-RATE-CODE               PIC  X(5).
  4177
  4178
  4179         16  FILLER                         PIC X(498).
  4180****************************************************************
  4181*             MORTGAGE COMPANY MASTER RECORD                   *
  4182****************************************************************
  4183
  4184     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4185         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4186         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4187             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4188             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4189             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4190             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4191             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4192
  4193         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4194         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4195         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4196         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4197         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4198
  4199         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  81
* EL640.cbl
  4200             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4201         16  CF-MP-RECON-USE-IND            PIC X(1).
  4202             88  CF-MP-USE-RECON             VALUE 'Y'.
  4203         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4204             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4205         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4206             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4207             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4208         16  FILLER                         PIC X(1).
  4209         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4210             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4211         16  CF-MORTG-MIB-VERSION           PIC X.
  4212             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4213             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4214             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4215         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4216             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4217                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4218             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4219                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4220             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4221                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4222             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4223                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4224             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4225                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4226             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4227                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4228         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4229         16  FILLER                         PIC X(7).
  4230         16  CF-MORTG-DESTINATION-SYMBOL.
  4231             20  CF-MORTG-MIB-COMM          PIC X(5).
  4232             20  CF-MORTG-MIB-TERM          PIC X(5).
  4233         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4234             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4235         16  FILLER                         PIC X(03).
  4236         16  CF-MP-CHECK-NO-CONTROL.
  4237             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4238                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4239                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4240                                                ' ' LOW-VALUES.
  4241                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4242                                               VALUE '3'.
  4243         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4244         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4245         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4246             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4247                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4248             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4249                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4250             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4251                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4252             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4253                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4254             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4255                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4256             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4257                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  82
* EL640.cbl
  4258         16  CF-MORTG-BILLING-AREA.
  4259             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4260                                            PIC X.
  4261         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4262         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4263         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4264         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4265             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4266             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4267         16  FILLER                         PIC X.
  4268         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4269             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4270             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4271         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4272         16  FILLER                         PIC X(8).
  4273         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4274         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4275         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4276         16  CF-ACH-COMPANY-ID.
  4277             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4278                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4279                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4280                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4281             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4282         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4283             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4284         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4285             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4286             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4287         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4288         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4289         16  FILLER                         PIC X(536).
  4290
  4291****************************************************************
  4292*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4293****************************************************************
  4294
  4295     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4296         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4297             20  CF-FEMALE-HEIGHT.
  4298                 24  CF-FEMALE-FT           PIC 99.
  4299                 24  CF-FEMALE-IN           PIC 99.
  4300             20  CF-FEMALE-MIN-WT           PIC 999.
  4301             20  CF-FEMALE-MAX-WT           PIC 999.
  4302         16  FILLER                         PIC X(428).
  4303
  4304     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4305         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4306             20  CF-MALE-HEIGHT.
  4307                 24  CF-MALE-FT             PIC 99.
  4308                 24  CF-MALE-IN             PIC 99.
  4309             20  CF-MALE-MIN-WT             PIC 999.
  4310             20  CF-MALE-MAX-WT             PIC 999.
  4311         16  FILLER                         PIC X(428).
  4312******************************************************************
  4313*             AUTOMATIC ACTIVITY RECORD                          *
  4314******************************************************************
  4315     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  83
* EL640.cbl
  4316         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4317             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4318             20  CF-SYS-LETTER-ID           PIC X(04).
  4319             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4320             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4321             20  CF-SYS-RESET-SW            PIC X(01).
  4322             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4323             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4324
  4325         16  FILLER                         PIC X(50).
  4326
  4327         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4328             20  CF-USER-ACTIVE-SW          PIC X(01).
  4329             20  CF-USER-LETTER-ID          PIC X(04).
  4330             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4331             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4332             20  CF-USER-RESET-SW           PIC X(01).
  4333             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4334             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4335             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4336
  4337         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  84
* EL640.cbl
  4339*                            COPY ERCCOMP.
  4340******************************************************************
  4341*                                                                *
  4342*                                                                *
  4343*                            ERCCOMP                             *
  4344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4345*                            VMOD=2.019                          *
  4346*                                                                *
  4347*   ONLINE CREDIT SYSTEM                                         *
  4348*                                                                *
  4349*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4350*                                                                *
  4351*   FILE TYPE = VSAM,KSDS                                        *
  4352*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4353*                                                                *
  4354*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4355*       ALTERNATE PATH = NONE                                    *
  4356*                                                                *
  4357*   LOG = NO                                                     *
  4358*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4359*                                                                *
  4360******************************************************************
  4361*                   C H A N G E   L O G
  4362*
  4363* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4364*-----------------------------------------------------------------
  4365*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4366* EFFECTIVE    NUMBER
  4367*-----------------------------------------------------------------
  4368* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4369* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4370* 092205    2005050300006  PEMA  ADD LEASE FEE
  4371* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4372* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4373* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4374* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4375* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4376******************************************************************
  4377
  4378 01  COMPENSATION-MASTER.
  4379     12  CO-RECORD-ID                          PIC XX.
  4380         88  VALID-CO-ID                          VALUE 'CO'.
  4381
  4382     12  CO-CONTROL-PRIMARY.
  4383         16  CO-COMPANY-CD                     PIC X.
  4384         16  CO-CONTROL.
  4385             20  CO-CTL-1.
  4386                 24  CO-CARR-GROUP.
  4387                     28  CO-CARRIER            PIC X.
  4388                     28  CO-GROUPING.
  4389                         32  CO-GROUP-PREFIX   PIC XXX.
  4390                         32  CO-GROUP-PRIME    PIC XXX.
  4391                 24  CO-RESP-NO.
  4392                     28  CO-RESP-PREFIX        PIC X(4).
  4393                     28  CO-RESP-PRIME         PIC X(6).
  4394             20  CO-CTL-2.
  4395                 24  CO-ACCOUNT.
  4396                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  85
* EL640.cbl
  4397                     28  CO-ACCT-PRIME         PIC X(6).
  4398         16  CO-TYPE                           PIC X.
  4399             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4400             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4401             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4402
  4403     12  CO-MAINT-INFORMATION.
  4404         16  CO-LAST-MAINT-DT                  PIC XX.
  4405         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4406         16  CO-LAST-MAINT-USER                PIC X(4).
  4407     12  FILLER                                PIC XX.
  4408     12  CO-STMT-TYPE                          PIC XXX.
  4409     12  CO-COMP-TYPE                          PIC X.
  4410         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4411     12  CO-STMT-OWNER                         PIC X(4).
  4412     12  CO-BALANCE-CONTROL                    PIC X.
  4413         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4414         88  CO-NO-BALANCE                        VALUE 'N'.
  4415
  4416     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4417         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4418         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4419         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4420
  4421     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4422         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4423         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4424
  4425     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4426     12  CO-GA-DIRECT-DEP                      PIC X.
  4427     12  CO-FUTURE-SPACE                       PIC X.
  4428         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4429
  4430     12  CO-ACCT-NAME                          PIC X(30).
  4431     12  CO-MAIL-NAME                          PIC X(30).
  4432     12  CO-ADDR-1                             PIC X(30).
  4433     12  CO-ADDR-2                             PIC X(30).
  4434     12  CO-ADDR-3.
  4435         16  CO-ADDR-CITY                      PIC X(27).
  4436         16  CO-ADDR-STATE                     PIC XX.
  4437     12  CO-CSO-1099                           PIC X.
  4438     12  CO-ZIP.
  4439         16  CO-ZIP-PRIME.
  4440             20  CO-ZIP-PRI-1ST                PIC X.
  4441                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4442             20  FILLER                        PIC X(4).
  4443         16  CO-ZIP-PLUS4                      PIC X(4).
  4444     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4445         16  CO-CAN-POSTAL-1                   PIC XXX.
  4446         16  CO-CAN-POSTAL-2                   PIC XXX.
  4447         16  FILLER                            PIC XXX.
  4448     12  CO-SOC-SEC                            PIC X(13).
  4449     12  CO-TELEPHONE.
  4450         16  CO-AREA-CODE                      PIC XXX.
  4451         16  CO-PREFIX                         PIC XXX.
  4452         16  CO-PHONE                          PIC X(4).
  4453
  4454     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  86
* EL640.cbl
  4455
  4456     12  CO-AR-BAL-LEVEL                       PIC X.
  4457         88  CO-AR-REF-LVL                        VALUE '1'.
  4458         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4459         88  CO-AR-BILL-LVL                       VALUE '2'.
  4460         88  CO-AR-AGT-LVL                        VALUE '3'.
  4461         88  CO-AR-FR-LVL                         VALUE '4'.
  4462
  4463     12  CO-AR-NORMAL-PRINT                    PIC X.
  4464         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4465         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4466
  4467     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4468
  4469     12  CO-AR-REPORTING                       PIC X.
  4470         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4471         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4472
  4473     12  CO-AR-PULL-CHECK                      PIC X.
  4474         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4475         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4476
  4477     12  CO-AR-BALANCE-PRINT                   PIC X.
  4478         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4479
  4480     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4481         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4482         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4483         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4484
  4485     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4486
  4487     12  CO-USER-CODE                          PIC X.
  4488     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4489
  4490******************************************************************
  4491*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4492*    THE LAST MONTH END RUN.
  4493******************************************************************
  4494
  4495     12  CO-LAST-ACTIVITY-DATE.
  4496         16  CO-ACT-YEAR                       PIC 99.
  4497         16  CO-ACT-MONTH                      PIC 99.
  4498         16  CO-ACT-DAY                        PIC 99.
  4499
  4500     12  CO-LAST-STMT-DT.
  4501         16  CO-LAST-STMT-YEAR                 PIC 99.
  4502         16  CO-LAST-STMT-MONTH                PIC 99.
  4503         16  CO-LAST-STMT-DAY                  PIC 99.
  4504
  4505     12  CO-MO-END-TOTALS.
  4506         16  CO-MONTHLY-TOTALS.
  4507             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4508             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4509             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4510             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4511             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4512
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  87
* EL640.cbl
  4513         16  CO-AGING-TOTALS.
  4514             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4515             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4516             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4517             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4518
  4519         16  CO-YTD-TOTALS.
  4520             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4521             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4522
  4523         16  CO-OVER-UNDER-TOTALS.
  4524             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4525             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4526
  4527     12  CO-MISCELLANEOUS-TOTALS.
  4528         16  CO-FICA-TOTALS.
  4529             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4530             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4531
  4532         16  CO-CLAIM-TOTALS.
  4533             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4534             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4535
  4536******************************************************************
  4537*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4538*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4539******************************************************************
  4540
  4541     12  CO-CURRENT-TOTALS.
  4542         16  CO-CURRENT-LAST-STMT-DT.
  4543             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4544             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4545             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4546
  4547         16  CO-CURRENT-MONTHLY-TOTALS.
  4548             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4549             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4550             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4551             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4552             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4553
  4554         16  CO-CURRENT-AGING-TOTALS.
  4555             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4556             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4557             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4558             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4559
  4560         16  CO-CURRENT-YTD-TOTALS.
  4561             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4562             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4563
  4564     12  CO-PAID-COMM-TOTALS.
  4565         16  CO-YTD-PAID-COMMS.
  4566             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4567             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4568
  4569     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4570         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  88
* EL640.cbl
  4571         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4572
  4573     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4574         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4575         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4576         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4577         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4578         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4579         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4580         88  CO-FINAL-LETTER                  VALUE 'F'.
  4581         88  CO-RECONCILING                   VALUE 'R'.
  4582         88  CO-PHONE-CALL                    VALUE 'P'.
  4583         88  CO-LEGAL                         VALUE 'L'.
  4584         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4585         88  CO-WRITE-OFF                     VALUE 'W'.
  4586         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4587
  4588     12  CO-CSR-CODE                       PIC X(4).
  4589
  4590     12  CO-GA-STATUS-INFO.
  4591         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4592         16  CO-GA-TERMINATION-DT          PIC XX.
  4593         16  CO-GA-STATUS-CODE             PIC X.
  4594             88  CO-GA-ACTIVE                 VALUE 'A'.
  4595             88  CO-GA-INACTIVE               VALUE 'I'.
  4596             88  CO-GA-PENDING                VALUE 'P'.
  4597         16  CO-GA-COMMENTS.
  4598             20  CO-GA-COMMENT-1           PIC X(40).
  4599             20  CO-GA-COMMENT-2           PIC X(40).
  4600             20  CO-GA-COMMENT-3           PIC X(40).
  4601             20  CO-GA-COMMENT-4           PIC X(40).
  4602
  4603     12  CO-RPTCD2                         PIC X(10).
  4604
  4605     12  CO-TYPE-AGENT                     PIC X(01).
  4606         88  CO-CORPORATION                   VALUE 'C'.
  4607         88  CO-PARTNERSHIP                   VALUE 'P'.
  4608         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4609         88  CO-TRUST                         VALUE 'T'.
  4610         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4611
  4612     12  CO-FAXNO.
  4613         16  CO-FAX-AREA-CODE                  PIC XXX.
  4614         16  CO-FAX-PREFIX                     PIC XXX.
  4615         16  CO-FAX-PHONE                      PIC X(4).
  4616
  4617     12  CO-BANK-INFORMATION.
  4618         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4619         16  CO-BANK-TRANSIT-NON REDEFINES
  4620             CO-BANK-TRANSIT-NO                PIC 9(8).
  4621
  4622         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4623     12  CO-MISC-DEDUCT-INFO REDEFINES
  4624                  CO-BANK-INFORMATION.
  4625         16  CO-MD-GL-ACCT                     PIC X(10).
  4626         16  CO-MD-DIV                         PIC XX.
  4627         16  CO-MD-CENTER                      PIC X(4).
  4628         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  89
* EL640.cbl
  4629         16  CO-CREATE-AP-CHECK                PIC X.
  4630         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4631         16  FILLER                            PIC XXX.
  4632     12  CO-ACH-STATUS                         PIC X.
  4633         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4634         88  CO-ACH-PENDING                        VALUE 'P'.
  4635
  4636     12  CO-BILL-SW                            PIC X.
  4637     12  CO-CONTROL-NAME                       PIC X(30).
  4638     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4639     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4640     12  CO-CLP-STATE                          PIC XX.
  4641     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4642     12  CO-SPP-REFUND-EDIT                    PIC X.
  4643
  4644******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  90
* EL640.cbl
  4646*                            COPY ERCPYAJ.
  4647******************************************************************
  4648*                                                                *
  4649*                            ERCPYAJ                             *
  4650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4651*                            VMOD=2.015                          *
  4652*                                                                *
  4653*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  4654*                                                                *
  4655*                                                                *
  4656*   FILE TYPE = VSAM,KSDS                                        *
  4657*   RECORD SIZE = 200  RECFORM = FIXED                           *
  4658*                                                                *
  4659*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  4660*       ALTERNATE PATHS = NONE                                   *
  4661*                                                                *
  4662*   LOG = YES                                                    *
  4663*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4664******************************************************************
  4665******************************************************************
  4666*                   C H A N G E   L O G
  4667*
  4668* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4669*-----------------------------------------------------------------
  4670*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4671* EFFECTIVE    NUMBER
  4672*-----------------------------------------------------------------
  4673* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  4674* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  4675******************************************************************
  4676
  4677 01  PENDING-PAY-ADJ.
  4678     12  PY-RECORD-ID                     PIC XX.
  4679         88  VALID-PY-ID                        VALUE 'PY'.
  4680
  4681     12  PY-CONTROL-PRIMARY.
  4682         16  PY-COMPANY-CD                PIC X.
  4683         16  PY-CARRIER                   PIC X.
  4684         16  PY-GROUPING                  PIC X(6).
  4685         16  PY-FIN-RESP                  PIC X(10).
  4686         16  PY-ACCOUNT                   PIC X(10).
  4687         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  4688                                          PIC X(10).
  4689         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  4690         16  PY-RECORD-TYPE               PIC X.
  4691             88  PY-REMIT-RECEIVED            VALUE 'R'.
  4692             88  PY-DEPOSIT                   VALUE 'D'.
  4693             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  4694             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  4695             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  4696             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  4697             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  4698             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  4699             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  4700             88  PY-FICA-ENTRY                VALUE 'F'.
  4701             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  4702             88  PY-POLICY-FEE                VALUE 'W'.
  4703             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  91
* EL640.cbl
  4704
  4705     12  PY-PYMT-TYPE                     PIC X.
  4706             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  4707             88  PY-REINS-PYMT                VALUE 'R'.
  4708             88  PY-EXP-PYMT                  VALUE 'E'.
  4709
  4710     12  PY-BIL-INV                       PIC X(6).
  4711     12  PY-REF-NO                        PIC X(12).
  4712
  4713     12  PY-LAST-MAINT-DT                 PIC XX.
  4714     12  PY-LAST-MAINT-BY                 PIC X(4).
  4715     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4716
  4717     12  PY-PYADJ-RECORD.
  4718         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  4719         16  PY-ENTRY-COMMENT             PIC X(30).
  4720         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  4721             20  PY-GL-ACCOUNT            PIC X(10).
  4722             20  PY-GL-STATE              PIC X(02).
  4723             20  PY-GL-CANC-SW            PIC X(01).
  4724                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  4725                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  4726             20  PY-GL-COMMENT            PIC X(10).
  4727             20  FILLER      REDEFINES PY-GL-COMMENT.
  4728                 24  PY-GL-CHECK-NO       PIC 9(06).
  4729                 24  FILLER               PIC X(04).
  4730             20  FILLER                   PIC X(07).
  4731         16  PY-SAVE-ACCOUNT              PIC X(10).
  4732         16  PY-SAVE-TYPE                 PIC X(01).
  4733
  4734         16  PY-LETTERS.
  4735             20  PY-LETTER OCCURS 3 TIMES
  4736                           INDEXED BY PY-LET-NDX
  4737                                          PIC X(04).
  4738
  4739         16  PY-ERCOMP-TYPE               PIC X.
  4740             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  4741             88  PY-GA-TYPE                   VALUE 'G'.
  4742             88  PY-BANK-TYPE                 VALUE 'B'.
  4743         16  FILLER                       PIC X(05).
  4744
  4745     12  PY-RECORD-STATUS.
  4746         16  PY-CREDIT-SELECT-DT          PIC XX.
  4747         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  4748         16  PY-BILLED-DATE               PIC XX.
  4749         16  PY-REPORTED-DT               PIC XX.
  4750         16  PY-PMT-APPLIED               PIC X.
  4751             88  PY-ACCOUNT-PMT               VALUE 'A'.
  4752             88  PY-GA-PMT                    VALUE 'G'.
  4753             88  PY-OVWRITE-PMT               VALUE 'O'.
  4754             88  PY-NON-AR-PMT                VALUE 'N'.
  4755         16  FILLER                       PIC X(5).
  4756         16  PY-INPUT-DT                  PIC XX.
  4757         16  PY-CHECK-NUMBER              PIC X(6).
  4758         16  PY-VOID-SW                   PIC X.
  4759             88  PY-CHECK-VOIDED              VALUE 'V'.
  4760         16  PY-CHECK-ORIGIN-SW           PIC X.
  4761             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  92
* EL640.cbl
  4762             88  PY-REFUND-CHECK              VALUE 'R'.
  4763             88  PY-GA-CHECK                  VALUE 'G'.
  4764             88  PY-CHECK-WRITTEN             VALUE 'W'.
  4765             88  PY-CHECK-REVERSAL            VALUE 'V'.
  4766         16  PY-CHECK-WRITTEN-DT          PIC XX.
  4767         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  4768         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  4769         16  PY-BILL-FLAG                 PIC X.
  4770             88  PY-BILLED                    VALUE 'B'.
  4771         16  PY-AR-FLAG                   PIC X.
  4772             88  PY-AR-CYCLE                  VALUE 'C'.
  4773             88  PY-AR-MONTH-END              VALUE 'M'.
  4774         16  PY-AR-DATE                   PIC XX.
  4775
  4776     12  PY-GL-CODES.
  4777         16  PY-GL-DB                     PIC X(14).
  4778         16  PY-GL-CR                     PIC X(14).
  4779         16  PY-GL-FLAG                   PIC X.
  4780         16  PY-GL-DATE                   PIC XX.
  4781
  4782     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  4783     12  FILLER                           PIC X(3).
  4784******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  93
* EL640.cbl
  4786*                            COPY ERCACCT.
  4787******************************************************************
  4788*                                                                *
  4789*                                                                *
  4790*                            ERCACCT                             *
  4791*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4792*                            VMOD=2.031                          *
  4793*                                                                *
  4794*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4795*                                                                *
  4796*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4797*   VSAM ACCOUNT MASTER FILES.                                   *
  4798*                                                                *
  4799*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4800*                                                                *
  4801*   FILE TYPE = VSAM,KSDS                                        *
  4802*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4803*                                                                *
  4804*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4805*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4806*                                                                *
  4807*   LOG = NO                                                     *
  4808*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4809*                                                                *
  4810*                                                                *
  4811******************************************************************
  4812*                   C H A N G E   L O G
  4813*
  4814* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4815*-----------------------------------------------------------------
  4816*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4817* EFFECTIVE    NUMBER
  4818*-----------------------------------------------------------------
  4819* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4820* 092705    2005050300006  PEMA  ADD SPP LEASES
  4821* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4822* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4823******************************************************************
  4824
  4825 01  ACCOUNT-MASTER.
  4826     12  AM-RECORD-ID                      PIC XX.
  4827         88  VALID-AM-ID                      VALUE 'AM'.
  4828
  4829     12  AM-CONTROL-PRIMARY.
  4830         16  AM-COMPANY-CD                 PIC X.
  4831         16  AM-MSTR-CNTRL.
  4832             20  AM-CONTROL-A.
  4833                 24  AM-CARRIER            PIC X.
  4834                 24  AM-GROUPING.
  4835                     28 AM-GROUPING-PREFIX PIC XXX.
  4836                     28 AM-GROUPING-PRIME  PIC XXX.
  4837                 24  AM-STATE              PIC XX.
  4838                 24  AM-ACCOUNT.
  4839                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4840                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4841             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4842                                           PIC X(19).
  4843             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  94
* EL640.cbl
  4844                 24  AM-EXPIRATION-DT      PIC XX.
  4845                 24  FILLER                PIC X(4).
  4846             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4847                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4848
  4849     12  AM-CONTROL-BY-VAR-GRP.
  4850         16  AM-COMPANY-CD-A1              PIC X.
  4851         16  AM-VG-CARRIER                 PIC X.
  4852         16  AM-VG-GROUPING                PIC X(6).
  4853         16  AM-VG-STATE                   PIC XX.
  4854         16  AM-VG-ACCOUNT                 PIC X(10).
  4855         16  AM-VG-DATE.
  4856             20  AM-VG-EXPIRATION-DT       PIC XX.
  4857             20  FILLER                    PIC X(4).
  4858         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4859                                           PIC 9(11)      COMP-3.
  4860     12  AM-MAINT-INFORMATION.
  4861         16  AM-LAST-MAINT-DT              PIC XX.
  4862         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4863         16  AM-LAST-MAINT-USER            PIC X(4).
  4864         16  FILLER                        PIC XX.
  4865
  4866     12  AM-EFFECTIVE-DT                   PIC XX.
  4867     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4868
  4869     12  AM-PREV-DATES  COMP-3.
  4870         16  AM-PREV-EXP-DT                PIC 9(11).
  4871         16  AM-PREV-EFF-DT                PIC 9(11).
  4872
  4873     12  AM-REPORT-CODE-1                  PIC X(10).
  4874     12  AM-REPORT-CODE-2                  PIC X(10).
  4875
  4876     12  AM-CITY-CODE                      PIC X(4).
  4877     12  AM-COUNTY-PARISH                  PIC X(6).
  4878
  4879     12  AM-NAME                           PIC X(30).
  4880     12  AM-PERSON                         PIC X(30).
  4881     12  AM-ADDRS                          PIC X(30).
  4882     12  AM-CITY.
  4883         16  AM-ADDR-CITY                  PIC X(28).
  4884         16  AM-ADDR-STATE                 PIC XX.
  4885     12  AM-ZIP.
  4886         16  AM-ZIP-PRIME.
  4887             20  AM-ZIP-PRI-1ST            PIC X.
  4888                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4889             20  FILLER                    PIC X(4).
  4890         16  AM-ZIP-PLUS4                  PIC X(4).
  4891     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4892         16  AM-CAN-POSTAL-1               PIC XXX.
  4893         16  AM-CAN-POSTAL-2               PIC XXX.
  4894         16  FILLER                        PIC XXX.
  4895     12  AM-TEL-NO.
  4896         16  AM-AREA-CODE                  PIC 999.
  4897         16  AM-TEL-PRE                    PIC 999.
  4898         16  AM-TEL-NBR                    PIC 9(4).
  4899     12  AM-TEL-LOC                        PIC X.
  4900         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4901         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  95
* EL640.cbl
  4902
  4903     12  AM-COMM-STRUCTURE.
  4904         16  AM-DEFN-1.
  4905             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4906                 24  AM-AGT.
  4907                     28  AM-AGT-PREFIX     PIC X(4).
  4908                     28  AM-AGT-PRIME      PIC X(6).
  4909                 24  AM-COM-TYP            PIC X.
  4910                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4911                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4912                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4913                 24  AM-RECALC-LV-INDIC    PIC X.
  4914                 24  AM-RETRO-LV-INDIC     PIC X.
  4915                 24  AM-GL-CODES           PIC X.
  4916                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4917                 24  FILLER                PIC X(01).
  4918         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4919             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4920                 24  FILLER                PIC X(11).
  4921                 24  AM-L-COMA             PIC XXX.
  4922                 24  AM-J-COMA             PIC XXX.
  4923                 24  AM-A-COMA             PIC XXX.
  4924                 24  FILLER                PIC X(6).
  4925
  4926     12  AM-COMM-CHANGE-STATUS             PIC X.
  4927         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4928
  4929     12  AM-CSR-CODE                       PIC X(4).
  4930
  4931     12  AM-BILLING-STATUS                 PIC X.
  4932         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4933         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4934     12  AM-AUTO-REFUND-SW                 PIC X.
  4935         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4936         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4937     12  AM-GPCD                           PIC 99.
  4938     12  AM-IG                             PIC X.
  4939         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4940         88  AM-HAS-GROUP                     VALUE '2'.
  4941     12  AM-STATUS                         PIC X.
  4942         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4943         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4944         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4945         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4946         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4947     12  AM-REMIT-TO                       PIC 99.
  4948     12  AM-ID-NO                          PIC X(11).
  4949
  4950     12  AM-CAL-TABLE                      PIC XX.
  4951     12  AM-LF-DEVIATION                   PIC XXX.
  4952     12  AM-AH-DEVIATION                   PIC XXX.
  4953     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4954     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4955     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4956     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4957     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4958     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4959
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  96
* EL640.cbl
  4960     12  AM-USER-FIELDS.
  4961         16  AM-FLD-1                      PIC XX.
  4962         16  AM-FLD-2                      PIC XX.
  4963         16  AM-FLD-3                      PIC XX.
  4964         16  AM-FLD-4                      PIC XX.
  4965         16  AM-FLD-5                      PIC XX.
  4966
  4967     12  AM-1ST-PROD-DATE.
  4968         16  AM-1ST-PROD-YR                PIC XX.
  4969         16  AM-1ST-PROD-MO                PIC XX.
  4970         16  AM-1ST-PROD-DA                PIC XX.
  4971     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4972     12  AM-CERTS-PURGED-DATE.
  4973         16  AM-PUR-YR                     PIC XX.
  4974         16  AM-PUR-MO                     PIC XX.
  4975         16  AM-PUR-DA                     PIC XX.
  4976     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4977     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4978     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4979     12  AM-INACTIVE-DATE.
  4980         16  AM-INA-MO                     PIC 99.
  4981         16  AM-INA-DA                     PIC 99.
  4982         16  AM-INA-YR                     PIC 99.
  4983     12  AM-AR-HI-CERT-DATE                PIC XX.
  4984
  4985     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4986     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4987
  4988     12  AM-OB-PAYMENT-MODE                PIC X.
  4989         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4990         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4991         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4992         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4993
  4994     12  AM-AH-ONLY-INDICATOR              PIC X.
  4995         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4996         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4997
  4998     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4999
  5000     12  AM-OVER-SHORT.
  5001         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5002         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5003
  5004     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5005     12  AM-DCC-CLP-STATE                  PIC XX.
  5006
  5007     12  AM-RECALC-COMM                    PIC X.
  5008     12  AM-RECALC-REIN                    PIC X.
  5009
  5010     12  AM-REI-TABLE                      PIC XXX.
  5011     12  AM-REI-ET-LF                      PIC X.
  5012     12  AM-REI-ET-AH                      PIC X.
  5013     12  AM-REI-PE-LF                      PIC X.
  5014     12  AM-REI-PE-AH                      PIC X.
  5015     12  AM-REI-PRT-ST                     PIC X.
  5016     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5017     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  97
* EL640.cbl
  5018     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5019     12  AM-REI-GROUP-A                    PIC X(6).
  5020     12  AM-REI-MORT                       PIC X(4).
  5021     12  AM-REI-PRT-OW                     PIC X.
  5022     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5023     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5024     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5025     12  AM-REI-GROUP-B                    PIC X(6).
  5026
  5027     12  AM-TRUST-TYPE                     PIC X(2).
  5028
  5029     12  AM-EMPLOYER-STMT-USED             PIC X.
  5030     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5031
  5032     12  AM-STD-AH-TYPE                    PIC XX.
  5033     12  AM-EARN-METHODS.
  5034         16  AM-EARN-METHOD-R              PIC X.
  5035             88 AM-REF-RL-R78                 VALUE 'R'.
  5036             88 AM-REF-RL-PR                  VALUE 'P'.
  5037             88 AM-REF-RL-MEAN                VALUE 'M'.
  5038             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5039         16  AM-EARN-METHOD-L              PIC X.
  5040             88 AM-REF-LL-R78                 VALUE 'R'.
  5041             88 AM-REF-LL-PR                  VALUE 'P'.
  5042             88 AM-REF-LL-MEAN                VALUE 'M'.
  5043             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5044         16  AM-EARN-METHOD-A              PIC X.
  5045             88 AM-REF-AH-R78                 VALUE 'R'.
  5046             88 AM-REF-AH-PR                  VALUE 'P'.
  5047             88 AM-REF-AH-MEAN                VALUE 'M'.
  5048             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5049             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5050             88 AM-REF-AH-NET                 VALUE 'N'.
  5051
  5052     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5053     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5054     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5055
  5056     12  AM-RET-Y-N                        PIC X.
  5057     12  AM-RET-P-E                        PIC X.
  5058     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5059     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5060     12  AM-RET-GRP                        PIC X(6).
  5061     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5062         16  AM-POOL-PRIME                 PIC XXX.
  5063         16  AM-POOL-SUB                   PIC XXX.
  5064     12  AM-RETRO-EARNINGS.
  5065         16  AM-RET-EARN-R                 PIC X.
  5066         16  AM-RET-EARN-L                 PIC X.
  5067         16  AM-RET-EARN-A                 PIC X.
  5068     12  AM-RET-ST-TAX-USE                 PIC X.
  5069         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5070         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5071     12  AM-RETRO-BEG-EARNINGS.
  5072         16  AM-RET-BEG-EARN-R             PIC X.
  5073         16  AM-RET-BEG-EARN-L             PIC X.
  5074         16  AM-RET-BEG-EARN-A             PIC X.
  5075     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  98
* EL640.cbl
  5076     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5077
  5078     12  AM-USER-SELECT-OPTIONS.
  5079         16  AM-USER-SELECT-1              PIC X(10).
  5080         16  AM-USER-SELECT-2              PIC X(10).
  5081         16  AM-USER-SELECT-3              PIC X(10).
  5082         16  AM-USER-SELECT-4              PIC X(10).
  5083         16  AM-USER-SELECT-5              PIC X(10).
  5084
  5085     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5086
  5087     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5088
  5089     12  AM-RPT045A-SWITCH                 PIC X.
  5090         88  RPT045A-OFF                   VALUE 'N'.
  5091
  5092     12  AM-INSURANCE-LIMITS.
  5093         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5094         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5095
  5096     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5097         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5098
  5099     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5100         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5101         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5102
  5103     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5104
  5105     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5106     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5107     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5108     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5109     12  FILLER                            PIC X(5).
  5110     12  AM-REPORT-CODE-3                  PIC X(10).
  5111*    12  FILLER                            PIC X(22).
  5112
  5113     12  AM-RESERVE-DATE.
  5114         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5115         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5116         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5117
  5118     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5119     12  AM-NOTIFICATION-TYPES.
  5120         16  AM-NOTIF-OF-LETTERS           PIC X.
  5121         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5122         16  AM-NOTIF-OF-REPORTS           PIC X.
  5123         16  AM-NOTIF-OF-STATUS            PIC X.
  5124
  5125     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5126         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5127         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5128         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5129         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5130
  5131     12  AM-BENEFIT-CONTROLS.
  5132         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5133             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page  99
* EL640.cbl
  5134             20  AM-BENEFIT-TYPE           PIC X.
  5135             20  AM-BENEFIT-REVISION       PIC XXX.
  5136             20  AM-BENEFIT-REM-TERM       PIC X.
  5137             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5138             20  FILLER                    PIC XX.
  5139         16  FILLER                        PIC X(80).
  5140
  5141     12  AM-TRANSFER-DATA.
  5142         16  AM-TRANSFERRED-FROM.
  5143             20  AM-TRNFROM-CARRIER        PIC X.
  5144             20  AM-TRNFROM-GROUPING.
  5145                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5146                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5147             20  AM-TRNFROM-STATE          PIC XX.
  5148             20  AM-TRNFROM-ACCOUNT.
  5149                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5150                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5151             20  AM-TRNFROM-DTE            PIC XX.
  5152         16  AM-TRANSFERRED-TO.
  5153             20  AM-TRNTO-CARRIER          PIC X.
  5154             20  AM-TRNTO-GROUPING.
  5155                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5156                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5157             20  AM-TRNTO-STATE            PIC XX.
  5158             20  AM-TRNTO-ACCOUNT.
  5159                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5160                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5161             20  AM-TRNTO-DTE              PIC XX.
  5162         16  FILLER                        PIC X(10).
  5163
  5164     12  AM-SAVED-REMIT-TO                 PIC 99.
  5165
  5166     12  AM-COMM-STRUCTURE-SAVED.
  5167         16  AM-DEFN-1-SAVED.
  5168             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5169                 24  AM-AGT-SV             PIC X(10).
  5170                 24  AM-COM-TYP-SV         PIC X.
  5171                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5172                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5173                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5174                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5175                 24  FILLER                PIC X.
  5176                 24  AM-GL-CODES-SV        PIC X.
  5177                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5178                 24  FILLER                PIC X.
  5179         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5180             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5181                 24  FILLER                PIC X(11).
  5182                 24  AM-L-COMA-SV          PIC XXX.
  5183                 24  AM-J-COMA-SV          PIC XXX.
  5184                 24  AM-A-COMA-SV          PIC XXX.
  5185                 24  FILLER                PIC X(6).
  5186
  5187     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5188         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5189            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5190            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5191            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 100
* EL640.cbl
  5192
  5193     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5194     12  FILLER                            PIC X(120).
  5195
  5196     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5197         16  AM-CONTROL-NAME               PIC X(30).
  5198         16  AM-EXECUTIVE-ONE.
  5199             20  AM-EXEC1-NAME             PIC X(15).
  5200             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5201                                                          COMP-3.
  5202             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5203                                                          COMP-3.
  5204         16  AM-EXECUTIVE-TWO.
  5205             20  AM-EXEC2-NAME             PIC X(15).
  5206             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5207                                                          COMP-3.
  5208             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5209                                                          COMP-3.
  5210
  5211     12  AM-RETRO-ADDITIONAL-DATA.
  5212         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5213         16  AM-RETRO-PREM-P-E             PIC X.
  5214         16  AM-RETRO-CLMS-P-I             PIC X.
  5215         16  AM-RETRO-RET-BRACKET-LF.
  5216             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5217                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5218                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5219             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5220                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5221                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5222             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5223                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5224                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5225         16  AM-RETRO-RET-BRACKET-AH.
  5226             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5227                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5228                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5229                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5230             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5231                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5232                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5233             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5234                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5235                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5236
  5237     12  AM-COMMENTS.
  5238         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5239
  5240     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5241         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5242         16  AM-FLI-BILLING-CODE           PIC X.
  5243         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5244         16  AM-FLI-UNITED-IDENT           PIC X.
  5245         16  AM-FLI-INTEREST-LOST-DATA.
  5246             20  AM-FLI-BANK-NO            PIC X(5).
  5247             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5248             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5249             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 101
* EL640.cbl
  5250         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5251             20  AM-FLI-AGT                PIC X(9).
  5252             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5253             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5254         16  FILLER                        PIC X(102).
  5255
  5256     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5257         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5258             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5259             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5260             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5261             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5262             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5263         16  FILLER                          PIC X(10).
  5264******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 102
* EL640.cbl
  5266*                            COPY ERCBILL.
  5267******************************************************************
  5268*                                                                *
  5269*                                                                *
  5270*                            ERCBILL                             *
  5271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5272*                            VMOD=2.007                          *
  5273*                                                                *
  5274*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
  5275*                                                                *
  5276*   FILE TYPE = VSAM,KSDS                                        *
  5277*   RECORD SIZE = 210  RECFORM = FIXED                           *
  5278*                                                                *
  5279*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
  5280*                                                                *
  5281*   LOG = NO                                                     *
  5282*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5283******************************************************************
  5284 01  BILLING-STATEMENT.
  5285     02 BILLING-STATEMENT-FILE.
  5286     12  BI-RECORD-ID                PIC XX.
  5287         88  VALID-BI-ID                VALUE 'BI'.
  5288
  5289     12  BI-CONTROL-PRIMARY.
  5290         16  BI-COMPANY-CD           PIC X.
  5291         16  BI-CARRIER              PIC X.
  5292         16  BI-GROUPING             PIC X(6).
  5293         16  BI-ACCOUNT              PIC X(10).
  5294         16  BI-FIN-RESP             PIC X(10).
  5295         16  BI-RECORD-TYPE          PIC X.
  5296             88  BI-HEADER-DATA         VALUE '1'.
  5297             88  BI-ADDRESS-DATA        VALUE '2'.
  5298             88  BI-TEXT-DATA           VALUE '3'.
  5299         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
  5300
  5301     12  BI-TEXT-RECORD.
  5302         16  BI-SKIP-CONTROL         PIC X.
  5303         16  BI-TEXT-LINE            PIC X(157).
  5304         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
  5305             20  BI-ADDR-LIT         PIC X(14).
  5306             20  BI-CO               PIC X(7).
  5307             20  BI-DASH             PIC X.
  5308             20  BI-ACCT             PIC X(10).
  5309             20  FILLER              PIC XX.
  5310             20  BI-ACCT-ADDR        PIC X(30).
  5311             20  FILLER              PIC X.
  5312             20  BI-REMIT-LIT        PIC X(11).
  5313             20  FILLER              PIC XX.
  5314             20  BI-REMIT-ADDR       PIC X(30).
  5315             20  FILLER              PIC X(49).
  5316         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
  5317             20  BI-INS-LAST-NAME    PIC X(15).
  5318             20  FILLER              PIC X.
  5319             20  BI-INS-1ST-NAME     PIC X(10).
  5320             20  FILLER REDEFINES BI-INS-1ST-NAME.
  5321                 24  BI-INS-INITS    PIC XX.
  5322                 24  FILLER          PIC X(8).
  5323             20  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 103
* EL640.cbl
  5324             20  BI-UNDRWRTR.
  5325                 24  BI-INS-INIT     PIC X.
  5326                 24  FILLER          PIC XXX.
  5327             20  BI-CERT             PIC X(11).
  5328             20  FILLER              PIC XX.
  5329             20  BI-EFF-DT           PIC X(8).
  5330             20  FILLER              PIC XX.
  5331             20  BI-CAN-DT           PIC X(8).
  5332             20  FILLER              PIC XX.
  5333             20  BI-ED-TERM          PIC ZZZ.
  5334             20  FILLER              PIC XX.
  5335             20  BI-TYPE             PIC XXXX.
  5336             20  FILLER              PIC X.
  5337             20  BI-PREM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5338             20  FILLER              PIC X(3).
  5339             20  BI-ED-RATE          PIC ZZZ.ZZZ.
  5340             20  FILLER              PIC XX.
  5341             20  BI-COMM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  5342             20  FILLER              PIC XX.
  5343             20  BI-FACE-AMT         PIC ZZZ,ZZZ,ZZZ.ZZ-.
  5344             20  FILLER              PIC X(26).
  5345         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
  5346             20  FILLER              PIC X(42).
  5347             20  BI-TOT-DESC         PIC X(20).
  5348             20  FILLER REDEFINES BI-TOT-DESC.
  5349                 24  BI-TOT-LIT      PIC X(6).
  5350                 24  BI-OVERRIDE-L6  PIC X(14).
  5351             20  FILLER              PIC X(11).
  5352             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
  5353             20  BI-TOT-DASH REDEFINES
  5354                 BI-TOT-PREM         PIC X(15).
  5355             20  FILLER              PIC X(11).
  5356             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
  5357             20  FILLER              PIC XX.
  5358             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
  5359             20  FILLER              PIC X(26).
  5360         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
  5361             20  BI-ENTRY-DESC       PIC X(30).
  5362             20  FILLER              PIC X(11).
  5363             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
  5364             20  FILLER              PIC X(31).
  5365             20  BI-ACCTG-COMMENT    PIC X(30).
  5366             20  FILLER              PIC X(39).
  5367         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
  5368             20  FILLER              PIC X(42).
  5369             20  BI-TOT-DESC5        PIC X(20).
  5370             20  FILLER              PIC X(11).
  5371             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5372             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
  5373             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5374             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
  5375             20  FILLER              PIC X(24).
  5376         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
  5377             20  BI-TEXT-2-81        PIC X(80).
  5378             20  FILLER              PIC X(77).
  5379         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
  5380             20  FILLER              PIC X(53).
  5381             20  BI-TEXT-55-133      PIC X(79).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 104
* EL640.cbl
  5382             20  FILLER              PIC X(25).
  5383         16  BI-TEXT-TYPE            PIC X.
  5384             88 DETAIL-LINE              VALUE 'D'.
  5385         16  BI-TERM                 PIC S999.
  5386         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
  5387         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
  5388         16  BI-RATE                 PIC S99V9(5) COMP-3.
  5389
  5390     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
  5391         16  FILLER                  PIC X.
  5392         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
  5393         16  FILLER                  PIC X(10).
  5394         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
  5395         16  FILLER                  PIC X(106).
  5396
  5397     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
  5398         16  BI-PROCESSOR-CD         PIC X(4).
  5399         16  BI-STATEMENT-TYPE       PIC X.
  5400             88  BI-PREVIEW-ONLY         VALUE 'P'.
  5401         16  BI-NO-OF-COPIES         PIC S9.
  5402         16  BI-CREATION-DT          PIC XX.
  5403         16  BI-INITIAL-PRINT-DATE   PIC XX.
  5404         16  BI-ACCOUNT-TOTALS.
  5405             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  5406             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  5407             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  5408             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5409             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5410             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5411             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  5412             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  5413         16  BI-FIN-RESP-ACCT        PIC X(10).
  5414         16  BI-FIN-RESP-NAME        PIC X(30).
  5415         16  FILLER                  PIC X(79).
  5416
  5417
  5418     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  5419     12  FILLER                      PIC XX.
  5420
  5421     12  GA-CONTROL-PRIMARY.
  5422         16  FILLER                  PIC X(31).
  5423
  5424     12  GA-TEXT-RECORD.
  5425         16  GA-SKIP-CONTROL         PIC X.
  5426         16  GA-TEXT-LINE            PIC X(132).
  5427         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  5428             20  FILLER              PIC X.
  5429             20  GA-CARRIER          PIC X.
  5430             20  GA-GROUPING         PIC X(6).
  5431             20  GA-DASH             PIC X.
  5432             20  GA-AGENT            PIC X(10).
  5433             20  FILLER              PIC X.
  5434             20  GA-AGENT-ADDR       PIC X(30).
  5435             20  FILLER              PIC X(82).
  5436         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  5437             20  GA-ACCT             PIC X(10).
  5438             20  FILLER              PIC X.
  5439             20  GA-ACCT-NAME        PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 105
* EL640.cbl
  5440             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  5441             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  5442             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  5443             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  5444             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  5445             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  5446             20  FILLER              PIC X.
  5447             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  5448             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  5449             20  FILLER              PIC X.
  5450         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  5451             20  FILLER              PIC X(11).
  5452             20  GA-ENTRY-DESC       PIC X(30).
  5453             20  FILLER              PIC X(60).
  5454             20  GA-ENTRY-COMMENT    PIC X(30).
  5455             20  FILLER              PIC X.
  5456         16  FILLER.
  5457             20  GA-BENEFIT-CD       PIC XX.
  5458             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  5459             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  5460             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  5461             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  5462             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  5463             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  5464             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  5465             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  5466
  5467     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  5468         16  FILLER                  PIC X.
  5469         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  5470         16  FILLER                  PIC X(144).
  5471
  5472     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  5473         16  GA-PROCESSOR-CD         PIC X(4).
  5474         16  GA-STATEMENT-TYPE       PIC X.
  5475             88  GA-PREVIEW-ONLY         VALUE 'P'.
  5476         16  GA-NO-OF-COPIES         PIC S9.
  5477         16  GA-CREATION-DT          PIC XX.
  5478         16  GA-INITIAL-PRINT-DATE   PIC XX.
  5479         16  GA-AGENT-TOTALS.
  5480             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  5481             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  5482             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  5483             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  5484             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  5485             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  5486             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  5487             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
  5488             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  5489         16  GA-AGENTS-NAME          PIC X(30).
  5490         16  FILLER                  PIC X(81).
  5491     12  FILLER                      PIC XX.
  5492
  5493
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 106
* EL640.cbl
  5495*                            COPY ELCTEXT.
  5496******************************************************************
  5497*                                                                *
  5498*                                                                *
  5499*                            ELCTEXT.                            *
  5500*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5501*                            VMOD=2.008                          *
  5502*                                                                *
  5503*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  5504*                                     FORM LETTERS,              *
  5505*                                     CERT FORM DISPLAY.
  5506*                                                                *
  5507*   FILE TYPE = VSAM,KSDS                                        *
  5508*   RECORD SIZE = 100   RECFORM = FIXED                          *
  5509*                                                                *
  5510*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  5511*       ALTERNATE INDEX = NONE                                   *
  5512*                                                                *
  5513*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  5514*       ALTERNATE INDEX = NONE                                   *
  5515*                                                                *
  5516*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  5517*       ALTERNATE INDEX = NONE                                   *
  5518*                                                                *
  5519*   LOG = NO                                                     *
  5520*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5521******************************************************************
  5522 01  TEXT-FILES.
  5523     12  TEXT-FILE-ID                PIC XX.
  5524         88  FORMS-FILE-TEXT            VALUE 'TF'.
  5525         88  LETTER-FILE-TEXT           VALUE 'TL'.
  5526         88  HELP-FILE-TEXT             VALUE 'TH'.
  5527
  5528     12  TX-CONTROL-PRIMARY.
  5529         16  TX-COMPANY-CD           PIC X.
  5530             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  5531         16  TX-ACCESS-CD-GENL       PIC X(12).
  5532
  5533         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5534             20  TX-LETTER-NO        PIC X(4).
  5535             20  FILLER              PIC X(8).
  5536
  5537         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5538             20  TX-FORM-NO          PIC X(12).
  5539
  5540         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  5541             20  TX-HELP-TYPE        PIC X.
  5542                 88  HELP-FOR-GENERAL   VALUE ' '.
  5543                 88  HELP-BY-SCREEN     VALUE 'S'.
  5544                 88  HELP-BY-ERROR      VALUE 'E'.
  5545             20  TX-SCREEN-OR-ERROR  PIC X(4).
  5546                 88  GENERAL-INFO-HELP  VALUE '0000'.
  5547             20  TX-HELP-FOR-COMPANY  PIC XXX.
  5548                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  5549             20  FILLER              PIC X(4).
  5550
  5551         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  5552
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 107
* EL640.cbl
  5553     12  TX-PROCESS-CONTROL          PIC XX.
  5554         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  5555
  5556     12  TX-TEXT-LINE                PIC X(70).
  5557
  5558     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  5559         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  5560         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  5561         88  TX-VALID-FORM-SQUEEZE-VALUE
  5562                                        VALUE 'Y' ' '.
  5563
  5564     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  5565         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  5566         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  5567         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  5568         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  5569         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  5570         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  5571         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  5572                                              'K' 'N' ' '
  5573                                              'Z'.
  5574
  5575     12  TX-ARCHIVE-SW               PIC X.
  5576         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  5577         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  5578         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  5579
  5580     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  5581     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  5582
  5583     12  TX-BSR-CODE                 PIC X.
  5584         88  TX-BSR-LETTER              VALUE 'B'.
  5585         88  TX-NON-BSR-LETTER          VALUE ' '.
  5586
  5587     12  FILLER                      PIC X.
  5588*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 108
* EL640.cbl
  5590
  5591 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  5592                          CONTROL-FILE COMPENSATION-MASTER
  5593                          PENDING-PAY-ADJ ACCOUNT-MASTER
  5594                          BILLING-STATEMENT TEXT-FILES.
  5595 0000-DFHEXIT SECTION.
  5596     MOVE '9#                    $   ' TO DFHEIV0.
  5597     MOVE 'EL640' TO DFHEIV1.
  5598     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5599
  5600     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5601     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  5602     MOVE EIBTRMID               TO QID-TERM.
  5603     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5604     MOVE '5'                    TO DC-OPTION-CODE.
  5605     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  5606     MOVE DC-BIN-DATE-1          TO WS-CURRENT-DATE.
  5607     MOVE DC-GREG-DATE-1-MDY     TO WS-CURRENT-DATE-MDY.
  5608     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DATE-EDIT.
  5609
  5610     IF EIBCALEN = 0
  5611         GO TO 8800-UNAUTHORIZED-ACCESS.
  5612
  5613     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5614         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  5615
  5616     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5617         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5618             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5619             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5620             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5621             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5622             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5623             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5624             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5625             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5626             MOVE PI-CR-CONTROL-IN-PROGRESS TO W-TRANSFER-CONTROL
  5627             MOVE SPACES          TO PI-CR-CONTROL-IN-PROGRESS
  5628         ELSE
  5629             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5630             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5631             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5632             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5633             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5634             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5635             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5636             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5637
  5638     MOVE LOW-VALUES             TO EL640AI.
  5639
  5640     IF PI-AR-PROCESSING
  5641        MOVE XCTL-635            TO XCTL-PYAJ.
  5642
  5643     IF PI-COMPANY-ID = 'DMD'
  5644        MOVE XCTL-633DMD         TO XCTL-PYAJ.
  5645
  5646     IF RETURNED-FROM NOT = SPACES
  5647         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 109
* EL640.cbl
  5648         IF RETURNED-FROM = XCTL-PYAJ AND NOT PI-VOID-BILL
  5649             MOVE ZEROS          TO PI-ADJUSTMENTS
  5650                                    PI-DISBURSED
  5651                                    PI-REMITTED
  5652             GO TO 1100-PYAJ-BILLING-PROCESS
  5653         ELSE
  5654             MOVE -1             TO APFNTERL
  5655             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5656             GO TO 8100-SEND-INITIAL-MAP.
  5657
  5658     IF EIBTRNID NOT = TRANS-ID
  5659         PERFORM 0400-CLEAR-PI  THRU  0499-EXIT
  5660         MOVE EL640A             TO PI-MAP-NAME
  5661         MOVE -1                 TO APFNTERL
  5662         GO TO 8100-SEND-INITIAL-MAP.
  5663
  5664
  5665* EXEC CICS HANDLE CONDITION
  5666*        PGMIDERR  (9600-PGMID-ERROR)
  5667*        ERROR     (9990-ABEND)
  5668*    END-EXEC.
  5669*    MOVE '"$L.                  ! " #00005660' TO DFHEIV0
  5670     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5672     MOVE X'2220233030303035363630' TO DFHEIV0(25:11)
  5673     CALL 'kxdfhei1' USING DFHEIV0
  5674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5675
  5676
  5677     IF EIBAID = DFHCLEAR
  5678         IF PI-MAP-NAME = EL640B
  5679             PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT
  5680             MOVE EL640A         TO PI-MAP-NAME
  5681             MOVE -1             TO APFNTERL
  5682             GO TO 8100-SEND-INITIAL-MAP
  5683         ELSE
  5684             GO TO 9400-CLEAR.
  5685
  5686     IF PI-PROCESSOR-ID = 'LGXX'
  5687         GO TO 0200-RECEIVE.
  5688
  5689
  5690* EXEC CICS READQ TS
  5691*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5692*        INTO   (SECURITY-CONTROL)
  5693*        LENGTH (SC-COMM-LENGTH)
  5694*        ITEM   (SC-ITEM)
  5695*    END-EXEC.
  5696*    MOVE '*$II   L              ''   #00005677' TO DFHEIV0
  5697     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5698     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5699     MOVE X'2020233030303035363737' TO DFHEIV0(25:11)
  5700     CALL 'kxdfhei1' USING DFHEIV0,
  5701           PI-SECURITY-TEMP-STORE-ID,
  5702           SECURITY-CONTROL,
  5703           SC-COMM-LENGTH,
  5704           SC-ITEM,
  5705           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 110
* EL640.cbl
  5706           DFHEIV99
  5707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5708
  5709
  5710     MOVE SC-CREDIT-DISPLAY (18)  TO PI-DISPLAY-CAP.
  5711     MOVE SC-CREDIT-UPDATE  (18)  TO PI-MODIFY-CAP.
  5712
  5713     IF NOT DISPLAY-CAP
  5714         MOVE 'READ'          TO SM-READ
  5715         PERFORM 9995-SECURITY-VIOLATION
  5716         MOVE ER-0070         TO  EMI-ERROR
  5717         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5718         GO TO 8100-SEND-INITIAL-MAP.
  5719
  5720 0200-RECEIVE.
  5721     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5722         MOVE ER-0008            TO EMI-ERROR
  5723         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5724         IF PI-MAP-NAME = EL640A
  5725             MOVE -1             TO APFNTERL
  5726             GO TO 8200-SEND-DATAONLY
  5727         ELSE
  5728             MOVE -1             TO BPFNTERL
  5729             GO TO 8200-SEND-DATAONLY.
  5730
  5731
  5732* EXEC CICS RECEIVE
  5733*        MAP      (PI-MAP-NAME)
  5734*        MAPSET   (MAPSET-NAME)
  5735*        INTO     (EL640AI)
  5736*    END-EXEC.
  5737     MOVE LENGTH OF
  5738      EL640AI
  5739       TO DFHEIV11
  5740*    MOVE '8"T I  L              ''   #00005705' TO DFHEIV0
  5741     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5742     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5743     MOVE X'2020233030303035373035' TO DFHEIV0(25:11)
  5744     CALL 'kxdfhei1' USING DFHEIV0,
  5745           PI-MAP-NAME,
  5746           EL640AI,
  5747           DFHEIV11,
  5748           MAPSET-NAME,
  5749           DFHEIV99,
  5750           DFHEIV99
  5751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5752
  5753
  5754     IF PI-END-BAL NOT NUMERIC
  5755         MOVE ZEROS              TO PI-END-BAL.
  5756
  5757     IF PI-MAP-NAME = EL640A
  5758         IF APFNTERL > ZERO
  5759             IF EIBAID NOT = DFHENTER
  5760                 MOVE ER-0004    TO EMI-ERROR
  5761                 MOVE AL-UNBOF   TO APFNTERA
  5762                 MOVE -1         TO APFNTERL
  5763                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 111
* EL640.cbl
  5764                 GO TO 8200-SEND-DATAONLY
  5765             ELSE
  5766                 IF APFNTERI NUMERIC AND
  5767                   (APFNTERI > 0 AND < 25)
  5768                     MOVE PF-VALUES (APFNTERI) TO EIBAID
  5769                 ELSE
  5770                     MOVE ER-0029  TO EMI-ERROR
  5771                     MOVE AL-UNBOF TO APFNTERA
  5772                     MOVE -1       TO APFNTERL
  5773                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5774                     GO TO 8200-SEND-DATAONLY
  5775         ELSE
  5776             NEXT SENTENCE
  5777     ELSE
  5778     IF PI-MAP-NAME = EL640B
  5779         IF BPFNTERL > ZERO
  5780             IF EIBAID NOT = DFHENTER
  5781                 MOVE ER-0004    TO EMI-ERROR
  5782                 MOVE AL-UNBOF   TO BPFNTERA
  5783                 MOVE -1         TO BPFNTERL
  5784                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5785                 GO TO 8200-SEND-DATAONLY
  5786             ELSE
  5787                 IF BPFNTERI NUMERIC AND
  5788                   (BPFNTERI > 0 AND < 25)
  5789                     MOVE PF-VALUES (BPFNTERI) TO EIBAID
  5790                 ELSE
  5791                     MOVE ER-0029  TO EMI-ERROR
  5792                     MOVE AL-UNBOF TO BPFNTERA
  5793                     MOVE -1       TO BPFNTERL
  5794                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5795                     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 112
* EL640.cbl
  5797 0300-CHECK-PFKEYS.
  5798     IF EIBAID = DFHPF23
  5799         GO TO 8810-PF23.
  5800
  5801     IF EIBAID = DFHPF24
  5802         GO TO 9200-RETURN-MAIN-MENU.
  5803
  5804     IF EIBAID = DFHPF12
  5805         GO TO 9500-PF12.
  5806
  5807******************************************************************
  5808*       IF CARRIER OR ACCOUNT SECURITY ALLOW ONLY                *
  5809*            BILLING TYPE OPTION ONE OR TWO.                     *
  5810*                        04/27/84                                *
  5811******************************************************************
  5812
  5813     IF PI-NO-CARRIER-SECURITY OR
  5814        PI-NO-ACCOUNT-SECURITY
  5815          GO TO 0305-CHECK-PFKEYS.
  5816
  5817     IF EIBAID = DFHENTER OR DFHPF6
  5818        NEXT SENTENCE
  5819       ELSE
  5820        GO TO 0320-INPUT-ERROR.
  5821
  5822 0305-CHECK-PFKEYS.
  5823     IF EIBAID = DFHPF3
  5824       AND PI-MAP-NAME = EL640A
  5825         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5826         MOVE PI-CARRIER         TO PI-CR-CARRIER
  5827         MOVE PI-GROUPING        TO PI-CR-GROUPING
  5828         MOVE PI-STATE           TO PI-CR-STATE
  5829         MOVE PI-ACCOUNT         TO PI-CR-ACCOUNT
  5830         MOVE XCTL-650           TO PGM-NAME
  5831         GO TO 9300-XCTL.
  5832
  5833     IF EIBAID = DFHPF4
  5834       AND PI-MAP-NAME = EL640A
  5835        NEXT SENTENCE
  5836     ELSE
  5837        GO TO 0320-CONT-PFKEYS.
  5838
  5839     IF PI-CR-FIN-RESP NOT = SPACES
  5840         PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT
  5841         MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  5842         MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  5843         MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  5844         MOVE XCTL-652           TO PGM-NAME
  5845         GO TO 9300-XCTL.
  5846
  5847     IF PI-SCR-FIN-RESP = SPACES OR LOW-VALUES
  5848         GO TO 0315-PF4-ERROR.
  5849
  5850     PERFORM 0500-CREATE-TEMP-STORAGE  THRU  0590-EXIT.
  5851
  5852     MOVE PI-SCR-CARRIER    TO PI-CR-CARRIER.
  5853     MOVE PI-SCR-GROUPING   TO PI-CR-GROUPING.
  5854     MOVE PI-SCR-FIN-RESP   TO PI-CR-FIN-RESP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 113
* EL640.cbl
  5855     MOVE PI-SCR-ACCOUNT    TO PI-CR-ACCOUNT.
  5856     MOVE PI-SCR-TYPE       TO PI-CR-TYPE.
  5857     MOVE 'Y'               TO PI-TRANSFER-SW.
  5858
  5859     IF PI-ZERO-CARRIER  OR
  5860        PI-ZERO-CAR-GROUP
  5861         MOVE ZEROS              TO PI-CR-CARRIER.
  5862
  5863     IF PI-ZERO-GROUPING  OR
  5864        PI-ZERO-CAR-GROUP
  5865         MOVE ZEROS              TO PI-CR-GROUPING.
  5866
  5867     MOVE XCTL-652               TO PGM-NAME.
  5868
  5869     GO TO 9300-XCTL.
  5870
  5871 0315-PF4-ERROR.
  5872
  5873     MOVE ER-2407                TO EMI-ERROR.
  5874     MOVE -1                     TO APFNTERL.
  5875     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5876     GO TO 8200-SEND-DATAONLY.
  5877
  5878 0320-CONT-PFKEYS.
  5879     IF EIBAID = DFHPF6
  5880       AND PI-MAP-NAME = EL640A
  5881         MOVE LOW-VALUES         TO EL640AO
  5882         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5883         MOVE XCTL-6401          TO PGM-NAME
  5884         GO TO 9300-XCTL.
  5885
  5886     IF EIBAID = DFHPF7
  5887       AND PI-MAP-NAME = EL640A
  5888         IF PI-CR-FIN-RESP NOT = SPACES
  5889             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5890             MOVE PI-COMP-CARRIER    TO PI-CR-CARRIER
  5891             MOVE PI-COMP-GROUPING   TO PI-CR-GROUPING
  5892             MOVE PI-COMP-FIN-RESP   TO PI-CR-FIN-RESP
  5893             MOVE XCTL-PYAJ          TO PGM-NAME
  5894             GO TO 9300-XCTL
  5895         ELSE
  5896             IF PI-RETURN-TO-PROGRAM = XCTL-633 OR XCTL-635 OR
  5897                                       XCTL-633DMD
  5898                 GO TO 9400-CLEAR
  5899             ELSE
  5900                 MOVE ER-2411        TO EMI-ERROR
  5901                 MOVE -1             TO APFNTERL
  5902                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5903                 GO TO 8200-SEND-DATAONLY.
  5904
  5905     IF EIBAID = DFHPF8
  5906       AND PI-MAP-NAME = EL640A
  5907           PERFORM 0500-CREATE-TEMP-STORAGE THRU 0590-EXIT
  5908           MOVE SPACES         TO PI-CR-CONTROL-IN-PROGRESS
  5909           MOVE XCTL-658       TO PGM-NAME
  5910           GO TO 9300-XCTL.
  5911
  5912     IF EIBAID = DFHPF1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 114
* EL640.cbl
  5913       AND PI-MAP-NAME = EL640B
  5914         GO TO 7500-PRODUCE-CHECK.
  5915
  5916     IF EIBAID = DFHPF5
  5917       AND PI-AR-PROCESSING
  5918         MOVE ER-3188            TO EMI-ERROR
  5919         MOVE -1                 TO APFNTERL
  5920         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5921         GO TO 8200-SEND-DATAONLY.
  5922
  5923     IF PI-COMPANY-ID = 'DMD'
  5924       IF EIBAID = DFHPF5
  5925         GO TO 0320-INPUT-ERROR.
  5926
  5927     IF EIBAID = DFHPF5
  5928       AND PI-MAP-NAME = EL640A
  5929            MOVE EL640B     TO PI-MAP-NAME
  5930            GO TO 7000-PROCESS-CHECK.
  5931
  5932     IF PI-MAP-NAME = EL640A
  5933         IF EIBAID = DFHENTER OR DFHPF3
  5934             GO TO 0330-EDIT-DATA
  5935         ELSE
  5936             GO TO 0320-INPUT-ERROR
  5937     ELSE
  5938         IF PI-MAP-NAME = EL640B
  5939             IF EIBAID = DFHENTER
  5940
  5941* EXEC CICS BIF DEEDIT
  5942*                    FIELD  (BCHKAMTI)
  5943*                    LENGTH (11)
  5944*                END-EXEC
  5945     MOVE 11
  5946       TO DFHEIV11
  5947*    MOVE '@"L                   #   #00005897' TO DFHEIV0
  5948     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5949     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5950     MOVE X'2020233030303035383937' TO DFHEIV0(25:11)
  5951     CALL 'kxdfhei1' USING DFHEIV0,
  5952           BCHKAMTI,
  5953           DFHEIV11
  5954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5955                 MOVE BCHKAMTI   TO  WORK-CHECK-AMT
  5956                 MOVE 'B'        TO  WS-ENTERED-FROM-MAP
  5957                 GO TO 7000-PROCESS-CHECK.
  5958
  5959 0320-INPUT-ERROR.
  5960     MOVE ER-0029                TO EMI-ERROR.
  5961     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5962
  5963     IF PI-MAP-NAME = EL640A
  5964         MOVE AL-UNBON           TO APFNTERA
  5965         MOVE -1                 TO APFNTERL
  5966     ELSE
  5967         MOVE AL-UNBON           TO BPFNTERA
  5968         MOVE -1                 TO BPFNTERL.
  5969
  5970     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 115
* EL640.cbl
  5971
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 116
* EL640.cbl
  5973 0330-EDIT-DATA.
  5974     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  5975
  5976     IF VALID-BILL-TYPE
  5977        IF NOT MODIFY-CAP
  5978           IF ABILTYPI = '1' OR '2'
  5979              NEXT SENTENCE
  5980           ELSE
  5981              MOVE 'UPDATE'         TO SM-READ
  5982              PERFORM 9995-SECURITY-VIOLATION
  5983              MOVE ER-0070          TO EMI-ERROR
  5984              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5985              GO TO 8100-SEND-INITIAL-MAP.
  5986
  5987     MOVE SPACES                 TO PI-BILLING-COUNTS
  5988                                    PI-LIMIT-BILLING-BTCHS.
  5989
  5990******************************************************************
  5991*         SECURITY CHECK FOR CARRIER AND ACCOUNT.                *
  5992*                     04/12/84                                   *
  5993******************************************************************
  5994
  5995     IF PI-CARRIER-SECURITY > SPACES
  5996        IF ACARIERL > ZEROS
  5997            IF PI-CARRIER-SECURITY = ACARIERI
  5998                MOVE AL-UANON    TO ACARIERA
  5999            ELSE
  6000                MOVE -1          TO ACARIERL
  6001                MOVE AL-UABON    TO ACARIERA
  6002                MOVE ER-2370     TO EMI-ERROR
  6003                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6004
  6005 350-ERROR-CHECK.
  6006     IF EMI-ERROR = ZEROS
  6007         NEXT SENTENCE
  6008     ELSE
  6009         GO TO 8200-SEND-DATAONLY.
  6010
  6011     IF AACCTL > ZEROS
  6012         MOVE AL-UANON           TO AACCTA
  6013         MOVE AACCTI             TO PI-SAV-ACCT
  6014                                    PI-CR-ACCOUNT
  6015     ELSE
  6016         MOVE -1                 TO AACCTL
  6017         MOVE AL-UABON           TO AACCTA
  6018         MOVE ER-0197            TO EMI-ERROR
  6019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6020
  6021     IF ACARIERL > ZEROS
  6022         MOVE AL-UANON           TO ACARIERA
  6023         MOVE ACARIERI           TO PI-SAV-CARR
  6024                                    WS-CARRIER
  6025     ELSE
  6026         IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  6027             MOVE -1             TO ACARIERL
  6028             MOVE AL-UABON       TO ACARIERA
  6029             MOVE ER-0194        TO EMI-ERROR
  6030             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 117
* EL640.cbl
  6031
  6032     IF AGROUPL > ZEROS
  6033         MOVE AL-UANON           TO AGROUPA
  6034         MOVE AGROUPI            TO PI-SAV-GROUP
  6035                                    WS-COMP
  6036     ELSE
  6037         IF CARR-GROUP-ST-ACCNT-CNTL
  6038             MOVE -1             TO AGROUPL
  6039             MOVE AL-UABON       TO AGROUPA
  6040             MOVE ER-0195        TO EMI-ERROR
  6041             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6042
  6043     IF ASTATEL > ZEROS
  6044         MOVE AL-UANON           TO ASTATEA
  6045         MOVE ASTATEI            TO PI-SAV-STATE
  6046     ELSE
  6047         IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  6048             MOVE -1             TO ASTATEL
  6049             MOVE AL-UABON       TO ASTATEA
  6050             MOVE ER-0196        TO EMI-ERROR
  6051             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6052
  6053     MOVE ABILTYPI               TO VALID-BILL-TYPE-VALUES.
  6054
  6055     IF VALID-BILL-TYPE
  6056         MOVE AL-UANON           TO ABILTYPA
  6057         MOVE ABILTYPI           TO PI-BILL-TYPE
  6058     ELSE
  6059         MOVE -1                 TO ABILTYPL
  6060         MOVE ER-2249            TO EMI-ERROR
  6061         MOVE AL-UABON           TO ABILTYPA
  6062         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6063
  6064     IF PI-AR-PROCESSING
  6065        IF PI-PREVIEW
  6066           NEXT SENTENCE
  6067        ELSE
  6068           MOVE -1               TO ABILTYPL
  6069           MOVE ER-3145          TO EMI-ERROR
  6070           MOVE AL-UABON         TO ABILTYPA
  6071           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6072
  6073     IF APRODSWL NOT = ZEROS
  6074         IF PI-PREVIEW
  6075             IF APRODSWI = 'Y' OR 'N'
  6076                 MOVE AL-UANON   TO APRODSWA
  6077             ELSE
  6078                 MOVE -1         TO APRODSWL
  6079                 MOVE ER-2436    TO EMI-ERROR
  6080                 MOVE AL-UABON   TO APRODSWA
  6081                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6082         ELSE
  6083             MOVE -1             TO APRODSWL
  6084             MOVE ER-2434        TO EMI-ERROR
  6085             MOVE AL-UABON       TO APRODSWA
  6086             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6087     ELSE
  6088         IF PI-PREVIEW
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 118
* EL640.cbl
  6089             MOVE -1             TO APRODSWL
  6090             MOVE ER-2435        TO EMI-ERROR
  6091             MOVE AL-UABON       TO APRODSWA
  6092             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6093
  6094     IF ABILERRI = 'Y' OR 'N'
  6095         MOVE ABILERRI           TO PI-BILL-ERRS
  6096         MOVE AL-UANON           TO ABILERRA
  6097     ELSE
  6098         IF NOT PI-VOID-BILL
  6099             MOVE -1             TO ABILERRL
  6100             MOVE ER-2250        TO EMI-ERROR
  6101             MOVE AL-UABON       TO ABILERRA
  6102             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6103
  6104     IF ABTCH1L NOT = ZEROS
  6105         MOVE AL-UANON           TO ABTCH1A
  6106         MOVE 'Y'                TO LIMIT-BILLING-SW
  6107         MOVE ABTCH1I            TO PI-BILLING-BATCHES (1).
  6108
  6109     IF ABTCH2L NOT = ZEROS
  6110         MOVE AL-UANON           TO ABTCH2A
  6111         MOVE 'Y'                TO LIMIT-BILLING-SW
  6112         MOVE ABTCH2I            TO PI-BILLING-BATCHES (2).
  6113
  6114     IF ABTCH3L NOT = ZEROS
  6115         MOVE AL-UANON           TO ABTCH3A
  6116         MOVE 'Y'                TO LIMIT-BILLING-SW
  6117         MOVE ABTCH3I            TO PI-BILLING-BATCHES (3).
  6118
  6119     IF EMI-ERROR = ZEROS
  6120         GO TO 1000-BILLING-PROCESS.
  6121
  6122     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 119
* EL640.cbl
  6124 0400-CLEAR-PI.
  6125     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  6126
  6127     MOVE ZEROS                  TO PI-BAL-FRWD-GA  PI-BAL-FRWD
  6128                                    PI-PREMIUM      PI-REMITTED
  6129                                    PI-TOT-ISS-COMP
  6130                                    PI-TOT-CAN-COMP
  6131                                    PI-ADJUSTMENTS  PI-DISBURSED
  6132                                    PI-END-BAL      PI-LF-ISS-COMP
  6133                                    PI-AH-ISS-COMP  PI-LF-CAN-COMP
  6134                                    PI-AH-CAN-COMP.
  6135
  6136     MOVE SPACES                 TO PI-BATCH (1)
  6137                                    PI-BATCH (2)
  6138                                    PI-BATCH (3)
  6139                                    PI-BATCH (4)
  6140                                    PI-BATCH (5)
  6141                                    PI-BATCH (6).
  6142
  6143     MOVE SPACES                 TO PI-BILLING-BATCHES (1)
  6144                                    PI-BILLING-BATCHES (2)
  6145                                    PI-BILLING-BATCHES (3).
  6146
  6147     MOVE ZEROS                  TO PI-BILLED (1) PI-PREV (1)
  6148                                    PI-NOBILL (1)
  6149                                    PI-PREM (1)   PI-COMM (1)
  6150                                    PI-NON-PREM (1)
  6151                                    PI-NON-COMM (1)
  6152                                    PI-BILLED (2) PI-PREV (2)
  6153                                    PI-NOBILL (2)
  6154                                    PI-PREM (2)   PI-COMM (2)
  6155                                    PI-NON-PREM (2)
  6156                                    PI-NON-COMM (2)
  6157                                    PI-BILLED (3) PI-PREV (3)
  6158                                    PI-NOBILL (3)
  6159                                    PI-PREM (3)   PI-COMM (3)
  6160                                    PI-NON-PREM (3)
  6161                                    PI-NON-COMM (3)
  6162                                    PI-BILLED (4) PI-PREV (4)
  6163                                    PI-NOBILL (4)
  6164                                    PI-PREM (4)   PI-COMM (4)
  6165                                    PI-NON-PREM (4)
  6166                                    PI-NON-COMM (4)
  6167                                    PI-BILLED (5) PI-PREV (5)
  6168                                    PI-NOBILL (5)
  6169                                    PI-PREM (5)   PI-COMM (5)
  6170                                    PI-NON-PREM (5)
  6171                                    PI-NON-COMM (5)
  6172                                    PI-BILLED (6) PI-PREV (6)
  6173                                    PI-NOBILL (6)
  6174                                    PI-PREM (6)   PI-COMM (6)
  6175                                    PI-NON-PREM (6)
  6176                                    PI-NON-COMM (6).
  6177
  6178 0499-EXIT.
  6179      EXIT.
  6180
  6181 0500-CREATE-TEMP-STORAGE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 120
* EL640.cbl
  6182
  6183     IF PI-BAL-FRWD NOT NUMERIC
  6184         MOVE ZEROS              TO PI-BAL-FRWD
  6185                                    PI-PREMIUM
  6186                                    PI-REMITTED
  6187                                    PI-TOT-ISS-COMP
  6188                                    PI-TOT-CAN-COMP
  6189                                    PI-ADJUSTMENTS
  6190                                    PI-DISBURSED
  6191                                    PI-END-BAL.
  6192
  6193
  6194* EXEC CICS WRITEQ TS
  6195*        QUEUE  (QID)
  6196*        FROM   (PROGRAM-INTERFACE-BLOCK)
  6197*        LENGTH (PI-COMM-LENGTH)
  6198*    END-EXEC.
  6199*    MOVE '*"                    ''   #00006139' TO DFHEIV0
  6200     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  6201     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6202     MOVE X'2020233030303036313339' TO DFHEIV0(25:11)
  6203     CALL 'kxdfhei1' USING DFHEIV0,
  6204           QID,
  6205           PROGRAM-INTERFACE-BLOCK,
  6206           PI-COMM-LENGTH,
  6207           DFHEIV99,
  6208           DFHEIV99,
  6209           DFHEIV99
  6210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6211
  6212
  6213 0590-EXIT.
  6214      EXIT.
  6215
  6216 0600-RECOVER-TEMP-STORAGE.
  6217
  6218* EXEC CICS READQ TS
  6219*        QUEUE  (QID)
  6220*        INTO   (PROGRAM-INTERFACE-BLOCK)
  6221*        LENGTH (PI-COMM-LENGTH)
  6222*    END-EXEC.
  6223*    MOVE '*$I    L              ''   #00006149' TO DFHEIV0
  6224     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  6225     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6226     MOVE X'2020233030303036313439' TO DFHEIV0(25:11)
  6227     CALL 'kxdfhei1' USING DFHEIV0,
  6228           QID,
  6229           PROGRAM-INTERFACE-BLOCK,
  6230           PI-COMM-LENGTH,
  6231           DFHEIV99,
  6232           DFHEIV99,
  6233           DFHEIV99
  6234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6235
  6236
  6237     PERFORM 0800-DELETE-TS THRU 0890-EXIT.
  6238
  6239     MOVE PI-CR-CARRIER    TO PI-SCR-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 121
* EL640.cbl
  6240     MOVE PI-CR-GROUPING   TO PI-SCR-GROUPING.
  6241     MOVE PI-CR-FIN-RESP   TO PI-SCR-FIN-RESP.
  6242     MOVE PI-CR-ACCOUNT    TO PI-SCR-ACCOUNT.
  6243     MOVE PI-CR-TYPE       TO PI-SCR-TYPE.
  6244
  6245     MOVE PI-SCRN-CONTROL TO W-TRANSFER-CONTROL.
  6246
  6247 0690-EXIT.
  6248      EXIT.
  6249
  6250 0800-DELETE-TS.
  6251
  6252* EXEC CICS HANDLE CONDITION
  6253*        QIDERR (0890-EXIT)
  6254*    END-EXEC.
  6255*    MOVE '"$N                   ! # #00006169' TO DFHEIV0
  6256     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  6257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6258     MOVE X'2320233030303036313639' TO DFHEIV0(25:11)
  6259     CALL 'kxdfhei1' USING DFHEIV0
  6260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6261
  6262
  6263
  6264* EXEC CICS DELETEQ TS
  6265*        QUEUE  (QID)
  6266*    END-EXEC.
  6267*    MOVE '*&                    #   #00006173' TO DFHEIV0
  6268     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6269     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6270     MOVE X'2020233030303036313733' TO DFHEIV0(25:11)
  6271     CALL 'kxdfhei1' USING DFHEIV0,
  6272           QID,
  6273           DFHEIV99
  6274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6275
  6276
  6277 0890-EXIT.
  6278      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 122
* EL640.cbl
  6280 1000-BILLING-PROCESS.
  6281*                *******************************************
  6282*                *  THIS SECTION PROCESSES THE PENDING     *
  6283*                *  BUSINESS AND PAYMNTS/ADJMNTS FILES.    *
  6284*                *  THE PREMIUM AMT WRITTEN IS EXTRACTED   *
  6285*                *  FROM THE PENDING BUSINESS FILE.        *
  6286*                *******************************************
  6287
  6288     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD
  6289                                    ERPNDB-CO-CD-A1
  6290                                    ERCOMP-COMP-CD
  6291                                    ERPYAJ-COMP-CD
  6292                                    ERACCT-P-CO-CD
  6293                                    ERACCT-A-CO-CD.
  6294
  6295     MOVE WS-CURRENT-DATE-EDIT   TO BI-HD-RUN-DT.
  6296
  6297     MOVE ZEROS                  TO PI-BAL-FRWD
  6298                                    PI-PREMIUM
  6299                                    PI-REMITTED
  6300                                    PI-TOT-ISS-COMP
  6301                                    PI-TOT-CAN-COMP
  6302                                    PI-ADJUSTMENTS
  6303                                    PI-DISBURSED
  6304                                    PI-END-BAL.
  6305
  6306     IF PI-VOID-BILL
  6307         GO TO 2000-VOID-BILLING.
  6308
  6309     MOVE SPACES                 TO ELCNTL-KEY.
  6310     MOVE '1'                    TO ELCNTL-REC-TYPE.
  6311     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  6312
  6313     IF EMI-ERROR NOT = ZEROS
  6314         GO TO 8200-SEND-DATAONLY.
  6315
  6316     IF CF-ACCOUNT-MSTR-MAINT-DT      = LOW-VALUES  OR
  6317        CF-COMPENSATION-MSTR-MAINT-DT = LOW-VALUES
  6318         MOVE ER-2571            TO EMI-ERROR
  6319         MOVE -1                 TO APFNTERL
  6320         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6321         GO TO 8200-SEND-DATAONLY.
  6322
  6323     IF CF-FORMS-PRINTER-ID = SPACES
  6324        IF ABILTYPI = '3' OR '4'
  6325          MOVE 2590               TO EMI-ERROR
  6326          MOVE -1                 TO ABILTYPL
  6327          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6328          GO TO 8200-SEND-DATAONLY.
  6329
  6330     MOVE CF-CL-MAIL-TO-NAME     TO BI-HD-CO.
  6331     MOVE CF-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  6332     MOVE SPACE                  TO DC-OPTION-CODE.
  6333     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6334     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  6335     MOVE DC-GREG-DATE-1-ALPHA   TO BI-HD-BILL-DT.
  6336     MOVE SPACE                  TO PI-DATA-BILLED-SW.
  6337
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 123
* EL640.cbl
  6338     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  6339
  6340     IF PNDB-EOF
  6341         GO TO 1100-PYAJ-BILLING-PROCESS.
  6342
  6343 1010-PNDB-BILLING-PROCESS-LOOP.
  6344     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  6345
  6346     IF PNDB-EOF
  6347         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6348         GO TO 1100-PYAJ-BILLING-PROCESS.
  6349
  6350     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  6351        PB-CARRIER       = PI-SAV-CARR    AND
  6352        PB-GROUPING      = PI-SAV-GROUP   AND
  6353        PB-STATE         = PI-SAV-STATE   AND
  6354        PB-ACCOUNT       = PI-SAV-ACCT
  6355         NEXT SENTENCE
  6356     ELSE
  6357         PERFORM 3500-TOTAL-OUT-DETAIL THRU 3599-EXIT
  6358         GO TO 1100-PYAJ-BILLING-PROCESS.
  6359
  6360     IF (PB-ISSUE) AND
  6361        (PB-I-POLICY-IS-REISSUE OR PB-I-REIN-ONLY OR
  6362         PB-I-POLICY-IS-MONTHLY OR
  6363         PB-I-POLICY-IS-DECLINED OR PB-I-POLICY-IS-VOIDED OR
  6364         PB-I-UNDERWRITE-POLICY)
  6365          GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6366     ELSE
  6367        IF (PB-CANCELLATION)
  6368           AND  (PB-CI-LF-POLICY-IS-REISSUE
  6369             OR  PB-CI-AH-POLICY-IS-REISSUE
  6370             OR  PB-CI-LF-POLICY-IS-MONTHLY
  6371             OR  PB-CI-AH-POLICY-IS-MONTHLY
  6372             OR  PB-CI-LF-POLICY-IS-DECLINED
  6373             OR  PB-CI-AH-POLICY-IS-VOID
  6374             OR  PB-CI-LF-REIN-ONLY
  6375             OR  PB-CI-AH-REIN-ONLY)
  6376             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6377
  6378     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  6379         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6380
  6381     IF PB-RECORD-ON-HOLD OR
  6382        PB-RECORD-RETURNED
  6383         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6384         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6385
  6386     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6387         IF PB-ENTRY-REVERSED
  6388             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6389         ELSE
  6390             IF PI-REBILLING
  6391                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6392                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6393
  6394     IF PB-BILLED-DT = LOW-VALUES
  6395       OR PI-TOT-REBILL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 124
* EL640.cbl
  6396       OR PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6397         NEXT SENTENCE
  6398     ELSE
  6399         IF NOT PB-BATCH-TRAILER
  6400             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6401             GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6402         ELSE
  6403             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6404
  6405     IF LIMIT-BILLING
  6406         IF PB-ENTRY-BATCH = ABTCH1I OR
  6407                             ABTCH2I OR
  6408                             ABTCH3I
  6409             NEXT SENTENCE
  6410         ELSE
  6411             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6412
  6413     IF PB-FATAL-ERRORS  OR
  6414        PB-UNFORCED-ERRORS
  6415         IF ABILERRI = 'N'
  6416             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6417             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6418             MOVE ER-2570        TO EMI-ERROR
  6419             MOVE -1             TO ABILERRL
  6420             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6421             SET EMI-INDX TO 1
  6422             IF EMI-ERROR-NUMBER (EMI-INDX) = ER-2570
  6423                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6424                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6425                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6426                 GO TO 8200-SEND-DATAONLY
  6427             ELSE
  6428                 SET EMI-INDX    TO 2
  6429                 MOVE EMI-ERROR-TEXT (EMI-INDX) TO WS-ERROR-TEXT
  6430                 MOVE PB-ENTRY-BATCH            TO WS-ERROR-BATCH
  6431                 MOVE WS-ERROR-MSG TO EMI-ERROR-TEXT (EMI-INDX)
  6432                 GO TO 8200-SEND-DATAONLY
  6433         ELSE
  6434             PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  6435             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6436
  6437     IF PB-BATCH-TRAILER
  6438         IF PI-UPDATE-FILES
  6439             PERFORM 1050-BILL-BATCH-TRAILER-CHK THRU 1059-EXIT
  6440             IF BILL-BATCH-TRAILER
  6441                 MOVE SPACE           TO BILL-BATCH-TRAILER-SW
  6442                 MOVE WS-CURRENT-DATE TO PB-BILLED-DT
  6443                 PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT
  6444                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6445             ELSE
  6446                 GO TO 1010-PNDB-BILLING-PROCESS-LOOP
  6447         ELSE
  6448             GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6449
  6450     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  6451
  6452     PERFORM 1300-CHECK-OVERRIDE-PREM THRU 1399-EXIT.
  6453
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 125
* EL640.cbl
  6454     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  6455         MOVE SPACE              TO WS-PROCESS-SW
  6456         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  6457         PERFORM 4300-READ-ACCOUNT-MASTER  THRU 4390-EXIT
  6458         PERFORM 1020-CHK-IF-AGENT-IS-SAME THRU 1029-EXIT
  6459         IF EMI-ERROR NOT = ZEROS
  6460             IF PI-UPDATE-FILES
  6461               OR (PI-PREVIEW AND APRODSWI = 'Y')
  6462                 PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6463                 IF EMI-ERROR NOT = '2403'
  6464                     PERFORM 3940-BILL-GENERIC-DELETE
  6465                             THRU 3940-EXIT
  6466                     GO TO 8200-SEND-DATAONLY
  6467                 ELSE
  6468                     GO TO 8200-SEND-DATAONLY
  6469             ELSE
  6470                 GO TO 8200-SEND-DATAONLY.
  6471
  6472     PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT.
  6473
  6474     IF DO-NOT-BILL-THIS-ACCT
  6475         GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
  6476
  6477     PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  6478
  6479     IF EMI-ERROR NOT = ZEROS
  6480         IF PI-UPDATE-FILES
  6481           OR (PI-PREVIEW AND APRODSWI = 'Y')
  6482             PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6483             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  6484             GO TO 8200-SEND-DATAONLY
  6485         ELSE
  6486             GO TO 8200-SEND-DATAONLY.
  6487
  6488     IF PI-UPDATE-FILES
  6489       OR (PI-PREVIEW AND APRODSWI = 'Y')
  6490         MOVE 'BD'               TO BILLING-DETAIL-TYPE
  6491         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6492
  6493     IF PI-BILL OR PI-REBILLING
  6494         PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  6495
  6496     GO TO 1010-PNDB-BILLING-PROCESS-LOOP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 126
* EL640.cbl
  6498 1020-CHK-IF-AGENT-IS-SAME.
  6499     MOVE +1 TO ACCOM-SUB.
  6500
  6501 1025-FIND-AGENT-LOOP.
  6502     IF AM-COM-TYP (ACCOM-SUB) = 'C' OR 'D' OR 'F' OR 'S'
  6503         NEXT SENTENCE
  6504     ELSE
  6505         ADD +1 TO ACCOM-SUB
  6506         IF ACCOM-SUB > 10
  6507             MOVE -1             TO AACCTL
  6508             MOVE ER-2404        TO EMI-ERROR
  6509             MOVE AL-UABON       TO AACCTA
  6510             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6511         ELSE
  6512             GO TO 1025-FIND-AGENT-LOOP.
  6513
  6514     IF AM-AGT (ACCOM-SUB) NOT = PI-SAV-ACCT
  6515         IF FIRST-TIME
  6516             MOVE -1             TO AACCTL
  6517             MOVE ER-2405        TO EMI-ERROR
  6518             MOVE AL-UABON       TO AACCTA
  6519             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6520             GO TO 1029-EXIT
  6521         ELSE
  6522             MOVE 'Y'            TO WS-PROCESS-SW
  6523             GO TO 1029-EXIT.
  6524
  6525     IF FIRST-TIME
  6526         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6527                                      PI-CR-FIN-RESP
  6528         MOVE 'A'                  TO PI-CR-TYPE
  6529         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6530         MOVE SPACE                TO FIRST-TIME-SW
  6531         IF EMI-ERROR NOT = ZEROS
  6532             GO TO 1029-EXIT.
  6533
  6534     IF AM-AGT (AM-REMIT-TO) = PI-SAV-REMIT-TO
  6535         NEXT SENTENCE
  6536     ELSE
  6537         MOVE 'Y'                TO WS-PROCESS-SW
  6538         MOVE ER-2408            TO EMI-ERROR
  6539         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6540         PERFORM 8900-SYNCPOINT-ROLLBACK THRU 8900-EXIT
  6541         PERFORM 3940-BILL-GENERIC-DELETE  THRU  3940-EXIT
  6542         MOVE -1                 TO AACCTL
  6543         GO TO 8200-SEND-DATAONLY.
  6544
  6545     MOVE AM-NAME                TO PI-ACCT-NAME.
  6546
  6547     IF PI-BILL OR PI-REBILLING
  6548         PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  6549
  6550 1029-EXIT.
  6551     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 127
* EL640.cbl
  6553 1030-COMPUTE-COMMISSION-TOTALS.
  6554     IF PB-CANCELLATION
  6555         GO TO 1035-COMPUTE-CANCEL-COMM.
  6556
  6557     COMPUTE PI-PREMIUM = (WS-I-LF-PREMIUM-AMT +
  6558         WS-I-AH-PREMIUM-AMT) + PI-PREMIUM.
  6559     COMPUTE PI-LF-ISS-COMP ROUNDED =
  6560         (WS-I-LF-PREMIUM-AMT * PB-I-LIFE-COMMISSION).
  6561     MOVE SPACES                 TO WS-AH-CATEGORY
  6562     IF (PI-COMPANY-ID = 'DCC')
  6563        AND (NOT PB-INVALID-AH)
  6564        MOVE SPACES              TO ELCNTL-KEY
  6565        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6566        MOVE '5'                 TO ELCNTL-REC-TYPE
  6567        MOVE PB-I-AH-BENEFIT-CD  TO ELCNTL-ACCESS (3:2)
  6568                                    CLAS-LOOK
  6569        MOVE +0                  TO ELCNTL-SEQ-NO
  6570        PERFORM 6130-FIND-BENEFIT-CD
  6571                                 THRU 6140-EXIT
  6572     END-IF
  6573     IF WS-AH-CATEGORY = 'G' OR 'L'
  6574        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6575           WS-I-AH-PREMIUM-AMT - PB-I-LF-ALT-PREMIUM-AMT
  6576              - PB-I-ADDL-CLP
  6577     ELSE
  6578        COMPUTE PI-AH-ISS-COMP ROUNDED =
  6579            (WS-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6580     END-IF
  6581     COMPUTE PI-TOT-ISS-COMP = PI-TOT-ISS-COMP +
  6582                               PI-LF-ISS-COMP +
  6583                               PI-AH-ISS-COMP.
  6584     GO TO 1039-EXIT.
  6585
  6586 1035-COMPUTE-CANCEL-COMM.
  6587
  6588     MOVE SPACES                 TO WS-AH-CATEGORY
  6589     IF (PI-COMPANY-ID = 'DCC')
  6590        AND (PB-CI-AH-BENEFIT-CD NOT = SPACES AND ZEROS)
  6591        MOVE SPACES              TO ELCNTL-KEY
  6592        MOVE PI-COMPANY-ID       TO ELCNTL-COMPANY-ID
  6593        MOVE '5'                 TO ELCNTL-REC-TYPE
  6594        MOVE PB-CI-AH-BENEFIT-CD TO ELCNTL-ACCESS (3:2)
  6595                                    CLAS-LOOK
  6596        MOVE +0                  TO ELCNTL-SEQ-NO
  6597        PERFORM 6130-FIND-BENEFIT-CD
  6598                                 THRU 6140-EXIT
  6599     END-IF
  6600     IF WS-AH-CATEGORY = 'G' OR 'L'
  6601        COMPUTE PI-PREMIUM = PI-PREMIUM -
  6602          WS-C-LF-CANCEL-AMT
  6603     ELSE
  6604        COMPUTE PI-PREMIUM = PI-PREMIUM -
  6605         (WS-C-LF-CANCEL-AMT + WS-C-AH-CANCEL-AMT)
  6606     END-IF
  6607
  6608     COMPUTE PI-LF-CAN-COMP   ROUNDED =
  6609         (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION) * -1.
  6610
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 128
* EL640.cbl
  6611     IF WS-AH-CATEGORY = 'G' OR 'L'
  6612        COMPUTE CNC-FACT = PB-C-AH-CANCEL-AMT /
  6613           PB-CI-AH-PREMIUM-AMT
  6614           COMPUTE PI-AH-CAN-COMP ROUNDED =
  6615           (CNC-FACT * (PB-CI-AH-PREMIUM-AMT -
  6616           PB-CI-LF-ALT-PREMIUM-AMT
  6617           - PB-CI-ADDL-CLP))
  6618*          - PB-CI-ADDL-CLP)) * -1
  6619     ELSE
  6620        COMPUTE PI-AH-CAN-COMP   ROUNDED =
  6621         (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION) * -1
  6622     END-IF
  6623     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6624     MOVE PB-C-LF-CANCEL-DT        TO  DC-BIN-DATE-2.
  6625     MOVE '1'                      TO  DC-OPTION-CODE.
  6626     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6627     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-LF.
  6628
  6629     IF DC-ODD-DAYS-OVER > ZEROS
  6630         ADD +1 TO MONTHS-DIFF-LF.
  6631
  6632     MOVE PB-CERT-EFF-DT           TO  DC-BIN-DATE-1.
  6633     MOVE PB-C-AH-CANCEL-DT        TO  DC-BIN-DATE-2.
  6634     MOVE '1'                      TO  DC-OPTION-CODE.
  6635     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6636     MOVE DC-ELAPSED-MONTHS        TO  MONTHS-DIFF-AH.
  6637
  6638     IF DC-ODD-DAYS-OVER > ZEROS
  6639         ADD +1 TO MONTHS-DIFF-AH.
  6640
  6641     PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT.
  6642
  6643     MOVE  +0                       TO  SUB.
  6644     MOVE  'Y'                      TO  WS-CHARGEBACK-LF-SW
  6645                                        WS-CHARGEBACK-AH-SW.
  6646
  6647     MOVE ZEROS                     TO  WS-LF-CAN-COMP
  6648                                        WS-AH-CAN-COMP.
  6649 1035-ACCT-COMM-LOOP.
  6650
  6651     ADD +1 TO SUB.
  6652
  6653     IF SUB > +10
  6654         GO TO 1035-COMPUTE-TOT-CAN.
  6655
  6656     IF AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'F' AND 'S'
  6657         GO TO 1035-ACCT-COMM-LOOP.
  6658
  6659     IF AM-COMM-CHARGEBACK (SUB) NOT NUMERIC
  6660         MOVE  ZEROS            TO  AM-COMM-CHARGEBACK (SUB).
  6661
  6662     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6663         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6664         GO TO 1035-CHECK-AH-CHARGEBACK.
  6665
  6666     IF (MONTHS-DIFF-LF > AM-COMM-CHARGEBACK (SUB))
  6667                            AND
  6668        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 129
* EL640.cbl
  6669         MOVE  'N'               TO  WS-CHARGEBACK-LF-SW
  6670     ELSE
  6671         COMPUTE WS-LF-CAN-COMP   ROUNDED =  WS-LF-CAN-COMP +
  6672            (WS-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION).
  6673
  6674 1035-CHECK-AH-CHARGEBACK.
  6675
  6676     IF AM-COMM-CHARGEBACK (SUB) = '99'
  6677         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6678         GO TO  1035-ACCT-COMM-LOOP.
  6679
  6680     IF (MONTHS-DIFF-AH > AM-COMM-CHARGEBACK (SUB))
  6681                            AND
  6682        (AM-COMM-CHARGEBACK (SUB) NOT = ZEROS)
  6683         MOVE  'N'                TO  WS-CHARGEBACK-AH-SW
  6684     ELSE
  6685        IF WS-AH-CATEGORY = 'G' OR 'L'
  6686           MOVE PI-AH-CAN-COMP   TO WS-AH-CAN-COMP
  6687        ELSE
  6688         COMPUTE WS-AH-CAN-COMP ROUNDED = WS-AH-CAN-COMP +
  6689            (WS-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION)
  6690        END-IF
  6691     END-IF
  6692
  6693     GO TO 1035-ACCT-COMM-LOOP.
  6694
  6695 1035-COMPUTE-TOT-CAN.
  6696
  6697     COMPUTE PI-TOT-CAN-COMP = PI-TOT-CAN-COMP +
  6698                               WS-LF-CAN-COMP +
  6699                               WS-AH-CAN-COMP.
  6700
  6701 1039-EXIT.
  6702     EXIT.
  6703
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 130
* EL640.cbl
  6705 1040-UPDATE-BILLING-STATISTICS.
  6706     SET PINDX                   TO 1.
  6707
  6708 1041-SEARCH-LOOP.
  6709     IF PI-NON-PREM (PINDX) NOT NUMERIC
  6710        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  6711     IF WS-NON-PREM  NOT NUMERIC
  6712        MOVE ZEROS               TO WS-NON-PREM.
  6713     IF PI-NON-COMM (PINDX) NOT NUMERIC
  6714        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  6715     IF WS-NON-COMM  NOT NUMERIC
  6716        MOVE ZEROS               TO WS-NON-COMM.
  6717
  6718     IF PI-BATCH (PINDX) NOT = SPACES
  6719         GO TO 1042-CHECK-FOR-MATCH.
  6720
  6721     MOVE PB-ENTRY-BATCH         TO PI-BATCH (PINDX).
  6722
  6723     IF PI-COMPANY-ID = 'DMD'
  6724         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6725
  6726     IF DO-NOT-BILL-THIS-ACCT OR
  6727        PB-FATAL-ERRORS       OR
  6728        PB-UNFORCED-ERRORS    OR
  6729        PB-RECORD-ON-HOLD     OR
  6730        PB-RECORD-RETURNED    OR
  6731        PI-VOID-BILL
  6732         MOVE +1                 TO PI-NOBILL (PINDX)
  6733         MOVE ZEROS              TO PI-BILLED (PINDX)
  6734                                    PI-PREV   (PINDX)
  6735     ELSE
  6736         IF PB-BILLED-DT = LOW-VALUES
  6737           OR PI-TOT-REBILL
  6738             MOVE +1             TO PI-BILLED (PINDX)
  6739             MOVE ZEROS          TO PI-NOBILL (PINDX)
  6740                                    PI-PREV   (PINDX)
  6741         ELSE
  6742             MOVE +1             TO PI-PREV   (PINDX)
  6743             MOVE ZEROS          TO PI-BILLED (PINDX)
  6744                                    PI-NOBILL (PINDX).
  6745
  6746     GO TO 1049-EXIT.
  6747
  6748 1042-CHECK-FOR-MATCH.
  6749     IF PI-BATCH (PINDX) = PB-ENTRY-BATCH
  6750         NEXT SENTENCE
  6751     ELSE
  6752         GO TO 1043-SET-INDEX-UP.
  6753
  6754     IF PI-COMPANY-ID = 'DMD'
  6755         PERFORM 1060-DMD-ERROR-ROUTINE THRU 1060-EXIT.
  6756
  6757     IF DO-NOT-BILL-THIS-ACCT OR
  6758        PB-FATAL-ERRORS       OR
  6759        PB-UNFORCED-ERRORS    OR
  6760        PB-RECORD-ON-HOLD     OR
  6761        PB-RECORD-RETURNED    OR
  6762        PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 131
* EL640.cbl
  6763         ADD +1 TO PI-NOBILL (PINDX)
  6764     ELSE
  6765         IF PB-BILLED-DT = LOW-VALUES
  6766           OR PI-TOT-REBILL
  6767             ADD +1          TO PI-BILLED (PINDX)
  6768         ELSE
  6769             ADD +1          TO PI-PREV   (PINDX).
  6770
  6771     GO TO 1049-EXIT.
  6772
  6773 1043-SET-INDEX-UP.
  6774     SET PINDX UP BY 1.
  6775
  6776     IF PINDX > +6
  6777         MOVE 'Y'                TO BATCHES-PROCESSED-SW
  6778         GO TO 1049-EXIT
  6779     ELSE
  6780         GO TO 1041-SEARCH-LOOP.
  6781
  6782 1049-EXIT.
  6783     EXIT.
  6784
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 132
* EL640.cbl
  6786 1050-BILL-BATCH-TRAILER-CHK.
  6787     SET PINDX                   TO 1.
  6788
  6789 1052-LOOP.
  6790     IF PI-BATCH (PINDX) = SPACES
  6791         GO TO 1059-EXIT.
  6792
  6793     IF PB-ENTRY-BATCH = PI-BATCH (PINDX)
  6794       AND PI-BILLED (PINDX) NOT = ZEROS
  6795         MOVE 'Y'                TO BILL-BATCH-TRAILER-SW
  6796         GO TO 1059-EXIT.
  6797
  6798     SET PINDX UP BY 1.
  6799     IF PINDX NOT > 6
  6800         GO TO 1052-LOOP.
  6801
  6802 1059-EXIT.
  6803     EXIT.
  6804
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 133
* EL640.cbl
  6806 1060-DMD-ERROR-ROUTINE.
  6807     IF PB-FATAL-ERRORS OR PB-UNFORCED-ERRORS
  6808        IF ABILERRI = 'Y'
  6809           IF PB-ISSUE
  6810              COMPUTE WS-NON-PREM = PB-I-LF-PREMIUM-AMT
  6811                 + PB-I-LF-ALT-PREMIUM-AMT
  6812                 + PB-I-AH-PREMIUM-AMT
  6813              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6814              COMPUTE WS-NON-COMM ROUNDED =
  6815              ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
  6816                                    * PB-I-LIFE-COMMISSION)
  6817                                    +
  6818               (PB-I-AH-PREMIUM-AMT * PB-I-AH-COMMISSION)
  6819              ADD WS-NON-COMM TO PI-NON-COMM (PINDX)
  6820           ELSE
  6821           IF PB-CANCELLATION
  6822              COMPUTE WS-NON-PREM =
  6823              (PB-C-LF-CANCEL-AMT +  PB-C-AH-CANCEL-AMT) * -1
  6824              ADD WS-NON-PREM TO PI-NON-PREM (PINDX)
  6825              COMPUTE WS-NON-COMM ROUNDED =
  6826              ((PB-C-LF-CANCEL-AMT * PB-CI-LIFE-COMMISSION)
  6827                                   +
  6828               (PB-C-AH-CANCEL-AMT * PB-CI-AH-COMMISSION))
  6829                                   * -1
  6830              ADD WS-NON-COMM TO PI-NON-COMM (PINDX).
  6831
  6832 1060-EXIT.
  6833     EXIT.
  6834
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 134
* EL640.cbl
  6836 1100-PYAJ-BILLING-PROCESS.
  6837*                *******************************************
  6838*                *  PROCESS THE PAYMENTS/ADJUSTMENTS FILE    *
  6839*                *******************************************
  6840
  6841     IF LIMIT-BILLING AND NOT PI-DATA-BILLED
  6842         MOVE ER-2443            TO EMI-ERROR
  6843         MOVE -1                 TO ABTCH1L
  6844         MOVE AL-UABON           TO ABTCH1A
  6845         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6846         GO TO 8200-SEND-DATAONLY.
  6847
  6848     IF NOT PI-DATA-BILLED
  6849         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  6850         IF EMI-ERROR = ZEROS
  6851             MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO
  6852                                          PI-CR-FIN-RESP
  6853             MOVE AM-REMIT-TO            TO ACCOM-SUB
  6854             MOVE 'A'                    TO PI-CR-TYPE
  6855             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  6856             IF EMI-ERROR NOT = ZEROS
  6857                 GO TO 8200-SEND-DATAONLY
  6858             ELSE
  6859                 NEXT SENTENCE
  6860         ELSE
  6861             GO TO 8200-SEND-DATAONLY.
  6862
  6863 1105-PYAJ-BILLING-STARTBR-LOOP.
  6864     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  6865
  6866     IF PYAJ-EOF
  6867         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6868
  6869 1110-PYAJ-BILLING-READ-LOOP.
  6870     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  6871
  6872     IF PYAJ-EOF
  6873         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6874
  6875     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  6876        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  6877        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  6878        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  6879        PY-ACCOUNT    = PI-SAV-ACCT
  6880         NEXT SENTENCE
  6881     ELSE
  6882         GO TO 1200-PYAJ-BILLING-COMPLETE.
  6883
  6884     IF PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  6885         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6886
  6887     IF PY-RECORD-TYPE = 'R' OR 'D' OR 'C' OR 'S' OR 'T' OR 'U'
  6888                         OR 'Z'
  6889         NEXT SENTENCE
  6890     ELSE
  6891         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6892
  6893     IF PY-VOID-SW NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 135
* EL640.cbl
  6894         GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6895
  6896     IF PI-AR-PROCESSING
  6897        IF PY-AR-DATE = LOW-VALUES
  6898           OR PI-TOT-REBILL
  6899           OR RETURNED-FROM = XCTL-PYAJ
  6900           NEXT SENTENCE
  6901        ELSE
  6902           GO TO 1110-PYAJ-BILLING-READ-LOOP
  6903     ELSE
  6904        IF (PY-BILLED-DATE = LOW-VALUES AND
  6905            PY-AR-DATE = LOW-VALUES)
  6906           OR PI-TOT-REBILL
  6907           OR RETURNED-FROM = XCTL-PYAJ
  6908           NEXT SENTENCE
  6909        ELSE
  6910           GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6911
  6912     MOVE 'Y'                    TO PI-DATA-BILLED-SW.
  6913
  6914     IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  6915         PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  6916         PY-ADD-TO-BALANCE
  6917         ADD PY-ENTRY-AMT  TO  PI-REMITTED
  6918     ELSE
  6919         IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  6920            AND PY-BILLING-CHECK
  6921             ADD PY-ENTRY-AMT TO PI-DISBURSED
  6922         ELSE
  6923             ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS.
  6924
  6925     IF RETURNED-FROM = SPACES
  6926         IF PI-UPDATE-FILES
  6927           OR (PI-PREVIEW AND APRODSWI = 'Y')
  6928             MOVE 'BP'           TO BILLING-DETAIL-TYPE
  6929             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6930
  6931     IF RETURNED-FROM = SPACES
  6932       AND (PI-BILL OR PI-REBILLING)
  6933         PERFORM 4800-PYAJ-END-BROWSE
  6934         PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT
  6935         ADD +1 TO ERPYAJ-FILE-SEQ-NO
  6936         GO TO 1105-PYAJ-BILLING-STARTBR-LOOP.
  6937
  6938     GO TO 1110-PYAJ-BILLING-READ-LOOP.
  6939
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 136
* EL640.cbl
  6941 1200-PYAJ-BILLING-COMPLETE.
  6942     IF PI-DATA-BILLED
  6943       IF RETURNED-FROM = SPACES
  6944         IF PI-UPDATE-FILES
  6945            OR (PI-PREVIEW AND APRODSWI = 'Y')
  6946               MOVE 'TS'           TO BILLING-DETAIL-TYPE
  6947               PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  6948
  6949     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
  6950
  6951     GO TO 8100-SEND-INITIAL-MAP.
  6952
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 137
* EL640.cbl
  6954 1300-CHECK-OVERRIDE-PREM.
  6955     IF PB-CANCELLATION
  6956        IF PB-CI-CANCEL-FEE NOT NUMERIC
  6957           MOVE ZEROS  TO  PB-CI-CANCEL-FEE
  6958        END-IF
  6959     END-IF
  6960
  6961     MOVE ZEROS                  TO WS-I-LF-PREMIUM-AMT
  6962                                    WS-I-LF-BENEFIT-AMT
  6963     IF PB-OVERRIDE-LIFE  OR
  6964        PB-OVERRIDE-BOTH
  6965         GO TO 1310-LIFE-OVERRIDE.
  6966
  6967     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  6968         IF PB-ISSUE
  6969           IF NOT PB-INVALID-LIFE
  6970            COMPUTE  WS-I-LF-PREMIUM-AMT =
  6971                    (PB-I-LF-PREMIUM-AMT +
  6972                     PB-I-LF-ALT-PREMIUM-AMT) * -1
  6973            COMPUTE  WS-I-LF-BENEFIT-AMT =
  6974                    (PB-I-LF-BENEFIT-AMT +
  6975                     PB-I-LF-ALT-BENEFIT-AMT) * -1
  6976           END-IF
  6977         ELSE
  6978             MULTIPLY PB-C-LF-CANCEL-AMT BY -1
  6979                            GIVING WS-C-LF-CANCEL-AMT
  6980             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  6981                            GIVING WS-CI-LIFE-BENEFIT
  6982         END-IF
  6983     ELSE
  6984         IF PB-ISSUE
  6985           IF NOT PB-INVALID-LIFE
  6986            ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
  6987                GIVING WS-I-LF-PREMIUM-AMT
  6988            COMPUTE  WS-I-LF-BENEFIT-AMT =
  6989                     PB-I-LF-BENEFIT-AMT +
  6990                     PB-I-LF-ALT-BENEFIT-AMT
  6991           END-IF
  6992         ELSE
  6993            MOVE PB-C-LF-CANCEL-AMT   TO WS-C-LF-CANCEL-AMT
  6994            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  6995         END-IF
  6996     END-IF
  6997
  6998     GO TO 1320-CHECK-AH
  6999
  7000     .
  7001 1310-LIFE-OVERRIDE.
  7002     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7003         IF PB-ISSUE
  7004           IF NOT PB-INVALID-LIFE
  7005            COMPUTE WS-I-LF-PREMIUM-AMT =
  7006                   (PB-I-LF-PREM-CALC +
  7007                      PB-I-LF-ALT-PREM-CALC) * -1
  7008            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7009                     (PB-I-LF-BENEFIT-AMT +
  7010                      PB-I-LF-ALT-BENEFIT-AMT) * -1
  7011           END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 138
* EL640.cbl
  7012         ELSE
  7013             MULTIPLY PB-C-LF-REF-CALC BY -1
  7014                            GIVING WS-C-LF-CANCEL-AMT
  7015             MULTIPLY PB-CI-LF-BENEFIT-AMT BY -1
  7016                            GIVING WS-CI-LIFE-BENEFIT
  7017         END-IF
  7018     ELSE
  7019         IF PB-ISSUE
  7020           IF NOT PB-INVALID-LIFE
  7021            ADD PB-I-LF-PREM-CALC   PB-I-LF-ALT-PREM-CALC
  7022                GIVING WS-I-LF-PREMIUM-AMT
  7023            COMPUTE  WS-I-LF-BENEFIT-AMT =
  7024                     PB-I-LF-BENEFIT-AMT +
  7025                     PB-I-LF-ALT-BENEFIT-AMT
  7026           END-IF
  7027         ELSE
  7028            MOVE PB-C-LF-REF-CALC     TO WS-C-LF-CANCEL-AMT
  7029            MOVE PB-CI-LF-BENEFIT-AMT TO WS-CI-LIFE-BENEFIT
  7030         END-IF
  7031     END-IF
  7032     .
  7033 1320-CHECK-AH.
  7034     IF PB-OVERRIDE-AH  OR
  7035        PB-OVERRIDE-BOTH
  7036         GO TO 1330-AH-OVERRIDE.
  7037
  7038     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7039         IF PB-ISSUE
  7040            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7041                            GIVING WS-I-AH-BENEFIT-AMT
  7042            MULTIPLY PB-I-AH-PREMIUM-AMT BY -1
  7043                            GIVING WS-I-AH-PREMIUM-AMT
  7044         ELSE
  7045             MULTIPLY PB-C-AH-CANCEL-AMT BY -1
  7046                            GIVING WS-C-AH-CANCEL-AMT
  7047     ELSE
  7048         IF PB-ISSUE
  7049            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7050            MOVE PB-I-AH-PREMIUM-AMT TO WS-I-AH-PREMIUM-AMT
  7051         ELSE
  7052            MOVE PB-C-AH-CANCEL-AMT TO WS-C-AH-CANCEL-AMT
  7053            IF  PB-CI-CANCEL-FEE > ZEROS
  7054                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7055                MULTIPLY WS-C-CANCEL-FEE BY -1
  7056                                          GIVING WORK-CANCEL-FEE
  7057                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7058
  7059     GO TO 1399-EXIT.
  7060
  7061 1330-AH-OVERRIDE.
  7062     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7063         IF PB-ISSUE
  7064            MULTIPLY PB-I-AH-BENEFIT-AMT BY -1
  7065                            GIVING WS-I-AH-BENEFIT-AMT
  7066            MULTIPLY PB-I-AH-PREM-CALC BY -1
  7067                            GIVING WS-I-AH-PREMIUM-AMT
  7068         ELSE
  7069             MULTIPLY PB-C-AH-REF-CALC BY -1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 139
* EL640.cbl
  7070                            GIVING WS-C-AH-CANCEL-AMT
  7071     ELSE
  7072         IF PB-ISSUE
  7073            MOVE PB-I-AH-BENEFIT-AMT TO WS-I-AH-BENEFIT-AMT
  7074            MOVE PB-I-AH-PREM-CALC   TO WS-I-AH-PREMIUM-AMT
  7075         ELSE
  7076            MOVE PB-C-AH-REF-CALC    TO WS-C-AH-CANCEL-AMT
  7077            IF PB-CI-CANCEL-FEE > ZEROS
  7078                MOVE PB-CI-CANCEL-FEE     TO WS-C-CANCEL-FEE
  7079                MULTIPLY WS-C-CANCEL-FEE BY -1
  7080                                          GIVING WORK-CANCEL-FEE
  7081                ADD WORK-CANCEL-FEE       TO TOT-REPT-CANCEL-FEE.
  7082
  7083 1399-EXIT.
  7084     EXIT.
  7085
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 140
* EL640.cbl
  7087 2000-VOID-BILLING.
  7088
  7089*                *******************************************
  7090*                *  PROCESS VOID BILLING.  THIS SECTION    *
  7091*                *  WILL RESET THE FILES TO THE STATUS     *
  7092*                *  THEY WERE IN PRIOR TO THE LAST BILLING *
  7093*                *******************************************
  7094
  7095     MOVE SPACES                 TO WS-EXP-DATE
  7096                                    WS-REMIT-TO.
  7097     SET DTNDX  RTNDX            TO 1.
  7098     MOVE SPACES                 TO ELCNTL-KEY.
  7099     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7100
  7101     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  7102
  7103     IF EMI-ERROR NOT = ZEROS
  7104         GO TO 8200-SEND-DATAONLY.
  7105
  7106     MOVE CF-CURRENT-MONTH-END   TO DC-BIN-DATE-1.
  7107     MOVE SPACE                  TO DC-OPTION-CODE.
  7108     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7109     MOVE DC-GREG-DATE-1-EDIT    TO PI-MONTH-END-DATE.
  7110
  7111     PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT.
  7112
  7113     IF PNDB-EOF
  7114         GO TO 2100-VOID-PNDB-COMPLETE.
  7115
  7116 2010-VOID-PNDB-LOOP.
  7117     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  7118
  7119     IF PNDB-EOF
  7120         GO TO 2100-VOID-PNDB-COMPLETE.
  7121
  7122     IF PB-COMPANY-CD-A1 = PI-COMPANY-CD  AND
  7123        PB-CARRIER       = PI-SAV-CARR    AND
  7124        PB-GROUPING      = PI-SAV-GROUP   AND
  7125        PB-STATE         = PI-SAV-STATE   AND
  7126        PB-ACCOUNT       = PI-SAV-ACCT
  7127         NEXT SENTENCE
  7128     ELSE
  7129         GO TO 2100-VOID-PNDB-COMPLETE.
  7130
  7131     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7132         GO TO 2010-VOID-PNDB-LOOP.
  7133
  7134     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  7135         MOVE PB-CONTROL-PRIMARY TO ERPNDB-PRIME-KEY
  7136
  7137* EXEC CICS ENDBR
  7138*             DATASET (ERPNDB-ALT-FILE-ID)
  7139*        END-EXEC
  7140     MOVE 0
  7141       TO DFHEIV11
  7142*    MOVE '&2                    $   #00007036' TO DFHEIV0
  7143     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7144     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 141
* EL640.cbl
  7145     MOVE X'2020233030303037303336' TO DFHEIV0(25:11)
  7146     CALL 'kxdfhei1' USING DFHEIV0,
  7147           ERPNDB-ALT-FILE-ID,
  7148           DFHEIV11,
  7149           DFHEIV99
  7150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7151
  7152* EXEC CICS DELETE
  7153*            DATASET (ERPNDB-FILE-ID)
  7154*            RIDFLD  (ERPNDB-PRIME-KEY)
  7155*        END-EXEC
  7156*    MOVE '&(  R                 &   #00007039' TO DFHEIV0
  7157     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  7158     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7159     MOVE X'2020233030303037303339' TO DFHEIV0(25:11)
  7160     CALL 'kxdfhei1' USING DFHEIV0,
  7161           ERPNDB-FILE-ID,
  7162           ERPNDB-PRIME-KEY,
  7163           DFHEIV99,
  7164           DFHEIV99,
  7165           DFHEIV99
  7166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7167         PERFORM 4000-PNDB-START-BROWSE THRU 4090-EXIT
  7168         IF PNDB-EOF
  7169            GO TO 2100-VOID-PNDB-COMPLETE
  7170         ELSE
  7171            GO TO 2010-VOID-PNDB-LOOP.
  7172
  7173     IF PB-BILLED-DT = LOW-VALUES  AND
  7174        PB-CHG-COUNT = ZEROS
  7175         GO TO 2010-VOID-PNDB-LOOP.
  7176
  7177     IF PB-BATCH-TRAILER
  7178         GO TO 2115-CONT.
  7179
  7180     IF PB-CERT-EFF-DT > ERACCT-A-EXP-DATE
  7181         MOVE PB-CERT-EFF-DT     TO PI-SAV-EXP-DT
  7182         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7183         IF AM-AGT (AM-REMIT-TO) NOT = WORK-REMIT-TO
  7184             MOVE AM-AGT (AM-REMIT-TO) TO WORK-REMIT-TO
  7185                                          WS-SAV-REMIT-TO (RTNDX)
  7186             IF RTNDX < 10
  7187                 SET RTNDX UP BY 1.
  7188
  7189 2115-CONT.
  7190     IF NOT PB-BATCH-TRAILER
  7191         PERFORM 1040-UPDATE-BILLING-STATISTICS THRU 1049-EXIT
  7192         PERFORM 1300-CHECK-OVERRIDE-PREM       THRU 1399-EXIT
  7193         PERFORM 1030-COMPUTE-COMMISSION-TOTALS THRU 1039-EXIT.
  7194
  7195     PERFORM 4200-PNDB-REWRITE THRU 4290-EXIT.
  7196
  7197     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7198     GO TO 2010-VOID-PNDB-LOOP.
  7199
  7200 2100-VOID-PNDB-COMPLETE.
  7201     SET RTNDX                   TO 1.
  7202
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 142
* EL640.cbl
  7203     IF NOT DATA-VOIDED
  7204         SET DTNDX TO RTNDX
  7205         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  7206         MOVE AM-AGT (AM-REMIT-TO) TO WS-SAV-REMIT-TO (RTNDX).
  7207
  7208 2105-PYAJ-LOOP.
  7209     IF RTNDX > 10
  7210       OR WS-SAV-REMIT-TO (RTNDX) = SPACES
  7211         GO TO 2105-VOID-CONTINUE.
  7212
  7213     MOVE WS-SAV-REMIT-TO (RTNDX) TO PI-SAV-REMIT-TO.
  7214     PERFORM 2200-VOID-PYAJ THRU 2290-EXIT.
  7215
  7216     SET RTNDX UP BY 1.
  7217     GO TO 2105-PYAJ-LOOP.
  7218
  7219 2105-VOID-CONTINUE.
  7220     IF DATA-VOIDED
  7221         NEXT SENTENCE
  7222     ELSE
  7223         MOVE -1                 TO APFNTERL
  7224         MOVE ER-2401            TO EMI-ERROR
  7225         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7226         GO TO 8100-SEND-INITIAL-MAP.
  7227
  7228     SET DTNDX                   TO 1.
  7229
  7230 2105-VOID-MASTERS-LOOP.
  7231     IF WS-SAV-EXP-DT (DTNDX) = SPACES
  7232       OR DTNDX > 10
  7233         GO TO 2105-VOID-COMPLETE.
  7234
  7235     MOVE WS-SAV-EXP-DT (DTNDX) TO PI-SAV-EXP-DT.
  7236
  7237     PERFORM 4400-ERACCT-REWRITE THRU 4490-EXIT.
  7238
  7239     IF PI-SAV-REMIT-TO NOT = ERCOMP-FIN-RESP
  7240         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  7241         PERFORM 3930-BILL-READ        THRU 3930-EXIT
  7242         IF NOT NO-BILL-RECS
  7243             PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT.
  7244
  7245     SET DTNDX UP BY 1.
  7246
  7247     GO TO 2105-VOID-MASTERS-LOOP.
  7248
  7249 2105-VOID-COMPLETE.
  7250     MOVE 0000                   TO EMI-ERROR.
  7251     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7252     SET PINDX ANDX TO 1.
  7253
  7254 2110-FORMAT-LOOP.
  7255     IF PI-BATCH (PINDX) NOT = SPACES
  7256         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  7257         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  7258         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  7259         SET ANDX PINDX UP BY 1
  7260         IF PINDX > 6
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 143
* EL640.cbl
  7261             NEXT SENTENCE
  7262         ELSE
  7263             GO TO 2110-FORMAT-LOOP.
  7264
  7265     MOVE -1                     TO AACCTL.
  7266
  7267     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 144
* EL640.cbl
  7269 2200-VOID-PYAJ.
  7270     PERFORM 4500-PYAJ-START-BROWSE THRU 4590-EXIT.
  7271
  7272     IF PYAJ-EOF
  7273         GO TO 2290-EXIT.
  7274
  7275 2210-VOID-PYAJ-LOOP.
  7276     PERFORM 4600-PYAJ-READ-NEXT THRU 4690-EXIT.
  7277
  7278     IF PYAJ-EOF
  7279         PERFORM 4800-PYAJ-END-BROWSE
  7280         GO TO 2290-EXIT.
  7281
  7282     IF PY-COMPANY-CD = PI-COMPANY-CD      AND
  7283        PY-CARRIER    = ERPYAJ-BR-CARRIER  AND
  7284        PY-GROUPING   = ERPYAJ-BR-GROUPING AND
  7285        PY-FIN-RESP   = PI-SAV-REMIT-TO    AND
  7286        PY-ACCOUNT    = PI-SAV-ACCT
  7287         NEXT SENTENCE
  7288     ELSE
  7289         PERFORM 4800-PYAJ-END-BROWSE
  7290         GO TO 2290-EXIT.
  7291
  7292     IF (PY-BILLED-DATE = LOW-VALUES AND
  7293            PY-AR-DATE = LOW-VALUES)
  7294       OR PY-CREDIT-ACCEPT-DT NOT = LOW-VALUES
  7295         GO TO 2210-VOID-PYAJ-LOOP.
  7296
  7297     PERFORM 4800-PYAJ-END-BROWSE.
  7298
  7299     PERFORM 4700-PYAJ-REWRITE THRU 4790-EXIT.
  7300
  7301     MOVE 'Y'                    TO DATA-VOIDED-SW.
  7302     ADD +1 TO ERPYAJ-FILE-SEQ-NO.
  7303
  7304     GO TO 2200-VOID-PYAJ.
  7305
  7306 2290-EXIT.
  7307     EXIT.
  7308
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 145
* EL640.cbl
  7310
  7311 3000-WRITE-BILLING-DETAIL.
  7312
  7313*                *******************************************
  7314*                *  FORMATS THE BILLING DETAIL RECORDS.    *
  7315*                *  THESE RECORDS ARE CREATED IN THE       *
  7316*                *  SAME FORMAT THAT THEY WILL APPEAR      *
  7317*                *  WHEN PRINTED.                          *
  7318*                *******************************************
  7319
  7320     IF CARRIER-ADDRESS  OR
  7321        GEN-AGT-ADDRESS
  7322          PERFORM 3930-BILL-READ THRU 3930-EXIT
  7323         IF NO-BILL-RECS
  7324             GO TO 3200-FORMAT-HDR-ADDR-RECS
  7325         ELSE
  7326             IF BI-PREVIEW-ONLY
  7327               OR BI-INITIAL-PRINT-DATE NOT = LOW-VALUES
  7328               OR PI-TOT-REBILL
  7329                 PERFORM 3940-BILL-GENERIC-DELETE THRU 3940-EXIT
  7330                 GO TO 3200-FORMAT-HDR-ADDR-RECS
  7331             ELSE
  7332                 MOVE ER-2403    TO EMI-ERROR
  7333                 MOVE -1         TO ABILTYPL
  7334                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7335                 GO TO 3990-EXIT.
  7336
  7337     IF TOTAL-STATEMENT
  7338         GO TO 3400-FORMAT-TOTAL-LINES.
  7339
  7340 3100-FORMAT-DETAIL-LINES.
  7341     IF PI-PREM (PINDX) NOT NUMERIC
  7342        MOVE ZEROS               TO PI-PREM (PINDX).
  7343     IF PI-COMM (PINDX) NOT NUMERIC
  7344        MOVE ZEROS               TO PI-COMM (PINDX).
  7345
  7346     IF WS-LINECTR > 23
  7347         MOVE ZEROS              TO WS-LINECTR
  7348         MOVE '3'                TO BI-RECORD-TYPE
  7349         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7350         MOVE '          CONTINUED ON NEXT PAGE'
  7351                                 TO BI-TEXT-LINE
  7352         PERFORM 3920-BILL-WRITE
  7353         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7354
  7355     IF WS-LINECTR = ZEROS
  7356         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7357     ELSE
  7358         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL
  7359     END-IF.
  7360
  7361     MOVE '3'                    TO BI-RECORD-TYPE.
  7362
  7363     IF BILLING-DETAIL-TYPE = 'BP'
  7364        IF PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT
  7365             MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7366             MULTIPLY PY-ENTRY-AMT   BY -1
  7367                              GIVING BI-TOT-PREM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 146
* EL640.cbl
  7368             MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7369             ADD +1 TO WS-LINECTR
  7370             PERFORM 3920-BILL-WRITE
  7371             GO TO 3990-EXIT.
  7372
  7373     IF BILLING-DETAIL-TYPE = 'BP'
  7374         MOVE PY-ENTRY-COMMENT   TO BI-TEXT-LINE
  7375         MOVE PY-ENTRY-AMT       TO BI-TOT-PREM
  7376         MOVE '* ACCOUNTING ENTRY *'  TO BI-TOT-DESC
  7377         ADD +1 TO WS-LINECTR
  7378         PERFORM 3920-BILL-WRITE
  7379         GO TO 3990-EXIT.
  7380
  7381     MOVE SPACES                 TO BI-TEXT-LINE.
  7382
  7383     IF PB-ISSUE
  7384        NEXT SENTENCE
  7385     ELSE
  7386        GO TO 3110-FORMAT-DETAIL-CANCEL.
  7387
  7388     MOVE PB-I-INSURED-FIRST-NAME    TO BI-INS-1ST-NAME.
  7389     MOVE PB-I-INSURED-MIDDLE-INIT   TO BI-INS-INIT.
  7390
  7391     IF PI-COMPANY-ID = 'DMD' AND
  7392        PB-ISSUE
  7393        MOVE PB-SV-STATE             TO BI-UNDRWRTR.
  7394
  7395     MOVE PB-I-INSURED-LAST-NAME     TO BI-INS-LAST-NAME.
  7396     MOVE PB-CERT-NO                 TO BI-CERT.
  7397     MOVE PB-I-LF-TERM               TO BI-ED-TERM  BI-TERM.
  7398     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7399     MOVE SPACE                      TO DC-OPTION-CODE.
  7400     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7401     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7402
  7403     IF PI-COMPANY-ID = 'DMD' AND
  7404        PB-ISSUE  AND
  7405        NOT PB-INVALID-LIFE
  7406          MOVE PB-I-LF-BENEFIT-CD    TO WS-BENE-CD
  7407          MOVE WS-BENEFIT            TO PB-I-LF-ABBR.
  7408
  7409     IF NOT PB-INVALID-LIFE
  7410        MOVE PB-I-LF-ABBR            TO BI-TYPE
  7411        MOVE WS-I-LF-PREMIUM-AMT     TO BI-PREM
  7412                                        BI-PREMIUM-AMT
  7413        ADD WS-I-LF-PREMIUM-AMT      TO TOT-REPT-LF-PREM
  7414        MULTIPLY PB-I-LIFE-COMMISSION BY 100 GIVING BI-ED-RATE
  7415        MOVE PB-I-LIFE-COMMISSION    TO BI-RATE
  7416        MOVE PI-LF-ISS-COMP          TO BI-COMM
  7417        ADD  PI-LF-ISS-COMP          TO TOT-REPT-LF-COMP
  7418        MOVE WS-I-LF-BENEFIT-AMT     TO BI-FACE-AMT
  7419                                        BI-BENEFIT-AMT
  7420        ADD WS-I-LF-BENEFIT-AMT      TO TOT-LF-REPT-FACE-AMT
  7421        ADD WS-I-LF-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7422        ADD PI-LF-ISS-COMP           TO  PI-COMM (PINDX)
  7423        PERFORM 3920-BILL-WRITE
  7424        ADD +1 TO WS-LINECTR
  7425        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 147
* EL640.cbl
  7426        MOVE SPACES                  TO BI-TEXT-LINE.
  7427
  7428     IF PI-COMPANY-ID = 'DMD' AND
  7429        PB-ISSUE  AND
  7430        NOT PB-INVALID-AH
  7431          MOVE PB-I-AH-BENEFIT-CD    TO WS-BENE-CD
  7432          MOVE WS-BENEFIT            TO PB-I-AH-ABBR.
  7433
  7434     IF NOT PB-INVALID-AH
  7435        MOVE PB-I-AH-ABBR            TO BI-TYPE
  7436        MOVE WS-I-AH-PREMIUM-AMT     TO BI-PREM
  7437                                        BI-PREMIUM-AMT
  7438        ADD WS-I-AH-PREMIUM-AMT      TO TOT-REPT-AH-PREM
  7439        MULTIPLY PB-I-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7440        MOVE PB-I-AH-COMMISSION      TO BI-RATE
  7441        MOVE PI-AH-ISS-COMP          TO BI-COMM
  7442        ADD PI-AH-ISS-COMP           TO TOT-REPT-AH-COMP
  7443        MOVE WS-I-AH-BENEFIT-AMT     TO BI-FACE-AMT
  7444        ADD WS-I-AH-BENEFIT-AMT      TO TOT-AH-REPT-FACE-AMT
  7445        ADD WS-I-AH-PREMIUM-AMT      TO  PI-PREM (PINDX)
  7446        ADD PI-AH-ISS-COMP           TO  PI-COMM (PINDX)
  7447        PERFORM 3920-BILL-WRITE
  7448        MOVE SINGLE-SPACE            TO BI-SKIP-CONTROL
  7449        ADD +1                       TO WS-LINECTR.
  7450
  7451     GO TO 3990-EXIT.
  7452
  7453 3110-FORMAT-DETAIL-CANCEL.
  7454     MOVE PB-CI-LAST-NAME            TO BI-INS-LAST-NAME.
  7455     MOVE PB-CI-INITIALS             TO BI-INS-INITS.
  7456
  7457     IF PI-COMPANY-ID = 'DMD' AND
  7458        PB-CANCELLATION
  7459        MOVE PB-SV-STATE             TO BI-UNDRWRTR.
  7460
  7461     MOVE PB-CERT-NO                 TO BI-CERT.
  7462     MOVE PB-CI-LF-TERM              TO BI-ED-TERM
  7463                                        BI-TERM.
  7464     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
  7465     MOVE SPACE                      TO DC-OPTION-CODE.
  7466     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7467     MOVE DC-GREG-DATE-1-EDIT        TO BI-EFF-DT.
  7468
  7469     IF PI-COMPANY-ID = 'DMD' AND
  7470        PB-CANCELLATION AND
  7471        PB-CI-LF-ABBR > SPACES
  7472          MOVE PB-CI-LF-BENEFIT-CD   TO WS-BENE-CD
  7473          MOVE WS-BENEFIT            TO PB-CI-LF-ABBR.
  7474
  7475     IF PB-CI-LF-ABBR > SPACES
  7476         MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
  7477         MOVE SPACE                  TO DC-OPTION-CODE
  7478         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7479         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7480         MOVE PB-CI-LF-ABBR          TO BI-TYPE
  7481         MOVE WS-C-LF-CANCEL-AMT     TO BI-PREMIUM-AMT
  7482         MULTIPLY WS-C-LF-CANCEL-AMT BY -1 GIVING WORK-AMT
  7483         MOVE WORK-AMT               TO BI-PREM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 148
* EL640.cbl
  7484         ADD WS-C-LF-CANCEL-AMT      TO TOT-REPT-LF-REF
  7485         ADD WORK-AMT                TO TOT-REPT-LF-PREM
  7486                                        PI-PREM (PINDX)
  7487         MULTIPLY PB-CI-LIFE-COMMISSION
  7488                                     BY 100 GIVING BI-ED-RATE
  7489         MOVE PB-CI-LIFE-COMMISSION  TO BI-RATE
  7490         IF WS-CHARGEBACK-LF-SW = 'N'
  7491             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7492             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7493             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7494                                            PI-COMM (PINDX)
  7495             COMPUTE TOT-REPT-LF-COMP-R =
  7496               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7497             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7498             ADD +1                      TO WS-LINECTR
  7499             PERFORM 3920-BILL-WRITE
  7500             MOVE SPACES                 TO BI-TEXT-LINE
  7501         ELSE
  7502             MOVE PI-LF-CAN-COMP         TO BI-COMM
  7503             ADD PI-LF-CAN-COMP          TO TOT-REPT-LF-COMP
  7504                                            PI-COMM (PINDX)
  7505             COMPUTE TOT-REPT-LF-COMP-R =
  7506               TOT-REPT-LF-COMP-R + (PI-LF-CAN-COMP * -1)
  7507             MOVE  ZEROS                 TO PI-LF-CAN-COMP
  7508             MOVE WS-CI-LIFE-BENEFIT     TO BI-BENEFIT-AMT
  7509             ADD +1                      TO WS-LINECTR
  7510             PERFORM 3920-BILL-WRITE
  7511             MOVE SPACES                 TO BI-TEXT-LINE.
  7512
  7513     IF PI-COMPANY-ID = 'DMD' AND
  7514        PB-CANCELLATION AND
  7515        PB-CI-AH-ABBR > SPACES
  7516          MOVE PB-CI-AH-BENEFIT-CD   TO WS-BENE-CD
  7517          MOVE WS-BENEFIT            TO PB-CI-AH-ABBR.
  7518
  7519     IF PB-CI-AH-ABBR > SPACES
  7520         MOVE PB-C-AH-CANCEL-DT      TO DC-BIN-DATE-1
  7521         MOVE SPACE                  TO DC-OPTION-CODE
  7522         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7523         MOVE DC-GREG-DATE-1-EDIT    TO BI-CAN-DT
  7524         MOVE PB-CI-AH-ABBR          TO BI-TYPE
  7525         MOVE WS-C-AH-CANCEL-AMT     TO BI-PREMIUM-AMT
  7526         MULTIPLY WS-C-AH-CANCEL-AMT BY -1 GIVING WORK-AMT
  7527         MOVE WORK-AMT               TO BI-PREM
  7528         ADD WS-C-AH-CANCEL-AMT      TO TOT-REPT-AH-REF
  7529         ADD WORK-AMT                TO TOT-REPT-AH-PREM
  7530                                        PI-PREM (PINDX)
  7531         MULTIPLY PB-CI-AH-COMMISSION BY 100 GIVING BI-ED-RATE
  7532         MOVE PB-CI-AH-COMMISSION    TO BI-RATE
  7533         IF WS-CHARGEBACK-AH-SW = 'N'
  7534             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7535             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7536             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7537                                            PI-COMM (PINDX)
  7538             COMPUTE TOT-REPT-AH-COMP-R =
  7539               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7540             ADD +1                      TO WS-LINECTR
  7541             PERFORM 3920-BILL-WRITE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 149
* EL640.cbl
  7542         ELSE
  7543             MOVE PI-AH-CAN-COMP         TO BI-COMM
  7544             ADD PI-AH-CAN-COMP          TO TOT-REPT-AH-COMP
  7545                                            PI-COMM (PINDX)
  7546             COMPUTE TOT-REPT-AH-COMP-R =
  7547               TOT-REPT-AH-COMP-R + (PI-AH-CAN-COMP * -1)
  7548             MOVE  ZEROS                 TO PI-AH-CAN-COMP
  7549             ADD +1                      TO WS-LINECTR
  7550             PERFORM 3920-BILL-WRITE.
  7551
  7552     IF PB-CI-CANCEL-FEE NOT NUMERIC
  7553         MOVE ZEROS                      TO PB-CI-CANCEL-FEE.
  7554
  7555     IF PB-CI-CANCEL-FEE > ZEROS
  7556         MOVE SPACES                 TO BI-INS-LAST-NAME
  7557                                        BI-INS-INITS
  7558                                        BI-EFF-DT
  7559                                        BI-CAN-DT
  7560                                        BI-TYPE
  7561         MOVE 'CANCEL FEE'           TO BI-CERT
  7562         MOVE WORK-CANCEL-FEE        TO BI-PREM
  7563                                        BI-COMM
  7564         MOVE ZEROS                  TO BI-PREMIUM-AMT
  7565                                        BI-RATE
  7566                                        BI-ED-RATE
  7567                                        BI-ED-TERM
  7568                                        BI-TERM
  7569         ADD +1                      TO WS-LINECTR
  7570         PERFORM 3920-BILL-WRITE.
  7571
  7572     GO TO 3990-EXIT.
  7573
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 150
* EL640.cbl
  7575
  7576 3200-FORMAT-HDR-ADDR-RECS.
  7577     PERFORM 3910-BILL-GETMAIN.
  7578
  7579     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7580     SET A-INDX  R-INDX          TO 1.
  7581     PERFORM 3210-FORMAT-ADDR-RECS  THRU 3210-EXIT 6 TIMES.
  7582     MOVE ZEROS                  TO WS-LINE-SEQ-NO.
  7583     PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7584     GO TO 3990-EXIT.
  7585
  7586 3210-FORMAT-ADDR-RECS.
  7587     MOVE '2'                     TO BI-RECORD-TYPE.
  7588     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDRESS-LINE.
  7589     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDRESS-LINE.
  7590     PERFORM 3920-BILL-WRITE.
  7591     SET A-INDX  R-INDX         UP BY 1.
  7592
  7593 3210-EXIT.
  7594     EXIT.
  7595
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 151
* EL640.cbl
  7597 3300-FORMAT-HEADINGS.
  7598     MOVE WS-PGECTR              TO BI-HD-PG.
  7599     ADD +1                      TO WS-PGECTR.
  7600     MOVE '3'                    TO BI-RECORD-TYPE.
  7601     MOVE TOP-OF-PAGE            TO BI-SKIP-CONTROL.
  7602
  7603     IF NOT PI-PREVIEW
  7604         MOVE BI-HD1             TO BI-TEXT-LINE
  7605     ELSE
  7606         MOVE BI-PREVIEW-HD      TO BI-TEXT-LINE
  7607         PERFORM 3920-BILL-WRITE
  7608         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7609         MOVE BI-HD1             TO BI-TEXT-LINE.
  7610
  7611     PERFORM 3920-BILL-WRITE.
  7612     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7613     MOVE BI-HD2                 TO BI-TEXT-LINE.
  7614     PERFORM 3920-BILL-WRITE.
  7615     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7616     MOVE BI-HD3                 TO BI-TEXT-LINE.
  7617     PERFORM 3920-BILL-WRITE.
  7618     SET A-INDX  R-INDX          TO 1.
  7619     PERFORM 3390-FORMAT-ADDR-TEXT-LINES THRU 3390-EXIT 5 TIMES.
  7620     MOVE '3'                    TO BI-RECORD-TYPE.
  7621     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7622     MOVE BI-HD4                 TO BI-TEXT-LINE.
  7623     PERFORM 3920-BILL-WRITE.
  7624     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7625     MOVE BI-HD5                 TO BI-TEXT-LINE.
  7626     PERFORM 3920-BILL-WRITE.
  7627
  7628 3380-EXIT.
  7629     EXIT.
  7630
  7631 3390-FORMAT-ADDR-TEXT-LINES.
  7632     MOVE '3'                    TO BI-RECORD-TYPE.
  7633     MOVE SPACES                 TO BI-TEXT-LINE.
  7634
  7635     IF A-INDX = 1
  7636         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7637         MOVE 'ACCOUNT NO. - '   TO BI-ADDR-LIT
  7638         MOVE WS-CARR-COMP       TO BI-CO
  7639         MOVE '-'                TO BI-DASH
  7640         MOVE PI-SAV-ACCT        TO BI-ACCT
  7641         MOVE 'REMIT TO - '      TO BI-REMIT-LIT
  7642     ELSE
  7643         MOVE SINGLE-SPACE       TO BI-SKIP-CONTROL.
  7644
  7645     MOVE WS-ACCT-LINES (A-INDX)  TO BI-ACCT-ADDR.
  7646     MOVE WS-REMIT-LINES (R-INDX) TO BI-REMIT-ADDR.
  7647     PERFORM 3920-BILL-WRITE.
  7648     SET A-INDX  R-INDX  UP BY 1.
  7649
  7650 3390-EXIT.
  7651     EXIT.
  7652
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 152
* EL640.cbl
  7654 3400-FORMAT-TOTAL-LINES.
  7655     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  7656                          PI-PREMIUM +
  7657                          TOT-REPT-CANCEL-FEE -
  7658                          PI-REMITTED -
  7659                          PI-TOT-ISS-COMP +
  7660                          PI-TOT-CAN-COMP +
  7661                          PI-ADJUSTMENTS +
  7662                          PI-DISBURSED.
  7663
  7664     MOVE SPACES                 TO BI-TEXT-LINE.
  7665
  7666     MOVE '1'                    TO BI-RECORD-TYPE.
  7667     MOVE PI-PROCESSOR-ID        TO BI-PROCESSOR-CD.
  7668
  7669     IF PI-PREV-BILL OR PI-PREV-REBILL
  7670         MOVE 'P'                TO BI-STATEMENT-TYPE.
  7671
  7672     MOVE +1                     TO BI-NO-OF-COPIES.
  7673     MOVE WS-CURRENT-DATE        TO BI-CREATION-DT.
  7674     MOVE LOW-VALUES             TO BI-INITIAL-PRINT-DATE.
  7675     MOVE PI-BAL-FRWD            TO BI-BAL-FRWD.
  7676     MOVE PI-PREMIUM             TO BI-PREMIUM.
  7677     MOVE PI-REMITTED            TO BI-REMITTED.
  7678     MOVE PI-TOT-ISS-COMP        TO BI-TOT-ISS-COMP.
  7679     MOVE PI-TOT-CAN-COMP        TO BI-TOT-CAN-COMP.
  7680     MOVE PI-ADJUSTMENTS         TO BI-ADJUSTMNTS.
  7681     MOVE PI-DISBURSED           TO BI-DISBURSED.
  7682     MOVE PI-END-BAL             TO BI-END-BAL.
  7683
  7684     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
  7685         MOVE WS-ACCT-LINES (1)  TO BI-FIN-RESP-NAME
  7686     ELSE
  7687         MOVE WS-REMIT-LINES (1) TO BI-FIN-RESP-NAME.
  7688
  7689     PERFORM 3920-BILL-WRITE.
  7690
  7691     IF WS-LINECTR > 16
  7692         MOVE ZEROS              TO WS-LINECTR
  7693         MOVE '3'                TO BI-RECORD-TYPE
  7694         MOVE TRIPLE-SPACE       TO BI-SKIP-CONTROL
  7695         MOVE '          CONTINUED ON NEXT PAGE'
  7696                                 TO BI-TEXT-LINE
  7697         PERFORM 3920-BILL-WRITE
  7698         PERFORM 3300-FORMAT-HEADINGS THRU 3380-EXIT.
  7699
  7700     IF PI-BAL-FRWD NOT = ZERO
  7701         MOVE SPACES             TO BI-TEXT-LINE
  7702         MOVE '3'                TO BI-RECORD-TYPE
  7703         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7704         MOVE 'BALANCE FORWARD'  TO BI-TOT-DESC
  7705         MOVE PI-BAL-FRWD        TO BI-TOT-PREM
  7706         PERFORM 3920-BILL-WRITE.
  7707
  7708     IF PI-PREMIUM NOT = ZERO
  7709         MOVE SPACES             TO BI-TEXT-LINE
  7710         MOVE '3'                TO BI-RECORD-TYPE
  7711         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 153
* EL640.cbl
  7712         MOVE 'THIS MONTHS PREMIUM'  TO BI-TOT-DESC
  7713         COMPUTE WORK-AMT  =  TOT-REPT-CANCEL-FEE + PI-PREMIUM
  7714         MOVE WORK-AMT           TO BI-TOT-PREM
  7715         PERFORM 3920-BILL-WRITE.
  7716
  7717     IF PI-TOT-ISS-COMP NOT = ZEROS  OR
  7718        PI-TOT-CAN-COMP NOT = ZEROS
  7719         MOVE SPACES             TO BI-TEXT-LINE
  7720         MOVE '3'                TO BI-RECORD-TYPE
  7721         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7722         MOVE 'LESS COMPENSATION' TO BI-TOT-DESC
  7723         SUBTRACT PI-TOT-CAN-COMP FROM PI-TOT-ISS-COMP
  7724                          GIVING BI-TOT-PREM
  7725         PERFORM 3920-BILL-WRITE.
  7726
  7727     IF PI-REMITTED  NOT = ZEROS  OR
  7728        PI-DISBURSED NOT = ZEROS
  7729         MOVE SPACES             TO BI-TEXT-LINE
  7730         MOVE '3'                TO BI-RECORD-TYPE
  7731         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7732         MOVE 'LESS PAYMENTS'    TO BI-TOT-DESC
  7733         IF PI-COMPANY-ID = 'UCL'
  7734             SUBTRACT PI-DISBURSED FROM PI-REMITTED
  7735                      GIVING BI-TOT-PREM
  7736             PERFORM 3920-BILL-WRITE
  7737           ELSE
  7738             MOVE PI-REMITTED        TO BI-TOT-PREM
  7739             PERFORM 3920-BILL-WRITE.
  7740
  7741     IF PI-ADJUSTMENTS NOT = ZERO
  7742         MOVE SPACES             TO BI-TEXT-LINE
  7743         MOVE '3'                TO BI-RECORD-TYPE
  7744         MOVE DOUBLE-SPACE       TO BI-SKIP-CONTROL
  7745         MOVE 'ADJUSTMENT'       TO BI-TOT-DESC
  7746         ADD PI-ADJUSTMENTS, PI-DISBURSED GIVING BI-TOT-PREM
  7747         PERFORM 3920-BILL-WRITE.
  7748
  7749     MOVE SPACES                 TO BI-TEXT-LINE.
  7750     MOVE '3'                    TO BI-RECORD-TYPE.
  7751     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7752     MOVE ALL '-'                TO BI-TOT-DASH.
  7753     PERFORM 3920-BILL-WRITE.
  7754
  7755     MOVE SPACES                 TO BI-TEXT-LINE.
  7756     MOVE '3'                    TO BI-RECORD-TYPE.
  7757     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7758
  7759     IF PI-END-BAL < +1.00 AND > -1.00
  7760         NEXT SENTENCE
  7761     ELSE
  7762         IF PI-END-BAL < +0
  7763             MOVE 'WE WILL REFUND' TO BI-TOT-DESC
  7764         ELSE
  7765             MOVE 'PLEASE REMIT' TO BI-TOT-DESC.
  7766
  7767     MOVE PI-END-BAL             TO BI-TOT-PREM.
  7768
  7769     PERFORM 3920-BILL-WRITE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 154
* EL640.cbl
  7770
  7771     IF CO-CARRY-BALANCE
  7772         IF PI-END-BAL > +1.00
  7773             MOVE SPACES         TO BI-TEXT-LINE
  7774             MOVE '3'            TO BI-RECORD-TYPE
  7775             MOVE DOUBLE-SPACE   TO BI-SKIP-CONTROL
  7776             MOVE 'PLEASE RETURN ONE COPY WITH REMITTANCE'
  7777                                 TO BI-TEXT-LINE
  7778             PERFORM 3920-BILL-WRITE.
  7779
  7780     IF PI-COMPANY-ID = 'DMD'
  7781        MOVE SPACES                 TO BI-TEXT-LINE
  7782        MOVE '3'                    TO BI-RECORD-TYPE
  7783        MOVE '0'                    TO BI-SKIP-CONTROL
  7784        MOVE BI-HD6                 TO BI-TEXT-LINE
  7785        PERFORM 3920-BILL-WRITE
  7786        MOVE SPACES                 TO BI-TEXT-LINE
  7787        MOVE ' '                    TO BI-SKIP-CONTROL
  7788        MOVE BI-HD7                 TO BI-TEXT-LINE
  7789        PERFORM 3920-BILL-WRITE
  7790
  7791        PERFORM 3600-FIND-BATCH-NUMBER THRU 3699-EXIT
  7792          VARYING PINDX FROM 1 BY 1
  7793            UNTIL PINDX > +6.
  7794
  7795     MOVE ZEROS                  TO PI-PREM     (PINDX)
  7796                                    PI-COMM     (PINDX)
  7797                                    PI-NON-PREM (PINDX)
  7798                                    PI-NON-COMM (PINDX).
  7799
  7800     GO TO 3990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 155
* EL640.cbl
  7802
  7803 3500-TOTAL-OUT-DETAIL.
  7804     IF PI-DATA-BILLED AND
  7805        RETURNED-FROM = SPACES
  7806           NEXT SENTENCE
  7807       ELSE
  7808           GO TO 3599-EXIT.
  7809
  7810     IF PI-UPDATE-FILES  OR
  7811        (PI-PREVIEW AND APRODSWI = 'Y')
  7812           NEXT SENTENCE
  7813        ELSE
  7814           GO TO 3599-EXIT.
  7815
  7816     MOVE SPACES                 TO BI-TEXT-LINE.
  7817*    MOVE '3'                    TO BI-RECORD-TYPE.
  7818*    MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7819*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  7820*    MOVE PI-LIFE-OVERRIDE-L6    TO BI-OVERRIDE-L6.
  7821*    MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM.
  7822*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  7823*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7824*    PERFORM 3920-BILL-WRITE.
  7825*
  7826*    MOVE SPACES                 TO BI-TEXT-LINE.
  7827*    MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7828*    MOVE 'TOTAL'                TO BI-TOT-LIT.
  7829*    MOVE PI-AH-OVERRIDE-L6      TO BI-OVERRIDE-L6.
  7830*    MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  7831*    MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  7832*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7833*    PERFORM 3920-BILL-WRITE.
  7834
  7835     MOVE SPACES                 TO BI-TEXT-LINE.
  7836     MOVE '3'                    TO BI-RECORD-TYPE.
  7837     MOVE DOUBLE-SPACE           TO BI-SKIP-CONTROL.
  7838     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  7839     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7840     ADD TOT-REPT-LF-REF TOT-REPT-LF-PREM
  7841          GIVING BI-TOT-PREM
  7842     ADD TOT-REPT-LF-COMP TOT-REPT-LF-COMP-R
  7843          GIVING BI-COM-TOT
  7844*    MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT.
  7845*    MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7846     PERFORM 3920-BILL-WRITE.
  7847
  7848     MOVE SPACES                 TO BI-TEXT-LINE.
  7849     MOVE '3'                    TO BI-RECORD-TYPE.
  7850     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7851     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  7852     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7853     MOVE TOT-REPT-LF-REF        TO BI-TOT-PREM.
  7854     MOVE TOT-REPT-LF-COMP-R     TO BI-COM-TOT
  7855     PERFORM 3920-BILL-WRITE.
  7856
  7857     MOVE SPACES                 TO BI-TEXT-LINE.
  7858     MOVE '3'                    TO BI-RECORD-TYPE.
  7859     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 156
* EL640.cbl
  7860     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  7861     MOVE PI-LIFE-OVERRIDE-L6    TO BI-TOT-DESC (12:6)
  7862     MOVE TOT-REPT-LF-PREM       TO BI-TOT-PREM
  7863     MOVE TOT-REPT-LF-COMP       TO BI-COM-TOT
  7864     MOVE TOT-LF-REPT-FACE-AMT   TO BI-FACE-TOT.
  7865     PERFORM 3920-BILL-WRITE.
  7866
  7867     MOVE SPACES                 TO BI-TEXT-LINE.
  7868     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7869     MOVE 'TOTAL PREM '          TO BI-TOT-DESC
  7870     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7871     ADD TOT-REPT-AH-REF TOT-REPT-AH-PREM
  7872          GIVING BI-TOT-PREM
  7873     ADD TOT-REPT-AH-COMP TOT-REPT-AH-COMP-R
  7874          GIVING BI-COM-TOT
  7875*    MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7876     PERFORM 3920-BILL-WRITE.
  7877
  7878     MOVE SPACES                 TO BI-TEXT-LINE.
  7879     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7880     MOVE 'TOTAL REF  '          TO BI-TOT-DESC
  7881     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7882     MOVE TOT-REPT-AH-REF        TO BI-TOT-PREM
  7883     MOVE TOT-REPT-AH-COMP-R     TO BI-COM-TOT.
  7884     PERFORM 3920-BILL-WRITE.
  7885
  7886     MOVE SPACES                 TO BI-TEXT-LINE.
  7887     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7888     MOVE 'TOTAL NET  '          TO BI-TOT-DESC
  7889     MOVE PI-AH-OVERRIDE-L6      TO BI-TOT-DESC (12:6)
  7890     MOVE TOT-REPT-AH-PREM       TO BI-TOT-PREM
  7891     MOVE TOT-REPT-AH-COMP       TO BI-COM-TOT.
  7892     MOVE TOT-AH-REPT-FACE-AMT   TO BI-FACE-TOT.
  7893     PERFORM 3920-BILL-WRITE.
  7894
  7895     IF PB-CI-CANCEL-FEE NOT NUMERIC
  7896         MOVE ZEROS  TO  PB-CI-CANCEL-FEE.
  7897
  7898     IF PB-CI-CANCEL-FEE > ZEROS
  7899         MOVE SPACES                 TO BI-TEXT-LINE
  7900         MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL
  7901         MOVE 'TOTAL'                TO BI-TOT-LIT
  7902         MOVE 'CAN-FE'               TO BI-OVERRIDE-L6
  7903         MOVE TOT-REPT-CANCEL-FEE    TO BI-TOT-PREM
  7904                                        BI-COM-TOT
  7905         MOVE ZEROS                  TO BI-FACE-TOT
  7906         PERFORM 3920-BILL-WRITE.
  7907
  7908     MOVE SPACES                 TO BI-TEXT-LINE.
  7909     MOVE SINGLE-SPACE           TO BI-SKIP-CONTROL.
  7910     PERFORM 3920-BILL-WRITE.
  7911
  7912 3599-EXIT.
  7913     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 157
* EL640.cbl
  7915
  7916 3600-FIND-BATCH-NUMBER.
  7917     IF PI-PREM (PINDX) NOT NUMERIC
  7918        MOVE ZEROS               TO PI-PREM (PINDX).
  7919     IF PI-COMM (PINDX) NOT NUMERIC
  7920        MOVE ZEROS               TO PI-COMM (PINDX).
  7921     IF PI-NON-PREM (PINDX) NOT NUMERIC
  7922        MOVE ZEROS               TO PI-NON-PREM (PINDX).
  7923     IF PI-NON-COMM (PINDX) NOT NUMERIC
  7924        MOVE ZEROS               TO PI-NON-COMM (PINDX).
  7925
  7926     IF PI-PREM (PINDX)     = ZEROS   AND
  7927        PI-COMM (PINDX)     = ZEROS   AND
  7928        PI-NON-PREM (PINDX) = ZEROS   AND
  7929        PI-NON-COMM (PINDX) = ZEROS
  7930          GO TO 3699-EXIT.
  7931
  7932     MOVE SPACES                 TO BI-TEXT-LINE.
  7933     MOVE '3'                    TO BI-RECORD-TYPE.
  7934     MOVE ' '                    TO BI-SKIP-CONTROL.
  7935     MOVE 'BATCH NO. '           TO WS-BATCH-DESC.
  7936     MOVE PI-BATCH (PINDX)       TO WS-BATCH-NBR.
  7937     MOVE WS-DESC                TO BI-TOT-DESC5.
  7938     MOVE PI-PREM (PINDX)        TO BI-TOT-PREM5.
  7939     MOVE PI-COMM (PINDX)        TO BI-COM-TOT5.
  7940     MOVE PI-NON-PREM (PINDX)    TO BI-NON-PREM5.
  7941     MOVE PI-NON-COMM (PINDX)    TO BI-NON-COMM5.
  7942     PERFORM 3920-BILL-WRITE.
  7943
  7944 3699-EXIT.
  7945     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 158
* EL640.cbl
  7947
  7948 3910-BILL-GETMAIN.
  7949
  7950* EXEC CICS GETMAIN
  7951*        SET     (ADDRESS OF BILLING-STATEMENT)
  7952*        LENGTH  (210)
  7953*        INITIMG (GETMAIN-SPACE)
  7954*    END-EXEC.
  7955     MOVE 210
  7956       TO DFHEIV11
  7957*    MOVE ',"IL                  $   #00007825' TO DFHEIV0
  7958     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7959     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7960     MOVE X'2020233030303037383235' TO DFHEIV0(25:11)
  7961     CALL 'kxdfhei1' USING DFHEIV0,
  7962           DFHEIV20,
  7963           DFHEIV11,
  7964           GETMAIN-SPACE
  7965     SET ADDRESS OF BILLING-STATEMENT TO
  7966         DFHEIV20
  7967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7968
  7969
  7970 3920-BILL-WRITE.
  7971     MOVE PI-COMPANY-CD          TO BI-COMPANY-CD.
  7972     MOVE PI-CR-CARRIER          TO BI-CARRIER.
  7973     MOVE PI-CR-GROUPING         TO BI-GROUPING
  7974     MOVE PI-SAV-ACCT            TO BI-ACCOUNT.
  7975     MOVE PI-SAV-REMIT-TO        TO BI-FIN-RESP.
  7976
  7977     MOVE 'BI'                   TO BI-RECORD-ID.
  7978     ADD +1                      TO WS-LINE-SEQ-NO.
  7979
  7980     IF BI-RECORD-TYPE = '1'
  7981         MOVE ZEROS              TO BI-LINE-SEQ-NO
  7982     ELSE
  7983         MOVE WS-LINE-SEQ-NO     TO BI-LINE-SEQ-NO.
  7984
  7985
  7986* EXEC CICS WRITE
  7987*        DATASET (ERBILL-FILE-ID)
  7988*        FROM    (BILLING-STATEMENT)
  7989*        RIDFLD  (BI-CONTROL-PRIMARY)
  7990*    END-EXEC.
  7991     MOVE LENGTH OF
  7992      BILLING-STATEMENT
  7993       TO DFHEIV11
  7994*    MOVE '&$ L                  ''   #00007846' TO DFHEIV0
  7995     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7996     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7997     MOVE X'2020233030303037383436' TO DFHEIV0(25:11)
  7998     CALL 'kxdfhei1' USING DFHEIV0,
  7999           ERBILL-FILE-ID,
  8000           BILLING-STATEMENT,
  8001           DFHEIV11,
  8002           BI-CONTROL-PRIMARY,
  8003           DFHEIV99,
  8004           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 159
* EL640.cbl
  8005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8006
  8007
  8008 3930-BILL-READ.
  8009     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8010     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8011     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8012     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8013     MOVE PI-SAV-REMIT-TO        TO ERBILL-FIN-RESP.
  8014     MOVE '1'                    TO ERBILL-REC-TYPE.
  8015     MOVE ZEROS                  TO ERBILL-LINE-SEQ-NO.
  8016
  8017
  8018* EXEC CICS HANDLE CONDITION
  8019*        NOTFND  (3930-BILL-NOTFND)
  8020*        NOTOPEN (3930-BILL-NOTOPEN)
  8021*    END-EXEC.
  8022*    MOVE '"$IJ                  ! $ #00007861' TO DFHEIV0
  8023     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8024     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8025     MOVE X'2420233030303037383631' TO DFHEIV0(25:11)
  8026     CALL 'kxdfhei1' USING DFHEIV0
  8027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8028
  8029
  8030
  8031* EXEC CICS READ
  8032*        SET     (ADDRESS OF BILLING-STATEMENT)
  8033*        DATASET (ERBILL-FILE-ID)
  8034*        RIDFLD  (ERBILL-KEY)
  8035*        GTEQ
  8036*    END-EXEC.
  8037*    MOVE '&"S        G          (   #00007866' TO DFHEIV0
  8038     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8039     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8040     MOVE X'2020233030303037383636' TO DFHEIV0(25:11)
  8041     CALL 'kxdfhei1' USING DFHEIV0,
  8042           ERBILL-FILE-ID,
  8043           DFHEIV20,
  8044           DFHEIV99,
  8045           ERBILL-KEY,
  8046           DFHEIV99,
  8047           DFHEIV99,
  8048           DFHEIV99
  8049     SET ADDRESS OF BILLING-STATEMENT TO
  8050         DFHEIV20
  8051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8052
  8053
  8054     IF BI-COMPANY-CD = PI-COMPANY-CD  AND
  8055        BI-CARRIER    = ERBILL-CARRIER AND
  8056        BI-GROUPING   = ERBILL-GROUP   AND
  8057        BI-ACCOUNT    = ERBILL-ACCT    AND
  8058        BI-FIN-RESP   = ERBILL-FIN-RESP
  8059          MOVE SPACE              TO NO-BILL-REC-SW
  8060          GO TO 3930-EXIT
  8061      ELSE
  8062          GO TO 3930-BILL-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 160
* EL640.cbl
  8063
  8064 3930-BILL-NOTOPEN.
  8065     MOVE ER-2564                TO EMI-ERROR.
  8066     MOVE -1 TO APFNTERL.
  8067     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8068     GO TO 8200-SEND-DATAONLY.
  8069
  8070 3930-BILL-NOTFND.
  8071     MOVE 'Y'                    TO NO-BILL-REC-SW.
  8072
  8073 3930-EXIT.
  8074     EXIT.
  8075
  8076 3940-BILL-GENERIC-DELETE.
  8077
  8078* EXEC CICS HANDLE CONDITION
  8079*        NOTFND (3940-EXIT)
  8080*    END-EXEC.
  8081*    MOVE '"$I                   ! % #00007896' TO DFHEIV0
  8082     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8083     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8084     MOVE X'2520233030303037383936' TO DFHEIV0(25:11)
  8085     CALL 'kxdfhei1' USING DFHEIV0
  8086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8087
  8088
  8089     MOVE PI-COMPANY-CD          TO ERBILL-CO-CD.
  8090     MOVE PI-CR-CARRIER          TO ERBILL-CARRIER.
  8091     MOVE PI-CR-GROUPING         TO ERBILL-GROUP.
  8092     MOVE PI-SAV-ACCT            TO ERBILL-ACCT.
  8093
  8094     IF ST-ACCNT-CNTL OR ACCNT-CNTL
  8095        MOVE ZEROS               TO ERBILL-CARRIER
  8096                                    ERBILL-GROUP.
  8097
  8098     IF CARR-ST-ACCNT-CNTL OR CARR-ACCNT-CNTL
  8099        MOVE ZEROS               TO ERBILL-GROUP.
  8100
  8101
  8102* EXEC CICS DELETE
  8103*        DATASET   (ERBILL-FILE-ID)
  8104*        RIDFLD    (ERBILL-KEY)
  8105*        KEYLENGTH (18)
  8106*        GENERIC
  8107*    END-EXEC.
  8108     MOVE 18
  8109       TO DFHEIV11
  8110*    MOVE '&(  RKG               &   #00007912' TO DFHEIV0
  8111     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  8112     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8113     MOVE X'2020233030303037393132' TO DFHEIV0(25:11)
  8114     CALL 'kxdfhei1' USING DFHEIV0,
  8115           ERBILL-FILE-ID,
  8116           ERBILL-KEY,
  8117           DFHEIV11,
  8118           DFHEIV99,
  8119           DFHEIV99
  8120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 161
* EL640.cbl
  8121
  8122
  8123 3940-EXIT.
  8124     EXIT.
  8125
  8126 3990-EXIT.
  8127     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 162
* EL640.cbl
  8129******************************************************************
  8130*                                                                *
  8131*   ALL I/O FOR THE VARIOUS FILES OTHER THAN THE COMPENSATION    *
  8132*   MASTER IS DONE IN THE FOLLOWING SECTIONS BEGINNING WITH 4XXX *
  8133*   WERE THE XXX INDICATES NUMERIC VALUES.                       *
  8134*                                                                *
  8135******************************************************************
  8136 4000-PNDB-START-BROWSE.
  8137     MOVE PI-COMPANY-CD          TO ERPNDB-CO-CD-A1.
  8138     MOVE PI-SAV-CARR            TO ERPNDB-CARR
  8139     MOVE PI-SAV-GROUP           TO ERPNDB-GROUP.
  8140     MOVE PI-SAV-STATE           TO ERPNDB-STATE.
  8141     MOVE PI-SAV-ACCT            TO ERPNDB-ACCT.
  8142     MOVE LOW-VALUES             TO ERPNDB-CERT.
  8143
  8144
  8145* EXEC CICS HANDLE CONDITION
  8146*        NOTFND (4010-REC-NOT-FND)
  8147*    END-EXEC.
  8148*    MOVE '"$I                   ! & #00007940' TO DFHEIV0
  8149     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8150     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8151     MOVE X'2620233030303037393430' TO DFHEIV0(25:11)
  8152     CALL 'kxdfhei1' USING DFHEIV0
  8153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8154
  8155
  8156
  8157* EXEC CICS STARTBR
  8158*        DATASET(ERPNDB-ALT-FILE-ID)
  8159*        RIDFLD (ERPNDB-ALT-KEY)
  8160*        GTEQ
  8161*    END-EXEC.
  8162     MOVE 0
  8163       TO DFHEIV11
  8164*    MOVE '&,         G          &   #00007944' TO DFHEIV0
  8165     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8166     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8167     MOVE X'2020233030303037393434' TO DFHEIV0(25:11)
  8168     CALL 'kxdfhei1' USING DFHEIV0,
  8169           ERPNDB-ALT-FILE-ID,
  8170           ERPNDB-ALT-KEY,
  8171           DFHEIV99,
  8172           DFHEIV11,
  8173           DFHEIV99
  8174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8175
  8176
  8177     GO TO 4090-EXIT.
  8178
  8179 4010-REC-NOT-FND.
  8180     MOVE 'Y'                    TO PNDB-EOF-SW.
  8181
  8182 4090-EXIT.
  8183     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 163
* EL640.cbl
  8185 4100-PNDB-READ-NEXT.
  8186
  8187* EXEC CICS HANDLE CONDITION
  8188*        ENDFILE (4110-END-OF-FILE)
  8189*    END-EXEC.
  8190*    MOVE '"$''                   ! '' #00007959' TO DFHEIV0
  8191     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8193     MOVE X'2720233030303037393539' TO DFHEIV0(25:11)
  8194     CALL 'kxdfhei1' USING DFHEIV0
  8195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8196
  8197
  8198
  8199* EXEC CICS READNEXT
  8200*        SET     (ADDRESS OF PENDING-BUSINESS)
  8201*        DATASET (ERPNDB-ALT-FILE-ID)
  8202*        RIDFLD  (ERPNDB-ALT-KEY)
  8203*    END-EXEC.
  8204     MOVE 0
  8205       TO DFHEIV11
  8206*    MOVE '&.S                   )   #00007963' TO DFHEIV0
  8207     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8208     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8209     MOVE X'2020233030303037393633' TO DFHEIV0(25:11)
  8210     CALL 'kxdfhei1' USING DFHEIV0,
  8211           ERPNDB-ALT-FILE-ID,
  8212           DFHEIV20,
  8213           DFHEIV99,
  8214           ERPNDB-ALT-KEY,
  8215           DFHEIV99,
  8216           DFHEIV11,
  8217           DFHEIV99,
  8218           DFHEIV99
  8219     SET ADDRESS OF PENDING-BUSINESS TO
  8220         DFHEIV20
  8221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8222
  8223
  8224     GO TO 4190-EXIT.
  8225
  8226 4110-END-OF-FILE.
  8227     MOVE 'Y'                    TO PNDB-EOF-SW.
  8228
  8229 4190-EXIT.
  8230     EXIT.
  8231
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 164
* EL640.cbl
  8233 4200-PNDB-REWRITE.
  8234     MOVE PB-COMPANY-CD          TO ERPNDB-CO-CD.
  8235     MOVE PB-ENTRY-BATCH         TO ERPNDB-BATCH.
  8236     MOVE PB-BATCH-SEQ-NO        TO ERPNDB-SEQ-NO.
  8237     MOVE PB-BATCH-CHG-SEQ-NO    TO ERPNDB-CHG-SEQ-NO.
  8238
  8239
  8240* EXEC CICS ENDBR
  8241*        DATASET (ERPNDB-ALT-FILE-ID)
  8242*    END-EXEC.
  8243     MOVE 0
  8244       TO DFHEIV11
  8245*    MOVE '&2                    $   #00007984' TO DFHEIV0
  8246     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8247     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8248     MOVE X'2020233030303037393834' TO DFHEIV0(25:11)
  8249     CALL 'kxdfhei1' USING DFHEIV0,
  8250           ERPNDB-ALT-FILE-ID,
  8251           DFHEIV11,
  8252           DFHEIV99
  8253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8254
  8255
  8256
  8257* EXEC CICS HANDLE CONDITION
  8258*        NOTFND   (4270-PNDB-NOTFIND)
  8259*        NOTOPEN  (4280-PNDB-FILE-NOTOPEN)
  8260*    END-EXEC.
  8261*    MOVE '"$IJ                  ! ( #00007988' TO DFHEIV0
  8262     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8263     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8264     MOVE X'2820233030303037393838' TO DFHEIV0(25:11)
  8265     CALL 'kxdfhei1' USING DFHEIV0
  8266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8267
  8268
  8269
  8270* EXEC CICS READ
  8271*        SET     (ADDRESS OF PENDING-BUSINESS)
  8272*        DATASET (ERPNDB-FILE-ID)
  8273*        RIDFLD  (ERPNDB-PRIME-KEY)
  8274*        UPDATE
  8275*    END-EXEC.
  8276*    MOVE '&"S        EU         (   #00007993' TO DFHEIV0
  8277     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8278     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8279     MOVE X'2020233030303037393933' TO DFHEIV0(25:11)
  8280     CALL 'kxdfhei1' USING DFHEIV0,
  8281           ERPNDB-FILE-ID,
  8282           DFHEIV20,
  8283           DFHEIV99,
  8284           ERPNDB-PRIME-KEY,
  8285           DFHEIV99,
  8286           DFHEIV99,
  8287           DFHEIV99
  8288     SET ADDRESS OF PENDING-BUSINESS TO
  8289         DFHEIV20
  8290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 165
* EL640.cbl
  8291
  8292
  8293     IF PB-ALT-CHG-SEQ-NO NOT = ZEROS
  8294         MOVE 'R'                TO PB-BILLING-STATUS.
  8295
  8296     IF PI-VOID-BILL
  8297         MOVE LOW-VALUES         TO PB-BILLED-DT
  8298         MOVE ZEROS              TO PB-CHG-COUNT
  8299     ELSE
  8300         MOVE WS-CURRENT-DATE    TO PB-BILLED-DT.
  8301
  8302     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  8303     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  8304     MOVE WS-CURRENT-DATE        TO PB-LAST-MAINT-DT.
  8305
  8306
  8307* EXEC CICS REWRITE
  8308*        DATASET (ERPNDB-FILE-ID)
  8309*        FROM    (PENDING-BUSINESS)
  8310*    END-EXEC.
  8311     MOVE LENGTH OF
  8312      PENDING-BUSINESS
  8313       TO DFHEIV11
  8314*    MOVE '&& L                  %   #00008013' TO DFHEIV0
  8315     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8316     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8317     MOVE X'2020233030303038303133' TO DFHEIV0(25:11)
  8318     CALL 'kxdfhei1' USING DFHEIV0,
  8319           ERPNDB-FILE-ID,
  8320           PENDING-BUSINESS,
  8321           DFHEIV11,
  8322           DFHEIV99
  8323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8324
  8325
  8326
  8327* EXEC CICS STARTBR
  8328*        DATASET (ERPNDB-ALT-FILE-ID)
  8329*        RIDFLD  (ERPNDB-ALT-KEY)
  8330*        GTEQ
  8331*    END-EXEC.
  8332     MOVE 0
  8333       TO DFHEIV11
  8334*    MOVE '&,         G          &   #00008018' TO DFHEIV0
  8335     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8336     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8337     MOVE X'2020233030303038303138' TO DFHEIV0(25:11)
  8338     CALL 'kxdfhei1' USING DFHEIV0,
  8339           ERPNDB-ALT-FILE-ID,
  8340           ERPNDB-ALT-KEY,
  8341           DFHEIV99,
  8342           DFHEIV11,
  8343           DFHEIV99
  8344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8345
  8346
  8347     PERFORM 4100-PNDB-READ-NEXT THRU 4190-EXIT.
  8348
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 166
* EL640.cbl
  8349     GO TO 4290-EXIT.
  8350
  8351 4270-PNDB-NOTFIND.
  8352     MOVE ER-2212                TO EMI-ERROR.
  8353     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8354     GO TO 4290-EXIT.
  8355
  8356 4280-PNDB-FILE-NOTOPEN.
  8357     MOVE -1                     TO ACARIERL.
  8358     MOVE ER-2210                TO EMI-ERROR.
  8359     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8360
  8361 4290-EXIT.
  8362     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 167
* EL640.cbl
  8364 4300-READ-ACCOUNT-MASTER.
  8365     MOVE PI-COMPANY-CD          TO ERACCT-A-CO-CD.
  8366     MOVE PI-SAV-CARR            TO ERACCT-A-CARRIER.
  8367     MOVE PI-SAV-GROUP           TO ERACCT-A-GROUPING.
  8368     MOVE PI-SAV-STATE           TO ERACCT-A-STATE.
  8369     MOVE PI-SAV-ACCT            TO ERACCT-A-ACCOUNT.
  8370     MOVE PI-SAV-EXP-DT          TO ERACCT-A-EXP-DATE.
  8371
  8372     MOVE SPACES                 TO WS-AM-ZIP.
  8373
  8374
  8375* EXEC CICS HANDLE CONDITION
  8376*        NOTFND   (4370-ACCOUNT-INVALID)
  8377*        NOTOPEN  (4380-ACCT-FILE-NOTOPEN)
  8378*    END-EXEC.
  8379*    MOVE '"$IJ                  ! ) #00008051' TO DFHEIV0
  8380     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8381     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8382     MOVE X'2920233030303038303531' TO DFHEIV0(25:11)
  8383     CALL 'kxdfhei1' USING DFHEIV0
  8384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8385
  8386
  8387
  8388* EXEC CICS READ
  8389*        DATASET   (ERACCT-ALT-FILE-ID)
  8390*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8391*        RIDFLD    (ERACCT-ALT-KEY)
  8392*        GTEQ
  8393*    END-EXEC.
  8394*    MOVE '&"S        G          (   #00008056' TO DFHEIV0
  8395     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8396     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8397     MOVE X'2020233030303038303536' TO DFHEIV0(25:11)
  8398     CALL 'kxdfhei1' USING DFHEIV0,
  8399           ERACCT-ALT-FILE-ID,
  8400           DFHEIV20,
  8401           DFHEIV99,
  8402           ERACCT-ALT-KEY,
  8403           DFHEIV99,
  8404           DFHEIV99,
  8405           DFHEIV99
  8406     SET ADDRESS OF ACCOUNT-MASTER TO
  8407         DFHEIV20
  8408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8409
  8410
  8411     IF AM-CANADIAN-POST-CODE
  8412         MOVE AM-CAN-POSTAL-1    TO WS-AM-CAN-POST-1
  8413         MOVE AM-CAN-POSTAL-2    TO WS-AM-CAN-POST-2
  8414     ELSE
  8415         MOVE AM-ZIP-PRIME       TO WS-AM-ZIP-PRIME
  8416         IF AM-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  8417             MOVE '-'            TO WS-AM-ZIP-DASH
  8418             MOVE AM-ZIP-PLUS4   TO WS-AM-ZIP-PLUS4.
  8419
  8420     IF AM-REMIT-TO NOT NUMERIC
  8421         MOVE +00 TO AM-REMIT-TO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 168
* EL640.cbl
  8422
  8423     IF AM-REMIT-TO = ZEROS
  8424         MOVE ER-2385            TO EMI-ERROR
  8425         MOVE -1                 TO AACCTL
  8426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8427
  8428     MOVE AM-CARRIER             TO PI-CARRIER.
  8429     MOVE AM-GROUPING            TO PI-GROUPING.
  8430     MOVE AM-STATE               TO PI-STATE.
  8431     MOVE AM-ACCOUNT             TO PI-ACCOUNT.
  8432
  8433     MOVE AM-AGT (AM-REMIT-TO)   TO PI-COMP-FIN-RESP.
  8434
  8435     IF PI-ZERO-CARRIER  OR
  8436        PI-ZERO-CAR-GROUP
  8437         MOVE ZEROS              TO PI-COMP-CARRIER
  8438     ELSE
  8439         MOVE AM-CARRIER         TO PI-COMP-CARRIER.
  8440
  8441     IF PI-ZERO-GROUPING  OR
  8442        PI-ZERO-CAR-GROUP
  8443         MOVE ZEROS              TO PI-COMP-GROUPING
  8444     ELSE
  8445         MOVE AM-GROUPING        TO PI-COMP-GROUPING.
  8446
  8447     IF CARR-GROUP-ST-ACCNT-CNTL
  8448         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8449         MOVE AM-GROUPING        TO PI-CR-GROUPING
  8450         MOVE AM-STATE           TO PI-CR-STATE.
  8451
  8452     IF ST-ACCNT-CNTL
  8453         MOVE ZEROS              TO PI-CR-CARRIER
  8454                                    PI-CR-GROUPING
  8455         MOVE AM-STATE           TO PI-CR-STATE.
  8456
  8457     IF CARR-ST-ACCNT-CNTL
  8458         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8459         MOVE ZEROS              TO PI-CR-GROUPING
  8460         MOVE AM-STATE           TO PI-CR-STATE.
  8461
  8462     IF ACCNT-CNTL
  8463         MOVE ZEROS              TO PI-CR-CARRIER
  8464                                    PI-CR-GROUPING
  8465                                    PI-CR-STATE.
  8466
  8467     IF CARR-ACCNT-CNTL
  8468         MOVE AM-CARRIER         TO PI-CR-CARRIER
  8469         MOVE ZEROS              TO PI-CR-GROUPING
  8470                                    PI-CR-STATE.
  8471
  8472     MOVE AM-EXPIRATION-DT       TO ERACCT-A-EXP-DATE.
  8473
  8474     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8475         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8476     ELSE
  8477         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8478
  8479     IF PI-VOID-BILL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 169
* EL640.cbl
  8480         MOVE AM-EXPIRATION-DT   TO WS-SAV-EXP-DT (DTNDX)
  8481         IF DTNDX < 10
  8482             SET DTNDX UP BY 1
  8483             GO TO 4390-EXIT
  8484         ELSE
  8485             GO TO 4390-EXIT.
  8486
  8487     IF PI-COMPANY-CD = AM-COMPANY-CD-A1 AND
  8488        PI-SAV-CARR   = AM-VG-CARRIER    AND
  8489        PI-SAV-GROUP  = AM-VG-GROUPING   AND
  8490        PI-SAV-STATE  = AM-VG-STATE      AND
  8491        PI-SAV-ACCT   = AM-VG-ACCOUNT
  8492          NEXT SENTENCE
  8493     ELSE
  8494          GO TO 4370-ACCOUNT-INVALID.
  8495
  8496     IF PI-GA-BILLING
  8497         NEXT SENTENCE
  8498     ELSE
  8499         GO TO 4390-EXIT.
  8500
  8501     IF AM-AGT (AM-REMIT-TO) = PI-SAV-ACCT
  8502         MOVE 'Y'                TO ACCOUNT-FIN-RESP-SW
  8503     ELSE
  8504         MOVE 'N'                TO ACCOUNT-FIN-RESP-SW.
  8505
  8506     GO TO 4390-EXIT.
  8507
  8508 4370-ACCOUNT-INVALID.
  8509     MOVE -1                     TO AACCTL.
  8510
  8511     MOVE SPACES                 TO PI-CARRIER
  8512                                    PI-GROUPING
  8513                                    PI-STATE
  8514                                    PI-ACCOUNT.
  8515
  8516     IF CARR-GROUP-ST-ACCNT-CNTL
  8517         MOVE AL-UABON           TO ACARIERA
  8518                                    AGROUPA
  8519                                    ASTATEA
  8520                                    AACCTA
  8521     ELSE
  8522         IF ST-ACCNT-CNTL
  8523             MOVE AL-UABON       TO ASTATEA
  8524                                    AACCTA
  8525         ELSE
  8526             IF CARR-ST-ACCNT-CNTL
  8527                 MOVE AL-UABON   TO ACARIERA
  8528                                    ASTATEA
  8529                                    AACCTA
  8530             ELSE
  8531                 IF ACCNT-CNTL
  8532                     MOVE AL-UABON
  8533                                 TO AACCTA
  8534                 ELSE
  8535                     MOVE AL-UABON
  8536                                 TO ACARIERA
  8537                                    AACCTA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 170
* EL640.cbl
  8538
  8539     MOVE ER-2210                TO EMI-ERROR.
  8540     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8541     GO TO 4390-EXIT.
  8542
  8543 4380-ACCT-FILE-NOTOPEN.
  8544     MOVE -1                     TO ACARIERL.
  8545     MOVE ER-2215                TO EMI-ERROR.
  8546     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8547
  8548 4390-EXIT.
  8549     EXIT.
  8550
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 171
* EL640.cbl
  8552 4400-ERACCT-REWRITE.
  8553     IF NOT PI-VOID-BILL
  8554         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8555         MOVE AM-COMPANY-CD      TO ERACCT-P-CO-CD
  8556         MOVE AM-CARRIER         TO ERACCT-P-CARRIER
  8557         MOVE AM-GROUPING        TO ERACCT-P-GROUPING
  8558         MOVE AM-STATE           TO ERACCT-P-STATE
  8559         MOVE AM-ACCOUNT         TO ERACCT-P-ACCOUNT
  8560         MOVE AM-EXPIRATION-DT   TO ERACCT-P-EXP-DATE
  8561     ELSE
  8562         MOVE LOW-VALUES         TO ERACCT-PRIME-KEY
  8563         MOVE PI-COMPANY-CD      TO ERACCT-P-CO-CD
  8564         MOVE PI-CARRIER         TO ERACCT-P-CARRIER
  8565         MOVE PI-GROUPING        TO ERACCT-P-GROUPING
  8566         MOVE PI-STATE           TO ERACCT-P-STATE
  8567         MOVE PI-SAV-ACCT        TO ERACCT-P-ACCOUNT
  8568         MOVE PI-SAV-EXP-DT      TO ERACCT-P-EXP-DATE.
  8569
  8570
  8571* EXEC CICS HANDLE CONDITION
  8572*        NOTFND   (4470-ACCOUNT-INVALID)
  8573*        NOTOPEN  (4480-ACCT-FILE-NOTOPEN)
  8574*    END-EXEC.
  8575*    MOVE '"$IJ                  ! * #00008222' TO DFHEIV0
  8576     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  8577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8578     MOVE X'2A20233030303038323232' TO DFHEIV0(25:11)
  8579     CALL 'kxdfhei1' USING DFHEIV0
  8580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8581
  8582
  8583
  8584* EXEC CICS READ
  8585*        DATASET   (ERACCT-FILE-ID)
  8586*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8587*        RIDFLD    (ERACCT-PRIME-KEY)
  8588*        UPDATE
  8589*    END-EXEC.
  8590*    MOVE '&"S        EU         (   #00008227' TO DFHEIV0
  8591     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8592     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8593     MOVE X'2020233030303038323237' TO DFHEIV0(25:11)
  8594     CALL 'kxdfhei1' USING DFHEIV0,
  8595           ERACCT-FILE-ID,
  8596           DFHEIV20,
  8597           DFHEIV99,
  8598           ERACCT-PRIME-KEY,
  8599           DFHEIV99,
  8600           DFHEIV99,
  8601           DFHEIV99
  8602     SET ADDRESS OF ACCOUNT-MASTER TO
  8603         DFHEIV20
  8604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8605
  8606
  8607     IF PI-VOID-BILL
  8608         MOVE AM-AGT (AM-REMIT-TO) TO PI-SAV-REMIT-TO.
  8609
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 172
* EL640.cbl
  8610     IF PI-VOID-BILL
  8611         MOVE SPACE              TO AM-BILLING-STATUS
  8612     ELSE
  8613         MOVE 'B'                TO AM-BILLING-STATUS.
  8614
  8615     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  8616     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  8617     MOVE WS-CURRENT-DATE        TO AM-LAST-MAINT-DT.
  8618
  8619
  8620* EXEC CICS REWRITE
  8621*        DATASET (ERACCT-FILE-ID)
  8622*        FROM    (ACCOUNT-MASTER)
  8623*    END-EXEC.
  8624     MOVE LENGTH OF
  8625      ACCOUNT-MASTER
  8626       TO DFHEIV11
  8627*    MOVE '&& L                  %   #00008246' TO DFHEIV0
  8628     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8629     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8630     MOVE X'2020233030303038323436' TO DFHEIV0(25:11)
  8631     CALL 'kxdfhei1' USING DFHEIV0,
  8632           ERACCT-FILE-ID,
  8633           ACCOUNT-MASTER,
  8634           DFHEIV11,
  8635           DFHEIV99
  8636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8637
  8638
  8639     GO TO 4490-EXIT.
  8640
  8641 4470-ACCOUNT-INVALID.
  8642     MOVE -1                     TO AACCTL.
  8643
  8644     MOVE SPACES                 TO PI-CARRIER
  8645                                    PI-GROUPING
  8646                                    PI-STATE
  8647                                    PI-ACCOUNT.
  8648
  8649     IF CARR-GROUP-ST-ACCNT-CNTL
  8650         MOVE AL-UABON           TO ACARIERA
  8651                                    AGROUPA
  8652                                    ASTATEA
  8653                                    AACCTA
  8654     ELSE
  8655         IF ST-ACCNT-CNTL
  8656             MOVE AL-UABON       TO ASTATEA
  8657                                    AACCTA
  8658         ELSE
  8659             IF CARR-ST-ACCNT-CNTL
  8660                 MOVE AL-UABON   TO ACARIERA
  8661                                    ASTATEA
  8662                                    AACCTA
  8663             ELSE
  8664                 IF ACCNT-CNTL
  8665                     MOVE AL-UABON
  8666                                 TO AACCTA
  8667                 ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 173
* EL640.cbl
  8668                     MOVE AL-UABON
  8669                                 TO ACARIERA
  8670                                    AACCTA.
  8671
  8672     MOVE ER-2210                TO EMI-ERROR.
  8673     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8674     GO TO 4490-EXIT.
  8675
  8676 4480-ACCT-FILE-NOTOPEN.
  8677     MOVE -1                     TO ACARIERL.
  8678     MOVE ER-2215                TO EMI-ERROR.
  8679     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8680
  8681 4490-EXIT.
  8682     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 174
* EL640.cbl
  8684
  8685 4500-PYAJ-START-BROWSE.
  8686     MOVE PI-COMPANY-CD          TO ERPYAJ-COMP-CD.
  8687
  8688     IF NOT PI-ZERO-CARRIER  AND
  8689        NOT PI-ZERO-CAR-GROUP
  8690         MOVE PI-COMP-CARRIER    TO ERPYAJ-CARRIER
  8691     ELSE
  8692         MOVE ZEROS              TO ERPYAJ-CARRIER.
  8693
  8694     IF NOT PI-ZERO-GROUPING  AND
  8695        NOT PI-ZERO-CAR-GROUP
  8696         MOVE PI-COMP-GROUPING   TO ERPYAJ-GROUPING
  8697     ELSE
  8698         MOVE ZEROS              TO ERPYAJ-GROUPING.
  8699
  8700     MOVE PI-SAV-REMIT-TO        TO ERPYAJ-FIN-RESP.
  8701     MOVE PI-SAV-ACCT            TO ERPYAJ-ACCOUNT.
  8702
  8703     IF PI-SAV-REMIT-TO = SPACES
  8704         MOVE PI-SAV-ACCT        TO PI-SAV-REMIT-TO
  8705                                    ERPYAJ-FIN-RESP.
  8706
  8707     MOVE LOW-VALUES             TO ERPYAJ-RECORD-TYPE.
  8708     MOVE ERPYAJ-KEY             TO ERPYAJ-BROWSE-COMP-KEY.
  8709
  8710
  8711* EXEC CICS HANDLE CONDITION
  8712*        NOTFND (4510-REC-NOT-FND)
  8713*    END-EXEC.
  8714*    MOVE '"$I                   ! + #00008322' TO DFHEIV0
  8715     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8716     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8717     MOVE X'2B20233030303038333232' TO DFHEIV0(25:11)
  8718     CALL 'kxdfhei1' USING DFHEIV0
  8719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8720
  8721
  8722
  8723* EXEC CICS STARTBR
  8724*        DATASET(ERPYAJ-FILE-ID)
  8725*        RIDFLD (ERPYAJ-KEY)
  8726*        GTEQ
  8727*    END-EXEC.
  8728     MOVE 0
  8729       TO DFHEIV11
  8730*    MOVE '&,         G          &   #00008326' TO DFHEIV0
  8731     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8732     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8733     MOVE X'2020233030303038333236' TO DFHEIV0(25:11)
  8734     CALL 'kxdfhei1' USING DFHEIV0,
  8735           ERPYAJ-FILE-ID,
  8736           ERPYAJ-KEY,
  8737           DFHEIV99,
  8738           DFHEIV11,
  8739           DFHEIV99
  8740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8741
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 175
* EL640.cbl
  8742
  8743     GO TO 4590-EXIT.
  8744
  8745 4510-REC-NOT-FND.
  8746     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8747
  8748 4590-EXIT.
  8749     EXIT.
  8750
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 176
* EL640.cbl
  8752 4600-PYAJ-READ-NEXT.
  8753
  8754* EXEC CICS HANDLE CONDITION
  8755*        ENDFILE (4610-END-OF-FILE)
  8756*    END-EXEC.
  8757*    MOVE '"$''                   ! , #00008342' TO DFHEIV0
  8758     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8759     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8760     MOVE X'2C20233030303038333432' TO DFHEIV0(25:11)
  8761     CALL 'kxdfhei1' USING DFHEIV0
  8762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8763
  8764
  8765
  8766* EXEC CICS READNEXT
  8767*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8768*        DATASET (ERPYAJ-FILE-ID)
  8769*        RIDFLD  (ERPYAJ-KEY)
  8770*    END-EXEC.
  8771     MOVE 0
  8772       TO DFHEIV11
  8773*    MOVE '&.S                   )   #00008346' TO DFHEIV0
  8774     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8775     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8776     MOVE X'2020233030303038333436' TO DFHEIV0(25:11)
  8777     CALL 'kxdfhei1' USING DFHEIV0,
  8778           ERPYAJ-FILE-ID,
  8779           DFHEIV20,
  8780           DFHEIV99,
  8781           ERPYAJ-KEY,
  8782           DFHEIV99,
  8783           DFHEIV11,
  8784           DFHEIV99,
  8785           DFHEIV99
  8786     SET ADDRESS OF PENDING-PAY-ADJ TO
  8787         DFHEIV20
  8788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8789
  8790
  8791     GO TO 4690-EXIT.
  8792
  8793 4610-END-OF-FILE.
  8794     MOVE 'Y'                    TO PYAJ-EOF-SW.
  8795
  8796 4690-EXIT.
  8797     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 177
* EL640.cbl
  8799 4700-PYAJ-REWRITE.
  8800
  8801* EXEC CICS READ
  8802*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  8803*        DATASET (ERPYAJ-FILE-ID)
  8804*        RIDFLD  (ERPYAJ-KEY)
  8805*        UPDATE
  8806*    END-EXEC.
  8807*    MOVE '&"S        EU         (   #00008361' TO DFHEIV0
  8808     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8809     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8810     MOVE X'2020233030303038333631' TO DFHEIV0(25:11)
  8811     CALL 'kxdfhei1' USING DFHEIV0,
  8812           ERPYAJ-FILE-ID,
  8813           DFHEIV20,
  8814           DFHEIV99,
  8815           ERPYAJ-KEY,
  8816           DFHEIV99,
  8817           DFHEIV99,
  8818           DFHEIV99
  8819     SET ADDRESS OF PENDING-PAY-ADJ TO
  8820         DFHEIV20
  8821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8822
  8823
  8824     IF PI-VOID-BILL
  8825         MOVE LOW-VALUES         TO PY-BILLED-DATE
  8826                                    PY-AR-DATE
  8827         IF ACCOUNT-NOT-FIN-RESP
  8828             IF PY-REMIT-RECEIVED OR PY-ADJ-REM-RECEIVED OR
  8829                 PY-DEPOSIT OR PY-ADJ-DEPOSIT OR
  8830                 PY-ADD-TO-BALANCE
  8831                 ADD PY-ENTRY-AMT  TO  PI-REMITTED
  8832             ELSE
  8833                 IF (PY-CHARGE-TO-AGENT OR PY-ADJ-CHG-TO-AGT)
  8834                    AND PY-BILLING-CHECK
  8835                    ADD PY-ENTRY-AMT TO PI-DISBURSED
  8836                 ELSE
  8837                     ADD PY-ENTRY-AMT TO PI-ADJUSTMENTS
  8838         ELSE
  8839             NEXT SENTENCE
  8840     ELSE
  8841         MOVE WS-CURRENT-DATE    TO PY-BILLED-DATE.
  8842
  8843     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  8844     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  8845     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT.
  8846
  8847
  8848* EXEC CICS REWRITE
  8849*        DATASET (ERPYAJ-FILE-ID)
  8850*        FROM    (PENDING-PAY-ADJ)
  8851*    END-EXEC.
  8852     MOVE LENGTH OF
  8853      PENDING-PAY-ADJ
  8854       TO DFHEIV11
  8855*    MOVE '&& L                  %   #00008391' TO DFHEIV0
  8856     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 178
* EL640.cbl
  8857     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8858     MOVE X'2020233030303038333931' TO DFHEIV0(25:11)
  8859     CALL 'kxdfhei1' USING DFHEIV0,
  8860           ERPYAJ-FILE-ID,
  8861           PENDING-PAY-ADJ,
  8862           DFHEIV11,
  8863           DFHEIV99
  8864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8865
  8866
  8867 4790-EXIT.
  8868     EXIT.
  8869
  8870 4800-PYAJ-END-BROWSE.
  8871
  8872* EXEC CICS ENDBR
  8873*        DATASET (ERPYAJ-FILE-ID)
  8874*    END-EXEC.
  8875     MOVE 0
  8876       TO DFHEIV11
  8877*    MOVE '&2                    $   #00008400' TO DFHEIV0
  8878     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8879     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8880     MOVE X'2020233030303038343030' TO DFHEIV0(25:11)
  8881     CALL 'kxdfhei1' USING DFHEIV0,
  8882           ERPYAJ-FILE-ID,
  8883           DFHEIV11,
  8884           DFHEIV99
  8885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8886
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 179
* EL640.cbl
  8888 5000-FORMAT-SCREEN.
  8889*                **********************************************
  8890*                *  FORMAT THE BILLING TOTALS SCREEN (EL640A) *
  8891*                **********************************************
  8892     MOVE LOW-VALUES             TO EL640AO.
  8893
  8894     IF PI-SAV-ACCT > SPACES
  8895        MOVE PI-SAV-ACCT         TO AACCTO
  8896        MOVE PI-SAV-CARR         TO ACARIERO
  8897        MOVE PI-SAV-GROUP        TO AGROUPO
  8898        MOVE PI-SAV-STATE        TO ASTATEO.
  8899
  8900     MOVE PI-BILL-TYPE           TO ABILTYPI.
  8901     MOVE PI-BILL-ERRS           TO ABILERRI.
  8902     MOVE AL-UANON               TO AACCTA
  8903                                    ACARIERA
  8904                                    AGROUPA
  8905                                    ASTATEA
  8906                                    ABILTYPA
  8907                                    ABILERRA.
  8908
  8909     IF ACCOUNT-NOT-FIN-RESP
  8910         MOVE ER-2539            TO EMI-ERROR
  8911         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8912
  8913     IF PI-BILLING-BATCHES (1) NOT = SPACES
  8914         MOVE PI-BILLING-BATCHES (1) TO ABTCH1I
  8915         MOVE AL-UANON               TO ABTCH1A.
  8916
  8917     IF PI-BILLING-BATCHES (2) NOT = SPACES
  8918         MOVE PI-BILLING-BATCHES (2) TO ABTCH2I
  8919         MOVE AL-UANON               TO ABTCH2A.
  8920
  8921     IF PI-BILLING-BATCHES (3) NOT = SPACES
  8922         MOVE PI-BILLING-BATCHES (3) TO ABTCH3I
  8923         MOVE AL-UANON               TO ABTCH3A.
  8924
  8925     SET ANDX  PINDX            TO 1.
  8926
  8927 5005-FORMAT-LOOP.
  8928     IF PI-BATCH (PINDX) NOT = SPACES
  8929         MOVE PI-BATCH  (PINDX)  TO BATCH  (ANDX)
  8930         MOVE PI-NOBILL (PINDX)  TO NOBILL (ANDX)
  8931         MOVE PI-BILLED (PINDX)  TO BILL   (ANDX)
  8932         MOVE PI-PREV   (PINDX)  TO PREV   (ANDX)
  8933         SET ANDX PINDX UP BY 1
  8934         IF ANDX > 6
  8935             NEXT SENTENCE
  8936         ELSE
  8937             GO TO 5005-FORMAT-LOOP.
  8938
  8939     IF MORE-THAN-6-BATCHES
  8940         MOVE ER-2472            TO EMI-ERROR
  8941         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8942         MOVE ZEROS              TO EMI-ERROR.
  8943
  8944     IF NOT PI-DATA-BILLED
  8945         IF RETURNED-FROM NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 180
* EL640.cbl
  8946             GO TO 5080-CONT
  8947         ELSE
  8948             MOVE ER-2409        TO EMI-ERROR
  8949             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8950             GO TO 5090-EXIT.
  8951
  8952     MOVE PI-BAL-FRWD            TO ABALFWDO.
  8953     MOVE PI-PREMIUM             TO APREMUMO.
  8954     MOVE PI-REMITTED            TO AREMITO.
  8955     MOVE PI-TOT-ISS-COMP        TO ACOMPISO.
  8956     MOVE PI-TOT-CAN-COMP        TO ACOMCANO.
  8957     COMPUTE PI-ADJUSTMENTS  =   PI-ADJUSTMENTS  +
  8958                                 TOT-REPT-CANCEL-FEE.
  8959     MOVE PI-ADJUSTMENTS         TO AADJUSTO.
  8960     MOVE PI-DISBURSED           TO ADISBURO.
  8961
  8962     COMPUTE PI-END-BAL = PI-BAL-FRWD +
  8963                          PI-PREMIUM -
  8964                          PI-REMITTED -
  8965                          PI-TOT-ISS-COMP +
  8966                          PI-TOT-CAN-COMP +
  8967                          PI-ADJUSTMENTS +
  8968                          PI-DISBURSED.
  8969
  8970     MOVE PI-END-BAL             TO ANETDUEO.
  8971
  8972     IF PI-END-BAL NEGATIVE
  8973         MOVE OWED-TO-AGENT      TO AENDHDGO
  8974     ELSE
  8975         IF PI-END-BAL > ZERO
  8976             MOVE AGENT-OWES     TO AENDHDGO
  8977         ELSE
  8978             MOVE 'BALANCE          =' TO AENDHDGO.
  8979
  8980 5080-CONT.
  8981     IF RETURNED-FROM NOT = SPACES
  8982         IF (RETURNED-FROM NOT = XCTL-6401)  AND
  8983             (PI-CR-FIN-RESP NOT = SPACES)
  8984               MOVE ER-2421        TO EMI-ERROR
  8985               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8986               MOVE ZEROS          TO EMI-ERROR
  8987         ELSE
  8988             NEXT SENTENCE
  8989     ELSE
  8990         IF PI-BILL OR PI-REBILLING
  8991             MOVE 'Y'            TO COMP-UPDATE-SW
  8992             PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  8993             MOVE 'Y'            TO ELCNTL-UPDATE-SW
  8994             MOVE SPACES         TO ELCNTL-KEY
  8995             MOVE '1'            TO ELCNTL-REC-TYPE
  8996             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  8997             MOVE WS-CURRENT-DATE TO CF-ACCOUNT-MSTR-MAINT-DT
  8998                                     CF-COMPENSATION-MSTR-MAINT-DT
  8999             PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT.
  9000
  9001 5090-EXIT.
  9002     EXIT.
  9003
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 181
* EL640.cbl
  9005 6000-READ-COMP-MASTER.
  9006
  9007* EXEC CICS HANDLE CONDITION
  9008*        NOTFND   (6070-NO-COMP-MSTR)
  9009*        NOTOPEN  (6080-COMP-FILE-NOTOPEN)
  9010*    END-EXEC.
  9011*    MOVE '"$IJ                  ! - #00008522' TO DFHEIV0
  9012     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9013     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9014     MOVE X'2D20233030303038353232' TO DFHEIV0(25:11)
  9015     CALL 'kxdfhei1' USING DFHEIV0
  9016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9017
  9018
  9019     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9020     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9021     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9022     MOVE PI-COMP-FIN-RESP       TO ERCOMP-FIN-RESP.
  9023
  9024     MOVE SPACES                 TO WS-CO-ZIP.
  9025
  9026     IF EIBAID = DFHPF5
  9027         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9028         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9029     ELSE
  9030         MOVE PI-SAV-ACCT        TO ERCOMP-ACCT
  9031         MOVE 'A'                TO ERCOMP-RECORD-TYPE.
  9032
  9033 6001-READ.
  9034     IF UPDATE-COMP-TOTALS OR PI-VOID-BILL
  9035
  9036* EXEC CICS READ
  9037*            DATASET   (ERCOMP-FILE-ID)
  9038*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9039*            RIDFLD    (ERCOMP-KEY)
  9040*            UPDATE
  9041*        END-EXEC
  9042*    MOVE '&"S        EU         (   #00008543' TO DFHEIV0
  9043     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9044     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9045     MOVE X'2020233030303038353433' TO DFHEIV0(25:11)
  9046     CALL 'kxdfhei1' USING DFHEIV0,
  9047           ERCOMP-FILE-ID,
  9048           DFHEIV20,
  9049           DFHEIV99,
  9050           ERCOMP-KEY,
  9051           DFHEIV99,
  9052           DFHEIV99,
  9053           DFHEIV99
  9054     SET ADDRESS OF COMPENSATION-MASTER TO
  9055         DFHEIV20
  9056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9057     ELSE
  9058
  9059* EXEC CICS READ
  9060*            DATASET   (ERCOMP-FILE-ID)
  9061*            SET       (ADDRESS OF COMPENSATION-MASTER)
  9062*            RIDFLD    (ERCOMP-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 182
* EL640.cbl
  9063*        END-EXEC.
  9064*    MOVE '&"S        E          (   #00008550' TO DFHEIV0
  9065     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9066     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9067     MOVE X'2020233030303038353530' TO DFHEIV0(25:11)
  9068     CALL 'kxdfhei1' USING DFHEIV0,
  9069           ERCOMP-FILE-ID,
  9070           DFHEIV20,
  9071           DFHEIV99,
  9072           ERCOMP-KEY,
  9073           DFHEIV99,
  9074           DFHEIV99,
  9075           DFHEIV99
  9076     SET ADDRESS OF COMPENSATION-MASTER TO
  9077         DFHEIV20
  9078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9079
  9080
  9081     IF CO-CANADIAN-POST-CODE
  9082         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9083         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9084     ELSE
  9085         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9086         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9087             MOVE '-'            TO WS-CO-ZIP-DASH
  9088             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9089
  9090 6002-CONTINUE.
  9091     IF EIBAID = DFHPF5
  9092         GO TO 6090-EXIT.
  9093
  9094     IF FIRST-TIME
  9095        MOVE CO-MAIL-NAME        TO WS-ACCT-LINES (1)
  9096        MOVE CO-ACCT-NAME        TO WS-ACCT-LINES (2)
  9097        MOVE CO-ADDR-1           TO WS-ACCT-LINES (3)
  9098        MOVE CO-ADDR-2           TO WS-ACCT-LINES (4)
  9099        MOVE CO-ADDR-3           TO WS-ACCT-LINES (5)
  9100        MOVE WS-CO-ZIP           TO WS-ACCT-LINES (6)
  9101        PERFORM 6400-FORMAT-ACCOUNT-ADDRS THRU 6490-EXIT.
  9102
  9103     IF PI-VOID-BILL
  9104         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9105         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9106         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9107         IF ACCOUNT-FIN-RESP
  9108             MOVE CO-MONTHLY-TOTALS TO CO-CURRENT-MONTHLY-TOTALS
  9109             MOVE CO-AGING-TOTALS   TO CO-CURRENT-AGING-TOTALS
  9110             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9111             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9112             PERFORM 6060-ERCOMP-REWRITE
  9113             GO TO 6090-EXIT
  9114         ELSE
  9115             MOVE CO-YTD-TOTALS     TO CO-CURRENT-YTD-TOTALS
  9116             MOVE CO-LAST-STMT-DT   TO CO-CURRENT-LAST-STMT-DT
  9117             PERFORM 6060-ERCOMP-REWRITE
  9118             MOVE LOW-VALUES        TO ERCOMP-ACCT
  9119             MOVE 'G'               TO ERCOMP-RECORD-TYPE
  9120             PERFORM 6001-READ
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 183
* EL640.cbl
  9121             COMPUTE CO-CURRENT-CUR-CHG =
  9122                     CO-CURRENT-CUR-CHG - PI-PREMIUM
  9123             COMPUTE CO-CURRENT-CUR-COM =
  9124                     CO-CURRENT-CUR-COM - PI-TOT-ISS-COMP -
  9125                     PI-TOT-CAN-COMP
  9126             COMPUTE CO-CURRENT-CUR-PMT =
  9127                     CO-CURRENT-CUR-PMT - PI-REMITTED +
  9128                     PI-DISBURSED + PI-ADJUSTMENTS
  9129             COMPUTE CO-CURRENT-END-BAL =
  9130                     CO-CURRENT-BAL-FWD + CO-CURRENT-CUR-CHG -
  9131                     CO-CURRENT-CUR-COM - CO-CURRENT-CUR-PMT
  9132             MOVE CO-AGING-TOTALS   TO  CO-CURRENT-AGING-TOTALS
  9133             PERFORM 6050-AGING  THRU  6059-AGING-EXIT
  9134             IF CO-CURRENT-CUR-CHG = ZEROS AND
  9135                CO-CURRENT-CUR-COM = ZEROS AND
  9136                CO-CURRENT-CUR-PMT = ZEROS
  9137                 MOVE CO-LAST-STMT-DT TO CO-CURRENT-LAST-STMT-DT
  9138                 PERFORM 6060-ERCOMP-REWRITE
  9139                 GO TO 6090-EXIT
  9140             ELSE
  9141                 PERFORM 6060-ERCOMP-REWRITE
  9142                 GO TO 6090-EXIT.
  9143
  9144     IF UPDATE-COMP-TOTALS
  9145         MOVE  PI-ME-MONTH       TO WS-ME-MONTH
  9146         MOVE  PI-ME-DAY         TO WS-ME-DAY
  9147         MOVE  PI-ME-YEAR        TO WS-ME-YEAR
  9148         IF ACCOUNT-FIN-RESP
  9149             IF NOT PI-CHECK-PRODUCED
  9150                 IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9151                     MOVE CO-CURRENT-END-BAL
  9152                                 TO CO-CURRENT-BAL-FWD
  9153                     COMPUTE CO-CURRENT-CUR-COM =
  9154                             CO-CURRENT-CUR-COM +
  9155                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9156                     COMPUTE CO-CURRENT-YTD-COM =
  9157                             CO-CURRENT-YTD-COM +
  9158                             PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9159                     COMPUTE CO-CURRENT-CUR-CHG =
  9160                             CO-CURRENT-CUR-CHG + PI-PREMIUM
  9161                     COMPUTE CO-CURRENT-CUR-PMT =
  9162                             CO-CURRENT-CUR-PMT +
  9163                             PI-REMITTED - PI-DISBURSED -
  9164                             PI-ADJUSTMENTS
  9165                     COMPUTE CO-CURRENT-END-BAL =
  9166                             CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9167                             PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9168                             PI-REMITTED + PI-DISBURSED +
  9169                             PI-ADJUSTMENTS
  9170                     PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9171                     PERFORM 6060-ERCOMP-REWRITE
  9172                     GO TO 6090-EXIT
  9173                ELSE
  9174                    MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9175                    MOVE PI-END-BAL         TO CO-CURRENT-END-BAL
  9176                    COMPUTE CO-CURRENT-CUR-COM =
  9177                            PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9178                    ADD CO-CURRENT-CUR-COM TO CO-CURRENT-YTD-COM
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 184
* EL640.cbl
  9179                    MOVE PI-PREMIUM        TO CO-CURRENT-CUR-CHG
  9180                    COMPUTE CO-CURRENT-CUR-PMT =
  9181                             PI-REMITTED - PI-DISBURSED -
  9182                             PI-ADJUSTMENTS
  9183                    PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9184                    MOVE WS-MONTH-END-DATE
  9185                                 TO CO-CURRENT-LAST-STMT-DT
  9186                    PERFORM 6060-ERCOMP-REWRITE
  9187                    GO TO 6090-EXIT
  9188             ELSE
  9189                 MOVE SPACE      TO PI-CHECK-SW
  9190                 MOVE PI-END-BAL TO CO-CURRENT-END-BAL
  9191                 COMPUTE CO-CURRENT-CUR-CHG = PI-PREMIUM +
  9192                         (PI-ADJUSTMENTS - PI-DISBURSED)
  9193                 PERFORM 6060-ERCOMP-REWRITE
  9194                 GO TO 6090-EXIT
  9195         ELSE
  9196             COMPUTE CO-CURRENT-YTD-COM =
  9197                     CO-CURRENT-YTD-COM + PI-TOT-ISS-COMP
  9198                                        - PI-TOT-CAN-COMP
  9199             PERFORM 6060-ERCOMP-REWRITE
  9200             MOVE LOW-VALUES    TO ERCOMP-ACCT
  9201             MOVE 'G'           TO ERCOMP-RECORD-TYPE
  9202             PERFORM 6001-READ
  9203             IF CO-CURRENT-LAST-STMT-DT = WS-MONTH-END-DATE
  9204                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9205                 COMPUTE CO-CURRENT-CUR-COM =
  9206                         CO-CURRENT-CUR-COM +
  9207                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9208                 COMPUTE CO-CURRENT-CUR-CHG =
  9209                         CO-CURRENT-CUR-CHG + PI-PREMIUM
  9210                 COMPUTE CO-CURRENT-CUR-PMT =
  9211                         CO-CURRENT-CUR-PMT +
  9212                         PI-REMITTED - PI-DISBURSED -
  9213                         PI-ADJUSTMENTS
  9214                 COMPUTE CO-CURRENT-END-BAL =
  9215                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9216                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9217                         PI-REMITTED + PI-DISBURSED +
  9218                         PI-ADJUSTMENTS
  9219                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9220                 PERFORM 6060-ERCOMP-REWRITE
  9221                 GO TO 6090-EXIT
  9222             ELSE
  9223                 MOVE CO-CURRENT-END-BAL TO CO-CURRENT-BAL-FWD
  9224                 COMPUTE CO-CURRENT-CUR-COM =
  9225                         PI-TOT-ISS-COMP - PI-TOT-CAN-COMP
  9226                 MOVE PI-PREMIUM         TO CO-CURRENT-CUR-CHG
  9227                 COMPUTE CO-CURRENT-CUR-PMT =
  9228                         PI-REMITTED - PI-DISBURSED -
  9229                         PI-ADJUSTMENTS
  9230                 COMPUTE CO-CURRENT-END-BAL =
  9231                         CO-CURRENT-BAL-FWD + PI-PREMIUM -
  9232                         PI-TOT-ISS-COMP + PI-TOT-CAN-COMP -
  9233                         PI-REMITTED + PI-DISBURSED +
  9234                         PI-ADJUSTMENTS
  9235                 PERFORM 6050-AGING THRU 6059-AGING-EXIT
  9236                 MOVE WS-MONTH-END-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 185
* EL640.cbl
  9237                                      TO CO-CURRENT-LAST-STMT-DT
  9238                 PERFORM 6060-ERCOMP-REWRITE
  9239                 GO TO 6090-EXIT.
  9240
  9241     IF PI-TOT-REBILL
  9242         MOVE CO-END-BAL           TO PI-BAL-FRWD
  9243     ELSE
  9244         MOVE CO-CURRENT-END-BAL   TO PI-BAL-FRWD.
  9245
  9246     IF PI-UPDATE-FILES
  9247       OR (PI-PREVIEW AND APRODSWI = 'Y')
  9248         NEXT SENTENCE
  9249     ELSE
  9250         GO TO 6090-EXIT.
  9251
  9252     IF AM-AGT (ACCOM-SUB) = PI-SAV-REMIT-TO
  9253         PERFORM 6040-READ-COMP-MASTER THRU 6049-EXIT
  9254         IF C-RECORD-FOUND
  9255             MOVE CO-ACCT-NAME   TO WS-REMIT-LINES (1)
  9256             MOVE CO-MAIL-NAME   TO WS-REMIT-LINES (2)
  9257             MOVE CO-ADDR-1      TO WS-REMIT-LINES (3)
  9258             MOVE CO-ADDR-2      TO WS-REMIT-LINES (4)
  9259             MOVE CO-ADDR-3      TO WS-REMIT-LINES (5)
  9260             MOVE WS-CO-ZIP      TO WS-REMIT-LINES (6)
  9261             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9262             MOVE 'CA'           TO BILLING-DETAIL-TYPE
  9263             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9264         ELSE
  9265             MOVE SPACES         TO ELCNTL-KEY
  9266             MOVE '6'            TO ELCNTL-REC-TYPE
  9267             MOVE PI-CARRIER     TO ELCNTL-CARRIER
  9268             PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT
  9269             MOVE CF-MAIL-TO-NAME   TO WS-REMIT-LINES (1)
  9270             MOVE CF-IN-CARE-OF     TO WS-REMIT-LINES (2)
  9271             MOVE CF-ADDRESS-LINE-1 TO WS-REMIT-LINES (3)
  9272             MOVE CF-ADDRESS-LINE-2 TO WS-REMIT-LINES (4)
  9273             MOVE CF-CITY-STATE     TO WS-REMIT-LINES (5)
  9274             MOVE WS-CF-ZIP         TO WS-REMIT-LINES (6)
  9275             PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9276             MOVE 'CA'              TO BILLING-DETAIL-TYPE
  9277             PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT
  9278     ELSE
  9279         MOVE LOW-VALUES         TO ERCOMP-ACCT
  9280         MOVE 'G'                TO ERCOMP-RECORD-TYPE
  9281         PERFORM 6001-READ
  9282         MOVE CO-ACCT-NAME       TO WS-REMIT-LINES (1)
  9283         MOVE CO-MAIL-NAME       TO WS-REMIT-LINES (2)
  9284         MOVE CO-ADDR-1          TO WS-REMIT-LINES (3)
  9285         MOVE CO-ADDR-2          TO WS-REMIT-LINES (4)
  9286         MOVE CO-ADDR-3          TO WS-REMIT-LINES (5)
  9287         MOVE WS-CO-ZIP          TO WS-REMIT-LINES (6)
  9288         MOVE CO-CURRENT-END-BAL TO PI-BAL-FRWD-GA
  9289         PERFORM 6300-ELIMINATE-LINE-SPACES THRU 6390-EXIT
  9290         MOVE 'GA'               TO BILLING-DETAIL-TYPE
  9291         PERFORM 3000-WRITE-BILLING-DETAIL THRU 3990-EXIT.
  9292
  9293     GO TO 6090-EXIT.
  9294
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 186
* EL640.cbl
  9295 6070-NO-COMP-MSTR.
  9296     MOVE ER-2230                TO EMI-ERROR.
  9297     MOVE -1                     TO AACCTL.
  9298     MOVE AL-UABON               TO ACARIERA
  9299                                    AGROUPA
  9300                                    AACCTA.
  9301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9302     GO TO 6090-EXIT.
  9303
  9304 6080-COMP-FILE-NOTOPEN.
  9305     MOVE -1                     TO APFNTERL
  9306     MOVE ER-2233                TO EMI-ERROR.
  9307     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9308
  9309 6090-EXIT.
  9310     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 187
* EL640.cbl
  9312
  9313 6040-READ-COMP-MASTER.
  9314
  9315* EXEC CICS HANDLE CONDITION
  9316*        NOTFND   (6045-NO-COMP-MSTR)
  9317*        NOTOPEN  (6045-COMP-FILE-NOTOPEN)
  9318*    END-EXEC.
  9319*    MOVE '"$IJ                  ! . #00008789' TO DFHEIV0
  9320     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9322     MOVE X'2E20233030303038373839' TO DFHEIV0(25:11)
  9323     CALL 'kxdfhei1' USING DFHEIV0
  9324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9325
  9326
  9327     MOVE 'Y'                    TO C-RECORD-FOUND-SW.
  9328     MOVE PI-COMPANY-CD          TO ERCOMP-COMP-CD.
  9329     MOVE PI-COMP-CARRIER        TO ERCOMP-CARRIER
  9330     MOVE PI-COMP-GROUPING       TO ERCOMP-GROUPING
  9331     MOVE LOW-VALUES             TO ERCOMP-FIN-RESP
  9332                                    ERCOMP-ACCT.
  9333     MOVE 'C'                    TO ERCOMP-RECORD-TYPE.
  9334
  9335     MOVE SPACES                 TO WS-CO-ZIP.
  9336
  9337
  9338* EXEC CICS READ
  9339*        DATASET   (ERCOMP-FILE-ID)
  9340*        SET       (ADDRESS OF COMPENSATION-MASTER)
  9341*        RIDFLD    (ERCOMP-KEY)
  9342*    END-EXEC.
  9343*    MOVE '&"S        E          (   #00008804' TO DFHEIV0
  9344     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9346     MOVE X'2020233030303038383034' TO DFHEIV0(25:11)
  9347     CALL 'kxdfhei1' USING DFHEIV0,
  9348           ERCOMP-FILE-ID,
  9349           DFHEIV20,
  9350           DFHEIV99,
  9351           ERCOMP-KEY,
  9352           DFHEIV99,
  9353           DFHEIV99,
  9354           DFHEIV99
  9355     SET ADDRESS OF COMPENSATION-MASTER TO
  9356         DFHEIV20
  9357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9358
  9359
  9360     IF CO-CANADIAN-POST-CODE
  9361         MOVE CO-CAN-POSTAL-1    TO WS-CO-CAN-POST-1
  9362         MOVE CO-CAN-POSTAL-2    TO WS-CO-CAN-POST-2
  9363     ELSE
  9364         MOVE CO-ZIP-PRIME       TO WS-CO-ZIP-PRIME
  9365         IF CO-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9366             MOVE '-'            TO WS-CO-ZIP-DASH
  9367             MOVE CO-ZIP-PLUS4   TO WS-CO-ZIP-PLUS4.
  9368
  9369     GO TO 6049-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 188
* EL640.cbl
  9370
  9371 6045-COMP-FILE-NOTOPEN.
  9372     MOVE -1                     TO APFNTERL.
  9373     MOVE ER-2233                TO EMI-ERROR.
  9374     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9375
  9376     GO TO 6049-EXIT.
  9377
  9378 6045-NO-COMP-MSTR.
  9379     MOVE 'N'                    TO C-RECORD-FOUND-SW.
  9380
  9381 6049-EXIT.
  9382     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 189
* EL640.cbl
  9384
  9385 6050-AGING.
  9386
  9387     IF NOT PI-VOID-BILL
  9388         IF CO-CURRENT-LAST-STMT-DT NOT = WS-MONTH-END-DATE
  9389             ADD  CO-CURRENT-OV60  TO CO-CURRENT-OV90
  9390             MOVE CO-CURRENT-OV30
  9391                                 TO CO-CURRENT-OV60
  9392             MOVE CO-CURRENT-CUR TO CO-CURRENT-OV30.
  9393
  9394     COMPUTE CO-CURRENT-CUR =
  9395             CO-CURRENT-CUR-CHG - CO-CURRENT-CUR-COM.
  9396
  9397     COMPUTE WS-PAY-ADJ =
  9398             PI-REMITTED - PI-DISBURSED - PI-ADJUSTMENTS.
  9399
  9400     IF WS-PAY-ADJ NEGATIVE
  9401         SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-CUR
  9402     ELSE
  9403         SUBTRACT WS-PAY-ADJ  FROM  CO-CURRENT-OV90.
  9404
  9405     IF CO-CURRENT-CUR NEGATIVE
  9406         ADD CO-CURRENT-CUR  TO  CO-CURRENT-OV90
  9407         MOVE ZEROS              TO  CO-CURRENT-CUR.
  9408
  9409     IF CO-CURRENT-OV90 NEGATIVE
  9410         ADD CO-CURRENT-OV90  TO  CO-CURRENT-OV60
  9411         MOVE ZEROS              TO  CO-CURRENT-OV90.
  9412
  9413     IF CO-CURRENT-OV60 NEGATIVE
  9414         ADD CO-CURRENT-OV60  TO  CO-CURRENT-OV30
  9415         MOVE ZEROS              TO  CO-CURRENT-OV60.
  9416
  9417     IF CO-CURRENT-OV30 NEGATIVE
  9418         ADD CO-CURRENT-OV30  TO  CO-CURRENT-CUR
  9419         MOVE ZEROS              TO  CO-CURRENT-OV30.
  9420
  9421 6059-AGING-EXIT.
  9422     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 190
* EL640.cbl
  9424
  9425 6060-ERCOMP-REWRITE.
  9426
  9427
  9428* EXEC CICS REWRITE
  9429*        DATASET (ERCOMP-FILE-ID)
  9430*        FROM    (COMPENSATION-MASTER)
  9431*    END-EXEC.
  9432     MOVE LENGTH OF
  9433      COMPENSATION-MASTER
  9434       TO DFHEIV11
  9435*    MOVE '&& L                  %   #00008877' TO DFHEIV0
  9436     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9437     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9438     MOVE X'2020233030303038383737' TO DFHEIV0(25:11)
  9439     CALL 'kxdfhei1' USING DFHEIV0,
  9440           ERCOMP-FILE-ID,
  9441           COMPENSATION-MASTER,
  9442           DFHEIV11,
  9443           DFHEIV99
  9444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9445
  9446
  9447 6100-READ-CONTROL-FILE.
  9448     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  9449     MOVE +0                     TO ELCNTL-SEQ-NO.
  9450
  9451     MOVE SPACES                 TO WS-CF-ZIP.
  9452
  9453
  9454* EXEC CICS HANDLE CONDITION
  9455*        NOTFND   (6110-NO-RECORD)
  9456*    END-EXEC.
  9457*    MOVE '"$I                   ! / #00008888' TO DFHEIV0
  9458     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9459     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9460     MOVE X'2F20233030303038383838' TO DFHEIV0(25:11)
  9461     CALL 'kxdfhei1' USING DFHEIV0
  9462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9463
  9464
  9465     IF NOT ELCNTL-UPDATE
  9466
  9467* EXEC CICS READ
  9468*            DATASET (ELCNTL-FILE-ID)
  9469*            SET     (ADDRESS OF CONTROL-FILE)
  9470*            RIDFLD  (ELCNTL-KEY)
  9471*        END-EXEC
  9472*    MOVE '&"S        E          (   #00008893' TO DFHEIV0
  9473     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9474     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9475     MOVE X'2020233030303038383933' TO DFHEIV0(25:11)
  9476     CALL 'kxdfhei1' USING DFHEIV0,
  9477           ELCNTL-FILE-ID,
  9478           DFHEIV20,
  9479           DFHEIV99,
  9480           ELCNTL-KEY,
  9481           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 191
* EL640.cbl
  9482           DFHEIV99,
  9483           DFHEIV99
  9484     SET ADDRESS OF CONTROL-FILE TO
  9485         DFHEIV20
  9486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9487     ELSE
  9488         MOVE SPACE              TO ELCNTL-UPDATE-SW
  9489
  9490* EXEC CICS READ
  9491*            DATASET (ELCNTL-FILE-ID)
  9492*            SET     (ADDRESS OF CONTROL-FILE)
  9493*            RIDFLD  (ELCNTL-KEY)
  9494*            UPDATE
  9495*        END-EXEC.
  9496*    MOVE '&"S        EU         (   #00008900' TO DFHEIV0
  9497     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9498     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9499     MOVE X'2020233030303038393030' TO DFHEIV0(25:11)
  9500     CALL 'kxdfhei1' USING DFHEIV0,
  9501           ELCNTL-FILE-ID,
  9502           DFHEIV20,
  9503           DFHEIV99,
  9504           ELCNTL-KEY,
  9505           DFHEIV99,
  9506           DFHEIV99,
  9507           DFHEIV99
  9508     SET ADDRESS OF CONTROL-FILE TO
  9509         DFHEIV20
  9510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9511
  9512
  9513     IF CF-ZIP-CODE-NUM NOT NUMERIC
  9514         MOVE ZEROS              TO CF-ZIP-CODE-NUM.
  9515
  9516     IF CF-ZIP-CODE-NUM NOT = ZEROS
  9517         MOVE CF-ZIP-CODE-NUM    TO WORK-ZIP
  9518         IF WORK-ZIPR1-4 = ZEROS
  9519             MOVE WORK-ZIPR1-5   TO WORK-ZIPR2-5
  9520             MOVE ZEROS          TO WORK-ZIPR2-4
  9521             MOVE WORK-ZIP       TO CF-ZIP-CODE
  9522         ELSE
  9523             MOVE WORK-ZIP       TO CF-ZIP-CODE.
  9524
  9525     IF CF-CANADIAN-POST-CODE
  9526         MOVE CF-CAN-POSTAL-1    TO WS-CF-CAN-POST-1
  9527         MOVE CF-CAN-POSTAL-2    TO WS-CF-CAN-POST-2
  9528     ELSE
  9529         MOVE CF-ZIP-PRIME       TO WS-CF-ZIP-PRIME
  9530         IF CF-ZIP-PLUS4 NOT = ZEROS  AND  SPACES
  9531             MOVE '-'            TO WS-CF-ZIP-DASH
  9532             MOVE CF-ZIP-PLUS4   TO WS-CF-ZIP-PLUS4.
  9533
  9534     GO TO 6120-EXIT.
  9535
  9536 6110-NO-RECORD.
  9537     IF ELCNTL-REC-TYPE = 1
  9538         MOVE ER-0022            TO EMI-ERROR
  9539     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 192
* EL640.cbl
  9540         MOVE ER-2208            TO EMI-ERROR
  9541         MOVE -1                 TO ACARIERL
  9542         MOVE AL-UABON           TO ACARIERA
  9543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9544
  9545 6120-EXIT.
  9546     EXIT.
  9547 6130-FIND-BENEFIT-CD.
  9548
  9549* EXEC CICS READ
  9550*       DATASET (ELCNTL-FILE-ID)
  9551*       SET     (ADDRESS OF CONTROL-FILE)
  9552*       RIDFLD  (ELCNTL-KEY)
  9553*       GTEQ
  9554*       RESP    (WS-RESPONSE)
  9555*    END-EXEC
  9556*    MOVE '&"S        G          (  N#00008942' TO DFHEIV0
  9557     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9558     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9559     MOVE X'204E233030303038393432' TO DFHEIV0(25:11)
  9560     CALL 'kxdfhei1' USING DFHEIV0,
  9561           ELCNTL-FILE-ID,
  9562           DFHEIV20,
  9563           DFHEIV99,
  9564           ELCNTL-KEY,
  9565           DFHEIV99,
  9566           DFHEIV99,
  9567           DFHEIV99
  9568     SET ADDRESS OF CONTROL-FILE TO
  9569         DFHEIV20
  9570     MOVE EIBRESP  TO WS-RESPONSE
  9571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9572     IF RESP-NORMAL
  9573        IF (CF-COMPANY-ID = PI-COMPANY-ID)
  9574           AND (CF-RECORD-TYPE = '5')
  9575           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  9576              (S1 > +8)
  9577              OR (CF-BENEFIT-CODE (S1) = CLAS-LOOK)
  9578           END-PERFORM
  9579           IF S1 NOT > +8
  9580              MOVE CF-BENEFIT-CATEGORY (S1)
  9581                                 TO WS-AH-CATEGORY
  9582              GO TO 6140-EXIT
  9583           END-IF
  9584        END-IF
  9585     END-IF
  9586     .
  9587 6140-NO-RECORD.
  9588     MOVE ER-2208                TO EMI-ERROR
  9589     MOVE -1                     TO ACARIERL
  9590     MOVE AL-UABON               TO ACARIERA
  9591     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  9592     .
  9593 6140-EXIT.
  9594     EXIT.
  9595 6200-REWRITE-CONTROL-FILE.
  9596
  9597
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 193
* EL640.cbl
  9598* EXEC CICS REWRITE
  9599*        DATASET (ELCNTL-FILE-ID)
  9600*        FROM    (CONTROL-FILE)
  9601*    END-EXEC.
  9602     MOVE LENGTH OF
  9603      CONTROL-FILE
  9604       TO DFHEIV11
  9605*    MOVE '&& L                  %   #00008974' TO DFHEIV0
  9606     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9607     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9608     MOVE X'2020233030303038393734' TO DFHEIV0(25:11)
  9609     CALL 'kxdfhei1' USING DFHEIV0,
  9610           ELCNTL-FILE-ID,
  9611           CONTROL-FILE,
  9612           DFHEIV11,
  9613           DFHEIV99
  9614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9615
  9616
  9617 6290-EXIT.
  9618     EXIT.
  9619
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 194
* EL640.cbl
  9621 6300-ELIMINATE-LINE-SPACES.
  9622     IF WS-REMIT-LINES (1) = SPACES
  9623         MOVE WS-REMIT-LINES (2)  TO WS-REMIT-LINES (1)
  9624         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9625         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9626         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9627         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9628         MOVE SPACES              TO WS-REMIT-LINES (6)
  9629         GO TO 6300-ELIMINATE-LINE-SPACES.
  9630
  9631     IF WS-REMIT-LINES (2) = SPACES AND
  9632        WS-REMIT-LINES (3) = SPACES AND
  9633        WS-REMIT-LINES (4) = SPACES AND
  9634        WS-REMIT-LINES (5) = SPACES AND
  9635        WS-REMIT-LINES (6) = SPACES
  9636          GO TO 6350-MOVE-ZIP.
  9637
  9638     IF WS-REMIT-LINES (2) = SPACES
  9639         MOVE WS-REMIT-LINES (3)  TO WS-REMIT-LINES (2)
  9640         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9641         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9642         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9643         MOVE SPACES              TO WS-REMIT-LINES (6)
  9644         GO TO 6300-ELIMINATE-LINE-SPACES.
  9645
  9646     IF WS-REMIT-LINES (3) = SPACES AND
  9647        WS-REMIT-LINES (4) = SPACES AND
  9648        WS-REMIT-LINES (5) = SPACES AND
  9649        WS-REMIT-LINES (6) = SPACES
  9650          GO TO 6350-MOVE-ZIP.
  9651
  9652     IF WS-REMIT-LINES (3) = SPACES
  9653         MOVE WS-REMIT-LINES (4)  TO WS-REMIT-LINES (3)
  9654         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9655         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9656         MOVE SPACES              TO WS-REMIT-LINES (6)
  9657         GO TO 6300-ELIMINATE-LINE-SPACES.
  9658
  9659     IF WS-REMIT-LINES (4) = SPACES AND
  9660        WS-REMIT-LINES (5) = SPACES AND
  9661        WS-REMIT-LINES (6) = SPACES
  9662          GO TO 6350-MOVE-ZIP.
  9663
  9664     IF WS-REMIT-LINES (4) = SPACES
  9665         MOVE WS-REMIT-LINES (5)  TO WS-REMIT-LINES (4)
  9666         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9667         MOVE SPACES              TO WS-REMIT-LINES (6)
  9668         GO TO 6300-ELIMINATE-LINE-SPACES.
  9669
  9670     IF WS-REMIT-LINES (5) = SPACES
  9671         MOVE WS-REMIT-LINES (6)  TO WS-REMIT-LINES (5)
  9672         MOVE SPACES              TO WS-REMIT-LINES (6).
  9673
  9674 6350-MOVE-ZIP.
  9675     IF WS-REMIT-LINES (6) NOT = SPACES
  9676         MOVE WS-REMIT-ZIP (6)        TO WS-R-LAST-ZIP (5)
  9677         MOVE SPACES                  TO WS-REMIT-LINES (6)
  9678     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 195
* EL640.cbl
  9679         IF WS-REMIT-LINES (5) NOT = SPACES
  9680             MOVE WS-REMIT-ZIP (5)     TO WS-R-LAST-ZIP (5)
  9681             MOVE SPACES               TO WS-REMIT-ZIP (5)
  9682         ELSE
  9683             IF WS-REMIT-LINES (4) NOT = SPACES
  9684                 MOVE WS-REMIT-ZIP (4) TO WS-R-LAST-ZIP (4)
  9685                 MOVE SPACES           TO WS-REMIT-ZIP (4).
  9686
  9687 6390-EXIT.
  9688     EXIT.
  9689
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 196
* EL640.cbl
  9691 6400-FORMAT-ACCOUNT-ADDRS.
  9692     IF WS-ACCT-ADDR-AREA = SPACES
  9693         GO TO 6490-EXIT.
  9694
  9695     IF WS-ACCT-LINES (1) = SPACES
  9696         MOVE WS-ACCT-LINES (2)  TO WS-ACCT-LINES (1)
  9697         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
  9698         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9699         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9700         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9701         MOVE SPACES              TO WS-ACCT-LINES (6)
  9702         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9703
  9704     IF WS-ACCT-LINES (2) = SPACES AND
  9705        WS-ACCT-LINES (3) = SPACES AND
  9706        WS-ACCT-LINES (4) = SPACES AND
  9707        WS-ACCT-LINES (5) = SPACES AND
  9708        WS-ACCT-LINES (6) = SPACES
  9709          GO TO 6450-MOVE-ZIP.
  9710
  9711     IF WS-ACCT-LINES (2) = SPACES
  9712         MOVE WS-ACCT-LINES (3)  TO WS-ACCT-LINES (2)
  9713         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9714         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9715         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9716         MOVE SPACES             TO WS-ACCT-LINES (6)
  9717         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9718
  9719     IF WS-ACCT-LINES (3) = SPACES AND
  9720        WS-ACCT-LINES (4) = SPACES AND
  9721        WS-ACCT-LINES (5) = SPACES AND
  9722        WS-ACCT-LINES (6) = SPACES
  9723          GO TO 6450-MOVE-ZIP.
  9724
  9725     IF WS-ACCT-LINES (3) = SPACES
  9726         MOVE WS-ACCT-LINES (4)  TO WS-ACCT-LINES (3)
  9727         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9728         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9729         MOVE SPACES             TO WS-ACCT-LINES (6)
  9730         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9731
  9732     IF WS-ACCT-LINES (4) = SPACES AND
  9733        WS-ACCT-LINES (5) = SPACES AND
  9734        WS-ACCT-LINES (6) = SPACES
  9735          GO TO 6450-MOVE-ZIP.
  9736
  9737     IF WS-ACCT-LINES (4) = SPACES
  9738         MOVE WS-ACCT-LINES (5)  TO WS-ACCT-LINES (4)
  9739         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9740         MOVE SPACES             TO WS-ACCT-LINES (6)
  9741         GO TO 6400-FORMAT-ACCOUNT-ADDRS.
  9742
  9743     IF WS-ACCT-LINES (5) = SPACES
  9744         MOVE WS-ACCT-LINES (6)  TO WS-ACCT-LINES (5)
  9745         MOVE SPACES             TO WS-ACCT-LINES (6).
  9746
  9747 6450-MOVE-ZIP.
  9748     IF WS-ACCT-LINES (6) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 197
* EL640.cbl
  9749         MOVE WS-ACCT-ZIP (6)         TO WS-A-LAST-ZIP (5)
  9750         MOVE SPACES                  TO WS-ACCT-LINES (6)
  9751     ELSE
  9752         IF WS-ACCT-LINES (5) NOT = SPACES
  9753             MOVE WS-ACCT-ZIP (5)      TO WS-A-LAST-ZIP (5)
  9754             MOVE SPACES               TO WS-ACCT-ZIP (5)
  9755         ELSE
  9756             IF WS-ACCT-LINES (4) NOT = SPACES
  9757                 MOVE WS-ACCT-ZIP (4)  TO WS-A-LAST-ZIP (4)
  9758                 MOVE SPACES           TO WS-ACCT-ZIP (4).
  9759
  9760 6490-EXIT.
  9761     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 198
* EL640.cbl
  9763 7000-PROCESS-CHECK.
  9764*                *******************************************
  9765*                *    FORMAT THE CHECK SCREEN (EL640D)     *
  9766*                *******************************************
  9767     MOVE LOW-VALUES             TO EL640BO.
  9768
  9769     IF PI-SAV-ACCT = PI-SAV-REMIT-TO
  9770         PERFORM 4300-READ-ACCOUNT-MASTER THRU 4390-EXIT
  9771         IF EMI-ERROR = ZEROS
  9772             MOVE AM-NAME        TO BNAMEO
  9773             MOVE AM-PERSON      TO BADDR1O
  9774             MOVE AM-ADDRS       TO BADDR2O
  9775*            MOVE AM-CITY        TO BCITYSTO
  9776             STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  9777                DELIMITED BY '  ' INTO BCITYSTO
  9778             END-STRING
  9779             MOVE WS-AM-ZIP      TO BZIPO
  9780         ELSE
  9781             MOVE EL640A         TO PI-MAP-NAME
  9782             MOVE -1             TO BPFNTERL
  9783             GO TO 8200-SEND-DATAONLY
  9784     ELSE
  9785         PERFORM 6000-READ-COMP-MASTER THRU 6090-EXIT
  9786         IF EMI-ERROR = ZEROS
  9787             MOVE CO-ACCT-NAME   TO BNAMEO
  9788             MOVE CO-ADDR-1      TO BADDR1O
  9789             MOVE CO-ADDR-2      TO BADDR2O
  9790*            MOVE CO-ADDR-3      TO BCITYSTO
  9791             STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  9792                DELIMITED BY '  ' INTO BCITYSTO
  9793             END-STRING
  9794             MOVE WS-CO-ZIP      TO BZIPO
  9795         ELSE
  9796             MOVE EL640A         TO PI-MAP-NAME
  9797             MOVE -1             TO BPFNTERL
  9798             GO TO 8200-SEND-DATAONLY.
  9799
  9800     MOVE AL-UNNON               TO BCHKAMTA.
  9801     MOVE PI-ACCT-NAME           TO BACCNAMO.
  9802     MOVE PI-SAV-ACCT            TO BACCTO.
  9803     MOVE PI-COMP-CARRIER        TO BCARIERO.
  9804     MOVE PI-COMP-GROUPING       TO BGROUPO.
  9805     MOVE PI-SAV-STATE           TO BSTATEO.
  9806     MOVE PI-MONTH-END-DATE      TO BPAYDT2O
  9807                                    WS-BEGIN-DATE.
  9808     MOVE '01'                   TO WS-BEGIN-DAY.
  9809     MOVE WS-BEGIN-DATE          TO BPAYDT1O.
  9810     MOVE -1                     TO BCHKNOL
  9811
  9812     IF WS-ENTERED-FROM-A
  9813         COMPUTE WORK-CHECK-AMT = PI-END-BAL * -1
  9814         MOVE WORK-CHECK-AMT     TO BCHKAMTO
  9815     ELSE
  9816         MOVE WORK-CHECK-AMT     TO BCHKAMTO.
  9817
  9818     IF WORK-CHECK-AMT NOT > ZEROS
  9819         MOVE ER-3165    TO  EMI-ERROR
  9820         MOVE -1         TO  BCHKAMTL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 199
* EL640.cbl
  9821         MOVE AL-UNBON   TO  BCHKAMTA
  9822         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9823
  9824     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 200
* EL640.cbl
  9826
  9827 7500-PRODUCE-CHECK.
  9828*                *******************************************
  9829*                *   PRODUCES A CHECK FOR LATER PRINTING   *
  9830*                *******************************************
  9831     MOVE SPACES                 TO ELCNTL-KEY.
  9832     MOVE '1'                    TO ELCNTL-REC-TYPE.
  9833     MOVE 'Y'                    TO ELCNTL-UPDATE-SW.
  9834     PERFORM 6100-READ-CONTROL-FILE THRU 6120-EXIT.
  9835
  9836     IF EMI-ERROR NOT = ZEROS
  9837         GO TO 8200-SEND-DATAONLY.
  9838
  9839     IF CR-CHECK-NO-AUTO-SEQ
  9840         IF CR-CHECK-CNT-RESET-VALUE
  9841             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
  9842             MOVE +1             TO CF-CR-CHECK-COUNTER
  9843             MOVE 6              TO BCHKNOL
  9844         ELSE
  9845             MOVE CF-CR-CHECK-COUNTER TO BCHKNOI
  9846             MOVE 6              TO BCHKNOL
  9847             ADD +1              TO CF-CR-CHECK-COUNTER.
  9848
  9849     IF CR-CHECK-NO-MANUAL
  9850         IF BCHKNOL = ZEROS
  9851             MOVE ER-2438        TO EMI-ERROR
  9852             MOVE -1             TO BCHKNOL
  9853             MOVE AL-UNBON       TO BCHKNOA
  9854             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9855             GO TO 8200-SEND-DATAONLY
  9856         ELSE
  9857             IF BCHKNOI NOT NUMERIC
  9858                 MOVE ER-2439    TO EMI-ERROR
  9859                 MOVE -1         TO BCHKNOL
  9860                 MOVE AL-UNBON   TO BCHKNOA
  9861                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9862                 GO TO 8200-SEND-DATAONLY.
  9863
  9864     PERFORM 7600-CHECK-FORMS THRU 7600-EXIT.
  9865
  9866
  9867* EXEC CICS GETMAIN
  9868*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  9869*        LENGTH  (ERPYAJ-LENGTH)
  9870*        INITIMG (GETMAIN-SPACE)
  9871*    END-EXEC.
  9872*    MOVE ',"IL                  $   #00009228' TO DFHEIV0
  9873     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9874     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9875     MOVE X'2020233030303039323238' TO DFHEIV0(25:11)
  9876     CALL 'kxdfhei1' USING DFHEIV0,
  9877           DFHEIV20,
  9878           ERPYAJ-LENGTH,
  9879           GETMAIN-SPACE
  9880     SET ADDRESS OF PENDING-PAY-ADJ TO
  9881         DFHEIV20
  9882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9883
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 201
* EL640.cbl
  9884
  9885
  9886* EXEC CICS BIF DEEDIT
  9887*        FIELD  (BCHKAMTI)
  9888*        LENGTH (11)
  9889*    END-EXEC.
  9890     MOVE 11
  9891       TO DFHEIV11
  9892*    MOVE '@"L                   #   #00009234' TO DFHEIV0
  9893     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9894     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9895     MOVE X'2020233030303039323334' TO DFHEIV0(25:11)
  9896     CALL 'kxdfhei1' USING DFHEIV0,
  9897           BCHKAMTI,
  9898           DFHEIV11
  9899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9900
  9901
  9902     IF BCHKAMTI NOT > ZEROS
  9903         MOVE ER-3165    TO  EMI-ERROR
  9904         MOVE -1         TO  BCHKAMTL
  9905         MOVE AL-UNBON   TO  BCHKAMTA
  9906         MOVE BCHKAMTI   TO  BCHKAMTO
  9907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9908         GO TO 8200-SEND-DATAONLY.
  9909
  9910     MOVE 'Y'                    TO PI-CHECK-SW.
  9911     MOVE 'PY'                   TO PY-RECORD-ID.
  9912     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  9913     MOVE PI-COMP-CARRIER        TO PY-CARRIER.
  9914     MOVE PI-COMP-GROUPING       TO PY-GROUPING.
  9915     MOVE PI-SAV-REMIT-TO        TO PY-FIN-RESP.
  9916     MOVE PI-SAV-ACCT            TO PY-ACCOUNT.
  9917     MOVE 'C'                    TO PY-RECORD-TYPE.
  9918     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  9919
  9920     IF PI-COMPANY-ID = CLIENT-ITY
  9921        MOVE PI-MONTH-END-DATE   TO WS-PY-END-DT
  9922                                    WS-BEGIN-DATE
  9923        MOVE '01'                TO WS-BEGIN-DAY
  9924        MOVE WS-BEGIN-DATE       TO WS-PY-BEGIN-DT
  9925        MOVE WS-ITY-COMMENT      TO PY-ENTRY-COMMENT
  9926     ELSE
  9927        MOVE WS-CURRENT-DATE-MDY TO WS-PY-CURRENT-DATE
  9928        MOVE WS-PY-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  9929
  9930     MOVE BCHKAMTI               TO PY-ENTRY-AMT.
  9931     ADD BCHKAMTI TO PI-DISBURSED.
  9932     MOVE BFORM1I                TO PY-LETTER (1).
  9933     MOVE BFORM2I                TO PY-LETTER (2).
  9934     MOVE BFORM3I                TO PY-LETTER (3).
  9935
  9936     IF NOT CR-CHECK-NO-AT-PRINT
  9937         MOVE BCHKNOI            TO PY-CHECK-NUMBER.
  9938
  9939     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  9940     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  9941     MOVE WS-CURRENT-DATE        TO PY-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 202
* EL640.cbl
  9942                                    PY-INPUT-DT.
  9943     IF PI-BILL OR PI-REBILLING
  9944         MOVE DC-BIN-DATE-1      TO PY-BILLED-DATE
  9945     ELSE
  9946         MOVE LOW-VALUES         TO PY-BILLED-DATE
  9947                                    PY-AR-DATE.
  9948
  9949     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  9950                                    PY-CHECK-QUE-SEQUENCE.
  9951     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  9952                                    PY-REPORTED-DT
  9953                                    PY-CHECK-WRITTEN-DT.
  9954     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  9955     MOVE 'B'                    TO PY-CHECK-ORIGIN-SW.
  9956
  9957
  9958* EXEC CICS WRITE
  9959*        DATASET (ERPYAJ-FILE-ID)
  9960*        FROM    (PENDING-PAY-ADJ)
  9961*        RIDFLD  (PY-CONTROL-PRIMARY)
  9962*    END-EXEC.
  9963     MOVE LENGTH OF
  9964      PENDING-PAY-ADJ
  9965       TO DFHEIV11
  9966*    MOVE '&$ L                  ''   #00009294' TO DFHEIV0
  9967     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9968     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9969     MOVE X'2020233030303039323934' TO DFHEIV0(25:11)
  9970     CALL 'kxdfhei1' USING DFHEIV0,
  9971           ERPYAJ-FILE-ID,
  9972           PENDING-PAY-ADJ,
  9973           DFHEIV11,
  9974           PY-CONTROL-PRIMARY,
  9975           DFHEIV99,
  9976           DFHEIV99
  9977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9978
  9979
  9980     IF CR-CHECK-NO-AUTO-SEQ
  9981         PERFORM 6200-REWRITE-CONTROL-FILE THRU 6290-EXIT
  9982     ELSE
  9983
  9984* EXEC CICS UNLOCK
  9985*            DATASET (ELCNTL-FILE-ID)
  9986*        END-EXEC.
  9987*    MOVE '&*                    #   #00009303' TO DFHEIV0
  9988     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9989     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9990     MOVE X'2020233030303039333033' TO DFHEIV0(25:11)
  9991     CALL 'kxdfhei1' USING DFHEIV0,
  9992           ELCNTL-FILE-ID,
  9993           DFHEIV99
  9994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9995
  9996
  9997     MOVE EL640A                 TO PI-MAP-NAME.
  9998     PERFORM 5000-FORMAT-SCREEN THRU 5090-EXIT.
  9999     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 203
* EL640.cbl
 10000
 10001 7600-CHECK-FORMS.
 10002
 10003     IF BFORM1L NOT = ZEROS
 10004             AND
 10005        BFORM1I NOT = SPACES
 10006         MOVE BFORM1I            TO ELLETR-FORM-NO
 10007         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10008         IF W-LETTER-NOT-FOUND
 10009             MOVE ER-7389        TO EMI-ERROR
 10010             MOVE -1             TO BFORM1L
 10011             MOVE AL-UABON       TO BFORM1A
 10012             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10013             GO TO 8200-SEND-DATAONLY.
 10014
 10015     IF BFORM2L NOT = ZEROS
 10016             AND
 10017        BFORM2I NOT = SPACES
 10018         MOVE BFORM2I            TO ELLETR-FORM-NO
 10019         PERFORM 7620-CHECK-ON-LETTER THRU 7620-EXIT
 10020
 10021         IF W-LETTER-NOT-FOUND
 10022             MOVE ER-7389        TO EMI-ERROR
 10023             MOVE -1             TO BFORM2L
 10024             MOVE AL-UABON       TO BFORM2A
 10025             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10026             GO TO 8200-SEND-DATAONLY.
 10027
 10028     IF BFORM3L NOT = ZEROS
 10029             AND
 10030        BFORM3I NOT = SPACES
 10031         MOVE BFORM3I            TO ELLETR-FORM-NO
 10032         IF  W-LETTER-NOT-FOUND
 10033             MOVE ER-7389        TO EMI-ERROR
 10034             MOVE -1             TO BFORM3L
 10035             MOVE AL-UABON       TO BFORM3A
 10036             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10037             GO TO 8200-SEND-DATAONLY.
 10038
 10039     IF BFORM1L = ZEROS
 10040         IF BFORM2L NOT = ZEROS
 10041             MOVE BFORM2L        TO BFORM1L
 10042             MOVE BFORM3L        TO BFORM2L
 10043             MOVE BFORM2A        TO BFORM1A
 10044             MOVE BFORM3A        TO BFORM2A
 10045             MOVE BFORM2I        TO BFORM1I
 10046             MOVE BFORM3I        TO BFORM2I
 10047             MOVE LOW-VALUES     TO BFORM3I
 10048                                    BFORM3A
 10049             MOVE ZEROS          TO BFORM3L
 10050         ELSE
 10051             IF BFORM3L NOT = ZEROS
 10052                 MOVE BFORM3L    TO BFORM1L
 10053                 MOVE BFORM3I    TO BFORM1I
 10054                 MOVE BFORM3A    TO BFORM1A
 10055                 MOVE LOW-VALUES TO BFORM3I
 10056                                    BFORM3A
 10057                 MOVE ZEROS      TO BFORM3L
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 204
* EL640.cbl
 10058             ELSE
 10059                 NEXT SENTENCE
 10060     ELSE
 10061         IF BFORM2L = ZEROS
 10062             IF BFORM3L NOT = ZEROS
 10063                 MOVE BFORM3L    TO BFORM2L
 10064                 MOVE BFORM3I    TO BFORM2I
 10065                 MOVE BFORM3A    TO BFORM2A
 10066                 MOVE LOW-VALUES TO BFORM3I
 10067                                    BFORM3A
 10068                 MOVE ZEROS      TO BFORM3L.
 10069
 10070 7600-EXIT.
 10071      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 205
* EL640.cbl
 10073 7620-CHECK-ON-LETTER.
 10074
 10075     MOVE SPACES                 TO W-LETTER-IND.
 10076
 10077     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD.
 10078     MOVE +1                     TO ELLETR-LINE-SEQ.
 10079
 10080
 10081* EXEC CICS HANDLE CONDITION
 10082*        NOTFND   (7620-LETR-NOT-FOUND)
 10083*        ENDFILE  (7620-LETR-NOT-FOUND)
 10084*        NOTOPEN  (7620-LETR-NOT-OPEN)
 10085*    END-EXEC.
 10086*    MOVE '"$I''J                 ! 0 #00009390' TO DFHEIV0
 10087     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10088     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10089     MOVE X'3020233030303039333930' TO DFHEIV0(25:11)
 10090     CALL 'kxdfhei1' USING DFHEIV0
 10091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10092
 10093
 10094
 10095* EXEC CICS READ
 10096*        SET     (ADDRESS OF TEXT-FILES)
 10097*        DATASET (ELLETR-FILE-ID)
 10098*        RIDFLD  (ELLETR-KEY)
 10099*    END-EXEC.
 10100*    MOVE '&"S        E          (   #00009396' TO DFHEIV0
 10101     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10102     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10103     MOVE X'2020233030303039333936' TO DFHEIV0(25:11)
 10104     CALL 'kxdfhei1' USING DFHEIV0,
 10105           ELLETR-FILE-ID,
 10106           DFHEIV20,
 10107           DFHEIV99,
 10108           ELLETR-KEY,
 10109           DFHEIV99,
 10110           DFHEIV99,
 10111           DFHEIV99
 10112     SET ADDRESS OF TEXT-FILES TO
 10113         DFHEIV20
 10114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10115
 10116
 10117     GO TO 7620-EXIT.
 10118
 10119 7620-LETR-NOT-FOUND.
 10120
 10121     MOVE 'Y'                    TO W-LETTER-IND.
 10122     GO TO 7620-EXIT.
 10123
 10124 7620-LETR-NOT-OPEN.
 10125
 10126     MOVE ER-0013                TO EMI-ERROR.
 10127     MOVE -1                     TO BFORM1L.
 10128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10129     GO TO 8200-SEND-DATAONLY.
 10130
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 206
* EL640.cbl
 10131 7620-EXIT.
 10132      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 207
* EL640.cbl
 10134 8100-SEND-INITIAL-MAP.
 10135
 10136     MOVE SPACES TO PI-TRANSFER-SW.
 10137
 10138     IF PI-MAP-NAME = EL640A
 10139         NEXT SENTENCE
 10140     ELSE
 10141         GO TO 8110-SEND-INITIAL-CHECK-MAP.
 10142
 10143     IF PI-COMPANY-ID = 'DMD'
 10144        MOVE AL-SADOF            TO APF5HDGA.
 10145
 10146     IF NOT PI-GA-BILLING
 10147        MOVE AL-SADOF            TO AGAHDGA.
 10148
 10149     MOVE WS-CURRENT-DATE-EDIT   TO ADATEO.
 10150     MOVE EIBTIME                TO TIME-IN.
 10151     MOVE TIME-OUT               TO ATIMEO.
 10152     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10153     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10154
 10155     MOVE -1                     TO AACCTL.
 10156     MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O.
 10157     MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O.
 10158
 10159     IF CARR-GROUP-ST-ACCNT-CNTL
 10160         NEXT SENTENCE
 10161     ELSE
 10162         IF ST-ACCNT-CNTL
 10163             MOVE AL-SADOF       TO ACARHDGA
 10164                                    AGRPHDGA
 10165             MOVE AL-SANOF       TO ACARIERA
 10166                                    AGROUPA
 10167         ELSE
 10168             IF CARR-ST-ACCNT-CNTL
 10169                 MOVE AL-SADOF   TO AGRPHDGA
 10170                 MOVE AL-SANOF   TO AGROUPA
 10171             ELSE
 10172                 IF ACCNT-CNTL
 10173                     MOVE AL-SADOF TO ACARHDGA
 10174                                      AGRPHDGA
 10175                                      ASTHDGA
 10176                     MOVE AL-SANOF TO ACARIERA
 10177                                      AGROUPA
 10178                                      ASTATEA
 10179                 ELSE
 10180                     IF CARR-ACCNT-CNTL
 10181                         MOVE AL-SADOF TO AGRPHDGA
 10182                                          ASTHDGA
 10183                         MOVE AL-SANOF TO AGROUPA
 10184                                          ASTATEA.
 10185
 10186     IF (EIBTRNID = EL633-TRANS-ID  OR  EL635-TRANS-ID  OR
 10187                    EL633DMD-TRANS-ID  OR
 10188                    EL650-TRANS-ID  OR  EL652-TRANS-ID  OR
 10189                    EL658-TRANS-ID)  AND
 10190          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10191        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 208
* EL640.cbl
 10192        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10193        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10194        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10195        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10196        IF CARR-GROUP-ST-ACCNT-CNTL
 10197            MOVE AL-UANON        TO ACARIERA
 10198                                    AGROUPA
 10199                                    ASTATEA
 10200                                    AACCTA
 10201            MOVE WT-CR-CARRIER   TO ACARIERI
 10202                                    PI-SCR-CARRIER
 10203            MOVE WT-CR-GROUPING  TO AGROUPI
 10204                                    PI-SCR-GROUPING
 10205            MOVE WT-CR-ACCOUNT   TO AACCTI
 10206                                    PI-SCR-ACCOUNT
 10207            MOVE 1               TO ACARIERL
 10208            MOVE 6               TO AGROUPL
 10209            MOVE 10              TO AACCTL
 10210            MOVE -1              TO ASTATEL
 10211        ELSE
 10212         IF ST-ACCNT-CNTL
 10213            MOVE AL-UANON        TO ASTATEA
 10214                                    AACCTA
 10215            MOVE WT-CR-ACCOUNT   TO AACCTI
 10216                                    PI-SCR-ACCOUNT
 10217            MOVE 10              TO AACCTL
 10218            MOVE -1              TO ASTATEL
 10219         ELSE
 10220            IF CARR-ST-ACCNT-CNTL
 10221                MOVE AL-UANON       TO ACARIERA
 10222                                       ASTATEA
 10223                                       AACCTA
 10224                MOVE WT-CR-CARRIER TO ACARIERI
 10225                                      PI-SCR-CARRIER
 10226                MOVE WT-CR-ACCOUNT TO AACCTI
 10227                                      PI-SCR-ACCOUNT
 10228                MOVE 1              TO ACARIERL
 10229                MOVE 10             TO AACCTL
 10230                MOVE -1             TO ASTATEL
 10231            ELSE
 10232                IF ACCNT-CNTL
 10233                    MOVE AL-UANON       TO AACCTA
 10234                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10235                                           PI-SCR-ACCOUNT
 10236                    MOVE 10             TO AACCTL
 10237                    MOVE -1             TO ABILTYPL
 10238                ELSE
 10239                    IF CARR-ACCNT-CNTL
 10240                        MOVE AL-UANON        TO ACARIERA
 10241                                                AACCTA
 10242                        MOVE WT-CR-CARRIER   TO ACARIERI
 10243                                                PI-SCR-CARRIER
 10244                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10245                                                PI-SCR-ACCOUNT
 10246                        MOVE 1               TO ACARIERL
 10247                        MOVE 10              TO AACCTL
 10248                        MOVE -1              TO ABILTYPL.
 10249
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 209
* EL640.cbl
 10250     IF (EIBTRNID = EL6311-TRANS-ID) AND
 10251          (WT-CR-ACCOUNT NOT = SPACES AND LOW-VALUES)
 10252        MOVE WT-CR-CARRIER       TO PI-SCR-CARRIER
 10253        MOVE WT-CR-GROUPING      TO PI-SCR-GROUPING
 10254        MOVE WT-CR-STATE         TO PI-SCR-STATE
 10255        MOVE WT-CR-FIN-RESP      TO PI-SCR-FIN-RESP
 10256        MOVE WT-CR-TYPE          TO PI-SCR-TYPE
 10257        MOVE SPACES              TO PI-SAV-CARR
 10258                                    PI-SAV-GROUP
 10259                                    PI-SAV-STATE
 10260                                    PI-SAV-ACCT
 10261        MOVE LOW-VALUES          TO PI-SAV-EXP-DT
 10262        IF CARR-GROUP-ST-ACCNT-CNTL
 10263            MOVE AL-UANON        TO ACARIERA
 10264                                    AGROUPA
 10265                                    ASTATEA
 10266                                    AACCTA
 10267            MOVE WT-CR-CARRIER   TO ACARIERI
 10268                                    PI-SCR-CARRIER
 10269                                    PI-SAV-CARR
 10270            MOVE WT-CR-GROUPING  TO AGROUPI
 10271                                    PI-SCR-GROUPING
 10272                                    PI-SAV-GROUP
 10273            MOVE WT-CR-STATE     TO ASTATEI
 10274                                    PI-SCR-STATE
 10275            MOVE WT-CR-ACCOUNT   TO AACCTI
 10276                                    PI-SCR-ACCOUNT
 10277            MOVE 1               TO ACARIERL
 10278            MOVE 6               TO AGROUPL
 10279            MOVE 10              TO AACCTL
 10280            MOVE 2               TO ASTATEL
 10281            MOVE -1              TO ABILTYPL
 10282        ELSE
 10283         IF ST-ACCNT-CNTL
 10284            MOVE AL-UANON        TO ASTATEA
 10285                                    AACCTA
 10286            MOVE WT-CR-STATE     TO ASTATEI
 10287                                    PI-SCR-STATE
 10288                                    PI-SAV-STATE
 10289            MOVE WT-CR-ACCOUNT   TO AACCTI
 10290                                    PI-SCR-ACCOUNT
 10291                                    PI-SAV-ACCT
 10292            MOVE 10              TO AACCTL
 10293            MOVE -1              TO ASTATEL
 10294         ELSE
 10295            IF CARR-ST-ACCNT-CNTL
 10296                MOVE AL-UANON      TO ACARIERA
 10297                                      ASTATEA
 10298                                      AACCTA
 10299                MOVE WT-CR-CARRIER TO ACARIERI
 10300                                      PI-SCR-CARRIER
 10301                                      PI-SAV-CARR
 10302                MOVE WT-CR-STATE   TO ASTATEI
 10303                                      PI-SCR-STATE
 10304                                      PI-SAV-STATE
 10305                MOVE WT-CR-ACCOUNT TO AACCTI
 10306                                      PI-SCR-ACCOUNT
 10307                                      PI-SAV-ACCT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 210
* EL640.cbl
 10308                MOVE 1             TO ACARIERL
 10309                MOVE 10            TO AACCTL
 10310                MOVE 2             TO ASTATEL
 10311                MOVE -1            TO ABILTYPL
 10312            ELSE
 10313                IF ACCNT-CNTL
 10314                    MOVE AL-UANON       TO AACCTA
 10315                    MOVE WT-CR-ACCOUNT  TO AACCTI
 10316                                           PI-SCR-ACCOUNT
 10317                                           PI-SAV-ACCT
 10318                    MOVE 10             TO AACCTL
 10319                    MOVE -1             TO ABILTYPL
 10320                ELSE
 10321                    IF CARR-ACCNT-CNTL
 10322                        MOVE AL-UANON        TO ACARIERA
 10323                                                AACCTA
 10324                        MOVE WT-CR-CARRIER   TO ACARIERI
 10325                                                PI-SCR-CARRIER
 10326                                                PI-SAV-CARR
 10327                        MOVE WT-CR-ACCOUNT   TO AACCTI
 10328                                                PI-SCR-ACCOUNT
 10329                                                PI-SAV-ACCT
 10330                        MOVE 1               TO ACARIERL
 10331                        MOVE 10              TO AACCTL
 10332                        MOVE -1              TO ABILTYPL.
 10333
 10334
 10335* EXEC CICS SEND
 10336*        MAP      (PI-MAP-NAME)
 10337*        MAPSET   (MAPSET-NAME)
 10338*        FROM     (EL640AO)
 10339*        ERASE
 10340*        CURSOR
 10341*    END-EXEC.
 10342     MOVE LENGTH OF
 10343      EL640AO
 10344       TO DFHEIV12
 10345     MOVE -1
 10346       TO DFHEIV11
 10347*    MOVE '8$     CT  E    H L F ,   #00009619' TO DFHEIV0
 10348     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10349     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10350     MOVE X'2020233030303039363139' TO DFHEIV0(25:11)
 10351     CALL 'kxdfhei1' USING DFHEIV0,
 10352           PI-MAP-NAME,
 10353           EL640AO,
 10354           DFHEIV12,
 10355           MAPSET-NAME,
 10356           DFHEIV99,
 10357           DFHEIV99,
 10358           DFHEIV99,
 10359           DFHEIV11,
 10360           DFHEIV99,
 10361           DFHEIV99,
 10362           DFHEIV99
 10363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10364
 10365
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 211
* EL640.cbl
 10366     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 212
* EL640.cbl
 10368 8110-SEND-INITIAL-CHECK-MAP.
 10369     MOVE WS-CURRENT-DATE-EDIT   TO BDATEO.
 10370     MOVE EIBTIME                TO TIME-IN.
 10371     MOVE TIME-OUT               TO BTIMEO.
 10372     MOVE PI-COMPANY-ID          TO BCMPNYO.
 10373     MOVE PI-PROCESSOR-ID        TO BUSERIDO.
 10374     MOVE -1                     TO BPFNTERL.
 10375     MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO.
 10376
 10377
 10378* EXEC CICS SEND
 10379*        MAP      (PI-MAP-NAME)
 10380*        MAPSET   (MAPSET-NAME)
 10381*        FROM     (EL640BO)
 10382*        ERASE
 10383*        CURSOR
 10384*    END-EXEC.
 10385     MOVE LENGTH OF
 10386      EL640BO
 10387       TO DFHEIV12
 10388     MOVE -1
 10389       TO DFHEIV11
 10390*    MOVE '8$     CT  E    H L F ,   #00009638' TO DFHEIV0
 10391     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10392     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10393     MOVE X'2020233030303039363338' TO DFHEIV0(25:11)
 10394     CALL 'kxdfhei1' USING DFHEIV0,
 10395           PI-MAP-NAME,
 10396           EL640BO,
 10397           DFHEIV12,
 10398           MAPSET-NAME,
 10399           DFHEIV99,
 10400           DFHEIV99,
 10401           DFHEIV99,
 10402           DFHEIV11,
 10403           DFHEIV99,
 10404           DFHEIV99,
 10405           DFHEIV99
 10406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10407
 10408
 10409     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 213
* EL640.cbl
 10411 8200-SEND-DATAONLY.
 10412     IF PI-MAP-NAME = EL640A
 10413         MOVE WS-CURRENT-DATE-EDIT   TO ADATEO
 10414         MOVE EIBTIME                TO TIME-IN
 10415         MOVE TIME-OUT               TO ATIMEO
 10416         MOVE PI-COMPANY-ID          TO CMPNYIDO
 10417         MOVE PI-PROCESSOR-ID        TO USERIDO
 10418         MOVE EMI-MESSAGE-AREA (1)   TO AERMSG1O
 10419         MOVE EMI-MESSAGE-AREA (2)   TO AERMSG2O
 10420
 10421* EXEC CICS SEND
 10422*            MAP      (PI-MAP-NAME)
 10423*            MAPSET   (MAPSET-NAME)
 10424*            FROM     (EL640AO)
 10425*            DATAONLY
 10426*            ERASEAUP
 10427*            CURSOR
 10428*        END-EXEC
 10429     MOVE LENGTH OF
 10430      EL640AO
 10431       TO DFHEIV12
 10432     MOVE -1
 10433       TO DFHEIV11
 10434*    MOVE '8$D    CT  A    H L F ,   #00009657' TO DFHEIV0
 10435     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10436     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10437     MOVE X'2020233030303039363537' TO DFHEIV0(25:11)
 10438     CALL 'kxdfhei1' USING DFHEIV0,
 10439           PI-MAP-NAME,
 10440           EL640AO,
 10441           DFHEIV12,
 10442           MAPSET-NAME,
 10443           DFHEIV99,
 10444           DFHEIV99,
 10445           DFHEIV99,
 10446           DFHEIV11,
 10447           DFHEIV99,
 10448           DFHEIV99,
 10449           DFHEIV99
 10450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10451     ELSE
 10452         MOVE WS-CURRENT-DATE-EDIT   TO BDATEO
 10453         MOVE EIBTIME                TO TIME-IN
 10454         MOVE TIME-OUT               TO BTIMEO
 10455         MOVE PI-COMPANY-ID          TO BCMPNYO
 10456         MOVE PI-PROCESSOR-ID        TO BUSERIDO
 10457         MOVE EMI-MESSAGE-AREA (1)   TO BERMSGO
 10458
 10459* EXEC CICS SEND
 10460*            MAP      (PI-MAP-NAME)
 10461*            MAPSET   (MAPSET-NAME)
 10462*            FROM     (EL640BO)
 10463*            DATAONLY
 10464*            ERASEAUP
 10465*            CURSOR
 10466*        END-EXEC.
 10467     MOVE LENGTH OF
 10468      EL640BO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 214
* EL640.cbl
 10469       TO DFHEIV12
 10470     MOVE -1
 10471       TO DFHEIV11
 10472*    MOVE '8$D    CT  A    H L F ,   #00009672' TO DFHEIV0
 10473     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 10474     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10475     MOVE X'2020233030303039363732' TO DFHEIV0(25:11)
 10476     CALL 'kxdfhei1' USING DFHEIV0,
 10477           PI-MAP-NAME,
 10478           EL640BO,
 10479           DFHEIV12,
 10480           MAPSET-NAME,
 10481           DFHEIV99,
 10482           DFHEIV99,
 10483           DFHEIV99,
 10484           DFHEIV11,
 10485           DFHEIV99,
 10486           DFHEIV99,
 10487           DFHEIV99
 10488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10489
 10490
 10491     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 215
* EL640.cbl
 10493 8300-SEND-TEXT.
 10494
 10495* EXEC CICS SEND TEXT
 10496*        FROM     (LOGOFF-TEXT)
 10497*        LENGTH   (LOGOFF-LENGTH)
 10498*        ERASE
 10499*        FREEKB
 10500*    END-EXEC.
 10501*    MOVE '8&      T  E F  H   F -   #00009684' TO DFHEIV0
 10502     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10503     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10504     MOVE X'2020233030303039363834' TO DFHEIV0(25:11)
 10505     CALL 'kxdfhei1' USING DFHEIV0,
 10506           LOGOFF-TEXT,
 10507           LOGOFF-LENGTH,
 10508           DFHEIV99,
 10509           DFHEIV99,
 10510           DFHEIV99,
 10511           DFHEIV99,
 10512           DFHEIV99,
 10513           DFHEIV99,
 10514           DFHEIV99,
 10515           DFHEIV99,
 10516           DFHEIV99,
 10517           DFHEIV99
 10518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10519
 10520
 10521
 10522* EXEC CICS RETURN
 10523*    END-EXEC.
 10524*    MOVE '.(                    &   #00009691' TO DFHEIV0
 10525     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10526     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10527     MOVE X'2020233030303039363931' TO DFHEIV0(25:11)
 10528     CALL 'kxdfhei1' USING DFHEIV0,
 10529           DFHEIV99,
 10530           DFHEIV99,
 10531           DFHEIV99,
 10532           DFHEIV99,
 10533           DFHEIV99
 10534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10535
 10536
 10537 8500-DATE-CONVERT.
 10538
 10539* EXEC CICS LINK
 10540*        PROGRAM  (LINK-ELDATCV)
 10541*        COMMAREA (DATE-CONVERSION-DATA)
 10542*        LENGTH   (DC-COMM-LENGTH)
 10543*    END-EXEC.
 10544*    MOVE '."C                   ''   #00009695' TO DFHEIV0
 10545     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10546     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10547     MOVE X'2020233030303039363935' TO DFHEIV0(25:11)
 10548     CALL 'kxdfhei1' USING DFHEIV0,
 10549           LINK-ELDATCV,
 10550           DATE-CONVERSION-DATA,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 216
* EL640.cbl
 10551           DC-COMM-LENGTH,
 10552           DFHEIV99,
 10553           DFHEIV99,
 10554           DFHEIV99
 10555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10556
 10557
 10558 8500-EXIT.
 10559     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 217
* EL640.cbl
 10561 8800-UNAUTHORIZED-ACCESS.
 10562     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10563     GO TO 8300-SEND-TEXT.
 10564
 10565 8810-PF23.
 10566     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10567     MOVE XCTL-005               TO PGM-NAME.
 10568     GO TO 9300-XCTL.
 10569
 10570 8900-SYNCPOINT-ROLLBACK.
 10571
 10572* EXEC CICS SYNCPOINT
 10573*         ROLLBACK
 10574*    END-EXEC.
 10575*    MOVE '6"R                   !   #00009714' TO DFHEIV0
 10576     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10578     MOVE X'2020233030303039373134' TO DFHEIV0(25:11)
 10579     CALL 'kxdfhei1' USING DFHEIV0
 10580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10581
 10582
 10583 8900-EXIT.
 10584     EXIT.
 10585
 10586 9100-RETURN-TRAN.
 10587     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10588     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10589
 10590
 10591* EXEC CICS RETURN
 10592*        TRANSID    (TRANS-ID)
 10593*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10594*        LENGTH     (PI-COMM-LENGTH)
 10595*    END-EXEC.
 10596*    MOVE '.(CT                  &   #00009725' TO DFHEIV0
 10597     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10598     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10599     MOVE X'2020233030303039373235' TO DFHEIV0(25:11)
 10600     CALL 'kxdfhei1' USING DFHEIV0,
 10601           TRANS-ID,
 10602           PROGRAM-INTERFACE-BLOCK,
 10603           PI-COMM-LENGTH,
 10604           DFHEIV99,
 10605           DFHEIV99
 10606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10607
 10608
 10609 9200-RETURN-MAIN-MENU.
 10610     MOVE XCTL-626               TO PGM-NAME.
 10611     GO TO 9300-XCTL.
 10612
 10613 9300-XCTL.
 10614
 10615* EXEC CICS XCTL
 10616*        PROGRAM    (PGM-NAME)
 10617*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10618*        LENGTH     (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 218
* EL640.cbl
 10619*    END-EXEC.
 10620*    MOVE '.$C                   $   #00009736' TO DFHEIV0
 10621     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10622     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10623     MOVE X'2020233030303039373336' TO DFHEIV0(25:11)
 10624     CALL 'kxdfhei1' USING DFHEIV0,
 10625           PGM-NAME,
 10626           PROGRAM-INTERFACE-BLOCK,
 10627           PI-COMM-LENGTH
 10628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10629
 10630
 10631 9400-CLEAR.
 10632     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
 10633     GO TO 9300-XCTL.
 10634
 10635 9500-PF12.
 10636     MOVE XCTL-010               TO PGM-NAME.
 10637     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 219
* EL640.cbl
 10639 9600-PGMID-ERROR.
 10640
 10641* EXEC CICS HANDLE CONDITION
 10642*        PGMIDERR    (8300-SEND-TEXT)
 10643*    END-EXEC.
 10644*    MOVE '"$L                   ! 1 #00009751' TO DFHEIV0
 10645     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10647     MOVE X'3120233030303039373531' TO DFHEIV0(25:11)
 10648     CALL 'kxdfhei1' USING DFHEIV0
 10649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10650
 10651
 10652     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10653     MOVE ' '                    TO PI-ENTRY-CD-1.
 10654     MOVE XCTL-005               TO PGM-NAME.
 10655     MOVE PGM-NAME               TO LOGOFF-PGM.
 10656     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 10657     GO TO 9300-XCTL.
 10658
 10659 9900-ERROR-FORMAT.
 10660     IF NOT EMI-ERRORS-COMPLETE
 10661         MOVE LINK-001           TO PGM-NAME
 10662
 10663* EXEC CICS LINK
 10664*            PROGRAM    (PGM-NAME)
 10665*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10666*            LENGTH     (EMI-COMM-LENGTH)
 10667*        END-EXEC.
 10668*    MOVE '."C                   ''   #00009765' TO DFHEIV0
 10669     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10670     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10671     MOVE X'2020233030303039373635' TO DFHEIV0(25:11)
 10672     CALL 'kxdfhei1' USING DFHEIV0,
 10673           PGM-NAME,
 10674           ERROR-MESSAGE-INTERFACE-BLOCK,
 10675           EMI-COMM-LENGTH,
 10676           DFHEIV99,
 10677           DFHEIV99,
 10678           DFHEIV99
 10679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10680
 10681
 10682 9900-EXIT.
 10683     EXIT.
 10684
 10685 9990-ABEND.
 10686     MOVE LINK-004               TO PGM-NAME.
 10687     MOVE DFHEIBLK               TO EMI-LINE1.
 10688
 10689
 10690* EXEC CICS LINK
 10691*        PROGRAM   (PGM-NAME)
 10692*        COMMAREA  (EMI-LINE1)
 10693*        LENGTH    (72)
 10694*    END-EXEC.
 10695     MOVE 72
 10696       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 220
* EL640.cbl
 10697*    MOVE '."C                   ''   #00009778' TO DFHEIV0
 10698     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10699     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10700     MOVE X'2020233030303039373738' TO DFHEIV0(25:11)
 10701     CALL 'kxdfhei1' USING DFHEIV0,
 10702           PGM-NAME,
 10703           EMI-LINE1,
 10704           DFHEIV11,
 10705           DFHEIV99,
 10706           DFHEIV99,
 10707           DFHEIV99
 10708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10709
 10710
 10711     IF PI-MAP-NAME = EL640A
 10712         MOVE -1 TO APFNTERL
 10713     ELSE
 10714         MOVE -1 TO BPFNTERL.
 10715
 10716     GO TO 8200-SEND-DATAONLY.
 10717
 10718 9995-SECURITY-VIOLATION.
 10719*                            COPY ELCSCTP.
 10720******************************************************************
 10721*                                                                *
 10722*                            ELCSCTP                             *
 10723*                            VMOD=2.001                          *
 10724*                                                                *
 10725*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10726******************************************************************
 10727
 10728
 10729     MOVE EIBDATE          TO SM-JUL-DATE.
 10730     MOVE EIBTRMID         TO SM-TERMID.
 10731     MOVE THIS-PGM         TO SM-PGM.
 10732     MOVE EIBTIME          TO TIME-IN.
 10733     MOVE TIME-OUT         TO SM-TIME.
 10734     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10735
 10736
 10737* EXEC CICS LINK
 10738*         PROGRAM  ('EL003')
 10739*         COMMAREA (SECURITY-MESSAGE)
 10740*         LENGTH   (80)
 10741*    END-EXEC.
 10742     MOVE 'EL003' TO DFHEIV1
 10743     MOVE 80
 10744       TO DFHEIV11
 10745*    MOVE '."C                   ''   #00009809' TO DFHEIV0
 10746     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10747     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10748     MOVE X'2020233030303039383039' TO DFHEIV0(25:11)
 10749     CALL 'kxdfhei1' USING DFHEIV0,
 10750           DFHEIV1,
 10751           SECURITY-MESSAGE,
 10752           DFHEIV11,
 10753           DFHEIV99,
 10754           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 221
* EL640.cbl
 10755           DFHEIV99
 10756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10757
 10758
 10759******************************************************************
 10760
 10761
 10762
 10763 9999-DFHBACK SECTION.
 10764     MOVE '9%                    "   ' TO DFHEIV0
 10765     MOVE 'EL640' TO DFHEIV1
 10766     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10767     GOBACK.
 10768 9999-DFHEXIT.
 10769     IF DFHEIGDJ EQUAL 0001
 10770         NEXT SENTENCE
 10771     ELSE IF DFHEIGDJ EQUAL 2
 10772         GO TO 9600-PGMID-ERROR,
 10773               9990-ABEND
 10774         DEPENDING ON DFHEIGDI
 10775     ELSE IF DFHEIGDJ EQUAL 3
 10776         GO TO 0890-EXIT
 10777         DEPENDING ON DFHEIGDI
 10778     ELSE IF DFHEIGDJ EQUAL 4
 10779         GO TO 3930-BILL-NOTFND,
 10780               3930-BILL-NOTOPEN
 10781         DEPENDING ON DFHEIGDI
 10782     ELSE IF DFHEIGDJ EQUAL 5
 10783         GO TO 3940-EXIT
 10784         DEPENDING ON DFHEIGDI
 10785     ELSE IF DFHEIGDJ EQUAL 6
 10786         GO TO 4010-REC-NOT-FND
 10787         DEPENDING ON DFHEIGDI
 10788     ELSE IF DFHEIGDJ EQUAL 7
 10789         GO TO 4110-END-OF-FILE
 10790         DEPENDING ON DFHEIGDI
 10791     ELSE IF DFHEIGDJ EQUAL 8
 10792         GO TO 4270-PNDB-NOTFIND,
 10793               4280-PNDB-FILE-NOTOPEN
 10794         DEPENDING ON DFHEIGDI
 10795     ELSE IF DFHEIGDJ EQUAL 9
 10796         GO TO 4370-ACCOUNT-INVALID,
 10797               4380-ACCT-FILE-NOTOPEN
 10798         DEPENDING ON DFHEIGDI
 10799     ELSE IF DFHEIGDJ EQUAL 10
 10800         GO TO 4470-ACCOUNT-INVALID,
 10801               4480-ACCT-FILE-NOTOPEN
 10802         DEPENDING ON DFHEIGDI
 10803     ELSE IF DFHEIGDJ EQUAL 11
 10804         GO TO 4510-REC-NOT-FND
 10805         DEPENDING ON DFHEIGDI
 10806     ELSE IF DFHEIGDJ EQUAL 12
 10807         GO TO 4610-END-OF-FILE
 10808         DEPENDING ON DFHEIGDI
 10809     ELSE IF DFHEIGDJ EQUAL 13
 10810         GO TO 6070-NO-COMP-MSTR,
 10811               6080-COMP-FILE-NOTOPEN
 10812         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:39 Page 222
* EL640.cbl
 10813     ELSE IF DFHEIGDJ EQUAL 14
 10814         GO TO 6045-NO-COMP-MSTR,
 10815               6045-COMP-FILE-NOTOPEN
 10816         DEPENDING ON DFHEIGDI
 10817     ELSE IF DFHEIGDJ EQUAL 15
 10818         GO TO 6110-NO-RECORD
 10819         DEPENDING ON DFHEIGDI
 10820     ELSE IF DFHEIGDJ EQUAL 16
 10821         GO TO 7620-LETR-NOT-FOUND,
 10822               7620-LETR-NOT-FOUND,
 10823               7620-LETR-NOT-OPEN
 10824         DEPENDING ON DFHEIGDI
 10825     ELSE IF DFHEIGDJ EQUAL 17
 10826         GO TO 8300-SEND-TEXT
 10827         DEPENDING ON DFHEIGDI.
 10828     MOVE '9%                    "   ' TO DFHEIV0
 10829     MOVE 'EL640' TO DFHEIV1
 10830     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10831     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        8572     Code:       35424
