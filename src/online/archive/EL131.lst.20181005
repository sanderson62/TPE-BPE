* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33* 080613    2013071600001  PEMA  ALLOW INC DTE CHANGE
    34* 082013    2013040900001  AJRA  ADD PF15 BENEFICIARY MAINT
    35* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    36* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    37* 040814    2014030500002  AJRA  ADD ICD CODES
    38* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    39* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    40* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    41* 031715  CR2015022700002  PEMA  CHECK CHG IN DIAGNOSIS
    42* 031815    2015021700001  TANA  BENE EDIT IF A PAYMENT PENDING
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 040617  CR2017022200003  TANA  INCREASE CHG INC DT TO 180 DAYS
    45* 062217  CR2017050300002  TANA  ADD AUTH RCVD FIELD
    46* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    47* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    48* 021418  CR2017110200001  TANA  EDIT NAME CHANGE AGST INSRD TYPE
    49* 052918  CR2018031500002  TANA  Add Message for filing time limit
    50* 061418  IR2018053000003  TANA  Fix Causal state / filing limit
    51******************************************************************
    52
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page   3
* EL131.cbl
    54 ENVIRONMENT DIVISION.
    55
    56 DATA DIVISION.
    57
    58 WORKING-STORAGE SECTION.
    59 01  DFH-START PIC X(04).
    60
    61 77  FILLER  PIC X(32)  VALUE '********************************'.
    62 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    63 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    64 77  s1                          pic s999 comp-3 value+0.
    65 77  s2                          pic s999 comp-3 value+0.
    66 77  a1                          pic s999 comp-3 value+0.
    67 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    68 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    69 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    70 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    71 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    72 77  ws-max-extension            pic s999 comp-3 value +0.
    73 77  ws-max-moben                pic s9(7)v99 comp-3 value +0.
    74 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    75 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    76     88  ERPDEF-FOUND                 VALUE 'Y'.
    77 77  WS-TRLR-FILE-EOF            PIC X     VALUE ' '.
    78     88  TRLR-FILE-EOF                VALUE 'Y'.
    79 77  WS-PAYMENT-PENDING          PIC X     VALUE ' '.
    80     88  PAYMENT-PENDING              VALUE 'Y'.
    81 77  WS-AUTH-RCVD                PIC X     VALUE ' '.
    82     88  AUTH-RCVD                    VALUE 'Y'.
    83     88  NO-AUTH-RCVD                 VALUE 'N'.
    84 77  ws-eracct-sw                pic x  value ' '.
    85     88  acct-found                value 'Y'.
    86 77  ws-benper-sw                pic x   value ' '.
    87     88  good-benper               value 'Y'.
    88 77  ws-claim-type               pic x value ' '.
    89 77  ws-ben-per                  pic 99 value 00.
    90 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    91 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    92 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    93 77  ws-max-bens                 pic s9(5) comp-3 value +0.
    94
    95 01  LCP-TIME-OF-DAY-XX.
    96     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    97     05  FILLER                    PIC 99.
    98 01  LCP-CICS-TIME                 PIC 9(15).
    99*                            COPY ELCSCTM.
   100******************************************************************
   101*                                                                *
   102*                                                                *
   103*                            ELCSCTM                             *
   104*                            VMOD=2.001                          *
   105*                                                                *
   106*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   107*                                                                *
   108******************************************************************
   109 01  SECURITY-MESSAGE.
   110     12  FILLER                          PIC X(30)
   111            VALUE '** LOGIC SECURITY VIOLATION -'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page   4
* EL131.cbl
   112     12  SM-READ                         PIC X(6).
   113     12  FILLER                          PIC X(5)
   114            VALUE ' PGM='.
   115     12  SM-PGM                          PIC X(6).
   116     12  FILLER                          PIC X(5)
   117            VALUE ' OPR='.
   118     12  SM-PROCESSOR-ID                 PIC X(4).
   119     12  FILLER                          PIC X(6)
   120            VALUE ' TERM='.
   121     12  SM-TERMID                       PIC X(4).
   122     12  FILLER                          PIC XX   VALUE SPACE.
   123     12  SM-JUL-DATE                     PIC 9(5).
   124     12  FILLER                          PIC X    VALUE SPACE.
   125     12  SM-TIME                         PIC 99.99.
   126
   127
   128*                            COPY ELCSCRTY.
   129******************************************************************
   130*                                                                *
   131*                                                                *
   132*                            ELCSCRTY                            *
   133*                            VMOD=2.001                          *
   134*                                                                *
   135*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   136*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   137*        SAVED IN PI-SECURITY-ADDRESS.                           *
   138*                                                                *
   139******************************************************************
   140 01  SECURITY-CONTROL.
   141     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   142     12  FILLER                       PIC XX    VALUE 'SC'.
   143     12  SC-CREDIT-CODES.
   144         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   145             20  SC-CREDIT-DISPLAY    PIC X.
   146             20  SC-CREDIT-UPDATE     PIC X.
   147     12  SC-CLAIMS-CODES.
   148         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   149             20  SC-CLAIMS-DISPLAY    PIC X.
   150             20  SC-CLAIMS-UPDATE     PIC X.
   151
   152*                            COPY ELCNWA.
   153*****************************************************************
   154*                                                               *
   155*                                                               *
   156*                            ELCNWA.                            *
   157*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   158*                            VMOD=2.003                         *
   159*                                                               *
   160*            M O V E   N A M E   W O R K   A R E A.             *
   161*                                                               *
   162*****************************************************************.
   163
   164 01  WS-NAME-WORK-AREA.
   165     05  WS-INSURED-LAST-NAME        PIC X(15).
   166     05  WS-INSURED-1ST-NAME         PIC X(12).
   167     05  WS-INSURED-MID-INIT         PIC X.
   168
   169     05  WS-NAME-WORK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page   5
* EL131.cbl
   170         10  WS-NW                   PIC X
   171             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   172
   173     05  WS-NAME-WORK2.
   174         10  WS-NW2                  PIC X
   175             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   176                                        NWA-INDEX0.
   177
   178     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   179                                     COMP-3.
   180
   181
   182 01  ws-dcc-error-line.
   183     05  filler occurs 15.
   184         10  ws-error-no        pic x(4).
   185 01  WS-DATE-AREA.
   186     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   187     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
   188     12  SAVE-DATE-CCYYMMDD.
   189         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   190         16  SAVE-DATE-YMD.
   191             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   192             20  FILLER         PIC X(4)    VALUE SPACES.
   193
   194 01  WS-BLANK                   PIC X       VALUE ' '.
   195
   196 01  CSO-WORK-FIELDS.
   197     05  WS-HOLD-CLAIM-STATUS    PIC X.
   198     05  WS-CRIT-PER-RECURRENT   PIC 99    VALUE 00.
   199     05  WS-CRIT-PER-ALPHA REDEFINES WS-CRIT-PER-RECURRENT.
   200         10  WS-RECURRENT-YN     PIC X.
   201         10  FILLER              PIC X.
   202
   203 01  LITERALS-NUMBERS.
   204     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   205     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   206     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   207     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   208     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   209     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   210     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   211     12  MAP-LENGTH              PIC S9(4)   VALUE +1060  COMP.
   212
   213     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   214     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   215     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   216     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   217     12  XCTL-EL114              PIC X(8)    VALUE 'EL114'.
   218     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   219     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   220     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   221     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   222     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   223
   224     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   225
   226     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   227
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page   6
* EL131.cbl
   228     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   229     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   230     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   231     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   232     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   233     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   234     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   235     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   236     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   237     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   238     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   239     12  WS-CONTEST-NOTE      PIC X(44)
   240         VALUE 'CONTRACT NOW CONTESTABLE - INC/RPT DT CHGD'.
   241     12  WS-FILE-LIM-NOTE     PIC X(44)
   242         VALUE 'FILING TIME LIMIT OK - INCRD DT CHGD'.
   243
   244     12  WS-FILING-NOTE     PIC X(30)
   245         VALUE 'FILING TIME LIMIT EXCEEDED'.
   246
   247     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   248     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   249     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   250     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   251         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   252     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   253     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   254     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   255     12  WS-ICD-CODE-1           PIC X(8).
   256     12  WS-ICD-CODE-2           PIC X(8).
   257     12  WS-CLAIM-SEQU.
   258         16  FILLER              PIC X VALUE '('.
   259         16  WS-CURRENT-SEQU     PIC Z9.
   260         16  FILLER              PIC X(04) VALUE ' OF '.
   261         16  WS-OF-SEQU          PIC Z9.
   262         16  FILLER              PIC X VALUE ')'.
   263     12  WS-EDIT-BEN-CODE        PIC XX.
   264         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   265                                          '90' THRU '99'.
   266
   267     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   268     12  WS-EDIT-NUMBER          PIC ZZZ9.
   269
   270     12  WS-RESPONSE             PIC S9(8)   COMP.
   271         88  WS-RESP-NORMAL              VALUE +00.
   272         88  WS-RESP-ERROR               VALUE +01.
   273         88  WS-RESP-NOTFND              VALUE +13.
   274         88  WS-RESP-DUPKEY              VALUE +15.
   275         88  WS-RESP-NOTOPEN             VALUE +19.
   276         88  WS-RESP-ENDFILE             VALUE +20.
   277
   278     12  WS-MOS-PAID             PIC 999.
   279     12  WS-ODD-DAYS             PIC 99.
   280     12  WS-REM-MOS              PIC 999.
   281     12  WS-REM-DAYS             PIC 99.
   282     12  WS-TERM-IN-DAYS         PIC 9(4).
   283     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   284
   285     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page   7
* EL131.cbl
   286     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   287     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   288     12  WS-RESET-SW             PIC X       VALUE 'N'.
   289     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   290     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   291     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   292
   293 01  DMD-DATE-YYYYMMDD.
   294     12  DMD-DECADE          PIC XX      VALUE SPACES.
   295     12  DMD-YYMMDD.
   296         16  DMD-YY          PIC XX      VALUE SPACES.
   297         16  DMD-MM          PIC XX      VALUE SPACES.
   298         16  DMD-DD          PIC XX      VALUE SPACES.
   299
   300 01  DMD-DATE-MMDDYYYY.
   301     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   302     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   303     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   304     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   305     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   306     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   307
   308 01  WS-MAIL-CODE.
   309     12  FILLER              PIC X.
   310     12  DMD-MAIL-CODE.
   311         16  WS-MAIL-4       PIC X(4).
   312         16  WS-MAIL-5       PIC X.
   313     12  FILLER              PIC X(4).
   314
   315     12  W-NAME-LAST             PIC  X(15).
   316     12  W-NAME-FIRST            PIC  X(15).
   317     12  W-NAME-MIDDLE.
   318         16  FILLER              PIC  X.
   319         16  W-NAME-MIDDLE-2     PIC  X.
   320         16  FILLER              PIC  X(13).
   321
   322*    COPY ELCDCTB.
   323******************************************************************
   324*                                                                *
   325*                                                                *
   326*                            ELCDCTB.                            *
   327*                            VMOD=2.002                          *
   328*                                                                *
   329*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   330*       COMMUNICATIONS AREA                                      *
   331*                                                                *
   332******************************************************************
   333 01  DCT-COMMUNICATION-AREA.
   334     12  DCT-BILLING-BANK-ID      PIC  X(05).
   335     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   336     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   337     12  DCT-PRODUCT-CODE         PIC  X(02).
   338     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   339     12  DCT-RETURN-CODE          PIC  X(02).
   340     12  DCT-MAIL-CODE            PIC  X(05).
   341     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   342     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page   8
* EL131.cbl
   344 01  ERROR-SWITCHES.
   345     12  ERROR-SWITCH            PIC X.
   346         88  SCREEN-ERROR                    VALUE 'X'.
   347     12  MSTR-KEY-SWITCH         PIC X.
   348         88  MSTR-KEY-CHANGED                VALUE 'X'.
   349     12  CERT-KEY-SWITCH         PIC X.
   350*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   351         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   352*********SET TO Y IF PRIMARY KEY WILL CHANGE
   353         88  CERT-KEY-CHANGED                VALUE 'Y'.
   354     12  MSTR-SWITCH             PIC X.
   355         88  MSTR-UPDATES                    VALUE 'X'.
   356     12  crtt-switch             pic x value spaces.
   357         88  crtt-update             value 'X'.
   358     12  CERT-SWITCH             PIC X.
   359         88  CERT-UPDATES                    VALUE 'X'.
   360     12  UPDATE-SWITCH           PIC X.
   361         88  UPDATES-PRESENT                 VALUE 'X'.
   362     12  TRLR-SWITCH             PIC X.
   363         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   364         88  UPDATE-MADE                     VALUE 'Y'.
   365     12  NINETY-TRLR-SWITCH      PIC X.
   366         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   367     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   368         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   369     12  EARNINGS-CALC-SWITCH    PIC X.
   370         88  TEX-REG                         VALUE '4'.
   371         88  NET-PAY                         VALUE '5'.
   372     12  DLYACTV-SW              PIC X       VALUE 'N'.
   373         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page   9
* EL131.cbl
   375 01  EDIT-WORK-AREA.
   376     12  COUNT-2                 PIC 9.
   377     12  CALL-PGM                PIC X(8).
   378     12  TRANS-ID                PIC X(4).
   379     12  CHECK-PFKEYS            PIC 99.
   380     12  CHECK-MAINT             PIC X.
   381         88  ADD-ALPHA-RECORD                VALUE 'A'.
   382         88  CHANGE-CLAIM                    VALUE 'C'.
   383         88  DELETE-CLAIM                    VALUE 'D'.
   384         88  CHANGE-NAME                     VALUE 'N'.
   385         88  VALID-OPTIONS                   VALUE 'A' 'C'
   386                                                   'D' 'N'.
   387
   388     12  HOLD-BENEFIT            PIC XX.
   389     12  HOLD-FREQ               PIC XX.
   390     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   391     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   392     12  HOLD-PDTHRU             PIC XX.
   393     12  HOLD-ADDON              PIC XX.
   394     12  HOLD-NODAYS             PIC 9(4).
   395     12  HOLD-NOPMTS             PIC 9(3).
   396     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   397     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   398     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   399     12  HOLD-BIRTH              PIC XX.
   400     12  HOLD-END                PIC XX.
   401     12  HOLD-EFF                PIC XX.
   402     12  HOLD-ENTRY              PIC XX.
   403     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   404     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   405     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   406     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   407     12  HOLD-LF-CV-CAN          PIC XX.
   408     12  HOLD-AH-CV-CAN          PIC XX.
   409     12  DIVIDE-QUOT             PIC 9(3).
   410     12  DIVIDE-REM              PIC 9(3).
   411
   412     12  WS-ALPHA-DATE.
   413         16  WS-ALPHA-YEAR.
   414             20  WS-ALPHA-YY-1   PIC 99.
   415             20  WS-ALPHA-YY-2   PIC 99.
   416         16  WS-ALPHA-MM         PIC 99.
   417         16  WS-ALPHA-DD         PIC 99.
   418
   419     12  BUILD-VALID-DATE.
   420         16  BUILD-MONTH         PIC 99.
   421         16  BUILD-DAY           PIC 99.
   422         16  BUILD-YEAR          PIC 99.
   423     12  DEEDIT-MMYY-INPUT.
   424         16  FILLER              PIC X.
   425         16  DEEDIT-MONTH        PIC XX.
   426         16  DEEDIT-YEAR         PIC XX.
   427     12  DEEDIT-BEN              PIC 9(9)V99.
   428     12  DEEDIT-DATE-INPUT.
   429         16  FILLER              PIC XX.
   430         16  DEEDIT-DATE         PIC X(6).
   431     12  WORK-DATE-MDY.
   432         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  10
* EL131.cbl
   433         16  FILLER              PIC X(4).
   434         16  YEAR-WORK           PIC XX.
   435     12  WORK-DATE-MY.
   436         16  WORK-MONTH          PIC XX.
   437         16  WORK-SLASH          PIC X       VALUE '/'.
   438         16  WORK-YEAR           PIC XX.
   439     12  HOLD-DATE.
   440         16  HOLD-MONTH          PIC 99.
   441         16  FILLER              PIC X(4).
   442         16  HOLD-YEAR           PIC 99.
   443     12  SPLIT-INFO-LINE-1.
   444         16  SPLIT-INFO-DESC     PIC X(15).
   445         16  FILLER              PIC X(5)    VALUE ' OLD='.
   446         16  SPLIT-INFO-OLD      PIC X(40).
   447     12  EFF-TERM-MO             PIC 9(4).
   448     12  CURR-MO                 PIC 9(4).
   449     12  WS-BIN-CURRENT-DT       PIC XX.
   450     12  WS-CALC-METHOD          PIC X.
   451     12  WS-INITIALS.
   452         16  WS-INIT-1           PIC X.
   453         16  WS-INIT-2           PIC X.
   454     12  WS-REIN-TABLE.
   455         16  WS-REIN-1           PIC X.
   456         16  WS-REIN-2           PIC X.
   457         16  WS-REIN-3           PIC X.
   458     12  PI-KEY.
   459         16  PI-TERM             PIC X(4).
   460         16  PI-QUAL             PIC X(4).
   461     12  CHECK-KEY               PIC X(20).
   462     12  SAVE-ACCT-KEY           PIC X(20).
   463     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   464     12  WS-SOC-SEC-NUMBER.
   465         16  WS-SOC-SEC-NO       PIC 9(9).
   466         16  WS-SOC-SEC-BLANK    PIC X(2).
   467     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   468         16  WS-SSN-1-3          PIC 9(3).
   469         16  WS-SSN-DASH1        PIC X(1).
   470         16  WS-SSN-4-5          PIC 9(2).
   471         16  WS-SSN-DASH2        PIC X(1).
   472         16  WS-SSN-6-9          PIC 9(4).
   473     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   474     12  WS-RETURNED-FROM        PIC X(8)  VALUE SPACES.
   475
   476 01  WS-SAVE-FIELDS.
   477     12  WS-SAVE-BENEFICIARY     PIC X(10) VALUE LOW-VALUES.
   478     12  WS-SAVE-MAINTI          PIC X(1) VALUE LOW-VALUES.
   479     12  WS-SAVE-MAINTL          PIC S9(4) COMP VALUE +0.
   480     12  WS-SAVE-STATUSI         PIC X(6) VALUE LOW-VALUES.
   481     12  WS-SAVE-STATUSL         PIC S9(4) COMP VALUE +0.
   482     12  WS-SAVE-REPI            PIC X(8) VALUE LOW-VALUES.
   483     12  WS-SAVE-REPL            PIC S9(4) COMP VALUE +0.
   484     12  WS-SAVE-CAUSEI          PIC X(6) VALUE LOW-VALUES.
   485     12  WS-SAVE-CAUSEL          PIC S9(4) COMP VALUE +0.
   486     12  WS-SAVE-ENDI            PIC X(8) VALUE LOW-VALUES.
   487     12  WS-SAVE-ENDL            PIC S9(4) COMP VALUE +0.
   488     12  WS-SAVE-DIAGI           PIC X(60) VALUE LOW-VALUES.
   489     12  WS-SAVE-DIAGL           PIC S9(4) COMP VALUE +0.
   490     12  WS-SAVE-ICD1I           PIC X(8)  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  11
* EL131.cbl
   491     12  WS-SAVE-ICD1L           PIC S9(4) COMP VALUE +0.
   492     12  WS-SAVE-ICD2I           PIC X(8)  VALUE LOW-VALUES.
   493     12  WS-SAVE-ICD2L           PIC S9(4) COMP VALUE +0.
   494     12  WS-SAVE-BENEI           PIC X(10) VALUE LOW-VALUES.
   495     12  WS-SAVE-BENEL           PIC S9(4) COMP VALUE +0.
   496     12  WS-SAVE-BIRTHI          PIC X(8) VALUE LOW-VALUES.
   497     12  WS-SAVE-BIRTHL          PIC S9(4) COMP VALUE +0.
   498     12  WS-SAVE-SOCIALI         PIC X(11) VALUE LOW-VALUES.
   499     12  WS-SAVE-SOCIALL         PIC S9(4) COMP VALUE +0.
   500     12  WS-SAVE-SEXI            PIC X(1) VALUE LOW-VALUES.
   501     12  WS-SAVE-SEXL            PIC S9(4) COMP VALUE +0.
   502     12  WS-SAVE-MLNAMEI         PIC X(15) VALUE LOW-VALUES.
   503     12  WS-SAVE-MLNAMEL         PIC S9(4) COMP VALUE +0.
   504     12  WS-SAVE-MFNAMEI         PIC X(12) VALUE LOW-VALUES.
   505     12  WS-SAVE-MFNAMEL         PIC S9(4) COMP VALUE +0.
   506     12  WS-SAVE-MMINITI         PIC X(1) VALUE LOW-VALUES.
   507     12  WS-SAVE-MMINITL         PIC S9(4) COMP VALUE +0.
   508     12  WS-SAVE-LOANNOI         PIC X(8) VALUE LOW-VALUES.
   509     12  WS-SAVE-LOANNOL         PIC S9(4) COMP VALUE +0.
   510     12  WS-SAVE-LOANBALI        PIC 9(7)V99 VALUE ZEROS.
   511     12  WS-SAVE-LOANBALL        PIC S9(4) COMP VALUE +0.
   512     12  WS-SAVE-PROCI           PIC X(4) VALUE LOW-VALUES.
   513     12  WS-SAVE-PROCL           PIC S9(4) COMP VALUE +0.
   514     12  WS-SAVE-SUPVI           PIC X(1) VALUE LOW-VALUES.
   515     12  WS-SAVE-SUPVL           PIC S9(4) COMP VALUE +0.
   516     12  WS-SAVE-PRICDI          PIC X(1) VALUE LOW-VALUES.
   517     12  WS-SAVE-PRICDL          PIC S9(4) COMP VALUE +0.
   518     12  WS-SAVE-FILETOI         PIC X(4) VALUE LOW-VALUES.
   519     12  WS-SAVE-FILETOL         PIC S9(4) COMP VALUE +0.
   520     12  WS-SAVE-PDTHRUI         PIC X(8) VALUE LOW-VALUES.
   521     12  WS-SAVE-PDTHRUL         PIC S9(4) COMP VALUE +0.
   522     12  WS-SAVE-PDAMTI          PIC 9(7)V99 VALUE ZEROS.
   523     12  WS-SAVE-PDAMTL          PIC S9(4) COMP VALUE +0.
   524     12  WS-SAVE-NODAYSI         PIC 9(5) VALUE ZEROS.
   525     12  WS-SAVE-NODAYSL         PIC S9(4) COMP VALUE +0.
   526     12  WS-SAVE-NOPMTSI         PIC 9(4) VALUE ZEROS.
   527     12  WS-SAVE-NOPMTSL         PIC S9(4) COMP VALUE +0.
   528     12  WS-SAVE-FORMTYPI        PIC X(1) VALUE LOW-VALUES.
   529     12  WS-SAVE-FORMTYPL        PIC S9(4) COMP VALUE +0.
   530     12  WS-SAVE-OCCI            PIC X(6) VALUE LOW-VALUES.
   531     12  WS-SAVE-OCCL            PIC S9(4) COMP VALUE +0.
   532
   533 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   534     12  M                   PIC S9(7)V99           VALUE ZEROS.
   535     12  L                   PIC S9(7)V99           VALUE ZEROS.
   536     12  N                   PIC S9(3)              VALUE ZEROS.
   537     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   538     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   539     12  I                   PIC S99V9(5)           VALUE ZEROS.
   540     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   541     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   542     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   543     12  R                   PIC S9(3)              VALUE ZEROS.
   544     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   545     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   546     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   547     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   548     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  12
* EL131.cbl
   549     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   550     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   551     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   552     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   553
   554 01  TERM-CALC-WORK-AREA.
   555     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   556     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   557     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   558     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   559     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   560     12  V-EXPONENTS.
   561        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   562     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   563
   564 01  TIME-IN.
   565     12  UN-HOURS                PIC XX.
   566     12  UN-MINUTES              PIC XX.
   567     12  FILLER                  PIC XX.
   568
   569 01  TIME-OUT.
   570     12  FOR-HOURS               PIC XX.
   571     12  FILLER                  PIC X       VALUE '.'.
   572     12  FOR-MINUTES             PIC XX.
   573
   574 01  ERROR-NUMBERS.
   575     12  ER-0000                 PIC X(4)    VALUE '0000'.
   576     12  ER-0004                 PIC X(4)    VALUE '0004'.
   577     12  ER-0008                 PIC X(4)    VALUE '0008'.
   578     12  ER-0023                 PIC X(4)    VALUE '0023'.
   579     12  ER-0029                 PIC X(4)    VALUE '0029'.
   580     12  ER-0068                 PIC X(4)    VALUE '0068'.
   581     12  ER-0070                 PIC X(4)    VALUE '0070'.
   582     12  ER-0149                 PIC X(4)    VALUE '0149'.
   583     12  ER-0154                 PIC X(4)    VALUE '0154'.
   584     12  ER-0169                 PIC X(4)    VALUE '0169'.
   585     12  ER-0192                 PIC X(4)    VALUE '0192'.
   586     12  ER-0199                 PIC X(4)    VALUE '0199'.
   587     12  ER-0203                 PIC X(4)    VALUE '0203'.
   588     12  ER-0204                 PIC X(4)    VALUE '0204'.
   589     12  ER-0205                 PIC X(4)    VALUE '0205'.
   590     12  ER-0206                 PIC X(4)    VALUE '0206'.
   591     12  ER-0208                 PIC X(4)    VALUE '0208'.
   592     12  ER-0210                 PIC X(4)    VALUE '0210'.
   593     12  ER-0215                 PIC X(4)    VALUE '0215'.
   594     12  ER-0219                 PIC X(4)    VALUE '0219'.
   595     12  ER-0220                 PIC X(4)    VALUE '0220'.
   596     12  ER-0222                 PIC X(4)    VALUE '0222'.
   597     12  ER-0223                 PIC X(4)    VALUE '0223'.
   598     12  ER-0224                 PIC X(4)    VALUE '0224'.
   599     12  ER-0227                 PIC X(4)    VALUE '0227'.
   600     12  ER-0230                 PIC X(4)    VALUE '0230'.
   601     12  ER-0232                 PIC X(4)    VALUE '0232'.
   602     12  ER-0233                 PIC X(4)    VALUE '0233'.
   603     12  ER-0236                 PIC X(4)    VALUE '0236'.
   604     12  ER-0237                 PIC X(4)    VALUE '0237'.
   605     12  ER-0238                 PIC X(4)    VALUE '0238'.
   606     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  13
* EL131.cbl
   607     12  ER-0241                 PIC X(4)    VALUE '0241'.
   608     12  ER-0243                 PIC X(4)    VALUE '0243'.
   609     12  ER-0244                 PIC X(4)    VALUE '0244'.
   610     12  ER-0246                 PIC X(4)    VALUE '0246'.
   611     12  ER-0247                 PIC X(4)    VALUE '0247'.
   612     12  ER-0248                 PIC X(4)    VALUE '0248'.
   613     12  ER-0250                 PIC X(4)    VALUE '0250'.
   614     12  ER-0251                 PIC X(4)    VALUE '0251'.
   615     12  ER-0253                 PIC X(4)    VALUE '0253'.
   616     12  ER-0256                 PIC X(4)    VALUE '0256'.
   617     12  ER-0257                 PIC X(4)    VALUE '0257'.
   618     12  ER-0258                 PIC X(4)    VALUE '0258'.
   619     12  ER-0259                 PIC X(4)    VALUE '0259'.
   620     12  ER-0260                 PIC X(4)    VALUE '0260'.
   621     12  ER-0261                 PIC X(4)    VALUE '0261'.
   622     12  ER-0262                 PIC X(4)    VALUE '0262'.
   623     12  ER-0263                 PIC X(4)    VALUE '0263'.
   624     12  ER-0273                 PIC X(4)    VALUE '0273'.
   625     12  ER-0274                 PIC X(4)    VALUE '0274'.
   626     12  ER-0276                 PIC X(4)    VALUE '0276'.
   627     12  ER-0282                 PIC X(4)    VALUE '0282'.
   628     12  ER-0283                 PIC X(4)    VALUE '0283'.
   629     12  ER-0309                 PIC X(4)    VALUE '0309'.
   630     12  ER-0310                 PIC X(4)    VALUE '0310'.
   631     12  ER-0311                 PIC X(4)    VALUE '0311'.
   632     12  ER-0333                 PIC X(4)    VALUE '0333'.
   633     12  ER-0360                 PIC X(4)    VALUE '0360'.
   634     12  ER-0377                 PIC X(4)    VALUE '0377'.
   635     12  ER-0402                 PIC X(4)    VALUE '0402'.
   636     12  ER-0416                 PIC X(4)    VALUE '0416'.
   637     12  ER-0426                 PIC X(4)    VALUE '0426'.
   638     12  ER-0427                 PIC X(4)    VALUE '0427'.
   639     12  ER-0428                 PIC X(4)    VALUE '0428'.
   640     12  ER-0429                 PIC X(4)    VALUE '0429'.
   641     12  ER-0430                 PIC X(4)    VALUE '0430'.
   642     12  ER-0458                 PIC X(4)    VALUE '0458'.
   643     12  ER-0475                 PIC X(4)    VALUE '0475'.
   644     12  ER-0491                 PIC X(4)    VALUE '0491'.
   645     12  ER-0509                 PIC X(4)    VALUE '0509'.
   646     12  ER-0510                 PIC X(4)    VALUE '0510'.
   647     12  ER-0511                 PIC X(4)    VALUE '0511'.
   648     12  ER-0512                 PIC X(4)    VALUE '0512'.
   649     12  ER-0519                 PIC X(4)    VALUE '0519'.
   650     12  ER-0520                 PIC X(4)    VALUE '0520'.
   651     12  ER-0521                 PIC X(4)    VALUE '0521'.
   652     12  ER-0547                 PIC X(4)    VALUE '0547'.
   653     12  ER-0548                 PIC X(4)    VALUE '0548'.
   654     12  ER-0549                 PIC X(4)    VALUE '0549'.
   655     12  ER-0565                 PIC X(4)    VALUE '0565'.
   656     12  ER-0598                 PIC X(4)    VALUE '0598'.
   657     12  ER-0639                 PIC X(4)    VALUE '0639'.
   658     12  ER-0797                 PIC X(4)    VALUE '0797'.
   659     12  ER-0802                 PIC X(4)    VALUE '0802'.
   660     12  ER-0803                 PIC X(4)    VALUE '0803'.
   661     12  ER-0849                 PIC X(4)    VALUE '0849'.
   662     12  ER-0885                 PIC X(4)    VALUE '0885'.
   663     12  ER-0887                 PIC X(4)    VALUE '0887'.
   664     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  14
* EL131.cbl
   665     12  ER-0921                 PIC X(4)    VALUE '0921'.
   666     12  ER-0938                 PIC X(4)    VALUE '0938'.
   667     12  ER-0946                 PIC X(4)    VALUE '0946'.
   668     12  ER-0947                 PIC X(4)    VALUE '0947'.
   669     12  ER-0948                 PIC X(4)    VALUE '0948'.
   670     12  ER-0949                 PIC X(4)    VALUE '0949'.
   671     12  ER-0950                 PIC X(4)    VALUE '0950'.
   672     12  ER-0951                 PIC X(4)    VALUE '0951'.
   673     12  ER-0954                 PIC X(4)    VALUE '0954'.
   674     12  ER-0974                 PIC X(4)    VALUE '0974'.
   675     12  ER-0975                 PIC X(4)    VALUE '0975'.
   676     12  ER-0992                 PIC X(4)    VALUE '0992'.
   677     12  er-1581                 pic x(4)    value '1581'.
   678     12  ER-1651                 PIC X(4)    VALUE '1651'.
   679     12  ER-1652                 PIC X(4)    VALUE '1652'.
   680     12  ER-1653                 PIC X(4)    VALUE '1653'.
   681     12  ER-1654                 PIC X(4)    VALUE '1654'.
   682     12  ER-1655                 PIC X(4)    VALUE '1655'.
   683     12  er-1656                 pic x(4)    value '1656'.
   684     12  ER-1661                 PIC X(4)    VALUE '1661'.
   685     12  ER-1662                 PIC X(4)    VALUE '1662'.
   686     12  ER-1663                 PIC X(4)    VALUE '1663'.
   687     12  er-1664                 pic x(4)    value '1664'.
   688     12  er-1665                 pic x(4)    value '1665'.
   689     12  er-1666                 pic x(4)    value '1666'.
   690     12  er-1668                 pic x(4)    value '1668'.
   691     12  er-1669                 pic x(4)    value '1669'.
   692     12  er-1675                 pic x(4)    value '1675'.
   693     12  er-1676                 pic x(4)    value '1676'.
   694     12  ER-1678                 PIC X(4)    VALUE '1678'.
   695     12  ER-1679                 PIC X(4)    VALUE '1679'.
   696     12  ER-1772                 PIC X(4)    VALUE '1772'.
   697     12  ER-1773                 PIC X(4)    VALUE '1773'.
   698     12  ER-1778                 PIC X(4)    VALUE '1778'.
   699     12  ER-2280                 PIC X(4)    VALUE '2280'.
   700     12  ER-2878                 PIC X(4)    VALUE '2878'.
   701     12  ER-7572                 PIC X(4)    VALUE '7572'.
   702     12  ER-7641                 PIC X(4)    VALUE '7641'.
   703     12  ER-7642                 PIC X(4)    VALUE '7642'.
   704     12  ER-7650                 PIC X(4)    VALUE '7650'.
   705     12  ER-7651                 PIC X(4)    VALUE '7651'.
   706     12  ER-7687                 PIC X(4)    VALUE '7687'.
   707     12  ER-7689                 PIC X(4)    VALUE '7689'.
   708     12  ER-7690                 PIC X(4)    VALUE '7690'.
   709     12  ER-7691                 PIC X(4)    VALUE '7691'.
   710     12  ER-8003                 PIC X(4)    VALUE '8003'.
   711     12  ER-8051                 PIC X(4)    VALUE '8051'.
   712     12  ER-8052                 PIC X(4)    VALUE '8052'.
   713     12  ER-8053                 PIC X(4)    VALUE '8053'.
   714     12  ER-8054                 PIC X(4)    VALUE '8054'.
   715     12  ER-8055                 PIC X(4)    VALUE '8055'.
   716     12  ER-8056                 PIC X(4)    VALUE '8056'.
   717     12  ER-8057                 PIC X(4)    VALUE '8057'.
   718     12  ER-8058                 PIC X(4)    VALUE '8058'.
   719     12  ER-8059                 PIC X(4)    VALUE '8059'.
   720     12  ER-8060                 PIC X(4)    VALUE '8060'.
   721     12  ER-8061                 PIC X(4)    VALUE '8061'.
   722     12  ER-8062                 PIC X(4)    VALUE '8062'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  15
* EL131.cbl
   723     12  ER-8063                 PIC X(4)    VALUE '8063'.
   724     12  ER-8064                 PIC X(4)    VALUE '8064'.
   725     12  ER-8065                 PIC X(4)    VALUE '8065'.
   726     12  ER-8066                 PIC X(4)    VALUE '8066'.
   727     12  ER-8152                 PIC X(4)    VALUE '8152'.
   728     12  ER-8153                 PIC X(4)    VALUE '8153'.
   729     12  ER-8154                 PIC X(4)    VALUE '8154'.
   730     12  ER-8155                 PIC X(4)    VALUE '8155'.
   731 01  ERPDEF-KEY-SAVE             PIC X(18).
   732 01  ERPDEF-KEY.
   733     12  ERPDEF-COMPANY-CD       PIC X.
   734     12  ERPDEF-STATE            PIC XX.
   735     12  ERPDEF-PROD-CD          PIC XXX.
   736     12  F                       PIC X(7).
   737     12  ERPDEF-BEN-TYPE         PIC X.
   738     12  ERPDEF-BEN-CODE         PIC XX.
   739     12  ERPDEF-EXP-DT           PIC XX.
   740 01  MSTR-KEY.
   741     12  COMPANY-CODE            PIC X.
   742     12  CARRIER-CODE            PIC X.
   743     12  CLAIM-NO                PIC X(7).
   744     12  CERT-NO.
   745         16  CERT-NO-PRIME       PIC X(10).
   746         16  CERT-NO-SUFX        PIC X.
   747
   748 01  WS-SAVE-CLAIM-KEY.
   749     12  WS-SAVE-COMPANY-CD      PIC X.
   750     12  WS-SAVE-CARRIER         PIC X.
   751     12  WS-SAVE-CLAIM-NO        PIC X(7).
   752     12  WS-SAVE-CERT-NO.
   753         16  WS-CERT-NO-PRIME    PIC X(10).
   754         16  WS-CERT-NO-SUFX     PIC X.
   755
   756 01  CERT-KEY.
   757     12  CERT-COMPANY-CODE       PIC X.
   758     12  CERT-CARRIER            PIC X.
   759     12  CERT-GROUP              PIC X(6).
   760     12  CERT-STATE              PIC XX.
   761     12  CERT-ACCOUNT            PIC X(10).
   762     12  CERT-DATE               PIC XX.
   763     12  CERT-CERT.
   764         16  CERT-CERT-PRIME     PIC X(10).
   765         16  CERT-CERT-SUFX      PIC X.
   766
   767 01  ELCRTT-KEY.
   768     05  CTRLR-COMP-CD       PIC X.
   769     05  CTRLR-CARRIER       PIC X.
   770     05  CTRLR-GROUPING      PIC X(6).
   771     05  CTRLR-STATE         PIC X(2).
   772     05  CTRLR-ACCOUNT       PIC X(10).
   773     05  CTRLR-EFF-DT        PIC XX.
   774     05  CTRLR-CERT-NO       PIC X(11).
   775     05  CTRLR-REC-TYPE      PIC X.
   776 01  NOTE-KEY.
   777     12  NOTE-COMP-CD            PIC X.
   778     12  NOTE-CERT-KEY.
   779         16  NOTE-CARRIER        PIC X.
   780         16  NOTE-GROUP          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  16
* EL131.cbl
   781         16  NOTE-STATE          PIC XX.
   782         16  NOTE-ACCOUNT        PIC X(10).
   783         16  NOTE-DATE           PIC XX.
   784         16  NOTE-CERT-NO        PIC X(11).
   785
   786 01  TRLR-KEY.
   787     12  TRLR-MAIN-KEY.
   788         16  TRLR-COMPANY-CD     PIC X.
   789         16  TRLR-CARRIER        PIC X.
   790         16  TRLR-CLAIM-NO       PIC X(07).
   791         16  TRLR-CERT-NO        PIC X(11).
   792     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   793
   794 01  BENEFIT-KEY.
   795     12  BEN-CO-ID               PIC X(3).
   796     12  BEN-REC-TYPE            PIC X.
   797     12  FILLER                  PIC XX.
   798     12  BEN-ACC-CD              PIC XX.
   799     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   800
   801 01  CNTL-KEY.
   802     12  CNTL-CO-ID              PIC X(3).
   803     12  CNTL-REC-TYPE           PIC X.
   804     12  CNTL-PROC-ID            PIC X(4).
   805     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   806         16  CNTL-STATE-NUMBER   PIC XX.
   807         16  FILLER              PIC XX.
   808     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   809         16  FILLER              PIC X(3).
   810         16  CNTL-CARRIER        PIC X.
   811     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   812
   813 01  ACTQ-KEY                    PIC X(20).
   814
   815 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   816
   817 01  CHKQ-KEY.
   818     12  CHKQ-COMPANY-CODE       PIC X.
   819     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   820     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   821
   822 01  ARCH-KEY.
   823     12  ARCH-COMPANY-CODE       PIC X.
   824     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   825     12  ARCH-RECORD-TYPE        PIC X.
   826     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   827
   828 01  ACCT-KEY.
   829     05  ACCT-PARTIAL-KEY.
   830         12  ACCT-COMPANY-CODE   PIC X.
   831         12  ACCT-CARRIER        PIC X.
   832         12  ACCT-GROUP          PIC X(6).
   833         12  ACCT-STATE          PIC XX.
   834         12  ACCT-ACCOUNT        PIC X(10).
   835     05  ACCT-DATE               PIC XX.
   836
   837 01  WS-ELBENE-KEY.
   838     12  WS-ELBENE-COMPANY-CD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  17
* EL131.cbl
   839     12  WS-ELBENE-RECORD-TYPE   PIC X.
   840     12  WS-ELBENE-ID            PIC X(10).
   841
   842 01  ELALPH-KEY.
   843     12  ELALPH-COMPANY-CD       PIC X.
   844     12  ELALPH-SOURCE           PIC X.
   845     12  ELALPH-NAME.
   846         16  ELALPH-LAST-NAME    PIC X(15).
   847         16  ELALPH-FIRST-NAME.
   848             20  ELALPH-FIRST-INIT   PIC X.
   849             20  FILLER              PIC X(11).
   850         16  ELALPH-MIDDLE-INIT  PIC X.
   851     12  ELALPH-DATE             PIC X(08).
   852     12  ELALPH-TIME             PIC S9(04)    COMP.
   853
   854 01  COMP-LENGTHS.
   855     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   856     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   857     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   858     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   859     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   860     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   861     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   862     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   863     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   864     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   865     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   866     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   867     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   868     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  18
* EL131.cbl
   870*                                COPY ELCLNKLT.
   871******************************************************************
   872*                                                                *
   873*                                                                *
   874*                           ELCLNKLT                             *
   875*                            VMOD=2.003                          *
   876*                                                                *
   877*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   878*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   879*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   880*                                                                *
   881*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   882*   COMPLETING THE REQUIRED FIELDS.                              *
   883*                                                                *
   884*   THE CALLING PROGRAM SHOULD CHECK:                            *
   885*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   886*                              9999 INDICATES AN UNKNOWN ABEND   *
   887*                                   WAS DETECTED.                *
   888*                              ALL OTHER VALUES ARE NORMAL ERROR *
   889*                              CODES FOUND IN THE ERROR FILE.    *
   890******************************************************************
   891 01  W-1523-LINKDATA.
   892     12  W-1523-COMMON-PI-DATA.
   893         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   894         16  FILLER              PIC  X(67).
   895         16  W-1523-COMPANY-CD   PIC  X(01).
   896         16  FILLER              PIC  X(10).
   897         16  W-1523-CONTROL-IN-PROGRESS.
   898             20  W-1523-CARRIER  PIC  X(01).
   899             20  W-1523-GROUPING PIC  X(06).
   900             20  W-1523-STATE    PIC  X(02).
   901             20  W-1523-ACCOUNT  PIC  X(10).
   902             20  W-1523-CLAIM-CERT-GRP.
   903                 24  W-1523-CLAIM-NO
   904                                 PIC  X(07).
   905                 24  W-1523-CERT-NO.
   906                     28  W-1523-CERT-PRIME
   907                                 PIC  X(10).
   908                     28  W-1523-CERT-SFX
   909                                 PIC  X(01).
   910                 24  W-1523-CERT-EFF-DT
   911                                 PIC  X(02).
   912         16  FILLER              PIC X(265).
   913
   914     12  W-1523-WORK-AREA.
   915         16  W-1523-FORM-NUMBER  PIC  X(04).
   916         16  W-1523-NUMBER-COPIES
   917                                 PIC  9(01).
   918         16  W-1523-ADDR-TYPE    PIC  X(02).
   919         16  W-1523-FOLLOW-UP-DATE
   920                                 PIC  X(02).
   921         16  W-1523-RESEND-DATE  PIC  X(02).
   922         16  W-1523-ERROR-CODE   PIC  9(04).
   923             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   924             88  W-1523-FATAL-ERROR
   925                                    VALUES  0006 0013 0042
   926                                            0154 0168 0169
   927                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  19
* EL131.cbl
   928                                            0179 0186 0281
   929                                            0332 2055 3697
   930                                            3698 3699 3770
   931                                            3771 3772 7675
   932                                            9106 9808 9883
   933                                            9887.
   934             88  W-1523-STOP-ERRORS
   935                                    VALUES  0013 0042 0154
   936                                            0168 0169 0172
   937                                            0281 0332 2055
   938                                            3698 3699 7675
   939                                            9106 9808 9883
   940                                            9999.
   941         16  W-1523-REASON       PIC  X(70).
   942         16  W-1523-ARCHIVE-NUMBER
   943                                 PIC  9(08).
   944     12  W-1523-POINTER-AREA.
   945         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   946         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   947         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   948         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   949         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  20
* EL131.cbl
   951*                                COPY ELCINTF.
   952******************************************************************
   953*                                                                *
   954*                                                                *
   955*                            ELCINTF.                            *
   956*                            VMOD=2.017                          *
   957*                                                                *
   958*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   959*                                                                *
   960*       LENGTH = 1024                                            *
   961*                                                                *
   962******************************************************************
   963*                   C H A N G E   L O G
   964*
   965* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   966*-----------------------------------------------------------------
   967*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   968* EFFECTIVE    NUMBER
   969*-----------------------------------------------------------------
   970* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   971******************************************************************
   972 01  PROGRAM-INTERFACE-BLOCK.
   973     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   974     12  PI-CALLING-PROGRAM              PIC X(8).
   975     12  PI-SAVED-PROGRAM-1              PIC X(8).
   976     12  PI-SAVED-PROGRAM-2              PIC X(8).
   977     12  PI-SAVED-PROGRAM-3              PIC X(8).
   978     12  PI-SAVED-PROGRAM-4              PIC X(8).
   979     12  PI-SAVED-PROGRAM-5              PIC X(8).
   980     12  PI-SAVED-PROGRAM-6              PIC X(8).
   981     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   982     12  PI-COMPANY-ID                   PIC XXX.
   983     12  PI-COMPANY-CD                   PIC X.
   984
   985     12  PI-COMPANY-PASSWORD             PIC X(8).
   986
   987     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   988
   989     12  PI-CONTROL-IN-PROGRESS.
   990         16  PI-CARRIER                  PIC X.
   991         16  PI-GROUPING                 PIC X(6).
   992         16  PI-STATE                    PIC XX.
   993         16  PI-ACCOUNT                  PIC X(10).
   994         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   995                                         PIC X(10).
   996         16  PI-CLAIM-CERT-GRP.
   997             20  PI-CLAIM-NO             PIC X(7).
   998             20  PI-CERT-NO.
   999                 25  PI-CERT-PRIME       PIC X(10).
  1000                 25  PI-CERT-SFX         PIC X.
  1001             20  PI-CERT-EFF-DT          PIC XX.
  1002         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1003             20  PI-PLAN-CODE            PIC X(2).
  1004             20  PI-REVISION-NUMBER      PIC X(3).
  1005             20  PI-PLAN-EFF-DT          PIC X(2).
  1006             20  PI-PLAN-EXP-DT          PIC X(2).
  1007             20  FILLER                  PIC X(11).
  1008         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  21
* EL131.cbl
  1009             20  PI-OE-REFERENCE-1.
  1010                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1011                 25  PI-OE-REF-1-SUFF    PIC XX.
  1012
  1013     12  PI-SESSION-IN-PROGRESS          PIC X.
  1014         88  CLAIM-SESSION                   VALUE '1'.
  1015         88  CREDIT-SESSION                  VALUE '2'.
  1016         88  WARRANTY-SESSION                VALUE '3'.
  1017         88  MORTGAGE-SESSION                VALUE '4'.
  1018         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1019
  1020
  1021*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1022
  1023     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1024     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1025
  1026     12  PI-CREDIT-USER                  PIC X.
  1027         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1028         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1029
  1030     12  PI-CLAIM-USER                   PIC X.
  1031         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1032         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1033
  1034     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1035         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1036         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1037         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1038         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1039         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1040
  1041     12  PI-PROCESSOR-ID                 PIC X(4).
  1042
  1043     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1044
  1045     12  PI-MEMBER-CAPTION               PIC X(10).
  1046
  1047     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1048         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1049
  1050     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1051     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1052     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1053     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1054
  1055     12  PI-AH-OVERRIDE-L1               PIC X.
  1056     12  PI-AH-OVERRIDE-L2               PIC XX.
  1057     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1058     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1059
  1060     12  PI-NEW-SYSTEM                   PIC X(2).
  1061
  1062     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1063     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1064         88  PI-USES-PAID-TO                 VALUE '1'.
  1065     12  PI-CRDTCRD-SYSTEM.
  1066         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  22
* EL131.cbl
  1067             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1068             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1069         16  PI-CC-MONTH-END-DT          PIC XX.
  1070     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1071
  1072     12  PI-OE-REFERENCE-2.
  1073         16  PI-OE-REF-2-PRIME           PIC X(10).
  1074         16  PI-OE-REF-2-SUFF            PIC X.
  1075
  1076     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1077
  1078     12  PI-LANGUAGE-TYPE                PIC X.
  1079             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1080             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1081             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1082
  1083     12  PI-POLICY-LINKAGE-IND           PIC X.
  1084         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1085         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1086                                                   LOW-VALUES.
  1087
  1088     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1089     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1090         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1091         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1092
  1093     12  PI-PROCESSOR-CSR-IND            PIC X.
  1094         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1095         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1096
  1097     12  FILLER                          PIC X(3).
  1098
  1099     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1100
  1101     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1102         PI-SYSTEM-LEVEL.
  1103
  1104         16  PI-ENTRY-CODES.
  1105             20  PI-ENTRY-CD-1           PIC X.
  1106             20  PI-ENTRY-CD-2           PIC X.
  1107
  1108         16  PI-RETURN-CODES.
  1109             20  PI-RETURN-CD-1          PIC X.
  1110             20  PI-RETURN-CD-2          PIC X.
  1111
  1112         16  PI-UPDATE-STATUS-SAVE.
  1113             20  PI-UPDATE-BY            PIC X(4).
  1114             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1115
  1116         16  PI-LOWER-CASE-LETTERS       PIC X.
  1117             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1118
  1119*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1120*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1121*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1122
  1123         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1124             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  23
* EL131.cbl
  1125             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1126             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1127             88  ACCNT-CNTL                  VALUE '3'.
  1128             88  CARR-ACCNT-CNTL             VALUE '4'.
  1129
  1130         16  PI-PROCESSOR-CAP-LIST.
  1131             20  PI-SYSTEM-CONTROLS.
  1132                24 PI-SYSTEM-DISPLAY     PIC X.
  1133                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1134                24 PI-SYSTEM-MODIFY      PIC X.
  1135                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1136             20  FILLER                  PIC XX.
  1137             20  PI-DISPLAY-CAP          PIC X.
  1138                 88  DISPLAY-CAP             VALUE 'Y'.
  1139             20  PI-MODIFY-CAP           PIC X.
  1140                 88  MODIFY-CAP              VALUE 'Y'.
  1141             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1142                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1143             20  PI-FORCE-CAP            PIC X.
  1144                 88  FORCE-CAP               VALUE 'Y'.
  1145
  1146         16  PI-PROGRAM-CONTROLS.
  1147             20  PI-PGM-PRINT-OPT        PIC X.
  1148             20  PI-PGM-FORMAT-OPT       PIC X.
  1149             20  PI-PGM-PROCESS-OPT      PIC X.
  1150             20  PI-PGM-TOTALS-OPT       PIC X.
  1151
  1152         16  PI-HELP-INTERFACE.
  1153             20  PI-LAST-ERROR-NO        PIC X(4).
  1154             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1155
  1156         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1157             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1158
  1159         16  PI-CR-CONTROL-IN-PROGRESS.
  1160             20  PI-CR-CARRIER           PIC X.
  1161             20  PI-CR-GROUPING          PIC X(6).
  1162             20  PI-CR-STATE             PIC XX.
  1163             20  PI-CR-ACCOUNT           PIC X(10).
  1164             20  PI-CR-FIN-RESP          PIC X(10).
  1165             20  PI-CR-TYPE              PIC X.
  1166
  1167         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1168
  1169         16  PI-CR-MONTH-END-DT          PIC XX.
  1170
  1171         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1172             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1173             88  PI-ZERO-CARRIER             VALUE '1'.
  1174             88  PI-ZERO-GROUPING            VALUE '2'.
  1175             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1176
  1177         16  PI-CARRIER-SECURITY         PIC X.
  1178             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1179
  1180         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1181             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1182             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  24
* EL131.cbl
  1183
  1184         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1185             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1186                                         INDEXED BY PI-ACCESS-NDX
  1187                                         PIC X.
  1188
  1189         16  PI-GA-BILLING-CONTROL       PIC X.
  1190             88  PI-GA-BILLING               VALUE '1'.
  1191
  1192         16  PI-MAIL-PROCESSING          PIC X.
  1193             88  PI-MAIL-YES                 VALUE 'Y'.
  1194
  1195         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1196
  1197         16  PI-AR-SYSTEM.
  1198             20  PI-AR-PROCESSING-CNTL   PIC X.
  1199                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1200             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1201             20  PI-AR-MONTH-END-DT      PIC XX.
  1202
  1203         16  PI-MP-SYSTEM.
  1204             20  PI-MORTGAGE-USER            PIC X.
  1205                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1206                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1207             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1208                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1209                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1210                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1211                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1212                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1213             20  PI-MP-MONTH-END-DT          PIC XX.
  1214             20  PI-MP-REFERENCE-NO.
  1215                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1216                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1217
  1218         16  PI-LABEL-CONTROL            PIC X(01).
  1219             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1220             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1221
  1222         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1223             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1224
  1225         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1226             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1227             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1228
  1229         16  FILLER                      PIC X(14).
  1230
  1231     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1232******************************************************************
  1233     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1234         16  PI-NO-PMTS                    PIC 9(4).
  1235         16  PI-CERT-SWITCH                PIC X.
  1236             88  CREATED-CERT              VALUE '2'.
  1237         16  PI-PREM-TYPE                  PIC X.
  1238         16  PI-SAVE-CERT-NO.
  1239             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1240             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  25
* EL131.cbl
  1241         16  FILLER                        PIC X(46).
  1242         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1243         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1244         16  PI-REC-FOUND-SW               PIC X.
  1245         16  PI-LETTER-SW                  PIC X.
  1246         16  PI-PREV-TRLR-KEY              PIC X(22).
  1247         16  pi-claim-type                 pic x.
  1248         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1249         16  pi-approval-level             pic x.
  1250         16  FILLER                        PIC X(543).
  1251
  1252 01  SAVE-RECORD                 PIC X(450).
  1253
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  26
* EL131.cbl
  1255*                                COPY ELCLOGOF SUPPRESS.
  1256******************************************************************
  1257*                                                                *
  1258*                                                                *
  1259*                            ELCLOGOF.                           *
  1260*                            VMOD=2.001                          *
  1261*                                                                *
  1262*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1263*                                                                *
  1264******************************************************************
  1265 01  CLASIC-LOGOFF.
  1266     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1267     12  LOGOFF-TEXT.
  1268         16  FILLER          PIC X(5)    VALUE SPACES.
  1269         16  LOGOFF-MSG.
  1270             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1271             20  FILLER      PIC X       VALUE SPACES.
  1272             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1273         16  FILLER          PIC X(80)
  1274           VALUE '* YOU ARE NOW LOGGED OFF'.
  1275         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1276         16  FILLER          PIC X       VALUE QUOTE.
  1277         16  LOGOFF-SYS-MSG  PIC X(17)
  1278           VALUE 'S CLAS-IC SYSTEM '.
  1279     12  TEXT-MESSAGES.
  1280         16  UNACCESS-MSG    PIC X(29)
  1281             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1282         16  PGMIDERR-MSG    PIC X(17)
  1283             VALUE 'PROGRAM NOT FOUND'.
  1284
  1285*                                COPY ELCATTR SUPPRESS.
  1286******************************************************************
  1287*                                                                *
  1288*                            ELCATTR.                            *
  1289*                            VMOD=2.001                          *
  1290*                                                                *
  1291*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1292*                                                                *
  1293*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1294*                                                                *
  1295*                   POS 1   P=PROTECTED                          *
  1296*                           U=UNPROTECTED                        *
  1297*                           S=ASKIP                              *
  1298*                   POS 2   A=ALPHA/NUMERIC                      *
  1299*                           N=NUMERIC                            *
  1300*                   POS 3   N=NORMAL                             *
  1301*                           B=BRIGHT                             *
  1302*                           D=DARK                               *
  1303*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1304*                           OF=MODIFIED DATA TAG OFF             *
  1305*                                                                *
  1306*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1307******************************************************************
  1308 01  ATTRIBUTE-LIST.
  1309     12  AL-PABOF            PIC X       VALUE 'Y'.
  1310     12  AL-PABON            PIC X       VALUE 'Z'.
  1311     12  AL-PADOF            PIC X       VALUE '%'.
  1312     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  27
* EL131.cbl
  1313     12  AL-PANOF            PIC X       VALUE '-'.
  1314     12  AL-PANON            PIC X       VALUE '/'.
  1315     12  AL-SABOF            PIC X       VALUE '8'.
  1316     12  AL-SABON            PIC X       VALUE '9'.
  1317     12  AL-SADOF            PIC X       VALUE '@'.
  1318     12  AL-SADON            PIC X       VALUE QUOTE.
  1319     12  AL-SANOF            PIC X       VALUE '0'.
  1320     12  AL-SANON            PIC X       VALUE '1'.
  1321     12  AL-UABOF            PIC X       VALUE 'H'.
  1322     12  AL-UABON            PIC X       VALUE 'I'.
  1323     12  AL-UADOF            PIC X       VALUE '<'.
  1324     12  AL-UADON            PIC X       VALUE '('.
  1325     12  AL-UANOF            PIC X       VALUE ' '.
  1326     12  AL-UANON            PIC X       VALUE 'A'.
  1327     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1328     12  AL-UNBON            PIC X       VALUE 'R'.
  1329     12  AL-UNDOF            PIC X       VALUE '*'.
  1330     12  AL-UNDON            PIC X       VALUE ')'.
  1331     12  AL-UNNOF            PIC X       VALUE '&'.
  1332     12  AL-UNNON            PIC X       VALUE 'J'.
  1333
  1334*                                COPY ELCAID SUPPRESS.
  1335******************************************************************
  1336*                                                                *
  1337*                            ELCAID.                             *
  1338*                            VMOD=2.001                          *
  1339*                                                                *
  1340*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1341*                                                                *
  1342*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1343*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1344******************************************************************
  1345
  1346 01  DFHAID.
  1347   02  DFHNULL   PIC  X  VALUE  ' '.
  1348   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1349   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1350   02  DFHPEN    PIC  X  VALUE  '='.
  1351   02  DFHOPID   PIC  X  VALUE  'W'.
  1352   02  DFHPA1    PIC  X  VALUE  '%'.
  1353   02  DFHPA2    PIC  X  VALUE  '>'.
  1354   02  DFHPA3    PIC  X  VALUE  ','.
  1355   02  DFHPF1    PIC  X  VALUE  '1'.
  1356   02  DFHPF2    PIC  X  VALUE  '2'.
  1357   02  DFHPF3    PIC  X  VALUE  '3'.
  1358   02  DFHPF4    PIC  X  VALUE  '4'.
  1359   02  DFHPF5    PIC  X  VALUE  '5'.
  1360   02  DFHPF6    PIC  X  VALUE  '6'.
  1361   02  DFHPF7    PIC  X  VALUE  '7'.
  1362   02  DFHPF8    PIC  X  VALUE  '8'.
  1363   02  DFHPF9    PIC  X  VALUE  '9'.
  1364   02  DFHPF10   PIC  X  VALUE  ':'.
  1365   02  DFHPF11   PIC  X  VALUE  '#'.
  1366   02  DFHPF12   PIC  X  VALUE  '@'.
  1367   02  DFHPF13   PIC  X  VALUE  'A'.
  1368   02  DFHPF14   PIC  X  VALUE  'B'.
  1369   02  DFHPF15   PIC  X  VALUE  'C'.
  1370   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  28
* EL131.cbl
  1371   02  DFHPF17   PIC  X  VALUE  'E'.
  1372   02  DFHPF18   PIC  X  VALUE  'F'.
  1373   02  DFHPF19   PIC  X  VALUE  'G'.
  1374   02  DFHPF20   PIC  X  VALUE  'H'.
  1375   02  DFHPF21   PIC  X  VALUE  'I'.
  1376*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1377   02  DFHPF22   PIC  X  VALUE  '['.
  1378   02  DFHPF23   PIC  X  VALUE  '.'.
  1379   02  DFHPF24   PIC  X  VALUE  '<'.
  1380   02  DFHMSRE   PIC  X  VALUE  'X'.
  1381   02  DFHSTRF   PIC  X  VALUE  'h'.
  1382   02  DFHTRIG   PIC  X  VALUE  '"'.
  1383 01  FILLER REDEFINES DFHAID.
  1384     12  FILLER                  PIC X(8).
  1385     12  AID-KEYS OCCURS 24 TIMES.
  1386         16  FILLER              PIC X.
  1387
  1388*                                COPY EL131S.
  1389 01  EL131AI.
  1390     05  FILLER            PIC  X(0012).
  1391*    -------------------------------
  1392     05  DATEL PIC S9(0004) COMP.
  1393     05  DATEF PIC  X(0001).
  1394     05  FILLER REDEFINES DATEF.
  1395         10  DATEA PIC  X(0001).
  1396     05  DATEI PIC  X(0008).
  1397*    -------------------------------
  1398     05  TIMEL PIC S9(0004) COMP.
  1399     05  TIMEF PIC  X(0001).
  1400     05  FILLER REDEFINES TIMEF.
  1401         10  TIMEA PIC  X(0001).
  1402     05  TIMEI PIC  X(0005).
  1403*    -------------------------------
  1404     05  SEQUL PIC S9(0004) COMP.
  1405     05  SEQUF PIC  X(0001).
  1406     05  FILLER REDEFINES SEQUF.
  1407         10  SEQUA PIC  X(0001).
  1408     05  SEQUI PIC  X(0010).
  1409*    -------------------------------
  1410     05  COMPL PIC S9(0004) COMP.
  1411     05  COMPF PIC  X(0001).
  1412     05  FILLER REDEFINES COMPF.
  1413         10  COMPA PIC  X(0001).
  1414     05  COMPI PIC  X(0003).
  1415*    -------------------------------
  1416     05  USERIDL PIC S9(0004) COMP.
  1417     05  USERIDF PIC  X(0001).
  1418     05  FILLER REDEFINES USERIDF.
  1419         10  USERIDA PIC  X(0001).
  1420     05  USERIDI PIC  X(0004).
  1421*    -------------------------------
  1422     05  LABEL1L PIC S9(0004) COMP.
  1423     05  LABEL1F PIC  X(0001).
  1424     05  FILLER REDEFINES LABEL1F.
  1425         10  LABEL1A PIC  X(0001).
  1426     05  LABEL1I PIC  X(0011).
  1427*    -------------------------------
  1428     05  PCERTNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  29
* EL131.cbl
  1429     05  PCERTNOF PIC  X(0001).
  1430     05  FILLER REDEFINES PCERTNOF.
  1431         10  PCERTNOA PIC  X(0001).
  1432     05  PCERTNOI PIC  X(0010).
  1433*    -------------------------------
  1434     05  PSUFXL PIC S9(0004) COMP.
  1435     05  PSUFXF PIC  X(0001).
  1436     05  FILLER REDEFINES PSUFXF.
  1437         10  PSUFXA PIC  X(0001).
  1438     05  PSUFXI PIC  X(0001).
  1439*    -------------------------------
  1440     05  CCNOL PIC S9(0004) COMP.
  1441     05  CCNOF PIC  X(0001).
  1442     05  FILLER REDEFINES CCNOF.
  1443         10  CCNOA PIC  X(0001).
  1444     05  CCNOI PIC  X(0016).
  1445*    -------------------------------
  1446     05  MAINTL PIC S9(0004) COMP.
  1447     05  MAINTF PIC  X(0001).
  1448     05  FILLER REDEFINES MAINTF.
  1449         10  MAINTA PIC  X(0001).
  1450     05  MAINTI PIC  X(0001).
  1451*    -------------------------------
  1452     05  CLAIML PIC S9(0004) COMP.
  1453     05  CLAIMF PIC  X(0001).
  1454     05  FILLER REDEFINES CLAIMF.
  1455         10  CLAIMA PIC  X(0001).
  1456     05  CLAIMI PIC  X(0007).
  1457*    -------------------------------
  1458     05  CARRL PIC S9(0004) COMP.
  1459     05  CARRF PIC  X(0001).
  1460     05  FILLER REDEFINES CARRF.
  1461         10  CARRA PIC  X(0001).
  1462     05  CARRI PIC  X(0001).
  1463*    -------------------------------
  1464     05  CERTL PIC S9(0004) COMP.
  1465     05  CERTF PIC  X(0001).
  1466     05  FILLER REDEFINES CERTF.
  1467         10  CERTA PIC  X(0001).
  1468     05  CERTI PIC  X(0010).
  1469*    -------------------------------
  1470     05  SUFXL PIC S9(0004) COMP.
  1471     05  SUFXF PIC  X(0001).
  1472     05  FILLER REDEFINES SUFXF.
  1473         10  SUFXA PIC  X(0001).
  1474     05  SUFXI PIC  X(0001).
  1475*    -------------------------------
  1476     05  TYPEL PIC S9(0004) COMP.
  1477     05  TYPEF PIC  X(0001).
  1478     05  FILLER REDEFINES TYPEF.
  1479         10  TYPEA PIC  X(0001).
  1480     05  TYPEI PIC  X(0001).
  1481*    -------------------------------
  1482     05  BENPERL PIC S9(0004) COMP.
  1483     05  BENPERF PIC  X(0001).
  1484     05  FILLER REDEFINES BENPERF.
  1485         10  BENPERA PIC  X(0001).
  1486     05  BENPERI PIC  99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  30
* EL131.cbl
  1487*    -------------------------------
  1488     05  INSTYPEL PIC S9(0004) COMP.
  1489     05  INSTYPEF PIC  X(0001).
  1490     05  FILLER REDEFINES INSTYPEF.
  1491         10  INSTYPEA PIC  X(0001).
  1492     05  INSTYPEI PIC  X(0001).
  1493*    -------------------------------
  1494     05  STATUSL PIC S9(0004) COMP.
  1495     05  STATUSF PIC  X(0001).
  1496     05  FILLER REDEFINES STATUSF.
  1497         10  STATUSA PIC  X(0001).
  1498     05  STATUSI PIC  X(0006).
  1499*    -------------------------------
  1500     05  INCL PIC S9(0004) COMP.
  1501     05  INCF PIC  X(0001).
  1502     05  FILLER REDEFINES INCF.
  1503         10  INCA PIC  X(0001).
  1504     05  INCI PIC  X(0008).
  1505*    -------------------------------
  1506     05  REPL PIC S9(0004) COMP.
  1507     05  REPF PIC  X(0001).
  1508     05  FILLER REDEFINES REPF.
  1509         10  REPA PIC  X(0001).
  1510     05  REPI PIC  X(0008).
  1511*    -------------------------------
  1512     05  ICD1L PIC S9(0004) COMP.
  1513     05  ICD1F PIC  X(0001).
  1514     05  FILLER REDEFINES ICD1F.
  1515         10  ICD1A PIC  X(0001).
  1516     05  ICD1I PIC  X(0008).
  1517*    -------------------------------
  1518     05  ICD2L PIC S9(0004) COMP.
  1519     05  ICD2F PIC  X(0001).
  1520     05  FILLER REDEFINES ICD2F.
  1521         10  ICD2A PIC  X(0001).
  1522     05  ICD2I PIC  X(0008).
  1523*    -------------------------------
  1524     05  DIAGL PIC S9(0004) COMP.
  1525     05  DIAGF PIC  X(0001).
  1526     05  FILLER REDEFINES DIAGF.
  1527         10  DIAGA PIC  X(0001).
  1528     05  DIAGI PIC  X(0060).
  1529*    -------------------------------
  1530     05  ACCSWL PIC S9(0004) COMP.
  1531     05  ACCSWF PIC  X(0001).
  1532     05  FILLER REDEFINES ACCSWF.
  1533         10  ACCSWA PIC  X(0001).
  1534     05  ACCSWI PIC  X(0001).
  1535*    -------------------------------
  1536     05  BENEL PIC S9(0004) COMP.
  1537     05  BENEF PIC  X(0001).
  1538     05  FILLER REDEFINES BENEF.
  1539         10  BENEA PIC  X(0001).
  1540     05  BENEI PIC  X(0010).
  1541*    -------------------------------
  1542     05  BIRTHL PIC S9(0004) COMP.
  1543     05  BIRTHF PIC  X(0001).
  1544     05  FILLER REDEFINES BIRTHF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  31
* EL131.cbl
  1545         10  BIRTHA PIC  X(0001).
  1546     05  BIRTHI PIC  X(0008).
  1547*    -------------------------------
  1548     05  SOCIALL PIC S9(0004) COMP.
  1549     05  SOCIALF PIC  X(0001).
  1550     05  FILLER REDEFINES SOCIALF.
  1551         10  SOCIALA PIC  X(0001).
  1552     05  SOCIALI PIC  X(0011).
  1553*    -------------------------------
  1554     05  SEXL PIC S9(0004) COMP.
  1555     05  SEXF PIC  X(0001).
  1556     05  FILLER REDEFINES SEXF.
  1557         10  SEXA PIC  X(0001).
  1558     05  SEXI PIC  X(0001).
  1559*    -------------------------------
  1560     05  MLNAMEL PIC S9(0004) COMP.
  1561     05  MLNAMEF PIC  X(0001).
  1562     05  FILLER REDEFINES MLNAMEF.
  1563         10  MLNAMEA PIC  X(0001).
  1564     05  MLNAMEI PIC  X(0015).
  1565*    -------------------------------
  1566     05  MFNAMEL PIC S9(0004) COMP.
  1567     05  MFNAMEF PIC  X(0001).
  1568     05  FILLER REDEFINES MFNAMEF.
  1569         10  MFNAMEA PIC  X(0001).
  1570     05  MFNAMEI PIC  X(0012).
  1571*    -------------------------------
  1572     05  MMINITL PIC S9(0004) COMP.
  1573     05  MMINITF PIC  X(0001).
  1574     05  FILLER REDEFINES MMINITF.
  1575         10  MMINITA PIC  X(0001).
  1576     05  MMINITI PIC  X(0001).
  1577*    -------------------------------
  1578     05  AUTHRCVL PIC S9(0004) COMP.
  1579     05  AUTHRCVF PIC  X(0001).
  1580     05  FILLER REDEFINES AUTHRCVF.
  1581         10  AUTHRCVA PIC  X(0001).
  1582     05  AUTHRCVI PIC  X(0001).
  1583*    -------------------------------
  1584     05  CRTLNMEL PIC S9(0004) COMP.
  1585     05  CRTLNMEF PIC  X(0001).
  1586     05  FILLER REDEFINES CRTLNMEF.
  1587         10  CRTLNMEA PIC  X(0001).
  1588     05  CRTLNMEI PIC  X(0015).
  1589*    -------------------------------
  1590     05  CRTFNMEL PIC S9(0004) COMP.
  1591     05  CRTFNMEF PIC  X(0001).
  1592     05  FILLER REDEFINES CRTFNMEF.
  1593         10  CRTFNMEA PIC  X(0001).
  1594     05  CRTFNMEI PIC  X(0012).
  1595*    -------------------------------
  1596     05  CRTINITL PIC S9(0004) COMP.
  1597     05  CRTINITF PIC  X(0001).
  1598     05  FILLER REDEFINES CRTINITF.
  1599         10  CRTINITA PIC  X(0001).
  1600     05  CRTINITI PIC  X(0001).
  1601*    -------------------------------
  1602     05  LOANBALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  32
* EL131.cbl
  1603     05  LOANBALF PIC  X(0001).
  1604     05  FILLER REDEFINES LOANBALF.
  1605         10  LOANBALA PIC  X(0001).
  1606     05  LOANBALI PIC  9(7)V99.
  1607*    -------------------------------
  1608     05  PROCL PIC S9(0004) COMP.
  1609     05  PROCF PIC  X(0001).
  1610     05  FILLER REDEFINES PROCF.
  1611         10  PROCA PIC  X(0001).
  1612     05  PROCI PIC  X(0004).
  1613*    -------------------------------
  1614     05  SUPVL PIC S9(0004) COMP.
  1615     05  SUPVF PIC  X(0001).
  1616     05  FILLER REDEFINES SUPVF.
  1617         10  SUPVA PIC  X(0001).
  1618     05  SUPVI PIC  X(0001).
  1619*    -------------------------------
  1620     05  PRICDL PIC S9(0004) COMP.
  1621     05  PRICDF PIC  X(0001).
  1622     05  FILLER REDEFINES PRICDF.
  1623         10  PRICDA PIC  X(0001).
  1624     05  PRICDI PIC  X(0001).
  1625*    -------------------------------
  1626     05  CRITPL PIC S9(0004) COMP.
  1627     05  CRITPF PIC  X(0001).
  1628     05  FILLER REDEFINES CRITPF.
  1629         10  CRITPA PIC  X(0001).
  1630     05  CRITPI PIC  X(0002).
  1631*    -------------------------------
  1632     05  EXTENSL PIC S9(0004) COMP.
  1633     05  EXTENSF PIC  X(0001).
  1634     05  FILLER REDEFINES EXTENSF.
  1635         10  EXTENSA PIC  X(0001).
  1636     05  EXTENSI PIC  99.
  1637*    -------------------------------
  1638     05  FILETOL PIC S9(0004) COMP.
  1639     05  FILETOF PIC  X(0001).
  1640     05  FILLER REDEFINES FILETOF.
  1641         10  FILETOA PIC  X(0001).
  1642     05  FILETOI PIC  X(0004).
  1643*    -------------------------------
  1644     05  PTHRHDGL PIC S9(0004) COMP.
  1645     05  PTHRHDGF PIC  X(0001).
  1646     05  FILLER REDEFINES PTHRHDGF.
  1647         10  PTHRHDGA PIC  X(0001).
  1648     05  PTHRHDGI PIC  X(0010).
  1649*    -------------------------------
  1650     05  PDTHRUL PIC S9(0004) COMP.
  1651     05  PDTHRUF PIC  X(0001).
  1652     05  FILLER REDEFINES PDTHRUF.
  1653         10  PDTHRUA PIC  X(0001).
  1654     05  PDTHRUI PIC  X(0008).
  1655*    -------------------------------
  1656     05  PDAMTL PIC S9(0004) COMP.
  1657     05  PDAMTF PIC  X(0001).
  1658     05  FILLER REDEFINES PDAMTF.
  1659         10  PDAMTA PIC  X(0001).
  1660     05  PDAMTI PIC  9(7)V99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  33
* EL131.cbl
  1661*    -------------------------------
  1662     05  NODAYSL PIC S9(0004) COMP.
  1663     05  NODAYSF PIC  X(0001).
  1664     05  FILLER REDEFINES NODAYSF.
  1665         10  NODAYSA PIC  X(0001).
  1666     05  NODAYSI PIC  9(5).
  1667*    -------------------------------
  1668     05  NOPMTSL PIC S9(0004) COMP.
  1669     05  NOPMTSF PIC  X(0001).
  1670     05  FILLER REDEFINES NOPMTSF.
  1671         10  NOPMTSA PIC  X(0001).
  1672     05  NOPMTSI PIC  9(4).
  1673*    -------------------------------
  1674     05  FORMTYPL PIC S9(0004) COMP.
  1675     05  FORMTYPF PIC  X(0001).
  1676     05  FILLER REDEFINES FORMTYPF.
  1677         10  FORMTYPA PIC  X(0001).
  1678     05  FORMTYPI PIC  X(0001).
  1679*    -------------------------------
  1680     05  ESTL PIC S9(0004) COMP.
  1681     05  ESTF PIC  X(0001).
  1682     05  FILLER REDEFINES ESTF.
  1683         10  ESTA PIC  X(0001).
  1684     05  ESTI PIC  X(0008).
  1685*    -------------------------------
  1686     05  AUIDL PIC S9(0004) COMP.
  1687     05  AUIDF PIC  X(0001).
  1688     05  FILLER REDEFINES AUIDF.
  1689         10  AUIDA PIC  X(0001).
  1690     05  AUIDI PIC  X(0004).
  1691*    -------------------------------
  1692     05  OCCL PIC S9(0004) COMP.
  1693     05  OCCF PIC  X(0001).
  1694     05  FILLER REDEFINES OCCF.
  1695         10  OCCA PIC  X(0001).
  1696     05  OCCI PIC  X(0006).
  1697*    -------------------------------
  1698     05  MNTDTL PIC S9(0004) COMP.
  1699     05  MNTDTF PIC  X(0001).
  1700     05  FILLER REDEFINES MNTDTF.
  1701         10  MNTDTA PIC  X(0001).
  1702     05  MNTDTI PIC  X(0008).
  1703*    -------------------------------
  1704     05  MNTTYPEL PIC S9(0004) COMP.
  1705     05  MNTTYPEF PIC  X(0001).
  1706     05  FILLER REDEFINES MNTTYPEF.
  1707         10  MNTTYPEA PIC  X(0001).
  1708     05  MNTTYPEI PIC  X(0006).
  1709*    -------------------------------
  1710     05  CERTCARL PIC S9(0004) COMP.
  1711     05  CERTCARF PIC  X(0001).
  1712     05  FILLER REDEFINES CERTCARF.
  1713         10  CERTCARA PIC  X(0001).
  1714     05  CERTCARI PIC  X(0001).
  1715*    -------------------------------
  1716     05  CERTGRPL PIC S9(0004) COMP.
  1717     05  CERTGRPF PIC  X(0001).
  1718     05  FILLER REDEFINES CERTGRPF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  34
* EL131.cbl
  1719         10  CERTGRPA PIC  X(0001).
  1720     05  CERTGRPI PIC  X(0006).
  1721*    -------------------------------
  1722     05  CERTSTL PIC S9(0004) COMP.
  1723     05  CERTSTF PIC  X(0001).
  1724     05  FILLER REDEFINES CERTSTF.
  1725         10  CERTSTA PIC  X(0001).
  1726     05  CERTSTI PIC  X(0002).
  1727*    -------------------------------
  1728     05  CERTACTL PIC S9(0004) COMP.
  1729     05  CERTACTF PIC  X(0001).
  1730     05  FILLER REDEFINES CERTACTF.
  1731         10  CERTACTA PIC  X(0001).
  1732     05  CERTACTI PIC  X(0010).
  1733*    -------------------------------
  1734     05  CERTEFFL PIC S9(0004) COMP.
  1735     05  CERTEFFF PIC  X(0001).
  1736     05  FILLER REDEFINES CERTEFFF.
  1737         10  CERTEFFA PIC  X(0001).
  1738     05  CERTEFFI PIC  X(0008).
  1739*    -------------------------------
  1740     05  ISSAGEL PIC S9(0004) COMP.
  1741     05  ISSAGEF PIC  X(0001).
  1742     05  FILLER REDEFINES ISSAGEF.
  1743         10  ISSAGEA PIC  X(0001).
  1744     05  ISSAGEI PIC  X(0002).
  1745*    -------------------------------
  1746     05  APRL PIC S9(0004) COMP.
  1747     05  APRF PIC  X(0001).
  1748     05  FILLER REDEFINES APRF.
  1749         10  APRA PIC  X(0001).
  1750     05  APRI PIC  9(4)V9(4).
  1751*    -------------------------------
  1752     05  PMTFREQL PIC S9(0004) COMP.
  1753     05  PMTFREQF PIC  X(0001).
  1754     05  FILLER REDEFINES PMTFREQF.
  1755         10  PMTFREQA PIC  X(0001).
  1756     05  PMTFREQI PIC  99.
  1757*    -------------------------------
  1758     05  INDGRPL PIC S9(0004) COMP.
  1759     05  INDGRPF PIC  X(0001).
  1760     05  FILLER REDEFINES INDGRPF.
  1761         10  INDGRPA PIC  X(0001).
  1762     05  INDGRPI PIC  X(0001).
  1763*    -------------------------------
  1764     05  PREMTYPL PIC S9(0004) COMP.
  1765     05  PREMTYPF PIC  X(0001).
  1766     05  FILLER REDEFINES PREMTYPF.
  1767         10  PREMTYPA PIC  X(0001).
  1768     05  PREMTYPI PIC  X(0001).
  1769*    -------------------------------
  1770     05  REINCDL PIC S9(0004) COMP.
  1771     05  REINCDF PIC  X(0001).
  1772     05  FILLER REDEFINES REINCDF.
  1773         10  REINCDA PIC  X(0001).
  1774     05  REINCDI PIC  X(0001).
  1775*    -------------------------------
  1776     05  JNTLNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  35
* EL131.cbl
  1777     05  JNTLNMEF PIC  X(0001).
  1778     05  FILLER REDEFINES JNTLNMEF.
  1779         10  JNTLNMEA PIC  X(0001).
  1780     05  JNTLNMEI PIC  X(0015).
  1781*    -------------------------------
  1782     05  JNTFNMEL PIC S9(0004) COMP.
  1783     05  JNTFNMEF PIC  X(0001).
  1784     05  FILLER REDEFINES JNTFNMEF.
  1785         10  JNTFNMEA PIC  X(0001).
  1786     05  JNTFNMEI PIC  X(0012).
  1787*    -------------------------------
  1788     05  JNTINITL PIC S9(0004) COMP.
  1789     05  JNTINITF PIC  X(0001).
  1790     05  FILLER REDEFINES JNTINITF.
  1791         10  JNTINITA PIC  X(0001).
  1792     05  JNTINITI PIC  X(0001).
  1793*    -------------------------------
  1794     05  JNTAGEL PIC S9(0004) COMP.
  1795     05  JNTAGEF PIC  X(0001).
  1796     05  FILLER REDEFINES JNTAGEF.
  1797         10  JNTAGEA PIC  X(0001).
  1798     05  JNTAGEI PIC  X(0002).
  1799*    -------------------------------
  1800     05  ADDONDTL PIC S9(0004) COMP.
  1801     05  ADDONDTF PIC  X(0001).
  1802     05  FILLER REDEFINES ADDONDTF.
  1803         10  ADDONDTA PIC  X(0001).
  1804     05  ADDONDTI PIC  X(0008).
  1805*    -------------------------------
  1806     05  LCVDSCRL PIC S9(0004) COMP.
  1807     05  LCVDSCRF PIC  X(0001).
  1808     05  FILLER REDEFINES LCVDSCRF.
  1809         10  LCVDSCRA PIC  X(0001).
  1810     05  LCVDSCRI PIC  X(0006).
  1811*    -------------------------------
  1812     05  LCVKINDL PIC S9(0004) COMP.
  1813     05  LCVKINDF PIC  X(0001).
  1814     05  FILLER REDEFINES LCVKINDF.
  1815         10  LCVKINDA PIC  X(0001).
  1816     05  LCVKINDI PIC  X(0003).
  1817*    -------------------------------
  1818     05  LCVCDL PIC S9(0004) COMP.
  1819     05  LCVCDF PIC  X(0001).
  1820     05  FILLER REDEFINES LCVCDF.
  1821         10  LCVCDA PIC  X(0001).
  1822     05  LCVCDI PIC  X(0002).
  1823*    -------------------------------
  1824     05  LCVOTRML PIC S9(0004) COMP.
  1825     05  LCVOTRMF PIC  X(0001).
  1826     05  FILLER REDEFINES LCVOTRMF.
  1827         10  LCVOTRMA PIC  X(0001).
  1828     05  LCVOTRMI PIC  999.
  1829*    -------------------------------
  1830     05  LCVRTRML PIC S9(0004) COMP.
  1831     05  LCVRTRMF PIC  X(0001).
  1832     05  FILLER REDEFINES LCVRTRMF.
  1833         10  LCVRTRMA PIC  X(0001).
  1834     05  LCVRTRMI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  36
* EL131.cbl
  1835*    -------------------------------
  1836     05  LCVRATEL PIC S9(0004) COMP.
  1837     05  LCVRATEF PIC  X(0001).
  1838     05  FILLER REDEFINES LCVRATEF.
  1839         10  LCVRATEA PIC  X(0001).
  1840     05  LCVRATEI PIC  9999V99.
  1841*    -------------------------------
  1842     05  LCVBENEL PIC S9(0004) COMP.
  1843     05  LCVBENEF PIC  X(0001).
  1844     05  FILLER REDEFINES LCVBENEF.
  1845         10  LCVBENEA PIC  X(0001).
  1846     05  LCVBENEI PIC  9(9)V99.
  1847*    -------------------------------
  1848     05  LCVFORML PIC S9(0004) COMP.
  1849     05  LCVFORMF PIC  X(0001).
  1850     05  FILLER REDEFINES LCVFORMF.
  1851         10  LCVFORMA PIC  X(0001).
  1852     05  LCVFORMI PIC  X(0012).
  1853*    -------------------------------
  1854     05  LCVCNDTL PIC S9(0004) COMP.
  1855     05  LCVCNDTF PIC  X(0001).
  1856     05  FILLER REDEFINES LCVCNDTF.
  1857         10  LCVCNDTA PIC  X(0001).
  1858     05  LCVCNDTI PIC  X(0008).
  1859*    -------------------------------
  1860     05  LCVEXITL PIC S9(0004) COMP.
  1861     05  LCVEXITF PIC  X(0001).
  1862     05  FILLER REDEFINES LCVEXITF.
  1863         10  LCVEXITA PIC  X(0001).
  1864     05  LCVEXITI PIC  X(0008).
  1865*    -------------------------------
  1866     05  LCVSTATL PIC S9(0004) COMP.
  1867     05  LCVSTATF PIC  X(0001).
  1868     05  FILLER REDEFINES LCVSTATF.
  1869         10  LCVSTATA PIC  X(0001).
  1870     05  LCVSTATI PIC  X(0006).
  1871*    -------------------------------
  1872     05  ACVDSCRL PIC S9(0004) COMP.
  1873     05  ACVDSCRF PIC  X(0001).
  1874     05  FILLER REDEFINES ACVDSCRF.
  1875         10  ACVDSCRA PIC  X(0001).
  1876     05  ACVDSCRI PIC  X(0006).
  1877*    -------------------------------
  1878     05  ACVKINDL PIC S9(0004) COMP.
  1879     05  ACVKINDF PIC  X(0001).
  1880     05  FILLER REDEFINES ACVKINDF.
  1881         10  ACVKINDA PIC  X(0001).
  1882     05  ACVKINDI PIC  X(0003).
  1883*    -------------------------------
  1884     05  ACVCDL PIC S9(0004) COMP.
  1885     05  ACVCDF PIC  X(0001).
  1886     05  FILLER REDEFINES ACVCDF.
  1887         10  ACVCDA PIC  X(0001).
  1888     05  ACVCDI PIC  X(0002).
  1889*    -------------------------------
  1890     05  ACVOTRML PIC S9(0004) COMP.
  1891     05  ACVOTRMF PIC  X(0001).
  1892     05  FILLER REDEFINES ACVOTRMF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  37
* EL131.cbl
  1893         10  ACVOTRMA PIC  X(0001).
  1894     05  ACVOTRMI PIC  999.
  1895*    -------------------------------
  1896     05  ACVRTRML PIC S9(0004) COMP.
  1897     05  ACVRTRMF PIC  X(0001).
  1898     05  FILLER REDEFINES ACVRTRMF.
  1899         10  ACVRTRMA PIC  X(0001).
  1900     05  ACVRTRMI PIC  X(0003).
  1901*    -------------------------------
  1902     05  ACVRATEL PIC S9(0004) COMP.
  1903     05  ACVRATEF PIC  X(0001).
  1904     05  FILLER REDEFINES ACVRATEF.
  1905         10  ACVRATEA PIC  X(0001).
  1906     05  ACVRATEI PIC  9999V99.
  1907*    -------------------------------
  1908     05  ACVBENEL PIC S9(0004) COMP.
  1909     05  ACVBENEF PIC  X(0001).
  1910     05  FILLER REDEFINES ACVBENEF.
  1911         10  ACVBENEA PIC  X(0001).
  1912     05  ACVBENEI PIC  9(9)V99.
  1913*    -------------------------------
  1914     05  ACVFORML PIC S9(0004) COMP.
  1915     05  ACVFORMF PIC  X(0001).
  1916     05  FILLER REDEFINES ACVFORMF.
  1917         10  ACVFORMA PIC  X(0001).
  1918     05  ACVFORMI PIC  X(0012).
  1919*    -------------------------------
  1920     05  ACVCNDTL PIC S9(0004) COMP.
  1921     05  ACVCNDTF PIC  X(0001).
  1922     05  FILLER REDEFINES ACVCNDTF.
  1923         10  ACVCNDTA PIC  X(0001).
  1924     05  ACVCNDTI PIC  X(0008).
  1925*    -------------------------------
  1926     05  ACVEXITL PIC S9(0004) COMP.
  1927     05  ACVEXITF PIC  X(0001).
  1928     05  FILLER REDEFINES ACVEXITF.
  1929         10  ACVEXITA PIC  X(0001).
  1930     05  ACVEXITI PIC  X(0008).
  1931*    -------------------------------
  1932     05  ACVSTATL PIC S9(0004) COMP.
  1933     05  ACVSTATF PIC  X(0001).
  1934     05  FILLER REDEFINES ACVSTATF.
  1935         10  ACVSTATA PIC  X(0001).
  1936     05  ACVSTATI PIC  X(0006).
  1937*    -------------------------------
  1938     05  LABEL2L PIC S9(0004) COMP.
  1939     05  LABEL2F PIC  X(0001).
  1940     05  FILLER REDEFINES LABEL2F.
  1941         10  LABEL2A PIC  X(0001).
  1942     05  LABEL2I PIC  X(0014).
  1943*    -------------------------------
  1944     05  BCERT1L PIC S9(0004) COMP.
  1945     05  BCERT1F PIC  X(0001).
  1946     05  FILLER REDEFINES BCERT1F.
  1947         10  BCERT1A PIC  X(0001).
  1948     05  BCERT1I PIC  X(0010).
  1949*    -------------------------------
  1950     05  BSUFX1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  38
* EL131.cbl
  1951     05  BSUFX1F PIC  X(0001).
  1952     05  FILLER REDEFINES BSUFX1F.
  1953         10  BSUFX1A PIC  X(0001).
  1954     05  BSUFX1I PIC  X(0001).
  1955*    -------------------------------
  1956     05  BCERT2L PIC S9(0004) COMP.
  1957     05  BCERT2F PIC  X(0001).
  1958     05  FILLER REDEFINES BCERT2F.
  1959         10  BCERT2A PIC  X(0001).
  1960     05  BCERT2I PIC  X(0010).
  1961*    -------------------------------
  1962     05  BSUFX2L PIC S9(0004) COMP.
  1963     05  BSUFX2F PIC  X(0001).
  1964     05  FILLER REDEFINES BSUFX2F.
  1965         10  BSUFX2A PIC  X(0001).
  1966     05  BSUFX2I PIC  X(0001).
  1967*    -------------------------------
  1968     05  BCERT3L PIC S9(0004) COMP.
  1969     05  BCERT3F PIC  X(0001).
  1970     05  FILLER REDEFINES BCERT3F.
  1971         10  BCERT3A PIC  X(0001).
  1972     05  BCERT3I PIC  X(0010).
  1973*    -------------------------------
  1974     05  BSUFX3L PIC S9(0004) COMP.
  1975     05  BSUFX3F PIC  X(0001).
  1976     05  FILLER REDEFINES BSUFX3F.
  1977         10  BSUFX3A PIC  X(0001).
  1978     05  BSUFX3I PIC  X(0001).
  1979*    -------------------------------
  1980     05  BCERT4L PIC S9(0004) COMP.
  1981     05  BCERT4F PIC  X(0001).
  1982     05  FILLER REDEFINES BCERT4F.
  1983         10  BCERT4A PIC  X(0001).
  1984     05  BCERT4I PIC  X(0010).
  1985*    -------------------------------
  1986     05  BSUFX4L PIC S9(0004) COMP.
  1987     05  BSUFX4F PIC  X(0001).
  1988     05  FILLER REDEFINES BSUFX4F.
  1989         10  BSUFX4A PIC  X(0001).
  1990     05  BSUFX4I PIC  X(0001).
  1991*    -------------------------------
  1992     05  BCERT5L PIC S9(0004) COMP.
  1993     05  BCERT5F PIC  X(0001).
  1994     05  FILLER REDEFINES BCERT5F.
  1995         10  BCERT5A PIC  X(0001).
  1996     05  BCERT5I PIC  X(0010).
  1997*    -------------------------------
  1998     05  BSUFX5L PIC S9(0004) COMP.
  1999     05  BSUFX5F PIC  X(0001).
  2000     05  FILLER REDEFINES BSUFX5F.
  2001         10  BSUFX5A PIC  X(0001).
  2002     05  BSUFX5I PIC  X(0001).
  2003*    -------------------------------
  2004     05  MSG1L PIC S9(0004) COMP.
  2005     05  MSG1F PIC  X(0001).
  2006     05  FILLER REDEFINES MSG1F.
  2007         10  MSG1A PIC  X(0001).
  2008     05  MSG1I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  39
* EL131.cbl
  2009*    -------------------------------
  2010     05  MSG2L PIC S9(0004) COMP.
  2011     05  MSG2F PIC  X(0001).
  2012     05  FILLER REDEFINES MSG2F.
  2013         10  MSG2A PIC  X(0001).
  2014     05  MSG2I PIC  X(0072).
  2015*    -------------------------------
  2016     05  PFKEYL PIC S9(0004) COMP.
  2017     05  PFKEYF PIC  X(0001).
  2018     05  FILLER REDEFINES PFKEYF.
  2019         10  PFKEYA PIC  X(0001).
  2020     05  PFKEYI PIC  99.
  2021*    -------------------------------
  2022     05  PFKEY6L PIC S9(0004) COMP.
  2023     05  PFKEY6F PIC  X(0001).
  2024     05  FILLER REDEFINES PFKEY6F.
  2025         10  PFKEY6A PIC  X(0001).
  2026     05  PFKEY6I PIC  X(0016).
  2027 01  EL131AO REDEFINES EL131AI.
  2028     05  FILLER            PIC  X(0012).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  DATEO PIC  X(0008).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  TIMEO PIC  99.99.
  2035*    -------------------------------
  2036     05  FILLER            PIC  X(0003).
  2037     05  SEQUO PIC  X(0010).
  2038*    -------------------------------
  2039     05  FILLER            PIC  X(0003).
  2040     05  COMPO PIC  X(0003).
  2041*    -------------------------------
  2042     05  FILLER            PIC  X(0003).
  2043     05  USERIDO PIC  X(0004).
  2044*    -------------------------------
  2045     05  FILLER            PIC  X(0003).
  2046     05  LABEL1O PIC  X(0011).
  2047*    -------------------------------
  2048     05  FILLER            PIC  X(0003).
  2049     05  PCERTNOO PIC  X(0010).
  2050*    -------------------------------
  2051     05  FILLER            PIC  X(0003).
  2052     05  PSUFXO PIC  X(0001).
  2053*    -------------------------------
  2054     05  FILLER            PIC  X(0003).
  2055     05  CCNOO PIC  X(0016).
  2056*    -------------------------------
  2057     05  FILLER            PIC  X(0003).
  2058     05  MAINTO PIC  X(0001).
  2059*    -------------------------------
  2060     05  FILLER            PIC  X(0003).
  2061     05  CLAIMO PIC  X(0007).
  2062*    -------------------------------
  2063     05  FILLER            PIC  X(0003).
  2064     05  CARRO PIC  X(0001).
  2065*    -------------------------------
  2066     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  40
* EL131.cbl
  2067     05  CERTO PIC  X(0010).
  2068*    -------------------------------
  2069     05  FILLER            PIC  X(0003).
  2070     05  SUFXO PIC  X(0001).
  2071*    -------------------------------
  2072     05  FILLER            PIC  X(0003).
  2073     05  TYPEO PIC  X(0001).
  2074*    -------------------------------
  2075     05  FILLER            PIC  X(0003).
  2076     05  BENPERO PIC  X(0002).
  2077*    -------------------------------
  2078     05  FILLER            PIC  X(0003).
  2079     05  INSTYPEO PIC  X(0001).
  2080*    -------------------------------
  2081     05  FILLER            PIC  X(0003).
  2082     05  STATUSO PIC  X(0006).
  2083*    -------------------------------
  2084     05  FILLER            PIC  X(0003).
  2085     05  INCO PIC  X(0008).
  2086*    -------------------------------
  2087     05  FILLER            PIC  X(0003).
  2088     05  REPO PIC  X(0008).
  2089*    -------------------------------
  2090     05  FILLER            PIC  X(0003).
  2091     05  ICD1O PIC  X(0008).
  2092*    -------------------------------
  2093     05  FILLER            PIC  X(0003).
  2094     05  ICD2O PIC  X(0008).
  2095*    -------------------------------
  2096     05  FILLER            PIC  X(0003).
  2097     05  DIAGO PIC  X(0060).
  2098*    -------------------------------
  2099     05  FILLER            PIC  X(0003).
  2100     05  ACCSWO PIC  X(0001).
  2101*    -------------------------------
  2102     05  FILLER            PIC  X(0003).
  2103     05  BENEO PIC  X(0010).
  2104*    -------------------------------
  2105     05  FILLER            PIC  X(0003).
  2106     05  BIRTHO PIC  X(0008).
  2107*    -------------------------------
  2108     05  FILLER            PIC  X(0003).
  2109     05  SOCIALO PIC  X(0011).
  2110*    -------------------------------
  2111     05  FILLER            PIC  X(0003).
  2112     05  SEXO PIC  X(0001).
  2113*    -------------------------------
  2114     05  FILLER            PIC  X(0003).
  2115     05  MLNAMEO PIC  X(0015).
  2116*    -------------------------------
  2117     05  FILLER            PIC  X(0003).
  2118     05  MFNAMEO PIC  X(0012).
  2119*    -------------------------------
  2120     05  FILLER            PIC  X(0003).
  2121     05  MMINITO PIC  X(0001).
  2122*    -------------------------------
  2123     05  FILLER            PIC  X(0003).
  2124     05  AUTHRCVO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  41
* EL131.cbl
  2125*    -------------------------------
  2126     05  FILLER            PIC  X(0003).
  2127     05  CRTLNMEO PIC  X(0015).
  2128*    -------------------------------
  2129     05  FILLER            PIC  X(0003).
  2130     05  CRTFNMEO PIC  X(0012).
  2131*    -------------------------------
  2132     05  FILLER            PIC  X(0003).
  2133     05  CRTINITO PIC  X(0001).
  2134*    -------------------------------
  2135     05  FILLER            PIC  X(0003).
  2136     05  LOANBALO PIC  ZZZZZ9.99.
  2137*    -------------------------------
  2138     05  FILLER            PIC  X(0003).
  2139     05  PROCO PIC  X(0004).
  2140*    -------------------------------
  2141     05  FILLER            PIC  X(0003).
  2142     05  SUPVO PIC  X(0001).
  2143*    -------------------------------
  2144     05  FILLER            PIC  X(0003).
  2145     05  PRICDO PIC  X(0001).
  2146*    -------------------------------
  2147     05  FILLER            PIC  X(0003).
  2148     05  CRITPO PIC  X(0002).
  2149*    -------------------------------
  2150     05  FILLER            PIC  X(0003).
  2151     05  EXTENSO PIC  X(0002).
  2152*    -------------------------------
  2153     05  FILLER            PIC  X(0003).
  2154     05  FILETOO PIC  X(0004).
  2155*    -------------------------------
  2156     05  FILLER            PIC  X(0003).
  2157     05  PTHRHDGO PIC  X(0010).
  2158*    -------------------------------
  2159     05  FILLER            PIC  X(0003).
  2160     05  PDTHRUO PIC  X(0008).
  2161*    -------------------------------
  2162     05  FILLER            PIC  X(0003).
  2163     05  PDAMTO PIC  Z(06).99.
  2164*    -------------------------------
  2165     05  FILLER            PIC  X(0003).
  2166     05  NODAYSO PIC  ZZZ99.
  2167*    -------------------------------
  2168     05  FILLER            PIC  X(0003).
  2169     05  NOPMTSO PIC  ZZ99.
  2170*    -------------------------------
  2171     05  FILLER            PIC  X(0003).
  2172     05  FORMTYPO PIC  X(0001).
  2173*    -------------------------------
  2174     05  FILLER            PIC  X(0003).
  2175     05  ESTO PIC  X(0008).
  2176*    -------------------------------
  2177     05  FILLER            PIC  X(0003).
  2178     05  AUIDO PIC  X(0004).
  2179*    -------------------------------
  2180     05  FILLER            PIC  X(0003).
  2181     05  OCCO PIC  X(0006).
  2182*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  42
* EL131.cbl
  2183     05  FILLER            PIC  X(0003).
  2184     05  MNTDTO PIC  X(0008).
  2185*    -------------------------------
  2186     05  FILLER            PIC  X(0003).
  2187     05  MNTTYPEO PIC  X(0006).
  2188*    -------------------------------
  2189     05  FILLER            PIC  X(0003).
  2190     05  CERTCARO PIC  X(0001).
  2191*    -------------------------------
  2192     05  FILLER            PIC  X(0003).
  2193     05  CERTGRPO PIC  X(0006).
  2194*    -------------------------------
  2195     05  FILLER            PIC  X(0003).
  2196     05  CERTSTO PIC  X(0002).
  2197*    -------------------------------
  2198     05  FILLER            PIC  X(0003).
  2199     05  CERTACTO PIC  X(0010).
  2200*    -------------------------------
  2201     05  FILLER            PIC  X(0003).
  2202     05  CERTEFFO PIC  X(0008).
  2203*    -------------------------------
  2204     05  FILLER            PIC  X(0003).
  2205     05  ISSAGEO PIC  X(0002).
  2206*    -------------------------------
  2207     05  FILLER            PIC  X(0003).
  2208     05  APRO PIC  9(3).9(4).
  2209*    -------------------------------
  2210     05  FILLER            PIC  X(0003).
  2211     05  PMTFREQO PIC  99.
  2212*    -------------------------------
  2213     05  FILLER            PIC  X(0003).
  2214     05  INDGRPO PIC  X(0001).
  2215*    -------------------------------
  2216     05  FILLER            PIC  X(0003).
  2217     05  PREMTYPO PIC  X(0001).
  2218*    -------------------------------
  2219     05  FILLER            PIC  X(0003).
  2220     05  REINCDO PIC  X(0001).
  2221*    -------------------------------
  2222     05  FILLER            PIC  X(0003).
  2223     05  JNTLNMEO PIC  X(0015).
  2224*    -------------------------------
  2225     05  FILLER            PIC  X(0003).
  2226     05  JNTFNMEO PIC  X(0012).
  2227*    -------------------------------
  2228     05  FILLER            PIC  X(0003).
  2229     05  JNTINITO PIC  X(0001).
  2230*    -------------------------------
  2231     05  FILLER            PIC  X(0003).
  2232     05  JNTAGEO PIC  X(0002).
  2233*    -------------------------------
  2234     05  FILLER            PIC  X(0003).
  2235     05  ADDONDTO PIC  X(0008).
  2236*    -------------------------------
  2237     05  FILLER            PIC  X(0003).
  2238     05  LCVDSCRO PIC  X(0006).
  2239*    -------------------------------
  2240     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  43
* EL131.cbl
  2241     05  LCVKINDO PIC  X(0003).
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  LCVCDO PIC  X(0002).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  LCVOTRMO PIC  999.
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  LCVRTRMO PIC  999.
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  LCVRATEO PIC  ZZZ.ZZ.
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  LCVFORMO PIC  X(0012).
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  LCVCNDTO PIC  X(0008).
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  LCVEXITO PIC  X(0008).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  LCVSTATO PIC  X(0006).
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  ACVDSCRO PIC  X(0006).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  ACVKINDO PIC  X(0003).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  ACVCDO PIC  X(0002).
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  ACVOTRMO PIC  999.
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  ACVRTRMO PIC  999.
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  ACVRATEO PIC  ZZZ.ZZ.
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2290*    -------------------------------
  2291     05  FILLER            PIC  X(0003).
  2292     05  ACVFORMO PIC  X(0012).
  2293*    -------------------------------
  2294     05  FILLER            PIC  X(0003).
  2295     05  ACVCNDTO PIC  X(0008).
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  ACVEXITO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  44
* EL131.cbl
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  ACVSTATO PIC  X(0006).
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  LABEL2O PIC  X(0014).
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  BCERT1O PIC  X(0010).
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  BSUFX1O PIC  X(0001).
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
  2313     05  BCERT2O PIC  X(0010).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  BSUFX2O PIC  X(0001).
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  BCERT3O PIC  X(0010).
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  BSUFX3O PIC  X(0001).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  BCERT4O PIC  X(0010).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  BSUFX4O PIC  X(0001).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  BCERT5O PIC  X(0010).
  2332*    -------------------------------
  2333     05  FILLER            PIC  X(0003).
  2334     05  BSUFX5O PIC  X(0001).
  2335*    -------------------------------
  2336     05  FILLER            PIC  X(0003).
  2337     05  MSG1O PIC  X(0072).
  2338*    -------------------------------
  2339     05  FILLER            PIC  X(0003).
  2340     05  MSG2O PIC  X(0072).
  2341*    -------------------------------
  2342     05  FILLER            PIC  X(0003).
  2343     05  PFKEYO PIC  X(0002).
  2344*    -------------------------------
  2345     05  FILLER            PIC  X(0003).
  2346     05  PFKEY6O PIC  X(0016).
  2347*    -------------------------------
  2348
  2349*                                COPY ELCEMIB SUPPRESS.
  2350******************************************************************
  2351*                                                                *
  2352*                                                                *
  2353*                            ELCEMIB.                            *
  2354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2355*                            VMOD=2.005                          *
  2356*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  45
* EL131.cbl
  2357*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2358*                                                                *
  2359******************************************************************
  2360 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2361     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2362     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2363     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2364     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2365     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2366     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2367     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2368     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2369     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2370         88  EMI-NO-ERRORS                    VALUE '1'.
  2371         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2372         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2373     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2374         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2375     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2376         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2377         88  EMI-AREA1-FULL                   VALUE '2'.
  2378     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2379         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2380         88  EMI-AREA2-FULL                   VALUE '2'.
  2381     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2382         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2383         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2384         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2385         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2386         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2387     12  EMI-ERROR-LINES.
  2388         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2389         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2390         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2391         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2392             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2393                 24  EMI-ERR-NUM         PIC X(4).
  2394                 24  EMI-FILLER          PIC X.
  2395                 24  EMI-SEV             PIC X.
  2396                 24  FILLER              PIC X.
  2397             20  FILLER                  PIC X(02).
  2398     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2399         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2400             20  EMI-ERROR-NUMBER    PIC X(4).
  2401             20  EMI-FILL            PIC X.
  2402             20  EMI-SEVERITY        PIC X.
  2403             20  FILLER              PIC X.
  2404             20  EMI-ERROR-TEXT.
  2405                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2406                 24  FILLER          PIC X(55).
  2407     12  EMI-SEVERITY-SAVE           PIC X.
  2408         88  EMI-NOTE                    VALUE 'N'.
  2409         88  EMI-WARNING                 VALUE 'W'.
  2410         88  EMI-FORCABLE                VALUE 'F'.
  2411         88  EMI-FATAL                   VALUE 'X'.
  2412     12  EMI-MESSAGE-FLAG            PIC X.
  2413         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2414         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  46
* EL131.cbl
  2415     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2416     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2417         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2418         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2419         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2420     12  emi-claim-no                pic x(7).
  2421     12  emi-claim-type              pic x(6).
  2422     12  FILLER                      PIC X(124)  VALUE SPACES.
  2423     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2424     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2425     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2426     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2427
  2428*                                COPY ELCJPFX SUPPRESS.
  2429******************************************************************
  2430*                                                                *
  2431*                                                                *
  2432*                            ELCJPFX.                            *
  2433*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2434*                            VMOD=2.002                          *
  2435*                                                                *
  2436*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2437*                                                                *
  2438*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2439*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2440*        ELCNTL - CONTROL FILE                                   *
  2441*        ELMSTR - CLAIM MASTERS                                  *
  2442*        ELTRLR - ACTIVITY TRAILERS                              *
  2443*        ELCHKQ - CHECK QUE                                      *
  2444******************************************************************
  2445 01  JOURNAL-RECORD.
  2446     12  jp-date                     pic s9(5) comp-3.
  2447     12  jp-time                     pic s9(7) comp-3.
  2448     12  JP-USER-ID                  PIC X(4).
  2449     12  JP-FILE-ID                  PIC X(8).
  2450     12  JP-PROGRAM-ID               PIC X(8).
  2451     12  JP-RECORD-TYPE              PIC X.
  2452         88 JP-ADD              VALUE 'A'.
  2453         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2454         88 JP-AFTER-CHANGE     VALUE 'C'.
  2455         88 JP-DELETE           VALUE 'D'.
  2456         88 JP-GENERIC-DELETE   VALUE 'G'.
  2457         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2458         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2459     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2460     12  JP-RECORD-AREA
  2461
  2462
  2463                                 PIC X(750).
  2464
  2465*                                COPY ELCCALC.
  2466******************************************************************
  2467*                                                                *
  2468*                           ELCCALC.                            *
  2469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2470*                            VMOD=2.025                          *
  2471*                                                                *
  2472*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  47
* EL131.cbl
  2473*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2474*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2475*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2476*                                                                *
  2477*  PASSED TO ELRTRM                                              *
  2478*  -----------------                                             *
  2479*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2480*  ORIGINAL TERM                                                 *
  2481*  BEGINNING DATE                                                *
  2482*  ENDING DATE                                                   *
  2483*  COMPANY I.D.                                                  *
  2484*  ACCOUNT MASTER USER FIELD                                     *
  2485*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2486*  FREE LOOK DAYS                                                *
  2487*                                                                *
  2488*  RETURNED FROM ELRTRM                                          *
  2489*  ---------------------                                         *
  2490*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2491*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2492*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2493*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2494*----------------------------------------------------------------*
  2495*  PASSED TO ELRAMT                                              *
  2496*  ----------------                                              *
  2497*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2498*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2499*  ORIGINAL AMOUNT                                               *
  2500*  ALTERNATE BENEFIT (BALLON)                                    *
  2501*  A.P.R. - NET PAY ONLY                                         *
  2502*  METHOD
  2503*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2504*  COMPANY I.D.                                                  *
  2505*  BENEFIT TYPE                                                  *
  2506*                                                                *
  2507*  RETURNED FROM ELRAMT                                          *
  2508*  --------------------                                          *
  2509*  REMAINING AMOUNT 1 - CURRENT                                  *
  2510*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2511*  REMAINING AMOUNT FACTOR
  2512*----------------------------------------------------------------*
  2513*  PASSED TO ELRESV                                              *
  2514*  -----------------                                             *
  2515*  CERTIFICATE EFFECTIVE DATE                                    *
  2516*  VALUATION DATE                                                *
  2517*  PAID THRU DATE                                                *
  2518*  BENEFIT                                                       *
  2519*  INCURRED DATE                                                 *
  2520*  REPORTED DATE                                                 *
  2521*  ISSUE AGE                                                     *
  2522*  TERM                                                          *
  2523*  CDT PERCENT                                                   *
  2524*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2525* *CLAIM TYPE (LIFE, A/H)                                        *
  2526* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2527* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2528*                                                                *
  2529*  RETURNED FROM ELRESV                                          *
  2530*  --------------------                                          *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  48
* EL131.cbl
  2531*  CDT TABLE USED                                                *
  2532*  CDT FACTOR USED                                               *
  2533*  PAY TO CURRENT RESERVE                                        *
  2534*  I.B.N.R. - A/H ONLY                                           *
  2535*  FUTURE (ACCRUED) AH ONLY                                      *
  2536*----------------------------------------------------------------*
  2537*  PASSED TO ELRATE                                              *
  2538*  ----------------                                              *
  2539*  CERT ISSUE DATE                                               *
  2540*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2541*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2542*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2543*  STATE CODE (CLIENT DEFINED)                                   *
  2544*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2545*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2546*  DEVIATION CODE                                                *
  2547*  ISSUE AGE                                                     *
  2548*  ORIGINAL BENEFIT AMOUNT                                       *
  2549*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2550*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2551*  BENEFIT KIND (LIFE OR A/H)                                    *
  2552*  A.P.R.                                                        *
  2553*  METHOD
  2554*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2555*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2556*  COMPANY I.D. (3 CHARACTER)                                    *
  2557*  BENEFIT CODE                                                  *
  2558*  BENEFIT OVERRIDE CODE                                         *
  2559*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2560*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2561*  JOINT INDICATOR (CSL ONLY)                                    *
  2562*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2563*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2564*                                                                *
  2565*  RETURNED FROM ELRATE                                          *
  2566*  --------------------                                          *
  2567*  CALCULATED PREMIUM                                            *
  2568*  PREMIUM RATE                                                  *
  2569*  MORTALITY CODE                                                *
  2570*  MAX ATTAINED AGE                                              *
  2571*  MAX AGE                                                       *
  2572*  MAX TERM                                                      *
  2573*  MAX MONTHLY BENEFIT                                           *
  2574*  MAX TOTAL BENIFIT                                             *
  2575*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2576*----------------------------------------------------------------*
  2577*  PASSED TO ELRFND                                              *
  2578*  ----------------                                              *
  2579*  CERT ISSUE DATE                                               *
  2580*  REFUND DATE                                                   *
  2581*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2582*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2583*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2584*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2585*  STATE CODE (CLIENT DEFINED)                                   *
  2586*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2587*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2588*  DEVIATION CODE                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  49
* EL131.cbl
  2589*  ISSUE AGE                                                     *
  2590*  ORIGINAL BENEFIT AMOUNT                                       *
  2591*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2592*  PROCESS TYPE (CANCEL)                                         *
  2593*  BENEFIT KIND (LIFE OR A/H)                                    *
  2594*  A.P.R.                                                        *
  2595*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2596*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2597*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2598*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2599*  COMPANY I.D. (3 CHARACTER)                                    *
  2600*  BENEFIT CODE                                                  *
  2601*  BENEFIT OVERRIDE CODE                                         *
  2602*                                                                *
  2603*  RETURNED FROM ELRFND                                          *
  2604*  --------------------                                          *
  2605*  CALCULATED REFUND                                             *
  2606*----------------------------------------------------------------*
  2607*  PASSED TO ELEARN                                              *
  2608*  ----------------                                              *
  2609*  CERT ISSUE DATE                                               *
  2610*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2611*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2612*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2613*  STATE CODE (CLIENT DEFINED)                                   *
  2614*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2615*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2616*  DEVIATION CODE                                                *
  2617*  ISSUE AGE                                                     *
  2618*  ORIGINAL BENEFIT AMOUNT                                       *
  2619*  BENEFIT KIND (LIFE OR A/H)                                    *
  2620*  A.P.R.                                                        *
  2621*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2622*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2623*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2624*  COMPANY I.D. (3 CHARACTER)                                    *
  2625*  BENEFIT CODE                                                  *
  2626*  BENEFIT OVERRIDE CODE                                         *
  2627*                                                                *
  2628*  RETURNED FROM ELEARN                                          *
  2629*  --------------------                                          *
  2630*  INDICATED  EARNINGS                                           *
  2631*----------------------------------------------------------------*
  2632*                 LENGTH = 450                                   *
  2633*                                                                *
  2634******************************************************************
  2635******************************************************************
  2636*                   C H A N G E   L O G
  2637*
  2638* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2639*-----------------------------------------------------------------
  2640*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2641* EFFECTIVE    NUMBER
  2642*-----------------------------------------------------------------
  2643* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2644* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2645* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2646* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  50
* EL131.cbl
  2647* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2648* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2649* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2650* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2651* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2652* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2653* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2654******************************************************************
  2655
  2656 01  CALCULATION-PASS-AREA.
  2657     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2658                                     COMP.
  2659
  2660     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2661       88  NO-CP-ERROR                             VALUE ZERO.
  2662       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2663                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2664       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2665       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2666       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2667       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2668       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2669       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2670       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2671       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2672       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2673       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2674       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2675       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2676       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2677       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2678       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2679       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2680       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2681
  2682     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2683       88  NO-CP-ERROR-2                           VALUE ZERO.
  2684***********************  INPUT AREAS ****************************
  2685
  2686     12  CP-CALCULATION-AREA.
  2687         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2688         16  CP-CERT-EFF-DT        PIC XX.
  2689         16  CP-VALUATION-DT       PIC XX.
  2690         16  CP-PAID-THRU-DT       PIC XX.
  2691         16  CP-BENEFIT-TYPE       PIC X.
  2692           88  CP-AH                               VALUE 'A' 'D'
  2693                                                   'I' 'U'.
  2694           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2695           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2696         16  CP-INCURRED-DT        PIC XX.
  2697         16  CP-REPORTED-DT        PIC XX.
  2698         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2699         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2700         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2701                                     COMP-3.
  2702         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2703                                     COMP-3.
  2704         16  CP-CDT-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  51
* EL131.cbl
  2705           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2706           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2707           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2708         16  CP-CLAIM-TYPE         PIC X.
  2709           88  CP-AH-CLAIM                         VALUE 'A'.
  2710           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2711         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2712                                     COMP-3.
  2713         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2714                                     COMP-3.
  2715         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2716                                     COMP-3.
  2717         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2718                                     COMP-3.
  2719         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2720                                     COMP-3.
  2721         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2722                                     COMP-3.
  2723         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2724                                     COMP-3.
  2725         16  CP-REM-TERM-METHOD    PIC X.
  2726           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2727           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2728           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2729           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2730           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2731           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2732           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2733         16  CP-EARNING-METHOD     PIC X.
  2734           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2735           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2736           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2737           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2738           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2739           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2740           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2741           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2742           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2743           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2744           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2745           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2746           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2747           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2748         16  CP-PROCESS-TYPE       PIC X.
  2749           88  CP-CLAIM                            VALUE '1'.
  2750           88  CP-CANCEL                           VALUE '2'.
  2751           88  CP-ISSUE                            VALUE '3'.
  2752         16  CP-SPECIAL-CALC-CD    PIC X.
  2753           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2754           88  CP-1-MTH-INTEREST               VALUE ' '.
  2755           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2756           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2757           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2758           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2759           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2760           88  CP-FARM-PLAN                    VALUE 'F'.
  2761           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2762           88  CP-2-MTH-INTEREST               VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  52
* EL131.cbl
  2763           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2764           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2765           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2766           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2767           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2768           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2769           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2770           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2771                                                     'W' 'X'.
  2772           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2773           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2774           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2775           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2776           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2777           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2778           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2779           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2780           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2781           88  CP-CSL-METH-1                   VALUE '5'.
  2782           88  CP-CSL-METH-2                   VALUE '6'.
  2783           88  CP-CSL-METH-3                   VALUE '7'.
  2784           88  CP-CSL-METH-4                   VALUE '8'.
  2785
  2786         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2787                                     COMP-3.
  2788         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2789         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2790         16  CP-STATE              PIC XX          VALUE SPACE.
  2791         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2792         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2793           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2794               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2795         16  CP-R78-OPTION         PIC X.
  2796           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2797           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2798
  2799         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2800         16  CP-IBNR-RESERVE-SW    PIC X.
  2801         16  CP-CLAIM-STATUS       PIC X.
  2802         16  CP-RATE-FILE          PIC X.
  2803         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2804                                     COMP-3.
  2805
  2806         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2807         16  CP-AH-OVERRIDE-CODE   PIC X.
  2808
  2809         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2810                                     COMP-3.
  2811         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2812                                   PIC S9(5)V99 COMP-3.
  2813         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2814                                     COMP-3.
  2815         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2816                                     COMP-3.
  2817         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2818                                     COMP-3.
  2819         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2820                                  PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  53
* EL131.cbl
  2821
  2822         16  CP-PAID-FROM-DATE     PIC X(02).
  2823         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2824         16  CP-EXT-DAYS-CALC      PIC X.
  2825           88  CP-EXT-NO-CHG                   VALUE ' '.
  2826           88  CP-EXT-CHG-LF                   VALUE '1'.
  2827           88  CP-EXT-CHG-AH                   VALUE '2'.
  2828           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2829         16  CP-DOMICILE-STATE     PIC XX.
  2830         16  CP-CARRIER            PIC X.
  2831         16  CP-REIN-FLAG          PIC X.
  2832         16  CP-REM-TRM-CALC-OPTION PIC X.
  2833           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2834                      '2' '3' '4' '5'.
  2835           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2836           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2837           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2838           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2839           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2840           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2841           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2842           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2843         16  CP-SIG-SWITCH         PIC X.
  2844         16  CP-RATING-METHOD      PIC X.
  2845           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2846           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2847           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2848           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2849           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2850           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2851           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2852           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2853           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2854         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2855                                     COMP-3.
  2856         16  CP-BEN-CATEGORY       PIC X.
  2857         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2858         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2859                                   PIC S99V9(5) COMP-3.
  2860         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2861         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2862                                   PIC S99V9(5) COMP-3.
  2863         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2864         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2865         16  CP-EXPIRE-DT          PIC XX.
  2866         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2867         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2868         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2869         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2870         16  CP-DDF-SPEC-CALC      PIC X.
  2871             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2872             88  CP-CALC-CLP              VALUE 'C'.
  2873         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2874         16  CP-CANCEL-REASON      PIC X.
  2875         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2876         16  CP-PMT-MODE           PIC X.
  2877         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2878         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  54
* EL131.cbl
  2879         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2880         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2881         16  FILLER                PIC X.
  2882
  2883***************    OUTPUT FROM ELRESV   ************************
  2884
  2885         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2886
  2887         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2888                                     COMP-3.
  2889         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2890                                     COMP-3.
  2891         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2892                                     COMP-3.
  2893         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2894                                     COMP-3.
  2895         16  FILLER                PIC X(09).
  2896***************    OUTPUT FROM ELRTRM   *************************
  2897
  2898         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2899                                     COMP-3.
  2900         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2901                                     COMP-3.
  2902         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2903                                     COMP-3.
  2904         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2905                                     COMP-3.
  2906         16  FILLER                PIC X(12).
  2907
  2908***************    OUTPUT FROM ELRAMT   *************************
  2909
  2910         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2911                                     COMP-3.
  2912         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2913                                     COMP-3.
  2914         16  FILLER                PIC X(12).
  2915
  2916***************    OUTPUT FROM ELRATE   *************************
  2917
  2918         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2919                                     COMP-3.
  2920         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2921                                     COMP-3.
  2922         16  CP-MORTALITY-CODE     PIC X(4).
  2923         16  CP-RATE-EDIT-FLAG     PIC X.
  2924             88  CP-RATES-NEED-APR                  VALUE '1'.
  2925         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2926                                     COMP-3.
  2927         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2928         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2929         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2930                                   PIC S9(7)V99 COMP-3.
  2931         16  FILLER                PIC X(07).
  2932
  2933***************    OUTPUT FROM ELRFND   *************************
  2934
  2935         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2936                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  55
* EL131.cbl
  2937         16  CP-REFUND-TYPE-USED   PIC X.
  2938           88  CP-R-AS-R78                         VALUE '1'.
  2939           88  CP-R-AS-PRORATA                     VALUE '2'.
  2940           88  CP-R-AS-CALIF                       VALUE '3'.
  2941           88  CP-R-AS-TEXAS                       VALUE '4'.
  2942           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2943           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2944           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2945           88  CP-R-AS-MEAN                        VALUE '8'.
  2946           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2947           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2948           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2949           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2950           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2951           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2952         16  FILLER                PIC X(12).
  2953
  2954***************    OUTPUT FROM ELEARN   *************************
  2955
  2956         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2957                                     COMP-3.
  2958         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2959                                     COMP-3.
  2960         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2961                                     COMP-3.
  2962         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2963                                     COMP-3.
  2964         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2965                                     COMP-3.
  2966         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2967                                     COMP-3.
  2968         16  CP-EARNING-TYPE-USED  PIC X.
  2969           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2970           88  CP-E-AS-R78                         VALUE '1'.
  2971           88  CP-E-AS-PRORATA                     VALUE '2'.
  2972           88  CP-E-AS-TEXAS                       VALUE '4'.
  2973           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2974           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2975           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2976           88  CP-E-AS-MEAN                        VALUE '8'.
  2977           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2978         16  FILLER                PIC X(12).
  2979
  2980***************    OUTPUT FROM ELPMNT   *************************
  2981
  2982         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2983                                     COMP-3.
  2984         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2985                                     COMP-3.
  2986         16  FILLER                PIC X(12).
  2987
  2988***************   MISC WORK AREAS    *****************************
  2989         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2990                                     COMP-3.
  2991         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2992                                     COMP-3.
  2993         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2994                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  56
* EL131.cbl
  2995         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2996                                     COMP-3.
  2997         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2998                                     COMP-3.
  2999         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3000                                     COMP-3.
  3001         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3002             88  OPEN-RATE-FILE                   VALUE 'O'.
  3003             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3004             88  IO-ERROR                         VALUE 'E'.
  3005
  3006         16  CP-FIRST-PAY-DATE     PIC XX.
  3007
  3008         16  CP-JOINT-INDICATOR    PIC X.
  3009
  3010         16  CP-RESERVE-REMAINING-TERM
  3011                                   PIC S9(4)V9    VALUE ZERO
  3012                                     COMP-3.
  3013
  3014         16  CP-INSURED-BIRTH-DT   PIC XX.
  3015
  3016         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3017                                     COMP-3.
  3018
  3019         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3020                                     COMP-3.
  3021
  3022         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3023                                     COMP-3.
  3024
  3025         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3026                                     COMP-3.
  3027
  3028         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3029                                     COMP-3.
  3030
  3031         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3032                                     COMP-3.
  3033
  3034         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3035                                     COMP-3.
  3036
  3037         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3038             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3039
  3040         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3041                                     COMP-3.
  3042         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3043                                     COMP-3.
  3044         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3045         16  cp-extra-periods      pic 9 value zeros.
  3046         16  cp-net-only-state     pic x value spaces.
  3047         16  FILLER                PIC X(13).
  3048******************************************************************
  3049
  3050*                                COPY ELCDATE.
  3051******************************************************************
  3052*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  57
* EL131.cbl
  3053*                                                                *
  3054*                            ELCDATE.                            *
  3055*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3056*                            VMOD=2.003
  3057*                                                                *
  3058*                                                                *
  3059*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3060*                 LENGTH = 200                                   *
  3061******************************************************************
  3062
  3063 01  DATE-CONVERSION-DATA.
  3064     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3065     12  DC-OPTION-CODE                PIC X.
  3066         88  BIN-TO-GREG                VALUE ' '.
  3067         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3068         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3069         88  YMD-GREG-TO-BIN            VALUE '3'.
  3070         88  MDY-GREG-TO-BIN            VALUE '4'.
  3071         88  JULIAN-TO-BIN              VALUE '5'.
  3072         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3073         88  FIND-CENTURY               VALUE '7'.
  3074         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3075         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3076         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3077         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3078         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3079         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3080         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3081         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3082         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3083         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3084         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3085         88  BIN-3-TO-GREG              VALUE 'I'.
  3086         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3087         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3088         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3089         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3090         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3091         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3092         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3093         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3094         88  THREE-CHARACTER-BIN
  3095                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3096         88  GREGORIAN-TO-BIN
  3097                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3098         88  BIN-TO-GREGORIAN
  3099                  VALUES ' ' '1' 'I' '8' 'G'.
  3100         88  JULIAN-TO-BINARY
  3101                  VALUES '5' 'C' 'E' 'F'.
  3102     12  DC-ERROR-CODE                 PIC X.
  3103         88  NO-CONVERSION-ERROR        VALUE ' '.
  3104         88  DATE-CONVERSION-ERROR
  3105                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3106         88  DATE-IS-ZERO               VALUE '1'.
  3107         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3108         88  DATE-IS-INVALID            VALUE '3'.
  3109         88  DATE1-GREATER-DATE2        VALUE '4'.
  3110         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  58
* EL131.cbl
  3111         88  DATE-INVALID-OPTION        VALUE '9'.
  3112         88  INVALID-CENTURY            VALUE 'A'.
  3113         88  ONLY-CENTURY               VALUE 'B'.
  3114         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3115         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3116     12  DC-END-OF-MONTH               PIC X.
  3117         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3118     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3119         88  USE-NORMAL-PROCESS         VALUE ' '.
  3120         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3121         88  ADJUST-UP-100-YRS          VALUE '2'.
  3122     12  FILLER                        PIC X.
  3123     12  DC-CONVERSION-DATES.
  3124         16  DC-BIN-DATE-1             PIC XX.
  3125         16  DC-BIN-DATE-2             PIC XX.
  3126         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3127         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3128                       DC-GREG-DATE-1-EDIT.
  3129             20  DC-EDIT1-MONTH        PIC 99.
  3130             20  SLASH1-1              PIC X.
  3131             20  DC-EDIT1-DAY          PIC 99.
  3132             20  SLASH1-2              PIC X.
  3133             20  DC-EDIT1-YEAR         PIC 99.
  3134         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3135         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3136                     DC-GREG-DATE-2-EDIT.
  3137             20  DC-EDIT2-MONTH        PIC 99.
  3138             20  SLASH2-1              PIC X.
  3139             20  DC-EDIT2-DAY          PIC 99.
  3140             20  SLASH2-2              PIC X.
  3141             20  DC-EDIT2-YEAR         PIC 99.
  3142         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3143         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3144                     DC-GREG-DATE-1-YMD.
  3145             20  DC-YMD-YEAR           PIC 99.
  3146             20  DC-YMD-MONTH          PIC 99.
  3147             20  DC-YMD-DAY            PIC 99.
  3148         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3149         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3150                      DC-GREG-DATE-1-MDY.
  3151             20  DC-MDY-MONTH          PIC 99.
  3152             20  DC-MDY-DAY            PIC 99.
  3153             20  DC-MDY-YEAR           PIC 99.
  3154         16  DC-GREG-DATE-1-ALPHA.
  3155             20  DC-ALPHA-MONTH        PIC X(10).
  3156             20  DC-ALPHA-DAY          PIC 99.
  3157             20  FILLER                PIC XX.
  3158             20  DC-ALPHA-CENTURY.
  3159                 24 DC-ALPHA-CEN-N     PIC 99.
  3160             20  DC-ALPHA-YEAR         PIC 99.
  3161         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3162         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3163         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3164         16  DC-JULIAN-DATE            PIC 9(05).
  3165         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3166                                       PIC 9(05).
  3167         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3168             20  DC-JULIAN-YEAR        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  59
* EL131.cbl
  3169             20  DC-JULIAN-DAYS        PIC 999.
  3170         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3171         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3172         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3173     12  DATE-CONVERSION-VARIBLES.
  3174         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3175         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3176             20  FILLER                PIC 9(3).
  3177             20  HOLD-CEN-1-CCYY.
  3178                 24  HOLD-CEN-1-CC     PIC 99.
  3179                 24  HOLD-CEN-1-YY     PIC 99.
  3180             20  HOLD-CEN-1-MO         PIC 99.
  3181             20  HOLD-CEN-1-DA         PIC 99.
  3182         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3183             20  HOLD-CEN-1-R-MO       PIC 99.
  3184             20  HOLD-CEN-1-R-DA       PIC 99.
  3185             20  HOLD-CEN-1-R-CCYY.
  3186                 24  HOLD-CEN-1-R-CC   PIC 99.
  3187                 24  HOLD-CEN-1-R-YY   PIC 99.
  3188             20  FILLER                PIC 9(3).
  3189         16  HOLD-CENTURY-1-X.
  3190             20  FILLER                PIC X(3)  VALUE SPACES.
  3191             20  HOLD-CEN-1-X-CCYY.
  3192                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3193                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3194             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3195             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3196         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3197             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3198             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3199             20  HOLD-CEN-1-R-X-CCYY.
  3200                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3201                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3202             20  FILLER                PIC XXX.
  3203         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3204         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3205         16  DC-JULIAN-DATE-1          PIC 9(07).
  3206         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3207             20  DC-JULIAN-1-CCYY.
  3208                 24  DC-JULIAN-1-CC    PIC 99.
  3209                 24  DC-JULIAN-1-YR    PIC 99.
  3210             20  DC-JULIAN-DA-1        PIC 999.
  3211         16  DC-JULIAN-DATE-2          PIC 9(07).
  3212         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3213             20  DC-JULIAN-2-CCYY.
  3214                 24  DC-JULIAN-2-CC    PIC 99.
  3215                 24  DC-JULIAN-2-YR    PIC 99.
  3216             20  DC-JULIAN-DA-2        PIC 999.
  3217         16  DC-GREG-DATE-A-EDIT.
  3218             20  DC-EDITA-MONTH        PIC 99.
  3219             20  SLASHA-1              PIC X VALUE '/'.
  3220             20  DC-EDITA-DAY          PIC 99.
  3221             20  SLASHA-2              PIC X VALUE '/'.
  3222             20  DC-EDITA-CCYY.
  3223                 24  DC-EDITA-CENT     PIC 99.
  3224                 24  DC-EDITA-YEAR     PIC 99.
  3225         16  DC-GREG-DATE-B-EDIT.
  3226             20  DC-EDITB-MONTH        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  60
* EL131.cbl
  3227             20  SLASHB-1              PIC X VALUE '/'.
  3228             20  DC-EDITB-DAY          PIC 99.
  3229             20  SLASHB-2              PIC X VALUE '/'.
  3230             20  DC-EDITB-CCYY.
  3231                 24  DC-EDITB-CENT     PIC 99.
  3232                 24  DC-EDITB-YEAR     PIC 99.
  3233         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3234         16  DC-GREG-DATE-CYMD-R REDEFINES
  3235                              DC-GREG-DATE-CYMD.
  3236             20  DC-CYMD-CEN           PIC 99.
  3237             20  DC-CYMD-YEAR          PIC 99.
  3238             20  DC-CYMD-MONTH         PIC 99.
  3239             20  DC-CYMD-DAY           PIC 99.
  3240         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3241         16  DC-GREG-DATE-MDCY-R REDEFINES
  3242                              DC-GREG-DATE-MDCY.
  3243             20  DC-MDCY-MONTH         PIC 99.
  3244             20  DC-MDCY-DAY           PIC 99.
  3245             20  DC-MDCY-CEN           PIC 99.
  3246             20  DC-MDCY-YEAR          PIC 99.
  3247    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3248        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3249    12  DC-EL310-DATE                  PIC X(21).
  3250    12  FILLER                         PIC X(28).
  3251
  3252*                                COPY ELCDMO.
  3253******************************************************************
  3254*                                                                *
  3255*                                                                *
  3256*                            ELCDMO.                             *
  3257*                            VMOD=2.004                          *
  3258*                                                                *
  3259*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3260*        COMMUNICATION AREA                                      *
  3261*   FILE TYPE = NA                                               *
  3262*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3263*                                                                *
  3264******************************************************************
  3265 01  DMO-COMMUNICATION-AREA.
  3266     12  DM-RECORD-TYPE                  PIC  X(02).
  3267             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3268             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3269             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3270     12  DM-DIST-CODE                    PIC  X(04).
  3271     12  DM-MAIL-CODE                    PIC  X(05).
  3272     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3273     12  DM-INSURED-NAME                 PIC  X(30).
  3274     12  DM-CLAIM-NO                     PIC  X(07).
  3275     12  DM-CLAIM-TYPE                   PIC  X.
  3276
  3277     12  DM-STATUS-DATA-AREA.
  3278         16  DM-CLAIM-STATUS             PIC  X.
  3279             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3280             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3281             88  DM-CLOSED                        VALUE '3'.
  3282             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3283             88  DM-DEFAULT                       VALUE '9'.
  3284         16  DM-STATUS-DATE              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  61
* EL131.cbl
  3285******YYYYMMDD
  3286         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3287             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3288             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3289             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3290             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3291             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3292             88  DM-RE-OPENED                     VALUE 'R'.
  3293             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3294             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3295             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3296         16  DM-STAT-CARRIER             PIC X.
  3297
  3298     12  DM-DRAFT-DATA-AREA.
  3299         16  DM-PAYMENT-TYPE             PIC  X.
  3300             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3301         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3302         16  DM-PAYMENT-DATE             PIC  X(08).
  3303******YYYYMMDD
  3304         16  DM-CERT-NO                  PIC  X(11).
  3305         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3306         16  DM-CARRIER                  PIC  X.
  3307
  3308     12  DM-RETURN-CODE                  PIC  XX.
  3309*                                COPY ERCPDEF.
  3310******************************************************************
  3311*                                                                *
  3312*                                                                *
  3313*                            ERCPDEF.                            *
  3314*                                                                *
  3315*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3316*                                                                *
  3317*    FILE TYPE = VSAM,KSDS                                       *
  3318*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3319*                                                                *
  3320*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3321*                                                                *
  3322*    LOG = YES                                                   *
  3323*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3324******************************************************************
  3325*                   C H A N G E   L O G
  3326*
  3327* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3328*-----------------------------------------------------------------
  3329*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3330* EFFECTIVE    NUMBER
  3331*-----------------------------------------------------------------
  3332* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3333* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3334* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3335******************************************************************
  3336 01  PRODUCT-MASTER.
  3337    12  PD-RECORD-ID                 PIC X(02).
  3338        88  VALID-PD-ID                  VALUE 'PD'.
  3339    12  PD-CONTROL-PRIMARY.
  3340        16  PD-COMPANY-CD            PIC X.
  3341        16  PD-STATE                 PIC XX.
  3342        16  PD-PRODUCT-CD            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  62
* EL131.cbl
  3343        16  PD-FILLER                PIC X(7).
  3344        16  PD-BEN-TYPE              PIC X.
  3345        16  PD-BEN-CODE              PIC XX.
  3346        16  PD-PROD-EXP-DT           PIC XX.
  3347    12  FILLER                       PIC X(50).
  3348    12  PD-PRODUCT-DATA OCCURS 8.
  3349        16  PD-PROD-CODE             PIC X.
  3350            88  PD-PROD-LIFE           VALUE 'L'.
  3351            88  PD-PROD-PROP           VALUE 'P'.
  3352            88  PD-PROD-AH             VALUE 'A'.
  3353            88  PD-PROD-IU             VALUE 'I'.
  3354            88  PD-PROD-GAP            VALUE 'G'.
  3355            88  PD-PROD-FAML           VALUE 'F'.
  3356        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3357        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3358        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3359        16  PD-MAX-TERM              PIC S999        COMP-3.
  3360        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3361        16  FILLER                   PIC X.
  3362        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3363        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3364        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3365        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3366        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3367        16  PD-REC-CRIT-PERIOD       PIC 99.
  3368        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3369            20  PD-RECURRING-YN      PIC X.
  3370            20  FILLER               PIC X.
  3371        16  PD-RTW-MOS               PIC 99.
  3372        16  PD-MAX-EXTENSION         PIC 99.
  3373        16  pd-ben-pct               pic sv999 comp-3.
  3374*       16  FILLER                   PIC XX.
  3375    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3376    12  PD-TERM-LIMITS OCCURS 15.
  3377        16  PD-LOW-TERM              PIC S999        COMP-3.
  3378        16  PD-HI-TERM               PIC S999        COMP-3.
  3379*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3380    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3381        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3382        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3383    12  PD-EARN-FACTORS.
  3384        16  FILLER OCCURS 15.
  3385            20  FILLER OCCURS 15.
  3386                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3387    12  PD-PRODUCT-DESC              PIC X(80).
  3388    12  PD-TRUNCATED                 PIC X.
  3389    12  FILLER                       PIC X(59).
  3390    12  PD-MAINT-INFORMATION.
  3391        16  PD-LAST-MAINT-DT         PIC X(02).
  3392        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3393        16  PD-LAST-MAINT-BY         PIC X(04).
  3394*                                COPY ELCCRTT.
  3395******************************************************************
  3396*                                                                *
  3397*                            ELCCRTT.                            *
  3398*                                                                *
  3399*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3400*                                                                *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  63
* EL131.cbl
  3401*   FILE TYPE = VSAM,KSDS                                        *
  3402*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3403*                                                                *
  3404*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3405*                                                                *
  3406*   LOG = YES                                                    *
  3407*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3408******************************************************************
  3409*                   C H A N G E   L O G
  3410*
  3411* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3412*-----------------------------------------------------------------
  3413*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3414* EFFECTIVE    NUMBER
  3415*-----------------------------------------------------------------
  3416* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3417* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3418* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3419* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3420* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3421* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3422* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3423* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  3424* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  3425******************************************************************
  3426
  3427 01  CERTIFICATE-TRAILERS.
  3428     12  CS-RECORD-ID                      PIC XX.
  3429         88  VALID-CS-ID                      VALUE 'CS'.
  3430
  3431     12  CS-CONTROL-PRIMARY.
  3432         16  CS-COMPANY-CD                 PIC X.
  3433         16  CS-CARRIER                    PIC X.
  3434         16  CS-GROUPING                   PIC X(6).
  3435         16  CS-STATE                      PIC XX.
  3436         16  CS-ACCOUNT                    PIC X(10).
  3437         16  CS-CERT-EFF-DT                PIC XX.
  3438         16  CS-CERT-NO.
  3439             20  CS-CERT-PRIME             PIC X(10).
  3440             20  CS-CERT-SFX               PIC X.
  3441         16  CS-TRAILER-TYPE               PIC X.
  3442             88  COMM-TRLR           VALUE 'A'.
  3443             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3444             88  CERT-DATA-TRLR      VALUE 'C'.
  3445
  3446     12  CS-DATA-AREA                      PIC X(516).
  3447
  3448     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3449         16  CS-BANK-COMMISSION-AREA.
  3450             20  CS-BANK-COMMS       OCCURS 10.
  3451                 24  CS-AGT                PIC X(10).
  3452                 24  CS-COM-TYP            PIC X.
  3453                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3454                 24  CS-RECALC-LV-INDIC    PIC X.
  3455                 24  FILLER                PIC X(10).
  3456         16  FILLER                        PIC X(256).
  3457
  3458     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  64
* EL131.cbl
  3459****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3460         16  CS-MB-CLAIM-DATA OCCURS 24.
  3461             20  CS-CLAIM-NO               PIC X(7).
  3462             20  CS-CLAIM-TYPE             PIC X.
  3463                 88  CS-AH-CLM               VALUE 'A'.
  3464                 88  CS-IU-CLM               VALUE 'I'.
  3465                 88  CS-GP-CLM               VALUE 'G'.
  3466                 88  CS-LF-CLM               VALUE 'L'.
  3467                 88  CS-PR-CLM               VALUE 'P'.
  3468                 88  CS-FL-CLM               VALUE 'F'.
  3469             20  CS-INSURED-TYPE           PIC X.
  3470                 88  CS-PRIM-INSURED          VALUE 'P'.
  3471                 88  CS-CO-BORROWER           VALUE 'C'.
  3472             20  CS-BENEFIT-PERIOD         PIC 99.
  3473             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3474             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3475             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3476         16  FILLER                        PIC X(12).
  3477     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3478         16  CS-VIN-NUMBER                 PIC X(17).
  3479         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3480         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3481         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3482         16  cs-agent-name.
  3483             20  cs-agent-fname            pic x(20).
  3484             20  cs-agent-mi               pic x.
  3485             20  cs-agent-lname            pic x(25).
  3486         16  cs-license-no                 pic x(15).
  3487         16  cs-npn-number                 pic x(10).
  3488         16  cs-agent-edit-status          pic x.
  3489             88  cs-ae-refer-to-manager      value 'M'.
  3490             88  cs-ae-cover-sheet           value 'C'.
  3491             88  cs-ae-sig-form              value 'S'.
  3492             88  cs-ae-verified              value 'V'.
  3493             88  cs-unidentified-signature   value 'U'.
  3494             88  cs-cert-returned            value 'R'.
  3495             88  cs-accept-no-commission     value 'N'.
  3496         16  cs-year                       pic 9999.
  3497         16  cs-make                       pic x(20).
  3498         16  cs-model                      pic x(20).
  3499         16  cs-future                     pic x(20).
  3500         16  cs-vehicle-odometer           pic s9(7) comp-3.
  3501         16  FILLER                        PIC X(356). *> was 420
  3502*        16  FILLER                        PIC X(496).
  3503
  3504****************************************************************
  3505*
  3506* Copyright (c) 2007-2013 Dell Inc.
  3507* All rights reserved.
  3508*
  3509****************************************************************
  3510 01  DFHEIV.
  3511   02  DFHEIV0               PIC X(35).
  3512   02  DFHEIV1               PIC X(08).
  3513   02  DFHEIV2               PIC X(08).
  3514   02  DFHEIV3               PIC X(08).
  3515   02  DFHEIV4               PIC X(06).
  3516   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  65
* EL131.cbl
  3517   02  DFHEIV6               PIC X(04).
  3518   02  DFHEIV7               PIC X(02).
  3519   02  DFHEIV8               PIC X(02).
  3520   02  DFHEIV9               PIC X(01).
  3521   02  DFHEIV10              PIC S9(7) COMP-3.
  3522   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3523   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3524   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3525   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3526   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3527   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3528   02  DFHEIV17              PIC X(04).
  3529   02  DFHEIV18              PIC X(04).
  3530   02  DFHEIV19              PIC X(04).
  3531   02  DFHEIV20              USAGE IS POINTER.
  3532   02  DFHEIV21              USAGE IS POINTER.
  3533   02  DFHEIV22              USAGE IS POINTER.
  3534   02  DFHEIV23              USAGE IS POINTER.
  3535   02  DFHEIV24              USAGE IS POINTER.
  3536   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3537   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3538   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3539   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3540   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3541   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3542   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3543   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3544   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3545   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3546   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3547   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3548   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3549   02  FILLER                PIC X(02).
  3550   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3551   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3552   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3553   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3554   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3555   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3556   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3557 LINKAGE  SECTION.
  3558*****************************************************************
  3559*                                                               *
  3560* Copyright (c) 2007-2013 Dell Inc.                             *
  3561* All rights reserved.                                          *
  3562*                                                               *
  3563*****************************************************************
  3564 01  dfheiblk.
  3565     02  eibtime          pic s9(7) comp-3.
  3566     02  eibdate          pic s9(7) comp-3.
  3567     02  eibtrnid         pic x(4).
  3568     02  eibtaskn         pic s9(7) comp-3.
  3569     02  eibtrmid         pic x(4).
  3570     02  dfheigdi         pic s9(4) comp.
  3571     02  eibcposn         pic s9(4) comp.
  3572     02  eibcalen         pic s9(4) comp.
  3573     02  eibaid           pic x(1).
  3574     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  66
* EL131.cbl
  3575     02  eibfn            pic x(2).
  3576     02  eibfiller2       pic x(2).
  3577     02  eibrcode         pic x(6).
  3578     02  eibfiller3       pic x(2).
  3579     02  eibds            pic x(8).
  3580     02  eibreqid         pic x(8).
  3581     02  eibrsrce         pic x(8).
  3582     02  eibsync          pic x(1).
  3583     02  eibfree          pic x(1).
  3584     02  eibrecv          pic x(1).
  3585     02  eibsend          pic x(1).
  3586     02  eibatt           pic x(1).
  3587     02  eibeoc           pic x(1).
  3588     02  eibfmh           pic x(1).
  3589     02  eibcompl         pic x(1).
  3590     02  eibsig           pic x(1).
  3591     02  eibconf          pic x(1).
  3592     02  eiberr           pic x(1).
  3593     02  eibrldbk         pic x(1).
  3594     02  eiberrcd         pic x(4).
  3595     02  eibsynrb         pic x(1).
  3596     02  eibnodat         pic x(1).
  3597     02  eibfiller5       pic x(2).
  3598     02  eibresp          pic s9(8) comp.
  3599     02  eibresp2         pic s9(8) comp.
  3600     02  dfheigdj         pic s9(4) comp.
  3601     02  dfheigdk         pic s9(4) comp.
  3602 01  DFHCOMMAREA                 PIC X(1024).
  3603
  3604*                                COPY ELCMSTR.
  3605******************************************************************
  3606*                                                                *
  3607*                            ELCMSTR.                            *
  3608*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3609*                            VMOD=2.012                          *
  3610*                                                                *
  3611*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3612*                                                                *
  3613*   FILE TYPE = VSAM,KSDS                                        *
  3614*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3615*                                                                *
  3616*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3617*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3618*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3619*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3620*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3621*                                                 RKP=75,LEN=21  *
  3622*                                                                *
  3623*   **** NOTE ****                                               *
  3624*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3625*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3626*                                                                *
  3627*   LOG = YES                                                    *
  3628*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3629******************************************************************
  3630*                   C H A N G E   L O G
  3631*
  3632* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  67
* EL131.cbl
  3633*-----------------------------------------------------------------
  3634*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3635* EFFECTIVE    NUMBER
  3636*-----------------------------------------------------------------
  3637* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3638* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3639* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3640* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3641* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3642* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3643******************************************************************
  3644 01  CLAIM-MASTER.
  3645     12  CL-RECORD-ID                PIC XX.
  3646         88  VALID-CL-ID         VALUE 'CL'.
  3647
  3648     12  CL-CONTROL-PRIMARY.
  3649         16  CL-COMPANY-CD           PIC X.
  3650         16  CL-CARRIER              PIC X.
  3651         16  CL-CLAIM-NO             PIC X(7).
  3652         16  CL-CERT-NO.
  3653             20  CL-CERT-PRIME       PIC X(10).
  3654             20  CL-CERT-SFX         PIC X.
  3655
  3656     12  CL-CONTROL-BY-NAME.
  3657         16  CL-COMPANY-CD-A1        PIC X.
  3658         16  CL-INSURED-LAST-NAME    PIC X(15).
  3659         16  CL-INSURED-NAME.
  3660             20  CL-INSURED-1ST-NAME PIC X(12).
  3661             20  CL-INSURED-MID-INIT PIC X.
  3662
  3663     12  CL-CONTROL-BY-SSN.
  3664         16  CL-COMPANY-CD-A2        PIC X.
  3665         16  CL-SOC-SEC-NO.
  3666             20  CL-SSN-STATE        PIC XX.
  3667             20  CL-SSN-ACCOUNT      PIC X(6).
  3668             20  CL-SSN-LN3          PIC X(3).
  3669
  3670     12  CL-CONTROL-BY-CERT-NO.
  3671         16  CL-COMPANY-CD-A4        PIC X.
  3672         16  CL-CERT-NO-A4.
  3673             20  CL-CERT-A4-PRIME    PIC X(10).
  3674             20  CL-CERT-A4-SFX      PIC X.
  3675
  3676     12  CL-CONTROL-BY-CCN.
  3677         16  CL-COMPANY-CD-A5        PIC X.
  3678         16  CL-CCN-A5.
  3679             20  CL-CCN.
  3680                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3681                 24  CL-CCN-PRIME-A5 PIC X(12).
  3682             20  CL-CCN-FILLER-A5    PIC X(4).
  3683
  3684     12  CL-INSURED-PROFILE-DATA.
  3685         16  CL-INSURED-BIRTH-DT     PIC XX.
  3686         16  CL-INSURED-SEX-CD       PIC X.
  3687             88  INSURED-IS-MALE        VALUE 'M'.
  3688             88  INSURED-IS-FEMALE      VALUE 'F'.
  3689             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3690         16  CL-INSURED-OCC-CD       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  68
* EL131.cbl
  3691         16  FILLER                  PIC X(5).
  3692
  3693     12  CL-PROCESSING-INFO.
  3694         16  CL-PROCESSOR-ID         PIC X(4).
  3695         16  CL-CLAIM-STATUS         PIC X.
  3696             88  CLAIM-IS-OPEN          VALUE 'O'.
  3697             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3698         16  CL-CLAIM-TYPE           PIC X.
  3699*            88  AH-CLAIM               VALUE 'A'.
  3700*            88  LIFE-CLAIM             VALUE 'L'.
  3701*            88  PROPERTY-CLAIM         VALUE 'P'.
  3702*            88  IUI-CLAIM              VALUE 'I'.
  3703*            88  GAP-CLAIM              VALUE 'G'.
  3704*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3705         16  CL-CLAIM-PREM-TYPE      PIC X.
  3706             88  SINGLE-PREMIUM         VALUE '1'.
  3707             88  O-B-COVERAGE           VALUE '2'.
  3708             88  OPEN-END-COVERAGE      VALUE '3'.
  3709         16  CL-INCURRED-DT          PIC XX.
  3710         16  CL-REPORTED-DT          PIC XX.
  3711         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3712         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3713         16  CL-LAST-PMT-DT          PIC XX.
  3714         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3715         16  CL-PAID-THRU-DT         PIC XX.
  3716         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3717         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3718         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3719         16  CL-PMT-CALC-METHOD      PIC X.
  3720             88  CL-360-DAY-YR          VALUE '1'.
  3721             88  CL-365-DAY-YR          VALUE '2'.
  3722             88  CL-FULL-MONTHS         VALUE '3'.
  3723         16  CL-CAUSE-CD             PIC X(6).
  3724
  3725         16  CL-PRIME-CERT-NO.
  3726             20  CL-PRIME-CERT-PRIME PIC X(10).
  3727             20  CL-PRIME-CERT-SFX   PIC X.
  3728
  3729         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3730             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3731             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3732
  3733         16  CL-MICROFILM-NO         PIC X(10).
  3734         16  FILLER REDEFINES CL-MICROFILM-NO.
  3735             20  CL-BENEFIT-PERIOD   PIC 99.
  3736             20  FILLER              PIC X(8).
  3737         16  CL-PROG-FORM-TYPE       PIC X.
  3738         16  CL-LAST-ADD-ON-DT       PIC XX.
  3739
  3740         16  CL-LAST-REOPEN-DT       PIC XX.
  3741         16  CL-LAST-CLOSE-DT        PIC XX.
  3742         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3743             88  FINAL-PAID             VALUE '1'.
  3744             88  CLAIM-DENIED           VALUE '2'.
  3745             88  AUTO-CLOSE             VALUE '3'.
  3746             88  MANUAL-CLOSE           VALUE '4'.
  3747             88  BENEFITS-CHANGED       VALUE 'C'.
  3748             88  SETUP-ERRORS           VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  69
* EL131.cbl
  3749         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3750         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3751         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3752             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3753         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3754         16  FILLER                  PIC X.
  3755
  3756     12  CL-CERTIFICATE-DATA.
  3757         16  CL-CERT-ORIGIN          PIC X.
  3758             88  CERT-WAS-ONLINE        VALUE '1'.
  3759             88  CERT-WAS-CREATED       VALUE '2'.
  3760             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3761         16  CL-CERT-KEY-DATA.
  3762             20  CL-CERT-CARRIER     PIC X.
  3763             20  CL-CERT-GROUPING    PIC X(6).
  3764             20  CL-CERT-STATE       PIC XX.
  3765             20  CL-CERT-ACCOUNT.
  3766                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3767                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3768             20  CL-CERT-EFF-DT      PIC XX.
  3769
  3770     12  CL-STATUS-CONTROLS.
  3771         16  CL-PRIORITY-CD          PIC X.
  3772             88  CONFIDENTIAL-DATA      VALUE '8'.
  3773             88  HIGHEST-PRIORITY       VALUE '9'.
  3774         16  CL-SUPV-ATTN-CD         PIC X.
  3775             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3776             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3777         16  CL-PURGED-DT            PIC XX.
  3778         16  CL-RESTORED-DT          PIC XX.
  3779         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3780         16  CL-NEXT-RESEND-DT       PIC XX.
  3781         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3782         16  CL-CRITICAL-PERIOD      PIC 99.
  3783*        16  FILLER                  PIC XX.
  3784         16  CL-LAST-MAINT-DT        PIC XX.
  3785         16  CL-LAST-MAINT-USER      PIC X(4).
  3786         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3787         16  CL-LAST-MAINT-TYPE      PIC X.
  3788             88  CLAIM-SET-UP           VALUE ' '.
  3789             88  PAYMENT-MADE           VALUE '1'.
  3790             88  LETTER-SENT            VALUE '2'.
  3791             88  MASTER-WAS-ALTERED     VALUE '3'.
  3792             88  MASTER-WAS-RESTORED    VALUE '4'.
  3793             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3794             88  FILE-CONVERTED         VALUE '6'.
  3795             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3796             88  ERROR-CORRECTION       VALUE 'E'.
  3797         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3798         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3799         16  CL-BENEFICIARY          PIC X(10).
  3800         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3801         16  CL-DENIAL-TYPE          PIC X.
  3802             88  CL-TYPE-DENIAL          VALUE '1'.
  3803             88  CL-TYPE-RESCISSION      VALUE '2'.
  3804             88  CL-TYPE-REFORMATION     VALUE '3'.
  3805             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3806             88  CL-TYPE-RECONSIDERED    VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  70
* EL131.cbl
  3807         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3808         16  filler                  pic x(3).
  3809*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3810*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3811*        16  CL-RTW-DT               PIC XX.
  3812
  3813     12  CL-TRAILER-CONTROLS.
  3814         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3815             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3816             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3817             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3818         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3819         16  FILLER                  PIC XX.
  3820         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3821         16  CL-ADDRESS-TRAILER-CNT.
  3822             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3823                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3824             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3825                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3826             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3827                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3828             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3829                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3830             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3831                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3832             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3833                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3834             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3835                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3836
  3837     12  CL-CV-REFERENCE-NO.
  3838         16  CL-CV-REFNO-PRIME       PIC X(18).
  3839         16  CL-CV-REFNO-SFX         PIC XX.
  3840
  3841     12  CL-FILE-LOCATION            PIC X(4).
  3842
  3843     12  CL-PROCESS-ERRORS.
  3844         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3845             88  NO-FATAL-ERRORS        VALUE ZERO.
  3846         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3847             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3848
  3849     12  CL-PRODUCT-CD               PIC X.
  3850
  3851     12  CL-CURRENT-KEY-DATA.
  3852         16  CL-CURRENT-CARRIER      PIC X.
  3853         16  CL-CURRENT-GROUPING     PIC X(6).
  3854         16  CL-CURRENT-STATE        PIC XX.
  3855         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3856
  3857     12  CL-ASSOCIATES               PIC X.
  3858         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3859         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3860         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3861         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3862
  3863     12  CL-ACTIVITY-CODE            PIC 99.
  3864     12  CL-ACTIVITY-MAINT-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  71
* EL131.cbl
  3865     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3866
  3867     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3868     12  CL-LAG-REPORT-CODE          PIC 9.
  3869     12  CL-LOAN-TYPE                PIC XX.
  3870     12  CL-LEGAL-STATE              PIC XX.
  3871
  3872     12  CL-YESNOSW                  PIC X.
  3873     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3874         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3875         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3876         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3877     12  cl-insured-type             pic x.
  3878         88  cl-claim-on-primary         value 'P'.
  3879         88  cl-claim-on-co-borrower     value 'C'.
  3880     12  cl-benefit-expiration-dt    PIC XX.
  3881
  3882*                                COPY ELCCERT.
  3883******************************************************************
  3884*                                                                *
  3885*                            ELCCERT.                            *
  3886*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3887*                            VMOD=2.013                          *
  3888*                                                                *
  3889*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3890*                                                                *
  3891*   FILE TYPE = VSAM,KSDS                                        *
  3892*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3893*                                                                *
  3894*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3895*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3896*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3897*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3898*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3899*                                                                *
  3900*   LOG = YES                                                    *
  3901*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3902******************************************************************
  3903*                   C H A N G E   L O G
  3904*
  3905* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3906*-----------------------------------------------------------------
  3907*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3908* EFFECTIVE    NUMBER
  3909*-----------------------------------------------------------------
  3910* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3911* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3912* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3913* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3914* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3915* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3916* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3917* 032612  CR2011110200001  PEMA  AHL CHANGES
  3918* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  3919* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3920* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  3921******************************************************************
  3922
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  72
* EL131.cbl
  3923 01  CERTIFICATE-MASTER.
  3924     12  CM-RECORD-ID                      PIC XX.
  3925         88  VALID-CM-ID                      VALUE 'CM'.
  3926
  3927     12  CM-CONTROL-PRIMARY.
  3928         16  CM-COMPANY-CD                 PIC X.
  3929         16  CM-CARRIER                    PIC X.
  3930         16  CM-GROUPING.
  3931             20  CM-GROUPING-PREFIX        PIC X(3).
  3932             20  CM-GROUPING-PRIME         PIC X(3).
  3933         16  CM-STATE                      PIC XX.
  3934         16  CM-ACCOUNT.
  3935             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3936             20  CM-ACCOUNT-PRIME          PIC X(6).
  3937         16  CM-CERT-EFF-DT                PIC XX.
  3938         16  CM-CERT-NO.
  3939             20  CM-CERT-PRIME             PIC X(10).
  3940             20  CM-CERT-SFX               PIC X.
  3941
  3942     12  CM-CONTROL-BY-NAME.
  3943         16  CM-COMPANY-CD-A1              PIC X.
  3944         16  CM-INSURED-LAST-NAME          PIC X(15).
  3945         16  CM-INSURED-INITIALS.
  3946             20  CM-INSURED-INITIAL1       PIC X.
  3947             20  CM-INSURED-INITIAL2       PIC X.
  3948
  3949     12  CM-CONTROL-BY-SSN.
  3950         16  CM-COMPANY-CD-A2              PIC X.
  3951         16  CM-SOC-SEC-NO.
  3952             20  CM-SSN-STATE              PIC XX.
  3953             20  CM-SSN-ACCOUNT            PIC X(6).
  3954             20  CM-SSN-LN3.
  3955                 25  CM-INSURED-INITIALS-A2.
  3956                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3957                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3958                 25 CM-PART-LAST-NAME-A2         PIC X.
  3959
  3960     12  CM-CONTROL-BY-CERT-NO.
  3961         16  CM-COMPANY-CD-A4              PIC X.
  3962         16  CM-CERT-NO-A4                 PIC X(11).
  3963
  3964     12  CM-CONTROL-BY-MEMB.
  3965         16  CM-COMPANY-CD-A5              PIC X.
  3966         16  CM-MEMBER-NO.
  3967             20  CM-MEMB-STATE             PIC XX.
  3968             20  CM-MEMB-ACCOUNT           PIC X(6).
  3969             20  CM-MEMB-LN4.
  3970                 25  CM-INSURED-INITIALS-A5.
  3971                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3972                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3973                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3974
  3975     12  CM-INSURED-PROFILE-DATA.
  3976         16  CM-INSURED-FIRST-NAME.
  3977             20  CM-INSURED-1ST-INIT       PIC X.
  3978             20  FILLER                    PIC X(9).
  3979         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3980         16  CM-INSURED-SEX                PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  73
* EL131.cbl
  3981             88  CM-SEX-MALE                  VALUE 'M'.
  3982             88  CM-SEX-FEMAL                 VALUE 'F'.
  3983         16  CM-INSURED-JOINT-AGE          PIC 99.
  3984         16  CM-JOINT-INSURED-NAME.
  3985             20  CM-JT-LAST-NAME           PIC X(15).
  3986             20  CM-JT-FIRST-NAME.
  3987                 24  CM-JT-1ST-INIT        PIC X.
  3988                 24  FILLER                PIC X(9).
  3989             20  CM-JT-INITIAL             PIC X.
  3990
  3991     12  CM-LIFE-DATA.
  3992         16  CM-LF-BENEFIT-CD              PIC XX.
  3993         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3994         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3995         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3996         16  CM-LF-DEV-CODE                PIC XXX.
  3997         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3998         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3999         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4000         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4001         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4002         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4003         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4004         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4005         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4006         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4007         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4008         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4009         16  cm-temp-epiq                  pic xx.
  4010             88  EPIQ-CLASS                  value 'EQ'.
  4011*        16  FILLER                        PIC XX.
  4012
  4013     12  CM-AH-DATA.
  4014         16  CM-AH-BENEFIT-CD              PIC XX.
  4015         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4016         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4017         16  CM-AH-DEV-CODE                PIC XXX.
  4018         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4019         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4020         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4021         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4022         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4023         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4024         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4025         16  CM-AH-PAID-THRU-DT            PIC XX.
  4026             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4027         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4028         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4029         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4030         16  FILLER                        PIC X.
  4031
  4032     12  CM-LOAN-INFORMATION.
  4033         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4034         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4035                                           PIC S9(5)V99  COMP-3.
  4036         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4037         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4038         16  CM-PAY-FREQUENCY              PIC S99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  74
* EL131.cbl
  4039         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4040         16  CM-RATE-CLASS                 PIC XX.
  4041         16  CM-BENEFICIARY                PIC X(25).
  4042         16  CM-POLICY-FORM-NO             PIC X(12).
  4043         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4044         16  CM-LAST-ADD-ON-DT             PIC XX.
  4045         16  CM-DEDUCTIBLE-AMOUNTS.
  4046             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4047             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4048         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4049             20  CM-RESIDENT-STATE         PIC XX.
  4050             20  CM-RATE-CODE              PIC X(4).
  4051             20  FILLER                    PIC XX.
  4052         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4053             20  CM-LOAN-OFFICER           PIC X(5).
  4054             20  FILLER                    PIC XXX.
  4055         16  CM-CSR-CODE                   PIC XXX.
  4056         16  CM-UNDERWRITING-CODE          PIC X.
  4057             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4058         16  CM-POST-CARD-IND              PIC X.
  4059         16  CM-REF-INTERFACE-SW           PIC X.
  4060         16  CM-PREMIUM-TYPE               PIC X.
  4061             88  CM-SING-PRM                  VALUE '1'.
  4062             88  CM-O-B-COVERAGE              VALUE '2'.
  4063             88  CM-OPEN-END                  VALUE '3'.
  4064         16  CM-IND-GRP-TYPE               PIC X.
  4065             88  CM-INDIVIDUAL                VALUE 'I'.
  4066             88  CM-GROUP                     VALUE 'G'.
  4067         16  CM-SKIP-CODE                  PIC X.
  4068             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4069             88  SKIP-JULY                    VALUE '1'.
  4070             88  SKIP-AUGUST                  VALUE '2'.
  4071             88  SKIP-SEPTEMBER               VALUE '3'.
  4072             88  SKIP-JULY-AUG                VALUE '4'.
  4073             88  SKIP-AUG-SEPT                VALUE '5'.
  4074             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4075             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4076             88  SKIP-JUNE                    VALUE '8'.
  4077             88  SKIP-JUNE-JULY               VALUE '9'.
  4078             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4079             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4080         16  CM-PAYMENT-MODE               PIC X.
  4081             88  PAY-MONTHLY                  VALUE SPACE.
  4082             88  PAY-WEEKLY                   VALUE '1'.
  4083             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4084             88  PAY-BI-WEEKLY                VALUE '3'.
  4085             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4086         16  CM-LOAN-NUMBER                PIC X(8).
  4087         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4088         16  CM-OLD-LOF                    PIC XXX.
  4089*        16  CM-LOAN-OFFICER               PIC XXX.
  4090         16  CM-REIN-TABLE                 PIC XXX.
  4091         16  CM-SPECIAL-REIN-CODE          PIC X.
  4092         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4093         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4094         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4095
  4096     12  CM-STATUS-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  75
* EL131.cbl
  4097         16  CM-ENTRY-STATUS               PIC X.
  4098         16  CM-ENTRY-DT                   PIC XX.
  4099
  4100         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4101         16  CM-LF-CANCEL-DT               PIC XX.
  4102         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4103
  4104         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4105         16  CM-LF-DEATH-DT                PIC XX.
  4106         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4107
  4108         16  CM-LF-CURRENT-STATUS          PIC X.
  4109             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4110                                                'M' '4' '5' '9'.
  4111             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4112             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4113             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4114             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4115             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4116             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4117             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4118             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4119             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4120             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4121             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4122             88  CM-LF-DECLINED               VALUE 'D'.
  4123             88  CM-LF-VOIDED                 VALUE 'V'.
  4124
  4125         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4126         16  CM-AH-CANCEL-DT               PIC XX.
  4127         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4128
  4129         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4130         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4131         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4132
  4133         16  CM-AH-CURRENT-STATUS          PIC X.
  4134             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4135                                                'M' '4' '5' '9'.
  4136             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4137             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4138             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4139             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4140             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4141             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4142             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4143             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4144             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4145             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4146             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4147             88  CM-AH-DECLINED               VALUE 'D'.
  4148             88  CM-AH-VOIDED                 VALUE 'V'.
  4149
  4150         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4151             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4152             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4153             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4154         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  76
* EL131.cbl
  4155
  4156         16  CM-ENTRY-BATCH                PIC X(6).
  4157         16  CM-LF-EXIT-BATCH              PIC X(6).
  4158         16  CM-AH-EXIT-BATCH              PIC X(6).
  4159         16  CM-LAST-MONTH-END             PIC XX.
  4160
  4161     12  CM-NOTE-SW                        PIC X.
  4162         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4163         88  CERT-NOTES-PRESENT               VALUE '1'.
  4164         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4165         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4166         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4167         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4168         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4169         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4170     12  CM-COMP-EXCP-SW                   PIC X.
  4171         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4172         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4173     12  CM-INSURED-ADDRESS-SW             PIC X.
  4174         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4175         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4176
  4177*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4178     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4179     12  FILLER                            PIC X.
  4180
  4181*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4182     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4183     12  FILLER                            PIC X.
  4184*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4185     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4186
  4187     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4188         88  CERT-ADDED-BATCH                 VALUE ' '.
  4189         88  CERT-ADDED-ONLINE                VALUE '1'.
  4190         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4191         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4192         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4193     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4194         88  CERT-AS-LOADED                   VALUE ' '.
  4195         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4196         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4197         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4198         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4199         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4200         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4201         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4202
  4203     12  CM-ACCOUNT-COMM-PCTS.
  4204         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4205         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4206
  4207     12  CM-USER-FIELD                     PIC X.
  4208     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4209     12  CM-CLP-STATE                      PIC XX.
  4210     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4211     12  CM-USER-RESERVED                  PIC XXX.
  4212     12  FILLER REDEFINES CM-USER-RESERVED.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  77
* EL131.cbl
  4213         16  CM-AH-CLASS-CD                PIC XX.
  4214         16  F                             PIC X.
  4215******************************************************************
  4216
  4217*                                COPY ELCTRLR.
  4218******************************************************************
  4219*                                                                *
  4220*                            ELCTRLR.                            *
  4221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4222*                            VMOD=2.014                          *
  4223*                                                                *
  4224*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4225*                                                                *
  4226*   FILE TYPE = VSAM,KSDS                                        *
  4227*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4228*                                                                *
  4229*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4230*       ALTERNATE INDEX = NONE                                   *
  4231*                                                                *
  4232*   LOG = YES                                                    *
  4233*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4234******************************************************************
  4235*                   C H A N G E   L O G
  4236*
  4237* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4238*-----------------------------------------------------------------
  4239*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4240* EFFECTIVE    NUMBER
  4241*-----------------------------------------------------------------
  4242* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4243* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4244* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4245* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4246* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4247* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4248* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4249* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4250* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4251* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4252* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4253* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4254* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4255* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4256* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4257* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4258* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  4259* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  4260* 040814    2014030500002  AJRA  ADD ICD CODES
  4261* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  4262* 013017  CR2016053100001  PEMA  ACH PROCESSING
  4263* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  4264******************************************************************
  4265 01  ACTIVITY-TRAILERS.
  4266     12  AT-RECORD-ID                    PIC XX.
  4267         88  VALID-AT-ID                       VALUE 'AT'.
  4268
  4269     12  AT-CONTROL-PRIMARY.
  4270         16  AT-COMPANY-CD               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  78
* EL131.cbl
  4271         16  AT-CARRIER                  PIC X.
  4272         16  AT-CLAIM-NO                 PIC X(7).
  4273         16  AT-CERT-NO.
  4274             20  AT-CERT-PRIME           PIC X(10).
  4275             20  AT-CERT-SFX             PIC X.
  4276         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4277             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4278             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4279             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4280             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4281             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4282             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4283             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4284             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4285             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4286             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4287             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4288             88  AT-BENEFICIARY-TRL           VALUE +91.
  4289             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4290             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4291             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4292             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4293
  4294     12  AT-TRAILER-TYPE                 PIC X.
  4295         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4296         88  PAYMENT-TR                       VALUE '2'.
  4297         88  AUTO-PAY-TR                      VALUE '3'.
  4298         88  CORRESPONDENCE-TR                VALUE '4'.
  4299         88  ADDRESS-TR                       VALUE '5'.
  4300         88  GENERAL-INFO-TR                  VALUE '6'.
  4301         88  AUTO-PROMPT-TR                   VALUE '7'.
  4302         88  DENIAL-TR                        VALUE '8'.
  4303         88  INCURRED-CHG-TR                  VALUE '9'.
  4304         88  FORM-CONTROL-TR                  VALUE 'A'.
  4305
  4306     12  AT-RECORDED-DT                  PIC XX.
  4307     12  AT-RECORDED-BY                  PIC X(4).
  4308     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4309
  4310     12  AT-TRAILER-BODY                 PIC X(165).
  4311
  4312     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4313         16  AT-RESERVE-CONTROLS.
  4314             20  AT-MANUAL-SW            PIC X.
  4315                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4316             20  AT-FUTURE-SW            PIC X.
  4317                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4318             20  AT-PTC-SW               PIC X.
  4319                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4320             20  AT-IBNR-SW              PIC X.
  4321                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4322             20  AT-PTC-LF-SW            PIC X.
  4323                 88  AT-LF-PTC-USED          VALUE '1'.
  4324             20  AT-CDT-ACCESS-METHOD    PIC X.
  4325                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4326                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4327                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4328             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  79
* EL131.cbl
  4329         16  AT-LAST-COMPUTED-DT         PIC XX.
  4330         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4331         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4332         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4333         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4334         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4335         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4336         16  AT-EXPENSE-CONTROLS.
  4337             20  AT-EXPENSE-METHOD       PIC X.
  4338                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4339                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4340                 88  PERCENT-OF-PMT           VALUE '3'.
  4341                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4342             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4343             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4344         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4345         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4346
  4347         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4348         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4349
  4350*        16  FILLER                      PIC X(53).
  4351         16  FILLER                      PIC X(47).
  4352
  4353         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4354         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4355
  4356         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4357             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4358             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4359*                    C = CLOSED
  4360*                    O = OPEN
  4361             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4362*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4363
  4364     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4365         16  AT-PAYMENT-TYPE             PIC X.
  4366             88  PARTIAL-PAYMENT                VALUE '1'.
  4367             88  FINAL-PAYMENT                  VALUE '2'.
  4368             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4369             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4370             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4371             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4372             88  VOIDED-PAYMENT                 VALUE '9'.
  4373             88  TRANSFER                       VALUE 'T'.
  4374             88  LIFE-INTEREST                  VALUE 'I'.
  4375
  4376         16  AT-CLAIM-TYPE               PIC X.
  4377             88  PAID-FOR-AH                    VALUE 'A'.
  4378             88  PAID-FOR-LIFE                  VALUE 'L'.
  4379             88  PAID-FOR-IUI                   VALUE 'I'.
  4380             88  PAID-FOR-GAP                   VALUE 'G'.
  4381             88  PAID-FOR-FAM                   VALUE 'F'.
  4382         16  AT-CLAIM-PREM-TYPE          PIC X.
  4383             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4384             88  AT-O-B-COVERAGE                VALUE '2'.
  4385             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4386         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  80
* EL131.cbl
  4387         16  AT-CHECK-NO                 PIC X(7).
  4388         16  AT-PAID-FROM-DT             PIC XX.
  4389         16  AT-PAID-THRU-DT             PIC XX.
  4390         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4391         16  AT-ACH-PAYMENT              PIC X.
  4392*        16  FILLER                      PIC X.
  4393         16  AT-PAYEES-NAME              PIC X(30).
  4394         16  AT-PAYMENT-ORIGIN           PIC X.
  4395             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4396             88  ONLINE-AUTO-PMT                VALUE '2'.
  4397             88  OFFLINE-PMT                    VALUE '3'.
  4398         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4399         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4400         16  AT-VOID-DATA.
  4401             20  AT-VOID-DT              PIC XX.
  4402*00144       20  AT-VOID-REASON          PIC X(30).
  4403             20  AT-VOID-REASON          PIC X(26).
  4404         16  AT-PMT-APPROVED-BY          PIC X(04).
  4405         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4406         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4407         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4408                                         PIC S99V9(5)  COMP-3.
  4409         16  AT-CREDIT-INTERFACE.
  4410             20  AT-PMT-SELECT-DT        PIC XX.
  4411                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4412             20  AT-PMT-ACCEPT-DT        PIC XX.
  4413                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4414             20  AT-VOID-SELECT-DT       PIC XX.
  4415                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4416             20  AT-VOID-ACCEPT-DT       PIC XX.
  4417                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4418
  4419         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  4420                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4421                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4422         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4423
  4424         16  AT-FORCE-CONTROL            PIC X.
  4425             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4426         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4427         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4428         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4429         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4430         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4431         16  AT-BENEFIT-TYPE             PIC X.
  4432
  4433         16  AT-EXPENSE-TYPE             PIC X.
  4434         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4435
  4436         16  AT-PAYEE-TYPE-CD.
  4437             20  AT-PAYEE-TYPE           PIC X.
  4438                 88  INSURED-PAID           VALUE 'I'.
  4439                 88  BENEFICIARY-PAID       VALUE 'B'.
  4440                 88  ACCOUNT-PAID           VALUE 'A'.
  4441                 88  OTHER-1-PAID           VALUE 'O'.
  4442                 88  OTHER-2-PAID           VALUE 'Q'.
  4443                 88  DOCTOR-PAID            VALUE 'P'.
  4444                 88  EMPLOYER-PAID          VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  81
* EL131.cbl
  4445             20  AT-PAYEE-SEQ            PIC X.
  4446
  4447         16  AT-CASH-PAYMENT             PIC X.
  4448         16  AT-GROUPED-PAYMENT          PIC X.
  4449         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4450         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4451         16  AT-APPROVED-LEVEL           PIC X.
  4452         16  AT-VOID-TYPE                PIC X.
  4453             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4454             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4455         16  AT-AIG-UNEMP-IND            PIC X.
  4456             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4457         16  AT-ASSOCIATES               PIC X.
  4458             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4459             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4460
  4461         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4462         16  AT-CV-PMT-CODE              PIC X.
  4463             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4464             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4465             88  FULL-ADD-PAYMENT           VALUE '3'.
  4466             88  HALF-ADD-PAYMENT           VALUE '4'.
  4467             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4468             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4469             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4470             88  ADDL-PAYMENT               VALUE '8'.
  4471
  4472         16  AT-EOB-CODE1                PIC XXX.
  4473         16  AT-EOB-CODE2                PIC XXX.
  4474         16  AT-EOB-CODE3                PIC XXX.
  4475         16  FILLER REDEFINES AT-EOB-CODE3.
  4476             20  AT-PRINT-CLM-FORM       PIC X.
  4477             20  AT-PRINT-SURVEY         PIC X.
  4478             20  AT-SPECIAL-RELEASE      PIC X.
  4479         16  AT-EOB-CODE4                PIC XXX.
  4480         16  FILLER REDEFINES AT-EOB-CODE4.
  4481             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4482             20  FILLER                  PIC X.
  4483         16  AT-EOB-CODE5                PIC XXX.
  4484         16  FILLER REDEFINES AT-EOB-CODE5.
  4485             20  AT-PMT-PROOF-DT         PIC XX.
  4486             20  FILLER                  PIC X.
  4487
  4488         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4489             88  AT-PRINT-EOB            VALUE 'Y'.
  4490
  4491         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4492         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4493
  4494     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4495         16  AT-SCHEDULE-START-DT        PIC XX.
  4496         16  AT-SCHEDULE-END-DT          PIC XX.
  4497         16  AT-TERMINATED-DT            PIC XX.
  4498         16  AT-LAST-PMT-TYPE            PIC X.
  4499             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4500             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4501         16  AT-FIRST-PMT-DATA.
  4502             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  82
* EL131.cbl
  4503             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4504             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4505         16  AT-REGULAR-PMT-DATA.
  4506             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4507             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4508             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4509         16  AT-AUTO-PAYEE-CD.
  4510             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4511                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4512                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4513                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4514                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4515                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4516             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4517         16  AT-AUTO-PAY-DAY             PIC 99.
  4518         16  AT-AUTO-CASH                PIC X.
  4519             88  AT-CASH                      VALUE 'Y'.
  4520             88  AT-NON-CASH                  VALUE 'N'.
  4521*        16  FILLER                      PIC X(129).
  4522         16  AT-AUTO-END-LETTER          PIC X(4).
  4523         16  FILLER                      PIC X(125).
  4524
  4525         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4526         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4527
  4528     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4529         16  AT-LETTER-SENT-DT           PIC XX.
  4530         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4531         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4532         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4533         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4534         16  AT-LETTER-ORIGIN            PIC X.
  4535             88  ONLINE-CREATION              VALUE '1' '3'.
  4536             88  OFFLINE-CREATION             VALUE '2' '4'.
  4537             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4538             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4539         16  AT-STD-LETTER-FORM          PIC X(4).
  4540         16  AT-REASON-TEXT              PIC X(70).
  4541         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4542         16  AT-ADDRESEE-TYPE            PIC X.
  4543              88  INSURED-ADDRESEE            VALUE 'I'.
  4544              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4545              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4546              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4547              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4548              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4549              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4550         16  AT-ADDRESSEE-NAME           PIC X(30).
  4551         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4552         16  AT-RESEND-PRINT-DATE        PIC XX.
  4553         16  AT-CORR-SOL-UNSOL           PIC X.
  4554         16  AT-LETTER-PURGED-DT         PIC XX.
  4555*
  4556*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4557*
  4558         16  AT-CSO-REDEFINITION.
  4559             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4560             20  AT-AUTO-CLOSE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  83
* EL131.cbl
  4561             20  AT-LETTER-TO-BENE       PIC X(1).
  4562             20  AT-STOP-LETTER-DT       PIC X(2).
  4563             20  AT-AUTH-RCVD            PIC X(1).
  4564             20  FILLER                  PIC X(18).
  4565*             20  FILLER                  PIC X(27).
  4566             20  AT-CSO-LETTER-STATUS    PIC X.
  4567                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4568                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4569                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4570             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4571             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4572*
  4573*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4574*
  4575*        16  FILLER                      PIC X(26).
  4576*
  4577*        16  AT-DMD-BSR-CODE             PIC X.
  4578*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4579*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4580*
  4581*        16  AT-DMD-LETTER-STATUS        PIC X.
  4582*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4583*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4584*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4585*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4586*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4587
  4588         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4589         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4590
  4591     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4592         16  AT-ADDRESS-TYPE             PIC X.
  4593             88  INSURED-ADDRESS               VALUE 'I'.
  4594             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  4595             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4596             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4597             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4598             88  OTHER-ADDRESS-1               VALUE 'O'.
  4599             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4600         16  AT-MAIL-TO-NAME             PIC X(30).
  4601         16  AT-ADDRESS-LINE-1           PIC X(30).
  4602         16  AT-ADDRESS-LINE-2           PIC X(30).
  4603         16  AT-CITY-STATE.
  4604             20  AT-CITY                 PIC X(28).
  4605             20  AT-STATE                PIC XX.
  4606         16  AT-ZIP.
  4607             20  AT-ZIP-CODE.
  4608                 24  AT-ZIP-1ST          PIC X.
  4609                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4610                 24  FILLER              PIC X(4).
  4611             20  AT-ZIP-PLUS4            PIC X(4).
  4612         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4613             20  AT-CAN-POSTAL-1         PIC XXX.
  4614             20  AT-CAN-POSTAL-2         PIC XXX.
  4615             20  FILLER                  PIC XXX.
  4616         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4617*         16  FILLER                      PIC X(23).
  4618         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  84
* EL131.cbl
  4619         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4620         16  FILLER                      PIC X(13).
  4621         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4622         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4623
  4624     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4625         16  AT-INFO-LINE-1              PIC X(60).
  4626         16  FILLER REDEFINES AT-INFO-LINE-1.
  4627             20  AT-NOTE-ERROR-NO OCCURS 15
  4628                                         PIC X(4).
  4629         16  AT-INFO-LINE-2              PIC X(60).
  4630         16  FILLER REDEFINES AT-INFO-LINE-2.
  4631             20  AT-ICD-CODE-1           PIC X(8).
  4632             20  AT-ICD-CODE-2           PIC X(8).
  4633             20  FILLER                  PIC X(44).
  4634         16  AT-INFO-TRAILER-TYPE        PIC X.
  4635             88  AT-ERRORS-NOTE          VALUE 'E'.
  4636             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4637             88  AT-CALL-NOTE            VALUE 'C'.
  4638             88  AT-MAINT-NOTE           VALUE 'M'.
  4639             88  AT-CERT-CHANGE          VALUE 'X'.
  4640             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4641             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4642             88  AT-CERT-CANCELLED       VALUE 'T'.
  4643         16  AT-CALL-TYPE                PIC X.
  4644             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4645             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4646         16  AT-NOTE-CONTINUATION        PIC X.
  4647             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4648         16  AT-EOB-CODES-EXIST          PIC X.
  4649             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4650         16  FILLER                      PIC X(35).
  4651         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4652         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4653
  4654     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4655         16  AT-PROMPT-LINE-1            PIC X(60).
  4656         16  AT-PROMPT-LINE-2            PIC X(60).
  4657         16  AT-PROMPT-START-DT          PIC XX.
  4658         16  AT-PROMPT-END-DT            PIC XX.
  4659         16  FILLER                      PIC X(35).
  4660         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4661         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4662
  4663     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4664         16  AT-DENIAL-INFO-1            PIC X(60).
  4665         16  AT-DENIAL-INFO-2            PIC X(60).
  4666         16  AT-DENIAL-DT                PIC XX.
  4667         16  AT-RETRACTION-DT            PIC XX.
  4668         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4669*         16  FILLER                      PIC X(31).
  4670         16  AT-DENIAL-PROOF-DT          PIC XX.
  4671         16  FILLER                      PIC X(29).
  4672         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4673         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4674
  4675     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4676         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  85
* EL131.cbl
  4677         16  AT-OLD-REPORTED-DT          PIC XX.
  4678         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4679         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4680         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4681         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4682         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4683         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4684         16  FILLER                      PIC X(26).
  4685         16  AT-OLD-DIAG-CODE            PIC X(6).
  4686         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4687         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4688         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4689         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4690         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4691         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4692         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4693         16  AT-OLD-ICD-CODE-1           PIC X(8).
  4694         16  AT-OLD-ICD-CODE-2           PIC X(8).
  4695         16  FILLER                      PIC X(9).
  4696         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4697
  4698     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4699         16  AT-FORM-SEND-ON-DT          PIC XX.
  4700         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4701         16  AT-FORM-RE-SEND-DT          PIC XX.
  4702         16  AT-FORM-ANSWERED-DT         PIC XX.
  4703         16  AT-FORM-PRINTED-DT          PIC XX.
  4704         16  AT-FORM-REPRINT-DT          PIC XX.
  4705         16  AT-FORM-TYPE                PIC X.
  4706             88  INITIAL-FORM                  VALUE '1'.
  4707             88  PROGRESS-FORM                 VALUE '2'.
  4708         16  AT-INSTRUCT-LN-1            PIC X(28).
  4709         16  AT-INSTRUCT-LN-2            PIC X(28).
  4710         16  AT-INSTRUCT-LN-3            PIC X(28).
  4711         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4712         16  AT-FORM-ADDRESS             PIC X.
  4713             88  FORM-TO-INSURED              VALUE 'I'.
  4714             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4715             88  FORM-TO-OTHER-1              VALUE 'O'.
  4716             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4717         16  AT-RELATED-1.
  4718             20 AT-REL-CARR-1            PIC X.
  4719             20 AT-REL-CLAIM-1           PIC X(7).
  4720             20 AT-REL-CERT-1            PIC X(11).
  4721         16  AT-RELATED-2.
  4722             20 AT-REL-CARR-2            PIC X.
  4723             20 AT-REL-CLAIM-2           PIC X(7).
  4724             20 AT-REL-CERT-2            PIC X(11).
  4725         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4726         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4727         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4728         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4729         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4730         16  AT-STOP-FORM-DT             PIC X(2).
  4731
  4732         16  FILLER                      PIC X(09).
  4733         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4734         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  86
* EL131.cbl
  4735******************************************************************
  4736
  4737*                                COPY ELCCNTL.
  4738******************************************************************
  4739*                                                                *
  4740*                                                                *
  4741*                            ELCCNTL.                            *
  4742*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4743*                            VMOD=2.059                          *
  4744*                                                                *
  4745*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4746*                                                                *
  4747*   FILE TYPE = VSAM,KSDS                                        *
  4748*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4749*                                                                *
  4750*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4751*       ALTERNATE INDEX = NONE                                   *
  4752*                                                                *
  4753*   LOG = YES                                                    *
  4754*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4755******************************************************************
  4756*                   C H A N G E   L O G
  4757*
  4758* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4759*-----------------------------------------------------------------
  4760*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4761* EFFECTIVE    NUMBER
  4762*-----------------------------------------------------------------
  4763* 082503                   PEMA  ADD BENEFIT GROUP
  4764* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4765* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4766* 092705    2005050300006  PEMA  ADD SPP LEASES
  4767* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4768* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4769* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4770* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4771* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4772* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4773* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4774* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4775* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4776* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4777* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4778******************************************************************
  4779*
  4780 01  CONTROL-FILE.
  4781     12  CF-RECORD-ID                       PIC XX.
  4782         88  VALID-CF-ID                        VALUE 'CF'.
  4783
  4784     12  CF-CONTROL-PRIMARY.
  4785         16  CF-COMPANY-ID                  PIC XXX.
  4786         16  CF-RECORD-TYPE                 PIC X.
  4787             88  CF-COMPANY-MASTER              VALUE '1'.
  4788             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4789             88  CF-STATE-MASTER                VALUE '3'.
  4790             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4791             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4792             88  CF-CARRIER-MASTER              VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  87
* EL131.cbl
  4793             88  CF-MORTALITY-MASTER            VALUE '7'.
  4794             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4795             88  CF-TERMINAL-MASTER             VALUE '9'.
  4796             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4797             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4798             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4799             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4800             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4801             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4802             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4803             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4804             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4805         16  CF-ACCESS-CD-GENL              PIC X(4).
  4806         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4807             20  CF-PROCESSOR               PIC X(4).
  4808         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4809             20  CF-STATE-CODE              PIC XX.
  4810             20  FILLER                     PIC XX.
  4811         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4812             20  FILLER                     PIC XX.
  4813             20  CF-HI-BEN-IN-REC           PIC XX.
  4814         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4815             20  FILLER                     PIC XXX.
  4816             20  CF-CARRIER-CNTL            PIC X.
  4817         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4818             20  FILLER                     PIC XX.
  4819             20  CF-HI-TYPE-IN-REC          PIC 99.
  4820         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4821             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4822                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4823             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4824             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4825         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4826             20  FILLER                     PIC X.
  4827             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4828         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4829             20  FILLER                     PIC XX.
  4830             20  CF-MORTGAGE-PLAN           PIC XX.
  4831         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4832
  4833     12  CF-LAST-MAINT-DT                   PIC XX.
  4834     12  CF-LAST-MAINT-BY                   PIC X(4).
  4835     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4836
  4837     12  CF-RECORD-BODY                     PIC X(728).
  4838
  4839
  4840****************************************************************
  4841*             COMPANY MASTER RECORD                            *
  4842****************************************************************
  4843
  4844     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4845         16  CF-COMPANY-ADDRESS.
  4846             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4847             20  CF-CL-IN-CARE-OF           PIC X(30).
  4848             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4849             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4850             20  CF-CL-CITY-STATE           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  88
* EL131.cbl
  4851             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4852             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4853         16  CF-COMPANY-CD                  PIC X.
  4854         16  CF-COMPANY-PASSWORD            PIC X(8).
  4855         16  CF-SECURITY-OPTION             PIC X.
  4856             88  ALL-SECURITY                   VALUE '1'.
  4857             88  COMPANY-VERIFY                 VALUE '2'.
  4858             88  PROCESSOR-VERIFY               VALUE '3'.
  4859             88  NO-SECURITY                    VALUE '4'.
  4860             88  ALL-BUT-TERM                   VALUE '5'.
  4861         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4862             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4863         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4864             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4865         16  CF-INFORCE-LOCATION            PIC X.
  4866             88  CERTS-ARE-ONLINE               VALUE '1'.
  4867             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4868             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4869         16  CF-LOWER-CASE-LETTERS          PIC X.
  4870         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4871             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4872             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4873             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4874             88  CF-ACCNT-CNTL                  VALUE '3'.
  4875             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4876
  4877         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4878         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4879
  4880         16  CF-LGX-CREDIT-USER             PIC X.
  4881             88  CO-IS-NOT-USER                 VALUE 'N'.
  4882             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4883
  4884         16 CF-CREDIT-CALC-CODES.
  4885             20  CF-CR-REM-TERM-CALC PIC X.
  4886               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4887               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4888               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4889               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4890               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4891               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4892               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4893             20  CF-CR-R78-METHOD           PIC X.
  4894               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4895               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4896
  4897         16  CF-CLAIM-CONTROL-COUNTS.
  4898             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4899                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4900
  4901             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4902                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4903
  4904             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4905                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4906
  4907             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4908                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  89
* EL131.cbl
  4909
  4910         16  CF-CURRENT-MONTH-END           PIC XX.
  4911
  4912         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4913             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4914             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4915             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4916             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4917                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4918                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4919             20  CF-CO-PREM-REJECT-SW       PIC X.
  4920                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4921                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4922             20  CF-CO-REF-REJECT-SW        PIC X.
  4923                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4924                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4925
  4926         16  CF-CO-REPORTING-DT             PIC XX.
  4927         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4928         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4929           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4930           88  CF-CO-MONTH-END                  VALUE '1'.
  4931
  4932         16  CF-LGX-CLAIM-USER              PIC X.
  4933             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4934             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4935
  4936         16  CF-CREDIT-EDIT-CONTROLS.
  4937             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4938             20  CF-MIN-AGE                 PIC 99.
  4939             20  CF-DEFAULT-AGE             PIC 99.
  4940             20  CF-MIN-TERM                PIC S999      COMP-3.
  4941             20  CF-MAX-TERM                PIC S999      COMP-3.
  4942             20  CF-DEFAULT-SEX             PIC X.
  4943             20  CF-JOINT-AGE-INPUT         PIC X.
  4944                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4945             20  CF-BIRTH-DATE-INPUT        PIC X.
  4946                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4947             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4948                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4949                 88  CF-ZERO-CARRIER            VALUE '1'.
  4950                 88  CF-ZERO-GROUPING           VALUE '2'.
  4951                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4952             20  CF-EDIT-SW                 PIC X.
  4953                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4954             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4955             20  CF-CR-PR-METHOD            PIC X.
  4956               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4957               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4958             20  FILLER                     PIC X.
  4959
  4960         16  CF-CREDIT-MISC-CONTROLS.
  4961             20  CF-REIN-TABLE-SW           PIC X.
  4962                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4963             20  CF-COMP-TABLE-SW           PIC X.
  4964                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4965             20  CF-EXPERIENCE-RETENTION-AGE
  4966                                            PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  90
* EL131.cbl
  4967             20  CF-CONVERSION-DT           PIC XX.
  4968             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4969             20  CF-RUN-FREQUENCY-SW        PIC X.
  4970                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4971                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4972
  4973             20  CF-CR-CHECK-NO-CONTROL.
  4974                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4975                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4976                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4977                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4978                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4979                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4980
  4981                 24  CF-CR-CHECK-COUNT       REDEFINES
  4982                     CF-CR-CHECK-COUNTER      PIC X(4).
  4983
  4984                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4985                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4986
  4987                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4988                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4989                 24  CF-MAIL-PROCESSING       PIC X.
  4990                     88  MAIL-PROCESSING          VALUE 'Y'.
  4991
  4992         16  CF-MISC-SYSTEM-CONTROL.
  4993             20  CF-SYSTEM-C                 PIC X.
  4994                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4995             20  CF-SYSTEM-D                 PIC X.
  4996                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4997             20  CF-SOC-SEC-NO-SW            PIC X.
  4998                 88  SOC-SEC-NO-USED             VALUE '1'.
  4999             20  CF-MEMBER-NO-SW             PIC X.
  5000                 88  MEMBER-NO-USED              VALUE '1'.
  5001             20  CF-TAX-ID-NUMBER            PIC X(11).
  5002             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5003             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5004                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5005                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5006                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5007                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5008             20  CF-SYSTEM-E                 PIC X.
  5009                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5010
  5011         16  CF-LGX-LIFE-USER               PIC X.
  5012             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5013             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5014
  5015         16  CF-CR-MONTH-END-DT             PIC XX.
  5016
  5017         16  CF-FILE-MAINT-DATES.
  5018             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5019                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5020             20  CF-LAST-BATCH       REDEFINES
  5021                 CF-LAST-BATCH-NO               PIC X(4).
  5022             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5023             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5024             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  91
* EL131.cbl
  5025             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5026             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5027             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5028             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5029             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5030             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5031             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5032
  5033         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5034         16  FILLER                         PIC X.
  5035
  5036         16  CF-ALT-MORT-CODE               PIC X(4).
  5037         16  CF-MEMBER-CAPTION              PIC X(10).
  5038
  5039         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5040             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5041             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5042             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5043             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5044             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5045
  5046         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5047
  5048         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5049         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5050         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5051         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5052
  5053         16  CF-AH-OVERRIDE-L1              PIC X.
  5054         16  CF-AH-OVERRIDE-L2              PIC XX.
  5055         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5056         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5057
  5058         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5059         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5060
  5061         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5062         16  CF-AR-LAST-EL860-DT            PIC XX.
  5063         16  CF-MP-MONTH-END-DT             PIC XX.
  5064
  5065         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5066         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5067             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5068
  5069         16  CF-AR-MONTH-END-DT             PIC XX.
  5070
  5071         16  CF-CRDTCRD-USER                PIC X.
  5072             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5073             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5074
  5075         16  CF-CC-MONTH-END-DT             PIC XX.
  5076
  5077         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5078
  5079         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5080             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5081             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5082             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  92
* EL131.cbl
  5083         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5084         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5085         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5086         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5087             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5088             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5089         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5090         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5091         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5092             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5093         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5094
  5095         16  CF-CL-ZIP-CODE.
  5096             20  CF-CL-ZIP-PRIME.
  5097                 24  CF-CL-ZIP-1ST          PIC X.
  5098                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5099                 24  FILLER                 PIC X(4).
  5100             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5101         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5102             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5103             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5104             20  FILLER                     PIC XXX.
  5105
  5106         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5107         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5108         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5109         16  CF-CO-OPTION-START-DATE        PIC XX.
  5110         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5111           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5112                                                      '3' '4'.
  5113           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5114           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5115           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5116           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5117           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5118           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5119
  5120         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5121
  5122         16  CF-PAYMENT-APPROVAL-LEVELS.
  5123             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5124             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5125             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5126             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5127             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5128             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5129
  5130         16  CF-END-USER-REPORTING-USER     PIC X.
  5131             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5132             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5133
  5134         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5135             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5136             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5137
  5138         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5139
  5140         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  93
* EL131.cbl
  5141         16  FILLER                         PIC X.
  5142
  5143         16  CF-CREDIT-ARCHIVE-CNTL.
  5144             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5145             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5146             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5147
  5148         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5149
  5150         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5151             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5152             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5153
  5154         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5155             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5156             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5157
  5158         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5159
  5160         16  CF-CO-ACH-ID-CODE              PIC  X.
  5161             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5162             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5163             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5164         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5165         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5166         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5167         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5168         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5169         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5170         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5171         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5172         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5173                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5174         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5175                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5176
  5177         16  CF-CO-OVER-SHORT.
  5178             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5179             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5180
  5181*         16  FILLER                         PIC X(102).
  5182         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5183             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5184             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5185
  5186         16  CF-AH-APPROVAL-DAYS.
  5187             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5188             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5189             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5190             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5191
  5192         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5193
  5194         16  CF-APPROV-LEV-5.
  5195             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5196             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5197             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5198
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  94
* EL131.cbl
  5199         16  FILLER                         PIC X(68).
  5200****************************************************************
  5201*             PROCESSOR/USER RECORD                            *
  5202****************************************************************
  5203
  5204     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5205         16  CF-PROCESSOR-NAME              PIC X(30).
  5206         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5207         16  CF-PROCESSOR-TITLE             PIC X(26).
  5208         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5209                 88  MESSAGE-YES                VALUE 'Y'.
  5210                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5211
  5212*****************************************************
  5213****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5214****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5215****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5216****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5217*****************************************************
  5218
  5219         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5220             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5221             20  CF-APPLICATION-FORCE       PIC X.
  5222             20  CF-INDIVIDUAL-APP.
  5223                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5224                     28  CF-BROWSE-APP      PIC X.
  5225                     28  CF-UPDATE-APP      PIC X.
  5226
  5227         16  CF-CURRENT-TERM-ON             PIC X(4).
  5228         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5229             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5230             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5231             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5232             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5233             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5234             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5235             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5236         16  CF-PROCESSOR-CARRIER           PIC X.
  5237             88  NO-CARRIER-SECURITY            VALUE ' '.
  5238         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5239             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5240         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5241             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5242         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5243             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5244
  5245         16  CF-PROC-SYS-ACCESS-SW.
  5246             20  CF-PROC-CREDIT-CLAIMS-SW.
  5247                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5248                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5249                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5250                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5251             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5252                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5253                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5254             20  CF-PROC-LIFE-GNRLDGR-SW.
  5255                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5256                     88  ACCESS-TO-LIFE             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  95
* EL131.cbl
  5257                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5258                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5259             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5260                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5261                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5262         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5263             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5264             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5265         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5266
  5267         16  CF-APPROVAL-LEVEL                  PIC X.
  5268             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5269             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5270             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5271             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5272             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5273
  5274         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5275
  5276         16  CF-LANGUAGE-TYPE                   PIC X.
  5277             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5278             88  CF-LANG-IS-FR                      VALUE 'F'.
  5279
  5280         16  CF-CSR-IND                         PIC X.
  5281         16  FILLER                             PIC X(239).
  5282
  5283****************************************************************
  5284*             PROCESSOR/REMINDERS RECORD                       *
  5285****************************************************************
  5286
  5287     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5288         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5289             20  CF-START-REMIND-DT         PIC XX.
  5290             20  CF-END-REMIND-DT           PIC XX.
  5291             20  CF-REMINDER-TEXT           PIC X(50).
  5292         16  FILLER                         PIC X(296).
  5293
  5294
  5295****************************************************************
  5296*             STATE MASTER RECORD                              *
  5297****************************************************************
  5298
  5299     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5300         16  CF-STATE-ABBREVIATION          PIC XX.
  5301         16  CF-STATE-NAME                  PIC X(25).
  5302         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5303         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5304             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5305             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5306             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5307             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5308                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5309                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5310             20  CF-ST-PREM-REJECT-SW       PIC X.
  5311                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5312                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5313             20  CF-ST-REF-REJECT-SW        PIC X.
  5314                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  96
* EL131.cbl
  5315                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5316         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5317         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5318         16  CF-ST-REFUND-RULES.
  5319             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5320             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5321             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5322         16  CF-ST-FST-PMT-EXTENSION.
  5323             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5324             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5325                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5326                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5327                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5328                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5329         16  CF-ST-STATE-CALL.
  5330             20  CF-ST-CALL-UNEARNED        PIC X.
  5331             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5332             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5333         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5334             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5335             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5336         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5337         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5338         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5339         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5340         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5341         16  FILLER                         PIC X.
  5342         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5343             20  CF-ST-BENEFIT-CD           PIC XX.
  5344             20  CF-ST-BENEFIT-KIND         PIC X.
  5345                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5346                 88  CF-ST-AH-KIND              VALUE 'A'.
  5347             20  CF-ST-REM-TERM-CALC        PIC X.
  5348                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5349                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5350                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5351                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5352                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5353                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5354                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5355                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5356
  5357             20  CF-ST-REFUND-CALC          PIC X.
  5358                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5359                 88  ST-REFD-BY-R78             VALUE '1'.
  5360                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5361                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5362                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5363                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5364                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5365                 88  ST-REFD-UTAH               VALUE '7'.
  5366                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5367                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5368                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5369
  5370             20  CF-ST-EARNING-CALC         PIC X.
  5371                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5372                 88  ST-EARN-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  97
* EL131.cbl
  5373                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5374                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5375                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5376                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5377                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5378                 88  ST-EARN-MEAN               VALUE '8'.
  5379                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5380
  5381             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5382                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5383                 88  ST-OVRD-BY-R78             VALUE '1'.
  5384                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5385                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5386                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5387                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5388                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5389                 88  ST-OVRD-MEAN               VALUE '8'.
  5390                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5391             20  cf-st-extra-periods        pic 9.
  5392*            20  FILLER                     PIC X.
  5393
  5394         16  CF-ST-COMMISSION-CAPS.
  5395             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5396             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5397             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5398             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5399         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5400                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5401                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5402                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5403
  5404         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5405
  5406         16  CF-ST-STATUTORY-INTEREST.
  5407             20  CF-ST-STAT-DATE-FROM       PIC X.
  5408                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5409                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5410             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5411             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5412             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5413             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5414             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5415
  5416         16  CF-ST-OVER-SHORT.
  5417             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5418             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5419
  5420         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5421
  5422         16  CF-ST-RT-CALC                  PIC X.
  5423
  5424         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5425         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5426         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5427         16  CF-ST-RF-LR-CALC               PIC X.
  5428         16  CF-ST-RF-LL-CALC               PIC X.
  5429         16  CF-ST-RF-LN-CALC               PIC X.
  5430         16  CF-ST-RF-AH-CALC               PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  98
* EL131.cbl
  5431         16  CF-ST-RF-CP-CALC               PIC X.
  5432*        16  FILLER                         PIC X(206).
  5433*CIDMOD         16  FILLER                         PIC X(192).
  5434         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5435             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5436         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5437         16  CF-ST-VFY-2ND-BENE             PIC X.
  5438         16  CF-ST-CAUSAL-STATE             PIC X.
  5439         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5440         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5441         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5442             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5443         16  CF-ST-NET-ONLY-STATE           PIC X.
  5444             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5445         16  cf-commission-cap-required     pic x.
  5446         16  CF-ST-GA-COMMISSION-CAPS.
  5447             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  5448             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  5449             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  5450             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  5451         16  CF-ST-TOT-COMMISSION-CAPS.
  5452             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  5453             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  5454             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  5455             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  5456         16  FILLER                         PIC X(156).
  5457
  5458****************************************************************
  5459*             BENEFIT MASTER RECORD                            *
  5460****************************************************************
  5461
  5462     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5463         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5464             20  CF-BENEFIT-CODE            PIC XX.
  5465             20  CF-BENEFIT-NUMERIC  REDEFINES
  5466                 CF-BENEFIT-CODE            PIC XX.
  5467             20  CF-BENEFIT-ALPHA           PIC XXX.
  5468             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5469             20  CF-BENEFIT-COMMENT         PIC X(10).
  5470
  5471             20  CF-LF-COVERAGE-TYPE        PIC X.
  5472                 88  CF-REDUCING                VALUE 'R'.
  5473                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5474
  5475             20  CF-SPECIAL-CALC-CD         PIC X.
  5476                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5477                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5478                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5479                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5480                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5481                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5482                 88  CF-FARM-PLAN               VALUE 'F'.
  5483                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5484                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5485                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5486                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5487                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5488                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page  99
* EL131.cbl
  5489                 88  CF-PRUDENTIAL              VALUE 'P'.
  5490                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5491                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5492                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5493                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5494                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5495                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5496
  5497             20  CF-JOINT-INDICATOR         PIC X.
  5498                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5499
  5500*            20  FILLER                     PIC X(12).
  5501             20  cf-maximum-benefits        pic s999 comp-3.
  5502             20  FILLER                     PIC X(09).
  5503             20  CF-BENEFIT-CATEGORY        PIC X.
  5504             20  CF-LOAN-TYPE               PIC X(8).
  5505
  5506             20  CF-CO-REM-TERM-CALC        PIC X.
  5507                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5508                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5509                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5510                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5511                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5512
  5513             20  CF-CO-EARNINGS-CALC        PIC X.
  5514                 88  CO-EARN-BY-R78             VALUE '1'.
  5515                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5516                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5517                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5518                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5519                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5520                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5521                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5522
  5523             20  CF-CO-REFUND-CALC          PIC X.
  5524                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5525                 88  CO-REFD-BY-R78             VALUE '1'.
  5526                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5527                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5528                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5529                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5530                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5531                 88  CO-REFD-MEAN               VALUE '8'.
  5532                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5533                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5534                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5535
  5536             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5537                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5538                 88  CO-OVRD-BY-R78             VALUE '1'.
  5539                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5540                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5541                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5542                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5543                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5544                 88  CO-OVRD-MEAN               VALUE '8'.
  5545                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5546
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 100
* EL131.cbl
  5547             20  CF-CO-BEN-I-G-CD           PIC X.
  5548                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5549                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5550                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5551
  5552         16  FILLER                         PIC X(304).
  5553
  5554
  5555****************************************************************
  5556*             CARRIER MASTER RECORD                            *
  5557****************************************************************
  5558
  5559     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5560         16  CF-ADDRESS-DATA.
  5561             20  CF-MAIL-TO-NAME            PIC X(30).
  5562             20  CF-IN-CARE-OF              PIC X(30).
  5563             20  CF-ADDRESS-LINE-1          PIC X(30).
  5564             20  CF-ADDRESS-LINE-2          PIC X(30).
  5565             20  CF-CITY-STATE              PIC X(30).
  5566             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5567             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5568
  5569         16  CF-CLAIM-NO-CONTROL.
  5570             20  CF-CLAIM-NO-METHOD         PIC X.
  5571                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5572                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5573                 88  CLAIM-NO-SEQ               VALUE '3'.
  5574                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5575             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5576                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5577                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5578                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5579
  5580         16  CF-CHECK-NO-CONTROL.
  5581             20  CF-CHECK-NO-METHOD         PIC X.
  5582                 88  CHECK-NO-MANUAL            VALUE '1'.
  5583                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5584                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5585                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5586             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5587                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5588
  5589         16  CF-DOMICILE-STATE              PIC XX.
  5590
  5591         16  CF-EXPENSE-CONTROLS.
  5592             20  CF-EXPENSE-METHOD          PIC X.
  5593                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5594                 88  DOLLARS-PER-PMT            VALUE '2'.
  5595                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5596                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5597             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5598             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5599
  5600         16  CF-CORRESPONDENCE-CONTROL.
  5601             20  CF-LETTER-RESEND-OPT       PIC X.
  5602                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5603                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5604             20  FILLER                     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 101
* EL131.cbl
  5605
  5606         16  CF-RESERVE-CONTROLS.
  5607             20  CF-MANUAL-SW               PIC X.
  5608                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5609             20  CF-FUTURE-SW               PIC X.
  5610                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5611             20  CF-PTC-SW                  PIC X.
  5612                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5613             20  CF-IBNR-SW                 PIC X.
  5614                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5615             20  CF-PTC-LF-SW               PIC X.
  5616                 88  CF-LF-PTC-USED             VALUE '1'.
  5617             20  CF-CDT-ACCESS-METHOD       PIC X.
  5618                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5619                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5620                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5621             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5622
  5623         16  CF-CLAIM-CALC-METHOD           PIC X.
  5624             88  360-PLUS-MONTHS                VALUE '1'.
  5625             88  365-PLUS-MONTHS                VALUE '2'.
  5626             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5627             88  360-DAILY                      VALUE '4'.
  5628             88  365-DAILY                      VALUE '5'.
  5629
  5630         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5631         16  FILLER                         PIC X(11).
  5632
  5633         16  CF-LIMIT-AMOUNTS.
  5634             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5635             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5636             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5637             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5638             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5639             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5640             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5641             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5642             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5643             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5644
  5645         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5646         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5647         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5648
  5649         16  CF-ZIP-CODE.
  5650             20  CF-ZIP-PRIME.
  5651                 24  CF-ZIP-1ST             PIC X.
  5652                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5653                 24  FILLER                 PIC X(4).
  5654             20  CF-ZIP-PLUS4               PIC X(4).
  5655         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5656             20  CF-CAN-POSTAL-1            PIC XXX.
  5657             20  CF-CAN-POSTAL-2            PIC XXX.
  5658             20  FILLER                     PIC XXX.
  5659
  5660         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5661         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5662         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 102
* EL131.cbl
  5663
  5664         16  CF-RATING-SWITCH               PIC X.
  5665             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5666             88  CF-NO-RATING                   VALUE 'N'.
  5667
  5668         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5669
  5670         16  CF-CARRIER-OVER-SHORT.
  5671             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5672             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5673
  5674         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5675         16  CF-SECPAY-SWITCH               PIC X.
  5676             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5677             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5678         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5679         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5680         16  FILLER                         PIC X(444).
  5681*        16  FILLER                         PIC X(452).
  5682
  5683
  5684****************************************************************
  5685*             MORTALITY MASTER RECORD                          *
  5686****************************************************************
  5687
  5688     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5689         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5690                                INDEXED BY CF-MORT-NDX.
  5691             20  CF-MORT-TABLE              PIC X(5).
  5692             20  CF-MORT-TABLE-TYPE         PIC X.
  5693                 88  CF-MORT-JOINT              VALUE 'J'.
  5694                 88  CF-MORT-SINGLE             VALUE 'S'.
  5695                 88  CF-MORT-COMBINED           VALUE 'C'.
  5696                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5697                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5698             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5699             20  CF-MORT-AGE-METHOD         PIC XX.
  5700                 88  CF-AGE-LAST                VALUE 'AL'.
  5701                 88  CF-AGE-NEAR                VALUE 'AN'.
  5702             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5703             20  CF-MORT-ADJUSTMENT-DIRECTION
  5704                                            PIC X.
  5705                 88  CF-MINUS                   VALUE '-'.
  5706                 88  CF-PLUS                    VALUE '+'.
  5707             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5708             20  CF-MORT-JOINT-CODE         PIC X.
  5709                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5710             20  CF-MORT-PC-Q               PIC X.
  5711                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5712             20  CF-MORT-TABLE-CODE         PIC X(4).
  5713             20  CF-MORT-COMMENTS           PIC X(15).
  5714             20  FILLER                     PIC X(14).
  5715
  5716         16  FILLER                         PIC X(251).
  5717
  5718
  5719****************************************************************
  5720*             BUSSINESS TYPE MASTER RECORD                     *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 103
* EL131.cbl
  5721****************************************************************
  5722
  5723     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5724* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5725* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5726* AND RECORD 05 IS TYPES 81-99
  5727         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5728             20  CF-BUSINESS-TITLE          PIC  X(19).
  5729             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5730                                            PIC S9V9(4) COMP-3.
  5731             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5732             20  FILLER                     PIC  X.
  5733         16  FILLER                         PIC  X(248).
  5734
  5735
  5736****************************************************************
  5737*             TERMINAL MASTER RECORD                           *
  5738****************************************************************
  5739
  5740     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5741
  5742         16  CF-COMPANY-TERMINALS.
  5743             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5744                                  PIC X(4).
  5745         16  FILLER               PIC X(248).
  5746
  5747
  5748****************************************************************
  5749*             LIFE EDIT MASTER RECORD                          *
  5750****************************************************************
  5751
  5752     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5753         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5754             20  CF-LIFE-CODE-IN            PIC XX.
  5755             20  CF-LIFE-CODE-OUT           PIC XX.
  5756         16  FILLER                         PIC X(248).
  5757
  5758
  5759****************************************************************
  5760*             AH EDIT MASTER RECORD                            *
  5761****************************************************************
  5762
  5763     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5764         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5765             20  CF-AH-CODE-IN              PIC XXX.
  5766             20  CF-AH-CODE-OUT             PIC XX.
  5767         16  FILLER                         PIC X(248).
  5768
  5769
  5770****************************************************************
  5771*             CREDIBILITY TABLES                               *
  5772****************************************************************
  5773
  5774     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5775         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5776                             INDEXED BY CF-CRDB-NDX.
  5777             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5778             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 104
* EL131.cbl
  5779             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5780         16  FILLER                         PIC  X(332).
  5781
  5782
  5783****************************************************************
  5784*             REPORT CUSTOMIZATION RECORD                      *
  5785****************************************************************
  5786
  5787     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5788         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5789             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5790             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5791             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5792**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5793****       A T-TRANSFER.                                   ****
  5794             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5795
  5796         16  FILLER                         PIC XX.
  5797
  5798         16  CF-CARRIER-CNTL-OPT.
  5799             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5800                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5801                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5802             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5803                                            PIC X.
  5804         16  CF-GROUP-CNTL-OPT.
  5805             20  CF-GROUP-OPT-SEQ           PIC 9.
  5806                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5807                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5808             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5809                                            PIC X(6).
  5810         16  CF-STATE-CNTL-OPT.
  5811             20  CF-STATE-OPT-SEQ           PIC 9.
  5812                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5813                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5814             20  CF-STATE-SELECT OCCURS 3 TIMES
  5815                                            PIC XX.
  5816         16  CF-ACCOUNT-CNTL-OPT.
  5817             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5818                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5819                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5820             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5821                                            PIC X(10).
  5822         16  CF-BUS-TYP-CNTL-OPT.
  5823             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5824                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5825                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5826             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5827                                            PIC XX.
  5828         16  CF-LF-TYP-CNTL-OPT.
  5829             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5830                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5831                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5832             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5833                                            PIC XX.
  5834         16  CF-AH-TYP-CNTL-OPT.
  5835             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5836                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 105
* EL131.cbl
  5837                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5838             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5839                                            PIC XX.
  5840         16  CF-REPTCD1-CNTL-OPT.
  5841             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5842                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5843                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5844             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5845                                            PIC X(10).
  5846         16  CF-REPTCD2-CNTL-OPT.
  5847             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5848                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5849                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5850             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5851                                            PIC X(10).
  5852         16  CF-USER1-CNTL-OPT.
  5853             20  CF-USER1-OPT-SEQ           PIC 9.
  5854                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5855                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5856             20  CF-USER1-SELECT OCCURS 3 TIMES
  5857                                            PIC X(10).
  5858         16  CF-USER2-CNTL-OPT.
  5859             20  CF-USER2-OPT-SEQ           PIC 9.
  5860                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5861                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5862             20  CF-USER2-SELECT OCCURS 3 TIMES
  5863                                            PIC X(10).
  5864         16  CF-USER3-CNTL-OPT.
  5865             20  CF-USER3-OPT-SEQ           PIC 9.
  5866                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5867                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5868             20  CF-USER3-SELECT OCCURS 3 TIMES
  5869                                            PIC X(10).
  5870         16  CF-USER4-CNTL-OPT.
  5871             20  CF-USER4-OPT-SEQ           PIC 9.
  5872                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5873                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5874             20  CF-USER4-SELECT OCCURS 3 TIMES
  5875                                            PIC X(10).
  5876         16  CF-USER5-CNTL-OPT.
  5877             20  CF-USER5-OPT-SEQ           PIC 9.
  5878                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5879                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5880             20  CF-USER5-SELECT OCCURS 3 TIMES
  5881                                            PIC X(10).
  5882         16  CF-REINS-CNTL-OPT.
  5883             20  CF-REINS-OPT-SEQ           PIC 9.
  5884                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5885                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5886             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5887                 24  CF-REINS-PRIME         PIC XXX.
  5888                 24  CF-REINS-SUB           PIC XXX.
  5889
  5890         16  CF-AGENT-CNTL-OPT.
  5891             20  CF-AGENT-OPT-SEQ           PIC 9.
  5892                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5893                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5894             20  CF-AGENT-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 106
* EL131.cbl
  5895                                            PIC X(10).
  5896
  5897         16  FILLER                         PIC X(43).
  5898
  5899         16  CF-LOSS-RATIO-SELECT.
  5900             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5901             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5902         16  CF-ENTRY-DATE-SELECT.
  5903             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5904             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5905         16  CF-EFFECTIVE-DATE-SELECT.
  5906             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5907             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5908
  5909         16  CF-EXCEPTION-LIST-IND          PIC X.
  5910             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5911
  5912         16  FILLER                         PIC X(318).
  5913
  5914****************************************************************
  5915*                  EXCEPTION REPORTING RECORD                  *
  5916****************************************************************
  5917
  5918     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5919         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5920             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5921
  5922         16  CF-COMBINED-LIFE-AH-OPT.
  5923             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5924             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5925             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5926             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5927
  5928         16  CF-LIFE-OPT.
  5929             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5930             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5931             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5932             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5933             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5934             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5935             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5936             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5937             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5938             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5939
  5940         16  CF-AH-OPT.
  5941             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5942             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5943             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5944             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5945             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5946             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5947             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5948             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5949             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5950             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5951
  5952         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 107
* EL131.cbl
  5953             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5954             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5955             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5956
  5957         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5958
  5959         16  FILLER                         PIC X(673).
  5960
  5961
  5962****************************************************************
  5963*             MORTGAGE SYSTEM PLAN RECORD                      *
  5964****************************************************************
  5965
  5966     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5967         16  CF-PLAN-TYPE                   PIC X.
  5968             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5969             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5970             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5971         16  CF-PLAN-ABBREV                 PIC XXX.
  5972         16  CF-PLAN-DESCRIPT               PIC X(10).
  5973         16  CF-PLAN-NOTES                  PIC X(20).
  5974         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5975         16  CF-PLAN-UNDERWRITING.
  5976             20  CF-PLAN-TERM-DATA.
  5977                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5978                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5979             20  CF-PLAN-AGE-DATA.
  5980                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5981                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5982                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5983             20  CF-PLAN-BENEFIT-DATA.
  5984                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5985                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5986                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5987                                            PIC S9(7)V99  COMP-3.
  5988         16  CF-PLAN-POLICY-FORMS.
  5989             20  CF-POLICY-FORM             PIC X(12).
  5990             20  CF-MASTER-APPLICATION      PIC X(12).
  5991             20  CF-MASTER-POLICY           PIC X(12).
  5992         16  CF-PLAN-RATING.
  5993             20  CF-RATE-CODE               PIC X(5).
  5994             20  CF-SEX-RATING              PIC X.
  5995                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5996                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5997             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5998             20  CF-SUB-STD-TYPE            PIC X.
  5999                 88  CF-PCT-OF-PREM            VALUE '1'.
  6000                 88  CF-PCT-OF-BENE            VALUE '2'.
  6001         16  CF-PLAN-PREM-TOLERANCES.
  6002             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6003             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6004         16  CF-PLAN-PYMT-TOLERANCES.
  6005             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6006             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6007         16  CF-PLAN-MISC-DATA.
  6008             20  FILLER                     PIC X.
  6009             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6010             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 108
* EL131.cbl
  6011         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6012         16  CF-PLAN-IND-GRP                PIC X.
  6013             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6014                                                     '1'.
  6015             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6016                                                     '2'.
  6017         16  CF-MIB-SEARCH-SW               PIC X.
  6018             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6019             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6020             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6021             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6022         16  CF-ALPHA-SEARCH-SW             PIC X.
  6023             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6024             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6025             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6026             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6027             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6028             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6029             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6030             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6031             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6032             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6033                                                     'A' 'B' 'C'
  6034                                                     'X' 'Y' 'Z'.
  6035         16  CF-EFF-DT-RULE-SW              PIC X.
  6036             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6037             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6038             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6039             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6040             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6041         16  FILLER                         PIC X(4).
  6042         16  CF-HEALTH-QUESTIONS            PIC X.
  6043             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6044         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6045         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6046         16  CF-PLAN-SNGL-JNT               PIC X.
  6047             88  CF-COMBINED-PLAN              VALUE 'C'.
  6048             88  CF-JNT-PLAN                   VALUE 'J'.
  6049             88  CF-SNGL-PLAN                  VALUE 'S'.
  6050         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6051         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6052         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6053         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6054         16  CF-RERATE-CNTL                 PIC  X.
  6055             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6056             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6057             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6058             88  CF-AUTO-RECALC                 VALUE '4'.
  6059         16  CF-BENEFIT-TYPE                PIC  X.
  6060             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6061             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6062         16  CF-POLICY-FEE                  PIC S999V99
  6063                                                    COMP-3.
  6064         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6065         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6066         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6067         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6068         16  FILLER                         PIC  X(32).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 109
* EL131.cbl
  6069         16  CF-TERMINATION-FORM            PIC  X(04).
  6070         16  FILLER                         PIC  X(08).
  6071         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6072                                                       COMP-3.
  6073         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6074         16  CF-ISSUE-LETTER                PIC  X(4).
  6075         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6076         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6077             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6078             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6079         16  CF-MP-REFUND-CALC              PIC X.
  6080             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6081             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6082             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6083             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6084             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6085             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6086             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6087             88  CF-MP-REFD-MEAN                VALUE '8'.
  6088         16  CF-ALT-RATE-CODE               PIC  X(5).
  6089
  6090
  6091         16  FILLER                         PIC X(498).
  6092****************************************************************
  6093*             MORTGAGE COMPANY MASTER RECORD                   *
  6094****************************************************************
  6095
  6096     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6097         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6098         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6099             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6100             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6101             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6102             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6103             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6104
  6105         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6106         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6107         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6108         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6109         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6110
  6111         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6112             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6113         16  CF-MP-RECON-USE-IND            PIC X(1).
  6114             88  CF-MP-USE-RECON             VALUE 'Y'.
  6115         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6116             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6117         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6118             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6119             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6120         16  FILLER                         PIC X(1).
  6121         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6122             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6123         16  CF-MORTG-MIB-VERSION           PIC X.
  6124             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6125             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6126             88  CF-MORTG-MIB-BOTH          VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 110
* EL131.cbl
  6127         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6128             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6129                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6130             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6131                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6132             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6133                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6134             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6135                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6136             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6137                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6138             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6139                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6140         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6141         16  FILLER                         PIC X(7).
  6142         16  CF-MORTG-DESTINATION-SYMBOL.
  6143             20  CF-MORTG-MIB-COMM          PIC X(5).
  6144             20  CF-MORTG-MIB-TERM          PIC X(5).
  6145         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6146             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6147         16  FILLER                         PIC X(03).
  6148         16  CF-MP-CHECK-NO-CONTROL.
  6149             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6150                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6151                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6152                                                ' ' LOW-VALUES.
  6153                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6154                                               VALUE '3'.
  6155         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6156         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6157         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6158             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6159                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6160             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6161                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6162             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6163                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6164             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6165                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6166             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6167                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6168             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6169                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6170         16  CF-MORTG-BILLING-AREA.
  6171             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6172                                            PIC X.
  6173         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6174         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6175         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6176         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6177             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6178             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6179         16  FILLER                         PIC X.
  6180         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6181             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6182             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6183         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6184         16  FILLER                         PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 111
* EL131.cbl
  6185         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6186         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6187         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6188         16  CF-ACH-COMPANY-ID.
  6189             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6190                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6191                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6192                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6193             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6194         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6195             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6196         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6197             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6198             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6199         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6200         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6201         16  FILLER                         PIC X(536).
  6202
  6203****************************************************************
  6204*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6205****************************************************************
  6206
  6207     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6208         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6209             20  CF-FEMALE-HEIGHT.
  6210                 24  CF-FEMALE-FT           PIC 99.
  6211                 24  CF-FEMALE-IN           PIC 99.
  6212             20  CF-FEMALE-MIN-WT           PIC 999.
  6213             20  CF-FEMALE-MAX-WT           PIC 999.
  6214         16  FILLER                         PIC X(428).
  6215
  6216     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6217         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6218             20  CF-MALE-HEIGHT.
  6219                 24  CF-MALE-FT             PIC 99.
  6220                 24  CF-MALE-IN             PIC 99.
  6221             20  CF-MALE-MIN-WT             PIC 999.
  6222             20  CF-MALE-MAX-WT             PIC 999.
  6223         16  FILLER                         PIC X(428).
  6224******************************************************************
  6225*             AUTOMATIC ACTIVITY RECORD                          *
  6226******************************************************************
  6227     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6228         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6229             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6230             20  CF-SYS-LETTER-ID           PIC X(04).
  6231             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6232             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6233             20  CF-SYS-RESET-SW            PIC X(01).
  6234             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6235             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6236
  6237         16  FILLER                         PIC X(50).
  6238
  6239         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6240             20  CF-USER-ACTIVE-SW          PIC X(01).
  6241             20  CF-USER-LETTER-ID          PIC X(04).
  6242             20  CF-USER-RESEND-DAYS        PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 112
* EL131.cbl
  6243             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6244             20  CF-USER-RESET-SW           PIC X(01).
  6245             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6246             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6247             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6248
  6249         16  FILLER                         PIC X(246).
  6250
  6251*                                COPY ELCACTQ.
  6252******************************************************************
  6253*                                                                *
  6254*                            ELCACTQ.                            *
  6255*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6256*                            VMOD=2.004                          *
  6257*                                                                *
  6258*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6259*                                                                *
  6260*   FILE TYPE = VSAM,KSDS                                        *
  6261*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6262*                                                                *
  6263*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6264*       ALTERNATE INDEX = NONE                                   *
  6265*                                                                *
  6266*   LOG = YES                                                    *
  6267*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6268*                                                                *
  6269*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6270******************************************************************
  6271
  6272 01  ACTIVITY-QUE.
  6273     12  AQ-RECORD-ID                PIC XX.
  6274         88  VALID-AQ-ID                VALUE 'AQ'.
  6275
  6276     12  AQ-CONTROL-PRIMARY.
  6277         16  AQ-COMPANY-CD           PIC X.
  6278         16  AQ-CARRIER              PIC X.
  6279         16  AQ-CLAIM-NO             PIC X(7).
  6280         16  AQ-CERT-NO.
  6281             20  AQ-CERT-PRIME       PIC X(10).
  6282             20  AQ-CERT-SFX         PIC X.
  6283
  6284     12  AQ-PENDING-ACTIVITY-FLAGS.
  6285         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6286         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6287             88  PENDING-PAYMENTS       VALUE '1'.
  6288         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6289             88  PENDING-FULL-PRINT     VALUE '1'.
  6290             88  PENDING-PART-PRINT     VALUE '2'.
  6291         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6292             88  PENDING-LETTERS        VALUE '1'.
  6293         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6294             88  PENDING-RESTORE        VALUE 'C'.
  6295             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6296
  6297     12  FILLER                      PIC X(20).
  6298
  6299     12  AQ-RESEND-DATE              PIC XX.
  6300     12  AQ-FOLLOWUP-DATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 113
* EL131.cbl
  6301     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6302     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6303     12  AQ-AUTO-LETTER              PIC X(4).
  6304     12  FILLER                      PIC XX.
  6305     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6306*****************************************************************
  6307
  6308*                                COPY ERCACCT.
  6309******************************************************************
  6310*                                                                *
  6311*                                                                *
  6312*                            ERCACCT                             *
  6313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6314*                            VMOD=2.031                          *
  6315*                                                                *
  6316*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6317*                                                                *
  6318*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6319*   VSAM ACCOUNT MASTER FILES.                                   *
  6320*                                                                *
  6321*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6322*                                                                *
  6323*   FILE TYPE = VSAM,KSDS                                        *
  6324*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6325*                                                                *
  6326*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6327*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6328*                                                                *
  6329*   LOG = NO                                                     *
  6330*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6331*                                                                *
  6332*                                                                *
  6333******************************************************************
  6334*                   C H A N G E   L O G
  6335*
  6336* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6337*-----------------------------------------------------------------
  6338*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6339* EFFECTIVE    NUMBER
  6340*-----------------------------------------------------------------
  6341* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6342* 092705    2005050300006  PEMA  ADD SPP LEASES
  6343* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6344* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6345* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6346* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6347* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6348* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6349******************************************************************
  6350
  6351 01  ACCOUNT-MASTER.
  6352     12  AM-RECORD-ID                      PIC XX.
  6353         88  VALID-AM-ID                      VALUE 'AM'.
  6354
  6355     12  AM-CONTROL-PRIMARY.
  6356         16  AM-COMPANY-CD                 PIC X.
  6357         16  AM-MSTR-CNTRL.
  6358             20  AM-CONTROL-A.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 114
* EL131.cbl
  6359                 24  AM-CARRIER            PIC X.
  6360                 24  AM-GROUPING.
  6361                     28 AM-GROUPING-PREFIX PIC XXX.
  6362                     28 AM-GROUPING-PRIME  PIC XXX.
  6363                 24  AM-STATE              PIC XX.
  6364                 24  AM-ACCOUNT.
  6365                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6366                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6367             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6368                                           PIC X(19).
  6369             20  AM-CNTRL-B.
  6370                 24  AM-EXPIRATION-DT      PIC XX.
  6371                 24  FILLER                PIC X(4).
  6372             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6373                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6374
  6375     12  AM-CONTROL-BY-VAR-GRP.
  6376         16  AM-COMPANY-CD-A1              PIC X.
  6377         16  AM-VG-CARRIER                 PIC X.
  6378         16  AM-VG-GROUPING                PIC X(6).
  6379         16  AM-VG-STATE                   PIC XX.
  6380         16  AM-VG-ACCOUNT                 PIC X(10).
  6381         16  AM-VG-DATE.
  6382             20  AM-VG-EXPIRATION-DT       PIC XX.
  6383             20  FILLER                    PIC X(4).
  6384         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6385                                           PIC 9(11)      COMP-3.
  6386     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6387         16  FILLER                        PIC X(10).
  6388         16  AM-VG-KEY3.
  6389             20  AM-VG3-ACCOUNT            PIC X(10).
  6390             20  AM-VG3-EXP-DT             PIC XX.
  6391         16  FILLER                        PIC X(4).
  6392     12  AM-MAINT-INFORMATION.
  6393         16  AM-LAST-MAINT-DT              PIC XX.
  6394         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6395         16  AM-LAST-MAINT-USER            PIC X(4).
  6396         16  FILLER                        PIC XX.
  6397
  6398     12  AM-EFFECTIVE-DT                   PIC XX.
  6399     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6400
  6401     12  AM-PREV-DATES  COMP-3.
  6402         16  AM-PREV-EXP-DT                PIC 9(11).
  6403         16  AM-PREV-EFF-DT                PIC 9(11).
  6404
  6405     12  AM-REPORT-CODE-1                  PIC X(10).
  6406     12  AM-REPORT-CODE-2                  PIC X(10).
  6407
  6408     12  AM-CITY-CODE                      PIC X(4).
  6409     12  AM-COUNTY-PARISH                  PIC X(6).
  6410
  6411     12  AM-NAME                           PIC X(30).
  6412     12  AM-PERSON                         PIC X(30).
  6413     12  AM-ADDRS                          PIC X(30).
  6414     12  AM-CITY.
  6415         16  AM-ADDR-CITY                  PIC X(28).
  6416         16  AM-ADDR-STATE                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 115
* EL131.cbl
  6417     12  AM-ZIP.
  6418         16  AM-ZIP-PRIME.
  6419             20  AM-ZIP-PRI-1ST            PIC X.
  6420                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6421             20  FILLER                    PIC X(4).
  6422         16  AM-ZIP-PLUS4                  PIC X(4).
  6423     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6424         16  AM-CAN-POSTAL-1               PIC XXX.
  6425         16  AM-CAN-POSTAL-2               PIC XXX.
  6426         16  FILLER                        PIC XXX.
  6427     12  AM-TEL-NO.
  6428         16  AM-AREA-CODE                  PIC 999.
  6429         16  AM-TEL-PRE                    PIC 999.
  6430         16  AM-TEL-NBR                    PIC 9(4).
  6431     12  AM-TEL-LOC                        PIC X.
  6432         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6433         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6434
  6435     12  AM-COMM-STRUCTURE.
  6436         16  AM-DEFN-1.
  6437             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6438                 24  AM-AGT.
  6439                     28  AM-AGT-PREFIX     PIC X(4).
  6440                     28  AM-AGT-PRIME      PIC X(6).
  6441                 24  AM-COM-TYP            PIC X.
  6442                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6443                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6444                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6445                 24  AM-RECALC-LV-INDIC    PIC X.
  6446                 24  AM-RETRO-LV-INDIC     PIC X.
  6447                 24  AM-GL-CODES           PIC X.
  6448                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6449                 24  FILLER                PIC X(01).
  6450         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6451             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6452                 24  FILLER                PIC X(11).
  6453                 24  AM-L-COMA             PIC XXX.
  6454                 24  AM-J-COMA             PIC XXX.
  6455                 24  AM-A-COMA             PIC XXX.
  6456                 24  FILLER                PIC X(6).
  6457
  6458     12  AM-COMM-CHANGE-STATUS             PIC X.
  6459         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6460
  6461     12  AM-CSR-CODE                       PIC X(4).
  6462
  6463     12  AM-BILLING-STATUS                 PIC X.
  6464         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6465         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6466     12  AM-AUTO-REFUND-SW                 PIC X.
  6467         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6468         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6469     12  AM-GPCD                           PIC 99.
  6470     12  AM-IG                             PIC X.
  6471         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6472         88  AM-HAS-GROUP                     VALUE '2'.
  6473     12  AM-STATUS                         PIC X.
  6474         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 116
* EL131.cbl
  6475         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6476         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6477         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6478         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6479         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6480         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6481         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  6482         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6483         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6484     12  AM-REMIT-TO                       PIC 99.
  6485     12  AM-ID-NO                          PIC X(11).
  6486
  6487     12  AM-CAL-TABLE                      PIC XX.
  6488     12  AM-LF-DEVIATION                   PIC XXX.
  6489     12  AM-AH-DEVIATION                   PIC XXX.
  6490     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6491     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6492     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6493     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6494     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6495     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6496
  6497     12  AM-USER-FIELDS.
  6498         16  AM-FLD-1                      PIC XX.
  6499         16  AM-FLD-2                      PIC XX.
  6500         16  AM-FLD-3                      PIC XX.
  6501         16  AM-FLD-4                      PIC XX.
  6502         16  AM-FLD-5                      PIC XX.
  6503
  6504     12  AM-1ST-PROD-DATE.
  6505         16  AM-1ST-PROD-YR                PIC XX.
  6506         16  AM-1ST-PROD-MO                PIC XX.
  6507         16  AM-1ST-PROD-DA                PIC XX.
  6508     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6509     12  AM-CERTS-PURGED-DATE.
  6510         16  AM-PUR-YR                     PIC XX.
  6511         16  AM-PUR-MO                     PIC XX.
  6512         16  AM-PUR-DA                     PIC XX.
  6513     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6514     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6515     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6516     12  AM-INACTIVE-DATE.
  6517         16  AM-INA-MO                     PIC 99.
  6518         16  AM-INA-DA                     PIC 99.
  6519         16  AM-INA-YR                     PIC 99.
  6520     12  AM-AR-HI-CERT-DATE                PIC XX.
  6521
  6522     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6523     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6524
  6525     12  AM-OB-PAYMENT-MODE                PIC X.
  6526         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6527         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6528         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6529         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6530
  6531     12  AM-AH-ONLY-INDICATOR              PIC X.
  6532         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 117
* EL131.cbl
  6533         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6534
  6535     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6536
  6537     12  AM-OVER-SHORT.
  6538         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6539         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6540
  6541     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6542     12  AM-DCC-CLP-STATE                  PIC XX.
  6543
  6544     12  AM-RECALC-COMM                    PIC X.
  6545     12  AM-RECALC-REIN                    PIC X.
  6546
  6547     12  AM-REI-TABLE                      PIC XXX.
  6548     12  AM-REI-ET-LF                      PIC X.
  6549     12  AM-REI-ET-AH                      PIC X.
  6550     12  AM-REI-PE-LF                      PIC X.
  6551     12  AM-REI-PE-AH                      PIC X.
  6552     12  AM-REI-PRT-ST                     PIC X.
  6553     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6554     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6555     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6556     12  AM-REI-GROUP-A                    PIC X(6).
  6557     12  AM-REI-MORT                       PIC X(4).
  6558     12  AM-REI-PRT-OW                     PIC X.
  6559     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6560     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6561     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6562     12  AM-REI-GROUP-B                    PIC X(6).
  6563
  6564     12  AM-TRUST-TYPE                     PIC X(2).
  6565
  6566     12  AM-EMPLOYER-STMT-USED             PIC X.
  6567     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6568
  6569     12  AM-STD-AH-TYPE                    PIC XX.
  6570     12  AM-EARN-METHODS.
  6571         16  AM-EARN-METHOD-R              PIC X.
  6572             88 AM-REF-RL-R78                 VALUE 'R'.
  6573             88 AM-REF-RL-PR                  VALUE 'P'.
  6574             88 AM-REF-RL-MEAN                VALUE 'M'.
  6575             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6576         16  AM-EARN-METHOD-L              PIC X.
  6577             88 AM-REF-LL-R78                 VALUE 'R'.
  6578             88 AM-REF-LL-PR                  VALUE 'P'.
  6579             88 AM-REF-LL-MEAN                VALUE 'M'.
  6580             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6581         16  AM-EARN-METHOD-A              PIC X.
  6582             88 AM-REF-AH-R78                 VALUE 'R'.
  6583             88 AM-REF-AH-PR                  VALUE 'P'.
  6584             88 AM-REF-AH-MEAN                VALUE 'M'.
  6585             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6586             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6587             88 AM-REF-AH-NET                 VALUE 'N'.
  6588
  6589     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6590     12  AM-TOL-REF                        PIC S999V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 118
* EL131.cbl
  6591     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6592
  6593     12  AM-RET-Y-N                        PIC X.
  6594     12  AM-RET-P-E                        PIC X.
  6595     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6596     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6597     12  AM-RET-GRP                        PIC X(6).
  6598     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6599         16  AM-POOL-PRIME                 PIC XXX.
  6600         16  AM-POOL-SUB                   PIC XXX.
  6601     12  AM-RETRO-EARNINGS.
  6602         16  AM-RET-EARN-R                 PIC X.
  6603         16  AM-RET-EARN-L                 PIC X.
  6604         16  AM-RET-EARN-A                 PIC X.
  6605     12  AM-RET-ST-TAX-USE                 PIC X.
  6606         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6607         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6608     12  AM-RETRO-BEG-EARNINGS.
  6609         16  AM-RET-BEG-EARN-R             PIC X.
  6610         16  AM-RET-BEG-EARN-L             PIC X.
  6611         16  AM-RET-BEG-EARN-A             PIC X.
  6612     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6613     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6614
  6615     12  AM-USER-SELECT-OPTIONS.
  6616         16  AM-USER-SELECT-1              PIC X(10).
  6617         16  AM-USER-SELECT-2              PIC X(10).
  6618         16  AM-USER-SELECT-3              PIC X(10).
  6619         16  AM-USER-SELECT-4              PIC X(10).
  6620         16  AM-USER-SELECT-5              PIC X(10).
  6621
  6622     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6623
  6624     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6625
  6626     12  AM-RPT045A-SWITCH                 PIC X.
  6627         88  RPT045A-OFF                   VALUE 'N'.
  6628
  6629     12  AM-INSURANCE-LIMITS.
  6630         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6631         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6632
  6633     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6634         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6635
  6636     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6637         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6638         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6639
  6640     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6641
  6642     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6643     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6644     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6645     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6646     12  AM-DCC-UEF-STATE                  PIC XX.
  6647     12  FILLER                            PIC XXX.
  6648     12  AM-REPORT-CODE-3                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 119
* EL131.cbl
  6649*    12  FILLER                            PIC X(22).
  6650
  6651     12  AM-RESERVE-DATE.
  6652         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6653         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6654         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6655
  6656     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6657     12  AM-NOTIFICATION-TYPES.
  6658         16  AM-NOTIF-OF-LETTERS           PIC X.
  6659         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6660         16  AM-NOTIF-OF-REPORTS           PIC X.
  6661         16  AM-NOTIF-OF-STATUS            PIC X.
  6662
  6663     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6664         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6665         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6666         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6667         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6668
  6669     12  AM-BENEFIT-CONTROLS.
  6670         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6671             20  AM-BENEFIT-CODE           PIC XX.
  6672             20  AM-BENEFIT-TYPE           PIC X.
  6673             20  AM-BENEFIT-REVISION       PIC XXX.
  6674             20  AM-BENEFIT-REM-TERM       PIC X.
  6675             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6676             20  FILLER                    PIC XX.
  6677         16  FILLER                        PIC X(80).
  6678
  6679     12  AM-TRANSFER-DATA.
  6680         16  AM-TRANSFERRED-FROM.
  6681             20  AM-TRNFROM-CARRIER        PIC X.
  6682             20  AM-TRNFROM-GROUPING.
  6683                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6684                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6685             20  AM-TRNFROM-STATE          PIC XX.
  6686             20  AM-TRNFROM-ACCOUNT.
  6687                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6688                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6689             20  AM-TRNFROM-DTE            PIC XX.
  6690         16  AM-TRANSFERRED-TO.
  6691             20  AM-TRNTO-CARRIER          PIC X.
  6692             20  AM-TRNTO-GROUPING.
  6693                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6694                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6695             20  AM-TRNTO-STATE            PIC XX.
  6696             20  AM-TRNTO-ACCOUNT.
  6697                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6698                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6699             20  AM-TRNTO-DTE              PIC XX.
  6700         16  FILLER                        PIC X(10).
  6701
  6702     12  AM-SAVED-REMIT-TO                 PIC 99.
  6703
  6704     12  AM-COMM-STRUCTURE-SAVED.
  6705         16  AM-DEFN-1-SAVED.
  6706             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 120
* EL131.cbl
  6707                 24  AM-AGT-SV             PIC X(10).
  6708                 24  AM-COM-TYP-SV         PIC X.
  6709                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6710                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6711                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6712                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6713                 24  FILLER                PIC X.
  6714                 24  AM-GL-CODES-SV        PIC X.
  6715                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6716                 24  FILLER                PIC X.
  6717         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6718             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6719                 24  FILLER                PIC X(11).
  6720                 24  AM-L-COMA-SV          PIC XXX.
  6721                 24  AM-J-COMA-SV          PIC XXX.
  6722                 24  AM-A-COMA-SV          PIC XXX.
  6723                 24  FILLER                PIC X(6).
  6724
  6725     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6726         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6727            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6728            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6729            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6730
  6731     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6732     12  FILLER                            PIC X(120).
  6733
  6734     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6735         16  AM-CONTROL-NAME               PIC X(30).
  6736         16  AM-EXECUTIVE-ONE.
  6737             20  AM-EXEC1-NAME             PIC X(15).
  6738             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6739                                                          COMP-3.
  6740             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6741                                                          COMP-3.
  6742         16  AM-EXECUTIVE-TWO.
  6743             20  AM-EXEC2-NAME             PIC X(15).
  6744             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6745                                                          COMP-3.
  6746             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6747                                                          COMP-3.
  6748
  6749     12  AM-RETRO-ADDITIONAL-DATA.
  6750         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6751         16  AM-RETRO-PREM-P-E             PIC X.
  6752         16  AM-RETRO-CLMS-P-I             PIC X.
  6753         16  AM-RETRO-RET-BRACKET-LF.
  6754             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6755                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6756                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6757             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6758                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6759                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6760             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6761                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6762                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6763         16  AM-RETRO-RET-BRACKET-AH.
  6764             20  AM-RETRO-RET-METHOD-AH    PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 121
* EL131.cbl
  6765                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6766                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6767                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6768             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6769                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6770                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6771             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6772                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6773                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6774
  6775     12  AM-COMMENTS.
  6776         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6777
  6778     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6779         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6780         16  AM-FLI-BILLING-CODE           PIC X.
  6781         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6782         16  AM-FLI-UNITED-IDENT           PIC X.
  6783         16  AM-FLI-INTEREST-LOST-DATA.
  6784             20  AM-FLI-BANK-NO            PIC X(5).
  6785             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6786             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6787             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6788         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6789             20  AM-FLI-AGT                PIC X(9).
  6790             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6791             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6792         16  FILLER                        PIC X(102).
  6793
  6794     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6795         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6796             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6797             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6798             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6799             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6800             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6801         16  FILLER                          PIC X(10).
  6802******************************************************************
  6803
  6804*                                COPY ELCCHKQ.
  6805******************************************************************
  6806*                                                                *
  6807*                                                                *
  6808*                            ELCCHKQ.                            *
  6809*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6810*                            VMOD=2.007                          *
  6811*                                                                *
  6812*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6813*                                                                *
  6814*   FILE TYPE = VSAM,KSDS                                        *
  6815*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6816*                                                                *
  6817*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6818*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6819*                                                                *
  6820*   LOG = YES                                                    *
  6821*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6822******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 122
* EL131.cbl
  6823 01  CHECK-QUE.
  6824     12  CQ-RECORD-ID                PIC XX.
  6825         88  VALID-CQ-ID         VALUE 'CQ'.
  6826
  6827     12  CQ-CONTROL-PRIMARY.
  6828         16  CQ-COMPANY-CD           PIC X.
  6829         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6830         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6831
  6832     12  CQ-CONTROL-BY-PAYEE.
  6833         16  CQ-CONTROL-BY-NUMBER.
  6834             20  CQ-COMPANY-CD-A1     PIC X.
  6835             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6836         16  CQ-PAYEE-CARRIER        PIC X.
  6837         16  CQ-PAYEE-GROUPING       PIC X(6).
  6838         16  CQ-PAYEE-STATE          PIC XX.
  6839         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6840         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  6841
  6842     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6843         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6844         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6845         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6846         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6847         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6848         16  FILLER                  PIC X(3).
  6849
  6850     12  CQ-ENTRY-TYPE               PIC X.
  6851             88  CHECK-ON-QUE           VALUE 'Q'.
  6852             88  ALIGNMENT-CHECK        VALUE 'A'.
  6853             88  SPOILED-CHECK          VALUE 'S'.
  6854             88  PAYMENT-ABORTED        VALUE 'X'.
  6855
  6856     12  CQ-CLAIM-MAST-CNTL.
  6857         16  CQ-CARRIER              PIC X.
  6858         16  CQ-CLAIM-NO             PIC X(7).
  6859         16  CQ-CERT-NO.
  6860             20  CQ-CERT-PRIME       PIC X(10).
  6861             20  CQ-CERT-SFX         PIC X.
  6862         16  CQ-CLAIM-TYPE           PIC X.
  6863             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6864             88  CQ-AH-CLAIM            VALUE 'A'.
  6865         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6866             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6867             88  CQ-O-B-COVERAGE        VALUE '2'.
  6868             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6869
  6870     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6871     12  CQ-CHECK-NUMBER             PIC X(7).
  6872     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6873     12  CQ-PAYMENT-TYPE             PIC X.
  6874             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6875             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6876             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6877             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6878             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6879             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6880             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 123
* EL131.cbl
  6881             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6882     12  CQ-VOID-INDICATOR           PIC X.
  6883             88  CHECK-IS-STOPPED          VALUE 'S'.
  6884             88  CHECK-IS-VOID             VALUE 'V'.
  6885     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6886     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6887     12  CQ-CHECK-BY-USER            PIC X(4).
  6888     12  CQ-PRE-NUMBERING-SW         PIC X.
  6889       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6890       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6891
  6892     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6893     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6894     12  CQ-LEDGER-FLAG              PIC X(01).
  6895     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6896     12  CQ-LAST-UPDATED-DT          PIC XX.
  6897     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6898     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  6899
  6900     12  FILLER                      PIC X(04).
  6901
  6902******************************************************************
  6903
  6904*                                COPY ELCARCH.
  6905******************************************************************
  6906*                                                                *
  6907*                            ELCARCH.                            *
  6908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6909*                            VMOD=2.007                          *
  6910*                                                                *
  6911*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6912*                                                                *
  6913*   FILE TYPE = VSAM,KSDS                                        *
  6914*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6915*                                                                *
  6916*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6917*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6918*                                                                *
  6919*   LOG = NO                                                     *
  6920*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6921*                                                                *
  6922*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6923******************************************************************
  6924 01  LETTER-ARCHIVE.
  6925     12  LA-RECORD-ID                PIC XX.
  6926         88  VALID-LA-ID                VALUE 'LA'.
  6927
  6928     12  LA-CONTROL-PRIMARY.
  6929         16  LA-COMPANY-CD           PIC X.
  6930         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6931         16  LA-RECORD-TYPE          PIC X.
  6932             88  LA-HEADER-DATA         VALUE '1'.
  6933             88  LA-ADDRESS-DATA        VALUE '2'.
  6934             88  LA-TEXT-DATA           VALUE '3'.
  6935             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6936         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6937
  6938     12  LA-CONTROL-BY-TYPE.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 124
* EL131.cbl
  6939         16  LA-COMPANY-CD-A1        PIC X.
  6940         16  LA-RECORD-TYPE-A1       PIC X.
  6941         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6942         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6943
  6944     12  LA-TEXT-RECORD.
  6945         16  LA-SKIP-CONTROL         PIC XX.
  6946             88  NO-LINES-SKIPPED       VALUE SPACES.
  6947             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6948         16  LA-TEXT-LINE            PIC X(70).
  6949
  6950     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6951         16  FILLER                  PIC XX.
  6952         16  LA-ADDRESS-LINE         PIC X(30).
  6953         16  FILLER                  PIC X(40).
  6954
  6955     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6956         16  FILLER                  PIC XX.
  6957         16  LA-CARRIER              PIC X.
  6958         16  LA-CLAIM-NO             PIC X(7).
  6959         16  LA-CERT-NO.
  6960             20  LA-CERT-PRIME       PIC X(10).
  6961             20  LA-CERT-SFX         PIC X.
  6962         16  LA-NO-OF-COPIES         PIC S9.
  6963         16  LA-RESEND-DATE          PIC XX.
  6964         16  LA-PROCESSOR-CD         PIC X(4).
  6965         16  LA-CREATION-DT          PIC XX.
  6966         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6967         16  LA-RESEND-PRINT-DATE    PIC XX.
  6968         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6969         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6970*
  6971* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6972*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6973*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6974*   I        20  LA-DMD-RES-ST           PIC XX.
  6975*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6976*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6977*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6978*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6979*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6980*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6981*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6982*   I        20  LA-DMD-UND-CODE         PIC XX.
  6983*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6984*   V    16  FILLER                  PIC X(15).
  6985* -----
  6986*
  6987* REINSERTED  CSO  MODS
  6988*
  6989         16  FILLER.
  6990             20  FILLER                  PIC X(29).
  6991             20  LA-CSO-LETTER-STATUS    PIC X.
  6992                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6993                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6994                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6995             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6996             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 125
* EL131.cbl
  6997*
  6998
  6999     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7000         16  FILLER                  PIC XX.
  7001         16  LA4-CARRIER             PIC X.
  7002         16  LA4-CLAIM-NO            PIC X(7).
  7003         16  LA4-CERT-NO.
  7004             20  LA4-CERT-PRIME      PIC X(10).
  7005             20  LA4-CERT-SFX        PIC X.
  7006         16  LA4-NO-OF-COPIES        PIC S9.
  7007         16  LA4-RESEND-DATE         PIC XX.
  7008         16  LA4-PROCESSOR-CD        PIC X(4).
  7009         16  LA4-CREATION-DT         PIC XX.
  7010         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7011         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7012         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7013         16  LA4-FORM-TYPE           PIC X.
  7014             88  LA4-INITIAL-FORM    VALUE '1'.
  7015             88  LA4-PROGRESS-FORM   VALUE '2'.
  7016         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7017         16  LA4-STATE               PIC X(02).
  7018         16  FILLER                  PIC X(31).
  7019******************************************************************
  7020
  7021*                                COPY ELCBENE.
  7022******************************************************************
  7023*                                                                *
  7024*                            ELCBENE.                            *
  7025*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7026*                            VMOD=2.006                          *
  7027*                                                                *
  7028*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7029*                                                                *
  7030*   FILE TYPE = VSAM,KSDS                                        *
  7031*   RECORD SIZE = 500   RECFORM = FIX                            *
  7032*                                                                *
  7033*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7034*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7035*                                                                *
  7036*   LOG = YES                                                    *
  7037*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7038*                                                                *
  7039*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7040******************************************************************
  7041*                   C H A N G E   L O G
  7042*
  7043* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7044*-----------------------------------------------------------------
  7045*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7046* EFFECTIVE    NUMBER
  7047*-----------------------------------------------------------------
  7048* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7049* 082317  CR2017082100003  PEMA  Add sub type
  7050******************************************************************
  7051
  7052 01  BENEFICIARY-MASTER.
  7053     12  BE-RECORD-ID                PIC XX.
  7054         88  VALID-BE-ID                VALUE 'BE'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 126
* EL131.cbl
  7055
  7056     12  BE-CONTROL-PRIMARY.
  7057         16  BE-COMPANY-CD           PIC X.
  7058         16  BE-RECORD-TYPE          PIC X.
  7059             88  BENEFICIARY-RECORD  VALUE 'B'.
  7060             88  ADJUSTOR-RECORD     VALUE 'A'.
  7061         16  BE-BENEFICIARY          PIC X(10).
  7062     12  BE-CONTROL-BY-NAME.
  7063         16  BE-COMPANY-CD-A1        PIC X.
  7064         16  BE-RECORD-TYPE-A1       PIC X.
  7065         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7066         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7067
  7068     12  BE-LAST-MAINT-DT            PIC XX.
  7069     12  BE-LAST-MAINT-BY            PIC X(4).
  7070     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7071
  7072     12  BE-ADDRESS-DATA.
  7073         16  BE-MAIL-TO-NAME         PIC X(30).
  7074         16  BE-ADDRESS-LINE-1       PIC X(30).
  7075         16  BE-ADDRESS-LINE-2       PIC X(30).
  7076         16  BE-ADDRESS-LINE-3       PIC X(30).
  7077         16  BE-CITY-STATE.
  7078             20  BE-CITY             PIC X(28).
  7079             20  BE-STATE            PIC XX.
  7080         16  BE-ZIP-CODE.
  7081             20  BE-ZIP-PRIME.
  7082                 24  BE-ZIP-1ST      PIC X.
  7083                     88  BE-CANADIAN-POST-CODE
  7084                                         VALUE 'A' THRU 'Z'.
  7085                 24  FILLER          PIC X(4).
  7086             20  BE-ZIP-PLUS4        PIC X(4).
  7087         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7088             20  BE-CAN-POSTAL-1     PIC XXX.
  7089             20  BE-CAN-POSTAL-2     PIC XXX.
  7090             20  FILLER              PIC XXX.
  7091         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7092         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7093
  7094******************************************************************
  7095*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7096*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7097******************************************************************
  7098     12  BE-CARRIER                  PIC X.
  7099
  7100     12  BE-ADDRESS-DATA2.
  7101         16  BE-MAIL-TO-NAME2        PIC X(30).
  7102         16  BE-ADDRESS-LINE-12      PIC X(30).
  7103         16  BE-ADDRESS-LINE-22      PIC X(30).
  7104         16  BE-ADDRESS-LINE-32      PIC X(30).
  7105         16  BE-CITY-STATE2.
  7106             20  BE-CITY2            PIC X(28).
  7107             20  BE-STATE2           PIC XX.
  7108         16  BE-ZIP-CODE2.
  7109             20  BE-ZIP-PRIME2.
  7110                 24  BE-ZIP-1ST2     PIC X.
  7111                     88  BE-CANADIAN-POST-CODE2
  7112                                         VALUE 'A' THRU 'Z'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 127
* EL131.cbl
  7113                 24  FILLER          PIC X(4).
  7114             20  BE-ZIP-PLUS42       PIC X(4).
  7115         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7116             20  BE-CAN-POSTAL-12    PIC XXX.
  7117             20  BE-CAN-POSTAL-22    PIC XXX.
  7118             20  FILLER              PIC XXX.
  7119         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7120         16  BE-ACH-DATA.
  7121             20  BE-ACH-YES-OR-NO    PIC X.
  7122                 88  BE-ON-ACH       VALUE 'Y'.
  7123                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7124             20  BE-ACH-ABA-ROUTING-NUMBER
  7125                                     PIC X(15).
  7126             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7127                                     PIC X(20).
  7128             20  BE-ACH-SUB-TYPE     PIC XX.
  7129             20  FILLER              PIC X(23).
  7130         16  BE-BILLING-STMT-DATA.
  7131*            20  BE-BSR              PIC X.
  7132*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7133*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7134*            20  BE-BSR-FROM         PIC X(30).
  7135*            20  BE-BSR-DEPT         PIC X(30).
  7136             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7137             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7138             20  BE-OUTPUT-TYPE      PIC X.
  7139                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7140                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7141
  7142     12  FILLER                      PIC X(28).
  7143******************************************************************
  7144
  7145*                                COPY ELCDAR.
  7146******************************************************************
  7147*                                                                *
  7148*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7149*   FILE TYPE = VSAM,KSDS                                        *
  7150*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7151*   BASE CLUSTER = DLYACTV                                       *
  7152*   LOG = YES                                                    *
  7153*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7154*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7155*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7156*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7157*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7158*               BY PROGRAM "LGINFCE".                            *
  7159*                                                                *
  7160******************************************************************
  7161 01  DAILY-ACTIVITY-RECORD.
  7162     05  DA-KEY.
  7163         10  DA-COMP-CD          PIC X.
  7164         10  DA-CARRIER          PIC X.
  7165         10  DA-CLAIM-NO         PIC X(7).
  7166         10  DA-CERT-NO.
  7167             15  DA-CERT-PRIME   PIC X(10).
  7168             15  DA-CERT-SFX     PIC X.
  7169     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7170     05  DA-RECORD-TYPE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 128
* EL131.cbl
  7171     05  FILLER                  PIC X(2).
  7172******************************************************************
  7173
  7174*                                COPY ELCALPH.
  7175******************************************************************
  7176*                                                                *
  7177*                            ELCALPH.                            *
  7178*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7179*                            VMOD=2.003                          *
  7180*                                                                *
  7181*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  7182*                                                                *
  7183*   FILE TYPE = VSAM,KSDS                                        *
  7184*   RECORD SIZE = 128  RECFORM = FIXED                           *
  7185*                                                                *
  7186*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  7187*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  7188*                                                                *
  7189*   LOG = YES                                                    *
  7190*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7191*                                                                *
  7192*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  7193******************************************************************
  7194
  7195 01  ALPHA-INDEX.
  7196     12  AI-RECORD-ID                         PIC XX.
  7197         88  VALID-AI-ID                  VALUE 'AI'.
  7198     12  AI-CONTROL-PRIMARY.
  7199         16  AI-COMPANY-CD                     PIC X.
  7200         16  AI-SOURCE                         PIC X.
  7201             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  7202             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  7203         16  AI-NAME.
  7204             20  AI-LAST-NAME                  PIC X(15).
  7205             20  AI-FIRST-NAME.
  7206                 24  AI-FIRST-INITIAL          PIC X.
  7207                 24  FILLER                    PIC X(11).
  7208             20  AI-MIDDLE-INIT                PIC X.
  7209         16  AI-DATE                           PIC X(8).
  7210         16  AI-TIME                           PIC S9(07) COMP-3.
  7211
  7212     12  AI-CONTROL-BY-ADMIN-KEY.
  7213         16  AI-CM-COMPANY-CD                  PIC X.
  7214         16  AI-CM-SOURCE                      PIC X.
  7215         16  AI-CM-CARRIER                     PIC X.
  7216         16  AI-CM-GROUPING.
  7217             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  7218             20  AI-CM-GROUPING-PRIME          PIC X(3).
  7219         16  AI-CM-STATE                       PIC XX.
  7220         16  AI-CM-PRODUCER.
  7221             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  7222             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  7223         16  AI-CM-CERT-EFF-DT                 PIC XX.
  7224         16  AI-CM-CERTIFICATE-NUMBER.
  7225             20  AI-CM-CERT-PRIME              PIC X(10).
  7226             20  AI-CM-CERT-SFX                PIC X.
  7227         16  AI-CM-DATE                        PIC X(8).
  7228         16  AI-CM-TIME                        PIC S9(7) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 129
* EL131.cbl
  7229         16  FILLER                            PIC X(11).
  7230
  7231     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  7232         AI-CONTROL-BY-ADMIN-KEY.
  7233         16  AI-CL-COMPANY-CD                  PIC X.
  7234         16  AI-CL-SOURCE                      PIC X.
  7235         16  AI-CL-CARRIER                     PIC X.
  7236         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  7237         16  AI-CL-CERTIFICATE-NUMBER.
  7238             20  AI-CL-CERT-PRIME              PIC X(10).
  7239             20  AI-CL-CERT-SFX                PIC X.
  7240         16  AI-CL-DATE                        PIC X(8).
  7241         16  AI-CL-INCURRED-DATE               PIC XX.
  7242         16  AI-CL-CLOSE-DATE                  PIC XX.
  7243         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  7244         16  AI-CREDIT-CARD-NUMBER.
  7245             20  AI-CCN.
  7246                 24  AI-CCN-PREFIX             PIC X(4).
  7247                 24  AI-CCN-PRIME              PIC X(12).
  7248             20  AI-CCN-FILLER                 PIC X(4).
  7249
  7250     12  AI-MAINT-INFO.
  7251         16  AI-LAST-MAINT-BY                  PIC X(4).
  7252         16  AI-LAST-MAINT-DT                  PIC XX.
  7253         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7254
  7255     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  7256
  7257     12  FILLER                                PIC X(15).
  7258
  7259
  7260*                                COPY ERCDMDNT.
  7261******************************************************************
  7262*                                                                *
  7263*                            ERCDMDNT                            *
  7264*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7265*                            VMOD=2.005                          *
  7266*                                                                *
  7267*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7268*                                                                *
  7269*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7270*                                                                *
  7271*        FILE TYPE= VSAM,KSDS                                    *
  7272*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7273*                                                                *
  7274*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7275*                                                                *
  7276*        LOG = YES                                               *
  7277*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7278*                                                                *
  7279******************************************************************
  7280
  7281 01  CERTIFICATE-NOTE.
  7282     12  CN-RECORD-ID                     PIC  XX.
  7283         88  VALID-CN-ID                      VALUE 'CN'.
  7284
  7285     12  CN-CONTROL-PRIMARY.
  7286         16  CN-COMPANY-CD                PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 130
* EL131.cbl
  7287         16  CN-CERT-KEY.
  7288             20  CN-CARRIER               PIC X.
  7289             20  CN-GROUPING.
  7290                 24  CN-GROUPING-PREFIX   PIC XXX.
  7291                 24  CN-GROUPING-PRIME    PIC XXX.
  7292             20  CN-STATE                 PIC XX.
  7293             20  CN-ACCOUNT.
  7294                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7295                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7296             20  CN-CERT-EFF-DT           PIC XX.
  7297             20  CN-CERT-NO.
  7298                 24  CN-CERT-PRIME        PIC X(10).
  7299                 24  CN-CERT-SFX          PIC X.
  7300
  7301     12  CN-BILLING-START-LINE-NO         PIC 99.
  7302     12  CN-BILLING-END-LINE-NO           PIC 99.
  7303
  7304     12  CN-LINES.
  7305         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7306
  7307     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7308         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7309         16  CN-CSI-GENERAL-DATA-AREA.
  7310             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7311
  7312         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7313             CN-CSI-GENERAL-DATA-AREA.
  7314             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7315             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7316             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7317             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7318             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7319             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7320             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7321             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7322             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7323             20  FILLER                       PIC XX.
  7324             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7325             20  FILLER                       PIC X(38).
  7326
  7327         16  CN-CSI-PRODUCT-DATA-AREA.
  7328             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7329
  7330         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7331             CN-CSI-PRODUCT-DATA-AREA.
  7332             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7333             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7334             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7335             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7336             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7337             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7338             20  FILLER                   PIC XX.
  7339             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7340             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7341             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7342             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7343             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7344             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 131
* EL131.cbl
  7345             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7346             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7347             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7348             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7349             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7350             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7351             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7352             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7353             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7354             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7355             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7356             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7357             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7358             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7359             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7360             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7361             20  FILLER                   PIC X(25).
  7362
  7363         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7364             CN-CSI-CREDIT-CARD-DATA.
  7365             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7366             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7367             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7368             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7369             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7370             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7371             20  FILLER                   PIC XX.
  7372             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7373             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7374             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7375             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7376             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7377             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7378             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7379             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7380             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7381             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7382             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7383             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7384             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7385             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7386             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7387             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7388             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7389             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7390             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7391             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7392             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7393             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7394             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7395             20  FILLER                   PIC X(17).
  7396
  7397         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7398             CN-CSI-FAMILY-LEAVE-DATA.
  7399             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7400             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7401             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7402             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 132
* EL131.cbl
  7403             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7404             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7405             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7406             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7407             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7408             20  CN-CSI-SL-INT-ON-PROCEEDS
  7409                                          PIC S9(5)V99  COMP-3.
  7410             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7411             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7412             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7413             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7414             20  CN-CSI-SL-POLICY-BENEFITS
  7415                                          PIC S9(5)V99  COMP-3.
  7416             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7417             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7418             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7419             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7420             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7421             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7422             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7423             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7424             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7425             20  CN-CSI-SL-STATE-NOT      PIC X.
  7426             20  FILLER                   PIC XX.
  7427
  7428         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7429             CN-CSI-SENIOR-LIFE-DATA.
  7430             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7431             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7432             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7433                                          PIC S9(5)V99  COMP-3.
  7434             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7435             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7436             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7437             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7438             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7439             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7440             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7441             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7442             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7443             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7444             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7445             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7446             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7447             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7448             20  CN-CSI-PP-REPAIR         PIC X.
  7449             20  CN-CSI-PP-REPLACE        PIC X.
  7450             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7451             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7452             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7453             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7454             20  FILLER                   PIC X(5).
  7455
  7456         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7457             CN-CSI-PURCH-PROP-DATA.
  7458             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7459             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7460             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 133
* EL131.cbl
  7461             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7462             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7463             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7464             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7465             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7466             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7467             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7468             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7469             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7470             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7471             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7472             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7473             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7474             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7475             20  CN-CSI-EW-REPLACE        PIC X.
  7476             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7477             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7478             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7479             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7480             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7481             20  FILLER                   PIC X(4).
  7482
  7483     12  CN-LAST-MAINT-DT                 PIC XX.
  7484     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7485     12  CN-LAST-MAINT-USER               PIC X(4).
  7486     12  FILLER                           PIC X(6).
  7487
  7488******************************************************************
  7489
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 134
* EL131.cbl
  7491 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7492                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7493                          CONTROL-FILE ACTIVITY-QUE
  7494                          ACCOUNT-MASTER CHECK-QUE
  7495                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7496                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7497                          CERTIFICATE-NOTE.
  7498 0000-DFHEXIT SECTION.
  7499     MOVE '9#                    $   ' TO DFHEIV0.
  7500     MOVE 'EL131' TO DFHEIV1.
  7501     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7502
  7503     IF EIBCALEN = ZERO
  7504         GO TO 8800-UNAUTHORIZED-ACCESS.
  7505
  7506     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7507     MOVE '5'                    TO DC-OPTION-CODE.
  7508     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7509     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7510     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7511     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7512
  7513     IF SAVE-DATE-YY GREATER 70
  7514         MOVE 19                 TO SAVE-DATE-CC
  7515      ELSE
  7516         MOVE 20                 TO SAVE-DATE-CC.
  7517
  7518
  7519* EXEC CICS HANDLE CONDITION
  7520*        PGMIDERR (8820-XCTL-ERROR)
  7521*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7522*        ERROR    (9990-ABEND)
  7523*    END-EXEC.
  7524*    MOVE '"$LI.                 ! " #00007514' TO DFHEIV0
  7525     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7526     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7527     MOVE X'2220233030303037353134' TO DFHEIV0(25:11)
  7528     CALL 'kxdfhei1' USING DFHEIV0
  7529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7530
  7531
  7532     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7533     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7534     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7535
  7536     INITIALIZE    EDIT-WORK-AREA.
  7537     MOVE '/'                    TO WORK-SLASH.
  7538     MOVE SPACES                 TO ERROR-SWITCHES.
  7539
  7540     MOVE TRAN-ID                TO TRANS-ID.
  7541     MOVE EIBTRMID               TO PI-TERM.
  7542     MOVE MAP-ID                 TO PI-QUAL.
  7543
  7544     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7545
  7546     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7547         MOVE LOW-VALUES         TO EL131AO
  7548         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 135
* EL131.cbl
  7549         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7550         MOVE -1                 TO MAINTL
  7551         GO TO 8110-SEND-DATA.
  7552
  7553     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7554         MOVE LOW-VALUES         TO EL131AO
  7555         MOVE PI-CALLING-PROGRAM TO WS-RETURNED-FROM
  7556         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7557         MOVE 'X'                TO PI-RETURN-CD-1
  7558         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7559         MOVE -1                 TO MAINTL
  7560         IF WS-RETURNED-FROM = XCTL-EL114
  7561             PERFORM 4200-LOAD-CHANGES THRU 4200-EXIT
  7562         END-IF
  7563         GO TO 8100-SEND-MAP.
  7564
  7565     IF EIBAID = DFHCLEAR
  7566         GO TO 8200-RETURN-PRIOR.
  7567
  7568     IF PI-PROCESSOR-ID = 'LGXX'
  7569         NEXT SENTENCE
  7570     ELSE
  7571
  7572* EXEC CICS READQ TS
  7573*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7574*            INTO    (SECURITY-CONTROL)
  7575*            LENGTH  (SC-COMM-LENGTH)
  7576*            ITEM    (SC-ITEM)
  7577*        END-EXEC
  7578*    MOVE '*$II   L              ''   #00007559' TO DFHEIV0
  7579     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7580     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7581     MOVE X'2020233030303037353539' TO DFHEIV0(25:11)
  7582     CALL 'kxdfhei1' USING DFHEIV0,
  7583           PI-SECURITY-TEMP-STORE-ID,
  7584           SECURITY-CONTROL,
  7585           SC-COMM-LENGTH,
  7586           SC-ITEM,
  7587           DFHEIV99,
  7588           DFHEIV99
  7589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7590         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7591         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7592         IF NOT DISPLAY-CAP
  7593             MOVE 'READ'               TO  SM-READ
  7594             PERFORM 9995-SECURITY-VIOLATION
  7595             MOVE ER-0070              TO  EMI-ERROR
  7596             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7597             GO TO 8100-SEND-MAP.
  7598
  7599
  7600* EXEC CICS RECEIVE
  7601*        MAP    ('EL131A')
  7602*        MAPSET ('EL131S')
  7603*    END-EXEC.
  7604     MOVE 'EL131A' TO DFHEIV1
  7605     MOVE 'EL131S' TO DFHEIV2
  7606*    MOVE '8"T                   ''   #00007574' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 136
* EL131.cbl
  7607     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7608     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7609     MOVE X'2020233030303037353734' TO DFHEIV0(25:11)
  7610     CALL 'kxdfhei1' USING DFHEIV0,
  7611           DFHEIV1,
  7612           EL131AI,
  7613           DFHEIV99,
  7614           DFHEIV2,
  7615           DFHEIV99,
  7616           DFHEIV99
  7617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7618
  7619
  7620     IF PFKEYL GREATER THAN ZERO
  7621         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7622
  7623     IF SCREEN-ERROR
  7624         MOVE ER-0004 TO EMI-ERROR
  7625         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7626         MOVE -1 TO MAINTL
  7627         GO TO 8110-SEND-DATA.
  7628
  7629     IF EIBAID = DFHPF3
  7630         GO TO 8500-TRLR-MNT.
  7631
  7632     IF EIBAID = DFHPF4
  7633         GO TO 8600-ADDR-MNT.
  7634
  7635     IF EIBAID = DFHPF5
  7636         GO TO 8700-CERT-MNT.
  7637
  7638     IF PI-COMPANY-ID = 'DMD'
  7639       IF EIBAID = DFHPF6
  7640         GO TO 8750-DMD-CLM-FIX.
  7641
  7642     IF EIBAID = DFHPF7
  7643         GO TO 4000-FORCE-ERRORS.
  7644
  7645     IF EIBAID = DFHPF12
  7646         GO TO 8300-GET-HELP.
  7647
  7648     IF EIBAID = DFHPF15
  7649         GO TO 8725-BENEFICIARY-MNT
  7650     END-IF.
  7651
  7652     IF EIBAID = DFHPF23
  7653         GO TO 8810-PF23-ENTERED.
  7654
  7655     IF EIBAID = DFHPF24
  7656         GO TO 8400-RETURN-MASTER.
  7657
  7658     IF EIBAID NOT = DFHENTER
  7659         MOVE ER-0029            TO EMI-ERROR
  7660         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7661         MOVE -1                 TO MAINTL
  7662         GO TO 8110-SEND-DATA.
  7663
  7664     IF PI-RETURN-CD-1 =  'X'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 137
* EL131.cbl
  7665         MOVE ER-0311            TO EMI-ERROR
  7666         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7667         MOVE -1                 TO MAINTL
  7668         GO TO 8110-SEND-DATA.
  7669
  7670     IF MAINTI = 'A'
  7671         GO TO 0500-ADD-ALPHA-ONLY.
  7672
  7673     IF MAINTI = 'N'
  7674         GO TO 0600-CHANGE-NAME.
  7675
  7676     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7677     PERFORM 1030-EDIT-NAME THRU 1030-EXIT.
  7678
  7679     IF SCREEN-ERROR
  7680         GO TO 8110-SEND-DATA.
  7681
  7682     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7683         MOVE ER-0276            TO EMI-ERROR
  7684         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7685         MOVE -1                 TO MAINTL
  7686         GO TO 8110-SEND-DATA.
  7687
  7688     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7689
  7690     IF SCREEN-ERROR
  7691         GO TO 8110-SEND-DATA.
  7692
  7693     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7694
  7695     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7696
  7697     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7698         GO TO 8110-SEND-DATA.
  7699
  7700     IF EMI-FATAL-CTR GREATER THAN ZERO
  7701         GO TO 8110-SEND-DATA.
  7702
  7703     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7704
  7705     IF WS-OPEN-CLOSE-SW = 'Y'
  7706         IF PI-LETTER-SW = 'Y'
  7707             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7708             MOVE 'T'            TO  CNTL-REC-TYPE
  7709             MOVE SPACES         TO  CNTL-PROC-ID
  7710             MOVE +0             TO  CNTL-SEQ-NO
  7711
  7712* EXEC CICS READ
  7713*                DATASET   (CNTL-FILE-ID)
  7714*                RIDFLD    (CNTL-KEY)
  7715*                SET       (ADDRESS OF CONTROL-FILE)
  7716*            END-EXEC
  7717*    MOVE '&"S        E          (   #00007670' TO DFHEIV0
  7718     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7719     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7720     MOVE X'2020233030303037363730' TO DFHEIV0(25:11)
  7721     CALL 'kxdfhei1' USING DFHEIV0,
  7722           CNTL-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 138
* EL131.cbl
  7723           DFHEIV20,
  7724           DFHEIV99,
  7725           CNTL-KEY,
  7726           DFHEIV99,
  7727           DFHEIV99,
  7728           DFHEIV99
  7729     SET ADDRESS OF CONTROL-FILE TO
  7730         DFHEIV20
  7731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7732             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7733
  7734     MOVE ER-0000                TO EMI-ERROR.
  7735     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7736
  7737     MOVE SPACE                  TO MAINTO.
  7738     MOVE -1                     TO MAINTL.
  7739     GO TO 8100-SEND-MAP.
  7740
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 139
* EL131.cbl
  7742 0100-UPDATE-PI.
  7743
  7744     MOVE LOW-VALUES             TO WS-SAVE-BENEFICIARY.
  7745     IF WS-RETURNED-FROM = XCTL-EL114
  7746***sometimes there is crap in positions 7-10 when no code was sele
  7747        IF PI-PROGRAM-WORK-AREA (1:5) > SPACES
  7748          MOVE PI-PROGRAM-WORK-AREA (1:10) TO WS-SAVE-BENEFICIARY
  7749        END-IF
  7750     END-IF.
  7751
  7752     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7753         GO TO 0110-UPDATE-UP.
  7754
  7755     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7756     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7757     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7758     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7759     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7760     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7761     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7762     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7763     GO TO 0120-UPDATE-PI-EXIT.
  7764
  7765 0110-UPDATE-UP.
  7766     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7767     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7768     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7769     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7770     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7771     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7772     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7773     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7774
  7775
  7776* EXEC CICS HANDLE CONDITION
  7777*         QIDERR    (0130-TS-ERROR)
  7778*         ITEMERR   (0130-TS-ERROR)
  7779*    END-EXEC.
  7780*    MOVE '"$N<                  ! # #00007718' TO DFHEIV0
  7781     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7783     MOVE X'2320233030303037373138' TO DFHEIV0(25:11)
  7784     CALL 'kxdfhei1' USING DFHEIV0
  7785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7786
  7787
  7788     IF WS-RETURNED-FROM = XCTL-EL114
  7789
  7790* EXEC CICS READQ TS
  7791*            QUEUE    (PI-KEY)
  7792*            INTO     (EL131AI)
  7793*            LENGTH   (MAP-LENGTH)
  7794*       END-EXEC
  7795*    MOVE '*$I    L              ''   #00007724' TO DFHEIV0
  7796     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7797     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7798     MOVE X'2020233030303037373234' TO DFHEIV0(25:11)
  7799     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 140
* EL131.cbl
  7800           PI-KEY,
  7801           EL131AI,
  7802           MAP-LENGTH,
  7803           DFHEIV99,
  7804           DFHEIV99,
  7805           DFHEIV99
  7806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7807
  7808        IF WS-SAVE-BENEFICIARY > SPACES
  7809            MOVE WS-SAVE-BENEFICIARY TO BENEI
  7810            MOVE +10            TO BENEL
  7811            MOVE LOW-VALUES TO WS-SAVE-BENEFICIARY
  7812        END-IF
  7813        PERFORM 4100-SAVE-CHANGES THRU 4100-EXIT
  7814     END-IF.
  7815
  7816
  7817* EXEC CICS READQ TS
  7818*         QUEUE    (PI-KEY)
  7819*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7820*         LENGTH   (PI-COMM-LENGTH)
  7821*    END-EXEC.
  7822*    MOVE '*$I    L              ''   #00007738' TO DFHEIV0
  7823     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7824     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7825     MOVE X'2020233030303037373338' TO DFHEIV0(25:11)
  7826     CALL 'kxdfhei1' USING DFHEIV0,
  7827           PI-KEY,
  7828           PROGRAM-INTERFACE-BLOCK,
  7829           PI-COMM-LENGTH,
  7830           DFHEIV99,
  7831           DFHEIV99,
  7832           DFHEIV99
  7833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7834
  7835
  7836
  7837* EXEC CICS DELETEQ TS
  7838*         QUEUE    (PI-KEY)
  7839*    END-EXEC.
  7840*    MOVE '*&                    #   #00007744' TO DFHEIV0
  7841     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7842     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7843     MOVE X'2020233030303037373434' TO DFHEIV0(25:11)
  7844     CALL 'kxdfhei1' USING DFHEIV0,
  7845           PI-KEY,
  7846           DFHEIV99
  7847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7848
  7849
  7850 0120-UPDATE-PI-EXIT.
  7851     EXIT.
  7852
  7853 0130-TS-ERROR.
  7854     MOVE LOW-VALUES             TO EL131AO.
  7855     MOVE ER-0192                TO EMI-ERROR.
  7856
  7857     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 141
* EL131.cbl
  7858
  7859     GO TO 8100-SEND-MAP.
  7860
  7861 0200-TRANS-PF.
  7862     IF EIBAID NOT = DFHENTER
  7863         MOVE 'X'                TO ERROR-SWITCH
  7864         GO TO 0210-EXIT.
  7865
  7866     IF PFKEYI NOT NUMERIC
  7867         MOVE 'X'                TO ERROR-SWITCH
  7868         GO TO 0210-EXIT.
  7869
  7870     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7871
  7872     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7873         MOVE 'X' TO ERROR-SWITCH
  7874         GO TO 0210-EXIT.
  7875
  7876     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7877
  7878 0210-EXIT.
  7879     EXIT.
  7880
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 142
* EL131.cbl
  7882 0500-ADD-ALPHA-ONLY.
  7883******************************************************************
  7884*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7885*    RECORD.                                                     *
  7886******************************************************************
  7887
  7888     IF MLNAMEL = +0 AND
  7889        MFNAMEL = +0 AND
  7890        MMINITL = +0
  7891         MOVE ER-0797                TO  EMI-ERROR
  7892         MOVE -1                     TO  MAINTL
  7893         MOVE AL-UABON               TO  MAINTA
  7894         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7895         GO TO 8110-SEND-DATA.
  7896
  7897     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7898     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7899     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7900     MOVE PI-CERT-NO                 TO  CERT-NO.
  7901
  7902
  7903* EXEC CICS READ
  7904*        DATASET   (CLMS-FILE-ID)
  7905*        RIDFLD    (MSTR-KEY)
  7906*        SET       (ADDRESS OF CLAIM-MASTER)
  7907*    END-EXEC.
  7908*    MOVE '&"S        E          (   #00007800' TO DFHEIV0
  7909     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7911     MOVE X'2020233030303037383030' TO DFHEIV0(25:11)
  7912     CALL 'kxdfhei1' USING DFHEIV0,
  7913           CLMS-FILE-ID,
  7914           DFHEIV20,
  7915           DFHEIV99,
  7916           MSTR-KEY,
  7917           DFHEIV99,
  7918           DFHEIV99,
  7919           DFHEIV99
  7920     SET ADDRESS OF CLAIM-MASTER TO
  7921         DFHEIV20
  7922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7923
  7924
  7925
  7926* EXEC CICS GETMAIN
  7927*        SET       (ADDRESS OF ALPHA-INDEX)
  7928*        LENGTH    (ALPH-LENGTH)
  7929*        INITIMG   (GETMAIN-SPACE)
  7930*    END-EXEC.
  7931*    MOVE ',"IL                  $   #00007806' TO DFHEIV0
  7932     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7933     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7934     MOVE X'2020233030303037383036' TO DFHEIV0(25:11)
  7935     CALL 'kxdfhei1' USING DFHEIV0,
  7936           DFHEIV20,
  7937           ALPH-LENGTH,
  7938           GETMAIN-SPACE
  7939     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 143
* EL131.cbl
  7940         DFHEIV20
  7941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7942
  7943
  7944     MOVE 'AI'                       TO  AI-RECORD-ID.
  7945     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7946                                         AI-CL-COMPANY-CD.
  7947     MOVE 'C'                        TO  AI-SOURCE
  7948                                         AI-CL-SOURCE.
  7949
  7950     IF MLNAMEL IS GREATER THAN +0
  7951         MOVE MLNAMEI                TO  AI-LAST-NAME
  7952     ELSE
  7953         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7954
  7955     IF MFNAMEL IS GREATER THAN +0
  7956         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7957     ELSE
  7958         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7959
  7960     IF MMINITL IS GREATER THAN +0
  7961         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7962     ELSE
  7963         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7964
  7965     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7966     MOVE '5'                        TO  DC-OPTION-CODE.
  7967     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7968     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7969     IF BUILD-YEAR IS GREATER THAN 50
  7970         MOVE '19'                   TO  WS-ALPHA-YY-1
  7971         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7972         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7973         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7974     ELSE
  7975         MOVE '20'                   TO  WS-ALPHA-YY-1
  7976         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7977         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7978         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7979
  7980     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7981                                         AI-CL-DATE.
  7982
  7983     MOVE EIBTIME                    TO  AI-TIME
  7984                                         AI-CL-TIME.
  7985
  7986     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7987     MOVE 'C'                        TO  AI-CL-SOURCE.
  7988     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7989     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7990     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7991     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7992     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7993
  7994     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7995     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7996     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7997
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 144
* EL131.cbl
  7998
  7999* EXEC CICS WRITE
  8000*        DATASET   (ALPH-FILE-ID)
  8001*        RIDFLD    (AI-CONTROL-PRIMARY)
  8002*        FROM      (ALPHA-INDEX)
  8003*    END-EXEC.
  8004     MOVE LENGTH OF
  8005      ALPHA-INDEX
  8006       TO DFHEIV11
  8007*    MOVE '&$ L                  ''   #00007866' TO DFHEIV0
  8008     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8010     MOVE X'2020233030303037383636' TO DFHEIV0(25:11)
  8011     CALL 'kxdfhei1' USING DFHEIV0,
  8012           ALPH-FILE-ID,
  8013           ALPHA-INDEX,
  8014           DFHEIV11,
  8015           AI-CONTROL-PRIMARY,
  8016           DFHEIV99,
  8017           DFHEIV99
  8018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8019
  8020
  8021     MOVE LOW-VALUES                 TO  EL131AO.
  8022     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8023     MOVE ER-0000                    TO  EMI-ERROR.
  8024     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8025     MOVE -1                         TO  MAINTL.
  8026     GO TO 8100-SEND-MAP.
  8027
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 145
* EL131.cbl
  8029 0600-CHANGE-NAME.
  8030******************************************************************
  8031*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  8032*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  8033******************************************************************
  8034
  8035     IF MLNAMEL = +0 AND
  8036        MFNAMEL = +0 AND
  8037        MMINITL = +0
  8038         MOVE ER-0276                TO  EMI-ERROR
  8039         MOVE -1                     TO  MAINTL
  8040         MOVE AL-UABON               TO  MAINTA
  8041         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8042         GO TO 8110-SEND-DATA.
  8043
  8044     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  8045     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  8046     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  8047     MOVE PI-CERT-NO                 TO  CERT-NO.
  8048
  8049
  8050* EXEC CICS READ
  8051*        DATASET   (CLMS-FILE-ID)
  8052*        RIDFLD    (MSTR-KEY)
  8053*        SET       (ADDRESS OF CLAIM-MASTER)
  8054*    END-EXEC.
  8055*    MOVE '&"S        E          (   #00007900' TO DFHEIV0
  8056     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8057     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8058     MOVE X'2020233030303037393030' TO DFHEIV0(25:11)
  8059     CALL 'kxdfhei1' USING DFHEIV0,
  8060           CLMS-FILE-ID,
  8061           DFHEIV20,
  8062           DFHEIV99,
  8063           MSTR-KEY,
  8064           DFHEIV99,
  8065           DFHEIV99,
  8066           DFHEIV99
  8067     SET ADDRESS OF CLAIM-MASTER TO
  8068         DFHEIV20
  8069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8070
  8071
  8072
  8073* EXEC CICS GETMAIN
  8074*        SET       (ADDRESS OF ALPHA-INDEX)
  8075*        LENGTH    (ALPH-LENGTH)
  8076*        INITIMG   (GETMAIN-SPACE)
  8077*    END-EXEC.
  8078*    MOVE ',"IL                  $   #00007906' TO DFHEIV0
  8079     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8080     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8081     MOVE X'2020233030303037393036' TO DFHEIV0(25:11)
  8082     CALL 'kxdfhei1' USING DFHEIV0,
  8083           DFHEIV20,
  8084           ALPH-LENGTH,
  8085           GETMAIN-SPACE
  8086     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 146
* EL131.cbl
  8087         DFHEIV20
  8088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8089
  8090
  8091     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  8092     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  8093     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  8094     MOVE CL-CERT-STATE          TO CERT-STATE
  8095     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  8096     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  8097     MOVE CL-CERT-NO             TO CERT-CERT
  8098
  8099
  8100* EXEC CICS READ
  8101*       DATASET   (CERT-FILE-ID)
  8102*       RIDFLD    (CERT-KEY)
  8103*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  8104*       RESP      (WS-RESPONSE)
  8105*    END-EXEC
  8106*    MOVE '&"S        E          (  N#00007920' TO DFHEIV0
  8107     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8108     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8109     MOVE X'204E233030303037393230' TO DFHEIV0(25:11)
  8110     CALL 'kxdfhei1' USING DFHEIV0,
  8111           CERT-FILE-ID,
  8112           DFHEIV20,
  8113           DFHEIV99,
  8114           CERT-KEY,
  8115           DFHEIV99,
  8116           DFHEIV99,
  8117           DFHEIV99
  8118     SET ADDRESS OF CERTIFICATE-MASTER TO
  8119         DFHEIV20
  8120     MOVE EIBRESP  TO WS-RESPONSE
  8121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8122
  8123     IF INSTYPEL > ZEROS
  8124        MOVE INSTYPEI TO CL-INSURED-TYPE
  8125     END-IF
  8126
  8127     IF MFNAMEL > +0
  8128        IF CL-INSURED-TYPE = 'C'
  8129          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  8130           MOVE ER-1675             TO EMI-ERROR
  8131           MOVE -1                  TO MFNAMEL
  8132           MOVE AL-UABON            TO MFNAMEA
  8133           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8134           GO TO 8110-SEND-DATA
  8135        ELSE
  8136          IF CL-INSURED-TYPE = 'P'
  8137            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  8138             MOVE ER-1676             TO EMI-ERROR
  8139             MOVE -1                  TO MFNAMEL
  8140             MOVE AL-UABON            TO MFNAMEA
  8141             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8142             GO TO 8110-SEND-DATA
  8143          END-IF
  8144        END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 147
* EL131.cbl
  8145     END-IF
  8146     MOVE 'AI'                       TO  AI-RECORD-ID.
  8147     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  8148                                         AI-CL-COMPANY-CD.
  8149     MOVE 'C'                        TO  AI-SOURCE
  8150                                         AI-CL-SOURCE.
  8151
  8152     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  8153     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  8154     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  8155
  8156     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  8157     MOVE '5'                        TO  DC-OPTION-CODE.
  8158     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8159     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  8160     IF BUILD-YEAR IS GREATER THAN 50
  8161         MOVE '19'                   TO  WS-ALPHA-YY-1
  8162         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8163         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8164         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  8165     ELSE
  8166         MOVE '20'                   TO  WS-ALPHA-YY-1
  8167         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  8168         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  8169         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  8170
  8171     MOVE WS-ALPHA-DATE              TO  AI-DATE
  8172                                         AI-CL-DATE.
  8173
  8174     MOVE EIBTIME                    TO  AI-TIME
  8175                                         AI-CL-TIME.
  8176
  8177     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  8178     MOVE 'C'                        TO  AI-CL-SOURCE.
  8179     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  8180     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  8181     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  8182     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  8183     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  8184
  8185     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  8186     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  8187     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  8188
  8189     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8190         MOVE 'Y'                TO CL-YESNOSW
  8191     END-IF.
  8192
  8193
  8194* EXEC CICS WRITE
  8195*        DATASET   (ALPH-FILE-ID)
  8196*        RIDFLD    (AI-CONTROL-PRIMARY)
  8197*        FROM      (ALPHA-INDEX)
  8198*    END-EXEC.
  8199     MOVE LENGTH OF
  8200      ALPHA-INDEX
  8201       TO DFHEIV11
  8202*    MOVE '&$ L                  ''   #00007997' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 148
* EL131.cbl
  8203     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8204     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8205     MOVE X'2020233030303037393937' TO DFHEIV0(25:11)
  8206     CALL 'kxdfhei1' USING DFHEIV0,
  8207           ALPH-FILE-ID,
  8208           ALPHA-INDEX,
  8209           DFHEIV11,
  8210           AI-CONTROL-PRIMARY,
  8211           DFHEIV99,
  8212           DFHEIV99
  8213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8214
  8215
  8216
  8217* EXEC CICS READ
  8218*        DATASET   (CLMS-FILE-ID)
  8219*        RIDFLD    (MSTR-KEY)
  8220*        SET       (ADDRESS OF CLAIM-MASTER)
  8221*        UPDATE
  8222*    END-EXEC.
  8223*    MOVE '&"S        EU         (   #00008003' TO DFHEIV0
  8224     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8225     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8226     MOVE X'2020233030303038303033' TO DFHEIV0(25:11)
  8227     CALL 'kxdfhei1' USING DFHEIV0,
  8228           CLMS-FILE-ID,
  8229           DFHEIV20,
  8230           DFHEIV99,
  8231           MSTR-KEY,
  8232           DFHEIV99,
  8233           DFHEIV99,
  8234           DFHEIV99
  8235     SET ADDRESS OF CLAIM-MASTER TO
  8236         DFHEIV20
  8237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8238
  8239
  8240     if (cl-priority-cd = '8')
  8241        and (pi-processor-id not = 'PEMA'and 'JMS '
  8242             AND 'AMWA' AND 'KMSB')
  8243        MOVE ER-8003             TO EMI-ERROR
  8244        PERFORM 9900-ERROR-FORMAT
  8245                                 THRU 9900-EXIT
  8246        MOVE -1                  TO MAINTL
  8247        GO TO 8110-SEND-DATA
  8248     end-if
  8249
  8250     IF MLNAMEL IS GREATER THAN +0
  8251         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  8252
  8253     IF MFNAMEL IS GREATER THAN +0
  8254         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  8255
  8256     IF MMINITL IS GREATER THAN +0
  8257         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
  8258
  8259     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  8260     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 149
* EL131.cbl
  8261     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  8262     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  8263
  8264     IF PI-COMPANY-ID = 'CID' or 'AHL'
  8265         MOVE 'Y'                TO CL-YESNOSW
  8266     END-IF.
  8267
  8268
  8269* EXEC CICS HANDLE CONDITION
  8270*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  8271*    END-EXEC.
  8272*    MOVE '"$$                   ! $ #00008038' TO DFHEIV0
  8273     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8274     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8275     MOVE X'2420233030303038303338' TO DFHEIV0(25:11)
  8276     CALL 'kxdfhei1' USING DFHEIV0
  8277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8278
  8279
  8280
  8281* EXEC CICS REWRITE
  8282*        DATASET   (CLMS-FILE-ID)
  8283*        FROM      (CLAIM-MASTER)
  8284*    END-EXEC.
  8285     MOVE LENGTH OF
  8286      CLAIM-MASTER
  8287       TO DFHEIV11
  8288*    MOVE '&& L                  %   #00008042' TO DFHEIV0
  8289     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8290     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8291     MOVE X'2020233030303038303432' TO DFHEIV0(25:11)
  8292     CALL 'kxdfhei1' USING DFHEIV0,
  8293           CLMS-FILE-ID,
  8294           CLAIM-MASTER,
  8295           DFHEIV11,
  8296           DFHEIV99
  8297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8298
  8299
  8300 0600-CONTINUE-NAME-UPDATE.
  8301
  8302     MOVE LOW-VALUES                 TO  EL131AO.
  8303     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  8304     MOVE ER-0000                    TO  EMI-ERROR.
  8305     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8306     MOVE -1                         TO  MAINTL.
  8307     GO TO 8100-SEND-MAP.
  8308
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 150
* EL131.cbl
  8310 1000-EDIT-SCREEN.
  8311
  8312     MOVE MAINTI                 TO CHECK-MAINT.
  8313
  8314     IF NOT VALID-OPTIONS
  8315         MOVE 'X'                TO ERROR-SWITCH
  8316         MOVE -1                 TO MAINTL
  8317         MOVE AL-UABON           TO MAINTA
  8318         MOVE ER-0023            TO EMI-ERROR
  8319         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8320         GO TO 1010-EXIT.
  8321
  8322     IF NOT MODIFY-CAP
  8323         MOVE 'UPDATE'           TO  SM-READ
  8324         PERFORM 9995-SECURITY-VIOLATION
  8325         MOVE ER-0070               TO  EMI-ERROR
  8326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8327         GO TO 8100-SEND-MAP.
  8328
  8329     IF DELETE-CLAIM
  8330         MOVE AL-UANON TO MAINTA
  8331         GO TO 1010-EXIT.
  8332
  8333     MOVE AL-UANON               TO MAINTA.
  8334
  8335     IF CCNOI GREATER THAN LOW-VALUES
  8336         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8337
  8338     IF PI-COMPANY-ID = 'CSL'
  8339        CONTINUE
  8340     ELSE
  8341        IF TYPEL > ZERO
  8342           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  8343              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8344                    PI-LIFE-OVERRIDE-L1))
  8345                       OR
  8346              ((PI-COMPANY-ID = 'DCC' OR 'VPP')
  8347              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  8348                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
  8349              MOVE AL-UANON      TO TYPEA
  8350              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  8351           ELSE
  8352              MOVE ER-0199       TO EMI-ERROR
  8353              PERFORM 9900-ERROR-FORMAT
  8354                                 THRU 9900-EXIT
  8355              MOVE AL-UABON      TO TYPEA
  8356              MOVE -1            TO TYPEL
  8357              MOVE 'X'           TO ERROR-SWITCH
  8358           END-IF
  8359        ELSE
  8360           MOVE AL-UANOF         TO TYPEA
  8361        END-IF
  8362     END-IF
  8363     IF STATUSI GREATER THAN LOW-VALUES
  8364         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  8365             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  8366             MOVE AL-UANON       TO STATUSA
  8367             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 151
* EL131.cbl
  8368             MOVE 'Y'            TO DLYACTV-SW
  8369         ELSE
  8370             MOVE ER-0333        TO EMI-ERROR
  8371             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8372             MOVE AL-UABON       TO STATUSA
  8373             MOVE -1             TO STATUSL
  8374             MOVE 'X'            TO ERROR-SWITCH
  8375         END-IF
  8376     ELSE
  8377         MOVE SPACE              TO TRLR-SWITCH
  8378         MOVE 'N'                TO DLYACTV-SW
  8379         MOVE AL-UANOF           TO STATUSA.
  8380
  8381     IF PROCI GREATER THAN LOW-VALUES
  8382         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8383     ELSE
  8384         MOVE AL-UANOF TO PROCA.
  8385
  8386     IF SEXI GREATER THAN LOW-VALUES
  8387         IF SEXI = 'F' OR 'M'
  8388             MOVE AL-UANON       TO SEXA
  8389             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8390           ELSE
  8391             MOVE ER-0219        TO EMI-ERROR
  8392             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8393             MOVE AL-UABON       TO SEXA
  8394             MOVE -1             TO SEXL
  8395             MOVE 'X'            TO ERROR-SWITCH
  8396       ELSE
  8397         MOVE AL-UANOF           TO SEXA.
  8398
  8399     IF BIRTHL = +0
  8400         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8401         MOVE AL-UANOF           TO  BIRTHA
  8402         GO TO 1000-CONTINUE-EDITS.
  8403
  8404     IF BIRTHI = SPACES
  8405         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8406         MOVE 'X'                TO  UPDATE-SWITCH
  8407                                     MSTR-SWITCH
  8408         GO TO 1000-CONTINUE-EDITS.
  8409
  8410     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8411     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8412     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8413     MOVE '4'                    TO  DC-OPTION-CODE.
  8414     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8415     IF DATE-CONVERSION-ERROR
  8416         MOVE ER-0220            TO  EMI-ERROR
  8417         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8418         MOVE AL-UABON           TO  BIRTHA
  8419         MOVE -1                 TO  BIRTHL
  8420         MOVE 'X'                TO  ERROR-SWITCH
  8421         GO TO 1000-CONTINUE-EDITS.
  8422
  8423******************************************************************
  8424**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8425**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 152
* EL131.cbl
  8426**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8427******************************************************************
  8428     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8429         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8430         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8431         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8432         MOVE '4'                TO  DC-OPTION-CODE
  8433         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8434         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8435                                     DC-ELAPSED-DAYS
  8436         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8437         IF DATE-CONVERSION-ERROR
  8438             MOVE ER-0220        TO  EMI-ERROR
  8439             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8440             MOVE AL-UABON       TO  BIRTHA
  8441             MOVE -1             TO  BIRTHL
  8442             MOVE 'X'            TO  ERROR-SWITCH
  8443             GO TO 1000-CONTINUE-EDITS.
  8444
  8445     MOVE AL-UANON               TO  BIRTHA.
  8446     MOVE 'X'                    TO  UPDATE-SWITCH
  8447                                     MSTR-SWITCH.
  8448     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8449     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8450     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8451
  8452 1000-CONTINUE-EDITS.
  8453
  8454     IF SOCIALI GREATER THAN LOW-VALUES
  8455         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8456         IF WS-SOC-SEC-NO NUMERIC AND
  8457           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8458             NEXT SENTENCE
  8459         ELSE
  8460            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8461               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8462               WS-SSN-DASH2 = '-'
  8463                 NEXT SENTENCE
  8464            ELSE
  8465                 MOVE ER-0887        TO  EMI-ERROR
  8466                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8467                 MOVE AL-UABON       TO  SOCIALA
  8468                 MOVE -1             TO  SOCIALL
  8469                 MOVE 'X'            TO  ERROR-SWITCH
  8470            END-IF
  8471        END-IF
  8472     END-IF.
  8473     if critpl > zeros
  8474        and critpi numeric
  8475        move al-uanon            to critpa
  8476        move 'X'                 to update-switch
  8477     end-if
  8478     IF SOCIALI GREATER THAN LOW-VALUES
  8479         MOVE AL-UANON           TO SOCIALA
  8480         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8481     ELSE
  8482         MOVE AL-UANOF           TO SOCIALA.
  8483
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 153
* EL131.cbl
  8484     IF OCCI GREATER THAN LOW-VALUES
  8485         MOVE AL-UANON           TO OCCA
  8486         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8487     ELSE
  8488         MOVE AL-UANOF           TO OCCA.
  8489
  8490     IF BENEL NOT GREATER THAN ZERO
  8491            GO TO 1005-CONTINUE-EDITS.
  8492
  8493     IF BENEI = SPACES
  8494        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8495           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8496           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8497           IF AUTO-PAY-TO-BENE = 'Y'
  8498               MOVE ER-1773      TO  EMI-ERROR
  8499               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8500               MOVE 'X'          TO ERROR-SWITCH
  8501               MOVE AL-UABON     TO BENEA
  8502               MOVE -1           TO BENEL
  8503           ELSE
  8504               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8505           END-IF
  8506        ELSE
  8507           PERFORM 1050-EDIT-BENE THRU 1050-EXIT
  8508           IF PAYMENT-PENDING
  8509               MOVE ER-1772      TO  EMI-ERROR
  8510               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8511               MOVE 'X'          TO ERROR-SWITCH
  8512               MOVE AL-UABON     TO BENEA
  8513               MOVE -1           TO BENEL
  8514           END-IF
  8515           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8516        END-IF
  8517        GO TO 1005-CONTINUE-EDITS.
  8518
  8519
  8520* EXEC CICS HANDLE CONDITION
  8521*        NOTFND (1004-BENE-NOT-FOUND)
  8522*    END-EXEC.
  8523*    MOVE '"$I                   ! % #00008266' TO DFHEIV0
  8524     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8525     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8526     MOVE X'2520233030303038323636' TO DFHEIV0(25:11)
  8527     CALL 'kxdfhei1' USING DFHEIV0
  8528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8529
  8530
  8531     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8532     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8533     MOVE BENEI                  TO  WS-ELBENE-ID.
  8534
  8535
  8536* EXEC CICS READ
  8537*        DATASET ('ELBENE')
  8538*        RIDFLD  (WS-ELBENE-KEY)
  8539*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8540*    END-EXEC.
  8541     MOVE 'ELBENE' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 154
* EL131.cbl
  8542*    MOVE '&"S        E          (   #00008274' TO DFHEIV0
  8543     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8544     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8545     MOVE X'2020233030303038323734' TO DFHEIV0(25:11)
  8546     CALL 'kxdfhei1' USING DFHEIV0,
  8547           DFHEIV1,
  8548           DFHEIV20,
  8549           DFHEIV99,
  8550           WS-ELBENE-KEY,
  8551           DFHEIV99,
  8552           DFHEIV99,
  8553           DFHEIV99
  8554     SET ADDRESS OF BENEFICIARY-MASTER TO
  8555         DFHEIV20
  8556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8557
  8558
  8559     MOVE AL-UANON               TO  BENEA.
  8560     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8561
  8562     GO TO 1005-CONTINUE-EDITS.
  8563
  8564 1004-BENE-NOT-FOUND.
  8565     MOVE ER-0565                TO  EMI-ERROR.
  8566
  8567     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8568     MOVE 'X'                    TO ERROR-SWITCH.
  8569     MOVE AL-UABON               TO BENEA.
  8570     MOVE -1                     TO BENEL.
  8571
  8572 1005-CONTINUE-EDITS.
  8573
  8574     IF DIAGI GREATER THAN LOW-VALUES
  8575         MOVE AL-UANON           TO DIAGA
  8576         MOVE 'X'                TO UPDATE-SWITCH
  8577                                    NINETY-TRLR-SWITCH
  8578     ELSE
  8579         MOVE AL-UANOF           TO DIAGA.
  8580
  8581     IF ICD1I GREATER THAN LOW-VALUES
  8582         IF (ICD1I GREATER THAN SPACES) AND
  8583            (ICD1I(4:1) NOT = '.')
  8584             IF ICD1I(4:1) = ' '
  8585                 MOVE '.' TO ICD1I(4:1)
  8586             ELSE
  8587                 IF ICD1I(8:1) = ' '
  8588                     MOVE ICD1I(7:1) TO ICD1I(8:1)
  8589                     MOVE ICD1I(6:1) TO ICD1I(7:1)
  8590                     MOVE ICD1I(5:1) TO ICD1I(6:1)
  8591                     MOVE ICD1I(4:1) TO ICD1I(5:1)
  8592                     MOVE '.'        TO ICD1I(4:1)
  8593                 END-IF
  8594             END-IF
  8595         END-IF
  8596         IF (ICD1I GREATER THAN SPACES) AND
  8597            (ICD1I(1:1) NOT > ' ' OR
  8598             ICD1I(2:1) NOT > ' ' OR
  8599             ICD1I(3:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 155
* EL131.cbl
  8600             ICD1I(4:1) NOT = '.')
  8601              MOVE ER-0992        TO  EMI-ERROR
  8602              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8603              MOVE 'X'            TO ERROR-SWITCH
  8604              MOVE AL-UABON       TO ICD1A
  8605              MOVE -1             TO ICD1L
  8606         ELSE
  8607             MOVE AL-UANON       TO ICD1A
  8608             MOVE 'X'            TO UPDATE-SWITCH
  8609                                    NINETY-TRLR-SWITCH
  8610         END-IF
  8611     ELSE
  8612         MOVE AL-UANOF           TO ICD1A
  8613     END-IF.
  8614
  8615     IF ICD2I GREATER THAN LOW-VALUES
  8616         IF (ICD2I GREATER THAN SPACES) AND
  8617            (ICD2I(4:1) NOT = '.')
  8618             IF ICD2I(4:1) = ' '
  8619                 MOVE '.' TO ICD2I(4:1)
  8620             ELSE
  8621                 IF ICD2I(8:1) = ' '
  8622                     MOVE ICD2I(7:1) TO ICD2I(8:1)
  8623                     MOVE ICD2I(6:1) TO ICD2I(7:1)
  8624                     MOVE ICD2I(5:1) TO ICD2I(6:1)
  8625                     MOVE ICD2I(4:1) TO ICD2I(5:1)
  8626                     MOVE '.'        TO ICD2I(4:1)
  8627                 END-IF
  8628             END-IF
  8629         END-IF
  8630         IF (ICD2I GREATER THAN SPACES) AND
  8631            (ICD2I(1:1) NOT > ' ' OR
  8632             ICD2I(2:1) NOT > ' ' OR
  8633             ICD2I(3:1) NOT > ' ' OR
  8634             ICD2I(4:1) NOT = '.')
  8635              MOVE ER-0992        TO EMI-ERROR
  8636              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8637              MOVE 'X'            TO ERROR-SWITCH
  8638              MOVE AL-UABON       TO ICD2A
  8639              MOVE -1             TO ICD2L
  8640         ELSE
  8641             MOVE AL-UANON       TO ICD2A
  8642             MOVE 'X'            TO UPDATE-SWITCH
  8643                                    NINETY-TRLR-SWITCH
  8644         END-IF
  8645     ELSE
  8646         MOVE AL-UANOF           TO ICD2A
  8647     END-IF.
  8648
  8649*    IF CAUSEI GREATER THAN LOW-VALUES
  8650*        MOVE AL-UANON           TO CAUSEA
  8651*        MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8652*    ELSE
  8653*        MOVE AL-UANOF           TO CAUSEA.
  8654
  8655*    IF ENDL GREATER THAN ZERO
  8656*        MOVE LOW-VALUES         TO HOLD-END
  8657*        IF ENDI = SPACES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 156
* EL131.cbl
  8658*            MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8659*        ELSE
  8660*            MOVE ENDI           TO DEEDIT-DATE-INPUT
  8661*            EXEC CICS BIF DEEDIT
  8662*                FIELD    (DEEDIT-DATE-INPUT)
  8663*                LENGTH   (DATE-LENGTH)
  8664*            END-EXEC
  8665*            MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8666*            MOVE '4'            TO DC-OPTION-CODE
  8667*            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8668*            IF NOT DATE-CONVERSION-ERROR
  8669*                MOVE DC-BIN-DATE-1      TO HOLD-END
  8670*                MOVE AL-UANON   TO ENDA
  8671*                MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8672*                MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8673*            ELSE
  8674*                MOVE ER-0224    TO EMI-ERROR
  8675*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8676*                MOVE AL-UABON   TO ENDA
  8677*                MOVE -1         TO ENDL
  8678*                MOVE 'X'        TO ERROR-SWITCH
  8679*      ELSE
  8680*          MOVE AL-UANOF         TO ENDA.
  8681
  8682     IF INCL GREATER THAN ZERO
  8683         MOVE LOW-VALUES         TO HOLD-INCUR
  8684         IF INCI = SPACES
  8685             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8686         ELSE
  8687             MOVE INCI           TO DEEDIT-DATE-INPUT
  8688
  8689* EXEC CICS BIF DEEDIT
  8690*                FIELD    (DEEDIT-DATE-INPUT)
  8691*                LENGTH   (DATE-LENGTH)
  8692*            END-EXEC
  8693*    MOVE '@"L                   #   #00008409' TO DFHEIV0
  8694     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8695     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8696     MOVE X'2020233030303038343039' TO DFHEIV0(25:11)
  8697     CALL 'kxdfhei1' USING DFHEIV0,
  8698           DEEDIT-DATE-INPUT,
  8699           DATE-LENGTH
  8700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8701             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8702             MOVE '4'            TO DC-OPTION-CODE
  8703             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8704             IF NOT DATE-CONVERSION-ERROR
  8705                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8706                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8707                 MOVE AL-UANON           TO INCA
  8708                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8709             ELSE
  8710                 MOVE ER-0222    TO EMI-ERROR
  8711                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8712                 MOVE AL-UABON   TO INCA
  8713                 MOVE -1         TO INCL
  8714                 MOVE 'X'        TO ERROR-SWITCH
  8715       ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 157
* EL131.cbl
  8716           IF PI-NO-PMTS = ZEROS
  8717               MOVE AL-UANOF     TO INCA.
  8718
  8719     IF REPL GREATER THAN ZERO
  8720         MOVE LOW-VALUES         TO HOLD-REPORTED
  8721         IF REPI = SPACES
  8722             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8723         ELSE
  8724             MOVE REPI           TO DEEDIT-DATE-INPUT
  8725
  8726* EXEC CICS BIF DEEDIT
  8727*                FIELD    (DEEDIT-DATE-INPUT)
  8728*                LENGTH   (DATE-LENGTH)
  8729*            END-EXEC
  8730*    MOVE '@"L                   #   #00008437' TO DFHEIV0
  8731     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8732     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8733     MOVE X'2020233030303038343337' TO DFHEIV0(25:11)
  8734     CALL 'kxdfhei1' USING DFHEIV0,
  8735           DEEDIT-DATE-INPUT,
  8736           DATE-LENGTH
  8737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8738             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8739             MOVE '4'            TO DC-OPTION-CODE
  8740             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8741             IF NOT DATE-CONVERSION-ERROR
  8742                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8743                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8744                 MOVE AL-UANON   TO REPA
  8745                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8746             ELSE
  8747                 MOVE ER-0223    TO EMI-ERROR
  8748                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8749                 MOVE AL-UABON   TO REPA
  8750                 MOVE -1         TO REPL
  8751                 MOVE 'X'        TO ERROR-SWITCH
  8752       ELSE
  8753         MOVE AL-UANOF TO REPA.
  8754
  8755     IF PDTHRUI GREATER THAN LOW-VALUES
  8756        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8757        IF PDTHRUI = SPACES
  8758           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8759        ELSE
  8760           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8761
  8762* EXEC CICS BIF DEEDIT
  8763*               FIELD    (DEEDIT-DATE-INPUT)
  8764*               LENGTH   (DATE-LENGTH)
  8765*          END-EXEC
  8766*    MOVE '@"L                   #   #00008464' TO DFHEIV0
  8767     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8768     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8769     MOVE X'2020233030303038343634' TO DFHEIV0(25:11)
  8770     CALL 'kxdfhei1' USING DFHEIV0,
  8771           DEEDIT-DATE-INPUT,
  8772           DATE-LENGTH
  8773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 158
* EL131.cbl
  8774           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8775           MOVE '4'            TO DC-OPTION-CODE
  8776           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8777           IF NOT DATE-CONVERSION-ERROR
  8778              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8779              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8780              MOVE AL-UANON   TO PDTHRUA
  8781              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8782              IF PI-USES-PAID-TO
  8783                 MOVE '6'            TO DC-OPTION-CODE
  8784                 MOVE -1             TO DC-ELAPSED-DAYS
  8785                 MOVE +0             TO DC-ELAPSED-MONTHS
  8786                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8787                 IF NO-CONVERSION-ERROR
  8788                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8789                 ELSE
  8790                    NEXT SENTENCE
  8791              ELSE
  8792                 NEXT SENTENCE
  8793           ELSE
  8794              MOVE ER-0475    TO EMI-ERROR
  8795              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8796              MOVE AL-UABON   TO PDTHRUA
  8797              MOVE -1         TO PDTHRUL
  8798              MOVE 'X'        TO ERROR-SWITCH
  8799     ELSE
  8800        IF MODIFY-CAP
  8801           MOVE AL-UANOF        TO PDTHRUA.
  8802
  8803     IF PDAMTL GREATER THAN +0
  8804         MOVE ZEROS              TO HOLD-PDAMT
  8805
  8806* EXEC CICS BIF DEEDIT
  8807*            FIELD    (PDAMTI)
  8808*            LENGTH   (9)
  8809*        END-EXEC
  8810     MOVE 9
  8811       TO DFHEIV11
  8812*    MOVE '@"L                   #   #00008499' TO DFHEIV0
  8813     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8814     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8815     MOVE X'2020233030303038343939' TO DFHEIV0(25:11)
  8816     CALL 'kxdfhei1' USING DFHEIV0,
  8817           PDAMTI,
  8818           DFHEIV11
  8819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8820         IF PDAMTI NUMERIC
  8821             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8822             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8823             MOVE AL-UNNON       TO PDAMTA
  8824         ELSE
  8825             MOVE ER-0547        TO EMI-ERROR
  8826             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8827             MOVE AL-UNBON       TO PDAMTA
  8828             MOVE -1             TO PDAMTL
  8829             MOVE 'X'            TO ERROR-SWITCH
  8830     ELSE
  8831         IF MODIFY-CAP
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 159
* EL131.cbl
  8832            MOVE AL-UNNOF        TO PDAMTA.
  8833
  8834     IF NODAYSI GREATER THAN LOW-VALUES
  8835         MOVE ZEROS              TO HOLD-NODAYS
  8836
  8837* EXEC CICS BIF DEEDIT
  8838*            FIELD (NODAYSI)
  8839*            LENGTH (5)
  8840*        END-EXEC
  8841     MOVE 5
  8842       TO DFHEIV11
  8843*    MOVE '@"L                   #   #00008519' TO DFHEIV0
  8844     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8845     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8846     MOVE X'2020233030303038353139' TO DFHEIV0(25:11)
  8847     CALL 'kxdfhei1' USING DFHEIV0,
  8848           NODAYSI,
  8849           DFHEIV11
  8850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8851         IF NODAYSI NUMERIC
  8852             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8853             MOVE AL-UNNON       TO NODAYSA
  8854             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8855         ELSE
  8856             MOVE ER-0491        TO EMI-ERROR
  8857             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8858             MOVE AL-UNBON       TO NODAYSA
  8859             MOVE -1             TO NODAYSL
  8860             MOVE 'X'            TO ERROR-SWITCH
  8861     ELSE
  8862         IF MODIFY-CAP
  8863            MOVE AL-UNNOF        TO NODAYSA.
  8864
  8865     IF NOPMTSI GREATER THAN LOW-VALUES
  8866         MOVE ZEROS              TO HOLD-NOPMTS
  8867
  8868* EXEC CICS BIF DEEDIT
  8869*            FIELD (NOPMTSI)
  8870*            LENGTH (4)
  8871*        END-EXEC
  8872     MOVE 4
  8873       TO DFHEIV11
  8874*    MOVE '@"L                   #   #00008539' TO DFHEIV0
  8875     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8876     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8877     MOVE X'2020233030303038353339' TO DFHEIV0(25:11)
  8878     CALL 'kxdfhei1' USING DFHEIV0,
  8879           NOPMTSI,
  8880           DFHEIV11
  8881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8882         IF NOPMTSI NUMERIC
  8883             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8884             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8885             MOVE AL-UNNON       TO NOPMTSA
  8886           ELSE
  8887             MOVE ER-0548        TO EMI-ERROR
  8888             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8889             MOVE AL-UNBON       TO NOPMTSA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 160
* EL131.cbl
  8890             MOVE -1             TO NOPMTSL
  8891             MOVE 'X'            TO ERROR-SWITCH
  8892       ELSE
  8893         IF MODIFY-CAP
  8894            MOVE AL-UNNOF        TO NOPMTSA.
  8895
  8896     IF FORMTYPI GREATER THAN LOW-VALUES
  8897         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8898             MOVE AL-UANON       TO FORMTYPA
  8899             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8900           ELSE
  8901             MOVE ER-7650        TO EMI-ERROR
  8902             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8903             MOVE AL-UABON       TO FORMTYPA
  8904             MOVE -1             TO FORMTYPL
  8905             MOVE 'X'            TO ERROR-SWITCH
  8906       ELSE
  8907         MOVE AL-UANOF           TO FORMTYPA.
  8908
  8909     IF PRICDL GREATER THAN ZERO
  8910         IF (PRICDI = ' ') OR
  8911            (PRICDI GREATER THAN ZERO   AND
  8912             PRICDI NOT GREATER THAN '9')
  8913             MOVE AL-UANON       TO PRICDA
  8914             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8915         ELSE
  8916             MOVE ER-0274        TO EMI-ERROR
  8917             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8918             MOVE AL-UABON       TO PRICDA
  8919             MOVE -1             TO PRICDL
  8920             MOVE 'X'            TO ERROR-SWITCH
  8921     ELSE
  8922         MOVE AL-UANOF TO PRICDA.
  8923
  8924     IF PI-COMPANY-ID = 'DMD'
  8925     IF PRICDL GREATER THAN ZERO
  8926       IF SYSTEM-MODIFY-CAP  OR
  8927          PI-PROCESSOR-ID = 'LGXX'
  8928             NEXT SENTENCE
  8929           ELSE
  8930            IF CL-PRIORITY-CD = '9'  OR
  8931               PRICDI         = '9'
  8932                  MOVE ER-0938        TO EMI-ERROR
  8933                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8934                  MOVE AL-UABON       TO PRICDA
  8935                  MOVE -1             TO PRICDL
  8936                  MOVE 'X'            TO ERROR-SWITCH.
  8937
  8938     IF FILETOL GREATER THAN ZERO
  8939         MOVE AL-UANON           TO FILETOA
  8940         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8941     ELSE
  8942         MOVE AL-UANOF TO FILETOA.
  8943
  8944     IF SUPVL GREATER THAN ZERO
  8945         IF SUPVI = 'Y' OR 'N' OR SPACE
  8946             MOVE AL-UANON       TO SUPVA
  8947             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 161
* EL131.cbl
  8948         ELSE
  8949             MOVE ER-0230        TO EMI-ERROR
  8950             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8951             MOVE AL-UABON       TO SUPVA
  8952             MOVE -1             TO SUPVL
  8953             MOVE 'X'            TO ERROR-SWITCH
  8954     ELSE
  8955         MOVE AL-UANOF           TO SUPVA.
  8956
  8957     IF MLNAMEL GREATER THAN ZERO
  8958         IF MLNAMEI GREATER THAN SPACES
  8959            MOVE AL-UANON        TO MLNAMEA
  8960            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
  8961                                     MSTR-KEY-SWITCH
  8962         ELSE
  8963            MOVE ER-0236         TO EMI-ERROR
  8964            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8965            MOVE AL-UABON        TO MLNAMEA
  8966            MOVE -1              TO MLNAMEL
  8967            MOVE 'X'             TO ERROR-SWITCH
  8968     ELSE
  8969         MOVE AL-UANOF           TO MLNAMEA.
  8970
  8971     IF MFNAMEI GREATER THAN LOW-VALUES
  8972         MOVE AL-UANON           TO MFNAMEA
  8973         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8974     ELSE
  8975         MOVE AL-UANOF           TO MFNAMEA.
  8976
  8977     IF MMINITI GREATER THAN LOW-VALUES
  8978         MOVE AL-UANON           TO MMINITA
  8979         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8980     ELSE
  8981         MOVE AL-UANOF           TO MMINITA.
  8982
  8983     IF CRTLNMEI GREATER THAN LOW-VALUES
  8984         IF CRTLNMEI NOT = SPACES
  8985            MOVE AL-UANON        TO CRTLNMEA
  8986            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8987                                     CERT-KEY-SWITCH
  8988        ELSE
  8989            MOVE ER-0236         TO EMI-ERROR
  8990            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8991            MOVE AL-UABON        TO CRTLNMEA
  8992            MOVE -1              TO CRTLNMEL
  8993            MOVE 'X'             TO ERROR-SWITCH
  8994     ELSE
  8995         MOVE AL-UANOF           TO CRTLNMEA.
  8996
  8997     IF CRTFNMEI GREATER THAN LOW-VALUES
  8998         MOVE AL-UANON           TO CRTFNMEA
  8999         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9000     ELSE
  9001         MOVE AL-UANOF           TO CRTFNMEA.
  9002
  9003     IF CRTINITI GREATER THAN LOW-VALUES
  9004         MOVE AL-UANON           TO CRTINITA
  9005         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 162
* EL131.cbl
  9006     ELSE
  9007         MOVE AL-UANOF           TO CRTINITA.
  9008
  9009     IF ISSAGEL GREATER THAN ZERO
  9010         IF ISSAGEI NUMERIC
  9011            MOVE AL-UANON        TO ISSAGEA
  9012            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9013         ELSE
  9014            MOVE ER-0237         TO EMI-ERROR
  9015            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9016            MOVE AL-UABON        TO ISSAGEA
  9017            MOVE -1              TO ISSAGEL
  9018            MOVE 'X'             TO ERROR-SWITCH
  9019     ELSE
  9020         MOVE AL-UANOF           TO ISSAGEA.
  9021
  9022     IF JNTFNMEI GREATER THAN LOW-VALUES
  9023         MOVE AL-UANON           TO JNTFNMEA
  9024         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9025     ELSE
  9026         MOVE AL-UANOF           TO JNTFNMEA.
  9027
  9028     IF JNTLNMEI GREATER THAN LOW-VALUES
  9029         MOVE AL-UANON           TO JNTLNMEA
  9030         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9031     ELSE
  9032         MOVE AL-UANOF           TO JNTLNMEA.
  9033
  9034     IF JNTINITI GREATER THAN LOW-VALUES
  9035         MOVE AL-UANON           TO JNTINITA
  9036         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  9037     ELSE
  9038         MOVE AL-UANOF           TO JNTINITA.
  9039
  9040     IF JNTAGEL GREATER THAN ZERO
  9041         IF JNTAGEI NUMERIC
  9042            MOVE AL-UANON        TO JNTAGEA
  9043            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9044         ELSE
  9045            MOVE ER-0238         TO EMI-ERROR
  9046            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9047            MOVE AL-UABON        TO JNTAGEA
  9048            MOVE -1              TO JNTAGEL
  9049            MOVE 'X'             TO ERROR-SWITCH
  9050     ELSE
  9051         MOVE AL-UANOF           TO JNTAGEA.
  9052
  9053     IF ADDONDTI GREATER THAN LOW-VALUES
  9054         MOVE LOW-VALUES         TO HOLD-ADDON
  9055         IF ADDONDTI = SPACES
  9056             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  9057         ELSE
  9058             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  9059
  9060* EXEC CICS BIF DEEDIT
  9061*                FIELD    (DEEDIT-DATE-INPUT)
  9062*                LENGTH   (DATE-LENGTH)
  9063*            END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 163
* EL131.cbl
  9064*    MOVE '@"L                   #   #00008720' TO DFHEIV0
  9065     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9066     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9067     MOVE X'2020233030303038373230' TO DFHEIV0(25:11)
  9068     CALL 'kxdfhei1' USING DFHEIV0,
  9069           DEEDIT-DATE-INPUT,
  9070           DATE-LENGTH
  9071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9072             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9073             MOVE '4'            TO DC-OPTION-CODE
  9074             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9075             IF NOT DATE-CONVERSION-ERROR
  9076                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
  9077                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  9078                                                  CERT-SWITCH
  9079                 MOVE AL-UANON   TO ADDONDTA
  9080                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  9081             ELSE
  9082                 MOVE ER-7651    TO EMI-ERROR
  9083                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9084                 MOVE AL-UABON   TO ADDONDTA
  9085                 MOVE -1         TO ADDONDTL
  9086                 MOVE 'X'        TO ERROR-SWITCH
  9087       ELSE
  9088         MOVE AL-UANOF TO ADDONDTA.
  9089
  9090     IF LCVCDI GREATER THAN LOW-VALUES
  9091         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  9092         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  9093     ELSE
  9094         MOVE AL-UANOF           TO LCVCDA.
  9095
  9096     IF ACVCDI GREATER THAN LOW-VALUES
  9097         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  9098         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  9099     ELSE
  9100         MOVE AL-UANOF           TO ACVCDA.
  9101
  9102     IF LCVOTRMI GREATER THAN LOW-VALUES
  9103
  9104* EXEC CICS BIF DEEDIT
  9105*            FIELD (LCVOTRMI)
  9106*            LENGTH(3)
  9107*        END-EXEC
  9108     MOVE 3
  9109       TO DFHEIV11
  9110*    MOVE '@"L                   #   #00008755' TO DFHEIV0
  9111     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9112     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9113     MOVE X'2020233030303038373535' TO DFHEIV0(25:11)
  9114     CALL 'kxdfhei1' USING DFHEIV0,
  9115           LCVOTRMI,
  9116           DFHEIV11
  9117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9118         IF LCVOTRMI IS NUMERIC
  9119             MOVE LCVOTRMI       TO LCVOTRMO
  9120             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9121             MOVE AL-UANON       TO LCVOTRMA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 164
* EL131.cbl
  9122         ELSE
  9123             MOVE ER-0241        TO EMI-ERROR
  9124             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9125             MOVE AL-UNBON       TO LCVOTRMA
  9126             MOVE 'X'            TO ERROR-SWITCH
  9127             MOVE -1             TO LCVOTRML
  9128     ELSE
  9129         MOVE AL-UANOF           TO LCVOTRMA.
  9130
  9131     IF ACVOTRMI GREATER THAN LOW-VALUES
  9132
  9133* EXEC CICS BIF DEEDIT
  9134*            FIELD (ACVOTRMI)
  9135*            LENGTH(3)
  9136*        END-EXEC
  9137     MOVE 3
  9138       TO DFHEIV11
  9139*    MOVE '@"L                   #   #00008773' TO DFHEIV0
  9140     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9141     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9142     MOVE X'2020233030303038373733' TO DFHEIV0(25:11)
  9143     CALL 'kxdfhei1' USING DFHEIV0,
  9144           ACVOTRMI,
  9145           DFHEIV11
  9146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9147         IF ACVOTRMI IS NUMERIC
  9148             MOVE ACVOTRMI       TO ACVOTRMO
  9149             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9150             MOVE AL-UANON       TO ACVOTRMA
  9151         ELSE
  9152             MOVE ER-0241        TO EMI-ERROR
  9153             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9154             MOVE AL-UNBON       TO ACVOTRMA
  9155             MOVE 'X'            TO ERROR-SWITCH
  9156             MOVE -1             TO ACVOTRML
  9157     ELSE
  9158         MOVE AL-UANOF           TO ACVOTRMA.
  9159
  9160     IF LCVRATEL GREATER THAN +0
  9161
  9162* EXEC CICS BIF DEEDIT
  9163*            FIELD (LCVRATEI)
  9164*            LENGTH(6)
  9165*        END-EXEC
  9166     MOVE 6
  9167       TO DFHEIV11
  9168*    MOVE '@"L                   #   #00008791' TO DFHEIV0
  9169     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9170     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9171     MOVE X'2020233030303038373931' TO DFHEIV0(25:11)
  9172     CALL 'kxdfhei1' USING DFHEIV0,
  9173           LCVRATEI,
  9174           DFHEIV11
  9175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9176         IF LCVRATEI IS NUMERIC
  9177             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  9178             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9179             MOVE AL-UNNON       TO LCVRATEA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 165
* EL131.cbl
  9180         ELSE
  9181             MOVE ER-2280        TO EMI-ERROR
  9182             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9183             MOVE AL-UNBON       TO LCVRATEA
  9184             MOVE 'X'            TO ERROR-SWITCH
  9185             MOVE -1             TO LCVRATEL
  9186     ELSE
  9187         MOVE AL-UNNOF           TO LCVRATEA.
  9188
  9189     IF ACVRATEL GREATER THAN +0
  9190
  9191* EXEC CICS BIF DEEDIT
  9192*            FIELD (ACVRATEI)
  9193*            LENGTH(6)
  9194*        END-EXEC
  9195     MOVE 6
  9196       TO DFHEIV11
  9197*    MOVE '@"L                   #   #00008809' TO DFHEIV0
  9198     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9199     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9200     MOVE X'2020233030303038383039' TO DFHEIV0(25:11)
  9201     CALL 'kxdfhei1' USING DFHEIV0,
  9202           ACVRATEI,
  9203           DFHEIV11
  9204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9205         IF ACVRATEI IS NUMERIC
  9206             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  9207             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9208             MOVE AL-UNNON       TO ACVRATEA
  9209         ELSE
  9210             MOVE ER-2280        TO EMI-ERROR
  9211             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9212             MOVE AL-UNBON       TO ACVRATEA
  9213             MOVE 'X'            TO ERROR-SWITCH
  9214             MOVE -1             TO ACVRATEL
  9215     ELSE
  9216         MOVE AL-UNNOF           TO ACVRATEA.
  9217
  9218     IF LCVBENEL GREATER THAN ZERO
  9219
  9220* EXEC CICS BIF DEEDIT
  9221*            FIELD (LCVBENEI)
  9222*            LENGTH (11)
  9223*        END-EXEC
  9224     MOVE 11
  9225       TO DFHEIV11
  9226*    MOVE '@"L                   #   #00008827' TO DFHEIV0
  9227     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9228     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9229     MOVE X'2020233030303038383237' TO DFHEIV0(25:11)
  9230     CALL 'kxdfhei1' USING DFHEIV0,
  9231           LCVBENEI,
  9232           DFHEIV11
  9233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9234         IF LCVBENEI IS NUMERIC
  9235            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  9236            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9237            MOVE AL-UNNON        TO LCVBENEA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 166
* EL131.cbl
  9238         ELSE
  9239            MOVE ER-0243         TO EMI-ERROR
  9240            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9241            MOVE AL-UNBON        TO LCVBENEA
  9242            MOVE -1              TO LCVBENEL
  9243            MOVE 'X'             TO ERROR-SWITCH
  9244     ELSE
  9245         MOVE AL-UANOF           TO LCVBENEA.
  9246
  9247     IF ACVBENEL GREATER THAN ZERO
  9248
  9249* EXEC CICS BIF DEEDIT
  9250*            FIELD (ACVBENEI)
  9251*            LENGTH (11)
  9252*        END-EXEC
  9253     MOVE 11
  9254       TO DFHEIV11
  9255*    MOVE '@"L                   #   #00008845' TO DFHEIV0
  9256     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9257     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9258     MOVE X'2020233030303038383435' TO DFHEIV0(25:11)
  9259     CALL 'kxdfhei1' USING DFHEIV0,
  9260           ACVBENEI,
  9261           DFHEIV11
  9262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9263         IF ACVBENEI IS NUMERIC
  9264            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  9265            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9266            MOVE AL-UNNON        TO ACVBENEA
  9267         ELSE
  9268            MOVE ER-0243         TO EMI-ERROR
  9269            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9270            MOVE AL-UNBON        TO ACVBENEA
  9271            MOVE -1              TO ACVBENEL
  9272            MOVE 'X'             TO ERROR-SWITCH
  9273     ELSE
  9274         MOVE AL-UANOF           TO ACVBENEA.
  9275
  9276     IF LCVFORMI GREATER THAN LOW-VALUES
  9277        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9278        MOVE AL-UANON            TO LCVFORMA
  9279     ELSE
  9280        MOVE AL-UANOF            TO LCVFORMA.
  9281
  9282     IF ACVFORMI GREATER THAN LOW-VALUES
  9283        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9284        MOVE AL-UANON            TO ACVFORMA
  9285     ELSE
  9286        MOVE AL-UANOF            TO ACVFORMA.
  9287
  9288     IF LCVCNDTL GREATER THAN ZERO
  9289         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9290         IF LCVCNDTI = SPACES
  9291             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9292         ELSE
  9293             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  9294             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9295             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 167
* EL131.cbl
  9296             MOVE '4'            TO DC-OPTION-CODE
  9297             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9298             IF NOT DATE-CONVERSION-ERROR
  9299                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  9300                 MOVE AL-UANON   TO LCVCNDTA
  9301                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9302                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  9303             ELSE
  9304                 MOVE ER-0246    TO EMI-ERROR
  9305                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9306                 MOVE AL-UABON   TO LCVCNDTA
  9307                 MOVE -1         TO LCVCNDTL
  9308                 MOVE 'X'        TO ERROR-SWITCH
  9309     ELSE
  9310         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  9311         MOVE AL-UANOF           TO LCVCNDTA.
  9312
  9313     IF ACVCNDTL GREATER THAN ZERO
  9314         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9315         IF ACVCNDTI = SPACES
  9316             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9317         ELSE
  9318             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  9319             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  9320             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  9321             MOVE '4'            TO DC-OPTION-CODE
  9322             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  9323             IF NOT DATE-CONVERSION-ERROR
  9324                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  9325                 MOVE AL-UANON   TO ACVCNDTA
  9326                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  9327                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  9328             ELSE
  9329                 MOVE ER-0246    TO EMI-ERROR
  9330                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9331                 MOVE AL-UABON   TO ACVCNDTA
  9332                 MOVE -1         TO ACVCNDTL
  9333                 MOVE 'X'        TO ERROR-SWITCH
  9334     ELSE
  9335         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  9336         MOVE AL-UANOF           TO ACVCNDTA.
  9337
  9338     IF APRL GREATER THAN +0
  9339
  9340* EXEC CICS BIF DEEDIT
  9341*            FIELD    (APRI)
  9342*            LENGTH   (8)
  9343*        END-EXEC
  9344     MOVE 8
  9345       TO DFHEIV11
  9346*    MOVE '@"L                   #   #00008925' TO DFHEIV0
  9347     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9348     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9349     MOVE X'2020233030303038393235' TO DFHEIV0(25:11)
  9350     CALL 'kxdfhei1' USING DFHEIV0,
  9351           APRI,
  9352           DFHEIV11
  9353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 168
* EL131.cbl
  9354         IF APRI NUMERIC
  9355            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9356            MOVE APRI            TO HOLD-APR APRO
  9357            MOVE AL-UANON        TO APRA
  9358          ELSE
  9359            MOVE ER-0259         TO EMI-ERROR
  9360            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9361            MOVE AL-UABON        TO APRA
  9362            MOVE -1              TO APRL
  9363            MOVE 'X'             TO ERROR-SWITCH
  9364     ELSE
  9365         MOVE AL-UANOF           TO APRA.
  9366
  9367     IF PMTFREQL GREATER THAN ZERO
  9368
  9369* EXEC CICS BIF DEEDIT
  9370*            FIELD    (PMTFREQI)
  9371*            LENGTH   (2)
  9372*        END-EXEC
  9373     MOVE 2
  9374       TO DFHEIV11
  9375*    MOVE '@"L                   #   #00008943' TO DFHEIV0
  9376     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9377     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9378     MOVE X'2020233030303038393433' TO DFHEIV0(25:11)
  9379     CALL 'kxdfhei1' USING DFHEIV0,
  9380           PMTFREQI,
  9381           DFHEIV11
  9382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9383         IF PMTFREQI NUMERIC
  9384            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  9385            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9386            MOVE AL-UANON        TO PMTFREQA
  9387          ELSE
  9388            MOVE ER-0427         TO EMI-ERROR
  9389            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9390            MOVE AL-UABON        TO PMTFREQA
  9391            MOVE -1              TO PMTFREQL
  9392            MOVE 'X'             TO ERROR-SWITCH
  9393     ELSE
  9394         MOVE AL-UANOF           TO PMTFREQA.
  9395
  9396     IF INDGRPL GREATER THAN ZERO
  9397         IF INDGRPI = 'I' OR 'G' OR SPACE
  9398             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  9399             MOVE AL-UANON       TO INDGRPA
  9400          ELSE
  9401             MOVE ER-0260        TO EMI-ERROR
  9402             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9403             MOVE AL-UABON       TO INDGRPA
  9404             MOVE -1             TO INDGRPL
  9405             MOVE 'X'            TO ERROR-SWITCH
  9406     ELSE
  9407         MOVE AL-UANOF           TO INDGRPA.
  9408
  9409     IF PREMTYPL GREATER THAN ZERO
  9410         IF PREMTYPI = '1' OR '2' OR '3'
  9411            MOVE PREMTYPI        TO PI-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 169
* EL131.cbl
  9412            MOVE AL-UNNON        TO PREMTYPA
  9413            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  9414          ELSE
  9415            MOVE ER-0227         TO EMI-ERROR
  9416            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9417            MOVE AL-UNBON        TO PREMTYPA
  9418            MOVE -1              TO PREMTYPL
  9419            MOVE 'X'             TO ERROR-SWITCH
  9420     ELSE
  9421         MOVE AL-UANOF           TO PREMTYPA.
  9422
  9423     IF LOANBALL GREATER THAN ZERO
  9424
  9425* EXEC CICS BIF DEEDIT
  9426*             FIELD    (LOANBALI)
  9427*             LENGTH   (9)
  9428*        END-EXEC
  9429     MOVE 9
  9430       TO DFHEIV11
  9431*    MOVE '@"L                   #   #00008988' TO DFHEIV0
  9432     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9433     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9434     MOVE X'2020233030303038393838' TO DFHEIV0(25:11)
  9435     CALL 'kxdfhei1' USING DFHEIV0,
  9436           LOANBALI,
  9437           DFHEIV11
  9438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9439         IF LOANBALI NUMERIC
  9440             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  9441             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  9442             MOVE AL-UNNON TO LOANBALA
  9443         ELSE
  9444             MOVE ER-0639        TO EMI-ERROR
  9445             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9446             MOVE AL-UNBON       TO LOANBALA
  9447             MOVE -1             TO LOANBALL
  9448             MOVE 'X'            TO ERROR-SWITCH
  9449     ELSE
  9450         MOVE AL-UNNOF           TO LOANBALA.
  9451
  9452*    IF LOANNOL GREATER THAN ZERO
  9453*          MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9454*          MOVE AL-UANON            TO LOANNOA
  9455*       ELSE
  9456*          MOVE AL-UANOF            TO LOANNOA.
  9457
  9458     IF REINCDI GREATER THAN LOW-VALUES
  9459        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9460        MOVE AL-UANON            TO REINCDA
  9461     ELSE
  9462        MOVE AL-UANOF            TO REINCDA.
  9463
  9464     IF CERTI GREATER THAN LOW-VALUES
  9465         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9466     ELSE
  9467         MOVE AL-UANOF           TO CERTA.
  9468
  9469     IF CERTEFFI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 170
* EL131.cbl
  9470         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9471     ELSE
  9472         MOVE AL-UANOF           TO CERTEFFA.
  9473
  9474     IF CERTACTI GREATER THAN LOW-VALUES
  9475         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9476     ELSE
  9477         MOVE AL-UANOF           TO CERTACTA.
  9478
  9479     IF CERTSTI GREATER THAN LOW-VALUES
  9480         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9481     ELSE
  9482         MOVE AL-UANOF           TO CERTSTA.
  9483
  9484     IF CERTCARI GREATER THAN LOW-VALUES
  9485         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9486     ELSE
  9487         MOVE AL-UANOF           TO CERTCARA.
  9488
  9489     IF DLYACTV-RECORD-NEEDED
  9490         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9491                 1150-EXIT
  9492     END-IF.
  9493
  9494     IF CERTEFFI GREATER LOW-VALUES OR
  9495        CERTACTI GREATER LOW-VALUES OR
  9496        CERTSTI  GREATER LOW-VALUES OR
  9497        CERTCARI GREATER LOW-VALUES OR
  9498        CERTGRPI GREATER LOW-VALUES
  9499        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9500
  9501*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9502*      IF PI-PREM-TYPE NOT = '1'  AND
  9503*         PI-NO-PMTS = ZEROS
  9504*          IF LOANBALL GREATER +0 OR
  9505*             ACVBENEL GREATER +0
  9506*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9507     if not acct-found
  9508        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9509     end-if
  9510     MOVE PI-COMPANY-CD          TO COMPANY-CODE
  9511     MOVE PI-CARRIER             TO CARRIER-CODE
  9512     MOVE PI-CLAIM-NO            TO CLAIM-NO
  9513     MOVE PI-CERT-NO             TO CERT-NO
  9514
  9515* EXEC CICS READ
  9516*        DATASET   (CLMS-FILE-ID)
  9517*        RIDFLD    (MSTR-KEY)
  9518*        SET       (ADDRESS OF CLAIM-MASTER)
  9519*        RESP      (WS-RESPONSE)
  9520*    END-EXEC
  9521*    MOVE '&"S        E          (  N#00009067' TO DFHEIV0
  9522     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9523     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9524     MOVE X'204E233030303039303637' TO DFHEIV0(25:11)
  9525     CALL 'kxdfhei1' USING DFHEIV0,
  9526           CLMS-FILE-ID,
  9527           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 171
* EL131.cbl
  9528           DFHEIV99,
  9529           MSTR-KEY,
  9530           DFHEIV99,
  9531           DFHEIV99,
  9532           DFHEIV99
  9533     SET ADDRESS OF CLAIM-MASTER TO
  9534         DFHEIV20
  9535     MOVE EIBRESP  TO WS-RESPONSE
  9536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9537     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE
  9538     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9539     MOVE CL-CERT-GROUPING       TO CERT-GROUP
  9540     MOVE CL-CERT-STATE          TO CERT-STATE
  9541     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9542     MOVE CL-CERT-EFF-DT         TO CERT-DATE
  9543     MOVE CL-CERT-NO             TO CERT-CERT
  9544
  9545* EXEC CICS READ
  9546*       DATASET   (CERT-FILE-ID)
  9547*       RIDFLD    (CERT-KEY)
  9548*       SET       (ADDRESS OF CERTIFICATE-MASTER)
  9549*       RESP      (WS-RESPONSE)
  9550*    END-EXEC
  9551*    MOVE '&"S        E          (  N#00009080' TO DFHEIV0
  9552     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9554     MOVE X'204E233030303039303830' TO DFHEIV0(25:11)
  9555     CALL 'kxdfhei1' USING DFHEIV0,
  9556           CERT-FILE-ID,
  9557           DFHEIV20,
  9558           DFHEIV99,
  9559           CERT-KEY,
  9560           DFHEIV99,
  9561           DFHEIV99,
  9562           DFHEIV99
  9563     SET ADDRESS OF CERTIFICATE-MASTER TO
  9564         DFHEIV20
  9565     MOVE EIBRESP  TO WS-RESPONSE
  9566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9567     if mfnamei > low-values
  9568        move mfnamei to w-name-first
  9569     else
  9570        move cl-insured-1st-name to w-name-first
  9571     end-if
  9572     if mlnamei > low-values
  9573        move mlnamei to w-name-last
  9574     else
  9575        move cl-insured-last-name to w-name-last
  9576     end-if
  9577     if instypel > zeros
  9578        evaluate true
  9579           when cl-no-of-days-paid > zeros
  9580              move er-1668       to emi-error
  9581              perform 9900-error-format
  9582                                 thru 9900-exit
  9583              move al-uabon      to instypea
  9584              move -1            to instypel
  9585              move 'X'           to error-switch
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 172
* EL131.cbl
  9586           when instypei = 'C'
  9587              if w-name-first (1:10) = cm-insured-first-name
  9588                 move er-1666    to emi-error
  9589                 PERFORM 9900-ERROR-FORMAT
  9590                                 THRU 9900-EXIT
  9591                 move al-uabon   to instypea
  9592                 move -1         to instypel
  9593                 move 'X'        to error-switch
  9594              end-if
  9595           when instypei = 'P'
  9596              if (w-name-first (1:10) <> cm-insured-first-name)
  9597                 or (w-name-last <> cm-insured-last-name)
  9598                 move er-1676    to emi-error
  9599                 PERFORM 9900-ERROR-FORMAT
  9600                                 THRU 9900-EXIT
  9601                 move al-uabon   to instypea
  9602                 move -1         to instypel
  9603                 move 'X'        to error-switch
  9604              end-if
  9605        end-evaluate
  9606     end-if
  9607*    if (instypel > zeros)
  9608*       and (cl-no-of-days-paid > zero)
  9609*       move er-1668             to emi-error
  9610*       perform 9900-error-format thru 9900-exit
  9611*       move al-uabon            to instypea
  9612*       move -1                  to instypel
  9613*       move 'X'                 to error-switch
  9614*    end-if
  9615*
  9616*    if instypel > zero
  9617*       if instypei = 'C'
  9618*          if w-name-first (1:10) = cm-insured-first-name
  9619*             move er-1666          to emi-error
  9620*             PERFORM 9900-ERROR-FORMAT
  9621*                                   THRU 9900-EXIT
  9622*             move al-uabon         to instypea
  9623*             move -1               to instypel
  9624*             move 'X'              to error-switch
  9625*          end-if
  9626*       end-if
  9627*    end-if
  9628     if (pi-company-id = 'DCC' OR 'VPP')
  9629        and (acct-found)
  9630        perform 2120-check-pdef  thru 2120-exit
  9631        IF EXTENSL > ZERO
  9632           IF EXTENSI NUMERIC
  9633              IF EXTENSI >  WS-MAX-EXTENSION
  9634                AND ERPDEF-FOUND
  9635                 MOVE ER-1678          TO EMI-ERROR
  9636                 PERFORM 9900-ERROR-FORMAT
  9637                                       THRU 9900-EXIT
  9638                 MOVE AL-UABON         TO EXTENSA
  9639                 MOVE -1               TO EXTENSL
  9640                 MOVE 'X'              TO ERROR-SWITCH
  9641              ELSE
  9642                 MOVE 'X'              TO UPDATE-SWITCH
  9643              END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 173
* EL131.cbl
  9644           ELSE
  9645              MOVE ER-1778          TO EMI-ERROR
  9646              PERFORM 9900-ERROR-FORMAT
  9647                                    THRU 9900-EXIT
  9648              MOVE AL-UABON         TO EXTENSA
  9649              MOVE -1               TO EXTENSL
  9650              MOVE 'X'              TO ERROR-SWITCH
  9651           END-IF
  9652        END-IF
  9653     end-if
  9654     if benperl > zeros
  9655        move al-uanon            to benpera
  9656     end-if
  9657     if benperl > zeros
  9658        if benperi numeric
  9659           perform 1015-edit-benefit-period
  9660                                 thru 1015-exit
  9661        else
  9662           move er-1669          to emi-error
  9663           PERFORM 9900-ERROR-FORMAT
  9664                                 THRU 9900-EXIT
  9665           move al-uabon         to benpera
  9666           move -1               to benperl
  9667           move 'X'              to error-switch
  9668        end-if
  9669    end-if
  9670     if instypel > zeros
  9671        if instypei = 'P' OR 'C'
  9672           move 'X'              to update-switch
  9673                                    mstr-switch
  9674           move al-uanon         to instypea
  9675        else
  9676            move er-1654          to emi-error
  9677           PERFORM 9900-ERROR-FORMAT
  9678                                 THRU 9900-EXIT
  9679           move al-uabon         to instypea
  9680           move -1               to instypel
  9681           move 'X'              to error-switch
  9682        end-if
  9683    end-if
  9684     if accswl > zeros
  9685        if accswi = 'Y' OR 'N'
  9686           MOVE 'X'              TO UPDATE-SWITCH
  9687                                    MSTR-SWITCH
  9688           MOVE AL-UANON         TO accswa
  9689*       else
  9690*          move er-1656          to emi-error
  9691*          PERFORM 9900-ERROR-FORMAT
  9692*                                THRU 9900-EXIT
  9693*          move al-uabon         to accswa
  9694*          move -1               to accswl
  9695*          move 'X'              to error-switch
  9696*          move al-uanof         to accswa
  9697        end-if
  9698     end-if
  9699     IF CERTL = ZEROS AND
  9700        SUFXL = ZEROS
  9701          GO TO 1010-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 174
* EL131.cbl
  9702
  9703     IF CERTL GREATER THAN ZEROS
  9704         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9705             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9706             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9707             MOVE 'X'            TO ERROR-SWITCH
  9708             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9709
  9710     IF SUFXL GREATER THAN ZEROS
  9711         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9712             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9713             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9714             MOVE 'X'            TO ERROR-SWITCH
  9715             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9716
  9717 1010-EXIT.
  9718     EXIT.
  9719
  9720 1015-edit-benefit-period.
  9721     move ' '                    to ws-benper-sw
  9722     evaluate true
  9723        when not erpdef-found
  9724           set good-benper       to true
  9725        when pd-recurring-yn (a1) = 'Y'
  9726           set good-benper       to true
  9727        when pd-recurring-yn (a1) = 'N'
  9728           if benperi < 02
  9729              set good-benper    to true
  9730           end-if
  9731        when pd-rec-crit-period (a1) numeric
  9732           if benperi <= pd-rec-crit-period (a1)
  9733              set good-benper    to true
  9734           end-if
  9735     end-evaluate
  9736     MOVE CERT-KEY               TO ELCRTT-KEY
  9737     MOVE 'B'                    TO CTRLR-REC-TYPE
  9738
  9739* EXEC CICS READ
  9740*       DATASET   ('ELCRTT')
  9741*       RIDFLD    (ELCRTT-KEY)
  9742*       INTO      (CERTIFICATE-TRAILERS)
  9743*       RESP      (WS-RESPONSE)
  9744*    END-EXEC
  9745     MOVE LENGTH OF
  9746      CERTIFICATE-TRAILERS
  9747       TO DFHEIV11
  9748     MOVE 'ELCRTT' TO DFHEIV1
  9749*    MOVE '&"IL       E          (  N#00009257' TO DFHEIV0
  9750     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9751     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9752     MOVE X'204E233030303039323537' TO DFHEIV0(25:11)
  9753     CALL 'kxdfhei1' USING DFHEIV0,
  9754           DFHEIV1,
  9755           CERTIFICATE-TRAILERS,
  9756           DFHEIV11,
  9757           ELCRTT-KEY,
  9758           DFHEIV99,
  9759           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 175
* EL131.cbl
  9760           DFHEIV99
  9761     MOVE EIBRESP  TO WS-RESPONSE
  9762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9763     IF WS-RESP-NORMAL
  9764        perform varying s1 from +1 by +1 until
  9765           (s1 > +24)
  9766           or ((cs-claim-type (s1) = cl-claim-type)
  9767           and (cs-insured-type (s1) = cl-insured-type)
  9768           and (cs-benefit-period (s1) > benperi))
  9769        end-perform
  9770        if s1 < +25
  9771           move er-1665          to emi-error
  9772           PERFORM 9900-ERROR-FORMAT
  9773                                 THRU 9900-EXIT
  9774           move al-uabon         to benpera
  9775           move -1               to benperl
  9776           move 'X'              to error-switch
  9777           go to 1015-exit
  9778*       else
  9779*          set good-benper       to true
  9780        end-if
  9781     end-if
  9782     if good-benper
  9783        move 'X'                 to update-switch
  9784                                    mstr-switch
  9785        move al-uanon            to benpera
  9786     else
  9787        move er-1669             to emi-error
  9788        PERFORM 9900-ERROR-FORMAT
  9789                                 THRU 9900-EXIT
  9790        move al-uabon            to benpera
  9791        move -1                  to benperl
  9792        move 'X'                 to error-switch
  9793     end-if
  9794     .
  9795 1015-exit.
  9796     exit.
  9797 1030-EDIT-NAME.
  9798     IF INSTYPEL > ZEROS
  9799        MOVE INSTYPEI TO CL-INSURED-TYPE
  9800     END-IF
  9801     IF MFNAMEL > +0
  9802        IF CL-INSURED-TYPE = 'C'
  9803          AND (CM-INSURED-FIRST-NAME = MFNAMEI(1:10))
  9804           MOVE ER-1675             TO EMI-ERROR
  9805           MOVE -1                  TO MFNAMEL
  9806           MOVE AL-UABON            TO MFNAMEA
  9807           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9808           MOVE 'X'                 TO ERROR-SWITCH
  9809        ELSE
  9810          IF CL-INSURED-TYPE = 'P'
  9811            AND (CM-INSURED-FIRST-NAME <> MFNAMEI(1:10))
  9812             MOVE ER-1676             TO EMI-ERROR
  9813             MOVE -1                  TO MFNAMEL
  9814             MOVE AL-UABON            TO MFNAMEA
  9815             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9816             MOVE 'X'                 TO ERROR-SWITCH
  9817          END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 176
* EL131.cbl
  9818        END-IF
  9819     END-IF.
  9820
  9821 1030-EXIT.
  9822     EXIT.
  9823 1050-EDIT-BENE.
  9824     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
  9825     MOVE PI-CARRIER         TO TRLR-CARRIER.
  9826     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
  9827     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
  9828     MOVE 1000               TO TRLR-SEQ-NO.
  9829
  9830
  9831* EXEC CICS HANDLE CONDITION
  9832*         NOTFND    (1052-DONE)
  9833*         ENDFILE   (1052-DONE)
  9834*    END-EXEC.
  9835*    MOVE '"$I''                  ! & #00009330' TO DFHEIV0
  9836     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9837     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9838     MOVE X'2620233030303039333330' TO DFHEIV0(25:11)
  9839     CALL 'kxdfhei1' USING DFHEIV0
  9840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9841
  9842
  9843
  9844* EXEC CICS STARTBR
  9845*        DATASET (TRLR-FILE-ID)
  9846*        RIDFLD  (TRLR-KEY)
  9847*    END-EXEC
  9848     MOVE 0
  9849       TO DFHEIV11
  9850*    MOVE '&,         G          &   #00009335' TO DFHEIV0
  9851     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9852     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9853     MOVE X'2020233030303039333335' TO DFHEIV0(25:11)
  9854     CALL 'kxdfhei1' USING DFHEIV0,
  9855           TRLR-FILE-ID,
  9856           TRLR-KEY,
  9857           DFHEIV99,
  9858           DFHEIV11,
  9859           DFHEIV99
  9860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9861
  9862
  9863     MOVE SPACES TO WS-TRLR-FILE-EOF
  9864                    WS-PAYMENT-PENDING
  9865     PERFORM 1052-READ-TRLR THRU 1052-EXIT
  9866       UNTIL  TRLR-FILE-EOF
  9867         OR PAYMENT-PENDING
  9868
  9869
  9870* EXEC CICS ENDBR
  9871*        DATASET (TRLR-FILE-ID)
  9872*    END-EXEC.
  9873     MOVE 0
  9874       TO DFHEIV11
  9875*    MOVE '&2                    $   #00009347' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 177
* EL131.cbl
  9876     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9877     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9878     MOVE X'2020233030303039333437' TO DFHEIV0(25:11)
  9879     CALL 'kxdfhei1' USING DFHEIV0,
  9880           TRLR-FILE-ID,
  9881           DFHEIV11,
  9882           DFHEIV99
  9883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9884
  9885 1050-EXIT.
  9886     EXIT.
  9887
  9888 1052-READ-TRLR.
  9889
  9890* EXEC CICS READNEXT
  9891*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9892*         DATASET  (TRLR-FILE-ID)
  9893*         RIDFLD   (TRLR-KEY)
  9894*    END-EXEC.
  9895     MOVE 0
  9896       TO DFHEIV11
  9897*    MOVE '&.S                   )   #00009354' TO DFHEIV0
  9898     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9899     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9900     MOVE X'2020233030303039333534' TO DFHEIV0(25:11)
  9901     CALL 'kxdfhei1' USING DFHEIV0,
  9902           TRLR-FILE-ID,
  9903           DFHEIV20,
  9904           DFHEIV99,
  9905           TRLR-KEY,
  9906           DFHEIV99,
  9907           DFHEIV11,
  9908           DFHEIV99,
  9909           DFHEIV99
  9910     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9911         DFHEIV20
  9912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9913
  9914
  9915     IF PI-COMPANY-CD   = TRLR-COMPANY-CD
  9916       AND PI-CARRIER  = TRLR-CARRIER
  9917       AND PI-CLAIM-NO = TRLR-CLAIM-NO
  9918       AND PI-CERT-NO  = TRLR-CERT-NO
  9919        CONTINUE
  9920     ELSE
  9921        GO TO 1052-DONE
  9922     END-IF.
  9923
  9924     IF PAYMENT-TR
  9925       AND BENEFICIARY-PAID
  9926       AND AT-VOID-DT = LOW-VALUES
  9927       AND AT-CHECK-WRITTEN-DT NOT > SPACES
  9928         SET PAYMENT-PENDING TO TRUE
  9929     END-IF.
  9930
  9931     IF CORRESPONDENCE-TR
  9932        IF AT-AUTH-RCVD = 'Y'
  9933           SET AUTH-RCVD TO TRUE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 178
* EL131.cbl
  9934        ELSE
  9935        IF AT-AUTH-RCVD = 'N'
  9936           SET NO-AUTH-RCVD TO TRUE
  9937        END-IF
  9938        END-IF
  9939     END-IF.
  9940
  9941     GO TO 1052-EXIT.
  9942
  9943 1052-DONE.
  9944     SET TRLR-FILE-EOF TO TRUE.
  9945 1052-EXIT.
  9946     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 179
* EL131.cbl
  9948 1120-EDIT-PROC.
  9949     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9950     MOVE '2'                    TO CNTL-REC-TYPE.
  9951     MOVE PROCI                  TO CNTL-PROC-ID.
  9952     MOVE ZERO                   TO CNTL-SEQ-NO.
  9953
  9954
  9955* EXEC CICS HANDLE CONDITION
  9956*         NOTFND    (1120-CNTL-NOTFND)
  9957*    END-EXEC.
  9958*    MOVE '"$I                   ! '' #00009399' TO DFHEIV0
  9959     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9960     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9961     MOVE X'2720233030303039333939' TO DFHEIV0(25:11)
  9962     CALL 'kxdfhei1' USING DFHEIV0
  9963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9964
  9965
  9966
  9967* EXEC CICS READ
  9968*         SET      (ADDRESS OF CONTROL-FILE)
  9969*         DATASET  (CNTL-FILE-ID)
  9970*         RIDFLD   (CNTL-KEY)
  9971*    END-EXEC.
  9972*    MOVE '&"S        E          (   #00009403' TO DFHEIV0
  9973     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9974     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9975     MOVE X'2020233030303039343033' TO DFHEIV0(25:11)
  9976     CALL 'kxdfhei1' USING DFHEIV0,
  9977           CNTL-FILE-ID,
  9978           DFHEIV20,
  9979           DFHEIV99,
  9980           CNTL-KEY,
  9981           DFHEIV99,
  9982           DFHEIV99,
  9983           DFHEIV99
  9984     SET ADDRESS OF CONTROL-FILE TO
  9985         DFHEIV20
  9986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9987
  9988
  9989     MOVE AL-UANON               TO PROCA.
  9990     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9991     GO TO 1120-EXIT.
  9992
  9993 1120-CNTL-NOTFND.
  9994     MOVE ER-0273                TO EMI-ERROR.
  9995     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9996     MOVE AL-UABON               TO PROCA.
  9997     MOVE -1                     TO PROCL.
  9998     MOVE 'X'                    TO ERROR-SWITCH.
  9999
 10000 1120-EXIT.
 10001     EXIT.
 10002
 10003*************************************************************
 10004*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
 10005*************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 180
* EL131.cbl
 10006
 10007 1150-OUTPUT-ACTIVITY-RECORD.
 10008
 10009
 10010* EXEC CICS GETMAIN
 10011*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 10012*        LENGTH (25)
 10013*        INITIMG (WS-BLANK)
 10014*    END-EXEC.
 10015     MOVE 25
 10016       TO DFHEIV11
 10017*    MOVE ',"IL                  $   #00009429' TO DFHEIV0
 10018     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10019     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10020     MOVE X'2020233030303039343239' TO DFHEIV0(25:11)
 10021     CALL 'kxdfhei1' USING DFHEIV0,
 10022           DFHEIV20,
 10023           DFHEIV11,
 10024           WS-BLANK
 10025     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 10026         DFHEIV20
 10027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10028
 10029
 10030     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 10031     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 10032     MOVE PI-CARRIER             TO DA-CARRIER.
 10033     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
 10034     MOVE PI-CERT-NO             TO DA-CERT-NO.
 10035     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
 10036     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
 10037
 10038
 10039* EXEC CICS HANDLE CONDITION
 10040*        NOTOPEN (1150-NOTOPEN-ERROR)
 10041*        DUPREC (1150-EXIT)
 10042*    END-EXEC.
 10043*    MOVE '"$J%                  ! ( #00009443' TO DFHEIV0
 10044     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 10045     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10046     MOVE X'2820233030303039343433' TO DFHEIV0(25:11)
 10047     CALL 'kxdfhei1' USING DFHEIV0
 10048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10049
 10050     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
 10051     MOVE 'DLYACTV'              TO JP-FILE-ID.
 10052     MOVE 'A'                    TO JP-RECORD-TYPE.
 10053     MOVE +48                    TO JOURNAL-LENGTH.
 10054
 10055
 10056* EXEC CICS WRITE
 10057*        DATASET ('DLYACTV')
 10058*        RIDFLD (DA-KEY)
 10059*        FROM (DAILY-ACTIVITY-RECORD)
 10060*        LENGTH (25)
 10061*    END-EXEC.
 10062     MOVE 'DLYACTV' TO DFHEIV1
 10063     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 181
* EL131.cbl
 10064       TO DFHEIV11
 10065*    MOVE '&$ L                  ''   #00009452' TO DFHEIV0
 10066     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10067     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10068     MOVE X'2020233030303039343532' TO DFHEIV0(25:11)
 10069     CALL 'kxdfhei1' USING DFHEIV0,
 10070           DFHEIV1,
 10071           DAILY-ACTIVITY-RECORD,
 10072           DFHEIV11,
 10073           DA-KEY,
 10074           DFHEIV99,
 10075           DFHEIV99
 10076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10077
 10078
 10079     GO TO 1150-EXIT.
 10080
 10081 1150-NOTOPEN-ERROR.
 10082
 10083     MOVE '2955'                 TO EMI-ERROR.
 10084     MOVE -1                     TO MAINTL.
 10085     MOVE AL-UANON               TO MAINTA.
 10086     MOVE 'X'                    TO ERROR-SWITCH.
 10087     PERFORM 9900-ERROR-FORMAT THRU
 10088             9900-EXIT.
 10089
 10090 1150-EXIT.
 10091     EXIT.
 10092
 10093*************************************************************
 10094*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
 10095*************************************************************
 10096
 10097 1240-EDIT-LIFE-CODE.
 10098
 10099     IF INVALID-BENEFIT-CODE
 10100         GO TO 1240-SET-ERROR.
 10101
 10102     MOVE SPACES                 TO BENEFIT-KEY.
 10103     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10104     MOVE '4'                    TO BEN-REC-TYPE.
 10105     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10106     MOVE ZERO                   TO BEN-SEQ-NO.
 10107
 10108
 10109* EXEC CICS READ GTEQ
 10110*         DATASET  (CNTL-FILE-ID)
 10111*         RIDFLD   (BENEFIT-KEY)
 10112*         SET      (ADDRESS OF CONTROL-FILE)
 10113*    END-EXEC.
 10114*    MOVE '&"S        G          (   #00009488' TO DFHEIV0
 10115     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10117     MOVE X'2020233030303039343838' TO DFHEIV0(25:11)
 10118     CALL 'kxdfhei1' USING DFHEIV0,
 10119           CNTL-FILE-ID,
 10120           DFHEIV20,
 10121           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 182
* EL131.cbl
 10122           BENEFIT-KEY,
 10123           DFHEIV99,
 10124           DFHEIV99,
 10125           DFHEIV99
 10126     SET ADDRESS OF CONTROL-FILE TO
 10127         DFHEIV20
 10128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10129
 10130
 10131     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10132        CF-RECORD-TYPE NOT = '4'
 10133         GO TO 1240-SET-ERROR.
 10134
 10135     MOVE ZERO                   TO COUNT-2.
 10136     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10137
 10138     IF SCREEN-ERROR
 10139         GO TO 1240-SET-ERROR.
 10140
 10141 1240-SET-CODE-SWITCHES.
 10142     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10143     MOVE AL-UANON               TO LCVCDA.
 10144     GO TO 1240-EXIT.
 10145
 10146 1240-SET-ERROR.
 10147     MOVE ER-0240                TO EMI-ERROR.
 10148     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10149     MOVE 'X'                    TO ERROR-SWITCH.
 10150     MOVE AL-UABON               TO LCVCDA.
 10151     MOVE -1                     TO LCVCDL.
 10152
 10153 1240-EXIT.
 10154     EXIT.
 10155
 10156 1310-EDIT-AH-CODE.
 10157     IF INVALID-BENEFIT-CODE
 10158         GO TO 1310-SET-ERROR.
 10159
 10160     MOVE SPACES                 TO BENEFIT-KEY.
 10161     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 10162     MOVE '5'                    TO BEN-REC-TYPE.
 10163     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
 10164     MOVE ZERO                   TO BEN-SEQ-NO.
 10165
 10166
 10167* EXEC CICS READ GTEQ
 10168*         DATASET  (CNTL-FILE-ID)
 10169*         RIDFLD   (BENEFIT-KEY)
 10170*         SET      (ADDRESS OF CONTROL-FILE)
 10171*    END-EXEC.
 10172*    MOVE '&"S        G          (   #00009529' TO DFHEIV0
 10173     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10175     MOVE X'2020233030303039353239' TO DFHEIV0(25:11)
 10176     CALL 'kxdfhei1' USING DFHEIV0,
 10177           CNTL-FILE-ID,
 10178           DFHEIV20,
 10179           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 183
* EL131.cbl
 10180           BENEFIT-KEY,
 10181           DFHEIV99,
 10182           DFHEIV99,
 10183           DFHEIV99
 10184     SET ADDRESS OF CONTROL-FILE TO
 10185         DFHEIV20
 10186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10187
 10188
 10189     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
 10190        CF-RECORD-TYPE NOT = '5'
 10191         GO TO 1310-SET-ERROR.
 10192
 10193     MOVE ZERO                   TO COUNT-2.
 10194     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 10195     IF SCREEN-ERROR
 10196         GO TO 1310-SET-ERROR.
 10197
 10198 1310-SET-CODE-SWITCHES.
 10199     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
 10200     MOVE AL-UANON               TO ACVCDA.
 10201     GO TO 1310-EXIT.
 10202
 10203 1310-SET-ERROR.
 10204     MOVE ER-0250                TO EMI-ERROR.
 10205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10206     MOVE AL-UABON               TO ACVCDA.
 10207     MOVE 'X'                    TO ERROR-SWITCH.
 10208     MOVE -1                     TO ACVCDL.
 10209
 10210 1310-EXIT.
 10211     EXIT.
 10212
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 184
* EL131.cbl
 10214 1460-EDIT-CERT-NO.
 10215     MOVE CERTI                  TO WS-CERT-NO-PRIME.
 10216     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
 10217
 10218     IF WS-SAVE-CERT-NO = SPACES
 10219         MOVE ER-0203            TO EMI-ERROR
 10220         GO TO 1460-CERT-NO-ERROR.
 10221
 10222     IF WS-CERT-NO-PRIME = SPACES AND
 10223        WS-CERT-NO-SUFX GREATER THAN SPACE
 10224            MOVE ER-0210         TO EMI-ERROR
 10225            GO TO 1460-CERT-NO-ERROR.
 10226
 10227     MOVE 'X'                    TO UPDATE-SWITCH.
 10228     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10229     MOVE AL-UANON               TO CERTA.
 10230
 10231     IF SUFXL IS GREATER THAN 0
 10232         MOVE AL-UANON           TO SUFXA.
 10233
 10234     GO TO 1460-EXIT.
 10235
 10236 1460-CERT-NO-ERROR.
 10237     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10238     MOVE AL-UABON               TO SUFXA.
 10239     MOVE AL-UABON               TO CERTA.
 10240     MOVE -1                     TO CERTL.
 10241     MOVE 'X'                    TO ERROR-SWITCH.
 10242
 10243 1460-EXIT.
 10244     EXIT.
 10245
 10246 1470-EDIT-EFF.
 10247     IF CERTEFFI = SPACES
 10248         GO TO 1470-DATE-ERROR.
 10249
 10250     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
 10251     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
 10252     IF DEEDIT-DATE = ZERO
 10253         GO TO 1470-DATE-ERROR.
 10254
 10255     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
 10256     MOVE '4'                    TO DC-OPTION-CODE.
 10257     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 10258     IF NOT DATE-CONVERSION-ERROR
 10259         MOVE DC-BIN-DATE-1      TO HOLD-EFF
 10260         MOVE AL-UANON           TO CERTEFFA
 10261         MOVE 'X'                TO UPDATE-SWITCH
 10262         MOVE 'Y'                TO CERT-KEY-SWITCH
 10263         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
 10264         GO TO 1470-EXIT.
 10265
 10266 1470-DATE-ERROR.
 10267     MOVE ER-0215                TO EMI-ERROR.
 10268     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10269     MOVE AL-UABON               TO CERTEFFA.
 10270     MOVE -1                     TO CERTEFFL.
 10271     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 185
* EL131.cbl
 10272
 10273 1470-EXIT.
 10274     EXIT.
 10275
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 186
* EL131.cbl
 10277 1480-EDIT-ACCT.
 10278     IF CERTACTI = SPACES
 10279         MOVE ER-0232            TO EMI-ERROR
 10280         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10281         MOVE AL-UABON           TO CERTACTA
 10282         MOVE -1                 TO CERTACTL
 10283         MOVE 'X'                TO ERROR-SWITCH
 10284     ELSE
 10285         MOVE 'X'                TO UPDATE-SWITCH
 10286         MOVE 'Y'                TO CERT-KEY-SWITCH.
 10287
 10288 1480-EXIT.
 10289     EXIT.
 10290
 10291 1490-EDIT-STATE.
 10292     IF CERTSTI = SPACES
 10293         MOVE ER-0233            TO EMI-ERROR
 10294         GO TO 1490-STATE-ERROR.
 10295
 10296     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10297     MOVE '3'                    TO CNTL-REC-TYPE.
 10298     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 10299     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
 10300     MOVE ZERO                   TO CNTL-SEQ-NO.
 10301
 10302
 10303* EXEC CICS HANDLE CONDITION
 10304*         NOTFND (1490-STATE-NOTFND)
 10305*    END-EXEC.
 10306*    MOVE '"$I                   ! ) #00009648' TO DFHEIV0
 10307     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10309     MOVE X'2920233030303039363438' TO DFHEIV0(25:11)
 10310     CALL 'kxdfhei1' USING DFHEIV0
 10311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10312
 10313
 10314
 10315* EXEC CICS READ
 10316*         SET        (ADDRESS OF CONTROL-FILE)
 10317*         DATASET    ('ELCNTL')
 10318*         RIDFLD     (CNTL-KEY)
 10319*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10320*         GENERIC
 10321*    END-EXEC.
 10322     MOVE 'ELCNTL' TO DFHEIV1
 10323*    MOVE '&"S  KG    E          (   #00009652' TO DFHEIV0
 10324     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10325     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10326     MOVE X'2020233030303039363532' TO DFHEIV0(25:11)
 10327     CALL 'kxdfhei1' USING DFHEIV0,
 10328           DFHEIV1,
 10329           DFHEIV20,
 10330           DFHEIV99,
 10331           CNTL-KEY,
 10332           CNTL-GENERIC-LENGTH,
 10333           DFHEIV99,
 10334           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 187
* EL131.cbl
 10335     SET ADDRESS OF CONTROL-FILE TO
 10336         DFHEIV20
 10337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10338
 10339
 10340     MOVE AL-UANON               TO CERTSTA.
 10341     MOVE 'X'                    TO UPDATE-SWITCH.
 10342     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10343     GO TO 1490-EXIT.
 10344
 10345 1490-STATE-NOTFND.
 10346     MOVE ER-0149                TO EMI-ERROR.
 10347
 10348 1490-STATE-ERROR.
 10349     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10350     MOVE AL-UABON               TO CERTSTA.
 10351     MOVE -1                     TO CERTSTL.
 10352     MOVE 'X'                    TO ERROR-SWITCH.
 10353
 10354 1490-EXIT.
 10355     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 188
* EL131.cbl
 10357 1500-EDIT-CARR.
 10358     IF CERTCARI = SPACES
 10359         GO TO 1500-CARR-NOTFND.
 10360
 10361     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 10362     MOVE '6'                    TO CNTL-REC-TYPE.
 10363     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
 10364     MOVE CERTCARI               TO CNTL-CARRIER.
 10365     MOVE ZERO                   TO CNTL-SEQ-NO.
 10366
 10367
 10368* EXEC CICS HANDLE CONDITION
 10369*         NOTFND   (1500-CARR-NOTFND)
 10370*    END-EXEC.
 10371*    MOVE '"$I                   ! * #00009687' TO DFHEIV0
 10372     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10373     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10374     MOVE X'2A20233030303039363837' TO DFHEIV0(25:11)
 10375     CALL 'kxdfhei1' USING DFHEIV0
 10376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10377
 10378
 10379
 10380* EXEC CICS READ
 10381*         SET        (ADDRESS OF CONTROL-FILE)
 10382*         DATASET    ('ELCNTL')
 10383*         RIDFLD     (CNTL-KEY)
 10384*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
 10385*         GENERIC
 10386*    END-EXEC.
 10387     MOVE 'ELCNTL' TO DFHEIV1
 10388*    MOVE '&"S  KG    E          (   #00009691' TO DFHEIV0
 10389     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 10390     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10391     MOVE X'2020233030303039363931' TO DFHEIV0(25:11)
 10392     CALL 'kxdfhei1' USING DFHEIV0,
 10393           DFHEIV1,
 10394           DFHEIV20,
 10395           DFHEIV99,
 10396           CNTL-KEY,
 10397           CNTL-GENERIC-LENGTH,
 10398           DFHEIV99,
 10399           DFHEIV99
 10400     SET ADDRESS OF CONTROL-FILE TO
 10401         DFHEIV20
 10402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10403
 10404
 10405     MOVE AL-UANON               TO CERTCARA.
 10406     MOVE 'X'                    TO UPDATE-SWITCH.
 10407     MOVE 'Y'                    TO CERT-KEY-SWITCH.
 10408     GO TO 1500-EXIT.
 10409
 10410 1500-CARR-NOTFND.
 10411     MOVE ER-0360                TO EMI-ERROR.
 10412     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10413     MOVE AL-UABON               TO CERTCARA.
 10414     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 189
* EL131.cbl
 10415     MOVE 'X'                    TO ERROR-SWITCH.
 10416
 10417 1500-EXIT.
 10418     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 190
* EL131.cbl
 10420 1510-DEEDIT-DATE.
 10421
 10422* EXEC CICS BIF DEEDIT
 10423*         FIELD    (DEEDIT-DATE-INPUT)
 10424*         LENGTH   (DATE-LENGTH)
 10425*    END-EXEC.
 10426*    MOVE '@"L                   #   #00009715' TO DFHEIV0
 10427     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10428     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10429     MOVE X'2020233030303039373135' TO DFHEIV0(25:11)
 10430     CALL 'kxdfhei1' USING DFHEIV0,
 10431           DEEDIT-DATE-INPUT,
 10432           DATE-LENGTH
 10433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10434
 10435
 10436 1510-EXIT.
 10437     EXIT.
 10438
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 191
* EL131.cbl
 10440 1620-VERIFY-ACCT.
 10441
 10442     move ' '                    to ws-eracct-sw
 10443     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
 10444     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10445     MOVE PI-GROUPING            TO ACCT-GROUP.
 10446     MOVE PI-STATE               TO ACCT-STATE.
 10447     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10448
 10449     IF CERTEFFI GREATER THAN LOW-VALUES
 10450         MOVE HOLD-EFF           TO ACCT-DATE
 10451     ELSE
 10452         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
 10453
 10454     IF CERTACTI GREATER THAN LOW-VALUES
 10455         MOVE CERTACTI           TO  ACCT-ACCOUNT.
 10456     IF CERTSTI GREATER THAN LOW-VALUES
 10457         MOVE CERTSTI            TO  ACCT-STATE.
 10458     IF CERTCARI GREATER THAN LOW-VALUES
 10459         MOVE CERTCARI           TO  ACCT-CARRIER.
 10460     IF CERTGRPI GREATER THAN LOW-VALUES
 10461         MOVE CERTGRPI           TO ACCT-GROUP.
 10462
 10463     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
 10464
 10465
 10466* EXEC CICS HANDLE CONDITION
 10467*         NOTFND  (1620-ACCT-NOTFND)
 10468*    END-EXEC.
 10469*    MOVE '"$I                   ! + #00009749' TO DFHEIV0
 10470     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10471     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10472     MOVE X'2B20233030303039373439' TO DFHEIV0(25:11)
 10473     CALL 'kxdfhei1' USING DFHEIV0
 10474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10475
 10476
 10477
 10478* EXEC CICS STARTBR
 10479*         DATASET   (ACCT-FILE-ID)
 10480*         RIDFLD    (ACCT-KEY)
 10481*    END-EXEC.
 10482     MOVE 0
 10483       TO DFHEIV11
 10484*    MOVE '&,         G          &   #00009753' TO DFHEIV0
 10485     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10486     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10487     MOVE X'2020233030303039373533' TO DFHEIV0(25:11)
 10488     CALL 'kxdfhei1' USING DFHEIV0,
 10489           ACCT-FILE-ID,
 10490           ACCT-KEY,
 10491           DFHEIV99,
 10492           DFHEIV11,
 10493           DFHEIV99
 10494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10495
 10496
 10497 1620-ACCT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 192
* EL131.cbl
 10498
 10499
 10500* EXEC CICS READNEXT
 10501*         DATASET  (ACCT-FILE-ID)
 10502*         RIDFLD   (ACCT-KEY)
 10503*         SET      (ADDRESS OF ACCOUNT-MASTER)
 10504*    END-EXEC.
 10505     MOVE 0
 10506       TO DFHEIV11
 10507*    MOVE '&.S                   )   #00009760' TO DFHEIV0
 10508     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10509     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10510     MOVE X'2020233030303039373630' TO DFHEIV0(25:11)
 10511     CALL 'kxdfhei1' USING DFHEIV0,
 10512           ACCT-FILE-ID,
 10513           DFHEIV20,
 10514           DFHEIV99,
 10515           ACCT-KEY,
 10516           DFHEIV99,
 10517           DFHEIV11,
 10518           DFHEIV99,
 10519           DFHEIV99
 10520     SET ADDRESS OF ACCOUNT-MASTER TO
 10521         DFHEIV20
 10522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10523
 10524
 10525     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
 10526         GO TO 1620-ACCT-NOTFND.
 10527
 10528     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
 10529        HOLD-EFF     LESS AM-EXPIRATION-DT
 10530         NEXT SENTENCE
 10531     ELSE
 10532         GO TO 1620-ACCT-LOOP.
 10533
 10534     set acct-found to true
 10535     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 10536         GO TO 1620-ACCT-END-BROWSE.
 10537
 10538     IF LOANBALL GREATER THAN +0
 10539         IF AM-MAX-TOT-BEN NUMERIC  AND
 10540            AM-MAX-TOT-BEN GREATER THAN ZERO
 10541             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
 10542                 MOVE AL-UNBON     TO LOANBALA
 10543                 MOVE -1           TO LOANBALL
 10544                 MOVE 'X'          TO ERROR-SWITCH
 10545                 MOVE ER-7641      TO EMI-ERROR
 10546                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10547
 10548     IF ACVBENEL GREATER THAN +0
 10549         IF AM-MAX-MON-BEN NUMERIC  AND
 10550            AM-MAX-MON-BEN GREATER THAN ZERO
 10551             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
 10552                 MOVE AL-UNBON     TO ACVBENEA
 10553                 MOVE -1           TO ACVBENEL
 10554                 MOVE 'X'          TO ERROR-SWITCH
 10555                 MOVE ER-7642      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 193
* EL131.cbl
 10556                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10557
 10558 1620-ACCT-END-BROWSE.
 10559
 10560
 10561* EXEC CICS ENDBR
 10562*         DATASET (ACCT-FILE-ID)
 10563*    END-EXEC.
 10564     MOVE 0
 10565       TO DFHEIV11
 10566*    MOVE '&2                    $   #00009801' TO DFHEIV0
 10567     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10568     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10569     MOVE X'2020233030303039383031' TO DFHEIV0(25:11)
 10570     CALL 'kxdfhei1' USING DFHEIV0,
 10571           ACCT-FILE-ID,
 10572           DFHEIV11,
 10573           DFHEIV99
 10574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10575
 10576
 10577     GO TO 1620-EXIT.
 10578
 10579 1620-ACCT-NOTFND.
 10580
 10581     MOVE -1                     TO MAINTL.
 10582     MOVE 'X'                    TO ERROR-SWITCH.
 10583     MOVE ER-0426                TO EMI-ERROR.
 10584     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10585
 10586 1620-EXIT.
 10587     EXIT.
 10588
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 194
* EL131.cbl
 10590 2000-UPDATE-CLAIM.
 10591
 10592     MOVE SPACES                 TO ERROR-SWITCH.
 10593     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 10594     MOVE PI-CARRIER             TO CARRIER-CODE.
 10595     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 10596     MOVE PI-CERT-NO             TO CERT-NO.
 10597
 10598     IF DELETE-CLAIM
 10599         GO TO 3000-DELETE-CLAIM.
 10600
 10601     IF  NOT MODIFY-CAP
 10602         MOVE ER-0070            TO EMI-ERROR
 10603         MOVE 'X'                TO ERROR-SWITCH
 10604         MOVE -1                 TO MAINTL
 10605         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10606         GO TO 2000-EXIT.
 10607
 10608     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 10609     MOVE ZERO                   TO TRLR-SEQ-NO.
 10610
 10611
 10612* EXEC CICS READ UPDATE
 10613*         SET       (ADDRESS OF CLAIM-MASTER)
 10614*         DATASET   (CLMS-FILE-ID)
 10615*         RIDFLD    (MSTR-KEY)
 10616*    END-EXEC.
 10617*    MOVE '&"S        EU         (   #00009839' TO DFHEIV0
 10618     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10619     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10620     MOVE X'2020233030303039383339' TO DFHEIV0(25:11)
 10621     CALL 'kxdfhei1' USING DFHEIV0,
 10622           CLMS-FILE-ID,
 10623           DFHEIV20,
 10624           DFHEIV99,
 10625           MSTR-KEY,
 10626           DFHEIV99,
 10627           DFHEIV99,
 10628           DFHEIV99
 10629     SET ADDRESS OF CLAIM-MASTER TO
 10630         DFHEIV20
 10631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10632
 10633
 10634     if (incl > zeros)
 10635        and (cl-no-of-pmts-made > 0)
 10636        and (hold-incur > low-values)
 10637        and (hold-incur not = cl-incurred-dt)
 10638        if hold-incur > cl-incurred-dt
 10639           move cl-incurred-dt   to dc-bin-date-1
 10640           move hold-incur       to dc-bin-date-2
 10641        else
 10642           move hold-incur       to dc-bin-date-1
 10643           move cl-incurred-dt   to dc-bin-date-2
 10644        end-if
 10645        move '1'                 to dc-option-code
 10646        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10647        if dc-elapsed-days > +180
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 195
* EL131.cbl
 10648           MOVE ER-1663             TO EMI-ERROR
 10649           PERFORM 9900-ERROR-FORMAT
 10650                                 THRU 9900-EXIT
 10651           MOVE -1                  TO MAINTL
 10652           GO TO 8110-SEND-DATA
 10653        end-if
 10654     end-if
 10655     IF (CL-PRIORITY-CD = '8')
 10656        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
 10657             AND 'AMWA' AND 'KMSB')
 10658        MOVE ER-8003             TO EMI-ERROR
 10659        PERFORM 9900-ERROR-FORMAT
 10660                                 THRU 9900-EXIT
 10661        MOVE -1                  TO MAINTL
 10662        GO TO 8110-SEND-DATA
 10663     END-IF
 10664
 10665     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
 10666         MOVE ER-0068            TO EMI-ERROR
 10667         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10668         GO TO 2000-EXIT.
 10669
 10670     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
 10671         MOVE ER-0068            TO EMI-ERROR
 10672         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10673         GO TO 2000-EXIT.
 10674
 10675     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
 10676         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
 10677
 10678     IF CL-PURGED-DT NOT = LOW-VALUES
 10679         MOVE ER-7691            TO EMI-ERROR
 10680         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10681         GO TO 2000-EXIT.
 10682
 10683     IF CERT-KEY-CHANGED
 10684         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
 10685
 10686     IF SCREEN-ERROR
 10687         MOVE ER-0068            TO EMI-ERROR
 10688         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
 10689         GO TO 2000-EXIT.
 10690
 10691     IF NINETY-TRLR-UPDATED
 10692         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
 10693
 10694     IF MSTR-KEY-CHANGED
 10695         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
 10696        ELSE
 10697         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
 10698
 10699     IF TRLR-UPDATE-REQUIRED
 10700         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
 10701
 10702 2000-CHECK-CERT.
 10703     IF NOT CERT-UPDATES
 10704         GO TO 2000-EXIT.
 10705
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 196
* EL131.cbl
 10706     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10707     MOVE PI-CARRIER             TO CERT-CARRIER.
 10708     MOVE PI-GROUPING            TO CERT-GROUP.
 10709     MOVE PI-STATE               TO CERT-STATE.
 10710     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10711     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10712     MOVE PI-CERT-NO             TO CERT-CERT.
 10713
 10714     IF CERT-ALT-KEY-CHANGED
 10715         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
 10716     ELSE
 10717         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
 10718
 10719 2000-EXIT.
 10720     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 197
* EL131.cbl
 10722 2010-RELEASE-REC.
 10723
 10724* EXEC CICS UNLOCK
 10725*         DATASET  (CLMS-FILE-ID)
 10726*    END-EXEC
 10727*    MOVE '&*                    #   #00009934' TO DFHEIV0
 10728     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10729     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10730     MOVE X'2020233030303039393334' TO DFHEIV0(25:11)
 10731     CALL 'kxdfhei1' USING DFHEIV0,
 10732           CLMS-FILE-ID,
 10733           DFHEIV99
 10734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10735
 10736     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10737     MOVE 'X'                    TO ERROR-SWITCH.
 10738
 10739 2010-EXIT.
 10740     EXIT.
 10741
 10742 2020-NORMAL-UPDATE.
 10743     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10744
 10745     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10746
 10747     IF WS-OPEN-CLOSE-SW = 'Y'
 10748       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10749       IF PI-REC-FOUND-SW = 'Y'
 10750         IF CL-ACTIVITY-CODE = 09
 10751           NEXT SENTENCE
 10752         ELSE
 10753           IF WS-RESET-SW = 'Y'
 10754             IF CL-CLAIM-STATUS = 'C'
 10755               MOVE 07               TO  CL-ACTIVITY-CODE
 10756               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10757               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
 10758             ELSE
 10759               MOVE 08               TO  CL-ACTIVITY-CODE
 10760               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
 10761               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
 10762
 10763     IF PI-COMPANY-ID = 'CID' or 'AHL'
 10764         MOVE 'Y'                TO CL-YESNOSW
 10765     END-IF.
 10766
 10767     if pi-company-id = 'DCC' OR 'VPP'
 10768        perform 1620-VERIFY-ACCT THRU 1620-EXIT
 10769        perform 2120-check-pdef  thru 2120-exit
 10770     end-if
 10771     if ((benperl <> zeros)
 10772        and (benperi numeric))
 10773                  or
 10774            (instypel <> zeros)
 10775        perform 2140-update-elcrtt thru 2140-exit
 10776     end-if
 10777
 10778* EXEC CICS HANDLE CONDITION
 10779*         DUPKEY   (2020-EXIT)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 198
* EL131.cbl
 10780*    END-EXEC.
 10781*    MOVE '"$$                   ! , #00009979' TO DFHEIV0
 10782     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10783     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10784     MOVE X'2C20233030303039393739' TO DFHEIV0(25:11)
 10785     CALL 'kxdfhei1' USING DFHEIV0
 10786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10787
 10788
 10789
 10790* EXEC CICS REWRITE
 10791*         DATASET   (CLMS-FILE-ID)
 10792*         FROM      (CLAIM-MASTER)
 10793*    END-EXEC.
 10794     MOVE LENGTH OF
 10795      CLAIM-MASTER
 10796       TO DFHEIV11
 10797*    MOVE '&& L                  %   #00009983' TO DFHEIV0
 10798     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10799     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10800     MOVE X'2020233030303039393833' TO DFHEIV0(25:11)
 10801     CALL 'kxdfhei1' USING DFHEIV0,
 10802           CLMS-FILE-ID,
 10803           CLAIM-MASTER,
 10804           DFHEIV11,
 10805           DFHEIV99
 10806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10807
 10808
 10809 2020-EXIT.
 10810     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 199
* EL131.cbl
 10812 2030-KEY-UPDATE.
 10813     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
 10814
 10815
 10816* EXEC CICS DELETE
 10817*        DATASET  (CLMS-FILE-ID)
 10818*    END-EXEC.
 10819*    MOVE '&(                    &   #00009994' TO DFHEIV0
 10820     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10821     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10822     MOVE X'2020233030303039393934' TO DFHEIV0(25:11)
 10823     CALL 'kxdfhei1' USING DFHEIV0,
 10824           CLMS-FILE-ID,
 10825           DFHEIV99,
 10826           DFHEIV99,
 10827           DFHEIV99,
 10828           DFHEIV99
 10829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10830
 10831
 10832
 10833* EXEC CICS GETMAIN
 10834*         SET      (ADDRESS OF CLAIM-MASTER)
 10835*         LENGTH   (MSTR-LENGTH)
 10836*         INITIMG  (GETMAIN-SPACE)
 10837*    END-EXEC.
 10838*    MOVE ',"IL                  $   #00009998' TO DFHEIV0
 10839     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10840     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10841     MOVE X'2020233030303039393938' TO DFHEIV0(25:11)
 10842     CALL 'kxdfhei1' USING DFHEIV0,
 10843           DFHEIV20,
 10844           MSTR-LENGTH,
 10845           GETMAIN-SPACE
 10846     SET ADDRESS OF CLAIM-MASTER TO
 10847         DFHEIV20
 10848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10849
 10850
 10851     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
 10852
 10853     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
 10854
 10855     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
 10856
 10857     IF WS-OPEN-CLOSE-SW = 'Y'
 10858       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
 10859         IF PI-REC-FOUND-SW = 'Y'
 10860           IF CL-ACTIVITY-CODE = 09
 10861             NEXT SENTENCE
 10862           ELSE
 10863             IF WS-RESET-SW = 'Y'
 10864               IF CL-CLAIM-STATUS = 'C'
 10865                 MOVE 07             TO  CL-ACTIVITY-CODE
 10866                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10867                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
 10868               ELSE
 10869                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 200
* EL131.cbl
 10870                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
 10871                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
 10872
 10873
 10874* EXEC CICS HANDLE CONDITION
 10875*         DUPKEY    (2030-EXIT)
 10876*    END-EXEC.
 10877*    MOVE '"$$                   ! - #00010026' TO DFHEIV0
 10878     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10879     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10880     MOVE X'2D20233030303130303236' TO DFHEIV0(25:11)
 10881     CALL 'kxdfhei1' USING DFHEIV0
 10882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10883
 10884
 10885** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10886*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10887
 10888     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10889         MOVE 'Y'                TO CL-YESNOSW
 10890     END-IF.
 10891
 10892
 10893* EXEC CICS WRITE
 10894*         DATASET   (CLMS-FILE-ID)
 10895*         RIDFLD    (MSTR-KEY)
 10896*         FROM      (CLAIM-MASTER)
 10897*    END-EXEC.
 10898     MOVE LENGTH OF
 10899      CLAIM-MASTER
 10900       TO DFHEIV11
 10901*    MOVE '&$ L                  ''   #00010037' TO DFHEIV0
 10902     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10903     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10904     MOVE X'2020233030303130303337' TO DFHEIV0(25:11)
 10905     CALL 'kxdfhei1' USING DFHEIV0,
 10906           CLMS-FILE-ID,
 10907           CLAIM-MASTER,
 10908           DFHEIV11,
 10909           MSTR-KEY,
 10910           DFHEIV99,
 10911           DFHEIV99
 10912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10913
 10914
 10915 2030-EXIT.
 10916     EXIT.
 10917
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 201
* EL131.cbl
 10919 2040-NORMAL-UPDATE.
 10920
 10921* EXEC CICS READ UPDATE
 10922*         DATASET  (CERT-FILE-ID)
 10923*         RIDFLD   (CERT-KEY)
 10924*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10925*    END-EXEC.
 10926*    MOVE '&"S        EU         (   #00010048' TO DFHEIV0
 10927     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10928     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10929     MOVE X'2020233030303130303438' TO DFHEIV0(25:11)
 10930     CALL 'kxdfhei1' USING DFHEIV0,
 10931           CERT-FILE-ID,
 10932           DFHEIV20,
 10933           DFHEIV99,
 10934           CERT-KEY,
 10935           DFHEIV99,
 10936           DFHEIV99,
 10937           DFHEIV99
 10938     SET ADDRESS OF CERTIFICATE-MASTER TO
 10939         DFHEIV20
 10940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10941
 10942
 10943     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10944
 10945
 10946* EXEC CICS HANDLE CONDITION
 10947*         DUPKEY   (2040-EXIT)
 10948*    END-EXEC.
 10949*    MOVE '"$$                   ! . #00010056' TO DFHEIV0
 10950     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10952     MOVE X'2E20233030303130303536' TO DFHEIV0(25:11)
 10953     CALL 'kxdfhei1' USING DFHEIV0
 10954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10955
 10956
 10957
 10958* EXEC CICS REWRITE
 10959*         DATASET  (CERT-FILE-ID)
 10960*         FROM     (CERTIFICATE-MASTER)
 10961*    END-EXEC.
 10962     MOVE LENGTH OF
 10963      CERTIFICATE-MASTER
 10964       TO DFHEIV11
 10965*    MOVE '&& L                  %   #00010060' TO DFHEIV0
 10966     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10967     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10968     MOVE X'2020233030303130303630' TO DFHEIV0(25:11)
 10969     CALL 'kxdfhei1' USING DFHEIV0,
 10970           CERT-FILE-ID,
 10971           CERTIFICATE-MASTER,
 10972           DFHEIV11,
 10973           DFHEIV99
 10974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10975
 10976
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 202
* EL131.cbl
 10977 2040-EXIT.
 10978     EXIT.
 10979
 10980 2050-KEY-UPDATE.
 10981
 10982* EXEC CICS READ UPDATE
 10983*         DATASET  (CERT-FILE-ID)
 10984*         RIDFLD   (CERT-KEY)
 10985*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10986*    END-EXEC.
 10987*    MOVE '&"S        EU         (   #00010069' TO DFHEIV0
 10988     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10989     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10990     MOVE X'2020233030303130303639' TO DFHEIV0(25:11)
 10991     CALL 'kxdfhei1' USING DFHEIV0,
 10992           CERT-FILE-ID,
 10993           DFHEIV20,
 10994           DFHEIV99,
 10995           CERT-KEY,
 10996           DFHEIV99,
 10997           DFHEIV99,
 10998           DFHEIV99
 10999     SET ADDRESS OF CERTIFICATE-MASTER TO
 11000         DFHEIV20
 11001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11002
 11003
 11004     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 11005
 11006
 11007* EXEC CICS DELETE
 11008*         DATASET   (CERT-FILE-ID)
 11009*    END-EXEC.
 11010*    MOVE '&(                    &   #00010077' TO DFHEIV0
 11011     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11012     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11013     MOVE X'2020233030303130303737' TO DFHEIV0(25:11)
 11014     CALL 'kxdfhei1' USING DFHEIV0,
 11015           CERT-FILE-ID,
 11016           DFHEIV99,
 11017           DFHEIV99,
 11018           DFHEIV99,
 11019           DFHEIV99
 11020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11021
 11022
 11023
 11024* EXEC CICS GETMAIN
 11025*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11026*         LENGTH    (CERT-LENGTH)
 11027*         INITIMG   (GETMAIN-SPACE)
 11028*    END-EXEC.
 11029*    MOVE ',"IL                  $   #00010081' TO DFHEIV0
 11030     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11031     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11032     MOVE X'2020233030303130303831' TO DFHEIV0(25:11)
 11033     CALL 'kxdfhei1' USING DFHEIV0,
 11034           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 203
* EL131.cbl
 11035           CERT-LENGTH,
 11036           GETMAIN-SPACE
 11037     SET ADDRESS OF CERTIFICATE-MASTER TO
 11038         DFHEIV20
 11039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11040
 11041
 11042     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 11043
 11044     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11045
 11046
 11047* EXEC CICS HANDLE CONDITION
 11048*         DUPKEY (2050-EXIT)
 11049*    END-EXEC.
 11050*    MOVE '"$$                   ! / #00010091' TO DFHEIV0
 11051     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11053     MOVE X'2F20233030303130303931' TO DFHEIV0(25:11)
 11054     CALL 'kxdfhei1' USING DFHEIV0
 11055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11056
 11057
 11058
 11059* EXEC CICS WRITE
 11060*         DATASET  (CERT-FILE-ID)
 11061*         RIDFLD   (CERT-KEY)
 11062*         FROM     (CERTIFICATE-MASTER)
 11063*    END-EXEC.
 11064     MOVE LENGTH OF
 11065      CERTIFICATE-MASTER
 11066       TO DFHEIV11
 11067*    MOVE '&$ L                  ''   #00010095' TO DFHEIV0
 11068     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11069     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11070     MOVE X'2020233030303130303935' TO DFHEIV0(25:11)
 11071     CALL 'kxdfhei1' USING DFHEIV0,
 11072           CERT-FILE-ID,
 11073           CERTIFICATE-MASTER,
 11074           DFHEIV11,
 11075           CERT-KEY,
 11076           DFHEIV99,
 11077           DFHEIV99
 11078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11079
 11080
 11081 2050-EXIT.
 11082     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 204
* EL131.cbl
 11084 2060-CHANGE-CERT.
 11085     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11086     MOVE PI-CARRIER             TO CERT-CARRIER.
 11087     MOVE PI-GROUPING            TO CERT-GROUP.
 11088     MOVE PI-STATE               TO CERT-STATE.
 11089     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11090     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11091     MOVE PI-CERT-NO             TO CERT-CERT.
 11092     IF CERTEFFI GREATER THAN LOW-VALUES
 11093         MOVE HOLD-EFF           TO CERT-DATE.
 11094     IF CERTACTI GREATER THAN LOW-VALUES
 11095         MOVE CERTACTI           TO CERT-ACCOUNT.
 11096     IF CERTSTI GREATER THAN LOW-VALUES
 11097         MOVE CERTSTI            TO CERT-STATE.
 11098     IF CERTCARI GREATER THAN LOW-VALUES
 11099         MOVE CERTCARI           TO CERT-CARRIER.
 11100     IF CERTGRPI GREATER THAN LOW-VALUES
 11101         MOVE CERTGRPI           TO CERT-GROUP.
 11102     IF CERTI GREATER THAN LOW-VALUES
 11103         MOVE CERTI              TO CERT-CERT-PRIME.
 11104     IF SUFXI GREATER THAN LOW-VALUES
 11105         MOVE SUFXI              TO CERT-CERT-SUFX.
 11106
 11107
 11108* EXEC CICS HANDLE CONDITION
 11109*         NOTFND   (2060-CERT-NOTFND)
 11110*    END-EXEC.
 11111*    MOVE '"$I                   ! 0 #00010127' TO DFHEIV0
 11112     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11114     MOVE X'3020233030303130313237' TO DFHEIV0(25:11)
 11115     CALL 'kxdfhei1' USING DFHEIV0
 11116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11117
 11118
 11119
 11120* EXEC CICS READ UPDATE
 11121*         DATASET  (CERT-FILE-ID)
 11122*         RIDFLD   (CERT-KEY)
 11123*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11124*    END-EXEC.
 11125*    MOVE '&"S        EU         (   #00010131' TO DFHEIV0
 11126     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11127     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11128     MOVE X'2020233030303130313331' TO DFHEIV0(25:11)
 11129     CALL 'kxdfhei1' USING DFHEIV0,
 11130           CERT-FILE-ID,
 11131           DFHEIV20,
 11132           DFHEIV99,
 11133           CERT-KEY,
 11134           DFHEIV99,
 11135           DFHEIV99,
 11136           DFHEIV99
 11137     SET ADDRESS OF CERTIFICATE-MASTER TO
 11138         DFHEIV20
 11139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11140
 11141
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 205
* EL131.cbl
 11142     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 11143
 11144     IF CM-CLAIM-INTERFACE-SW = SPACES
 11145        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11146
 11147
 11148* EXEC CICS HANDLE CONDITION
 11149*         DUPKEY   (2060-DUPKEY)
 11150*    END-EXEC.
 11151*    MOVE '"$$                   ! 1 #00010142' TO DFHEIV0
 11152     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11154     MOVE X'3120233030303130313432' TO DFHEIV0(25:11)
 11155     CALL 'kxdfhei1' USING DFHEIV0
 11156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11157
 11158
 11159
 11160* EXEC CICS REWRITE
 11161*         DATASET  (CERT-FILE-ID)
 11162*         FROM     (CERTIFICATE-MASTER)
 11163*    END-EXEC.
 11164     MOVE LENGTH OF
 11165      CERTIFICATE-MASTER
 11166       TO DFHEIV11
 11167*    MOVE '&& L                  %   #00010146' TO DFHEIV0
 11168     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11169     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11170     MOVE X'2020233030303130313436' TO DFHEIV0(25:11)
 11171     CALL 'kxdfhei1' USING DFHEIV0,
 11172           CERT-FILE-ID,
 11173           CERTIFICATE-MASTER,
 11174           DFHEIV11,
 11175           DFHEIV99
 11176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11177
 11178
 11179 2060-DUPKEY.
 11180
 11181     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11182
 11183 2060-CHANGE-TRLR-ACTQ.
 11184     IF SCREEN-ERROR
 11185         GO TO 2060-EXIT.
 11186
 11187     IF CERTI    GREATER LOW-VALUES OR
 11188        SUFXI    GREATER LOW-VALUES OR
 11189        CERTCARI GREATER LOW-VALUES
 11190         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 11191         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 11192
 11193     MOVE SPACES                 TO CERT-KEY-SWITCH
 11194                                    CERT-SWITCH
 11195                                    TRLR-SWITCH
 11196                                    NINETY-TRLR-SWITCH.
 11197     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 11198     GO TO 2060-EXIT.
 11199
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 206
* EL131.cbl
 11200 2060-CERT-NOTFND.
 11201     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 11202
 11203     IF WS-REC-FOUND-SW = 'N'
 11204         MOVE ER-0206            TO  EMI-ERROR
 11205         MOVE -1                 TO  MAINTL
 11206         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11207
 11208* EXEC CICS UNLOCK
 11209*            DATASET   (CLMS-FILE-ID)
 11210*        END-EXEC
 11211*    MOVE '&*                    #   #00010179' TO DFHEIV0
 11212     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11213     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11214     MOVE X'2020233030303130313739' TO DFHEIV0(25:11)
 11215     CALL 'kxdfhei1' USING DFHEIV0,
 11216           CLMS-FILE-ID,
 11217           DFHEIV99
 11218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11219         GO TO 8110-SEND-DATA.
 11220
 11221     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 11222
 11223     GO TO 2060-CHANGE-TRLR-ACTQ.
 11224
 11225 2060-EXIT.
 11226     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 207
* EL131.cbl
 11228 2070-CHECK-OLD.
 11229
 11230
 11231* EXEC CICS HANDLE CONDITION
 11232*        NOTFND   (2070-NOT-FOUND)
 11233*    END-EXEC.
 11234*    MOVE '"$I                   ! 2 #00010193' TO DFHEIV0
 11235     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11237     MOVE X'3220233030303130313933' TO DFHEIV0(25:11)
 11238     CALL 'kxdfhei1' USING DFHEIV0
 11239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11240
 11241
 11242     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 11243     MOVE PI-CARRIER             TO CERT-CARRIER.
 11244     MOVE PI-GROUPING            TO CERT-GROUP.
 11245     MOVE PI-STATE               TO CERT-STATE.
 11246     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 11247     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 11248     MOVE PI-CERT-NO             TO CERT-CERT.
 11249
 11250
 11251* EXEC CICS READ UPDATE
 11252*         DATASET  (CERT-FILE-ID)
 11253*         RIDFLD   (CERT-KEY)
 11254*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 11255*    END-EXEC.
 11256*    MOVE '&"S        EU         (   #00010205' TO DFHEIV0
 11257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11258     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11259     MOVE X'2020233030303130323035' TO DFHEIV0(25:11)
 11260     CALL 'kxdfhei1' USING DFHEIV0,
 11261           CERT-FILE-ID,
 11262           DFHEIV20,
 11263           DFHEIV99,
 11264           CERT-KEY,
 11265           DFHEIV99,
 11266           DFHEIV99,
 11267           DFHEIV99
 11268     SET ADDRESS OF CERTIFICATE-MASTER TO
 11269         DFHEIV20
 11270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11271
 11272
 11273     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 11274     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 11275     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 11276
 11277     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 11278         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 11279
 11280     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11281       AND
 11282        CERT-WAS-CREATED-FOR-CLAIM
 11283         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 11284
 11285* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 208
* EL131.cbl
 11286*             DATASET   (CERT-FILE-ID)
 11287*        END-EXEC
 11288*    MOVE '&(                    &   #00010222' TO DFHEIV0
 11289     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11290     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11291     MOVE X'2020233030303130323232' TO DFHEIV0(25:11)
 11292     CALL 'kxdfhei1' USING DFHEIV0,
 11293           CERT-FILE-ID,
 11294           DFHEIV99,
 11295           DFHEIV99,
 11296           DFHEIV99,
 11297           DFHEIV99
 11298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11299         GO TO 2070-EXIT.
 11300
 11301     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 11302         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 11303
 11304
 11305* EXEC CICS HANDLE CONDITION
 11306*         DUPKEY   (2070-EXIT)
 11307*    END-EXEC.
 11308*    MOVE '"$$                   ! 3 #00010230' TO DFHEIV0
 11309     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11311     MOVE X'3320233030303130323330' TO DFHEIV0(25:11)
 11312     CALL 'kxdfhei1' USING DFHEIV0
 11313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11314
 11315
 11316
 11317* EXEC CICS REWRITE
 11318*         DATASET  (CERT-FILE-ID)
 11319*         FROM     (CERTIFICATE-MASTER)
 11320*    END-EXEC.
 11321     MOVE LENGTH OF
 11322      CERTIFICATE-MASTER
 11323       TO DFHEIV11
 11324*    MOVE '&& L                  %   #00010234' TO DFHEIV0
 11325     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11326     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11327     MOVE X'2020233030303130323334' TO DFHEIV0(25:11)
 11328     CALL 'kxdfhei1' USING DFHEIV0,
 11329           CERT-FILE-ID,
 11330           CERTIFICATE-MASTER,
 11331           DFHEIV11,
 11332           DFHEIV99
 11333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11334
 11335
 11336     GO TO 2070-EXIT.
 11337
 11338 2070-NOT-FOUND.
 11339     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 11340
 11341 2070-EXIT.
 11342     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 209
* EL131.cbl
 11344 2080-CREATE-CERT.
 11345
 11346* EXEC CICS GETMAIN
 11347*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 11348*         LENGTH    (CERT-LENGTH)
 11349*         INITIMG   (GETMAIN-SPACE)
 11350*    END-EXEC.
 11351*    MOVE ',"IL                  $   #00010248' TO DFHEIV0
 11352     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11353     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11354     MOVE X'2020233030303130323438' TO DFHEIV0(25:11)
 11355     CALL 'kxdfhei1' USING DFHEIV0,
 11356           DFHEIV20,
 11357           CERT-LENGTH,
 11358           GETMAIN-SPACE
 11359     SET ADDRESS OF CERTIFICATE-MASTER TO
 11360         DFHEIV20
 11361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11362
 11363
 11364     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 11365
 11366     IF CERTEFFI GREATER THAN LOW-VALUES
 11367         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 11368                                    DC-BIN-DATE-1
 11369         MOVE '6'                TO DC-OPTION-CODE
 11370         MOVE +1                 TO DC-ELAPSED-MONTHS
 11371         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11372         IF NO-CONVERSION-ERROR
 11373             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 11374
 11375     IF CERTACTI GREATER THAN LOW-VALUES
 11376         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 11377     IF CERTSTI GREATER THAN LOW-VALUES
 11378         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 11379     IF CERTCARI GREATER THAN LOW-VALUES
 11380         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 11381     IF CERTGRPI GREATER THAN LOW-VALUES
 11382         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 11383     IF CERTI GREATER THAN LOW-VALUES
 11384         MOVE CERTI              TO CERT-CERT-PRIME
 11385                                    CM-CERT-PRIME
 11386         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11387
 11388     IF SUFXI GREATER THAN LOW-VALUES
 11389         MOVE SUFXI              TO CERT-CERT-SUFX
 11390                                    CM-CERT-SFX
 11391         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 11392
 11393     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 11394
 11395     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 11396
 11397     MOVE SPACES                 TO CM-ENTRY-BATCH
 11398                                    CM-LF-EXIT-BATCH
 11399                                    CM-AH-EXIT-BATCH
 11400                                    CM-CREDIT-INTERFACE-SW-1
 11401                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 210
* EL131.cbl
 11402
 11403     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11404                               '9' OR 'D' OR 'V'
 11405         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11406
 11407     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 11408                               '9' OR 'D' OR 'V'
 11409         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11410
 11411     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 11412                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 11413     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 11414
 11415
 11416* EXEC CICS HANDLE CONDITION
 11417*         DUPKEY (2080-EXIT)
 11418*    END-EXEC.
 11419*    MOVE '"$$                   ! 4 #00010305' TO DFHEIV0
 11420     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11422     MOVE X'3420233030303130333035' TO DFHEIV0(25:11)
 11423     CALL 'kxdfhei1' USING DFHEIV0
 11424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11425
 11426
 11427
 11428* EXEC CICS WRITE
 11429*         DATASET  (CERT-FILE-ID)
 11430*         RIDFLD   (CERT-KEY)
 11431*         FROM     (CERTIFICATE-MASTER)
 11432*    END-EXEC.
 11433     MOVE LENGTH OF
 11434      CERTIFICATE-MASTER
 11435       TO DFHEIV11
 11436*    MOVE '&$ L                  ''   #00010309' TO DFHEIV0
 11437     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11438     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11439     MOVE X'2020233030303130333039' TO DFHEIV0(25:11)
 11440     CALL 'kxdfhei1' USING DFHEIV0,
 11441           CERT-FILE-ID,
 11442           CERTIFICATE-MASTER,
 11443           DFHEIV11,
 11444           CERT-KEY,
 11445           DFHEIV99,
 11446           DFHEIV99
 11447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11448
 11449
 11450 2080-EXIT.
 11451     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 211
* EL131.cbl
 11453 2100-MOVE-MSTR.
 11454     IF TYPEI GREATER THAN LOW-VALUES
 11455         MOVE TYPEI              TO CL-CLAIM-TYPE.
 11456
 11457     IF STATUSI = LOW-VALUES
 11458         GO TO 2100-NO-STATUS-CHANGE.
 11459
 11460     IF STATUSI = 'OPEN' OR 'O'
 11461         IF CL-CLAIM-STATUS = 'O'
 11462             MOVE SPACES         TO TRLR-SWITCH
 11463                 GO TO 2100-NO-STATUS-CHANGE.
 11464
 11465     IF STATUSI = 'CLOSED' OR 'C'
 11466         IF CL-CLAIM-STATUS = 'C'
 11467             MOVE SPACES         TO TRLR-SWITCH
 11468                 GO TO 2100-NO-STATUS-CHANGE.
 11469
 11470     IF PI-COMPANY-ID = 'DMD'
 11471        IF STATUSI = 'OPEN' OR 'O'
 11472           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 11473              MOVE ZERO       TO STATUSL
 11474              MOVE LOW-VALUES TO STATUSI
 11475              GO TO 2100-NO-STATUS-CHANGE.
 11476
 11477     IF PI-COMPANY-ID = 'DMD'
 11478         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 11479
 11480     MOVE STATUSI                TO CL-CLAIM-STATUS.
 11481
 11482 2100-NO-STATUS-CHANGE.
 11483
 11484     IF CCNOI GREATER THAN LOW-VALUES
 11485         MOVE CCNOI              TO CL-CCN.
 11486
 11487     IF PROCI GREATER THAN LOW-VALUES
 11488         MOVE PROCI              TO CL-PROCESSOR-ID.
 11489
 11490     if (accswi > low-values)
 11491        and (accswi = 'Y' OR 'N')
 11492        move accswi              to cl-accident-claim-sw
 11493     end-if
 11494     if benperi > low-values
 11495        and benperi numeric
 11496        move benperi             to cl-benefit-period
 11497     end-if
 11498     if instypei > low-values
 11499        move instypei            to cl-insured-type
 11500     end-if
 11501     IF SEXI GREATER THAN LOW-VALUES
 11502         MOVE SEXI               TO CL-INSURED-SEX-CD.
 11503
 11504     IF BIRTHI GREATER THAN LOW-VALUES
 11505         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 11506
 11507     IF SOCIALI GREATER THAN LOW-VALUES
 11508       AND
 11509        SOCIALI = SPACES
 11510         MOVE CL-CERT-STATE      TO CL-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 212
* EL131.cbl
 11511         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 11512         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 11513     ELSE
 11514         IF SOCIALI GREATER THAN LOW-VALUES
 11515             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 11516
 11517     IF OCCI GREATER THAN LOW-VALUES
 11518         MOVE OCCI               TO CL-INSURED-OCC-CD.
 11519
 11520     IF BENEL GREATER THAN ZERO
 11521         MOVE BENEI              TO CL-BENEFICIARY.
 11522
 11523     IF DIAGI GREATER THAN LOW-VALUES
 11524         MOVE DIAGI              TO WS-DIAGNOSIS.
 11525
 11526     IF ICD1I GREATER THAN LOW-VALUES
 11527         MOVE ICD1I              TO WS-ICD-CODE-1
 11528     END-IF.
 11529
 11530     IF ICD2I GREATER THAN LOW-VALUES
 11531         MOVE ICD2I              TO WS-ICD-CODE-2
 11532     END-IF.
 11533
 11534     IF PREMTYPI GREATER THAN LOW-VALUES
 11535         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 11536
 11537*    IF CAUSEI GREATER THAN LOW-VALUES
 11538*        MOVE CAUSEI             TO CL-CAUSE-CD.
 11539
 11540*    IF ENDI GREATER THAN LOW-VALUES
 11541*        MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 11542
 11543     IF PDTHRUI GREATER THAN LOW-VALUES
 11544        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 11545
 11546     IF PDAMTL GREATER THAN +0
 11547        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 11548
 11549     IF NODAYSI GREATER THAN LOW-VALUES
 11550        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 11551
 11552     IF NOPMTSI GREATER THAN LOW-VALUES
 11553        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 11554
 11555     IF FORMTYPI GREATER THAN LOW-VALUES
 11556        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 11557
 11558     IF INCI GREATER THAN LOW-VALUES
 11559        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 11560
 11561     IF REPI GREATER THAN LOW-VALUES
 11562        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 11563
 11564     IF ADDONDTI GREATER THAN LOW-VALUES
 11565        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 11566
 11567     IF PRICDI GREATER THAN LOW-VALUES
 11568         MOVE PRICDI             TO CL-PRIORITY-CD.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 213
* EL131.cbl
 11569
 11570     IF CRITPL  > ZEROS
 11571        MOVE CRITPI              TO CL-CRITICAL-PERIOD
 11572     END-IF
 11573
 11574     IF EXTENSL  > ZEROS
 11575        MOVE EXTENSI             TO CL-NO-OF-EXTENSIONS
 11576     END-IF
 11577*    IF CRITPTL > ZEROS
 11578*       MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 11579*    END-IF
 11580
 11581*    IF RTWMOSL > ZEROS
 11582*       MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 11583*    END-IF
 11584     IF FILETOI GREATER THAN LOW-VALUES
 11585         MOVE FILETOI            TO CL-FILE-LOCATION.
 11586
 11587     IF SUPVI GREATER THAN LOW-VALUES
 11588         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 11589
 11590     IF MLNAMEI GREATER THAN LOW-VALUES
 11591         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 11592
 11593     IF MFNAMEI GREATER THAN LOW-VALUES
 11594         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 11595
 11596     IF MMINITI GREATER THAN LOW-VALUES
 11597         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 11598
 11599     IF CERTEFFI GREATER THAN LOW-VALUES
 11600         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 11601
 11602     IF CERTACTI GREATER THAN LOW-VALUES
 11603         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 11604
 11605     IF CERTSTI GREATER THAN LOW-VALUES
 11606         MOVE CERTSTI            TO CL-CERT-STATE.
 11607
 11608     IF CERTCARI GREATER THAN LOW-VALUES
 11609         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 11610                                    CL-CARRIER.
 11611
 11612     IF CERTGRPI GREATER THAN LOW-VALUES
 11613         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 11614
 11615     IF CERTI GREATER THAN LOW-VALUES
 11616         MOVE CERTI              TO CERT-NO-PRIME.
 11617
 11618     IF SUFXI GREATER THAN LOW-VALUES
 11619         MOVE SUFXI              TO CERT-NO-SUFX.
 11620
 11621     MOVE CERT-NO                TO CL-CERT-NO
 11622                                    CL-CERT-NO-A4.
 11623
 11624     IF PI-COMPANY-ID = 'FLA'
 11625          NEXT SENTENCE
 11626     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 214
* EL131.cbl
 11627         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 11628         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 11629         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 11630         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 11631
 11632     IF TRLR-UPDATE-REQUIRED
 11633        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 11634        MOVE ZEROS              TO TRLR-SEQ-NO
 11635
 11636* EXEC CICS READ
 11637*            DATASET   (TRLR-FILE-ID)
 11638*            RIDFLD    (TRLR-KEY)
 11639*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11640*       END-EXEC
 11641*    MOVE '&"S        E          (   #00010500' TO DFHEIV0
 11642     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11643     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11644     MOVE X'2020233030303130353030' TO DFHEIV0(25:11)
 11645     CALL 'kxdfhei1' USING DFHEIV0,
 11646           TRLR-FILE-ID,
 11647           DFHEIV20,
 11648           DFHEIV99,
 11649           TRLR-KEY,
 11650           DFHEIV99,
 11651           DFHEIV99,
 11652           DFHEIV99
 11653     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11654         DFHEIV20
 11655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11656        IF AT-TRAILER-TYPE = '1'
 11657           MOVE +1 TO MISC-SUB
 11658           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 11659           MISC-SUB GREATER THAN +6 OR
 11660           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 11661           IF MISC-SUB GREATER THAN +1
 11662              SUBTRACT +1 FROM MISC-SUB
 11663              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11664                 GO TO 2100-BYPASS-LAST-UPDATE.
 11665
 11666     IF TRLR-UPDATE-REQUIRED AND
 11667        CLAIM-IS-OPEN
 11668         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 11669     ELSE
 11670         IF TRLR-UPDATE-REQUIRED AND
 11671            CLAIM-IS-CLOSED
 11672             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 11673             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 11674
 11675 2100-BYPASS-LAST-UPDATE.
 11676     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11677     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 11678
 11679     GO TO 2100-EXIT.
 11680
 11681 2100-BUMP-OPEN-CLOSE-HIST.
 11682     ADD +1                      TO MISC-SUB.
 11683
 11684 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 215
* EL131.cbl
 11685     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 216
* EL131.cbl
 11687 2120-check-pdef.
 11688     move +0                     to s1
 11689     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 11690     move spaces                 to ws-dcc-error-line
 11691     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 11692     IF ERPDEF-FOUND
 11693        perform 2130-check-trlr  thru 2130-exit
 11694        move +1                  to s1
 11695*       if cl-accident-claim-sw = ' '
 11696*          move er-1655             to ws-error-no (s1)
 11697*          add +1 to s1
 11698*       end-if
 11699        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 11700        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 11701        if (hold-incur > low-values)
 11702           and (incl > zeros)
 11703           and (hold-incur not = cl-incurred-dt)
 11704           move hold-incur       to dc-bin-date-2
 11705        end-if
 11706        MOVE '1'                 TO DC-OPTION-CODE
 11707        MOVE +0                  TO DC-ELAPSED-MONTHS
 11708                                    DC-ELAPSED-DAYS
 11709        PERFORM 9800-CONVERT-DATE
 11710                                 THRU 9800-EXIT
 11711        IF NO-CONVERSION-ERROR
 11712           MOVE DC-ELAPSED-MONTHS
 11713                                 TO WS-MONTHS-BETWEEN
 11714           IF DC-ELAPSED-DAYS > 1
 11715              ADD 1 TO WS-MONTHS-BETWEEN
 11716           END-IF
 11717        ELSE
 11718           display ' dte conv error ' dc-error-code
 11719           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 11720        END-IF
 11721        IF (WS-EXCL-PERIOD = ZEROS)
 11722           OR (WS-MONTHS-BETWEEN = ZEROS)
 11723           CONTINUE
 11724        ELSE
 11725           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 11726              MOVE ER-1651       TO ws-error-no (s1)
 11727              add +1             to s1
 11728           END-IF
 11729        END-IF
 11730        IF (WS-COV-ENDS = ZEROS)
 11731           OR (WS-MONTHS-BETWEEN = ZEROS)
 11732           CONTINUE
 11733        ELSE
 11734           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 11735              MOVE -1            TO MAINTL
 11736              MOVE ER-1653       TO ws-error-no (s1)
 11737              add +1 to s1
 11738           END-IF
 11739        END-IF
 11740        IF (WS-ACC-PERIOD = ZEROS)
 11741           OR (WS-MONTHS-BETWEEN = ZEROS)
 11742           CONTINUE
 11743        ELSE
 11744           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 217
* EL131.cbl
 11745              and (accswi = spaces or low-values)
 11746*             and (cl-accident-claim-sw = ' ')
 11747              move er-1655       to ws-error-no (s1)
 11748              add +1             to s1
 11749           end-if
 11750           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 11751*             if (cl-accident-claim-sw not = 'Y')
 11752              if (accswi not = 'Y')
 11753                 MOVE ER-1652    TO ws-error-no (s1)
 11754              else
 11755                 move er-1662    to ws-error-no (s1)
 11756              end-if
 11757              MOVE -1            TO MAINTL
 11758              add +1             to s1
 11759           END-IF
 11760        END-IF
 11761        if cl-claim-type  = 'I'
 11762           move er-1661          to ws-error-no (s1)
 11763           add +1                to s1
 11764        end-if
 11765        perform 2130-check-trlr  thru 2130-exit
 11766     END-IF
 11767
 11768     .
 11769 2120-exit.
 11770     exit.
 11771
 11772 2130-check-trlr.
 11773
 11774     evaluate true
 11775        when s1 = +0
 11776           move cl-control-primary
 11777                                 to trlr-key
 11778           MOVE +95              TO TRLR-SEQ-NO
 11779
 11780* EXEC CICS READ
 11781*             update
 11782*             DATASET  ('ELTRLR')
 11783*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11784*             RIDFLD   (TRLR-KEY)
 11785*             RESP     (WS-RESPONSE)
 11786*          END-EXEC
 11787     MOVE 'ELTRLR' TO DFHEIV1
 11788*    MOVE '&"S        EU         (  N#00010628' TO DFHEIV0
 11789     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11790     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11791     MOVE X'204E233030303130363238' TO DFHEIV0(25:11)
 11792     CALL 'kxdfhei1' USING DFHEIV0,
 11793           DFHEIV1,
 11794           DFHEIV20,
 11795           DFHEIV99,
 11796           TRLR-KEY,
 11797           DFHEIV99,
 11798           DFHEIV99,
 11799           DFHEIV99
 11800     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11801         DFHEIV20
 11802     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 218
* EL131.cbl
 11803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11804           if ws-resp-normal
 11805              move spaces        to at-info-line-1
 11806           end-if
 11807        when s1 = +1
 11808           if ws-resp-normal
 11809
 11810* exec cics rewrite
 11811*                dataset   ('ELTRLR')
 11812*                from      (activity-trailers)
 11813*             end-exec
 11814     MOVE LENGTH OF
 11815      activity-trailers
 11816       TO DFHEIV11
 11817     MOVE 'ELTRLR' TO DFHEIV1
 11818*    MOVE '&& L                  %   #00010640' TO DFHEIV0
 11819     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11820     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11821     MOVE X'2020233030303130363430' TO DFHEIV0(25:11)
 11822     CALL 'kxdfhei1' USING DFHEIV0,
 11823           DFHEIV1,
 11824           activity-trailers,
 11825           DFHEIV11,
 11826           DFHEIV99
 11827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11828           end-if
 11829        when s1 > +1
 11830           if ws-resp-normal
 11831              move ws-dcc-error-line
 11832                                 to at-info-line-1
 11833
 11834* exec cics rewrite
 11835*                dataset   ('ELTRLR')
 11836*                from      (activity-trailers)
 11837*             end-exec
 11838     MOVE LENGTH OF
 11839      activity-trailers
 11840       TO DFHEIV11
 11841     MOVE 'ELTRLR' TO DFHEIV1
 11842*    MOVE '&& L                  %   #00010649' TO DFHEIV0
 11843     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11844     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11845     MOVE X'2020233030303130363439' TO DFHEIV0(25:11)
 11846     CALL 'kxdfhei1' USING DFHEIV0,
 11847           DFHEIV1,
 11848           activity-trailers,
 11849           DFHEIV11,
 11850           DFHEIV99
 11851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11852           else
 11853
 11854* EXEC CICS GETMAIN
 11855*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11856*                LENGTH   (TRLR-LENGTH)
 11857*                INITIMG  (GETMAIN-SPACE)
 11858*             END-EXEC
 11859*    MOVE ',"IL                  $   #00010654' TO DFHEIV0
 11860     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 219
* EL131.cbl
 11861     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11862     MOVE X'2020233030303130363534' TO DFHEIV0(25:11)
 11863     CALL 'kxdfhei1' USING DFHEIV0,
 11864           DFHEIV20,
 11865           TRLR-LENGTH,
 11866           GETMAIN-SPACE
 11867     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11868         DFHEIV20
 11869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11870              move 'AT'          to at-record-id
 11871              move cl-control-primary
 11872                                 to at-control-primary
 11873              move +95           to at-sequence-no
 11874              move '6'           to at-trailer-type
 11875              move ws-dcc-error-line
 11876                                 to at-info-line-1
 11877              move 'E'           to at-info-trailer-type
 11878              move save-bin-date to at-recorded-dt
 11879                                    at-gen-info-last-maint-dt
 11880              move pi-processor-id
 11881                                 to at-recorded-by
 11882                                    at-gen-info-last-updated-by
 11883              move eibtime       to at-last-maint-hhmmss
 11884
 11885* exec cics write
 11886*                dataset   ('ELTRLR')
 11887*                from      (activity-trailers)
 11888*                ridfld    (trlr-key)
 11889*             end-exec
 11890     MOVE LENGTH OF
 11891      activity-trailers
 11892       TO DFHEIV11
 11893     MOVE 'ELTRLR' TO DFHEIV1
 11894*    MOVE '&$ L                  ''   #00010673' TO DFHEIV0
 11895     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11896     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11897     MOVE X'2020233030303130363733' TO DFHEIV0(25:11)
 11898     CALL 'kxdfhei1' USING DFHEIV0,
 11899           DFHEIV1,
 11900           activity-trailers,
 11901           DFHEIV11,
 11902           trlr-key,
 11903           DFHEIV99,
 11904           DFHEIV99
 11905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11906              perform varying s1 from +1 by +1 until
 11907                 ws-error-no (s1) = spaces
 11908                 move ws-error-no (s1)
 11909                                 to emi-error
 11910                 PERFORM 9900-ERROR-FORMAT
 11911                                 THRU 9900-EXIT
 11912              end-perform
 11913           end-if
 11914     end-evaluate
 11915
 11916     .
 11917 2130-exit.
 11918     exit.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 220
* EL131.cbl
 11919 2140-update-elcrtt.
 11920     move ' '                    to crtt-switch
 11921     MOVE CERT-KEY               TO ELCRTT-KEY
 11922     MOVE 'B'                    TO CTRLR-REC-TYPE
 11923
 11924* EXEC CICS READ
 11925*       UPDATE
 11926*       DATASET   ('ELCRTT')
 11927*       RIDFLD    (ELCRTT-KEY)
 11928*       INTO      (CERTIFICATE-TRAILERS)
 11929*       RESP      (WS-RESPONSE)
 11930*    END-EXEC
 11931     MOVE LENGTH OF
 11932      CERTIFICATE-TRAILERS
 11933       TO DFHEIV11
 11934     MOVE 'ELCRTT' TO DFHEIV1
 11935*    MOVE '&"IL       EU         (  N#00010695' TO DFHEIV0
 11936     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11937     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11938     MOVE X'204E233030303130363935' TO DFHEIV0(25:11)
 11939     CALL 'kxdfhei1' USING DFHEIV0,
 11940           DFHEIV1,
 11941           CERTIFICATE-TRAILERS,
 11942           DFHEIV11,
 11943           ELCRTT-KEY,
 11944           DFHEIV99,
 11945           DFHEIV99,
 11946           DFHEIV99
 11947     MOVE EIBRESP  TO WS-RESPONSE
 11948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11949     IF WS-RESP-NORMAL
 11950        perform varying s1 from +1 by +1 until
 11951           (s1 > +24)
 11952           or (cs-claim-no (s1) = cl-claim-no)
 11953        end-perform
 11954        if (s1 < +25)
 11955           if (benperl <> zeros)
 11956              and (cs-benefit-period (s1) not = benperi)
 11957              move benperi       to cs-benefit-period (s1)
 11958              set crtt-update    to true
 11959          end-if
 11960          if (instypel <> zeros)
 11961             and (instypei not = cs-insured-type (s1))
 11962             move instypei      to cs-insured-type (s1)
 11963             set crtt-update    to true
 11964          end-if
 11965          move cs-claim-type (s1) to ws-claim-type
 11966          move cs-benefit-period (s1) to ws-ben-per
 11967        end-if
 11968        if crtt-update
 11969           perform 2150-accum    thru 2150-exit
 11970
 11971* EXEC CICS REWRITE
 11972*             DATASET   ('ELCRTT')
 11973*             FROM      (CERTIFICATE-TRAILERS)
 11974*          END-EXEC
 11975     MOVE LENGTH OF
 11976      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 221
* EL131.cbl
 11977       TO DFHEIV11
 11978     MOVE 'ELCRTT' TO DFHEIV1
 11979*    MOVE '&& L                  %   #00010723' TO DFHEIV0
 11980     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11981     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11982     MOVE X'2020233030303130373233' TO DFHEIV0(25:11)
 11983     CALL 'kxdfhei1' USING DFHEIV0,
 11984           DFHEIV1,
 11985           CERTIFICATE-TRAILERS,
 11986           DFHEIV11,
 11987           DFHEIV99
 11988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11989        else
 11990
 11991* exec cics unlock
 11992*             dataset   ('ELCRTT')
 11993*          end-exec
 11994     MOVE 'ELCRTT' TO DFHEIV1
 11995*    MOVE '&*                    #   #00010728' TO DFHEIV0
 11996     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 11997     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11998     MOVE X'2020233030303130373238' TO DFHEIV0(25:11)
 11999     CALL 'kxdfhei1' USING DFHEIV0,
 12000           DFHEIV1,
 12001           DFHEIV99
 12002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12003        end-if
 12004     end-if
 12005     .
 12006 2140-exit.
 12007     exit.
 12008 2150-accum.
 12009     if not erpdef-found
 12010        perform 3997-get-erpdef  thru 3997-exit
 12011     end-if
 12012     if (erpdef-found)
 12013        and (ws-max-moben not = zeros)
 12014        and (ws-max-moben < cm-ah-benefit-amt)
 12015        continue
 12016     else
 12017        move cm-ah-benefit-amt   to ws-max-moben
 12018     end-if
 12019     move cm-ah-orig-term        to ws-max-bens
 12020     if cl-critical-period not = zeros and spaces
 12021        move cl-critical-period  to ws-max-bens
 12022     end-if
 12023     move zeros to ws-tot-days-paid ws-tot-amt-paid
 12024     perform varying s2 from +1 by +1 until
 12025        (s2 > +24)
 12026        or (cs-claim-no (s2) = spaces)
 12027        if (cs-benefit-period (s2) = ws-ben-per)
 12028           and (cs-claim-type (s2) = ws-claim-type)
 12029           and (cs-insured-type (s2) = cl-insured-type)
 12030*          compute ws-tot-days-paid =
 12031*             ws-tot-days-paid + cs-days-paid (s2)
 12032           compute ws-tot-amt-paid =
 12033              ws-tot-amt-paid + cs-total-paid (s2)
 12034        end-if
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 222
* EL131.cbl
 12035     end-perform
 12036     if s2 < +25
 12037        compute ws-pd-bens rounded =
 12038           ws-tot-amt-paid / ws-max-moben
 12039        compute cs-remaining-bens (s1) =
 12040           ws-max-bens - ws-pd-bens
 12041        if cs-remaining-bens (s1) < zeros
 12042           move zeros            to cs-remaining-bens (s1)
 12043        end-if
 12044     end-if
 12045     .
 12046 2150-exit.
 12047     exit.
 12048 2200-MOVE-CERT.
 12049     IF CRTLNMEI GREATER THAN LOW-VALUES
 12050         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 12051
 12052     IF CRTFNMEI GREATER THAN LOW-VALUES
 12053         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
 12054         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 12055
 12056     IF CRTINITI GREATER THAN LOW-VALUES
 12057         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 12058
 12059     IF CM-INSURED-INITIALS = SPACES
 12060         MOVE '**'               TO CM-INSURED-INITIALS.
 12061
 12062     IF ISSAGEI GREATER THAN LOW-VALUES
 12063         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 12064
 12065     IF JNTFNMEI GREATER THAN LOW-VALUES
 12066         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 12067
 12068     IF JNTLNMEI GREATER THAN LOW-VALUES
 12069         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 12070
 12071     IF JNTINITI GREATER THAN LOW-VALUES
 12072         MOVE JNTINITI           TO CM-JT-INITIAL.
 12073
 12074     IF JNTAGEI GREATER THAN LOW-VALUES
 12075         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 12076
 12077     IF ADDONDTI GREATER THAN LOW-VALUES
 12078        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 12079
 12080     IF LCVCDI GREATER THAN LOW-VALUES
 12081        IF LCVCDI = SPACES OR ZEROS
 12082           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 12083        ELSE
 12084           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 12085
 12086     IF LCVOTRMI GREATER THAN LOW-VALUES
 12087         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 12088
 12089     IF LCVRATEL GREATER THAN +0
 12090         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 12091
 12092     IF LCVBENEL GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 223
* EL131.cbl
 12093         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 12094
 12095     IF LCVFORMI GREATER THAN LOW-VALUES
 12096         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 12097
 12098     IF LCVCNDTI = LOW-VALUES
 12099        GO TO 2210-SET-STATUS.
 12100
 12101     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 12102        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 12103        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 12104        GO TO 2210-SET-STATUS.
 12105
 12106     IF CM-LF-CURRENT-STATUS = '7'
 12107        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 12108        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 12109        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12110                                    CM-LF-DEATH-DT
 12111        GO TO 2210-SET-STATUS.
 12112
 12113     IF CM-LF-CURRENT-STATUS = '8'
 12114        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 12115        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 12116                                    CM-LF-CANCEL-DT.
 12117
 12118 2210-SET-STATUS.
 12119
 12120     IF CM-LF-CURRENT-STATUS = SPACES
 12121         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 12122
 12123     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 12124         MOVE '6'                TO DC-OPTION-CODE
 12125         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12126         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12127         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12128         IF NO-CONVERSION-ERROR
 12129             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 12130         ELSE
 12131             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 12132     ELSE
 12133         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 12134
 12135 2215-PROCESS-AH-SIDE.
 12136
 12137     IF ACVCDI GREATER THAN LOW-VALUES
 12138        IF ACVCDI = SPACES OR ZEROS
 12139           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 12140        ELSE
 12141           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 12142
 12143     IF ACVOTRMI GREATER THAN LOW-VALUES
 12144         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 12145
 12146     IF ACVRATEL GREATER THAN +0
 12147         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 12148
 12149     IF ACVBENEL GREATER THAN +0
 12150         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 224
* EL131.cbl
 12151                                    PI-PAYMENT-AMT.
 12152
 12153     IF ACVFORMI GREATER THAN LOW-VALUES
 12154         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 12155
 12156     IF ACVCNDTI = LOW-VALUES
 12157        GO TO 2220-SET-STATUS.
 12158
 12159     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 12160        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 12161        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 12162        GO TO 2220-SET-STATUS.
 12163
 12164     IF CM-AH-CURRENT-STATUS = '6'
 12165        MOVE CM-AH-STATUS-AT-SETTLEMENT
 12166                                 TO CM-AH-CURRENT-STATUS
 12167        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 12168        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12169                                    CM-AH-SETTLEMENT-DT
 12170        GO TO 2220-SET-STATUS.
 12171
 12172     IF CM-AH-CURRENT-STATUS = '8'
 12173        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 12174        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 12175                                    CM-AH-CANCEL-DT.
 12176
 12177 2220-SET-STATUS.
 12178     IF CM-AH-CURRENT-STATUS = SPACES
 12179         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 12180
 12181     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 12182         MOVE '6'                TO DC-OPTION-CODE
 12183         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 12184         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 12185         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12186         IF NO-CONVERSION-ERROR
 12187             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 12188         ELSE
 12189             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 12190     ELSE
 12191         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 12192
 12193 2225-FINISH-CERT.
 12194     IF APRL GREATER THAN +0
 12195         MOVE HOLD-APR           TO CM-LOAN-APR.
 12196
 12197     IF PMTFREQI GREATER THAN LOW-VALUES
 12198         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 12199
 12200     IF INDGRPI GREATER THAN LOW-VALUES
 12201         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 12202
 12203*    IF LOANNOI GREATER THAN LOW-VALUES
 12204*       MOVE LOANNOI             TO CM-LOAN-NUMBER.
 12205
 12206     IF LOANBALL GREATER THAN +0
 12207        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 12208
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 225
* EL131.cbl
 12209     IF PREMTYPI GREATER THAN LOW-VALUES
 12210         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 12211
 12212     IF REINCDI GREATER THAN LOW-VALUES
 12213         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 12214                                    WS-REIN-1
 12215                                    WS-REIN-2
 12216                                    WS-REIN-3
 12217         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 12218
 12219     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 12220
 12221     MOVE ZEROS                  TO CM-LOAN-TERM
 12222                                    CM-LIFE-COMM-PCT
 12223                                    CM-AH-COMM-PCT.
 12224
 12225*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 12226*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 12227*         PI-NO-PMTS = ZEROS
 12228*          IF LOANBALL GREATER THAN +0          OR
 12229*             ACVBENEL GREATER THAN +0          OR
 12230*             APRL     GREATER THAN +0          OR
 12231*             LCVRATEL GREATER THAN +0          OR
 12232*             ACVRATEL GREATER THAN +0
 12233*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 12234
 12235 2200-EXIT.
 12236     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 226
* EL131.cbl
 12238 2300-UPDATE-TRLR.
 12239     MOVE ZERO                   TO TRLR-SEQ-NO.
 12240
 12241* EXEC CICS READ UPDATE
 12242*         DATASET  (TRLR-FILE-ID)
 12243*         RIDFLD   (TRLR-KEY)
 12244*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12245*    END-EXEC.
 12246*    MOVE '&"S        EU         (   #00010968' TO DFHEIV0
 12247     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12248     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12249     MOVE X'2020233030303130393638' TO DFHEIV0(25:11)
 12250     CALL 'kxdfhei1' USING DFHEIV0,
 12251           TRLR-FILE-ID,
 12252           DFHEIV20,
 12253           DFHEIV99,
 12254           TRLR-KEY,
 12255           DFHEIV99,
 12256           DFHEIV99,
 12257           DFHEIV99
 12258     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12259         DFHEIV20
 12260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12261
 12262
 12263     MOVE ZERO                   TO COUNT-2.
 12264
 12265     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12266         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12267
 12268     IF NOT UPDATE-MADE
 12269         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12270
 12271
 12272* EXEC CICS REWRITE
 12273*         DATASET  (TRLR-FILE-ID)
 12274*         FROM     (ACTIVITY-TRAILERS)
 12275*    END-EXEC.
 12276     MOVE LENGTH OF
 12277      ACTIVITY-TRAILERS
 12278       TO DFHEIV11
 12279*    MOVE '&& L                  %   #00010982' TO DFHEIV0
 12280     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12281     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12282     MOVE X'2020233030303130393832' TO DFHEIV0(25:11)
 12283     CALL 'kxdfhei1' USING DFHEIV0,
 12284           TRLR-FILE-ID,
 12285           ACTIVITY-TRAILERS,
 12286           DFHEIV11,
 12287           DFHEIV99
 12288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12289
 12290
 12291 2300-EXIT.
 12292     EXIT.
 12293
 12294 2310-INS-STATUS.
 12295     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 227
* EL131.cbl
 12296     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 12297         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 12298         MOVE 'Y'                TO TRLR-SWITCH.
 12299
 12300 2310-EXIT.
 12301     EXIT.
 12302
 12303 2320-SHIFT-STATUS.
 12304     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 12305        MOVE 6                   TO COUNT-2
 12306        GO TO 2320-EXIT.
 12307
 12308     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 12309     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 12310     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 12311     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 12312     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 12313     MOVE 6       TO COUNT-2.
 12314     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 12315
 12316 2320-EXIT.
 12317     EXIT.
 12318
 12319 2330-ADD-UPDATE.
 12320
 12321     IF COUNT-2 GREATER THAN 1
 12322        COMPUTE MISC-SUB = (COUNT-2 - 1)
 12323        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 12324           GO TO 2330-EXIT.
 12325
 12326     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 12327                                   AT-RESERVES-LAST-MAINT-DT
 12328
 12329     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 12330     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 12331     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 12332     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 12333
 12334 2330-EXIT.
 12335     EXIT.
 12336
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 228
* EL131.cbl
 12338 2400-UPDATE-TRLR.
 12339
 12340* EXEC CICS HANDLE CONDITION
 12341*         NOTFND    (2400-TRLR-NOTFND)
 12342*         ENDFILE   (2410-EXIT)
 12343*    END-EXEC.
 12344*    MOVE '"$I''                  ! 5 #00011035' TO DFHEIV0
 12345     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12346     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12347     MOVE X'3520233030303131303335' TO DFHEIV0(25:11)
 12348     CALL 'kxdfhei1' USING DFHEIV0
 12349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12350
 12351
 12352
 12353* EXEC CICS STARTBR
 12354*        DATASET (TRLR-FILE-ID)
 12355*        RIDFLD  (TRLR-KEY)
 12356*    END-EXEC.
 12357     MOVE 0
 12358       TO DFHEIV11
 12359*    MOVE '&,         G          &   #00011040' TO DFHEIV0
 12360     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12361     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12362     MOVE X'2020233030303131303430' TO DFHEIV0(25:11)
 12363     CALL 'kxdfhei1' USING DFHEIV0,
 12364           TRLR-FILE-ID,
 12365           TRLR-KEY,
 12366           DFHEIV99,
 12367           DFHEIV11,
 12368           DFHEIV99
 12369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12370
 12371
 12372
 12373* EXEC CICS GETMAIN
 12374*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12375*         LENGTH    (TRLR-LENGTH)
 12376*         INITIMG   (GETMAIN-SPACE)
 12377*    END-EXEC.
 12378*    MOVE ',"IL                  $   #00011045' TO DFHEIV0
 12379     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12380     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12381     MOVE X'2020233030303131303435' TO DFHEIV0(25:11)
 12382     CALL 'kxdfhei1' USING DFHEIV0,
 12383           DFHEIV20,
 12384           TRLR-LENGTH,
 12385           GETMAIN-SPACE
 12386     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12387         DFHEIV20
 12388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12389
 12390
 12391     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 12392
 12393
 12394* EXEC CICS ENDBR
 12395*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 229
* EL131.cbl
 12396*    END-EXEC.
 12397     MOVE 0
 12398       TO DFHEIV11
 12399*    MOVE '&2                    $   #00011053' TO DFHEIV0
 12400     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12401     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12402     MOVE X'2020233030303131303533' TO DFHEIV0(25:11)
 12403     CALL 'kxdfhei1' USING DFHEIV0,
 12404           TRLR-FILE-ID,
 12405           DFHEIV11,
 12406           DFHEIV99
 12407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12408
 12409
 12410     GO TO 2400-EXIT.
 12411
 12412 2400-TRLR-NOTFND.
 12413     MOVE ER-0205                TO EMI-ERROR.
 12414     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12415     MOVE 'X'                    TO ERROR-SWITCH.
 12416
 12417 2400-EXIT.
 12418     EXIT.
 12419
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 230
* EL131.cbl
 12421 2410-CHANGE-TRLR.
 12422
 12423* EXEC CICS READNEXT
 12424*        DATASET (TRLR-FILE-ID)
 12425*        RIDFLD  (TRLR-KEY)
 12426*        INTO    (ACTIVITY-TRAILERS)
 12427*    END-EXEC.
 12428     MOVE LENGTH OF
 12429      ACTIVITY-TRAILERS
 12430       TO DFHEIV12
 12431     MOVE 0
 12432       TO DFHEIV11
 12433*    MOVE '&.IL                  )   #00011069' TO DFHEIV0
 12434     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12435     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12436     MOVE X'2020233030303131303639' TO DFHEIV0(25:11)
 12437     CALL 'kxdfhei1' USING DFHEIV0,
 12438           TRLR-FILE-ID,
 12439           ACTIVITY-TRAILERS,
 12440           DFHEIV12,
 12441           TRLR-KEY,
 12442           DFHEIV99,
 12443           DFHEIV11,
 12444           DFHEIV99,
 12445           DFHEIV99
 12446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12447
 12448
 12449     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 12450        GO TO 2410-CHANGE-TRLR.
 12451
 12452     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 12453                                    CHECK-KEY.
 12454
 12455     IF CHECK-KEY NOT = MSTR-KEY
 12456         GO TO 2410-EXIT.
 12457
 12458
 12459* EXEC CICS ENDBR
 12460*        DATASET (TRLR-FILE-ID)
 12461*    END-EXEC.
 12462     MOVE 0
 12463       TO DFHEIV11
 12464*    MOVE '&2                    $   #00011084' TO DFHEIV0
 12465     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12466     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12467     MOVE X'2020233030303131303834' TO DFHEIV0(25:11)
 12468     CALL 'kxdfhei1' USING DFHEIV0,
 12469           TRLR-FILE-ID,
 12470           DFHEIV11,
 12471           DFHEIV99
 12472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12473
 12474
 12475
 12476* EXEC CICS READ UPDATE
 12477*        DATASET (TRLR-FILE-ID)
 12478*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 231
* EL131.cbl
 12479*        INTO    (ACTIVITY-TRAILERS)
 12480*    END-EXEC.
 12481     MOVE LENGTH OF
 12482      ACTIVITY-TRAILERS
 12483       TO DFHEIV11
 12484*    MOVE '&"IL       EU         (   #00011088' TO DFHEIV0
 12485     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12486     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12487     MOVE X'2020233030303131303838' TO DFHEIV0(25:11)
 12488     CALL 'kxdfhei1' USING DFHEIV0,
 12489           TRLR-FILE-ID,
 12490           ACTIVITY-TRAILERS,
 12491           DFHEIV11,
 12492           TRLR-KEY,
 12493           DFHEIV99,
 12494           DFHEIV99,
 12495           DFHEIV99
 12496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12497
 12498
 12499
 12500* EXEC CICS DELETE
 12501*        DATASET (TRLR-FILE-ID)
 12502*    END-EXEC.
 12503*    MOVE '&(                    &   #00011094' TO DFHEIV0
 12504     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12505     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12506     MOVE X'2020233030303131303934' TO DFHEIV0(25:11)
 12507     CALL 'kxdfhei1' USING DFHEIV0,
 12508           TRLR-FILE-ID,
 12509           DFHEIV99,
 12510           DFHEIV99,
 12511           DFHEIV99,
 12512           DFHEIV99
 12513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12514
 12515
 12516     IF AT-SEQUENCE-NO = ZERO AND
 12517        TRLR-UPDATE-REQUIRED
 12518         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 12519
 12520     IF CERTI GREATER THAN LOW-VALUES
 12521        MOVE CERTI               TO AT-CERT-PRIME.
 12522
 12523     IF SUFXI GREATER THAN LOW-VALUES
 12524        MOVE SUFXI               TO AT-CERT-SFX.
 12525
 12526     IF CERTCARI GREATER THAN LOW-VALUES
 12527        MOVE CERTCARI            TO AT-CARRIER.
 12528
 12529     IF PAYMENT-TR
 12530        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 12531           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 12532              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 12533
 12534     IF CORRESPONDENCE-TR
 12535        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 12536           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 232
* EL131.cbl
 12537
 12538
 12539* EXEC CICS WRITE
 12540*         DATASET  (TRLR-FILE-ID)
 12541*         RIDFLD   (AT-CONTROL-PRIMARY)
 12542*         FROM     (ACTIVITY-TRAILERS)
 12543*    END-EXEC.
 12544     MOVE LENGTH OF
 12545      ACTIVITY-TRAILERS
 12546       TO DFHEIV11
 12547*    MOVE '&$ L                  ''   #00011120' TO DFHEIV0
 12548     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12549     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12550     MOVE X'2020233030303131313230' TO DFHEIV0(25:11)
 12551     CALL 'kxdfhei1' USING DFHEIV0,
 12552           TRLR-FILE-ID,
 12553           ACTIVITY-TRAILERS,
 12554           DFHEIV11,
 12555           AT-CONTROL-PRIMARY,
 12556           DFHEIV99,
 12557           DFHEIV99
 12558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12559
 12560
 12561
 12562* EXEC CICS STARTBR
 12563*         DATASET  (TRLR-FILE-ID)
 12564*         RIDFLD   (TRLR-KEY)
 12565*    END-EXEC.
 12566     MOVE 0
 12567       TO DFHEIV11
 12568*    MOVE '&,         G          &   #00011126' TO DFHEIV0
 12569     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12570     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12571     MOVE X'2020233030303131313236' TO DFHEIV0(25:11)
 12572     CALL 'kxdfhei1' USING DFHEIV0,
 12573           TRLR-FILE-ID,
 12574           TRLR-KEY,
 12575           DFHEIV99,
 12576           DFHEIV11,
 12577           DFHEIV99
 12578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12579
 12580
 12581     GO TO 2410-CHANGE-TRLR.
 12582
 12583 2410-EXIT.
 12584     EXIT.
 12585
 12586 2420-UPDATE-TRLR.
 12587     MOVE ZERO TO COUNT-2.
 12588     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 12589         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 12590
 12591     IF NOT UPDATE-MADE
 12592         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 12593
 12594 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 233
* EL131.cbl
 12595     EXIT.
 12596
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 234
* EL131.cbl
 12598 2425-UPDATE-NINETY-TRLR.
 12599
 12600     MOVE +90                    TO TRLR-SEQ-NO.
 12601
 12602
 12603* EXEC CICS HANDLE CONDITION
 12604*         NOTFND    (2425-NINETY-NOTFND)
 12605*         ENDFILE   (2425-NINETY-NOTFND)
 12606*    END-EXEC.
 12607*    MOVE '"$I''                  ! 6 #00011152' TO DFHEIV0
 12608     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12609     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12610     MOVE X'3620233030303131313532' TO DFHEIV0(25:11)
 12611     CALL 'kxdfhei1' USING DFHEIV0
 12612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12613
 12614
 12615
 12616* EXEC CICS READ UPDATE
 12617*        DATASET (TRLR-FILE-ID)
 12618*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12619*        RIDFLD  (TRLR-KEY)
 12620*    END-EXEC.
 12621*    MOVE '&"S        EU         (   #00011157' TO DFHEIV0
 12622     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12623     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12624     MOVE X'2020233030303131313537' TO DFHEIV0(25:11)
 12625     CALL 'kxdfhei1' USING DFHEIV0,
 12626           TRLR-FILE-ID,
 12627           DFHEIV20,
 12628           DFHEIV99,
 12629           TRLR-KEY,
 12630           DFHEIV99,
 12631           DFHEIV99,
 12632           DFHEIV99
 12633     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12634         DFHEIV20
 12635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12636
 12637     if (diagi > low-values)
 12638        and (diagi not = at-info-line-1)
 12639        and (cl-total-paid-amt > zeros)
 12640        move cl-cert-eff-dt      to dc-bin-date-1
 12641        move cl-paid-thru-dt     to dc-bin-date-2
 12642        move '1'                 to dc-option-code
 12643        perform 9800-convert-date
 12644                                 thru 9800-exit
 12645        if no-conversion-error
 12646           and dc-elapsed-months < +24
 12647           and (not emi-bypass-forcables)
 12648           move er-1581          to emi-error
 12649           perform 9900-error-format
 12650                                thru 9900-exit
 12651           move -1              to diagl
 12652           go to 8110-send-data
 12653        end-if
 12654     end-if
 12655     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 235
* EL131.cbl
 12656     MOVE AT-ICD-CODE-1         TO WS-ICD-CODE-1.
 12657     MOVE AT-ICD-CODE-2         TO WS-ICD-CODE-2.
 12658
 12659     IF DIAGI GREATER THAN LOW-VALUES
 12660         MOVE DIAGI             TO AT-INFO-LINE-1
 12661     END-IF.
 12662
 12663     IF ICD1I GREATER THAN LOW-VALUES
 12664         MOVE ICD1I             TO AT-ICD-CODE-1
 12665     END-IF.
 12666
 12667     IF ICD2I GREATER THAN LOW-VALUES
 12668         MOVE ICD2I             TO AT-ICD-CODE-2
 12669     END-IF.
 12670
 12671
 12672* EXEC CICS REWRITE
 12673*        DATASET (TRLR-FILE-ID)
 12674*        FROM    (ACTIVITY-TRAILERS)
 12675*    END-EXEC.
 12676     MOVE LENGTH OF
 12677      ACTIVITY-TRAILERS
 12678       TO DFHEIV11
 12679*    MOVE '&& L                  %   #00011196' TO DFHEIV0
 12680     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12681     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12682     MOVE X'2020233030303131313936' TO DFHEIV0(25:11)
 12683     CALL 'kxdfhei1' USING DFHEIV0,
 12684           TRLR-FILE-ID,
 12685           ACTIVITY-TRAILERS,
 12686           DFHEIV11,
 12687           DFHEIV99
 12688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12689
 12690
 12691     IF DIAGI GREATER THAN LOW-VALUES
 12692       AND DIAGI NOT = WS-DIAGNOSIS
 12693         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 12694         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 12695         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12696
 12697     IF ICD1I GREATER THAN LOW-VALUES
 12698       AND ICD1I NOT = WS-ICD-CODE-1
 12699         MOVE 'ICD CODE 1'         TO SPLIT-INFO-DESC
 12700         MOVE WS-ICD-CODE-1        TO SPLIT-INFO-OLD
 12701         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12702     END-IF.
 12703
 12704     IF ICD2I GREATER THAN LOW-VALUES
 12705       AND ICD2I NOT = WS-ICD-CODE-2
 12706         MOVE 'ICD CODE 2'         TO SPLIT-INFO-DESC
 12707         MOVE WS-ICD-CODE-2        TO SPLIT-INFO-OLD
 12708         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT
 12709     END-IF.
 12710
 12711     GO TO 2425-EXIT.
 12712
 12713 2425-NINETY-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 236
* EL131.cbl
 12714
 12715
 12716* EXEC CICS GETMAIN
 12717*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12718*         LENGTH    (TRLR-LENGTH)
 12719*         INITIMG   (GETMAIN-SPACE)
 12720*    END-EXEC.
 12721*    MOVE ',"IL                  $   #00011225' TO DFHEIV0
 12722     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12723     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12724     MOVE X'2020233030303131323235' TO DFHEIV0(25:11)
 12725     CALL 'kxdfhei1' USING DFHEIV0,
 12726           DFHEIV20,
 12727           TRLR-LENGTH,
 12728           GETMAIN-SPACE
 12729     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12730         DFHEIV20
 12731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12732
 12733
 12734     MOVE +90                  TO TRLR-SEQ-NO.
 12735     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 12736
 12737     MOVE 'AT'                 TO AT-RECORD-ID
 12738     MOVE '6'                  TO AT-TRAILER-TYPE
 12739     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 12740                                  AT-GEN-INFO-LAST-MAINT-DT
 12741     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 12742                                  AT-GEN-INFO-LAST-UPDATED-BY
 12743     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 12744     MOVE DIAGI                TO AT-INFO-LINE-1.
 12745     MOVE ICD1I                TO AT-ICD-CODE-1.
 12746     MOVE ICD2I                TO AT-ICD-CODE-2.
 12747
 12748
 12749* EXEC CICS WRITE
 12750*        DATASET (TRLR-FILE-ID)
 12751*        FROM    (ACTIVITY-TRAILERS)
 12752*        RIDFLD  (TRLR-KEY)
 12753*    END-EXEC.
 12754     MOVE LENGTH OF
 12755      ACTIVITY-TRAILERS
 12756       TO DFHEIV11
 12757*    MOVE '&$ L                  ''   #00011245' TO DFHEIV0
 12758     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12759     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12760     MOVE X'2020233030303131323435' TO DFHEIV0(25:11)
 12761     CALL 'kxdfhei1' USING DFHEIV0,
 12762           TRLR-FILE-ID,
 12763           ACTIVITY-TRAILERS,
 12764           DFHEIV11,
 12765           TRLR-KEY,
 12766           DFHEIV99,
 12767           DFHEIV99
 12768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12769
 12770
 12771 2425-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 237
* EL131.cbl
 12772     EXIT.
 12773
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 238
* EL131.cbl
 12775 2430-UPDATE-ACTQ.
 12776
 12777* EXEC CICS HANDLE CONDITION
 12778*         NOTFND    (2430-EXIT)
 12779*         ENDFILE   (2440-EXIT)
 12780*    END-EXEC.
 12781*    MOVE '"$I''                  ! 7 #00011256' TO DFHEIV0
 12782     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12783     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12784     MOVE X'3720233030303131323536' TO DFHEIV0(25:11)
 12785     CALL 'kxdfhei1' USING DFHEIV0
 12786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12787
 12788
 12789
 12790* EXEC CICS STARTBR
 12791*         DATASET  (ACTQ-FILE-ID)
 12792*         RIDFLD   (ACTQ-KEY)
 12793*    END-EXEC.
 12794     MOVE 0
 12795       TO DFHEIV11
 12796*    MOVE '&,         G          &   #00011261' TO DFHEIV0
 12797     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12798     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12799     MOVE X'2020233030303131323631' TO DFHEIV0(25:11)
 12800     CALL 'kxdfhei1' USING DFHEIV0,
 12801           ACTQ-FILE-ID,
 12802           ACTQ-KEY,
 12803           DFHEIV99,
 12804           DFHEIV11,
 12805           DFHEIV99
 12806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12807
 12808
 12809
 12810* EXEC CICS GETMAIN
 12811*         SET      (ADDRESS OF ACTIVITY-QUE)
 12812*         LENGTH   (ACTQ-LENGTH)
 12813*         INITIMG  (GETMAIN-SPACE)
 12814*    END-EXEC.
 12815*    MOVE ',"IL                  $   #00011266' TO DFHEIV0
 12816     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12817     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12818     MOVE X'2020233030303131323636' TO DFHEIV0(25:11)
 12819     CALL 'kxdfhei1' USING DFHEIV0,
 12820           DFHEIV20,
 12821           ACTQ-LENGTH,
 12822           GETMAIN-SPACE
 12823     SET ADDRESS OF ACTIVITY-QUE TO
 12824         DFHEIV20
 12825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12826
 12827
 12828     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 12829
 12830 2430-EXIT.
 12831     EXIT.
 12832
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 239
* EL131.cbl
 12833 2440-CHANGE-ACTQ.
 12834
 12835
 12836* EXEC CICS READNEXT
 12837*         DATASET  (ACTQ-FILE-ID)
 12838*         RIDFLD   (ACTQ-KEY)
 12839*         INTO     (ACTIVITY-QUE)
 12840*    END-EXEC.
 12841     MOVE LENGTH OF
 12842      ACTIVITY-QUE
 12843       TO DFHEIV12
 12844     MOVE 0
 12845       TO DFHEIV11
 12846*    MOVE '&.IL                  )   #00011279' TO DFHEIV0
 12847     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12848     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12849     MOVE X'2020233030303131323739' TO DFHEIV0(25:11)
 12850     CALL 'kxdfhei1' USING DFHEIV0,
 12851           ACTQ-FILE-ID,
 12852           ACTIVITY-QUE,
 12853           DFHEIV12,
 12854           ACTQ-KEY,
 12855           DFHEIV99,
 12856           DFHEIV11,
 12857           DFHEIV99,
 12858           DFHEIV99
 12859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12860
 12861
 12862
 12863* EXEC CICS ENDBR
 12864*         DATASET (ACTQ-FILE-ID)
 12865*    END-EXEC.
 12866     MOVE 0
 12867       TO DFHEIV11
 12868*    MOVE '&2                    $   #00011285' TO DFHEIV0
 12869     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12870     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12871     MOVE X'2020233030303131323835' TO DFHEIV0(25:11)
 12872     CALL 'kxdfhei1' USING DFHEIV0,
 12873           ACTQ-FILE-ID,
 12874           DFHEIV11,
 12875           DFHEIV99
 12876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12877
 12878
 12879     IF ACTQ-KEY NOT = MSTR-KEY
 12880         GO TO 2440-EXIT.
 12881
 12882
 12883* EXEC CICS READ UPDATE
 12884*         DATASET  (ACTQ-FILE-ID)
 12885*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12886*         SET      (ADDRESS OF ACTIVITY-QUE)
 12887*    END-EXEC.
 12888*    MOVE '&"S        EU         (   #00011292' TO DFHEIV0
 12889     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12890     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 240
* EL131.cbl
 12891     MOVE X'2020233030303131323932' TO DFHEIV0(25:11)
 12892     CALL 'kxdfhei1' USING DFHEIV0,
 12893           ACTQ-FILE-ID,
 12894           DFHEIV20,
 12895           DFHEIV99,
 12896           AQ-CONTROL-PRIMARY,
 12897           DFHEIV99,
 12898           DFHEIV99,
 12899           DFHEIV99
 12900     SET ADDRESS OF ACTIVITY-QUE TO
 12901         DFHEIV20
 12902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12903
 12904
 12905     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 12906
 12907
 12908* EXEC CICS DELETE
 12909*         DATASET (ACTQ-FILE-ID)
 12910*    END-EXEC.
 12911*    MOVE '&(                    &   #00011300' TO DFHEIV0
 12912     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12913     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12914     MOVE X'2020233030303131333030' TO DFHEIV0(25:11)
 12915     CALL 'kxdfhei1' USING DFHEIV0,
 12916           ACTQ-FILE-ID,
 12917           DFHEIV99,
 12918           DFHEIV99,
 12919           DFHEIV99,
 12920           DFHEIV99
 12921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12922
 12923
 12924     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 12925     IF CERTI GREATER THAN LOW-VALUES
 12926        MOVE CERTI               TO AQ-CERT-PRIME.
 12927     IF SUFXI GREATER THAN LOW-VALUES
 12928        MOVE SUFXI               TO AQ-CERT-SFX.
 12929     IF CERTCARI GREATER THAN LOW-VALUES
 12930        MOVE CERTCARI            TO AQ-CARRIER.
 12931
 12932
 12933* EXEC CICS HANDLE CONDITION
 12934*         DUPREC   (2440-EXIT)
 12935*    END-EXEC.
 12936*    MOVE '"$%                   ! 8 #00011312' TO DFHEIV0
 12937     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12938     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12939     MOVE X'3820233030303131333132' TO DFHEIV0(25:11)
 12940     CALL 'kxdfhei1' USING DFHEIV0
 12941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12942
 12943
 12944
 12945* EXEC CICS WRITE
 12946*         DATASET  (ACTQ-FILE-ID)
 12947*         RIDFLD   (AQ-CONTROL-PRIMARY)
 12948*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 241
* EL131.cbl
 12949*    END-EXEC.
 12950     MOVE LENGTH OF
 12951      ACTIVITY-QUE
 12952       TO DFHEIV11
 12953*    MOVE '&$ L                  ''   #00011316' TO DFHEIV0
 12954     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12955     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12956     MOVE X'2020233030303131333136' TO DFHEIV0(25:11)
 12957     CALL 'kxdfhei1' USING DFHEIV0,
 12958           ACTQ-FILE-ID,
 12959           ACTIVITY-QUE,
 12960           DFHEIV11,
 12961           AQ-CONTROL-PRIMARY,
 12962           DFHEIV99,
 12963           DFHEIV99
 12964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12965
 12966
 12967 2440-EXIT.
 12968     EXIT.
 12969
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 242
* EL131.cbl
 12971 2460-UPDATE-CHECKQ.
 12972
 12973* EXEC CICS HANDLE CONDITION
 12974*         NOTFND   (2460-EXIT)
 12975*    END-EXEC.
 12976*    MOVE '"$I                   ! 9 #00011327' TO DFHEIV0
 12977     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12978     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12979     MOVE X'3920233030303131333237' TO DFHEIV0(25:11)
 12980     CALL 'kxdfhei1' USING DFHEIV0
 12981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12982
 12983
 12984     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 12985     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 12986     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 12987
 12988
 12989* EXEC CICS READ UPDATE
 12990*         DATASET   (CHKQ-FILE-ID)
 12991*         RIDFLD    (CHKQ-KEY)
 12992*         SET       (ADDRESS OF CHECK-QUE)
 12993*    END-EXEC.
 12994*    MOVE '&"S        EU         (   #00011335' TO DFHEIV0
 12995     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12996     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12997     MOVE X'2020233030303131333335' TO DFHEIV0(25:11)
 12998     CALL 'kxdfhei1' USING DFHEIV0,
 12999           CHKQ-FILE-ID,
 13000           DFHEIV20,
 13001           DFHEIV99,
 13002           CHKQ-KEY,
 13003           DFHEIV99,
 13004           DFHEIV99,
 13005           DFHEIV99
 13006     SET ADDRESS OF CHECK-QUE TO
 13007         DFHEIV20
 13008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13009
 13010
 13011     IF CERTI GREATER THAN LOW-VALUES
 13012        MOVE CERTI               TO CQ-CERT-PRIME.
 13013     IF SUFXI GREATER THAN LOW-VALUES
 13014        MOVE SUFXI               TO CQ-CERT-SFX.
 13015     IF CERTCARI GREATER THAN LOW-VALUES
 13016        MOVE CERTCARI            TO CQ-CARRIER.
 13017
 13018
 13019* EXEC CICS REWRITE
 13020*         DATASET  (CHKQ-FILE-ID)
 13021*         FROM     (CHECK-QUE)
 13022*    END-EXEC.
 13023     MOVE LENGTH OF
 13024      CHECK-QUE
 13025       TO DFHEIV11
 13026*    MOVE '&& L                  %   #00011348' TO DFHEIV0
 13027     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13028     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 243
* EL131.cbl
 13029     MOVE X'2020233030303131333438' TO DFHEIV0(25:11)
 13030     CALL 'kxdfhei1' USING DFHEIV0,
 13031           CHKQ-FILE-ID,
 13032           CHECK-QUE,
 13033           DFHEIV11,
 13034           DFHEIV99
 13035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13036
 13037
 13038 2460-EXIT.
 13039     EXIT.
 13040
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 244
* EL131.cbl
 13042 2475-UPDATE-LETTER.
 13043
 13044* EXEC CICS HANDLE CONDITION
 13045*         NOTFND   (2475-EXIT)
 13046*    END-EXEC.
 13047*    MOVE '"$I                   ! : #00011358' TO DFHEIV0
 13048     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13049     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13050     MOVE X'3A20233030303131333538' TO DFHEIV0(25:11)
 13051     CALL 'kxdfhei1' USING DFHEIV0
 13052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13053
 13054
 13055     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 13056     MOVE '1'                    TO ARCH-RECORD-TYPE.
 13057     MOVE ZEROS                  TO ARCH-SEQ-NO.
 13058     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 13059
 13060
 13061* EXEC CICS READ UPDATE
 13062*         DATASET   (ARCH-FILE-ID)
 13063*         RIDFLD    (ARCH-KEY)
 13064*         SET       (ADDRESS OF LETTER-ARCHIVE)
 13065*    END-EXEC.
 13066*    MOVE '&"S        EU         (   #00011367' TO DFHEIV0
 13067     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13068     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13069     MOVE X'2020233030303131333637' TO DFHEIV0(25:11)
 13070     CALL 'kxdfhei1' USING DFHEIV0,
 13071           ARCH-FILE-ID,
 13072           DFHEIV20,
 13073           DFHEIV99,
 13074           ARCH-KEY,
 13075           DFHEIV99,
 13076           DFHEIV99,
 13077           DFHEIV99
 13078     SET ADDRESS OF LETTER-ARCHIVE TO
 13079         DFHEIV20
 13080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13081
 13082
 13083* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 13084* TO THIS MASTER-KEY INFORMATION.
 13085
 13086     IF LA-CARRIER  = CARRIER-CODE AND
 13087        LA-CLAIM-NO = CLAIM-NO     AND
 13088        LA-CERT-NO  = CERT-NO
 13089        NEXT SENTENCE
 13090     ELSE
 13091        GO TO 2475-UNLOCK.
 13092
 13093     IF CERTI GREATER THAN LOW-VALUES
 13094        MOVE CERTI               TO LA-CERT-PRIME.
 13095     IF SUFXI GREATER THAN LOW-VALUES
 13096        MOVE SUFXI               TO LA-CERT-SFX.
 13097     IF CERTCARI GREATER THAN LOW-VALUES
 13098        MOVE CERTCARI            TO LA-CARRIER.
 13099
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 245
* EL131.cbl
 13100
 13101* EXEC CICS REWRITE
 13102*         DATASET  (ARCH-FILE-ID)
 13103*         FROM     (LETTER-ARCHIVE)
 13104*    END-EXEC.
 13105     MOVE LENGTH OF
 13106      LETTER-ARCHIVE
 13107       TO DFHEIV11
 13108*    MOVE '&& L                  %   #00011390' TO DFHEIV0
 13109     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13110     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13111     MOVE X'2020233030303131333930' TO DFHEIV0(25:11)
 13112     CALL 'kxdfhei1' USING DFHEIV0,
 13113           ARCH-FILE-ID,
 13114           LETTER-ARCHIVE,
 13115           DFHEIV11,
 13116           DFHEIV99
 13117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13118
 13119
 13120     GO TO 2475-EXIT.
 13121
 13122 2475-UNLOCK.
 13123
 13124* EXEC CICS UNLOCK
 13125*         DATASET  (ARCH-FILE-ID)
 13126*    END-EXEC.
 13127*    MOVE '&*                    #   #00011398' TO DFHEIV0
 13128     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13129     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13130     MOVE X'2020233030303131333938' TO DFHEIV0(25:11)
 13131     CALL 'kxdfhei1' USING DFHEIV0,
 13132           ARCH-FILE-ID,
 13133           DFHEIV99
 13134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13135
 13136
 13137 2475-EXIT.
 13138     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 246
* EL131.cbl
 13140 2600-CREATE-MAINT-NOTE.
 13141     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13142     MOVE '1'                    TO CNTL-REC-TYPE.
 13143     MOVE SPACES                 TO CNTL-PROC-ID.
 13144     MOVE ZERO                   TO CNTL-SEQ-NO.
 13145
 13146
 13147* EXEC CICS READ
 13148*         SET        (ADDRESS OF CONTROL-FILE)
 13149*         DATASET    ('ELCNTL')
 13150*         RIDFLD     (CNTL-KEY)
 13151*    END-EXEC.
 13152     MOVE 'ELCNTL' TO DFHEIV1
 13153*    MOVE '&"S        E          (   #00011411' TO DFHEIV0
 13154     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13156     MOVE X'2020233030303131343131' TO DFHEIV0(25:11)
 13157     CALL 'kxdfhei1' USING DFHEIV0,
 13158           DFHEIV1,
 13159           DFHEIV20,
 13160           DFHEIV99,
 13161           CNTL-KEY,
 13162           DFHEIV99,
 13163           DFHEIV99,
 13164           DFHEIV99
 13165     SET ADDRESS OF CONTROL-FILE TO
 13166         DFHEIV20
 13167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13168
 13169
 13170     IF CO-NO-USE-AUDIT-CHANGES
 13171         GO TO 2600-EXIT.
 13172
 13173     IF PROCL GREATER ZERO
 13174     IF PROCI NOT = LOW-VALUES
 13175     IF PROCI NOT = CL-PROCESSOR-ID
 13176         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 13177         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 13178         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13179
 13180     IF SEXL GREATER ZERO
 13181     IF SEXI NOT = LOW-VALUES
 13182     IF SEXI NOT = CL-INSURED-SEX-CD
 13183         MOVE 'SEX'                TO SPLIT-INFO-DESC
 13184         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 13185         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13186
 13187     IF BIRTHL GREATER ZERO
 13188     IF HOLD-BIRTH NOT = LOW-VALUES
 13189     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 13190         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 13191         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 13192         MOVE SPACES               TO DC-OPTION-CODE
 13193         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13194         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13195         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13196
 13197     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 247
* EL131.cbl
 13198     IF SOCIALI NOT = LOW-VALUES
 13199     IF SOCIALI NOT = CL-SOC-SEC-NO
 13200         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 13201         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 13202         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13203
 13204     IF OCCL GREATER ZERO
 13205     IF OCCI NOT = LOW-VALUES
 13206     IF OCCI NOT = CL-INSURED-OCC-CD
 13207         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 13208         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 13209         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13210
 13211     IF BENEL GREATER ZERO
 13212     IF BENEI NOT = LOW-VALUES
 13213     IF BENEI NOT = CL-BENEFICIARY
 13214         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 13215         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 13216         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13217
 13218     IF PREMTYPL GREATER ZERO
 13219     IF PREMTYPI NOT = LOW-VALUES
 13220     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 13221         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 13222         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 13223         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13224
 13225*    IF CAUSEL GREATER ZERO
 13226*    IF CAUSEI NOT = LOW-VALUES
 13227*    IF CAUSEI NOT = CL-CAUSE-CD
 13228*        MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 13229*        MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 13230*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13231
 13232*    IF ENDL GREATER ZERO
 13233*    IF HOLD-END NOT = LOW-VALUES
 13234*    IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 13235*        MOVE 'END DT'             TO SPLIT-INFO-DESC
 13236*        MOVE CL-EST-END-OF-DISAB-DT
 13237*                                  TO DC-BIN-DATE-1
 13238*        MOVE SPACES               TO DC-OPTION-CODE
 13239*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13240*        MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13241*        PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13242
 13243     IF PDTHRUL GREATER ZERO
 13244     IF HOLD-PDTHRU NOT = LOW-VALUES
 13245     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 13246         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 13247         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 13248         MOVE SPACES               TO DC-OPTION-CODE
 13249         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13250         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13251         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13252
 13253     IF PDAMTL GREATER ZERO
 13254     IF HOLD-PDAMT NOT = ZEROS
 13255     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 248
* EL131.cbl
 13256         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 13257         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 13258         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 13259         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13260
 13261     IF NODAYSL GREATER ZERO
 13262     IF HOLD-NODAYS NOT = ZEROS
 13263     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 13264         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 13265         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 13266         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13267         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13268
 13269     IF NOPMTSL GREATER ZERO
 13270     IF HOLD-NOPMTS NOT = ZEROS
 13271     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 13272         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 13273         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 13274         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 13275         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13276
 13277     IF FORMTYPL GREATER ZERO
 13278     IF FORMTYPI NOT = LOW-VALUES
 13279     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 13280         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 13281         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 13282         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13283
 13284     IF REPL GREATER ZERO
 13285     IF HOLD-REPORTED NOT = LOW-VALUES
 13286     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 13287         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 13288         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 13289         MOVE SPACES               TO DC-OPTION-CODE
 13290         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13291         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13292         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13293
 13294     IF ADDONDTL GREATER ZERO
 13295     IF HOLD-ADDON NOT = LOW-VALUES
 13296     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 13297         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 13298         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 13299         MOVE SPACES               TO DC-OPTION-CODE
 13300         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13301         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13302         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13303
 13304     IF PRICDL GREATER ZERO
 13305     IF PRICDI NOT = LOW-VALUES
 13306     IF PRICDI NOT = CL-PRIORITY-CD
 13307         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 13308         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 13309         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13310
 13311     IF FILETOL GREATER ZERO
 13312     IF FILETOI NOT = LOW-VALUES
 13313     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 249
* EL131.cbl
 13314         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 13315         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 13316         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13317
 13318     IF SUPVL GREATER ZERO
 13319     IF SUPVI NOT = LOW-VALUES
 13320     IF SUPVI NOT = CL-SUPV-ATTN-CD
 13321         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 13322         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 13323         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13324*    IF (CRITPTL > ZERO)
 13325*       AND (CRITPTI NOT = LOW-VALUES)
 13326*       AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 13327*       MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 13328*       MOVE CL-CRIT-PER-RECURRENT
 13329*                                TO SPLIT-INFO-OLD
 13330*       PERFORM 2650-WRITE-MAINT-NOTE
 13331*                                THRU 2650-EXIT
 13332*    END-IF
 13333
 13334*    IF (RTWMOSL > ZERO)
 13335*       AND (RTWMOSI NOT = LOW-VALUES)
 13336*       AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 13337*       MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 13338*       MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 13339*       PERFORM 2650-WRITE-MAINT-NOTE
 13340*                                THRU 2650-EXIT
 13341*    END-IF
 13342     IF MLNAMEL GREATER ZERO
 13343     IF MLNAMEI NOT = LOW-VALUES
 13344     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 13345         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 13346         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 13347         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13348
 13349     IF MFNAMEL GREATER ZERO
 13350     IF MFNAMEI NOT = LOW-VALUES
 13351     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 13352         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 13353         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 13354         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13355
 13356     IF MMINITL GREATER ZERO
 13357     IF MMINITI NOT = LOW-VALUES
 13358     IF MMINITI NOT = CL-INSURED-MID-INIT
 13359         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 13360         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 13361         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13362
 13363     IF CERTEFFL GREATER ZERO
 13364     IF HOLD-EFF NOT = LOW-VALUES
 13365     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 13366         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 13367         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 13368         MOVE SPACES               TO DC-OPTION-CODE
 13369         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13370         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 13371         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 250
* EL131.cbl
 13372
 13373     IF CERTACTL GREATER ZERO
 13374     IF CERTACTI NOT = LOW-VALUES
 13375     IF CERTACTI NOT = CL-CERT-ACCOUNT
 13376         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 13377         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 13378         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13379
 13380     IF CERTSTL GREATER ZERO
 13381     IF CERTSTI NOT = LOW-VALUES
 13382     IF CERTSTI NOT = CL-CERT-STATE
 13383         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 13384         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 13385         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13386
 13387     IF CERTCARL GREATER ZERO
 13388     IF CERTCARI NOT = LOW-VALUES
 13389     IF CERTCARI NOT = CL-CERT-CARRIER
 13390         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 13391         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 13392         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13393
 13394     IF CERTGRPL GREATER ZERO
 13395     IF CERTGRPI NOT = LOW-VALUES
 13396     IF CERTGRPI NOT = CL-CERT-GROUPING
 13397         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 13398         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 13399         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13400
 13401     IF CERTL GREATER ZERO OR
 13402        SUFXL GREATER ZERO
 13403     IF (CERTI NOT = LOW-VALUES AND
 13404                     CL-CERT-PRIME)
 13405                OR
 13406        (SUFXI NOT = LOW-VALUES AND
 13407                     CL-CERT-SFX)
 13408         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 13409         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 13410         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 13411     IF incl > zeros
 13412        IF (HOLD-INCUR NOT = LOW-VALUES)
 13413           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13414           MOVE 'INC DTE'        TO SPLIT-INFO-DESC
 13415           MOVE CL-INCURRED-DT   TO DC-BIN-DATE-1
 13416           MOVE SPACES           TO DC-OPTION-CODE
 13417           PERFORM 9800-CONVERT-DATE
 13418                                 THRU 9800-EXIT
 13419           MOVE DC-GREG-DATE-1-EDIT
 13420                                 TO SPLIT-INFO-OLD
 13421           PERFORM 2650-WRITE-MAINT-NOTE
 13422                                 THRU 2650-EXIT
 13423        END-IF
 13424     END-IF
 13425     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 13426       IF (REPL GREATER ZERO
 13427         AND HOLD-REPORTED NOT = LOW-VALUES
 13428         AND HOLD-REPORTED NOT = CL-REPORTED-DT)
 13429        OR (incl > zeros
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 251
* EL131.cbl
 13430          AND (HOLD-INCUR NOT = LOW-VALUES)
 13431             AND (HOLD-INCUR NOT = CL-INCURRED-DT))
 13432          PERFORM 2610-CHECK-2-YEAR-CONTESTABLE THRU 2610-EXIT
 13433       END-IF
 13434     END-IF
 13435     IF incl > zeros
 13436       AND PI-COMPANY-ID = 'CID'
 13437        IF (HOLD-INCUR NOT = LOW-VALUES)
 13438           AND (HOLD-INCUR NOT = CL-INCURRED-DT)
 13439           IF TYPEI = PI-AH-OVERRIDE-L1
 13440              SET ELAPSED-BETWEEN-BIN TO TRUE
 13441              MOVE ZERO               TO DC-ELAPSED-MONTHS
 13442                                         DC-ELAPSED-DAYS
 13443
 13444              MOVE HOLD-INCUR  TO DC-BIN-DATE-1
 13445              MOVE SAVE-BIN-DATE TO DC-BIN-DATE-2
 13446              PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13447              IF DC-ODD-DAYS-OVER > ZERO
 13448                 ADD 1 TO DC-ELAPSED-MONTHS
 13449              END-IF
 13450
 13451              IF PI-STATE = 'HI'
 13452                AND DC-ELAPSED-MONTHS <= 18
 13453                 CONTINUE
 13454              ELSE
 13455                 IF DC-ELAPSED-MONTHS > 15
 13456                    MOVE ER-7572            TO EMI-ERROR
 13457                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13458                 END-IF
 13459              END-IF
 13460              PERFORM 2620-CHECK-TRLR THRU 2620-EXIT
 13461           END-IF
 13462        END-IF
 13463     END-IF
 13464     .
 13465 2600-EXIT.
 13466      EXIT.
 13467 2610-CHECK-2-YEAR-CONTESTABLE.
 13468     SET ELAPSED-BETWEEN-BIN TO TRUE
 13469     MOVE ZERO               TO DC-ELAPSED-MONTHS
 13470                                DC-ELAPSED-DAYS
 13471
 13472     MOVE HOLD-EFF TO DC-BIN-DATE-1.
 13473     IF HOLD-INCUR > SPACES
 13474        MOVE HOLD-INCUR TO DC-BIN-DATE-2
 13475     ELSE
 13476        MOVE CL-INCURRED-DT TO DC-BIN-DATE-2
 13477     END-IF
 13478     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 13479     IF DC-ODD-DAYS-OVER > ZERO
 13480        ADD 1 TO DC-ELAPSED-MONTHS
 13481     END-IF
 13482
 13483     IF DC-ELAPSED-MONTHS <= 24
 13484        IF HOLD-REPORTED > SPACES
 13485           MOVE HOLD-REPORTED TO DC-BIN-DATE-2
 13486        ELSE
 13487           MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 252
* EL131.cbl
 13488        END-IF
 13489        MOVE ZERO           TO DC-ELAPSED-MONTHS
 13490                               DC-ELAPSED-DAYS
 13491        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13492        IF DC-ODD-DAYS-OVER > ZERO
 13493           ADD 1 TO DC-ELAPSED-MONTHS
 13494        END-IF
 13495        IF DC-ELAPSED-MONTHS > 24
 13496           MOVE ER-1679            TO EMI-ERROR
 13497           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13498        ELSE
 13499           MOVE 1                  TO EMI-ERROR
 13500        END-IF
 13501     END-IF.
 13502
 13503     PERFORM 2615-CHECK-TRLR THRU 2615-EXIT.
 13504
 13505 2610-EXIT.
 13506     EXIT.
 13507 2615-CHECK-TRLR.
 13508
 13509     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13510     MOVE +96              TO TRLR-SEQ-NO
 13511
 13512* EXEC CICS READ
 13513*       UPDATE
 13514*       DATASET  ('ELTRLR')
 13515*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13516*       RIDFLD   (TRLR-KEY)
 13517*       RESP     (WS-RESPONSE)
 13518*    END-EXEC
 13519     MOVE 'ELTRLR' TO DFHEIV1
 13520*    MOVE '&"S        EU         (  N#00011758' TO DFHEIV0
 13521     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13522     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13523     MOVE X'204E233030303131373538' TO DFHEIV0(25:11)
 13524     CALL 'kxdfhei1' USING DFHEIV0,
 13525           DFHEIV1,
 13526           DFHEIV20,
 13527           DFHEIV99,
 13528           TRLR-KEY,
 13529           DFHEIV99,
 13530           DFHEIV99,
 13531           DFHEIV99
 13532     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13533         DFHEIV20
 13534     MOVE EIBRESP  TO WS-RESPONSE
 13535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13536     IF WS-RESP-NORMAL
 13537        IF EMI-ERROR =  ER-1679
 13538           IF EMI-ERROR-NUMBER(1) = ER-1679
 13539              MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13540           ELSE
 13541           IF EMI-ERROR-NUMBER(2) = ER-1679
 13542              MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13543           ELSE
 13544           IF EMI-ERROR-NUMBER(3) = ER-1679
 13545              MOVE EMI-LINE3 TO AT-INFO-LINE-1
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 253
* EL131.cbl
 13546           END-IF
 13547           END-IF
 13548           END-IF
 13549
 13550* EXEC CICS REWRITE
 13551*             DATASET   ('ELTRLR')
 13552*             FROM      (ACTIVITY-TRAILERS)
 13553*          END-EXEC
 13554     MOVE LENGTH OF
 13555      ACTIVITY-TRAILERS
 13556       TO DFHEIV11
 13557     MOVE 'ELTRLR' TO DFHEIV1
 13558*    MOVE '&& L                  %   #00011778' TO DFHEIV0
 13559     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13560     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13561     MOVE X'2020233030303131373738' TO DFHEIV0(25:11)
 13562     CALL 'kxdfhei1' USING DFHEIV0,
 13563           DFHEIV1,
 13564           ACTIVITY-TRAILERS,
 13565           DFHEIV11,
 13566           DFHEIV99
 13567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13568        ELSE
 13569           IF EMI-ERROR = 1
 13570              MOVE WS-CONTEST-NOTE TO AT-INFO-LINE-1
 13571              MOVE ZERO TO EMI-ERROR
 13572
 13573* EXEC CICS REWRITE
 13574*                DATASET   ('ELTRLR')
 13575*                FROM      (ACTIVITY-TRAILERS)
 13576*             END-EXEC
 13577     MOVE LENGTH OF
 13578      ACTIVITY-TRAILERS
 13579       TO DFHEIV11
 13580     MOVE 'ELTRLR' TO DFHEIV1
 13581*    MOVE '&& L                  %   #00011786' TO DFHEIV0
 13582     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13583     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13584     MOVE X'2020233030303131373836' TO DFHEIV0(25:11)
 13585     CALL 'kxdfhei1' USING DFHEIV0,
 13586           DFHEIV1,
 13587           ACTIVITY-TRAILERS,
 13588           DFHEIV11,
 13589           DFHEIV99
 13590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13591           ELSE
 13592
 13593* EXEC CICS DELETE
 13594*                DATASET   ('ELTRLR')
 13595*             END-EXEC
 13596     MOVE 'ELTRLR' TO DFHEIV1
 13597*    MOVE '&(                    &   #00011791' TO DFHEIV0
 13598     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13599     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13600     MOVE X'2020233030303131373931' TO DFHEIV0(25:11)
 13601     CALL 'kxdfhei1' USING DFHEIV0,
 13602           DFHEIV1,
 13603           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 254
* EL131.cbl
 13604           DFHEIV99,
 13605           DFHEIV99,
 13606           DFHEIV99
 13607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13608           END-IF
 13609        END-IF
 13610     ELSE
 13611     IF EMI-ERROR =  ER-1679
 13612
 13613* EXEC CICS GETMAIN
 13614*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13615*          LENGTH   (TRLR-LENGTH)
 13616*          INITIMG  (GETMAIN-SPACE)
 13617*       END-EXEC
 13618*    MOVE ',"IL                  $   #00011798' TO DFHEIV0
 13619     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13620     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13621     MOVE X'2020233030303131373938' TO DFHEIV0(25:11)
 13622     CALL 'kxdfhei1' USING DFHEIV0,
 13623           DFHEIV20,
 13624           TRLR-LENGTH,
 13625           GETMAIN-SPACE
 13626     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13627         DFHEIV20
 13628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13629        MOVE 'AT'          TO AT-RECORD-ID
 13630        MOVE CL-CONTROL-PRIMARY
 13631                           TO AT-CONTROL-PRIMARY
 13632        MOVE +96           TO AT-SEQUENCE-NO
 13633        MOVE '6'           TO AT-TRAILER-TYPE
 13634        MOVE SPACES             TO AT-GENERAL-INFO-TR
 13635        INITIALIZE AT-GENERAL-INFO-TR
 13636        IF EMI-ERROR-NUMBER(1) = ER-1679
 13637           MOVE EMI-LINE1 TO AT-INFO-LINE-1
 13638        ELSE
 13639        IF EMI-ERROR-NUMBER(2) = ER-1679
 13640           MOVE EMI-LINE2 TO AT-INFO-LINE-1
 13641        ELSE
 13642        IF EMI-ERROR-NUMBER(3) = ER-1679
 13643           MOVE EMI-LINE3 TO AT-INFO-LINE-1
 13644        END-IF
 13645        END-IF
 13646        END-IF
 13647        MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13648        MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13649                              AT-GEN-INFO-LAST-MAINT-DT
 13650        MOVE PI-PROCESSOR-ID
 13651                           TO AT-RECORDED-BY
 13652                              AT-GEN-INFO-LAST-UPDATED-BY
 13653        MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13654
 13655* EXEC CICS WRITE
 13656*          DATASET   ('ELTRLR')
 13657*          FROM      (ACTIVITY-TRAILERS)
 13658*          RIDFLD    (TRLR-KEY)
 13659*       END-EXEC
 13660     MOVE LENGTH OF
 13661      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 255
* EL131.cbl
 13662       TO DFHEIV11
 13663     MOVE 'ELTRLR' TO DFHEIV1
 13664*    MOVE '&$ L                  ''   #00011828' TO DFHEIV0
 13665     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13666     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13667     MOVE X'2020233030303131383238' TO DFHEIV0(25:11)
 13668     CALL 'kxdfhei1' USING DFHEIV0,
 13669           DFHEIV1,
 13670           ACTIVITY-TRAILERS,
 13671           DFHEIV11,
 13672           TRLR-KEY,
 13673           DFHEIV99,
 13674           DFHEIV99
 13675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13676     END-IF
 13677     END-IF
 13678     .
 13679 2615-EXIT.
 13680     EXIT.
 13681
 13682 2620-CHECK-TRLR.
 13683
 13684     MOVE CL-CONTROL-PRIMARY   TO TRLR-KEY
 13685     MOVE +97                  TO TRLR-SEQ-NO
 13686
 13687* EXEC CICS READ
 13688*       UPDATE
 13689*       DATASET  ('ELTRLR')
 13690*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13691*       RIDFLD   (TRLR-KEY)
 13692*       RESP     (WS-RESPONSE)
 13693*    END-EXEC
 13694     MOVE 'ELTRLR' TO DFHEIV1
 13695*    MOVE '&"S        EU         (  N#00011843' TO DFHEIV0
 13696     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13697     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13698     MOVE X'204E233030303131383433' TO DFHEIV0(25:11)
 13699     CALL 'kxdfhei1' USING DFHEIV0,
 13700           DFHEIV1,
 13701           DFHEIV20,
 13702           DFHEIV99,
 13703           TRLR-KEY,
 13704           DFHEIV99,
 13705           DFHEIV99,
 13706           DFHEIV99
 13707     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13708         DFHEIV20
 13709     MOVE EIBRESP  TO WS-RESPONSE
 13710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13711     IF WS-RESP-NORMAL
 13712        IF EMI-ERROR =  ER-7572
 13713           MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 13714
 13715* EXEC CICS REWRITE
 13716*             DATASET   ('ELTRLR')
 13717*             FROM      (ACTIVITY-TRAILERS)
 13718*          END-EXEC
 13719     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 256
* EL131.cbl
 13720      ACTIVITY-TRAILERS
 13721       TO DFHEIV11
 13722     MOVE 'ELTRLR' TO DFHEIV1
 13723*    MOVE '&& L                  %   #00011853' TO DFHEIV0
 13724     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13725     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13726     MOVE X'2020233030303131383533' TO DFHEIV0(25:11)
 13727     CALL 'kxdfhei1' USING DFHEIV0,
 13728           DFHEIV1,
 13729           ACTIVITY-TRAILERS,
 13730           DFHEIV11,
 13731           DFHEIV99
 13732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13733        ELSE
 13734           MOVE WS-FILE-LIM-NOTE TO AT-INFO-LINE-1
 13735
 13736* EXEC CICS REWRITE
 13737*                DATASET   ('ELTRLR')
 13738*                FROM      (ACTIVITY-TRAILERS)
 13739*             END-EXEC
 13740     MOVE LENGTH OF
 13741      ACTIVITY-TRAILERS
 13742       TO DFHEIV11
 13743     MOVE 'ELTRLR' TO DFHEIV1
 13744*    MOVE '&& L                  %   #00011859' TO DFHEIV0
 13745     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13746     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13747     MOVE X'2020233030303131383539' TO DFHEIV0(25:11)
 13748     CALL 'kxdfhei1' USING DFHEIV0,
 13749           DFHEIV1,
 13750           ACTIVITY-TRAILERS,
 13751           DFHEIV11,
 13752           DFHEIV99
 13753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13754        END-IF
 13755     ELSE
 13756        IF EMI-ERROR =  ER-7572
 13757
 13758* EXEC CICS GETMAIN
 13759*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13760*             LENGTH   (TRLR-LENGTH)
 13761*             INITIMG  (GETMAIN-SPACE)
 13762*          END-EXEC
 13763*    MOVE ',"IL                  $   #00011866' TO DFHEIV0
 13764     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13765     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13766     MOVE X'2020233030303131383636' TO DFHEIV0(25:11)
 13767     CALL 'kxdfhei1' USING DFHEIV0,
 13768           DFHEIV20,
 13769           TRLR-LENGTH,
 13770           GETMAIN-SPACE
 13771     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13772         DFHEIV20
 13773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13774           MOVE 'AT'          TO AT-RECORD-ID
 13775           MOVE CL-CONTROL-PRIMARY
 13776                              TO AT-CONTROL-PRIMARY
 13777           MOVE +97           TO AT-SEQUENCE-NO
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 257
* EL131.cbl
 13778           MOVE '6'           TO AT-TRAILER-TYPE
 13779           MOVE SPACES             TO AT-GENERAL-INFO-TR
 13780           INITIALIZE AT-GENERAL-INFO-TR
 13781           MOVE WS-FILING-NOTE TO AT-INFO-LINE-1
 13782           MOVE SPACE           TO AT-INFO-TRAILER-TYPE
 13783           MOVE SAVE-BIN-DATE TO AT-RECORDED-DT
 13784                                 AT-GEN-INFO-LAST-MAINT-DT
 13785           MOVE PI-PROCESSOR-ID
 13786                              TO AT-RECORDED-BY
 13787                                 AT-GEN-INFO-LAST-UPDATED-BY
 13788           MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
 13789
 13790* EXEC CICS WRITE
 13791*             DATASET   ('ELTRLR')
 13792*             FROM      (ACTIVITY-TRAILERS)
 13793*             RIDFLD    (TRLR-KEY)
 13794*          END-EXEC
 13795     MOVE LENGTH OF
 13796      ACTIVITY-TRAILERS
 13797       TO DFHEIV11
 13798     MOVE 'ELTRLR' TO DFHEIV1
 13799*    MOVE '&$ L                  ''   #00011886' TO DFHEIV0
 13800     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13801     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13802     MOVE X'2020233030303131383836' TO DFHEIV0(25:11)
 13803     CALL 'kxdfhei1' USING DFHEIV0,
 13804           DFHEIV1,
 13805           ACTIVITY-TRAILERS,
 13806           DFHEIV11,
 13807           TRLR-KEY,
 13808           DFHEIV99,
 13809           DFHEIV99
 13810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13811        END-IF
 13812     END-IF
 13813     .
 13814 2620-EXIT.
 13815     EXIT.
 13816
 13817 2650-WRITE-MAINT-NOTE.
 13818
 13819* EXEC CICS GETMAIN
 13820*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13821*         LENGTH   (TRLR-LENGTH)
 13822*         INITIMG  (GETMAIN-SPACE)
 13823*    END-EXEC.
 13824*    MOVE ',"IL                  $   #00011898' TO DFHEIV0
 13825     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13826     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13827     MOVE X'2020233030303131383938' TO DFHEIV0(25:11)
 13828     CALL 'kxdfhei1' USING DFHEIV0,
 13829           DFHEIV20,
 13830           TRLR-LENGTH,
 13831           GETMAIN-SPACE
 13832     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13833         DFHEIV20
 13834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13835
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 258
* EL131.cbl
 13836
 13837
 13838* EXEC CICS HANDLE CONDITION
 13839*         DUPREC   (2650-EXIT)
 13840*    END-EXEC.
 13841*    MOVE '"$%                   ! ; #00011904' TO DFHEIV0
 13842     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 13843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13844     MOVE X'3B20233030303131393034' TO DFHEIV0(25:11)
 13845     CALL 'kxdfhei1' USING DFHEIV0
 13846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13847
 13848
 13849     MOVE SPACES             TO ACTIVITY-TRAILERS.
 13850
 13851     IF CERTL GREATER ZERO
 13852         MOVE CERTI          TO CL-CERT-PRIME.
 13853
 13854     IF SUFXL GREATER ZERO
 13855         MOVE SUFXI          TO CL-CERT-SFX.
 13856
 13857     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 13858
 13859     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 13860     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 13861
 13862     MOVE 'AT'               TO AT-RECORD-ID.
 13863
 13864     MOVE '6'                TO AT-TRAILER-TYPE.
 13865     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 13866                                AT-GEN-INFO-LAST-MAINT-DT.
 13867     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 13868                                AT-GEN-INFO-LAST-UPDATED-BY.
 13869     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 13870     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 13871     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 13872
 13873
 13874* EXEC CICS WRITE
 13875*         DATASET  (TRLR-FILE-ID)
 13876*         RIDFLD   (AT-CONTROL-PRIMARY)
 13877*         FROM     (ACTIVITY-TRAILERS)
 13878*    END-EXEC.
 13879     MOVE LENGTH OF
 13880      ACTIVITY-TRAILERS
 13881       TO DFHEIV11
 13882*    MOVE '&$ L                  ''   #00011932' TO DFHEIV0
 13883     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13884     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13885     MOVE X'2020233030303131393332' TO DFHEIV0(25:11)
 13886     CALL 'kxdfhei1' USING DFHEIV0,
 13887           TRLR-FILE-ID,
 13888           ACTIVITY-TRAILERS,
 13889           DFHEIV11,
 13890           AT-CONTROL-PRIMARY,
 13891           DFHEIV99,
 13892           DFHEIV99
 13893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 259
* EL131.cbl
 13894
 13895
 13896 2650-EXIT.
 13897      EXIT.
 13898
 13899 2800-CHECK-AUTO-PAY.
 13900
 13901     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 13902     MOVE PI-CARRIER         TO TRLR-CARRIER.
 13903     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 13904     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 13905     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 13906
 13907
 13908* EXEC CICS HANDLE CONDITION
 13909*         NOTFND    (2800-EXIT)
 13910*         ENDFILE   (2800-EXIT)
 13911*    END-EXEC.
 13912*    MOVE '"$I''                  ! < #00011949' TO DFHEIV0
 13913     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13914     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13915     MOVE X'3C20233030303131393439' TO DFHEIV0(25:11)
 13916     CALL 'kxdfhei1' USING DFHEIV0
 13917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13918
 13919
 13920
 13921* EXEC CICS READ
 13922*        DATASET (TRLR-FILE-ID)
 13923*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 13924*        RIDFLD  (TRLR-KEY)
 13925*    END-EXEC.
 13926*    MOVE '&"S        E          (   #00011954' TO DFHEIV0
 13927     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13928     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13929     MOVE X'2020233030303131393534' TO DFHEIV0(25:11)
 13930     CALL 'kxdfhei1' USING DFHEIV0,
 13931           TRLR-FILE-ID,
 13932           DFHEIV20,
 13933           DFHEIV99,
 13934           TRLR-KEY,
 13935           DFHEIV99,
 13936           DFHEIV99,
 13937           DFHEIV99
 13938     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13939         DFHEIV20
 13940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13941
 13942
 13943     IF BENEFICIARY-PAID-AUTO
 13944         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 13945     END-IF.
 13946
 13947 2800-EXIT.
 13948      EXIT.
 13949
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 260
* EL131.cbl
 13951 3000-DELETE-CLAIM.
 13952     IF  NOT MODIFY-CAP
 13953         MOVE ER-0070            TO EMI-ERROR
 13954         MOVE -1                 TO MAINTL
 13955         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13956         GO TO 8110-SEND-DATA.
 13957
 13958
 13959* EXEC CICS READ
 13960*         SET      (ADDRESS OF CLAIM-MASTER)
 13961*         DATASET  (CLMS-FILE-ID)
 13962*         RIDFLD   (MSTR-KEY)
 13963*    END-EXEC.
 13964*    MOVE '&"S        E          (   #00011975' TO DFHEIV0
 13965     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13966     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13967     MOVE X'2020233030303131393735' TO DFHEIV0(25:11)
 13968     CALL 'kxdfhei1' USING DFHEIV0,
 13969           CLMS-FILE-ID,
 13970           DFHEIV20,
 13971           DFHEIV99,
 13972           MSTR-KEY,
 13973           DFHEIV99,
 13974           DFHEIV99,
 13975           DFHEIV99
 13976     SET ADDRESS OF CLAIM-MASTER TO
 13977         DFHEIV20
 13978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13979
 13980
 13981     IF CL-1ST-TRL-AVAIL
 13982         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 13983     ELSE
 13984        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 13985        MOVE 0                   TO TRLR-SEQ-NO
 13986
 13987* EXEC CICS STARTBR
 13988*            DATASET (TRLR-FILE-ID)
 13989*            RIDFLD  (TRLR-KEY)
 13990*        END-EXEC
 13991     MOVE 0
 13992       TO DFHEIV11
 13993*    MOVE '&,         G          &   #00011986' TO DFHEIV0
 13994     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13995     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13996     MOVE X'2020233030303131393836' TO DFHEIV0(25:11)
 13997     CALL 'kxdfhei1' USING DFHEIV0,
 13998           TRLR-FILE-ID,
 13999           TRLR-KEY,
 14000           DFHEIV99,
 14001           DFHEIV11,
 14002           DFHEIV99
 14003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14004         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 14005
 14006* EXEC CICS ENDBR
 14007*            DATASET (TRLR-FILE-ID)
 14008*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 261
* EL131.cbl
 14009     MOVE 0
 14010       TO DFHEIV11
 14011*    MOVE '&2                    $   #00011991' TO DFHEIV0
 14012     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14013     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14014     MOVE X'2020233030303131393931' TO DFHEIV0(25:11)
 14015     CALL 'kxdfhei1' USING DFHEIV0,
 14016           TRLR-FILE-ID,
 14017           DFHEIV11,
 14018           DFHEIV99
 14019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14020        IF SCREEN-ERROR
 14021            MOVE ER-0208         TO EMI-ERROR
 14022            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14023            MOVE -1              TO MAINTL
 14024            GO TO 8110-SEND-DATA
 14025        ELSE
 14026            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 14027
 14028     IF SCREEN-ERROR
 14029         MOVE -1                 TO MAINTL
 14030         GO TO 8110-SEND-DATA.
 14031
 14032     MOVE -1                     TO ONE-OR-MIN1.
 14033     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 14034
 14035     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 14036         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 14037                                    WS-SAVE-CLAIM-KEY
 14038         MOVE +1                 TO ONE-OR-MIN1
 14039         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 14040
 14041     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 14042
 14043     MOVE LOW-VALUES             TO EL131AO.
 14044     MOVE ER-0000                TO EMI-ERROR.
 14045     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14046     MOVE 'X'                    TO PI-RETURN-CD-1.
 14047     MOVE -1                     TO MAINTL.
 14048     GO TO 8100-SEND-MAP.
 14049
 14050 3010-DEL-MSTR-TRLR.
 14051
 14052* EXEC CICS READ UPDATE
 14053*         SET       (ADDRESS OF CLAIM-MASTER)
 14054*         DATASET   (CLMS-FILE-ID)
 14055*         RIDFLD    (MSTR-KEY)
 14056*    END-EXEC.
 14057*    MOVE '&"S        EU         (   #00012025' TO DFHEIV0
 14058     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14059     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14060     MOVE X'2020233030303132303235' TO DFHEIV0(25:11)
 14061     CALL 'kxdfhei1' USING DFHEIV0,
 14062           CLMS-FILE-ID,
 14063           DFHEIV20,
 14064           DFHEIV99,
 14065           MSTR-KEY,
 14066           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 262
* EL131.cbl
 14067           DFHEIV99,
 14068           DFHEIV99
 14069     SET ADDRESS OF CLAIM-MASTER TO
 14070         DFHEIV20
 14071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14072
 14073
 14074     if (cl-priority-cd = '8')
 14075        and (pi-processor-id not = 'PEMA' and 'JMS '
 14076             AND 'AMWA')
 14077        MOVE ER-8003             TO EMI-ERROR
 14078        PERFORM 9900-ERROR-FORMAT
 14079                                 THRU 9900-EXIT
 14080        MOVE -1                  TO MAINTL
 14081        GO TO 8110-SEND-DATA
 14082     end-if
 14083
 14084     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 14085     MOVE ZERO                   TO TRLR-SEQ-NO.
 14086
 14087
 14088* EXEC CICS HANDLE CONDITION
 14089*         NOTFND    (3010-DEL-ACTQ)
 14090*         ENDFILE   (3040-EXIT)
 14091*    END-EXEC.
 14092*    MOVE '"$I''                  ! = #00012044' TO DFHEIV0
 14093     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14094     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14095     MOVE X'3D20233030303132303434' TO DFHEIV0(25:11)
 14096     CALL 'kxdfhei1' USING DFHEIV0
 14097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14098
 14099
 14100     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 14101
 14102 3010-DEL-ACTQ.
 14103
 14104
 14105* EXEC CICS HANDLE CONDITION
 14106*         NOTFND    (3010-NO-ACTIVITY)
 14107*         ENDFILE   (3050-EXIT)
 14108*    END-EXEC.
 14109*    MOVE '"$I''                  ! > #00012053' TO DFHEIV0
 14110     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14111     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14112     MOVE X'3E20233030303132303533' TO DFHEIV0(25:11)
 14113     CALL 'kxdfhei1' USING DFHEIV0
 14114     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14115
 14116
 14117
 14118* EXEC CICS STARTBR
 14119*         DATASET  (ACTQ-FILE-ID)
 14120*         RIDFLD   (ACTQ-KEY)
 14121*    END-EXEC.
 14122     MOVE 0
 14123       TO DFHEIV11
 14124*    MOVE '&,         G          &   #00012058' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 263
* EL131.cbl
 14125     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14126     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14127     MOVE X'2020233030303132303538' TO DFHEIV0(25:11)
 14128     CALL 'kxdfhei1' USING DFHEIV0,
 14129           ACTQ-FILE-ID,
 14130           ACTQ-KEY,
 14131           DFHEIV99,
 14132           DFHEIV11,
 14133           DFHEIV99
 14134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14135
 14136
 14137
 14138* EXEC CICS GETMAIN
 14139*         SET      (ADDRESS OF ACTIVITY-QUE)
 14140*         LENGTH   (ACTQ-LENGTH)
 14141*         INITIMG  (GETMAIN-SPACE)
 14142*    END-EXEC.
 14143*    MOVE ',"IL                  $   #00012063' TO DFHEIV0
 14144     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14145     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14146     MOVE X'2020233030303132303633' TO DFHEIV0(25:11)
 14147     CALL 'kxdfhei1' USING DFHEIV0,
 14148           DFHEIV20,
 14149           ACTQ-LENGTH,
 14150           GETMAIN-SPACE
 14151     SET ADDRESS OF ACTIVITY-QUE TO
 14152         DFHEIV20
 14153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14154
 14155
 14156     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 14157
 14158
 14159* EXEC CICS ENDBR
 14160*         DATASET (ACTQ-FILE-ID)
 14161*    END-EXEC.
 14162     MOVE 0
 14163       TO DFHEIV11
 14164*    MOVE '&2                    $   #00012071' TO DFHEIV0
 14165     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14166     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14167     MOVE X'2020233030303132303731' TO DFHEIV0(25:11)
 14168     CALL 'kxdfhei1' USING DFHEIV0,
 14169           ACTQ-FILE-ID,
 14170           DFHEIV11,
 14171           DFHEIV99
 14172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14173
 14174
 14175 3010-NO-ACTIVITY.
 14176
 14177
 14178* EXEC CICS HANDLE CONDITION
 14179*        NOTFND   (3010-CERT-NOT-FOUND)
 14180*    END-EXEC.
 14181*    MOVE '"$I                   ! ? #00012077' TO DFHEIV0
 14182     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 264
* EL131.cbl
 14183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14184     MOVE X'3F20233030303132303737' TO DFHEIV0(25:11)
 14185     CALL 'kxdfhei1' USING DFHEIV0
 14186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14187
 14188
 14189     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 14190     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 14191     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 14192     MOVE CL-CERT-STATE          TO CERT-STATE.
 14193     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 14194     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 14195     MOVE CL-CERT-NO             TO CERT-CERT.
 14196
 14197
 14198* EXEC CICS READ
 14199*        DATASET   (CERT-FILE-ID)
 14200*        RIDFLD    (CERT-KEY)
 14201*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14202*    END-EXEC.
 14203*    MOVE '&"S        E          (   #00012089' TO DFHEIV0
 14204     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14206     MOVE X'2020233030303132303839' TO DFHEIV0(25:11)
 14207     CALL 'kxdfhei1' USING DFHEIV0,
 14208           CERT-FILE-ID,
 14209           DFHEIV20,
 14210           DFHEIV99,
 14211           CERT-KEY,
 14212           DFHEIV99,
 14213           DFHEIV99,
 14214           DFHEIV99
 14215     SET ADDRESS OF CERTIFICATE-MASTER TO
 14216         DFHEIV20
 14217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14218
 14219
 14220     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 14221       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 14222         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 14223     ELSE
 14224         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 14225
 14226 3010-UPDATE-CERT-TRLR.
 14227
 14228     MOVE CERT-KEY               TO ELCRTT-KEY
 14229     MOVE 'B'                    TO CTRLR-REC-TYPE
 14230
 14231* EXEC CICS READ
 14232*       UPDATE
 14233*       DATASET   ('ELCRTT')
 14234*       RIDFLD    (ELCRTT-KEY)
 14235*       INTO      (CERTIFICATE-TRAILERS)
 14236*       RESP      (WS-RESPONSE)
 14237*    END-EXEC
 14238     MOVE LENGTH OF
 14239      CERTIFICATE-TRAILERS
 14240       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 265
* EL131.cbl
 14241     MOVE 'ELCRTT' TO DFHEIV1
 14242*    MOVE '&"IL       EU         (  N#00012105' TO DFHEIV0
 14243     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14244     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14245     MOVE X'204E233030303132313035' TO DFHEIV0(25:11)
 14246     CALL 'kxdfhei1' USING DFHEIV0,
 14247           DFHEIV1,
 14248           CERTIFICATE-TRAILERS,
 14249           DFHEIV11,
 14250           ELCRTT-KEY,
 14251           DFHEIV99,
 14252           DFHEIV99,
 14253           DFHEIV99
 14254     MOVE EIBRESP  TO WS-RESPONSE
 14255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14256     IF WS-RESP-NORMAL
 14257        perform varying s1 from +1 by +1 until
 14258           (s1 > +24)
 14259           or (cs-claim-no (s1) = cl-claim-no)
 14260        end-perform
 14261        if s1 < +25
 14262           move spaces           to cs-claim-no (s1)
 14263                                    cs-claim-type (s1)
 14264                                    cs-insured-type (s1)
 14265           move zeros            to cs-days-paid (s1)
 14266                                    cs-total-paid (s1)
 14267                                    cs-benefit-period (s1)
 14268           if s1 not = +24
 14269              compute s2 = s1 + +1
 14270              perform 3015-bump  thru 3015-exit
 14271           end-if
 14272
 14273* EXEC CICS REWRITE
 14274*             DATASET   ('ELCRTT')
 14275*             FROM      (CERTIFICATE-TRAILERS)
 14276*          END-EXEC
 14277     MOVE LENGTH OF
 14278      CERTIFICATE-TRAILERS
 14279       TO DFHEIV11
 14280     MOVE 'ELCRTT' TO DFHEIV1
 14281*    MOVE '&& L                  %   #00012128' TO DFHEIV0
 14282     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14283     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14284     MOVE X'2020233030303132313238' TO DFHEIV0(25:11)
 14285     CALL 'kxdfhei1' USING DFHEIV0,
 14286           DFHEIV1,
 14287           CERTIFICATE-TRAILERS,
 14288           DFHEIV11,
 14289           DFHEIV99
 14290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14291        end-if
 14292     end-if
 14293     .
 14294 3010-CERT-NOT-FOUND.
 14295
 14296
 14297* EXEC CICS DELETE
 14298*        DATASET  (CLMS-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 266
* EL131.cbl
 14299*    END-EXEC.
 14300*    MOVE '&(                    &   #00012137' TO DFHEIV0
 14301     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14302     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14303     MOVE X'2020233030303132313337' TO DFHEIV0(25:11)
 14304     CALL 'kxdfhei1' USING DFHEIV0,
 14305           CLMS-FILE-ID,
 14306           DFHEIV99,
 14307           DFHEIV99,
 14308           DFHEIV99,
 14309           DFHEIV99
 14310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14311
 14312
 14313 3010-EXIT.
 14314      EXIT.
 14315
 14316 3015-bump.
 14317     perform varying s2 from s2 by +1 until s2 > +24
 14318        move cs-mb-claim-data (s2)
 14319                                 to cs-mb-claim-data (s1)
 14320        move spaces              to cs-mb-claim-data (s2)
 14321        add +1 to s1
 14322     end-perform
 14323     .
 14324 3015-exit.
 14325     exit.
 14326 3020-UPDATE-CERT.
 14327
 14328* EXEC CICS READ UPDATE
 14329*         DATASET  (CERT-FILE-ID)
 14330*         RIDFLD   (CERT-KEY)
 14331*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14332*    END-EXEC.
 14333*    MOVE '&"S        EU         (   #00012155' TO DFHEIV0
 14334     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14335     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14336     MOVE X'2020233030303132313535' TO DFHEIV0(25:11)
 14337     CALL 'kxdfhei1' USING DFHEIV0,
 14338           CERT-FILE-ID,
 14339           DFHEIV20,
 14340           DFHEIV99,
 14341           CERT-KEY,
 14342           DFHEIV99,
 14343           DFHEIV99,
 14344           DFHEIV99
 14345     SET ADDRESS OF CERTIFICATE-MASTER TO
 14346         DFHEIV20
 14347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14348
 14349
 14350     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 14351
 14352
 14353* EXEC CICS HANDLE CONDITION
 14354*         DUPKEY   (3020-EXIT)
 14355*    END-EXEC.
 14356*    MOVE '"$$                   ! @ #00012163' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 267
* EL131.cbl
 14357     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 14358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14359     MOVE X'4020233030303132313633' TO DFHEIV0(25:11)
 14360     CALL 'kxdfhei1' USING DFHEIV0
 14361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14362
 14363
 14364
 14365* EXEC CICS REWRITE
 14366*         DATASET  (CERT-FILE-ID)
 14367*         FROM     (CERTIFICATE-MASTER)
 14368*    END-EXEC.
 14369     MOVE LENGTH OF
 14370      CERTIFICATE-MASTER
 14371       TO DFHEIV11
 14372*    MOVE '&& L                  %   #00012167' TO DFHEIV0
 14373     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14374     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14375     MOVE X'2020233030303132313637' TO DFHEIV0(25:11)
 14376     CALL 'kxdfhei1' USING DFHEIV0,
 14377           CERT-FILE-ID,
 14378           CERTIFICATE-MASTER,
 14379           DFHEIV11,
 14380           DFHEIV99
 14381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14382
 14383
 14384 3020-EXIT.
 14385     EXIT.
 14386
 14387 3030-DELETE-CERT.
 14388
 14389* EXEC CICS READ UPDATE
 14390*         DATASET  (CERT-FILE-ID)
 14391*         RIDFLD   (CERT-KEY)
 14392*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14393*    END-EXEC.
 14394*    MOVE '&"S        EU         (   #00012176' TO DFHEIV0
 14395     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14396     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14397     MOVE X'2020233030303132313736' TO DFHEIV0(25:11)
 14398     CALL 'kxdfhei1' USING DFHEIV0,
 14399           CERT-FILE-ID,
 14400           DFHEIV20,
 14401           DFHEIV99,
 14402           CERT-KEY,
 14403           DFHEIV99,
 14404           DFHEIV99,
 14405           DFHEIV99
 14406     SET ADDRESS OF CERTIFICATE-MASTER TO
 14407         DFHEIV20
 14408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14409
 14410
 14411
 14412* EXEC CICS DELETE
 14413*         DATASET   (CERT-FILE-ID)
 14414*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 268
* EL131.cbl
 14415*    MOVE '&(                    &   #00012182' TO DFHEIV0
 14416     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14417     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14418     MOVE X'2020233030303132313832' TO DFHEIV0(25:11)
 14419     CALL 'kxdfhei1' USING DFHEIV0,
 14420           CERT-FILE-ID,
 14421           DFHEIV99,
 14422           DFHEIV99,
 14423           DFHEIV99,
 14424           DFHEIV99
 14425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14426
 14427
 14428 3030-EXIT.
 14429     EXIT.
 14430
 14431 3040-DELETE-TRLR.
 14432
 14433* EXEC CICS READ
 14434*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14435*         DATASET  (TRLR-FILE-ID)
 14436*         RIDFLD   (TRLR-KEY)
 14437*         GTEQ
 14438*    END-EXEC.
 14439*    MOVE '&"S        G          (   #00012190' TO DFHEIV0
 14440     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14441     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14442     MOVE X'2020233030303132313930' TO DFHEIV0(25:11)
 14443     CALL 'kxdfhei1' USING DFHEIV0,
 14444           TRLR-FILE-ID,
 14445           DFHEIV20,
 14446           DFHEIV99,
 14447           TRLR-KEY,
 14448           DFHEIV99,
 14449           DFHEIV99,
 14450           DFHEIV99
 14451     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14452         DFHEIV20
 14453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14454
 14455
 14456     IF PI-COMPANY-CD = AT-COMPANY-CD
 14457        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 14458        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14459           GO TO 3040-EXIT
 14460        ELSE
 14461           NEXT SENTENCE
 14462     ELSE
 14463        GO TO 3040-EXIT.
 14464
 14465
 14466* EXEC CICS DELETE
 14467*         DATASET  (TRLR-FILE-ID)
 14468*         RIDFLD   (TRLR-KEY)
 14469*    END-EXEC.
 14470*    MOVE '&(  R                 &   #00012206' TO DFHEIV0
 14471     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14472     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 269
* EL131.cbl
 14473     MOVE X'2020233030303132323036' TO DFHEIV0(25:11)
 14474     CALL 'kxdfhei1' USING DFHEIV0,
 14475           TRLR-FILE-ID,
 14476           TRLR-KEY,
 14477           DFHEIV99,
 14478           DFHEIV99,
 14479           DFHEIV99
 14480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14481
 14482
 14483     GO TO 3040-DELETE-TRLR.
 14484
 14485 3040-EXIT.
 14486     EXIT.
 14487
 14488 3050-DELETE-ACTQ.
 14489
 14490* EXEC CICS READNEXT
 14491*         DATASET  (ACTQ-FILE-ID)
 14492*         RIDFLD   (ACTQ-KEY)
 14493*         INTO     (ACTIVITY-QUE)
 14494*    END-EXEC.
 14495     MOVE LENGTH OF
 14496      ACTIVITY-QUE
 14497       TO DFHEIV12
 14498     MOVE 0
 14499       TO DFHEIV11
 14500*    MOVE '&.IL                  )   #00012217' TO DFHEIV0
 14501     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14502     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14503     MOVE X'2020233030303132323137' TO DFHEIV0(25:11)
 14504     CALL 'kxdfhei1' USING DFHEIV0,
 14505           ACTQ-FILE-ID,
 14506           ACTIVITY-QUE,
 14507           DFHEIV12,
 14508           ACTQ-KEY,
 14509           DFHEIV99,
 14510           DFHEIV11,
 14511           DFHEIV99,
 14512           DFHEIV99
 14513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14514
 14515
 14516     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 14517         GO TO 3050-EXIT.
 14518
 14519
 14520* EXEC CICS ENDBR
 14521*         DATASET  (ACTQ-FILE-ID)
 14522*    END-EXEC.
 14523     MOVE 0
 14524       TO DFHEIV11
 14525*    MOVE '&2                    $   #00012226' TO DFHEIV0
 14526     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14527     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14528     MOVE X'2020233030303132323236' TO DFHEIV0(25:11)
 14529     CALL 'kxdfhei1' USING DFHEIV0,
 14530           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 270
* EL131.cbl
 14531           DFHEIV11,
 14532           DFHEIV99
 14533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14534
 14535
 14536
 14537* EXEC CICS DELETE
 14538*         DATASET   (ACTQ-FILE-ID)
 14539*         RIDFLD    (ACTQ-KEY)
 14540*    END-EXEC.
 14541*    MOVE '&(  R                 &   #00012230' TO DFHEIV0
 14542     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 14543     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14544     MOVE X'2020233030303132323330' TO DFHEIV0(25:11)
 14545     CALL 'kxdfhei1' USING DFHEIV0,
 14546           ACTQ-FILE-ID,
 14547           ACTQ-KEY,
 14548           DFHEIV99,
 14549           DFHEIV99,
 14550           DFHEIV99
 14551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14552
 14553
 14554
 14555* EXEC CICS STARTBR
 14556*         DATASET   (ACTQ-FILE-ID)
 14557*         RIDFLD    (ACTQ-KEY)
 14558*    END-EXEC.
 14559     MOVE 0
 14560       TO DFHEIV11
 14561*    MOVE '&,         G          &   #00012235' TO DFHEIV0
 14562     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14563     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14564     MOVE X'2020233030303132323335' TO DFHEIV0(25:11)
 14565     CALL 'kxdfhei1' USING DFHEIV0,
 14566           ACTQ-FILE-ID,
 14567           ACTQ-KEY,
 14568           DFHEIV99,
 14569           DFHEIV11,
 14570           DFHEIV99
 14571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14572
 14573
 14574     GO TO 3050-DELETE-ACTQ.
 14575
 14576 3050-EXIT.
 14577     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 271
* EL131.cbl
 14579 3060-READ-TRLR.
 14580
 14581* EXEC CICS HANDLE CONDITION
 14582*         NOTFND    (3060-EXIT)
 14583*         ENDFILE   (3060-EXIT)
 14584*    END-EXEC.
 14585*    MOVE '"$I''                  ! A #00012246' TO DFHEIV0
 14586     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 14587     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14588     MOVE X'4120233030303132323436' TO DFHEIV0(25:11)
 14589     CALL 'kxdfhei1' USING DFHEIV0
 14590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14591
 14592
 14593 3060-LOOP.
 14594
 14595* EXEC CICS READNEXT
 14596*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 14597*         DATASET  (TRLR-FILE-ID)
 14598*         RIDFLD   (TRLR-KEY)
 14599*    END-EXEC.
 14600     MOVE 0
 14601       TO DFHEIV11
 14602*    MOVE '&.S                   )   #00012252' TO DFHEIV0
 14603     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14604     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14605     MOVE X'2020233030303132323532' TO DFHEIV0(25:11)
 14606     CALL 'kxdfhei1' USING DFHEIV0,
 14607           TRLR-FILE-ID,
 14608           DFHEIV20,
 14609           DFHEIV99,
 14610           TRLR-KEY,
 14611           DFHEIV99,
 14612           DFHEIV11,
 14613           DFHEIV99,
 14614           DFHEIV99
 14615     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14616         DFHEIV20
 14617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14618
 14619
 14620     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 14621         GO TO 3060-EXIT.
 14622
 14623     IF FORM-CONTROL-TR
 14624         IF AT-RECORDED-DT = SAVE-BIN-DATE
 14625             NEXT SENTENCE
 14626         ELSE
 14627             MOVE 'X'            TO ERROR-SWITCH
 14628             GO TO 3060-EXIT
 14629     ELSE
 14630         IF PAYMENT-TR OR CORRESPONDENCE-TR
 14631            MOVE 'X'                 TO ERROR-SWITCH
 14632            GO TO 3060-EXIT.
 14633
 14634     GO TO 3060-LOOP.
 14635
 14636 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 272
* EL131.cbl
 14637     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 273
* EL131.cbl
 14639 3997-GET-ERPDEF.
 14640
 14641     move cl-company-cd          to cert-company-code
 14642     move cl-cert-key-data       to cert-key (2:21)
 14643     move cl-cert-no             to cert-cert
 14644
 14645
 14646* EXEC CICS READ
 14647*        DATASET   (CERT-FILE-ID)
 14648*        RIDFLD    (CERT-KEY)
 14649*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 14650*        resp      (ws-response)
 14651*    END-EXEC
 14652*    MOVE '&"S        E          (  N#00012283' TO DFHEIV0
 14653     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14654     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14655     MOVE X'204E233030303132323833' TO DFHEIV0(25:11)
 14656     CALL 'kxdfhei1' USING DFHEIV0,
 14657           CERT-FILE-ID,
 14658           DFHEIV20,
 14659           DFHEIV99,
 14660           CERT-KEY,
 14661           DFHEIV99,
 14662           DFHEIV99,
 14663           DFHEIV99
 14664     SET ADDRESS OF CERTIFICATE-MASTER TO
 14665         DFHEIV20
 14666     MOVE EIBRESP  TO ws-response
 14667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14668
 14669     MOVE SPACES                 TO WS-CRIT-PER-ALPHA
 14670                                    WS-ERPDEF-SW
 14671     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 14672                                    WS-CRIT-PER-RTW-MOS
 14673
 14674     if cm-clp-state = spaces or low-values or zeros
 14675        move cm-state            to cm-clp-state
 14676     end-if
 14677     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 14678     MOVE CM-clp-state           TO ERPDEF-STATE
 14679     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 14680     evaluate true
 14681        when (cl-claim-type = 'L' or 'P')
 14682           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14683             and 'CU')
 14684           move 'L'              to erpdef-ben-type
 14685           move cm-lf-benefit-cd to erpdef-ben-code
 14686        when (cl-claim-type not = 'L' and 'P')
 14687           and (cm-ah-benefit-cd not = '00' and '  ')
 14688           move 'A'              to erpdef-ben-type
 14689           move cm-ah-benefit-cd to erpdef-ben-code
 14690        when (cl-claim-type not = 'L' and 'P')
 14691           and (cm-ah-benefit-cd = '00' or '  ')
 14692           move 'L'              to erpdef-ben-type
 14693           move cm-lf-benefit-cd to erpdef-ben-code
 14694        when (cl-claim-type = 'L' or 'P')
 14695           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 14696           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 274
* EL131.cbl
 14697           move cm-ah-benefit-cd to erpdef-ben-code
 14698        when other
 14699           move 'A'              to erpdef-ben-type
 14700           move cm-ah-benefit-cd to erpdef-ben-code
 14701     end-evaluate
 14702
 14703*    if (cl-claim-type = 'L' or 'P')
 14704*       and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 14705*          and 'CU')
 14706*       move 'L'                 to erpdef-ben-type
 14707*       move cm-lf-benefit-cd    to erpdef-ben-code
 14708*    else
 14709*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
 14710*       MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 14711*    end-if
 14712     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 14713     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 14714
 14715
 14716* EXEC CICS STARTBR
 14717*        DATASET  ('ERPDEF')
 14718*        RIDFLD   (ERPDEF-KEY)
 14719*        GTEQ
 14720*        RESP     (WS-RESPONSE)
 14721*    END-EXEC
 14722     MOVE 'ERPDEF' TO DFHEIV1
 14723     MOVE 0
 14724       TO DFHEIV11
 14725*    MOVE '&,         G          &  N#00012336' TO DFHEIV0
 14726     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14727     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14728     MOVE X'204E233030303132333336' TO DFHEIV0(25:11)
 14729     CALL 'kxdfhei1' USING DFHEIV0,
 14730           DFHEIV1,
 14731           ERPDEF-KEY,
 14732           DFHEIV99,
 14733           DFHEIV11,
 14734           DFHEIV99
 14735     MOVE EIBRESP  TO WS-RESPONSE
 14736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14737
 14738     IF WS-RESP-NORMAL
 14739
 14740* EXEC CICS READNEXT
 14741*          DATASET  ('ERPDEF')
 14742*          INTO     (PRODUCT-MASTER)
 14743*          RIDFLD   (ERPDEF-KEY)
 14744*          RESP     (WS-RESPONSE)
 14745*       END-EXEC
 14746     MOVE LENGTH OF
 14747      PRODUCT-MASTER
 14748       TO DFHEIV12
 14749     MOVE 'ERPDEF' TO DFHEIV1
 14750     MOVE 0
 14751       TO DFHEIV11
 14752*    MOVE '&.IL                  )  N#00012344' TO DFHEIV0
 14753     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 14754     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 275
* EL131.cbl
 14755     MOVE X'204E233030303132333434' TO DFHEIV0(25:11)
 14756     CALL 'kxdfhei1' USING DFHEIV0,
 14757           DFHEIV1,
 14758           PRODUCT-MASTER,
 14759           DFHEIV12,
 14760           ERPDEF-KEY,
 14761           DFHEIV99,
 14762           DFHEIV11,
 14763           DFHEIV99,
 14764           DFHEIV99
 14765     MOVE EIBRESP  TO WS-RESPONSE
 14766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14767        IF WS-RESP-NORMAL
 14768           IF (ERPDEF-KEY-SAVE (1:16) =
 14769              PD-CONTROL-PRIMARY (1:16))
 14770              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 14771              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 14772                 (A1 > +8)
 14773                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 14774              END-PERFORM
 14775              IF A1 < +9
 14776                 SET ERPDEF-FOUND TO TRUE
 14777                 MOVE PD-CRIT-PERIOD (A1)
 14778                              TO WS-CRITICAL-PERIOD
 14779                 MOVE PD-REC-CRIT-PERIOD (A1)
 14780                              TO WS-CRIT-PER-RECURRENT
 14781                 IF PD-RTW-MOS (A1) NUMERIC
 14782                    MOVE PD-RTW-MOS (A1)
 14783                              TO WS-CRIT-PER-RTW-MOS
 14784                 ELSE
 14785                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 14786                 END-IF
 14787                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 14788                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 14789                                 TO WS-EXCL-PERIOD
 14790                 END-IF
 14791                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 14792                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 14793                                 TO WS-COV-ENDS
 14794                 END-IF
 14795                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 14796                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 14797                                 TO WS-ACC-PERIOD
 14798                 END-IF
 14799                 if pd-max-extension (a1) numeric
 14800                    move pd-max-extension (a1)
 14801                                 to ws-max-extension
 14802                 end-if
 14803                 if pd-max-amt (a1) numeric
 14804                    move pd-max-amt (a1)
 14805                                 to ws-max-moben
 14806                 end-if
 14807              END-IF
 14808           END-IF
 14809        END-IF
 14810     END-IF
 14811
 14812     .
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 276
* EL131.cbl
 14813 3997-EXIT.
 14814     EXIT.
 14815 4000-FORCE-ERRORS.
 14816     IF PI-RETURN-CD-1 = 'X'
 14817         MOVE ER-0311            TO EMI-ERROR
 14818         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14819         MOVE -1                 TO MAINTL
 14820         GO TO 8110-SEND-DATA.
 14821
 14822     IF NOT FORCE-CAP
 14823         MOVE ER-0416            TO EMI-ERROR
 14824         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14825         MOVE -1                 TO MAINTL
 14826         GO TO 8110-SEND-DATA.
 14827
 14828     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 14829     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 14830     IF EMI-FATAL-CTR GREATER THAN ZERO
 14831         GO TO 4000-FATAL-ERRORS.
 14832
 14833     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 14834
 14835     IF EMI-FATAL-CTR GREATER THAN ZERO
 14836         GO TO 4000-FATAL-ERRORS.
 14837
 14838     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 14839
 14840     IF EMI-FATAL-CTR GREATER THAN ZERO
 14841         GO TO 4000-FATAL-ERRORS.
 14842
 14843     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 14844     MOVE AL-UANOF               TO CERTA.
 14845     MOVE ER-0000 TO EMI-ERROR.
 14846     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14847
 14848 4000-FATAL-ERRORS.
 14849     MOVE -1                     TO MAINTL.
 14850     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 277
* EL131.cbl
 14852
 14853 4100-SAVE-CHANGES.
 14854     IF MAINTL > 0
 14855         MOVE MAINTI  TO WS-SAVE-MAINTI
 14856         MOVE MAINTL  TO WS-SAVE-MAINTL
 14857     END-IF
 14858     IF STATUSL > 0
 14859         MOVE STATUSI  TO WS-SAVE-STATUSI
 14860         MOVE STATUSL  TO WS-SAVE-STATUSL
 14861     END-IF
 14862     IF REPL > 0
 14863         MOVE REPI  TO WS-SAVE-REPI
 14864         MOVE REPL  TO WS-SAVE-REPL
 14865     END-IF
 14866*    IF CAUSEL > 0
 14867*        MOVE CAUSEI  TO WS-SAVE-CAUSEI
 14868*        MOVE CAUSEL  TO WS-SAVE-CAUSEL
 14869*    END-IF
 14870*    IF ENDL > 0
 14871*        MOVE ENDI  TO WS-SAVE-ENDI
 14872*        MOVE ENDL  TO WS-SAVE-ENDL
 14873*    END-IF
 14874     IF DIAGL > 0
 14875         MOVE DIAGI  TO WS-SAVE-DIAGI
 14876         MOVE DIAGL  TO WS-SAVE-DIAGL
 14877     END-IF
 14878     IF ICD1L > 0
 14879         MOVE ICD1I  TO WS-SAVE-ICD1I
 14880         MOVE ICD1L  TO WS-SAVE-ICD1L
 14881     END-IF
 14882     IF ICD2L > 0
 14883         MOVE ICD2I  TO WS-SAVE-ICD2I
 14884         MOVE ICD2L  TO WS-SAVE-ICD2L
 14885     END-IF
 14886     IF BENEL > 0
 14887         MOVE BENEI  TO WS-SAVE-BENEI
 14888         MOVE BENEL  TO WS-SAVE-BENEL
 14889     END-IF
 14890     IF BIRTHL > 0
 14891         MOVE BIRTHI  TO WS-SAVE-BIRTHI
 14892         MOVE BIRTHL  TO WS-SAVE-BIRTHL
 14893     END-IF
 14894     IF SOCIALL > 0
 14895         MOVE SOCIALI  TO WS-SAVE-SOCIALI
 14896         MOVE SOCIALL  TO WS-SAVE-SOCIALL
 14897     END-IF
 14898     IF SEXL > 0
 14899         MOVE SEXI  TO WS-SAVE-SEXI
 14900         MOVE SEXL  TO WS-SAVE-SEXL
 14901     END-IF
 14902     IF MLNAMEL > 0
 14903         MOVE MLNAMEI  TO WS-SAVE-MLNAMEI
 14904         MOVE MLNAMEL  TO WS-SAVE-MLNAMEL
 14905     END-IF
 14906     IF MFNAMEL > 0
 14907         MOVE MFNAMEI  TO WS-SAVE-MFNAMEI
 14908         MOVE MFNAMEL  TO WS-SAVE-MFNAMEL
 14909     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 278
* EL131.cbl
 14910     IF MMINITL > 0
 14911         MOVE MMINITI  TO WS-SAVE-MMINITI
 14912         MOVE MMINITL  TO WS-SAVE-MMINITL
 14913     END-IF
 14914*    IF LOANNOL > 0
 14915*        MOVE LOANNOI  TO WS-SAVE-LOANNOI
 14916*        MOVE LOANNOL  TO WS-SAVE-LOANNOL
 14917*    END-IF
 14918     IF LOANBALL > 0
 14919         MOVE LOANBALI  TO WS-SAVE-LOANBALI
 14920         MOVE LOANBALL  TO WS-SAVE-LOANBALL
 14921     END-IF
 14922     IF PROCL > 0
 14923         MOVE PROCI  TO WS-SAVE-PROCI
 14924         MOVE PROCL  TO WS-SAVE-PROCL
 14925     END-IF
 14926     IF SUPVL > 0
 14927         MOVE SUPVI  TO WS-SAVE-SUPVI
 14928         MOVE SUPVL  TO WS-SAVE-SUPVL
 14929     END-IF
 14930     IF PRICDL > 0
 14931         MOVE PRICDI  TO WS-SAVE-PRICDI
 14932         MOVE PRICDL  TO WS-SAVE-PRICDL
 14933     END-IF
 14934     IF FILETOL > 0
 14935         MOVE FILETOI  TO WS-SAVE-FILETOI
 14936         MOVE FILETOL  TO WS-SAVE-FILETOL
 14937     END-IF
 14938     IF PDTHRUL > 0
 14939         MOVE PDTHRUI  TO WS-SAVE-PDTHRUI
 14940         MOVE PDTHRUL  TO WS-SAVE-PDTHRUL
 14941     END-IF
 14942     IF PDAMTL > 0
 14943         MOVE PDAMTI  TO WS-SAVE-PDAMTI
 14944         MOVE PDAMTL  TO WS-SAVE-PDAMTL
 14945     END-IF
 14946     IF NODAYSL > 0
 14947         MOVE NODAYSI  TO WS-SAVE-NODAYSI
 14948         MOVE NODAYSL  TO WS-SAVE-NODAYSL
 14949     END-IF
 14950     IF NOPMTSL > 0
 14951         MOVE NOPMTSI  TO WS-SAVE-NOPMTSI
 14952         MOVE NOPMTSL  TO WS-SAVE-NOPMTSL
 14953     END-IF
 14954     IF FORMTYPL > 0
 14955         MOVE FORMTYPI  TO WS-SAVE-FORMTYPI
 14956         MOVE FORMTYPL  TO WS-SAVE-FORMTYPL
 14957     END-IF
 14958     IF OCCL > 0
 14959         MOVE OCCI  TO WS-SAVE-OCCI
 14960         MOVE OCCL  TO WS-SAVE-OCCL
 14961     END-IF.
 14962 4100-EXIT.
 14963      EXIT.
 14964
 14965 4200-LOAD-CHANGES.
 14966     IF WS-SAVE-MAINTL > 0
 14967         MOVE WS-SAVE-MAINTI  TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 279
* EL131.cbl
 14968         MOVE WS-SAVE-MAINTL  TO MAINTL
 14969         MOVE AL-UANON        TO MAINTA
 14970     END-IF
 14971     IF WS-SAVE-STATUSL > 0
 14972         MOVE WS-SAVE-STATUSI  TO STATUSI
 14973         MOVE WS-SAVE-STATUSL  TO STATUSL
 14974         MOVE AL-UANON         TO STATUSA
 14975     END-IF
 14976     IF WS-SAVE-REPL > 0
 14977         MOVE WS-SAVE-REPI  TO REPI
 14978         MOVE WS-SAVE-REPL  TO REPL
 14979         MOVE AL-UANON      TO REPA
 14980     END-IF
 14981*    IF WS-SAVE-CAUSEL > 0
 14982*        MOVE WS-SAVE-CAUSEI  TO CAUSEI
 14983*        MOVE WS-SAVE-CAUSEL  TO CAUSEL
 14984*        MOVE AL-UANON        TO CAUSEA
 14985*    END-IF
 14986*    IF WS-SAVE-ENDL > 0
 14987*        MOVE WS-SAVE-ENDI  TO ENDI
 14988*        MOVE WS-SAVE-ENDL  TO ENDL
 14989*        MOVE AL-UANON      TO ENDA
 14990*    END-IF
 14991     IF WS-SAVE-DIAGL > 0
 14992         MOVE WS-SAVE-DIAGI  TO DIAGI
 14993         MOVE WS-SAVE-DIAGL  TO DIAGL
 14994         MOVE AL-UANON       TO DIAGA
 14995     END-IF
 14996     IF WS-SAVE-ICD1L > 0
 14997         MOVE WS-SAVE-ICD1I  TO ICD1I
 14998         MOVE WS-SAVE-ICD1L  TO ICD1L
 14999         MOVE AL-UANON       TO ICD1A
 15000     END-IF
 15001     IF WS-SAVE-ICD2L > 0
 15002         MOVE WS-SAVE-ICD2I  TO ICD2I
 15003         MOVE WS-SAVE-ICD2L  TO ICD2L
 15004         MOVE AL-UANON       TO ICD2A
 15005     END-IF
 15006     IF WS-SAVE-BENEL > 0
 15007         MOVE WS-SAVE-BENEI  TO BENEI
 15008         MOVE WS-SAVE-BENEL  TO BENEL
 15009         MOVE AL-UANON       TO BENEA
 15010     END-IF
 15011     IF WS-SAVE-BIRTHL > 0
 15012         MOVE WS-SAVE-BIRTHI  TO BIRTHI
 15013         MOVE WS-SAVE-BIRTHL  TO BIRTHL
 15014         MOVE AL-UANON        TO BIRTHA
 15015     END-IF
 15016     IF WS-SAVE-SOCIALL > 0
 15017         MOVE WS-SAVE-SOCIALI  TO SOCIALI
 15018         MOVE WS-SAVE-SOCIALL  TO SOCIALL
 15019         MOVE AL-UANON         TO SOCIALA
 15020     END-IF
 15021     IF WS-SAVE-SEXL > 0
 15022         MOVE WS-SAVE-SEXI  TO SEXI
 15023         MOVE WS-SAVE-SEXL  TO SEXL
 15024         MOVE AL-UANON      TO SEXA
 15025     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 280
* EL131.cbl
 15026     IF WS-SAVE-MLNAMEL > 0
 15027         MOVE WS-SAVE-MLNAMEI  TO MLNAMEI
 15028         MOVE WS-SAVE-MLNAMEL  TO MLNAMEL
 15029         MOVE AL-UANON         TO MLNAMEA
 15030     END-IF
 15031     IF WS-SAVE-MFNAMEL > 0
 15032         MOVE WS-SAVE-MFNAMEI  TO MFNAMEI
 15033         MOVE WS-SAVE-MFNAMEL  TO MFNAMEL
 15034         MOVE AL-UANON         TO MFNAMEA
 15035     END-IF
 15036     IF WS-SAVE-MMINITL > 0
 15037         MOVE WS-SAVE-MMINITI  TO MMINITI
 15038         MOVE WS-SAVE-MMINITL  TO MMINITL
 15039         MOVE AL-UANON         TO MMINITA
 15040     END-IF
 15041*    IF WS-SAVE-LOANNOL > 0
 15042*        MOVE WS-SAVE-LOANNOI  TO LOANNOI
 15043*        MOVE WS-SAVE-LOANNOL  TO LOANNOL
 15044*        MOVE AL-UANON         TO LOANNOA
 15045*    END-IF
 15046     IF WS-SAVE-LOANBALL > 0
 15047         MOVE WS-SAVE-LOANBALI  TO LOANBALI
 15048         MOVE WS-SAVE-LOANBALL  TO LOANBALL
 15049         MOVE AL-UANON          TO LOANBALA
 15050     END-IF
 15051     IF WS-SAVE-PROCL > 0
 15052         MOVE WS-SAVE-PROCI  TO PROCI
 15053         MOVE WS-SAVE-PROCL  TO PROCL
 15054         MOVE AL-UANON       TO PROCA
 15055     END-IF
 15056     IF WS-SAVE-SUPVL > 0
 15057         MOVE WS-SAVE-SUPVI  TO SUPVI
 15058         MOVE WS-SAVE-SUPVL  TO SUPVL
 15059         MOVE AL-UANON       TO SUPVA
 15060     END-IF
 15061     IF WS-SAVE-PRICDL > 0
 15062         MOVE WS-SAVE-PRICDI  TO PRICDI
 15063         MOVE WS-SAVE-PRICDL  TO PRICDL
 15064         MOVE AL-UANON        TO PRICDA
 15065     END-IF
 15066     IF WS-SAVE-FILETOL > 0
 15067         MOVE WS-SAVE-FILETOI  TO FILETOI
 15068         MOVE WS-SAVE-FILETOL  TO FILETOL
 15069         MOVE AL-UANON         TO FILETOA
 15070     END-IF
 15071     IF WS-SAVE-PDTHRUL > 0
 15072         MOVE WS-SAVE-PDTHRUI  TO PDTHRUI
 15073         MOVE WS-SAVE-PDTHRUL  TO PDTHRUL
 15074         MOVE AL-UANON         TO PDTHRUA
 15075     END-IF
 15076     IF WS-SAVE-PDAMTL > 0
 15077         MOVE WS-SAVE-PDAMTI  TO PDAMTI
 15078         MOVE WS-SAVE-PDAMTL  TO PDAMTL
 15079         MOVE AL-UANON        TO PDAMTA
 15080     END-IF
 15081     IF WS-SAVE-NODAYSL > 0
 15082         MOVE WS-SAVE-NODAYSI  TO NODAYSI
 15083         MOVE WS-SAVE-NODAYSL  TO NODAYSL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 281
* EL131.cbl
 15084         MOVE AL-UANON         TO NODAYSA
 15085     END-IF
 15086     IF WS-SAVE-NOPMTSL > 0
 15087         MOVE WS-SAVE-NOPMTSI  TO NOPMTSI
 15088         MOVE WS-SAVE-NOPMTSL  TO NOPMTSL
 15089         MOVE AL-UANON         TO NOPMTSA
 15090     END-IF
 15091     IF WS-SAVE-FORMTYPL > 0
 15092         MOVE WS-SAVE-FORMTYPI  TO FORMTYPI
 15093         MOVE WS-SAVE-FORMTYPL  TO FORMTYPL
 15094         MOVE AL-UANON          TO FORMTYPA
 15095     END-IF
 15096     IF WS-SAVE-OCCL > 0
 15097         MOVE WS-SAVE-OCCI  TO OCCI
 15098         MOVE WS-SAVE-OCCL  TO OCCL
 15099         MOVE AL-UANON      TO OCCA
 15100     END-IF.
 15101 4200-EXIT.
 15102      EXIT.
 15103
 15104 5000-BUILD-MAP.
 15105     IF PI-RETURN-CD-1 = SPACE
 15106         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 15107
 15108     MOVE SPACE                  TO PI-RETURN-CD-1.
 15109
 15110     MOVE LOW-VALUES             TO EL131AI.
 15111
 15112     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 15113     MOVE PI-CARRIER             TO CARRIER-CODE.
 15114     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 15115     MOVE PI-CERT-NO             TO CERT-NO.
 15116
 15117 5000-READ-CLAIM-MASTER.
 15118
 15119
 15120* EXEC CICS READ
 15121*         SET      (ADDRESS OF CLAIM-MASTER)
 15122*         DATASET  (CLMS-FILE-ID)
 15123*         RIDFLD   (MSTR-KEY)
 15124*    END-EXEC.
 15125*    MOVE '&"S        E          (   #00012702' TO DFHEIV0
 15126     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15127     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15128     MOVE X'2020233030303132373032' TO DFHEIV0(25:11)
 15129     CALL 'kxdfhei1' USING DFHEIV0,
 15130           CLMS-FILE-ID,
 15131           DFHEIV20,
 15132           DFHEIV99,
 15133           MSTR-KEY,
 15134           DFHEIV99,
 15135           DFHEIV99,
 15136           DFHEIV99
 15137     SET ADDRESS OF CLAIM-MASTER TO
 15138         DFHEIV20
 15139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15140
 15141
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 282
* EL131.cbl
 15142     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 15143
 15144 5000-READ-DIAGNOSIS-TRAILER.
 15145
 15146
 15147* EXEC CICS HANDLE CONDITION
 15148*         NOTFND (5000-TRLR-NOT-FOUND)
 15149*    END-EXEC.
 15150*    MOVE '"$I                   ! B #00012712' TO DFHEIV0
 15151     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15152     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15153     MOVE X'4220233030303132373132' TO DFHEIV0(25:11)
 15154     CALL 'kxdfhei1' USING DFHEIV0
 15155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15156
 15157
 15158     MOVE MSTR-KEY               TO TRLR-KEY.
 15159     MOVE NINETY                 TO TRLR-SEQ-NO.
 15160
 15161
 15162* EXEC CICS READ
 15163*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15164*         DATASET  (TRLR-FILE-ID)
 15165*         RIDFLD   (TRLR-KEY)
 15166*    END-EXEC.
 15167*    MOVE '&"S        E          (   #00012719' TO DFHEIV0
 15168     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15169     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15170     MOVE X'2020233030303132373139' TO DFHEIV0(25:11)
 15171     CALL 'kxdfhei1' USING DFHEIV0,
 15172           TRLR-FILE-ID,
 15173           DFHEIV20,
 15174           DFHEIV99,
 15175           TRLR-KEY,
 15176           DFHEIV99,
 15177           DFHEIV99,
 15178           DFHEIV99
 15179     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15180         DFHEIV20
 15181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15182
 15183
 15184     MOVE AT-INFO-LINE-1         TO DIAGO.
 15185     MOVE AT-ICD-CODE-1          TO ICD1O.
 15186     MOVE AT-ICD-CODE-2          TO ICD2O.
 15187
 15188 5000-READ-CERTIFICATE-MASTER.
 15189
 15190     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 15191     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 15192     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 15193     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 15194     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 15195     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 15196     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 15197
 15198
 15199* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 283
* EL131.cbl
 15200*         NOTFND (5000-CERT-NOT-FOUND)
 15201*    END-EXEC.
 15202*    MOVE '"$I                   ! C #00012739' TO DFHEIV0
 15203     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15205     MOVE X'4320233030303132373339' TO DFHEIV0(25:11)
 15206     CALL 'kxdfhei1' USING DFHEIV0
 15207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15208
 15209
 15210
 15211* EXEC CICS READ
 15212*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 15213*         DATASET  (CERT-FILE-ID)
 15214*         RIDFLD   (CERT-KEY)
 15215*    END-EXEC.
 15216*    MOVE '&"S        E          (   #00012743' TO DFHEIV0
 15217     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15218     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15219     MOVE X'2020233030303132373433' TO DFHEIV0(25:11)
 15220     CALL 'kxdfhei1' USING DFHEIV0,
 15221           CERT-FILE-ID,
 15222           DFHEIV20,
 15223           DFHEIV99,
 15224           CERT-KEY,
 15225           DFHEIV99,
 15226           DFHEIV99,
 15227           DFHEIV99
 15228     SET ADDRESS OF CERTIFICATE-MASTER TO
 15229         DFHEIV20
 15230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15231
 15232
 15233     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 15234     PERFORM 5100-LOAD-CORR-TRLR THRU 5100-EXIT.
 15235     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 15236
 15237     GO TO 5000-EXIT.
 15238
 15239 5000-TRLR-NOT-FOUND.
 15240     MOVE ER-7687                TO EMI-ERROR.
 15241     MOVE -1                     TO DIAGL.
 15242     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15243     GO TO 5000-EXIT.
 15244
 15245 5000-CERT-NOT-FOUND.
 15246     MOVE ER-0206                TO EMI-ERROR.
 15247     MOVE -1                     TO CERTL.
 15248     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15249
 15250 5000-EXIT.
 15251     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 284
* EL131.cbl
 15253 5010-RESET-PI-AREA.
 15254     IF CERTI GREATER THAN LOW-VALUES
 15255         MOVE CERTI              TO PI-CERT-PRIME.
 15256
 15257     IF SUFXI GREATER THAN LOW-VALUES
 15258         MOVE SUFXI              TO PI-CERT-SFX.
 15259
 15260     IF CERTEFFI GREATER THAN LOW-VALUES
 15261         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 15262
 15263     IF CERTACTI GREATER THAN LOW-VALUES
 15264         MOVE CERTACTI           TO PI-ACCOUNT.
 15265
 15266     IF CERTSTI GREATER THAN LOW-VALUES
 15267         MOVE CERTSTI            TO PI-STATE.
 15268
 15269     IF CERTCARI GREATER THAN LOW-VALUES
 15270         MOVE CERTCARI           TO PI-CARRIER.
 15271
 15272     IF CERTGRPI GREATER THAN LOW-VALUES
 15273         MOVE CERTGRPI           TO PI-GROUPING.
 15274
 15275 5010-EXIT.
 15276     EXIT.
 15277
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 285
* EL131.cbl
 15279 5020-MOVE-MSTR.
 15280
 15281     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 15282     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 15283     MOVE WS-CLAIM-SEQU          TO SEQUO.
 15284     MOVE AL-SABON               TO SEQUA.
 15285     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 15286     MOVE CL-CLAIM-TYPE          TO TYPEO
 15287                                    pi-claim-type
 15288
 15289     IF CL-TOTAL-PAID-AMT  = +0 AND
 15290        CL-LAST-PMT-AMT    = +0 AND
 15291        CL-NO-OF-PMTS-MADE = +0
 15292          MOVE AL-UANON          TO TYPEA.
 15293
 15294     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 15295     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 15296     MOVE CL-CERT-PRIME          TO CERTO.
 15297     MOVE CL-CERT-SFX            TO SUFXO.
 15298     MOVE CL-CERT-CARRIER        TO CARRO.
 15299
 15300     IF CL-CLAIM-STATUS = 'C'
 15301         MOVE 'CLOSED'           TO STATUSO
 15302     ELSE
 15303         MOVE 'OPEN  '           TO STATUSO.
 15304
 15305     move cl-accident-claim-sw   to accswo
 15306     if cl-benefit-period not numeric
 15307        move zeros               to cl-benefit-period
 15308     end-if
 15309     move cl-benefit-period      to benpero
 15310     move cl-insured-type        to instypeo
 15311     MOVE CL-PROCESSOR-ID        TO PROCO.
 15312
 15313     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 15314     MOVE CL-CCN                 TO CCNOO.
 15315
 15316     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 15317     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 15318     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 15319     MOVE CL-INSURED-SEX-CD      TO SEXO.
 15320
 15321     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 15322         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 15323         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15324         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15325         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 15326     ELSE
 15327         MOVE SPACES             TO BIRTHO.
 15328
 15329     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 15330        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 15331         NEXT SENTENCE
 15332       ELSE
 15333         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 15334
 15335     IF PI-COMPANY-ID = 'DMD'
 15336       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 286
* EL131.cbl
 15337          IF SOCIALO = SPACES OR LOW-VALUES
 15338            MOVE ER-0885         TO EMI-ERROR
 15339            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15340
 15341     MOVE CL-INSURED-OCC-CD      TO OCCO.
 15342*    MOVE CL-CAUSE-CD            TO CAUSEO.
 15343
 15344*    IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 15345*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 15346*        MOVE SPACES                 TO DC-OPTION-CODE
 15347*        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15348*        MOVE DC-GREG-DATE-1-EDIT TO ENDO
 15349*    ELSE
 15350*        MOVE SPACES             TO ENDO.
 15351
 15352     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 15353        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15354        MOVE SPACES             TO DC-OPTION-CODE
 15355        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15356        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15357        IF PI-USES-PAID-TO
 15358           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 15359           MOVE '6'                TO DC-OPTION-CODE
 15360           MOVE +1                 TO DC-ELAPSED-DAYS
 15361           MOVE +0                 TO DC-ELAPSED-MONTHS
 15362           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15363           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 15364        ELSE
 15365           NEXT SENTENCE
 15366     ELSE
 15367        MOVE SPACES             TO PDTHRUO.
 15368
 15369     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 15370     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 15371     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 15372     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 15373
 15374     IF MODIFY-CAP
 15375        MOVE AL-UNNOF            TO PDAMTA
 15376                                    NODAYSA
 15377                                    NOPMTSA
 15378        MOVE AL-UANOF            TO PDTHRUA.
 15379     MOVE PI-COMPANY-ID          TO CNTL-CO-ID
 15380     MOVE '2'                    TO CNTL-REC-TYPE
 15381     MOVE +0                     TO CNTL-SEQ-NO
 15382     MOVE PI-PROCESSOR-ID        TO CNTL-PROC-ID
 15383
 15384
 15385* EXEC CICS READ
 15386*         DATASET  (CNTL-FILE-ID)
 15387*         SET      (ADDRESS OF CONTROL-FILE)
 15388*         RIDFLD   (CNTL-KEY)
 15389*         RESP     (WS-RESPONSE)
 15390*    END-EXEC
 15391*    MOVE '&"S        E          (  N#00012900' TO DFHEIV0
 15392     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15393     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15394     MOVE X'204E233030303132393030' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 287
* EL131.cbl
 15395     CALL 'kxdfhei1' USING DFHEIV0,
 15396           CNTL-FILE-ID,
 15397           DFHEIV20,
 15398           DFHEIV99,
 15399           CNTL-KEY,
 15400           DFHEIV99,
 15401           DFHEIV99,
 15402           DFHEIV99
 15403     SET ADDRESS OF CONTROL-FILE TO
 15404         DFHEIV20
 15405     MOVE EIBRESP  TO WS-RESPONSE
 15406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15407
 15408     IF WS-RESP-NORMAL
 15409        MOVE CF-APPROVAL-LEVEL   TO PI-APPROVAL-LEVEL
 15410     end-if
 15411     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 15412         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 15413         MOVE SPACES             TO DC-OPTION-CODE
 15414         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15415         MOVE DC-GREG-DATE-1-EDIT TO INCO
 15416     ELSE
 15417         MOVE SPACES             TO INCO.
 15418
 15419     IF (CL-NO-OF-PMTS-MADE = ZEROS)
 15420        OR (PI-APPROVAL-LEVEL = '4' OR '5')
 15421        MOVE AL-UANOF            TO INCA
 15422     end-if
 15423     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 15424
 15425     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 15426         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 15427         MOVE SPACES             TO DC-OPTION-CODE
 15428         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15429         MOVE DC-GREG-DATE-1-EDIT TO REPO
 15430     ELSE
 15431         MOVE SPACES             TO REPO.
 15432
 15433     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 15434         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 15435         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15436         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15437         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 15438     ELSE
 15439         MOVE SPACES             TO ESTO.
 15440
 15441     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 15442         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 15443         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15444         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15445         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 15446     ELSE
 15447         MOVE SPACES             TO MNTDTO.
 15448
 15449
 15450     IF CL-LAST-MAINT-TYPE = SPACE
 15451         MOVE 'SET-UP'           TO MNTTYPEO
 15452     ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 288
* EL131.cbl
 15453     IF CL-LAST-MAINT-TYPE = '1'
 15454         MOVE 'PAYMNT'           TO MNTTYPEO
 15455     ELSE
 15456     IF CL-LAST-MAINT-TYPE = '2'
 15457         MOVE 'LETTER'           TO MNTTYPEO
 15458     ELSE
 15459     IF CL-LAST-MAINT-TYPE = '3'
 15460         MOVE 'UPDATE'           TO MNTTYPEO
 15461     ELSE
 15462     IF CL-LAST-MAINT-TYPE = '4'
 15463         MOVE 'RESTOR'           TO MNTTYPEO
 15464     ELSE
 15465     IF CL-LAST-MAINT-TYPE = '5'
 15466         MOVE 'INC DT'           TO MNTTYPEO
 15467     ELSE
 15468     IF CL-LAST-MAINT-TYPE = '6'
 15469         MOVE ' CONV'            TO MNTTYPEO
 15470     ELSE
 15471     IF CL-LAST-MAINT-TYPE = 'C'
 15472         MOVE 'CHGBEN'           TO MNTTYPEO
 15473     ELSE
 15474     IF CL-LAST-MAINT-TYPE = 'E'
 15475         MOVE 'ERRCOR'           TO MNTTYPEO
 15476     ELSE
 15477         MOVE SPACES             TO MNTTYPEO.
 15478
 15479     MOVE CL-BENEFICIARY         TO BENEO.
 15480     MOVE CL-FILE-LOCATION       TO FILETOO.
 15481     IF CL-CRITICAL-PERIOD NOT NUMERIC
 15482        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 15483     END-IF
 15484     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 15485     IF CL-NO-OF-EXTENSIONS NOT NUMERIC
 15486        MOVE ZEROS               TO CL-NO-OF-EXTENSIONS
 15487     END-IF
 15488     MOVE CL-NO-OF-EXTENSIONS    TO EXTENSO
 15489*    MOVE CL-CRIT-PER-RECURRENT
 15490*                                TO CRITPTO
 15491*    IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 15492*       MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 15493*    END-IF
 15494*    MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 15495     MOVE CL-PRIORITY-CD         TO PRICDO.
 15496     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 15497     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 15498     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 15499     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 15500
 15501 5020-EXIT.
 15502     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 289
* EL131.cbl
 15504 5030-MOVE-CERT.
 15505
 15506     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 15507         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 15508         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15509         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15510         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 15511       ELSE
 15512         MOVE SPACES             TO CERTEFFO
 15513         MOVE ZERO               TO HOLD-DATE.
 15514
 15515     MOVE CM-ACCOUNT             TO CERTACTO.
 15516     MOVE CM-STATE               TO CERTSTO PI-STATE.
 15517     MOVE CM-GROUPING            TO CERTGRPO.
 15518     MOVE CM-CARRIER             TO CERTCARO.
 15519     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 15520     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 15521     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 15522     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 15523     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 15524     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 15525     MOVE CM-JT-INITIAL          TO JNTINITO.
 15526     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 15527
 15528*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 15529     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 15530     MOVE '3'                    TO CNTL-REC-TYPE.
 15531     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 15532     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 15533     MOVE ZERO                   TO CNTL-SEQ-NO.
 15534
 15535
 15536* EXEC CICS READ
 15537*         SET        (ADDRESS OF CONTROL-FILE)
 15538*         DATASET    ('ELCNTL')
 15539*         RIDFLD     (CNTL-KEY)
 15540*         RESP       (WS-RESPONSE)
 15541*    END-EXEC.
 15542     MOVE 'ELCNTL' TO DFHEIV1
 15543*    MOVE '&"S        E          (  N#00013034' TO DFHEIV0
 15544     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15545     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15546     MOVE X'204E233030303133303334' TO DFHEIV0(25:11)
 15547     CALL 'kxdfhei1' USING DFHEIV0,
 15548           DFHEIV1,
 15549           DFHEIV20,
 15550           DFHEIV99,
 15551           CNTL-KEY,
 15552           DFHEIV99,
 15553           DFHEIV99,
 15554           DFHEIV99
 15555     SET ADDRESS OF CONTROL-FILE TO
 15556         DFHEIV20
 15557     MOVE EIBRESP  TO WS-RESPONSE
 15558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15559
 15560
 15561     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 290
* EL131.cbl
 15562        MOVE ZERO                TO CP-FREE-LOOK
 15563     ELSE
 15564        MOVE CF-ST-FREE-LOOK-PERIOD
 15565                                 TO CP-FREE-LOOK.
 15566
 15567     IF CM-LF-BENEFIT-CD = '00'
 15568        GO TO 5030-MOVE-CERT-AH.
 15569
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 291
* EL131.cbl
 15571     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 15572     MOVE '5'                    TO DC-OPTION-CODE
 15573     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15574     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 15575     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15576     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 15577     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 15578     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15579     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15580     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 15581     MOVE '4'                    TO CP-REM-TERM-METHOD
 15582     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 15583     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15584     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15585
 15586     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 15587     IF CM-LF-PREMIUM-RATE NUMERIC
 15588         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 15589     ELSE
 15590         MOVE ZEROS              TO LCVRATEO.
 15591
 15592     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 15593         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 15594
 15595     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 15596
 15597     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 15598
 15599     IF CM-LF-CURRENT-STATUS = '8'
 15600        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 15601            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 15602            MOVE ' '             TO DC-OPTION-CODE
 15603            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15604            IF NOT DATE-CONVERSION-ERROR
 15605                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15606
 15607     IF CM-LF-CURRENT-STATUS = '7'
 15608        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 15609            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 15610            MOVE ' '             TO DC-OPTION-CODE
 15611            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15612            IF NOT DATE-CONVERSION-ERROR
 15613                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 15614
 15615     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 15616         MOVE ' '                TO DC-OPTION-CODE
 15617         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 15618         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15619         IF NOT DATE-CONVERSION-ERROR
 15620             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 15621             MOVE HOLD-MONTH     TO WORK-MONTH
 15622             MOVE HOLD-YEAR      TO WORK-YEAR
 15623             MOVE WORK-DATE-MY   TO LCVEXITO.
 15624
 15625     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 15626        IF CP-REMAINING-TERM-3 = ZEROS
 15627           MOVE 'EXPIRED'        TO LCVSTATO
 15628        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 292
* EL131.cbl
 15629           MOVE 'ACTIVE'         TO LCVSTATO.
 15630
 15631     IF CM-LF-CURRENT-STATUS = '2'
 15632        MOVE 'PEND   '           TO LCVSTATO.
 15633     IF CM-LF-CURRENT-STATUS = '3'
 15634        MOVE 'RESTORE'           TO LCVSTATO.
 15635     IF CM-LF-CURRENT-STATUS = '5'
 15636        MOVE 'REISSUE'           TO LCVSTATO.
 15637     IF CM-LF-CURRENT-STATUS = '6'
 15638        MOVE 'LMP DIS'           TO LCVSTATO.
 15639     IF CM-LF-CURRENT-STATUS = '7'
 15640        MOVE 'DEATH  '           TO LCVSTATO.
 15641     IF CM-LF-CURRENT-STATUS = '8'
 15642        MOVE 'CANCEL '           TO LCVSTATO.
 15643     IF CM-LF-CURRENT-STATUS = '9'
 15644        MOVE 'RE-ONLY'           TO LCVSTATO.
 15645     IF CM-LF-CURRENT-STATUS = 'V'
 15646        MOVE 'VOID   '           TO LCVSTATO.
 15647     IF CM-LF-CURRENT-STATUS = 'D'
 15648        MOVE 'DECLINE'           TO LCVSTATO.
 15649
 15650     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15651     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15652     MOVE '4'                    TO BEN-REC-TYPE.
 15653     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 15654     MOVE ZERO                   TO BEN-SEQ-NO.
 15655
 15656
 15657* EXEC CICS READ GTEQ
 15658*         DATASET  (CNTL-FILE-ID)
 15659*         RIDFLD   (BENEFIT-KEY)
 15660*         SET      (ADDRESS OF CONTROL-FILE)
 15661*    END-EXEC.
 15662*    MOVE '&"S        G          (   #00013136' TO DFHEIV0
 15663     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15664     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15665     MOVE X'2020233030303133313336' TO DFHEIV0(25:11)
 15666     CALL 'kxdfhei1' USING DFHEIV0,
 15667           CNTL-FILE-ID,
 15668           DFHEIV20,
 15669           DFHEIV99,
 15670           BENEFIT-KEY,
 15671           DFHEIV99,
 15672           DFHEIV99,
 15673           DFHEIV99
 15674     SET ADDRESS OF CONTROL-FILE TO
 15675         DFHEIV20
 15676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15677
 15678
 15679     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15680        CF-RECORD-TYPE NOT = '4'
 15681         MOVE ER-0240            TO EMI-ERROR
 15682         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15683         GO TO 5030-MOVE-CERT-FINISH.
 15684
 15685     MOVE ZERO                   TO COUNT-2.
 15686     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 293
* EL131.cbl
 15687
 15688     IF SCREEN-ERROR
 15689         MOVE ER-0282            TO EMI-ERROR
 15690         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15691        ELSE
 15692         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 15693
 15694 5030-MOVE-CERT-AH.
 15695
 15696     IF CM-LF-BENEFIT-CD = '00'
 15697         IF CM-AH-BENEFIT-CD = '00'
 15698             GO TO 5030-MOVE-CERT-FINISH.
 15699
 15700     IF CM-AH-BENEFIT-CD = '00'
 15701        MOVE SPACES             TO ACVKINDO
 15702        COMPUTE PI-PAYMENT-AMT =
 15703                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 15704        GO TO 5030-MOVE-CERT-FINISH.
 15705
 15706     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15707     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 15708     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 15709     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 15710     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 15711     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15712     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15713     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 15714
 15715**DMD **********************************************
 15716     IF PI-COMPANY-ID = 'DMD'
 15717         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 15718                                   CM-PMT-EXTENSION-DAYS
 15719         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 15720                                      CL-NO-OF-DAYS-PAID
 15721         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 15722             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 15723         MOVE WS-REM-MOS         TO ACVRTRMO
 15724                                    CP-REMAINING-TERM-3
 15725*        MOVE WS-REM-DAYS        TO DAYSPO
 15726         GO TO 5030-SKIP-RTRM.
 15727**DMD **********************************************
 15728
 15729     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15730     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15731     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 15732     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15733
 15734 5030-SKIP-RTRM.
 15735     IF CM-AH-PREMIUM-RATE NUMERIC
 15736         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15737     ELSE
 15738         MOVE ZEROS              TO ACVRATEO.
 15739
 15740     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 15741     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 15742
 15743     IF CM-AH-CURRENT-STATUS = '8'
 15744        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 294
* EL131.cbl
 15745            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15746            MOVE ' '             TO DC-OPTION-CODE
 15747            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15748            IF NOT DATE-CONVERSION-ERROR
 15749                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15750
 15751     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15752        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15753            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 15754            MOVE ' '             TO DC-OPTION-CODE
 15755            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15756            IF NOT DATE-CONVERSION-ERROR
 15757                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 15758
 15759     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15760        IF CP-REMAINING-TERM-3 = ZEROS
 15761           MOVE 'EXPIRED'        TO ACVSTATO
 15762        ELSE
 15763           MOVE 'ACTIVE'         TO ACVSTATO.
 15764
 15765     IF CM-AH-CURRENT-STATUS = '2'
 15766        MOVE 'PEND   '           TO ACVSTATO.
 15767     IF CM-AH-CURRENT-STATUS = '3'
 15768        MOVE 'RESTORE'           TO ACVSTATO.
 15769     IF CM-AH-CURRENT-STATUS = '5'
 15770        MOVE 'REISSUE'           TO ACVSTATO.
 15771     IF CM-AH-CURRENT-STATUS = '6'
 15772        MOVE 'LMP DIS'           TO ACVSTATO.
 15773     IF CM-AH-CURRENT-STATUS = '7'
 15774        MOVE 'DEATH  '           TO ACVSTATO.
 15775     IF CM-AH-CURRENT-STATUS = '8'
 15776        MOVE 'CANCEL '           TO ACVSTATO.
 15777     IF CM-AH-CURRENT-STATUS = '9'
 15778        MOVE 'RE-ONLY'           TO ACVSTATO.
 15779     IF CM-AH-CURRENT-STATUS = 'V'
 15780        MOVE 'VOID   '           TO ACVSTATO.
 15781     IF CM-AH-CURRENT-STATUS = '9'
 15782        MOVE 'DECLINE'           TO ACVSTATO.
 15783
 15784     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15785         MOVE ' '                TO DC-OPTION-CODE
 15786         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15787         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15788         IF NOT DATE-CONVERSION-ERROR
 15789             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 15790             MOVE HOLD-MONTH     TO WORK-MONTH
 15791             MOVE HOLD-YEAR      TO WORK-YEAR
 15792             MOVE WORK-DATE-MY   TO ACVEXITO.
 15793
 15794     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 15795
 15796     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 15797     MOVE '5'                    TO BEN-REC-TYPE.
 15798     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 15799     MOVE ZERO                   TO BEN-SEQ-NO.
 15800
 15801
 15802* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 295
* EL131.cbl
 15803*         DATASET  (CNTL-FILE-ID)
 15804*         RIDFLD   (BENEFIT-KEY)
 15805*         SET      (ADDRESS OF CONTROL-FILE)
 15806*    END-EXEC.
 15807*    MOVE '&"S        G          (   #00013264' TO DFHEIV0
 15808     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15810     MOVE X'2020233030303133323634' TO DFHEIV0(25:11)
 15811     CALL 'kxdfhei1' USING DFHEIV0,
 15812           CNTL-FILE-ID,
 15813           DFHEIV20,
 15814           DFHEIV99,
 15815           BENEFIT-KEY,
 15816           DFHEIV99,
 15817           DFHEIV99,
 15818           DFHEIV99
 15819     SET ADDRESS OF CONTROL-FILE TO
 15820         DFHEIV20
 15821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15822
 15823
 15824     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 15825        CF-RECORD-TYPE NOT = '5'
 15826         MOVE ER-0250            TO EMI-ERROR
 15827         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15828         GO TO 5030-MOVE-CERT-FINISH.
 15829
 15830     MOVE ZERO                   TO COUNT-2.
 15831     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 15832
 15833     IF SCREEN-ERROR
 15834         MOVE ER-0283            TO EMI-ERROR
 15835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15836       ELSE
 15837         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 15838
 15839 5030-MOVE-CERT-FINISH.
 15840
 15841     MOVE CM-LOAN-APR            TO APRO.
 15842     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15843     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15844     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 15845*    MOVE CM-LOAN-NUMBER         TO LOANNOO
 15846     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 15847     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 15848
 15849     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 15850         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15851         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 15852         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 15853         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 15854     ELSE
 15855         MOVE SPACES               TO ADDONDTO.
 15856
 15857     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 15858
 15859 5030-EXIT.
 15860     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 296
* EL131.cbl
 15862 5040-FIND-BENEFIT.
 15863     ADD 1                       TO COUNT-2.
 15864     IF COUNT-2 GREATER THAN 8
 15865         GO TO 5050-BENEFIT-NOTFND.
 15866
 15867     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 15868         GO TO 5060-EXIT.
 15869
 15870     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 15871         GO TO 5050-BENEFIT-NOTFND.
 15872
 15873     GO TO 5040-FIND-BENEFIT.
 15874
 15875 5050-BENEFIT-NOTFND.
 15876     MOVE 'X'                    TO ERROR-SWITCH.
 15877
 15878 5060-EXIT.
 15879     EXIT.
 15880 5100-LOAD-CORR-TRLR.
 15881     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 15882     MOVE PI-CARRIER         TO TRLR-CARRIER.
 15883     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 15884     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 15885     MOVE 1000               TO TRLR-SEQ-NO.
 15886
 15887
 15888* EXEC CICS HANDLE CONDITION
 15889*         NOTFND    (1052-DONE)
 15890*         ENDFILE   (1052-DONE)
 15891*    END-EXEC.
 15892*    MOVE '"$I''                  ! D #00013333' TO DFHEIV0
 15893     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 15894     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15895     MOVE X'4420233030303133333333' TO DFHEIV0(25:11)
 15896     CALL 'kxdfhei1' USING DFHEIV0
 15897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15898
 15899
 15900
 15901* EXEC CICS STARTBR
 15902*        DATASET (TRLR-FILE-ID)
 15903*        RIDFLD  (TRLR-KEY)
 15904*    END-EXEC
 15905     MOVE 0
 15906       TO DFHEIV11
 15907*    MOVE '&,         G          &   #00013338' TO DFHEIV0
 15908     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15909     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15910     MOVE X'2020233030303133333338' TO DFHEIV0(25:11)
 15911     CALL 'kxdfhei1' USING DFHEIV0,
 15912           TRLR-FILE-ID,
 15913           TRLR-KEY,
 15914           DFHEIV99,
 15915           DFHEIV11,
 15916           DFHEIV99
 15917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15918
 15919
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 297
* EL131.cbl
 15920     MOVE SPACES TO WS-TRLR-FILE-EOF
 15921                    WS-AUTH-RCVD
 15922     PERFORM 1052-READ-TRLR THRU 1052-EXIT
 15923       UNTIL  TRLR-FILE-EOF
 15924         OR WS-AUTH-RCVD > SPACES.
 15925
 15926
 15927* EXEC CICS ENDBR
 15928*        DATASET (TRLR-FILE-ID)
 15929*    END-EXEC.
 15930     MOVE 0
 15931       TO DFHEIV11
 15932*    MOVE '&2                    $   #00013350' TO DFHEIV0
 15933     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15934     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15935     MOVE X'2020233030303133333530' TO DFHEIV0(25:11)
 15936     CALL 'kxdfhei1' USING DFHEIV0,
 15937           TRLR-FILE-ID,
 15938           DFHEIV11,
 15939           DFHEIV99
 15940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15941
 15942
 15943     IF AUTH-RCVD
 15944        MOVE 'Y' TO AUTHRCVO
 15945     ELSE
 15946        MOVE 'N' TO AUTHRCVO
 15947     END-IF.
 15948
 15949
 15950 5100-EXIT.
 15951     EXIT.
 15952
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 298
* EL131.cbl
 15954 6000-CALCULATE-CERT-TERM.
 15955
 15956     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 15957         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 15958     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 15959         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 15960     IF CM-LOAN-APR NOT NUMERIC
 15961         MOVE ZEROS              TO CM-LOAN-APR.
 15962
 15963*    IF WS-CALC-METHOD  = 'G'
 15964         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 15965*     ELSE
 15966*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 15967
 15968     IF N GREATER 120
 15969         MOVE 120                TO N.
 15970
 15971     MOVE '6'                    TO DC-OPTION-CODE.
 15972     MOVE N                      TO DC-ELAPSED-MONTHS.
 15973     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 15974     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 15975
 15976     IF CM-LF-BENEFIT-CD NOT = ZERO
 15977         MOVE N                  TO CM-LF-ORIG-TERM
 15978         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 15979         IF NO-CONVERSION-ERROR
 15980             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 15981
 15982     IF CM-AH-BENEFIT-CD NOT = ZERO
 15983         MOVE N                  TO CM-AH-ORIG-TERM
 15984         IF NO-CONVERSION-ERROR
 15985             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 15986
 15987 6000-EXIT.
 15988      EXIT.
 15989
 15990 6100-CALC-GROSS-TERM.
 15991     MOVE CM-LOAN-BALANCE         TO L.
 15992     MOVE PI-PAYMENT-AMT          TO M.
 15993
 15994     COMPUTE N = L / M.
 15995     IF N LESS 1
 15996         MOVE 1  TO N.
 15997
 15998     IF CM-LF-BENEFIT-CD NOT = ZERO
 15999         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 16000     ELSE
 16001         MOVE ZEROS               TO WS-LF-RATE.
 16002
 16003     IF CM-AH-BENEFIT-CD NOT = ZERO
 16004         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 16005     ELSE
 16006         MOVE ZEROS               TO WS-AH-RATE.
 16007
 16008     COMPUTE I = CM-LOAN-APR / +1200.
 16009
 16010 6105-LOOP.
 16011     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 299
* EL131.cbl
 16012         GO TO 6200-EXIT.
 16013     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 16014     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 16015         ADD 1 TO N
 16016         GO TO 6105-LOOP.
 16017
 16018 6200-EXIT.
 16019      EXIT.
 16020
 16021 6210-CALC-LEFT-RIGHTONE.
 16022      MOVE L         TO LEFT-TOT-1.
 16023      SUBTRACT 1 FROM N.
 16024      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 16025      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 16026      ADD 1 TO N.
 16027 6211-CALC-TERM1.
 16028      MOVE N         TO TERM1.
 16029      MULTIPLY M BY TERM1.
 16030 6212-LOOP.
 16031      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 16032      ADD 1 TO A-N.
 16033      MULTIPLY A-N BY TERM1.
 16034      SUBTRACT 1 FROM A-N.
 16035      ADD TERM1 TO LEFT-TOT-1.
 16036 6213-CALC-TERM2.
 16037      MOVE M         TO TERM2.
 16038      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 16039      MULTIPLY IA-N BY TERM2.
 16040      SUBTRACT TERM2 FROM LEFT-TOT-1.
 16041 6215-CALC-RIGHTONE.
 16042      MOVE M         TO RIGHT-TOT-1.
 16043      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 16044      MULTIPLY A-N BY RIGHT-TOT-1.
 16045 6220-EXIT.
 16046      EXIT.
 16047
 16048 6300-CALC-A-N.
 16049     IF N LESS 1
 16050         MOVE 0     TO A-N
 16051         GO TO 6300-EXIT.
 16052     IF I = 0
 16053         MOVE .00001 TO I.
 16054     ADD 1 TO I.
 16055     DIVIDE I INTO 1 GIVING V.
 16056     SUBTRACT 1 FROM I.
 16057     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16058     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 16059     DIVIDE I INTO TERM3 GIVING A-N.
 16060 6300-EXIT.
 16061      EXIT.
 16062
 16063 6350-CALC-IA-N.
 16064     IF N LESS 1
 16065         MOVE 0      TO IA-N
 16066         GO TO 6400-EXIT.
 16067     ADD 1 TO N.
 16068     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 16069     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 300
* EL131.cbl
 16070     MULTIPLY N BY V-EX-N GIVING TERM3.
 16071     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 16072     SUBTRACT V FROM 1 GIVING TERM4.
 16073     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 16074 6400-EXIT.
 16075      EXIT.
 16076
 16077 6450-CALC-V-EX-N.
 16078     IF N LESS 1
 16079         MOVE 1    TO V-EX-N
 16080         GO TO 6490-EXIT.
 16081     MOVE N        TO NV-STORE.
 16082     IF V-EX-ONETIME = 1  OR
 16083        V NOT = V-EXPONENT (1)
 16084          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 16085 6460-LOOP.
 16086     IF N GREATER 248
 16087         MOVE 248 TO N.
 16088     IF N = 1
 16089         MOVE V               TO V-EX-N
 16090      ELSE
 16091         MOVE V-EXPONENT (N)  TO V-EX-N.
 16092     GO TO 6490-EXIT.
 16093
 16094 6470-BUILD-V-EX-TABLE.
 16095     MOVE 2      TO N.
 16096     MOVE V      TO V-EXPONENT (1)
 16097                    V-EX-N.
 16098 6471-LOOP.
 16099     MULTIPLY V BY V-EX-N.
 16100     MOVE V-EX-N   TO V-EXPONENT (N).
 16101     ADD 1 TO N.
 16102     IF N LESS 248
 16103         GO TO 6471-LOOP.
 16104     MOVE NV-STORE     TO N.
 16105     MOVE 0            TO V-EX-ONETIME.
 16106 6480-EXIT.
 16107      EXIT.
 16108
 16109 6490-EXIT.
 16110      EXIT.
 16111
 16112 6500-CALC-NET-TERM.
 16113     MOVE CM-LOAN-BALANCE         TO L.
 16114     MOVE PI-PAYMENT-AMT          TO M.
 16115
 16116     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 16117     IF WS-REMAIN GREATER ZERO
 16118         ADD 1 TO N.
 16119     IF N = 0
 16120         MOVE 1 TO N.
 16121
 16122 6700-EXIT.
 16123      EXIT.
 16124
 16125 6999-CALC-TERM-EXIT.
 16126     EXIT.
 16127
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 301
* EL131.cbl
 16129 7000-RESET-ATTRIBUTE.
 16130
 16131     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 16132                                    CERTSTA   CERTCARA
 16133                                    CERTGRPA.
 16134     MOVE -1                     TO CERTCARL.
 16135
 16136 7000-EXIT.
 16137     EXIT.
 16138
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 302
* EL131.cbl
 16140 7600-BROWSE-CLAIM.
 16141
 16142
 16143* EXEC CICS READ
 16144*        DATASET(CLMS-FILE-ID)
 16145*        SET    (ADDRESS OF CLAIM-MASTER)
 16146*        RIDFLD (MSTR-KEY)
 16147*        GENERIC
 16148*        EQUAL
 16149*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16150*    END-EXEC.
 16151*    MOVE '&"S  KG    E          (   #00013553' TO DFHEIV0
 16152     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16154     MOVE X'2020233030303133353533' TO DFHEIV0(25:11)
 16155     CALL 'kxdfhei1' USING DFHEIV0,
 16156           CLMS-FILE-ID,
 16157           DFHEIV20,
 16158           DFHEIV99,
 16159           MSTR-KEY,
 16160           ELMSTR-GENERIC-LENGTH,
 16161           DFHEIV99,
 16162           DFHEIV99
 16163     SET ADDRESS OF CLAIM-MASTER TO
 16164         DFHEIV20
 16165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16166
 16167
 16168     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 16169
 16170     if cl-assoc-cert-total = 0
 16171        move 1 to cl-assoc-cert-total
 16172     end-if
 16173     IF CL-ASSOC-CERT-SEQU = 0
 16174        MOVE 1 TO CL-ASSOC-CERT-SEQU
 16175     END-IF
 16176
 16177     IF CL-ASSOC-CERT-TOTAL = 1
 16178         MOVE AL-SADOF           TO BCERT1A
 16179                                    BSUFX1A
 16180                                    BCERT2A
 16181                                    BSUFX2A
 16182                                    BCERT3A
 16183                                    BSUFX3A
 16184                                    BCERT4A
 16185                                    BSUFX4A
 16186                                    BCERT5A
 16187                                    BSUFX5A
 16188                                    PCERTNOA
 16189                                    PSUFXA
 16190                                    LABEL1A
 16191                                    LABEL2A
 16192         GO TO 7699-EXIT.
 16193
 16194 7610-BROWSE-CLAIM-LOOP.
 16195
 16196     MOVE LOW-VALUES             TO BCERT1O
 16197                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 303
* EL131.cbl
 16198                                    BCERT2O
 16199                                    BSUFX2O
 16200                                    BCERT3O
 16201                                    BSUFX3O
 16202                                    BCERT4O
 16203                                    BSUFX4O
 16204                                    BCERT5O
 16205                                    BSUFX5O.
 16206
 16207
 16208* EXEC CICS HANDLE CONDITION
 16209*        ENDFILE  (7630-END-BROWSE)
 16210*    END-EXEC.
 16211*    MOVE '"$''                   ! E #00013601' TO DFHEIV0
 16212     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16213     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16214     MOVE X'4520233030303133363031' TO DFHEIV0(25:11)
 16215     CALL 'kxdfhei1' USING DFHEIV0
 16216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16217
 16218
 16219
 16220* EXEC CICS STARTBR
 16221*        DATASET    (CLMS-FILE-ID)
 16222*        RIDFLD     (MSTR-KEY)
 16223*    END-EXEC.
 16224     MOVE 0
 16225       TO DFHEIV11
 16226*    MOVE '&,         G          &   #00013605' TO DFHEIV0
 16227     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16228     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16229     MOVE X'2020233030303133363035' TO DFHEIV0(25:11)
 16230     CALL 'kxdfhei1' USING DFHEIV0,
 16231           CLMS-FILE-ID,
 16232           MSTR-KEY,
 16233           DFHEIV99,
 16234           DFHEIV11,
 16235           DFHEIV99
 16236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16237
 16238
 16239     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 16240
 16241 7620-READ-CLAIM-LOOP.
 16242
 16243
 16244* EXEC CICS READNEXT
 16245*        DATASET   (CLMS-FILE-ID)
 16246*        SET       (ADDRESS OF CLAIM-MASTER)
 16247*        RIDFLD    (MSTR-KEY)
 16248*    END-EXEC.
 16249     MOVE 0
 16250       TO DFHEIV11
 16251*    MOVE '&.S                   )   #00013614' TO DFHEIV0
 16252     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16253     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16254     MOVE X'2020233030303133363134' TO DFHEIV0(25:11)
 16255     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 304
* EL131.cbl
 16256           CLMS-FILE-ID,
 16257           DFHEIV20,
 16258           DFHEIV99,
 16259           MSTR-KEY,
 16260           DFHEIV99,
 16261           DFHEIV11,
 16262           DFHEIV99,
 16263           DFHEIV99
 16264     SET ADDRESS OF CLAIM-MASTER TO
 16265         DFHEIV20
 16266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16267
 16268
 16269     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 16270        CL-CARRIER     NOT = CARRI           OR
 16271        CL-CLAIM-NO    NOT = CLAIMI
 16272        GO TO 7630-END-BROWSE.
 16273
 16274     IF WS-ASSOCIATED-CERTS = 1
 16275         MOVE CL-CERT-PRIME      TO BCERT1O
 16276         MOVE CL-CERT-SFX        TO BSUFX1O.
 16277
 16278     IF WS-ASSOCIATED-CERTS = 2
 16279         MOVE CL-CERT-PRIME      TO BCERT2O
 16280         MOVE CL-CERT-SFX        TO BSUFX2O.
 16281
 16282     IF WS-ASSOCIATED-CERTS = 3
 16283         MOVE CL-CERT-PRIME      TO BCERT3O
 16284         MOVE CL-CERT-SFX        TO BSUFX3O.
 16285
 16286     IF WS-ASSOCIATED-CERTS = 4
 16287         MOVE CL-CERT-PRIME      TO BCERT4O
 16288         MOVE CL-CERT-SFX        TO BSUFX4O.
 16289
 16290     IF WS-ASSOCIATED-CERTS = 5
 16291         MOVE CL-CERT-PRIME      TO BCERT5O
 16292         MOVE CL-CERT-SFX        TO BSUFX5O
 16293     ELSE
 16294         ADD +1                  TO WS-ASSOCIATED-CERTS
 16295         GO TO 7620-READ-CLAIM-LOOP.
 16296
 16297 7630-END-BROWSE.
 16298
 16299
 16300* EXEC CICS ENDBR
 16301*        DATASET   (CLMS-FILE-ID)
 16302*    END-EXEC.
 16303     MOVE 0
 16304       TO DFHEIV11
 16305*    MOVE '&2                    $   #00013650' TO DFHEIV0
 16306     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16307     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16308     MOVE X'2020233030303133363530' TO DFHEIV0(25:11)
 16309     CALL 'kxdfhei1' USING DFHEIV0,
 16310           CLMS-FILE-ID,
 16311           DFHEIV11,
 16312           DFHEIV99
 16313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 305
* EL131.cbl
 16314
 16315
 16316 7640-HIGHLIGHT-CERT-DISPLAYED.
 16317
 16318     MOVE AL-SANON               TO BCERT1A
 16319                                    BSUFX1A
 16320                                    BCERT2A
 16321                                    BSUFX2A
 16322                                    BCERT3A
 16323                                    BSUFX3A
 16324                                    BCERT4A
 16325                                    BSUFX4A
 16326                                    BCERT5A
 16327                                    BSUFX5A.
 16328
 16329     IF BCERT1O = CERTI AND
 16330        BSUFX1O = SUFXI
 16331            MOVE AL-SABON        TO BCERT1A
 16332                                    BSUFX1A.
 16333
 16334     IF BCERT2O = CERTI AND
 16335        BSUFX2O = SUFXI
 16336            MOVE AL-SABON        TO BCERT2A
 16337                                    BSUFX2A.
 16338
 16339     IF BCERT3O = CERTI AND
 16340        BSUFX3O = SUFXI
 16341            MOVE AL-SABON        TO BCERT3A
 16342                                    BSUFX3A.
 16343
 16344     IF BCERT4O = CERTI AND
 16345        BSUFX4O = SUFXI
 16346            MOVE AL-SABON        TO BCERT4A
 16347                                    BSUFX4A.
 16348
 16349     IF BCERT5O = CERTI AND
 16350        BSUFX5O = SUFXI
 16351            MOVE AL-SABON        TO BCERT5A
 16352                                    BSUFX5A.
 16353
 16354 7699-EXIT.
 16355     EXIT.
 16356
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 306
* EL131.cbl
 16358 7700-CHECK-SEQUENCE.
 16359
 16360
 16361* EXEC CICS HANDLE CONDITION
 16362*        ENDFILE  (7799-EXIT)
 16363*        NOTFND   (7799-EXIT)
 16364*    END-EXEC.
 16365*    MOVE '"$''I                  ! F #00013698' TO DFHEIV0
 16366     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 16367     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16368     MOVE X'4620233030303133363938' TO DFHEIV0(25:11)
 16369     CALL 'kxdfhei1' USING DFHEIV0
 16370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16371
 16372
 16373
 16374* EXEC CICS READ
 16375*        DATASET(CLMS-FILE-ID)
 16376*        SET    (ADDRESS OF CLAIM-MASTER)
 16377*        RIDFLD (MSTR-KEY)
 16378*        GENERIC
 16379*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 16380*    END-EXEC.
 16381*    MOVE '&"S  KG    E          (   #00013703' TO DFHEIV0
 16382     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 16383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16384     MOVE X'2020233030303133373033' TO DFHEIV0(25:11)
 16385     CALL 'kxdfhei1' USING DFHEIV0,
 16386           CLMS-FILE-ID,
 16387           DFHEIV20,
 16388           DFHEIV99,
 16389           MSTR-KEY,
 16390           ELMSTR-GENERIC-LENGTH,
 16391           DFHEIV99,
 16392           DFHEIV99
 16393     SET ADDRESS OF CLAIM-MASTER TO
 16394         DFHEIV20
 16395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16396
 16397
 16398     COMPUTE WS-ASSOC-CERT-TOTAL =
 16399             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 16400
 16401     GO TO 7799-EXIT.
 16402
 16403 7710-RESEQUENCE-CLAIMS.
 16404
 16405
 16406* EXEC CICS HANDLE CONDITION
 16407*        ENDFILE  (7799-EXIT)
 16408*    END-EXEC.
 16409*    MOVE '"$''                   ! G #00013718' TO DFHEIV0
 16410     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 16411     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16412     MOVE X'4720233030303133373138' TO DFHEIV0(25:11)
 16413     CALL 'kxdfhei1' USING DFHEIV0
 16414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16415
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 307
* EL131.cbl
 16416
 16417
 16418* EXEC CICS STARTBR
 16419*        DATASET(CLMS-FILE-ID)
 16420*        RIDFLD (MSTR-KEY)
 16421*    END-EXEC.
 16422     MOVE 0
 16423       TO DFHEIV11
 16424*    MOVE '&,         G          &   #00013722' TO DFHEIV0
 16425     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16426     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16427     MOVE X'2020233030303133373232' TO DFHEIV0(25:11)
 16428     CALL 'kxdfhei1' USING DFHEIV0,
 16429           CLMS-FILE-ID,
 16430           MSTR-KEY,
 16431           DFHEIV99,
 16432           DFHEIV11,
 16433           DFHEIV99
 16434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16435
 16436
 16437     COMPUTE WS-ASSOC-CERT-SEQU =
 16438             WS-ASSOC-CERT-SEQU + 1.
 16439
 16440     COMPUTE WS-READNEXT-SWITCH =
 16441             WS-READNEXT-SWITCH + 1.
 16442
 16443 7720-READ-CLAIM-LOOP.
 16444
 16445
 16446* EXEC CICS READNEXT
 16447*        DATASET(CLMS-FILE-ID)
 16448*        SET    (ADDRESS OF CLAIM-MASTER)
 16449*        RIDFLD (MSTR-KEY)
 16450*    END-EXEC.
 16451     MOVE 0
 16452       TO DFHEIV11
 16453*    MOVE '&.S                   )   #00013735' TO DFHEIV0
 16454     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16455     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16456     MOVE X'2020233030303133373335' TO DFHEIV0(25:11)
 16457     CALL 'kxdfhei1' USING DFHEIV0,
 16458           CLMS-FILE-ID,
 16459           DFHEIV20,
 16460           DFHEIV99,
 16461           MSTR-KEY,
 16462           DFHEIV99,
 16463           DFHEIV11,
 16464           DFHEIV99,
 16465           DFHEIV99
 16466     SET ADDRESS OF CLAIM-MASTER TO
 16467         DFHEIV20
 16468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16469
 16470
 16471     IF WS-READNEXT-SWITCH = 1
 16472         ADD 1                   TO WS-READNEXT-SWITCH
 16473         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 308
* EL131.cbl
 16474
 16475 7730-END-BROWSE.
 16476
 16477
 16478* EXEC CICS ENDBR
 16479*        DATASET(CLMS-FILE-ID)
 16480*    END-EXEC.
 16481     MOVE 0
 16482       TO DFHEIV11
 16483*    MOVE '&2                    $   #00013747' TO DFHEIV0
 16484     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16485     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16486     MOVE X'2020233030303133373437' TO DFHEIV0(25:11)
 16487     CALL 'kxdfhei1' USING DFHEIV0,
 16488           CLMS-FILE-ID,
 16489           DFHEIV11,
 16490           DFHEIV99
 16491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16492
 16493
 16494 7740-READ-CLAIM-UPDATE.
 16495
 16496     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 16497        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 16498        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 16499        GO TO 7799-EXIT
 16500     ELSE
 16501        MOVE ZERO                TO WS-READNEXT-SWITCH.
 16502
 16503
 16504* EXEC CICS READ
 16505*        DATASET(CLMS-FILE-ID)
 16506*        SET    (ADDRESS OF CLAIM-MASTER)
 16507*        RIDFLD (MSTR-KEY)
 16508*        UPDATE
 16509*    END-EXEC.
 16510*    MOVE '&"S        EU         (   #00013760' TO DFHEIV0
 16511     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16512     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16513     MOVE X'2020233030303133373630' TO DFHEIV0(25:11)
 16514     CALL 'kxdfhei1' USING DFHEIV0,
 16515           CLMS-FILE-ID,
 16516           DFHEIV20,
 16517           DFHEIV99,
 16518           MSTR-KEY,
 16519           DFHEIV99,
 16520           DFHEIV99,
 16521           DFHEIV99
 16522     SET ADDRESS OF CLAIM-MASTER TO
 16523         DFHEIV20
 16524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16525
 16526
 16527     if (cl-priority-cd = '8')
 16528        and (pi-processor-id not = 'PEMA' and 'JMS '
 16529             AND 'AMWA')
 16530        MOVE ER-8003             TO EMI-ERROR
 16531        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 309
* EL131.cbl
 16532                                 THRU 9900-EXIT
 16533        MOVE -1                  TO MAINTL
 16534        GO TO 8110-SEND-DATA
 16535     end-if
 16536
 16537     IF PI-COMPANY-ID = 'CID' or 'AHL'
 16538         MOVE 'Y'                TO CL-YESNOSW
 16539     END-IF.
 16540
 16541     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 16542     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 16543
 16544
 16545* EXEC CICS REWRITE
 16546*         DATASET(CLMS-FILE-ID)
 16547*         FROM   (CLAIM-MASTER)
 16548*    END-EXEC.
 16549     MOVE LENGTH OF
 16550      CLAIM-MASTER
 16551       TO DFHEIV11
 16552*    MOVE '&& L                  %   #00013784' TO DFHEIV0
 16553     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16554     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16555     MOVE X'2020233030303133373834' TO DFHEIV0(25:11)
 16556     CALL 'kxdfhei1' USING DFHEIV0,
 16557           CLMS-FILE-ID,
 16558           CLAIM-MASTER,
 16559           DFHEIV11,
 16560           DFHEIV99
 16561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16562
 16563
 16564     GO TO 7710-RESEQUENCE-CLAIMS.
 16565
 16566 7799-EXIT.
 16567     EXIT.
 16568
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 310
* EL131.cbl
 16570 7800-CHECK-AUTO-ACTIVITY.
 16571
 16572
 16573* EXEC CICS HANDLE CONDITION
 16574*        NOTFND   (7800-NOT-FOUND)
 16575*    END-EXEC.
 16576*    MOVE '"$I                   ! H #00013797' TO DFHEIV0
 16577     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16579     MOVE X'4820233030303133373937' TO DFHEIV0(25:11)
 16580     CALL 'kxdfhei1' USING DFHEIV0
 16581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16582
 16583
 16584     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 16585     MOVE 'T'                        TO  CNTL-REC-TYPE.
 16586     MOVE SPACES                     TO  CNTL-PROC-ID.
 16587     MOVE +0                         TO  CNTL-SEQ-NO.
 16588
 16589
 16590* EXEC CICS READ
 16591*        DATASET   (CNTL-FILE-ID)
 16592*        RIDFLD    (CNTL-KEY)
 16593*        SET       (ADDRESS OF CONTROL-FILE)
 16594*    END-EXEC.
 16595*    MOVE '&"S        E          (   #00013806' TO DFHEIV0
 16596     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16597     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16598     MOVE X'2020233030303133383036' TO DFHEIV0(25:11)
 16599     CALL 'kxdfhei1' USING DFHEIV0,
 16600           CNTL-FILE-ID,
 16601           DFHEIV20,
 16602           DFHEIV99,
 16603           CNTL-KEY,
 16604           DFHEIV99,
 16605           DFHEIV99,
 16606           DFHEIV99
 16607     SET ADDRESS OF CONTROL-FILE TO
 16608         DFHEIV20
 16609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16610
 16611
 16612     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 16613         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 16614
 16615     IF CL-ACTIVITY-CODE NOT = ZEROS
 16616         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 16617         IF MISC-SUB IS GREATER THAN +9
 16618             SUBTRACT +9 FROM MISC-SUB
 16619             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 16620         ELSE
 16621             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 16622     ELSE
 16623         MOVE 'Y'                              TO  WS-RESET-SW.
 16624
 16625     IF STATUSI = 'C' OR 'CLOSED'
 16626         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 16627             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 311
* EL131.cbl
 16628                                         PI-LETTER-SW
 16629             GO TO 7800-EXIT.
 16630
 16631     IF STATUSI = 'C' OR 'CLOSED'
 16632         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 16633             MOVE 'N'                TO  PI-LETTER-SW
 16634         ELSE
 16635             MOVE 'Y'                TO  PI-LETTER-SW.
 16636
 16637     IF STATUSI = 'O' OR 'OPEN'
 16638         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 16639             MOVE 'N'                TO  PI-REC-FOUND-SW
 16640                                         PI-LETTER-SW
 16641             GO TO 7800-EXIT.
 16642
 16643     IF STATUSI = 'O' OR 'OPEN'
 16644         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 16645             MOVE 'N'                TO  PI-LETTER-SW
 16646         ELSE
 16647             MOVE 'Y'                TO  PI-LETTER-SW.
 16648
 16649     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 16650     GO TO 7800-EXIT.
 16651
 16652 7800-NOT-FOUND.
 16653
 16654     MOVE 'N'                        TO  PI-REC-FOUND-SW
 16655                                         PI-LETTER-SW.
 16656
 16657 7800-EXIT.
 16658     EXIT.
 16659
 16660 7850-AUTO-LETTER-WRITER.
 16661
 16662     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 16663     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 16664
 16665     IF STATUSI = 'C' OR 'CLOSED'
 16666         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 16667     ELSE
 16668         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 16669
 16670     IF STATUSI = 'C' OR 'CLOSED'
 16671         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 16672             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16673             MOVE '6'                TO  DC-OPTION-CODE
 16674             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 16675             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16676             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16677             IF NO-CONVERSION-ERROR
 16678                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16679             ELSE
 16680                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16681
 16682     IF STATUSI = 'C' OR 'CLOSED'
 16683         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 16684             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16685             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 312
* EL131.cbl
 16686             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 16687             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16688             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16689             IF NO-CONVERSION-ERROR
 16690                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16691             ELSE
 16692                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16693
 16694     IF STATUSI = 'O' OR 'OPEN'
 16695         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 16696             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16697             MOVE '6'                TO  DC-OPTION-CODE
 16698             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 16699             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16700             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16701             IF NO-CONVERSION-ERROR
 16702                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 16703             ELSE
 16704                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 16705
 16706     IF STATUSI = 'O' OR 'OPEN'
 16707         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 16708             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 16709             MOVE '6'                TO  DC-OPTION-CODE
 16710             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 16711             MOVE +0                 TO  DC-ELAPSED-MONTHS
 16712             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 16713             IF NO-CONVERSION-ERROR
 16714                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 16715             ELSE
 16716                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 16717
 16718
 16719* EXEC CICS LINK
 16720*        PROGRAM    (LINK-1523)
 16721*        COMMAREA   (W-1523-LINKDATA)
 16722*        LENGTH     (W-1523-COMM-LENGTH)
 16723*    END-EXEC.
 16724*    MOVE '."C                   (   #00013918' TO DFHEIV0
 16725     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16726     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16727     MOVE X'2020233030303133393138' TO DFHEIV0(25:11)
 16728     CALL 'kxdfhei1' USING DFHEIV0,
 16729           LINK-1523,
 16730           W-1523-LINKDATA,
 16731           W-1523-COMM-LENGTH,
 16732           DFHEIV99,
 16733           DFHEIV99,
 16734           DFHEIV99,
 16735           DFHEIV99
 16736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16737
 16738
 16739     IF W-1523-ERROR-CODE = ZEROS
 16740         GO TO 7850-EXIT.
 16741
 16742     IF W-1523-FATAL-ERROR
 16743         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 313
* EL131.cbl
 16744         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16745
 16746     IF W-1523-ERROR-CODE = 0191
 16747         MOVE ER-0803                TO  EMI-ERROR
 16748         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16749
 16750 7850-EXIT.
 16751     EXIT.
 16752
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 314
* EL131.cbl
 16754 8000-CREATE-DMO-REC.
 16755     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 16756     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 16757     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 16758
 16759
 16760* EXEC CICS HANDLE CONDITION
 16761*         NOTFND   (8000-NOTE-NOT-FOUND)
 16762*    END-EXEC.
 16763*    MOVE '"$I                   ! I #00013944' TO DFHEIV0
 16764     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16766     MOVE X'4920233030303133393434' TO DFHEIV0(25:11)
 16767     CALL 'kxdfhei1' USING DFHEIV0
 16768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16769
 16770
 16771
 16772* EXEC CICS READ
 16773*         DATASET(NOTE-FILE-ID)
 16774*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 16775*         RIDFLD (NOTE-KEY)
 16776*    END-EXEC.
 16777*    MOVE '&"S        E          (   #00013948' TO DFHEIV0
 16778     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16779     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16780     MOVE X'2020233030303133393438' TO DFHEIV0(25:11)
 16781     CALL 'kxdfhei1' USING DFHEIV0,
 16782           NOTE-FILE-ID,
 16783           DFHEIV20,
 16784           DFHEIV99,
 16785           NOTE-KEY,
 16786           DFHEIV99,
 16787           DFHEIV99,
 16788           DFHEIV99
 16789     SET ADDRESS OF CERTIFICATE-NOTE TO
 16790         DFHEIV20
 16791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16792
 16793
 16794     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 16795     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 16796     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 16797
 16798     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 16799         MOVE 'CC'               TO DCT-PRODUCT-CODE
 16800     ELSE
 16801         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 16802
 16803     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 16804     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 16805
 16806
 16807* EXEC CICS LINK
 16808*        PROGRAM    ('DLO006')
 16809*        COMMAREA   (DCT-COMMUNICATION-AREA)
 16810*        LENGTH     (WS-DCT-LENGTH)
 16811*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 315
* EL131.cbl
 16812     MOVE 'DLO006' TO DFHEIV1
 16813*    MOVE '."C                   (   #00013966' TO DFHEIV0
 16814     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16815     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16816     MOVE X'2020233030303133393636' TO DFHEIV0(25:11)
 16817     CALL 'kxdfhei1' USING DFHEIV0,
 16818           DFHEIV1,
 16819           DCT-COMMUNICATION-AREA,
 16820           WS-DCT-LENGTH,
 16821           DFHEIV99,
 16822           DFHEIV99,
 16823           DFHEIV99,
 16824           DFHEIV99
 16825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16826
 16827
 16828     IF  DCT-RETURN-CODE = 'OK'
 16829         GO TO 8000-CONT.
 16830
 16831     IF DCT-RETURN-CODE = '01' OR '02'
 16832         GO TO 8000-EXIT.
 16833
 16834     IF DCT-RETURN-CODE = '03'
 16835         MOVE ER-0951            TO EMI-ERROR
 16836         MOVE -1                 TO MAINTL
 16837         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16838         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16839         GO TO 8110-SEND-DATA.
 16840
 16841     IF DCT-RETURN-CODE = '04'
 16842         MOVE ER-0946            TO EMI-ERROR
 16843         MOVE -1                 TO MAINTL
 16844         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16845         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16846         GO TO 8110-SEND-DATA.
 16847
 16848     IF DCT-RETURN-CODE = '05'
 16849         MOVE ER-0947            TO EMI-ERROR
 16850         MOVE -1                 TO MAINTL
 16851         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16852         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16853         GO TO 8110-SEND-DATA.
 16854
 16855     IF DCT-RETURN-CODE = '06'
 16856         MOVE ER-0921            TO EMI-ERROR
 16857         MOVE -1                 TO MAINTL
 16858         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16859         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16860         GO TO 8110-SEND-DATA.
 16861
 16862     IF DCT-RETURN-CODE = '07'
 16863         MOVE ER-0919            TO EMI-ERROR
 16864         MOVE -1                 TO MAINTL
 16865         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16866         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16867         GO TO 8110-SEND-DATA.
 16868
 16869     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 316
* EL131.cbl
 16870         MOVE ER-0948            TO EMI-ERROR
 16871         MOVE -1                 TO MAINTL
 16872         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16873         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16874         GO TO 8110-SEND-DATA.
 16875
 16876     IF DCT-RETURN-CODE = 'N1'
 16877         MOVE ER-0950            TO EMI-ERROR
 16878         MOVE -1                 TO MAINTL
 16879         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16880         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16881         GO TO 8110-SEND-DATA.
 16882
 16883     IF DCT-RETURN-CODE = 'E1'
 16884         MOVE ER-0974            TO EMI-ERROR
 16885         MOVE -1                 TO MAINTL
 16886         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16887         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16888         GO TO 8110-SEND-DATA.
 16889
 16890     IF DCT-RETURN-CODE = 'E2'
 16891         MOVE ER-0975            TO EMI-ERROR
 16892         MOVE -1                 TO MAINTL
 16893         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16894         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16895         GO TO 8110-SEND-DATA.
 16896
 16897     IF DCT-RETURN-CODE NOT = 'OK'
 16898         MOVE ER-0949            TO EMI-ERROR
 16899         MOVE -1                 TO MAINTL
 16900         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16901         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16902         GO TO 8110-SEND-DATA.
 16903
 16904 8000-CONT.
 16905
 16906     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 16907     MOVE 'CS'                   TO DM-RECORD-TYPE.
 16908     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 16909     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 16910     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 16911     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 16912     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 16913     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 16914
 16915     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 16916     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 16917     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 16918     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 16919     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 16920
 16921     IF STATUSI = 'OPEN' OR 'O'
 16922         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 16923      ELSE
 16924         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 16925
 16926     IF STATUSI = 'OPEN' OR 'O'
 16927        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 317
* EL131.cbl
 16928         MOVE '1'                TO DM-CLAIM-STATUS
 16929      ELSE
 16930         MOVE '2'                TO DM-CLAIM-STATUS.
 16931
 16932     IF STATUSI = 'CLOSED' OR 'C'
 16933        IF NOT FINAL-PAID
 16934         MOVE '3'                TO DM-CLAIM-STATUS
 16935      ELSE
 16936         MOVE '4'                TO DM-CLAIM-STATUS.
 16937
 16938     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 16939
 16940
 16941* EXEC CICS LINK
 16942*        PROGRAM    ('DLO025')
 16943*        COMMAREA   (DMO-COMMUNICATION-AREA)
 16944*        LENGTH     (WS-DMO-LENGTH)
 16945*    END-EXEC.
 16946     MOVE 'DLO025' TO DFHEIV1
 16947*    MOVE '."C                   (   #00014084' TO DFHEIV0
 16948     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16949     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16950     MOVE X'2020233030303134303834' TO DFHEIV0(25:11)
 16951     CALL 'kxdfhei1' USING DFHEIV0,
 16952           DFHEIV1,
 16953           DMO-COMMUNICATION-AREA,
 16954           WS-DMO-LENGTH,
 16955           DFHEIV99,
 16956           DFHEIV99,
 16957           DFHEIV99,
 16958           DFHEIV99
 16959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16960
 16961
 16962     IF  DM-RETURN-CODE = 'OK'
 16963         GO TO 8000-EXIT.
 16964
 16965     IF DM-RETURN-CODE = '01'
 16966         MOVE ER-8051            TO EMI-ERROR
 16967         MOVE -1                 TO MAINTL
 16968         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16969         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16970         GO TO 8110-SEND-DATA.
 16971
 16972     IF DM-RETURN-CODE = '02'
 16973         MOVE ER-8052            TO EMI-ERROR
 16974         MOVE -1                 TO MAINTL
 16975         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16976         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16977         GO TO 8110-SEND-DATA.
 16978
 16979     IF DM-RETURN-CODE = '03'
 16980         MOVE ER-8053            TO EMI-ERROR
 16981         MOVE -1                 TO MAINTL
 16982         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16983         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16984         GO TO 8110-SEND-DATA.
 16985
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 318
* EL131.cbl
 16986     IF DM-RETURN-CODE = '04'
 16987         MOVE ER-8054            TO EMI-ERROR
 16988         MOVE -1                 TO MAINTL
 16989         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16990         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16991         GO TO 8110-SEND-DATA.
 16992
 16993     IF DM-RETURN-CODE = '05'
 16994         MOVE ER-8055            TO EMI-ERROR
 16995         MOVE -1                 TO MAINTL
 16996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16997         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 16998         GO TO 8110-SEND-DATA.
 16999
 17000     IF DM-RETURN-CODE = '06'
 17001         MOVE ER-8056            TO EMI-ERROR
 17002         MOVE -1                 TO MAINTL
 17003         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17004         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17005         GO TO 8110-SEND-DATA.
 17006
 17007     IF DM-RETURN-CODE = '07'
 17008         MOVE ER-8057            TO EMI-ERROR
 17009         MOVE -1                 TO MAINTL
 17010         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17011         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17012         GO TO 8110-SEND-DATA.
 17013
 17014     IF DM-RETURN-CODE = '08'
 17015         MOVE ER-8058            TO EMI-ERROR
 17016         MOVE -1                 TO MAINTL
 17017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17018         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17019         GO TO 8110-SEND-DATA.
 17020
 17021     IF DM-RETURN-CODE = '09'
 17022         MOVE ER-8059            TO EMI-ERROR
 17023         MOVE -1                 TO MAINTL
 17024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17025         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17026         GO TO 8110-SEND-DATA.
 17027
 17028     IF DM-RETURN-CODE = '10'
 17029         MOVE ER-8060            TO EMI-ERROR
 17030         MOVE -1                 TO MAINTL
 17031         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17032         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17033         GO TO 8110-SEND-DATA.
 17034
 17035     IF DM-RETURN-CODE = '11'
 17036         MOVE ER-8061            TO EMI-ERROR
 17037         MOVE -1                 TO MAINTL
 17038         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17039         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17040         GO TO 8110-SEND-DATA.
 17041
 17042     IF DM-RETURN-CODE = '12'
 17043         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 319
* EL131.cbl
 17044         MOVE -1                 TO MAINTL
 17045         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17046         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17047         GO TO 8110-SEND-DATA.
 17048
 17049     IF DM-RETURN-CODE = '13'
 17050         MOVE ER-8063            TO EMI-ERROR
 17051         MOVE -1                 TO MAINTL
 17052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17053         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17054         GO TO 8110-SEND-DATA.
 17055
 17056     IF DM-RETURN-CODE = '14'
 17057         MOVE ER-8064            TO EMI-ERROR
 17058         MOVE -1                 TO MAINTL
 17059         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17060         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17061         GO TO 8110-SEND-DATA.
 17062
 17063     IF DM-RETURN-CODE = '15'
 17064         MOVE ER-8065            TO EMI-ERROR
 17065         MOVE -1                 TO MAINTL
 17066         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17067         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17068         GO TO 8110-SEND-DATA.
 17069
 17070     IF DM-RETURN-CODE = '16'
 17071         MOVE ER-8154            TO EMI-ERROR
 17072         MOVE -1                 TO MAINTL
 17073         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17074         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17075         GO TO 8110-SEND-DATA.
 17076
 17077     IF DM-RETURN-CODE = '17'
 17078         MOVE ER-8155            TO EMI-ERROR
 17079         MOVE -1                 TO MAINTL
 17080         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17081         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17082         GO TO 8110-SEND-DATA.
 17083
 17084     IF DM-RETURN-CODE = 'N1'
 17085         MOVE ER-8152            TO EMI-ERROR
 17086         MOVE -1                 TO MAINTL
 17087         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17088         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17089         GO TO 8110-SEND-DATA.
 17090
 17091     IF DM-RETURN-CODE = 'E1'
 17092         MOVE ER-8153            TO EMI-ERROR
 17093         MOVE -1                 TO MAINTL
 17094         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17095         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 17096         GO TO 8110-SEND-DATA.
 17097
 17098     MOVE ER-8066                TO EMI-ERROR.
 17099     MOVE -1                     TO MAINTL.
 17100     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17101     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 320
* EL131.cbl
 17102     GO TO 8110-SEND-DATA.
 17103
 17104 8000-NOTE-NOT-FOUND.
 17105
 17106* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 17107*    MOVE '6"R                   !   #00014233' TO DFHEIV0
 17108     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17110     MOVE X'2020233030303134323333' TO DFHEIV0(25:11)
 17111     CALL 'kxdfhei1' USING DFHEIV0
 17112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17113
 17114     MOVE ER-0954                TO EMI-ERROR.
 17115     MOVE -1                     TO MAINTL.
 17116     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17117     GO TO 8110-SEND-DATA.
 17118
 17119 8000-EXIT.
 17120     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 321
* EL131.cbl
 17122 8050-FORMAT-LAST-NAME-1ST.
 17123*****************************************************************
 17124*             M O V E   N A M E   R O U T I N E                 *
 17125*                                                               *
 17126*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 17127*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 17128*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 17129*                                                               *
 17130*                  FIELD               VALUE                    *
 17131*                  -----               -----                    *
 17132*           W-NAME-LAST    (CL15)      SMITH                    *
 17133*           W-NAME-FIRST   (CL15)      JOHN                     *
 17134*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 17135*                                                               *
 17136*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 17137*                SMITH, JOHN ALLEN                              *
 17138*                     OR                                        *
 17139*                SMITH, JOHN A.                                 *
 17140*                                                               *
 17141*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 17142*     COPYBOOK, ELCNWA.                                         *
 17143*****************************************************************.
 17144
 17145     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 17146     MOVE ZERO                   TO WS-NAME-SW.
 17147     SET NWA-INDEX               TO +1.
 17148
 17149     IF W-NAME-LAST   = SPACES  AND
 17150        W-NAME-MIDDLE = SPACES
 17151          MOVE +1                TO WS-NAME-SW.
 17152
 17153     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 17154     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17155
 17156     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 17157     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17158
 17159     SET NWA-INDEX UP BY +1.
 17160
 17161     IF W-NAME-MIDDLE NOT = SPACES
 17162         IF W-NAME-MIDDLE-2 = SPACES
 17163             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 17164             SET NWA-INDEX UP BY +1
 17165             MOVE '.'            TO WS-NW (NWA-INDEX)
 17166             SET NWA-INDEX UP BY +2
 17167         ELSE
 17168             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 17169             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 17170
 17171 8050-EXIT.
 17172     EXIT.
 17173
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 322
* EL131.cbl
 17175 8060-MOVE-NAME.
 17176     IF WS-NAME-SW GREATER THAN +1
 17177         GO TO 8060-EXIT.
 17178
 17179     IF WS-NAME-WORK2 = SPACES
 17180         GO TO 8060-EXIT.
 17181
 17182     SET NWA-INDEX2            TO +1.
 17183     SET NWA-INDEX3            TO +2.
 17184
 17185 8060-MOVE-NAME-CYCLE.
 17186     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 17187
 17188     IF NWA-INDEX LESS THAN +30
 17189         SET NWA-INDEX UP BY +1
 17190     ELSE
 17191         ADD +2 TO  WS-NAME-SW
 17192         GO TO 8060-EXIT.
 17193
 17194     IF NWA-INDEX2 LESS THAN +20
 17195         SET NWA-INDEX3 UP BY +1
 17196         SET NWA-INDEX2 UP BY +1.
 17197
 17198     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 17199        WS-NW2 (NWA-INDEX3) = SPACES
 17200         IF WS-NAME-SW = ZERO
 17201             MOVE ','            TO WS-NW (NWA-INDEX)
 17202             SET NWA-INDEX UP BY +2
 17203             MOVE +1             TO WS-NAME-SW
 17204             GO TO 8060-EXIT
 17205         ELSE
 17206             GO TO 8060-EXIT.
 17207
 17208     GO TO 8060-MOVE-NAME-CYCLE.
 17209
 17210 8060-EXIT.
 17211     EXIT.
 17212
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 323
* EL131.cbl
 17214
 17215 8070-UNLOCK-CLAIM-MSTR.
 17216
 17217* EXEC CICS UNLOCK
 17218*        DATASET   (CLMS-FILE-ID)
 17219*    END-EXEC.
 17220*    MOVE '&*                    #   #00014336' TO DFHEIV0
 17221     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 17222     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17223     MOVE X'2020233030303134333336' TO DFHEIV0(25:11)
 17224     CALL 'kxdfhei1' USING DFHEIV0,
 17225           CLMS-FILE-ID,
 17226           DFHEIV99
 17227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17228
 17229
 17230 8070-EXIT.
 17231      EXIT.
 17232
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 324
* EL131.cbl
 17234 8100-SEND-MAP.
 17235     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 17236
 17237     move al-uanon               to accswa
 17238     IF NOT PI-NO-CARRIER-SECURITY
 17239        MOVE AL-SANOF            TO CERTCARA.
 17240     IF NOT PI-NO-ACCOUNT-SECURITY
 17241        MOVE AL-SANOF            TO CERTACTA.
 17242
 17243     IF PI-PROCESSOR-ID = 'LGXX'
 17244        MOVE AL-UANON            TO CCNOA.
 17245
 17246     IF PI-COMPANY-ID = 'DMD'
 17247        NEXT SENTENCE
 17248     ELSE
 17249        MOVE AL-SADOF            TO PFKEY6A.
 17250     IF NOT (PI-COMPANY-ID = 'DCC' OR 'VPP')
 17251        MOVE AL-SANOF TO EXTENSA
 17252     END-IF
 17253
 17254     IF PI-USES-PAID-TO
 17255        MOVE 'PAID TO  :' TO PTHRHDGO.
 17256
 17257
 17258* EXEC CICS SEND
 17259*         MAP     ('EL131A')
 17260*         MAPSET  ('EL131S')
 17261*         ERASE
 17262*         FREEKB
 17263*         CURSOR
 17264*    END-EXEC.
 17265     MOVE 'EL131A' TO DFHEIV1
 17266     MOVE -1
 17267       TO DFHEIV11
 17268     MOVE 'EL131S' TO DFHEIV2
 17269*    MOVE '8$     CT  E F  H     ,   #00014367' TO DFHEIV0
 17270     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17271     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17272     MOVE X'2020233030303134333637' TO DFHEIV0(25:11)
 17273     CALL 'kxdfhei1' USING DFHEIV0,
 17274           DFHEIV1,
 17275           EL131AO,
 17276           DFHEIV99,
 17277           DFHEIV2,
 17278           DFHEIV99,
 17279           DFHEIV99,
 17280           DFHEIV99,
 17281           DFHEIV11,
 17282           DFHEIV99,
 17283           DFHEIV99,
 17284           DFHEIV99
 17285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17286
 17287
 17288     GO TO 9000-RETURN-TRANS.
 17289
 17290 8110-SEND-DATA.
 17291     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 325
* EL131.cbl
 17292
 17293     IF PI-USES-PAID-TO
 17294        MOVE 'PAID TO  :' TO PTHRHDGO.
 17295
 17296     IF PI-PROCESSOR-ID = 'LGXX'
 17297        MOVE AL-UANON            TO CCNOA.
 17298
 17299     IF PI-COMPANY-ID = 'DMD'
 17300        NEXT SENTENCE
 17301     ELSE
 17302        MOVE AL-SADOF            TO PFKEY6A.
 17303
 17304
 17305* EXEC CICS SEND
 17306*         MAP      ('EL131A')
 17307*         MAPSET   ('EL131S')
 17308*         DATAONLY
 17309*         FREEKB
 17310*         CURSOR
 17311*    END-EXEC.
 17312     MOVE 'EL131A' TO DFHEIV1
 17313     MOVE -1
 17314       TO DFHEIV11
 17315     MOVE 'EL131S' TO DFHEIV2
 17316*    MOVE '8$D    CT    F  H     ,   #00014391' TO DFHEIV0
 17317     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17318     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 17319     MOVE X'2020233030303134333931' TO DFHEIV0(25:11)
 17320     CALL 'kxdfhei1' USING DFHEIV0,
 17321           DFHEIV1,
 17322           EL131AO,
 17323           DFHEIV99,
 17324           DFHEIV2,
 17325           DFHEIV99,
 17326           DFHEIV99,
 17327           DFHEIV99,
 17328           DFHEIV11,
 17329           DFHEIV99,
 17330           DFHEIV99,
 17331           DFHEIV99
 17332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17333
 17334
 17335     GO TO 9000-RETURN-TRANS.
 17336
 17337 8120-FORMAT-TIME-DATE.
 17338     perform 8140-check-for-prev-errors
 17339                                 thru 8140-exit
 17340     IF SKIP-ATTRIBUTE = 'Y'
 17341        MOVE SPACES              TO SKIP-ATTRIBUTE
 17342        MOVE ER-0598             TO EMI-ERROR
 17343        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17344        GO TO 8125-SKIP-ATTRIBUTE.
 17345
 17346*     IF PI-COMPANY-ID = 'DMD'
 17347      IF PI-PROCESSOR-ID <> 'EMER'
 17348         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 17349                                    CERTCARA  CERTGRPA CERTA SUFXA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 326
* EL131.cbl
 17350
 17351     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 17352                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 17353                                    JNTINITA  JNTAGEA   APRA
 17354                                    LCVCDA    LCVOTRMA  LCVRTRMA
 17355                                    LCVBENEA  LCVFORMA  LCVCNDTA
 17356                                    LCVEXITA  LCVSTATA  LCVKINDA
 17357                                    ACVCDA    ACVOTRMA  ACVRTRMA
 17358                                    ACVBENEA  ACVFORMA  ACVCNDTA
 17359                                    ACVEXITA  ACVSTATA  ACVKINDA
 17360                                    PMTFREQA  INDGRPA   PREMTYPA
 17361                                    REINCDA   LCVRATEA  ACVRATEA
 17362                                    ADDONDTA.
 17363
 17364*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 17365*       IF PI-COMPANY-ID = 'DMD'
 17366*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 17367*                                   SUFXA
 17368*                                   PDAMTA    NODAYSA   NOPMTSA
 17369*                                   INCA      OCCA
 17370*          IF NOT SYSTEM-MODIFY-CAP
 17371*              MOVE AL-SANOF         TO PDTHRUA.
 17372
 17373     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 17374         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 17375
 17376 8125-SKIP-ATTRIBUTE.
 17377
 17378     MOVE SAVE-DATE              TO DATEO.
 17379
 17380* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 17381*    END-EXEC
 17382*    MOVE '0"A                   "   #00014443' TO DFHEIV0
 17383     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 17384     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 17385     MOVE X'2020233030303134343433' TO DFHEIV0(25:11)
 17386     CALL 'kxdfhei1' USING DFHEIV0,
 17387           LCP-CICS-TIME
 17388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17389
 17390* EXEC CICS FORMATTIME
 17391*              ABSTIME(LCP-CICS-TIME)
 17392*              TIME(LCP-TIME-OF-DAY-XX)
 17393*    END-EXEC
 17394*    MOVE 'j$(     (             #   #00014445' TO DFHEIV0
 17395     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 17396     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17397     MOVE X'2020233030303134343435' TO DFHEIV0(25:11)
 17398     CALL 'kxdfhei1' USING DFHEIV0,
 17399           LCP-CICS-TIME,
 17400           LCP-TIME-OF-DAY-XX
 17401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17402     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 17403     MOVE UN-HOURS               TO FOR-HOURS.
 17404     MOVE UN-MINUTES             TO FOR-MINUTES.
 17405     MOVE TIME-OUT               TO TIMEO.
 17406     MOVE PI-COMPANY-ID          TO COMPO.
 17407     MOVE PI-PROCESSOR-ID        TO USERIDO.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 327
* EL131.cbl
 17408     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 17409     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17410     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 17411     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
 17412
 17413 8130-EXIT.
 17414     EXIT.
 17415
 17416 8140-check-for-prev-errors.
 17417
 17418     MOVE PI-COMPANY-CD          TO trlr-company-cd
 17419     MOVE PI-CARRIER             TO trlr-carrier
 17420     MOVE PI-CLAIM-NO            TO trlr-claim-no
 17421     MOVE PI-CERT-NO             TO trlr-cert-no
 17422     MOVE +95                    TO TRLR-SEQ-NO
 17423
 17424
 17425* EXEC CICS READ
 17426*       DATASET  ('ELTRLR')
 17427*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17428*       RIDFLD   (TRLR-KEY)
 17429*       RESP     (WS-RESPONSE)
 17430*    END-EXEC
 17431     MOVE 'ELTRLR' TO DFHEIV1
 17432*    MOVE '&"S        E          (  N#00014471' TO DFHEIV0
 17433     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17434     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17435     MOVE X'204E233030303134343731' TO DFHEIV0(25:11)
 17436     CALL 'kxdfhei1' USING DFHEIV0,
 17437           DFHEIV1,
 17438           DFHEIV20,
 17439           DFHEIV99,
 17440           TRLR-KEY,
 17441           DFHEIV99,
 17442           DFHEIV99,
 17443           DFHEIV99
 17444     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17445         DFHEIV20
 17446     MOVE EIBRESP  TO WS-RESPONSE
 17447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17448
 17449     if ws-resp-normal
 17450        perform varying s1 from +1 by +1 until
 17451           at-note-error-no (s1) = spaces
 17452           if at-note-error-no (s1) = '1652'
 17453              continue
 17454           else
 17455              move at-note-error-no (s1)
 17456                                 to emi-error
 17457              move -1 to maintl
 17458              if at-note-error-no (s1) = '1653'
 17459                 evaluate true
 17460                    when pi-claim-type = 'L'
 17461                       move '  LF  '
 17462                        to emi-claim-type
 17463                    when pi-claim-type = 'I'
 17464                       move '  IU  '
 17465                        to emi-claim-type
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 328
* EL131.cbl
 17466                    WHEN PI-CLAIM-TYPE = 'F'
 17467                       MOVE '  FL  '
 17468                        TO EMI-CLAIM-TYPE
 17469                    when other
 17470                       move '  AH  '
 17471                        to emi-claim-type
 17472                 end-evaluate
 17473              end-if
 17474              PERFORM 9900-ERROR-FORMAT
 17475                                 THRU 9900-EXIT
 17476           end-if
 17477*          if at-note-error-no (s1) = '1653'
 17478*             perform varying emi-sub from 1 by 1 until
 17479*                emi-sub > 3
 17480*                if emi-error-number (emi-sub) = '1653'
 17481*                   evaluate true
 17482*                      when pi-claim-type = 'L'
 17483*                         move '  LF  '
 17484*                          to emi-claim-type
 17485*                      when pi-claim-type = 'I'
 17486*                         move '  IU  '
 17487*                          to emi-claim-type
 17488*                      when other
 17489*                         move '  AH  '
 17490*                          to emi-claim-type
 17491*                   end-evaluate
 17492*                end-if
 17493*             end-perform
 17494*          end-if
 17495        end-perform
 17496     else
 17497        display ' resp not normal ' ws-response ' '
 17498        trlr-key (2:19)
 17499     end-if
 17500
 17501     .
 17502 8140-exit.
 17503     exit.
 17504 8150-ENTERED-CLAIM-NOTFOUND.
 17505
 17506     MOVE ER-0204                TO EMI-ERROR.
 17507     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17508     MOVE -1                     TO MAINTL.
 17509     GO TO 8100-SEND-MAP.
 17510
 17511 8200-RETURN-PRIOR.
 17512     MOVE SPACE                  TO PI-RETURN-CD-1.
 17513     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 17514     GO TO 9200-XCTL.
 17515
 17516 8300-GET-HELP.
 17517     MOVE XCTL-EL010             TO CALL-PGM.
 17518     GO TO 9200-XCTL.
 17519
 17520 8400-RETURN-MASTER.
 17521     MOVE SPACE                  TO PI-RETURN-CD-1.
 17522     MOVE XCTL-EL126             TO CALL-PGM.
 17523     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 329
* EL131.cbl
 17524
 17525 8500-TRLR-MNT.
 17526     IF PI-RETURN-CD-1 = 'X'
 17527         MOVE ER-0311            TO EMI-ERROR
 17528         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17529         MOVE -1                 TO MAINTL
 17530         GO TO 8110-SEND-DATA.
 17531
 17532
 17533* EXEC CICS WRITEQ TS
 17534*         QUEUE     (PI-KEY)
 17535*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17536*         LENGTH    (PI-COMM-LENGTH)
 17537*    END-EXEC.
 17538*    MOVE '*"     L              ''   #00014561' TO DFHEIV0
 17539     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17540     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17541     MOVE X'2020233030303134353631' TO DFHEIV0(25:11)
 17542     CALL 'kxdfhei1' USING DFHEIV0,
 17543           PI-KEY,
 17544           PROGRAM-INTERFACE-BLOCK,
 17545           PI-COMM-LENGTH,
 17546           DFHEIV99,
 17547           DFHEIV99,
 17548           DFHEIV99
 17549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17550
 17551
 17552     MOVE XCTL-EL142             TO CALL-PGM.
 17553     GO TO 9200-XCTL.
 17554
 17555 8600-ADDR-MNT.
 17556     IF PI-RETURN-CD-1 = 'X'
 17557         MOVE ER-0311            TO EMI-ERROR
 17558         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17559         MOVE -1                 TO MAINTL
 17560         GO TO 8110-SEND-DATA.
 17561
 17562
 17563* EXEC CICS WRITEQ TS
 17564*         QUEUE     (PI-KEY)
 17565*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17566*         LENGTH    (PI-COMM-LENGTH)
 17567*    END-EXEC.
 17568*    MOVE '*"     L              ''   #00014577' TO DFHEIV0
 17569     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17570     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17571     MOVE X'2020233030303134353737' TO DFHEIV0(25:11)
 17572     CALL 'kxdfhei1' USING DFHEIV0,
 17573           PI-KEY,
 17574           PROGRAM-INTERFACE-BLOCK,
 17575           PI-COMM-LENGTH,
 17576           DFHEIV99,
 17577           DFHEIV99,
 17578           DFHEIV99
 17579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17580
 17581
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 330
* EL131.cbl
 17582     MOVE XCTL-EL141             TO CALL-PGM.
 17583     GO TO 9200-XCTL.
 17584
 17585 8700-CERT-MNT.
 17586     IF PI-RETURN-CD-1 = 'X'
 17587         MOVE ER-7690            TO EMI-ERROR
 17588         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17589         MOVE -1                 TO MAINTL
 17590         GO TO 8110-SEND-DATA.
 17591
 17592
 17593* EXEC CICS WRITEQ TS
 17594*         QUEUE     (PI-KEY)
 17595*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17596*         LENGTH    (PI-COMM-LENGTH)
 17597*    END-EXEC.
 17598*    MOVE '*"     L              ''   #00014593' TO DFHEIV0
 17599     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17600     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17601     MOVE X'2020233030303134353933' TO DFHEIV0(25:11)
 17602     CALL 'kxdfhei1' USING DFHEIV0,
 17603           PI-KEY,
 17604           PROGRAM-INTERFACE-BLOCK,
 17605           PI-COMM-LENGTH,
 17606           DFHEIV99,
 17607           DFHEIV99,
 17608           DFHEIV99
 17609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17610
 17611
 17612     MOVE XCTL-EL1273            TO CALL-PGM.
 17613     GO TO 9200-XCTL.
 17614
 17615 8725-BENEFICIARY-MNT.
 17616     IF PI-RETURN-CD-1 = 'X'
 17617         MOVE ER-0311            TO EMI-ERROR
 17618         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17619         MOVE -1                 TO MAINTL
 17620         GO TO 8110-SEND-DATA.
 17621
 17622
 17623* EXEC CICS WRITEQ TS
 17624*         QUEUE     (PI-KEY)
 17625*         FROM      (EL131AI)
 17626*         LENGTH    (MAP-LENGTH)
 17627*    END-EXEC.
 17628*    MOVE '*"     L              ''   #00014609' TO DFHEIV0
 17629     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17630     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17631     MOVE X'2020233030303134363039' TO DFHEIV0(25:11)
 17632     CALL 'kxdfhei1' USING DFHEIV0,
 17633           PI-KEY,
 17634           EL131AI,
 17635           MAP-LENGTH,
 17636           DFHEIV99,
 17637           DFHEIV99,
 17638           DFHEIV99
 17639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 331
* EL131.cbl
 17640
 17641
 17642
 17643* EXEC CICS WRITEQ TS
 17644*         QUEUE     (PI-KEY)
 17645*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17646*         LENGTH    (PI-COMM-LENGTH)
 17647*    END-EXEC.
 17648*    MOVE '*"     L              ''   #00014615' TO DFHEIV0
 17649     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17650     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17651     MOVE X'2020233030303134363135' TO DFHEIV0(25:11)
 17652     CALL 'kxdfhei1' USING DFHEIV0,
 17653           PI-KEY,
 17654           PROGRAM-INTERFACE-BLOCK,
 17655           PI-COMM-LENGTH,
 17656           DFHEIV99,
 17657           DFHEIV99,
 17658           DFHEIV99
 17659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17660
 17661
 17662     MOVE XCTL-EL114             TO CALL-PGM.
 17663     GO TO 9200-XCTL.
 17664
 17665 8750-DMD-CLM-FIX.
 17666
 17667* EXEC CICS WRITEQ TS
 17668*         QUEUE     (PI-KEY)
 17669*         FROM      (PROGRAM-INTERFACE-BLOCK)
 17670*         LENGTH    (PI-COMM-LENGTH)
 17671*    END-EXEC.
 17672*    MOVE '*"     L              ''   #00014625' TO DFHEIV0
 17673     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 17674     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17675     MOVE X'2020233030303134363235' TO DFHEIV0(25:11)
 17676     CALL 'kxdfhei1' USING DFHEIV0,
 17677           PI-KEY,
 17678           PROGRAM-INTERFACE-BLOCK,
 17679           PI-COMM-LENGTH,
 17680           DFHEIV99,
 17681           DFHEIV99,
 17682           DFHEIV99
 17683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17684
 17685
 17686     MOVE XCTL-EL400DMD          TO CALL-PGM.
 17687     GO TO 9200-XCTL.
 17688
 17689 8800-UNAUTHORIZED-ACCESS.
 17690     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 17691     GO TO 8990-SEND-TEXT.
 17692
 17693 8810-PF23-ENTERED.
 17694     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 17695     MOVE XCTL-EL005             TO CALL-PGM.
 17696     GO TO 9200-XCTL.
 17697
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 332
* EL131.cbl
 17698 8820-XCTL-ERROR.
 17699
 17700* EXEC CICS HANDLE CONDITION
 17701*        PGMIDERR (8990-SEND-TEXT)
 17702*    END-EXEC.
 17703*    MOVE '"$L                   ! J #00014644' TO DFHEIV0
 17704     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17705     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17706     MOVE X'4A20233030303134363434' TO DFHEIV0(25:11)
 17707     CALL 'kxdfhei1' USING DFHEIV0
 17708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17709
 17710
 17711     MOVE SPACE                 TO PI-ENTRY-CD-1.
 17712     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 17713     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 17714     MOVE XCTL-EL005            TO CALL-PGM.
 17715     GO TO 9200-XCTL.
 17716
 17717 8990-SEND-TEXT.
 17718
 17719* EXEC CICS SEND TEXT
 17720*         FROM      (LOGOFF-TEXT)
 17721*         LENGTH    (LOGOFF-LENGTH)
 17722*         ERASE
 17723*         FREEKB
 17724*    END-EXEC.
 17725*    MOVE '8&      T  E F  H   F -   #00014655' TO DFHEIV0
 17726     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17727     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17728     MOVE X'2020233030303134363535' TO DFHEIV0(25:11)
 17729     CALL 'kxdfhei1' USING DFHEIV0,
 17730           LOGOFF-TEXT,
 17731           LOGOFF-LENGTH,
 17732           DFHEIV99,
 17733           DFHEIV99,
 17734           DFHEIV99,
 17735           DFHEIV99,
 17736           DFHEIV99,
 17737           DFHEIV99,
 17738           DFHEIV99,
 17739           DFHEIV99,
 17740           DFHEIV99,
 17741           DFHEIV99
 17742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17743
 17744
 17745     GO TO 9100-RETURN-CICS.
 17746
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 333
* EL131.cbl
 17748 9000-RETURN-TRANS.
 17749
 17750* EXEC CICS RETURN
 17751*         TRANSID   (TRANS-ID)
 17752*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 17753*         LENGTH    (PI-COMM-LENGTH)
 17754*    END-EXEC.
 17755*    MOVE '.(CT                  ''   #00014666' TO DFHEIV0
 17756     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17757     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17758     MOVE X'2020233030303134363636' TO DFHEIV0(25:11)
 17759     CALL 'kxdfhei1' USING DFHEIV0,
 17760           TRANS-ID,
 17761           PROGRAM-INTERFACE-BLOCK,
 17762           PI-COMM-LENGTH,
 17763           DFHEIV99,
 17764           DFHEIV99,
 17765           DFHEIV99
 17766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17767
 17768
 17769
 17770* GOBACK.
 17771     MOVE '9%                    "   ' TO DFHEIV0
 17772     MOVE 'EL131' TO DFHEIV1
 17773     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17774     GOBACK.
 17775
 17776 9100-RETURN-CICS.
 17777
 17778* EXEC CICS RETURN
 17779*    END-EXEC.
 17780*    MOVE '.(                    ''   #00014675' TO DFHEIV0
 17781     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 17782     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17783     MOVE X'2020233030303134363735' TO DFHEIV0(25:11)
 17784     CALL 'kxdfhei1' USING DFHEIV0,
 17785           DFHEIV99,
 17786           DFHEIV99,
 17787           DFHEIV99,
 17788           DFHEIV99,
 17789           DFHEIV99,
 17790           DFHEIV99
 17791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17792
 17793
 17794
 17795* GOBACK.
 17796     MOVE '9%                    "   ' TO DFHEIV0
 17797     MOVE 'EL131' TO DFHEIV1
 17798     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17799     GOBACK.
 17800
 17801 9200-XCTL.
 17802
 17803* EXEC CICS XCTL
 17804*         PROGRAM    (CALL-PGM)
 17805*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 334
* EL131.cbl
 17806*         LENGTH     (PI-COMM-LENGTH)
 17807*    END-EXEC.
 17808*    MOVE '.$C                   %   #00014681' TO DFHEIV0
 17809     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17810     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17811     MOVE X'2020233030303134363831' TO DFHEIV0(25:11)
 17812     CALL 'kxdfhei1' USING DFHEIV0,
 17813           CALL-PGM,
 17814           PROGRAM-INTERFACE-BLOCK,
 17815           PI-COMM-LENGTH,
 17816           DFHEIV99
 17817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17818
 17819
 17820 9700-LINK-RTRM-FILE-ID.
 17821
 17822* EXEC CICS LINK
 17823*        PROGRAM  (RTRM-FILE-ID)
 17824*        COMMAREA (CALCULATION-PASS-AREA)
 17825*        LENGTH   (CP-COMM-LENGTH)
 17826*    END-EXEC.
 17827*    MOVE '."C                   (   #00014688' TO DFHEIV0
 17828     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17829     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17830     MOVE X'2020233030303134363838' TO DFHEIV0(25:11)
 17831     CALL 'kxdfhei1' USING DFHEIV0,
 17832           RTRM-FILE-ID,
 17833           CALCULATION-PASS-AREA,
 17834           CP-COMM-LENGTH,
 17835           DFHEIV99,
 17836           DFHEIV99,
 17837           DFHEIV99,
 17838           DFHEIV99
 17839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17840
 17841
 17842 9700-EXIT.
 17843      EXIT.
 17844
 17845 9800-CONVERT-DATE.
 17846     MOVE SPACES TO DC-ERROR-CODE.
 17847
 17848* EXEC CICS LINK
 17849*         PROGRAM    (DATE-CONV)
 17850*         COMMAREA   (DATE-CONVERSION-DATA)
 17851*         LENGTH     (DC-COMM-LENGTH)
 17852*    END-EXEC.
 17853*    MOVE '."C                   (   #00014699' TO DFHEIV0
 17854     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17855     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17856     MOVE X'2020233030303134363939' TO DFHEIV0(25:11)
 17857     CALL 'kxdfhei1' USING DFHEIV0,
 17858           DATE-CONV,
 17859           DATE-CONVERSION-DATA,
 17860           DC-COMM-LENGTH,
 17861           DFHEIV99,
 17862           DFHEIV99,
 17863           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 335
* EL131.cbl
 17864           DFHEIV99
 17865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17866
 17867
 17868 9800-EXIT.
 17869     EXIT.
 17870
 17871 9900-ERROR-FORMAT.
 17872
 17873* EXEC CICS LINK
 17874*         PROGRAM    (XCTL-EL001)
 17875*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17876*         LENGTH     (EMI-COMM-LENGTH)
 17877*    END-EXEC.
 17878*    MOVE '."C                   (   #00014709' TO DFHEIV0
 17879     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17880     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17881     MOVE X'2020233030303134373039' TO DFHEIV0(25:11)
 17882     CALL 'kxdfhei1' USING DFHEIV0,
 17883           XCTL-EL001,
 17884           ERROR-MESSAGE-INTERFACE-BLOCK,
 17885           EMI-COMM-LENGTH,
 17886           DFHEIV99,
 17887           DFHEIV99,
 17888           DFHEIV99,
 17889           DFHEIV99
 17890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17891
 17892
 17893 9900-EXIT.
 17894     EXIT.
 17895
 17896 9990-ABEND.
 17897     MOVE DFHEIBLK               TO EMI-LINE1.
 17898
 17899* EXEC CICS LINK
 17900*         PROGRAM   (XCTL-EL004)
 17901*         COMMAREA  (EMI-LINE1)
 17902*         LENGTH    (72)
 17903*     END-EXEC.
 17904     MOVE 72
 17905       TO DFHEIV11
 17906*    MOVE '."C                   (   #00014720' TO DFHEIV0
 17907     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17909     MOVE X'2020233030303134373230' TO DFHEIV0(25:11)
 17910     CALL 'kxdfhei1' USING DFHEIV0,
 17911           XCTL-EL004,
 17912           EMI-LINE1,
 17913           DFHEIV11,
 17914           DFHEIV99,
 17915           DFHEIV99,
 17916           DFHEIV99,
 17917           DFHEIV99
 17918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17919
 17920
 17921     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 336
* EL131.cbl
 17922
 17923     GO TO 8110-SEND-DATA.
 17924
 17925 9995-SECURITY-VIOLATION.
 17926*           COPY ELCSCTP.
 17927******************************************************************
 17928*                                                                *
 17929*                            ELCSCTP                             *
 17930*                            VMOD=2.001                          *
 17931*                                                                *
 17932*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17933******************************************************************
 17934
 17935
 17936     MOVE EIBDATE          TO SM-JUL-DATE.
 17937     MOVE EIBTRMID         TO SM-TERMID.
 17938     MOVE THIS-PGM         TO SM-PGM.
 17939     MOVE EIBTIME          TO TIME-IN.
 17940     MOVE TIME-OUT         TO SM-TIME.
 17941     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17942
 17943
 17944* EXEC CICS LINK
 17945*         PROGRAM  ('EL003')
 17946*         COMMAREA (SECURITY-MESSAGE)
 17947*         LENGTH   (80)
 17948*    END-EXEC.
 17949     MOVE 'EL003' TO DFHEIV1
 17950     MOVE 80
 17951       TO DFHEIV11
 17952*    MOVE '."C                   (   #00014748' TO DFHEIV0
 17953     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17955     MOVE X'2020233030303134373438' TO DFHEIV0(25:11)
 17956     CALL 'kxdfhei1' USING DFHEIV0,
 17957           DFHEIV1,
 17958           SECURITY-MESSAGE,
 17959           DFHEIV11,
 17960           DFHEIV99,
 17961           DFHEIV99,
 17962           DFHEIV99,
 17963           DFHEIV99
 17964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17965
 17966
 17967******************************************************************
 17968
 17969
 17970
 17971 9999-DFHBACK SECTION.
 17972     MOVE '9%                    "   ' TO DFHEIV0
 17973     MOVE 'EL131' TO DFHEIV1
 17974     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17975     GOBACK.
 17976 9999-DFHEXIT.
 17977     IF DFHEIGDJ EQUAL 0001
 17978         NEXT SENTENCE
 17979     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 337
* EL131.cbl
 17980         GO TO 8820-XCTL-ERROR,
 17981               8150-ENTERED-CLAIM-NOTFOUND,
 17982               9990-ABEND
 17983         DEPENDING ON DFHEIGDI
 17984     ELSE IF DFHEIGDJ EQUAL 3
 17985         GO TO 0130-TS-ERROR,
 17986               0130-TS-ERROR
 17987         DEPENDING ON DFHEIGDI
 17988     ELSE IF DFHEIGDJ EQUAL 4
 17989         GO TO 0600-CONTINUE-NAME-UPDATE
 17990         DEPENDING ON DFHEIGDI
 17991     ELSE IF DFHEIGDJ EQUAL 5
 17992         GO TO 1004-BENE-NOT-FOUND
 17993         DEPENDING ON DFHEIGDI
 17994     ELSE IF DFHEIGDJ EQUAL 6
 17995         GO TO 1052-DONE,
 17996               1052-DONE
 17997         DEPENDING ON DFHEIGDI
 17998     ELSE IF DFHEIGDJ EQUAL 7
 17999         GO TO 1120-CNTL-NOTFND
 18000         DEPENDING ON DFHEIGDI
 18001     ELSE IF DFHEIGDJ EQUAL 8
 18002         GO TO 1150-NOTOPEN-ERROR,
 18003               1150-EXIT
 18004         DEPENDING ON DFHEIGDI
 18005     ELSE IF DFHEIGDJ EQUAL 9
 18006         GO TO 1490-STATE-NOTFND
 18007         DEPENDING ON DFHEIGDI
 18008     ELSE IF DFHEIGDJ EQUAL 10
 18009         GO TO 1500-CARR-NOTFND
 18010         DEPENDING ON DFHEIGDI
 18011     ELSE IF DFHEIGDJ EQUAL 11
 18012         GO TO 1620-ACCT-NOTFND
 18013         DEPENDING ON DFHEIGDI
 18014     ELSE IF DFHEIGDJ EQUAL 12
 18015         GO TO 2020-EXIT
 18016         DEPENDING ON DFHEIGDI
 18017     ELSE IF DFHEIGDJ EQUAL 13
 18018         GO TO 2030-EXIT
 18019         DEPENDING ON DFHEIGDI
 18020     ELSE IF DFHEIGDJ EQUAL 14
 18021         GO TO 2040-EXIT
 18022         DEPENDING ON DFHEIGDI
 18023     ELSE IF DFHEIGDJ EQUAL 15
 18024         GO TO 2050-EXIT
 18025         DEPENDING ON DFHEIGDI
 18026     ELSE IF DFHEIGDJ EQUAL 16
 18027         GO TO 2060-CERT-NOTFND
 18028         DEPENDING ON DFHEIGDI
 18029     ELSE IF DFHEIGDJ EQUAL 17
 18030         GO TO 2060-DUPKEY
 18031         DEPENDING ON DFHEIGDI
 18032     ELSE IF DFHEIGDJ EQUAL 18
 18033         GO TO 2070-NOT-FOUND
 18034         DEPENDING ON DFHEIGDI
 18035     ELSE IF DFHEIGDJ EQUAL 19
 18036         GO TO 2070-EXIT
 18037         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 338
* EL131.cbl
 18038     ELSE IF DFHEIGDJ EQUAL 20
 18039         GO TO 2080-EXIT
 18040         DEPENDING ON DFHEIGDI
 18041     ELSE IF DFHEIGDJ EQUAL 21
 18042         GO TO 2400-TRLR-NOTFND,
 18043               2410-EXIT
 18044         DEPENDING ON DFHEIGDI
 18045     ELSE IF DFHEIGDJ EQUAL 22
 18046         GO TO 2425-NINETY-NOTFND,
 18047               2425-NINETY-NOTFND
 18048         DEPENDING ON DFHEIGDI
 18049     ELSE IF DFHEIGDJ EQUAL 23
 18050         GO TO 2430-EXIT,
 18051               2440-EXIT
 18052         DEPENDING ON DFHEIGDI
 18053     ELSE IF DFHEIGDJ EQUAL 24
 18054         GO TO 2440-EXIT
 18055         DEPENDING ON DFHEIGDI
 18056     ELSE IF DFHEIGDJ EQUAL 25
 18057         GO TO 2460-EXIT
 18058         DEPENDING ON DFHEIGDI
 18059     ELSE IF DFHEIGDJ EQUAL 26
 18060         GO TO 2475-EXIT
 18061         DEPENDING ON DFHEIGDI
 18062     ELSE IF DFHEIGDJ EQUAL 27
 18063         GO TO 2650-EXIT
 18064         DEPENDING ON DFHEIGDI
 18065     ELSE IF DFHEIGDJ EQUAL 28
 18066         GO TO 2800-EXIT,
 18067               2800-EXIT
 18068         DEPENDING ON DFHEIGDI
 18069     ELSE IF DFHEIGDJ EQUAL 29
 18070         GO TO 3010-DEL-ACTQ,
 18071               3040-EXIT
 18072         DEPENDING ON DFHEIGDI
 18073     ELSE IF DFHEIGDJ EQUAL 30
 18074         GO TO 3010-NO-ACTIVITY,
 18075               3050-EXIT
 18076         DEPENDING ON DFHEIGDI
 18077     ELSE IF DFHEIGDJ EQUAL 31
 18078         GO TO 3010-CERT-NOT-FOUND
 18079         DEPENDING ON DFHEIGDI
 18080     ELSE IF DFHEIGDJ EQUAL 32
 18081         GO TO 3020-EXIT
 18082         DEPENDING ON DFHEIGDI
 18083     ELSE IF DFHEIGDJ EQUAL 33
 18084         GO TO 3060-EXIT,
 18085               3060-EXIT
 18086         DEPENDING ON DFHEIGDI
 18087     ELSE IF DFHEIGDJ EQUAL 34
 18088         GO TO 5000-TRLR-NOT-FOUND
 18089         DEPENDING ON DFHEIGDI
 18090     ELSE IF DFHEIGDJ EQUAL 35
 18091         GO TO 5000-CERT-NOT-FOUND
 18092         DEPENDING ON DFHEIGDI
 18093     ELSE IF DFHEIGDJ EQUAL 36
 18094         GO TO 1052-DONE,
 18095               1052-DONE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-18 10:30 Page 339
* EL131.cbl
 18096         DEPENDING ON DFHEIGDI
 18097     ELSE IF DFHEIGDJ EQUAL 37
 18098         GO TO 7630-END-BROWSE
 18099         DEPENDING ON DFHEIGDI
 18100     ELSE IF DFHEIGDJ EQUAL 38
 18101         GO TO 7799-EXIT,
 18102               7799-EXIT
 18103         DEPENDING ON DFHEIGDI
 18104     ELSE IF DFHEIGDJ EQUAL 39
 18105         GO TO 7799-EXIT
 18106         DEPENDING ON DFHEIGDI
 18107     ELSE IF DFHEIGDJ EQUAL 40
 18108         GO TO 7800-NOT-FOUND
 18109         DEPENDING ON DFHEIGDI
 18110     ELSE IF DFHEIGDJ EQUAL 41
 18111         GO TO 8000-NOTE-NOT-FOUND
 18112         DEPENDING ON DFHEIGDI
 18113     ELSE IF DFHEIGDJ EQUAL 42
 18114         GO TO 8990-SEND-TEXT
 18115         DEPENDING ON DFHEIGDI.
 18116     MOVE '9%                    "   ' TO DFHEIV0
 18117     MOVE 'EL131' TO DFHEIV1
 18118     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 18119     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14268     Code:       64071
