* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79******************************************************************
    80
    81 ENVIRONMENT DIVISION.
    82
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page   4
* EL6311.cbl
    84 DATA DIVISION.
    85 WORKING-STORAGE SECTION.
    86 01  DFH-START PIC X(04).
    87 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    88 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    89 77  FILLER  PIC X(32)  VALUE '********************************'.
    90 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    91 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    92 77  A1                          PIC S999 COMP-3 VALUE +0.
    93 77  N1                          PIC S999 COMP-3 VALUE +0.
    94 77  N2                          PIC S999 COMP-3 VALUE +0.
    95 77  N3                          PIC S999 COMP-3 VALUE +0.
    96 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    97 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    98 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    99     88  REVERSAL                    VALUE 'Y'.
   100 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   101 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   102 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   103 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   104 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   105     88  ERMAIL-FOUND                 VALUE 'Y'.
   106 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   107 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   108 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   109 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   110     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   111 77  ws-stop-sw                  pic x value ' '.
   112     88  i-say-stop                 value 'Y'.
   113 77  ws-check-sw                 pic x value ' '.
   114     88  i-have-checks              value 'Y'.
   115 77  ws-proc-check-sw            pic x value ' '.
   116     88  i-have-processed-checks    value 'Y'.
   117 77  ws-chek-browse-sw           pic x value ' '.
   118 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   119 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   120 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   121 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   122 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   123 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   124 01  P pointer.
   125 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   126 01  var-ptr pointer.
   127 01  env-var-len                 pic 9(4)  binary.
   128 01  rc                          pic 9(9)  binary.
   129 01  WS-KIXSYS.
   130     05  WS-KIX-FIL1             PIC X(10).
   131     05  WS-KIX-APPS             PIC X(10).
   132     05  WS-KIX-ENV              PIC X(10).
   133     05  WS-KIX-MYENV            PIC X(10).
   134     05  WS-KIX-SYS              PIC X(10).
   135*    COPY ELCSCTM.
   136******************************************************************
   137*                                                                *
   138*                                                                *
   139*                            ELCSCTM                             *
   140*                            VMOD=2.001                          *
   141*                                                                *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page   5
* EL6311.cbl
   142*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   143*                                                                *
   144******************************************************************
   145 01  SECURITY-MESSAGE.
   146     12  FILLER                          PIC X(30)
   147            VALUE '** LOGIC SECURITY VIOLATION -'.
   148     12  SM-READ                         PIC X(6).
   149     12  FILLER                          PIC X(5)
   150            VALUE ' PGM='.
   151     12  SM-PGM                          PIC X(6).
   152     12  FILLER                          PIC X(5)
   153            VALUE ' OPR='.
   154     12  SM-PROCESSOR-ID                 PIC X(4).
   155     12  FILLER                          PIC X(6)
   156            VALUE ' TERM='.
   157     12  SM-TERMID                       PIC X(4).
   158     12  FILLER                          PIC XX   VALUE SPACE.
   159     12  SM-JUL-DATE                     PIC 9(5).
   160     12  FILLER                          PIC X    VALUE SPACE.
   161     12  SM-TIME                         PIC 99.99.
   162
   163
   164*    COPY ELCSCRTY.
   165******************************************************************
   166*                                                                *
   167*                                                                *
   168*                            ELCSCRTY                            *
   169*                            VMOD=2.001                          *
   170*                                                                *
   171*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   172*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   173*        SAVED IN PI-SECURITY-ADDRESS.                           *
   174*                                                                *
   175******************************************************************
   176 01  SECURITY-CONTROL.
   177     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   178     12  FILLER                       PIC XX    VALUE 'SC'.
   179     12  SC-CREDIT-CODES.
   180         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   181             20  SC-CREDIT-DISPLAY    PIC X.
   182             20  SC-CREDIT-UPDATE     PIC X.
   183     12  SC-CLAIMS-CODES.
   184         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   185             20  SC-CLAIMS-DISPLAY    PIC X.
   186             20  SC-CLAIMS-UPDATE     PIC X.
   187
   188 01  WS-VA-NO-COMM-MESS.
   189     12  FILLER                  PIC X(41) VALUE
   190        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   191 01  WS-OC-MESSAGE.
   192     12  FILLER                  PIC X(43) VALUE
   193        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   194     12  WS-OC-DIS-AMT           PIC -----9.99.
   195     12  FILLER                  PIC X(4) VALUE ' ON '.
   196     12  WS-OC-DATE              PIC X(10).
   197 01  WS-DATE-AREA.
   198     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   199     12  WS-CURRENT-DT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page   6
* EL6311.cbl
   200         16  FILLER              PIC X(6)    VALUE SPACES.
   201         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   202     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   203     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   204     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   205
   206 01  STANDARD-AREAS.
   207     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   208     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   209     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   210     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   211     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   212     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   213     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   214     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   215     12  PGM-NAME                PIC X(8).
   216     12  TIME-IN                 PIC S9(7).
   217     12  TIME-OUT-R  REDEFINES TIME-IN.
   218         16  FILLER              PIC X.
   219         16  TIME-OUT            PIC 99V99.
   220         16  FILLER              PIC XX.
   221     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   222     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   223     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   224     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   225     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   226     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   227     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   228     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   229     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   230     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   231     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   232     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   233     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   234     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   235     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   236     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   237     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   238     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   239     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   240     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   241     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   242     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   243     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   244     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   245     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   246     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   247     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   248     12  FILE-ID                 PIC X(8).
   249     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   250     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   251     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   252     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   253     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   254     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   255     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   256     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   257     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page   7
* EL6311.cbl
   258     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   259     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   260     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   261     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   262     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   263     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   264
   265 01  WS-PASS-AREA.
   266     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   267     05  WS-PASS-VADS-REC    PIC X(350).
   268*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   269*                                COPY ELCZREC.
   270******************************************************************
   271*                                                                *
   272*                                                                *
   273*                            ELCZREC.                            *
   274*                                                                *
   275*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   276*                                                                *
   277******************************************************************
   278*-----------------------------------------------------------------
   279*                   C H A N G E   L O G
   280*
   281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   282*-----------------------------------------------------------------
   283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   284* EFFECTIVE    NUMBER
   285*-----------------------------------------------------------------
   286* 122011    2011022800001  AJRA  NEW FILE
   287* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   288* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   289* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   290* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   291*-----------------------------------------------------------------
   292 01  W-Z-CONTROL-DATA.
   293     05  W-NUMBER-OF-COPIES      PIC  9.
   294     05  FILLER                  PIC  X.
   295     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   296     05  FILLER                  PIC  X.
   297     05  W-DAYS-TO-RESEND        PIC  999.
   298     05  FILLER                  PIC  X.
   299     05  W-FORM-TO-RESEND        PIC  X(4).
   300     05  W-ADD-BAR-CODE          PIC  X.
   301     05  W-PROMPT-LETTER         PIC  X.
   302     05  W-HAS-RETURN-ENV        PIC  X.
   303     05  W-ENCLOSURE-CD          PIC  XXX.
   304     05  W-SIG-FLAG-DEFAULT      PIC  X.
   305     05  W-AUTO-CLOSE-IND        PIC  X.
   306     05  FILLER                  PIC  X.
   307     05  W-LETTER-TO-BENE        PIC  X.
   308     05  FILLER                  PIC  X.
   309     05  W-LETTER-TO-ACCT        PIC  X.
   310     05  FILLER                  PIC  X.
   311     05  W-LETTER-TYPE           PIC  X.
   312     05  FILLER                  PIC  X.
   313     05  W-PRINT-CERTIFICATE     PIC  X.
   314     05  FILLER                  PIC  X.
   315     05  W-REFUND-REQUIRED       PIC  X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page   8
* EL6311.cbl
   316     05  FILLER                  PIC  X.
   317     05  W-ONBASE-CODE           PIC  XX.
   318     05  FILLER                  PIC  X.
   319     05  W-ACCT-SUMM             PIC  X.
   320     05  FILLER                  PIC  X.
   321     05  W-CSO-SUMM              PIC  X.
   322     05  FILLER                  PIC  X.
   323     05  W-REASONS-REQUIRED      PIC  X.
   324     05  FILLER                  PIC  X(29).
   325******************************************************************
   326*                                                                *
   327*              A C C E S S   K E Y S                             *
   328*                                                                *
   329******************************************************************
   330
   331 01  ACCESS-KEYS.
   332     12  ERPYAJ-KEY.
   333         16  ERPYAJ-COMPANY-CD       PIC X.
   334         16  ERPYAJ-CARRIER          PIC X.
   335         16  ERPYAJ-GROUPING         PIC X(6).
   336         16  ERPYAJ-FIN-RESP         PIC X(10).
   337         16  ERPYAJ-ACCOUNT          PIC X(10).
   338         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   339         16  ERPYAJ-TYPE             PIC X.
   340     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   341     12  ELCERT-KEY.
   342         16  ELCERT-COMPANY-CD       PIC X.
   343         16  ELCERT-CARRIER          PIC X.
   344         16  ELCERT-GROUPING         PIC X(6).
   345         16  ELCERT-STATE            PIC XX.
   346         16  ELCERT-ACCOUNT          PIC X(10).
   347         16  ELCERT-CERT-EFF-DT      PIC XX.
   348         16  ELCERT-CERT-NO.
   349             20  ELCERT-CERT-PRIME   PIC X(10).
   350             20  ELCERT-CERT-SFX     PIC X.
   351
   352     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   353     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   354     12  ELCRTO-KEY.
   355         16  ELCRTO-COMPANY-CD       PIC X.
   356         16  ELCRTO-CARRIER          PIC X.
   357         16  ELCRTO-GROUPING         PIC X(6).
   358         16  ELCRTO-STATE            PIC XX.
   359         16  ELCRTO-ACCOUNT          PIC X(10).
   360         16  ELCRTO-CERT-EFF-DT      PIC XX.
   361         16  ELCRTO-CERT-NO.
   362             20  ELCRTO-CERT-PRIME   PIC X(10).
   363             20  ELCRTO-CERT-SFX     PIC X.
   364         16  ELCRTO-RECORD-TYPE      PIC X.
   365         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   366
   367     12  ELCRTT-KEY.
   368         16  ELCRTT-PRIMARY          PIC X(33).
   369         16  ELCRTT-REC-TYPE         PIC X(1).
   370     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   371     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   372
   373     12  ERPNDB-KEY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page   9
* EL6311.cbl
   374         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   375         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   376         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   377         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   378             ERPNDB-BATCH-SEQ-NO     PIC XX.
   379         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   380
   381     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   382     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   383     12  ERCHEK-KEY.
   384         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   385         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   386         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   387         16  CHEK-STATE              PIC XX      VALUE SPACES.
   388         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   389         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   390         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   391         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   392         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   393     12  ELLETR-KEY.
   394         16  LETR-COMPANY-CD     PIC X.
   395         16  LETR-LETTER-ID      PIC X(4).
   396         16  LETR-FILLER         PIC X(8).
   397         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   398     12  ERPNDM-KEY.
   399         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   400         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   401         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   402         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   403
   404*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   405     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   406*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   407     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   408
   409     12  ERPNDB-ALT-KEY.
   410         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   411         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   412         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   413         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   414         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   415         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   416         16  ERPNDB-CERT-NO.
   417             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   418             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   419         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   420         16  ERPNDB-RECORD-TYPE      PIC X.
   421
   422      12  ERPNDB-CSR-KEY.
   423          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   424          20  ERPNDB-CSR-ID                PIC X(4).
   425          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   426          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   427          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   428
   429     12  ERNOTE-KEY.
   430         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   431         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  10
* EL6311.cbl
   432         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   433         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   434         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   435         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   436         16  ERNOTE-CERT-NO.
   437             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   438             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   439
   440     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   441     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   442
   443     12  ERCNOT-KEY.
   444         16  ERCNOT-PART-KEY.
   445             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   446             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   447             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   448             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   449             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   450             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   451             20  ERCNOT-CERT-NO.
   452                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   453                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   454         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   455         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   456
   457     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   458     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   459
   460     12  ERMAIL-KEY.
   461         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   462         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   463         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   464         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   465         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   466         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   467         16  ERMAIL-CERT-NO.
   468             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   469             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   470
   471     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   472     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   473
   474     12  ERRQST-KEY.
   475         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   476         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   477
   478     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   479     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   480
   481     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   482
   483     12  ERLOFC-KEY.
   484         16  ERLOFC-COMPANY-CD          PIC  X.
   485         16  ERLOFC-CARRIER             PIC  X.
   486         16  ERLOFC-GROUPING            PIC  X(6).
   487         16  ERLOFC-STATE               PIC  XX.
   488         16  ERLOFC-ACCOUNT             PIC  X(10).
   489         16  ERLOFC-OFFICER-CODE        PIC  X(5).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  11
* EL6311.cbl
   490*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   491
   492     12  ERACCT-KEY.
   493         16  ERACCT-COMPANY-CD          PIC  X.
   494         16  ERACCT-CARRIER             PIC  X.
   495         16  ERACCT-GROUPING            PIC  X(6).
   496         16  ERACCT-STATE               PIC  XX.
   497         16  ERACCT-ACCOUNT             PIC  X(10).
   498         16  ERACCT-EXP-DT.
   499             20  ERACCT-DT              PIC  XX.
   500             20  ERACCT-FILL            PIC  X(4).
   501
   502     12  ERENDT-KEY.
   503         16  ENDT-COMPANY-CD       PIC X.
   504         16  ENDT-CARRIER          PIC X.
   505         16  ENDT-GROUPING         PIC X(6).
   506         16  ENDT-STATE            PIC XX.
   507         16  ENDT-ACCOUNT          PIC X(10).
   508         16  ENDT-CERT-EFF-DT      PIC XX.
   509         16  ENDT-CERT-PRIME       PIC X(10).
   510         16  ENDT-CERT-SFX         PIC X.
   511         16  ENDT-RECORD-TYPE      PIC X.
   512         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   513
   514 01  WS-ELMSTR-WORK.
   515     12  ELMSTR-KEY.
   516         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   517         16  MSTR-CERT-NO.
   518             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   519             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   520     12  W-CLAIM-KEY.
   521         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   522         16  W-CL-CERT-NO.
   523             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   524             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   525      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   526 01  CANCEL-GEN-PASS-AREA.
   527     05  CG-OPTION-CODE          PIC X.
   528         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   529         88  CG-FLAT-CANCEL        VALUE '1'.
   530         88  CG-CANCEL             VALUE '2'.
   531         88  CG-CANCEL-REISSUE     VALUE '3'.
   532     05  CG-ERROR-CODE           PIC 99.
   533         88  CG-SUCCESS            VALUE 00.
   534         88  CG-DATE-ERROR         VALUE 01.
   535         88  CG-CERT-NOT-FOUND     VALUE 02.
   536         88  CG-AMOUNT-ERROR       VALUE 04.
   537         88  CG-OPTION-ERROR       VALUE 05.
   538         88  CG-PREV-CAN           VALUE 06.
   539         88  CG-INVALID-DATA       VALUE 07.
   540         88  CG-NO-ACCT-MSTR       VALUE 08.
   541         88  CG-SFX-A-EXIST        VALUE 09.
   542         88  CG-MISC-ERROR         VALUE 99.
   543     05  CG-COMPANY-ID           PIC XXX.
   544     05  CG-PROC-ID              PIC XXXX.
   545     05  CG-CURRENT-DT           PIC XX.
   546     05  CG-MONTH-END-DT         PIC XX.
   547     05  CG-CERT-KEY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  12
* EL6311.cbl
   548         10  CG-CERT-COMPANY-CD  PIC X.
   549         10  CG-CERT-CARRIER     PIC X.
   550         10  CG-CERT-GROUP       PIC X(6).
   551         10  CG-CERT-STATE       PIC XX.
   552         10  CG-CERT-ACCOUNT     PIC X(10).
   553         10  CG-CERT-EFF-DT      PIC XX.
   554         10  CG-CERT-CERT-NO     PIC X(11).
   555     05  CG-LF-CAN-DATA.
   556         10  CG-LF-CAN-DT        PIC XX.
   557         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   558     05  CG-AH-CAN-DATA.
   559         10  CG-AH-CAN-DT        PIC XX.
   560         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   561     05  CG-CERT-PROFILE-DATA.
   562         10  CG-INS-LNAME        PIC X(15).
   563         10  CG-INS-FNAME        PIC X(10).
   564         10  CG-INS-MID-INIT     PIC X.
   565         10  CG-INS-AGE          PIC 99.
   566         10  CG-JNT-LNAME        PIC X(15).
   567         10  CG-JNT-FNAME        PIC X(10).
   568         10  CG-JNT-MID-INIT     PIC X.
   569         10  CG-JNT-AGE          PIC 99.
   570     05  CG-LF-ISS-DATA.
   571         10  CG-LF-BENCD         PIC XX.
   572         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   573         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   574     05  CG-AH-ISS-DATA.
   575         10  CG-AH-BENCD         PIC XX.
   576         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   577     05  CG-BATCH-NO             PIC X(6).
   578     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   579     05  FILLER                  PIC X(306).
   580******************************************************************
   581*                                                                *
   582*            G E N E R A L   W O R K   A R E A                   *
   583*                                                                *
   584******************************************************************
   585
   586 01  WORK-AREA.
   587     12  WS-RESPONSE             PIC S9(8)   COMP.
   588         88  RESP-NORMAL           VALUE +0.
   589         88  resp-file-notfnd      value +12.
   590         88  RESP-NOTFND           VALUE +13.
   591         88  resp-duprec           value +14.
   592         88  resp-dupkey           value +15.
   593         88  resp-invreq           value +16.
   594         88  RESP-NOTOPEN          VALUE +19.
   595         88  RESP-ENDFILE          VALUE +20.
   596         88  resp-lengtherr        value +22.
   597     12  DEEDIT-FIELD            PIC X(15).
   598     12  FILLER          REDEFINES DEEDIT-FIELD.
   599         16  FILLER              PIC X(4).
   600         16  DEEDIT-FIELD-X11    PIC X(11).
   601     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   602                                 PIC S9(15).
   603     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   604                                 PIC S9(13)V99.
   605     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  13
* EL6311.cbl
   606                                 PIC S9(11)V9999.
   607     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   608     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   609     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   610         16  WS-CALC-TERM-WHOLE  PIC S999.
   611         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   612
   613     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   614     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   615         16  WS-HR-MINS          PIC 99V99.
   616         16  FILLER              PIC XX.
   617
   618     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   619     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   620
   621     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   622     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   623
   624     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   625     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   626     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   627     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   628     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   629     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   630     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   631
   632     12  QID.
   633         16  QID-TERM            PIC X(4).
   634         16  FILLER              PIC X(4)    VALUE '607B'.
   635
   636     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   637         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   638
   639     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   640         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   641
   642     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   643         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   644                                         'A'.
   645
   646     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   647
   648     12  WS-NUMERIC-SW           PIC X.
   649        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   650
   651     12  WS-EDIT-CSO-FIELD.
   652         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   653                                 PIC X.
   654
   655     12  WS-SAVE-INPUT-FIELDS.
   656         16  WS-BAGE             PIC 99       VALUE ZERO.
   657*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   658         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   659         16  FILLER REDEFINES WS-BAPR.
   660             20  WS-APR-WHOLE-NUM    PIC 99.
   661             20  WS-APR-DEC          PIC 9999.
   662         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   663         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  14
* EL6311.cbl
   664
   665         16  WS-B-COVERAGE OCCURS 2 TIMES.
   666             20  WS-TERM-IN-DAYS-SW  PIC X.
   667                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   668             20  WS-BTERM        PIC 999       COMP-3.
   669             20  WS-BALT-TERM    PIC 999       COMP-3.
   670             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   671             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   672             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   673             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   674             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   675             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   676
   677         16  WS-C-FIELDS COMP-3.
   678             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   679             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   680             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   681
   682         16  WS-D-FIELDS COMP-3.
   683             20  WS-DRISS        PIC S9(5)    VALUE +0.
   684             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   685             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   686             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   687             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   688             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   689
   690     12  WS-SAVE-BIRTH-DATE.
   691         16  FILLER              PIC X(4)   VALUE SPACES.
   692         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   693
   694     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   695     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   696     12  FILLER REDEFINES WS-WORK-BIN-RED.
   697         16  FILLER              PIC X(02).
   698         16  WS-WORK-BIN-DT      PIC X(02).
   699     12  WS-SW-1                 PIC X     VALUE SPACE.
   700     12  WS-SW-2                 PIC X     VALUE SPACE.
   701     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   702         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   703     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   704         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   705
   706     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   707     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   708     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   709     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   710     12  WS-CONVERTED-CANCEL-DATES.
   711         16  WS-CONVERTED-CANDT1                  PIC XX.
   712         16  WS-CONVERTED-CANDT2                  PIC XX.
   713
   714     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   715
   716     12  WS-REC-FOUND-SW         PIC X.
   717         88  RECORD-NOT-FOUND    VALUE 'N'.
   718
   719     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   720         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   721         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  15
* EL6311.cbl
   722
   723     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   724         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   725         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   726
   727     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   728         88  BROWSE-STARTED      VALUE 'Y'.
   729
   730     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   731         88  FIRST-TIME          VALUE 'Y'.
   732
   733     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   734         88  FIRST-ENTRY         VALUE 'Y'.
   735
   736     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   737         88  REC-BILLED          VALUE 'Y'.
   738
   739     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   740         88  NO-CURSOR-SET       VALUE +0.
   741         88  CURSOR-SET          VALUE +1.
   742
   743     12  WS-ERR-SW               PIC X.
   744         88  STD-ERRORS          VALUE 'S'.
   745         88  TRN-ERRORS          VALUE 'T'.
   746
   747     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   748         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   749
   750     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   751         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   752
   753     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   754         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   755
   756     12  WS-ERR-CODE.
   757         16  FILLER              PIC 99.
   758         16  WS-ERROR-SUB        PIC 99.
   759
   760     12  WS-DATE-WORK.
   761         16  WS-WORK-MM          PIC XX.
   762         16  WS-WORK-DD          PIC XX.
   763         16  WS-WORK-YY          PIC XX.
   764
   765     12  WS-MM-YY.
   766         16  WS-MM               PIC XX.
   767         16  FILLER              PIC X     VALUE '/'.
   768         16  WS-YY               PIC XX.
   769
   770     12  WS-CERT-EFF-DT          PIC XX.
   771
   772     12  WS-MEMBER-NO            PIC X(12).
   773     12  FILLER  REDEFINES  WS-MEMBER-NO.
   774         16  WS-MEMBER-NO-1-8    PIC 9(8).
   775         16  FILLER              PIC X(4).
   776
   777     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   778
   779     12  WS-ERPNDB-ALT-KEY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  16
* EL6311.cbl
   780         16  WS-PB-COMPANY-CD-A1         PIC X.
   781         16  WS-PB-CARRIER               PIC X.
   782         16  WS-PB-GROUPING              PIC X(6).
   783         16  WS-PB-STATE                 PIC XX.
   784         16  WS-PB-ACCOUNT               PIC X(10).
   785         16  WS-PB-CERT-EFF-DT           PIC XX.
   786         16  WS-PB-CERT-NO.
   787             20  WS-PB-CERT-PRIME        PIC X(10).
   788             20  WS-PB-CERT-SFX          PIC X.
   789         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   790         16  WS-PB-RECORD-TYPE           PIC X.
   791
   792     12  WS-SHOW-SAVE-AREAS.
   793         16  WS-NEW-CERT-NO.
   794             20  WS-NEW-PRIME    PIC X(10).
   795             20  WS-NEW-SUFFIX   PIC X.
   796         16  WS-NEW-CERT-EFF-DT  PIC XX.
   797         16  WS-NEW-RECORD-TYPE  PIC X.
   798         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   799             88   SHOW-RECORD            VALUE 'Y'.
   800
   801     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   802
   803     12  WS-BATCH-NO.
   804         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   805         16  FILLER              PIC X(5) VALUE SPACES.
   806
   807     12  WS-FIRST-NAME.
   808         16  WS-1ST-INIT         PIC X.
   809         16  FILLER              PIC X(9).
   810
   811     12  WS-INITIALS.
   812         16  WS-INITIAL-1        PIC X.
   813         16  WS-INITIAL-2        PIC X.
   814
   815     12  WS-C-HDG.
   816         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   817         16  FILLER              PIC X(4) VALUE '-REF'.
   818
   819     12  WS-D-PREM-HDG.
   820         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   821         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   822
   823     12  WS-D-REFUND-HDG.
   824         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   825         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   826
   827     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   828
   829     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   830     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   831     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   832     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   833     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   834     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   835     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   836
   837     12  WS-01-CANCEL-ERR        PIC X(25)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  17
* EL6311.cbl
   838         VALUE 'CANCEL DATE ERROR'.
   839     12  WS-02-CANCEL-ERR        PIC X(25)
   840         VALUE 'CERT NOT FOUND'.
   841     12  WS-04-CANCEL-ERR        PIC X(25)
   842         VALUE 'CANCEL AMOUNT ERROR'.
   843     12  WS-05-CANCEL-ERR        PIC X(25)
   844         VALUE 'CANCEL OPTION ERROR'.
   845     12  WS-06-CANCEL-ERR        PIC X(25)
   846         VALUE 'PREVIOUSLY CANCELLED'.
   847     12  WS-07-CANCEL-ERR        PIC X(25)
   848         VALUE 'INVALID DATA'.
   849     12  WS-08-CANCEL-ERR        PIC X(25)
   850         VALUE 'NO ACCOUNT MASTER'.
   851     12  WS-09-CANCEL-ERR        PIC X(25)
   852         VALUE 'SUFFIX ALREADY EXISTS'.
   853     12  WS-99-CANCEL-ERR        PIC X(25)
   854         VALUE 'MISC CANCEL ERROR'.
   855
   856     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   857     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   858
   859     12  WS-AGE-FIELDS.
   860         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   861         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   862         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   863         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   864
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  18
* EL6311.cbl
   866
   867******************************************************************
   868*                                                                *
   869*                 B A T C H   T O T A L S                        *
   870*                                                                *
   871******************************************************************
   872
   873     12  WS-BATCH-RECORD.
   874         16  FILLER                       PIC X(10).
   875         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   876         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   877         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   878         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   879         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   880         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   881         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   882         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   883         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   884         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   885         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   886         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   887         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   888         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   889         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   890         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   891         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   892         16  WS-ACCOUNT-NAME              PIC X(30).
   893         16  FILLER                       PIC X.
   894         16  WS-REFERENCE                 PIC X(12).
   895         16  FILLER                       PIC X(197).
   896
   897     12  WS-BATCH-TOTALS.
   898         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   899         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   900         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   901         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   902         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   903         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   904         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   905         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   906         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   907         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   908         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   909         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   910         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   911         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   912         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   913         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   914         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   915         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   916         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   917
   918     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   919
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  19
* EL6311.cbl
   921
   922******************************************************************
   923*                                                                *
   924*                E R R O R   M E S S A G E S                     *
   925*                                                                *
   926******************************************************************
   927
   928 01  ERROR-MESSAGES.
   929     12  ER-0004                 PIC  9(4) VALUE 0004.
   930     12  ER-0008                 PIC  9(4) VALUE 0008.
   931     12  ER-0023                 PIC  9(4) VALUE 0023.
   932     12  ER-0029                 PIC  9(4) VALUE 0029.
   933     12  ER-0033                 PIC  9(4) VALUE 0033.
   934     12  ER-0070                 PIC  9(4) VALUE 0070.
   935     12  ER-0220                 PIC  9(4) VALUE 0220.
   936     12  ER-0248                 PIC  9(4) VALUE 0248.
   937     12  ER-0280                 PIC  9(4) VALUE 0280.
   938     12  ER-0348                 PIC  9(4) VALUE 0348.
   939     12  ER-0582                 PIC  9(4) VALUE 0582.
   940     12  ER-0877                 PIC  9(4) VALUE 0877.
   941     12  ER-1236                 PIC  9(4) VALUE 1236.
   942     12  ER-1570                 PIC  9(4) VALUE 1570.
   943     12  ER-1575                 PIC  9(4) VALUE 1575.
   944     12  ER-1609                 PIC  9(4) VALUE 1609.
   945     12  ER-1819                 PIC  9(4) VALUE 1819.
   946     12  ER-2077                 PIC  9(4) VALUE 2077.
   947     12  ER-2129                 PIC  9(4) VALUE 2129.
   948     12  ER-2188                 PIC  9(4) VALUE 2188.
   949     12  ER-2192                 PIC  9(4) VALUE 2192.
   950     12  ER-2196                 PIC  9(4) VALUE 2196.
   951     12  ER-2197                 PIC  9(4) VALUE 2197.
   952     12  ER-2198                 PIC  9(4) VALUE 2198.
   953     12  ER-2200                 PIC  9(4) VALUE 2200.
   954     12  ER-2212                 PIC  9(4) VALUE 2212.
   955     12  ER-2218                 PIC  9(4) VALUE 2218.
   956     12  ER-2220                 PIC  9(4) VALUE 2220.
   957     12  ER-2222                 PIC  9(4) VALUE 2222.
   958     12  ER-2223                 PIC  9(4) VALUE 2223.
   959     12  ER-2224                 PIC  9(4) VALUE 2224.
   960     12  ER-2225                 PIC  9(4) VALUE 2225.
   961     12  ER-2226                 PIC  9(4) VALUE 2226.
   962     12  ER-2227                 PIC  9(4) VALUE 2227.
   963     12  ER-2228                 PIC  9(4) VALUE 2228.
   964     12  ER-2240                 PIC  9(4) VALUE 2240.
   965     12  ER-2241                 PIC  9(4) VALUE 2241.
   966     12  ER-2242                 PIC  9(4) VALUE 2242.
   967     12  ER-2243                 PIC  9(4) VALUE 2243.
   968     12  ER-2244                 PIC  9(4) VALUE 2244.
   969     12  ER-2245                 PIC  9(4) VALUE 2245.
   970     12  ER-2246                 PIC  9(4) VALUE 2246.
   971     12  ER-2247                 PIC  9(4) VALUE 2247.
   972     12  ER-2251                 PIC  9(4) VALUE 2251.
   973     12  ER-2252                 PIC  9(4) VALUE 2252.
   974     12  ER-2253                 PIC  9(4) VALUE 2253.
   975     12  ER-2254                 PIC  9(4) VALUE 2254.
   976     12  ER-2255                 PIC  9(4) VALUE 2255.
   977     12  ER-2256                 PIC  9(4) VALUE 2256.
   978     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  20
* EL6311.cbl
   979     12  ER-2258                 PIC  9(4) VALUE 2258.
   980     12  ER-2259                 PIC  9(4) VALUE 2259.
   981     12  ER-2260                 PIC  9(4) VALUE 2260.
   982     12  ER-2261                 PIC  9(4) VALUE 2261.
   983     12  ER-2287                 PIC  9(4) VALUE 2287.
   984     12  ER-2336                 PIC  9(4) VALUE 2336.
   985     12  ER-2337                 PIC  9(4) VALUE 2337.
   986     12  ER-2437                 PIC  9(4) VALUE 2437.
   987     12  ER-2471                 PIC  9(4) VALUE 2471.
   988     12  ER-2530                 PIC  9(4) VALUE 2530.
   989     12  ER-2531                 PIC  9(4) VALUE 2531.
   990     12  ER-2532                 PIC  9(4) VALUE 2532.
   991     12  ER-2533                 PIC  9(4) VALUE 2533.
   992     12  ER-2547                 PIC  9(4) VALUE 2547.
   993     12  ER-2591                 PIC  9(4) VALUE 2591.
   994     12  ER-2592                 PIC  9(4) VALUE 2592.
   995     12  ER-2593                 PIC  9(4) VALUE 2593.
   996     12  ER-2600                 PIC  9(4) VALUE 2600.
   997     12  ER-2601                 PIC  9(4) VALUE 2601.
   998     12  ER-2604                 PIC  9(4) VALUE 2604.
   999     12  ER-2605                 PIC  9(4) VALUE 2605.
  1000     12  ER-2606                 PIC  9(4) VALUE 2606.
  1001     12  ER-2607                 PIC  9(4) VALUE 2607.
  1002     12  ER-2622                 PIC  9(4) VALUE 2622.
  1003     12  ER-2625                 PIC  9(4) VALUE 2625.
  1004     12  ER-2626                 PIC  9(4) VALUE 2626.
  1005     12  ER-2627                 PIC  9(4) VALUE 2627.
  1006     12  ER-2628                 PIC  9(4) VALUE 2628.
  1007     12  ER-2629                 PIC  9(4) VALUE 2629.
  1008     12  ER-2630                 PIC  9(4) VALUE 2630.
  1009     12  ER-2631                 PIC  9(4) VALUE 2631.
  1010     12  ER-2632                 PIC  9(4) VALUE 2632.
  1011     12  ER-2633                 PIC  9(4) VALUE 2633.
  1012     12  ER-2634                 PIC  9(4) VALUE 2634.
  1013     12  ER-2635                 PIC  9(4) VALUE 2635.
  1014     12  ER-2636                 PIC  9(4) VALUE 2636.
  1015     12  ER-2639                 PIC  9(4) VALUE 2639.
  1016     12  ER-2640                 PIC  9(4) VALUE 2640.
  1017     12  ER-2647                 PIC  9(4) VALUE 2647.
  1018     12  ER-2648                 PIC  9(4) VALUE 2648.
  1019     12  ER-2649                 PIC  9(4) VALUE 2649.
  1020     12  ER-2650                 PIC  9(4) VALUE 2650.
  1021     12  ER-2653                 PIC  9(4) VALUE 2653.
  1022     12  ER-2654                 PIC  9(4) VALUE 2654.
  1023     12  ER-2655                 PIC  9(4) VALUE 2655.
  1024     12  ER-2656                 PIC  9(4) VALUE 2656.
  1025     12  ER-2657                 PIC  9(4) VALUE 2657.
  1026     12  ER-2660                 PIC  9(4) VALUE 2660.
  1027     12  ER-2661                 PIC  9(4) VALUE 2661.
  1028     12  ER-2662                 PIC  9(4) VALUE 2662.
  1029     12  ER-2663                 PIC  9(4) VALUE 2663.
  1030     12  ER-2664                 PIC  9(4) VALUE 2664.
  1031     12  ER-2667                 PIC  9(4) VALUE 2667.
  1032     12  ER-2668                 PIC  9(4) VALUE 2668.
  1033     12  ER-2669                 PIC  9(4) VALUE 2669.
  1034     12  ER-2670                 PIC  9(4) VALUE 2670.
  1035     12  ER-2671                 PIC  9(4) VALUE 2671.
  1036     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  21
* EL6311.cbl
  1037     12  ER-2673                 PIC  9(4) VALUE 2673.
  1038     12  ER-2677                 PIC  9(4) VALUE 2677.
  1039     12  ER-2678                 PIC  9(4) VALUE 2678.
  1040     12  ER-2679                 PIC  9(4) VALUE 2679.
  1041     12  ER-2680                 PIC  9(4) VALUE 2680.
  1042     12  ER-2681                 PIC  9(4) VALUE 2681.
  1043     12  ER-2682                 PIC  9(4) VALUE 2682.
  1044     12  ER-2683                 PIC  9(4) VALUE 2683.
  1045     12  ER-2684                 PIC  9(4) VALUE 2684.
  1046     12  ER-2686                 PIC  9(4) VALUE 2686.
  1047     12  ER-2689                 PIC  9(4) VALUE 2689.
  1048     12  ER-2690                 PIC  9(4) VALUE 2690.
  1049     12  ER-2693                 PIC  9(4) VALUE 2693.
  1050     12  ER-2695                 PIC  9(4) VALUE 2695.
  1051     12  ER-2701                 PIC  9(4) VALUE 2701.
  1052     12  ER-2720                 PIC  9(4) VALUE 2720.
  1053     12  ER-2709                 PIC  9(4) VALUE 2709.
  1054     12  ER-2704                 PIC  9(4) VALUE 2704.
  1055     12  ER-2725                 PIC  9(4) VALUE 2725.
  1056     12  ER-2726                 PIC  9(4) VALUE 2726.
  1057     12  ER-2728                 PIC  9(4) VALUE 2728.
  1058     12  ER-2729                 PIC  9(4) VALUE 2729.
  1059     12  ER-2731                 PIC  9(4) VALUE 2731.
  1060     12  ER-2732                 PIC  9(4) VALUE 2732.
  1061     12  ER-2733                 PIC  9(4) VALUE 2733.
  1062     12  ER-2735                 PIC  9(4) VALUE 2735.
  1063     12  ER-2738                 PIC  9(4) VALUE 2738.
  1064     12  ER-2742                 PIC  9(4) VALUE 2742.
  1065     12  ER-2743                 PIC  9(4) VALUE 2743.
  1066     12  ER-2744                 PIC  9(4) VALUE 2744.
  1067     12  ER-2747                 PIC  9(4) VALUE 2747.
  1068     12  ER-2749                 PIC  9(4) VALUE 2749.
  1069     12  ER-2753                 PIC  9(4) VALUE 2753.
  1070     12  ER-2755                 PIC  9(4) VALUE 2755.
  1071     12  ER-2757                 PIC  9(4) VALUE 2757.
  1072     12  ER-2771                 PIC  9(4) VALUE 2771.
  1073     12  ER-2774                 PIC  9(4) VALUE 2774.
  1074     12  ER-2775                 PIC  9(4) VALUE 2775.
  1075     12  ER-2776                 PIC  9(4) VALUE 2776.
  1076     12  ER-2777                 PIC  9(4) VALUE 2777.
  1077     12  ER-2794                 PIC  9(4) VALUE 2794.
  1078     12  ER-2799                 PIC  9(4) VALUE 2799.
  1079     12  ER-2900                 PIC  9(4) VALUE 2900.
  1080     12  ER-2902                 PIC  9(4) VALUE 2902.
  1081     12  ER-2945                 PIC  9(4) VALUE 2945.
  1082     12  ER-3000                 PIC  9(4) VALUE 3000.
  1083     12  ER-3006                 PIC  9(4) VALUE 3006.
  1084     12  ER-3054                 PIC  9(4) VALUE 3054.
  1085     12  ER-3224                 PIC  9(4) VALUE 3224.
  1086     12  ER-3269                 PIC  9(4) VALUE 3269.
  1087     12  er-3444                 pic  9(4) value 3444.
  1088     12  er-3446                 pic  9(4) value 3446.
  1089     12  er-3447                 pic  9(4) value 3447.
  1090     12  er-3448                 pic  9(4) value 3448.
  1091     12  er-3449                 pic  9(4) value 3449.
  1092     12  ER-3456                 PIC  9(4) VALUE 3456.
  1093     12  ER-3457                 PIC  9(4) VALUE 3457.
  1094     12  ER-3458                 PIC  9(4) VALUE 3458.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  22
* EL6311.cbl
  1095     12  ER-3504                 PIC  9(4) VALUE 3504.
  1096     12  ER-3513                 PIC  9(4) VALUE 3513.
  1097     12  ER-3831                 PIC  9(4) VALUE 3831.
  1098     12  ER-3834                 PIC  9(4) VALUE 3834.
  1099     12  ER-3835                 PIC  9(4) VALUE 3835.
  1100     12  ER-4005                 PIC  9(4) VALUE 4005.
  1101     12  ER-7144                 PIC  9(4) VALUE 7144.
  1102     12  ER-7401                 PIC  9(4) VALUE 7401.
  1103     12  ER-7402                 PIC  9(4) VALUE 7402.
  1104     12  ER-7403                 PIC  9(4) VALUE 7403.
  1105     12  ER-7404                 PIC  9(4) VALUE 7404.
  1106     12  ER-7423                 PIC  9(4) VALUE 7423.
  1107     12  ER-7424                 PIC  9(4) VALUE 7424.
  1108     12  ER-7433                 PIC  9(4) VALUE 7433.
  1109     12  ER-7450                 PIC  9(4) VALUE 7450.
  1110     12  ER-7451                 PIC  9(4) VALUE 7451.
  1111     12  ER-7530                 PIC  9(4) VALUE 7530.
  1112     12  ER-7573                 PIC  9(4) VALUE 7573.
  1113     12  ER-7631                 PIC  9(4) VALUE 7631.
  1114     12  ER-7632                 PIC  9(4) VALUE 7632.
  1115     12  ER-7633                 PIC  9(4) VALUE 7633.
  1116     12  ER-7537                 PIC  9(4) VALUE 7537.
  1117     12  ER-7538                 PIC  9(4) VALUE 7538.
  1118     12  ER-7574                 PIC  9(4) VALUE 7574.
  1119     12  ER-7997                 PIC  9(4) VALUE 7997.
  1120     12  ER-7998                 PIC  9(4) VALUE 7998.
  1121     12  ER-8148                 PIC  9(4) VALUE 8148.
  1122     12  ER-9063                 PIC  9(4) VALUE 9063.
  1123     12  ER-9076                 PIC  9(4) VALUE 9076.
  1124     12  ER-9618                 PIC  9(4) VALUE 9618.
  1125     12  ER-9841                 PIC  9(4) VALUE 9841.
  1126
  1127*                                COPY ELCTEXT.
  1128******************************************************************
  1129*                                                                *
  1130*                                                                *
  1131*                            ELCTEXT.                            *
  1132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1133*                            VMOD=2.008                          *
  1134*                                                                *
  1135*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1136*                                     FORM LETTERS,              *
  1137*                                     CERT FORM DISPLAY.
  1138*                                                                *
  1139*   FILE TYPE = VSAM,KSDS                                        *
  1140*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1141*                                                                *
  1142*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1143*       ALTERNATE INDEX = NONE                                   *
  1144*                                                                *
  1145*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1146*       ALTERNATE INDEX = NONE                                   *
  1147*                                                                *
  1148*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1149*       ALTERNATE INDEX = NONE                                   *
  1150*                                                                *
  1151*   LOG = NO                                                     *
  1152*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  23
* EL6311.cbl
  1153******************************************************************
  1154 01  TEXT-FILES.
  1155     12  TEXT-FILE-ID                PIC XX.
  1156         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1157         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1158         88  HELP-FILE-TEXT             VALUE 'TH'.
  1159
  1160     12  TX-CONTROL-PRIMARY.
  1161         16  TX-COMPANY-CD           PIC X.
  1162             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1163         16  TX-ACCESS-CD-GENL       PIC X(12).
  1164
  1165         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1166             20  TX-LETTER-NO        PIC X(4).
  1167             20  FILLER              PIC X(8).
  1168
  1169         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1170             20  TX-FORM-NO          PIC X(12).
  1171
  1172         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1173             20  TX-HELP-TYPE        PIC X.
  1174                 88  HELP-FOR-GENERAL   VALUE ' '.
  1175                 88  HELP-BY-SCREEN     VALUE 'S'.
  1176                 88  HELP-BY-ERROR      VALUE 'E'.
  1177             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1178                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1179             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1180                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1181             20  FILLER              PIC X(4).
  1182
  1183         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1184
  1185     12  TX-PROCESS-CONTROL          PIC XX.
  1186         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1187
  1188     12  TX-TEXT-LINE                PIC X(70).
  1189
  1190     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1191         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1192         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1193         88  TX-VALID-FORM-SQUEEZE-VALUE
  1194                                        VALUE 'Y' ' '.
  1195
  1196     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1197         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1198         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1199         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1200         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1201         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1202         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1203         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1204                                              'K' 'N' ' '
  1205                                              'Z'.
  1206
  1207     12  TX-ARCHIVE-SW               PIC X.
  1208         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1209         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1210         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  24
* EL6311.cbl
  1211
  1212     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1213     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1214
  1215     12  TX-BSR-CODE                 PIC X.
  1216         88  TX-BSR-LETTER              VALUE 'B'.
  1217         88  TX-NON-BSR-LETTER          VALUE ' '.
  1218
  1219     12  FILLER                      PIC X.
  1220*****************************************************************
  1221*                                COPY ELCCRTO.
  1222******************************************************************
  1223*                                                                *
  1224*                            ELCCRTO.                            *
  1225*                                                                *
  1226*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1227*                                                                *
  1228*   FILE TYPE = VSAM,KSDS                                        *
  1229*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1230*                                                                *
  1231*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1232*                                                                *
  1233*   LOG = YES                                                    *
  1234*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1235******************************************************************
  1236*                   C H A N G E   L O G
  1237*
  1238* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1239*-----------------------------------------------------------------
  1240*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1241* EFFECTIVE    NUMBER
  1242*-----------------------------------------------------------------
  1243* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1244* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1245* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1246* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1247* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1248******************************************************************
  1249 01  ORIGINAL-CERTIFICATE.
  1250     12  OC-RECORD-ID                      PIC XX.
  1251         88  VALID-OC-ID                      VALUE 'OC'.
  1252     12  OC-CONTROL-PRIMARY.
  1253         16  OC-COMPANY-CD                 PIC X.
  1254         16  OC-CARRIER                    PIC X.
  1255         16  OC-GROUPING                   PIC X(6).
  1256         16  OC-STATE                      PIC XX.
  1257         16  OC-ACCOUNT                    PIC X(10).
  1258         16  OC-CERT-EFF-DT                PIC XX.
  1259         16  OC-CERT-NO.
  1260             20  OC-CERT-PRIME             PIC X(10).
  1261             20  OC-CERT-SFX               PIC X.
  1262         16  OC-RECORD-TYPE                PIC X.
  1263         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1264     12  OC-LAST-MAINT-DT                  PIC XX.
  1265     12  OC-LAST-MAINT-BY                  PIC X(4).
  1266     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1267     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1268     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  25
* EL6311.cbl
  1269     12  OC-ORIG-REC.
  1270         16  OC-INS-LAST-NAME              PIC X(15).
  1271         16  OC-INS-FIRST-NAME             PIC X(10).
  1272         16  OC-INS-MIDDLE-INIT            PIC X.
  1273         16  OC-INS-AGE                    PIC S999     COMP-3.
  1274         16  OC-JNT-LAST-NAME              PIC X(15).
  1275         16  OC-JNT-FIRST-NAME             PIC X(10).
  1276         16  OC-JNT-MIDDLE-INIT            PIC X.
  1277         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1278         16  OC-LF-BENCD                   PIC XX.
  1279         16  OC-LF-TERM                    PIC S999      COMP-3.
  1280         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1281         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1282         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1283         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1284         16  OC-LF-EXP-DT                  PIC XX.
  1285         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1286         16  OC-LF-CANCEL-DT               PIC XX.
  1287         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1288         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1289         16  OC-AH-BENCD                   PIC XX.
  1290         16  OC-AH-TERM                    PIC S999      COMP-3.
  1291         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1292         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1293         16  OC-AH-EXP-DT                  PIC XX.
  1294         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1295         16  OC-AH-CP                      PIC 99.
  1296         16  OC-AH-CANCEL-DT               PIC XX.
  1297         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1298         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1299         16  OC-CRED-BENE-NAME             PIC X(25).
  1300         16  OC-1ST-PMT-DT                 PIC XX.
  1301         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1302         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1303         16  OC-ISSUE-TRAN-IND             PIC X.
  1304         16  OC-CANCEL-TRAN-IND            PIC X.
  1305         16  FILLER                        PIC X(211).
  1306
  1307     12  FILLER                            PIC X(50).
  1308******************************************************************
  1309*                                COPY ERCACCT.
  1310******************************************************************
  1311*                                                                *
  1312*                                                                *
  1313*                            ERCACCT                             *
  1314*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1315*                            VMOD=2.031                          *
  1316*                                                                *
  1317*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1318*                                                                *
  1319*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1320*   VSAM ACCOUNT MASTER FILES.                                   *
  1321*                                                                *
  1322*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1323*                                                                *
  1324*   FILE TYPE = VSAM,KSDS                                        *
  1325*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1326*                                                                *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  26
* EL6311.cbl
  1327*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1328*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1329*                                                                *
  1330*   LOG = NO                                                     *
  1331*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1332*                                                                *
  1333*                                                                *
  1334******************************************************************
  1335*                   C H A N G E   L O G
  1336*
  1337* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1338*-----------------------------------------------------------------
  1339*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1340* EFFECTIVE    NUMBER
  1341*-----------------------------------------------------------------
  1342* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1343* 092705    2005050300006  PEMA  ADD SPP LEASES
  1344* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1345* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1346* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1347* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1348* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1349* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1350******************************************************************
  1351
  1352 01  ACCOUNT-MASTER.
  1353     12  AM-RECORD-ID                      PIC XX.
  1354         88  VALID-AM-ID                      VALUE 'AM'.
  1355
  1356     12  AM-CONTROL-PRIMARY.
  1357         16  AM-COMPANY-CD                 PIC X.
  1358         16  AM-MSTR-CNTRL.
  1359             20  AM-CONTROL-A.
  1360                 24  AM-CARRIER            PIC X.
  1361                 24  AM-GROUPING.
  1362                     28 AM-GROUPING-PREFIX PIC XXX.
  1363                     28 AM-GROUPING-PRIME  PIC XXX.
  1364                 24  AM-STATE              PIC XX.
  1365                 24  AM-ACCOUNT.
  1366                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1367                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1368             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1369                                           PIC X(19).
  1370             20  AM-CNTRL-B.
  1371                 24  AM-EXPIRATION-DT      PIC XX.
  1372                 24  FILLER                PIC X(4).
  1373             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1374                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1375
  1376     12  AM-CONTROL-BY-VAR-GRP.
  1377         16  AM-COMPANY-CD-A1              PIC X.
  1378         16  AM-VG-CARRIER                 PIC X.
  1379         16  AM-VG-GROUPING                PIC X(6).
  1380         16  AM-VG-STATE                   PIC XX.
  1381         16  AM-VG-ACCOUNT                 PIC X(10).
  1382         16  AM-VG-DATE.
  1383             20  AM-VG-EXPIRATION-DT       PIC XX.
  1384             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  27
* EL6311.cbl
  1385         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1386                                           PIC 9(11)      COMP-3.
  1387     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1388         16  FILLER                        PIC X(10).
  1389         16  AM-VG-KEY3.
  1390             20  AM-VG3-ACCOUNT            PIC X(10).
  1391             20  AM-VG3-EXP-DT             PIC XX.
  1392         16  FILLER                        PIC X(4).
  1393     12  AM-MAINT-INFORMATION.
  1394         16  AM-LAST-MAINT-DT              PIC XX.
  1395         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1396         16  AM-LAST-MAINT-USER            PIC X(4).
  1397         16  FILLER                        PIC XX.
  1398
  1399     12  AM-EFFECTIVE-DT                   PIC XX.
  1400     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1401
  1402     12  AM-PREV-DATES  COMP-3.
  1403         16  AM-PREV-EXP-DT                PIC 9(11).
  1404         16  AM-PREV-EFF-DT                PIC 9(11).
  1405
  1406     12  AM-REPORT-CODE-1                  PIC X(10).
  1407     12  AM-REPORT-CODE-2                  PIC X(10).
  1408
  1409     12  AM-CITY-CODE                      PIC X(4).
  1410     12  AM-COUNTY-PARISH                  PIC X(6).
  1411
  1412     12  AM-NAME                           PIC X(30).
  1413     12  AM-PERSON                         PIC X(30).
  1414     12  AM-ADDRS                          PIC X(30).
  1415     12  AM-CITY.
  1416         16  AM-ADDR-CITY                  PIC X(28).
  1417         16  AM-ADDR-STATE                 PIC XX.
  1418     12  AM-ZIP.
  1419         16  AM-ZIP-PRIME.
  1420             20  AM-ZIP-PRI-1ST            PIC X.
  1421                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1422             20  FILLER                    PIC X(4).
  1423         16  AM-ZIP-PLUS4                  PIC X(4).
  1424     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1425         16  AM-CAN-POSTAL-1               PIC XXX.
  1426         16  AM-CAN-POSTAL-2               PIC XXX.
  1427         16  FILLER                        PIC XXX.
  1428     12  AM-TEL-NO.
  1429         16  AM-AREA-CODE                  PIC 999.
  1430         16  AM-TEL-PRE                    PIC 999.
  1431         16  AM-TEL-NBR                    PIC 9(4).
  1432     12  AM-TEL-LOC                        PIC X.
  1433         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1434         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1435
  1436     12  AM-COMM-STRUCTURE.
  1437         16  AM-DEFN-1.
  1438             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1439                 24  AM-AGT.
  1440                     28  AM-AGT-PREFIX     PIC X(4).
  1441                     28  AM-AGT-PRIME      PIC X(6).
  1442                 24  AM-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  28
* EL6311.cbl
  1443                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1444                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1445                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1446                 24  AM-RECALC-LV-INDIC    PIC X.
  1447                 24  AM-RETRO-LV-INDIC     PIC X.
  1448                 24  AM-GL-CODES           PIC X.
  1449                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1450                 24  FILLER                PIC X(01).
  1451         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1452             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1453                 24  FILLER                PIC X(11).
  1454                 24  AM-L-COMA             PIC XXX.
  1455                 24  AM-J-COMA             PIC XXX.
  1456                 24  AM-A-COMA             PIC XXX.
  1457                 24  FILLER                PIC X(6).
  1458
  1459     12  AM-COMM-CHANGE-STATUS             PIC X.
  1460         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1461
  1462     12  AM-CSR-CODE                       PIC X(4).
  1463
  1464     12  AM-BILLING-STATUS                 PIC X.
  1465         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1466         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1467     12  AM-AUTO-REFUND-SW                 PIC X.
  1468         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1469         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1470     12  AM-GPCD                           PIC 99.
  1471     12  AM-IG                             PIC X.
  1472         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1473         88  AM-HAS-GROUP                     VALUE '2'.
  1474     12  AM-STATUS                         PIC X.
  1475         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1476         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1477         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1478         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1479         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1480         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1481         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1482         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1483         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1484         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1485     12  AM-REMIT-TO                       PIC 99.
  1486     12  AM-ID-NO                          PIC X(11).
  1487
  1488     12  AM-CAL-TABLE                      PIC XX.
  1489     12  AM-LF-DEVIATION                   PIC XXX.
  1490     12  AM-AH-DEVIATION                   PIC XXX.
  1491     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1492     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1493     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1494     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1495     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1496     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1497
  1498     12  AM-USER-FIELDS.
  1499         16  AM-FLD-1                      PIC XX.
  1500         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  29
* EL6311.cbl
  1501         16  AM-FLD-3                      PIC XX.
  1502         16  AM-FLD-4                      PIC XX.
  1503         16  AM-FLD-5                      PIC XX.
  1504
  1505     12  AM-1ST-PROD-DATE.
  1506         16  AM-1ST-PROD-YR                PIC XX.
  1507         16  AM-1ST-PROD-MO                PIC XX.
  1508         16  AM-1ST-PROD-DA                PIC XX.
  1509     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1510     12  AM-CERTS-PURGED-DATE.
  1511         16  AM-PUR-YR                     PIC XX.
  1512         16  AM-PUR-MO                     PIC XX.
  1513         16  AM-PUR-DA                     PIC XX.
  1514     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1515     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1516     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1517     12  AM-INACTIVE-DATE.
  1518         16  AM-INA-MO                     PIC 99.
  1519         16  AM-INA-DA                     PIC 99.
  1520         16  AM-INA-YR                     PIC 99.
  1521     12  AM-AR-HI-CERT-DATE                PIC XX.
  1522
  1523     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1524     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1525
  1526     12  AM-OB-PAYMENT-MODE                PIC X.
  1527         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1528         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1529         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1530         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1531
  1532     12  AM-AH-ONLY-INDICATOR              PIC X.
  1533         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1534         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1535
  1536     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1537
  1538     12  AM-OVER-SHORT.
  1539         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1540         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1541
  1542     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1543     12  AM-DCC-CLP-STATE                  PIC XX.
  1544
  1545     12  AM-RECALC-COMM                    PIC X.
  1546     12  AM-RECALC-REIN                    PIC X.
  1547
  1548     12  AM-REI-TABLE                      PIC XXX.
  1549     12  AM-REI-ET-LF                      PIC X.
  1550     12  AM-REI-ET-AH                      PIC X.
  1551     12  AM-REI-PE-LF                      PIC X.
  1552     12  AM-REI-PE-AH                      PIC X.
  1553     12  AM-REI-PRT-ST                     PIC X.
  1554     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1555     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1556     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1557     12  AM-REI-GROUP-A                    PIC X(6).
  1558     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  30
* EL6311.cbl
  1559     12  AM-REI-PRT-OW                     PIC X.
  1560     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1561     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1562     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1563     12  AM-REI-GROUP-B                    PIC X(6).
  1564
  1565     12  AM-TRUST-TYPE                     PIC X(2).
  1566
  1567     12  AM-EMPLOYER-STMT-USED             PIC X.
  1568     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1569
  1570     12  AM-STD-AH-TYPE                    PIC XX.
  1571     12  AM-EARN-METHODS.
  1572         16  AM-EARN-METHOD-R              PIC X.
  1573             88 AM-REF-RL-R78                 VALUE 'R'.
  1574             88 AM-REF-RL-PR                  VALUE 'P'.
  1575             88 AM-REF-RL-MEAN                VALUE 'M'.
  1576             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1577         16  AM-EARN-METHOD-L              PIC X.
  1578             88 AM-REF-LL-R78                 VALUE 'R'.
  1579             88 AM-REF-LL-PR                  VALUE 'P'.
  1580             88 AM-REF-LL-MEAN                VALUE 'M'.
  1581             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1582         16  AM-EARN-METHOD-A              PIC X.
  1583             88 AM-REF-AH-R78                 VALUE 'R'.
  1584             88 AM-REF-AH-PR                  VALUE 'P'.
  1585             88 AM-REF-AH-MEAN                VALUE 'M'.
  1586             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1587             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1588             88 AM-REF-AH-NET                 VALUE 'N'.
  1589
  1590     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1591     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1592     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1593
  1594     12  AM-RET-Y-N                        PIC X.
  1595     12  AM-RET-P-E                        PIC X.
  1596     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1597     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1598     12  AM-RET-GRP                        PIC X(6).
  1599     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1600         16  AM-POOL-PRIME                 PIC XXX.
  1601         16  AM-POOL-SUB                   PIC XXX.
  1602     12  AM-RETRO-EARNINGS.
  1603         16  AM-RET-EARN-R                 PIC X.
  1604         16  AM-RET-EARN-L                 PIC X.
  1605         16  AM-RET-EARN-A                 PIC X.
  1606     12  AM-RET-ST-TAX-USE                 PIC X.
  1607         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1608         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1609     12  AM-RETRO-BEG-EARNINGS.
  1610         16  AM-RET-BEG-EARN-R             PIC X.
  1611         16  AM-RET-BEG-EARN-L             PIC X.
  1612         16  AM-RET-BEG-EARN-A             PIC X.
  1613     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1614     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1615
  1616     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  31
* EL6311.cbl
  1617         16  AM-USER-SELECT-1              PIC X(10).
  1618         16  AM-USER-SELECT-2              PIC X(10).
  1619         16  AM-USER-SELECT-3              PIC X(10).
  1620         16  AM-USER-SELECT-4              PIC X(10).
  1621         16  AM-USER-SELECT-5              PIC X(10).
  1622
  1623     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1624
  1625     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1626
  1627     12  AM-RPT045A-SWITCH                 PIC X.
  1628         88  RPT045A-OFF                   VALUE 'N'.
  1629
  1630     12  AM-INSURANCE-LIMITS.
  1631         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1632         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1633
  1634     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1635         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1636
  1637     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1638         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1639         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1640
  1641     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1642
  1643     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1644     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1645     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1646     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1647     12  AM-DCC-UEF-STATE                  PIC XX.
  1648     12  FILLER                            PIC XXX.
  1649     12  AM-REPORT-CODE-3                  PIC X(10).
  1650*    12  FILLER                            PIC X(22).
  1651
  1652     12  AM-RESERVE-DATE.
  1653         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1654         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1655         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1656
  1657     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1658     12  AM-NOTIFICATION-TYPES.
  1659         16  AM-NOTIF-OF-LETTERS           PIC X.
  1660         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1661         16  AM-NOTIF-OF-REPORTS           PIC X.
  1662         16  AM-NOTIF-OF-STATUS            PIC X.
  1663
  1664     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1665         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1666         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1667         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1668         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1669
  1670     12  AM-BENEFIT-CONTROLS.
  1671         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1672             20  AM-BENEFIT-CODE           PIC XX.
  1673             20  AM-BENEFIT-TYPE           PIC X.
  1674             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  32
* EL6311.cbl
  1675             20  AM-BENEFIT-REM-TERM       PIC X.
  1676             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1677             20  FILLER                    PIC XX.
  1678         16  FILLER                        PIC X(80).
  1679
  1680     12  AM-TRANSFER-DATA.
  1681         16  AM-TRANSFERRED-FROM.
  1682             20  AM-TRNFROM-CARRIER        PIC X.
  1683             20  AM-TRNFROM-GROUPING.
  1684                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1685                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1686             20  AM-TRNFROM-STATE          PIC XX.
  1687             20  AM-TRNFROM-ACCOUNT.
  1688                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1689                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1690             20  AM-TRNFROM-DTE            PIC XX.
  1691         16  AM-TRANSFERRED-TO.
  1692             20  AM-TRNTO-CARRIER          PIC X.
  1693             20  AM-TRNTO-GROUPING.
  1694                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1695                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1696             20  AM-TRNTO-STATE            PIC XX.
  1697             20  AM-TRNTO-ACCOUNT.
  1698                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1699                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1700             20  AM-TRNTO-DTE              PIC XX.
  1701         16  FILLER                        PIC X(10).
  1702
  1703     12  AM-SAVED-REMIT-TO                 PIC 99.
  1704
  1705     12  AM-COMM-STRUCTURE-SAVED.
  1706         16  AM-DEFN-1-SAVED.
  1707             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1708                 24  AM-AGT-SV             PIC X(10).
  1709                 24  AM-COM-TYP-SV         PIC X.
  1710                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1711                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1712                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1713                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1714                 24  FILLER                PIC X.
  1715                 24  AM-GL-CODES-SV        PIC X.
  1716                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1717                 24  FILLER                PIC X.
  1718         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1719             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1720                 24  FILLER                PIC X(11).
  1721                 24  AM-L-COMA-SV          PIC XXX.
  1722                 24  AM-J-COMA-SV          PIC XXX.
  1723                 24  AM-A-COMA-SV          PIC XXX.
  1724                 24  FILLER                PIC X(6).
  1725
  1726     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1727         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1728            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1729            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1730            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1731
  1732     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  33
* EL6311.cbl
  1733     12  FILLER                            PIC X(120).
  1734
  1735     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1736         16  AM-CONTROL-NAME               PIC X(30).
  1737         16  AM-EXECUTIVE-ONE.
  1738             20  AM-EXEC1-NAME             PIC X(15).
  1739             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1740                                                          COMP-3.
  1741             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1742                                                          COMP-3.
  1743         16  AM-EXECUTIVE-TWO.
  1744             20  AM-EXEC2-NAME             PIC X(15).
  1745             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1746                                                          COMP-3.
  1747             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1748                                                          COMP-3.
  1749
  1750     12  AM-RETRO-ADDITIONAL-DATA.
  1751         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1752         16  AM-RETRO-PREM-P-E             PIC X.
  1753         16  AM-RETRO-CLMS-P-I             PIC X.
  1754         16  AM-RETRO-RET-BRACKET-LF.
  1755             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1756                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1757                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1758             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1759                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1760                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1761             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1762                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1763                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1764         16  AM-RETRO-RET-BRACKET-AH.
  1765             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1766                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1767                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1768                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1769             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1770                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1771                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1772             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1773                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1774                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1775
  1776     12  AM-COMMENTS.
  1777         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1778
  1779     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1780         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1781         16  AM-FLI-BILLING-CODE           PIC X.
  1782         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1783         16  AM-FLI-UNITED-IDENT           PIC X.
  1784         16  AM-FLI-INTEREST-LOST-DATA.
  1785             20  AM-FLI-BANK-NO            PIC X(5).
  1786             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1787             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1788             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1789         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1790             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  34
* EL6311.cbl
  1791             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1792             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1793         16  FILLER                        PIC X(102).
  1794
  1795     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1796         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1797             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1798             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1799             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1800             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1801             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1802         16  FILLER                          PIC X(10).
  1803******************************************************************
  1804*                                COPY ELCVADS.
  1805******************************************************************
  1806*                                                                *
  1807*                                                                *
  1808*                            ELCVADS.                            *
  1809*                                                                *
  1810*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1811*   ELVADS                  LENGTH = 350                         *
  1812******************************************************************
  1813******************************************************************
  1814*                   C H A N G E   L O G
  1815*
  1816* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1817*-----------------------------------------------------------------
  1818*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1819* EFFECTIVE    NUMBER
  1820*-----------------------------------------------------------------
  1821* 100111    2011022800001  AJRA  NAPERSOFT
  1822******************************************************************
  1823
  1824 01  VIRGINIA-DISCLOSURE.
  1825     12  VD-COMPANY-CD              PIC X.
  1826     12  VD-CARRIER                 PIC X.
  1827     12  VD-GROUPING.
  1828         20  VD-GROUPING-PREFIX     PIC XXX.
  1829         20  VD-GROUPING-PRIME      PIC XXX.
  1830     12  VD-STATE                   PIC XX.
  1831     12  VD-ACCOUNT.
  1832         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1833         20  VD-ACCOUNT-PRIME       PIC X(6).
  1834     12  VD-CERT-EFF-DT             PIC XX.
  1835     12  VD-CERT-NO.
  1836         20  VD-CERT-PRIME          PIC X(10).
  1837         20  VD-CERT-SFX            PIC X.
  1838     12  VD-ENTRY-BATCH             PIC X(6).
  1839     12  VD-CSR-ID                  PIC X(4).
  1840     12  VD-NAME.
  1841         20  VD-INSURED-LAST-NAME   PIC X(15).
  1842         20  VD-INSURED-FIRST-NAME.
  1843             24  VD-INSURED-1ST-INIT PIC X.
  1844             24  FILLER             PIC X(9).
  1845         20  VD-INSURED-MIDDLE-INIT PIC X.
  1846     12  VD-JOINT-INSURED.
  1847         20 VD-JOINT-LAST-NAME      PIC X(15).
  1848         20 VD-JOINT-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  35
* EL6311.cbl
  1849            24  VD-JOINT-FIRST-INIT PIC X.
  1850            24  FILLER              PIC X(9).
  1851         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1852     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1853     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1854     12  VD-INSURED-CITY-STATE.
  1855         20  VD-INSURED-CITY        PIC X(28).
  1856         20  VD-INSURED-STATE       PIC XX.
  1857     12  VD-INSURED-ZIP-CODE.
  1858         20  VD-INSURED-ZIP-PRIME.
  1859             24  VD-INSURED-ZIP-1   PIC X.
  1860                 88  VD-CANADIAN-POST-CODE
  1861                                       VALUE 'A' THRU 'Z'.
  1862             24  FILLER             PIC X(4).
  1863         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1864     12  VD-BENEFICIARY-NAME        PIC X(30).
  1865     12  VD-ACCOUNT-NAME            PIC X(30).
  1866     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1867     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1868     12  VD-1ST-PMT-DT              PIC XX.
  1869     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1870         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1871         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1872                                             '90' THRU '99'.
  1873     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1874                                    PIC XX.
  1875     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1876     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1877     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1878     12  VD-LF-TERM                 PIC S999   COMP-3.
  1879     12  VD-AH-BENEFIT-CD           PIC XX.
  1880         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1881         88  VD-INVALID-AH             VALUE '  ' '00'
  1882                                             '90' THRU '99'.
  1883     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1884     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1885     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1886     12  VD-AH-TERM                 PIC S999   COMP-3.
  1887     12  VD-LETTER-ID               PIC X(4).
  1888     12  VD-PROC-ID                 PIC X(4).
  1889     12  VD-COMP-ID                 PIC X(3).
  1890     12  VD-CURRENT-DATE            PIC XX.
  1891     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1892     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1893     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  36
* EL6311.cbl
  1895*    COPY ELCDATE.
  1896******************************************************************
  1897*                                                                *
  1898*                                                                *
  1899*                            ELCDATE.                            *
  1900*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1901*                            VMOD=2.003
  1902*                                                                *
  1903*                                                                *
  1904*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1905*                 LENGTH = 200                                   *
  1906******************************************************************
  1907
  1908 01  DATE-CONVERSION-DATA.
  1909     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1910     12  DC-OPTION-CODE                PIC X.
  1911         88  BIN-TO-GREG                VALUE ' '.
  1912         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1913         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1914         88  YMD-GREG-TO-BIN            VALUE '3'.
  1915         88  MDY-GREG-TO-BIN            VALUE '4'.
  1916         88  JULIAN-TO-BIN              VALUE '5'.
  1917         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1918         88  FIND-CENTURY               VALUE '7'.
  1919         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1920         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1921         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1922         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1923         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1924         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1925         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1926         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1927         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1928         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1929         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1930         88  BIN-3-TO-GREG              VALUE 'I'.
  1931         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1932         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1933         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1934         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1935         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1936         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1937         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1938         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1939         88  THREE-CHARACTER-BIN
  1940                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1941         88  GREGORIAN-TO-BIN
  1942                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1943         88  BIN-TO-GREGORIAN
  1944                  VALUES ' ' '1' 'I' '8' 'G'.
  1945         88  JULIAN-TO-BINARY
  1946                  VALUES '5' 'C' 'E' 'F'.
  1947     12  DC-ERROR-CODE                 PIC X.
  1948         88  NO-CONVERSION-ERROR        VALUE ' '.
  1949         88  DATE-CONVERSION-ERROR
  1950                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1951         88  DATE-IS-ZERO               VALUE '1'.
  1952         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  37
* EL6311.cbl
  1953         88  DATE-IS-INVALID            VALUE '3'.
  1954         88  DATE1-GREATER-DATE2        VALUE '4'.
  1955         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1956         88  DATE-INVALID-OPTION        VALUE '9'.
  1957         88  INVALID-CENTURY            VALUE 'A'.
  1958         88  ONLY-CENTURY               VALUE 'B'.
  1959         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1960         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1961     12  DC-END-OF-MONTH               PIC X.
  1962         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1963     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1964         88  USE-NORMAL-PROCESS         VALUE ' '.
  1965         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1966         88  ADJUST-UP-100-YRS          VALUE '2'.
  1967     12  FILLER                        PIC X.
  1968     12  DC-CONVERSION-DATES.
  1969         16  DC-BIN-DATE-1             PIC XX.
  1970         16  DC-BIN-DATE-2             PIC XX.
  1971         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1972         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1973                       DC-GREG-DATE-1-EDIT.
  1974             20  DC-EDIT1-MONTH        PIC 99.
  1975             20  SLASH1-1              PIC X.
  1976             20  DC-EDIT1-DAY          PIC 99.
  1977             20  SLASH1-2              PIC X.
  1978             20  DC-EDIT1-YEAR         PIC 99.
  1979         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1980         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1981                     DC-GREG-DATE-2-EDIT.
  1982             20  DC-EDIT2-MONTH        PIC 99.
  1983             20  SLASH2-1              PIC X.
  1984             20  DC-EDIT2-DAY          PIC 99.
  1985             20  SLASH2-2              PIC X.
  1986             20  DC-EDIT2-YEAR         PIC 99.
  1987         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1988         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1989                     DC-GREG-DATE-1-YMD.
  1990             20  DC-YMD-YEAR           PIC 99.
  1991             20  DC-YMD-MONTH          PIC 99.
  1992             20  DC-YMD-DAY            PIC 99.
  1993         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1994         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1995                      DC-GREG-DATE-1-MDY.
  1996             20  DC-MDY-MONTH          PIC 99.
  1997             20  DC-MDY-DAY            PIC 99.
  1998             20  DC-MDY-YEAR           PIC 99.
  1999         16  DC-GREG-DATE-1-ALPHA.
  2000             20  DC-ALPHA-MONTH        PIC X(10).
  2001             20  DC-ALPHA-DAY          PIC 99.
  2002             20  FILLER                PIC XX.
  2003             20  DC-ALPHA-CENTURY.
  2004                 24 DC-ALPHA-CEN-N     PIC 99.
  2005             20  DC-ALPHA-YEAR         PIC 99.
  2006         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2007         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2008         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2009         16  DC-JULIAN-DATE            PIC 9(05).
  2010         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  38
* EL6311.cbl
  2011                                       PIC 9(05).
  2012         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2013             20  DC-JULIAN-YEAR        PIC 99.
  2014             20  DC-JULIAN-DAYS        PIC 999.
  2015         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2016         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2017         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2018     12  DATE-CONVERSION-VARIBLES.
  2019         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2020         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2021             20  FILLER                PIC 9(3).
  2022             20  HOLD-CEN-1-CCYY.
  2023                 24  HOLD-CEN-1-CC     PIC 99.
  2024                 24  HOLD-CEN-1-YY     PIC 99.
  2025             20  HOLD-CEN-1-MO         PIC 99.
  2026             20  HOLD-CEN-1-DA         PIC 99.
  2027         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2028             20  HOLD-CEN-1-R-MO       PIC 99.
  2029             20  HOLD-CEN-1-R-DA       PIC 99.
  2030             20  HOLD-CEN-1-R-CCYY.
  2031                 24  HOLD-CEN-1-R-CC   PIC 99.
  2032                 24  HOLD-CEN-1-R-YY   PIC 99.
  2033             20  FILLER                PIC 9(3).
  2034         16  HOLD-CENTURY-1-X.
  2035             20  FILLER                PIC X(3)  VALUE SPACES.
  2036             20  HOLD-CEN-1-X-CCYY.
  2037                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2038                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2039             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2040             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2041         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2042             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2043             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2044             20  HOLD-CEN-1-R-X-CCYY.
  2045                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2046                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2047             20  FILLER                PIC XXX.
  2048         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2049         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2050         16  DC-JULIAN-DATE-1          PIC 9(07).
  2051         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2052             20  DC-JULIAN-1-CCYY.
  2053                 24  DC-JULIAN-1-CC    PIC 99.
  2054                 24  DC-JULIAN-1-YR    PIC 99.
  2055             20  DC-JULIAN-DA-1        PIC 999.
  2056         16  DC-JULIAN-DATE-2          PIC 9(07).
  2057         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2058             20  DC-JULIAN-2-CCYY.
  2059                 24  DC-JULIAN-2-CC    PIC 99.
  2060                 24  DC-JULIAN-2-YR    PIC 99.
  2061             20  DC-JULIAN-DA-2        PIC 999.
  2062         16  DC-GREG-DATE-A-EDIT.
  2063             20  DC-EDITA-MONTH        PIC 99.
  2064             20  SLASHA-1              PIC X VALUE '/'.
  2065             20  DC-EDITA-DAY          PIC 99.
  2066             20  SLASHA-2              PIC X VALUE '/'.
  2067             20  DC-EDITA-CCYY.
  2068                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  39
* EL6311.cbl
  2069                 24  DC-EDITA-YEAR     PIC 99.
  2070         16  DC-GREG-DATE-B-EDIT.
  2071             20  DC-EDITB-MONTH        PIC 99.
  2072             20  SLASHB-1              PIC X VALUE '/'.
  2073             20  DC-EDITB-DAY          PIC 99.
  2074             20  SLASHB-2              PIC X VALUE '/'.
  2075             20  DC-EDITB-CCYY.
  2076                 24  DC-EDITB-CENT     PIC 99.
  2077                 24  DC-EDITB-YEAR     PIC 99.
  2078         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2079         16  DC-GREG-DATE-CYMD-R REDEFINES
  2080                              DC-GREG-DATE-CYMD.
  2081             20  DC-CYMD-CEN           PIC 99.
  2082             20  DC-CYMD-YEAR          PIC 99.
  2083             20  DC-CYMD-MONTH         PIC 99.
  2084             20  DC-CYMD-DAY           PIC 99.
  2085         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2086         16  DC-GREG-DATE-MDCY-R REDEFINES
  2087                              DC-GREG-DATE-MDCY.
  2088             20  DC-MDCY-MONTH         PIC 99.
  2089             20  DC-MDCY-DAY           PIC 99.
  2090             20  DC-MDCY-CEN           PIC 99.
  2091             20  DC-MDCY-YEAR          PIC 99.
  2092    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2093        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2094    12  DC-EL310-DATE                  PIC X(21).
  2095    12  FILLER                         PIC X(28).
  2096
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  40
* EL6311.cbl
  2098*    COPY ELCLOGOF.
  2099******************************************************************
  2100*                                                                *
  2101*                                                                *
  2102*                            ELCLOGOF.                           *
  2103*                            VMOD=2.001                          *
  2104*                                                                *
  2105*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2106*                                                                *
  2107******************************************************************
  2108 01  CLASIC-LOGOFF.
  2109     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2110     12  LOGOFF-TEXT.
  2111         16  FILLER          PIC X(5)    VALUE SPACES.
  2112         16  LOGOFF-MSG.
  2113             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2114             20  FILLER      PIC X       VALUE SPACES.
  2115             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2116         16  FILLER          PIC X(80)
  2117           VALUE '* YOU ARE NOW LOGGED OFF'.
  2118         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2119         16  FILLER          PIC X       VALUE QUOTE.
  2120         16  LOGOFF-SYS-MSG  PIC X(17)
  2121           VALUE 'S CLAS-IC SYSTEM '.
  2122     12  TEXT-MESSAGES.
  2123         16  UNACCESS-MSG    PIC X(29)
  2124             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2125         16  PGMIDERR-MSG    PIC X(17)
  2126             VALUE 'PROGRAM NOT FOUND'.
  2127
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  41
* EL6311.cbl
  2129*    COPY ELCATTR.
  2130******************************************************************
  2131*                                                                *
  2132*                            ELCATTR.                            *
  2133*                            VMOD=2.001                          *
  2134*                                                                *
  2135*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2136*                                                                *
  2137*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2138*                                                                *
  2139*                   POS 1   P=PROTECTED                          *
  2140*                           U=UNPROTECTED                        *
  2141*                           S=ASKIP                              *
  2142*                   POS 2   A=ALPHA/NUMERIC                      *
  2143*                           N=NUMERIC                            *
  2144*                   POS 3   N=NORMAL                             *
  2145*                           B=BRIGHT                             *
  2146*                           D=DARK                               *
  2147*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2148*                           OF=MODIFIED DATA TAG OFF             *
  2149*                                                                *
  2150*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2151******************************************************************
  2152 01  ATTRIBUTE-LIST.
  2153     12  AL-PABOF            PIC X       VALUE 'Y'.
  2154     12  AL-PABON            PIC X       VALUE 'Z'.
  2155     12  AL-PADOF            PIC X       VALUE '%'.
  2156     12  AL-PADON            PIC X       VALUE '_'.
  2157     12  AL-PANOF            PIC X       VALUE '-'.
  2158     12  AL-PANON            PIC X       VALUE '/'.
  2159     12  AL-SABOF            PIC X       VALUE '8'.
  2160     12  AL-SABON            PIC X       VALUE '9'.
  2161     12  AL-SADOF            PIC X       VALUE '@'.
  2162     12  AL-SADON            PIC X       VALUE QUOTE.
  2163     12  AL-SANOF            PIC X       VALUE '0'.
  2164     12  AL-SANON            PIC X       VALUE '1'.
  2165     12  AL-UABOF            PIC X       VALUE 'H'.
  2166     12  AL-UABON            PIC X       VALUE 'I'.
  2167     12  AL-UADOF            PIC X       VALUE '<'.
  2168     12  AL-UADON            PIC X       VALUE '('.
  2169     12  AL-UANOF            PIC X       VALUE ' '.
  2170     12  AL-UANON            PIC X       VALUE 'A'.
  2171     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2172     12  AL-UNBON            PIC X       VALUE 'R'.
  2173     12  AL-UNDOF            PIC X       VALUE '*'.
  2174     12  AL-UNDON            PIC X       VALUE ')'.
  2175     12  AL-UNNOF            PIC X       VALUE '&'.
  2176     12  AL-UNNON            PIC X       VALUE 'J'.
  2177
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  42
* EL6311.cbl
  2179*    COPY ELCEMIB.
  2180******************************************************************
  2181*                                                                *
  2182*                                                                *
  2183*                            ELCEMIB.                            *
  2184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2185*                            VMOD=2.005                          *
  2186*                                                                *
  2187*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2188*                                                                *
  2189******************************************************************
  2190 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2191     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2192     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2193     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2194     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2195     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2196     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2197     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2198     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2199     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2200         88  EMI-NO-ERRORS                    VALUE '1'.
  2201         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2202         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2203     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2204         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2205     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2206         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2207         88  EMI-AREA1-FULL                   VALUE '2'.
  2208     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2209         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2210         88  EMI-AREA2-FULL                   VALUE '2'.
  2211     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2212         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2213         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2214         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2215         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2216         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2217     12  EMI-ERROR-LINES.
  2218         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2219         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2220         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2221         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2222             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2223                 24  EMI-ERR-NUM         PIC X(4).
  2224                 24  EMI-FILLER          PIC X.
  2225                 24  EMI-SEV             PIC X.
  2226                 24  FILLER              PIC X.
  2227             20  FILLER                  PIC X(02).
  2228     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2229         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2230             20  EMI-ERROR-NUMBER    PIC X(4).
  2231             20  EMI-FILL            PIC X.
  2232             20  EMI-SEVERITY        PIC X.
  2233             20  FILLER              PIC X.
  2234             20  EMI-ERROR-TEXT.
  2235                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2236                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  43
* EL6311.cbl
  2237     12  EMI-SEVERITY-SAVE           PIC X.
  2238         88  EMI-NOTE                    VALUE 'N'.
  2239         88  EMI-WARNING                 VALUE 'W'.
  2240         88  EMI-FORCABLE                VALUE 'F'.
  2241         88  EMI-FATAL                   VALUE 'X'.
  2242     12  EMI-MESSAGE-FLAG            PIC X.
  2243         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2244         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2245     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2246     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2247         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2248         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2249         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2250     12  emi-claim-no                pic x(7).
  2251     12  emi-claim-type              pic x(6).
  2252     12  FILLER                      PIC X(124)  VALUE SPACES.
  2253     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2254     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2255     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2256     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2257
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  44
* EL6311.cbl
  2259*    COPY ELCINTF.
  2260******************************************************************
  2261*                                                                *
  2262*                                                                *
  2263*                            ELCINTF.                            *
  2264*                            VMOD=2.017                          *
  2265*                                                                *
  2266*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2267*                                                                *
  2268*       LENGTH = 1024                                            *
  2269*                                                                *
  2270******************************************************************
  2271*                   C H A N G E   L O G
  2272*
  2273* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2274*-----------------------------------------------------------------
  2275*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2276* EFFECTIVE    NUMBER
  2277*-----------------------------------------------------------------
  2278* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2279******************************************************************
  2280 01  PROGRAM-INTERFACE-BLOCK.
  2281     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2282     12  PI-CALLING-PROGRAM              PIC X(8).
  2283     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2284     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2285     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2286     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2287     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2288     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2289     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2290     12  PI-COMPANY-ID                   PIC XXX.
  2291     12  PI-COMPANY-CD                   PIC X.
  2292
  2293     12  PI-COMPANY-PASSWORD             PIC X(8).
  2294
  2295     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2296
  2297     12  PI-CONTROL-IN-PROGRESS.
  2298         16  PI-CARRIER                  PIC X.
  2299         16  PI-GROUPING                 PIC X(6).
  2300         16  PI-STATE                    PIC XX.
  2301         16  PI-ACCOUNT                  PIC X(10).
  2302         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2303                                         PIC X(10).
  2304         16  PI-CLAIM-CERT-GRP.
  2305             20  PI-CLAIM-NO             PIC X(7).
  2306             20  PI-CERT-NO.
  2307                 25  PI-CERT-PRIME       PIC X(10).
  2308                 25  PI-CERT-SFX         PIC X.
  2309             20  PI-CERT-EFF-DT          PIC XX.
  2310         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2311             20  PI-PLAN-CODE            PIC X(2).
  2312             20  PI-REVISION-NUMBER      PIC X(3).
  2313             20  PI-PLAN-EFF-DT          PIC X(2).
  2314             20  PI-PLAN-EXP-DT          PIC X(2).
  2315             20  FILLER                  PIC X(11).
  2316         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  45
* EL6311.cbl
  2317             20  PI-OE-REFERENCE-1.
  2318                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2319                 25  PI-OE-REF-1-SUFF    PIC XX.
  2320
  2321     12  PI-SESSION-IN-PROGRESS          PIC X.
  2322         88  CLAIM-SESSION                   VALUE '1'.
  2323         88  CREDIT-SESSION                  VALUE '2'.
  2324         88  WARRANTY-SESSION                VALUE '3'.
  2325         88  MORTGAGE-SESSION                VALUE '4'.
  2326         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2327
  2328
  2329*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2330
  2331     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2332     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2333
  2334     12  PI-CREDIT-USER                  PIC X.
  2335         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2336         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2337
  2338     12  PI-CLAIM-USER                   PIC X.
  2339         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2340         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2341
  2342     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2343         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2344         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2345         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2346         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2347         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2348
  2349     12  PI-PROCESSOR-ID                 PIC X(4).
  2350
  2351     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2352
  2353     12  PI-MEMBER-CAPTION               PIC X(10).
  2354
  2355     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2356         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2357
  2358     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2359     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2360     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2361     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2362
  2363     12  PI-AH-OVERRIDE-L1               PIC X.
  2364     12  PI-AH-OVERRIDE-L2               PIC XX.
  2365     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2366     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2367
  2368     12  PI-NEW-SYSTEM                   PIC X(2).
  2369
  2370     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2371     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2372         88  PI-USES-PAID-TO                 VALUE '1'.
  2373     12  PI-CRDTCRD-SYSTEM.
  2374         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  46
* EL6311.cbl
  2375             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2376             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2377         16  PI-CC-MONTH-END-DT          PIC XX.
  2378     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2379
  2380     12  PI-OE-REFERENCE-2.
  2381         16  PI-OE-REF-2-PRIME           PIC X(10).
  2382         16  PI-OE-REF-2-SUFF            PIC X.
  2383
  2384     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2385
  2386     12  PI-LANGUAGE-TYPE                PIC X.
  2387             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2388             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2389             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2390
  2391     12  PI-POLICY-LINKAGE-IND           PIC X.
  2392         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2393         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2394                                                   LOW-VALUES.
  2395
  2396     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2397     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2398         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2399         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2400
  2401     12  PI-PROCESSOR-CSR-IND            PIC X.
  2402         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2403         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2404
  2405     12  FILLER                          PIC X(3).
  2406
  2407     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2408
  2409     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2410         PI-SYSTEM-LEVEL.
  2411
  2412         16  PI-ENTRY-CODES.
  2413             20  PI-ENTRY-CD-1           PIC X.
  2414             20  PI-ENTRY-CD-2           PIC X.
  2415
  2416         16  PI-RETURN-CODES.
  2417             20  PI-RETURN-CD-1          PIC X.
  2418             20  PI-RETURN-CD-2          PIC X.
  2419
  2420         16  PI-UPDATE-STATUS-SAVE.
  2421             20  PI-UPDATE-BY            PIC X(4).
  2422             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2423
  2424         16  PI-LOWER-CASE-LETTERS       PIC X.
  2425             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2426
  2427*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2428*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2429*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2430
  2431         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2432             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  47
* EL6311.cbl
  2433             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2434             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2435             88  ACCNT-CNTL                  VALUE '3'.
  2436             88  CARR-ACCNT-CNTL             VALUE '4'.
  2437
  2438         16  PI-PROCESSOR-CAP-LIST.
  2439             20  PI-SYSTEM-CONTROLS.
  2440                24 PI-SYSTEM-DISPLAY     PIC X.
  2441                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2442                24 PI-SYSTEM-MODIFY      PIC X.
  2443                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2444             20  FILLER                  PIC XX.
  2445             20  PI-DISPLAY-CAP          PIC X.
  2446                 88  DISPLAY-CAP             VALUE 'Y'.
  2447             20  PI-MODIFY-CAP           PIC X.
  2448                 88  MODIFY-CAP              VALUE 'Y'.
  2449             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2450                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2451             20  PI-FORCE-CAP            PIC X.
  2452                 88  FORCE-CAP               VALUE 'Y'.
  2453
  2454         16  PI-PROGRAM-CONTROLS.
  2455             20  PI-PGM-PRINT-OPT        PIC X.
  2456             20  PI-PGM-FORMAT-OPT       PIC X.
  2457             20  PI-PGM-PROCESS-OPT      PIC X.
  2458             20  PI-PGM-TOTALS-OPT       PIC X.
  2459
  2460         16  PI-HELP-INTERFACE.
  2461             20  PI-LAST-ERROR-NO        PIC X(4).
  2462             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2463
  2464         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2465             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2466
  2467         16  PI-CR-CONTROL-IN-PROGRESS.
  2468             20  PI-CR-CARRIER           PIC X.
  2469             20  PI-CR-GROUPING          PIC X(6).
  2470             20  PI-CR-STATE             PIC XX.
  2471             20  PI-CR-ACCOUNT           PIC X(10).
  2472             20  PI-CR-FIN-RESP          PIC X(10).
  2473             20  PI-CR-TYPE              PIC X.
  2474
  2475         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2476
  2477         16  PI-CR-MONTH-END-DT          PIC XX.
  2478
  2479         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2480             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2481             88  PI-ZERO-CARRIER             VALUE '1'.
  2482             88  PI-ZERO-GROUPING            VALUE '2'.
  2483             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2484
  2485         16  PI-CARRIER-SECURITY         PIC X.
  2486             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2487
  2488         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2489             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2490             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  48
* EL6311.cbl
  2491
  2492         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2493             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2494                                         INDEXED BY PI-ACCESS-NDX
  2495                                         PIC X.
  2496
  2497         16  PI-GA-BILLING-CONTROL       PIC X.
  2498             88  PI-GA-BILLING               VALUE '1'.
  2499
  2500         16  PI-MAIL-PROCESSING          PIC X.
  2501             88  PI-MAIL-YES                 VALUE 'Y'.
  2502
  2503         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2504
  2505         16  PI-AR-SYSTEM.
  2506             20  PI-AR-PROCESSING-CNTL   PIC X.
  2507                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2508             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2509             20  PI-AR-MONTH-END-DT      PIC XX.
  2510
  2511         16  PI-MP-SYSTEM.
  2512             20  PI-MORTGAGE-USER            PIC X.
  2513                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2514                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2515             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2516                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2517                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2518                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2519                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2520                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2521             20  PI-MP-MONTH-END-DT          PIC XX.
  2522             20  PI-MP-REFERENCE-NO.
  2523                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2524                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2525
  2526         16  PI-LABEL-CONTROL            PIC X(01).
  2527             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2528             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2529
  2530         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2531             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2532
  2533         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2534             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2535             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2536
  2537         16  FILLER                      PIC X(14).
  2538
  2539     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2540******************************************************************
  2541
  2542     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2543*    COPY ELC631PI.
  2544******************************************************************
  2545*                                                                *
  2546*                                                                *
  2547*                            ELC631PI                            *
  2548*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  49
* EL6311.cbl
  2549*                                                                *
  2550*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2551*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2552*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2553*                                                                *
  2554*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2555*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2556*    BETWEEN PROGRAMS.                                           *
  2557*                                                                *
  2558*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2559*                                                                *
  2560*               EL631 - EL6311 - EL6312 - EL6313                 *
  2561*                                                                *
  2562******************************************************************
  2563*                   C H A N G E   L O G
  2564*
  2565* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2566*-----------------------------------------------------------------
  2567*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2568* EFFECTIVE    NUMBER
  2569*-----------------------------------------------------------------
  2570* 021414    2003053000001  PEMA  changes for auto chk request
  2571******************************************************************
  2572
  2573         16  PI-631-DATA.
  2574             20  PI-ERPNDB-KEY.
  2575                 24  PI-PB-COMPANY-CD     PIC X.
  2576                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2577                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2578                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2579
  2580             20  PI-ERPNDB-ALT-KEY.
  2581                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2582                 24  PI-PB-CARRIER        PIC X.
  2583                 24  PI-PB-GROUPING       PIC X(6).
  2584                 24  PI-PB-STATE          PIC XX.
  2585                 24  PI-PB-ACCOUNT        PIC X(10).
  2586                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2587                 24  PI-PB-CERT-NO.
  2588                     28  PI-PB-CERT-PRIME PIC X(10).
  2589                     28  PI-PB-CERT-SFX   PIC X.
  2590                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2591                 24  PI-PB-RECORD-TYPE    PIC X.
  2592
  2593             20  PI-ERPNDB-CSR-KEY.
  2594                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2595                 24  PI-PB-CSR-ID             PIC X(4).
  2596                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2597                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2598                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2599
  2600             20  PI-BROWSE-TYPE               PIC X.
  2601                 88  PI-FILE-BROWSE             VALUE ' '.
  2602                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2603                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2604                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2605                 88  PI-CSR-BROWSE              VALUE '4'.
  2606
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  50
* EL6311.cbl
  2607             20  PI-MAINT-FUNCTION            PIC X.
  2608                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2609                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2610                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2611                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2612                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2613                 88  PI-PF5-FUNCTION            VALUE '5'.
  2614                 88  PI-PF6-FUNCTION            VALUE '6'.
  2615
  2616             20  PI-FILE-SWITCHES.
  2617                 24  PI-ALL-ISSUES-SW         PIC X.
  2618                     88  ALL-ISSUES             VALUE 'Y'.
  2619                 24  PI-ALL-CANCELS-SW        PIC X.
  2620                     88  ALL-CANCELS            VALUE 'Y'.
  2621                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2622                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2623                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2624                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2625                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2626                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2627                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2628                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2629                 24  PI-HOLD-REC-SW           PIC X.
  2630                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2631                 24  PI-CHANGE-REC-SW         PIC X.
  2632                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2633                 24  PI-CHK-REQ-REC-SW        PIC X.
  2634                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2635                 24  PI-ISSUE-WARNING-SW      PIC X.
  2636                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2637                 24  PI-CANCEL-WARNING-SW     PIC X.
  2638                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2639             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2640                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2641             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2642                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2643
  2644             20  PI-MAP-NAME                  PIC X(8).
  2645
  2646             20  PI-CURSOR                    PIC S9(4) COMP.
  2647
  2648             20  PI-PREV-ALT-KEY              PIC X(36).
  2649             20  PI-PREV-CSR-KEY              PIC X(15).
  2650             20  PI-PREV-KEY.
  2651                 24  PI-PREV-COMPANY-CD       PIC X.
  2652                 24  PI-PREV-BATCH            PIC X(6).
  2653                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2654                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2655             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2656             20  PI-BROWSE-SW                 PIC X.
  2657                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2658                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2659             20  PI-SV-CARRIER                PIC X.
  2660             20  PI-SV-GROUPING               PIC X(6).
  2661             20  PI-SV-STATE                  PIC XX.
  2662             20  PI-EDIT-SW                   PIC X.
  2663             20  PI-DISPLAY-SW                PIC XX.
  2664                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  51
* EL6311.cbl
  2665                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2666             20  PI-CRITERIA-DATA             PIC X(350).
  2667             20  PI-BMODE                     PIC X.
  2668             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2669             20  PI-BPMTS                     PIC S999     COMP-3.
  2670             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2671             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2672             20  PI-CSR-SESSION-SW            PIC X.
  2673                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2674             20  PI-ERRORS-SW                 PIC X.
  2675                 88  FATAL-ERRORS               VALUE 'X'.
  2676*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2677             20  pi-unforced-sw               pic x.
  2678                 88  unforced-errors            value 'X'.
  2679             20  FILLER                       PIC X(4).
  2680
  2681        16  FILLER             PIC X(94).
  2682
  2683 01  W-LETTER-COMMUNICATION-AREAS.
  2684*    COPY ELC1042.
  2685******************************************************************
  2686*                                                                *
  2687*                                                                *
  2688*                           ELC1042                              *
  2689*                            VMOD=2.002                          *
  2690*                                                                *
  2691*    NOTE                                                        *
  2692*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2693*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2694*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2695*        TO THESE PROGRAMS.                                      *
  2696*                                                                *
  2697*    NOTE                                                        *
  2698*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2699*        USE ONLY!                                               *
  2700*                                                                *
  2701******************************************************************
  2702
  2703         16  PI-1042-WA.
  2704             20  PI-ACTION       PIC  X(01).
  2705                 88 PI-SHOW-MODE           VALUE '1'.
  2706                 88 PI-CLEAR-MODE          VALUE '2'.
  2707                 88 PI-CREATE-MODE         VALUE '3'.
  2708             20  PI-COMM-CONTROL PIC  X(12).
  2709             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2710             20  PI-EOF-SW       PIC  X(01).
  2711                 88  PI-FILE-EOF           VALUE 'Y'.
  2712             20  PI-FILETYP      PIC  X(01).
  2713             20  PI-FORM-SQUEEZE-CONTROL
  2714                                 PIC  X(01).
  2715                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2716                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2717             20  PI-LAST-CONTROL PIC  X(12).
  2718             20  PI-TEMP-STOR-ITEMS
  2719                                 PIC S9(04) COMP.
  2720             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2721             20  PI-UPDATE-SW    PIC  9(01).
  2722                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  52
* EL6311.cbl
  2723             20  PI-104-SCREEN-SENT-IND
  2724                                 PIC  X(01).
  2725                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2726                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2727             20  PI-1042-SCREEN-SENT-IND
  2728                                 PIC  X(01).
  2729                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2730                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2731             20  PI-1042-ARCHIVE-IND
  2732                                 PIC  X(01).
  2733                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2734             20  FILLER          PIC  X(29).
  2735*    COPY ELC689PI.
  2736******************************************************************
  2737*                                                                *
  2738*                            ELC689PI                            *
  2739*                            VMOD=2.003                          *
  2740*                                                                *
  2741*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2742*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2743*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2744*                                                                *
  2745*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2746*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2747*    BETWEEN PROGRAMS.                                           *
  2748*                                                                *
  2749*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2750*                                                                *
  2751*               EL631 - EL689  - EL6891 - EL6892                 *
  2752*                                                                *
  2753******************************************************************
  2754*                   C H A N G E   L O G
  2755*
  2756* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2757*-----------------------------------------------------------------
  2758*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2759* EFFECTIVE    NUMBER
  2760*-----------------------------------------------------------------
  2761* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2762* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2763* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2764******************************************************************
  2765
  2766
  2767         16  PI-689-WORK-AREA.
  2768             20  PI-689-ALT-PRINTER-ID
  2769                                 PIC  X(04).
  2770             20  PI-689-ARCHIVE-NUMBER
  2771                                 PIC  9(08).
  2772             20  PI-689-ARCHIVE-SW
  2773                                 PIC  X(01).
  2774                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2775             20  PI-689-DATA-SOURCE
  2776                                 PIC  X(01).
  2777                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2778                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2779                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2780                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  53
* EL6311.cbl
  2781                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2782             20  PI-689-ERROR-IND
  2783                                 PIC  X(01).
  2784                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2785             20  PI-689-ERROR    PIC  9(04).
  2786                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2787                 88  PI-689-FATAL-ERROR
  2788                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2789                            0042 0047 0051 0066 0067 0070
  2790                            0168 0169 0174 0175 0176 0177 0179
  2791                            0180 0181 0182 0184 0185 0189 0190
  2792                            0191
  2793                            0215 0279 0280
  2794                            0412 0413 0454
  2795                            0533 0537
  2796                            2055 2114 2208 2209 2216 2232 2369
  2797                            2398 2433 2908 2999
  2798                            3000 3770 3771 3775
  2799                            7250 7365 7367 7368 7369 7370 7371
  2800                            7272 7373 7374 7376 7377 7378 7379
  2801                            7381 7388 7390 7393 7395 7396 7398
  2802                            9095 9096 9281 9298 9299 9320 9327
  2803                            9426 9427.
  2804                 88  PI-689-STOP-ERROR
  2805                     VALUES 0004 0008 0013 0023 0029 0033
  2806                            0042 0047 0066 0067 0070
  2807                            0168 0169 0174 0175 0176 0177
  2808                            0181 0182 0184 0185 0189 0190
  2809                            0279 0280
  2810                            0412 0413 0454
  2811                            2055 2208 2209 2216 2232
  2812                            2398 2999
  2813                            3000 3770 3771 3775
  2814                            7250 7365 7369 7370 7371
  2815                            7272 7373 7374 7376 7377 7378 7379
  2816                            7381 7388 7390 7393 7396 7398
  2817                            9095 9096 9299 9320 9426.
  2818             20  PI-689-FOLLOW-UP-DATE
  2819                                 PIC  X(02).
  2820             20  PI-689-FORM-NUMBER
  2821                                 PIC  X(04).
  2822             20  PI-689-LABEL-SOURCE
  2823                                 PIC X(01).
  2824                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2825                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2826                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2827                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2828                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2829                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2830                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2831             20  PI-689-NUMBER-COPIES
  2832                                 PIC  9(01).
  2833             20  PI-689-NUMBER-LABEL-LINES
  2834                                 PIC  9(01).
  2835             20  PI-689-NUMBER-TEXT-RECORDS
  2836                                 PIC  9(03).
  2837             20  PI-689-PRINT-ORDER-SW
  2838                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  54
* EL6311.cbl
  2839                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2840                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2841                 88  PI-689-PRINT-LATER     VALUE '3'.
  2842                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2843             20  PI-689-PRINT-RESTRICTION
  2844                                 PIC  X(01).
  2845                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2846                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2847                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2848             20  PI-689-PRINT-SW PIC  X(01).
  2849                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2850             20  PI-689-RESEND-DATE-1
  2851                                 PIC  X(02).
  2852             20  PI-689-RESEND-LETR-1
  2853                                 PIC X(4).
  2854             20  PI-689-TEMP-STOR-ID
  2855                                 PIC  X(08).
  2856             20  PI-689-USE-SCREEN-IND
  2857                                 PIC  X(01).
  2858                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2859             20  PI-689-ARCH-POINTER
  2860                                 PIC S9(08) COMP.
  2861                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2862             20  PI-689-ARCT-POINTER
  2863                                 PIC S9(08) COMP.
  2864                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2865             20  PI-689-VARIABLE-DATA-GRP.
  2866                 24  PI-689-VARIABLE-DATA-1
  2867                                 PIC  X(30).
  2868                 24  PI-689-VARIABLE-DATA-2
  2869                                 PIC  X(30).
  2870                 24  PI-689-VARIABLE-DATA-3
  2871                                 PIC  X(30).
  2872                 24  PI-689-VARIABLE-DATA-4
  2873                                 PIC  X(30).
  2874
  2875         16  PI-689-KEY-DATA-FIELDS.
  2876             20  PI-689-ACCOUNT  PIC  X(10).
  2877             20  PI-689-CARRIER  PIC  X(01).
  2878             20  PI-689-CERT-NO.
  2879                 24  PI-689-CERT-PRIME
  2880                                 PIC  X(10).
  2881                 24  PI-689-CERT-SFX
  2882                                 PIC  X(01).
  2883             20  PI-689-CHG-SEQ-NO
  2884                                 PIC S9(04)    COMP.
  2885             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2886                                 PIC  X(02).
  2887             20  PI-689-ENTRY-BATCH
  2888                                 PIC  X(06).
  2889             20  PI-689-EFF-DATE PIC  X(02).
  2890             20  PI-689-EXP-DATE PIC  X(02).
  2891             20  PI-689-GROUPING PIC  X(06).
  2892             20  PI-689-RESP-PERSON
  2893                                 PIC  X(10).
  2894             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2895             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2896                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  55
* EL6311.cbl
  2897             20  PI-689-STATE    PIC  X(02).
  2898             20  PI-689-TYPE     PIC  X(01).
  2899             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2900             20  PI-689-ALT-SEQ-NO
  2901                                 PIC S9(04)    COMP.
  2902         16  PI-689-DATE-EDIT    PIC  X(08).
  2903         16  PI-689-FOLLOW-UP-EDIT
  2904                                 PIC  X(08).
  2905         16  PI-689-RESEND1-EDIT PIC  X(08).
  2906         16  PI-689-SEQ-EDIT     PIC  X(08).
  2907         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2908         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2909             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2910         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2911         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  56
* EL6311.cbl
  2913
  2914 01  WS-EL6315-PASS-AREA.
  2915        16  PI-6315-ISS-CAN-SW      PIC X.
  2916        16  FILLER                  PIC X(120).
  2917        16  PI-RES-REF-CLM-TYPE     PIC X.
  2918        16  FILLER                  PIC X.
  2919        16  PI-6315-PASS-AREA.
  2920            20 FILLER               PIC X(236).
  2921            20 PI-6315-FINALIZED    PIC X.
  2922            20 FILLER               PIC X(280).
  2923
  2924 01  WS-EL6316-PASS-AREA.
  2925        16  PI-ISS-CAN-SW           PIC X.
  2926        16  FILLER                  PIC X(121).
  2927        16  PI-CLM-RESC-IND         PIC X.
  2928        16  PI-6316-PASS-AREA.
  2929            20 FILLER               PIC X(236).
  2930            20 PI-6316-FINALIZED    PIC X.
  2931            20 FILLER               PIC X(280).
  2932
  2933******************************************************************
  2934*                                                                *
  2935*         P A S S   A R E A   F O R   E D I T                    *
  2936*                                                                *
  2937******************************************************************
  2938
  2939 01  PASSED-RECORD.
  2940     12  RECORD-SAVE                  PIC X(585).
  2941* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2942*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2943*                    BY  WK-CURRENT-DATE.
  2944******************************************************************
  2945*                                                                *
  2946*                                                                *
  2947*                             ELC50W1                            *
  2948*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2949*                            VMOD=2.004                          *
  2950*                                                                *
  2951*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2952*                                                                *
  2953*                                                                *
  2954******************************************************************
  2955
  2956     12  WK-WORK-AREA.
  2957         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2958         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2959         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2960         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2961         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2962         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2963         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2964         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2965         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2966         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2967         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2968         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2969         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2970         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  57
* EL6311.cbl
  2971         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2972         16  WK-CREDIT-EDIT-CONTROLS.
  2973             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2974             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2975             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2976             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2977             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2978             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2979         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2980         16  WK-SAVE-REIN-DATA.
  2981             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2982             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2983             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2984         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2985             88  ENTRY-FROM-EL6311       VALUE '6'.
  2986         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2987         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2988     12  WK-RECORD-ADDRESSES.
  2989         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2990         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2991         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2992         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2993         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2994         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2995         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2996         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2997     12  WK-OVER-SHORT-AREA.
  2998         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2999         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3000         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3001             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3002         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  58
* EL6311.cbl
  3004
  3005*    COPY ELCEDITC.
  3006******************************************************************
  3007*                                                                *
  3008*                                                                *
  3009*                            ELCEDITC                            *
  3010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3011*                            VMOD=2.012                          *
  3012*                                                                *
  3013*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3014*                     EL6313, EL050 AND EL517.                   *
  3015*                                                                *
  3016******************************************************************
  3017******************************************************************
  3018*                   C H A N G E   L O G
  3019*
  3020* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3021*-----------------------------------------------------------------
  3022*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3023* EFFECTIVE    NUMBER
  3024*-----------------------------------------------------------------
  3025* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3026******************************************************************
  3027
  3028     12  EDIT-CRITERIA-DATA.
  3029         16  EC-CO-MONTH-END-DT       PIC XX.
  3030         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3031         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3032         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3033         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3034         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3035         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3036         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3037         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3038         16  EC-CO-REM-TERM-CALC      PIC X.
  3039               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3040               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3041               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3042               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3043
  3044         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3045               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3046               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3047               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3048               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3049               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3050               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3051               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3052               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3053               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3054               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3055
  3056         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3057               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3058               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3059               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3060               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3061               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  59
* EL6311.cbl
  3062               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3063               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3064               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3065
  3066         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3067                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3068                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3069
  3070         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3071                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3072                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3073                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3074                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3075                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3076                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3077                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3078                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3079
  3080         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3081               88  EC-BR-REDUCING                   VALUE 'R'.
  3082               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3083
  3084         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3085         16  EC-BR-LF-DESC             PIC X(10).
  3086         16  EC-BR-AH-DESC             PIC X(10).
  3087         16  EC-BR-LF-COMMENT          PIC X(10).
  3088         16  EC-BR-AH-COMMENT          PIC X(10).
  3089
  3090         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3091               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3092               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3093               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3094               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3095
  3096         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3097               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3098               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3099               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3100               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3101
  3102         16  EC-BR-LF-REFUND-CALC      PIC X.
  3103                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3104                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3105                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3106                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3107                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3108                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3109                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3110
  3111         16  EC-BR-AH-REFUND-CALC      PIC X.
  3112                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3113                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3114                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3115                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3116                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3117                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3118                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3119                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  60
* EL6311.cbl
  3120
  3121         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3122                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3123                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3124                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3125
  3126         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3127                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3128                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3129                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3130
  3131         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3132         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3133         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3134         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3135
  3136         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3137         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3138                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3139                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3140                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3141                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3142
  3143         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3144               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3145               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3146               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3147               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3148               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3149
  3150         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3151               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3152               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3153               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3154               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3155               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3156
  3157         16  EC-ST-LF-REFUND-CALC      PIC X.
  3158                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3159                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3160                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3161                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3162                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3163                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3164                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3165                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3166
  3167         16  EC-ST-AH-REFUND-CALC      PIC X.
  3168                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3169                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3170                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3171                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3172                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3173                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3174                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3175                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3176
  3177         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  61
* EL6311.cbl
  3178         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3179         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3180         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3181         16  EC-AM-EXPIRATION-DT       PIC XX.
  3182         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3183         16  EC-AM-CLASS-CD            PIC XX.
  3184         16  EC-AM-LF-DEVIATION        PIC XXX.
  3185         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3186         16  EC-AM-AH-DEVIATION        PIC XXX.
  3187         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3188         16  EC-AM-PHONE-NO            PIC X(10).
  3189
  3190         16  EC-AM-LF-REFUND-CALC      PIC X.
  3191                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3192                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3193                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3194                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3195                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3196                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3197                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3198
  3199         16  EC-AM-AH-REFUND-CALC      PIC X.
  3200                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3201                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3202                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3203                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3204                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3205                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3206                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3207
  3208         16  EC-AM-BEN-I-G-CD          PIC X.
  3209                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3210                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3211                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3212
  3213         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3214         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3215         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3216         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3217         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3218         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3219         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3220         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3221         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3222
  3223         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3224         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3225         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3226         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3227         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3228         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3229         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3230         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3231         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3232         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3233         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3234         16  EC-RT-LF-NSP-ST           PIC XX.
  3235         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  62
* EL6311.cbl
  3236         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3237         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3238
  3239         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3240             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3241                                             'M' '5' '9' '2'.
  3242             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3243             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3244             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3245             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3246             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3247             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3248             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3249             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3250             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3251             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3252
  3253         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3254             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3255                                             'M' '5' '9' '2'.
  3256             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3257             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3258             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3259             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3260             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3261             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3262             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3263             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3264             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3265             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3266
  3267         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3268         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3269         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3270         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3271         16  EC-CM-DEATH-DT            PIC XX.
  3272
  3273*DMD CUSTOM CODING FIELDS BELOW
  3274*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3275         16  EC-BR-DMD-RATING-SW       PIC X.
  3276                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3277                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3278                 88  NO-DMD-RATING               VALUE 'N'.
  3279
  3280         16  EC-NEW-CERT               PIC X(11).
  3281         16  EC-NEW-STATE              PIC XX.
  3282         16  FILLER                    PIC X.
  3283*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3284         16  OVER-SHORT-EDIT-FIELDS.
  3285             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3286             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3287             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3288             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3289             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3290             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3291             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3292             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3293             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  63
* EL6311.cbl
  3294         16  FILLER                    PIC X(71).
  3295
  3296******************************************************************
  3297
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  64
* EL6311.cbl
  3299
  3300*    COPY ELCJPFX.
  3301******************************************************************
  3302*                                                                *
  3303*                                                                *
  3304*                            ELCJPFX.                            *
  3305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3306*                            VMOD=2.002                          *
  3307*                                                                *
  3308*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3309*                                                                *
  3310*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3311*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3312*        ELCNTL - CONTROL FILE                                   *
  3313*        ELMSTR - CLAIM MASTERS                                  *
  3314*        ELTRLR - ACTIVITY TRAILERS                              *
  3315*        ELCHKQ - CHECK QUE                                      *
  3316******************************************************************
  3317 01  JOURNAL-RECORD.
  3318     12  jp-date                     pic s9(5) comp-3.
  3319     12  jp-time                     pic s9(7) comp-3.
  3320     12  JP-USER-ID                  PIC X(4).
  3321     12  JP-FILE-ID                  PIC X(8).
  3322     12  JP-PROGRAM-ID               PIC X(8).
  3323     12  JP-RECORD-TYPE              PIC X.
  3324         88 JP-ADD              VALUE 'A'.
  3325         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3326         88 JP-AFTER-CHANGE     VALUE 'C'.
  3327         88 JP-DELETE           VALUE 'D'.
  3328         88 JP-GENERIC-DELETE   VALUE 'G'.
  3329         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3330         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3331     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3332     12  JP-RECORD-AREA
  3333
  3334
  3335                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  65
* EL6311.cbl
  3337*    COPY ELCAID.
  3338******************************************************************
  3339*                                                                *
  3340*                            ELCAID.                             *
  3341*                            VMOD=2.001                          *
  3342*                                                                *
  3343*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3344*                                                                *
  3345*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3346*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3347******************************************************************
  3348
  3349 01  DFHAID.
  3350   02  DFHNULL   PIC  X  VALUE  ' '.
  3351   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3352   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3353   02  DFHPEN    PIC  X  VALUE  '='.
  3354   02  DFHOPID   PIC  X  VALUE  'W'.
  3355   02  DFHPA1    PIC  X  VALUE  '%'.
  3356   02  DFHPA2    PIC  X  VALUE  '>'.
  3357   02  DFHPA3    PIC  X  VALUE  ','.
  3358   02  DFHPF1    PIC  X  VALUE  '1'.
  3359   02  DFHPF2    PIC  X  VALUE  '2'.
  3360   02  DFHPF3    PIC  X  VALUE  '3'.
  3361   02  DFHPF4    PIC  X  VALUE  '4'.
  3362   02  DFHPF5    PIC  X  VALUE  '5'.
  3363   02  DFHPF6    PIC  X  VALUE  '6'.
  3364   02  DFHPF7    PIC  X  VALUE  '7'.
  3365   02  DFHPF8    PIC  X  VALUE  '8'.
  3366   02  DFHPF9    PIC  X  VALUE  '9'.
  3367   02  DFHPF10   PIC  X  VALUE  ':'.
  3368   02  DFHPF11   PIC  X  VALUE  '#'.
  3369   02  DFHPF12   PIC  X  VALUE  '@'.
  3370   02  DFHPF13   PIC  X  VALUE  'A'.
  3371   02  DFHPF14   PIC  X  VALUE  'B'.
  3372   02  DFHPF15   PIC  X  VALUE  'C'.
  3373   02  DFHPF16   PIC  X  VALUE  'D'.
  3374   02  DFHPF17   PIC  X  VALUE  'E'.
  3375   02  DFHPF18   PIC  X  VALUE  'F'.
  3376   02  DFHPF19   PIC  X  VALUE  'G'.
  3377   02  DFHPF20   PIC  X  VALUE  'H'.
  3378   02  DFHPF21   PIC  X  VALUE  'I'.
  3379*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3380   02  DFHPF22   PIC  X  VALUE  '['.
  3381   02  DFHPF23   PIC  X  VALUE  '.'.
  3382   02  DFHPF24   PIC  X  VALUE  '<'.
  3383   02  DFHMSRE   PIC  X  VALUE  'X'.
  3384   02  DFHSTRF   PIC  X  VALUE  'h'.
  3385   02  DFHTRIG   PIC  X  VALUE  '"'.
  3386
  3387 01  FILLER    REDEFINES DFHAID.
  3388     12  FILLER              PIC X(8).
  3389     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3390
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  66
* EL6311.cbl
  3392*    COPY EL6311S.
  3393 01  EL631BI.
  3394     05  FILLER            PIC  X(0012).
  3395*    -------------------------------
  3396     05  BDATEL PIC S9(0004) COMP.
  3397     05  BDATEF PIC  X(0001).
  3398     05  FILLER REDEFINES BDATEF.
  3399         10  BDATEA PIC  X(0001).
  3400     05  BDATEI PIC  X(0008).
  3401*    -------------------------------
  3402     05  BTIMEL PIC S9(0004) COMP.
  3403     05  BTIMEF PIC  X(0001).
  3404     05  FILLER REDEFINES BTIMEF.
  3405         10  BTIMEA PIC  X(0001).
  3406     05  BTIMEI PIC  X(0005).
  3407*    -------------------------------
  3408     05  BHEADL PIC S9(0004) COMP.
  3409     05  BHEADF PIC  X(0001).
  3410     05  FILLER REDEFINES BHEADF.
  3411         10  BHEADA PIC  X(0001).
  3412     05  BHEADI PIC  X(0038).
  3413*    -------------------------------
  3414     05  BNCERTLL PIC S9(0004) COMP.
  3415     05  BNCERTLF PIC  X(0001).
  3416     05  FILLER REDEFINES BNCERTLF.
  3417         10  BNCERTLA PIC  X(0001).
  3418     05  BNCERTLI PIC  X(0008).
  3419*    -------------------------------
  3420     05  BNCERTL PIC S9(0004) COMP.
  3421     05  BNCERTF PIC  X(0001).
  3422     05  FILLER REDEFINES BNCERTF.
  3423         10  BNCERTA PIC  X(0001).
  3424     05  BNCERTI PIC  X(0011).
  3425*    -------------------------------
  3426     05  BNSTATLL PIC S9(0004) COMP.
  3427     05  BNSTATLF PIC  X(0001).
  3428     05  FILLER REDEFINES BNSTATLF.
  3429         10  BNSTATLA PIC  X(0001).
  3430     05  BNSTATLI PIC  X(0009).
  3431*    -------------------------------
  3432     05  BNSTATL PIC S9(0004) COMP.
  3433     05  BNSTATF PIC  X(0001).
  3434     05  FILLER REDEFINES BNSTATF.
  3435         10  BNSTATA PIC  X(0001).
  3436     05  BNSTATI PIC  X(0002).
  3437*    -------------------------------
  3438     05  BCHGTL PIC S9(0004) COMP.
  3439     05  BCHGTF PIC  X(0001).
  3440     05  FILLER REDEFINES BCHGTF.
  3441         10  BCHGTA PIC  X(0001).
  3442     05  BCHGTI PIC  X(0004).
  3443*    -------------------------------
  3444     05  BCHGL PIC S9(0004) COMP.
  3445     05  BCHGF PIC  X(0001).
  3446     05  FILLER REDEFINES BCHGF.
  3447         10  BCHGA PIC  X(0001).
  3448     05  BCHGI PIC  X(0004).
  3449*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  67
* EL6311.cbl
  3450     05  BCOMPIDL PIC S9(0004) COMP.
  3451     05  BCOMPIDF PIC  X(0001).
  3452     05  FILLER REDEFINES BCOMPIDF.
  3453         10  BCOMPIDA PIC  X(0001).
  3454     05  BCOMPIDI PIC  X(0003).
  3455*    -------------------------------
  3456     05  BREGIONL PIC S9(0004) COMP.
  3457     05  BREGIONF PIC  X(0001).
  3458     05  FILLER REDEFINES BREGIONF.
  3459         10  BREGIONA PIC  X(0001).
  3460     05  BREGIONI PIC  X(0006).
  3461*    -------------------------------
  3462     05  BUSERL PIC S9(0004) COMP.
  3463     05  BUSERF PIC  X(0001).
  3464     05  FILLER REDEFINES BUSERF.
  3465         10  BUSERA PIC  X(0001).
  3466     05  BUSERI PIC  X(0004).
  3467*    -------------------------------
  3468     05  BMAINTL PIC S9(0004) COMP.
  3469     05  BMAINTF PIC  X(0001).
  3470     05  FILLER REDEFINES BMAINTF.
  3471         10  BMAINTA PIC  X(0001).
  3472     05  BMAINTI PIC  X(0001).
  3473*    -------------------------------
  3474     05  BMANTBYL PIC S9(0004) COMP.
  3475     05  BMANTBYF PIC  X(0001).
  3476     05  FILLER REDEFINES BMANTBYF.
  3477         10  BMANTBYA PIC  X(0001).
  3478     05  BMANTBYI PIC  X(0004).
  3479*    -------------------------------
  3480     05  BCHGHDGL PIC S9(0004) COMP.
  3481     05  BCHGHDGF PIC  X(0001).
  3482     05  FILLER REDEFINES BCHGHDGF.
  3483         10  BCHGHDGA PIC  X(0001).
  3484     05  BCHGHDGI PIC  X(0003).
  3485*    -------------------------------
  3486     05  BMANTDTL PIC S9(0004) COMP.
  3487     05  BMANTDTF PIC  X(0001).
  3488     05  FILLER REDEFINES BMANTDTF.
  3489         10  BMANTDTA PIC  X(0001).
  3490     05  BMANTDTI PIC  X(0008).
  3491*    -------------------------------
  3492     05  BMANTATL PIC S9(0004) COMP.
  3493     05  BMANTATF PIC  X(0001).
  3494     05  FILLER REDEFINES BMANTATF.
  3495         10  BMANTATA PIC  X(0001).
  3496     05  BMANTATI PIC  X(0005).
  3497*    -------------------------------
  3498     05  BCSRL PIC S9(0004) COMP.
  3499     05  BCSRF PIC  X(0001).
  3500     05  FILLER REDEFINES BCSRF.
  3501         10  BCSRA PIC  X(0001).
  3502     05  BCSRI PIC  X(0004).
  3503*    -------------------------------
  3504     05  BBATCHL PIC S9(0004) COMP.
  3505     05  BBATCHF PIC  X(0001).
  3506     05  FILLER REDEFINES BBATCHF.
  3507         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  68
* EL6311.cbl
  3508     05  BBATCHI PIC  X(0006).
  3509*    -------------------------------
  3510     05  BSEQL PIC S9(0004) COMP.
  3511     05  BSEQF PIC  X(0001).
  3512     05  FILLER REDEFINES BSEQF.
  3513         10  BSEQA PIC  X(0001).
  3514     05  BSEQI PIC  X(0004).
  3515*    -------------------------------
  3516     05  BMOENDTL PIC S9(0004) COMP.
  3517     05  BMOENDTF PIC  X(0001).
  3518     05  FILLER REDEFINES BMOENDTF.
  3519         10  BMOENDTA PIC  X(0001).
  3520     05  BMOENDTI PIC  X(0008).
  3521*    -------------------------------
  3522     05  BCARRL PIC S9(0004) COMP.
  3523     05  BCARRF PIC  X(0001).
  3524     05  FILLER REDEFINES BCARRF.
  3525         10  BCARRA PIC  X(0001).
  3526     05  BCARRI PIC  X(0001).
  3527*    -------------------------------
  3528     05  BGROUPL PIC S9(0004) COMP.
  3529     05  BGROUPF PIC  X(0001).
  3530     05  FILLER REDEFINES BGROUPF.
  3531         10  BGROUPA PIC  X(0001).
  3532     05  BGROUPI PIC  X(0006).
  3533*    -------------------------------
  3534     05  BSTATEL PIC S9(0004) COMP.
  3535     05  BSTATEF PIC  X(0001).
  3536     05  FILLER REDEFINES BSTATEF.
  3537         10  BSTATEA PIC  X(0001).
  3538     05  BSTATEI PIC  X(0002).
  3539*    -------------------------------
  3540     05  BACCTL PIC S9(0004) COMP.
  3541     05  BACCTF PIC  X(0001).
  3542     05  FILLER REDEFINES BACCTF.
  3543         10  BACCTA PIC  X(0001).
  3544     05  BACCTI PIC  X(0010).
  3545*    -------------------------------
  3546     05  BVINHL PIC S9(0004) COMP.
  3547     05  BVINHF PIC  X(0001).
  3548     05  FILLER REDEFINES BVINHF.
  3549         10  BVINHA PIC  X(0001).
  3550     05  BVINHI PIC  X(0004).
  3551*    -------------------------------
  3552     05  BVINL PIC S9(0004) COMP.
  3553     05  BVINF PIC  X(0001).
  3554     05  FILLER REDEFINES BVINF.
  3555         10  BVINA PIC  X(0001).
  3556     05  BVINI PIC  X(0017).
  3557*    -------------------------------
  3558     05  BREFHDGL PIC S9(0004) COMP.
  3559     05  BREFHDGF PIC  X(0001).
  3560     05  FILLER REDEFINES BREFHDGF.
  3561         10  BREFHDGA PIC  X(0001).
  3562     05  BREFHDGI PIC  X(0004).
  3563*    -------------------------------
  3564     05  BREFL PIC S9(0004) COMP.
  3565     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  69
* EL6311.cbl
  3566     05  FILLER REDEFINES BREFF.
  3567         10  BREFA PIC  X(0001).
  3568     05  BREFI PIC  X(0012).
  3569*    -------------------------------
  3570     05  BAGEDEFL PIC S9(0004) COMP.
  3571     05  BAGEDEFF PIC  X(0001).
  3572     05  FILLER REDEFINES BAGEDEFF.
  3573         10  BAGEDEFA PIC  X(0001).
  3574     05  BAGEDEFI PIC  X(0004).
  3575*    -------------------------------
  3576     05  BCERTNOL PIC S9(0004) COMP.
  3577     05  BCERTNOF PIC  X(0001).
  3578     05  FILLER REDEFINES BCERTNOF.
  3579         10  BCERTNOA PIC  X(0001).
  3580     05  BCERTNOI PIC  X(0010).
  3581*    -------------------------------
  3582     05  BSUFIXL PIC S9(0004) COMP.
  3583     05  BSUFIXF PIC  X(0001).
  3584     05  FILLER REDEFINES BSUFIXF.
  3585         10  BSUFIXA PIC  X(0001).
  3586     05  BSUFIXI PIC  X(0001).
  3587*    -------------------------------
  3588     05  BEFFDTL PIC S9(0004) COMP.
  3589     05  BEFFDTF PIC  X(0001).
  3590     05  FILLER REDEFINES BEFFDTF.
  3591         10  BEFFDTA PIC  X(0001).
  3592     05  BEFFDTI PIC  X(0008).
  3593*    -------------------------------
  3594     05  BLSTNML PIC S9(0004) COMP.
  3595     05  BLSTNMF PIC  X(0001).
  3596     05  FILLER REDEFINES BLSTNMF.
  3597         10  BLSTNMA PIC  X(0001).
  3598     05  BLSTNMI PIC  X(0015).
  3599*    -------------------------------
  3600     05  B1STNML PIC S9(0004) COMP.
  3601     05  B1STNMF PIC  X(0001).
  3602     05  FILLER REDEFINES B1STNMF.
  3603         10  B1STNMA PIC  X(0001).
  3604     05  B1STNMI PIC  X(0010).
  3605*    -------------------------------
  3606     05  BINITL PIC S9(0004) COMP.
  3607     05  BINITF PIC  X(0001).
  3608     05  FILLER REDEFINES BINITF.
  3609         10  BINITA PIC  X(0001).
  3610     05  BINITI PIC  X(0001).
  3611*    -------------------------------
  3612     05  BSEXL PIC S9(0004) COMP.
  3613     05  BSEXF PIC  X(0001).
  3614     05  FILLER REDEFINES BSEXF.
  3615         10  BSEXA PIC  X(0001).
  3616     05  BSEXI PIC  X(0001).
  3617*    -------------------------------
  3618     05  BAGEL PIC S9(0004) COMP.
  3619     05  BAGEF PIC  X(0001).
  3620     05  FILLER REDEFINES BAGEF.
  3621         10  BAGEA PIC  X(0001).
  3622     05  BAGEI PIC  X(0002).
  3623*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  70
* EL6311.cbl
  3624     05  BBIRTHL PIC S9(0004) COMP.
  3625     05  BBIRTHF PIC  X(0001).
  3626     05  FILLER REDEFINES BBIRTHF.
  3627         10  BBIRTHA PIC  X(0001).
  3628     05  BBIRTHI PIC  X(0008).
  3629*    -------------------------------
  3630     05  B1STPMTL PIC S9(0004) COMP.
  3631     05  B1STPMTF PIC  X(0001).
  3632     05  FILLER REDEFINES B1STPMTF.
  3633         10  B1STPMTA PIC  X(0001).
  3634     05  B1STPMTI PIC  X(0008).
  3635*    -------------------------------
  3636     05  BDAYSL PIC S9(0004) COMP.
  3637     05  BDAYSF PIC  X(0001).
  3638     05  FILLER REDEFINES BDAYSF.
  3639         10  BDAYSA PIC  X(0001).
  3640     05  BDAYSI PIC  X(0003).
  3641*    -------------------------------
  3642     05  BLNTRML PIC S9(0004) COMP.
  3643     05  BLNTRMF PIC  X(0001).
  3644     05  FILLER REDEFINES BLNTRMF.
  3645         10  BLNTRMA PIC  X(0001).
  3646     05  BLNTRMI PIC  X(0003).
  3647*    -------------------------------
  3648     05  BLNOFCRL PIC S9(0004) COMP.
  3649     05  BLNOFCRF PIC  X(0001).
  3650     05  FILLER REDEFINES BLNOFCRF.
  3651         10  BLNOFCRA PIC  X(0001).
  3652     05  BLNOFCRI PIC  X(0005).
  3653*    -------------------------------
  3654     05  BMODEL PIC S9(0004) COMP.
  3655     05  BMODEF PIC  X(0001).
  3656     05  FILLER REDEFINES BMODEF.
  3657         10  BMODEA PIC  X(0001).
  3658     05  BMODEI PIC  X(0001).
  3659*    -------------------------------
  3660     05  BFREQL PIC S9(0004) COMP.
  3661     05  BFREQF PIC  X(0001).
  3662     05  FILLER REDEFINES BFREQF.
  3663         10  BFREQA PIC  X(0001).
  3664     05  BFREQI PIC  X(0002).
  3665*    -------------------------------
  3666     05  BPMTSL PIC S9(0004) COMP.
  3667     05  BPMTSF PIC  X(0001).
  3668     05  FILLER REDEFINES BPMTSF.
  3669         10  BPMTSA PIC  X(0001).
  3670     05  BPMTSI PIC  999.
  3671*    -------------------------------
  3672     05  BPMTAMTL PIC S9(0004) COMP.
  3673     05  BPMTAMTF PIC  X(0001).
  3674     05  FILLER REDEFINES BPMTAMTF.
  3675         10  BPMTAMTA PIC  X(0001).
  3676     05  BPMTAMTI PIC  9(7)V99.
  3677*    -------------------------------
  3678     05  BAPRL PIC S9(0004) COMP.
  3679     05  BAPRF PIC  X(0001).
  3680     05  FILLER REDEFINES BAPRF.
  3681         10  BAPRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  71
* EL6311.cbl
  3682     05  BAPRI PIC  X(7).
  3683*    -------------------------------
  3684     05  BLIVESL PIC S9(0004) COMP.
  3685     05  BLIVESF PIC  X(0001).
  3686     05  FILLER REDEFINES BLIVESF.
  3687         10  BLIVESA PIC  X(0001).
  3688     05  BLIVESI PIC  X(0009).
  3689*    -------------------------------
  3690     05  BMEMCAPL PIC S9(0004) COMP.
  3691     05  BMEMCAPF PIC  X(0001).
  3692     05  FILLER REDEFINES BMEMCAPF.
  3693         10  BMEMCAPA PIC  X(0001).
  3694     05  BMEMCAPI PIC  X(0011).
  3695*    -------------------------------
  3696     05  BORIGHDL PIC S9(0004) COMP.
  3697     05  BORIGHDF PIC  X(0001).
  3698     05  FILLER REDEFINES BORIGHDF.
  3699         10  BORIGHDA PIC  X(0001).
  3700     05  BORIGHDI PIC  X(0009).
  3701*    -------------------------------
  3702     05  DMDBILL PIC S9(0004) COMP.
  3703     05  DMDBILF PIC  X(0001).
  3704     05  FILLER REDEFINES DMDBILF.
  3705         10  DMDBILA PIC  X(0001).
  3706     05  DMDBILI PIC  X(0006).
  3707*    -------------------------------
  3708     05  BFORCEL PIC S9(0004) COMP.
  3709     05  BFORCEF PIC  X(0001).
  3710     05  FILLER REDEFINES BFORCEF.
  3711         10  BFORCEA PIC  X(0001).
  3712     05  BFORCEI PIC  X(0001).
  3713*    -------------------------------
  3714     05  BENTRYL PIC S9(0004) COMP.
  3715     05  BENTRYF PIC  X(0001).
  3716     05  FILLER REDEFINES BENTRYF.
  3717         10  BENTRYA PIC  X(0001).
  3718     05  BENTRYI PIC  X(0001).
  3719*    -------------------------------
  3720     05  BREINL PIC S9(0004) COMP.
  3721     05  BREINF PIC  X(0001).
  3722     05  FILLER REDEFINES BREINF.
  3723         10  BREINA PIC  X(0001).
  3724     05  BREINI PIC  X(0001).
  3725*    -------------------------------
  3726     05  BBILCDL PIC S9(0004) COMP.
  3727     05  BBILCDF PIC  X(0001).
  3728     05  FILLER REDEFINES BBILCDF.
  3729         10  BBILCDA PIC  X(0001).
  3730     05  BBILCDI PIC  X(0001).
  3731*    -------------------------------
  3732     05  BUNWRITL PIC S9(0004) COMP.
  3733     05  BUNWRITF PIC  X(0001).
  3734     05  FILLER REDEFINES BUNWRITF.
  3735         10  BUNWRITA PIC  X(0001).
  3736     05  BUNWRITI PIC  X(0001).
  3737*    -------------------------------
  3738     05  BSKPCDL PIC S9(0004) COMP.
  3739     05  BSKPCDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  72
* EL6311.cbl
  3740     05  FILLER REDEFINES BSKPCDF.
  3741         10  BSKPCDA PIC  X(0001).
  3742     05  BSKPCDI PIC  X(0001).
  3743*    -------------------------------
  3744     05  BINDGRPL PIC S9(0004) COMP.
  3745     05  BINDGRPF PIC  X(0001).
  3746     05  FILLER REDEFINES BINDGRPF.
  3747         10  BINDGRPA PIC  X(0001).
  3748     05  BINDGRPI PIC  X(0001).
  3749*    -------------------------------
  3750     05  BSIGL PIC S9(0004) COMP.
  3751     05  BSIGF PIC  X(0001).
  3752     05  FILLER REDEFINES BSIGF.
  3753         10  BSIGA PIC  X(0001).
  3754     05  BSIGI PIC  X(0001).
  3755*    -------------------------------
  3756     05  BRTCLSL PIC S9(0004) COMP.
  3757     05  BRTCLSF PIC  X(0001).
  3758     05  FILLER REDEFINES BRTCLSF.
  3759         10  BRTCLSA PIC  X(0001).
  3760     05  BRTCLSI PIC  X(0002).
  3761*    -------------------------------
  3762     05  BCHGCNTL PIC S9(0004) COMP.
  3763     05  BCHGCNTF PIC  X(0001).
  3764     05  FILLER REDEFINES BCHGCNTF.
  3765         10  BCHGCNTA PIC  X(0001).
  3766     05  BCHGCNTI PIC  X(0003).
  3767*    -------------------------------
  3768     05  BMEMBERL PIC S9(0004) COMP.
  3769     05  BMEMBERF PIC  X(0001).
  3770     05  FILLER REDEFINES BMEMBERF.
  3771         10  BMEMBERA PIC  X(0001).
  3772     05  BMEMBERI PIC  X(0012).
  3773*    -------------------------------
  3774     05  BORGNOL PIC S9(0004) COMP.
  3775     05  BORGNOF PIC  X(0001).
  3776     05  FILLER REDEFINES BORGNOF.
  3777         10  BORGNOA PIC  X(0001).
  3778     05  BORGNOI PIC  X(0006).
  3779*    -------------------------------
  3780     05  BORGSEQL PIC S9(0004) COMP.
  3781     05  BORGSEQF PIC  X(0001).
  3782     05  FILLER REDEFINES BORGSEQF.
  3783         10  BORGSEQA PIC  X(0001).
  3784     05  BORGSEQI PIC  X(0004).
  3785*    -------------------------------
  3786     05  BBILLEDL PIC S9(0004) COMP.
  3787     05  BBILLEDF PIC  X(0001).
  3788     05  FILLER REDEFINES BBILLEDF.
  3789         10  BBILLEDA PIC  X(0001).
  3790     05  BBILLEDI PIC  9(9).
  3791*    -------------------------------
  3792     05  BKIND1L PIC S9(0004) COMP.
  3793     05  BKIND1F PIC  X(0001).
  3794     05  FILLER REDEFINES BKIND1F.
  3795         10  BKIND1A PIC  X(0001).
  3796     05  BKIND1I PIC  X(0002).
  3797*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  73
* EL6311.cbl
  3798     05  BTYPE1L PIC S9(0004) COMP.
  3799     05  BTYPE1F PIC  X(0001).
  3800     05  FILLER REDEFINES BTYPE1F.
  3801         10  BTYPE1A PIC  X(0001).
  3802     05  BTYPE1I PIC  X(0003).
  3803*    -------------------------------
  3804     05  BTERM1L PIC S9(0004) COMP.
  3805     05  BTERM1F PIC  X(0001).
  3806     05  FILLER REDEFINES BTERM1F.
  3807         10  BTERM1A PIC  X(0001).
  3808     05  BTERM1I PIC  X(0003).
  3809*    -------------------------------
  3810     05  BBEN1L PIC S9(0004) COMP.
  3811     05  BBEN1F PIC  X(0001).
  3812     05  FILLER REDEFINES BBEN1F.
  3813         10  BBEN1A PIC  X(0001).
  3814     05  BBEN1I PIC  X(0012).
  3815*    -------------------------------
  3816     05  BPREM1L PIC S9(0004) COMP.
  3817     05  BPREM1F PIC  X(0001).
  3818     05  FILLER REDEFINES BPREM1F.
  3819         10  BPREM1A PIC  X(0001).
  3820     05  BPREM1I PIC  X(0011).
  3821*    -------------------------------
  3822     05  BEXPIR1L PIC S9(0004) COMP.
  3823     05  BEXPIR1F PIC  X(0001).
  3824     05  FILLER REDEFINES BEXPIR1F.
  3825         10  BEXPIR1A PIC  X(0001).
  3826     05  BEXPIR1I PIC  X(0008).
  3827*    -------------------------------
  3828     05  BCP1L PIC S9(0004) COMP.
  3829     05  BCP1F PIC  X(0001).
  3830     05  FILLER REDEFINES BCP1F.
  3831         10  BCP1A PIC  X(0001).
  3832     05  BCP1I PIC  X(0002).
  3833*    -------------------------------
  3834     05  BALTBN1L PIC S9(0004) COMP.
  3835     05  BALTBN1F PIC  X(0001).
  3836     05  FILLER REDEFINES BALTBN1F.
  3837         10  BALTBN1A PIC  X(0001).
  3838     05  BALTBN1I PIC  X(0012).
  3839*    -------------------------------
  3840     05  BALTPR1L PIC S9(0004) COMP.
  3841     05  BALTPR1F PIC  X(0001).
  3842     05  FILLER REDEFINES BALTPR1F.
  3843         10  BALTPR1A PIC  X(0001).
  3844     05  BALTPR1I PIC  X(0011).
  3845*    -------------------------------
  3846     05  BBNCD1L PIC S9(0004) COMP.
  3847     05  BBNCD1F PIC  X(0001).
  3848     05  FILLER REDEFINES BBNCD1F.
  3849         10  BBNCD1A PIC  X(0001).
  3850     05  BBNCD1I PIC  X(0003).
  3851*    -------------------------------
  3852     05  BCPRM1L PIC S9(0004) COMP.
  3853     05  BCPRM1F PIC  X(0001).
  3854     05  FILLER REDEFINES BCPRM1F.
  3855         10  BCPRM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  74
* EL6311.cbl
  3856     05  BCPRM1I PIC  X(0011).
  3857*    -------------------------------
  3858     05  BCAPRM1L PIC S9(0004) COMP.
  3859     05  BCAPRM1F PIC  X(0001).
  3860     05  FILLER REDEFINES BCAPRM1F.
  3861         10  BCAPRM1A PIC  X(0001).
  3862     05  BCAPRM1I PIC  X(0011).
  3863*    -------------------------------
  3864     05  BENABR1L PIC S9(0004) COMP.
  3865     05  BENABR1F PIC  X(0001).
  3866     05  FILLER REDEFINES BENABR1F.
  3867         10  BENABR1A PIC  X(0001).
  3868     05  BENABR1I PIC  X(0005).
  3869*    -------------------------------
  3870     05  BDIFF1L PIC S9(0004) COMP.
  3871     05  BDIFF1F PIC  X(0001).
  3872     05  FILLER REDEFINES BDIFF1F.
  3873         10  BDIFF1A PIC  X(0001).
  3874     05  BDIFF1I PIC  X(0011).
  3875*    -------------------------------
  3876     05  BBILIT1L PIC S9(0004) COMP.
  3877     05  BBILIT1F PIC  X(0001).
  3878     05  FILLER REDEFINES BBILIT1F.
  3879         10  BBILIT1A PIC  X(0001).
  3880     05  BBILIT1I PIC  X(0008).
  3881*    -------------------------------
  3882     05  BADIFF1L PIC S9(0004) COMP.
  3883     05  BADIFF1F PIC  X(0001).
  3884     05  FILLER REDEFINES BADIFF1F.
  3885         10  BADIFF1A PIC  X(0001).
  3886     05  BADIFF1I PIC  X(0011).
  3887*    -------------------------------
  3888     05  BKIND2L PIC S9(0004) COMP.
  3889     05  BKIND2F PIC  X(0001).
  3890     05  FILLER REDEFINES BKIND2F.
  3891         10  BKIND2A PIC  X(0001).
  3892     05  BKIND2I PIC  X(0002).
  3893*    -------------------------------
  3894     05  BTYPE2L PIC S9(0004) COMP.
  3895     05  BTYPE2F PIC  X(0001).
  3896     05  FILLER REDEFINES BTYPE2F.
  3897         10  BTYPE2A PIC  X(0001).
  3898     05  BTYPE2I PIC  X(0003).
  3899*    -------------------------------
  3900     05  BTERM2L PIC S9(0004) COMP.
  3901     05  BTERM2F PIC  X(0001).
  3902     05  FILLER REDEFINES BTERM2F.
  3903         10  BTERM2A PIC  X(0001).
  3904     05  BTERM2I PIC  X(0003).
  3905*    -------------------------------
  3906     05  BBEN2L PIC S9(0004) COMP.
  3907     05  BBEN2F PIC  X(0001).
  3908     05  FILLER REDEFINES BBEN2F.
  3909         10  BBEN2A PIC  X(0001).
  3910     05  BBEN2I PIC  X(0012).
  3911*    -------------------------------
  3912     05  BPREM2L PIC S9(0004) COMP.
  3913     05  BPREM2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  75
* EL6311.cbl
  3914     05  FILLER REDEFINES BPREM2F.
  3915         10  BPREM2A PIC  X(0001).
  3916     05  BPREM2I PIC  X(0011).
  3917*    -------------------------------
  3918     05  BEXPIR2L PIC S9(0004) COMP.
  3919     05  BEXPIR2F PIC  X(0001).
  3920     05  FILLER REDEFINES BEXPIR2F.
  3921         10  BEXPIR2A PIC  X(0001).
  3922     05  BEXPIR2I PIC  X(0008).
  3923*    -------------------------------
  3924     05  BCP2L PIC S9(0004) COMP.
  3925     05  BCP2F PIC  X(0001).
  3926     05  FILLER REDEFINES BCP2F.
  3927         10  BCP2A PIC  X(0001).
  3928     05  BCP2I PIC  X(0002).
  3929*    -------------------------------
  3930     05  BALTBN2L PIC S9(0004) COMP.
  3931     05  BALTBN2F PIC  X(0001).
  3932     05  FILLER REDEFINES BALTBN2F.
  3933         10  BALTBN2A PIC  X(0001).
  3934     05  BALTBN2I PIC  X(0012).
  3935*    -------------------------------
  3936     05  BALTPR2L PIC S9(0004) COMP.
  3937     05  BALTPR2F PIC  X(0001).
  3938     05  FILLER REDEFINES BALTPR2F.
  3939         10  BALTPR2A PIC  X(0001).
  3940     05  BALTPR2I PIC  X(0011).
  3941*    -------------------------------
  3942     05  BBNCD2L PIC S9(0004) COMP.
  3943     05  BBNCD2F PIC  X(0001).
  3944     05  FILLER REDEFINES BBNCD2F.
  3945         10  BBNCD2A PIC  X(0001).
  3946     05  BBNCD2I PIC  X(0003).
  3947*    -------------------------------
  3948     05  BCPRM2L PIC S9(0004) COMP.
  3949     05  BCPRM2F PIC  X(0001).
  3950     05  FILLER REDEFINES BCPRM2F.
  3951         10  BCPRM2A PIC  X(0001).
  3952     05  BCPRM2I PIC  X(0011).
  3953*    -------------------------------
  3954     05  BCAPRM2L PIC S9(0004) COMP.
  3955     05  BCAPRM2F PIC  X(0001).
  3956     05  FILLER REDEFINES BCAPRM2F.
  3957         10  BCAPRM2A PIC  X(0001).
  3958     05  BCAPRM2I PIC  X(0011).
  3959*    -------------------------------
  3960     05  BENABR2L PIC S9(0004) COMP.
  3961     05  BENABR2F PIC  X(0001).
  3962     05  FILLER REDEFINES BENABR2F.
  3963         10  BENABR2A PIC  X(0001).
  3964     05  BENABR2I PIC  X(0005).
  3965*    -------------------------------
  3966     05  BDIFF2L PIC S9(0004) COMP.
  3967     05  BDIFF2F PIC  X(0001).
  3968     05  FILLER REDEFINES BDIFF2F.
  3969         10  BDIFF2A PIC  X(0001).
  3970     05  BDIFF2I PIC  X(0011).
  3971*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  76
* EL6311.cbl
  3972     05  BBILIT2L PIC S9(0004) COMP.
  3973     05  BBILIT2F PIC  X(0001).
  3974     05  FILLER REDEFINES BBILIT2F.
  3975         10  BBILIT2A PIC  X(0001).
  3976     05  BBILIT2I PIC  X(0008).
  3977*    -------------------------------
  3978     05  BADIFF2L PIC S9(0004) COMP.
  3979     05  BADIFF2F PIC  X(0001).
  3980     05  FILLER REDEFINES BADIFF2F.
  3981         10  BADIFF2A PIC  X(0001).
  3982     05  BADIFF2I PIC  X(0011).
  3983*    -------------------------------
  3984     05  BERMSG1L PIC S9(0004) COMP.
  3985     05  BERMSG1F PIC  X(0001).
  3986     05  FILLER REDEFINES BERMSG1F.
  3987         10  BERMSG1A PIC  X(0001).
  3988     05  BERMSG1I PIC  X(0078).
  3989*    -------------------------------
  3990     05  BERMSG2L PIC S9(0004) COMP.
  3991     05  BERMSG2F PIC  X(0001).
  3992     05  FILLER REDEFINES BERMSG2F.
  3993         10  BERMSG2A PIC  X(0001).
  3994     05  BERMSG2I PIC  X(0078).
  3995*    -------------------------------
  3996     05  BERMSG3L PIC S9(0004) COMP.
  3997     05  BERMSG3F PIC  X(0001).
  3998     05  FILLER REDEFINES BERMSG3F.
  3999         10  BERMSG3A PIC  X(0001).
  4000     05  BERMSG3I PIC  X(0078).
  4001*    -------------------------------
  4002     05  BPFENTRL PIC S9(0004) COMP.
  4003     05  BPFENTRF PIC  X(0001).
  4004     05  FILLER REDEFINES BPFENTRF.
  4005         10  BPFENTRA PIC  X(0001).
  4006     05  BPFENTRI PIC  9(2).
  4007*    -------------------------------
  4008     05  BPF5HDRL PIC S9(0004) COMP.
  4009     05  BPF5HDRF PIC  X(0001).
  4010     05  FILLER REDEFINES BPF5HDRF.
  4011         10  BPF5HDRA PIC  X(0001).
  4012     05  BPF5HDRI PIC  X(0005).
  4013*    -------------------------------
  4014     05  BPF4HDRL PIC S9(0004) COMP.
  4015     05  BPF4HDRF PIC  X(0001).
  4016     05  FILLER REDEFINES BPF4HDRF.
  4017         10  BPF4HDRA PIC  X(0001).
  4018     05  BPF4HDRI PIC  X(0013).
  4019*    -------------------------------
  4020     05  BF15HDRL PIC S9(0004) COMP.
  4021     05  BF15HDRF PIC  X(0001).
  4022     05  FILLER REDEFINES BF15HDRF.
  4023         10  BF15HDRA PIC  X(0001).
  4024     05  BF15HDRI PIC  X(0010).
  4025 01  EL631BO REDEFINES EL631BI.
  4026     05  FILLER            PIC  X(0012).
  4027*    -------------------------------
  4028     05  FILLER            PIC  X(0003).
  4029     05  BDATEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  77
* EL6311.cbl
  4030*    -------------------------------
  4031     05  FILLER            PIC  X(0003).
  4032     05  BTIMEO PIC  99.99.
  4033*    -------------------------------
  4034     05  FILLER            PIC  X(0003).
  4035     05  BHEADO PIC  X(0038).
  4036*    -------------------------------
  4037     05  FILLER            PIC  X(0003).
  4038     05  BNCERTLO PIC  X(0008).
  4039*    -------------------------------
  4040     05  FILLER            PIC  X(0003).
  4041     05  BNCERTO PIC  X(0011).
  4042*    -------------------------------
  4043     05  FILLER            PIC  X(0003).
  4044     05  BNSTATLO PIC  X(0009).
  4045*    -------------------------------
  4046     05  FILLER            PIC  X(0003).
  4047     05  BNSTATO PIC  X(0002).
  4048*    -------------------------------
  4049     05  FILLER            PIC  X(0003).
  4050     05  BCHGTO PIC  X(0004).
  4051*    -------------------------------
  4052     05  FILLER            PIC  X(0003).
  4053     05  BCHGO PIC  ZZZ9.
  4054*    -------------------------------
  4055     05  FILLER            PIC  X(0003).
  4056     05  BCOMPIDO PIC  X(0003).
  4057*    -------------------------------
  4058     05  FILLER            PIC  X(0003).
  4059     05  BREGIONO PIC  X(0006).
  4060*    -------------------------------
  4061     05  FILLER            PIC  X(0003).
  4062     05  BUSERO PIC  X(0004).
  4063*    -------------------------------
  4064     05  FILLER            PIC  X(0003).
  4065     05  BMAINTO PIC  X(0001).
  4066*    -------------------------------
  4067     05  FILLER            PIC  X(0003).
  4068     05  BMANTBYO PIC  X(0004).
  4069*    -------------------------------
  4070     05  FILLER            PIC  X(0003).
  4071     05  BCHGHDGO PIC  X(0003).
  4072*    -------------------------------
  4073     05  FILLER            PIC  X(0003).
  4074     05  BMANTDTO PIC  X(0008).
  4075*    -------------------------------
  4076     05  FILLER            PIC  X(0003).
  4077     05  BMANTATO PIC  99.99.
  4078*    -------------------------------
  4079     05  FILLER            PIC  X(0003).
  4080     05  BCSRO PIC  X(0004).
  4081*    -------------------------------
  4082     05  FILLER            PIC  X(0003).
  4083     05  BBATCHO PIC  X(0006).
  4084*    -------------------------------
  4085     05  FILLER            PIC  X(0003).
  4086     05  BSEQO PIC  X(0004).
  4087*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  78
* EL6311.cbl
  4088     05  FILLER            PIC  X(0003).
  4089     05  BMOENDTO PIC  X(0008).
  4090*    -------------------------------
  4091     05  FILLER            PIC  X(0003).
  4092     05  BCARRO PIC  X(0001).
  4093*    -------------------------------
  4094     05  FILLER            PIC  X(0003).
  4095     05  BGROUPO PIC  X(0006).
  4096*    -------------------------------
  4097     05  FILLER            PIC  X(0003).
  4098     05  BSTATEO PIC  X(0002).
  4099*    -------------------------------
  4100     05  FILLER            PIC  X(0003).
  4101     05  BACCTO PIC  X(0010).
  4102*    -------------------------------
  4103     05  FILLER            PIC  X(0003).
  4104     05  BVINHO PIC  X(0004).
  4105*    -------------------------------
  4106     05  FILLER            PIC  X(0003).
  4107     05  BVINO PIC  X(0017).
  4108*    -------------------------------
  4109     05  FILLER            PIC  X(0003).
  4110     05  BREFHDGO PIC  X(0004).
  4111*    -------------------------------
  4112     05  FILLER            PIC  X(0003).
  4113     05  BREFO PIC  X(0012).
  4114*    -------------------------------
  4115     05  FILLER            PIC  X(0003).
  4116     05  BAGEDEFO PIC  X(0004).
  4117*    -------------------------------
  4118     05  FILLER            PIC  X(0003).
  4119     05  BCERTNOO PIC  X(0010).
  4120*    -------------------------------
  4121     05  FILLER            PIC  X(0003).
  4122     05  BSUFIXO PIC  X(0001).
  4123*    -------------------------------
  4124     05  FILLER            PIC  X(0003).
  4125     05  BEFFDTO PIC  X(0008).
  4126*    -------------------------------
  4127     05  FILLER            PIC  X(0003).
  4128     05  BLSTNMO PIC  X(0015).
  4129*    -------------------------------
  4130     05  FILLER            PIC  X(0003).
  4131     05  B1STNMO PIC  X(0010).
  4132*    -------------------------------
  4133     05  FILLER            PIC  X(0003).
  4134     05  BINITO PIC  X(0001).
  4135*    -------------------------------
  4136     05  FILLER            PIC  X(0003).
  4137     05  BSEXO PIC  X(0001).
  4138*    -------------------------------
  4139     05  FILLER            PIC  X(0003).
  4140     05  BAGEO PIC  X(0002).
  4141*    -------------------------------
  4142     05  FILLER            PIC  X(0003).
  4143     05  BBIRTHO PIC  X(0008).
  4144*    -------------------------------
  4145     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  79
* EL6311.cbl
  4146     05  B1STPMTO PIC  X(0008).
  4147*    -------------------------------
  4148     05  FILLER            PIC  X(0003).
  4149     05  BDAYSO PIC  X(0003).
  4150*    -------------------------------
  4151     05  FILLER            PIC  X(0003).
  4152     05  BLNTRMO PIC  X(0003).
  4153*    -------------------------------
  4154     05  FILLER            PIC  X(0003).
  4155     05  BLNOFCRO PIC  X(0005).
  4156*    -------------------------------
  4157     05  FILLER            PIC  X(0003).
  4158     05  BMODEO PIC  X(0001).
  4159*    -------------------------------
  4160     05  FILLER            PIC  X(0003).
  4161     05  BFREQO PIC  X(0002).
  4162*    -------------------------------
  4163     05  FILLER            PIC  X(0003).
  4164     05  BPMTSO PIC  X(0003).
  4165*    -------------------------------
  4166     05  FILLER            PIC  X(0003).
  4167     05  BPMTAMTO PIC  ZZZZZ9.99.
  4168*    -------------------------------
  4169     05  FILLER            PIC  X(0003).
  4170     05  BAPRO PIC  99.9999.
  4171*    -------------------------------
  4172     05  FILLER            PIC  X(0003).
  4173     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4174*    -------------------------------
  4175     05  FILLER            PIC  X(0003).
  4176     05  BMEMCAPO PIC  X(0011).
  4177*    -------------------------------
  4178     05  FILLER            PIC  X(0003).
  4179     05  BORIGHDO PIC  X(0009).
  4180*    -------------------------------
  4181     05  FILLER            PIC  X(0003).
  4182     05  DMDBILO PIC  X(0006).
  4183*    -------------------------------
  4184     05  FILLER            PIC  X(0003).
  4185     05  BFORCEO PIC  X(0001).
  4186*    -------------------------------
  4187     05  FILLER            PIC  X(0003).
  4188     05  BENTRYO PIC  X(0001).
  4189*    -------------------------------
  4190     05  FILLER            PIC  X(0003).
  4191     05  BREINO PIC  X(0001).
  4192*    -------------------------------
  4193     05  FILLER            PIC  X(0003).
  4194     05  BBILCDO PIC  X(0001).
  4195*    -------------------------------
  4196     05  FILLER            PIC  X(0003).
  4197     05  BUNWRITO PIC  X(0001).
  4198*    -------------------------------
  4199     05  FILLER            PIC  X(0003).
  4200     05  BSKPCDO PIC  X(0001).
  4201*    -------------------------------
  4202     05  FILLER            PIC  X(0003).
  4203     05  BINDGRPO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  80
* EL6311.cbl
  4204*    -------------------------------
  4205     05  FILLER            PIC  X(0003).
  4206     05  BSIGO PIC  X(0001).
  4207*    -------------------------------
  4208     05  FILLER            PIC  X(0003).
  4209     05  BRTCLSO PIC  X(0002).
  4210*    -------------------------------
  4211     05  FILLER            PIC  X(0003).
  4212     05  BCHGCNTO PIC  X(0003).
  4213*    -------------------------------
  4214     05  FILLER            PIC  X(0003).
  4215     05  BMEMBERO PIC  X(0012).
  4216*    -------------------------------
  4217     05  FILLER            PIC  X(0003).
  4218     05  BORGNOO PIC  X(0006).
  4219*    -------------------------------
  4220     05  FILLER            PIC  X(0003).
  4221     05  BORGSEQO PIC  X(0004).
  4222*    -------------------------------
  4223     05  FILLER            PIC  X(0003).
  4224     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4225*    -------------------------------
  4226     05  FILLER            PIC  X(0003).
  4227     05  BKIND1O PIC  X(0002).
  4228*    -------------------------------
  4229     05  FILLER            PIC  X(0003).
  4230     05  BTYPE1O PIC  X(0003).
  4231*    -------------------------------
  4232     05  FILLER            PIC  X(0003).
  4233     05  BTERM1O PIC  X(0003).
  4234*    -------------------------------
  4235     05  FILLER            PIC  X(0003).
  4236     05  BBEN1O PIC  X(0012).
  4237*    -------------------------------
  4238     05  FILLER            PIC  X(0003).
  4239     05  BPREM1O PIC  X(0011).
  4240*    -------------------------------
  4241     05  FILLER            PIC  X(0003).
  4242     05  BEXPIR1O PIC  X(0008).
  4243*    -------------------------------
  4244     05  FILLER            PIC  X(0003).
  4245     05  BCP1O PIC  X(0002).
  4246*    -------------------------------
  4247     05  FILLER            PIC  X(0003).
  4248     05  BALTBN1O PIC  X(0012).
  4249*    -------------------------------
  4250     05  FILLER            PIC  X(0003).
  4251     05  BALTPR1O PIC  X(0011).
  4252*    -------------------------------
  4253     05  FILLER            PIC  X(0003).
  4254     05  BBNCD1O PIC  X(0003).
  4255*    -------------------------------
  4256     05  FILLER            PIC  X(0003).
  4257     05  BCPRM1O PIC  X(0011).
  4258*    -------------------------------
  4259     05  FILLER            PIC  X(0003).
  4260     05  BCAPRM1O PIC  X(0011).
  4261*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  81
* EL6311.cbl
  4262     05  FILLER            PIC  X(0003).
  4263     05  BENABR1O PIC  X(0005).
  4264*    -------------------------------
  4265     05  FILLER            PIC  X(0003).
  4266     05  BDIFF1O PIC  X(0011).
  4267*    -------------------------------
  4268     05  FILLER            PIC  X(0003).
  4269     05  BBILIT1O PIC  X(0008).
  4270*    -------------------------------
  4271     05  FILLER            PIC  X(0003).
  4272     05  BADIFF1O PIC  X(0011).
  4273*    -------------------------------
  4274     05  FILLER            PIC  X(0003).
  4275     05  BKIND2O PIC  X(0002).
  4276*    -------------------------------
  4277     05  FILLER            PIC  X(0003).
  4278     05  BTYPE2O PIC  X(0003).
  4279*    -------------------------------
  4280     05  FILLER            PIC  X(0003).
  4281     05  BTERM2O PIC  X(0003).
  4282*    -------------------------------
  4283     05  FILLER            PIC  X(0003).
  4284     05  BBEN2O PIC  X(0012).
  4285*    -------------------------------
  4286     05  FILLER            PIC  X(0003).
  4287     05  BPREM2O PIC  X(0011).
  4288*    -------------------------------
  4289     05  FILLER            PIC  X(0003).
  4290     05  BEXPIR2O PIC  X(0008).
  4291*    -------------------------------
  4292     05  FILLER            PIC  X(0003).
  4293     05  BCP2O PIC  X(0002).
  4294*    -------------------------------
  4295     05  FILLER            PIC  X(0003).
  4296     05  BALTBN2O PIC  X(0012).
  4297*    -------------------------------
  4298     05  FILLER            PIC  X(0003).
  4299     05  BALTPR2O PIC  X(0011).
  4300*    -------------------------------
  4301     05  FILLER            PIC  X(0003).
  4302     05  BBNCD2O PIC  X(0003).
  4303*    -------------------------------
  4304     05  FILLER            PIC  X(0003).
  4305     05  BCPRM2O PIC  X(0011).
  4306*    -------------------------------
  4307     05  FILLER            PIC  X(0003).
  4308     05  BCAPRM2O PIC  X(0011).
  4309*    -------------------------------
  4310     05  FILLER            PIC  X(0003).
  4311     05  BENABR2O PIC  X(0005).
  4312*    -------------------------------
  4313     05  FILLER            PIC  X(0003).
  4314     05  BDIFF2O PIC  X(0011).
  4315*    -------------------------------
  4316     05  FILLER            PIC  X(0003).
  4317     05  BBILIT2O PIC  X(0008).
  4318*    -------------------------------
  4319     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  82
* EL6311.cbl
  4320     05  BADIFF2O PIC  X(0011).
  4321*    -------------------------------
  4322     05  FILLER            PIC  X(0003).
  4323     05  BERMSG1O PIC  X(0078).
  4324*    -------------------------------
  4325     05  FILLER            PIC  X(0003).
  4326     05  BERMSG2O PIC  X(0078).
  4327*    -------------------------------
  4328     05  FILLER            PIC  X(0003).
  4329     05  BERMSG3O PIC  X(0078).
  4330*    -------------------------------
  4331     05  FILLER            PIC  X(0003).
  4332     05  BPFENTRO PIC  X(0002).
  4333*    -------------------------------
  4334     05  FILLER            PIC  X(0003).
  4335     05  BPF5HDRO PIC  X(0005).
  4336*    -------------------------------
  4337     05  FILLER            PIC  X(0003).
  4338     05  BPF4HDRO PIC  X(0013).
  4339*    -------------------------------
  4340     05  FILLER            PIC  X(0003).
  4341     05  BF15HDRO PIC  X(0010).
  4342*    -------------------------------
  4343 01  EL631CI REDEFINES EL631BI.
  4344     05  FILLER            PIC  X(0012).
  4345*    -------------------------------
  4346     05  CDATEL PIC S9(0004) COMP.
  4347     05  CDATEF PIC  X(0001).
  4348     05  FILLER REDEFINES CDATEF.
  4349         10  CDATEA PIC  X(0001).
  4350     05  CDATEI PIC  X(0008).
  4351*    -------------------------------
  4352     05  CTIMEL PIC S9(0004) COMP.
  4353     05  CTIMEF PIC  X(0001).
  4354     05  FILLER REDEFINES CTIMEF.
  4355         10  CTIMEA PIC  X(0001).
  4356     05  CTIMEI PIC  X(0005).
  4357*    -------------------------------
  4358     05  CHEADL PIC S9(0004) COMP.
  4359     05  CHEADF PIC  X(0001).
  4360     05  FILLER REDEFINES CHEADF.
  4361         10  CHEADA PIC  X(0001).
  4362     05  CHEADI PIC  X(0038).
  4363*    -------------------------------
  4364     05  CCHGTL PIC S9(0004) COMP.
  4365     05  CCHGTF PIC  X(0001).
  4366     05  FILLER REDEFINES CCHGTF.
  4367         10  CCHGTA PIC  X(0001).
  4368     05  CCHGTI PIC  X(0004).
  4369*    -------------------------------
  4370     05  CCHGL PIC S9(0004) COMP.
  4371     05  CCHGF PIC  X(0001).
  4372     05  FILLER REDEFINES CCHGF.
  4373         10  CCHGA PIC  X(0001).
  4374     05  CCHGI PIC  X(0004).
  4375*    -------------------------------
  4376     05  CMAINTL PIC S9(0004) COMP.
  4377     05  CMAINTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  83
* EL6311.cbl
  4378     05  FILLER REDEFINES CMAINTF.
  4379         10  CMAINTA PIC  X(0001).
  4380     05  CMAINTI PIC  X(0001).
  4381*    -------------------------------
  4382     05  CMANTBYL PIC S9(0004) COMP.
  4383     05  CMANTBYF PIC  X(0001).
  4384     05  FILLER REDEFINES CMANTBYF.
  4385         10  CMANTBYA PIC  X(0001).
  4386     05  CMANTBYI PIC  X(0004).
  4387*    -------------------------------
  4388     05  CCHGHDGL PIC S9(0004) COMP.
  4389     05  CCHGHDGF PIC  X(0001).
  4390     05  FILLER REDEFINES CCHGHDGF.
  4391         10  CCHGHDGA PIC  X(0001).
  4392     05  CCHGHDGI PIC  X(0003).
  4393*    -------------------------------
  4394     05  CMANTDTL PIC S9(0004) COMP.
  4395     05  CMANTDTF PIC  X(0001).
  4396     05  FILLER REDEFINES CMANTDTF.
  4397         10  CMANTDTA PIC  X(0001).
  4398     05  CMANTDTI PIC  X(0008).
  4399*    -------------------------------
  4400     05  CMANTATL PIC S9(0004) COMP.
  4401     05  CMANTATF PIC  X(0001).
  4402     05  FILLER REDEFINES CMANTATF.
  4403         10  CMANTATA PIC  X(0001).
  4404     05  CMANTATI PIC  X(0005).
  4405*    -------------------------------
  4406     05  CCSRL PIC S9(0004) COMP.
  4407     05  CCSRF PIC  X(0001).
  4408     05  FILLER REDEFINES CCSRF.
  4409         10  CCSRA PIC  X(0001).
  4410     05  CCSRI PIC  X(0004).
  4411*    -------------------------------
  4412     05  CBATCHL PIC S9(0004) COMP.
  4413     05  CBATCHF PIC  X(0001).
  4414     05  FILLER REDEFINES CBATCHF.
  4415         10  CBATCHA PIC  X(0001).
  4416     05  CBATCHI PIC  X(0006).
  4417*    -------------------------------
  4418     05  CSEQL PIC S9(0004) COMP.
  4419     05  CSEQF PIC  X(0001).
  4420     05  FILLER REDEFINES CSEQF.
  4421         10  CSEQA PIC  X(0001).
  4422     05  CSEQI PIC  X(0004).
  4423*    -------------------------------
  4424     05  CMOENDTL PIC S9(0004) COMP.
  4425     05  CMOENDTF PIC  X(0001).
  4426     05  FILLER REDEFINES CMOENDTF.
  4427         10  CMOENDTA PIC  X(0001).
  4428     05  CMOENDTI PIC  X(0008).
  4429*    -------------------------------
  4430     05  CCARRL PIC S9(0004) COMP.
  4431     05  CCARRF PIC  X(0001).
  4432     05  FILLER REDEFINES CCARRF.
  4433         10  CCARRA PIC  X(0001).
  4434     05  CCARRI PIC  X(0001).
  4435*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  84
* EL6311.cbl
  4436     05  CGROUPL PIC S9(0004) COMP.
  4437     05  CGROUPF PIC  X(0001).
  4438     05  FILLER REDEFINES CGROUPF.
  4439         10  CGROUPA PIC  X(0001).
  4440     05  CGROUPI PIC  X(0006).
  4441*    -------------------------------
  4442     05  CSTATEL PIC S9(0004) COMP.
  4443     05  CSTATEF PIC  X(0001).
  4444     05  FILLER REDEFINES CSTATEF.
  4445         10  CSTATEA PIC  X(0001).
  4446     05  CSTATEI PIC  X(0002).
  4447*    -------------------------------
  4448     05  CACCTL PIC S9(0004) COMP.
  4449     05  CACCTF PIC  X(0001).
  4450     05  FILLER REDEFINES CACCTF.
  4451         10  CACCTA PIC  X(0001).
  4452     05  CACCTI PIC  X(0010).
  4453*    -------------------------------
  4454     05  CORIGHDL PIC S9(0004) COMP.
  4455     05  CORIGHDF PIC  X(0001).
  4456     05  FILLER REDEFINES CORIGHDF.
  4457         10  CORIGHDA PIC  X(0001).
  4458     05  CORIGHDI PIC  X(0011).
  4459*    -------------------------------
  4460     05  CORGNOL PIC S9(0004) COMP.
  4461     05  CORGNOF PIC  X(0001).
  4462     05  FILLER REDEFINES CORGNOF.
  4463         10  CORGNOA PIC  X(0001).
  4464     05  CORGNOI PIC  X(0006).
  4465*    -------------------------------
  4466     05  CORGSEQL PIC S9(0004) COMP.
  4467     05  CORGSEQF PIC  X(0001).
  4468     05  FILLER REDEFINES CORGSEQF.
  4469         10  CORGSEQA PIC  X(0001).
  4470     05  CORGSEQI PIC  X(0004).
  4471*    -------------------------------
  4472     05  CREFHDGL PIC S9(0004) COMP.
  4473     05  CREFHDGF PIC  X(0001).
  4474     05  FILLER REDEFINES CREFHDGF.
  4475         10  CREFHDGA PIC  X(0001).
  4476     05  CREFHDGI PIC  X(0010).
  4477*    -------------------------------
  4478     05  CREFL PIC S9(0004) COMP.
  4479     05  CREFF PIC  X(0001).
  4480     05  FILLER REDEFINES CREFF.
  4481         10  CREFA PIC  X(0001).
  4482     05  CREFI PIC  X(0012).
  4483*    -------------------------------
  4484     05  CNHINTL PIC S9(0004) COMP.
  4485     05  CNHINTF PIC  X(0001).
  4486     05  FILLER REDEFINES CNHINTF.
  4487         10  CNHINTA PIC  X(0001).
  4488     05  CNHINTI PIC  9(7)V99.
  4489*    -------------------------------
  4490     05  CCERTNOL PIC S9(0004) COMP.
  4491     05  CCERTNOF PIC  X(0001).
  4492     05  FILLER REDEFINES CCERTNOF.
  4493         10  CCERTNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  85
* EL6311.cbl
  4494     05  CCERTNOI PIC  X(0010).
  4495*    -------------------------------
  4496     05  CSUFIXL PIC S9(0004) COMP.
  4497     05  CSUFIXF PIC  X(0001).
  4498     05  FILLER REDEFINES CSUFIXF.
  4499         10  CSUFIXA PIC  X(0001).
  4500     05  CSUFIXI PIC  X(0001).
  4501*    -------------------------------
  4502     05  CEFFDTL PIC S9(0004) COMP.
  4503     05  CEFFDTF PIC  X(0001).
  4504     05  FILLER REDEFINES CEFFDTF.
  4505         10  CEFFDTA PIC  X(0001).
  4506     05  CEFFDTI PIC  X(0008).
  4507*    -------------------------------
  4508     05  CLSTNML PIC S9(0004) COMP.
  4509     05  CLSTNMF PIC  X(0001).
  4510     05  FILLER REDEFINES CLSTNMF.
  4511         10  CLSTNMA PIC  X(0001).
  4512     05  CLSTNMI PIC  X(0015).
  4513*    -------------------------------
  4514     05  CPCYNL PIC S9(0004) COMP.
  4515     05  CPCYNF PIC  X(0001).
  4516     05  FILLER REDEFINES CPCYNF.
  4517         10  CPCYNA PIC  X(0001).
  4518     05  CPCYNI PIC  X(0001).
  4519*    -------------------------------
  4520     05  CINAMEL PIC S9(0004) COMP.
  4521     05  CINAMEF PIC  X(0001).
  4522     05  FILLER REDEFINES CINAMEF.
  4523         10  CINAMEA PIC  X(0001).
  4524     05  CINAMEI PIC  X(0015).
  4525*    -------------------------------
  4526     05  CINITSL PIC S9(0004) COMP.
  4527     05  CINITSF PIC  X(0001).
  4528     05  FILLER REDEFINES CINITSF.
  4529         10  CINITSA PIC  X(0001).
  4530     05  CINITSI PIC  X(0010).
  4531*    -------------------------------
  4532     05  CCANREAL PIC S9(0004) COMP.
  4533     05  CCANREAF PIC  X(0001).
  4534     05  FILLER REDEFINES CCANREAF.
  4535         10  CCANREAA PIC  X(0001).
  4536     05  CCANREAI PIC  X(0001).
  4537*    -------------------------------
  4538     05  CKIND1L PIC S9(0004) COMP.
  4539     05  CKIND1F PIC  X(0001).
  4540     05  FILLER REDEFINES CKIND1F.
  4541         10  CKIND1A PIC  X(0001).
  4542     05  CKIND1I PIC  X(0002).
  4543*    -------------------------------
  4544     05  CCANDT1L PIC S9(0004) COMP.
  4545     05  CCANDT1F PIC  X(0001).
  4546     05  FILLER REDEFINES CCANDT1F.
  4547         10  CCANDT1A PIC  X(0001).
  4548     05  CCANDT1I PIC  X(0008).
  4549*    -------------------------------
  4550     05  CREFND1L PIC S9(0004) COMP.
  4551     05  CREFND1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  86
* EL6311.cbl
  4552     05  FILLER REDEFINES CREFND1F.
  4553         10  CREFND1A PIC  X(0001).
  4554     05  CREFND1I PIC  S9(9)V99.
  4555*    -------------------------------
  4556     05  CMTHD1L PIC S9(0004) COMP.
  4557     05  CMTHD1F PIC  X(0001).
  4558     05  FILLER REDEFINES CMTHD1F.
  4559         10  CMTHD1A PIC  X(0001).
  4560     05  CMTHD1I PIC  X(0001).
  4561*    -------------------------------
  4562     05  CKIND2L PIC S9(0004) COMP.
  4563     05  CKIND2F PIC  X(0001).
  4564     05  FILLER REDEFINES CKIND2F.
  4565         10  CKIND2A PIC  X(0001).
  4566     05  CKIND2I PIC  X(0002).
  4567*    -------------------------------
  4568     05  CCANDT2L PIC S9(0004) COMP.
  4569     05  CCANDT2F PIC  X(0001).
  4570     05  FILLER REDEFINES CCANDT2F.
  4571         10  CCANDT2A PIC  X(0001).
  4572     05  CCANDT2I PIC  X(0008).
  4573*    -------------------------------
  4574     05  CREFND2L PIC S9(0004) COMP.
  4575     05  CREFND2F PIC  X(0001).
  4576     05  FILLER REDEFINES CREFND2F.
  4577         10  CREFND2A PIC  X(0001).
  4578     05  CREFND2I PIC  S9(9)V99.
  4579*    -------------------------------
  4580     05  CMTHD2L PIC S9(0004) COMP.
  4581     05  CMTHD2F PIC  X(0001).
  4582     05  FILLER REDEFINES CMTHD2F.
  4583         10  CMTHD2A PIC  X(0001).
  4584     05  CMTHD2I PIC  X(0001).
  4585*    -------------------------------
  4586     05  CLIVESL PIC S9(0004) COMP.
  4587     05  CLIVESF PIC  X(0001).
  4588     05  FILLER REDEFINES CLIVESF.
  4589         10  CLIVESA PIC  X(0001).
  4590     05  CLIVESI PIC  X(0003).
  4591*    -------------------------------
  4592     05  CFORCEL PIC S9(0004) COMP.
  4593     05  CFORCEF PIC  X(0001).
  4594     05  FILLER REDEFINES CFORCEF.
  4595         10  CFORCEA PIC  X(0001).
  4596     05  CFORCEI PIC  X(0001).
  4597*    -------------------------------
  4598     05  CBILCDL PIC S9(0004) COMP.
  4599     05  CBILCDF PIC  X(0001).
  4600     05  FILLER REDEFINES CBILCDF.
  4601         10  CBILCDA PIC  X(0001).
  4602     05  CBILCDI PIC  X(0001).
  4603*    -------------------------------
  4604     05  CCRFND1L PIC S9(0004) COMP.
  4605     05  CCRFND1F PIC  X(0001).
  4606     05  FILLER REDEFINES CCRFND1F.
  4607         10  CCRFND1A PIC  X(0001).
  4608     05  CCRFND1I PIC  X(0011).
  4609*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  87
* EL6311.cbl
  4610     05  CCRFND2L PIC S9(0004) COMP.
  4611     05  CCRFND2F PIC  X(0001).
  4612     05  FILLER REDEFINES CCRFND2F.
  4613         10  CCRFND2A PIC  X(0001).
  4614     05  CCRFND2I PIC  X(0011).
  4615*    -------------------------------
  4616     05  CBILIT1L PIC S9(0004) COMP.
  4617     05  CBILIT1F PIC  X(0001).
  4618     05  FILLER REDEFINES CBILIT1F.
  4619         10  CBILIT1A PIC  X(0001).
  4620     05  CBILIT1I PIC  X(0008).
  4621*    -------------------------------
  4622     05  CDRFND1L PIC S9(0004) COMP.
  4623     05  CDRFND1F PIC  X(0001).
  4624     05  FILLER REDEFINES CDRFND1F.
  4625         10  CDRFND1A PIC  X(0001).
  4626     05  CDRFND1I PIC  X(0011).
  4627*    -------------------------------
  4628     05  CBILIT2L PIC S9(0004) COMP.
  4629     05  CBILIT2F PIC  X(0001).
  4630     05  FILLER REDEFINES CBILIT2F.
  4631         10  CBILIT2A PIC  X(0001).
  4632     05  CBILIT2I PIC  X(0008).
  4633*    -------------------------------
  4634     05  CDRFND2L PIC S9(0004) COMP.
  4635     05  CDRFND2F PIC  X(0001).
  4636     05  FILLER REDEFINES CDRFND2F.
  4637         10  CDRFND2A PIC  X(0001).
  4638     05  CDRFND2I PIC  X(0011).
  4639*    -------------------------------
  4640     05  CCANTXTL PIC S9(0004) COMP.
  4641     05  CCANTXTF PIC  X(0001).
  4642     05  FILLER REDEFINES CCANTXTF.
  4643         10  CCANTXTA PIC  X(0001).
  4644     05  CCANTXTI PIC  X(0005).
  4645*    -------------------------------
  4646     05  CCANFEEL PIC S9(0004) COMP.
  4647     05  CCANFEEF PIC  X(0001).
  4648     05  FILLER REDEFINES CCANFEEF.
  4649         10  CCANFEEA PIC  X(0001).
  4650     05  CCANFEEI PIC  X(0002).
  4651*    -------------------------------
  4652     05  CTERM1L PIC S9(0004) COMP.
  4653     05  CTERM1F PIC  X(0001).
  4654     05  FILLER REDEFINES CTERM1F.
  4655         10  CTERM1A PIC  X(0001).
  4656     05  CTERM1I PIC  X(0003).
  4657*    -------------------------------
  4658     05  CRTERM1L PIC S9(0004) COMP.
  4659     05  CRTERM1F PIC  X(0001).
  4660     05  FILLER REDEFINES CRTERM1F.
  4661         10  CRTERM1A PIC  X(0001).
  4662     05  CRTERM1I PIC  X(0003).
  4663*    -------------------------------
  4664     05  CPREM1L PIC S9(0004) COMP.
  4665     05  CPREM1F PIC  X(0001).
  4666     05  FILLER REDEFINES CPREM1F.
  4667         10  CPREM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  88
* EL6311.cbl
  4668     05  CPREM1I PIC  X(0011).
  4669*    -------------------------------
  4670     05  CTERM2L PIC S9(0004) COMP.
  4671     05  CTERM2F PIC  X(0001).
  4672     05  FILLER REDEFINES CTERM2F.
  4673         10  CTERM2A PIC  X(0001).
  4674     05  CTERM2I PIC  X(0003).
  4675*    -------------------------------
  4676     05  CRTERM2L PIC S9(0004) COMP.
  4677     05  CRTERM2F PIC  X(0001).
  4678     05  FILLER REDEFINES CRTERM2F.
  4679         10  CRTERM2A PIC  X(0001).
  4680     05  CRTERM2I PIC  X(0003).
  4681*    -------------------------------
  4682     05  CPREM2L PIC S9(0004) COMP.
  4683     05  CPREM2F PIC  X(0001).
  4684     05  FILLER REDEFINES CPREM2F.
  4685         10  CPREM2A PIC  X(0001).
  4686     05  CPREM2I PIC  X(0011).
  4687*    -------------------------------
  4688     05  CENTRDTL PIC S9(0004) COMP.
  4689     05  CENTRDTF PIC  X(0001).
  4690     05  FILLER REDEFINES CENTRDTF.
  4691         10  CENTRDTA PIC  X(0001).
  4692     05  CENTRDTI PIC  X(0008).
  4693*    -------------------------------
  4694     05  CPAYEEL PIC S9(0004) COMP.
  4695     05  CPAYEEF PIC  X(0001).
  4696     05  FILLER REDEFINES CPAYEEF.
  4697         10  CPAYEEA PIC  X(0001).
  4698     05  CPAYEEI PIC  X(0006).
  4699*    -------------------------------
  4700     05  CRFNDSWL PIC S9(0004) COMP.
  4701     05  CRFNDSWF PIC  X(0001).
  4702     05  FILLER REDEFINES CRFNDSWF.
  4703         10  CRFNDSWA PIC  X(0001).
  4704     05  CRFNDSWI PIC  X(0003).
  4705*    -------------------------------
  4706     05  CLFHDGL PIC S9(0004) COMP.
  4707     05  CLFHDGF PIC  X(0001).
  4708     05  FILLER REDEFINES CLFHDGF.
  4709         10  CLFHDGA PIC  X(0001).
  4710     05  CLFHDGI PIC  X(0006).
  4711*    -------------------------------
  4712     05  CAHHDGL PIC S9(0004) COMP.
  4713     05  CAHHDGF PIC  X(0001).
  4714     05  FILLER REDEFINES CAHHDGF.
  4715         10  CAHHDGA PIC  X(0001).
  4716     05  CAHHDGI PIC  X(0006).
  4717*    -------------------------------
  4718     05  CENTDTL PIC S9(0004) COMP.
  4719     05  CENTDTF PIC  X(0001).
  4720     05  FILLER REDEFINES CENTDTF.
  4721         10  CENTDTA PIC  X(0001).
  4722     05  CENTDTI PIC  X(0008).
  4723*    -------------------------------
  4724     05  CENTBYL PIC S9(0004) COMP.
  4725     05  CENTBYF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  89
* EL6311.cbl
  4726     05  FILLER REDEFINES CENTBYF.
  4727         10  CENTBYA PIC  X(0001).
  4728     05  CENTBYI PIC  X(0004).
  4729*    -------------------------------
  4730     05  CCHGCNTL PIC S9(0004) COMP.
  4731     05  CCHGCNTF PIC  X(0001).
  4732     05  FILLER REDEFINES CCHGCNTF.
  4733         10  CCHGCNTA PIC  X(0001).
  4734     05  CCHGCNTI PIC  X(0003).
  4735*    -------------------------------
  4736     05  CLFREFNL PIC S9(0004) COMP.
  4737     05  CLFREFNF PIC  X(0001).
  4738     05  FILLER REDEFINES CLFREFNF.
  4739         10  CLFREFNA PIC  X(0001).
  4740     05  CLFREFNI PIC  X(0006).
  4741*    -------------------------------
  4742     05  CAHREFNL PIC S9(0004) COMP.
  4743     05  CAHREFNF PIC  X(0001).
  4744     05  FILLER REDEFINES CAHREFNF.
  4745         10  CAHREFNA PIC  X(0001).
  4746     05  CAHREFNI PIC  X(0006).
  4747*    -------------------------------
  4748     05  CREINCDL PIC S9(0004) COMP.
  4749     05  CREINCDF PIC  X(0001).
  4750     05  FILLER REDEFINES CREINCDF.
  4751         10  CREINCDA PIC  X(0001).
  4752     05  CREINCDI PIC  X(0003).
  4753*    -------------------------------
  4754     05  CAEFFDTL PIC S9(0004) COMP.
  4755     05  CAEFFDTF PIC  X(0001).
  4756     05  FILLER REDEFINES CAEFFDTF.
  4757         10  CAEFFDTA PIC  X(0001).
  4758     05  CAEFFDTI PIC  X(0008).
  4759*    -------------------------------
  4760     05  CAEXPDTL PIC S9(0004) COMP.
  4761     05  CAEXPDTF PIC  X(0001).
  4762     05  FILLER REDEFINES CAEXPDTF.
  4763         10  CAEXPDTA PIC  X(0001).
  4764     05  CAEXPDTI PIC  X(0008).
  4765*    -------------------------------
  4766     05  COMMLFL PIC S9(0004) COMP.
  4767     05  COMMLFF PIC  X(0001).
  4768     05  FILLER REDEFINES COMMLFF.
  4769         10  COMMLFA PIC  X(0001).
  4770     05  COMMLFI PIC  X(0006).
  4771*    -------------------------------
  4772     05  COMMAHL PIC S9(0004) COMP.
  4773     05  COMMAHF PIC  X(0001).
  4774     05  FILLER REDEFINES COMMAHF.
  4775         10  COMMAHA PIC  X(0001).
  4776     05  COMMAHI PIC  X(0006).
  4777*    -------------------------------
  4778     05  CERMSG1L PIC S9(0004) COMP.
  4779     05  CERMSG1F PIC  X(0001).
  4780     05  FILLER REDEFINES CERMSG1F.
  4781         10  CERMSG1A PIC  X(0001).
  4782     05  CERMSG1I PIC  X(0078).
  4783*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  90
* EL6311.cbl
  4784     05  CERMSG2L PIC S9(0004) COMP.
  4785     05  CERMSG2F PIC  X(0001).
  4786     05  FILLER REDEFINES CERMSG2F.
  4787         10  CERMSG2A PIC  X(0001).
  4788     05  CERMSG2I PIC  X(0078).
  4789*    -------------------------------
  4790     05  CERMSG3L PIC S9(0004) COMP.
  4791     05  CERMSG3F PIC  X(0001).
  4792     05  FILLER REDEFINES CERMSG3F.
  4793         10  CERMSG3A PIC  X(0001).
  4794     05  CERMSG3I PIC  X(0078).
  4795*    -------------------------------
  4796     05  CPFENTRL PIC S9(0004) COMP.
  4797     05  CPFENTRF PIC  X(0001).
  4798     05  FILLER REDEFINES CPFENTRF.
  4799         10  CPFENTRA PIC  X(0001).
  4800     05  CPFENTRI PIC  9(2).
  4801*    -------------------------------
  4802     05  CPF5HDRL PIC S9(0004) COMP.
  4803     05  CPF5HDRF PIC  X(0001).
  4804     05  FILLER REDEFINES CPF5HDRF.
  4805         10  CPF5HDRA PIC  X(0001).
  4806     05  CPF5HDRI PIC  X(0005).
  4807*    -------------------------------
  4808     05  CPF4HDRL PIC S9(0004) COMP.
  4809     05  CPF4HDRF PIC  X(0001).
  4810     05  FILLER REDEFINES CPF4HDRF.
  4811         10  CPF4HDRA PIC  X(0001).
  4812     05  CPF4HDRI PIC  X(0013).
  4813*    -------------------------------
  4814     05  CF15HDRL PIC S9(0004) COMP.
  4815     05  CF15HDRF PIC  X(0001).
  4816     05  FILLER REDEFINES CF15HDRF.
  4817         10  CF15HDRA PIC  X(0001).
  4818     05  CF15HDRI PIC  X(0022).
  4819 01  EL631CO REDEFINES EL631BI.
  4820     05  FILLER            PIC  X(0012).
  4821*    -------------------------------
  4822     05  FILLER            PIC  X(0003).
  4823     05  CDATEO PIC  X(0008).
  4824*    -------------------------------
  4825     05  FILLER            PIC  X(0003).
  4826     05  CTIMEO PIC  99.99.
  4827*    -------------------------------
  4828     05  FILLER            PIC  X(0003).
  4829     05  CHEADO PIC  X(0038).
  4830*    -------------------------------
  4831     05  FILLER            PIC  X(0003).
  4832     05  CCHGTO PIC  X(0004).
  4833*    -------------------------------
  4834     05  FILLER            PIC  X(0003).
  4835     05  CCHGO PIC  ZZZ9.
  4836*    -------------------------------
  4837     05  FILLER            PIC  X(0003).
  4838     05  CMAINTO PIC  X(0001).
  4839*    -------------------------------
  4840     05  FILLER            PIC  X(0003).
  4841     05  CMANTBYO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  91
* EL6311.cbl
  4842*    -------------------------------
  4843     05  FILLER            PIC  X(0003).
  4844     05  CCHGHDGO PIC  X(0003).
  4845*    -------------------------------
  4846     05  FILLER            PIC  X(0003).
  4847     05  CMANTDTO PIC  X(0008).
  4848*    -------------------------------
  4849     05  FILLER            PIC  X(0003).
  4850     05  CMANTATO PIC  99.99.
  4851*    -------------------------------
  4852     05  FILLER            PIC  X(0003).
  4853     05  CCSRO PIC  X(0004).
  4854*    -------------------------------
  4855     05  FILLER            PIC  X(0003).
  4856     05  CBATCHO PIC  X(0006).
  4857*    -------------------------------
  4858     05  FILLER            PIC  X(0003).
  4859     05  CSEQO PIC  X(0004).
  4860*    -------------------------------
  4861     05  FILLER            PIC  X(0003).
  4862     05  CMOENDTO PIC  X(0008).
  4863*    -------------------------------
  4864     05  FILLER            PIC  X(0003).
  4865     05  CCARRO PIC  X(0001).
  4866*    -------------------------------
  4867     05  FILLER            PIC  X(0003).
  4868     05  CGROUPO PIC  X(0006).
  4869*    -------------------------------
  4870     05  FILLER            PIC  X(0003).
  4871     05  CSTATEO PIC  X(0002).
  4872*    -------------------------------
  4873     05  FILLER            PIC  X(0003).
  4874     05  CACCTO PIC  X(0010).
  4875*    -------------------------------
  4876     05  FILLER            PIC  X(0003).
  4877     05  CORIGHDO PIC  X(0011).
  4878*    -------------------------------
  4879     05  FILLER            PIC  X(0003).
  4880     05  CORGNOO PIC  X(0006).
  4881*    -------------------------------
  4882     05  FILLER            PIC  X(0003).
  4883     05  CORGSEQO PIC  X(0004).
  4884*    -------------------------------
  4885     05  FILLER            PIC  X(0003).
  4886     05  CREFHDGO PIC  X(0010).
  4887*    -------------------------------
  4888     05  FILLER            PIC  X(0003).
  4889     05  CREFO PIC  X(0012).
  4890*    -------------------------------
  4891     05  FILLER            PIC  X(0003).
  4892     05  CNHINTO PIC  999999.99.
  4893*    -------------------------------
  4894     05  FILLER            PIC  X(0003).
  4895     05  CCERTNOO PIC  X(0010).
  4896*    -------------------------------
  4897     05  FILLER            PIC  X(0003).
  4898     05  CSUFIXO PIC  X(0001).
  4899*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  92
* EL6311.cbl
  4900     05  FILLER            PIC  X(0003).
  4901     05  CEFFDTO PIC  X(0008).
  4902*    -------------------------------
  4903     05  FILLER            PIC  X(0003).
  4904     05  CLSTNMO PIC  X(0015).
  4905*    -------------------------------
  4906     05  FILLER            PIC  X(0003).
  4907     05  CPCYNO PIC  X(0001).
  4908*    -------------------------------
  4909     05  FILLER            PIC  X(0003).
  4910     05  CINAMEO PIC  X(0015).
  4911*    -------------------------------
  4912     05  FILLER            PIC  X(0003).
  4913     05  CINITSO PIC  X(0010).
  4914*    -------------------------------
  4915     05  FILLER            PIC  X(0003).
  4916     05  CCANREAO PIC  X(0001).
  4917*    -------------------------------
  4918     05  FILLER            PIC  X(0003).
  4919     05  CKIND1O PIC  X(0002).
  4920*    -------------------------------
  4921     05  FILLER            PIC  X(0003).
  4922     05  CCANDT1O PIC  X(0008).
  4923*    -------------------------------
  4924     05  FILLER            PIC  X(0003).
  4925     05  CREFND1O PIC  Z(7).99-.
  4926*    -------------------------------
  4927     05  FILLER            PIC  X(0003).
  4928     05  CMTHD1O PIC  X(0001).
  4929*    -------------------------------
  4930     05  FILLER            PIC  X(0003).
  4931     05  CKIND2O PIC  X(0002).
  4932*    -------------------------------
  4933     05  FILLER            PIC  X(0003).
  4934     05  CCANDT2O PIC  X(0008).
  4935*    -------------------------------
  4936     05  FILLER            PIC  X(0003).
  4937     05  CREFND2O PIC  Z(7).99-.
  4938*    -------------------------------
  4939     05  FILLER            PIC  X(0003).
  4940     05  CMTHD2O PIC  X(0001).
  4941*    -------------------------------
  4942     05  FILLER            PIC  X(0003).
  4943     05  CLIVESO PIC  X(0003).
  4944*    -------------------------------
  4945     05  FILLER            PIC  X(0003).
  4946     05  CFORCEO PIC  X(0001).
  4947*    -------------------------------
  4948     05  FILLER            PIC  X(0003).
  4949     05  CBILCDO PIC  X(0001).
  4950*    -------------------------------
  4951     05  FILLER            PIC  X(0003).
  4952     05  CCRFND1O PIC  Z(7).99-.
  4953*    -------------------------------
  4954     05  FILLER            PIC  X(0003).
  4955     05  CCRFND2O PIC  Z(7).99-.
  4956*    -------------------------------
  4957     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  93
* EL6311.cbl
  4958     05  CBILIT1O PIC  X(0008).
  4959*    -------------------------------
  4960     05  FILLER            PIC  X(0003).
  4961     05  CDRFND1O PIC  Z(7).99-.
  4962*    -------------------------------
  4963     05  FILLER            PIC  X(0003).
  4964     05  CBILIT2O PIC  X(0008).
  4965*    -------------------------------
  4966     05  FILLER            PIC  X(0003).
  4967     05  CDRFND2O PIC  Z(7).99-.
  4968*    -------------------------------
  4969     05  FILLER            PIC  X(0003).
  4970     05  CCANTXTO PIC  X(0005).
  4971*    -------------------------------
  4972     05  FILLER            PIC  X(0003).
  4973     05  CCANFEEO PIC  Z9.
  4974*    -------------------------------
  4975     05  FILLER            PIC  X(0003).
  4976     05  CTERM1O PIC  ZZ9.
  4977*    -------------------------------
  4978     05  FILLER            PIC  X(0003).
  4979     05  CRTERM1O PIC  ZZ9.
  4980*    -------------------------------
  4981     05  FILLER            PIC  X(0003).
  4982     05  CPREM1O PIC  ZZZZZZ9.99-.
  4983*    -------------------------------
  4984     05  FILLER            PIC  X(0003).
  4985     05  CTERM2O PIC  ZZ9.
  4986*    -------------------------------
  4987     05  FILLER            PIC  X(0003).
  4988     05  CRTERM2O PIC  ZZ9.
  4989*    -------------------------------
  4990     05  FILLER            PIC  X(0003).
  4991     05  CPREM2O PIC  ZZZZZZ9.99-.
  4992*    -------------------------------
  4993     05  FILLER            PIC  X(0003).
  4994     05  CENTRDTO PIC  X(0008).
  4995*    -------------------------------
  4996     05  FILLER            PIC  X(0003).
  4997     05  CPAYEEO PIC  X(0006).
  4998*    -------------------------------
  4999     05  FILLER            PIC  X(0003).
  5000     05  CRFNDSWO PIC  X(0003).
  5001*    -------------------------------
  5002     05  FILLER            PIC  X(0003).
  5003     05  CLFHDGO PIC  X(0006).
  5004*    -------------------------------
  5005     05  FILLER            PIC  X(0003).
  5006     05  CAHHDGO PIC  X(0006).
  5007*    -------------------------------
  5008     05  FILLER            PIC  X(0003).
  5009     05  CENTDTO PIC  X(0008).
  5010*    -------------------------------
  5011     05  FILLER            PIC  X(0003).
  5012     05  CENTBYO PIC  X(0004).
  5013*    -------------------------------
  5014     05  FILLER            PIC  X(0003).
  5015     05  CCHGCNTO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  94
* EL6311.cbl
  5016*    -------------------------------
  5017     05  FILLER            PIC  X(0003).
  5018     05  CLFREFNO PIC  X(0006).
  5019*    -------------------------------
  5020     05  FILLER            PIC  X(0003).
  5021     05  CAHREFNO PIC  X(0006).
  5022*    -------------------------------
  5023     05  FILLER            PIC  X(0003).
  5024     05  CREINCDO PIC  X(0003).
  5025*    -------------------------------
  5026     05  FILLER            PIC  X(0003).
  5027     05  CAEFFDTO PIC  X(0008).
  5028*    -------------------------------
  5029     05  FILLER            PIC  X(0003).
  5030     05  CAEXPDTO PIC  X(0008).
  5031*    -------------------------------
  5032     05  FILLER            PIC  X(0003).
  5033     05  COMMLFO PIC  .99999.
  5034*    -------------------------------
  5035     05  FILLER            PIC  X(0003).
  5036     05  COMMAHO PIC  .99999.
  5037*    -------------------------------
  5038     05  FILLER            PIC  X(0003).
  5039     05  CERMSG1O PIC  X(0078).
  5040*    -------------------------------
  5041     05  FILLER            PIC  X(0003).
  5042     05  CERMSG2O PIC  X(0078).
  5043*    -------------------------------
  5044     05  FILLER            PIC  X(0003).
  5045     05  CERMSG3O PIC  X(0078).
  5046*    -------------------------------
  5047     05  FILLER            PIC  X(0003).
  5048     05  CPFENTRO PIC  X(0002).
  5049*    -------------------------------
  5050     05  FILLER            PIC  X(0003).
  5051     05  CPF5HDRO PIC  X(0005).
  5052*    -------------------------------
  5053     05  FILLER            PIC  X(0003).
  5054     05  CPF4HDRO PIC  X(0013).
  5055*    -------------------------------
  5056     05  FILLER            PIC  X(0003).
  5057     05  CF15HDRO PIC  X(0022).
  5058*    -------------------------------
  5059 01  EL631DI REDEFINES EL631BI.
  5060     05  FILLER            PIC  X(0012).
  5061*    -------------------------------
  5062     05  DDATEL PIC S9(0004) COMP.
  5063     05  DDATEF PIC  X(0001).
  5064     05  FILLER REDEFINES DDATEF.
  5065         10  DDATEA PIC  X(0001).
  5066     05  DDATEI PIC  X(0008).
  5067*    -------------------------------
  5068     05  DTIMEL PIC S9(0004) COMP.
  5069     05  DTIMEF PIC  X(0001).
  5070     05  FILLER REDEFINES DTIMEF.
  5071         10  DTIMEA PIC  X(0001).
  5072     05  DTIMEI PIC  X(0005).
  5073*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  95
* EL6311.cbl
  5074     05  DHEADL PIC S9(0004) COMP.
  5075     05  DHEADF PIC  X(0001).
  5076     05  FILLER REDEFINES DHEADF.
  5077         10  DHEADA PIC  X(0001).
  5078     05  DHEADI PIC  X(0038).
  5079*    -------------------------------
  5080     05  DLDATEL PIC S9(0004) COMP.
  5081     05  DLDATEF PIC  X(0001).
  5082     05  FILLER REDEFINES DLDATEF.
  5083         10  DLDATEA PIC  X(0001).
  5084     05  DLDATEI PIC  X(0010).
  5085*    -------------------------------
  5086     05  DBATCHL PIC S9(0004) COMP.
  5087     05  DBATCHF PIC  X(0001).
  5088     05  FILLER REDEFINES DBATCHF.
  5089         10  DBATCHA PIC  X(0001).
  5090     05  DBATCHI PIC  X(0011).
  5091*    -------------------------------
  5092     05  DACCTNML PIC S9(0004) COMP.
  5093     05  DACCTNMF PIC  X(0001).
  5094     05  FILLER REDEFINES DACCTNMF.
  5095         10  DACCTNMA PIC  X(0001).
  5096     05  DACCTNMI PIC  X(0030).
  5097*    -------------------------------
  5098     05  DPROCDTL PIC S9(0004) COMP.
  5099     05  DPROCDTF PIC  X(0001).
  5100     05  FILLER REDEFINES DPROCDTF.
  5101         10  DPROCDTA PIC  X(0001).
  5102     05  DPROCDTI PIC  X(0008).
  5103*    -------------------------------
  5104     05  DINPUTL PIC S9(0004) COMP.
  5105     05  DINPUTF PIC  X(0001).
  5106     05  FILLER REDEFINES DINPUTF.
  5107         10  DINPUTA PIC  X(0001).
  5108     05  DINPUTI PIC  X(0008).
  5109*    -------------------------------
  5110     05  DMAINDTL PIC S9(0004) COMP.
  5111     05  DMAINDTF PIC  X(0001).
  5112     05  FILLER REDEFINES DMAINDTF.
  5113         10  DMAINDTA PIC  X(0001).
  5114     05  DMAINDTI PIC  X(0008).
  5115*    -------------------------------
  5116     05  DCARRL PIC S9(0004) COMP.
  5117     05  DCARRF PIC  X(0001).
  5118     05  FILLER REDEFINES DCARRF.
  5119         10  DCARRA PIC  X(0001).
  5120     05  DCARRI PIC  X(0001).
  5121*    -------------------------------
  5122     05  DGROUPL PIC S9(0004) COMP.
  5123     05  DGROUPF PIC  X(0001).
  5124     05  FILLER REDEFINES DGROUPF.
  5125         10  DGROUPA PIC  X(0001).
  5126     05  DGROUPI PIC  X(0006).
  5127*    -------------------------------
  5128     05  DSTATEL PIC S9(0004) COMP.
  5129     05  DSTATEF PIC  X(0001).
  5130     05  FILLER REDEFINES DSTATEF.
  5131         10  DSTATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  96
* EL6311.cbl
  5132     05  DSTATEI PIC  X(0002).
  5133*    -------------------------------
  5134     05  DACCTL PIC S9(0004) COMP.
  5135     05  DACCTF PIC  X(0001).
  5136     05  FILLER REDEFINES DACCTF.
  5137         10  DACCTA PIC  X(0001).
  5138     05  DACCTI PIC  X(0010).
  5139*    -------------------------------
  5140     05  DRECVDTL PIC S9(0004) COMP.
  5141     05  DRECVDTF PIC  X(0001).
  5142     05  FILLER REDEFINES DRECVDTF.
  5143         10  DRECVDTA PIC  X(0001).
  5144     05  DRECVDTI PIC  X(0008).
  5145*    -------------------------------
  5146     05  DCSRL PIC S9(0004) COMP.
  5147     05  DCSRF PIC  X(0001).
  5148     05  FILLER REDEFINES DCSRF.
  5149         10  DCSRA PIC  X(0001).
  5150     05  DCSRI PIC  X(0004).
  5151*    -------------------------------
  5152     05  DREFHDGL PIC S9(0004) COMP.
  5153     05  DREFHDGF PIC  X(0001).
  5154     05  FILLER REDEFINES DREFHDGF.
  5155         10  DREFHDGA PIC  X(0001).
  5156     05  DREFHDGI PIC  X(0010).
  5157*    -------------------------------
  5158     05  DREFL PIC S9(0004) COMP.
  5159     05  DREFF PIC  X(0001).
  5160     05  FILLER REDEFINES DREFF.
  5161         10  DREFA PIC  X(0001).
  5162     05  DREFI PIC  X(0012).
  5163*    -------------------------------
  5164     05  DLFPHDGL PIC S9(0004) COMP.
  5165     05  DLFPHDGF PIC  X(0001).
  5166     05  FILLER REDEFINES DLFPHDGF.
  5167         10  DLFPHDGA PIC  X(0001).
  5168     05  DLFPHDGI PIC  X(0010).
  5169*    -------------------------------
  5170     05  DAHPHDGL PIC S9(0004) COMP.
  5171     05  DAHPHDGF PIC  X(0001).
  5172     05  FILLER REDEFINES DAHPHDGF.
  5173         10  DAHPHDGA PIC  X(0001).
  5174     05  DAHPHDGI PIC  X(0010).
  5175*    -------------------------------
  5176     05  DLFRHDGL PIC S9(0004) COMP.
  5177     05  DLFRHDGF PIC  X(0001).
  5178     05  FILLER REDEFINES DLFRHDGF.
  5179         10  DLFRHDGA PIC  X(0001).
  5180     05  DLFRHDGI PIC  X(0009).
  5181*    -------------------------------
  5182     05  DAHRHDGL PIC S9(0004) COMP.
  5183     05  DAHRHDGF PIC  X(0001).
  5184     05  FILLER REDEFINES DAHRHDGF.
  5185         10  DAHRHDGA PIC  X(0001).
  5186     05  DAHRHDGI PIC  X(0009).
  5187*    -------------------------------
  5188     05  DRISSL PIC S9(0004) COMP.
  5189     05  DRISSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  97
* EL6311.cbl
  5190     05  FILLER REDEFINES DRISSF.
  5191         10  DRISSA PIC  X(0001).
  5192     05  DRISSI PIC  X(0005).
  5193*    -------------------------------
  5194     05  DRLFPRML PIC S9(0004) COMP.
  5195     05  DRLFPRMF PIC  X(0001).
  5196     05  FILLER REDEFINES DRLFPRMF.
  5197         10  DRLFPRMA PIC  X(0001).
  5198     05  DRLFPRMI PIC  S9(9)V99.
  5199*    -------------------------------
  5200     05  DRAHPRML PIC S9(0004) COMP.
  5201     05  DRAHPRMF PIC  X(0001).
  5202     05  FILLER REDEFINES DRAHPRMF.
  5203         10  DRAHPRMA PIC  X(0001).
  5204     05  DRAHPRMI PIC  S9(9)V99.
  5205*    -------------------------------
  5206     05  DRCANCL PIC S9(0004) COMP.
  5207     05  DRCANCF PIC  X(0001).
  5208     05  FILLER REDEFINES DRCANCF.
  5209         10  DRCANCA PIC  X(0001).
  5210     05  DRCANCI PIC  X(0005).
  5211*    -------------------------------
  5212     05  DRLFRFDL PIC S9(0004) COMP.
  5213     05  DRLFRFDF PIC  X(0001).
  5214     05  FILLER REDEFINES DRLFRFDF.
  5215         10  DRLFRFDA PIC  X(0001).
  5216     05  DRLFRFDI PIC  S9(9)V99.
  5217*    -------------------------------
  5218     05  DRAHRFDL PIC S9(0004) COMP.
  5219     05  DRAHRFDF PIC  X(0001).
  5220     05  FILLER REDEFINES DRAHRFDF.
  5221         10  DRAHRFDA PIC  X(0001).
  5222     05  DRAHRFDI PIC  S9(9)V99.
  5223*    -------------------------------
  5224     05  DEISSL PIC S9(0004) COMP.
  5225     05  DEISSF PIC  X(0001).
  5226     05  FILLER REDEFINES DEISSF.
  5227         10  DEISSA PIC  X(0001).
  5228     05  DEISSI PIC  X(0005).
  5229*    -------------------------------
  5230     05  DELFPRML PIC S9(0004) COMP.
  5231     05  DELFPRMF PIC  X(0001).
  5232     05  FILLER REDEFINES DELFPRMF.
  5233         10  DELFPRMA PIC  X(0001).
  5234     05  DELFPRMI PIC  X(0011).
  5235*    -------------------------------
  5236     05  DEAHPRML PIC S9(0004) COMP.
  5237     05  DEAHPRMF PIC  X(0001).
  5238     05  FILLER REDEFINES DEAHPRMF.
  5239         10  DEAHPRMA PIC  X(0001).
  5240     05  DEAHPRMI PIC  X(0011).
  5241*    -------------------------------
  5242     05  DECANCL PIC S9(0004) COMP.
  5243     05  DECANCF PIC  X(0001).
  5244     05  FILLER REDEFINES DECANCF.
  5245         10  DECANCA PIC  X(0001).
  5246     05  DECANCI PIC  X(0005).
  5247*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  98
* EL6311.cbl
  5248     05  DELFRFDL PIC S9(0004) COMP.
  5249     05  DELFRFDF PIC  X(0001).
  5250     05  FILLER REDEFINES DELFRFDF.
  5251         10  DELFRFDA PIC  X(0001).
  5252     05  DELFRFDI PIC  X(0011).
  5253*    -------------------------------
  5254     05  DEAHRFDL PIC S9(0004) COMP.
  5255     05  DEAHRFDF PIC  X(0001).
  5256     05  FILLER REDEFINES DEAHRFDF.
  5257         10  DEAHRFDA PIC  X(0001).
  5258     05  DEAHRFDI PIC  X(0011).
  5259*    -------------------------------
  5260     05  DCISSL PIC S9(0004) COMP.
  5261     05  DCISSF PIC  X(0001).
  5262     05  FILLER REDEFINES DCISSF.
  5263         10  DCISSA PIC  X(0001).
  5264     05  DCISSI PIC  X(0005).
  5265*    -------------------------------
  5266     05  DCLFPRML PIC S9(0004) COMP.
  5267     05  DCLFPRMF PIC  X(0001).
  5268     05  FILLER REDEFINES DCLFPRMF.
  5269         10  DCLFPRMA PIC  X(0001).
  5270     05  DCLFPRMI PIC  X(0011).
  5271*    -------------------------------
  5272     05  DCAHPRML PIC S9(0004) COMP.
  5273     05  DCAHPRMF PIC  X(0001).
  5274     05  FILLER REDEFINES DCAHPRMF.
  5275         10  DCAHPRMA PIC  X(0001).
  5276     05  DCAHPRMI PIC  X(0011).
  5277*    -------------------------------
  5278     05  DCCANCL PIC S9(0004) COMP.
  5279     05  DCCANCF PIC  X(0001).
  5280     05  FILLER REDEFINES DCCANCF.
  5281         10  DCCANCA PIC  X(0001).
  5282     05  DCCANCI PIC  X(0005).
  5283*    -------------------------------
  5284     05  DCLFRFDL PIC S9(0004) COMP.
  5285     05  DCLFRFDF PIC  X(0001).
  5286     05  FILLER REDEFINES DCLFRFDF.
  5287         10  DCLFRFDA PIC  X(0001).
  5288     05  DCLFRFDI PIC  X(0011).
  5289*    -------------------------------
  5290     05  DCAHRFDL PIC S9(0004) COMP.
  5291     05  DCAHRFDF PIC  X(0001).
  5292     05  FILLER REDEFINES DCAHRFDF.
  5293         10  DCAHRFDA PIC  X(0001).
  5294     05  DCAHRFDI PIC  X(0011).
  5295*    -------------------------------
  5296     05  DOISSL PIC S9(0004) COMP.
  5297     05  DOISSF PIC  X(0001).
  5298     05  FILLER REDEFINES DOISSF.
  5299         10  DOISSA PIC  X(0001).
  5300     05  DOISSI PIC  X(0005).
  5301*    -------------------------------
  5302     05  DOLFPRML PIC S9(0004) COMP.
  5303     05  DOLFPRMF PIC  X(0001).
  5304     05  FILLER REDEFINES DOLFPRMF.
  5305         10  DOLFPRMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page  99
* EL6311.cbl
  5306     05  DOLFPRMI PIC  X(0011).
  5307*    -------------------------------
  5308     05  DOAHPRML PIC S9(0004) COMP.
  5309     05  DOAHPRMF PIC  X(0001).
  5310     05  FILLER REDEFINES DOAHPRMF.
  5311         10  DOAHPRMA PIC  X(0001).
  5312     05  DOAHPRMI PIC  X(0011).
  5313*    -------------------------------
  5314     05  DOCANCL PIC S9(0004) COMP.
  5315     05  DOCANCF PIC  X(0001).
  5316     05  FILLER REDEFINES DOCANCF.
  5317         10  DOCANCA PIC  X(0001).
  5318     05  DOCANCI PIC  X(0005).
  5319*    -------------------------------
  5320     05  DOLFRFDL PIC S9(0004) COMP.
  5321     05  DOLFRFDF PIC  X(0001).
  5322     05  FILLER REDEFINES DOLFRFDF.
  5323         10  DOLFRFDA PIC  X(0001).
  5324     05  DOLFRFDI PIC  X(0011).
  5325*    -------------------------------
  5326     05  DOAHRFDL PIC S9(0004) COMP.
  5327     05  DOAHRFDF PIC  X(0001).
  5328     05  FILLER REDEFINES DOAHRFDF.
  5329         10  DOAHRFDA PIC  X(0001).
  5330     05  DOAHRFDI PIC  X(0011).
  5331*    -------------------------------
  5332     05  DITOTALL PIC S9(0004) COMP.
  5333     05  DITOTALF PIC  X(0001).
  5334     05  FILLER REDEFINES DITOTALF.
  5335         10  DITOTALA PIC  X(0001).
  5336     05  DITOTALI PIC  X(0005).
  5337*    -------------------------------
  5338     05  DIFATALL PIC S9(0004) COMP.
  5339     05  DIFATALF PIC  X(0001).
  5340     05  FILLER REDEFINES DIFATALF.
  5341         10  DIFATALA PIC  X(0001).
  5342     05  DIFATALI PIC  X(0005).
  5343*    -------------------------------
  5344     05  DIFORCEL PIC S9(0004) COMP.
  5345     05  DIFORCEF PIC  X(0001).
  5346     05  FILLER REDEFINES DIFORCEF.
  5347         10  DIFORCEA PIC  X(0001).
  5348     05  DIFORCEI PIC  X(0005).
  5349*    -------------------------------
  5350     05  DIHOLDL PIC S9(0004) COMP.
  5351     05  DIHOLDF PIC  X(0001).
  5352     05  FILLER REDEFINES DIHOLDF.
  5353         10  DIHOLDA PIC  X(0001).
  5354     05  DIHOLDI PIC  X(0005).
  5355*    -------------------------------
  5356     05  DIAVAILL PIC S9(0004) COMP.
  5357     05  DIAVAILF PIC  X(0001).
  5358     05  FILLER REDEFINES DIAVAILF.
  5359         10  DIAVAILA PIC  X(0001).
  5360     05  DIAVAILI PIC  X(0005).
  5361*    -------------------------------
  5362     05  DIGPREML PIC S9(0004) COMP.
  5363     05  DIGPREMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 100
* EL6311.cbl
  5364     05  FILLER REDEFINES DIGPREMF.
  5365         10  DIGPREMA PIC  X(0001).
  5366     05  DIGPREMI PIC  X(0011).
  5367*    -------------------------------
  5368     05  DIBPREML PIC S9(0004) COMP.
  5369     05  DIBPREMF PIC  X(0001).
  5370     05  FILLER REDEFINES DIBPREMF.
  5371         10  DIBPREMA PIC  X(0001).
  5372     05  DIBPREMI PIC  X(0011).
  5373*    -------------------------------
  5374     05  DCTOTALL PIC S9(0004) COMP.
  5375     05  DCTOTALF PIC  X(0001).
  5376     05  FILLER REDEFINES DCTOTALF.
  5377         10  DCTOTALA PIC  X(0001).
  5378     05  DCTOTALI PIC  X(0005).
  5379*    -------------------------------
  5380     05  DCFATALL PIC S9(0004) COMP.
  5381     05  DCFATALF PIC  X(0001).
  5382     05  FILLER REDEFINES DCFATALF.
  5383         10  DCFATALA PIC  X(0001).
  5384     05  DCFATALI PIC  X(0005).
  5385*    -------------------------------
  5386     05  DCFORCEL PIC S9(0004) COMP.
  5387     05  DCFORCEF PIC  X(0001).
  5388     05  FILLER REDEFINES DCFORCEF.
  5389         10  DCFORCEA PIC  X(0001).
  5390     05  DCFORCEI PIC  X(0005).
  5391*    -------------------------------
  5392     05  DCHOLDL PIC S9(0004) COMP.
  5393     05  DCHOLDF PIC  X(0001).
  5394     05  FILLER REDEFINES DCHOLDF.
  5395         10  DCHOLDA PIC  X(0001).
  5396     05  DCHOLDI PIC  X(0005).
  5397*    -------------------------------
  5398     05  DCAVAILL PIC S9(0004) COMP.
  5399     05  DCAVAILF PIC  X(0001).
  5400     05  FILLER REDEFINES DCAVAILF.
  5401         10  DCAVAILA PIC  X(0001).
  5402     05  DCAVAILI PIC  X(0005).
  5403*    -------------------------------
  5404     05  DCGPREML PIC S9(0004) COMP.
  5405     05  DCGPREMF PIC  X(0001).
  5406     05  FILLER REDEFINES DCGPREMF.
  5407         10  DCGPREMA PIC  X(0001).
  5408     05  DCGPREMI PIC  X(0011).
  5409*    -------------------------------
  5410     05  DCBPREML PIC S9(0004) COMP.
  5411     05  DCBPREMF PIC  X(0001).
  5412     05  FILLER REDEFINES DCBPREMF.
  5413         10  DCBPREMA PIC  X(0001).
  5414     05  DCBPREMI PIC  X(0011).
  5415*    -------------------------------
  5416     05  DNTOTALL PIC S9(0004) COMP.
  5417     05  DNTOTALF PIC  X(0001).
  5418     05  FILLER REDEFINES DNTOTALF.
  5419         10  DNTOTALA PIC  X(0001).
  5420     05  DNTOTALI PIC  X(0005).
  5421*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 101
* EL6311.cbl
  5422     05  DNFATALL PIC S9(0004) COMP.
  5423     05  DNFATALF PIC  X(0001).
  5424     05  FILLER REDEFINES DNFATALF.
  5425         10  DNFATALA PIC  X(0001).
  5426     05  DNFATALI PIC  X(0005).
  5427*    -------------------------------
  5428     05  DNFORCEL PIC S9(0004) COMP.
  5429     05  DNFORCEF PIC  X(0001).
  5430     05  FILLER REDEFINES DNFORCEF.
  5431         10  DNFORCEA PIC  X(0001).
  5432     05  DNFORCEI PIC  X(0005).
  5433*    -------------------------------
  5434     05  DNHOLDL PIC S9(0004) COMP.
  5435     05  DNHOLDF PIC  X(0001).
  5436     05  FILLER REDEFINES DNHOLDF.
  5437         10  DNHOLDA PIC  X(0001).
  5438     05  DNHOLDI PIC  X(0005).
  5439*    -------------------------------
  5440     05  DNAVAILL PIC S9(0004) COMP.
  5441     05  DNAVAILF PIC  X(0001).
  5442     05  FILLER REDEFINES DNAVAILF.
  5443         10  DNAVAILA PIC  X(0001).
  5444     05  DNAVAILI PIC  X(0005).
  5445*    -------------------------------
  5446     05  DNGPREML PIC S9(0004) COMP.
  5447     05  DNGPREMF PIC  X(0001).
  5448     05  FILLER REDEFINES DNGPREMF.
  5449         10  DNGPREMA PIC  X(0001).
  5450     05  DNGPREMI PIC  X(0011).
  5451*    -------------------------------
  5452     05  DNBPREML PIC S9(0004) COMP.
  5453     05  DNBPREMF PIC  X(0001).
  5454     05  FILLER REDEFINES DNBPREMF.
  5455         10  DNBPREMA PIC  X(0001).
  5456     05  DNBPREMI PIC  X(0011).
  5457*    -------------------------------
  5458     05  DERMSGL PIC S9(0004) COMP.
  5459     05  DERMSGF PIC  X(0001).
  5460     05  FILLER REDEFINES DERMSGF.
  5461         10  DERMSGA PIC  X(0001).
  5462     05  DERMSGI PIC  X(0075).
  5463*    -------------------------------
  5464     05  DPFENTRL PIC S9(0004) COMP.
  5465     05  DPFENTRF PIC  X(0001).
  5466     05  FILLER REDEFINES DPFENTRF.
  5467         10  DPFENTRA PIC  X(0001).
  5468     05  DPFENTRI PIC  9(2).
  5469 01  EL631DO REDEFINES EL631BI.
  5470     05  FILLER            PIC  X(0012).
  5471*    -------------------------------
  5472     05  FILLER            PIC  X(0003).
  5473     05  DDATEO PIC  X(0008).
  5474*    -------------------------------
  5475     05  FILLER            PIC  X(0003).
  5476     05  DTIMEO PIC  99.99.
  5477*    -------------------------------
  5478     05  FILLER            PIC  X(0003).
  5479     05  DHEADO PIC  X(0038).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 102
* EL6311.cbl
  5480*    -------------------------------
  5481     05  FILLER            PIC  X(0003).
  5482     05  DLDATEO PIC  X(0010).
  5483*    -------------------------------
  5484     05  FILLER            PIC  X(0003).
  5485     05  DBATCHO PIC  X(0011).
  5486*    -------------------------------
  5487     05  FILLER            PIC  X(0003).
  5488     05  DACCTNMO PIC  X(0030).
  5489*    -------------------------------
  5490     05  FILLER            PIC  X(0003).
  5491     05  DPROCDTO PIC  X(0008).
  5492*    -------------------------------
  5493     05  FILLER            PIC  X(0003).
  5494     05  DINPUTO PIC  X(0008).
  5495*    -------------------------------
  5496     05  FILLER            PIC  X(0003).
  5497     05  DMAINDTO PIC  X(0008).
  5498*    -------------------------------
  5499     05  FILLER            PIC  X(0003).
  5500     05  DCARRO PIC  X(0001).
  5501*    -------------------------------
  5502     05  FILLER            PIC  X(0003).
  5503     05  DGROUPO PIC  X(0006).
  5504*    -------------------------------
  5505     05  FILLER            PIC  X(0003).
  5506     05  DSTATEO PIC  X(0002).
  5507*    -------------------------------
  5508     05  FILLER            PIC  X(0003).
  5509     05  DACCTO PIC  X(0010).
  5510*    -------------------------------
  5511     05  FILLER            PIC  X(0003).
  5512     05  DRECVDTO PIC  X(0008).
  5513*    -------------------------------
  5514     05  FILLER            PIC  X(0003).
  5515     05  DCSRO PIC  X(0004).
  5516*    -------------------------------
  5517     05  FILLER            PIC  X(0003).
  5518     05  DREFHDGO PIC  X(0010).
  5519*    -------------------------------
  5520     05  FILLER            PIC  X(0003).
  5521     05  DREFO PIC  X(0012).
  5522*    -------------------------------
  5523     05  FILLER            PIC  X(0003).
  5524     05  DLFPHDGO PIC  X(0010).
  5525*    -------------------------------
  5526     05  FILLER            PIC  X(0003).
  5527     05  DAHPHDGO PIC  X(0010).
  5528*    -------------------------------
  5529     05  FILLER            PIC  X(0003).
  5530     05  DLFRHDGO PIC  X(0009).
  5531*    -------------------------------
  5532     05  FILLER            PIC  X(0003).
  5533     05  DAHRHDGO PIC  X(0009).
  5534*    -------------------------------
  5535     05  FILLER            PIC  X(0003).
  5536     05  DRISSO PIC  ZZ99-.
  5537*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 103
* EL6311.cbl
  5538     05  FILLER            PIC  X(0003).
  5539     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5540*    -------------------------------
  5541     05  FILLER            PIC  X(0003).
  5542     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5543*    -------------------------------
  5544     05  FILLER            PIC  X(0003).
  5545     05  DRCANCO PIC  ZZ99-.
  5546*    -------------------------------
  5547     05  FILLER            PIC  X(0003).
  5548     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5549*    -------------------------------
  5550     05  FILLER            PIC  X(0003).
  5551     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5552*    -------------------------------
  5553     05  FILLER            PIC  X(0003).
  5554     05  DEISSO PIC  ZZ99-.
  5555*    -------------------------------
  5556     05  FILLER            PIC  X(0003).
  5557     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5558*    -------------------------------
  5559     05  FILLER            PIC  X(0003).
  5560     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5561*    -------------------------------
  5562     05  FILLER            PIC  X(0003).
  5563     05  DECANCO PIC  ZZ99-.
  5564*    -------------------------------
  5565     05  FILLER            PIC  X(0003).
  5566     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5567*    -------------------------------
  5568     05  FILLER            PIC  X(0003).
  5569     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5570*    -------------------------------
  5571     05  FILLER            PIC  X(0003).
  5572     05  DCISSO PIC  ZZ99-.
  5573*    -------------------------------
  5574     05  FILLER            PIC  X(0003).
  5575     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5576*    -------------------------------
  5577     05  FILLER            PIC  X(0003).
  5578     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5579*    -------------------------------
  5580     05  FILLER            PIC  X(0003).
  5581     05  DCCANCO PIC  ZZ99-.
  5582*    -------------------------------
  5583     05  FILLER            PIC  X(0003).
  5584     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5585*    -------------------------------
  5586     05  FILLER            PIC  X(0003).
  5587     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5588*    -------------------------------
  5589     05  FILLER            PIC  X(0003).
  5590     05  DOISSO PIC  ZZ99-.
  5591*    -------------------------------
  5592     05  FILLER            PIC  X(0003).
  5593     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5594*    -------------------------------
  5595     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 104
* EL6311.cbl
  5596     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5597*    -------------------------------
  5598     05  FILLER            PIC  X(0003).
  5599     05  DOCANCO PIC  ZZ99-.
  5600*    -------------------------------
  5601     05  FILLER            PIC  X(0003).
  5602     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5603*    -------------------------------
  5604     05  FILLER            PIC  X(0003).
  5605     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5606*    -------------------------------
  5607     05  FILLER            PIC  X(0003).
  5608     05  DITOTALO PIC  ZZZ99.
  5609*    -------------------------------
  5610     05  FILLER            PIC  X(0003).
  5611     05  DIFATALO PIC  ZZZ99.
  5612*    -------------------------------
  5613     05  FILLER            PIC  X(0003).
  5614     05  DIFORCEO PIC  ZZZ99.
  5615*    -------------------------------
  5616     05  FILLER            PIC  X(0003).
  5617     05  DIHOLDO PIC  ZZZ99.
  5618*    -------------------------------
  5619     05  FILLER            PIC  X(0003).
  5620     05  DIAVAILO PIC  ZZZ99.
  5621*    -------------------------------
  5622     05  FILLER            PIC  X(0003).
  5623     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5624*    -------------------------------
  5625     05  FILLER            PIC  X(0003).
  5626     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5627*    -------------------------------
  5628     05  FILLER            PIC  X(0003).
  5629     05  DCTOTALO PIC  ZZZ99.
  5630*    -------------------------------
  5631     05  FILLER            PIC  X(0003).
  5632     05  DCFATALO PIC  ZZZ99.
  5633*    -------------------------------
  5634     05  FILLER            PIC  X(0003).
  5635     05  DCFORCEO PIC  ZZZ99.
  5636*    -------------------------------
  5637     05  FILLER            PIC  X(0003).
  5638     05  DCHOLDO PIC  ZZZ99.
  5639*    -------------------------------
  5640     05  FILLER            PIC  X(0003).
  5641     05  DCAVAILO PIC  ZZZ99.
  5642*    -------------------------------
  5643     05  FILLER            PIC  X(0003).
  5644     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5645*    -------------------------------
  5646     05  FILLER            PIC  X(0003).
  5647     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5648*    -------------------------------
  5649     05  FILLER            PIC  X(0003).
  5650     05  DNTOTALO PIC  ---99.
  5651*    -------------------------------
  5652     05  FILLER            PIC  X(0003).
  5653     05  DNFATALO PIC  ---99.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 105
* EL6311.cbl
  5654*    -------------------------------
  5655     05  FILLER            PIC  X(0003).
  5656     05  DNFORCEO PIC  ---99.
  5657*    -------------------------------
  5658     05  FILLER            PIC  X(0003).
  5659     05  DNHOLDO PIC  ---99.
  5660*    -------------------------------
  5661     05  FILLER            PIC  X(0003).
  5662     05  DNAVAILO PIC  ---99.
  5663*    -------------------------------
  5664     05  FILLER            PIC  X(0003).
  5665     05  DNGPREMO PIC  -------9.99.
  5666*    -------------------------------
  5667     05  FILLER            PIC  X(0003).
  5668     05  DNBPREMO PIC  -------9.99.
  5669*    -------------------------------
  5670     05  FILLER            PIC  X(0003).
  5671     05  DERMSGO PIC  X(0075).
  5672*    -------------------------------
  5673     05  FILLER            PIC  X(0003).
  5674     05  DPFENTRO PIC  X(0002).
  5675*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 106
* EL6311.cbl
  5677 01  MAP-B REDEFINES EL631BI.
  5678     12  FILLER                  PIC X(591).
  5679*    12  FILLER                  PIC X(512).
  5680*    12  FILLER                  PIC X(510).
  5681     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5682         16  BKIND-LEN               PIC S9(4)  COMP.
  5683         16  BKIND-ATTRB             PIC X.
  5684         16  BKIND                   PIC XX.
  5685         16  BTYPE-LEN               PIC S9(4)  COMP.
  5686         16  BTYPE-ATTRB             PIC X.
  5687         16  BTYPE                   PIC X(3).
  5688         16  BTERM-LEN               PIC S9(4)  COMP.
  5689         16  BTERM-ATTRB             PIC X.
  5690         16  BTERMI                  PIC 999.
  5691         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5692         16  BBEN-LEN                PIC S9(4)  COMP.
  5693         16  BBEN-ATTRB              PIC X.
  5694         16  BBENI                   PIC 9(10)V99.
  5695*        16  BBENI                   PIC 9(12).
  5696         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5697         16  BPREM-LEN               PIC S9(4)  COMP.
  5698         16  BPREM-ATTRB             PIC X.
  5699         16  BPREMI                  PIC S9(9)V99.
  5700*        16  BPREMI                  PIC 9(11).
  5701         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5702         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5703         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5704         16  BEXPIRE-ATTRB           PIC X.
  5705         16  BEXPIRE                 PIC X(8).
  5706         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5707         16  BCRIT-PERD-ATTRB        PIC X.
  5708         16  BCRIT-PERDI             PIC 99.
  5709         16  BCRIT-PERDO REDEFINES
  5710                         BCRIT-PERDI PIC ZZ.
  5711         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5712         16  BALT-BEN-ATTRB          PIC X.
  5713         16  BALT-BENI               PIC 9(10)V99.
  5714*        16  BALT-BENI               PIC 9(12).
  5715         16  BALT-BENO REDEFINES
  5716                           BALT-BENI PIC Z(9).ZZ.
  5717         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5718         16  BALT-PREM-ATTRB         PIC X.
  5719         16  BALT-PREMI              PIC 9(9)V99.
  5720*        16  BALT-PREMI              PIC 9(11).
  5721         16  BALT-PREMO REDEFINES
  5722                          BALT-PREMI PIC Z(7).ZZ-.
  5723         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5724         16  BBEN-CD-ATTRB           PIC X.
  5725         16  BBEN-CD                 PIC XXX.
  5726         16  BCPREM-LEN              PIC S9(4)  COMP.
  5727         16  BCPREM-ATTRB            PIC X.
  5728         16  BCPREMI                 PIC S9(9)V99.
  5729*        16  BCPREMI                 PIC X(11).
  5730         16  BCPREMO REDEFINES BCPREMI
  5731                                     PIC Z(7).99-.
  5732         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5733         16  BCALT-PREM-ATTRB        PIC X.
  5734         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 107
* EL6311.cbl
  5735         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5736         16  BBEN-ABBR-ATTRB         PIC X.
  5737         16  BBEN-ABBR               PIC X(5).
  5738         16  BDIFF-LEN               PIC S9(4)  COMP.
  5739         16  BDIFF-ATTRB             PIC X.
  5740         16  BDIFFO                  PIC Z(7).99-.
  5741         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5742         16  BBILL-LIT-ATTRB         PIC X.
  5743         16  BBILL-LIT               PIC X(8).
  5744         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5745         16  BDALT-PREM-ATTRB        PIC X.
  5746         16  BDALT-PREM              PIC Z(7).99-.
  5747
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 108
* EL6311.cbl
  5749
  5750****************************************************************
  5751*
  5752* Copyright (c) 2007 by Clerity Solutions, Inc.
  5753* All rights reserved.
  5754*
  5755****************************************************************
  5756 01  DFHEIV.
  5757   02  DFHEIV0               PIC X(35).
  5758   02  DFHEIV1               PIC X(08).
  5759   02  DFHEIV2               PIC X(08).
  5760   02  DFHEIV3               PIC X(08).
  5761   02  DFHEIV4               PIC X(06).
  5762   02  DFHEIV5               PIC X(04).
  5763   02  DFHEIV6               PIC X(04).
  5764   02  DFHEIV7               PIC X(02).
  5765   02  DFHEIV8               PIC X(02).
  5766   02  DFHEIV9               PIC X(01).
  5767   02  DFHEIV10              PIC S9(7) COMP-3.
  5768   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5769   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5770   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5771   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5772   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5773   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5774   02  DFHEIV17              PIC X(04).
  5775   02  DFHEIV18              PIC X(04).
  5776   02  DFHEIV19              PIC X(04).
  5777   02  DFHEIV20              USAGE IS POINTER.
  5778   02  DFHEIV21              USAGE IS POINTER.
  5779   02  DFHEIV22              USAGE IS POINTER.
  5780   02  DFHEIV23              USAGE IS POINTER.
  5781   02  DFHEIV24              USAGE IS POINTER.
  5782   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5783   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5784   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5785   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5786   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5787   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5788   02  FILLER                PIC X(02).
  5789   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5790   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5791   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5792   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5793   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5794 LINKAGE  SECTION.
  5795*****************************************************************
  5796*                                                               *
  5797* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5798* All rights reserved.                                          *
  5799*                                                               *
  5800*****************************************************************
  5801 01  dfheiblk.
  5802     02  eibtime          pic s9(7) comp-3.
  5803     02  eibdate          pic s9(7) comp-3.
  5804     02  eibtrnid         pic x(4).
  5805     02  eibtaskn         pic s9(7) comp-3.
  5806     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 109
* EL6311.cbl
  5807     02  dfheigdi         pic s9(4) comp.
  5808     02  eibcposn         pic s9(4) comp.
  5809     02  eibcalen         pic s9(4) comp.
  5810     02  eibaid           pic x(1).
  5811     02  eibfiller1       pic x(1).
  5812     02  eibfn            pic x(2).
  5813     02  eibfiller2       pic x(2).
  5814     02  eibrcode         pic x(6).
  5815     02  eibfiller3       pic x(2).
  5816     02  eibds            pic x(8).
  5817     02  eibreqid         pic x(8).
  5818     02  eibrsrce         pic x(8).
  5819     02  eibsync          pic x(1).
  5820     02  eibfree          pic x(1).
  5821     02  eibrecv          pic x(1).
  5822     02  eibsend          pic x(1).
  5823     02  eibatt           pic x(1).
  5824     02  eibeoc           pic x(1).
  5825     02  eibfmh           pic x(1).
  5826     02  eibcompl         pic x(1).
  5827     02  eibsig           pic x(1).
  5828     02  eibconf          pic x(1).
  5829     02  eiberr           pic x(1).
  5830     02  eibrldbk         pic x(1).
  5831     02  eiberrcd         pic x(4).
  5832     02  eibsynrb         pic x(1).
  5833     02  eibnodat         pic x(1).
  5834     02  eibfiller5       pic x(2).
  5835     02  eibresp          pic 9(09) comp.
  5836     02  eibresp2         pic 9(09) comp.
  5837     02  dfheigdj         pic s9(4) comp.
  5838     02  dfheigdk         pic s9(4) comp.
  5839 01  DFHCOMMAREA                 PIC X(1300).
  5840*                                COPY ERCPNDB.
  5841******************************************************************
  5842*                                                                *
  5843*                                                                *
  5844*                            ERCPNDB.                            *
  5845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5846*                            VMOD=2.025                          *
  5847*                                                                *
  5848*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5849*                                                                *
  5850******************************************************************
  5851*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5852*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5853******************************************************************
  5854*                                                                *
  5855*                                                                *
  5856*   FILE TYPE = VSAM,KSDS                                        *
  5857*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5858*                                                                *
  5859*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5860*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5861*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5862*                                                 RKP=13,LEN=36  *
  5863*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5864*                                      AND CHG-SEQ.)             *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 110
* EL6311.cbl
  5865*                                                RKP=49,LEN=11   *
  5866*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5867*                                      AND CHG-SEQ.)             *
  5868*                                                RKP=60,LEN=15   *
  5869*                                                                *
  5870*   LOG = NO                                                     *
  5871*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5872******************************************************************
  5873******************************************************************
  5874*                   C H A N G E   L O G
  5875*
  5876* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5877*-----------------------------------------------------------------
  5878*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5879* EFFECTIVE    NUMBER
  5880*-----------------------------------------------------------------
  5881* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5882* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5883* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5884* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5885* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5886* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5887* 032306                   PEMA  ADD BOW LOAN NUMBER
  5888* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5889* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5890* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5891* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5892* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5893* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5894* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5895* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5896* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5897* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5898* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  5899******************************************************************
  5900
  5901 01  PENDING-BUSINESS.
  5902     12  PB-RECORD-ID                     PIC XX.
  5903         88  VALID-PB-ID                        VALUE 'PB'.
  5904
  5905     12  PB-CONTROL-PRIMARY.
  5906         16  PB-COMPANY-CD                PIC X.
  5907         16  PB-ENTRY-BATCH               PIC X(6).
  5908         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5909         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5910
  5911     12  PB-CONTROL-BY-ACCOUNT.
  5912         16  PB-COMPANY-CD-A1             PIC X.
  5913         16  PB-CARRIER                   PIC X.
  5914         16  PB-GROUPING.
  5915             20  PB-GROUPING-PREFIX       PIC XXX.
  5916             20  PB-GROUPING-PRIME        PIC XXX.
  5917         16  PB-STATE                     PIC XX.
  5918         16  PB-ACCOUNT.
  5919             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5920             20  PB-ACCOUNT-PRIME         PIC X(6).
  5921         16  PB-CERT-EFF-DT               PIC XX.
  5922         16  PB-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 111
* EL6311.cbl
  5923             20  PB-CERT-PRIME            PIC X(10).
  5924             20  PB-CERT-SFX              PIC X.
  5925         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5926
  5927         16  PB-RECORD-TYPE               PIC X.
  5928             88  PB-MAILING-DATA                VALUE '0'.
  5929             88  PB-ISSUE                       VALUE '1'.
  5930             88  PB-CANCELLATION                VALUE '2'.
  5931             88  PB-BATCH-TRAILER               VALUE '9'.
  5932
  5933     12  PB-CONTROL-BY-ORIG-BATCH.
  5934         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5935         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5936         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5937         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5938
  5939     12  PB-CONTROL-BY-CSR.
  5940         16  PB-CSR-COMPANY-CD            PIC X.
  5941         16  PB-CSR-ID                    PIC X(4).
  5942         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5943         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5944         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5945******************************************************************
  5946*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5947******************************************************************
  5948
  5949     12  PB-LAST-MAINT-DT                 PIC XX.
  5950     12  PB-LAST-MAINT-BY                 PIC X(4).
  5951     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5952
  5953     12  PB-RECORD-BODY                   PIC X(375).
  5954
  5955     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5956         16  PB-CERT-ORIGIN               PIC X.
  5957             88  CLASIC-CREATED-CERT         VALUE '1'.
  5958         16  PB-I-NAME.
  5959             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5960             20  PB-I-INSURED-FIRST-NAME.
  5961                 24  PB-I-INSURED-1ST-INIT PIC X.
  5962                 24  FILLER                PIC X(9).
  5963             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5964         16  PB-I-AGE                     PIC S99   COMP-3.
  5965         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5966         16  PB-I-BIRTHDAY                PIC XX.
  5967         16  PB-I-INSURED-SEX             PIC X.
  5968             88  PB-SEX-MALE     VALUE 'M'.
  5969             88  PB-SEX-FEMALE   VALUE 'F'.
  5970
  5971         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5972         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5973         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5974         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5975         16  PB-I-SKIP-CODE               PIC X.
  5976             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5977             88  PB-SKIP-JULY              VALUE '1'.
  5978             88  PB-SKIP-AUGUST            VALUE '2'.
  5979             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5980             88  PB-SKIP-JULY-AUG          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 112
* EL6311.cbl
  5981             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5982             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5983             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5984             88  PB-SKIP-JUNE              VALUE '8'.
  5985             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5986             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5987             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5988         16  PB-I-TERM-TYPE               PIC X.
  5989             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5990             88  PB-PAID-WEEKLY            VALUE 'W'.
  5991             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5992             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5993             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5994         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5995         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5996         16  PB-I-DATA-ENTRY-SW           PIC X.
  5997             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5998             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5999             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6000             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6001         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6002         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6003*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6004         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6005         16  FILLER                       PIC X.
  6006
  6007         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6008             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6009             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6010                                                   '90' THRU '99'.
  6011         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6012                                          PIC XX.
  6013         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6014         16  PB-I-AMOUNT-FINANCED REDEFINES
  6015                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6016         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6017         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6018                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6019         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6020         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6021         16  PB-I-CLP-AMOUNT REDEFINES
  6022                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6023         16  PB-I-LF-CALC-FLAG            PIC X.
  6024             88 PB-COMP-LF-PREM               VALUE '?'.
  6025         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6026         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6027         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6028         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6029         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6030         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6031         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6032         16  PB-I-LF-ABBR                 PIC XXX.
  6033         16  PB-I-LF-INPUT-CD             PIC XX.
  6034
  6035         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6036             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6037             88  PB-INVALID-AH               VALUE '  ' '00'
  6038                                                   '90' THRU '99'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 113
* EL6311.cbl
  6039         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6040         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6041         16  PB-I-AH-CALC-FLAG            PIC X.
  6042             88 PB-COMP-AH-PREM                  VALUE '?'.
  6043         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6044         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6045         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6046         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6047         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6048         16  PB-I-AH-ABBR                 PIC XXX.
  6049         16  PB-I-AH-INPUT-CD             PIC XXX.
  6050
  6051         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6052         16  PB-I-REIN-TABLE              PIC XXX.
  6053         16  PB-I-BUSINESS-TYPE           PIC 99.
  6054         16  PB-I-INDV-GRP-CD             PIC X.
  6055         16  PB-I-MORT-CODE.
  6056             20  PB-I-TABLE               PIC X.
  6057             20  PB-I-INTEREST            PIC XX.
  6058             20  PB-I-MORT-TYP            PIC X.
  6059         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6060         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6061         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6062         16  PB-I-INDV-GRP-OVRD           PIC X.
  6063         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6064         16  PB-I-SIG-SW                  PIC X.
  6065             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6066         16  PB-I-RATE-CLASS              PIC XX.
  6067         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6068         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6069         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6070         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6071         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6072         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6073         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6074         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6075         16  PB-I-OB-FLAG                 PIC X.
  6076             88  PB-I-OB                      VALUE 'B'.
  6077             88  PB-I-SUMMARY                 VALUE 'Z'.
  6078         16  PB-I-ENTRY-STATUS            PIC X.
  6079             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6080                                              'M' '5' '9' '2'.
  6081             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6082             88  PB-I-POLICY-PENDING          VALUE '2'.
  6083             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6084             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6085             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6086             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6087             88  PB-I-REIN-ONLY               VALUE '9'.
  6088             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6089             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6090             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6091             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6092         16  PB-I-INT-CODE                PIC X.
  6093             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6094             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6095         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6096         16  PB-I-SOC-SEC-NO              PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 114
* EL6311.cbl
  6097         16  PB-I-MEMBER-NO               PIC X(12).
  6098         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6099*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6100         16  PB-I-OLD-LOF                 PIC XXX.
  6101         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6102         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6103         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6104         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6105         16  PB-I-LIFE-INDICATOR          PIC X.
  6106             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6107         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6108         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6109                                          PIC S9(5)V99    COMP-3.
  6110         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6111             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6112             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6113         16  PB-I-1ST-PMT-DT              PIC XX.
  6114         16  PB-I-JOINT-INSURED.
  6115             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6116             20 PB-I-JOINT-FIRST-NAME.
  6117                24  PB-I-JOINT-FIRST-INIT PIC X.
  6118                24  FILLER                PIC X(9).
  6119             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6120*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6121         16  PB-I-BENEFICIARY-NAME.
  6122             20  PB-I-BANK-NUMBER         PIC X(10).
  6123             20  FILLER                   PIC X(15).
  6124         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6125         16  PB-I-REFERENCE               PIC X(12).
  6126         16  FILLER REDEFINES PB-I-REFERENCE.
  6127             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6128             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6129             20  PB-I-CLP-STATE           PIC XX.
  6130         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6131             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6132             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6133             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6134         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6135         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6136         16  PB-I-RESIDENT-STATE          PIC XX.
  6137         16  PB-I-RATE-CODE               PIC X(4).
  6138         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6139         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6140         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6141         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6142         16  PB-I-BANK-NOCHRGB            PIC 99.
  6143         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6144         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6145
  6146     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6147         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6148             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6149         16  PB-C-CANCEL-ORIGIN           PIC X.
  6150             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6151         16  PB-C-LF-CANCEL-DT            PIC XX.
  6152         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6153         16  PB-C-LF-CALC-REQ             PIC X.
  6154             88 PB-COMP-LF-CANCEL            VALUE '?'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 115
* EL6311.cbl
  6155         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6156         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6157         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6158             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6159         16  PB-C-AH-CANCEL-DT            PIC XX.
  6160         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6161         16  PB-C-AH-CALC-REQ             PIC X.
  6162             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6163         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6164         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6165         16  PB-C-LAST-NAME               PIC X(15).
  6166         16  PB-C-REFUND-SW               PIC X.
  6167             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6168             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6169         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6170         16  PB-C-PAYEE-CODE              PIC X(6).
  6171         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6172         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6173         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6174         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6175         16  PB-C-REFERENCE               PIC X(12).
  6176         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6177         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6178         16  PB-C-POST-CARD-IND           PIC X.
  6179         16  PB-C-CANCEL-REASON           PIC X.
  6180         16  PB-C-REF-INTERFACE-SW        PIC X.
  6181         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6182         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6183         16  FILLER                       PIC X(01).
  6184*        16  FILLER                       PIC X(18).
  6185         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6186*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6187         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6188         16  PB-CANCELED-CERT-DATA.
  6189             20  PB-CI-INSURED-NAME.
  6190                 24  PB-CI-LAST-NAME      PIC X(15).
  6191                 24  PB-CI-INITIALS       PIC XX.
  6192             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6193             20  PB-CI-INSURED-SEX        PIC X.
  6194             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6195             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6196             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6197             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6198             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6199             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6200             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6201             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6202             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6203             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6204             20  PB-CI-RATE-CLASS         PIC XX.
  6205             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6206             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6207             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6208             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6209             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6210             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6211             20  PB-CI-LF-ABBR            PIC X(3).
  6212             20  PB-CI-AH-ABBR            PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 116
* EL6311.cbl
  6213             20  PB-CI-OB-FLAG            PIC X.
  6214                 88  PB-CI-OB                VALUE 'B'.
  6215             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6216                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6217                                           'M' '4' '5' '9' '2'.
  6218                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6219                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6220                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6221                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6222                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6223                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6224                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6225                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6226                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6227                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6228                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6229                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6230                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6231             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6232                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6233                                           'M' '4' '5' '9' '2'.
  6234                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6235                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6236                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6237                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6238                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6239                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6240                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6241                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6242                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6243                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6244                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6245                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6246                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6247             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6248             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6249             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6250             20  PB-CI-MEMBER-NO          PIC X(12).
  6251             20  PB-CI-INT-CODE           PIC X.
  6252                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6253                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6254             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6255             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6256             20  PB-CI-COMP-EXCP-SW       PIC X.
  6257                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6258                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6259             20  PB-CI-ENTRY-STATUS       PIC X.
  6260             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6261             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6262             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6263             20  PB-CI-DEATH-DT           PIC XX.
  6264             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6265             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6266             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6267             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6268             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6269             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6270             20  PB-CI-ENTRY-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 117
* EL6311.cbl
  6271             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6272             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6273             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6274             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6275             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6276             20  PB-CI-OLD-LOF               PIC XXX.
  6277*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6278             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6279             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6280             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6281             20  PB-CI-INDV-GRP-CD           PIC X.
  6282             20  PB-CI-BENEFICIARY-NAME.
  6283                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6284                 24  FILLER                  PIC X(15).
  6285             20  PB-CI-NOTE-SW               PIC X.
  6286             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6287             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6288             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6289             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6290             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6291             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6292             20  PB-CI-FIRST-NAME            PIC X(10).
  6293             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6294
  6295         16  FILLER                       PIC X(13).
  6296*032306  16  FILLER                       PIC X(27).
  6297*        16  FILLER                       PIC X(46).
  6298
  6299     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6300         16  FILLER                       PIC X(10).
  6301         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6302         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6303         16  PB-M-INSURED-MID-INIT        PIC X.
  6304         16  PB-M-INSURED-AGE             PIC 99.
  6305         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6306         16  PB-M-INSURED-SEX             PIC X.
  6307         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6308         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6309         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6310         16  PB-M-INSURED-CITY-STATE.
  6311             20  PB-M-INSURED-CITY        PIC X(28).
  6312             20  PB-M-INSURED-STATE       PIC XX.
  6313         16  PB-M-INSURED-ZIP-CODE.
  6314             20  PB-M-INSURED-ZIP-PRIME.
  6315                 24  PB-M-INSURED-ZIP-1   PIC X.
  6316                     88  PB-M-CANADIAN-POST-CODE
  6317                                             VALUE 'A' THRU 'Z'.
  6318                 24  FILLER               PIC X(4).
  6319             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6320         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6321                                        PB-M-INSURED-ZIP-CODE.
  6322             20  PM-M-INS-CAN-POST1       PIC XXX.
  6323             20  PM-M-INS-CAN-POST2       PIC XXX.
  6324             20  FILLER                   PIC XXX.
  6325         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6326         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6327         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6328         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 118
* EL6311.cbl
  6329         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6330         16  PB-M-CRED-BENE-CITYST.
  6331             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6332             20  PB-M-CRED-BENE-STATE     PIC XX.
  6333         16  FILLER                       PIC X(92).
  6334
  6335     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6336         16  FILLER                       PIC X(10).
  6337         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6338         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6339         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6340         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6341         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6342         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6343         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6344         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6345         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6346         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6347         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6348         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6349         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6350         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6351         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6352         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6353         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6354         16  PB-ACCOUNT-NAME              PIC X(30).
  6355         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6356         16  PB-REFERENCE                 PIC X(12).
  6357         16  PB-B-RECEIVED-DT             PIC XX.
  6358         16  FILLER                       PIC X(234).
  6359
  6360     12  PB-RECORD-STATUS.
  6361         16  PB-CREDIT-SELECT-DT          PIC XX.
  6362         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6363         16  PB-BILLED-DT                 PIC XX.
  6364         16  PB-BILLING-STATUS            PIC X.
  6365             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6366             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6367             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6368         16  PB-RECORD-BILL               PIC X.
  6369             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6370             88  PB-RECORD-RETURNED           VALUE 'R'.
  6371             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6372             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6373             88  PB-OVERRIDE-AH               VALUE 'A'.
  6374             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6375         16  PB-BATCH-ENTRY               PIC X.
  6376             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6377             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6378             88  PB-REISSUED-CERT             VALUE 'E'.
  6379             88  PB-CASH-CERT                 VALUE 'C'.
  6380             88  PB-MONTHLY-CERT              VALUE 'M'.
  6381             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6382             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6383             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6384         16  PB-FORCE-CODE                PIC X.
  6385             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6386             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 119
* EL6311.cbl
  6387             88  PB-CANCEL-FORCE              VALUE '8'.
  6388             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6389             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6390             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6391             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6392             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6393             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6394             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6395             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6396         16  PB-FATAL-FLAG                PIC X.
  6397             88  PB-FATAL-ERRORS              VALUE 'X'.
  6398         16  PB-FORCE-ER-CD               PIC X.
  6399             88  PB-FORCE-ERRORS              VALUE 'F'.
  6400             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6401         16  PB-WARN-ER-CD                PIC X.
  6402             88  PB-WARNING-ERRORS            VALUE 'W'.
  6403         16  FILLER                       PIC X.
  6404         16  PB-OUT-BAL-CD                PIC X.
  6405             88  PB-OUT-OF-BAL                VALUE 'O'.
  6406         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6407         16  PB-AH-OVERRIDE-L1            PIC X.
  6408         16  PB-INPUT-DT                  PIC XX.
  6409         16  PB-INPUT-BY                  PIC X(4).
  6410         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6411         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6412         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6413         16  PB-LF-EARNING-METHOD         PIC X.
  6414         16  PB-AH-EARNING-METHOD         PIC X.
  6415         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6416         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6417         16  PB-REIN-CD                   PIC XXX.
  6418         16  PB-LF-REFUND-TYPE            PIC X.
  6419         16  PB-AH-REFUND-TYPE            PIC X.
  6420         16  PB-ACCT-EFF-DT               PIC XX.
  6421         16  PB-ACCT-EXP-DT               PIC XX.
  6422         16  PB-COMPANY-ID                PIC X(3).
  6423         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6424         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6425         16  PB-SV-CARRIER                PIC X.
  6426         16  PB-SV-GROUPING               PIC X(6).
  6427         16  PB-SV-STATE                  PIC XX.
  6428         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6429         16  PB-GA-BILLING-INFO.
  6430             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6431                                          PIC XX.
  6432         16  PB-SV-REMIT-TO  REDEFINES
  6433             PB-GA-BILLING-INFO           PIC X(10).
  6434         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6435         16  PB-I-LOAN-OFFICER            PIC X(5).
  6436         16  PB-I-VIN                     PIC X(17).
  6437
  6438         16  FILLER                       PIC X(04).
  6439         16  IMNET-BYPASS-SW              PIC X.
  6440
  6441******************************************************************
  6442*                COMMON EDIT ERRORS                              *
  6443******************************************************************
  6444
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 120
* EL6311.cbl
  6445     12  PB-COMMON-ERRORS.
  6446         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6447                                           PIC S9(4)     COMP.
  6448
  6449******************************************************************
  6450*                                COPY ELCCERT.
  6451******************************************************************
  6452*                                                                *
  6453*                            ELCCERT.                            *
  6454*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6455*                            VMOD=2.013                          *
  6456*                                                                *
  6457*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6458*                                                                *
  6459*   FILE TYPE = VSAM,KSDS                                        *
  6460*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6461*                                                                *
  6462*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6463*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6464*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6465*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6466*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6467*                                                                *
  6468*   LOG = YES                                                    *
  6469*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6470******************************************************************
  6471*                   C H A N G E   L O G
  6472*
  6473* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6474*-----------------------------------------------------------------
  6475*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6476* EFFECTIVE    NUMBER
  6477*-----------------------------------------------------------------
  6478* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6479* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6480* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6481* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6482* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6483* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6484* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6485* 032612  CR2011110200001  PEMA  AHL CHANGES
  6486* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6487* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6488******************************************************************
  6489
  6490 01  CERTIFICATE-MASTER.
  6491     12  CM-RECORD-ID                      PIC XX.
  6492         88  VALID-CM-ID                      VALUE 'CM'.
  6493
  6494     12  CM-CONTROL-PRIMARY.
  6495         16  CM-COMPANY-CD                 PIC X.
  6496         16  CM-CARRIER                    PIC X.
  6497         16  CM-GROUPING.
  6498             20  CM-GROUPING-PREFIX        PIC X(3).
  6499             20  CM-GROUPING-PRIME         PIC X(3).
  6500         16  CM-STATE                      PIC XX.
  6501         16  CM-ACCOUNT.
  6502             20  CM-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 121
* EL6311.cbl
  6503             20  CM-ACCOUNT-PRIME          PIC X(6).
  6504         16  CM-CERT-EFF-DT                PIC XX.
  6505         16  CM-CERT-NO.
  6506             20  CM-CERT-PRIME             PIC X(10).
  6507             20  CM-CERT-SFX               PIC X.
  6508
  6509     12  CM-CONTROL-BY-NAME.
  6510         16  CM-COMPANY-CD-A1              PIC X.
  6511         16  CM-INSURED-LAST-NAME          PIC X(15).
  6512         16  CM-INSURED-INITIALS.
  6513             20  CM-INSURED-INITIAL1       PIC X.
  6514             20  CM-INSURED-INITIAL2       PIC X.
  6515
  6516     12  CM-CONTROL-BY-SSN.
  6517         16  CM-COMPANY-CD-A2              PIC X.
  6518         16  CM-SOC-SEC-NO.
  6519             20  CM-SSN-STATE              PIC XX.
  6520             20  CM-SSN-ACCOUNT            PIC X(6).
  6521             20  CM-SSN-LN3.
  6522                 25  CM-INSURED-INITIALS-A2.
  6523                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6524                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6525                 25 CM-PART-LAST-NAME-A2         PIC X.
  6526
  6527     12  CM-CONTROL-BY-CERT-NO.
  6528         16  CM-COMPANY-CD-A4              PIC X.
  6529         16  CM-CERT-NO-A4                 PIC X(11).
  6530
  6531     12  CM-CONTROL-BY-MEMB.
  6532         16  CM-COMPANY-CD-A5              PIC X.
  6533         16  CM-MEMBER-NO.
  6534             20  CM-MEMB-STATE             PIC XX.
  6535             20  CM-MEMB-ACCOUNT           PIC X(6).
  6536             20  CM-MEMB-LN4.
  6537                 25  CM-INSURED-INITIALS-A5.
  6538                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6539                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6540                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6541
  6542     12  CM-INSURED-PROFILE-DATA.
  6543         16  CM-INSURED-FIRST-NAME.
  6544             20  CM-INSURED-1ST-INIT       PIC X.
  6545             20  FILLER                    PIC X(9).
  6546         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6547         16  CM-INSURED-SEX                PIC X.
  6548             88  CM-SEX-MALE                  VALUE 'M'.
  6549             88  CM-SEX-FEMAL                 VALUE 'F'.
  6550         16  CM-INSURED-JOINT-AGE          PIC 99.
  6551         16  CM-JOINT-INSURED-NAME.
  6552             20  CM-JT-LAST-NAME           PIC X(15).
  6553             20  CM-JT-FIRST-NAME.
  6554                 24  CM-JT-1ST-INIT        PIC X.
  6555                 24  FILLER                PIC X(9).
  6556             20  CM-JT-INITIAL             PIC X.
  6557
  6558     12  CM-LIFE-DATA.
  6559         16  CM-LF-BENEFIT-CD              PIC XX.
  6560         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 122
* EL6311.cbl
  6561         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6562         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6563         16  CM-LF-DEV-CODE                PIC XXX.
  6564         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6565         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6566         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6567         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6568         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6569         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6570         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6571         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6572         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6573         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6574         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6575         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6576         16  cm-temp-epiq                  pic xx.
  6577             88  EPIQ-CLASS                  value 'EQ'.
  6578*        16  FILLER                        PIC XX.
  6579
  6580     12  CM-AH-DATA.
  6581         16  CM-AH-BENEFIT-CD              PIC XX.
  6582         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6583         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6584         16  CM-AH-DEV-CODE                PIC XXX.
  6585         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6586         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6587         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6588         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6589         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6590         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6591         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6592         16  CM-AH-PAID-THRU-DT            PIC XX.
  6593             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6594         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6595         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6596         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6597         16  FILLER                        PIC X.
  6598
  6599     12  CM-LOAN-INFORMATION.
  6600         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6601         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6602                                           PIC S9(5)V99  COMP-3.
  6603         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6604         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6605         16  CM-PAY-FREQUENCY              PIC S99.
  6606         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6607         16  CM-RATE-CLASS                 PIC XX.
  6608         16  CM-BENEFICIARY                PIC X(25).
  6609         16  CM-POLICY-FORM-NO             PIC X(12).
  6610         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6611         16  CM-LAST-ADD-ON-DT             PIC XX.
  6612         16  CM-DEDUCTIBLE-AMOUNTS.
  6613             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6614             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6615         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6616             20  CM-RESIDENT-STATE         PIC XX.
  6617             20  CM-RATE-CODE              PIC X(4).
  6618             20  FILLER                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 123
* EL6311.cbl
  6619         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6620             20  CM-LOAN-OFFICER           PIC X(5).
  6621             20  FILLER                    PIC XXX.
  6622         16  CM-CSR-CODE                   PIC XXX.
  6623         16  CM-UNDERWRITING-CODE          PIC X.
  6624             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6625         16  CM-POST-CARD-IND              PIC X.
  6626         16  CM-NH-INTERFACE-SW            PIC X.
  6627         16  CM-PREMIUM-TYPE               PIC X.
  6628             88  CM-SING-PRM                  VALUE '1'.
  6629             88  CM-O-B-COVERAGE              VALUE '2'.
  6630             88  CM-OPEN-END                  VALUE '3'.
  6631         16  CM-IND-GRP-TYPE               PIC X.
  6632             88  CM-INDIVIDUAL                VALUE 'I'.
  6633             88  CM-GROUP                     VALUE 'G'.
  6634         16  CM-SKIP-CODE                  PIC X.
  6635             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6636             88  SKIP-JULY                    VALUE '1'.
  6637             88  SKIP-AUGUST                  VALUE '2'.
  6638             88  SKIP-SEPTEMBER               VALUE '3'.
  6639             88  SKIP-JULY-AUG                VALUE '4'.
  6640             88  SKIP-AUG-SEPT                VALUE '5'.
  6641             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6642             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6643             88  SKIP-JUNE                    VALUE '8'.
  6644             88  SKIP-JUNE-JULY               VALUE '9'.
  6645             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6646             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6647         16  CM-PAYMENT-MODE               PIC X.
  6648             88  PAY-MONTHLY                  VALUE SPACE.
  6649             88  PAY-WEEKLY                   VALUE '1'.
  6650             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6651             88  PAY-BI-WEEKLY                VALUE '3'.
  6652             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6653         16  CM-LOAN-NUMBER                PIC X(8).
  6654         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6655         16  CM-OLD-LOF                    PIC XXX.
  6656*        16  CM-LOAN-OFFICER               PIC XXX.
  6657         16  CM-REIN-TABLE                 PIC XXX.
  6658         16  CM-SPECIAL-REIN-CODE          PIC X.
  6659         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6660         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6661         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6662
  6663     12  CM-STATUS-DATA.
  6664         16  CM-ENTRY-STATUS               PIC X.
  6665         16  CM-ENTRY-DT                   PIC XX.
  6666
  6667         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6668         16  CM-LF-CANCEL-DT               PIC XX.
  6669         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6670
  6671         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6672         16  CM-LF-DEATH-DT                PIC XX.
  6673         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6674
  6675         16  CM-LF-CURRENT-STATUS          PIC X.
  6676             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 124
* EL6311.cbl
  6677                                                'M' '4' '5' '9'.
  6678             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6679             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6680             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6681             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6682             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6683             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6684             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6685             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6686             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6687             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6688             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6689             88  CM-LF-DECLINED               VALUE 'D'.
  6690             88  CM-LF-VOIDED                 VALUE 'V'.
  6691
  6692         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6693         16  CM-AH-CANCEL-DT               PIC XX.
  6694         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6695
  6696         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6697         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6698         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6699
  6700         16  CM-AH-CURRENT-STATUS          PIC X.
  6701             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6702                                                'M' '4' '5' '9'.
  6703             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6704             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6705             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6706             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6707             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6708             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6709             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6710             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6711             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6712             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6713             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6714             88  CM-AH-DECLINED               VALUE 'D'.
  6715             88  CM-AH-VOIDED                 VALUE 'V'.
  6716
  6717         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6718             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6719             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6720             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6721         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6722
  6723         16  CM-ENTRY-BATCH                PIC X(6).
  6724         16  CM-LF-EXIT-BATCH              PIC X(6).
  6725         16  CM-AH-EXIT-BATCH              PIC X(6).
  6726         16  CM-LAST-MONTH-END             PIC XX.
  6727
  6728     12  CM-NOTE-SW                        PIC X.
  6729         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6730         88  CERT-NOTES-PRESENT               VALUE '1'.
  6731         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6732         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6733         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6734         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 125
* EL6311.cbl
  6735         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6736         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6737     12  CM-COMP-EXCP-SW                   PIC X.
  6738         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6739         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6740     12  CM-INSURED-ADDRESS-SW             PIC X.
  6741         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6742         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6743
  6744*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6745     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6746     12  FILLER                            PIC X.
  6747
  6748*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6749     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6750     12  FILLER                            PIC X.
  6751*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6752     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6753
  6754     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6755         88  CERT-ADDED-BATCH                 VALUE ' '.
  6756         88  CERT-ADDED-ONLINE                VALUE '1'.
  6757         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6758         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6759         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6760     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6761         88  CERT-AS-LOADED                   VALUE ' '.
  6762         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6763         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6764         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6765         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6766         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6767         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6768         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6769
  6770     12  CM-ACCOUNT-COMM-PCTS.
  6771         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6772         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6773
  6774     12  CM-USER-FIELD                     PIC X.
  6775     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6776     12  CM-CLP-STATE                      PIC XX.
  6777     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6778     12  CM-USER-RESERVED                  PIC XXX.
  6779     12  FILLER REDEFINES CM-USER-RESERVED.
  6780         16  CM-AH-CLASS-CD                PIC XX.
  6781         16  F                             PIC X.
  6782******************************************************************
  6783*                                COPY ERCNOTE.
  6784******************************************************************
  6785*                                                                *
  6786*                                                                *
  6787*                            ERCNOTE                             *
  6788*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6789*                            VMOD=2.003                          *
  6790*                                                                *
  6791*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6792*                                                                *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 126
* EL6311.cbl
  6793*        FILE TYPE= VSAM,KSDS                                    *
  6794*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6795*                                                                *
  6796*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6797*                                                                *
  6798*        LOG = YES                                               *
  6799*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6800*                                                                *
  6801******************************************************************
  6802*                   C H A N G E   L O G
  6803*
  6804* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6805*-----------------------------------------------------------------
  6806*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6807* EFFECTIVE    NUMBER
  6808*-----------------------------------------------------------------
  6809* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6810*                                FILE WILL CONTAIN BILLING NOTES O
  6811******************************************************************
  6812
  6813 01  CERTIFICATE-NOTE.
  6814     12  CN-RECORD-ID                PIC  XX.
  6815         88  VALID-CN-ID                  VALUE 'CN'.
  6816
  6817     12  CN-CONTROL-PRIMARY.
  6818         16  CN-COMPANY-CD           PIC X.
  6819         16  CN-CARRIER              PIC X.
  6820         16  CN-GROUPING.
  6821             20 CN-GROUPING-PREFIX   PIC XXX.
  6822             20 CN-GROUPING-PRIME    PIC XXX.
  6823         16  CN-STATE                PIC XX.
  6824         16  CN-ACCOUNT.
  6825             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6826             20 CN-ACCOUNT-PRIME     PIC X(6).
  6827         16  CN-CERT-EFF-DT          PIC XX.
  6828         16  CN-CERT-NO.
  6829             20  CN-CERT-PRIME       PIC X(10).
  6830             20  CN-CERT-SFX         PIC X.
  6831
  6832     12  CN-BILLING-START-LINE-NO    PIC 99.
  6833     12  CN-BILLING-END-LINE-NO      PIC 99.
  6834
  6835     12  CN-LINES.
  6836         16  CN-LINE OCCURS 10       PIC X(77).
  6837
  6838     12  CN-LAST-MAINT-DT            PIC XX.
  6839     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6840     12  CN-LAST-MAINT-USER          PIC X(4).
  6841     12  FILLER                      PIC X(6).
  6842******************************************************************
  6843*                                COPY ERCPNDM.
  6844******************************************************************
  6845*                                                                *
  6846*                                                                *
  6847*                            ERCPNDM                             *
  6848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6849*                            VMOD=2.003                          *
  6850*                                                                *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 127
* EL6311.cbl
  6851*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6852*                                                                *
  6853*   FILE TYPE = VSAM,KSDS                                        *
  6854*   RECORD SIZE = 374   RECFORM = FIX                            *
  6855*                                                                *
  6856*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6857*   ALTERNATE PATH    = NOT USED                                 *
  6858*                                                                *
  6859*   LOG = YES                                                    *
  6860*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6861******************************************************************
  6862*                   C H A N G E   L O G
  6863*
  6864* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6865*-----------------------------------------------------------------
  6866*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6867* EFFECTIVE    NUMBER
  6868*-----------------------------------------------------------------
  6869* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6870* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6871* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6872******************************************************************
  6873
  6874 01  PENDING-MAILING-DATA.
  6875     12  PM-RECORD-ID                      PIC XX.
  6876         88  VALID-MA-ID                       VALUE 'PM'.
  6877
  6878     12  PM-CONTROL-PRIMARY.
  6879         16  PM-COMPANY-CD                 PIC X.
  6880         16  PM-ENTRY-BATCH                PIC X(6).
  6881         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6882         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6883
  6884     12  FILLER                            PIC X(14).
  6885
  6886     12  PM-ACCESS-CONTROL.
  6887         16  PM-SOURCE-SYSTEM              PIC XX.
  6888             88  PM-FROM-CREDIT                VALUE 'CR'.
  6889             88  PM-FROM-VSI                   VALUE 'VS'.
  6890             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6891             88  PM-FROM-OTHER                 VALUE 'OT'.
  6892         16  PM-RECORD-ADD-DT              PIC XX.
  6893         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6894         16  PM-LAST-MAINT-DT              PIC XX.
  6895         16  PM-LAST-MAINT-BY              PIC XXXX.
  6896         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6897
  6898     12  PM-PROFILE-INFO.
  6899         16  PM-QUALIFY-CODE-1             PIC XX.
  6900         16  PM-QUALIFY-CODE-2             PIC XX.
  6901         16  PM-QUALIFY-CODE-3             PIC XX.
  6902         16  PM-QUALIFY-CODE-4             PIC XX.
  6903         16  PM-QUALIFY-CODE-5             PIC XX.
  6904
  6905         16  PM-INSURED-LAST-NAME          PIC X(15).
  6906         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6907         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6908         16  PM-INSURED-ISSUE-AGE          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 128
* EL6311.cbl
  6909         16  PM-INSURED-BIRTH-DT           PIC XX.
  6910         16  PM-INSURED-SEX                PIC X.
  6911             88  PM-SEX-MALE                   VALUE 'M'.
  6912             88  PM-SEX-FEMALE                 VALUE 'F'.
  6913         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6914
  6915         16  PM-ADDRESS-CORRECTED          PIC X.
  6916         16  PM-JOINT-BIRTH-DT             PIC XX.
  6917*        16  FILLER                        PIC X(12).
  6918
  6919         16  PM-ADDRESS-LINE-1             PIC X(30).
  6920         16  PM-ADDRESS-LINE-2             PIC X(30).
  6921         16  PM-CITY-STATE.
  6922             20  PM-CITY                   PIC X(28).
  6923             20  PM-STATE                  PIC XX.
  6924         16  PM-ZIP.
  6925             20  PM-ZIP-CODE.
  6926                 24  PM-ZIP-1              PIC X.
  6927                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6928                 24  FILLER                PIC X(4).
  6929             20  PM-ZIP-PLUS4              PIC X(4).
  6930         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6931             20  PM-CAN-POST1              PIC XXX.
  6932             20  PM-CAN-POST2              PIC XXX.
  6933             20  FILLER                    PIC XXX.
  6934
  6935         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6936
  6937         16  FILLER                        PIC X(03).
  6938
  6939     12  PM-CRED-BENE-INFO.
  6940         16  PM-CRED-BENE-NAME             PIC X(25).
  6941         16  PM-CRED-BENE-ADDR             PIC X(30).
  6942         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6943         16  PM-CRED-BENE-CTYST.
  6944             20  PM-CRED-BENE-CITY         PIC X(28).
  6945             20  PM-CRED-BENE-STATE        PIC XX.
  6946         16  PM-CRED-BENE-ZIP.
  6947             20  PM-CB-ZIP-CODE.
  6948                 24  PM-CB-ZIP-1           PIC X.
  6949                     88  PM-CB-CANADIAN-POST-CODE
  6950                                  VALUE 'A' THRU 'Z'.
  6951                 24  FILLER                PIC X(4).
  6952             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6953         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6954             20  PM-CB-CAN-POST1           PIC XXX.
  6955             20  PM-CB-CAN-POST2           PIC XXX.
  6956             20  FILLER                    PIC XXX.
  6957     12  PM-POST-CARD-MAIL-DATA.
  6958         16  PM-MAIL-DATA OCCURS 7.
  6959             20  PM-MAIL-TYPE              PIC X.
  6960                 88  PM-12MO-MAILING           VALUE '1'.
  6961                 88  PM-EXP-MAILING            VALUE '2'.
  6962             20  PM-MAIL-STATUS            PIC X.
  6963                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6964                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6965                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6966             20  PM-MAIL-DATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 129
* EL6311.cbl
  6967     12  FILLER                            PIC XX.
  6968     12  FILLER                            PIC X(12).
  6969*    12  FILLER                            PIC X(30).
  6970
  6971******************************************************************
  6972*                                COPY ERCMAIL.
  6973******************************************************************
  6974*                                                                *
  6975*                                                                *
  6976*                            ERCMAIL                             *
  6977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6978*                            VMOD=2.003                          *
  6979*                                                                *
  6980*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6981*                                                                *
  6982*   FILE TYPE = VSAM,KSDS                                        *
  6983*   RECORD SIZE = 374   RECFORM = FIX                            *
  6984*                                                                *
  6985*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6986*   ALTERNATE PATH    = NOT USED                                 *
  6987*                                                                *
  6988*   LOG = YES                                                    *
  6989*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6990******************************************************************
  6991*                   C H A N G E   L O G
  6992*
  6993* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6994*-----------------------------------------------------------------
  6995*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6996* EFFECTIVE    NUMBER
  6997*-----------------------------------------------------------------
  6998* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6999* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7000* 111108                   PEMA  ADD CRED BENE ADDR2
  7001******************************************************************
  7002
  7003 01  MAILING-DATA.
  7004     12  MA-RECORD-ID                      PIC XX.
  7005         88  VALID-MA-ID                       VALUE 'MA'.
  7006
  7007     12  MA-CONTROL-PRIMARY.
  7008         16  MA-COMPANY-CD                 PIC X.
  7009         16  MA-CARRIER                    PIC X.
  7010         16  MA-GROUPING.
  7011             20  MA-GROUPING-PREFIX        PIC XXX.
  7012             20  MA-GROUPING-PRIME         PIC XXX.
  7013         16  MA-STATE                      PIC XX.
  7014         16  MA-ACCOUNT.
  7015             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7016             20  MA-ACCOUNT-PRIME          PIC X(6).
  7017         16  MA-CERT-EFF-DT                PIC XX.
  7018         16  MA-CERT-NO.
  7019             20  MA-CERT-PRIME             PIC X(10).
  7020             20  MA-CERT-SFX               PIC X.
  7021
  7022     12  FILLER                            PIC XX.
  7023
  7024     12  MA-ACCESS-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 130
* EL6311.cbl
  7025         16  MA-SOURCE-SYSTEM              PIC XX.
  7026             88  MA-FROM-CREDIT                VALUE 'CR'.
  7027             88  MA-FROM-VSI                   VALUE 'VS'.
  7028             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7029             88  MA-FROM-OTHER                 VALUE 'OT'.
  7030         16  MA-RECORD-ADD-DT              PIC XX.
  7031         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7032         16  MA-LAST-MAINT-DT              PIC XX.
  7033         16  MA-LAST-MAINT-BY              PIC XXXX.
  7034         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7035
  7036     12  MA-PROFILE-INFO.
  7037         16  MA-QUALIFY-CODE-1             PIC XX.
  7038         16  MA-QUALIFY-CODE-2             PIC XX.
  7039         16  MA-QUALIFY-CODE-3             PIC XX.
  7040         16  MA-QUALIFY-CODE-4             PIC XX.
  7041         16  MA-QUALIFY-CODE-5             PIC XX.
  7042
  7043         16  MA-INSURED-LAST-NAME          PIC X(15).
  7044         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7045         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7046         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7047         16  MA-INSURED-BIRTH-DT           PIC XX.
  7048         16  MA-INSURED-SEX                PIC X.
  7049             88  MA-SEX-MALE                   VALUE 'M'.
  7050             88  MA-SEX-FEMALE                 VALUE 'F'.
  7051         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7052
  7053         16  MA-ADDRESS-CORRECTED          PIC X.
  7054         16  MA-JOINT-BIRTH-DT             PIC XX.
  7055*        16  FILLER                        PIC X(12).
  7056
  7057         16  MA-ADDRESS-LINE-1             PIC X(30).
  7058         16  MA-ADDRESS-LINE-2             PIC X(30).
  7059         16  MA-CITY-STATE.
  7060             20  MA-CITY                   PIC X(28).
  7061             20  MA-ADDR-STATE             PIC XX.
  7062         16  MA-ZIP.
  7063             20  MA-ZIP-CODE.
  7064                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7065                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7066                 24  FILLER                PIC X(4).
  7067             20  MA-ZIP-PLUS4              PIC X(4).
  7068         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7069             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7070             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7071             20  FILLER                    PIC X(3).
  7072
  7073         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7074
  7075         16  FILLER                        PIC XXX.
  7076*        16  FILLER                        PIC X(10).
  7077
  7078     12  MA-CRED-BENE-INFO.
  7079         16  MA-CRED-BENE-NAME                 PIC X(25).
  7080         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7081         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7082         16  MA-CRED-BENE-CTYST.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 131
* EL6311.cbl
  7083             20  MA-CRED-BENE-CITY             PIC X(28).
  7084             20  MA-CRED-BENE-STATE            PIC XX.
  7085         16  MA-CRED-BENE-ZIP.
  7086             20  MA-CB-ZIP-CODE.
  7087                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7088                     88  MA-CB-CANADIAN-POST-CODE
  7089                                           VALUE 'A' THRU 'Z'.
  7090                 24  FILLER                    PIC X(4).
  7091             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7092         16  MA-CB-CANADIAN-POSTAL-CODE
  7093                            REDEFINES MA-CRED-BENE-ZIP.
  7094             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7095             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7096             20  FILLER                        PIC X(3).
  7097     12  MA-POST-CARD-MAIL-DATA.
  7098         16  MA-MAIL-DATA OCCURS 7.
  7099             20  MA-MAIL-TYPE              PIC X.
  7100                 88  MA-12MO-MAILING           VALUE '1'.
  7101                 88  MA-EXP-MAILING            VALUE '2'.
  7102             20  MA-MAIL-STATUS            PIC X.
  7103                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7104                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7105                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7106             20  MA-MAIL-DATE              PIC XX.
  7107     12  FILLER                            PIC XX.
  7108     12  FILLER                            PIC XX.
  7109*    12  FILLER                            PIC X(30).
  7110******************************************************************
  7111*                                COPY ERCRQST.
  7112******************************************************************
  7113*                                                                *
  7114*                                                                *
  7115*                            ERCRQST.                            *
  7116*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7117*                            VMOD=2.002                          *
  7118*                                                                *
  7119*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7120*                                                                *
  7121*   FILE TYPE = VSAM,KSDS                                        *
  7122*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7123*                                                                *
  7124*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7125*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7126*                                   ACCOUNT, REF, BATCH)         *
  7127*                                                RKP=9, LEN=38   *
  7128*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7129*                                   ACCOUNT, REF, BATCH)         *
  7130*                                                RKP=47, LEN=46  *
  7131*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7132*                                   BATCH)                       *
  7133*                                                RKP=93, LEN=24  *
  7134*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7135*                                   REF, BATCH)                  *
  7136*                                                RKP=117, LEN=35 *
  7137*   LOG = NO                                                     *
  7138*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7139******************************************************************
  7140
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 132
* EL6311.cbl
  7141 01  AR-REQUEST-RECORD.
  7142     12  RQ-RECORD-ID                     PIC XX.
  7143         88  VALID-RQ-ID                        VALUE 'RQ'.
  7144
  7145     12  RQ-CONTROL-PRIMARY.
  7146         16  RQ-COMPANY-CD                PIC X.
  7147         16  RQ-ENTRY-BATCH               PIC X(6).
  7148
  7149     12  RQ-CONTROL-BY-ACCT-REF.
  7150         16  RQ-COMPANY-CD-A1             PIC X.
  7151         16  RQ-CARRIER-A1                PIC X.
  7152         16  RQ-GROUPING-A1               PIC X(6).
  7153         16  RQ-STATE-A1                  PIC XX.
  7154         16  RQ-ACCOUNT-A1                PIC X(10).
  7155         16  RQ-REFERENCE-A1              PIC X(12).
  7156         16  RQ-BATCH-A1                  PIC X(6).
  7157
  7158     12  RQ-CONTROL-BY-FIN-RESP.
  7159         16  RQ-COMPANY-CD-A2             PIC X.
  7160         16  RQ-CARRIER-A2                PIC X.
  7161         16  RQ-GROUPING-A2               PIC X(6).
  7162         16  RQ-FIN-RESP-A2               PIC X(10).
  7163         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7164         16  RQ-REFERENCE-A2              PIC X(12).
  7165         16  RQ-BATCH-A2                  PIC X(6).
  7166
  7167     12  RQ-CONTROL-BY-ACCT-AGENT.
  7168         16  RQ-COMPANY-CD-A3             PIC X.
  7169         16  RQ-CARRIER-A3                PIC X.
  7170         16  RQ-GROUPING-A3               PIC X(6).
  7171         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7172         16  RQ-BATCH-A3                  PIC X(6).
  7173
  7174     12  RQ-CONTROL-BY-SUMMARY.
  7175         16  RQ-COMPANY-CD-A4             PIC X.
  7176         16  RQ-SUMMARY-CODE              PIC X(6).
  7177         16  RQ-ACCOUNT-A4                PIC X(10).
  7178         16  RQ-REFERENCE-A4              PIC X(12).
  7179         16  RQ-BATCH-A4                  PIC X(6).
  7180
  7181     12  RQ-REQUEST-METHOD                PIC X.
  7182         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7183         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7184         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7185         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7186     12  FILLER                           PIC X.
  7187     12  RQ-STATUS                        PIC X.
  7188         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7189         88  RQ-RESUBMIT                      VALUE 'R'.
  7190     12  RQ-PROCESSOR-ID                  PIC X(4).
  7191     12  RQ-ENTRY-DT                      PIC XX.
  7192     12  RQ-MO-END-DT                     PIC XX.
  7193     12  RQ-REQUEST-DT                    PIC XX.
  7194     12  RQ-STMT-DT                       PIC XX.
  7195     12  RQ-REVERSAL-DT                   PIC XX.
  7196     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7197     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7198
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 133
* EL6311.cbl
  7199     12  FILLER                           PIC X(27).
  7200
  7201******************************************************************
  7202
  7203*                                COPY ERCLOFC.
  7204******************************************************************
  7205*                                                                *
  7206*                                                                *
  7207*                            ERCLOFC                             *
  7208*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7209*                            VMOD=2.003                          *
  7210*                                                                *
  7211*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7212*                                                                *
  7213*   FILE TYPE = VSAM,KSDS                                        *
  7214*   RECORD SIZE = 670   RECFORM = FIX                            *
  7215*                                                                *
  7216*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7217*                                                                *
  7218*   LOG = YES                                                    *
  7219*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7220*                                                                *
  7221******************************************************************
  7222
  7223 01  LOAN-OFFICER-MASTER.
  7224     12  LO-RECORD-ID                PIC XX.
  7225         88  VALID-LO-ID                VALUE 'LO'.
  7226
  7227     12  LO-CONTROL-PRIMARY.
  7228         16  LO-COMPANY-CD           PIC X.
  7229         16  LO-CARRIER              PIC X.
  7230         16  LO-GROUPING.
  7231             20  LO-GROUPING-PREFIX  PIC XXX.
  7232             20  LO-GROUPING-PRIME   PIC XXX.
  7233         16  LO-STATE                PIC XX.
  7234         16  LO-ACCOUNT.
  7235             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7236             20  LO-ACCOUNT-PRIME    PIC X(6).
  7237         16  LO-OFFICER-CODE         PIC X(5).
  7238
  7239     12  LO-OFFICER-NAME             PIC X(30).
  7240
  7241     12  LO-LAST-MAINT-DT            PIC XX.
  7242     12  LO-LAST-USER                PIC X(4).
  7243     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7244
  7245     12  LO-COMP-CONTROL             PIC X.
  7246             88  LO-SHOW-COMP           VALUE 'Y'.
  7247             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7248     12  LO-DETAIL-CONTROL           PIC X.
  7249             88  LO-PRINT-DETAIL        VALUE 'D'.
  7250             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7251
  7252     12  LO-SV-CARRIER               PIC X.
  7253     12  LO-SV-GROUPING              PIC X(6).
  7254     12  LO-SV-STATE                 PIC XX.
  7255
  7256     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 134
* EL6311.cbl
  7257     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7258
  7259     12  LO-OFFICER-INFO.
  7260         16  FILLER OCCURS 12 TIMES.
  7261             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7262             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7263             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7264             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7265             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7266             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7267             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7268             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7269     12  FILLER                      PIC X(198).
  7270******************************************************************
  7271*                                COPY ERCPYAJ.
  7272******************************************************************
  7273*                                                                *
  7274*                            ERCPYAJ                             *
  7275*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7276*                            VMOD=2.015                          *
  7277*                                                                *
  7278*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7279*                                                                *
  7280*                                                                *
  7281*   FILE TYPE = VSAM,KSDS                                        *
  7282*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7283*                                                                *
  7284*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7285*       ALTERNATE PATHS = NONE                                   *
  7286*                                                                *
  7287*   LOG = YES                                                    *
  7288*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7289******************************************************************
  7290******************************************************************
  7291*                   C H A N G E   L O G
  7292*
  7293* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7294*-----------------------------------------------------------------
  7295*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7296* EFFECTIVE    NUMBER
  7297*-----------------------------------------------------------------
  7298* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7299* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7300******************************************************************
  7301
  7302 01  PENDING-PAY-ADJ.
  7303     12  PY-RECORD-ID                     PIC XX.
  7304         88  VALID-PY-ID                        VALUE 'PY'.
  7305
  7306     12  PY-CONTROL-PRIMARY.
  7307         16  PY-COMPANY-CD                PIC X.
  7308         16  PY-CARRIER                   PIC X.
  7309         16  PY-GROUPING                  PIC X(6).
  7310         16  PY-FIN-RESP                  PIC X(10).
  7311         16  PY-ACCOUNT                   PIC X(10).
  7312         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7313                                          PIC X(10).
  7314         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 135
* EL6311.cbl
  7315         16  PY-RECORD-TYPE               PIC X.
  7316             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7317             88  PY-DEPOSIT                   VALUE 'D'.
  7318             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7319             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7320             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7321             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7322             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7323             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7324             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7325             88  PY-FICA-ENTRY                VALUE 'F'.
  7326             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7327             88  PY-POLICY-FEE                VALUE 'W'.
  7328             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7329
  7330     12  PY-PYMT-TYPE                     PIC X.
  7331             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7332             88  PY-REINS-PYMT                VALUE 'R'.
  7333             88  PY-EXP-PYMT                  VALUE 'E'.
  7334
  7335     12  PY-BIL-INV                       PIC X(6).
  7336     12  PY-REF-NO                        PIC X(12).
  7337
  7338     12  PY-LAST-MAINT-DT                 PIC XX.
  7339     12  PY-LAST-MAINT-BY                 PIC X(4).
  7340     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7341
  7342     12  PY-PYADJ-RECORD.
  7343         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7344         16  PY-ENTRY-COMMENT             PIC X(30).
  7345         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7346             20  PY-GL-ACCOUNT            PIC X(10).
  7347             20  PY-GL-STATE              PIC X(02).
  7348             20  PY-GL-CANC-SW            PIC X(01).
  7349                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7350                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7351             20  PY-GL-COMMENT            PIC X(10).
  7352             20  FILLER      REDEFINES PY-GL-COMMENT.
  7353                 24  PY-GL-CHECK-NO       PIC 9(06).
  7354                 24  FILLER               PIC X(04).
  7355             20  FILLER                   PIC X(07).
  7356         16  PY-SAVE-ACCOUNT              PIC X(10).
  7357         16  PY-SAVE-TYPE                 PIC X(01).
  7358
  7359         16  PY-LETTERS.
  7360             20  PY-LETTER OCCURS 3 TIMES
  7361                           INDEXED BY PY-LET-NDX
  7362                                          PIC X(04).
  7363
  7364         16  PY-ERCOMP-TYPE               PIC X.
  7365             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7366             88  PY-GA-TYPE                   VALUE 'G'.
  7367             88  PY-BANK-TYPE                 VALUE 'B'.
  7368         16  FILLER                       PIC X(05).
  7369
  7370     12  PY-RECORD-STATUS.
  7371         16  PY-CREDIT-SELECT-DT          PIC XX.
  7372         16  PY-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 136
* EL6311.cbl
  7373         16  PY-BILLED-DATE               PIC XX.
  7374         16  PY-REPORTED-DT               PIC XX.
  7375         16  PY-PMT-APPLIED               PIC X.
  7376             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7377             88  PY-GA-PMT                    VALUE 'G'.
  7378             88  PY-OVWRITE-PMT               VALUE 'O'.
  7379             88  PY-NON-AR-PMT                VALUE 'N'.
  7380         16  FILLER                       PIC X(5).
  7381         16  PY-INPUT-DT                  PIC XX.
  7382         16  PY-CHECK-NUMBER              PIC X(6).
  7383         16  PY-VOID-SW                   PIC X.
  7384             88  PY-CHECK-VOIDED              VALUE 'V'.
  7385         16  PY-CHECK-ORIGIN-SW           PIC X.
  7386             88  PY-BILLING-CHECK             VALUE 'B'.
  7387             88  PY-REFUND-CHECK              VALUE 'R'.
  7388             88  PY-GA-CHECK                  VALUE 'G'.
  7389             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7390             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7391         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7392         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7393         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7394         16  PY-BILL-FLAG                 PIC X.
  7395             88  PY-BILLED                    VALUE 'B'.
  7396         16  PY-AR-FLAG                   PIC X.
  7397             88  PY-AR-CYCLE                  VALUE 'C'.
  7398             88  PY-AR-MONTH-END              VALUE 'M'.
  7399         16  PY-AR-DATE                   PIC XX.
  7400
  7401     12  PY-GL-CODES.
  7402         16  PY-GL-DB                     PIC X(14).
  7403         16  PY-GL-CR                     PIC X(14).
  7404         16  PY-GL-FLAG                   PIC X.
  7405         16  PY-GL-DATE                   PIC XX.
  7406
  7407     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7408     12  FILLER                           PIC X(3).
  7409******************************************************************
  7410*                                COPY ERCCNOT.
  7411******************************************************************
  7412*                                                                *
  7413*                            ERCCNOT                             *
  7414*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7415*                            VMOD=2.003                          *
  7416*                                                                *
  7417*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7418*                                                                *
  7419*        FILE TYPE= VSAM,KSDS                                    *
  7420*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7421*                                                                *
  7422*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7423*                                                                *
  7424*        LOG = YES                                               *
  7425*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7426*                                                                *
  7427******************************************************************
  7428*                   C H A N G E   L O G
  7429*
  7430* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 137
* EL6311.cbl
  7431*-----------------------------------------------------------------
  7432*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7433* EFFECTIVE    NUMBER
  7434*-----------------------------------------------------------------
  7435* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7436******************************************************************
  7437
  7438 01  CERT-NOTE-FILE.
  7439     12  CZ-RECORD-ID                PIC  XX.
  7440         88  VALID-CZ-ID                  VALUE 'CZ'.
  7441
  7442     12  CZ-CONTROL-PRIMARY.
  7443         16  CZ-COMPANY-CD           PIC X.
  7444         16  CZ-CARRIER              PIC X.
  7445         16  CZ-GROUPING.
  7446             20 CZ-GROUPING-PREFIX   PIC XXX.
  7447             20 CZ-GROUPING-PRIME    PIC XXX.
  7448         16  CZ-STATE                PIC XX.
  7449         16  CZ-ACCOUNT.
  7450             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7451             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7452         16  CZ-CERT-EFF-DT          PIC XX.
  7453         16  CZ-CERT-NO.
  7454             20  CZ-CERT-PRIME       PIC X(10).
  7455             20  CZ-CERT-SFX         PIC X.
  7456         16  CZ-RECORD-TYPE          PIC X.
  7457             88  CERT-NOTE           VALUE '1'.
  7458             88  CLAIM-CERT-NOTE     VALUE '2'.
  7459         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7460
  7461     12  CZ-LAST-MAINT-DT            PIC XX.
  7462     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7463     12  CZ-LAST-MAINT-USER          PIC X(4).
  7464
  7465     12  CZ-NOTE-INFORMATION.
  7466         16  CZ-NOTE                 PIC X(63).
  7467         16  FILLER                  PIC X(39).
  7468******************************************************************
  7469*                                COPY ELCMSTR.
  7470******************************************************************
  7471*                                                                *
  7472*                            ELCMSTR.                            *
  7473*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7474*                            VMOD=2.012                          *
  7475*                                                                *
  7476*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7477*                                                                *
  7478*   FILE TYPE = VSAM,KSDS                                        *
  7479*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7480*                                                                *
  7481*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7482*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7483*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7484*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7485*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7486*                                                 RKP=75,LEN=21  *
  7487*                                                                *
  7488*   **** NOTE ****                                               *
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 138
* EL6311.cbl
  7489*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7490*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7491*                                                                *
  7492*   LOG = YES                                                    *
  7493*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7494******************************************************************
  7495*                   C H A N G E   L O G
  7496*
  7497* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7498*-----------------------------------------------------------------
  7499*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7500* EFFECTIVE    NUMBER
  7501*-----------------------------------------------------------------
  7502* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7503* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7504* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7505* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7506* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7507******************************************************************
  7508 01  CLAIM-MASTER.
  7509     12  CL-RECORD-ID                PIC XX.
  7510         88  VALID-CL-ID         VALUE 'CL'.
  7511
  7512     12  CL-CONTROL-PRIMARY.
  7513         16  CL-COMPANY-CD           PIC X.
  7514         16  CL-CARRIER              PIC X.
  7515         16  CL-CLAIM-NO             PIC X(7).
  7516         16  CL-CERT-NO.
  7517             20  CL-CERT-PRIME       PIC X(10).
  7518             20  CL-CERT-SFX         PIC X.
  7519
  7520     12  CL-CONTROL-BY-NAME.
  7521         16  CL-COMPANY-CD-A1        PIC X.
  7522         16  CL-INSURED-LAST-NAME    PIC X(15).
  7523         16  CL-INSURED-NAME.
  7524             20  CL-INSURED-1ST-NAME PIC X(12).
  7525             20  CL-INSURED-MID-INIT PIC X.
  7526
  7527     12  CL-CONTROL-BY-SSN.
  7528         16  CL-COMPANY-CD-A2        PIC X.
  7529         16  CL-SOC-SEC-NO.
  7530             20  CL-SSN-STATE        PIC XX.
  7531             20  CL-SSN-ACCOUNT      PIC X(6).
  7532             20  CL-SSN-LN3          PIC X(3).
  7533
  7534     12  CL-CONTROL-BY-CERT-NO.
  7535         16  CL-COMPANY-CD-A4        PIC X.
  7536         16  CL-CERT-NO-A4.
  7537             20  CL-CERT-A4-PRIME    PIC X(10).
  7538             20  CL-CERT-A4-SFX      PIC X.
  7539
  7540     12  CL-CONTROL-BY-CCN.
  7541         16  CL-COMPANY-CD-A5        PIC X.
  7542         16  CL-CCN-A5.
  7543             20  CL-CCN.
  7544                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7545                 24  CL-CCN-PRIME-A5 PIC X(12).
  7546             20  CL-CCN-FILLER-A5    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 139
* EL6311.cbl
  7547
  7548     12  CL-INSURED-PROFILE-DATA.
  7549         16  CL-INSURED-BIRTH-DT     PIC XX.
  7550         16  CL-INSURED-SEX-CD       PIC X.
  7551             88  INSURED-IS-MALE        VALUE 'M'.
  7552             88  INSURED-IS-FEMALE      VALUE 'F'.
  7553             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7554         16  CL-INSURED-OCC-CD       PIC X(6).
  7555         16  FILLER                  PIC X(5).
  7556
  7557     12  CL-PROCESSING-INFO.
  7558         16  CL-PROCESSOR-ID         PIC X(4).
  7559         16  CL-CLAIM-STATUS         PIC X.
  7560             88  CLAIM-IS-OPEN          VALUE 'O'.
  7561             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7562         16  CL-CLAIM-TYPE           PIC X.
  7563*            88  AH-CLAIM               VALUE 'A'.
  7564*            88  LIFE-CLAIM             VALUE 'L'.
  7565*            88  PROPERTY-CLAIM         VALUE 'P'.
  7566*            88  IUI-CLAIM              VALUE 'I'.
  7567*            88  GAP-CLAIM              VALUE 'G'.
  7568*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7569         16  CL-CLAIM-PREM-TYPE      PIC X.
  7570             88  SINGLE-PREMIUM         VALUE '1'.
  7571             88  O-B-COVERAGE           VALUE '2'.
  7572             88  OPEN-END-COVERAGE      VALUE '3'.
  7573         16  CL-INCURRED-DT          PIC XX.
  7574         16  CL-REPORTED-DT          PIC XX.
  7575         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7576         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7577         16  CL-LAST-PMT-DT          PIC XX.
  7578         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7579         16  CL-PAID-THRU-DT         PIC XX.
  7580         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7581         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7582         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7583         16  CL-PMT-CALC-METHOD      PIC X.
  7584             88  CL-360-DAY-YR          VALUE '1'.
  7585             88  CL-365-DAY-YR          VALUE '2'.
  7586             88  CL-FULL-MONTHS         VALUE '3'.
  7587         16  CL-CAUSE-CD             PIC X(6).
  7588
  7589         16  CL-PRIME-CERT-NO.
  7590             20  CL-PRIME-CERT-PRIME PIC X(10).
  7591             20  CL-PRIME-CERT-SFX   PIC X.
  7592
  7593         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7594             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7595             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7596
  7597         16  CL-MICROFILM-NO         PIC X(10).
  7598         16  FILLER REDEFINES CL-MICROFILM-NO.
  7599             20  CL-BENEFIT-PERIOD   PIC 99.
  7600             20  FILLER              PIC X(8).
  7601         16  CL-PROG-FORM-TYPE       PIC X.
  7602         16  CL-LAST-ADD-ON-DT       PIC XX.
  7603
  7604         16  CL-LAST-REOPEN-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 140
* EL6311.cbl
  7605         16  CL-LAST-CLOSE-DT        PIC XX.
  7606         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7607             88  FINAL-PAID             VALUE '1'.
  7608             88  CLAIM-DENIED           VALUE '2'.
  7609             88  AUTO-CLOSE             VALUE '3'.
  7610             88  MANUAL-CLOSE           VALUE '4'.
  7611             88  BENEFITS-CHANGED       VALUE 'C'.
  7612             88  SETUP-ERRORS           VALUE 'E'.
  7613         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7614         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7615         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7616             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7617         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7618         16  FILLER                  PIC X.
  7619
  7620     12  CL-CERTIFICATE-DATA.
  7621         16  CL-CERT-ORIGIN          PIC X.
  7622             88  CERT-WAS-ONLINE        VALUE '1'.
  7623             88  CERT-WAS-CREATED       VALUE '2'.
  7624             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7625         16  CL-CERT-KEY-DATA.
  7626             20  CL-CERT-CARRIER     PIC X.
  7627             20  CL-CERT-GROUPING    PIC X(6).
  7628             20  CL-CERT-STATE       PIC XX.
  7629             20  CL-CERT-ACCOUNT.
  7630                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7631                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7632             20  CL-CERT-EFF-DT      PIC XX.
  7633
  7634     12  CL-STATUS-CONTROLS.
  7635         16  CL-PRIORITY-CD          PIC X.
  7636             88  CONFIDENTIAL-DATA      VALUE '8'.
  7637             88  HIGHEST-PRIORITY       VALUE '9'.
  7638         16  CL-SUPV-ATTN-CD         PIC X.
  7639             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7640             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7641         16  CL-PURGED-DT            PIC XX.
  7642         16  CL-RESTORED-DT          PIC XX.
  7643         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7644         16  CL-NEXT-RESEND-DT       PIC XX.
  7645         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7646         16  CL-CRITICAL-PERIOD      PIC 99.
  7647*        16  FILLER                  PIC XX.
  7648         16  CL-LAST-MAINT-DT        PIC XX.
  7649         16  CL-LAST-MAINT-USER      PIC X(4).
  7650         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7651         16  CL-LAST-MAINT-TYPE      PIC X.
  7652             88  CLAIM-SET-UP           VALUE ' '.
  7653             88  PAYMENT-MADE           VALUE '1'.
  7654             88  LETTER-SENT            VALUE '2'.
  7655             88  MASTER-WAS-ALTERED     VALUE '3'.
  7656             88  MASTER-WAS-RESTORED    VALUE '4'.
  7657             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7658             88  FILE-CONVERTED         VALUE '6'.
  7659             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7660             88  ERROR-CORRECTION       VALUE 'E'.
  7661         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7662         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 141
* EL6311.cbl
  7663         16  CL-BENEFICIARY          PIC X(10).
  7664         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7665         16  CL-DENIAL-TYPE          PIC X.
  7666             88  CL-TYPE-DENIAL          VALUE '1'.
  7667             88  CL-TYPE-RESCISSION      VALUE '2'.
  7668             88  CL-TYPE-REFORMATION     VALUE '3'.
  7669             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7670             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7671         16  filler                  pic x(5).
  7672*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7673*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7674*        16  CL-RTW-DT               PIC XX.
  7675
  7676     12  CL-TRAILER-CONTROLS.
  7677         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7678             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7679             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7680             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7681         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7682         16  FILLER                  PIC XX.
  7683         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7684         16  CL-ADDRESS-TRAILER-CNT.
  7685             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7686                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7687             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7688                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7689             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7690                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7691             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7692                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7693             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7694                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7695             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7696                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7697             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7698                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7699
  7700     12  CL-CV-REFERENCE-NO.
  7701         16  CL-CV-REFNO-PRIME       PIC X(18).
  7702         16  CL-CV-REFNO-SFX         PIC XX.
  7703
  7704     12  CL-FILE-LOCATION            PIC X(4).
  7705
  7706     12  CL-PROCESS-ERRORS.
  7707         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7708             88  NO-FATAL-ERRORS        VALUE ZERO.
  7709         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7710             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7711
  7712     12  CL-PRODUCT-CD               PIC X.
  7713
  7714     12  CL-CURRENT-KEY-DATA.
  7715         16  CL-CURRENT-CARRIER      PIC X.
  7716         16  CL-CURRENT-GROUPING     PIC X(6).
  7717         16  CL-CURRENT-STATE        PIC XX.
  7718         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7719
  7720     12  CL-ASSOCIATES               PIC X.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 142
* EL6311.cbl
  7721         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7722         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7723         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7724         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7725
  7726     12  CL-ACTIVITY-CODE            PIC 99.
  7727     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7728     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7729
  7730     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7731     12  CL-LAG-REPORT-CODE          PIC 9.
  7732     12  CL-LOAN-TYPE                PIC XX.
  7733     12  CL-LEGAL-STATE              PIC XX.
  7734
  7735     12  CL-YESNOSW                  PIC X.
  7736     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7737         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7738         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7739         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7740     12  cl-insured-type             pic x.
  7741         88  cl-claim-on-primary         value 'P'.
  7742         88  cl-claim-on-co-borrower     value 'C'.
  7743     12  cl-benefit-expiration-dt    PIC XX.
  7744*                                COPY ERCENDT.
  7745******************************************************************
  7746*                                                                *
  7747*                                                                *
  7748*                            ERCENDT.                            *
  7749*                            VMOD=2.001                          *
  7750*                                                                *
  7751*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7752*                                                                *
  7753*   FILE TYPE = VSAM,KSDS                                        *
  7754*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7755*                                                                *
  7756*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7757*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7758*                                                                *
  7759*   LOG = NO                                                     *
  7760*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7761******************************************************************
  7762*-----------------------------------------------------------------
  7763*                   C H A N G E   L O G
  7764*
  7765* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7766*-----------------------------------------------------------------
  7767*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7768* EFFECTIVE    NUMBER
  7769*-----------------------------------------------------------------
  7770* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7771*                                WITH OPEN CLAIMS
  7772* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7773* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7774* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7775* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7776*-----------------------------------------------------------------
  7777 01  ENDORSEMENT-RECORD.
  7778     12  EN-RECORD-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 143
* EL6311.cbl
  7779         88  VALID-EN-ID                VALUE 'EN'.
  7780     12  EN-CONTROL-PRIMARY.
  7781         16  EN-COMPANY-CD           PIC X.
  7782         16  EN-CARRIER              PIC X.
  7783         16  EN-GROUPING             PIC X(6).
  7784         16  EN-STATE                PIC XX.
  7785         16  EN-ACCOUNT              PIC X(10).
  7786         16  EN-CERT-EFF-DT          PIC XX.
  7787         16  EN-CERT-NO.
  7788             20  EN-CERT-PRIME       PIC X(10).
  7789             20  EN-CERT-SFX         PIC X.
  7790         16  EN-REC-TYPE             PIC X.
  7791             88  EN-ISSUE               VALUE 'I'.
  7792             88  EN-CANCELLATION        VALUE 'C'.
  7793         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7794     12  EN-CONTROL-BY-ARCH-NO.
  7795         16  EN-COMPANY-CD-A1              PIC X.
  7796         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7797     12  EN-LAST-MAINT-DT            PIC XX.
  7798     12  EN-LAST-MAINT-BY            PIC X(4).
  7799     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7800     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7801     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7802         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7803         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7804         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7805         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7806         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7807         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7808         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7809         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7810         16  EN-LF-ORIG-BENCD        PIC XX.
  7811         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7812         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7813         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7814         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7815         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7816         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7817*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7818         16  EN-ORIG-CRED-BENE       PIC X(25).
  7819         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7820         16  FILLER                  PIC X.
  7821         16  EN-AH-ORIG-BENCD        PIC XX.
  7822         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7823         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7824         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7825         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7826*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7827*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7828         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7829         16  F                       PIC X(09).
  7830         16  EN-AH-ORIG-CP           PIC 99.
  7831         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7832         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7833         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7834         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7835         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7836         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 144
* EL6311.cbl
  7837         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7838         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7839         16  EN-LF-NEW-BENCD         PIC XX.
  7840         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7841         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7842         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7843         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7844         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7845         16  EN-LF-NEW-EXP-DT        PIC XX.
  7846         16  EN-NEW-CRED-BENE        PIC X(25).
  7847         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7848         16  FILLER                  PIC X.
  7849         16  EN-AH-NEW-BENCD         PIC XX.
  7850         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7851         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7852         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7853         16  EN-AH-NEW-EXP-DT        PIC XX.
  7854*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7855*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7856*        16  F                       PIC X(12).
  7857         16  EN-AH-NEW-CP            PIC 99.
  7858         16  EN-SIG-SW               PIC X.
  7859         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7860         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7861         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7862         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7863         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7864         16  FILLER                  PIC X(33).
  7865     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7866         16  EN-LF-ORIG-REF-DT       PIC XX.
  7867         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7868         16  EN-AH-ORIG-REF-DT       PIC XX.
  7869         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7870         16  EN-LF-NEW-REF-DT        PIC XX.
  7871         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7872         16  EN-AH-NEW-REF-DT        PIC XX.
  7873         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7874         16  EN-FLAG-CERT            PIC X.
  7875         16  EN-INS-LAST-NAME        PIC X(15).
  7876         16  EN-INS-FIRST-NAME       PIC X(10).
  7877         16  EN-INS-MIDDLE-INIT      PIC X.
  7878         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7879         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7880         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7881         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7882         16  FILLER                  PIC X(262).
  7883     12  EN-MONEY-SW             PIC X.
  7884     12  EN-HEALTH-APP           PIC X.
  7885     12  EN-VOUCHER-SW           PIC X.
  7886     12  EN-PAYEE                PIC X(14).
  7887     12  EN-INPUT-DT             PIC XX.
  7888     12  EN-PROCESS-DT           PIC XX.
  7889     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7890     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7891     12  EN-REASON-CODES.
  7892         16  F OCCURS 12.
  7893             20  EN-REASON-CODE  PIC X(4).
  7894     12  EN-TEMPLATE-USED        PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 145
* EL6311.cbl
  7895     12  EN-DOCU-TYPE            PIC X.
  7896         88  EN-VERI-DOCU          VALUE 'V'.
  7897         88  EN-GCE-DOCU           VALUE 'G'.
  7898         88  EN-CANC-DOCU          VALUE 'C'.
  7899     12  EN-COMMENTS1            PIC X(13).
  7900     12  EN-COMMENTS2            PIC X(70).
  7901     12  EN-COMM-CHGBK           PIC X.
  7902         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7903         88  EN-CHG-ACCT           VALUE 'Y'.
  7904     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7905     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7906     12  EN-BATCH-NUMBER         PIC X(6).
  7907     12  EN-ACCT-SUMM            PIC X.
  7908     12  EN-CSO-SUMM             PIC X.
  7909     12  en-check-type           pic x.
  7910     12  FILLER                  PIC X(12).
  7911******************************************************************
  7912*                                COPY ELCCRTT.
  7913******************************************************************
  7914*                                                                *
  7915*                            ELCCRTT.                            *
  7916*                                                                *
  7917*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7918*                                                                *
  7919*   FILE TYPE = VSAM,KSDS                                        *
  7920*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7921*                                                                *
  7922*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7923*                                                                *
  7924*   LOG = YES                                                    *
  7925*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7926******************************************************************
  7927*                   C H A N G E   L O G
  7928*
  7929* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7930*-----------------------------------------------------------------
  7931*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7932* EFFECTIVE    NUMBER
  7933*-----------------------------------------------------------------
  7934* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7935* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7936* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7937* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7938* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7939* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7940* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7941* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7942* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7943******************************************************************
  7944
  7945 01  CERTIFICATE-TRAILERS.
  7946     12  CS-RECORD-ID                      PIC XX.
  7947         88  VALID-CS-ID                      VALUE 'CS'.
  7948
  7949     12  CS-CONTROL-PRIMARY.
  7950         16  CS-COMPANY-CD                 PIC X.
  7951         16  CS-CARRIER                    PIC X.
  7952         16  CS-GROUPING                   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 146
* EL6311.cbl
  7953         16  CS-STATE                      PIC XX.
  7954         16  CS-ACCOUNT                    PIC X(10).
  7955         16  CS-CERT-EFF-DT                PIC XX.
  7956         16  CS-CERT-NO.
  7957             20  CS-CERT-PRIME             PIC X(10).
  7958             20  CS-CERT-SFX               PIC X.
  7959         16  CS-TRAILER-TYPE               PIC X.
  7960             88  COMM-TRLR           VALUE 'A'.
  7961             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7962             88  CERT-DATA-TRLR      VALUE 'C'.
  7963
  7964     12  CS-DATA-AREA                      PIC X(516).
  7965
  7966     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7967         16  CS-BANK-COMMISSION-AREA.
  7968             20  CS-BANK-COMMS       OCCURS 10.
  7969                 24  CS-AGT                PIC X(10).
  7970                 24  CS-COM-TYP            PIC X.
  7971                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7972                 24  CS-RECALC-LV-INDIC    PIC X.
  7973                 24  FILLER                PIC X(10).
  7974         16  FILLER                        PIC X(256).
  7975
  7976     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7977****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7978         16  CS-MB-CLAIM-DATA OCCURS 24.
  7979             20  CS-CLAIM-NO               PIC X(7).
  7980             20  CS-CLAIM-TYPE             PIC X.
  7981                 88  CS-AH-CLM               VALUE 'A'.
  7982                 88  CS-IU-CLM               VALUE 'I'.
  7983                 88  CS-GP-CLM               VALUE 'G'.
  7984                 88  CS-LF-CLM               VALUE 'L'.
  7985                 88  CS-PR-CLM               VALUE 'P'.
  7986                 88  CS-FL-CLM               VALUE 'F'.
  7987             20  CS-INSURED-TYPE           PIC X.
  7988                 88  CS-PRIM-INSURED          VALUE 'P'.
  7989                 88  CS-CO-BORROWER           VALUE 'C'.
  7990             20  CS-BENEFIT-PERIOD         PIC 99.
  7991             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7992             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7993             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7994         16  FILLER                        PIC X(12).
  7995     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7996         16  CS-VIN-NUMBER                 PIC X(17).
  7997         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7998         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7999         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8000         16  cs-agent-name.
  8001             20  cs-agent-fname            pic x(20).
  8002             20  cs-agent-mi               pic x.
  8003             20  cs-agent-lname            pic x(25).
  8004         16  cs-license-no                 pic x(15).
  8005         16  cs-npn-number                 pic x(10).
  8006         16  cs-agent-edit-status          pic x.
  8007             88  cs-ae-refer-to-manager      value 'M'.
  8008             88  cs-ae-cover-sheet           value 'C'.
  8009             88  cs-ae-sig-form              value 'S'.
  8010             88  cs-ae-verified              value 'V'.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 147
* EL6311.cbl
  8011             88  cs-unidentified-signature   value 'U'.
  8012             88  cs-cert-returned            value 'R'.
  8013             88  cs-accept-no-commission     value 'N'.
  8014         16  cs-year                       pic 9999.
  8015         16  cs-make                       pic x(20).
  8016         16  cs-model                      pic x(20).
  8017         16  cs-future                     pic x(20).
  8018         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8019         16  FILLER                        PIC X(356). *> was 420
  8020*        16  FILLER                        PIC X(496).
  8021*                                COPY ERCCHEK.
  8022******************************************************************
  8023*                                                                *
  8024*                                                                *
  8025*                            ERCCHEK                             *
  8026*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8027*                            VMOD=2.008                          *
  8028*                                                                *
  8029*   FILE DESCRIPTION = CHECK RECORDS                             *
  8030*                                                                *
  8031*   FILE TYPE = VSAM,KSDS                                        *
  8032*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8033*                                                                *
  8034*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8035*       ALTERNATE INDEX = NONE                                   *
  8036*                                                                *
  8037*   LOG = YES                                                    *
  8038*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8039******************************************************************
  8040*                   C H A N G E   L O G
  8041*
  8042* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8043*-----------------------------------------------------------------
  8044*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8045* EFFECTIVE    NUMBER
  8046*-----------------------------------------------------------------
  8047* 021414    2003053000001  PEMA  changes for auto chk request
  8048******************************************************************
  8049 01  CHECK-RECORDS.
  8050     12  CH-RECORD-ID                      PIC XX.
  8051         88  VALID-CH-ID                      VALUE 'CH'.
  8052
  8053     12  CH-CONTROL-PRIMARY.
  8054         16  CH-COMPANY-CD                 PIC X.
  8055         16  CH-CARRIER                    PIC X.
  8056         16  CH-GROUPING                   PIC X(6).
  8057         16  CH-STATE                      PIC XX.
  8058         16  CH-ACCOUNT                    PIC X(10).
  8059         16  CH-CERT-EFF-DT                PIC XX.
  8060         16  CH-CERT-NO.
  8061             20  CH-CERT-PRIME             PIC X(10).
  8062             20  CH-CERT-SFX               PIC X.
  8063         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8064
  8065     12  CH-RECORDED-DT                    PIC XX.
  8066     12  CH-RECORDED-BY                    PIC X(4).
  8067     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8068
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 148
* EL6311.cbl
  8069     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8070     12  CH-CHECK-NO                       PIC X(7).
  8071     12  CH-REASON-FOR-CHECK               PIC X(25).
  8072     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8073     12  FILLER                            PIC X.
  8074
  8075     12  CH-PAYEE-INFO.
  8076         16  CH-PAYEE-NAME-1               PIC X(30).
  8077         16  CH-PAYEE-NAME-2               PIC X(30).
  8078         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8079         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8080         16  CH-PAYEE-CITY-ST.
  8081             20  CH-PAYEE-CITY             PIC X(28).
  8082             20  CH-PAYEE-STATE            PIC XX.
  8083         16  CH-PAYEE-ZIP-CODE.
  8084             20  CH-PAYEE-ZIP.
  8085                 24  CH-ZIP-PRI-1ST        PIC X.
  8086                     88  CH-CANADIAN-POST-CODE
  8087                                           VALUES 'A' THRU 'Z'.
  8088                 24  FILLER                PIC X(4).
  8089             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8090         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8091             20  CH-CAN-POSTAL-1           PIC XXX.
  8092             20  CH-CAN-POSTAL-2           PIC XXX.
  8093             20  FILLER                    PIC XXX.
  8094
  8095     12  CH-CHECK-STUB-TEXT.
  8096         16  CH-STUB-LINE-1                PIC X(30).
  8097         16  CH-TEXT-LINE-1                PIC X(50).
  8098         16  CH-TEXT-LINE-2                PIC X(50).
  8099         16  CH-TEXT-LINE-3                PIC X(40).
  8100     12  CH-RETURN-TO                      PIC X(30).
  8101
  8102     12  CH-COMPENSATION-CONTROL.
  8103         16  CH-COMP-CARRIER               PIC X.
  8104         16  CH-COMP-GROUPING              PIC X(6).
  8105         16  CH-COMP-FIN-RESP              PIC X(10).
  8106         16  CH-COMP-ACCOUNT               PIC X(10).
  8107
  8108     12  CH-CREDIT-SELECT-DT               PIC XX.
  8109     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8110     12  CH-PAYEE-CODE                     PIC X(6).
  8111
  8112     12  CH-VOID-DATA.
  8113         20  CH-VOID-DT                    PIC XX.
  8114         20  CH-VOID-BY                    PIC X(4).
  8115         20  CH-VOID-REASON                PIC X(25).
  8116
  8117     12  CH-APPROVAL-DATA.
  8118         20  CH-APPROVAL-DT                PIC XX.
  8119         20  CH-APPROVAL-STATUS            PIC X.
  8120             88  CH-IN-LIMBO                  VALUE ' '.
  8121             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8122             88  CH-APPROVED                  VALUE 'A'.
  8123             88  CH-DENIED                    VALUE 'D'.
  8124         20  CH-APPROVED-BY                PIC XXXX.
  8125     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8126             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 149
* EL6311.cbl
  8127     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8128
  8129     12  ch-released-dt                    pic xx.
  8130     12  ch-check-cashed-dt                pic xx.
  8131     12  FILLER                            PIC X.
  8132*    12  CH-CHECK-REFERENCE                PIC X(12).
  8133     12  CH-CHECK-ORIGIN-SW                PIC X.
  8134             88  CH-REFUND-CHECK              VALUE 'R'.
  8135             88  CH-MAINT-CHECK               VALUE 'M'.
  8136
  8137     12  CH-CANC-DT                        PIC XX.
  8138     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8139     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8140
  8141     12  CH-INSURED-NAME                   PIC X(28).
  8142
  8143     12  ch-released-by                    pic x(4).
  8144     12  ch-csr                            pic x(4).
  8145     12  ch-deduct-commission              pic x.
  8146         88  ch-deduct-comm                  value 'Y'.
  8147         88  ch-do-not-deduct-comm           value 'N'.
  8148
  8149     12  FILLER                            PIC X(11).
  8150*    12  CH-LETTER-TABLE.
  8151*        16  CH-LETTERS OCCURS 3 TIMES
  8152*                       INDEXED BY CH-LT-NDX
  8153*                                          PIC X(04).
  8154
  8155     12  FILLER                            PIC X(07).
  8156
  8157 01  var                         pic x(30).
  8158 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8159                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8160                          PENDING-MAILING-DATA MAILING-DATA
  8161                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8162                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8163                          CLAIM-MASTER ENDORSEMENT-RECORD
  8164                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8165                          VAR.
  8166 0000-DFHEXIT SECTION.
  8167     MOVE '9#                    $   ' TO DFHEIV0.
  8168     MOVE 'EL6311' TO DFHEIV1.
  8169     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8170
  8171     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8172     MOVE EIBTRMID               TO QID-TERM.
  8173     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8174     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8175     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8176     MOVE 2                      TO EMI-SWITCH2.
  8177
  8178     move spaces to ws-kix-myenv
  8179     set P to address of KIXSYS
  8180     CALL "getenv" using by value P returning var-ptr
  8181     if var-ptr = null then
  8182        display ' kixsys not set '
  8183     else
  8184        set address of var to var-ptr
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 150
* EL6311.cbl
  8185        move 0 to env-var-len
  8186        inspect var tallying env-var-len
  8187          for characters before X'00'
  8188        unstring var (1:env-var-len) delimited by '/'
  8189           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8190              WS-KIX-SYS
  8191        end-unstring
  8192     end-if
  8193     perform varying a1 from +1 by +1 until a1 > +10
  8194        if ws-kix-myenv (a1:1) = low-values or high-values
  8195           display ' found low or hi val '
  8196           move spaces to ws-kix-myenv (a1:1)
  8197        end-if
  8198     end-perform
  8199*    display ' env *' ws-kix-myenv '*'
  8200     IF EIBCALEN = 0
  8201         GO TO 8800-UNAUTHORIZED-ACCESS.
  8202
  8203     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8204     MOVE '5'                   TO DC-OPTION-CODE.
  8205     PERFORM 9700-DATE-LINK.
  8206     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8207     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8208
  8209     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8210     MOVE SPACE                  TO DC-OPTION-CODE.
  8211     PERFORM 9700-DATE-LINK.
  8212     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8213     MOVE LOW-VALUES             TO EL631BI.
  8214
  8215
  8216* EXEC CICS HANDLE CONDITION
  8217*        PGMIDERR  (9600-PGMID-ERROR)
  8218*        ERROR     (9990-ABEND)
  8219*        INVREQ    (9990-ABEND)
  8220*        QIDERR    (0010-MAIN-LOGIC)
  8221*    END-EXEC.
  8222*    MOVE '"$L.8N                ! " #00008211' TO DFHEIV0
  8223     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8224     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8225     MOVE X'2220233030303038323131' TO DFHEIV0(25:11)
  8226     CALL 'kxdfhei1' USING DFHEIV0
  8227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8228
  8229
  8230     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8231         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8232             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8233             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8234             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8235             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8236             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8237             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8238             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8239             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8240
  8241             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8242                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 151
* EL6311.cbl
  8243
  8244             ELSE
  8245                 NEXT SENTENCE
  8246
  8247         ELSE
  8248             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8249             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8250             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8251             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8252             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8253             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8254             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8255             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8256             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8257             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8258             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8259             GO TO 3900-RE-DISPLAY-RECORD
  8260     ELSE
  8261         GO TO 0020-MAIN-LOGIC.
  8262
  8263 0010-MAIN-LOGIC.
  8264     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8265                                    WS-FIRST-ENTRY-SW.
  8266
  8267     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8268
  8269     MOVE LOW-VALUES             TO EC-NEW-CERT
  8270                                    EC-NEW-STATE.
  8271
  8272     IF PI-DISPLAY-ORIGINAL-BATCH
  8273         NEXT SENTENCE
  8274     ELSE
  8275         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8276             GO TO 5000-BROWSE-BATCH-HEADERS.
  8277
  8278     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8279         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8280
  8281     IF PI-CSR-BROWSE
  8282        GO TO 4200-BROWSE-CSR-FORWARD.
  8283
  8284     IF PI-FILE-BROWSE
  8285         GO TO 4300-BROWSE-FILE-FORWARD.
  8286
  8287     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8288
  8289 0020-MAIN-LOGIC.
  8290     IF EIBAID = DFHCLEAR
  8291         GO TO 9400-CLEAR.
  8292
  8293     MOVE LOW-VALUES             TO EC-NEW-CERT
  8294                                    EC-NEW-STATE.
  8295
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 152
* EL6311.cbl
  8297
  8298******************************************************************
  8299*                                                                *
  8300*              R E C E I V E   M A P                             *
  8301*                                                                *
  8302******************************************************************
  8303
  8304 0200-RECEIVE.
  8305     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8306         MOVE ER-0008            TO EMI-ERROR
  8307         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8308         IF PI-MAP-NAME = EL631B
  8309             MOVE -1                 TO BMAINTL
  8310             GO TO 8200-SEND-DATAONLY
  8311         ELSE
  8312             IF PI-MAP-NAME = EL631C
  8313                 MOVE -1                 TO CMAINTL
  8314                 GO TO 8200-SEND-DATAONLY
  8315             ELSE
  8316                 IF PI-MAP-NAME = EL631D
  8317                     MOVE -1                 TO DPFENTRL
  8318                     GO TO 8200-SEND-DATAONLY.
  8319
  8320
  8321* EXEC CICS RECEIVE
  8322*        MAP      (PI-MAP-NAME)
  8323*        MAPSET   (MAPSET-EL6311S)
  8324*        INTO     (EL631BI)
  8325*    END-EXEC.
  8326     MOVE LENGTH OF
  8327      EL631BI
  8328       TO DFHEIV11
  8329*    MOVE '8"T I  L              ''   #00008308' TO DFHEIV0
  8330     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8331     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8332     MOVE X'2020233030303038333038' TO DFHEIV0(25:11)
  8333     CALL 'kxdfhei1' USING DFHEIV0,
  8334           PI-MAP-NAME,
  8335           EL631BI,
  8336           DFHEIV11,
  8337           MAPSET-EL6311S,
  8338           DFHEIV99,
  8339           DFHEIV99
  8340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8341
  8342
  8343******************************************************************
  8344*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8345******************************************************************
  8346
  8347     IF BTYPE-LEN (1) EQUAL +3
  8348        IF BTYPE (1) EQUAL ALL ' '
  8349            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8350
  8351     IF BTYPE-LEN (2) EQUAL +3
  8352        IF BTYPE (2) EQUAL ALL ' '
  8353            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8354
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 153
* EL6311.cbl
  8355     INSPECT EL631BI CONVERTING '_' TO ' '.
  8356
  8357     IF PI-MAP-NAME = EL631B
  8358         IF BPFENTRL GREATER THAN ZEROS
  8359             IF EIBAID NOT = DFHENTER
  8360                 MOVE ER-0004       TO EMI-ERROR
  8361                 MOVE -1            TO BPFENTRL
  8362                 MOVE AL-UNBOF      TO BPFENTRA
  8363                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8364                 GO TO 8200-SEND-DATAONLY
  8365             ELSE
  8366                 IF BPFENTRI NUMERIC AND
  8367                   (BPFENTRI GREATER 0 AND LESS 25)
  8368                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8369                 ELSE
  8370                     MOVE ER-0029  TO EMI-ERROR
  8371                     MOVE AL-UNBON TO BPFENTRA
  8372                     MOVE -1       TO BPFENTRL
  8373                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8374                     GO TO 8200-SEND-DATAONLY
  8375         ELSE
  8376             NEXT SENTENCE
  8377     ELSE
  8378         IF PI-MAP-NAME = EL631C
  8379            IF CPFENTRL GREATER THAN ZEROS
  8380                IF EIBAID NOT = DFHENTER
  8381                 MOVE ER-0004         TO EMI-ERROR
  8382                 MOVE -1              TO CPFENTRL
  8383                 MOVE AL-UNBOF        TO CPFENTRA
  8384                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8385                 GO TO 8200-SEND-DATAONLY
  8386             ELSE
  8387                 IF CPFENTRI NUMERIC AND
  8388                   (CPFENTRI GREATER 0 AND LESS 25)
  8389                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8390                 ELSE
  8391                     MOVE ER-0029      TO EMI-ERROR
  8392                     MOVE AL-UNBON     TO CPFENTRA
  8393                     MOVE -1           TO CPFENTRL
  8394                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8395                     GO TO 8200-SEND-DATAONLY
  8396         ELSE
  8397             NEXT SENTENCE
  8398     ELSE
  8399     IF PI-MAP-NAME = EL631D
  8400         IF DPFENTRL GREATER THAN ZEROS
  8401             IF EIBAID NOT = DFHENTER
  8402                 MOVE ER-0004         TO EMI-ERROR
  8403                 MOVE -1              TO DPFENTRL
  8404                 MOVE AL-UNBOF        TO DPFENTRA
  8405                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8406                 GO TO 8200-SEND-DATAONLY
  8407             ELSE
  8408                 IF DPFENTRI NUMERIC AND
  8409                   (DPFENTRI GREATER 0 AND LESS 25)
  8410                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8411                 ELSE
  8412                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 154
* EL6311.cbl
  8413                     MOVE AL-UNBON     TO DPFENTRA
  8414                     MOVE -1           TO DPFENTRL
  8415                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8416                     GO TO 8200-SEND-DATAONLY.
  8417
  8418     IF EIBAID = DFHPF23
  8419         GO TO 8810-PF23.
  8420
  8421     IF EIBAID = DFHPF24
  8422         GO TO 9200-RETURN-MAIN-MENU.
  8423
  8424     IF EIBAID = DFHPF12
  8425         GO TO 9500-PF12.
  8426
  8427     IF PI-MAP-NAME = EL631B
  8428        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8429
  8430     IF PI-MAP-NAME = EL631C
  8431        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8432
  8433     IF PI-MAP-NAME = EL631D
  8434        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8435
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 155
* EL6311.cbl
  8437
  8438******************************************************************
  8439*                                                                *
  8440*      ISSUE SCREEN PF KEY CHECKING                              *
  8441*                                                                *
  8442******************************************************************
  8443
  8444******************************************************************
  8445*                                                                *
  8446*      PF KEY FUNCTIONS:                                         *
  8447*                                                                *
  8448*      PF1  = BROWSE FORWARD                                     *
  8449*      PF2  = BROWSE BACKWARD                                    *
  8450*      PF3  = CERTIFICATE LOOKUP                                 *
  8451*      PF4  = DISPLAY BATCH HEADER                               *
  8452*      PF5  = ADD ISSUE  SCREEN                                  *
  8453*      PF6  = ADD CANCEL SCREEN                                  *
  8454*      PF7  = CERTIFICATE DISPLAY                                *
  8455*      PF8  = CERTIFICATE NOTES                                  *
  8456*      PF9  = EDIT CONTROL                                       *
  8457*      PF10 = DISPLAY LETTER SCREEN                              *
  8458*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8459*      PF12 = HELP SCREEN                                        *
  8460*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8461*      PF14 = ACCOUNT MASTER                                     *
  8462*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8463*      PF16 = DISPLAY LETTER REVIEW                              *
  8464*                                                                *
  8465******************************************************************
  8466
  8467 0300-CHECK-ISSUE-PF-KEYS.
  8468     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8469        MOVE ER-2337            TO EMI-ERROR
  8470        MOVE -1                  TO BMAINTL
  8471        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8472        GO TO 8200-SEND-DATAONLY.
  8473
  8474     IF EIBAID = DFHPF1
  8475        MOVE '0'                TO PI-EDIT-SW
  8476        IF PI-PRIMARY-BROWSE
  8477           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8478        ELSE
  8479           IF PI-PRIMARY-WITH-SELECT
  8480              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8481           ELSE
  8482              IF PI-FILE-BROWSE
  8483                 GO TO 4300-BROWSE-FILE-FORWARD
  8484              ELSE
  8485                 IF PI-CSR-BROWSE
  8486                    GO TO 4200-BROWSE-CSR-FORWARD
  8487                 ELSE
  8488                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8489
  8490     IF EIBAID = DFHPF2
  8491        MOVE '0'                TO PI-EDIT-SW
  8492        IF PI-PRIMARY-BROWSE
  8493           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8494        ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 156
* EL6311.cbl
  8495           IF PI-PRIMARY-WITH-SELECT
  8496              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8497           ELSE
  8498              IF PI-FILE-BROWSE
  8499                 GO TO 4800-BROWSE-FILE-BACKWARD
  8500              ELSE
  8501                 IF PI-CSR-BROWSE
  8502                    GO TO 4900-BROWSE-CSR-BACKWARD
  8503                 ELSE
  8504                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8505
  8506     IF EIBAID = DFHPF3
  8507        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8508        MOVE XCTL-EL127         TO PGM-NAME
  8509        GO TO 9300-XCTL.
  8510
  8511     IF (EIBAID = DFHPF15 OR DFHPF6)
  8512        AND (CSR-EDIT-SESSION)
  8513*       AND (FATAL-OR-UNFORCED)
  8514        AND (FATAL-ERRORS)
  8515        MOVE ER-1819             TO EMI-ERROR
  8516        MOVE -1                  TO BMAINTL
  8517        MOVE AL-UANON            TO BMAINTA
  8518        PERFORM 9900-ERROR-FORMAT
  8519                                 THRU 9900-EXIT
  8520        GO TO 8200-SEND-DATAONLY
  8521     END-IF
  8522     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8523      OR (EIBAID = DFHPF10)
  8524        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8525        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8526        IF (RESP-NORMAL)
  8527           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8528              AM-CONTROL-PRIMARY (1:20))
  8529            IF AM-NAME NOT GREATER THAN SPACES OR
  8530               AM-ADDRS NOT GREATER THAN SPACES  OR
  8531               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8532               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8533               AM-ZIP NOT GREATER THAN SPACES
  8534               MOVE ER-3834             TO EMI-ERROR
  8535               MOVE -1                  TO BMAINTL
  8536               MOVE AL-UANON            TO BMAINTA
  8537               PERFORM 9900-ERROR-FORMAT
  8538                                 THRU 9900-EXIT
  8539               GO TO 8200-SEND-DATAONLY
  8540            END-IF
  8541        ELSE
  8542           MOVE ER-1609             TO EMI-ERROR
  8543           MOVE -1                  TO BMAINTL
  8544           MOVE AL-UANON            TO BMAINTA
  8545           PERFORM 9900-ERROR-FORMAT
  8546                                THRU 9900-EXIT
  8547           GO TO 8200-SEND-DATAONLY
  8548        END-IF
  8549
  8550        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8551        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8552        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 157
* EL6311.cbl
  8553            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8554               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8555               MA-CITY NOT GREATER THAN SPACES OR
  8556               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8557               MA-ZIP-CODE NOT GREATER THAN SPACES
  8558               MOVE ER-3835             TO EMI-ERROR
  8559               MOVE -1                  TO BMAINTL
  8560               MOVE AL-UANON            TO BMAINTA
  8561               PERFORM 9900-ERROR-FORMAT
  8562                                 THRU 9900-EXIT
  8563               GO TO 8200-SEND-DATAONLY
  8564            END-IF
  8565        ELSE
  8566           MOVE ER-3000             TO EMI-ERROR
  8567           MOVE -1                  TO BMAINTL
  8568           MOVE AL-UANON            TO BMAINTA
  8569           PERFORM 9900-ERROR-FORMAT
  8570                                THRU 9900-EXIT
  8571           GO TO 8200-SEND-DATAONLY
  8572        END-IF
  8573
  8574     END-IF
  8575     IF (EIBAID = DFHPF15)
  8576        AND (CSR-EDIT-SESSION)
  8577        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8578        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8579        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8580        MOVE PI-SV-STATE         TO PI-STATE
  8581        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8582        MOVE BCERTNOI            TO PI-CERT-PRIME
  8583        MOVE BSUFIXI             TO PI-CERT-SFX
  8584        MOVE BEFFDTI             TO DEEDIT-FIELD
  8585        PERFORM 8600-DEEDIT
  8586        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8587        MOVE '4'                 TO DC-OPTION-CODE
  8588        PERFORM 9700-DATE-LINK
  8589        IF DATE-CONVERSION-ERROR
  8590           MOVE ER-0348          TO EMI-ERROR
  8591           MOVE -1               TO BEFFDTL
  8592           MOVE AL-UABON         TO BEFFDTA
  8593           PERFORM 9900-ERROR-FORMAT
  8594                                 THRU 9900-EXIT
  8595           GO TO 8200-SEND-DATAONLY
  8596        ELSE
  8597           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8598           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8599           MOVE XCTL-EL6315      TO PGM-NAME
  8600           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8601           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8602           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8603           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8604           GO TO 9300-XCTL
  8605        END-IF
  8606     END-IF
  8607
  8608     IF EIBAID = DFHPF4
  8609        MOVE '0'                TO PI-EDIT-SW
  8610        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 158
* EL6311.cbl
  8611           NEXT SENTENCE
  8612        ELSE
  8613           GO TO 7200-DISPLAY-BATCHES.
  8614
  8615     IF EIBAID = DFHPF5
  8616        MOVE ER-0029                TO EMI-ERROR
  8617        MOVE -1                     TO BPFENTRL
  8618        MOVE AL-UNBON               TO BPFENTRA
  8619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8620        GO TO 8200-SEND-DATAONLY.
  8621*        MOVE '0'                TO PI-EDIT-SW
  8622*        IF PI-DISPLAY-ORIGINAL-BATCH
  8623*           NEXT SENTENCE
  8624*        ELSE
  8625*           MOVE EL631B              TO PI-MAP-NAME
  8626*           MOVE LOW-VALUES          TO EL631BI
  8627*           MOVE 'A'                 TO BMAINTO
  8628*           MOVE AL-UANON            TO BMAINTA
  8629*           MOVE -1                  TO BMAINTL
  8630*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8631*           GO TO 8100-SEND-INITIAL-MAP.
  8632
  8633     IF EIBAID = DFHPF6
  8634        IF NOT CSR-EDIT-SESSION
  8635           MOVE ER-0029                TO EMI-ERROR
  8636           MOVE -1                     TO BPFENTRL
  8637           MOVE AL-UNBON               TO BPFENTRA
  8638           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8639           GO TO 8200-SEND-DATAONLY
  8640*           MOVE '0'              TO PI-EDIT-SW
  8641*           IF PI-DISPLAY-ORIGINAL-BATCH
  8642*              NEXT SENTENCE
  8643*           ELSE
  8644*              MOVE EL631C        TO PI-MAP-NAME
  8645*              MOVE LOW-VALUES    TO EL631CI
  8646*              MOVE 'A'           TO CMAINTO
  8647*              MOVE AL-UANON      TO CMAINTA
  8648*              MOVE -1            TO CMAINTL
  8649*              MOVE '6'           TO PI-MAINT-FUNCTION
  8650*              GO TO 8100-SEND-INITIAL-MAP
  8651*           END-IF
  8652        ELSE
  8653           PERFORM 5100-PROCESS-POL-RESC
  8654                                 THRU 5100-EXIT
  8655           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8656           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8657                                    PI-PREV-SEQ-NO
  8658           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8659*                                    WS-CANCEL-LETTER-SW
  8660                                    PI-ALL-ISSUES-SW
  8661                                    PI-ALL-CANCELS-SW
  8662           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8663        END-IF
  8664     END-IF
  8665     IF EIBAID = DFHPF7
  8666        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8667        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8668        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 159
* EL6311.cbl
  8669        MOVE PI-SV-STATE            TO PI-STATE
  8670        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8671        MOVE BCERTNOI               TO PI-CERT-PRIME
  8672        MOVE BSUFIXI                TO PI-CERT-SFX
  8673        MOVE BEFFDTI                TO DEEDIT-FIELD
  8674        PERFORM 8600-DEEDIT
  8675        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8676        MOVE '4'                    TO DC-OPTION-CODE
  8677        PERFORM 9700-DATE-LINK
  8678        IF DATE-CONVERSION-ERROR
  8679           MOVE ER-0348            TO EMI-ERROR
  8680           MOVE -1                  TO BEFFDTL
  8681           MOVE AL-UABON            TO BEFFDTA
  8682           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8683           GO TO 8200-SEND-DATAONLY
  8684        ELSE
  8685           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8686           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8687           MOVE XCTL-EL1273        TO PGM-NAME
  8688           GO TO 9300-XCTL.
  8689
  8690     IF EIBAID = DFHPF8
  8691        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8692        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8693        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8694        MOVE PI-SV-STATE            TO PI-STATE
  8695        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8696        MOVE BCERTNOI               TO PI-CERT-PRIME
  8697        MOVE BSUFIXI                TO PI-CERT-SFX
  8698        MOVE BEFFDTI                TO DEEDIT-FIELD
  8699        PERFORM 8600-DEEDIT
  8700        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8701        MOVE '4'                    TO DC-OPTION-CODE
  8702        PERFORM 9700-DATE-LINK
  8703        IF DATE-CONVERSION-ERROR
  8704           MOVE ER-0348            TO EMI-ERROR
  8705           MOVE -1                  TO BEFFDTL
  8706           MOVE AL-UABON            TO BEFFDTA
  8707           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8708           GO TO 8200-SEND-DATAONLY
  8709        ELSE
  8710           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8711           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8712           IF PI-COMPANY-ID = 'DMD'
  8713               MOVE XCTL-EL401DMD      TO PGM-NAME
  8714             ELSE
  8715               MOVE XCTL-EL1279        TO PGM-NAME
  8716           END-IF
  8717           GO TO 9300-XCTL.
  8718
  8719     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8720        MOVE XCTL-EL6312         TO PGM-NAME
  8721
  8722* EXEC CICS XCTL
  8723*           PROGRAM   (PGM-NAME)
  8724*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8725*           LENGTH    (WS-COMM-LENGTH)
  8726*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 160
* EL6311.cbl
  8727*    MOVE '.$C                   %   #00008692' TO DFHEIV0
  8728     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8729     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8730     MOVE X'2020233030303038363932' TO DFHEIV0(25:11)
  8731     CALL 'kxdfhei1' USING DFHEIV0,
  8732           PGM-NAME,
  8733           PROGRAM-INTERFACE-BLOCK,
  8734           WS-COMM-LENGTH,
  8735           DFHEIV99
  8736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8737     ELSE
  8738        MOVE '0'                 TO  PI-EDIT-SW.
  8739
  8740     IF  EIBAID = DFHPF10
  8741         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8742         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8743         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8744                                    PI-1042-WA
  8745         MOVE 4                  TO PI-689-DATA-SOURCE
  8746         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8747         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8748         MOVE PI-SV-STATE        TO PI-689-STATE
  8749         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8750         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8751         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8752         MOVE PI-PB-ALT-CHG-SEQ-NO
  8753                                 TO PI-689-ALT-SEQ-NO
  8754         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8755         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8756         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8757         MOVE +0                 TO PI-689-CONTROL
  8758         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8759                                    PI-689-EXP-DATE
  8760                                    PI-689-RESP-PERSON
  8761                                    PI-689-TYPE
  8762                                    PI-689-FOLLOW-UP-EDIT
  8763                                    PI-689-RESEND1-EDIT
  8764                                    PI-689-SEQ-EDIT
  8765                                    PI-689-BCSEQ-EDIT
  8766                                    PI-689-LBL-OVERRIDE
  8767         MOVE W-LETTER-COMMUNICATION-AREAS
  8768                                 TO PI-PROGRAM-WORK-AREA
  8769         MOVE XCTL-EL689         TO PGM-NAME
  8770         GO TO 9300-XCTL.
  8771
  8772     IF  EIBAID = DFHPF16
  8773         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8774         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8775         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8776                                    PI-1042-WA
  8777         MOVE 4                  TO PI-689-DATA-SOURCE
  8778         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8779         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8780         MOVE PI-SV-STATE        TO PI-689-STATE
  8781         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8782         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8783         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8784         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 161
* EL6311.cbl
  8785                                 TO PI-689-ALT-SEQ-NO
  8786         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8787         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8788         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8789         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8790         MOVE W-LETTER-COMMUNICATION-AREAS
  8791                                 TO PI-PROGRAM-WORK-AREA
  8792         MOVE XCTL-EL690         TO PGM-NAME
  8793         GO TO 9300-XCTL.
  8794
  8795     IF EIBAID = DFHPF13
  8796         MOVE XCTL-EL6313        TO PGM-NAME
  8797         GO TO 9300-XCTL.
  8798
  8799     IF EIBAID = DFHPF17
  8800        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8801        IF (PB-I-LOAN-APR numeric)
  8802           and (pb-i-loan-apr < 99.9999)
  8803           AND (PB-I-BENEFICIARY-NAME NOT
  8804              = SPACES AND LOW-VALUES)
  8805
  8806           MOVE LINK-ELVADS          TO PGM-NAME
  8807
  8808* EXEC CICS LINK
  8809*              PROGRAM    (PGM-NAME)
  8810*              COMMAREA   (WS-PASS-AREA)
  8811*              LENGTH     (WS-PASS-AREA-LENGTH)
  8812*          END-EXEC
  8813*    MOVE '."C                   (   #00008767' TO DFHEIV0
  8814     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8815     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8816     MOVE X'2020233030303038373637' TO DFHEIV0(25:11)
  8817     CALL 'kxdfhei1' USING DFHEIV0,
  8818           PGM-NAME,
  8819           WS-PASS-AREA,
  8820           WS-PASS-AREA-LENGTH,
  8821           DFHEIV99,
  8822           DFHEIV99,
  8823           DFHEIV99,
  8824           DFHEIV99
  8825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8826
  8827           MOVE 0000             TO EMI-ERROR
  8828           MOVE -1               TO BMAINTL
  8829           PERFORM 9900-ERROR-FORMAT
  8830                                 THRU 9900-EXIT
  8831           GO TO 8200-SEND-DATAONLY
  8832        ELSE
  8833           MOVE ER-0877            TO EMI-ERROR
  8834           MOVE -1                  TO BEFFDTL
  8835           MOVE AL-UABON            TO BEFFDTA
  8836           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8837           GO TO 8200-SEND-DATAONLY
  8838        END-IF
  8839     END-IF
  8840     IF EIBAID = DFHPF14
  8841        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8842        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 162
* EL6311.cbl
  8843        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8844        MOVE PI-SV-STATE            TO PI-CR-STATE
  8845        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8846        MOVE SPACE                  TO PI-EDIT-SW
  8847        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8848        MOVE XCTL-EL650             TO PGM-NAME
  8849        GO TO 9300-XCTL.
  8850
  8851     IF EIBAID = DFHPF15
  8852        IF PI-COMPANY-ID  =  'HER'
  8853            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8854            MOVE XCTL-EL680         TO PGM-NAME
  8855            GO TO 9300-XCTL.
  8856
  8857     IF EIBAID = DFHENTER OR DFHPF11
  8858        GO TO 1000-ISSUE-MAINLINE.
  8859
  8860     MOVE ER-0029                TO EMI-ERROR
  8861     MOVE -1                     TO BPFENTRL
  8862     MOVE AL-UNBON               TO BPFENTRA
  8863     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8864     GO TO 8200-SEND-DATAONLY.
  8865
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 163
* EL6311.cbl
  8867
  8868******************************************************************
  8869*                                                                *
  8870*      CANCEL SCREEN PF KEY CHECKING                             *
  8871*                                                                *
  8872******************************************************************
  8873
  8874******************************************************************
  8875*                                                                *
  8876*      PF KEY FUNCTIONS:                                         *
  8877*                                                                *
  8878*      PF1  = BROWSE FORWARD                                     *
  8879*      PF2  = BROWSE BACKWARD                                    *
  8880*      PF3  = CERTIFICATE LOOKUP                                 *
  8881*      PF4  = DISPLAY BATCH HEADER                               *
  8882*      PF5  = ADD ISSUE SCREEN                                   *
  8883*      PF6  = ADD CANCEL SCREEN                                  *
  8884*      PF7  = CERTIFICATE DISPLAY                                *
  8885*      PF8  = CERTIFICATE NOTES                                  *
  8886*      PF9  = EDIT CONTROL                                       *
  8887*      PF10 = DISPLAY LETTER SCREEN                              *
  8888*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8889*      PF12 = DISPLAY HELP SCREEN                                *
  8890*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8891*      PF14 = ACCOUNT MASTER                                     *
  8892*      PF16 = LETTER REVIEW                                      *
  8893*                                                                *
  8894******************************************************************
  8895
  8896 0400-CHECK-CANCEL-PF-KEYS.
  8897     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8898        MOVE ER-2337             TO EMI-ERROR
  8899        MOVE -1                  TO CMAINTL
  8900        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8901        GO TO 8200-SEND-DATAONLY.
  8902
  8903     IF EIBAID = DFHPF1
  8904        MOVE '0'                TO PI-EDIT-SW
  8905        IF PI-PRIMARY-BROWSE
  8906           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8907        ELSE
  8908           IF PI-PRIMARY-WITH-SELECT
  8909              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8910           ELSE
  8911              IF PI-FILE-BROWSE
  8912                 GO TO 4300-BROWSE-FILE-FORWARD
  8913              ELSE
  8914                 IF PI-CSR-BROWSE
  8915                    GO TO 4200-BROWSE-CSR-FORWARD
  8916                 ELSE
  8917                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8918
  8919     IF EIBAID = DFHPF2
  8920        MOVE '0'                TO PI-EDIT-SW
  8921        IF PI-PRIMARY-BROWSE
  8922           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8923        ELSE
  8924           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 164
* EL6311.cbl
  8925              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8926           ELSE
  8927              IF PI-FILE-BROWSE
  8928                 GO TO 4800-BROWSE-FILE-BACKWARD
  8929              ELSE
  8930                 IF PI-CSR-BROWSE
  8931                    GO TO 4900-BROWSE-CSR-BACKWARD
  8932                 ELSE
  8933                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8934
  8935     IF EIBAID = DFHPF3
  8936        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8937        MOVE XCTL-EL127         TO PGM-NAME
  8938        GO TO 9300-XCTL.
  8939
  8940     IF (EIBAID = DFHPF15 OR DFHPF17)
  8941        AND (CSR-EDIT-SESSION)
  8942*       AND (FATAL-OR-UNFORCED)
  8943        AND (FATAL-ERRORS)
  8944        MOVE ER-1819             TO EMI-ERROR
  8945        MOVE -1                  TO CMAINTL
  8946        MOVE AL-UANON            TO CMAINTA
  8947        PERFORM 9900-ERROR-FORMAT
  8948                                 THRU 9900-EXIT
  8949        GO TO 8200-SEND-DATAONLY
  8950     END-IF
  8951     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8952       AND (CSR-EDIT-SESSION)
  8953        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8954        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8955        IF (RESP-NORMAL)
  8956           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8957              AM-CONTROL-PRIMARY (1:20))
  8958            IF AM-NAME NOT GREATER THAN SPACES OR
  8959               AM-ADDRS NOT GREATER THAN SPACES  OR
  8960               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8961               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8962               AM-ZIP NOT GREATER THAN SPACES
  8963               MOVE ER-3834             TO EMI-ERROR
  8964               MOVE -1                  TO BMAINTL
  8965               MOVE AL-UANON            TO BMAINTA
  8966               PERFORM 9900-ERROR-FORMAT
  8967                                 THRU 9900-EXIT
  8968               GO TO 8200-SEND-DATAONLY
  8969            END-IF
  8970        ELSE
  8971           MOVE ER-1609             TO EMI-ERROR
  8972           MOVE -1                  TO BMAINTL
  8973           MOVE AL-UANON            TO BMAINTA
  8974           PERFORM 9900-ERROR-FORMAT
  8975                                THRU 9900-EXIT
  8976           GO TO 8200-SEND-DATAONLY
  8977        END-IF
  8978
  8979        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8980        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8981        IF (ERMAIL-FOUND)
  8982            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 165
* EL6311.cbl
  8983               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8984               MA-CITY NOT GREATER THAN SPACES OR
  8985               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8986               MA-ZIP-CODE NOT GREATER THAN SPACES
  8987               MOVE ER-3835             TO EMI-ERROR
  8988               MOVE -1                  TO BMAINTL
  8989               MOVE AL-UANON            TO BMAINTA
  8990               PERFORM 9900-ERROR-FORMAT
  8991                                 THRU 9900-EXIT
  8992               GO TO 8200-SEND-DATAONLY
  8993            END-IF
  8994        ELSE
  8995           MOVE ER-3000             TO EMI-ERROR
  8996           MOVE -1                  TO BMAINTL
  8997           MOVE AL-UANON            TO BMAINTA
  8998           PERFORM 9900-ERROR-FORMAT
  8999                                THRU 9900-EXIT
  9000           GO TO 8200-SEND-DATAONLY
  9001        END-IF
  9002
  9003     END-IF
  9004     IF (EIBAID = DFHPF15 OR DFHPF17)
  9005        AND (CSR-EDIT-SESSION)
  9006        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9007        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9008        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9009        MOVE PI-SV-STATE         TO PI-STATE
  9010        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9011        MOVE CCERTNOI            TO PI-CERT-PRIME
  9012        MOVE CSUFIXI             TO PI-CERT-SFX
  9013        MOVE CEFFDTI             TO DEEDIT-FIELD
  9014        PERFORM 8600-DEEDIT
  9015        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9016        MOVE '4'                 TO DC-OPTION-CODE
  9017        PERFORM 9700-DATE-LINK
  9018        IF DATE-CONVERSION-ERROR
  9019           MOVE ER-0348          TO EMI-ERROR
  9020           MOVE -1               TO CEFFDTL
  9021           MOVE AL-UABON         TO CEFFDTA
  9022           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9023           GO TO 8200-SEND-DATAONLY
  9024        ELSE
  9025           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9026           PERFORM 6000-CREATE-TEMP-STORAGE
  9027                                 THRU 6000-EXIT
  9028           IF EIBAID = DFHPF17
  9029               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9030                                  THRU 6400-EXIT
  9031               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9032                                 '2' AND '3' AND '4'
  9033                  MOVE ER-3831     TO  EMI-ERROR
  9034                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9035                  GO TO 8200-SEND-DATAONLY
  9036               END-IF
  9037               MOVE 'Y'          TO PI-CLM-RESC-IND
  9038           ELSE
  9039               MOVE 'N'          TO PI-CLM-RESC-IND
  9040           END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 166
* EL6311.cbl
  9041           MOVE XCTL-EL6316      TO PGM-NAME
  9042           MOVE '2'              TO PI-ISS-CAN-SW
  9043           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9044           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9045           GO TO 9300-XCTL
  9046        END-IF
  9047     END-IF
  9048
  9049     IF EIBAID = DFHPF4
  9050        MOVE '0'                TO PI-EDIT-SW
  9051        IF PI-DISPLAY-ORIGINAL-BATCH
  9052           NEXT SENTENCE
  9053        ELSE
  9054           GO TO 7200-DISPLAY-BATCHES.
  9055
  9056     IF EIBAID = DFHPF5
  9057        MOVE ER-0029                TO EMI-ERROR
  9058        MOVE -1                     TO BPFENTRL
  9059        MOVE AL-UNBON               TO BPFENTRA
  9060        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9061        GO TO 8200-SEND-DATAONLY.
  9062*        MOVE '0'                TO PI-EDIT-SW
  9063*        IF PI-DISPLAY-ORIGINAL-BATCH
  9064*           NEXT SENTENCE
  9065*        ELSE
  9066*           MOVE EL631B              TO PI-MAP-NAME
  9067*           MOVE LOW-VALUES          TO EL631BI
  9068*           MOVE 'A'                 TO BMAINTO
  9069*           MOVE AL-UANON            TO BMAINTA
  9070*           MOVE -1                  TO BMAINTL
  9071*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9072*           GO TO 8100-SEND-INITIAL-MAP.
  9073
  9074     IF EIBAID = DFHPF6
  9075        MOVE ER-0029                TO EMI-ERROR
  9076        MOVE -1                     TO BPFENTRL
  9077        MOVE AL-UNBON               TO BPFENTRA
  9078        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9079        GO TO 8200-SEND-DATAONLY.
  9080*        MOVE '0'                TO PI-EDIT-SW
  9081*        IF PI-DISPLAY-ORIGINAL-BATCH
  9082*           NEXT SENTENCE
  9083*        ELSE
  9084*           MOVE EL631C              TO PI-MAP-NAME
  9085*           MOVE LOW-VALUES          TO EL631CI
  9086*           MOVE 'A'                 TO CMAINTO
  9087*           MOVE AL-UANON            TO CMAINTA
  9088*           MOVE -1                  TO CMAINTL
  9089*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9090*           GO TO 8100-SEND-INITIAL-MAP.
  9091
  9092     IF EIBAID = DFHPF7
  9093        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9094        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9095        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9096        MOVE PI-SV-STATE            TO PI-STATE
  9097        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9098        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 167
* EL6311.cbl
  9099        MOVE CSUFIXI                TO PI-CERT-SFX
  9100        MOVE CEFFDTI                TO DEEDIT-FIELD
  9101        PERFORM 8600-DEEDIT
  9102        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9103        MOVE '4'                    TO DC-OPTION-CODE
  9104        PERFORM 9700-DATE-LINK
  9105        IF DATE-CONVERSION-ERROR
  9106           MOVE ER-0348            TO EMI-ERROR
  9107           MOVE -1                  TO BEFFDTL
  9108           MOVE AL-UABON            TO BEFFDTA
  9109           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9110           GO TO 8200-SEND-DATAONLY
  9111        ELSE
  9112           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9113           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9114           MOVE XCTL-EL1273        TO PGM-NAME
  9115           GO TO 9300-XCTL.
  9116
  9117     IF EIBAID = DFHPF8
  9118        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9119        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9120        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9121        MOVE PI-SV-STATE            TO PI-STATE
  9122        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9123        MOVE CCERTNOI               TO PI-CERT-PRIME
  9124        MOVE CSUFIXI                TO PI-CERT-SFX
  9125        MOVE CEFFDTI                TO DEEDIT-FIELD
  9126        PERFORM 8600-DEEDIT
  9127        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9128        MOVE '4'                    TO DC-OPTION-CODE
  9129        PERFORM 9700-DATE-LINK
  9130        IF DATE-CONVERSION-ERROR
  9131           MOVE ER-0348             TO EMI-ERROR
  9132           MOVE -1                  TO BEFFDTL
  9133           MOVE AL-UABON            TO BEFFDTA
  9134           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9135           GO TO 8200-SEND-DATAONLY
  9136        ELSE
  9137           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9138           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9139           IF PI-COMPANY-ID = 'DMD'
  9140               MOVE XCTL-EL401DMD      TO PGM-NAME
  9141             ELSE
  9142               MOVE XCTL-EL1279        TO PGM-NAME
  9143           END-IF
  9144           GO TO 9300-XCTL.
  9145
  9146     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9147        MOVE XCTL-EL6312     TO PGM-NAME
  9148
  9149* EXEC CICS XCTL
  9150*           PROGRAM  (PGM-NAME)
  9151*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9152*           LENGTH   (WS-COMM-LENGTH)
  9153*       END-EXEC
  9154*    MOVE '.$C                   %   #00009094' TO DFHEIV0
  9155     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9156     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 168
* EL6311.cbl
  9157     MOVE X'2020233030303039303934' TO DFHEIV0(25:11)
  9158     CALL 'kxdfhei1' USING DFHEIV0,
  9159           PGM-NAME,
  9160           PROGRAM-INTERFACE-BLOCK,
  9161           WS-COMM-LENGTH,
  9162           DFHEIV99
  9163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9164     ELSE
  9165        MOVE '0'                 TO  PI-EDIT-SW.
  9166
  9167     IF EIBAID = DFHPF10
  9168         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9169         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9170         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9171         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9172                                    PI-1042-WA
  9173         MOVE 4                  TO PI-689-DATA-SOURCE
  9174         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9175         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9176         MOVE PI-SV-STATE        TO PI-689-STATE
  9177         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9178         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9179         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9180         MOVE PI-PB-ALT-CHG-SEQ-NO
  9181                                 TO PI-689-ALT-SEQ-NO
  9182         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9183         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9184         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9185         MOVE +0                 TO PI-689-CONTROL
  9186         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9187                                    PI-689-EXP-DATE
  9188                                    PI-689-RESP-PERSON
  9189                                    PI-689-TYPE
  9190                                    PI-689-FOLLOW-UP-EDIT
  9191                                    PI-689-RESEND1-EDIT
  9192                                    PI-689-SEQ-EDIT
  9193                                    PI-689-BCSEQ-EDIT
  9194                                    PI-689-LBL-OVERRIDE
  9195         MOVE W-LETTER-COMMUNICATION-AREAS
  9196                                 TO PI-PROGRAM-WORK-AREA
  9197         MOVE XCTL-EL689         TO PGM-NAME
  9198         GO TO 9300-XCTL.
  9199
  9200     IF  EIBAID = DFHPF16
  9201         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9202         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9203         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9204                                    PI-1042-WA
  9205         MOVE 4                  TO PI-689-DATA-SOURCE
  9206         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9207         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9208         MOVE PI-SV-STATE        TO PI-689-STATE
  9209         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9210         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9211         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9212         MOVE PI-PB-ALT-CHG-SEQ-NO
  9213                                 TO PI-689-ALT-SEQ-NO
  9214         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 169
* EL6311.cbl
  9215         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9216         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9217         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9218         MOVE W-LETTER-COMMUNICATION-AREAS
  9219                                 TO PI-PROGRAM-WORK-AREA
  9220         MOVE XCTL-EL690         TO PGM-NAME
  9221         GO TO 9300-XCTL.
  9222     IF (EIBAID = DFHPF13)
  9223        if (not fatal-errors)
  9224           and (not unforced-errors)
  9225           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9226           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9227           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9228           MOVE PI-SV-STATE      TO PI-STATE
  9229           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9230           MOVE CCERTNOI         TO PI-CERT-PRIME
  9231           MOVE CSUFIXI          TO PI-CERT-SFX
  9232           MOVE CEFFDTI          TO DEEDIT-FIELD
  9233           PERFORM 8600-DEEDIT
  9234           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9235           MOVE '4'              TO DC-OPTION-CODE
  9236           PERFORM 9700-DATE-LINK
  9237           IF DATE-CONVERSION-ERROR
  9238              MOVE ER-0348       TO EMI-ERROR
  9239              MOVE -1            TO CEFFDTL
  9240              MOVE AL-UABON      TO CEFFDTA
  9241              PERFORM 9900-ERROR-FORMAT
  9242                                 THRU 9900-EXIT
  9243              GO TO 8200-SEND-DATAONLY
  9244           ELSE
  9245              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9246              MOVE AL-UANON      TO CEFFDTA
  9247              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9248              PERFORM 6000-CREATE-TEMP-STORAGE
  9249                                 THRU 6000-EXIT
  9250              MOVE XCTL-EL677    TO PGM-NAME
  9251              GO TO 9300-XCTL
  9252           end-if
  9253        else
  9254           MOVE ER-3444          TO EMI-ERROR
  9255           MOVE -1               TO CPFENTRL
  9256           MOVE AL-UNBON         TO CPFENTRA
  9257           PERFORM 9900-ERROR-FORMAT
  9258                                 THRU 9900-EXIT
  9259           GO TO 8200-SEND-DATAONLY
  9260        end-if
  9261     end-if
  9262
  9263     IF EIBAID = DFHPF14
  9264        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9265        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9266        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9267        MOVE PI-SV-STATE            TO PI-CR-STATE
  9268        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9269        MOVE SPACE                  TO PI-EDIT-SW
  9270        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9271        MOVE XCTL-EL650             TO PGM-NAME
  9272        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 170
* EL6311.cbl
  9273
  9274     IF EIBAID = DFHENTER OR DFHPF11
  9275        GO TO 2000-CANCEL-MAINLINE.
  9276
  9277     MOVE ER-0029                TO EMI-ERROR.
  9278     MOVE -1                     TO CPFENTRL.
  9279     MOVE AL-UNBON               TO CPFENTRA.
  9280     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9281     GO TO 8200-SEND-DATAONLY.
  9282
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 171
* EL6311.cbl
  9284
  9285******************************************************************
  9286*                                                                *
  9287*      BATCH SCREEN PF KEY CHECKING                              *
  9288*                                                                *
  9289******************************************************************
  9290
  9291******************************************************************
  9292*                                                                *
  9293*      PF KEY FUNCTIONS:                                         *
  9294*                                                                *
  9295*      PF1 = BROWSE FORWARD                                      *
  9296*      PF2 = BROWSE BACKWARD                                     *
  9297*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9298*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9299*                                                                *
  9300*                                                                *
  9301******************************************************************
  9302
  9303 0500-CHECK-BATCH-PF-KEYS.
  9304     IF EIBAID = DFHPF1
  9305        MOVE '0'                TO PI-EDIT-SW
  9306        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9307           GO TO 5000-BROWSE-BATCH-HEADERS
  9308        ELSE
  9309           IF PI-GOOD-BROWSE
  9310              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9311                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9312              ELSE
  9313                 IF PI-FILE-BROWSE
  9314                    GO TO 4300-BROWSE-FILE-FORWARD
  9315                 ELSE
  9316                    IF PI-CSR-BROWSE
  9317                       GO TO 4200-BROWSE-CSR-FORWARD
  9318                    ELSE
  9319                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9320           ELSE
  9321              GO TO 0800-BROWSE-ERROR.
  9322
  9323     IF EIBAID = DFHPF2
  9324        MOVE '0'                TO PI-EDIT-SW
  9325        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9326           GO TO 5500-BROWSE-BATCH-BACKWARD
  9327        ELSE
  9328           IF PI-GOOD-BROWSE
  9329              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9330                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9331              ELSE
  9332                 IF PI-FILE-BROWSE
  9333                    GO TO 4800-BROWSE-FILE-BACKWARD
  9334                 ELSE
  9335                    IF PI-CSR-BROWSE
  9336                       GO TO 4900-BROWSE-CSR-BACKWARD
  9337                    ELSE
  9338                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9339           ELSE
  9340              GO TO 0800-BROWSE-ERROR.
  9341
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 172
* EL6311.cbl
  9342     IF EIBAID = DFHPF3
  9343        GO TO 3000-BATCH-MAINLINE.
  9344
  9345     IF  EIBAID = DFHPF4
  9346        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9347        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9348        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9349        MOVE PI-SV-STATE            TO PI-CR-STATE
  9350        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9351                                       PI-CR-FIN-RESP
  9352        MOVE 'A'                    TO PI-CR-TYPE
  9353        MOVE SPACE                  TO PI-EDIT-SW
  9354        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9355        MOVE XCTL-EL640             TO PGM-NAME
  9356        GO TO 9300-XCTL.
  9357
  9358     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9359       AND
  9360        (EIBAID = DFHENTER)
  9361           GO TO 3500-EDIT-BATCH-DATA.
  9362
  9363     IF EIBAID = DFHENTER
  9364        GO TO 3500-EDIT-BATCH-DATA.
  9365
  9366     MOVE ER-0029             TO EMI-ERROR.
  9367     MOVE -1                  TO DPFENTRL.
  9368     MOVE AL-UNBON            TO DPFENTRA.
  9369     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9370     GO TO 8200-SEND-DATAONLY.
  9371
  9372 0800-BROWSE-ERROR.
  9373     MOVE ER-2258                TO EMI-ERROR.
  9374     MOVE -1                     TO DPFENTRL.
  9375     MOVE AL-UNBON               TO DPFENTRA.
  9376     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9377     GO TO 8200-SEND-DATAONLY.
  9378
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 173
* EL6311.cbl
  9380
  9381******************************************************************
  9382*                                                                *
  9383*                I S S U E   M A I N L I N E                     *
  9384*                                                                *
  9385******************************************************************
  9386
  9387 1000-ISSUE-MAINLINE.
  9388     IF PI-DISPLAY-ORIGINAL-BATCH
  9389        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9390           MOVE ER-0023             TO EMI-ERROR
  9391           MOVE -1                  TO BMAINTL
  9392           MOVE AL-UABON            TO BMAINTA
  9393           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9394           GO TO 8200-SEND-DATAONLY
  9395        ELSE
  9396           NEXT SENTENCE
  9397     ELSE
  9398        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9399           MOVE ER-0023             TO EMI-ERROR
  9400           MOVE -1                  TO BMAINTL
  9401           MOVE AL-UABON            TO BMAINTA
  9402           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9403           GO TO 8200-SEND-DATAONLY.
  9404
  9405     IF BMAINTI = 'S'
  9406        GO TO 1100-SHOW-REQUEST.
  9407
  9408     IF NOT MODIFY-CAP
  9409         MOVE 'UPDATE'       TO SM-READ
  9410         PERFORM 9995-SECURITY-VIOLATION
  9411         MOVE ER-0070        TO EMI-ERROR
  9412         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9413         GO TO 8100-SEND-INITIAL-MAP.
  9414
  9415     IF BMAINTL GREATER THAN ZEROS
  9416        IF PI-PF5-FUNCTION
  9417           IF BMAINTI NOT = 'A'
  9418              MOVE AL-UABON  TO BMAINTA
  9419              MOVE -1        TO BMAINTL
  9420              MOVE ER-2260   TO EMI-ERROR
  9421              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9422              GO TO 8200-SEND-DATAONLY.
  9423
  9424     IF BCERTNOL = ZEROS
  9425       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9426         NEXT SENTENCE
  9427     ELSE
  9428         IF BCERTNOL NOT = ZEROS
  9429             MOVE AL-UANON       TO BCERTNOA
  9430         ELSE
  9431             MOVE -1             TO BCERTNOL
  9432             MOVE  1             TO SET-CURSOR-SW
  9433             MOVE ER-2218        TO EMI-ERROR
  9434             MOVE AL-UABON       TO BCERTNOA
  9435             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9436
  9437     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 174
* EL6311.cbl
  9438         MOVE AL-UANON       TO BSUFIXA
  9439     ELSE
  9440         MOVE AL-SANOF       TO BSUFIXA.
  9441
  9442     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9443        NEXT SENTENCE
  9444     ELSE
  9445        IF BEFFDTL NOT = ZEROS
  9446           MOVE AL-UNNON             TO BEFFDTA
  9447           MOVE BEFFDTI              TO DEEDIT-FIELD
  9448           PERFORM 8600-DEEDIT
  9449           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9450           MOVE 4                    TO DC-OPTION-CODE
  9451           PERFORM 9700-DATE-LINK
  9452           IF NO-CONVERSION-ERROR
  9453              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9454              ELSE
  9455              MOVE -1                TO BEFFDTL
  9456              MOVE  1                TO SET-CURSOR-SW
  9457              MOVE ER-2226           TO EMI-ERROR
  9458              MOVE AL-UNBON          TO BEFFDTA
  9459              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9460           ELSE
  9461              MOVE -1                TO BEFFDTL
  9462              MOVE  1                TO SET-CURSOR-SW
  9463              MOVE ER-2220           TO EMI-ERROR
  9464              MOVE AL-UNBON          TO BEFFDTA
  9465              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9466
  9467     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9468
  9469     IF BCERTNOL NOT = ZEROS
  9470        MOVE BCERTNOI                TO WS-NEW-PRIME
  9471     ELSE
  9472        MOVE SPACES                  TO WS-NEW-PRIME.
  9473
  9474     IF BSUFIXL NOT = ZEROS
  9475        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9476     ELSE
  9477        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9478
  9479     IF BEFFDTL NOT = ZEROS
  9480        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9481     ELSE
  9482        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9483
  9484     IF BMAINTI = 'A' OR 'K' OR 'S'
  9485        NEXT SENTENCE
  9486     ELSE
  9487        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9488        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9489           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9490           WS-PB-RECORD-TYPE NOT = '1'
  9491           IF BMAINTI = 'C'
  9492               MOVE ER-2287          TO EMI-ERROR
  9493               MOVE -1               TO BCERTNOL
  9494               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9495               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 175
* EL6311.cbl
  9496               GO TO 8200-SEND-DATAONLY
  9497             ELSE
  9498               MOVE ER-2260          TO EMI-ERROR
  9499               MOVE -1               TO BCERTNOL
  9500               MOVE AL-UABON         TO BCERTNOA
  9501               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9502               GO TO 8200-SEND-DATAONLY.
  9503
  9504     IF BMAINTI = 'D'
  9505         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9506
  9507*    IF BMICRNOL  NOT =  ZEROS
  9508*        IF BMICRNOI  NUMERIC
  9509*            MOVE AL-UNNON       TO  BMICRNOA
  9510*        ELSE
  9511*            MOVE -1             TO  BMICRNOL
  9512*            MOVE 1              TO  SET-CURSOR-SW
  9513*            MOVE AL-UNBON       TO  BMICRNOA
  9514*            MOVE ER-2701        TO  EMI-ERROR
  9515*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9516     IF BVINL NOT = ZEROS
  9517        MOVE AL-UANON            TO BVINA
  9518     END-IF
  9519     IF B1STNML NOT = ZEROS
  9520         MOVE AL-UANON                TO B1STNMA.
  9521
  9522     IF BINITL  NOT = ZEROS
  9523        MOVE AL-UANON                TO BINITA.
  9524
  9525     IF BSEXL NOT = ZEROS
  9526        IF BSEXI = 'M' OR 'F'
  9527           MOVE AL-UANON             TO BSEXA
  9528        ELSE
  9529           MOVE -1               TO BSEXL
  9530           MOVE ER-2629          TO EMI-ERROR
  9531           MOVE AL-UABON         TO BSEXA
  9532           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9533
  9534     IF BAGEL NOT = ZEROS
  9535         IF BAGEI NUMERIC
  9536             MOVE BAGEI              TO WS-BAGE
  9537             MOVE AL-UNNON           TO BAGEA
  9538         ELSE
  9539             MOVE -1                 TO BAGEL
  9540             MOVE  1                 TO SET-CURSOR-SW
  9541             MOVE ER-2223            TO EMI-ERROR
  9542             MOVE AL-UNBON           TO BAGEA
  9543             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9544
  9545     IF BLSTNML NOT = ZERO  OR
  9546        B1STNML NOT = ZERO  OR
  9547        BINITL NOT = ZERO
  9548         IF BAGEL = ZEROS
  9549             MOVE -1                 TO BAGEL
  9550             MOVE  1                 TO SET-CURSOR-SW
  9551             MOVE ER-3269            TO EMI-ERROR
  9552             MOVE AL-UNBON           TO BAGEA
  9553             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 176
* EL6311.cbl
  9554         END-IF
  9555     END-IF.
  9556
  9557     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9558
  9559     IF (BBIRTHL GREATER THAN +0) AND
  9560        (BBIRTHI NOT EQUAL SPACES)
  9561        NEXT SENTENCE
  9562     ELSE
  9563        GO TO 1010-CHECK-AGE.
  9564
  9565     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9566     PERFORM 8600-DEEDIT.
  9567     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9568     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9569     MOVE AL-UNNON               TO BBIRTHA.
  9570     MOVE '4'                    TO DC-OPTION-CODE.
  9571     PERFORM 9700-DATE-LINK.
  9572     IF DATE-CONVERSION-ERROR
  9573        MOVE -1                  TO BBIRTHL
  9574        MOVE  1                  TO SET-CURSOR-SW
  9575        MOVE ER-2228             TO EMI-ERROR
  9576        MOVE AL-UNBON            TO BBIRTHA
  9577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9578        GO TO 1010-CHECK-AGE.
  9579
  9580     IF (NO-CONVERSION-ERROR) AND
  9581        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9582        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9583        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9584        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9585                                    WS-CONVERTED-BIRTH
  9586        MOVE AL-UANON            TO BBIRTHA
  9587     ELSE
  9588        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9589        MOVE AL-UANON            TO BBIRTHA.
  9590
  9591 1010-CHECK-AGE.
  9592
  9593*    IF BAGEL = ZERO
  9594*       IF BBIRTHL GREATER THAN ZERO
  9595*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9596
  9597     IF B1STPMTL NOT = ZEROS
  9598        IF B1STPMTI = SPACES
  9599           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9600        ELSE
  9601           MOVE B1STPMTI             TO DEEDIT-FIELD
  9602           PERFORM 8600-DEEDIT
  9603           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9604           MOVE AL-UNNON             TO B1STPMTA
  9605           MOVE 4                    TO DC-OPTION-CODE
  9606           PERFORM 9700-DATE-LINK
  9607           IF NO-CONVERSION-ERROR
  9608              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9609              MOVE AL-UANON          TO B1STPMTA
  9610           ELSE
  9611              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 177
* EL6311.cbl
  9612              MOVE  1                TO SET-CURSOR-SW
  9613              MOVE ER-2200           TO EMI-ERROR
  9614              MOVE AL-UNBON          TO B1STPMTA
  9615              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9616
  9617     IF BDAYSL NOT = ZEROS
  9618         IF BDAYSI NUMERIC
  9619             MOVE AL-UNNON           TO BDAYSA
  9620         ELSE
  9621             MOVE -1                 TO BDAYSL
  9622             MOVE ER-2530            TO EMI-ERROR
  9623             MOVE AL-UNBON           TO BDAYSA
  9624             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9625
  9626     IF BLNTRML NOT = ZEROS
  9627         IF BLNTRMI NUMERIC
  9628             MOVE AL-UNNON       TO BLNTRMA
  9629         ELSE
  9630             MOVE -1             TO BLNTRML
  9631             MOVE ER-2533        TO EMI-ERROR
  9632             MOVE AL-UNBON       TO BLNTRMA
  9633             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9634
  9635**   IF PI-COMPANY-ID = 'DMD'
  9636     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9637        NEXT SENTENCE
  9638     ELSE
  9639         IF BLNOFCRL NOT = ZEROS
  9640            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9641            IF LOAN-OFFICER-FOUND
  9642                MOVE AL-UANON        TO BLNOFCRA
  9643             ELSE
  9644                 MOVE SPACE          TO WS-LOAN-OFFICER
  9645                 MOVE -1             TO BLNOFCRL
  9646                 MOVE  1             TO SET-CURSOR-SW
  9647                 MOVE ER-3006        TO EMI-ERROR
  9648                 MOVE AL-UNBON       TO BLNOFCRA
  9649                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9650
  9651     IF BFREQL NOT = ZEROS
  9652         IF BFREQI NUMERIC
  9653             MOVE AL-UNNON       TO BFREQA
  9654         ELSE
  9655             MOVE -1             TO BFREQL
  9656             MOVE  1             TO SET-CURSOR-SW
  9657             MOVE ER-2223        TO EMI-ERROR
  9658             MOVE AL-UNBON       TO BFREQA
  9659             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9660
  9661     IF BMODEL NOT = ZEROS
  9662         MOVE BMODEI             TO WS-MODE-CODE
  9663                                    PI-BMODE
  9664         IF WS-MODE-CODE-VALID
  9665             MOVE AL-UANON       TO BMODEA
  9666         ELSE
  9667             MOVE -1             TO BMODEL
  9668             MOVE ER-2591        TO EMI-ERROR
  9669             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 178
* EL6311.cbl
  9670             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9671
  9672     IF BPMTSL NOT = ZEROS
  9673         IF BPMTSI NUMERIC
  9674             MOVE AL-UNNON           TO BPMTSA
  9675             MOVE BPMTSI             TO PI-BPMTS
  9676         ELSE
  9677             MOVE -1                 TO BPMTSL
  9678             MOVE ER-2592            TO EMI-ERROR
  9679             MOVE AL-UNBON           TO BPMTSA
  9680             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9681
  9682     IF BPMTAMTL NOT = ZEROS
  9683
  9684* EXEC CICS BIF DEEDIT
  9685*            FIELD  (BPMTAMTI)
  9686*            LENGTH (9)
  9687*       END-EXEC
  9688     MOVE 9
  9689       TO DFHEIV11
  9690*    MOVE '@"L                   #   #00009618' TO DFHEIV0
  9691     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9692     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9693     MOVE X'2020233030303039363138' TO DFHEIV0(25:11)
  9694     CALL 'kxdfhei1' USING DFHEIV0,
  9695           BPMTAMTI,
  9696           DFHEIV11
  9697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9698        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9699*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9700*        PERFORM 8600-DEEDIT
  9701*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9702
  9703*    IF BAPRL NOT = ZEROS
  9704*        EXEC CICS BIF DEEDIT
  9705*            FIELD  (BAPRI)
  9706*            LENGTH (7)
  9707*        END-EXEC
  9708*        MOVE BAPRI              TO WS-BAPR.
  9709
  9710     IF BAPRL > 0
  9711        MOVE +0                  TO  WS-BAPR
  9712        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9713           (WS-SUB > 7)
  9714           OR (BAPRI (WS-SUB:1) NUMERIC)
  9715           OR (BAPRI (WS-SUB:1) = '.')
  9716        END-PERFORM
  9717        IF WS-SUB > 7
  9718           MOVE ER-2471       TO EMI-ERROR
  9719           MOVE -1            TO BAPRL
  9720           MOVE AL-UNBON      TO BAPRA
  9721           PERFORM 9900-ERROR-FORMAT
  9722                                 THRU 9900-EXIT
  9723        ELSE
  9724           IF BAPRI (WS-SUB:1) NUMERIC
  9725              MOVE WS-SUB           TO WS-BEG
  9726              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9727                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 179
* EL6311.cbl
  9728                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9729              END-PERFORM
  9730              COMPUTE WS-END = WS-SUB - WS-BEG
  9731              MOVE BAPRI (WS-BEG:WS-END)
  9732                                 TO WS-APR-WHOLE-NUM
  9733           END-IF
  9734           IF BAPRI (WS-SUB:1) = '.'
  9735              COMPUTE WS-BEG = WS-SUB + 1
  9736              IF (WS-BEG < 8)
  9737                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9738                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9739                    (WS-SUB > 7)
  9740                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9741                 END-PERFORM
  9742                 COMPUTE WS-END = WS-SUB - WS-BEG
  9743                 MOVE BAPRI (WS-BEG:WS-END)
  9744                                 TO WS-APR-DEC (1:WS-END)
  9745              END-IF
  9746           END-IF
  9747           MOVE AL-UNNON      TO BAPRA
  9748           MOVE WS-BAPR       TO BAPRO
  9749        END-IF
  9750     END-IF
  9751*     IF BAPRL NOT = ZEROS
  9752*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9753*        PERFORM 8600-DEEDIT
  9754*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9755
  9756     IF BLIVESL NOT = ZEROS
  9757        MOVE BLIVESI             TO DEEDIT-FIELD
  9758        PERFORM 8600-DEEDIT
  9759        IF DEEDIT-FIELD-V0 NUMERIC
  9760           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9761           MOVE AL-UNNON         TO BLIVESA
  9762        ELSE
  9763           MOVE -1               TO BLIVESL
  9764           MOVE AL-UNBON         TO BLIVESA
  9765           MOVE ER-2223          TO EMI-ERROR
  9766           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9767
  9768*DMD CUSTOM CODING*************START
  9769*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9770     IF PI-COMPANY-ID NOT = 'DMD'
  9771         MOVE ZEROS               TO BBILLEDL
  9772         GO TO 1010-EDIT-CONT.
  9773
  9774     IF BBILLEDL NOT = ZEROS
  9775        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9776        MOVE 'Y'                 TO WS-NUMERIC-SW
  9777        MOVE +1                  TO WS-CSO-SUB
  9778        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9779        IF CSO-NUMERIC-FIELD
  9780
  9781* EXEC CICS BIF DEEDIT
  9782*              FIELD  (BBILLEDI)
  9783*              LENGTH (9)
  9784*          END-EXEC
  9785     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 180
* EL6311.cbl
  9786       TO DFHEIV11
  9787*    MOVE '@"L                   #   #00009704' TO DFHEIV0
  9788     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9789     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9790     MOVE X'2020233030303039373034' TO DFHEIV0(25:11)
  9791     CALL 'kxdfhei1' USING DFHEIV0,
  9792           BBILLEDI,
  9793           DFHEIV11
  9794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9795           MOVE BBILLEDI         TO WS-BILLED
  9796           MOVE AL-UNNON         TO BBILLEDA
  9797        ELSE
  9798           MOVE -1               TO BBILLEDL
  9799           MOVE AL-UNBON         TO BBILLEDA
  9800           MOVE ER-2547          TO EMI-ERROR
  9801           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9802     ELSE
  9803        IF BMAINTI EQUAL 'A'
  9804           MOVE -1               TO BBILLEDL
  9805           MOVE AL-UNBON         TO BBILLEDA
  9806           MOVE ER-8148          TO EMI-ERROR
  9807           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9808
  9809 1010-EDIT-CONT.
  9810
  9811     IF BFORCEL  NOT = ZEROS
  9812         IF FORCE-CAP
  9813            MOVE AL-UANON            TO BFORCEA
  9814         ELSE
  9815            MOVE ER-2945             TO EMI-ERROR
  9816            MOVE AL-UABON            TO BFORCEA
  9817            MOVE -1                  TO BFORCEL
  9818            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9819
  9820     if (bforcel not = zeros)
  9821        and (bforcei = 'L')
  9822        and (not csr-edit-session)
  9823        and (emi-error <> er-2945)
  9824        MOVE ER-2670             TO EMI-ERROR
  9825        MOVE AL-UABON            TO BFORCEA
  9826        MOVE -1                  TO BFORCEL
  9827        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9828     end-if
  9829     IF BENTRYL NOT = ZEROS
  9830        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9831                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9832           MOVE ER-2224              TO EMI-ERROR
  9833           MOVE AL-UABON             TO BENTRYA
  9834           MOVE -1                   TO BENTRYL
  9835           MOVE  1                   TO SET-CURSOR-SW
  9836           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9837        ELSE
  9838           MOVE AL-UANON             TO BENTRYA.
  9839
  9840     IF BUNWRITL NOT = ZEROS
  9841        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9842           MOVE ER-7574              TO EMI-ERROR
  9843           MOVE AL-UABON             TO BUNWRITA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 181
* EL6311.cbl
  9844           MOVE -1                   TO BUNWRITL
  9845           MOVE  1                   TO SET-CURSOR-SW
  9846           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9847        ELSE
  9848           MOVE AL-UANON             TO BUNWRITA.
  9849
  9850     IF BREINL  NOT = ZEROS
  9851         MOVE AL-UANON               TO BREINA.
  9852
  9853     IF BBILCDL NOT = ZEROS
  9854        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9855                             AND 'A' AND 'B' AND 'E'
  9856           MOVE ER-2225              TO EMI-ERROR
  9857           MOVE AL-UABON             TO BBILCDA
  9858           MOVE -1                   TO BBILCDL
  9859           MOVE  1                   TO SET-CURSOR-SW
  9860           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9861        ELSE
  9862           MOVE AL-UANON             TO BBILCDA.
  9863
  9864     IF BSKPCDL NOT = ZEROS
  9865         MOVE AL-UANON               TO BSKPCDA.
  9866
  9867     IF BINDGRPL NOT = ZEROS
  9868         MOVE AL-UANON               TO BINDGRPA.
  9869
  9870     IF BSIGL   NOT = ZEROS
  9871         MOVE AL-UANON               TO BSIGA.
  9872
  9873     IF BRTCLSL NOT = ZEROS
  9874         MOVE AL-UANON               TO BRTCLSA.
  9875
  9876     IF BMEMBERL NOT = ZEROS
  9877         MOVE AL-UANON               TO BMEMBERA.
  9878
  9879     MOVE +0                         TO WS-SUB1.
  9880
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 182
* EL6311.cbl
  9882
  9883******************************************************************
  9884*                                                                *
  9885*           E D I T   I S S U E   C O V E R A G E S              *
  9886*                                                                *
  9887******************************************************************
  9888
  9889 1020-EDIT-COVERAGES.
  9890     ADD +1                      TO WS-SUB1.
  9891
  9892     IF WS-SUB1 GREATER +2
  9893        GO TO 1025-EDIT-CONTINUE
  9894     END-IF
  9895
  9896     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9897       IF (BMODEL   GREATER ZERO  OR
  9898            BPMTSL   GREATER ZERO  OR
  9899            BPMTAMTL GREATER ZERO)
  9900          AND
  9901            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9902               GO TO 1021-CONT-EDIT.
  9903
  9904     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9905        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9906        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9907        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9908        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9909        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9910        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9911        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9912        NEXT SENTENCE
  9913         ELSE
  9914            GO TO 1020-EDIT-COVERAGES.
  9915
  9916 1021-CONT-EDIT.
  9917
  9918     IF BMAINTI = 'A'
  9919        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9920           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9921        ELSE
  9922           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9923           MOVE ER-7404          TO EMI-ERROR
  9924           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9925           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9926     ELSE
  9927        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9928           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9929
  9930     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9931        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9932        PERFORM 8600-DEEDIT
  9933        IF DEEDIT-FIELD-V0 NUMERIC
  9934           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9935        ELSE
  9936           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9937
  9938     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9939*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 183
* EL6311.cbl
  9940        IF BMODEL  GREATER THAN ZEROS  AND
  9941           BPMTSL  GREATER THAN ZEROS
  9942           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9943
  9944     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9945         IF BMODEL   GREATER THAN ZEROS  OR
  9946            BPMTSL   GREATER THAN ZEROS  OR
  9947            BPMTAMTL GREATER THAN ZEROS
  9948             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9949
  9950     IF BMAINTI = ('C' OR 'K')
  9951        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9952           NEXT SENTENCE
  9953        ELSE
  9954           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9955           PERFORM 8600-DEEDIT
  9956           IF DEEDIT-FIELD-V0 NUMERIC
  9957              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9958              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9959                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9960              ELSE
  9961                    MOVE ER-2241      TO EMI-ERROR
  9962                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9963                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9964                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9965           ELSE
  9966              MOVE ER-2223          TO EMI-ERROR
  9967              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9968              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9969              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9970     ELSE
  9971        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9972            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9973            PERFORM 8600-DEEDIT
  9974            IF DEEDIT-FIELD-V0      NUMERIC
  9975               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9976                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9977                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9978               ELSE
  9979                  MOVE ER-2241         TO EMI-ERROR
  9980                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9981                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9982                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9983            ELSE
  9984              MOVE ER-2223             TO EMI-ERROR
  9985              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9986              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9987              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9988        ELSE
  9989            MOVE ER-2240               TO EMI-ERROR
  9990            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9991            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9992*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9993*        IF BMODEL  GREATER THAN ZEROS  AND
  9994*           BPMTSL  GREATER THAN ZEROS
  9995*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9996
  9997     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 184
* EL6311.cbl
  9998        AND BMAINTI = ('C' OR 'K')
  9999           NEXT SENTENCE
 10000     ELSE
 10001        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10002           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10003
 10004* EXEC CICS BIF DEEDIT
 10005*              FIELD  (BBENI (WS-SUB1))
 10006*              LENGTH (12)
 10007*          END-EXEC
 10008     MOVE 12
 10009       TO DFHEIV11
 10010*    MOVE '@"L                   #   #00009916' TO DFHEIV0
 10011     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10012     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10013     MOVE X'2020233030303039393136' TO DFHEIV0(25:11)
 10014     CALL 'kxdfhei1' USING DFHEIV0,
 10015           BBENI(WS-SUB1),
 10016           DFHEIV11
 10017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10018           IF BBENI (WS-SUB1)  NUMERIC
 10019              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10020                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10021*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10022*          PERFORM 8600-DEEDIT
 10023*          IF DEEDIT-FIELD-V2  NUMERIC
 10024*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10025*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10026              ELSE
 10027                 MOVE ER-7632    TO EMI-ERROR
 10028                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10029                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10030                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10031           ELSE
 10032              MOVE ER-2223         TO EMI-ERROR
 10033              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10034              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10035              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10036        ELSE
 10037           MOVE ER-7632    TO EMI-ERROR
 10038           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10039           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10040           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10041
 10042     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10043        AND (BMAINTI = ('C' OR 'K'))
 10044        CONTINUE
 10045     ELSE
 10046        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10047           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10048           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10049              FOR ALL '.'
 10050           IF WS-TALLY > 1
 10051              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10052                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10053              END-PERFORM
 10054              IF A1 < 9
 10055                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 185
* EL6311.cbl
 10056                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10057              END-IF
 10058           ELSE
 10059              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10060                (A1 > 11)
 10061                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10062                  LOW-VALUES OR SPACES)
 10063              END-PERFORM
 10064              IF A1 > 1 AND < 12
 10065                 MOVE SPACES
 10066                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10067              END-IF
 10068           END-IF
 10069
 10070* EXEC CICS BIF DEEDIT
 10071*              FIELD  (BPREMI (WS-SUB1))
 10072*              LENGTH (11)
 10073*          END-EXEC
 10074     MOVE 11
 10075       TO DFHEIV11
 10076*    MOVE '@"L                   #   #00009971' TO DFHEIV0
 10077     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10078     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10079     MOVE X'2020233030303039393731' TO DFHEIV0(25:11)
 10080     CALL 'kxdfhei1' USING DFHEIV0,
 10081           BPREMI(WS-SUB1),
 10082           DFHEIV11
 10083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10084           IF BPREMI (WS-SUB1) NUMERIC
 10085              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10086                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10087*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10088*          PERFORM 8600-DEEDIT
 10089*          IF DEEDIT-FIELD-V2  NUMERIC
 10090*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10091*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10092              ELSE
 10093                 IF PI-COMPANY-ID NOT = 'DCC' and 'CAP'
 10094                    MOVE ER-7633    TO EMI-ERROR
 10095                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10096                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10097                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10098                 END-IF
 10099              END-IF
 10100           ELSE
 10101              MOVE ER-2223         TO EMI-ERROR
 10102              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10103              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10104              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10105           END-IF
 10106        ELSE
 10107           IF PI-COMPANY-ID NOT = 'DCC' and 'CAP'
 10108              MOVE ER-7633         TO EMI-ERROR
 10109              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10110              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10111              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10112           END-IF
 10113        END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 186
* EL6311.cbl
 10114     END-IF
 10115
 10116     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10117        NEXT SENTENCE
 10118     ELSE
 10119        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10120
 10121* EXEC CICS BIF DEEDIT
 10122*           FIELD  (BCPREMI (WS-SUB1))
 10123*           LENGTH (11)
 10124*       END-EXEC
 10125     MOVE 11
 10126       TO DFHEIV11
 10127*    MOVE '@"L                   #   #00010011' TO DFHEIV0
 10128     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10129     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10130     MOVE X'2020233030303130303131' TO DFHEIV0(25:11)
 10131     CALL 'kxdfhei1' USING DFHEIV0,
 10132           BCPREMI(WS-SUB1),
 10133           DFHEIV11
 10134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10135        IF BCPREMI (WS-SUB1) NUMERIC
 10136           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10137*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10138*       PERFORM 8600-DEEDIT
 10139*       IF DEEDIT-FIELD-V2  NUMERIC
 10140*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10141        ELSE
 10142           MOVE ER-2223         TO EMI-ERROR
 10143           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10144           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10145           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10146
 10147     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10148        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10149        PERFORM 8600-DEEDIT
 10150        IF DEEDIT-FIELD-V0 NUMERIC
 10151           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10152           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10153         ELSE
 10154           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10155           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10156           MOVE ER-2223              TO EMI-ERROR
 10157           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10158
 10159     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10160        IF BEXPIRE   (WS-SUB1) = SPACES
 10161           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10162        ELSE
 10163           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10164           PERFORM 8600-DEEDIT
 10165           IF DEEDIT-FIELD-V0        NUMERIC
 10166              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10167              MOVE 4                TO DC-OPTION-CODE
 10168              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10169              PERFORM 9700-DATE-LINK
 10170              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10171                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 187
* EL6311.cbl
 10172              IF NO-CONVERSION-ERROR
 10173                 NEXT SENTENCE
 10174              ELSE
 10175                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10176                 MOVE ER-2531    TO EMI-ERROR
 10177                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10178                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10179           ELSE
 10180             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10181             MOVE ER-2532        TO EMI-ERROR
 10182             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10183             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10184
 10185     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10186        NEXT SENTENCE
 10187     ELSE
 10188
 10189* EXEC CICS BIF DEEDIT
 10190*           FIELD  (BALT-BENI (WS-SUB1))
 10191*           LENGTH (12)
 10192*       END-EXEC
 10193     MOVE 12
 10194       TO DFHEIV11
 10195*    MOVE '@"L                   #   #00010068' TO DFHEIV0
 10196     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10197     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10198     MOVE X'2020233030303130303638' TO DFHEIV0(25:11)
 10199     CALL 'kxdfhei1' USING DFHEIV0,
 10200           BALT-BENI(WS-SUB1),
 10201           DFHEIV11
 10202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10203        IF BALT-BENI (WS-SUB1) NUMERIC
 10204           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10205*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10206*       PERFORM 8600-DEEDIT
 10207*       IF DEEDIT-FIELD-V0 NUMERIC
 10208*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10209        ELSE
 10210           MOVE ER-2223         TO EMI-ERROR
 10211           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10212           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10213           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10214
 10215     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10216        NEXT SENTENCE
 10217     ELSE
 10218
 10219* EXEC CICS BIF DEEDIT
 10220*           FIELD  (BALT-PREMI (WS-SUB1))
 10221*           LENGTH (11)
 10222*       END-EXEC
 10223     MOVE 11
 10224       TO DFHEIV11
 10225*    MOVE '@"L                   #   #00010087' TO DFHEIV0
 10226     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10227     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10228     MOVE X'2020233030303130303837' TO DFHEIV0(25:11)
 10229     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 188
* EL6311.cbl
 10230           BALT-PREMI(WS-SUB1),
 10231           DFHEIV11
 10232     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10233        IF BALT-PREMI (WS-SUB1) NUMERIC
 10234           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10235*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10236*       PERFORM 8600-DEEDIT
 10237*       IF DEEDIT-FIELD-V0 NUMERIC
 10238*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10239        ELSE
 10240           MOVE ER-2223         TO EMI-ERROR
 10241           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10242           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10243           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10244
 10245      GO TO 1020-EDIT-COVERAGES.
 10246     .
 10247 1025-edit-continue.
 10248     IF PI-COMPANY-ID  =  'DMD'
 10249        MOVE LOW-VALUES             TO BNCERTI
 10250                                       BNSTATI.
 10251
 10252     IF EMI-ERROR = ZEROS
 10253         NEXT SENTENCE
 10254     ELSE
 10255         GO TO 8200-SEND-DATAONLY.
 10256
 10257     IF BMAINTI = 'A'
 10258         GO TO 1200-ADD-ISSUE-ROUTINE.
 10259
 10260     IF BMAINTI = 'C'
 10261         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10262
 10263     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10264
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 189
* EL6311.cbl
 10266
 10267 1030-EDIT-FOR-NUMERICS.
 10268     IF WS-CSO-SUB EQUAL 10
 10269        GO TO 1030-EDIT-EXIT.
 10270
 10271     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10272        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10273        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10274           ADD +1               TO WS-CSO-SUB
 10275           GO TO 1030-EDIT-FOR-NUMERICS.
 10276
 10277     MOVE 'N'                   TO WS-NUMERIC-SW.
 10278
 10279 1030-EDIT-EXIT.
 10280******************************************************************
 10281*                                                                *
 10282*                 C A L C U L A T E   A G E                      *
 10283*                                                                *
 10284******************************************************************
 10285
 10286
 10287 1095-CALC-AGE.
 10288
 10289     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10290     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10291     MOVE 1                  TO DC-OPTION-CODE.
 10292     PERFORM 9700-DATE-LINK
 10293     IF NO-CONVERSION-ERROR
 10294         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10295         MOVE WS-BAGE            TO BAGEI
 10296         MOVE +2                 TO BAGEL
 10297         MOVE AL-UNNON TO BAGEA.
 10298
 10299 1099-EXIT.
 10300     EXIT.
 10301
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 190
* EL6311.cbl
 10303
 10304******************************************************************
 10305*                                                                *
 10306*                   S H O W   I S S U E                          *
 10307*                                                                *
 10308******************************************************************
 10309
 10310 1100-SHOW-REQUEST.
 10311     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10312
 10313     IF BCERTNOL = ZEROS AND
 10314        BEFFDTL  = ZEROS
 10315        MOVE -1                  TO BMAINTL
 10316        GO TO 8200-SEND-DATAONLY.
 10317
 10318     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10319
 10320     IF BSUFIXL NOT = ZEROS
 10321        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10322     ELSE
 10323        MOVE SPACE               TO WS-NEW-SUFFIX.
 10324
 10325     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10326     PERFORM 8600-DEEDIT.
 10327     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10328     MOVE '4'                    TO DC-OPTION-CODE.
 10329     PERFORM 9700-DATE-LINK.
 10330     IF DATE-CONVERSION-ERROR
 10331        MOVE ER-0348             TO EMI-ERROR
 10332        MOVE -1                  TO BEFFDTL
 10333        MOVE AL-UABON            TO BEFFDTA
 10334        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10335        GO TO 8200-SEND-DATAONLY
 10336     ELSE
 10337        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10338        MOVE AL-UANON            TO BEFFDTA
 10339        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10340
 10341     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10342
 10343     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10344        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10345          MOVE 'Y'                    TO WS-SHOW-SW
 10346          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10347             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10348           ELSE
 10349             IF PI-FILE-BROWSE
 10350                GO TO 4300-BROWSE-FILE-FORWARD
 10351              ELSE
 10352                IF PI-CSR-BROWSE
 10353                   GO TO 4200-BROWSE-CSR-FORWARD
 10354                ELSE
 10355                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10356        ELSE
 10357           GO TO 3900-RE-DISPLAY-RECORD.
 10358
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 191
* EL6311.cbl
 10360
 10361******************************************************************
 10362*                                                                *
 10363*            A D D   I S S U E   R O U T I N E                   *
 10364*                                                                *
 10365******************************************************************
 10366
 10367***************************************************************
 10368*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10369*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10370*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10371*     4. LINK TO THE EDIT ROUTINE.                            *
 10372*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10373*     6. WRITE THE NEW ISSUE RECORD.                          *
 10374*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10375*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10376*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10377*        ELSE                                                 *
 10378*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10379***************************************************************
 10380
 10381 1200-ADD-ISSUE-ROUTINE.
 10382     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10383
 10384
 10385* EXEC CICS GETMAIN
 10386*        SET     (ADDRESS OF PENDING-BUSINESS)
 10387*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10388*    END-EXEC.
 10389*    MOVE '," L                  $   #00010242' TO DFHEIV0
 10390     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10391     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10392     MOVE X'2020233030303130323432' TO DFHEIV0(25:11)
 10393     CALL 'kxdfhei1' USING DFHEIV0,
 10394           DFHEIV20,
 10395           ERPNDB-RECORD-LENGTH,
 10396           DFHEIV99
 10397     SET ADDRESS OF PENDING-BUSINESS TO
 10398         DFHEIV20
 10399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10400
 10401
 10402
 10403* EXEC CICS HANDLE CONDITION
 10404*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10405*    END-EXEC.
 10406*    MOVE '"$I                   ! # #00010247' TO DFHEIV0
 10407     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10408     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10409     MOVE X'2320233030303130323437' TO DFHEIV0(25:11)
 10410     CALL 'kxdfhei1' USING DFHEIV0
 10411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10412
 10413
 10414     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10415     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10416     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10417
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 192
* EL6311.cbl
 10418
 10419* EXEC CICS READ
 10420*        INTO    (PENDING-BUSINESS)
 10421*        DATASET (FILE-ID-ERPNDB)
 10422*        RIDFLD  (ERPNDB-KEY)
 10423*    END-EXEC.
 10424     MOVE LENGTH OF
 10425      PENDING-BUSINESS
 10426       TO DFHEIV11
 10427*    MOVE '&"IL       E          (   #00010255' TO DFHEIV0
 10428     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10430     MOVE X'2020233030303130323535' TO DFHEIV0(25:11)
 10431     CALL 'kxdfhei1' USING DFHEIV0,
 10432           FILE-ID-ERPNDB,
 10433           PENDING-BUSINESS,
 10434           DFHEIV11,
 10435           ERPNDB-KEY,
 10436           DFHEIV99,
 10437           DFHEIV99,
 10438           DFHEIV99
 10439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10440
 10441
 10442     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10443
 10444     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10445     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10446     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10447     MOVE SPACES                 TO PENDING-BUSINESS.
 10448     MOVE 'PB'                   TO PB-RECORD-ID.
 10449     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10450     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10451     MOVE SPACES                 TO PB-CERT-SFX.
 10452     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10453     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10454                                    PB-ALT-CHG-SEQ-NO.
 10455
 10456     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10457     MOVE '1'                    TO PB-RECORD-TYPE.
 10458
 10459     IF BSUFIXL NOT = ZEROS
 10460        MOVE BSUFIXI             TO PB-CERT-SFX.
 10461
 10462     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10463
 10464     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10465     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10466
 10467     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10468                                    PB-I-LF-PREM-CALC
 10469                                    PB-I-LF-ALT-PREM-CALC
 10470                                    PB-I-LF-RATE
 10471                                    PB-I-LF-ALT-RATE
 10472                                    PB-I-LF-REI-RATE
 10473                                    PB-I-LF-ALT-REI-RATE
 10474                                    PB-I-RATE-DEV-PCT-LF
 10475                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 193
* EL6311.cbl
 10476                                    PB-I-AH-RATE
 10477                                    PB-I-AH-REI-RATE
 10478                                    PB-I-AH-RATE-TRM
 10479                                    PB-I-RATE-DEV-PCT-AH
 10480                                    PB-I-BUSINESS-TYPE
 10481                                    PB-I-LIFE-COMMISSION
 10482                                    PB-I-JOINT-COMMISSION
 10483                                    PB-I-JOINT-AGE
 10484                                    PB-I-AH-COMMISSION
 10485                                    PB-I-CURR-SEQ
 10486                                    PB-CHG-COUNT
 10487                                    PB-LF-BILLED-AMTS
 10488                                    PB-AH-BILLED-AMTS
 10489                                    PB-CALC-TOLERANCE
 10490                                    PB-I-EXTENTION-DAYS
 10491*                                   PB-I-MICROFILM-NO
 10492                                    PB-I-TERM-IN-DAYS.
 10493
 10494     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10495                                    PB-I-LF-EXPIRE-DT
 10496                                    PB-I-AH-EXPIRE-DT
 10497                                    PB-BILLED-DT
 10498                                    PB-ACCT-EFF-DT
 10499                                    PB-ACCT-EXP-DT
 10500                                    PB-I-1ST-PMT-DT.
 10501
 10502     MOVE 'X'                    TO PB-FATAL-FLAG.
 10503
 10504     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10505
 10506     IF BLSTNML GREATER THAN ZEROS
 10507         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10508
 10509*    IF BMICRNOL  GREATER  ZEROS
 10510*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10511*    ELSE
 10512*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10513     IF BVINL > ZEROS
 10514        MOVE BVINI               TO PB-I-VIN
 10515     END-IF
 10516     IF B1STNML GREATER THAN ZEROS
 10517         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10518
 10519     IF BINITL  GREATER THAN ZEROS
 10520         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10521
 10522     IF BBIRTHL GREATER THAN ZERO
 10523         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10524     ELSE
 10525         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10526
 10527     IF B1STPMTL GREATER THAN ZERO
 10528         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10529     ELSE
 10530         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10531
 10532     IF BAGEL    GREATER THAN ZEROS
 10533         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 194
* EL6311.cbl
 10534        ELSE
 10535         MOVE ZEROS              TO PB-I-AGE.
 10536
 10537     IF BSEXL    GREATER THAN ZEROS
 10538         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10539
 10540     IF BTERM-LEN (1) GREATER THAN ZEROS
 10541        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10542     ELSE
 10543        MOVE ZEROS               TO PB-I-LF-TERM.
 10544
 10545     IF BTERM-LEN (2) GREATER THAN ZEROS
 10546        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10547     ELSE
 10548        MOVE ZEROS               TO PB-I-AH-TERM.
 10549
 10550     IF BLNTRML       GREATER THAN ZEROS
 10551         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10552        ELSE
 10553         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10554
 10555     IF BFREQL        GREATER THAN ZEROS
 10556         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10557        ELSE
 10558         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10559
 10560     IF BSKPCDL       GREATER THAN ZEROS
 10561         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10562
 10563     IF BMODEL        GREATER THAN ZEROS
 10564         MOVE BMODEI             TO PB-I-TERM-TYPE
 10565                                    PI-BMODE.
 10566
 10567     IF BPMTSL        GREATER THAN ZEROS
 10568         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10569                                    PI-BPMTS
 10570        ELSE
 10571         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10572                                    PI-BPMTS.
 10573
 10574     IF BPMTAMTL      GREATER THAN ZEROS
 10575         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10576        ELSE
 10577         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10578
 10579     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10580        IF BTYPE  (1)   NOT = ZEROS
 10581           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10582                                    PI-BTYPE (1)
 10583           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10584           MOVE SPACES           TO PB-I-LF-ABBR
 10585        ELSE
 10586           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10587                                    PB-I-LF-ABBR
 10588           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10589     ELSE
 10590        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10591                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 195
* EL6311.cbl
 10592        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10593
 10594     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10595         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10596     ELSE
 10597         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10598
 10599     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10600         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10601     ELSE
 10602         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10603
 10604     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10605         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10606            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10607            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10608         ELSE
 10609            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10610*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10611*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10612         END-IF
 10613     ELSE
 10614         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10615
 10616     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10617         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10618
 10619     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10620         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10621         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10622     ELSE
 10623         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10624
 10625     IF  BALT-PREM-LEN     (2) > ZEROS
 10626         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10627     ELSE
 10628         MOVE ZEROS            TO PB-I-TOT-FEES.
 10629
 10630     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10631        IF BTYPE      (2)   NOT = ZEROS
 10632           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10633                                  PI-BTYPE (2)
 10634           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10635           MOVE SPACES         TO PB-I-AH-ABBR
 10636        ELSE
 10637           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10638                                  PB-I-AH-ABBR
 10639           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10640     ELSE
 10641        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10642                                  PB-I-AH-ABBR
 10643        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10644
 10645     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10646         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10647     ELSE
 10648         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10649
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 196
* EL6311.cbl
 10650     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10651         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10652            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10653            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10654         ELSE
 10655            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10656*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10657*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10658         END-IF
 10659     ELSE
 10660         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10661
 10662     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10663         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10664
 10665     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10666        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10667     ELSE
 10668        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10669
 10670     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10671        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10672     ELSE
 10673        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10674
 10675     IF BINDGRPL  GREATER THAN ZEROS
 10676         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10677
 10678     IF BRTCLSL   GREATER THAN ZEROS
 10679         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10680
 10681     IF BSIGL     GREATER THAN ZEROS
 10682         MOVE BSIGI              TO PB-I-SIG-SW.
 10683     IF BAPRL > ZEROS
 10684         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10685     ELSE
 10686        if pi-company-id = 'CID'
 10687           move +99.9999         to pb-i-loan-apr
 10688        else
 10689           MOVE ZEROS            TO PB-I-LOAN-APR
 10690        end-if
 10691     end-if
 10692     IF BMEMBERL  GREATER THAN ZEROS
 10693         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10694
 10695     IF BLNOFCRL  GREATER THAN ZEROS
 10696         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10697
 10698     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10699        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10700     ELSE
 10701        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10702
 10703     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10704        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10705     ELSE
 10706        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10707
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 197
* EL6311.cbl
 10708     IF BDAYSL   GREATER THAN ZEROS
 10709        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10710                                    PB-I-EXTENTION-DAYS
 10711     ELSE
 10712        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10713                                    PB-I-EXTENTION-DAYS.
 10714
 10715     IF BDAYSL GREATER THAN ZEROS
 10716        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10717
 10718     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10719        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10720           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10721
 10722     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10723        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10724           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10725
 10726     IF B1STPMTL GREATER THAN ZEROS
 10727        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10728
 10729     IF PB-EXT-DAYS-PROCESSING
 10730        IF PB-I-EXTENTION-DAYS = ZEROS
 10731           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10732
 10733     IF PB-EXPIRE-DT-PROCESSING
 10734        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10735           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10736             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10737
 10738     IF PB-1ST-PMT-DT-PROCESSING
 10739        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10740           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10741
 10742     IF BREINL GREATER THAN ZEROS
 10743        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10744
 10745     IF BENTRYL NOT = ZEROS
 10746        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10747        IF PI-COMPANY-ID = 'CID'
 10748           AND (PB-BATCH-ENTRY = 'P')
 10749           AND (PB-STATE = 'VA')
 10750           PERFORM 1500-UPDATE-ERNOTE
 10751                                 THRU 1500-EXIT
 10752        END-IF
 10753     END-IF
 10754     IF BUNWRITL NOT = ZEROS
 10755        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10756
 10757     IF BFORCEL NOT = ZEROS
 10758        MOVE BFORCEI             TO PB-FORCE-CODE.
 10759
 10760     IF BBILCDL NOT = ZEROS
 10761        MOVE BBILCDI             TO PB-RECORD-BILL.
 10762
 10763     IF BLIVESL GREATER THAN ZEROS
 10764        MOVE WS-BLIVES           TO PB-I-LIVES
 10765     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 198
* EL6311.cbl
 10766        MOVE ZEROS               TO PB-I-LIVES.
 10767
 10768     IF BBILLEDL GREATER THAN ZEROS
 10769        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10770     ELSE
 10771        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10772
 10773*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10774
 10775 1260-WRITE-PB-RECORD.
 10776     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10777                                    PB-INPUT-BY.
 10778     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10779     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10780                                    PB-INPUT-DT.
 10781
 10782     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10783     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10784                                    PB-CONTROL-BY-ORIG-BATCH.
 10785
 10786
 10787     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10788     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10789     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10790     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10791     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10792
 10793     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10794
 10795     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10796
 10797     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10798     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10799     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10800
 10801     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10802     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10803
 10804 1275-WRITE-PENDING-BUSINESS.
 10805     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10806     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10807     MOVE 'A'                    TO JP-RECORD-TYPE.
 10808     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10809
 10810
 10811* EXEC CICS HANDLE CONDITION
 10812*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10813*    END-EXEC.
 10814*    MOVE '"$%                   ! $ #00010629' TO DFHEIV0
 10815     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10817     MOVE X'2420233030303130363239' TO DFHEIV0(25:11)
 10818     CALL 'kxdfhei1' USING DFHEIV0
 10819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10820
 10821
 10822
 10823* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 199
* EL6311.cbl
 10824*        DATASET (FILE-ID-ERPNDB)
 10825*        FROM    (PENDING-BUSINESS)
 10826*        RIDFLD  (PB-CONTROL-PRIMARY)
 10827*    END-EXEC.
 10828     MOVE LENGTH OF
 10829      PENDING-BUSINESS
 10830       TO DFHEIV11
 10831*    MOVE '&$ L                  ''   #00010633' TO DFHEIV0
 10832     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10833     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10834     MOVE X'2020233030303130363333' TO DFHEIV0(25:11)
 10835     CALL 'kxdfhei1' USING DFHEIV0,
 10836           FILE-ID-ERPNDB,
 10837           PENDING-BUSINESS,
 10838           DFHEIV11,
 10839           PB-CONTROL-PRIMARY,
 10840           DFHEIV99,
 10841           DFHEIV99
 10842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10843
 10844
 10845     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10846
 10847     PERFORM 8400-LOG-JOURNAL-RECORD.
 10848
 10849******************************************************************
 10850*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10851******************************************************************
 10852*    display ' made it to add orig cert '
 10853     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10854     MOVE ' '                    TO WS-ERMAIL-SW
 10855
 10856* EXEC CICS READ
 10857*       DATASET   (FILE-ID-ERMAIL)
 10858*       SET       (ADDRESS OF MAILING-DATA)
 10859*       RIDFLD    (ERMAIL-KEY)
 10860*       RESP      (WS-RESPONSE)
 10861*    END-EXEC
 10862*    MOVE '&"S        E          (  N#00010649' TO DFHEIV0
 10863     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10864     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10865     MOVE X'204E233030303130363439' TO DFHEIV0(25:11)
 10866     CALL 'kxdfhei1' USING DFHEIV0,
 10867           FILE-ID-ERMAIL,
 10868           DFHEIV20,
 10869           DFHEIV99,
 10870           ERMAIL-KEY,
 10871           DFHEIV99,
 10872           DFHEIV99,
 10873           DFHEIV99
 10874     SET ADDRESS OF MAILING-DATA TO
 10875         DFHEIV20
 10876     MOVE EIBRESP  TO WS-RESPONSE
 10877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10878     IF RESP-NORMAL
 10879        SET ERMAIL-FOUND TO TRUE
 10880     END-IF
 10881
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 200
* EL6311.cbl
 10882     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10883     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10884     MOVE 'OC'                   TO OC-RECORD-ID
 10885     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10886                                 TO OC-CONTROL-PRIMARY (1:33)
 10887     MOVE 'I'                    TO OC-RECORD-TYPE
 10888     MOVE +4096                  TO OC-KEY-SEQ-NO
 10889     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10890     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10891     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10892     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10893     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10894     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10895     MOVE PB-I-AGE               TO OC-INS-AGE
 10896     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10897     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10898     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10899     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10900     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10901     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10902     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10903     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10904     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10905     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10906     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10907     IF PB-I-JOINT-COMMISSION > +0
 10908         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10909     ELSE
 10910         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10911     END-IF
 10912     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10913     MOVE +0                     TO OC-LF-CANCEL-AMT
 10914                                    OC-LF-ITD-CANCEL-AMT
 10915     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10916     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10917     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10918     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10919     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10920     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10921     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10922     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10923     MOVE +0                     TO OC-AH-CANCEL-AMT
 10924                                    OC-AH-ITD-CANCEL-AMT
 10925     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10926     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10927     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10928     IF ERMAIL-FOUND
 10929        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10930     END-IF
 10931     IF NOT CERT-TRL-REC-NOT-FOUND
 10932        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10933                           OC-INS-AGE-DEFAULT-FLAG
 10934        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10935                           OC-JNT-AGE-DEFAULT-FLAG
 10936     END-IF
 10937     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10938     .
 10939 1275-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 201
* EL6311.cbl
 10940
 10941* EXEC CICS WRITE
 10942*       DATASET   ('ELCRTO')
 10943*       FROM      (ORIGINAL-CERTIFICATE)
 10944*       RIDFLD    (OC-CONTROL-PRIMARY)
 10945*       RESP      (WS-RESPONSE)
 10946*    END-EXEC
 10947     MOVE LENGTH OF
 10948      ORIGINAL-CERTIFICATE
 10949       TO DFHEIV11
 10950     MOVE 'ELCRTO' TO DFHEIV1
 10951*    MOVE '&$ L                  ''  N#00010717' TO DFHEIV0
 10952     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10953     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10954     MOVE X'204E233030303130373137' TO DFHEIV0(25:11)
 10955     CALL 'kxdfhei1' USING DFHEIV0,
 10956           DFHEIV1,
 10957           ORIGINAL-CERTIFICATE,
 10958           DFHEIV11,
 10959           OC-CONTROL-PRIMARY,
 10960           DFHEIV99,
 10961           DFHEIV99
 10962     MOVE EIBRESP  TO WS-RESPONSE
 10963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10964*    display ' just wrote 1275 ' ws-response
 10965     IF RESP-DUPKEY
 10966        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10967        GO TO 1275-WRITE-ELCRTO
 10968     ELSE
 10969        IF NOT RESP-NORMAL
 10970           MOVE -1               TO BMAINTL
 10971           MOVE ER-7450          TO EMI-ERROR
 10972           PERFORM 9900-ERROR-FORMAT
 10973                                 THRU 9900-EXIT
 10974           GO TO 8200-SEND-DATAONLY
 10975        END-IF
 10976     END-IF
 10977******************************************************************
 10978*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10979******************************************************************
 10980
 10981
 10982* EXEC CICS READ
 10983*        INTO    (PENDING-BUSINESS)
 10984*        DATASET (FILE-ID-ERPNDB)
 10985*        RIDFLD  (ERPNDB-KEY)
 10986*        UPDATE
 10987*    END-EXEC.
 10988     MOVE LENGTH OF
 10989      PENDING-BUSINESS
 10990       TO DFHEIV11
 10991*    MOVE '&"IL       EU         (   #00010740' TO DFHEIV0
 10992     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10993     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10994     MOVE X'2020233030303130373430' TO DFHEIV0(25:11)
 10995     CALL 'kxdfhei1' USING DFHEIV0,
 10996           FILE-ID-ERPNDB,
 10997           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 202
* EL6311.cbl
 10998           DFHEIV11,
 10999           ERPNDB-KEY,
 11000           DFHEIV99,
 11001           DFHEIV99,
 11002           DFHEIV99
 11003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11004
 11005
 11006     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11007     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11008     MOVE 'B'                    TO JP-RECORD-TYPE.
 11009     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11010
 11011     PERFORM 8400-LOG-JOURNAL-RECORD.
 11012
 11013     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11014
 11015
 11016* EXEC CICS REWRITE
 11017*        DATASET (FILE-ID-ERPNDB)
 11018*        FROM    (PENDING-BUSINESS)
 11019*    END-EXEC.
 11020     MOVE LENGTH OF
 11021      PENDING-BUSINESS
 11022       TO DFHEIV11
 11023*    MOVE '&& L                  %   #00010756' TO DFHEIV0
 11024     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11025     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11026     MOVE X'2020233030303130373536' TO DFHEIV0(25:11)
 11027     CALL 'kxdfhei1' USING DFHEIV0,
 11028           FILE-ID-ERPNDB,
 11029           PENDING-BUSINESS,
 11030           DFHEIV11,
 11031           DFHEIV99
 11032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11033
 11034
 11035     MOVE 'C'                    TO JP-RECORD-TYPE.
 11036     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11037
 11038     PERFORM 8400-LOG-JOURNAL-RECORD.
 11039
 11040     IF WS-ERRORS-PRESENT
 11041         GO TO 3900-RE-DISPLAY-RECORD.
 11042
 11043     MOVE ZEROS                  TO EMI-ERROR.
 11044     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11045     MOVE LOW-VALUES             TO EL631BI.
 11046     MOVE  -1                    TO BMAINTL.
 11047     GO TO 8100-SEND-INITIAL-MAP.
 11048
 11049 1280-BATCH-HDR-NOT-FOUND.
 11050     MOVE -1                     TO BMAINTL.
 11051     MOVE ER-7450                TO EMI-ERROR.
 11052     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11053     GO TO 8200-SEND-DATAONLY.
 11054
 11055 1290-DUPLICATE-ALT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 203
* EL6311.cbl
 11056
 11057******************************************************************
 11058*                                                                *
 11059*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11060*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11061*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11062*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11063*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11064*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11065*                                                                *
 11066******************************************************************
 11067
 11068     IF LCP-ONCTR-01 =  0
 11069         ADD 1 TO LCP-ONCTR-01
 11070        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11071
 11072     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11073
 11074     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11075         NEXT SENTENCE
 11076     ELSE
 11077         ADD +1 TO PB-BATCH-SEQ-NO
 11078                   PB-CSR-BATCH-SEQ-NO
 11079         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11080         GO TO 1275-WRITE-PENDING-BUSINESS.
 11081
 11082     MOVE -1                     TO BCERTNOL.
 11083     MOVE AL-UABON               TO BCERTNOA.
 11084     MOVE AL-UNBON               TO BEFFDTA.
 11085
 11086     MOVE 1                      TO EMI-SUB
 11087                                    EMI-SWITCH1
 11088                                    EMI-SWITCH-AREA-1
 11089                                    EMI-SWITCH-AREA-2.
 11090
 11091     MOVE SPACES                 TO EMI-ERROR-LINES.
 11092
 11093
 11094* EXEC CICS SYNCPOINT ROLLBACK
 11095*    END-EXEC.
 11096*    MOVE '6"R                   !   #00010819' TO DFHEIV0
 11097     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11099     MOVE X'2020233030303130383139' TO DFHEIV0(25:11)
 11100     CALL 'kxdfhei1' USING DFHEIV0
 11101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11102
 11103
 11104     MOVE ER-2247                TO EMI-ERROR.
 11105     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11106     GO TO 8200-SEND-DATAONLY.
 11107
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 204
* EL6311.cbl
 11109
 11110
 11111 1295-READ-CERT-TRAILER.
 11112
 11113
 11114* EXEC CICS GETMAIN
 11115*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11116*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11117*        INITIMG (GETMAIN-SPACE)
 11118*    END-EXEC
 11119*    MOVE ',"IL                  $   #00010831' TO DFHEIV0
 11120     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11121     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11122     MOVE X'2020233030303130383331' TO DFHEIV0(25:11)
 11123     CALL 'kxdfhei1' USING DFHEIV0,
 11124           DFHEIV20,
 11125           ELCRTT-RECORD-LENGTH,
 11126           GETMAIN-SPACE
 11127     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11128         DFHEIV20
 11129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11130
 11131     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11132     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11133     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11134
 11135
 11136* EXEC CICS HANDLE CONDITION
 11137*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11138*    END-EXEC.
 11139*    MOVE '"$I                   ! % #00010841' TO DFHEIV0
 11140     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11141     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11142     MOVE X'2520233030303130383431' TO DFHEIV0(25:11)
 11143     CALL 'kxdfhei1' USING DFHEIV0
 11144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11145
 11146
 11147
 11148* EXEC CICS READ
 11149*        DATASET  (CRTT-ID)
 11150*        RIDFLD   (ELCRTT-KEY)
 11151*        INTO     (CERTIFICATE-TRAILERS)
 11152*    END-EXEC.
 11153     MOVE LENGTH OF
 11154      CERTIFICATE-TRAILERS
 11155       TO DFHEIV11
 11156*    MOVE '&"IL       E          (   #00010845' TO DFHEIV0
 11157     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11158     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11159     MOVE X'2020233030303130383435' TO DFHEIV0(25:11)
 11160     CALL 'kxdfhei1' USING DFHEIV0,
 11161           CRTT-ID,
 11162           CERTIFICATE-TRAILERS,
 11163           DFHEIV11,
 11164           ELCRTT-KEY,
 11165           DFHEIV99,
 11166           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 205
* EL6311.cbl
 11167           DFHEIV99
 11168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11169
 11170
 11171     GO TO 1295-EXIT.
 11172
 11173 1295-CERT-TRL-REC-NOTFND.
 11174     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11175
 11176 1295-EXIT.
 11177     EXIT.
 11178
 11179******************************************************************
 11180*                                                                *
 11181*          C H A N G E   I S S U E   R O U T I N E               *
 11182*                                                                *
 11183******************************************************************
 11184
 11185***************************************************************
 11186*                                                             *
 11187*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11188*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11189*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11190*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11191*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11192*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11193*     5. LINK TO THE EDIT ROUTINE.                            *
 11194*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11195*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11196*              THE EDIT ROUTINE.                              *
 11197*     7. REWRITE THE NEW ISSUE                                *
 11198*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11199*                                                             *
 11200***************************************************************
 11201
 11202 1300-CHANGE-ISSUE-ROUTINE.
 11203     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11204
 11205     IF BCHGL NOT = ZEROS
 11206        MOVE ER-2196             TO EMI-ERROR
 11207        MOVE AL-UABON            TO BMAINTA
 11208        MOVE -1                  TO BMAINTL
 11209        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11210        GO TO 8200-SEND-DATAONLY.
 11211
 11212     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11213
 11214     IF BSUFIXL NOT = ZEROS
 11215        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11216     ELSE
 11217        MOVE SPACE               TO WS-NEW-SUFFIX.
 11218
 11219     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11220     PERFORM 8600-DEEDIT.
 11221     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11222     MOVE '4'                    TO DC-OPTION-CODE.
 11223     PERFORM 9700-DATE-LINK.
 11224     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 206
* EL6311.cbl
 11225        MOVE ER-0348             TO EMI-ERROR
 11226        MOVE -1                  TO BEFFDTL
 11227        MOVE AL-UABON            TO BEFFDTA
 11228        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11229        GO TO 8200-SEND-DATAONLY
 11230     ELSE
 11231        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11232        MOVE AL-UANON            TO BEFFDTA
 11233        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11234
 11235 1325-PROCESS-ISSUE-CHANGES.
 11236
 11237* EXEC CICS HANDLE CONDITION
 11238*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11239*    END-EXEC.
 11240*    MOVE '"$I                   ! & #00010916' TO DFHEIV0
 11241     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11243     MOVE X'2620233030303130393136' TO DFHEIV0(25:11)
 11244     CALL 'kxdfhei1' USING DFHEIV0
 11245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11246
 11247
 11248     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11249     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11250     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11251
 11252
 11253* EXEC CICS GETMAIN
 11254*        SET      (ADDRESS OF PENDING-BUSINESS)
 11255*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11256*        INITIMG  (GETMAIN-SPACE)
 11257*     END-EXEC.
 11258*    MOVE ',"IL                  $   #00010924' TO DFHEIV0
 11259     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11260     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11261     MOVE X'2020233030303130393234' TO DFHEIV0(25:11)
 11262     CALL 'kxdfhei1' USING DFHEIV0,
 11263           DFHEIV20,
 11264           ERPNDB-RECORD-LENGTH,
 11265           GETMAIN-SPACE
 11266     SET ADDRESS OF PENDING-BUSINESS TO
 11267         DFHEIV20
 11268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11269
 11270
 11271
 11272* EXEC CICS READ
 11273*        INTO    (PENDING-BUSINESS)
 11274*        DATASET (FILE-ID-ERPNDB)
 11275*        RIDFLD  (ERPNDB-KEY)
 11276*    END-EXEC.
 11277     MOVE LENGTH OF
 11278      PENDING-BUSINESS
 11279       TO DFHEIV11
 11280*    MOVE '&"IL       E          (   #00010930' TO DFHEIV0
 11281     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 207
* EL6311.cbl
 11283     MOVE X'2020233030303130393330' TO DFHEIV0(25:11)
 11284     CALL 'kxdfhei1' USING DFHEIV0,
 11285           FILE-ID-ERPNDB,
 11286           PENDING-BUSINESS,
 11287           DFHEIV11,
 11288           ERPNDB-KEY,
 11289           DFHEIV99,
 11290           DFHEIV99,
 11291           DFHEIV99
 11292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11293
 11294
 11295     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11296
 11297
 11298* EXEC CICS HANDLE CONDITION
 11299*         NOTFND     (1385-REC-NOT-FOUND)
 11300*    END-EXEC.
 11301*    MOVE '"$I                   ! '' #00010938' TO DFHEIV0
 11302     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11304     MOVE X'2720233030303130393338' TO DFHEIV0(25:11)
 11305     CALL 'kxdfhei1' USING DFHEIV0
 11306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11307
 11308
 11309**********************************************************
 11310*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11311*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11312**********************************************************
 11313
 11314
 11315* EXEC CICS READ
 11316*        DATASET (FILE-ID-ERPNDB)
 11317*        INTO    (PENDING-BUSINESS)
 11318*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11319*    END-EXEC.
 11320     MOVE LENGTH OF
 11321      PENDING-BUSINESS
 11322       TO DFHEIV11
 11323*    MOVE '&"IL       E          (   #00010947' TO DFHEIV0
 11324     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11325     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11326     MOVE X'2020233030303130393437' TO DFHEIV0(25:11)
 11327     CALL 'kxdfhei1' USING DFHEIV0,
 11328           FILE-ID-ERPNDB,
 11329           PENDING-BUSINESS,
 11330           DFHEIV11,
 11331           PI-PREV-CONTROL-PRIMARY,
 11332           DFHEIV99,
 11333           DFHEIV99,
 11334           DFHEIV99
 11335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11336
 11337
 11338********** DO NOT ALLOW CHANGES IF THRU A/R
 11339     IF BMAINTI = 'C'
 11340         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 208
* EL6311.cbl
 11341             MOVE ER-4005          TO EMI-ERROR
 11342             MOVE -1               TO BMAINTL
 11343             MOVE AL-UABON         TO BMAINTA
 11344             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11345             GO TO 8200-SEND-DATAONLY.
 11346**********
 11347
 11348     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11349        MOVE -1                 TO BMAINTL
 11350        MOVE ER-2197            TO EMI-ERROR
 11351        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11352        GO TO 8200-SEND-DATAONLY.
 11353
 11354     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11355        MOVE ER-2196             TO EMI-ERROR
 11356        MOVE AL-UABON            TO BMAINTA
 11357        MOVE -1                  TO BMAINTL
 11358        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11359        GO TO 8200-SEND-DATAONLY.
 11360
 11361     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11362
 11363     IF PB-BILLED-DT = LOW-VALUES AND
 11364        PB-CHG-COUNT = ZEROS
 11365        NEXT SENTENCE
 11366     ELSE
 11367        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11368            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11369           OR
 11370           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11371            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11372           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11373     move zeros                  to ws-check-amts
 11374     move ' '                    to ws-stop-sw
 11375                                    ws-check-sw
 11376                                    ws-proc-check-sw
 11377                                    ws-chek-browse-sw
 11378
 11379     perform 2500-browse-checks  thru 2500-exit
 11380
 11381     if i-have-processed-checks
 11382        or i-have-checks
 11383        continue
 11384     else
 11385        go to 1330-continue
 11386     end-if
 11387
 11388     compute ws-tot-orig-prem =
 11389        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11390        pb-i-lf-alt-premium-amt
 11391
 11392     if bprem1l <> zeros
 11393        MOVE AL-UNNON            TO bprem1a
 11394        move ws-bprem (1)        to ws-new-iss-total
 11395     else
 11396        move pb-i-lf-premium-amt to ws-new-iss-total
 11397     end-if
 11398     display ' new iss totala ' ws-new-iss-total
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 209
* EL6311.cbl
 11399
 11400     if baltpr1l <> zeros
 11401        MOVE AL-UNNON            TO baltpr1a
 11402        compute ws-new-iss-total =
 11403           ws-new-iss-total + ws-balt-prem(1)
 11404     else
 11405        compute ws-new-iss-total =
 11406           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11407     end-if
 11408
 11409     if bprem2l <> zeros
 11410        MOVE AL-UNNON            TO bprem2a
 11411        compute ws-new-iss-total = ws-new-iss-total +
 11412           ws-bprem (2)
 11413     else
 11414        compute ws-new-iss-total = ws-new-iss-total +
 11415           pb-i-ah-premium-amt
 11416     end-if
 11417
 11418     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11419        if ((bprem1l <> zeros)
 11420           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11421                      or
 11422           ((bprem2l <> zeros)
 11423           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11424           move er-3456          to emi-error
 11425           perform 9900-error-format
 11426                                 thru 9900-exit
 11427           go to 1330-continue
 11428        end-if
 11429     end-if
 11430
 11431     if ws-new-iss-total > ws-tot-orig-prem
 11432        move er-3458             to emi-error
 11433        perform 9900-error-format thru 9900-exit
 11434        move al-uabon            to bmainta
 11435        move -1                  to bmaintl
 11436        go to 8200-send-dataonly
 11437     end-if
 11438
 11439     if ws-new-iss-total < ws-tot-orig-prem
 11440        move er-3457             to emi-error
 11441        move al-uabon            to bprem1a
 11442                                    bprem2a
 11443        move +0 to bprem1l bprem2l
 11444        perform 9900-error-format thru 9900-exit
 11445        move -1                  to bmaintl
 11446        go to 1330-continue
 11447     end-if
 11448
 11449     .
 11450 1330-continue.
 11451
 11452
 11453* EXEC CICS READ
 11454*        DATASET (FILE-ID-ERPNDB)
 11455*        INTO    (PENDING-BUSINESS)
 11456*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 210
* EL6311.cbl
 11457*        UPDATE
 11458*    END-EXEC.
 11459     MOVE LENGTH OF
 11460      PENDING-BUSINESS
 11461       TO DFHEIV11
 11462*    MOVE '&"IL       EU         (   #00011067' TO DFHEIV0
 11463     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11464     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11465     MOVE X'2020233030303131303637' TO DFHEIV0(25:11)
 11466     CALL 'kxdfhei1' USING DFHEIV0,
 11467           FILE-ID-ERPNDB,
 11468           PENDING-BUSINESS,
 11469           DFHEIV11,
 11470           PI-PREV-CONTROL-PRIMARY,
 11471           DFHEIV99,
 11472           DFHEIV99,
 11473           DFHEIV99
 11474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11475
 11476
 11477     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11478     MOVE 'B'                    TO JP-RECORD-TYPE
 11479     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11480     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11481
 11482     PERFORM 8400-LOG-JOURNAL-RECORD.
 11483
 11484     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11485        PB-CHG-COUNT NOT = ZEROS
 11486        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11487            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11488           OR
 11489           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11490            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11491            MOVE LOW-VALUES             TO PB-BILLED-DT
 11492            ADD +1                      TO PB-CHG-COUNT.
 11493
 11494     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11495     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11496     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11497     MOVE '5'                    TO DC-OPTION-CODE.
 11498     PERFORM 9700-DATE-LINK
 11499     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11500
 11501*    IF BMICRNOL  GREATER  ZEROS
 11502*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11503
 11504     IF BVINL > ZEROS
 11505        MOVE BVINI               TO PB-I-VIN
 11506     END-IF
 11507     IF (BFORCEL NOT = ZEROS)
 11508        AND (PB-COMPANY-ID = 'DCC' or 'CAP')
 11509        AND (BFORCEI = ' ')
 11510        AND (PB-FORCE-CODE = 'O')
 11511        COMPUTE PB-I-AH-PREMIUM-AMT =
 11512           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11513        PERFORM 1800-REMOVE-CERT-NOTES
 11514                                 THRU 1800-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 211
* EL6311.cbl
 11515        PERFORM 1900-DELETE-ERPYAJ
 11516                                 THRU 1900-EXIT
 11517        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11518     END-IF
 11519     IF (BFORCEL NOT = ZEROS)
 11520        AND (PB-COMPANY-ID = 'DCC' or 'CAP')
 11521        AND (BFORCEI = 'O')
 11522        AND (PB-FORCE-CODE NOT = 'O')
 11523        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11524           PB-I-AH-PREM-CALC
 11525        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11526        MOVE SPACE               TO DC-OPTION-CODE
 11527        PERFORM 9700-DATE-LINK
 11528        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11529        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11530        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11531        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11532        PERFORM 1500-UPDATE-ERNOTE
 11533                                 THRU 1500-EXIT
 11534        PERFORM 1600-UPDATE-ERPYAJ
 11535                                 THRU 1600-EXIT
 11536     END-IF
 11537     IF BLSTNML  GREATER THAN ZEROS
 11538         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11539
 11540     IF B1STNML  GREATER THAN ZEROS
 11541         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11542
 11543     IF BINITL   GREATER THAN ZEROS
 11544         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11545
 11546     IF BBIRTHL  GREATER THAN ZERO
 11547         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11548
 11549     IF B1STPMTL GREATER THAN ZERO
 11550         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11551
 11552     IF BAGEL    GREATER THAN ZEROS
 11553         MOVE BAGEI              TO PB-I-AGE.
 11554
 11555     MOVE 'N'                    TO WS-INS-AGE-SET
 11556                                    WS-JNT-AGE-SET.
 11557     IF BAGEL    GREATER THAN ZEROS
 11558        MOVE 'Y'                TO WS-INS-AGE-SET
 11559        IF BAGEI = ZERO AND
 11560             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11561           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11562           MOVE 'AGE*'          TO BAGEDEFO
 11563        ELSE
 11564           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11565           MOVE 'AGE '          TO BAGEDEFO
 11566        END-IF
 11567        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11568     END-IF.
 11569
 11570     IF BSEXL    GREATER THAN ZEROS
 11571         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11572
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 212
* EL6311.cbl
 11573     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11574        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11575
 11576     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11577        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11578
 11579     IF BLNTRML  GREATER THAN ZEROS
 11580         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11581
 11582     IF BFREQL   GREATER THAN ZEROS
 11583         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11584
 11585     IF BSKPCDL  GREATER THAN ZEROS
 11586         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11587
 11588     IF BMODEL   GREATER THAN ZEROS
 11589         MOVE BMODEI             TO PB-I-TERM-TYPE
 11590                                    PI-BMODE.
 11591
 11592     IF BPMTSL   GREATER THAN ZEROS
 11593         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11594                                    PI-BPMTS.
 11595
 11596     IF BPMTAMTL GREATER THAN ZEROS
 11597         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11598
 11599     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11600         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11601
 11602     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11603         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11604
 11605     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11606
 11607     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11608         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11609            SUBTRACT PB-I-LF-PREMIUM-AMT
 11610                     FROM WS-B-LF-ISS-PRM-ENTERED
 11611            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11612            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11613            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11614         ELSE
 11615            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11616*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11617*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11618         END-IF
 11619     END-IF.
 11620
 11621     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11622            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11623                     FROM WS-B-LF-ISS-PRM-ENTERED
 11624         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11625         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11626
 11627     IF  BALT-PREM-LEN     (2)  > ZEROS
 11628         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11629
 11630     IF  BBEN-LEN (2)  GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 213
* EL6311.cbl
 11631         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11632
 11633     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11634         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11635            SUBTRACT PB-I-AH-PREMIUM-AMT
 11636                     FROM WS-B-AH-ISS-PRM-ENTERED
 11637            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11638            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11639            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11640         ELSE
 11641            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11642*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11643*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11644         END-IF
 11645     END-IF
 11646
 11647     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11648        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11649
 11650     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11651        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11652
 11653     IF BINDGRPL            GREATER THAN ZEROS
 11654         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11655
 11656     IF BRTCLSL             GREATER THAN ZEROS
 11657         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11658
 11659     IF BSIGL               GREATER THAN ZEROS
 11660         MOVE BSIGI              TO PB-I-SIG-SW.
 11661
 11662     IF BAPRL               GREATER THAN ZEROS
 11663         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11664
 11665     IF BMEMBERL            GREATER THAN ZEROS
 11666         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11667
 11668     IF BLNOFCRL            GREATER THAN ZEROS
 11669         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11670
 11671     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11672        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11673
 11674     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11675        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11676
 11677     IF BDAYSL              GREATER THAN ZEROS
 11678        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11679                                    PB-I-EXTENTION-DAYS.
 11680
 11681     IF BDAYSL GREATER THAN ZEROS
 11682        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11683
 11684     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11685        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11686           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11687
 11688     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 214
* EL6311.cbl
 11689        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11690           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11691
 11692     IF B1STPMTL GREATER THAN ZEROS
 11693        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11694
 11695     IF PB-EXT-DAYS-PROCESSING
 11696        IF PB-I-EXTENTION-DAYS = ZEROS
 11697           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11698
 11699     IF PB-EXPIRE-DT-PROCESSING
 11700        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11701           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11702             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11703
 11704     IF PB-1ST-PMT-DT-PROCESSING
 11705        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11706           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11707
 11708     IF BREINL GREATER THAN ZEROS
 11709        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11710
 11711     IF BFORCEL NOT = ZEROS
 11712        MOVE BFORCEI             TO PB-FORCE-CODE.
 11713     IF (BENTRYL NOT = ZEROS)
 11714        AND (PB-COMPANY-ID = 'CID')
 11715        AND (PB-STATE = 'VA')
 11716        AND (BENTRYI NOT = 'P')
 11717        AND (PB-BATCH-ENTRY = 'P')
 11718        PERFORM 1800-REMOVE-CERT-NOTES
 11719                                 THRU 1800-EXIT
 11720     END-IF
 11721     IF BENTRYL NOT = ZEROS
 11722        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11723        IF PI-COMPANY-ID = 'CID'
 11724           AND (PB-BATCH-ENTRY = 'P')
 11725           AND (PB-STATE = 'VA')
 11726           PERFORM 1500-UPDATE-ERNOTE
 11727                                 THRU 1500-EXIT
 11728        END-IF
 11729     END-IF
 11730
 11731     IF BUNWRITL NOT = ZEROS
 11732        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11733
 11734     IF BBILCDL NOT = ZEROS
 11735        MOVE BBILCDI             TO PB-RECORD-BILL.
 11736
 11737     IF BLIVESL GREATER THAN ZEROS
 11738        MOVE WS-BLIVES           TO PB-I-LIVES.
 11739
 11740
 11741*DMD CUSTOM CODING*************START
 11742     IF PI-COMPANY-ID NOT = 'DMD'
 11743         MOVE ZEROS               TO BBILLEDL.
 11744*DMD CUSTOM CODING*************END
 11745
 11746     IF BBILLEDL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 215
* EL6311.cbl
 11747        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11748
 11749
 11750*****************************************************************
 11751*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11752*****************************************************************
 11753
 11754     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11755        IF BTYPE  (1)   = ZEROS OR SPACES
 11756           IF REMOVE-LF-COVERAGE
 11757               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11758                                        PI-BTYPE (1)
 11759               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11760                                        WS-B-LF-ISS-PRM-ENTERED
 11761               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11762                                        WS-B-LF-ISS-PRM-ENTERED
 11763               SUBTRACT PB-I-LF-PREM-CALC FROM
 11764                                        WS-B-LF-ISS-PRM-COMPUTED
 11765               MOVE ZEROS            TO PB-I-LF-TERM
 11766                                        PB-I-LF-BENEFIT-AMT
 11767                                        PB-I-LF-PREMIUM-AMT
 11768                                        PB-I-LF-BENEFIT-CD
 11769                                        PB-I-LF-PREM-CALC
 11770                                        PB-I-LF-CRIT-PER
 11771                                        PB-I-LF-ALT-BENEFIT-AMT
 11772                                        PB-I-LF-ALT-PREMIUM-AMT
 11773               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11774           ELSE
 11775               NEXT SENTENCE
 11776        ELSE
 11777           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11778                                    PI-BTYPE (1).
 11779     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11780        IF BTYPE  (2)   = ZEROS OR SPACES
 11781           IF  REMOVE-AH-COVERAGE
 11782               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11783                                        PI-BTYPE (2)
 11784               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11785                                        WS-B-AH-ISS-PRM-ENTERED
 11786               SUBTRACT PB-I-AH-PREM-CALC FROM
 11787                                        WS-B-AH-ISS-PRM-COMPUTED
 11788               MOVE ZEROS            TO PB-I-AH-TERM
 11789                                        PB-I-AH-BENEFIT-AMT
 11790                                        PB-I-AH-PREMIUM-AMT
 11791                                        PB-I-AH-BENEFIT-CD
 11792                                        PB-I-AH-PREM-CALC
 11793                                        PB-I-AH-CRIT-PER
 11794               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11795           ELSE
 11796               NEXT SENTENCE
 11797        ELSE
 11798           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11799                                    PI-BTYPE (2).
 11800 1360-REWRITE-PB-RECORD.
 11801     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11802
 11803     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11804     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 216
* EL6311.cbl
 11805
 11806     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11807
 11808     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11809     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11810
 11811     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11812         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11813
 11814     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11815         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11816
 11817     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11818
 11819     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11820
 11821     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11822
 11823     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11824     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11825     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11826
 11827     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11828     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11829
 11830 1375-REWRITE-PB-RECORD.
 11831     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11832     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11833     MOVE 'C'                    TO JP-RECORD-TYPE.
 11834     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11835
 11836
 11837* EXEC CICS REWRITE
 11838*        DATASET (FILE-ID-ERPNDB)
 11839*        FROM    (PENDING-BUSINESS)
 11840*    END-EXEC.
 11841     MOVE LENGTH OF
 11842      PENDING-BUSINESS
 11843       TO DFHEIV11
 11844*    MOVE '&& L                  %   #00011433' TO DFHEIV0
 11845     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11846     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11847     MOVE X'2020233030303131343333' TO DFHEIV0(25:11)
 11848     CALL 'kxdfhei1' USING DFHEIV0,
 11849           FILE-ID-ERPNDB,
 11850           PENDING-BUSINESS,
 11851           DFHEIV11,
 11852           DFHEIV99
 11853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11854
 11855
 11856     PERFORM 8400-LOG-JOURNAL-RECORD.
 11857******************************************************************
 11858*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11859******************************************************************
 11860     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11861     MOVE ' '                    TO WS-ERMAIL-SW
 11862
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 217
* EL6311.cbl
 11863* EXEC CICS READ
 11864*       DATASET   (FILE-ID-ERMAIL)
 11865*       SET       (ADDRESS OF MAILING-DATA)
 11866*       RIDFLD    (ERMAIL-KEY)
 11867*       RESP      (WS-RESPONSE)
 11868*    END-EXEC
 11869*    MOVE '&"S        E          (  N#00011444' TO DFHEIV0
 11870     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11871     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11872     MOVE X'204E233030303131343434' TO DFHEIV0(25:11)
 11873     CALL 'kxdfhei1' USING DFHEIV0,
 11874           FILE-ID-ERMAIL,
 11875           DFHEIV20,
 11876           DFHEIV99,
 11877           ERMAIL-KEY,
 11878           DFHEIV99,
 11879           DFHEIV99,
 11880           DFHEIV99
 11881     SET ADDRESS OF MAILING-DATA TO
 11882         DFHEIV20
 11883     MOVE EIBRESP  TO WS-RESPONSE
 11884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11885     IF RESP-NORMAL
 11886        SET ERMAIL-FOUND TO TRUE
 11887     END-IF
 11888
 11889     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11890     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11891                                 TO ELCRTO-KEY
 11892     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11893     MOVE +0                     TO ELCRTO-SEQ-NO
 11894
 11895* EXEC CICS READ
 11896*       DATASET   ('ELCRTO')
 11897*       INTO      (ORIGINAL-CERTIFICATE)
 11898*       RIDFLD    (ELCRTO-KEY)
 11899*       GTEQ
 11900*       RESP      (WS-RESPONSE)
 11901*    END-EXEC
 11902     MOVE LENGTH OF
 11903      ORIGINAL-CERTIFICATE
 11904       TO DFHEIV11
 11905     MOVE 'ELCRTO' TO DFHEIV1
 11906*    MOVE '&"IL       G          (  N#00011459' TO DFHEIV0
 11907     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11908     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11909     MOVE X'204E233030303131343539' TO DFHEIV0(25:11)
 11910     CALL 'kxdfhei1' USING DFHEIV0,
 11911           DFHEIV1,
 11912           ORIGINAL-CERTIFICATE,
 11913           DFHEIV11,
 11914           ELCRTO-KEY,
 11915           DFHEIV99,
 11916           DFHEIV99,
 11917           DFHEIV99
 11918     MOVE EIBRESP  TO WS-RESPONSE
 11919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11920*    display ' just read gteq ' ws-response
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 218
* EL6311.cbl
 11921     IF RESP-NORMAL
 11922        AND (OC-CONTROL-PRIMARY (1:33) =
 11923                 PB-CONTROL-BY-ACCOUNT (1:33))
 11924        AND (OC-RECORD-TYPE = 'I')
 11925*       display ' resp norm, key =, type i '
 11926        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11927*          display ' end proc blank '
 11928           display ' csr edit session ' PI-CSR-SESSION-SW
 11929           IF NOT CSR-EDIT-SESSION
 11930
 11931* EXEC CICS READ
 11932*                DATASET   ('ELCRTO')
 11933*                INTO      (ORIGINAL-CERTIFICATE)
 11934*                RIDFLD    (OC-CONTROL-PRIMARY)
 11935*                UPDATE
 11936*                RESP      (WS-RESPONSE)
 11937*             END-EXEC
 11938     MOVE LENGTH OF
 11939      ORIGINAL-CERTIFICATE
 11940       TO DFHEIV11
 11941     MOVE 'ELCRTO' TO DFHEIV1
 11942*    MOVE '&"IL       EU         (  N#00011476' TO DFHEIV0
 11943     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11944     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11945     MOVE X'204E233030303131343736' TO DFHEIV0(25:11)
 11946     CALL 'kxdfhei1' USING DFHEIV0,
 11947           DFHEIV1,
 11948           ORIGINAL-CERTIFICATE,
 11949           DFHEIV11,
 11950           OC-CONTROL-PRIMARY,
 11951           DFHEIV99,
 11952           DFHEIV99,
 11953           DFHEIV99
 11954     MOVE EIBRESP  TO WS-RESPONSE
 11955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11956              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11957              IF RESP-NORMAL
 11958                 display ' good read upd '
 11959                 MOVE PB-I-INSURED-LAST-NAME TO
 11960                         OC-INS-LAST-NAME
 11961                 MOVE PB-I-INSURED-FIRST-NAME TO
 11962                         OC-INS-FIRST-NAME
 11963                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11964                         OC-INS-MIDDLE-INIT
 11965                 MOVE PB-I-AGE         TO OC-INS-AGE
 11966                 MOVE PB-I-JOINT-LAST-NAME   TO
 11967                         OC-JNT-LAST-NAME
 11968                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11969                         OC-JNT-FIRST-NAME
 11970                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11971                         OC-JNT-MIDDLE-INIT
 11972                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11973                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11974                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11975                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11976                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11977                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11978                         OC-LF-ALT-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 219
* EL6311.cbl
 11979                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11980                         OC-LF-ALT-PRM-AMT
 11981                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11982                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11983                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11984                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11985                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11986                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11987                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11988                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11989                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11990                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11991                 IF OC-CANCEL-TRAN-IND = 'N'
 11992                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11993                    MOVE +0            TO OC-LF-CANCEL-AMT
 11994                                          OC-LF-ITD-CANCEL-AMT
 11995                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11996                    MOVE +0            TO OC-AH-CANCEL-AMT
 11997                                          OC-AH-ITD-CANCEL-AMT
 11998                 END-IF
 11999                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12000                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12001                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12002                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12003                 IF ERMAIL-FOUND
 12004                    MOVE MA-CRED-BENE-NAME
 12005                                 TO OC-CRED-BENE-NAME
 12006                 END-IF
 12007                 IF NOT CERT-TRL-REC-NOT-FOUND
 12008                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12009                           OC-INS-AGE-DEFAULT-FLAG
 12010                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12011                           OC-JNT-AGE-DEFAULT-FLAG
 12012                 END-IF
 12013
 12014* EXEC CICS REWRITE
 12015*                   DATASET   ('ELCRTO')
 12016*                   FROM      (ORIGINAL-CERTIFICATE)
 12017*                   RESP      (WS-RESPONSE)
 12018*                END-EXEC
 12019     MOVE LENGTH OF
 12020      ORIGINAL-CERTIFICATE
 12021       TO DFHEIV11
 12022     MOVE 'ELCRTO' TO DFHEIV1
 12023*    MOVE '&& L                  %  N#00011540' TO DFHEIV0
 12024     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12025     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12026     MOVE X'204E233030303131353430' TO DFHEIV0(25:11)
 12027     CALL 'kxdfhei1' USING DFHEIV0,
 12028           DFHEIV1,
 12029           ORIGINAL-CERTIFICATE,
 12030           DFHEIV11,
 12031           DFHEIV99
 12032     MOVE EIBRESP  TO WS-RESPONSE
 12033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12034                 display ' just rewrote ' ws-response
 12035              END-IF
 12036           END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 220
* EL6311.cbl
 12037        ELSE
 12038           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12039           MOVE 'OC'             TO OC-RECORD-ID
 12040           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12041           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12042           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12043           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12044           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12045           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12046           MOVE PB-I-AGE         TO OC-INS-AGE
 12047           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12048           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12049           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12050           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12051           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12052           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12053           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12054           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12055           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12056           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12057           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12058           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12059           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12060           MOVE +0               TO OC-LF-CANCEL-AMT
 12061                                    OC-LF-ITD-CANCEL-AMT
 12062           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12063           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12064           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12065           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12066           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12067           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12068           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12069           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12070           MOVE +0               TO OC-AH-CANCEL-AMT
 12071                                    OC-AH-ITD-CANCEL-AMT
 12072           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12073           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12074           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12075           IF ERMAIL-FOUND
 12076              MOVE MA-CRED-BENE-NAME
 12077                                 TO OC-CRED-BENE-NAME
 12078           END-IF
 12079           IF NOT CERT-TRL-REC-NOT-FOUND
 12080              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12081                           OC-INS-AGE-DEFAULT-FLAG
 12082              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12083                           OC-JNT-AGE-DEFAULT-FLAG
 12084           END-IF
 12085           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12086
 12087* EXEC CICS WRITE
 12088*             DATASET   ('ELCRTO')
 12089*             FROM      (ORIGINAL-CERTIFICATE)
 12090*             RIDFLD    (OC-CONTROL-PRIMARY)
 12091*             RESP      (WS-RESPONSE)
 12092*          END-EXEC
 12093     MOVE LENGTH OF
 12094      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 221
* EL6311.cbl
 12095       TO DFHEIV11
 12096     MOVE 'ELCRTO' TO DFHEIV1
 12097*    MOVE '&$ L                  ''  N#00011597' TO DFHEIV0
 12098     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12099     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12100     MOVE X'204E233030303131353937' TO DFHEIV0(25:11)
 12101     CALL 'kxdfhei1' USING DFHEIV0,
 12102           DFHEIV1,
 12103           ORIGINAL-CERTIFICATE,
 12104           DFHEIV11,
 12105           OC-CONTROL-PRIMARY,
 12106           DFHEIV99,
 12107           DFHEIV99
 12108     MOVE EIBRESP  TO WS-RESPONSE
 12109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12110        END-IF
 12111     ELSE
 12112        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12113        MOVE 'OC'                TO OC-RECORD-ID
 12114        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12115                                 TO OC-CONTROL-PRIMARY (1:33)
 12116        MOVE 'I'                 TO OC-RECORD-TYPE
 12117        MOVE +4096               TO OC-KEY-SEQ-NO
 12118        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12119        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12120        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12121        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12122        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12123        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12124        MOVE PB-I-AGE            TO OC-INS-AGE
 12125        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12126        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12127        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12128        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12129        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12130        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12131        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12132        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12133        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12134        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12135        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12136        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12137        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12138        MOVE +0                  TO OC-LF-CANCEL-AMT
 12139                                    OC-LF-ITD-CANCEL-AMT
 12140        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12141        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12142        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12143        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12144        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12145        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12146        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12147        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12148        MOVE +0                  TO OC-AH-CANCEL-AMT
 12149                                    OC-AH-ITD-CANCEL-AMT
 12150        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12151        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12152        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 222
* EL6311.cbl
 12153        IF ERMAIL-FOUND
 12154           MOVE MA-CRED-BENE-NAME
 12155                                 TO OC-CRED-BENE-NAME
 12156        END-IF
 12157        IF NOT CERT-TRL-REC-NOT-FOUND
 12158           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12159                           OC-INS-AGE-DEFAULT-FLAG
 12160           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12161                           OC-JNT-AGE-DEFAULT-FLAG
 12162        END-IF
 12163        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12164
 12165* EXEC CICS WRITE
 12166*          DATASET   ('ELCRTO')
 12167*          FROM      (ORIGINAL-CERTIFICATE)
 12168*          RIDFLD    (OC-CONTROL-PRIMARY)
 12169*          RESP      (WS-RESPONSE)
 12170*       END-EXEC
 12171     MOVE LENGTH OF
 12172      ORIGINAL-CERTIFICATE
 12173       TO DFHEIV11
 12174     MOVE 'ELCRTO' TO DFHEIV1
 12175*    MOVE '&$ L                  ''  N#00011657' TO DFHEIV0
 12176     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12177     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12178     MOVE X'204E233030303131363537' TO DFHEIV0(25:11)
 12179     CALL 'kxdfhei1' USING DFHEIV0,
 12180           DFHEIV1,
 12181           ORIGINAL-CERTIFICATE,
 12182           DFHEIV11,
 12183           OC-CONTROL-PRIMARY,
 12184           DFHEIV99,
 12185           DFHEIV99
 12186     MOVE EIBRESP  TO WS-RESPONSE
 12187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12188     END-IF
 12189******************************************************************
 12190*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12191******************************************************************
 12192
 12193     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12194     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12195
 12196
 12197* EXEC CICS READ
 12198*        INTO    (PENDING-BUSINESS)
 12199*        DATASET (FILE-ID-ERPNDB)
 12200*        RIDFLD  (ERPNDB-KEY)
 12201*        UPDATE
 12202*    END-EXEC.
 12203     MOVE LENGTH OF
 12204      PENDING-BUSINESS
 12205       TO DFHEIV11
 12206*    MOVE '&"IL       EU         (   #00011671' TO DFHEIV0
 12207     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12208     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12209     MOVE X'2020233030303131363731' TO DFHEIV0(25:11)
 12210     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 223
* EL6311.cbl
 12211           FILE-ID-ERPNDB,
 12212           PENDING-BUSINESS,
 12213           DFHEIV11,
 12214           ERPNDB-KEY,
 12215           DFHEIV99,
 12216           DFHEIV99,
 12217           DFHEIV99
 12218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12219
 12220
 12221     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12222     MOVE 'B'                    TO JP-RECORD-TYPE.
 12223     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12224
 12225     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12226
 12227     PERFORM 8400-LOG-JOURNAL-RECORD.
 12228
 12229     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12230
 12231     MOVE 'C'                    TO JP-RECORD-TYPE.
 12232     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12233
 12234
 12235* EXEC CICS REWRITE
 12236*        DATASET    (FILE-ID-ERPNDB)
 12237*        FROM       (PENDING-BUSINESS)
 12238*    END-EXEC.
 12239     MOVE LENGTH OF
 12240      PENDING-BUSINESS
 12241       TO DFHEIV11
 12242*    MOVE '&& L                  %   #00011691' TO DFHEIV0
 12243     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12244     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12245     MOVE X'2020233030303131363931' TO DFHEIV0(25:11)
 12246     CALL 'kxdfhei1' USING DFHEIV0,
 12247           FILE-ID-ERPNDB,
 12248           PENDING-BUSINESS,
 12249           DFHEIV11,
 12250           DFHEIV99
 12251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12252
 12253
 12254     PERFORM 8400-LOG-JOURNAL-RECORD.
 12255
 12256     IF WS-ERRORS-PRESENT
 12257        GO TO 3900-RE-DISPLAY-RECORD.
 12258
 12259     MOVE ZEROS                  TO EMI-ERROR.
 12260     MOVE -1                     TO BMAINTL.
 12261     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12262     GO TO 3900-RE-DISPLAY-RECORD.
 12263
 12264 1380-BATCH-HDR-NOT-FOUND.
 12265     MOVE -1                     TO BMAINTL.
 12266     MOVE ER-7450                TO EMI-ERROR.
 12267     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12268     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 224
* EL6311.cbl
 12269
 12270 1385-REC-NOT-FOUND.
 12271     MOVE -1                     TO BMAINTL.
 12272     MOVE ER-7451                TO EMI-ERROR.
 12273     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12274     GO TO 8200-SEND-DATAONLY.
 12275
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 225
* EL6311.cbl
 12277
 12278 1386-UPDATE-AGE-FLAGS.
 12279
 12280
 12281* EXEC CICS GETMAIN
 12282*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12283*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12284*        INITIMG (GETMAIN-SPACE)
 12285*    END-EXEC
 12286*    MOVE ',"IL                  $   #00011722' TO DFHEIV0
 12287     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12288     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12289     MOVE X'2020233030303131373232' TO DFHEIV0(25:11)
 12290     CALL 'kxdfhei1' USING DFHEIV0,
 12291           DFHEIV20,
 12292           ELCRTT-RECORD-LENGTH,
 12293           GETMAIN-SPACE
 12294     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12295         DFHEIV20
 12296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12297
 12298
 12299* EXEC CICS HANDLE CONDITION
 12300*        NOTFND   (1386-NOTFND)
 12301*    END-EXEC.
 12302*    MOVE '"$I                   ! ( #00011728' TO DFHEIV0
 12303     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12305     MOVE X'2820233030303131373238' TO DFHEIV0(25:11)
 12306     CALL 'kxdfhei1' USING DFHEIV0
 12307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12308
 12309
 12310     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12311     MOVE 'C'                TO ELCRTT-REC-TYPE
 12312
 12313
 12314* EXEC CICS READ
 12315*        UPDATE
 12316*        DATASET  (CRTT-ID)
 12317*        RIDFLD   (ELCRTT-KEY)
 12318*        INTO     (CERTIFICATE-TRAILERS)
 12319*    END-EXEC.
 12320     MOVE LENGTH OF
 12321      CERTIFICATE-TRAILERS
 12322       TO DFHEIV11
 12323*    MOVE '&"IL       EU         (   #00011735' TO DFHEIV0
 12324     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12325     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12326     MOVE X'2020233030303131373335' TO DFHEIV0(25:11)
 12327     CALL 'kxdfhei1' USING DFHEIV0,
 12328           CRTT-ID,
 12329           CERTIFICATE-TRAILERS,
 12330           DFHEIV11,
 12331           ELCRTT-KEY,
 12332           DFHEIV99,
 12333           DFHEIV99,
 12334           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 226
* EL6311.cbl
 12335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12336
 12337
 12338     IF WS-INS-AGE-SET = 'Y'
 12339        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12340     END-IF
 12341     IF WS-JNT-AGE-SET = 'Y'
 12342        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12343     END-IF
 12344
 12345
 12346* EXEC CICS REWRITE
 12347*       DATASET  (CRTT-ID)
 12348*       FROM     (CERTIFICATE-TRAILERS)
 12349*    END-EXEC.
 12350     MOVE LENGTH OF
 12351      CERTIFICATE-TRAILERS
 12352       TO DFHEIV11
 12353*    MOVE '&& L                  %   #00011749' TO DFHEIV0
 12354     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12355     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12356     MOVE X'2020233030303131373439' TO DFHEIV0(25:11)
 12357     CALL 'kxdfhei1' USING DFHEIV0,
 12358           CRTT-ID,
 12359           CERTIFICATE-TRAILERS,
 12360           DFHEIV11,
 12361           DFHEIV99
 12362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12363
 12364
 12365     GO TO 1386-EXIT.
 12366
 12367 1386-NOTFND.
 12368
 12369     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12370     MOVE 'CS'         TO CS-RECORD-ID.
 12371     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12372     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12373     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12374     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12375     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12376
 12377* EXEC CICS WRITE
 12378*       DATASET  (CRTT-ID)
 12379*       RIDFLD   (ELCRTT-KEY)
 12380*       FROM     (CERTIFICATE-TRAILERS)
 12381*    END-EXEC.
 12382     MOVE LENGTH OF
 12383      CERTIFICATE-TRAILERS
 12384       TO DFHEIV11
 12385*    MOVE '&$ L                  ''   #00011765' TO DFHEIV0
 12386     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12387     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12388     MOVE X'2020233030303131373635' TO DFHEIV0(25:11)
 12389     CALL 'kxdfhei1' USING DFHEIV0,
 12390           CRTT-ID,
 12391           CERTIFICATE-TRAILERS,
 12392           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 227
* EL6311.cbl
 12393           ELCRTT-KEY,
 12394           DFHEIV99,
 12395           DFHEIV99
 12396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12397
 12398
 12399 1386-EXIT.
 12400     EXIT.
 12401
 12402 1390-UPDATE-ERPNDM.
 12403
 12404
 12405* EXEC CICS HANDLE CONDITION
 12406*        NOTFND (1399-EXIT)
 12407*    END-EXEC.
 12408*    MOVE '"$I                   ! ) #00011776' TO DFHEIV0
 12409     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12410     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12411     MOVE X'2920233030303131373736' TO DFHEIV0(25:11)
 12412     CALL 'kxdfhei1' USING DFHEIV0
 12413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12414
 12415
 12416     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12417
 12418
 12419* EXEC CICS READ
 12420*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12421*        DATASET (FILE-ID-ERPNDM)
 12422*        RIDFLD  (ERPNDM-KEY)
 12423*        UPDATE
 12424*    END-EXEC.
 12425*    MOVE '&"S        EU         (   #00011782' TO DFHEIV0
 12426     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12427     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12428     MOVE X'2020233030303131373832' TO DFHEIV0(25:11)
 12429     CALL 'kxdfhei1' USING DFHEIV0,
 12430           FILE-ID-ERPNDM,
 12431           DFHEIV20,
 12432           DFHEIV99,
 12433           ERPNDM-KEY,
 12434           DFHEIV99,
 12435           DFHEIV99,
 12436           DFHEIV99
 12437     SET ADDRESS OF PENDING-MAILING-DATA TO
 12438         DFHEIV20
 12439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12440
 12441
 12442     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12443     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12444     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12445
 12446     IF BLSTNML GREATER THAN ZEROS
 12447         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12448
 12449     IF B1STNML GREATER  THAN ZEROS
 12450         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 228
* EL6311.cbl
 12451
 12452     IF BINITL GREATER THAN ZEROS
 12453         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12454
 12455     IF BAGEL GREATER THAN ZEROS
 12456         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12457
 12458     IF BBIRTHL GREATER THAN ZEROS
 12459         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12460
 12461     IF BSEXL GREATER THAN ZEROS
 12462         MOVE  BSEXI             TO PM-INSURED-SEX.
 12463
 12464
 12465* EXEC CICS REWRITE
 12466*        DATASET (FILE-ID-ERPNDM)
 12467*        FROM    (PENDING-MAILING-DATA)
 12468*    END-EXEC.
 12469     MOVE LENGTH OF
 12470      PENDING-MAILING-DATA
 12471       TO DFHEIV11
 12472*    MOVE '&& L                  %   #00011811' TO DFHEIV0
 12473     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12474     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12475     MOVE X'2020233030303131383131' TO DFHEIV0(25:11)
 12476     CALL 'kxdfhei1' USING DFHEIV0,
 12477           FILE-ID-ERPNDM,
 12478           PENDING-MAILING-DATA,
 12479           DFHEIV11,
 12480           DFHEIV99
 12481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12482
 12483
 12484 1399-EXIT.
 12485     EXIT.
 12486
 12487******************************************************************
 12488*                                                                *
 12489*          D E L E T E   I S S U E   R O U T I N E               *
 12490*                                                                *
 12491******************************************************************
 12492
 12493 1400-DELETE-ISSUE-ROUTINE.
 12494     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12495
 12496     IF BCHGL NOT = ZEROS
 12497        MOVE ER-2196             TO EMI-ERROR
 12498        MOVE AL-UABON            TO BMAINTA
 12499        MOVE -1                  TO BMAINTL
 12500        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12501        GO TO 8200-SEND-DATAONLY.
 12502
 12503
 12504* EXEC CICS HANDLE CONDITION
 12505*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12506*    END-EXEC.
 12507*    MOVE '"$I                   ! * #00011835' TO DFHEIV0
 12508     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 229
* EL6311.cbl
 12509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12510     MOVE X'2A20233030303131383335' TO DFHEIV0(25:11)
 12511     CALL 'kxdfhei1' USING DFHEIV0
 12512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12513
 12514
 12515     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12516     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12517     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12518
 12519
 12520* EXEC CICS READ
 12521*        SET     (ADDRESS OF PENDING-BUSINESS)
 12522*        DATASET (FILE-ID-ERPNDB)
 12523*        RIDFLD  (ERPNDB-KEY)
 12524*    END-EXEC.
 12525*    MOVE '&"S        E          (   #00011843' TO DFHEIV0
 12526     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12527     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12528     MOVE X'2020233030303131383433' TO DFHEIV0(25:11)
 12529     CALL 'kxdfhei1' USING DFHEIV0,
 12530           FILE-ID-ERPNDB,
 12531           DFHEIV20,
 12532           DFHEIV99,
 12533           ERPNDB-KEY,
 12534           DFHEIV99,
 12535           DFHEIV99,
 12536           DFHEIV99
 12537     SET ADDRESS OF PENDING-BUSINESS TO
 12538         DFHEIV20
 12539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12540
 12541
 12542     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12543
 12544     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12545
 12546     IF BSUFIXL NOT = ZEROS
 12547        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12548     ELSE
 12549        MOVE SPACE               TO WS-NEW-SUFFIX.
 12550
 12551     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12552     PERFORM 8600-DEEDIT.
 12553     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12554     MOVE '4'                    TO DC-OPTION-CODE.
 12555     PERFORM 9700-DATE-LINK.
 12556     IF DATE-CONVERSION-ERROR
 12557        MOVE ER-0348             TO EMI-ERROR
 12558        MOVE -1                  TO BEFFDTL
 12559        MOVE AL-UABON            TO BEFFDTA
 12560        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12561        GO TO 8200-SEND-DATAONLY
 12562     ELSE
 12563        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12564        MOVE AL-UANON            TO BEFFDTA
 12565        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12566
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 230
* EL6311.cbl
 12567
 12568* EXEC CICS HANDLE CONDITION
 12569*         NOTFND    (1490-RECORD-NOT-FOUND)
 12570*    END-EXEC.
 12571*    MOVE '"$I                   ! + #00011874' TO DFHEIV0
 12572     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12574     MOVE X'2B20233030303131383734' TO DFHEIV0(25:11)
 12575     CALL 'kxdfhei1' USING DFHEIV0
 12576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12577
 12578
 12579
 12580* EXEC CICS READ
 12581*        SET     (ADDRESS OF PENDING-BUSINESS)
 12582*        DATASET (FILE-ID-ERPNDB)
 12583*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12584*        UPDATE
 12585*    END-EXEC.
 12586*    MOVE '&"S        EU         (   #00011878' TO DFHEIV0
 12587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12588     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12589     MOVE X'2020233030303131383738' TO DFHEIV0(25:11)
 12590     CALL 'kxdfhei1' USING DFHEIV0,
 12591           FILE-ID-ERPNDB,
 12592           DFHEIV20,
 12593           DFHEIV99,
 12594           PI-PREV-CONTROL-PRIMARY,
 12595           DFHEIV99,
 12596           DFHEIV99,
 12597           DFHEIV99
 12598     SET ADDRESS OF PENDING-BUSINESS TO
 12599         DFHEIV20
 12600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12601
 12602
 12603     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12604        MOVE -1                 TO BMAINTL
 12605        MOVE ER-2197            TO EMI-ERROR
 12606        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12607        GO TO 8200-SEND-DATAONLY.
 12608
 12609     IF PB-BILLED-DT NOT = LOW-VALUES
 12610        MOVE -1                 TO BMAINTL
 12611        MOVE ER-2129            TO EMI-ERROR
 12612        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12613        GO TO 8200-SEND-DATAONLY.
 12614
 12615     IF PB-CHG-COUNT NOT = ZEROS
 12616        MOVE ER-2336            TO EMI-ERROR
 12617        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12618        MOVE AL-UABON            TO BMAINTA
 12619        MOVE -1                  TO BMAINTL
 12620        GO TO 8200-SEND-DATAONLY.
 12621
 12622     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12623        PB-CHG-COUNT NOT = ZEROS
 12624        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 231
* EL6311.cbl
 12625        MOVE AL-UABON            TO BMAINTA
 12626        MOVE -1                  TO BMAINTL
 12627        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12628        GO TO 8200-SEND-DATAONLY.
 12629******************************************************************
 12630*                                                                *
 12631*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12632*                                                                *
 12633******************************************************************
 12634     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12635     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12636     MOVE +0                     TO ELCRTO-SEQ-NO
 12637
 12638* EXEC CICS READ
 12639*       DATASET   ('ELCRTO')
 12640*       INTO      (ORIGINAL-CERTIFICATE)
 12641*       RIDFLD    (ELCRTO-KEY)
 12642*       GTEQ
 12643*       RESP      (WS-RESPONSE)
 12644*    END-EXEC
 12645     MOVE LENGTH OF
 12646      ORIGINAL-CERTIFICATE
 12647       TO DFHEIV11
 12648     MOVE 'ELCRTO' TO DFHEIV1
 12649*    MOVE '&"IL       G          (  N#00011919' TO DFHEIV0
 12650     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12651     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12652     MOVE X'204E233030303131393139' TO DFHEIV0(25:11)
 12653     CALL 'kxdfhei1' USING DFHEIV0,
 12654           DFHEIV1,
 12655           ORIGINAL-CERTIFICATE,
 12656           DFHEIV11,
 12657           ELCRTO-KEY,
 12658           DFHEIV99,
 12659           DFHEIV99,
 12660           DFHEIV99
 12661     MOVE EIBRESP  TO WS-RESPONSE
 12662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12663     IF RESP-NORMAL
 12664        AND (OC-CONTROL-PRIMARY (1:33) =
 12665                 PB-CONTROL-BY-ACCOUNT (1:33))
 12666        AND (OC-RECORD-TYPE = 'I')
 12667
 12668* EXEC CICS READ
 12669*          DATASET   ('ELCRTO')
 12670*          INTO      (ORIGINAL-CERTIFICATE)
 12671*          RIDFLD    (ELCRTO-KEY)
 12672*          UPDATE
 12673*          RESP      (WS-RESPONSE)
 12674*       END-EXEC
 12675     MOVE LENGTH OF
 12676      ORIGINAL-CERTIFICATE
 12677       TO DFHEIV11
 12678     MOVE 'ELCRTO' TO DFHEIV1
 12679*    MOVE '&"IL       EU         (  N#00011930' TO DFHEIV0
 12680     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12681     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12682     MOVE X'204E233030303131393330' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 232
* EL6311.cbl
 12683     CALL 'kxdfhei1' USING DFHEIV0,
 12684           DFHEIV1,
 12685           ORIGINAL-CERTIFICATE,
 12686           DFHEIV11,
 12687           ELCRTO-KEY,
 12688           DFHEIV99,
 12689           DFHEIV99,
 12690           DFHEIV99
 12691     MOVE EIBRESP  TO WS-RESPONSE
 12692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12693        IF RESP-NORMAL
 12694
 12695* EXEC CICS DELETE
 12696*             DATASET   ('ELCRTO')
 12697*          END-EXEC
 12698     MOVE 'ELCRTO' TO DFHEIV1
 12699*    MOVE '&(                    &   #00011938' TO DFHEIV0
 12700     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12701     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12702     MOVE X'2020233030303131393338' TO DFHEIV0(25:11)
 12703     CALL 'kxdfhei1' USING DFHEIV0,
 12704           DFHEIV1,
 12705           DFHEIV99,
 12706           DFHEIV99,
 12707           DFHEIV99,
 12708           DFHEIV99
 12709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12710        END-IF
 12711     END-IF
 12712******************************************************************
 12713*                                                                *
 12714*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12715*                                                                *
 12716******************************************************************
 12717
 12718* EXEC CICS HANDLE CONDITION
 12719*        NOTFND    (1405-DELETE-CERTIFICATE)
 12720*    END-EXEC.
 12721*    MOVE '"$I                   ! , #00011948' TO DFHEIV0
 12722     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12723     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12724     MOVE X'2C20233030303131393438' TO DFHEIV0(25:11)
 12725     CALL 'kxdfhei1' USING DFHEIV0
 12726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12727
 12728
 12729
 12730* EXEC CICS READ
 12731*        EQUAL
 12732*        DATASET   (FILE-ID-ERPNDM)
 12733*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12734*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12735*        UPDATE
 12736*    END-EXEC.
 12737*    MOVE '&"S        EU         (   #00011952' TO DFHEIV0
 12738     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12739     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12740     MOVE X'2020233030303131393532' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 233
* EL6311.cbl
 12741     CALL 'kxdfhei1' USING DFHEIV0,
 12742           FILE-ID-ERPNDM,
 12743           DFHEIV20,
 12744           DFHEIV99,
 12745           PI-PREV-CONTROL-PRIMARY,
 12746           DFHEIV99,
 12747           DFHEIV99,
 12748           DFHEIV99
 12749     SET ADDRESS OF PENDING-MAILING-DATA TO
 12750         DFHEIV20
 12751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12752
 12753
 12754     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12755     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12756     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12757
 12758     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12759
 12760
 12761* EXEC CICS DELETE
 12762*        DATASET   (FILE-ID-ERPNDM)
 12763*    END-EXEC.
 12764*    MOVE '&(                    &   #00011966' TO DFHEIV0
 12765     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12766     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12767     MOVE X'2020233030303131393636' TO DFHEIV0(25:11)
 12768     CALL 'kxdfhei1' USING DFHEIV0,
 12769           FILE-ID-ERPNDM,
 12770           DFHEIV99,
 12771           DFHEIV99,
 12772           DFHEIV99,
 12773           DFHEIV99
 12774     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12775
 12776
 12777******************************************************************
 12778*                PROCESS   CERTIFICATE                           *
 12779******************************************************************
 12780
 12781 1405-DELETE-CERTIFICATE.
 12782
 12783* EXEC CICS HANDLE CONDITION
 12784*         NOTFND  (1420-CONTINUE-DELETE)
 12785*    END-EXEC.
 12786*    MOVE '"$I                   ! - #00011975' TO DFHEIV0
 12787     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12788     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12789     MOVE X'2D20233030303131393735' TO DFHEIV0(25:11)
 12790     CALL 'kxdfhei1' USING DFHEIV0
 12791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12792
 12793
 12794     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12795     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12796     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12797     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12798
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 234
* EL6311.cbl
 12799
 12800* EXEC CICS READ
 12801*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12802*        DATASET (FILE-ID-ELCERT)
 12803*        RIDFLD  (ELCERT-KEY)
 12804*        UPDATE
 12805*    END-EXEC.
 12806*    MOVE '&"S        EU         (   #00011984' TO DFHEIV0
 12807     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12808     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12809     MOVE X'2020233030303131393834' TO DFHEIV0(25:11)
 12810     CALL 'kxdfhei1' USING DFHEIV0,
 12811           FILE-ID-ELCERT,
 12812           DFHEIV20,
 12813           DFHEIV99,
 12814           ELCERT-KEY,
 12815           DFHEIV99,
 12816           DFHEIV99,
 12817           DFHEIV99
 12818     SET ADDRESS OF CERTIFICATE-MASTER TO
 12819         DFHEIV20
 12820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12821
 12822
 12823     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12824
 12825     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12826     MOVE 'B'                    TO JP-RECORD-TYPE
 12827     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12828
 12829     PERFORM 8400-LOG-JOURNAL-RECORD.
 12830
 12831     IF CERT-NOTES-ARE-NOT-PRESENT
 12832        MOVE ' '                 TO WS-CERT-NOTE-SW
 12833     ELSE
 12834        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12835
 12836     IF INSURED-ADDR-PRESENT
 12837        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12838
 12839******************************************************************
 12840******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12841******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12842******************************************************************
 12843******************************************************************
 12844
 12845     IF CERT-ADDED-BATCH AND
 12846        (NOT NO-CLAIM-ATTACHED
 12847         OR
 12848         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12849        GO TO 1410-REWRITE-CERT.
 12850
 12851******************************************************************
 12852******************************************************************
 12853
 12854     IF CERT-ADDED-BATCH  AND
 12855        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12856        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 235
* EL6311.cbl
 12857
 12858     IF NO-CLAIM-ATTACHED
 12859        NEXT SENTENCE
 12860     ELSE
 12861        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12862        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12863        GO TO 1410-REWRITE-CERT.
 12864
 12865     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12866     MOVE 'D'                      TO JP-RECORD-TYPE.
 12867     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12868
 12869
 12870* EXEC CICS DELETE
 12871*         DATASET    (FILE-ID-ELCERT)
 12872*    END-EXEC.
 12873*    MOVE '&(                    &   #00012037' TO DFHEIV0
 12874     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12875     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12876     MOVE X'2020233030303132303337' TO DFHEIV0(25:11)
 12877     CALL 'kxdfhei1' USING DFHEIV0,
 12878           FILE-ID-ELCERT,
 12879           DFHEIV99,
 12880           DFHEIV99,
 12881           DFHEIV99,
 12882           DFHEIV99
 12883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12884
 12885
 12886     PERFORM 8400-LOG-JOURNAL-RECORD.
 12887
 12888******************************************************************
 12889*                                                                *
 12890*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12891*                                                                *
 12892******************************************************************
 12893
 12894     IF  CERT-NOTES-ARE-PRESENT
 12895         NEXT SENTENCE
 12896     ELSE
 12897         GO TO 1407-DELETE-MAILING.
 12898
 12899
 12900* EXEC CICS HANDLE CONDITION
 12901*         NOTFND  (1406-DELETE-ERNOTE)
 12902*    END-EXEC.
 12903*    MOVE '"$I                   ! . #00012054' TO DFHEIV0
 12904     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12905     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12906     MOVE X'2E20233030303132303534' TO DFHEIV0(25:11)
 12907     CALL 'kxdfhei1' USING DFHEIV0
 12908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12909
 12910
 12911     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12912     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12913     MOVE 0                     TO ERCNOT-SEQUENCE.
 12914
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 236
* EL6311.cbl
 12915 1406-DELETE-ERCNOT-LOOP.
 12916
 12917
 12918* EXEC CICS READ
 12919*        GTEQ
 12920*        DATASET   (FILE-ID-ERCNOT)
 12921*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12922*        RIDFLD    (ERCNOT-KEY)
 12923*    END-EXEC.
 12924*    MOVE '&"S        G          (   #00012064' TO DFHEIV0
 12925     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12926     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12927     MOVE X'2020233030303132303634' TO DFHEIV0(25:11)
 12928     CALL 'kxdfhei1' USING DFHEIV0,
 12929           FILE-ID-ERCNOT,
 12930           DFHEIV20,
 12931           DFHEIV99,
 12932           ERCNOT-KEY,
 12933           DFHEIV99,
 12934           DFHEIV99,
 12935           DFHEIV99
 12936     SET ADDRESS OF CERT-NOTE-FILE TO
 12937         DFHEIV20
 12938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12939
 12940
 12941     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12942     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12943         GO TO 1406-DELETE-ERNOTE
 12944     END-IF.
 12945
 12946     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12947     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12948     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12949
 12950     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12951
 12952
 12953* EXEC CICS DELETE
 12954*        DATASET   (FILE-ID-ERCNOT)
 12955*        RIDFLD    (ERCNOT-KEY)
 12956*        END-EXEC.
 12957*    MOVE '&(  R                 &   #00012082' TO DFHEIV0
 12958     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12959     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12960     MOVE X'2020233030303132303832' TO DFHEIV0(25:11)
 12961     CALL 'kxdfhei1' USING DFHEIV0,
 12962           FILE-ID-ERCNOT,
 12963           ERCNOT-KEY,
 12964           DFHEIV99,
 12965           DFHEIV99,
 12966           DFHEIV99
 12967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12968
 12969
 12970     PERFORM 8400-LOG-JOURNAL-RECORD.
 12971
 12972     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 237
* EL6311.cbl
 12973
 12974 1406-DELETE-ERNOTE.
 12975
 12976
 12977* EXEC CICS HANDLE CONDITION
 12978*         NOTFND  (1407-DELETE-MAILING)
 12979*    END-EXEC.
 12980*    MOVE '"$I                   ! / #00012093' TO DFHEIV0
 12981     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12982     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12983     MOVE X'2F20233030303132303933' TO DFHEIV0(25:11)
 12984     CALL 'kxdfhei1' USING DFHEIV0
 12985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12986
 12987
 12988
 12989* EXEC CICS READ
 12990*        EQUAL
 12991*        DATASET   (FILE-ID-ERNOTE)
 12992*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12993*        RIDFLD    (ELCERT-KEY)
 12994*        UPDATE
 12995*    END-EXEC.
 12996*    MOVE '&"S        EU         (   #00012097' TO DFHEIV0
 12997     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12998     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12999     MOVE X'2020233030303132303937' TO DFHEIV0(25:11)
 13000     CALL 'kxdfhei1' USING DFHEIV0,
 13001           FILE-ID-ERNOTE,
 13002           DFHEIV20,
 13003           DFHEIV99,
 13004           ELCERT-KEY,
 13005           DFHEIV99,
 13006           DFHEIV99,
 13007           DFHEIV99
 13008     SET ADDRESS OF CERTIFICATE-NOTE TO
 13009         DFHEIV20
 13010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13011
 13012
 13013     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 13014     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13015     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13016
 13017     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13018
 13019
 13020* EXEC CICS DELETE
 13021*        DATASET   (FILE-ID-ERNOTE)
 13022*        END-EXEC.
 13023*    MOVE '&(                    &   #00012111' TO DFHEIV0
 13024     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13025     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13026     MOVE X'2020233030303132313131' TO DFHEIV0(25:11)
 13027     CALL 'kxdfhei1' USING DFHEIV0,
 13028           FILE-ID-ERNOTE,
 13029           DFHEIV99,
 13030           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 238
* EL6311.cbl
 13031           DFHEIV99,
 13032           DFHEIV99
 13033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13034
 13035
 13036     PERFORM 8400-LOG-JOURNAL-RECORD.
 13037
 13038******************************************************************
 13039*                                                                *
 13040*                DELETE MAILING ADDRESS RECORDS                  *
 13041*                                                                *
 13042******************************************************************
 13043
 13044 1407-DELETE-MAILING.
 13045     IF CERT-ADDRESS-PRESENT
 13046        NEXT SENTENCE
 13047     ELSE
 13048        GO TO 1420-CONTINUE-DELETE.
 13049
 13050
 13051* EXEC CICS HANDLE CONDITION
 13052*         NOTFND  (1420-CONTINUE-DELETE)
 13053*    END-EXEC.
 13054*    MOVE '"$I                   ! 0 #00012129' TO DFHEIV0
 13055     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13056     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13057     MOVE X'3020233030303132313239' TO DFHEIV0(25:11)
 13058     CALL 'kxdfhei1' USING DFHEIV0
 13059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13060
 13061
 13062
 13063* EXEC CICS READ
 13064*        EQUAL
 13065*        DATASET   (FILE-ID-ERMAIL)
 13066*        SET       (ADDRESS OF MAILING-DATA)
 13067*        RIDFLD    (ELCERT-KEY)
 13068*        UPDATE
 13069*    END-EXEC.
 13070*    MOVE '&"S        EU         (   #00012133' TO DFHEIV0
 13071     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13072     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13073     MOVE X'2020233030303132313333' TO DFHEIV0(25:11)
 13074     CALL 'kxdfhei1' USING DFHEIV0,
 13075           FILE-ID-ERMAIL,
 13076           DFHEIV20,
 13077           DFHEIV99,
 13078           ELCERT-KEY,
 13079           DFHEIV99,
 13080           DFHEIV99,
 13081           DFHEIV99
 13082     SET ADDRESS OF MAILING-DATA TO
 13083         DFHEIV20
 13084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13085
 13086
 13087     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13088     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 239
* EL6311.cbl
 13089     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13090
 13091     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13092
 13093
 13094* EXEC CICS DELETE
 13095*        DATASET   (FILE-ID-ERMAIL)
 13096*    END-EXEC.
 13097*    MOVE '&(                    &   #00012147' TO DFHEIV0
 13098     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13099     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13100     MOVE X'2020233030303132313437' TO DFHEIV0(25:11)
 13101     CALL 'kxdfhei1' USING DFHEIV0,
 13102           FILE-ID-ERMAIL,
 13103           DFHEIV99,
 13104           DFHEIV99,
 13105           DFHEIV99,
 13106           DFHEIV99
 13107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13108
 13109
 13110     GO TO 1420-CONTINUE-DELETE.
 13111
 13112 1410-REWRITE-CERT.
 13113     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13114     MOVE 'C'                      TO JP-RECORD-TYPE.
 13115     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13116     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13117
 13118
 13119* EXEC CICS REWRITE
 13120*         DATASET    (FILE-ID-ELCERT)
 13121*         FROM       (CERTIFICATE-MASTER)
 13122*         END-EXEC.
 13123     MOVE LENGTH OF
 13124      CERTIFICATE-MASTER
 13125       TO DFHEIV11
 13126*    MOVE '&& L                  %   #00012159' TO DFHEIV0
 13127     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13128     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13129     MOVE X'2020233030303132313539' TO DFHEIV0(25:11)
 13130     CALL 'kxdfhei1' USING DFHEIV0,
 13131           FILE-ID-ELCERT,
 13132           CERTIFICATE-MASTER,
 13133           DFHEIV11,
 13134           DFHEIV99
 13135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13136
 13137
 13138     PERFORM 8400-LOG-JOURNAL-RECORD.
 13139
 13140 1420-CONTINUE-DELETE.
 13141     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13142     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13143
 13144     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13145     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13146
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 240
* EL6311.cbl
 13147     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13148
 13149 1450-DELETE-PB-RECORD.
 13150     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13151     MOVE 'D'                      TO JP-RECORD-TYPE
 13152     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13153
 13154
 13155* EXEC CICS DELETE
 13156*        DATASET    (FILE-ID-ERPNDB)
 13157*    END-EXEC.
 13158*    MOVE '&(                    &   #00012180' TO DFHEIV0
 13159     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13160     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13161     MOVE X'2020233030303132313830' TO DFHEIV0(25:11)
 13162     CALL 'kxdfhei1' USING DFHEIV0,
 13163           FILE-ID-ERPNDB,
 13164           DFHEIV99,
 13165           DFHEIV99,
 13166           DFHEIV99,
 13167           DFHEIV99
 13168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13169
 13170
 13171     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13172
 13173     PERFORM 8400-LOG-JOURNAL-RECORD.
 13174
 13175     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13176     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13177     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13178
 13179
 13180* EXEC CICS HANDLE CONDITION
 13181*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13182*    END-EXEC.
 13183*    MOVE '"$I                   ! 1 #00012192' TO DFHEIV0
 13184     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13185     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13186     MOVE X'3120233030303132313932' TO DFHEIV0(25:11)
 13187     CALL 'kxdfhei1' USING DFHEIV0
 13188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13189
 13190
 13191
 13192* EXEC CICS READ
 13193*        SET     (ADDRESS OF PENDING-BUSINESS)
 13194*        DATASET (FILE-ID-ERPNDB)
 13195*        RIDFLD  (ERPNDB-KEY)
 13196*        UPDATE
 13197*    END-EXEC.
 13198*    MOVE '&"S        EU         (   #00012196' TO DFHEIV0
 13199     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13200     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13201     MOVE X'2020233030303132313936' TO DFHEIV0(25:11)
 13202     CALL 'kxdfhei1' USING DFHEIV0,
 13203           FILE-ID-ERPNDB,
 13204           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 241
* EL6311.cbl
 13205           DFHEIV99,
 13206           ERPNDB-KEY,
 13207           DFHEIV99,
 13208           DFHEIV99,
 13209           DFHEIV99
 13210     SET ADDRESS OF PENDING-BUSINESS TO
 13211         DFHEIV20
 13212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13213
 13214
 13215     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13216
 13217     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13218
 13219     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13220        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13221        MOVE 'D'                   TO JP-RECORD-TYPE
 13222        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13223
 13224* EXEC CICS DELETE
 13225*            DATASET    (FILE-ID-ERPNDB)
 13226*       END-EXEC
 13227*    MOVE '&(                    &   #00012211' TO DFHEIV0
 13228     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13229     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13230     MOVE X'2020233030303132323131' TO DFHEIV0(25:11)
 13231     CALL 'kxdfhei1' USING DFHEIV0,
 13232           FILE-ID-ERPNDB,
 13233           DFHEIV99,
 13234           DFHEIV99,
 13235           DFHEIV99,
 13236           DFHEIV99
 13237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13238        PERFORM 8400-LOG-JOURNAL-RECORD
 13239     ELSE
 13240        MOVE 'B'                 TO JP-RECORD-TYPE
 13241        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13242        PERFORM 8400-LOG-JOURNAL-RECORD
 13243        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13244        MOVE 'C'                 TO JP-RECORD-TYPE
 13245        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13246
 13247* EXEC CICS REWRITE
 13248*            DATASET    (FILE-ID-ERPNDB)
 13249*            FROM       (PENDING-BUSINESS)
 13250*       END-EXEC
 13251     MOVE LENGTH OF
 13252      PENDING-BUSINESS
 13253       TO DFHEIV11
 13254*    MOVE '&& L                  %   #00012222' TO DFHEIV0
 13255     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13256     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13257     MOVE X'2020233030303132323232' TO DFHEIV0(25:11)
 13258     CALL 'kxdfhei1' USING DFHEIV0,
 13259           FILE-ID-ERPNDB,
 13260           PENDING-BUSINESS,
 13261           DFHEIV11,
 13262           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 242
* EL6311.cbl
 13263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13264        PERFORM 8400-LOG-JOURNAL-RECORD.
 13265
 13266******************************************************************
 13267*                                                                *
 13268*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13269*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13270*                                                                *
 13271******************************************************************
 13272
 13273     IF NOT PI-AR-PROCESSING
 13274        GO TO 1475-DELETE-FINISHED.
 13275
 13276     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13277        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13278        NEXT SENTENCE
 13279     ELSE
 13280        GO TO 1475-DELETE-FINISHED.
 13281
 13282
 13283* EXEC CICS HANDLE CONDITION
 13284*         NOTFND    (1475-DELETE-FINISHED)
 13285*         END-EXEC.
 13286*    MOVE '"$I                   ! 2 #00012244' TO DFHEIV0
 13287     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13288     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13289     MOVE X'3220233030303132323434' TO DFHEIV0(25:11)
 13290     CALL 'kxdfhei1' USING DFHEIV0
 13291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13292
 13293
 13294     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13295     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13296
 13297
 13298* EXEC CICS READ
 13299*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13300*        DATASET (FILE-ID-ERRQST)
 13301*        RIDFLD  (ERRQST-KEY)
 13302*        UPDATE
 13303*    END-EXEC.
 13304*    MOVE '&"S        EU         (   #00012251' TO DFHEIV0
 13305     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13306     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13307     MOVE X'2020233030303132323531' TO DFHEIV0(25:11)
 13308     CALL 'kxdfhei1' USING DFHEIV0,
 13309           FILE-ID-ERRQST,
 13310           DFHEIV20,
 13311           DFHEIV99,
 13312           ERRQST-KEY,
 13313           DFHEIV99,
 13314           DFHEIV99,
 13315           DFHEIV99
 13316     SET ADDRESS OF AR-REQUEST-RECORD TO
 13317         DFHEIV20
 13318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13319
 13320
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 243
* EL6311.cbl
 13321     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13322
 13323     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13324
 13325     MOVE 'D'                      TO JP-RECORD-TYPE.
 13326     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13327
 13328
 13329* EXEC CICS DELETE
 13330*         DATASET    (FILE-ID-ERRQST)
 13331*    END-EXEC.
 13332*    MOVE '&(                    &   #00012265' TO DFHEIV0
 13333     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13334     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13335     MOVE X'2020233030303132323635' TO DFHEIV0(25:11)
 13336     CALL 'kxdfhei1' USING DFHEIV0,
 13337           FILE-ID-ERRQST,
 13338           DFHEIV99,
 13339           DFHEIV99,
 13340           DFHEIV99,
 13341           DFHEIV99
 13342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13343
 13344
 13345     PERFORM 8400-LOG-JOURNAL-RECORD.
 13346
 13347 1475-DELETE-FINISHED.
 13348     MOVE ZEROS                  TO EMI-ERROR.
 13349     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13350     MOVE LOW-VALUES             TO EL631BI.
 13351     MOVE -1                     TO BMAINTL.
 13352     GO TO 8100-SEND-INITIAL-MAP.
 13353
 13354 1480-BATCH-HDR-NOT-FOUND.
 13355     MOVE -1                     TO BMAINTL.
 13356     MOVE ER-7450                TO EMI-ERROR.
 13357     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13358     GO TO 8200-SEND-DATAONLY.
 13359
 13360 1490-RECORD-NOT-FOUND.
 13361     MOVE -1                     TO BMAINTL.
 13362     MOVE ER-7451                TO EMI-ERROR.
 13363     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13364     GO TO 8200-SEND-DATAONLY.
 13365
 13366******************************************************************
 13367*            O V E R   C H A R G E   P R O C E S S I N G         *
 13368******************************************************************
 13369 1500-UPDATE-ERNOTE.
 13370     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13371     MOVE 'A'                    TO WS-NOTE-SW
 13372     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13373     .
 13374 1500-EXIT.
 13375     EXIT.
 13376 1510-ADD-ERNOTE-REC.
 13377
 13378* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 244
* EL6311.cbl
 13379*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13380*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13381*        INITIMG (GETMAIN-SPACE)
 13382*    END-EXEC
 13383*    MOVE ',"IL                  $   #00012301' TO DFHEIV0
 13384     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13385     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13386     MOVE X'2020233030303132333031' TO DFHEIV0(25:11)
 13387     CALL 'kxdfhei1' USING DFHEIV0,
 13388           DFHEIV20,
 13389           ERNOTE-RECORD-LENGTH,
 13390           GETMAIN-SPACE
 13391     SET ADDRESS OF CERTIFICATE-NOTE TO
 13392         DFHEIV20
 13393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13394     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13395                                 TO ERNOTE-KEY
 13396
 13397* EXEC CICS READ
 13398*       DATASET    (FILE-ID-ERNOTE)
 13399*       RIDFLD     (ERNOTE-KEY)
 13400*       INTO       (CERTIFICATE-NOTE)
 13401*       RESP       (WS-RESPONSE)
 13402*       UPDATE
 13403*    END-EXEC
 13404     MOVE LENGTH OF
 13405      CERTIFICATE-NOTE
 13406       TO DFHEIV11
 13407*    MOVE '&"IL       EU         (  N#00012308' TO DFHEIV0
 13408     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13409     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13410     MOVE X'204E233030303132333038' TO DFHEIV0(25:11)
 13411     CALL 'kxdfhei1' USING DFHEIV0,
 13412           FILE-ID-ERNOTE,
 13413           CERTIFICATE-NOTE,
 13414           DFHEIV11,
 13415           ERNOTE-KEY,
 13416           DFHEIV99,
 13417           DFHEIV99,
 13418           DFHEIV99
 13419     MOVE EIBRESP  TO WS-RESPONSE
 13420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13421     IF RESP-NORMAL
 13422        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13423           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13424        END-IF
 13425        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13426           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13427        END-IF
 13428        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13429           (N1 > +10)
 13430           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13431           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13432        END-PERFORM
 13433        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13434          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13435
 13436* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 245
* EL6311.cbl
 13437*            DATASET    (FILE-ID-ERNOTE)
 13438*          END-EXEC
 13439*    MOVE '&*                    #   #00012329' TO DFHEIV0
 13440     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13441     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13442     MOVE X'2020233030303132333239' TO DFHEIV0(25:11)
 13443     CALL 'kxdfhei1' USING DFHEIV0,
 13444           FILE-ID-ERNOTE,
 13445           DFHEIV99
 13446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13447        ELSE
 13448          PERFORM VARYING N1 FROM +1 BY +1
 13449           UNTIL (N1 > +10)
 13450           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13451          END-PERFORM
 13452          IF (N1 < +11)
 13453            IF N1 >= CN-BILLING-START-LINE-NO AND
 13454              N1 <= CN-BILLING-END-LINE-NO
 13455              IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13456                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13457              ELSE
 13458                 MOVE WS-VA-NO-COMM-MESS
 13459                                    TO CN-LINE (N1)
 13460              END-IF
 13461            ELSE
 13462              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13463               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13464                IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13465                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13466                ELSE
 13467                  MOVE WS-VA-NO-COMM-MESS
 13468                                    TO CN-LINE (N1)
 13469                END-IF
 13470                MOVE N1             TO CN-BILLING-END-LINE-NO
 13471              ELSE
 13472                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13473                  IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13474                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13475                  ELSE
 13476                     MOVE WS-VA-NO-COMM-MESS
 13477                                    TO CN-LINE (N1)
 13478                  END-IF
 13479                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13480                                      CN-BILLING-START-LINE-NO
 13481                ELSE
 13482                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13483                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13484                     IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13485                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13486                     ELSE
 13487                       MOVE WS-VA-NO-COMM-MESS
 13488                                    TO CN-LINE (N1)
 13489                     END-IF
 13490                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13491                  ELSE
 13492                     PERFORM 1700-SQUEEZE-IT-IN
 13493                                 THRU 1700-EXIT
 13494                  END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 246
* EL6311.cbl
 13495                END-IF
 13496              END-IF
 13497            END-IF
 13498            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13499            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13500            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13501
 13502* EXEC CICS REWRITE
 13503*              DATASET    (FILE-ID-ERNOTE)
 13504*              FROM       (CERTIFICATE-NOTE)
 13505*              RESP       (WS-RESPONSE)
 13506*           END-EXEC
 13507     MOVE LENGTH OF
 13508      CERTIFICATE-NOTE
 13509       TO DFHEIV11
 13510*    MOVE '&& L                  %  N#00012386' TO DFHEIV0
 13511     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13512     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13513     MOVE X'204E233030303132333836' TO DFHEIV0(25:11)
 13514     CALL 'kxdfhei1' USING DFHEIV0,
 13515           FILE-ID-ERNOTE,
 13516           CERTIFICATE-NOTE,
 13517           DFHEIV11,
 13518           DFHEIV99
 13519     MOVE EIBRESP  TO WS-RESPONSE
 13520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13521          END-IF
 13522        END-IF
 13523     ELSE
 13524        MOVE SPACES              TO CERTIFICATE-NOTE
 13525        MOVE 'CN'                TO CN-RECORD-ID
 13526        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13527                                 TO CN-CONTROL-PRIMARY
 13528                                    ERNOTE-KEY
 13529        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13530                                    CN-BILLING-END-LINE-NO
 13531        IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13532           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13533        ELSE
 13534           MOVE WS-VA-NO-COMM-MESS
 13535                                 TO CN-LINE (1)
 13536        END-IF
 13537        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13538        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13539        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13540
 13541* EXEC CICS WRITE
 13542*          DATASET    (FILE-ID-ERNOTE)
 13543*          FROM       (CERTIFICATE-NOTE)
 13544*          RIDFLD     (ERNOTE-KEY)
 13545*          RESP       (WS-RESPONSE)
 13546*       END-EXEC
 13547     MOVE LENGTH OF
 13548      CERTIFICATE-NOTE
 13549       TO DFHEIV11
 13550*    MOVE '&$ L                  ''  N#00012410' TO DFHEIV0
 13551     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13552     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 247
* EL6311.cbl
 13553     MOVE X'204E233030303132343130' TO DFHEIV0(25:11)
 13554     CALL 'kxdfhei1' USING DFHEIV0,
 13555           FILE-ID-ERNOTE,
 13556           CERTIFICATE-NOTE,
 13557           DFHEIV11,
 13558           ERNOTE-KEY,
 13559           DFHEIV99,
 13560           DFHEIV99
 13561     MOVE EIBRESP  TO WS-RESPONSE
 13562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13563     END-IF
 13564     .
 13565 1510-EXIT.
 13566     EXIT.
 13567 1520-UPDATE-ELCERT.
 13568     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13569                                 TO ELCERT-KEY
 13570
 13571* EXEC CICS READ
 13572*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13573*        DATASET (FILE-ID-ELCERT)
 13574*        RIDFLD  (ELCERT-KEY)
 13575*        UPDATE
 13576*        RESP    (WS-RESPONSE)
 13577*    END-EXEC
 13578*    MOVE '&"S        EU         (  N#00012423' TO DFHEIV0
 13579     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13580     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13581     MOVE X'204E233030303132343233' TO DFHEIV0(25:11)
 13582     CALL 'kxdfhei1' USING DFHEIV0,
 13583           FILE-ID-ELCERT,
 13584           DFHEIV20,
 13585           DFHEIV99,
 13586           ELCERT-KEY,
 13587           DFHEIV99,
 13588           DFHEIV99,
 13589           DFHEIV99
 13590     SET ADDRESS OF CERTIFICATE-MASTER TO
 13591         DFHEIV20
 13592     MOVE EIBRESP  TO WS-RESPONSE
 13593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13594     IF RESP-NORMAL
 13595        IF WS-NOTE-SW = 'A'
 13596           IF CM-NOTE-SW = ' '
 13597              MOVE '2'             TO CM-NOTE-SW
 13598           ELSE
 13599             IF CM-NOTE-SW = '1'
 13600                MOVE '3'           TO CM-NOTE-SW
 13601             ELSE
 13602               IF CM-NOTE-SW = '4'
 13603                  MOVE '6'         TO CM-NOTE-SW
 13604               ELSE
 13605                 IF CM-NOTE-SW = '5'
 13606                    MOVE '7'       TO CM-NOTE-SW
 13607                 END-IF
 13608               END-IF
 13609             END-IF
 13610           END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 248
* EL6311.cbl
 13611        ELSE
 13612           IF CM-NOTE-SW = '2'
 13613              MOVE ' '             TO CM-NOTE-SW
 13614           ELSE
 13615             IF CM-NOTE-SW = '3'
 13616                MOVE '1'           TO CM-NOTE-SW
 13617             ELSE
 13618               IF CM-NOTE-SW = '6'
 13619                  MOVE '4'         TO CM-NOTE-SW
 13620               ELSE
 13621                 IF CM-NOTE-SW = '7'
 13622                    MOVE '5'       TO CM-NOTE-SW
 13623                 END-IF
 13624               END-IF
 13625             END-IF
 13626           END-IF
 13627        END-IF
 13628
 13629* EXEC CICS REWRITE
 13630*          DATASET    (FILE-ID-ELCERT)
 13631*          FROM       (CERTIFICATE-MASTER)
 13632*          RESP       (WS-RESPONSE)
 13633*       END-EXEC
 13634     MOVE LENGTH OF
 13635      CERTIFICATE-MASTER
 13636       TO DFHEIV11
 13637*    MOVE '&& L                  %  N#00012464' TO DFHEIV0
 13638     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13639     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13640     MOVE X'204E233030303132343634' TO DFHEIV0(25:11)
 13641     CALL 'kxdfhei1' USING DFHEIV0,
 13642           FILE-ID-ELCERT,
 13643           CERTIFICATE-MASTER,
 13644           DFHEIV11,
 13645           DFHEIV99
 13646     MOVE EIBRESP  TO WS-RESPONSE
 13647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13648        IF RESP-NORMAL
 13649           CONTINUE
 13650        ELSE
 13651           MOVE WS-RESPONSE TO EMI-ERROR
 13652           PERFORM 9900-ERROR-FORMAT
 13653                                 THRU 9900-EXIT
 13654           GO TO 8200-SEND-DATAONLY
 13655        END-IF
 13656     ELSE
 13657        MOVE -1                  TO BMAINTL
 13658        MOVE 0249                TO EMI-ERROR
 13659        PERFORM 9900-ERROR-FORMAT
 13660                                 THRU 9900-EXIT
 13661        GO TO 8200-SEND-DATAONLY
 13662     END-IF
 13663     .
 13664 1520-EXIT.
 13665     EXIT.
 13666 1600-UPDATE-ERPYAJ.
 13667     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13668                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 249
* EL6311.cbl
 13669     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13670                                 THRU 1620-EXIT
 13671     .
 13672 1600-EXIT.
 13673     EXIT.
 13674 1610-ADD-ERPYAJ-BANK-REC.
 13675
 13676* EXEC CICS GETMAIN
 13677*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13678*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13679*        INITIMG (GETMAIN-SPACE)
 13680*    END-EXEC
 13681*    MOVE ',"IL                  $   #00012496' TO DFHEIV0
 13682     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13683     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13684     MOVE X'2020233030303132343936' TO DFHEIV0(25:11)
 13685     CALL 'kxdfhei1' USING DFHEIV0,
 13686           DFHEIV20,
 13687           ERPYAJ-RECORD-LENGTH,
 13688           GETMAIN-SPACE
 13689     SET ADDRESS OF PENDING-PAY-ADJ TO
 13690         DFHEIV20
 13691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13692     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13693     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13694     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13695     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13696     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13697     MOVE +10                    TO ERPYAJ-SEQ-NO
 13698     MOVE 'R'                    TO ERPYAJ-TYPE
 13699     IF REVERSAL
 13700        MOVE 'C'                 TO ERPYAJ-TYPE
 13701     END-IF
 13702     MOVE SPACES                 TO PENDING-PAY-ADJ
 13703     MOVE 'PY'                   TO PY-RECORD-ID
 13704     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13705     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13706     IF REVERSAL
 13707        MOVE PB-I-DCC-OVER-CHG-AMT
 13708                                 TO PY-ENTRY-AMT
 13709     END-IF
 13710     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13711                                    PY-INPUT-DT
 13712*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13713*                                   PY-INPUT-DT
 13714     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13715     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13716     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13717     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13718     IF PB-CARRIER = '2'
 13719        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13720     ELSE
 13721        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13722     END-IF
 13723     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13724                                    PY-BILLED-DATE
 13725                                    PY-AR-DATE
 13726                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 250
* EL6311.cbl
 13727                                    PY-CHECK-WRITTEN-DT
 13728     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13729                                    PY-CHECK-QUE-SEQUENCE
 13730     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13731     PERFORM WITH TEST AFTER
 13732        UNTIL (NOT RESP-DUPKEY)
 13733           AND (NOT RESP-DUPREC)
 13734
 13735* EXEC CICS WRITE
 13736*          DATASET    (FILE-ID-ERPYAJ)
 13737*          FROM       (PENDING-PAY-ADJ)
 13738*          RIDFLD     (ERPYAJ-KEY)
 13739*          RESP       (WS-RESPONSE)
 13740*       END-EXEC
 13741     MOVE LENGTH OF
 13742      PENDING-PAY-ADJ
 13743       TO DFHEIV11
 13744*    MOVE '&$ L                  ''  N#00012543' TO DFHEIV0
 13745     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13746     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13747     MOVE X'204E233030303132353433' TO DFHEIV0(25:11)
 13748     CALL 'kxdfhei1' USING DFHEIV0,
 13749           FILE-ID-ERPYAJ,
 13750           PENDING-PAY-ADJ,
 13751           DFHEIV11,
 13752           ERPYAJ-KEY,
 13753           DFHEIV99,
 13754           DFHEIV99
 13755     MOVE EIBRESP  TO WS-RESPONSE
 13756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13757        IF RESP-DUPKEY OR RESP-DUPREC
 13758           ADD +1                TO ERPYAJ-SEQ-NO
 13759           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13760        END-IF
 13761     END-PERFORM
 13762     .
 13763 1610-EXIT.
 13764     EXIT.
 13765 1620-ADD-ERPYAJ-DLR-REC.
 13766     MOVE 'C'                    TO ERPYAJ-TYPE
 13767     IF REVERSAL
 13768        MOVE 'R'                 TO ERPYAJ-TYPE
 13769     END-IF
 13770     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13771                                    ERPYAJ-ACCOUNT
 13772     ADD +1                      TO ERPYAJ-SEQ-NO
 13773     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13774     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13775     IF PB-CARRIER = '2'
 13776        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13777     ELSE
 13778        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13779     END-IF
 13780     PERFORM WITH TEST AFTER
 13781        UNTIL (NOT RESP-DUPKEY)
 13782           AND (NOT RESP-DUPREC)
 13783
 13784* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 251
* EL6311.cbl
 13785*          DATASET    (FILE-ID-ERPYAJ)
 13786*          FROM       (PENDING-PAY-ADJ)
 13787*          RIDFLD     (ERPYAJ-KEY)
 13788*          RESP       (WS-RESPONSE)
 13789*       END-EXEC
 13790     MOVE LENGTH OF
 13791      PENDING-PAY-ADJ
 13792       TO DFHEIV11
 13793*    MOVE '&$ L                  ''  N#00012575' TO DFHEIV0
 13794     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13795     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13796     MOVE X'204E233030303132353735' TO DFHEIV0(25:11)
 13797     CALL 'kxdfhei1' USING DFHEIV0,
 13798           FILE-ID-ERPYAJ,
 13799           PENDING-PAY-ADJ,
 13800           DFHEIV11,
 13801           ERPYAJ-KEY,
 13802           DFHEIV99,
 13803           DFHEIV99
 13804     MOVE EIBRESP  TO WS-RESPONSE
 13805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13806        IF RESP-DUPKEY OR RESP-DUPREC
 13807           ADD +1                TO ERPYAJ-SEQ-NO
 13808           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13809        END-IF
 13810     END-PERFORM
 13811     .
 13812 1620-EXIT.
 13813     EXIT.
 13814 1700-SQUEEZE-IT-IN.
 13815     IF (N1 > CN-BILLING-END-LINE-NO)
 13816        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13817           N1 = +1
 13818           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13819           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13820              IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13821                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13822              ELSE
 13823                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13824              END-IF
 13825              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13826              MOVE +2 TO N1
 13827           END-IF
 13828        END-PERFORM
 13829     ELSE
 13830        IF (N1 < CN-BILLING-START-LINE-NO)
 13831           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13832              N1 = +10
 13833              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13834              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13835                 IF PI-COMPANY-ID = 'DCC' or 'CAP'
 13836                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13837                 ELSE
 13838                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13839                 END-IF
 13840                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13841                 MOVE +9 TO N1
 13842              END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 252
* EL6311.cbl
 13843           END-PERFORM
 13844        END-IF
 13845     END-IF
 13846     .
 13847 1700-EXIT.
 13848     EXIT.
 13849 1800-REMOVE-CERT-NOTES.
 13850     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13851                                 TO ERNOTE-KEY
 13852
 13853* EXEC CICS READ
 13854*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13855*       DATASET    (FILE-ID-ERNOTE)
 13856*       RIDFLD     (ERNOTE-KEY)
 13857*       RESP       (WS-RESPONSE)
 13858*       UPDATE
 13859*    END-EXEC
 13860*    MOVE '&"S        EU         (  N#00012627' TO DFHEIV0
 13861     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13862     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13863     MOVE X'204E233030303132363237' TO DFHEIV0(25:11)
 13864     CALL 'kxdfhei1' USING DFHEIV0,
 13865           FILE-ID-ERNOTE,
 13866           DFHEIV20,
 13867           DFHEIV99,
 13868           ERNOTE-KEY,
 13869           DFHEIV99,
 13870           DFHEIV99,
 13871           DFHEIV99
 13872     SET ADDRESS OF CERTIFICATE-NOTE TO
 13873         DFHEIV20
 13874     MOVE EIBRESP  TO WS-RESPONSE
 13875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13876     IF RESP-NORMAL
 13877        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13878           (N1 > +10)
 13879           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13880           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13881        END-PERFORM
 13882        IF N1 < +11
 13883           MOVE SPACES              TO CN-LINE (N1)
 13884           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13885              N1 <= CN-BILLING-END-LINE-NO
 13886              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13887              IF CN-BILLING-END-LINE-NO <
 13888                               CN-BILLING-START-LINE-NO
 13889                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13890                                     CN-BILLING-START-LINE-NO
 13891              END-IF
 13892              PERFORM 1820-SQUEEZE-ERNOTE
 13893                                  THRU 1820-EXIT
 13894           END-IF
 13895           IF CN-LINES = SPACES
 13896
 13897* EXEC CICS DELETE
 13898*                DATASET    (FILE-ID-ERNOTE)
 13899*                RESP       (WS-RESPONSE)
 13900*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 253
* EL6311.cbl
 13901*    MOVE '&(                    &  N#00012654' TO DFHEIV0
 13902     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13903     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13904     MOVE X'204E233030303132363534' TO DFHEIV0(25:11)
 13905     CALL 'kxdfhei1' USING DFHEIV0,
 13906           FILE-ID-ERNOTE,
 13907           DFHEIV99,
 13908           DFHEIV99,
 13909           DFHEIV99,
 13910           DFHEIV99
 13911     MOVE EIBRESP  TO WS-RESPONSE
 13912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13913              IF RESP-NORMAL
 13914                 MOVE 'D'        TO WS-NOTE-SW
 13915                 PERFORM 1520-UPDATE-ELCERT
 13916                                 THRU 1520-EXIT
 13917              END-IF
 13918           ELSE
 13919
 13920* EXEC CICS REWRITE
 13921*                DATASET    (FILE-ID-ERNOTE)
 13922*                FROM       (CERTIFICATE-NOTE)
 13923*                RESP       (WS-RESPONSE)
 13924*             END-EXEC
 13925     MOVE LENGTH OF
 13926      CERTIFICATE-NOTE
 13927       TO DFHEIV11
 13928*    MOVE '&& L                  %  N#00012664' TO DFHEIV0
 13929     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13930     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13931     MOVE X'204E233030303132363634' TO DFHEIV0(25:11)
 13932     CALL 'kxdfhei1' USING DFHEIV0,
 13933           FILE-ID-ERNOTE,
 13934           CERTIFICATE-NOTE,
 13935           DFHEIV11,
 13936           DFHEIV99
 13937     MOVE EIBRESP  TO WS-RESPONSE
 13938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13939           END-IF
 13940        END-IF
 13941     END-IF
 13942     .
 13943 1800-EXIT.
 13944     EXIT.
 13945 1820-SQUEEZE-ERNOTE.
 13946     MOVE CN-BILLING-START-LINE-NO TO N2
 13947     IF N2 = 0
 13948         MOVE +1                 TO N2
 13949     END-IF
 13950     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13951        (N1 > +9)
 13952        IF CN-LINE (N1) = SPACES
 13953           MOVE CN-LINE (N1 + +1)
 13954                                 TO CN-LINE (N1)
 13955           MOVE SPACES           TO CN-LINE (N1 + +1)
 13956        END-IF
 13957     END-PERFORM
 13958     .
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 254
* EL6311.cbl
 13959 1820-EXIT.
 13960     EXIT.
 13961 1900-DELETE-ERPYAJ.
 13962     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13963     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13964     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13965     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13966     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13967     MOVE +10                    TO ERPYAJ-SEQ-NO
 13968     MOVE 'R'                    TO ERPYAJ-TYPE
 13969     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13970
 13971* EXEC CICS STARTBR
 13972*       DATASET    (FILE-ID-ERPYAJ)
 13973*       RIDFLD     (ERPYAJ-KEY)
 13974*       RESP       (WS-RESPONSE)
 13975*    END-EXEC
 13976     MOVE 0
 13977       TO DFHEIV11
 13978*    MOVE '&,         G          &  N#00012700' TO DFHEIV0
 13979     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13980     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13981     MOVE X'204E233030303132373030' TO DFHEIV0(25:11)
 13982     CALL 'kxdfhei1' USING DFHEIV0,
 13983           FILE-ID-ERPYAJ,
 13984           ERPYAJ-KEY,
 13985           DFHEIV99,
 13986           DFHEIV11,
 13987           DFHEIV99
 13988     MOVE EIBRESP  TO WS-RESPONSE
 13989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13990     IF RESP-NORMAL
 13991        CONTINUE
 13992     ELSE
 13993        GO TO 1900-GET-DEALER
 13994     END-IF
 13995     .
 13996 1900-READNEXT-ERPYAJ-B.
 13997*  GET THE BANK ERPYAJ RECORD
 13998
 13999* EXEC CICS READNEXT
 14000*       DATASET    (FILE-ID-ERPYAJ)
 14001*       RIDFLD     (ERPYAJ-KEY)
 14002*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14003*       RESP       (WS-RESPONSE)
 14004*    END-EXEC
 14005     MOVE 0
 14006       TO DFHEIV11
 14007*    MOVE '&.S                   )  N#00012713' TO DFHEIV0
 14008     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14009     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14010     MOVE X'204E233030303132373133' TO DFHEIV0(25:11)
 14011     CALL 'kxdfhei1' USING DFHEIV0,
 14012           FILE-ID-ERPYAJ,
 14013           DFHEIV20,
 14014           DFHEIV99,
 14015           ERPYAJ-KEY,
 14016           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 255
* EL6311.cbl
 14017           DFHEIV11,
 14018           DFHEIV99,
 14019           DFHEIV99
 14020     SET ADDRESS OF PENDING-PAY-ADJ TO
 14021         DFHEIV20
 14022     MOVE EIBRESP  TO WS-RESPONSE
 14023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14024     IF RESP-NORMAL
 14025        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14026           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14027              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14028                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14029
 14030* EXEC CICS READ
 14031*                   DATASET    (FILE-ID-ERPYAJ)
 14032*                   RIDFLD     (ERPYAJ-KEY)
 14033*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14034*                   RESP       (WS-RESPONSE)
 14035*                   UPDATE
 14036*                END-EXEC
 14037*    MOVE '&"S        EU         (  N#00012724' TO DFHEIV0
 14038     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14039     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14040     MOVE X'204E233030303132373234' TO DFHEIV0(25:11)
 14041     CALL 'kxdfhei1' USING DFHEIV0,
 14042           FILE-ID-ERPYAJ,
 14043           DFHEIV20,
 14044           DFHEIV99,
 14045           ERPYAJ-KEY,
 14046           DFHEIV99,
 14047           DFHEIV99,
 14048           DFHEIV99
 14049     SET ADDRESS OF PENDING-PAY-ADJ TO
 14050         DFHEIV20
 14051     MOVE EIBRESP  TO WS-RESPONSE
 14052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14053                 IF RESP-NORMAL
 14054
 14055* EXEC CICS DELETE
 14056*                      DATASET   (FILE-ID-ERPYAJ)
 14057*                      RESP      (WS-RESPONSE)
 14058*                   END-EXEC
 14059*    MOVE '&(                    &  N#00012732' TO DFHEIV0
 14060     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14061     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14062     MOVE X'204E233030303132373332' TO DFHEIV0(25:11)
 14063     CALL 'kxdfhei1' USING DFHEIV0,
 14064           FILE-ID-ERPYAJ,
 14065           DFHEIV99,
 14066           DFHEIV99,
 14067           DFHEIV99,
 14068           DFHEIV99
 14069     MOVE EIBRESP  TO WS-RESPONSE
 14070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14071                 END-IF
 14072              ELSE
 14073                 SET REVERSAL    TO TRUE
 14074                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 256
* EL6311.cbl
 14075                                 THRU 1600-EXIT
 14076                 GO TO 1900-EXIT
 14077              END-IF
 14078           ELSE
 14079              GO TO 1900-READNEXT-ERPYAJ-B
 14080           END-IF
 14081        END-IF
 14082
 14083* EXEC CICS ENDBR
 14084*          DATASET   (FILE-ID-ERPYAJ)
 14085*       END-EXEC
 14086     MOVE 0
 14087       TO DFHEIV11
 14088*    MOVE '&2                    $   #00012747' TO DFHEIV0
 14089     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14090     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14091     MOVE X'2020233030303132373437' TO DFHEIV0(25:11)
 14092     CALL 'kxdfhei1' USING DFHEIV0,
 14093           FILE-ID-ERPYAJ,
 14094           DFHEIV11,
 14095           DFHEIV99
 14096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14097     END-IF
 14098     .
 14099 1900-GET-DEALER.
 14100     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14101     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14102     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14103     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14104     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14105     MOVE +10                    TO ERPYAJ-SEQ-NO
 14106     MOVE 'C'                    TO ERPYAJ-TYPE
 14107     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14108
 14109* EXEC CICS STARTBR
 14110*       DATASET    (FILE-ID-ERPYAJ)
 14111*       RIDFLD     (ERPYAJ-KEY)
 14112*       RESP       (WS-RESPONSE)
 14113*    END-EXEC
 14114     MOVE 0
 14115       TO DFHEIV11
 14116*    MOVE '&,         G          &  N#00012761' TO DFHEIV0
 14117     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14118     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14119     MOVE X'204E233030303132373631' TO DFHEIV0(25:11)
 14120     CALL 'kxdfhei1' USING DFHEIV0,
 14121           FILE-ID-ERPYAJ,
 14122           ERPYAJ-KEY,
 14123           DFHEIV99,
 14124           DFHEIV11,
 14125           DFHEIV99
 14126     MOVE EIBRESP  TO WS-RESPONSE
 14127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14128     IF RESP-NORMAL
 14129        CONTINUE
 14130     ELSE
 14131        GO TO 1900-EXIT
 14132     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 257
* EL6311.cbl
 14133     .
 14134 1900-READNEXT-ERPYAJ-D.
 14135*  GET THE DEALER ERPYAJ RECORD
 14136
 14137* EXEC CICS READNEXT
 14138*       DATASET    (FILE-ID-ERPYAJ)
 14139*       RIDFLD     (ERPYAJ-KEY)
 14140*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14141*       RESP       (WS-RESPONSE)
 14142*    END-EXEC
 14143     MOVE 0
 14144       TO DFHEIV11
 14145*    MOVE '&.S                   )  N#00012774' TO DFHEIV0
 14146     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14147     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14148     MOVE X'204E233030303132373734' TO DFHEIV0(25:11)
 14149     CALL 'kxdfhei1' USING DFHEIV0,
 14150           FILE-ID-ERPYAJ,
 14151           DFHEIV20,
 14152           DFHEIV99,
 14153           ERPYAJ-KEY,
 14154           DFHEIV99,
 14155           DFHEIV11,
 14156           DFHEIV99,
 14157           DFHEIV99
 14158     SET ADDRESS OF PENDING-PAY-ADJ TO
 14159         DFHEIV20
 14160     MOVE EIBRESP  TO WS-RESPONSE
 14161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14162     IF RESP-NORMAL
 14163        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14164           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14165              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14166                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14167
 14168* EXEC CICS READ
 14169*                   DATASET    (FILE-ID-ERPYAJ)
 14170*                   RIDFLD     (ERPYAJ-KEY)
 14171*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14172*                   RESP       (WS-RESPONSE)
 14173*                   UPDATE
 14174*                END-EXEC
 14175*    MOVE '&"S        EU         (  N#00012785' TO DFHEIV0
 14176     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14177     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14178     MOVE X'204E233030303132373835' TO DFHEIV0(25:11)
 14179     CALL 'kxdfhei1' USING DFHEIV0,
 14180           FILE-ID-ERPYAJ,
 14181           DFHEIV20,
 14182           DFHEIV99,
 14183           ERPYAJ-KEY,
 14184           DFHEIV99,
 14185           DFHEIV99,
 14186           DFHEIV99
 14187     SET ADDRESS OF PENDING-PAY-ADJ TO
 14188         DFHEIV20
 14189     MOVE EIBRESP  TO WS-RESPONSE
 14190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 258
* EL6311.cbl
 14191                 IF RESP-NORMAL
 14192
 14193* EXEC CICS DELETE
 14194*                      DATASET   (FILE-ID-ERPYAJ)
 14195*                      RESP      (WS-RESPONSE)
 14196*                   END-EXEC
 14197*    MOVE '&(                    &  N#00012793' TO DFHEIV0
 14198     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14199     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14200     MOVE X'204E233030303132373933' TO DFHEIV0(25:11)
 14201     CALL 'kxdfhei1' USING DFHEIV0,
 14202           FILE-ID-ERPYAJ,
 14203           DFHEIV99,
 14204           DFHEIV99,
 14205           DFHEIV99,
 14206           DFHEIV99
 14207     MOVE EIBRESP  TO WS-RESPONSE
 14208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14209                 END-IF
 14210              ELSE
 14211                 SET REVERSAL    TO TRUE
 14212              END-IF
 14213           ELSE
 14214              GO TO 1900-READNEXT-ERPYAJ-D
 14215           END-IF
 14216        END-IF
 14217
 14218* EXEC CICS ENDBR
 14219*          DATASET   (FILE-ID-ERPYAJ)
 14220*       END-EXEC
 14221     MOVE 0
 14222       TO DFHEIV11
 14223*    MOVE '&2                    $   #00012805' TO DFHEIV0
 14224     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14225     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14226     MOVE X'2020233030303132383035' TO DFHEIV0(25:11)
 14227     CALL 'kxdfhei1' USING DFHEIV0,
 14228           FILE-ID-ERPYAJ,
 14229           DFHEIV11,
 14230           DFHEIV99
 14231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14232     END-IF
 14233     .
 14234 1900-EXIT.
 14235     EXIT.
 14236******************************************************************
 14237*            C A N C E L   M A I N L I N E                       *
 14238******************************************************************
 14239
 14240 2000-CANCEL-MAINLINE.
 14241     IF PI-DISPLAY-ORIGINAL-BATCH
 14242        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14243           MOVE ER-0023             TO EMI-ERROR
 14244           MOVE -1                  TO CMAINTL
 14245           MOVE AL-UABON            TO CMAINTA
 14246           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14247           GO TO 8200-SEND-DATAONLY
 14248        ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 259
* EL6311.cbl
 14249           NEXT SENTENCE
 14250     ELSE
 14251        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14252           MOVE ER-0023             TO EMI-ERROR
 14253           MOVE -1                  TO CMAINTL
 14254           MOVE AL-UABON            TO CMAINTA
 14255           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14256           GO TO 8200-SEND-DATAONLY.
 14257
 14258     IF CMAINTI = 'S'
 14259        GO TO 2100-SHOW-REQUEST.
 14260
 14261     IF NOT MODIFY-CAP
 14262         MOVE 'UPDATE'       TO SM-READ
 14263         PERFORM 9995-SECURITY-VIOLATION
 14264         MOVE ER-0070        TO EMI-ERROR
 14265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14266         GO TO 8100-SEND-INITIAL-MAP.
 14267
 14268     IF CMAINTL GREATER THAN ZEROS
 14269        IF PI-PF6-FUNCTION
 14270           IF CMAINTI NOT = 'A'
 14271              MOVE AL-UABON  TO CMAINTA
 14272              MOVE -1        TO CMAINTL
 14273              MOVE ER-2260   TO EMI-ERROR
 14274              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14275              GO TO 8200-SEND-DATAONLY.
 14276
 14277     IF CCERTNOL = ZEROS
 14278       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14279         NEXT SENTENCE
 14280     ELSE
 14281         IF CCERTNOL NOT = ZEROS
 14282             MOVE AL-UANON       TO CCERTNOA
 14283         ELSE
 14284             MOVE -1             TO CCERTNOL
 14285             MOVE  1             TO SET-CURSOR-SW
 14286             MOVE ER-2218       TO EMI-ERROR
 14287             MOVE AL-UABON       TO CCERTNOA
 14288             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14289
 14290     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14291        NEXT SENTENCE
 14292     ELSE
 14293        IF CEFFDTL NOT = ZEROS
 14294           MOVE AL-UNNON         TO CEFFDTA
 14295           MOVE CEFFDTI TO DEEDIT-FIELD
 14296           PERFORM 8600-DEEDIT
 14297           MOVE 4                TO DC-OPTION-CODE
 14298           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14299           PERFORM 9700-DATE-LINK
 14300           IF NO-CONVERSION-ERROR
 14301              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14302              ELSE
 14303              MOVE -1            TO CEFFDTL
 14304              MOVE  1            TO SET-CURSOR-SW
 14305              MOVE ER-2226      TO EMI-ERROR
 14306              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 260
* EL6311.cbl
 14307              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14308          ELSE
 14309          MOVE -1                 TO CEFFDTL
 14310          MOVE  1                 TO SET-CURSOR-SW
 14311          MOVE ER-2220            TO EMI-ERROR
 14312          MOVE AL-UNBON           TO CEFFDTA
 14313          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14314
 14315     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14316
 14317     IF CCERTNOL NOT = ZEROS
 14318        MOVE CCERTNOI                TO WS-NEW-PRIME
 14319     ELSE
 14320        MOVE SPACES                  TO WS-NEW-PRIME.
 14321
 14322     IF CSUFIXL NOT = ZEROS
 14323        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14324     ELSE
 14325        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14326
 14327     IF CEFFDTL NOT = ZEROS
 14328        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14329     ELSE
 14330        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14331
 14332     IF CMAINTI = 'A' OR 'K' OR 'S'
 14333        NEXT SENTENCE
 14334     ELSE
 14335        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14336        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14337           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14338           WS-PB-RECORD-TYPE NOT = '2'
 14339           IF CMAINTI = 'C'
 14340              MOVE ER-2287          TO EMI-ERROR
 14341              MOVE -1               TO CCERTNOL
 14342              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14343              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14344              GO TO 8200-SEND-DATAONLY
 14345             ELSE
 14346              MOVE ER-2260          TO EMI-ERROR
 14347              MOVE -1               TO CCERTNOL
 14348              MOVE AL-UABON         TO CCERTNOA
 14349              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14350              GO TO 8200-SEND-DATAONLY.
 14351
 14352     IF CMAINTI = 'D'
 14353        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14354
 14355     IF CLSTNML GREATER THAN ZEROS
 14356         MOVE AL-UANON           TO CLSTNMA.
 14357
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 261
* EL6311.cbl
 14359
 14360******************************************************************
 14361*                                                                *
 14362*           E D I T   C A N C E L   C O V E R A G E S            *
 14363*                                                                *
 14364******************************************************************
 14365
 14366 2015-EDIT-COVERAGES.
 14367     IF CCANDT1L      GREATER THAN ZEROS OR
 14368        CREFND1L      GREATER THAN ZEROS OR
 14369        CCANDT2L      GREATER THAN ZEROS OR
 14370        CREFND2L      GREATER THAN ZEROS OR
 14371        CMTHD1L       GREATER THAN ZEROS OR
 14372        CMTHD2L       GREATER THAN ZEROS OR
 14373        CLIVESL       GREATER THAN ZEROS OR
 14374        CPAYEEL       GREATER THAN ZEROS OR
 14375        CFORCEL       GREATER THAN ZEROS OR
 14376        CBILCDL       GREATER THAN ZEROS OR
 14377        CCANREAL      GREATER THAN ZEROS
 14378            NEXT SENTENCE
 14379         ELSE
 14380            GO TO 2030-EDIT-COMPLETE.
 14381
 14382     IF CCANDT1L = ZEROS
 14383        AND (CMAINTI = 'C' OR 'K')
 14384        NEXT SENTENCE
 14385     ELSE
 14386        IF CCANDT1L      GREATER THAN ZEROS
 14387            MOVE AL-UNNON            TO CCANDT1A
 14388            IF CCANDT1I = SPACES
 14389               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14390            ELSE
 14391               MOVE CCANDT1I            TO DEEDIT-FIELD
 14392               PERFORM 8600-DEEDIT
 14393               IF DEEDIT-FIELD-V0   NUMERIC
 14394                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14395                  MOVE 4                TO DC-OPTION-CODE
 14396                  PERFORM 9700-DATE-LINK
 14397                  IF NO-CONVERSION-ERROR
 14398                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14399                  ELSE
 14400                      MOVE -1        TO CCANDT1L
 14401                      MOVE ER-2227   TO EMI-ERROR
 14402                      MOVE AL-UNBON  TO CCANDT1A
 14403                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14404               ELSE
 14405                  MOVE -1         TO CCANDT1L
 14406                  MOVE ER-2223    TO EMI-ERROR
 14407                  MOVE AL-UNBON   TO CCANDT1A
 14408                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14409        ELSE
 14410            IF CREFND1L GREATER THAN ZEROS
 14411               MOVE -1             TO CCANDT1L
 14412               MOVE ER-2222        TO EMI-ERROR
 14413               MOVE AL-UNBOF       TO CCANDT1A
 14414               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14415
 14416     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 262
* EL6311.cbl
 14417        AND (CMAINTI = 'C' OR 'K')
 14418         NEXT SENTENCE
 14419     ELSE
 14420         IF CREFND1L NOT = ZEROS
 14421            MOVE AL-UNNON        TO CREFND1A
 14422
 14423* EXEC CICS BIF DEEDIT
 14424*               FIELD  (CREFND1I)
 14425*               LENGTH (11)
 14426*           END-EXEC
 14427     MOVE 11
 14428       TO DFHEIV11
 14429*    MOVE '@"L                   #   #00012998' TO DFHEIV0
 14430     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14431     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14432     MOVE X'2020233030303132393938' TO DFHEIV0(25:11)
 14433     CALL 'kxdfhei1' USING DFHEIV0,
 14434           CREFND1I,
 14435           DFHEIV11
 14436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14437            MOVE CREFND1I        TO WS-CREFND1
 14438*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14439*           PERFORM 8600-DEEDIT
 14440*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14441            IF WS-CREFND1  = ZEROS
 14442               AND CMAINTI = 'A'
 14443             MOVE ER-2437        TO EMI-ERROR
 14444             MOVE -1             TO CREFND1L
 14445             MOVE AL-UNBON       TO CREFND1A
 14446             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14447
 14448     IF CCANREAL > +0
 14449        MOVE AL-UANON            TO CCANREAA
 14450        IF CCANREAI = 'R' OR ' '
 14451           CONTINUE
 14452        ELSE
 14453           MOVE ER-9841        TO EMI-ERROR
 14454           MOVE -1             TO CCANREAL
 14455           MOVE AL-UABON       TO CCANREAA
 14456           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14457        END-IF
 14458     END-IF
 14459     IF CMTHD1L EQUAL +0
 14460        NEXT SENTENCE
 14461     ELSE
 14462        IF CMTHD1L NOT = +0
 14463           MOVE AL-UNNON        TO CMTHD1A
 14464           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14465                         OR '5' OR '6' OR '8' OR '9'
 14466                         OR 'R' OR ' '
 14467              NEXT SENTENCE
 14468           ELSE
 14469              MOVE ER-0582        TO EMI-ERROR
 14470              MOVE -1             TO CMTHD1L
 14471              MOVE AL-UNBON       TO CMTHD1A
 14472              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14473
 14474     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 263
* EL6311.cbl
 14475        AND (CMAINTI = 'C' OR 'K')
 14476         NEXT SENTENCE
 14477     ELSE
 14478         IF CCANDT2L  GREATER THAN ZEROS
 14479             MOVE AL-UNNON       TO CCANDT2A
 14480             IF CCANDT2I = SPACES
 14481                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14482             ELSE
 14483                MOVE CCANDT2I       TO DEEDIT-FIELD
 14484                PERFORM 8600-DEEDIT
 14485                IF DEEDIT-FIELD-V0   NUMERIC
 14486                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14487                   MOVE 4                TO DC-OPTION-CODE
 14488                   PERFORM 9700-DATE-LINK
 14489                   IF NO-CONVERSION-ERROR
 14490                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14491                   ELSE
 14492                      MOVE -1       TO CCANDT2L
 14493                      MOVE ER-2227  TO EMI-ERROR
 14494                      MOVE AL-UNBON TO CCANDT2A
 14495                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14496                ELSE
 14497                   MOVE -1         TO CCANDT2L
 14498                   MOVE ER-2223    TO EMI-ERROR
 14499                   MOVE AL-UNBON   TO CCANDT2A
 14500                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14501         ELSE
 14502            IF CREFND2L GREATER THAN ZEROS
 14503               MOVE -1             TO CCANDT2L
 14504               MOVE ER-2222        TO EMI-ERROR
 14505               MOVE AL-UNBOF       TO CCANDT2A
 14506               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14507
 14508     IF CREFND2L = ZEROS
 14509        AND (CMAINTI = 'C' OR 'K')
 14510         NEXT SENTENCE
 14511     ELSE
 14512         IF CREFND2L NOT = ZEROS
 14513            MOVE AL-UNNON        TO CREFND2A
 14514
 14515* EXEC CICS BIF DEEDIT
 14516*               FIELD  (CREFND2I)
 14517*               LENGTH (11)
 14518*           END-EXEC
 14519     MOVE 11
 14520       TO DFHEIV11
 14521*    MOVE '@"L                   #   #00013079' TO DFHEIV0
 14522     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14523     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14524     MOVE X'2020233030303133303739' TO DFHEIV0(25:11)
 14525     CALL 'kxdfhei1' USING DFHEIV0,
 14526           CREFND2I,
 14527           DFHEIV11
 14528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14529            MOVE CREFND2I        TO WS-CREFND2
 14530*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14531*           PERFORM 8600-DEEDIT
 14532*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 264
* EL6311.cbl
 14533            IF WS-CREFND2  = ZEROS
 14534               AND CMAINTI = 'A'
 14535             MOVE ER-2437        TO EMI-ERROR
 14536             MOVE -1             TO CREFND2L
 14537             MOVE AL-UNBON       TO CREFND2A
 14538             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14539
 14540     IF CMTHD2L EQUAL +0
 14541        NEXT SENTENCE
 14542     ELSE
 14543        IF CMTHD2L NOT = +0
 14544           MOVE AL-UNNON        TO CMTHD2A
 14545           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14546                         OR '5' OR '6' OR '8' OR '9'
 14547                         OR ' ' OR 'R'
 14548              NEXT SENTENCE
 14549           ELSE
 14550              MOVE ER-0582        TO EMI-ERROR
 14551              MOVE -1             TO CMTHD2L
 14552              MOVE AL-UNBON       TO CMTHD2A
 14553              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14554
 14555     IF CLIVESL GREATER THAN ZEROS
 14556         MOVE CLIVESI            TO DEEDIT-FIELD
 14557         PERFORM 8600-DEEDIT
 14558         IF DEEDIT-FIELD-V0 NUMERIC
 14559             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14560             MOVE AL-UNNON       TO CLIVESA
 14561         ELSE
 14562             MOVE -1             TO CLIVESL
 14563             MOVE AL-UNBON       TO CLIVESA
 14564             MOVE ER-2223        TO EMI-ERROR
 14565             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14566
 14567     IF CFORCEL  NOT = ZEROS
 14568         IF FORCE-CAP
 14569            MOVE AL-UANON            TO CFORCEA
 14570         ELSE
 14571            MOVE ER-2945             TO EMI-ERROR
 14572            MOVE AL-UABON            TO CFORCEA
 14573            MOVE -1                  TO CFORCEL
 14574            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14575
 14576     IF CPAYEEL GREATER THAN ZEROS
 14577        MOVE AL-UANON            TO CPAYEEA.
 14578
 14579     IF CBILCDL NOT = ZEROS
 14580        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14581                             AND 'A' AND 'B' AND 'E'
 14582           MOVE ER-2225              TO EMI-ERROR
 14583           MOVE AL-UABON             TO CBILCDA
 14584           MOVE -1                   TO CBILCDL
 14585           MOVE  1                   TO SET-CURSOR-SW
 14586           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14587        ELSE
 14588           MOVE AL-UANON             TO CBILCDA.
 14589
 14590 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 265
* EL6311.cbl
 14591     IF EMI-ERROR = ZEROS
 14592         NEXT SENTENCE
 14593     ELSE
 14594         GO TO 8200-SEND-DATAONLY.
 14595
 14596     IF CMAINTI = 'A'
 14597        GO TO 2200-ADD-CANCEL-ROUTINE.
 14598
 14599     IF CMAINTI = 'C'
 14600        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14601
 14602     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14603
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 266
* EL6311.cbl
 14605
 14606******************************************************************
 14607*                                                                *
 14608*                   S H O W   C A N C E L                        *
 14609*                                                                *
 14610******************************************************************
 14611
 14612 2100-SHOW-REQUEST.
 14613     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14614
 14615     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14616        MOVE -1                  TO CMAINTL
 14617        GO TO 8200-SEND-DATAONLY.
 14618
 14619     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14620
 14621     IF CSUFIXL NOT = ZEROS
 14622        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14623       ELSE
 14624        MOVE SPACE            TO WS-NEW-SUFFIX.
 14625
 14626     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14627     PERFORM 8600-DEEDIT.
 14628     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14629     MOVE '4'                    TO DC-OPTION-CODE.
 14630     PERFORM 9700-DATE-LINK.
 14631     IF DATE-CONVERSION-ERROR
 14632        MOVE ER-0348             TO EMI-ERROR
 14633        MOVE -1                  TO CEFFDTL
 14634        MOVE AL-UABON            TO CEFFDTA
 14635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14636        GO TO 8200-SEND-DATAONLY
 14637     ELSE
 14638        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14639        MOVE AL-UANON            TO CEFFDTA
 14640        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14641
 14642     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14643
 14644     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14645        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14646        MOVE 'Y'                    TO WS-SHOW-SW
 14647        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14648           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14649        ELSE
 14650           IF PI-FILE-BROWSE
 14651              GO TO 4300-BROWSE-FILE-FORWARD
 14652           ELSE
 14653              IF PI-CSR-BROWSE
 14654                 GO TO 4200-BROWSE-CSR-FORWARD
 14655              ELSE
 14656                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14657     ELSE
 14658        GO TO 3900-RE-DISPLAY-RECORD.
 14659
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 267
* EL6311.cbl
 14661
 14662
 14663******************************************************************
 14664*                                                                *
 14665*            A D D   C A N C E L   R O U T I N E                 *
 14666*                                                                *
 14667******************************************************************
 14668
 14669 2200-ADD-CANCEL-ROUTINE.
 14670     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14671
 14672
 14673* EXEC CICS GETMAIN
 14674*        SET     (ADDRESS OF PENDING-BUSINESS)
 14675*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14676*    END-EXEC.
 14677*    MOVE '," L                  $   #00013226' TO DFHEIV0
 14678     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14679     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14680     MOVE X'2020233030303133323236' TO DFHEIV0(25:11)
 14681     CALL 'kxdfhei1' USING DFHEIV0,
 14682           DFHEIV20,
 14683           ERPNDB-RECORD-LENGTH,
 14684           DFHEIV99
 14685     SET ADDRESS OF PENDING-BUSINESS TO
 14686         DFHEIV20
 14687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14688
 14689
 14690
 14691* EXEC CICS HANDLE CONDITION
 14692*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14693*    END-EXEC.
 14694*    MOVE '"$I                   ! 3 #00013231' TO DFHEIV0
 14695     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14697     MOVE X'3320233030303133323331' TO DFHEIV0(25:11)
 14698     CALL 'kxdfhei1' USING DFHEIV0
 14699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14700
 14701
 14702     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14703     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14704     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14705
 14706
 14707* EXEC CICS READ
 14708*        INTO    (PENDING-BUSINESS)
 14709*        DATASET (FILE-ID-ERPNDB)
 14710*        RIDFLD  (ERPNDB-KEY)
 14711*    END-EXEC.
 14712     MOVE LENGTH OF
 14713      PENDING-BUSINESS
 14714       TO DFHEIV11
 14715*    MOVE '&"IL       E          (   #00013239' TO DFHEIV0
 14716     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14717     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14718     MOVE X'2020233030303133323339' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 268
* EL6311.cbl
 14719     CALL 'kxdfhei1' USING DFHEIV0,
 14720           FILE-ID-ERPNDB,
 14721           PENDING-BUSINESS,
 14722           DFHEIV11,
 14723           ERPNDB-KEY,
 14724           DFHEIV99,
 14725           DFHEIV99,
 14726           DFHEIV99
 14727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14728
 14729
 14730     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14731
 14732     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14733     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14734     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14735     MOVE SPACES                 TO PENDING-BUSINESS.
 14736     MOVE 'PB'                   TO PB-RECORD-ID.
 14737     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14738     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14739     MOVE SPACES                 TO PB-CERT-SFX.
 14740     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14741     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14742                                    PB-ALT-CHG-SEQ-NO.
 14743
 14744     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14745     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14746     MOVE '2'                    TO PB-RECORD-TYPE.
 14747
 14748     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14749     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14750
 14751
 14752     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14753                                    PB-ALT-CHG-SEQ-NO
 14754                                    PB-C-LF-REF-CALC
 14755                                    PB-C-AH-REF-CALC
 14756                                    PB-C-LF-RFND-CLP
 14757                                    PB-C-AH-RFND-CLP
 14758                                    PB-CI-INSURED-AGE
 14759                                    PB-CI-LF-TERM
 14760                                    PB-CI-AH-TERM
 14761                                    PB-CI-LF-BENEFIT-CD
 14762                                    PB-CI-LF-BENEFIT-AMT
 14763                                    PB-CI-LF-ALT-BENEFIT-AMT
 14764                                    PB-CI-LF-PREMIUM-AMT
 14765                                    PB-CI-LF-ALT-PREMIUM-AMT
 14766                                    PB-CI-AH-BENEFIT-CD
 14767                                    PB-CI-AH-BENEFIT-AMT
 14768                                    PB-CI-AH-PREMIUM-AMT
 14769                                    PB-CI-PAY-FREQUENCY
 14770                                    PB-CI-LOAN-APR
 14771                                    PB-CI-LOAN-TERM
 14772                                    PB-CI-LIFE-COMMISSION
 14773                                    PB-CI-AH-COMMISSION
 14774                                    PB-CI-CURR-SEQ
 14775                                    PB-CI-AH-CANCEL-AMT
 14776                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 269
* EL6311.cbl
 14777                                    PB-CI-RATE-DEV-PCT-LF
 14778                                    PB-CI-RATE-DEV-PCT-AH
 14779                                    PB-CI-EXTENTION-DAYS
 14780                                    PB-CI-TERM-IN-DAYS
 14781                                    PB-CI-LIVES
 14782                                    PB-CI-LF-CRIT-PER
 14783                                    PB-CI-AH-CRIT-PER
 14784                                    PB-C-LF-REM-TERM
 14785                                    PB-C-AH-REM-TERM
 14786                                    PB-CHG-COUNT
 14787                                    PB-LF-BILLED-AMTS
 14788                                    PB-AH-BILLED-AMTS
 14789                                    PB-C-NH-INT-ON-REFS
 14790*                                   PB-C-MICROFILM-NO
 14791                                    PB-CALC-TOLERANCE.
 14792
 14793     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14794                                    PB-CI-AH-SETTLEMENT-DT
 14795                                    PB-CI-DEATH-DT
 14796                                    PB-CI-LF-PRIOR-CANCEL-DT
 14797                                    PB-CI-AH-PRIOR-CANCEL-DT
 14798                                    PB-CI-ENTRY-DT
 14799                                    PB-CI-LF-EXPIRE-DT
 14800                                    PB-CI-AH-EXPIRE-DT
 14801                                    PB-CI-LOAN-1ST-PMT-DT
 14802                                    PB-C-LF-CANCEL-DT
 14803                                    PB-C-AH-CANCEL-DT
 14804                                    PB-CREDIT-ACCEPT-DT
 14805                                    PB-BILLED-DT
 14806                                    PB-ACCT-EFF-DT
 14807                                    PB-ACCT-EXP-DT.
 14808
 14809     MOVE 'X'                    TO PB-FATAL-FLAG.
 14810
 14811     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14812
 14813     IF CSUFIXL     GREATER THAN ZEROS
 14814        MOVE CSUFIXI             TO PB-CERT-SFX.
 14815
 14816*    IF CMICRNOL  GREATER  ZEROS
 14817*        IF CMICRNOI  NUMERIC
 14818*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14819*            MOVE AL-UNNON       TO  CMICRNOA
 14820*        ELSE
 14821*            MOVE -1             TO  CMICRNOL
 14822*            MOVE AL-UNBON       TO  CMICRNOA
 14823*            MOVE ER-2701        TO  EMI-ERROR
 14824*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14825
 14826     IF CLSTNML     GREATER THAN ZEROS
 14827        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14828
 14829     IF CCANREAL > ZEROS
 14830        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14831     END-IF
 14832     IF CPCYNL > ZEROS
 14833        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14834     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 270
* EL6311.cbl
 14835     IF CCANDT1L    GREATER THAN ZEROS
 14836        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14837
 14838     IF CCANDT2L    GREATER THAN ZEROS
 14839        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14840
 14841     IF CMTHD1L    GREATER THAN +0
 14842        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14843
 14844     IF CMTHD2L    GREATER THAN +0
 14845        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14846
 14847     IF CREFND1L    GREATER THAN ZEROS
 14848        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14849        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14850     ELSE
 14851        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14852
 14853     IF CREFND2L    GREATER THAN ZEROS
 14854        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14855        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14856     ELSE
 14857        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14858
 14859     IF CLIVESL     GREATER THAN ZEROS
 14860        MOVE WS-CLIVES           TO PB-C-LIVES
 14861     ELSE
 14862        MOVE ZEROS               TO PB-C-LIVES.
 14863
 14864     IF CPAYEEL     GREATER THAN ZEROS
 14865        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14866
 14867     IF CFORCEL     GREATER THAN ZEROS
 14868        MOVE CFORCEI             TO PB-FORCE-CODE.
 14869
 14870     IF CBILCDL     GREATER THAN ZEROS
 14871        MOVE CBILCDI             TO PB-RECORD-BILL.
 14872
 14873*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14874
 14875 2260-WRITE-PB-RECORD.
 14876     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14877                                    PB-INPUT-BY.
 14878     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14879     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14880                                    PB-INPUT-DT.
 14881
 14882     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14883     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14884                                    PB-CONTROL-BY-ORIG-BATCH.
 14885
 14886     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14887     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14888     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14889     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14890     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14891
 14892     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 271
* EL6311.cbl
 14893
 14894     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14895
 14896     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14897     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14898     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14899
 14900     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14901     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14902
 14903 2275-WRITE-PENDING-BUSINESS.
 14904     MOVE 'A'                    TO JP-RECORD-TYPE.
 14905     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14906     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14907     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14908
 14909
 14910* EXEC CICS HANDLE CONDITION
 14911*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14912*    END-EXEC.
 14913*    MOVE '"$%                   ! 4 #00013424' TO DFHEIV0
 14914     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14915     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14916     MOVE X'3420233030303133343234' TO DFHEIV0(25:11)
 14917     CALL 'kxdfhei1' USING DFHEIV0
 14918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14919
 14920
 14921
 14922* EXEC CICS WRITE
 14923*        DATASET (FILE-ID-ERPNDB)
 14924*        FROM    (PENDING-BUSINESS)
 14925*        RIDFLD  (PB-CONTROL-PRIMARY)
 14926*    END-EXEC.
 14927     MOVE LENGTH OF
 14928      PENDING-BUSINESS
 14929       TO DFHEIV11
 14930*    MOVE '&$ L                  ''   #00013428' TO DFHEIV0
 14931     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14932     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14933     MOVE X'2020233030303133343238' TO DFHEIV0(25:11)
 14934     CALL 'kxdfhei1' USING DFHEIV0,
 14935           FILE-ID-ERPNDB,
 14936           PENDING-BUSINESS,
 14937           DFHEIV11,
 14938           PB-CONTROL-PRIMARY,
 14939           DFHEIV99,
 14940           DFHEIV99
 14941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14942
 14943
 14944     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14945
 14946     PERFORM 8400-LOG-JOURNAL-RECORD.
 14947
 14948******************************************************************
 14949*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14950******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 272
* EL6311.cbl
 14951
 14952     display ' made it to add orig CANCEL cert '
 14953     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14954     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14955     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14956     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14957
 14958
 14959* EXEC CICS READ
 14960*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14961*        DATASET (FILE-ID-ELCERT)
 14962*        RIDFLD  (ELCERT-KEY)
 14963*        RESP    (WS-RESPONSE)
 14964*    END-EXEC.
 14965*    MOVE '&"S        E          (  N#00013448' TO DFHEIV0
 14966     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14967     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14968     MOVE X'204E233030303133343438' TO DFHEIV0(25:11)
 14969     CALL 'kxdfhei1' USING DFHEIV0,
 14970           FILE-ID-ELCERT,
 14971           DFHEIV20,
 14972           DFHEIV99,
 14973           ELCERT-KEY,
 14974           DFHEIV99,
 14975           DFHEIV99,
 14976           DFHEIV99
 14977     SET ADDRESS OF CERTIFICATE-MASTER TO
 14978         DFHEIV20
 14979     MOVE EIBRESP  TO WS-RESPONSE
 14980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14981
 14982
 14983     IF NOT RESP-NORMAL
 14984        GO TO 2276-BYPASS-CRTO
 14985     END-IF
 14986
 14987     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14988     MOVE ' '                    TO WS-ERMAIL-SW
 14989
 14990
 14991* EXEC CICS READ
 14992*       DATASET   (FILE-ID-ERMAIL)
 14993*       SET       (ADDRESS OF MAILING-DATA)
 14994*       RIDFLD    (ERMAIL-KEY)
 14995*       RESP      (WS-RESPONSE)
 14996*    END-EXEC
 14997*    MOVE '&"S        E          (  N#00013462' TO DFHEIV0
 14998     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14999     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15000     MOVE X'204E233030303133343632' TO DFHEIV0(25:11)
 15001     CALL 'kxdfhei1' USING DFHEIV0,
 15002           FILE-ID-ERMAIL,
 15003           DFHEIV20,
 15004           DFHEIV99,
 15005           ERMAIL-KEY,
 15006           DFHEIV99,
 15007           DFHEIV99,
 15008           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 273
* EL6311.cbl
 15009     SET ADDRESS OF MAILING-DATA TO
 15010         DFHEIV20
 15011     MOVE EIBRESP  TO WS-RESPONSE
 15012     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15013
 15014     IF RESP-NORMAL
 15015        SET ERMAIL-FOUND TO TRUE
 15016     END-IF
 15017
 15018     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15019
 15020     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15021     MOVE 'OC'                   TO OC-RECORD-ID
 15022     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15023                                 TO OC-CONTROL-PRIMARY (1:33)
 15024     MOVE 'I'                    TO OC-RECORD-TYPE
 15025     MOVE +4096                  TO OC-KEY-SEQ-NO
 15026     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15027     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15028     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15029
 15030     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15031     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15032     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15033     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15034     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15035     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15036     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15037     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15038     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15039     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15040     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15041     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15042     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15043     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15044     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15045     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15046     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15047     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15048     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15049     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15050     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15051     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15052     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15053     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15054     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15055     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15056     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15057     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15058     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15059     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15060     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15061     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15062
 15063     IF ERMAIL-FOUND
 15064        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15065     END-IF
 15066     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 274
* EL6311.cbl
 15067        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15068                           OC-INS-AGE-DEFAULT-FLAG
 15069        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15070                           OC-JNT-AGE-DEFAULT-FLAG
 15071     END-IF
 15072     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15073     .
 15074 2275-WRITE-ELCRTO.
 15075
 15076
 15077* EXEC CICS WRITE
 15078*       DATASET   ('ELCRTO')
 15079*       FROM      (ORIGINAL-CERTIFICATE)
 15080*       RIDFLD    (OC-CONTROL-PRIMARY)
 15081*       RESP      (WS-RESPONSE)
 15082*    END-EXEC
 15083     MOVE LENGTH OF
 15084      ORIGINAL-CERTIFICATE
 15085       TO DFHEIV11
 15086     MOVE 'ELCRTO' TO DFHEIV1
 15087*    MOVE '&$ L                  ''  N#00013531' TO DFHEIV0
 15088     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15089     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15090     MOVE X'204E233030303133353331' TO DFHEIV0(25:11)
 15091     CALL 'kxdfhei1' USING DFHEIV0,
 15092           DFHEIV1,
 15093           ORIGINAL-CERTIFICATE,
 15094           DFHEIV11,
 15095           OC-CONTROL-PRIMARY,
 15096           DFHEIV99,
 15097           DFHEIV99
 15098     MOVE EIBRESP  TO WS-RESPONSE
 15099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15100
 15101     display ' just wrote 2275 ' ws-response
 15102     IF RESP-DUPKEY
 15103        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15104        GO TO 2275-WRITE-ELCRTO
 15105     ELSE
 15106        IF NOT RESP-NORMAL
 15107           MOVE -1               TO BMAINTL
 15108           MOVE ER-7450          TO EMI-ERROR
 15109           PERFORM 9900-ERROR-FORMAT
 15110                                 THRU 9900-EXIT
 15111           GO TO 8200-SEND-DATAONLY
 15112        END-IF
 15113     END-IF.
 15114
 15115 2276-BYPASS-CRTO.
 15116******************************************************************
 15117*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15118******************************************************************
 15119
 15120
 15121* EXEC CICS READ
 15122*        INTO    (PENDING-BUSINESS)
 15123*        DATASET (FILE-ID-ERPNDB)
 15124*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 275
* EL6311.cbl
 15125*        UPDATE
 15126*    END-EXEC.
 15127     MOVE LENGTH OF
 15128      PENDING-BUSINESS
 15129       TO DFHEIV11
 15130*    MOVE '&"IL       EU         (   #00013557' TO DFHEIV0
 15131     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15132     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15133     MOVE X'2020233030303133353537' TO DFHEIV0(25:11)
 15134     CALL 'kxdfhei1' USING DFHEIV0,
 15135           FILE-ID-ERPNDB,
 15136           PENDING-BUSINESS,
 15137           DFHEIV11,
 15138           ERPNDB-KEY,
 15139           DFHEIV99,
 15140           DFHEIV99,
 15141           DFHEIV99
 15142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15143
 15144
 15145     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15146     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15147     MOVE 'B'                    TO JP-RECORD-TYPE.
 15148     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15149
 15150     PERFORM 8400-LOG-JOURNAL-RECORD.
 15151
 15152     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15153
 15154
 15155* EXEC CICS REWRITE
 15156*        DATASET (FILE-ID-ERPNDB)
 15157*        FROM    (PENDING-BUSINESS)
 15158*    END-EXEC.
 15159     MOVE LENGTH OF
 15160      PENDING-BUSINESS
 15161       TO DFHEIV11
 15162*    MOVE '&& L                  %   #00013573' TO DFHEIV0
 15163     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15164     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15165     MOVE X'2020233030303133353733' TO DFHEIV0(25:11)
 15166     CALL 'kxdfhei1' USING DFHEIV0,
 15167           FILE-ID-ERPNDB,
 15168           PENDING-BUSINESS,
 15169           DFHEIV11,
 15170           DFHEIV99
 15171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15172
 15173
 15174     MOVE 'C'                    TO JP-RECORD-TYPE.
 15175     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15176
 15177     PERFORM 8400-LOG-JOURNAL-RECORD.
 15178
 15179     IF WS-ERRORS-PRESENT
 15180        GO TO 3900-RE-DISPLAY-RECORD.
 15181
 15182     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 276
* EL6311.cbl
 15183     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15184     MOVE LOW-VALUES             TO EL631CI.
 15185     MOVE  -1                    TO CMAINTL.
 15186     GO TO 8100-SEND-INITIAL-MAP.
 15187
 15188 2280-BATCH-HDR-NOT-FOUND.
 15189     MOVE -1                     TO BMAINTL.
 15190     MOVE ER-7450                TO EMI-ERROR.
 15191     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15192     GO TO 8200-SEND-DATAONLY.
 15193
 15194 2290-DUPLICATE-ALT-INDEX.
 15195
 15196******************************************************************
 15197*                                                                *
 15198*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15199*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15200*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15201*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15202*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15203*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15204*                                                                *
 15205******************************************************************
 15206
 15207     IF LCP-ONCTR-02 =  0
 15208         ADD 1 TO LCP-ONCTR-02
 15209        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15210
 15211     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15212
 15213     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15214         NEXT SENTENCE
 15215     ELSE
 15216         ADD +1 TO PB-BATCH-SEQ-NO
 15217                   PB-CSR-BATCH-SEQ-NO
 15218         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15219         GO TO 2275-WRITE-PENDING-BUSINESS.
 15220
 15221     MOVE -1                     TO CCERTNOL.
 15222     MOVE AL-UABON               TO CCERTNOA.
 15223     MOVE AL-UNBON               TO CEFFDTA.
 15224
 15225     MOVE 1                      TO EMI-SUB
 15226                                    EMI-SWITCH1
 15227                                    EMI-SWITCH-AREA-1
 15228                                    EMI-SWITCH-AREA-2.
 15229
 15230     MOVE SPACES                 TO EMI-ERROR-LINES.
 15231
 15232
 15233* EXEC CICS SYNCPOINT ROLLBACK
 15234*    END-EXEC.
 15235*    MOVE '6"R                   !   #00013636' TO DFHEIV0
 15236     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15238     MOVE X'2020233030303133363336' TO DFHEIV0(25:11)
 15239     CALL 'kxdfhei1' USING DFHEIV0
 15240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 277
* EL6311.cbl
 15241
 15242
 15243     MOVE ER-2247                TO EMI-ERROR.
 15244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15245     GO TO 8200-SEND-DATAONLY.
 15246
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 278
* EL6311.cbl
 15248
 15249******************************************************************
 15250*                                                                *
 15251*          C H A N G E   C A N C E L   R O U T I N E             *
 15252*                                                                *
 15253******************************************************************
 15254
 15255***************************************************************
 15256*                                                             *
 15257*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15258*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15259*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15260*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15261*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15262*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15263*     5. LINK TO THE EDIT ROUTINE.                            *
 15264*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15265*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15266*              THE EDIT ROUTINE.                              *
 15267*     7. REWRITE THE NEW ISSUE                                *
 15268*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15269*                                                             *
 15270***************************************************************
 15271 2300-CHANGE-CANCEL-ROUTINE.
 15272     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15273
 15274     IF CCHGL NOT = ZEROS
 15275        MOVE ER-2196             TO EMI-ERROR
 15276        MOVE AL-UABON            TO CMAINTA
 15277        MOVE -1                  TO CMAINTL
 15278        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15279        GO TO 8200-SEND-DATAONLY.
 15280
 15281     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15282
 15283     IF CSUFIXL NOT = ZEROS
 15284        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15285     ELSE
 15286        MOVE SPACE               TO WS-NEW-SUFFIX.
 15287
 15288     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15289     PERFORM 8600-DEEDIT.
 15290     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15291     MOVE '4'                    TO DC-OPTION-CODE.
 15292
 15293     PERFORM 9700-DATE-LINK.
 15294
 15295     IF DATE-CONVERSION-ERROR
 15296        MOVE ER-0348             TO EMI-ERROR
 15297        MOVE -1                  TO CEFFDTL
 15298        MOVE AL-UABON            TO CEFFDTA
 15299        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15300        GO TO 8200-SEND-DATAONLY
 15301     ELSE
 15302        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15303        MOVE AL-UANON            TO CEFFDTA
 15304        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15305
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 279
* EL6311.cbl
 15306 2325-PROCESS-CANCEL-CHANGES.
 15307
 15308* EXEC CICS HANDLE CONDITION
 15309*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15310*    END-EXEC.
 15311*    MOVE '"$I                   ! 5 #00013703' TO DFHEIV0
 15312     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15314     MOVE X'3520233030303133373033' TO DFHEIV0(25:11)
 15315     CALL 'kxdfhei1' USING DFHEIV0
 15316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15317
 15318
 15319     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15320     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15321     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15322
 15323
 15324* EXEC CICS GETMAIN
 15325*        SET      (ADDRESS OF PENDING-BUSINESS)
 15326*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15327*        INITIMG  (GETMAIN-SPACE)
 15328*     END-EXEC.
 15329*    MOVE ',"IL                  $   #00013711' TO DFHEIV0
 15330     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15331     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15332     MOVE X'2020233030303133373131' TO DFHEIV0(25:11)
 15333     CALL 'kxdfhei1' USING DFHEIV0,
 15334           DFHEIV20,
 15335           ERPNDB-RECORD-LENGTH,
 15336           GETMAIN-SPACE
 15337     SET ADDRESS OF PENDING-BUSINESS TO
 15338         DFHEIV20
 15339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15340
 15341
 15342
 15343* EXEC CICS READ
 15344*        INTO    (PENDING-BUSINESS)
 15345*        DATASET (FILE-ID-ERPNDB)
 15346*        RIDFLD  (ERPNDB-KEY)
 15347*    END-EXEC.
 15348     MOVE LENGTH OF
 15349      PENDING-BUSINESS
 15350       TO DFHEIV11
 15351*    MOVE '&"IL       E          (   #00013717' TO DFHEIV0
 15352     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15353     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15354     MOVE X'2020233030303133373137' TO DFHEIV0(25:11)
 15355     CALL 'kxdfhei1' USING DFHEIV0,
 15356           FILE-ID-ERPNDB,
 15357           PENDING-BUSINESS,
 15358           DFHEIV11,
 15359           ERPNDB-KEY,
 15360           DFHEIV99,
 15361           DFHEIV99,
 15362           DFHEIV99
 15363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 280
* EL6311.cbl
 15364
 15365
 15366     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15367
 15368
 15369* EXEC CICS HANDLE CONDITION
 15370*         NOTFND     (2385-REC-NOT-FOUND)
 15371*    END-EXEC.
 15372*    MOVE '"$I                   ! 6 #00013725' TO DFHEIV0
 15373     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15375     MOVE X'3620233030303133373235' TO DFHEIV0(25:11)
 15376     CALL 'kxdfhei1' USING DFHEIV0
 15377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15378
 15379
 15380**********************************************************
 15381*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15382*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15383**********************************************************
 15384
 15385
 15386* EXEC CICS READ
 15387*        DATASET (FILE-ID-ERPNDB)
 15388*        INTO    (PENDING-BUSINESS)
 15389*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15390*    END-EXEC.
 15391     MOVE LENGTH OF
 15392      PENDING-BUSINESS
 15393       TO DFHEIV11
 15394*    MOVE '&"IL       E          (   #00013734' TO DFHEIV0
 15395     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15396     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15397     MOVE X'2020233030303133373334' TO DFHEIV0(25:11)
 15398     CALL 'kxdfhei1' USING DFHEIV0,
 15399           FILE-ID-ERPNDB,
 15400           PENDING-BUSINESS,
 15401           DFHEIV11,
 15402           PI-PREV-CONTROL-PRIMARY,
 15403           DFHEIV99,
 15404           DFHEIV99,
 15405           DFHEIV99
 15406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15407
 15408
 15409********** DO NOT ALLOW CHANGES IF THRU A/R
 15410     IF BMAINTI = 'C'
 15411         IF PB-EL860-INTERNAL-PROCESS
 15412             MOVE ER-4005          TO EMI-ERROR
 15413             MOVE -1               TO BMAINTL
 15414             MOVE AL-UABON         TO BMAINTA
 15415             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15416             GO TO 8200-SEND-DATAONLY.
 15417**********
 15418
 15419     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15420        MOVE -1                 TO CMAINTL
 15421        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 281
* EL6311.cbl
 15422        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15423        GO TO 8200-SEND-DATAONLY.
 15424
 15425     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15426        MOVE ER-2196             TO EMI-ERROR
 15427        MOVE AL-UABON            TO CMAINTA
 15428        MOVE -1                  TO CMAINTL
 15429        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15430        GO TO 8200-SEND-DATAONLY.
 15431     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15432
 15433     IF PB-BILLED-DT = LOW-VALUES AND
 15434        PB-CHG-COUNT = ZEROS
 15435        NEXT SENTENCE
 15436     ELSE
 15437        IF (CREFND1L GREATER THAN ZEROS AND
 15438            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15439           OR
 15440           (CREFND2L GREATER THAN ZEROS AND
 15441            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15442           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15443     if ((crefnd1l <> zeros)
 15444        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15445                      or
 15446        ((crefnd2l <> zeros)
 15447        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15448        continue
 15449     else
 15450        go to 2330-continue-change
 15451     end-if
 15452
 15453     move zeros                  to ws-check-amts
 15454     move ' '                    to ws-stop-sw
 15455                                    ws-check-sw
 15456                                    ws-proc-check-sw
 15457                                    ws-chek-browse-sw
 15458
 15459     perform 2500-browse-checks  thru 2500-exit
 15460
 15461     if i-have-processed-checks
 15462        or i-have-checks
 15463        continue
 15464     else
 15465        go to 2330-continue-change
 15466     end-if
 15467
 15468     if crefnd1l <> zeros
 15469        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15470        move ws-crefnd1 to ws-new-ref-total
 15471     else
 15472        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15473     end-if
 15474     if crefnd2l <> zeros
 15475        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15476        compute ws-new-ref-total = ws-new-ref-total +
 15477           ws-crefnd2
 15478     else
 15479        compute ws-new-ref-total = ws-new-ref-total +
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 282
* EL6311.cbl
 15480           pb-c-ah-cancel-amt
 15481     end-if
 15482
 15483     if zeros = (ws-lf-diff + ws-ah-diff)
 15484        move er-3449             to emi-error
 15485        perform 9900-error-format thru 9900-exit
 15486        go to 2330-continue-change
 15487     end-if
 15488
 15489     if (ws-new-ref-total < ws-check-amts)
 15490        and (pb-c-refund-sw = 'Y')
 15491        move er-3447             to emi-error
 15492        perform 9900-error-format thru 9900-exit
 15493        move al-uabon            to cmainta
 15494        move -1                  to cmaintl
 15495        go to 8200-send-dataonly
 15496     end-if
 15497
 15498     if (ws-new-ref-total > ws-check-amts)
 15499        and (ws-check-amts not = zeros)
 15500        move er-3448             to emi-error
 15501        move al-uabon            to crefnd1a
 15502                                    crefnd2a
 15503        perform 9900-error-format thru 9900-exit
 15504     end-if
 15505
 15506*     if (ws-lf-diff + ws-ah-diff) < zeros
 15507*        move er-3447             to emi-error
 15508*        perform 9900-error-format thru 9900-exit
 15509*        move al-uabon            to cmainta
 15510*        move -1                  to cmaintl
 15511*        go to 8200-send-dataonly
 15512*     end-if
 15513     .
 15514 2330-continue-change.
 15515
 15516
 15517* EXEC CICS READ
 15518*        DATASET (FILE-ID-ERPNDB)
 15519*        INTO    (PENDING-BUSINESS)
 15520*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15521*        UPDATE
 15522*    END-EXEC.
 15523     MOVE LENGTH OF
 15524      PENDING-BUSINESS
 15525       TO DFHEIV11
 15526*    MOVE '&"IL       EU         (   #00013847' TO DFHEIV0
 15527     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15528     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15529     MOVE X'2020233030303133383437' TO DFHEIV0(25:11)
 15530     CALL 'kxdfhei1' USING DFHEIV0,
 15531           FILE-ID-ERPNDB,
 15532           PENDING-BUSINESS,
 15533           DFHEIV11,
 15534           PI-PREV-CONTROL-PRIMARY,
 15535           DFHEIV99,
 15536           DFHEIV99,
 15537           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 283
* EL6311.cbl
 15538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15539
 15540
 15541     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15542     MOVE 'B'                    TO JP-RECORD-TYPE
 15543     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15544     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15545
 15546     PERFORM 8400-LOG-JOURNAL-RECORD.
 15547
 15548     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15549          PB-CHG-COUNT NOT = ZEROS
 15550        IF (CREFND1L GREATER THAN ZEROS AND
 15551            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15552           OR
 15553           (CREFND2L GREATER THAN ZEROS AND
 15554            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15555            ADD +1                      TO PB-CHG-COUNT
 15556            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15557
 15558*    IF CMICRNOL  GREATER  ZEROS
 15559*        IF CMICRNOI  NUMERIC
 15560*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15561*            MOVE AL-UNNON       TO  CMICRNOA
 15562*        ELSE
 15563*            MOVE -1             TO  CMICRNOL
 15564*            MOVE AL-UNBON       TO  CMICRNOA
 15565*            MOVE ER-2701        TO  EMI-ERROR
 15566*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15567
 15568     IF CSUFIXL GREATER THAN ZEROS
 15569        MOVE CSUFIXI             TO PB-CERT-SFX.
 15570
 15571     IF CLSTNML GREATER THAN ZEROS
 15572         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15573
 15574     IF CCANREAL > ZEROS
 15575        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15576     END-IF
 15577     IF CPCYNL > ZEROS
 15578        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15579     END-IF
 15580     IF CCANDT1L    GREATER THAN ZEROS
 15581        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15582
 15583     IF CCANDT2L    GREATER THAN ZEROS
 15584        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15585
 15586     IF CMTHD1L    GREATER THAN +0
 15587        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15588
 15589     IF CMTHD2L    GREATER THAN +0
 15590        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15591
 15592     IF CREFND1L    GREATER THAN ZEROS
 15593        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15594        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15595        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 284
* EL6311.cbl
 15596        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15597
 15598     IF CREFND2L    GREATER THAN ZEROS
 15599        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15600        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15601        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15602        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15603
 15604     IF CLIVESL     GREATER THAN ZEROS
 15605        MOVE WS-CLIVES           TO PB-C-LIVES.
 15606
 15607     IF CPAYEEL     GREATER THAN ZEROS
 15608        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15609
 15610     IF CFORCEL     GREATER THAN ZEROS
 15611        MOVE CFORCEI             TO PB-FORCE-CODE.
 15612
 15613     IF CBILCDL     GREATER THAN ZEROS
 15614        MOVE CBILCDI             TO PB-RECORD-BILL.
 15615
 15616 2360-REWRITE-PB-RECORD.
 15617     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15618     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15619     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15620     MOVE 'C'                    TO JP-RECORD-TYPE.
 15621     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15622     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15623     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15624
 15625     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15626
 15627     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15628     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15629
 15630     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15631
 15632     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15633
 15634     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15635     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15636     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15637
 15638     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15639     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15640
 15641 2375-REWRITE-PENDING-BUSINESS.
 15642     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15643     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15644     MOVE 'C'                    TO JP-RECORD-TYPE.
 15645     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15646
 15647
 15648* EXEC CICS REWRITE
 15649*        DATASET (FILE-ID-ERPNDB)
 15650*        FROM    (PENDING-BUSINESS)
 15651*    END-EXEC.
 15652     MOVE LENGTH OF
 15653      PENDING-BUSINESS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 285
* EL6311.cbl
 15654       TO DFHEIV11
 15655*    MOVE '&& L                  %   #00013960' TO DFHEIV0
 15656     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15657     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15658     MOVE X'2020233030303133393630' TO DFHEIV0(25:11)
 15659     CALL 'kxdfhei1' USING DFHEIV0,
 15660           FILE-ID-ERPNDB,
 15661           PENDING-BUSINESS,
 15662           DFHEIV11,
 15663           DFHEIV99
 15664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15665
 15666
 15667     PERFORM 8400-LOG-JOURNAL-RECORD.
 15668
 15669******************************************************************
 15670*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15671******************************************************************
 15672
 15673     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15674     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15675     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15676     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15677
 15678
 15679* EXEC CICS READ
 15680*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15681*        DATASET (FILE-ID-ELCERT)
 15682*        RIDFLD  (ELCERT-KEY)
 15683*        RESP    (WS-RESPONSE)
 15684*    END-EXEC.
 15685*    MOVE '&"S        E          (  N#00013976' TO DFHEIV0
 15686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15688     MOVE X'204E233030303133393736' TO DFHEIV0(25:11)
 15689     CALL 'kxdfhei1' USING DFHEIV0,
 15690           FILE-ID-ELCERT,
 15691           DFHEIV20,
 15692           DFHEIV99,
 15693           ELCERT-KEY,
 15694           DFHEIV99,
 15695           DFHEIV99,
 15696           DFHEIV99
 15697     SET ADDRESS OF CERTIFICATE-MASTER TO
 15698         DFHEIV20
 15699     MOVE EIBRESP  TO WS-RESPONSE
 15700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15701
 15702
 15703     IF NOT RESP-NORMAL
 15704        GO TO 2376-BYPASS-CRTO
 15705     END-IF
 15706
 15707
 15708     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15709     MOVE ' '                    TO WS-ERMAIL-SW
 15710
 15711
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 286
* EL6311.cbl
 15712* EXEC CICS READ
 15713*       DATASET   (FILE-ID-ERMAIL)
 15714*       SET       (ADDRESS OF MAILING-DATA)
 15715*       RIDFLD    (ERMAIL-KEY)
 15716*       RESP      (WS-RESPONSE)
 15717*    END-EXEC
 15718*    MOVE '&"S        E          (  N#00013991' TO DFHEIV0
 15719     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15720     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15721     MOVE X'204E233030303133393931' TO DFHEIV0(25:11)
 15722     CALL 'kxdfhei1' USING DFHEIV0,
 15723           FILE-ID-ERMAIL,
 15724           DFHEIV20,
 15725           DFHEIV99,
 15726           ERMAIL-KEY,
 15727           DFHEIV99,
 15728           DFHEIV99,
 15729           DFHEIV99
 15730     SET ADDRESS OF MAILING-DATA TO
 15731         DFHEIV20
 15732     MOVE EIBRESP  TO WS-RESPONSE
 15733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15734
 15735     IF RESP-NORMAL
 15736        SET ERMAIL-FOUND TO TRUE
 15737     END-IF
 15738
 15739     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15740
 15741     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15742                                 TO ELCRTO-KEY
 15743     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15744     MOVE +0                     TO ELCRTO-SEQ-NO
 15745
 15746
 15747* EXEC CICS READ
 15748*       DATASET   ('ELCRTO')
 15749*       INTO      (ORIGINAL-CERTIFICATE)
 15750*       RIDFLD    (ELCRTO-KEY)
 15751*       GTEQ
 15752*       RESP      (WS-RESPONSE)
 15753*    END-EXEC
 15754     MOVE LENGTH OF
 15755      ORIGINAL-CERTIFICATE
 15756       TO DFHEIV11
 15757     MOVE 'ELCRTO' TO DFHEIV1
 15758*    MOVE '&"IL       G          (  N#00014009' TO DFHEIV0
 15759     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15760     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15761     MOVE X'204E233030303134303039' TO DFHEIV0(25:11)
 15762     CALL 'kxdfhei1' USING DFHEIV0,
 15763           DFHEIV1,
 15764           ORIGINAL-CERTIFICATE,
 15765           DFHEIV11,
 15766           ELCRTO-KEY,
 15767           DFHEIV99,
 15768           DFHEIV99,
 15769           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 287
* EL6311.cbl
 15770     MOVE EIBRESP  TO WS-RESPONSE
 15771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15772
 15773     IF RESP-NORMAL
 15774        AND (OC-CONTROL-PRIMARY (1:33) =
 15775                 PB-CONTROL-BY-ACCOUNT (1:33))
 15776        AND (OC-RECORD-TYPE = 'I')
 15777        display ' resp norm, key =, type i '
 15778        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15779           display ' end proc blank '
 15780           display ' csr edit session ' PI-CSR-SESSION-SW
 15781           IF NOT CSR-EDIT-SESSION
 15782
 15783* EXEC CICS READ
 15784*                DATASET   ('ELCRTO')
 15785*                INTO      (ORIGINAL-CERTIFICATE)
 15786*                RIDFLD    (OC-CONTROL-PRIMARY)
 15787*                UPDATE
 15788*                RESP      (WS-RESPONSE)
 15789*             END-EXEC
 15790     MOVE LENGTH OF
 15791      ORIGINAL-CERTIFICATE
 15792       TO DFHEIV11
 15793     MOVE 'ELCRTO' TO DFHEIV1
 15794*    MOVE '&"IL       EU         (  N#00014026' TO DFHEIV0
 15795     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15796     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15797     MOVE X'204E233030303134303236' TO DFHEIV0(25:11)
 15798     CALL 'kxdfhei1' USING DFHEIV0,
 15799           DFHEIV1,
 15800           ORIGINAL-CERTIFICATE,
 15801           DFHEIV11,
 15802           OC-CONTROL-PRIMARY,
 15803           DFHEIV99,
 15804           DFHEIV99,
 15805           DFHEIV99
 15806     MOVE EIBRESP  TO WS-RESPONSE
 15807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15808              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15809              IF RESP-NORMAL
 15810                 display ' good read upd '
 15811                 IF OC-ISSUE-TRAN-IND = 'N'
 15812                    MOVE CM-INSURED-LAST-NAME   TO
 15813                         OC-INS-LAST-NAME
 15814                    MOVE CM-INSURED-FIRST-NAME  TO
 15815                         OC-INS-FIRST-NAME
 15816                    MOVE CM-INSURED-INITIAL2    TO
 15817                         OC-INS-MIDDLE-INIT
 15818                    MOVE CM-INSURED-ISSUE-AGE   TO
 15819                         OC-INS-AGE
 15820                    MOVE CM-JT-LAST-NAME        TO
 15821                         OC-JNT-LAST-NAME
 15822                    MOVE CM-JT-FIRST-NAME       TO
 15823                         OC-JNT-FIRST-NAME
 15824                    MOVE CM-JT-INITIAL          TO
 15825                         OC-JNT-MIDDLE-INIT
 15826                    MOVE CM-INSURED-JOINT-AGE   TO
 15827                         OC-JNT-AGE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 288
* EL6311.cbl
 15828                    MOVE CM-LF-BENEFIT-CD       TO
 15829                         OC-LF-BENCD
 15830                    MOVE CM-LF-ORIG-TERM        TO
 15831                         OC-LF-TERM
 15832                    MOVE CM-LF-BENEFIT-AMT      TO
 15833                         OC-LF-BEN-AMT
 15834                    MOVE CM-LF-PREMIUM-AMT      TO
 15835                         OC-LF-PRM-AMT
 15836                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15837                         OC-LF-ALT-BEN-AMT
 15838                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15839                         OC-LF-ALT-PRM-AMT
 15840                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15841                         OC-LF-EXP-DT
 15842                    MOVE CM-LIFE-COMM-PCT       TO
 15843                         OC-LF-COMM-PCT
 15844                    MOVE CM-AH-BENEFIT-CD       TO
 15845                         OC-AH-BENCD
 15846                    MOVE CM-AH-ORIG-TERM        TO
 15847                         OC-AH-TERM
 15848                    MOVE CM-AH-BENEFIT-AMT      TO
 15849                         OC-AH-BEN-AMT
 15850                    MOVE CM-AH-PREMIUM-AMT      TO
 15851                         OC-AH-PRM-AMT
 15852                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15853                         OC-AH-EXP-DT
 15854                    MOVE CM-AH-COMM-PCT         TO
 15855                         OC-AH-COMM-PCT
 15856                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15857                         OC-AH-CP
 15858                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15859                         OC-1ST-PMT-DT
 15860                 END-IF
 15861                 MOVE PB-C-LF-CANCEL-DT      TO
 15862                         OC-LF-CANCEL-DT
 15863                 MOVE PB-C-LF-CANCEL-AMT     TO
 15864                         OC-LF-CANCEL-AMT
 15865                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15866                         OC-LF-ITD-CANCEL-AMT
 15867                 MOVE PB-C-AH-CANCEL-DT      TO
 15868                         OC-AH-CANCEL-DT
 15869                 MOVE PB-C-AH-CANCEL-AMT     TO
 15870                         OC-AH-CANCEL-AMT
 15871                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15872                         OC-AH-ITD-CANCEL-AMT
 15873                 MOVE 'Y'                    TO
 15874                         OC-CANCEL-TRAN-IND
 15875                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15876                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15877                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15878                 IF ERMAIL-FOUND
 15879                    MOVE MA-CRED-BENE-NAME
 15880                                 TO OC-CRED-BENE-NAME
 15881                 END-IF
 15882                 IF NOT CERT-TRL-REC-NOT-FOUND
 15883                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15884                           OC-INS-AGE-DEFAULT-FLAG
 15885                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 289
* EL6311.cbl
 15886                           OC-JNT-AGE-DEFAULT-FLAG
 15887                 END-IF
 15888
 15889* EXEC CICS REWRITE
 15890*                   DATASET   ('ELCRTO')
 15891*                   FROM      (ORIGINAL-CERTIFICATE)
 15892*                   RESP      (WS-RESPONSE)
 15893*                END-EXEC
 15894     MOVE LENGTH OF
 15895      ORIGINAL-CERTIFICATE
 15896       TO DFHEIV11
 15897     MOVE 'ELCRTO' TO DFHEIV1
 15898*    MOVE '&& L                  %  N#00014113' TO DFHEIV0
 15899     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15900     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15901     MOVE X'204E233030303134313133' TO DFHEIV0(25:11)
 15902     CALL 'kxdfhei1' USING DFHEIV0,
 15903           DFHEIV1,
 15904           ORIGINAL-CERTIFICATE,
 15905           DFHEIV11,
 15906           DFHEIV99
 15907     MOVE EIBRESP  TO WS-RESPONSE
 15908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15909                 display ' just rewrote ' ws-response
 15910              END-IF
 15911           END-IF
 15912        ELSE
 15913           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15914           MOVE 'OC'             TO OC-RECORD-ID
 15915           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15916           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15917           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15918           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15919           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15920           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15921           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15922           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15923           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15924           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15925           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15926           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15927           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15928           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15929           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15930           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15931           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15932           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15933           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15934           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15935           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15936           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15937           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15938           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15939           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15940           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15941           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15942           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15943           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 290
* EL6311.cbl
 15944           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15945           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15946           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15947           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15948           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15949           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15950           IF ERMAIL-FOUND
 15951              MOVE MA-CRED-BENE-NAME
 15952                                 TO OC-CRED-BENE-NAME
 15953           END-IF
 15954           IF NOT CERT-TRL-REC-NOT-FOUND
 15955              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15956                           OC-INS-AGE-DEFAULT-FLAG
 15957              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15958                           OC-JNT-AGE-DEFAULT-FLAG
 15959           END-IF
 15960           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15961
 15962* EXEC CICS WRITE
 15963*             DATASET   ('ELCRTO')
 15964*             FROM      (ORIGINAL-CERTIFICATE)
 15965*             RIDFLD    (OC-CONTROL-PRIMARY)
 15966*             RESP      (WS-RESPONSE)
 15967*          END-EXEC
 15968     MOVE LENGTH OF
 15969      ORIGINAL-CERTIFICATE
 15970       TO DFHEIV11
 15971     MOVE 'ELCRTO' TO DFHEIV1
 15972*    MOVE '&$ L                  ''  N#00014170' TO DFHEIV0
 15973     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15974     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15975     MOVE X'204E233030303134313730' TO DFHEIV0(25:11)
 15976     CALL 'kxdfhei1' USING DFHEIV0,
 15977           DFHEIV1,
 15978           ORIGINAL-CERTIFICATE,
 15979           DFHEIV11,
 15980           OC-CONTROL-PRIMARY,
 15981           DFHEIV99,
 15982           DFHEIV99
 15983     MOVE EIBRESP  TO WS-RESPONSE
 15984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15985        END-IF
 15986     ELSE
 15987        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15988        MOVE 'OC'                TO OC-RECORD-ID
 15989        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15990                                 TO OC-CONTROL-PRIMARY (1:33)
 15991        MOVE 'I'                 TO OC-RECORD-TYPE
 15992        MOVE +4096               TO OC-KEY-SEQ-NO
 15993        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15994        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15995        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15996        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15997        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15998        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15999        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16000        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 16001        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 291
* EL6311.cbl
 16002        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16003        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16004        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16005        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16006        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16007        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16008        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16009        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16010        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16011        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16012        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16013        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16014        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16015        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16016        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16017        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16018        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16019        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16020        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16021        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16022        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16023        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16024        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16025        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16026        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16027        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16028        IF ERMAIL-FOUND
 16029           MOVE MA-CRED-BENE-NAME
 16030                                 TO OC-CRED-BENE-NAME
 16031        END-IF
 16032        IF NOT CERT-TRL-REC-NOT-FOUND
 16033           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16034                           OC-INS-AGE-DEFAULT-FLAG
 16035           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16036                           OC-JNT-AGE-DEFAULT-FLAG
 16037        END-IF
 16038        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16039
 16040
 16041* EXEC CICS WRITE
 16042*          DATASET   ('ELCRTO')
 16043*          FROM      (ORIGINAL-CERTIFICATE)
 16044*          RIDFLD    (OC-CONTROL-PRIMARY)
 16045*          RESP      (WS-RESPONSE)
 16046*       END-EXEC
 16047     MOVE LENGTH OF
 16048      ORIGINAL-CERTIFICATE
 16049       TO DFHEIV11
 16050     MOVE 'ELCRTO' TO DFHEIV1
 16051*    MOVE '&$ L                  ''  N#00014231' TO DFHEIV0
 16052     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16053     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16054     MOVE X'204E233030303134323331' TO DFHEIV0(25:11)
 16055     CALL 'kxdfhei1' USING DFHEIV0,
 16056           DFHEIV1,
 16057           ORIGINAL-CERTIFICATE,
 16058           DFHEIV11,
 16059           OC-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 292
* EL6311.cbl
 16060           DFHEIV99,
 16061           DFHEIV99
 16062     MOVE EIBRESP  TO WS-RESPONSE
 16063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16064     END-IF.
 16065
 16066 2376-BYPASS-CRTO.
 16067******************************************************************
 16068*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16069******************************************************************
 16070
 16071
 16072* EXEC CICS HANDLE CONDITION
 16073*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16074*    END-EXEC.
 16075*    MOVE '"$I                   ! 7 #00014244' TO DFHEIV0
 16076     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16077     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16078     MOVE X'3720233030303134323434' TO DFHEIV0(25:11)
 16079     CALL 'kxdfhei1' USING DFHEIV0
 16080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16081
 16082
 16083
 16084* EXEC CICS READ
 16085*        INTO    (PENDING-BUSINESS)
 16086*        DATASET (FILE-ID-ERPNDB)
 16087*        RIDFLD  (ERPNDB-KEY)
 16088*        UPDATE
 16089*    END-EXEC.
 16090     MOVE LENGTH OF
 16091      PENDING-BUSINESS
 16092       TO DFHEIV11
 16093*    MOVE '&"IL       EU         (   #00014248' TO DFHEIV0
 16094     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16095     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16096     MOVE X'2020233030303134323438' TO DFHEIV0(25:11)
 16097     CALL 'kxdfhei1' USING DFHEIV0,
 16098           FILE-ID-ERPNDB,
 16099           PENDING-BUSINESS,
 16100           DFHEIV11,
 16101           ERPNDB-KEY,
 16102           DFHEIV99,
 16103           DFHEIV99,
 16104           DFHEIV99
 16105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16106
 16107
 16108     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16109     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16110     MOVE 'B'                    TO JP-RECORD-TYPE.
 16111     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16112
 16113     PERFORM 8400-LOG-JOURNAL-RECORD.
 16114
 16115     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16116
 16117
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 293
* EL6311.cbl
 16118* EXEC CICS REWRITE
 16119*        DATASET (FILE-ID-ERPNDB)
 16120*        FROM    (PENDING-BUSINESS)
 16121*    END-EXEC.
 16122     MOVE LENGTH OF
 16123      PENDING-BUSINESS
 16124       TO DFHEIV11
 16125*    MOVE '&& L                  %   #00014264' TO DFHEIV0
 16126     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16127     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16128     MOVE X'2020233030303134323634' TO DFHEIV0(25:11)
 16129     CALL 'kxdfhei1' USING DFHEIV0,
 16130           FILE-ID-ERPNDB,
 16131           PENDING-BUSINESS,
 16132           DFHEIV11,
 16133           DFHEIV99
 16134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16135
 16136
 16137     MOVE 'C'                    TO JP-RECORD-TYPE.
 16138     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16139
 16140     PERFORM 8400-LOG-JOURNAL-RECORD.
 16141
 16142     IF WS-ERRORS-PRESENT
 16143         GO TO 3900-RE-DISPLAY-RECORD.
 16144
 16145     MOVE ZEROS                  TO EMI-ERROR
 16146     MOVE -1                     TO CMAINTL
 16147     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16148     GO TO 3900-RE-DISPLAY-RECORD.
 16149
 16150 2380-BATCH-HDR-NOT-FOUND.
 16151     MOVE -1                     TO BMAINTL.
 16152     MOVE ER-7450                TO EMI-ERROR.
 16153     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16154     GO TO 8200-SEND-DATAONLY.
 16155
 16156 2385-REC-NOT-FOUND.
 16157     MOVE -1                     TO BMAINTL.
 16158     MOVE ER-7451                TO EMI-ERROR.
 16159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16160     GO TO 8200-SEND-DATAONLY.
 16161
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 294
* EL6311.cbl
 16163
 16164******************************************************************
 16165*                                                                *
 16166*          D E L E T E   C A N C E L   R O U T I N E             *
 16167*                                                                *
 16168******************************************************************
 16169
 16170 2400-DELETE-CANCEL-ROUTINE.
 16171     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16172
 16173     IF CCHGL NOT = ZEROS
 16174        MOVE ER-2196             TO EMI-ERROR
 16175        MOVE AL-UABON            TO CMAINTA
 16176        MOVE -1                  TO CMAINTL
 16177        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16178        GO TO 8200-SEND-DATAONLY.
 16179
 16180
 16181* EXEC CICS HANDLE CONDITION
 16182*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16183*    END-EXEC.
 16184*    MOVE '"$I                   ! 8 #00014312' TO DFHEIV0
 16185     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16186     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16187     MOVE X'3820233030303134333132' TO DFHEIV0(25:11)
 16188     CALL 'kxdfhei1' USING DFHEIV0
 16189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16190
 16191
 16192     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16193     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16194     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16195
 16196
 16197* EXEC CICS READ
 16198*        SET     (ADDRESS OF PENDING-BUSINESS)
 16199*        DATASET (FILE-ID-ERPNDB)
 16200*        RIDFLD  (ERPNDB-KEY)
 16201*    END-EXEC.
 16202*    MOVE '&"S        E          (   #00014320' TO DFHEIV0
 16203     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16204     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16205     MOVE X'2020233030303134333230' TO DFHEIV0(25:11)
 16206     CALL 'kxdfhei1' USING DFHEIV0,
 16207           FILE-ID-ERPNDB,
 16208           DFHEIV20,
 16209           DFHEIV99,
 16210           ERPNDB-KEY,
 16211           DFHEIV99,
 16212           DFHEIV99,
 16213           DFHEIV99
 16214     SET ADDRESS OF PENDING-BUSINESS TO
 16215         DFHEIV20
 16216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16217
 16218
 16219     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16220
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 295
* EL6311.cbl
 16221     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16222
 16223     IF CSUFIXL NOT = ZEROS
 16224        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16225     ELSE
 16226        MOVE SPACE               TO WS-NEW-SUFFIX.
 16227
 16228     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16229
 16230     PERFORM 8600-DEEDIT.
 16231     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16232     MOVE '4'                    TO DC-OPTION-CODE.
 16233     PERFORM 9700-DATE-LINK.
 16234
 16235     IF DATE-CONVERSION-ERROR
 16236        MOVE ER-0348             TO EMI-ERROR
 16237        MOVE -1                  TO CEFFDTL
 16238        MOVE AL-UABON            TO CEFFDTA
 16239        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16240        GO TO 8200-SEND-DATAONLY
 16241     ELSE
 16242        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16243        MOVE AL-UANON            TO CEFFDTA
 16244        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16245
 16246
 16247* EXEC CICS HANDLE CONDITION
 16248*         NOTFND    (2490-RECORD-NOT-FOUND)
 16249*    END-EXEC.
 16250*    MOVE '"$I                   ! 9 #00014353' TO DFHEIV0
 16251     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16252     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16253     MOVE X'3920233030303134333533' TO DFHEIV0(25:11)
 16254     CALL 'kxdfhei1' USING DFHEIV0
 16255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16256
 16257
 16258
 16259* EXEC CICS READ
 16260*        SET     (ADDRESS OF PENDING-BUSINESS)
 16261*        DATASET (FILE-ID-ERPNDB)
 16262*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16263*        UPDATE
 16264*    END-EXEC.
 16265*    MOVE '&"S        EU         (   #00014357' TO DFHEIV0
 16266     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16267     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16268     MOVE X'2020233030303134333537' TO DFHEIV0(25:11)
 16269     CALL 'kxdfhei1' USING DFHEIV0,
 16270           FILE-ID-ERPNDB,
 16271           DFHEIV20,
 16272           DFHEIV99,
 16273           PI-PREV-CONTROL-PRIMARY,
 16274           DFHEIV99,
 16275           DFHEIV99,
 16276           DFHEIV99
 16277     SET ADDRESS OF PENDING-BUSINESS TO
 16278         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 296
* EL6311.cbl
 16279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16280
 16281
 16282     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16283        MOVE -1                 TO CMAINTL
 16284        MOVE ER-2197            TO EMI-ERROR
 16285        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16286        GO TO 8200-SEND-DATAONLY.
 16287
 16288     IF PB-BILLED-DT NOT = LOW-VALUES
 16289        MOVE -1                 TO CMAINTL
 16290        MOVE ER-2129            TO EMI-ERROR
 16291        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16292        GO TO 8200-SEND-DATAONLY.
 16293
 16294     IF PB-CHG-COUNT NOT = ZEROS
 16295        MOVE ER-2336            TO EMI-ERROR
 16296        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16297        MOVE AL-UABON            TO CMAINTA
 16298        MOVE -1                  TO CMAINTL
 16299        GO TO 8200-SEND-DATAONLY.
 16300
 16301     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16302        PB-CHG-COUNT NOT = ZEROS
 16303        MOVE ER-2196             TO EMI-ERROR
 16304        MOVE AL-UABON            TO CMAINTA
 16305        MOVE -1                  TO CMAINTL
 16306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16307        GO TO 8200-SEND-DATAONLY.
 16308
 16309     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16310        MOVE ER-2900 TO EMI-ERROR
 16311        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16312        MOVE AL-UABON         TO CMAINTA
 16313        MOVE -1               TO CMAINTL
 16314        GO TO 8200-SEND-DATAONLY.
 16315     move ' '                    to ws-stop-sw
 16316                                    ws-check-sw
 16317                                    ws-proc-check-sw
 16318                                    ws-chek-browse-sw
 16319
 16320     perform 2500-browse-checks  thru 2500-exit
 16321     if (i-have-processed-checks)
 16322        and (pb-c-refund-sw = 'Y')
 16323        move er-3446             to emi-error
 16324        perform 9900-error-format thru 9900-exit
 16325        move al-uabon            to cmainta
 16326        move -1                  to cmaintl
 16327        go to 8200-send-dataonly
 16328     end-if
 16329
 16330* EXEC CICS HANDLE CONDITION
 16331*         NOTFND  (2475-CONTINUE-DELETE)
 16332*    END-EXEC
 16333*    MOVE '"$I                   ! : #00014411' TO DFHEIV0
 16334     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16335     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16336     MOVE X'3A20233030303134343131' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 297
* EL6311.cbl
 16337     CALL 'kxdfhei1' USING DFHEIV0
 16338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16339
 16340     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16341     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16342     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16343     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16344
 16345
 16346* EXEC CICS READ
 16347*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16348*        DATASET (FILE-ID-ELCERT)
 16349*        RIDFLD  (ELCERT-KEY)
 16350*        UPDATE
 16351*    END-EXEC.
 16352*    MOVE '&"S        EU         (   #00014420' TO DFHEIV0
 16353     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16354     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16355     MOVE X'2020233030303134343230' TO DFHEIV0(25:11)
 16356     CALL 'kxdfhei1' USING DFHEIV0,
 16357           FILE-ID-ELCERT,
 16358           DFHEIV20,
 16359           DFHEIV99,
 16360           ELCERT-KEY,
 16361           DFHEIV99,
 16362           DFHEIV99,
 16363           DFHEIV99
 16364     SET ADDRESS OF CERTIFICATE-MASTER TO
 16365         DFHEIV20
 16366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16367
 16368
 16369     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16370
 16371     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16372     MOVE 'B'                    TO JP-RECORD-TYPE.
 16373     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16374     PERFORM 8400-LOG-JOURNAL-RECORD.
 16375
 16376     IF PB-CI-LIVES NOT NUMERIC
 16377         MOVE ZERO                    TO PB-CI-LIVES.
 16378
 16379     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16380        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16381           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16382           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16383           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16384                                            CM-LF-CANCEL-DT
 16385           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16386        ELSE
 16387           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16388           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16389           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16390           MOVE PB-CI-LIVES              TO CM-LIVES.
 16391
 16392     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16393        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16394           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 298
* EL6311.cbl
 16395               MOVE CM-LF-STATUS-AT-CANCEL
 16396                                        TO CM-LF-CURRENT-STATUS
 16397               MOVE SPACE
 16398                                        TO CM-LF-STATUS-AT-CANCEL
 16399           ELSE
 16400               MOVE PB-CI-LF-POLICY-STATUS
 16401                                        TO CM-LF-CURRENT-STATUS
 16402        ELSE
 16403           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16404
 16405
 16406     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16407        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16408           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16409           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16410           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16411                                            CM-AH-CANCEL-DT
 16412           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16413        ELSE
 16414           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16415           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16416           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16417           MOVE PB-CI-LIVES              TO CM-LIVES.
 16418
 16419     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16420        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16421           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16422               MOVE CM-AH-STATUS-AT-CANCEL
 16423                                        TO CM-AH-CURRENT-STATUS
 16424               MOVE SPACE
 16425                                        TO CM-AH-STATUS-AT-CANCEL
 16426           ELSE
 16427               MOVE PB-CI-AH-POLICY-STATUS
 16428                                        TO CM-AH-CURRENT-STATUS
 16429        ELSE
 16430           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16431
 16432 2450-REWRITE-CERT.
 16433     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16434     MOVE 'C'                      TO JP-RECORD-TYPE.
 16435     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16436
 16437
 16438* EXEC CICS REWRITE
 16439*        DATASET  (FILE-ID-ELCERT)
 16440*        FROM     (CERTIFICATE-MASTER)
 16441*    END-EXEC.
 16442     MOVE LENGTH OF
 16443      CERTIFICATE-MASTER
 16444       TO DFHEIV11
 16445*    MOVE '&& L                  %   #00014495' TO DFHEIV0
 16446     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16447     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16448     MOVE X'2020233030303134343935' TO DFHEIV0(25:11)
 16449     CALL 'kxdfhei1' USING DFHEIV0,
 16450           FILE-ID-ELCERT,
 16451           CERTIFICATE-MASTER,
 16452           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 299
* EL6311.cbl
 16453           DFHEIV99
 16454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16455
 16456
 16457     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16458
 16459     PERFORM 8400-LOG-JOURNAL-RECORD.
 16460
 16461     move ' '                    to ws-stop-sw
 16462                                    ws-proc-check-sw
 16463                                    ws-chek-browse-sw
 16464
 16465     if i-have-checks
 16466        perform until i-say-stop
 16467           perform 2510-startbr-erchek
 16468                                 thru 2510-exit
 16469           if resp-normal
 16470              perform 2520-readnext-erchek
 16471                                 thru 2520-exit
 16472           end-if
 16473           if (not resp-normal)
 16474              or (pb-control-by-account (1:33) not =
 16475                 ch-control-primary (1:33))
 16476                 set i-say-stop to true
 16477           else
 16478              perform 2530-readupd-erchek
 16479                                 thru 2530-exit
 16480              if resp-normal
 16481                 perform 2540-delete-erchek
 16482                                 thru 2540-exit
 16483              end-if
 16484              if ws-chek-browse-sw = 'Y'
 16485                 perform 2525-endbr-erchek
 16486                                 thru 2525-exit
 16487                 move ' '        to ws-chek-browse-sw
 16488              end-if
 16489           end-if
 16490        end-perform
 16491     end-if
 16492
 16493     if ws-chek-browse-sw = 'Y'
 16494        perform 2525-endbr-erchek thru 2525-exit
 16495     end-if
 16496     .
 16497 2475-CONTINUE-DELETE.
 16498     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16499     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16500
 16501     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16502     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16503
 16504     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16505
 16506     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16507     MOVE 'D'                    TO JP-RECORD-TYPE
 16508     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16509
 16510
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 300
* EL6311.cbl
 16511* EXEC CICS DELETE
 16512*        DATASET    (FILE-ID-ERPNDB)
 16513*    END-EXEC.
 16514*    MOVE '&(                    &   #00014553' TO DFHEIV0
 16515     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16516     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16517     MOVE X'2020233030303134353533' TO DFHEIV0(25:11)
 16518     CALL 'kxdfhei1' USING DFHEIV0,
 16519           FILE-ID-ERPNDB,
 16520           DFHEIV99,
 16521           DFHEIV99,
 16522           DFHEIV99,
 16523           DFHEIV99
 16524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16525
 16526
 16527     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16528
 16529     PERFORM 8400-LOG-JOURNAL-RECORD.
 16530
 16531     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16532     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16533
 16534
 16535* EXEC CICS HANDLE CONDITION
 16536*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16537*    END-EXEC.
 16538*    MOVE '"$I                   ! ; #00014564' TO DFHEIV0
 16539     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16540     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16541     MOVE X'3B20233030303134353634' TO DFHEIV0(25:11)
 16542     CALL 'kxdfhei1' USING DFHEIV0
 16543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16544
 16545
 16546
 16547* EXEC CICS READ
 16548*        SET     (ADDRESS OF PENDING-BUSINESS)
 16549*        DATASET (FILE-ID-ERPNDB)
 16550*        RIDFLD  (ERPNDB-KEY)
 16551*        UPDATE
 16552*    END-EXEC.
 16553*    MOVE '&"S        EU         (   #00014568' TO DFHEIV0
 16554     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16555     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16556     MOVE X'2020233030303134353638' TO DFHEIV0(25:11)
 16557     CALL 'kxdfhei1' USING DFHEIV0,
 16558           FILE-ID-ERPNDB,
 16559           DFHEIV20,
 16560           DFHEIV99,
 16561           ERPNDB-KEY,
 16562           DFHEIV99,
 16563           DFHEIV99,
 16564           DFHEIV99
 16565     SET ADDRESS OF PENDING-BUSINESS TO
 16566         DFHEIV20
 16567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16568
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 301
* EL6311.cbl
 16569
 16570     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16571     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16572
 16573     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16574        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16575        MOVE 'D'                 TO JP-RECORD-TYPE
 16576        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16577
 16578* EXEC CICS DELETE
 16579*            DATASET    (FILE-ID-ERPNDB)
 16580*       END-EXEC
 16581*    MOVE '&(                    &   #00014582' TO DFHEIV0
 16582     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16583     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16584     MOVE X'2020233030303134353832' TO DFHEIV0(25:11)
 16585     CALL 'kxdfhei1' USING DFHEIV0,
 16586           FILE-ID-ERPNDB,
 16587           DFHEIV99,
 16588           DFHEIV99,
 16589           DFHEIV99,
 16590           DFHEIV99
 16591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16592        PERFORM 8400-LOG-JOURNAL-RECORD
 16593     ELSE
 16594        MOVE 'B'                 TO JP-RECORD-TYPE
 16595        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16596        PERFORM 8400-LOG-JOURNAL-RECORD
 16597        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16598        MOVE 'C'                 TO JP-RECORD-TYPE
 16599        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16600
 16601* EXEC CICS REWRITE
 16602*            DATASET    (FILE-ID-ERPNDB)
 16603*            FROM       (PENDING-BUSINESS)
 16604*       END-EXEC
 16605     MOVE LENGTH OF
 16606      PENDING-BUSINESS
 16607       TO DFHEIV11
 16608*    MOVE '&& L                  %   #00014593' TO DFHEIV0
 16609     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16610     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16611     MOVE X'2020233030303134353933' TO DFHEIV0(25:11)
 16612     CALL 'kxdfhei1' USING DFHEIV0,
 16613           FILE-ID-ERPNDB,
 16614           PENDING-BUSINESS,
 16615           DFHEIV11,
 16616           DFHEIV99
 16617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16618        PERFORM 8400-LOG-JOURNAL-RECORD.
 16619
 16620******************************************************************
 16621*                                                                *
 16622*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16623*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16624*                                                                *
 16625******************************************************************
 16626
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 302
* EL6311.cbl
 16627     IF NOT PI-AR-PROCESSING
 16628        GO TO 2480-DELETE-FINISHED.
 16629
 16630     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16631        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16632        NEXT SENTENCE
 16633     ELSE
 16634        GO TO 2480-DELETE-FINISHED.
 16635
 16636
 16637* EXEC CICS HANDLE CONDITION
 16638*         NOTFND    (2480-DELETE-FINISHED)
 16639*    END-EXEC.
 16640*    MOVE '"$I                   ! < #00014615' TO DFHEIV0
 16641     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16643     MOVE X'3C20233030303134363135' TO DFHEIV0(25:11)
 16644     CALL 'kxdfhei1' USING DFHEIV0
 16645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16646
 16647
 16648     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16649     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16650
 16651
 16652* EXEC CICS READ
 16653*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16654*        DATASET (FILE-ID-ERRQST)
 16655*        RIDFLD  (ERRQST-KEY)
 16656*        UPDATE
 16657*    END-EXEC.
 16658*    MOVE '&"S        EU         (   #00014622' TO DFHEIV0
 16659     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16660     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16661     MOVE X'2020233030303134363232' TO DFHEIV0(25:11)
 16662     CALL 'kxdfhei1' USING DFHEIV0,
 16663           FILE-ID-ERRQST,
 16664           DFHEIV20,
 16665           DFHEIV99,
 16666           ERRQST-KEY,
 16667           DFHEIV99,
 16668           DFHEIV99,
 16669           DFHEIV99
 16670     SET ADDRESS OF AR-REQUEST-RECORD TO
 16671         DFHEIV20
 16672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16673
 16674
 16675     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16676
 16677     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16678
 16679     MOVE 'D'                      TO JP-RECORD-TYPE.
 16680     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16681
 16682
 16683* EXEC CICS DELETE
 16684*         DATASET    (FILE-ID-ERRQST)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 303
* EL6311.cbl
 16685*    END-EXEC.
 16686*    MOVE '&(                    &   #00014636' TO DFHEIV0
 16687     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16688     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16689     MOVE X'2020233030303134363336' TO DFHEIV0(25:11)
 16690     CALL 'kxdfhei1' USING DFHEIV0,
 16691           FILE-ID-ERRQST,
 16692           DFHEIV99,
 16693           DFHEIV99,
 16694           DFHEIV99,
 16695           DFHEIV99
 16696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16697
 16698
 16699     PERFORM 8400-LOG-JOURNAL-RECORD.
 16700
 16701 2480-DELETE-FINISHED.
 16702     MOVE ZEROS                  TO EMI-ERROR.
 16703     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16704     MOVE LOW-VALUES             TO EL631CI.
 16705     MOVE -1                     TO CMAINTL.
 16706     GO TO 8100-SEND-INITIAL-MAP.
 16707
 16708 2485-BATCH-HDR-NOT-FOUND.
 16709     MOVE -1                     TO CMAINTL
 16710     MOVE AL-UABON               TO CMAINTA.
 16711     MOVE ER-7450                TO EMI-ERROR.
 16712     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16713     GO TO 8200-SEND-DATAONLY.
 16714
 16715 2490-RECORD-NOT-FOUND.
 16716     MOVE -1                     TO CMAINTL
 16717     MOVE AL-UABON               TO CMAINTA.
 16718     MOVE ER-7451                TO EMI-ERROR.
 16719     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16720     GO TO 8200-SEND-DATAONLY.
 16721***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16722***                                                            ***
 16723***     2500  B R O W S E   C H E C K S                        ***
 16724***  We perform this routine from 2 different places.          ***
 16725***  1. If the user changes the refund amount on a cancel, we  ***
 16726***    want to.........                                        ***
 16727***    a. determine if prior checks have been processed        ***
 16728***    b. If the amt is larger, display message instructing    ***
 16729***     them to create another check to make up the difference.***
 16730***    c. If the amt is less, do not allow the change and      ***
 16731***     display a FATAL error suggesting they deal with check  ***
 16732***     records befor continuing.                              ***
 16733***  2. If the user wants to delete a cancel record we......   ***
 16734***    a. browse through all the checks and if there is a      ***
 16735***     processed check, send FATAL message.                   ***
 16736***    b. If there is a non-released check, then delete that   ***
 16737***     check after you delete the pending cancel record.      ***
 16738***                                                            ***
 16739***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16740
 16741 2500-browse-checks.
 16742
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 304
* EL6311.cbl
 16743     perform 2510-startbr-erchek thru 2510-exit
 16744
 16745     if not resp-normal
 16746        go to 2500-exit
 16747     end-if
 16748
 16749     perform until i-say-stop
 16750        perform 2520-readnext-erchek
 16751                                 thru 2520-exit
 16752        if (not resp-normal)
 16753           or (pb-control-by-account (1:33) not =
 16754              ch-control-primary (1:33))
 16755              set i-say-stop to true
 16756        else
 16757           if (ch-approval-status) = ' '
 16758              and (ch-void-dt = low-values)
 16759              and (ch-released-dt = low-values)
 16760              set i-have-checks to true
 16761           else
 16762              if ch-void-dt = low-values
 16763                 set i-have-processed-checks to true
 16764              end-if
 16765           end-if
 16766           if (ch-credit-accept-dt = low-values)
 16767              and (ch-void-dt = low-values)
 16768              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16769              if (ch-check-origin-sw not = 'R')
 16770                 and (pb-record-type = '2')
 16771                 continue
 16772              else
 16773                 compute ws-check-amts =
 16774                    ws-check-amts + ch-amount-paid
 16775              end-if
 16776           end-if
 16777        end-if
 16778     end-perform
 16779
 16780     if ws-chek-browse-sw = 'Y'
 16781        perform 2525-endbr-erchek thru 2525-exit
 16782     end-if
 16783
 16784    .
 16785 2500-exit.
 16786     exit.
 16787
 16788 2510-startbr-erchek.
 16789
 16790     move pb-control-by-account  to erchek-key
 16791     move +0                     to chek-record-seq
 16792
 16793
 16794* exec cics startbr
 16795*       dataset   ('ERCHEK')
 16796*       ridfld    (erchek-key)
 16797*       gteq
 16798*       resp      (ws-response)
 16799*    end-exec
 16800     MOVE 'ERCHEK' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 305
* EL6311.cbl
 16801     MOVE 0
 16802       TO DFHEIV11
 16803*    MOVE '&,         G          &  N#00014734' TO DFHEIV0
 16804     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16805     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16806     MOVE X'204E233030303134373334' TO DFHEIV0(25:11)
 16807     CALL 'kxdfhei1' USING DFHEIV0,
 16808           DFHEIV1,
 16809           erchek-key,
 16810           DFHEIV99,
 16811           DFHEIV11,
 16812           DFHEIV99
 16813     MOVE EIBRESP  TO ws-response
 16814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16815
 16816     IF RESP-NORMAL
 16817        move 'Y'                 to ws-chek-browse-sw
 16818     end-if
 16819
 16820     .
 16821 2510-exit.
 16822     exit.
 16823
 16824 2520-readnext-erchek.
 16825
 16826
 16827* EXEC CICS READNEXT
 16828*       SET     (ADDRESS OF CHECK-RECORDS)
 16829*       DATASET ('ERCHEK')
 16830*       RIDFLD  (ERCHEK-KEY)
 16831*       RESP    (WS-RESPONSE)
 16832*    END-EXEC
 16833     MOVE 'ERCHEK' TO DFHEIV1
 16834     MOVE 0
 16835       TO DFHEIV11
 16836*    MOVE '&.S                   )  N#00014751' TO DFHEIV0
 16837     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16838     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16839     MOVE X'204E233030303134373531' TO DFHEIV0(25:11)
 16840     CALL 'kxdfhei1' USING DFHEIV0,
 16841           DFHEIV1,
 16842           DFHEIV20,
 16843           DFHEIV99,
 16844           ERCHEK-KEY,
 16845           DFHEIV99,
 16846           DFHEIV11,
 16847           DFHEIV99,
 16848           DFHEIV99
 16849     SET ADDRESS OF CHECK-RECORDS TO
 16850         DFHEIV20
 16851     MOVE EIBRESP  TO WS-RESPONSE
 16852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16853
 16854     .
 16855 2520-exit.
 16856     exit.
 16857
 16858 2525-endbr-erchek.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 306
* EL6311.cbl
 16859
 16860
 16861* exec cics endbr
 16862*       dataset  ('ERCHEK')
 16863*    end-exec
 16864     MOVE 'ERCHEK' TO DFHEIV1
 16865     MOVE 0
 16866       TO DFHEIV11
 16867*    MOVE '&2                    $   #00014764' TO DFHEIV0
 16868     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16869     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16870     MOVE X'2020233030303134373634' TO DFHEIV0(25:11)
 16871     CALL 'kxdfhei1' USING DFHEIV0,
 16872           DFHEIV1,
 16873           DFHEIV11,
 16874           DFHEIV99
 16875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16876
 16877     .
 16878 2525-exit.
 16879     exit.
 16880
 16881 2530-readupd-erchek.
 16882
 16883
 16884* EXEC CICS READ
 16885*       UPDATE
 16886*       SET     (ADDRESS OF CHECK-RECORDS)
 16887*       DATASET ('ERCHEK')
 16888*       RIDFLD  (ERCHEK-KEY)
 16889*       RESP    (WS-RESPONSE)
 16890*    END-EXEC
 16891     MOVE 'ERCHEK' TO DFHEIV1
 16892*    MOVE '&"S        EU         (  N#00014774' TO DFHEIV0
 16893     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16894     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16895     MOVE X'204E233030303134373734' TO DFHEIV0(25:11)
 16896     CALL 'kxdfhei1' USING DFHEIV0,
 16897           DFHEIV1,
 16898           DFHEIV20,
 16899           DFHEIV99,
 16900           ERCHEK-KEY,
 16901           DFHEIV99,
 16902           DFHEIV99,
 16903           DFHEIV99
 16904     SET ADDRESS OF CHECK-RECORDS TO
 16905         DFHEIV20
 16906     MOVE EIBRESP  TO WS-RESPONSE
 16907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16908
 16909     .
 16910 2530-exit.
 16911     exit.
 16912
 16913 2540-delete-erchek.
 16914
 16915
 16916* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 307
* EL6311.cbl
 16917*       DATASET ('ERCHEK')
 16918*       RESP    (WS-RESPONSE)
 16919*    END-EXEC
 16920     MOVE 'ERCHEK' TO DFHEIV1
 16921*    MOVE '&(                    &  N#00014788' TO DFHEIV0
 16922     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16923     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16924     MOVE X'204E233030303134373838' TO DFHEIV0(25:11)
 16925     CALL 'kxdfhei1' USING DFHEIV0,
 16926           DFHEIV1,
 16927           DFHEIV99,
 16928           DFHEIV99,
 16929           DFHEIV99,
 16930           DFHEIV99
 16931     MOVE EIBRESP  TO WS-RESPONSE
 16932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16933
 16934     .
 16935 2540-exit.
 16936     exit.
 16937***************************************************************
 16938*                                                             *
 16939*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16940*                                                             *
 16941***************************************************************
 16942
 16943***************************************************************
 16944*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16945*     AN ALREADY BILLED RECORD.                               *
 16946***************************************************************
 16947
 16948 2700-BUILD-CORRECTION-RECORD.
 16949     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16950     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16951     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16952     MOVE '5'                    TO DC-OPTION-CODE.
 16953     PERFORM 9700-DATE-LINK.
 16954     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16955
 16956     IF PB-CHG-COUNT = ZEROS
 16957        MOVE +1                  TO WS-SEQ-SAVE
 16958     ELSE
 16959        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16960
 16961     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16962     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16963
 16964     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16965
 16966     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16967     MOVE 'A'                    TO JP-RECORD-TYPE.
 16968     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16969
 16970
 16971* EXEC CICS WRITE
 16972*        DATASET    (FILE-ID-ERPNDB)
 16973*        FROM       (PENDING-BUSINESS)
 16974*        RIDFLD     (PB-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 308
* EL6311.cbl
 16975*    END-EXEC.
 16976     MOVE LENGTH OF
 16977      PENDING-BUSINESS
 16978       TO DFHEIV11
 16979*    MOVE '&$ L                  ''   #00014829' TO DFHEIV0
 16980     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16981     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16982     MOVE X'2020233030303134383239' TO DFHEIV0(25:11)
 16983     CALL 'kxdfhei1' USING DFHEIV0,
 16984           FILE-ID-ERPNDB,
 16985           PENDING-BUSINESS,
 16986           DFHEIV11,
 16987           PB-CONTROL-PRIMARY,
 16988           DFHEIV99,
 16989           DFHEIV99
 16990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16991
 16992
 16993     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16994
 16995     PERFORM 8400-LOG-JOURNAL-RECORD.
 16996
 16997 2799-EXIT.
 16998      EXIT.
 16999
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 309
* EL6311.cbl
 17001
 17002******************************************************************
 17003*                                                                *
 17004*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17005*                                                                *
 17006******************************************************************
 17007
 17008 2800-REWRITE-ISSUE-CERT-KEY.
 17009     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17010
 17011     IF  BCERTNOL GREATER THAN ZEROS
 17012         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17013
 17014     IF  BSUFIXL  GREATER THAN ZEROS
 17015         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17016
 17017     IF  BEFFDTL  GREATER THAN ZEROS
 17018         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17019
 17020 2810-READ-BY-ACCOUNT.
 17021
 17022* EXEC CICS HANDLE CONDITION
 17023*         NOTFND    (2820-PROCESS-REWRITE)
 17024*    END-EXEC.
 17025*    MOVE '"$I                   ! = #00014863' TO DFHEIV0
 17026     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17027     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17028     MOVE X'3D20233030303134383633' TO DFHEIV0(25:11)
 17029     CALL 'kxdfhei1' USING DFHEIV0
 17030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17031
 17032
 17033***  read pndb using new key
 17034
 17035* EXEC CICS READ
 17036*        SET     (ADDRESS OF PENDING-BUSINESS)
 17037*        DATASET (FILE-ID-ERPNDB2)
 17038*        RIDFLD  (ERPNDB-ALT-KEY)
 17039*    END-EXEC.
 17040*    MOVE '&"S        E          (   #00014868' TO DFHEIV0
 17041     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17042     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17043     MOVE X'2020233030303134383638' TO DFHEIV0(25:11)
 17044     CALL 'kxdfhei1' USING DFHEIV0,
 17045           FILE-ID-ERPNDB2,
 17046           DFHEIV20,
 17047           DFHEIV99,
 17048           ERPNDB-ALT-KEY,
 17049           DFHEIV99,
 17050           DFHEIV99,
 17051           DFHEIV99
 17052     SET ADDRESS OF PENDING-BUSINESS TO
 17053         DFHEIV20
 17054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17055
 17056
 17057     GO TO 2890-DUPLICATE-RECORD.
 17058
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 310
* EL6311.cbl
 17059  2820-PROCESS-REWRITE.
 17060
 17061* EXEC CICS HANDLE CONDITION
 17062*         NOTFND    (2885-RECORD-MISSING)
 17063*    END-EXEC.
 17064*    MOVE '"$I                   ! > #00014877' TO DFHEIV0
 17065     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17067     MOVE X'3E20233030303134383737' TO DFHEIV0(25:11)
 17068     CALL 'kxdfhei1' USING DFHEIV0
 17069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17070
 17071
 17072     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17073
 17074***  read pndb using original key
 17075
 17076* EXEC CICS READ
 17077*        SET     (ADDRESS OF PENDING-BUSINESS)
 17078*        DATASET (FILE-ID-ERPNDB)
 17079*        RIDFLD  (ERPNDB-KEY)
 17080*        UPDATE
 17081*    END-EXEC.
 17082*    MOVE '&"S        EU         (   #00014884' TO DFHEIV0
 17083     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17084     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17085     MOVE X'2020233030303134383834' TO DFHEIV0(25:11)
 17086     CALL 'kxdfhei1' USING DFHEIV0,
 17087           FILE-ID-ERPNDB,
 17088           DFHEIV20,
 17089           DFHEIV99,
 17090           ERPNDB-KEY,
 17091           DFHEIV99,
 17092           DFHEIV99,
 17093           DFHEIV99
 17094     SET ADDRESS OF PENDING-BUSINESS TO
 17095         DFHEIV20
 17096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17097
 17098
 17099     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17100     MOVE 'D'                    TO JP-RECORD-TYPE.
 17101     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17102     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17103
 17104     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17105
 17106     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17107     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17108     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17109
 17110***  delete pndb using original key
 17111
 17112* EXEC CICS DELETE
 17113*        DATASET    (FILE-ID-ERPNDB)
 17114*    END-EXEC.
 17115*    MOVE '&(                    &   #00014903' TO DFHEIV0
 17116     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 311
* EL6311.cbl
 17117     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17118     MOVE X'2020233030303134393033' TO DFHEIV0(25:11)
 17119     CALL 'kxdfhei1' USING DFHEIV0,
 17120           FILE-ID-ERPNDB,
 17121           DFHEIV99,
 17122           DFHEIV99,
 17123           DFHEIV99,
 17124           DFHEIV99
 17125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17126
 17127
 17128     PERFORM 8400-LOG-JOURNAL-RECORD.
 17129
 17130
 17131* EXEC CICS GETMAIN
 17132*        SET      (ADDRESS OF PENDING-BUSINESS)
 17133*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17134*        INITIMG  (GETMAIN-SPACE)
 17135*    END-EXEC.
 17136*    MOVE ',"IL                  $   #00014909' TO DFHEIV0
 17137     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17138     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17139     MOVE X'2020233030303134393039' TO DFHEIV0(25:11)
 17140     CALL 'kxdfhei1' USING DFHEIV0,
 17141           DFHEIV20,
 17142           ERPNDB-RECORD-LENGTH,
 17143           GETMAIN-SPACE
 17144     SET ADDRESS OF PENDING-BUSINESS TO
 17145         DFHEIV20
 17146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17147
 17148
 17149***  pending-business now has original record
 17150     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17151
 17152
 17153* EXEC CICS HANDLE CONDITION
 17154*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17155*    END-EXEC.
 17156*    MOVE '"$I                   ! ? #00014918' TO DFHEIV0
 17157     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17158     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17159     MOVE X'3F20233030303134393138' TO DFHEIV0(25:11)
 17160     CALL 'kxdfhei1' USING DFHEIV0
 17161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17162
 17163
 17164***  read elcert using original key
 17165
 17166* EXEC CICS READ
 17167*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17168*        DATASET (FILE-ID-ELCERT)
 17169*        RIDFLD  (ELCERT-KEY)
 17170*        UPDATE
 17171*    END-EXEC.
 17172*    MOVE '&"S        EU         (   #00014923' TO DFHEIV0
 17173     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17174     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 312
* EL6311.cbl
 17175     MOVE X'2020233030303134393233' TO DFHEIV0(25:11)
 17176     CALL 'kxdfhei1' USING DFHEIV0,
 17177           FILE-ID-ELCERT,
 17178           DFHEIV20,
 17179           DFHEIV99,
 17180           ELCERT-KEY,
 17181           DFHEIV99,
 17182           DFHEIV99,
 17183           DFHEIV99
 17184     SET ADDRESS OF CERTIFICATE-MASTER TO
 17185         DFHEIV20
 17186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17187
 17188
 17189     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17190     MOVE 'B'                    TO JP-RECORD-TYPE
 17191     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17192     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17193
 17194     IF INSURED-ADDR-PRESENT
 17195        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17196
 17197     IF CERT-NOTES-ARE-NOT-PRESENT
 17198        MOVE SPACE               TO WS-CERT-NOTE-SW
 17199     ELSE
 17200        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17201
 17202     IF CERT-ADDED-BATCH      OR
 17203        CERT-AND-CLAIM-ONLINE OR
 17204        CERT-WAS-CREATED-FOR-CLAIM
 17205        NEXT SENTENCE
 17206     ELSE
 17207        GO TO 2825-DELETE-CERTIFICATE.
 17208
 17209     PERFORM 8400-LOG-JOURNAL-RECORD.
 17210
 17211*********************************************************
 17212** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17213     IF CERT-ADDED-BATCH
 17214         GO TO 2822-REWRITE-ELCERT.
 17215*********************************************************
 17216
 17217     IF NO-CLAIM-ATTACHED
 17218        NEXT SENTENCE
 17219     ELSE
 17220        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17221        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17222
 17223 2822-REWRITE-ELCERT.
 17224     MOVE 'C'                    TO JP-RECORD-TYPE
 17225     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17226
 17227     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17228
 17229
 17230* EXEC CICS REWRITE
 17231*         DATASET    (FILE-ID-ELCERT)
 17232*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 313
* EL6311.cbl
 17233*    END-EXEC.
 17234     MOVE LENGTH OF
 17235      CERTIFICATE-MASTER
 17236       TO DFHEIV11
 17237*    MOVE '&& L                  %   #00014970' TO DFHEIV0
 17238     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17239     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17240     MOVE X'2020233030303134393730' TO DFHEIV0(25:11)
 17241     CALL 'kxdfhei1' USING DFHEIV0,
 17242           FILE-ID-ELCERT,
 17243           CERTIFICATE-MASTER,
 17244           DFHEIV11,
 17245           DFHEIV99
 17246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17247
 17248
 17249     PERFORM 8400-LOG-JOURNAL-RECORD.
 17250
 17251     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17252
 17253 2825-DELETE-CERTIFICATE.
 17254     MOVE 'D'                      TO JP-RECORD-TYPE.
 17255     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17256
 17257     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17258
 17259
 17260* EXEC CICS DELETE
 17261*         DATASET    (FILE-ID-ELCERT)
 17262*    END-EXEC.
 17263*    MOVE '&(                    &   #00014985' TO DFHEIV0
 17264     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17265     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17266     MOVE X'2020233030303134393835' TO DFHEIV0(25:11)
 17267     CALL 'kxdfhei1' USING DFHEIV0,
 17268           FILE-ID-ELCERT,
 17269           DFHEIV99,
 17270           DFHEIV99,
 17271           DFHEIV99,
 17272           DFHEIV99
 17273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17274
 17275
 17276     PERFORM 8400-LOG-JOURNAL-RECORD.
 17277
 17278******************************************************************
 17279*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17280******************************************************************
 17281
 17282     IF CERT-NOTES-ARE-PRESENT
 17283        NEXT SENTENCE
 17284     ELSE
 17285        GO TO 2827-DELETE-MAILING.
 17286
 17287
 17288* EXEC CICS HANDLE CONDITION
 17289*         NOTFND  (2827-DELETE-MAILING)
 17290*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 314
* EL6311.cbl
 17291*    MOVE '"$I                   ! @ #00015000' TO DFHEIV0
 17292     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17293     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17294     MOVE X'4020233030303135303030' TO DFHEIV0(25:11)
 17295     CALL 'kxdfhei1' USING DFHEIV0
 17296     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17297
 17298
 17299
 17300* EXEC CICS READ
 17301*        EQUAL
 17302*        DATASET   (FILE-ID-ERNOTE)
 17303*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17304*        RIDFLD    (ELCERT-KEY)
 17305*        UPDATE
 17306*    END-EXEC.
 17307*    MOVE '&"S        EU         (   #00015004' TO DFHEIV0
 17308     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17309     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17310     MOVE X'2020233030303135303034' TO DFHEIV0(25:11)
 17311     CALL 'kxdfhei1' USING DFHEIV0,
 17312           FILE-ID-ERNOTE,
 17313           DFHEIV20,
 17314           DFHEIV99,
 17315           ELCERT-KEY,
 17316           DFHEIV99,
 17317           DFHEIV99,
 17318           DFHEIV99
 17319     SET ADDRESS OF CERTIFICATE-NOTE TO
 17320         DFHEIV20
 17321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17322
 17323
 17324     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17325     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17326     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17327
 17328     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17329
 17330
 17331* EXEC CICS DELETE
 17332*        DATASET   (FILE-ID-ERNOTE)
 17333*    END-EXEC.
 17334*    MOVE '&(                    &   #00015018' TO DFHEIV0
 17335     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17336     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17337     MOVE X'2020233030303135303138' TO DFHEIV0(25:11)
 17338     CALL 'kxdfhei1' USING DFHEIV0,
 17339           FILE-ID-ERNOTE,
 17340           DFHEIV99,
 17341           DFHEIV99,
 17342           DFHEIV99,
 17343           DFHEIV99
 17344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17345
 17346
 17347     PERFORM 8400-LOG-JOURNAL-RECORD.
 17348
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 315
* EL6311.cbl
 17349******************************************************************
 17350*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17351******************************************************************
 17352
 17353 2827-DELETE-MAILING.
 17354     IF CERT-ADDRESS-PRESENT
 17355        NEXT SENTENCE
 17356     ELSE
 17357        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17358
 17359
 17360* EXEC CICS HANDLE CONDITION
 17361*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17362*    END-EXEC.
 17363*    MOVE '"$I                   ! A #00015034' TO DFHEIV0
 17364     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17365     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17366     MOVE X'4120233030303135303334' TO DFHEIV0(25:11)
 17367     CALL 'kxdfhei1' USING DFHEIV0
 17368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17369
 17370
 17371     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17372
 17373
 17374* EXEC CICS READ
 17375*        EQUAL
 17376*        DATASET   (FILE-ID-ERMAIL)
 17377*        SET       (ADDRESS OF MAILING-DATA)
 17378*        RIDFLD    (ERMAIL-KEY)
 17379*        UPDATE
 17380*    END-EXEC.
 17381*    MOVE '&"S        EU         (   #00015040' TO DFHEIV0
 17382     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17383     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17384     MOVE X'2020233030303135303430' TO DFHEIV0(25:11)
 17385     CALL 'kxdfhei1' USING DFHEIV0,
 17386           FILE-ID-ERMAIL,
 17387           DFHEIV20,
 17388           DFHEIV99,
 17389           ERMAIL-KEY,
 17390           DFHEIV99,
 17391           DFHEIV99,
 17392           DFHEIV99
 17393     SET ADDRESS OF MAILING-DATA TO
 17394         DFHEIV20
 17395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17396
 17397
 17398     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17399     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17400     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17401
 17402     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17403
 17404
 17405* EXEC CICS DELETE
 17406*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 316
* EL6311.cbl
 17407*    END-EXEC.
 17408*    MOVE '&(                    &   #00015054' TO DFHEIV0
 17409     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17410     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17411     MOVE X'2020233030303135303534' TO DFHEIV0(25:11)
 17412     CALL 'kxdfhei1' USING DFHEIV0,
 17413           FILE-ID-ERMAIL,
 17414           DFHEIV99,
 17415           DFHEIV99,
 17416           DFHEIV99,
 17417           DFHEIV99
 17418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17419
 17420
 17421     PERFORM 8400-LOG-JOURNAL-RECORD.
 17422
 17423 2830-BUILD-NEW-ISSUE-RECORD.
 17424     MOVE SPACES                 TO ELCERT-KEY.
 17425
 17426     IF  BCERTNOL GREATER THAN ZEROS
 17427         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17428
 17429     IF  BSUFIXL  GREATER THAN ZEROS
 17430         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17431
 17432     IF BEFFDTL GREATER THAN ZEROS
 17433        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17434
 17435 2870-WRITE-PENDING-BUSINESS.
 17436     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17437     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17438     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17439     MOVE '5'                    TO DC-OPTION-CODE.
 17440     PERFORM 9700-DATE-LINK.
 17441     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17442
 17443     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17444
 17445     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17446     MOVE 'A'                    TO JP-RECORD-TYPE.
 17447     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17448
 17449
 17450* EXEC CICS WRITE
 17451*        DATASET  (FILE-ID-ERPNDB)
 17452*        FROM     (PENDING-BUSINESS)
 17453*        RIDFLD   (PB-CONTROL-PRIMARY)
 17454*    END-EXEC.
 17455     MOVE LENGTH OF
 17456      PENDING-BUSINESS
 17457       TO DFHEIV11
 17458*    MOVE '&$ L                  ''   #00015086' TO DFHEIV0
 17459     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17460     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17461     MOVE X'2020233030303135303836' TO DFHEIV0(25:11)
 17462     CALL 'kxdfhei1' USING DFHEIV0,
 17463           FILE-ID-ERPNDB,
 17464           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 317
* EL6311.cbl
 17465           DFHEIV11,
 17466           PB-CONTROL-PRIMARY,
 17467           DFHEIV99,
 17468           DFHEIV99
 17469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17470
 17471
 17472     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17473
 17474     PERFORM 8400-LOG-JOURNAL-RECORD.
 17475
 17476     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17477
 17478 2885-RECORD-MISSING.
 17479     MOVE -1                     TO BMAINTL
 17480     MOVE AL-UABON               TO BMAINTA
 17481     MOVE ER-2902                TO EMI-ERROR.
 17482     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17483     GO TO 8200-SEND-DATAONLY.
 17484
 17485 2890-DUPLICATE-RECORD.
 17486     MOVE -1                     TO BMAINTL.
 17487     MOVE AL-UABON               TO BCERTNOA.
 17488     MOVE AL-UNBON               TO BEFFDTA.
 17489     MOVE SPACE                  TO BMAINTI.
 17490
 17491     MOVE 1                      TO EMI-SUB
 17492                                    EMI-SWITCH1
 17493                                    EMI-SWITCH-AREA-1
 17494                                    EMI-SWITCH-AREA-2.
 17495
 17496     MOVE SPACES                 TO EMI-ERROR-LINES.
 17497
 17498
 17499* EXEC CICS SYNCPOINT ROLLBACK
 17500*    END-EXEC.
 17501*    MOVE '6"R                   !   #00015118' TO DFHEIV0
 17502     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17504     MOVE X'2020233030303135313138' TO DFHEIV0(25:11)
 17505     CALL 'kxdfhei1' USING DFHEIV0
 17506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17507
 17508
 17509     MOVE ER-2247                TO EMI-ERROR.
 17510     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17511     GO TO 8200-SEND-DATAONLY.
 17512
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 318
* EL6311.cbl
 17514
 17515******************************************************************
 17516*                                                                *
 17517*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17518*                                                                *
 17519******************************************************************
 17520
 17521 2900-REWRITE-CAN-CERT-KEY.
 17522     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17523
 17524     IF  CCERTNOL GREATER THAN ZEROS
 17525         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17526
 17527     IF  CSUFIXL  GREATER THAN ZEROS
 17528         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17529
 17530     IF  CEFFDTL  GREATER THAN ZEROS
 17531         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17532
 17533 2910-READ-BY-ACCOUNT.
 17534
 17535* EXEC CICS HANDLE CONDITION
 17536*         NOTFND    (2920-PROCESS-REWRITE)
 17537*    END-EXEC.
 17538*    MOVE '"$I                   ! B #00015146' TO DFHEIV0
 17539     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17540     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17541     MOVE X'4220233030303135313436' TO DFHEIV0(25:11)
 17542     CALL 'kxdfhei1' USING DFHEIV0
 17543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17544
 17545
 17546
 17547* EXEC CICS READ
 17548*        SET     (ADDRESS OF PENDING-BUSINESS)
 17549*        DATASET (FILE-ID-ERPNDB2)
 17550*        RIDFLD  (ERPNDB-ALT-KEY)
 17551*    END-EXEC.
 17552*    MOVE '&"S        E          (   #00015150' TO DFHEIV0
 17553     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17554     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17555     MOVE X'2020233030303135313530' TO DFHEIV0(25:11)
 17556     CALL 'kxdfhei1' USING DFHEIV0,
 17557           FILE-ID-ERPNDB2,
 17558           DFHEIV20,
 17559           DFHEIV99,
 17560           ERPNDB-ALT-KEY,
 17561           DFHEIV99,
 17562           DFHEIV99,
 17563           DFHEIV99
 17564     SET ADDRESS OF PENDING-BUSINESS TO
 17565         DFHEIV20
 17566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17567
 17568
 17569     GO TO 2990-DUPLICATE-RECORD.
 17570
 17571  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 319
* EL6311.cbl
 17572
 17573* EXEC CICS HANDLE CONDITION
 17574*         NOTFND    (2985-RECORD-MISSING)
 17575*    END-EXEC.
 17576*    MOVE '"$I                   ! C #00015159' TO DFHEIV0
 17577     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17578     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17579     MOVE X'4320233030303135313539' TO DFHEIV0(25:11)
 17580     CALL 'kxdfhei1' USING DFHEIV0
 17581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17582
 17583
 17584     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17585
 17586
 17587* EXEC CICS READ
 17588*        SET     (ADDRESS OF PENDING-BUSINESS)
 17589*        DATASET (FILE-ID-ERPNDB)
 17590*        RIDFLD  (ERPNDB-KEY)
 17591*        UPDATE
 17592*    END-EXEC.
 17593*    MOVE '&"S        EU         (   #00015165' TO DFHEIV0
 17594     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17595     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17596     MOVE X'2020233030303135313635' TO DFHEIV0(25:11)
 17597     CALL 'kxdfhei1' USING DFHEIV0,
 17598           FILE-ID-ERPNDB,
 17599           DFHEIV20,
 17600           DFHEIV99,
 17601           ERPNDB-KEY,
 17602           DFHEIV99,
 17603           DFHEIV99,
 17604           DFHEIV99
 17605     SET ADDRESS OF PENDING-BUSINESS TO
 17606         DFHEIV20
 17607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17608
 17609
 17610     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17611     MOVE 'D'                    TO JP-RECORD-TYPE.
 17612     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17613     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17614
 17615     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17616
 17617     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17618     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17619     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17620
 17621
 17622* EXEC CICS DELETE
 17623*        DATASET    (FILE-ID-ERPNDB)
 17624*    END-EXEC.
 17625*    MOVE '&(                    &   #00015183' TO DFHEIV0
 17626     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17627     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17628     MOVE X'2020233030303135313833' TO DFHEIV0(25:11)
 17629     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 320
* EL6311.cbl
 17630           FILE-ID-ERPNDB,
 17631           DFHEIV99,
 17632           DFHEIV99,
 17633           DFHEIV99,
 17634           DFHEIV99
 17635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17636
 17637
 17638     PERFORM 8400-LOG-JOURNAL-RECORD.
 17639
 17640
 17641* EXEC CICS GETMAIN
 17642*        SET      (ADDRESS OF PENDING-BUSINESS)
 17643*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17644*        INITIMG  (GETMAIN-SPACE)
 17645*    END-EXEC.
 17646*    MOVE ',"IL                  $   #00015189' TO DFHEIV0
 17647     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17648     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17649     MOVE X'2020233030303135313839' TO DFHEIV0(25:11)
 17650     CALL 'kxdfhei1' USING DFHEIV0,
 17651           DFHEIV20,
 17652           ERPNDB-RECORD-LENGTH,
 17653           GETMAIN-SPACE
 17654     SET ADDRESS OF PENDING-BUSINESS TO
 17655         DFHEIV20
 17656     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17657
 17658
 17659     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17660
 17661 2950-PROCESS-CANCELS.
 17662
 17663
 17664* EXEC CICS HANDLE CONDITION
 17665*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17666*    END-EXEC.
 17667*    MOVE '"$I                   ! D #00015199' TO DFHEIV0
 17668     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17669     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17670     MOVE X'4420233030303135313939' TO DFHEIV0(25:11)
 17671     CALL 'kxdfhei1' USING DFHEIV0
 17672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17673
 17674
 17675
 17676* EXEC CICS READ
 17677*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17678*        DATASET (FILE-ID-ELCERT)
 17679*        RIDFLD  (ELCERT-KEY)
 17680*        UPDATE
 17681*    END-EXEC.
 17682*    MOVE '&"S        EU         (   #00015203' TO DFHEIV0
 17683     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17684     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17685     MOVE X'2020233030303135323033' TO DFHEIV0(25:11)
 17686     CALL 'kxdfhei1' USING DFHEIV0,
 17687           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 321
* EL6311.cbl
 17688           DFHEIV20,
 17689           DFHEIV99,
 17690           ELCERT-KEY,
 17691           DFHEIV99,
 17692           DFHEIV99,
 17693           DFHEIV99
 17694     SET ADDRESS OF CERTIFICATE-MASTER TO
 17695         DFHEIV20
 17696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17697
 17698
 17699     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17700
 17701     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17702     MOVE 'B'                      TO JP-RECORD-TYPE.
 17703     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17704     PERFORM 8400-LOG-JOURNAL-RECORD.
 17705
 17706     IF PB-CI-LIVES NOT NUMERIC
 17707         MOVE ZERO                    TO PB-CI-LIVES.
 17708
 17709     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17710        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17711        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17712        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17713                                         CM-LF-CANCEL-DT
 17714     ELSE
 17715        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17716        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17717        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17718        MOVE PB-CI-LIVES              TO CM-LIVES.
 17719
 17720     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17721        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17722            MOVE CM-LF-STATUS-AT-CANCEL
 17723                                     TO CM-LF-CURRENT-STATUS
 17724            MOVE SPACE
 17725                                     TO CM-LF-STATUS-AT-CANCEL
 17726        ELSE
 17727            MOVE PB-CI-LF-POLICY-STATUS
 17728                                     TO CM-LF-CURRENT-STATUS
 17729     ELSE
 17730        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17731
 17732     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17733        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17734        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17735        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17736                                         CM-AH-CANCEL-DT
 17737     ELSE
 17738        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17739        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17740        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17741        MOVE PB-CI-LIVES              TO CM-LIVES.
 17742
 17743     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17744        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17745            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 322
* EL6311.cbl
 17746                                     TO CM-AH-CURRENT-STATUS
 17747            MOVE SPACE
 17748                                     TO CM-AH-STATUS-AT-CANCEL
 17749        ELSE
 17750            MOVE PB-CI-AH-POLICY-STATUS
 17751                                     TO CM-AH-CURRENT-STATUS
 17752     ELSE
 17753        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17754
 17755 2975-REWRITE-CERT.
 17756     MOVE 'C'                      TO JP-RECORD-TYPE.
 17757     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17758
 17759
 17760* EXEC CICS REWRITE
 17761*        DATASET    (FILE-ID-ELCERT)
 17762*        FROM       (CERTIFICATE-MASTER)
 17763*    END-EXEC.
 17764     MOVE LENGTH OF
 17765      CERTIFICATE-MASTER
 17766       TO DFHEIV11
 17767*    MOVE '&& L                  %   #00015270' TO DFHEIV0
 17768     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17769     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17770     MOVE X'2020233030303135323730' TO DFHEIV0(25:11)
 17771     CALL 'kxdfhei1' USING DFHEIV0,
 17772           FILE-ID-ELCERT,
 17773           CERTIFICATE-MASTER,
 17774           DFHEIV11,
 17775           DFHEIV99
 17776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17777
 17778
 17779     PERFORM 8400-LOG-JOURNAL-RECORD.
 17780
 17781 2960-BUILD-NEW-CANCEL-RECORD.
 17782     IF  CCERTNOL GREATER THAN ZEROS
 17783         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17784
 17785     IF  CSUFIXL  GREATER THAN ZEROS
 17786         MOVE CSUFIXI             TO PB-CERT-SFX.
 17787
 17788     IF  CEFFDTL  GREATER  THAN ZEROS
 17789         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17790
 17791 2970-WRITE-PENDING-BUSINESS.
 17792     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17793     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17794     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17795     MOVE '5'                    TO DC-OPTION-CODE.
 17796     PERFORM 9700-DATE-LINK.
 17797     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17798
 17799     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17800
 17801     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17802                                    PB-CI-INSURED-SEX
 17803                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 323
* EL6311.cbl
 17804                                    PB-CI-AH-BENEFIT-CD
 17805                                    PB-CI-RATE-CLASS
 17806                                    PB-CI-RATE-DEV-LF
 17807                                    PB-CI-RATE-DEV-AH
 17808                                    PB-CI-LF-ABBR
 17809                                    PB-CI-AH-ABBR
 17810                                    PB-CI-OB-FLAG
 17811                                    PB-CI-LF-POLICY-STATUS
 17812                                    PB-CI-AH-POLICY-STATUS
 17813                                    PB-CI-INDV-GRP-CD
 17814                                    PB-CI-BENEFICIARY-NAME
 17815                                    PB-CI-NOTE-SW
 17816                                    PB-CI-SOC-SEC-NO
 17817                                    PB-CI-MEMBER-NO
 17818                                    PB-CI-INT-CODE
 17819                                    PB-CI-COMP-EXCP-SW
 17820                                    PB-CI-ENTRY-STATUS
 17821                                    PB-CI-CREDIT-INTERFACE-SW-1
 17822                                    PB-CI-CREDIT-INTERFACE-SW-2
 17823                                    PB-CI-ENTRY-BATCH.
 17824
 17825     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17826                                    PB-CI-AH-SETTLEMENT-DT
 17827                                    PB-CI-DEATH-DT
 17828                                    PB-CI-LF-PRIOR-CANCEL-DT
 17829                                    PB-CI-AH-PRIOR-CANCEL-DT
 17830                                    PB-CI-LOAN-1ST-PMT-DT
 17831                                    PB-CI-ENTRY-DT
 17832                                    PB-CI-LF-EXPIRE-DT
 17833                                    PB-CI-AH-EXPIRE-DT.
 17834
 17835     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17836                                    PB-CI-LF-TERM
 17837                                    PB-CI-LF-BENEFIT-AMT
 17838                                    PB-CI-LF-ALT-BENEFIT-AMT
 17839                                    PB-CI-LF-PREMIUM-AMT
 17840                                    PB-CI-LF-ALT-PREMIUM-AMT
 17841                                    PB-CI-AH-TERM
 17842                                    PB-CI-AH-BENEFIT-AMT
 17843                                    PB-CI-AH-PREMIUM-AMT
 17844                                    PB-CI-RATE-DEV-PCT-LF
 17845                                    PB-CI-RATE-DEV-PCT-AH
 17846                                    PB-CI-LIFE-COMMISSION
 17847                                    PB-CI-AH-COMMISSION
 17848                                    PB-CI-PAY-FREQUENCY
 17849                                    PB-CI-LOAN-APR
 17850                                    PB-CI-LOAN-TERM
 17851                                    PB-CI-CURR-SEQ
 17852                                    PB-CI-AH-CANCEL-AMT
 17853                                    PB-CI-LF-CANCEL-AMT
 17854                                    PB-CI-EXTENTION-DAYS
 17855                                    PB-CI-TERM-IN-DAYS
 17856                                    PB-CI-LOAN-OFFICER
 17857                                    PB-CI-LIVES
 17858                                    PB-CI-LF-CRIT-PER
 17859                                    PB-CI-AH-CRIT-PER
 17860                                    PB-C-LF-REM-TERM
 17861                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 324
* EL6311.cbl
 17862
 17863     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17864     MOVE 'A'                    TO JP-RECORD-TYPE.
 17865     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17866
 17867
 17868* EXEC CICS HANDLE CONDITION
 17869*        DUPREC   (2990-DUPLICATE-RECORD)
 17870*    END-EXEC.
 17871*    MOVE '"$%                   ! E #00015363' TO DFHEIV0
 17872     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17874     MOVE X'4520233030303135333633' TO DFHEIV0(25:11)
 17875     CALL 'kxdfhei1' USING DFHEIV0
 17876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17877
 17878
 17879
 17880* EXEC CICS WRITE
 17881*        DATASET  (FILE-ID-ERPNDB)
 17882*        FROM     (PENDING-BUSINESS)
 17883*        RIDFLD   (PB-CONTROL-PRIMARY)
 17884*    END-EXEC.
 17885     MOVE LENGTH OF
 17886      PENDING-BUSINESS
 17887       TO DFHEIV11
 17888*    MOVE '&$ L                  ''   #00015367' TO DFHEIV0
 17889     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17890     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17891     MOVE X'2020233030303135333637' TO DFHEIV0(25:11)
 17892     CALL 'kxdfhei1' USING DFHEIV0,
 17893           FILE-ID-ERPNDB,
 17894           PENDING-BUSINESS,
 17895           DFHEIV11,
 17896           PB-CONTROL-PRIMARY,
 17897           DFHEIV99,
 17898           DFHEIV99
 17899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17900
 17901
 17902     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17903
 17904     PERFORM 8400-LOG-JOURNAL-RECORD.
 17905
 17906     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17907
 17908 2985-RECORD-MISSING.
 17909     MOVE -1                     TO CMAINTL
 17910     MOVE AL-UABON               TO CMAINTA.
 17911
 17912     MOVE ER-2902                TO EMI-ERROR.
 17913     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17914     GO TO 8200-SEND-DATAONLY.
 17915
 17916 2990-DUPLICATE-RECORD.
 17917     MOVE SPACE                  TO CMAINTI.
 17918     MOVE -1                     TO CMAINTL.
 17919     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 325
* EL6311.cbl
 17920     MOVE AL-UNBON               TO CEFFDTA.
 17921
 17922     MOVE 1                      TO EMI-SUB
 17923                                    EMI-SWITCH1
 17924                                    EMI-SWITCH-AREA-1
 17925                                    EMI-SWITCH-AREA-2.
 17926     MOVE SPACES                 TO EMI-ERROR-LINES.
 17927
 17928
 17929* EXEC CICS SYNCPOINT ROLLBACK
 17930*    END-EXEC.
 17931*    MOVE '6"R                   !   #00015399' TO DFHEIV0
 17932     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17933     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17934     MOVE X'2020233030303135333939' TO DFHEIV0(25:11)
 17935     CALL 'kxdfhei1' USING DFHEIV0
 17936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17937
 17938
 17939     MOVE ER-2247                TO EMI-ERROR.
 17940     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17941     GO TO 8200-SEND-DATAONLY.
 17942
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 326
* EL6311.cbl
 17944
 17945***************************************************************
 17946*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17947*     PREMIUM FOR A SINGLE BATCH.                             *
 17948*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17949***************************************************************
 17950
 17951 3000-BATCH-MAINLINE.
 17952     IF PI-PREV-KEY NOT = SPACES
 17953         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17954     ELSE
 17955         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17956
 17957     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17958
 17959 3010-READNEXT.
 17960
 17961* EXEC CICS READ
 17962*         DATASET    (FILE-ID-ERPNDB)
 17963*         SET        (ADDRESS OF PENDING-BUSINESS)
 17964*         RIDFLD     (ERPNDB-KEY)
 17965*         GTEQ
 17966*    END-EXEC.
 17967*    MOVE '&"S        G          (   #00015423' TO DFHEIV0
 17968     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17969     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17970     MOVE X'2020233030303135343233' TO DFHEIV0(25:11)
 17971     CALL 'kxdfhei1' USING DFHEIV0,
 17972           FILE-ID-ERPNDB,
 17973           DFHEIV20,
 17974           DFHEIV99,
 17975           ERPNDB-KEY,
 17976           DFHEIV99,
 17977           DFHEIV99,
 17978           DFHEIV99
 17979     SET ADDRESS OF PENDING-BUSINESS TO
 17980         DFHEIV20
 17981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17982
 17983
 17984     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17985        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17986          GO TO 3030-END-BATCH.
 17987
 17988     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17989
 17990     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17991        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17992          GO TO 3020-BUMP-SEQ.
 17993
 17994     IF PB-ISSUE
 17995        ADD +1                   TO WS-ISS-TOTAL-CNT
 17996        IF PB-FATAL-ERRORS
 17997           ADD +1                      TO WS-ISS-FATAL-CNT
 17998           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17999           GO TO 3020-BUMP-SEQ
 18000        ELSE
 18001           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 327
* EL6311.cbl
 18002              ADD +1                      TO WS-ISS-FORCE-CNT
 18003              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18004              GO TO 3020-BUMP-SEQ
 18005           ELSE
 18006              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18007                 ADD +1                      TO WS-ISS-HOLD-CNT
 18008                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18009                 GO TO 3020-BUMP-SEQ
 18010              ELSE
 18011                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 18012                     THRU  3299-EXIT
 18013                 GO TO 3020-BUMP-SEQ.
 18014
 18015     IF PB-CANCELLATION
 18016        ADD +1                   TO WS-CAN-TOTAL-CNT
 18017        IF PB-FATAL-ERRORS
 18018           ADD +1                 TO WS-CAN-FATAL-CNT
 18019           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18020           GO TO 3020-BUMP-SEQ
 18021        ELSE
 18022           IF PB-UNFORCED-ERRORS
 18023              ADD +1                 TO WS-CAN-FORCE-CNT
 18024              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18025              GO TO 3020-BUMP-SEQ
 18026           ELSE
 18027              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18028                 ADD +1                 TO WS-CAN-HOLD-CNT
 18029                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18030                 GO TO 3020-BUMP-SEQ
 18031              ELSE
 18032                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18033                     THRU  3499-EXIT
 18034                 GO TO 3020-BUMP-SEQ.
 18035
 18036     IF PB-BATCH-TRAILER
 18037         GO TO 3030-END-BATCH.
 18038
 18039 3020-BUMP-SEQ.
 18040     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18041     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18042     GO TO 3010-READNEXT.
 18043
 18044 3030-END-BATCH.
 18045     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18046     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18047     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18048     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18049
 18050     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18051                                          - WS-ISS-FORCE-CNT
 18052                                          - WS-ISS-HOLD-CNT).
 18053
 18054     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18055     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18056
 18057     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18058     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18059     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 328
* EL6311.cbl
 18060     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18061     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18062                                          - WS-CAN-FORCE-CNT
 18063                                          - WS-CAN-HOLD-CNT).
 18064     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18065     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18066
 18067     COMPUTE WS-NET-TOTAL-CNT
 18068         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18069     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18070     COMPUTE WS-NET-FATAL-CNT
 18071         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18072     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18073     COMPUTE WS-NET-FORCE-CNT
 18074         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18075     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18076     COMPUTE WS-NET-HOLD-CNT
 18077         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18078     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18079
 18080     COMPUTE WS-NET-AVAIL-CNT
 18081          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18082                              - WS-ISS-FORCE-CNT
 18083                              - WS-ISS-HOLD-CNT)
 18084          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18085                              - WS-CAN-FORCE-CNT
 18086                              - WS-CAN-HOLD-CNT).
 18087     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18088
 18089     COMPUTE WS-NET-GOOD-PREM
 18090         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18091     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18092     COMPUTE WS-NET-BAD-PREM
 18093         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18094     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18095
 18096     MOVE 0000                   TO EMI-ERROR.
 18097     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18098     MOVE -1                     TO DPFENTRL.
 18099     GO TO 8200-SEND-DATAONLY.
 18100
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 329
* EL6311.cbl
 18102
 18103******************************************************************
 18104*                                                                *
 18105*           A D D    B A D   I S S U E   P R E M I U M           *
 18106*                                                                *
 18107******************************************************************
 18108
 18109 3100-ADD-BAD-ISSUE-PREM.
 18110     IF PB-OVERRIDE-LIFE
 18111       OR PB-OVERRIDE-BOTH
 18112           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18113           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18114       ELSE
 18115           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18116           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18117
 18118     IF PB-OVERRIDE-AH
 18119       OR PB-OVERRIDE-BOTH
 18120           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18121       ELSE
 18122           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18123
 18124 3199-EXIT.
 18125     EXIT.
 18126
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 330
* EL6311.cbl
 18128
 18129******************************************************************
 18130*                                                                *
 18131*       A D D   G O O D   I S S U E   P R E M I U M              *
 18132*                                                                *
 18133******************************************************************
 18134
 18135 3200-ADD-GOOD-ISSUE-PREM.
 18136     IF PB-OVERRIDE-LIFE
 18137       OR PB-OVERRIDE-BOTH
 18138           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18139           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18140       ELSE
 18141           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18142           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18143
 18144     IF PB-OVERRIDE-AH
 18145       OR PB-OVERRIDE-BOTH
 18146           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18147       ELSE
 18148           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18149
 18150 3299-EXIT.
 18151     EXIT.
 18152
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 331
* EL6311.cbl
 18154
 18155
 18156******************************************************************
 18157*                                                                *
 18158*        A D D   B A D   C A N C E L   P R E M I U M             *
 18159*                                                                *
 18160******************************************************************
 18161
 18162 3300-ADD-BAD-CANCEL-PREM.
 18163     IF PB-OVERRIDE-LIFE
 18164       OR PB-OVERRIDE-BOTH
 18165           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18166       ELSE
 18167           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18168
 18169     IF PB-OVERRIDE-AH
 18170       OR PB-OVERRIDE-BOTH
 18171           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18172       ELSE
 18173           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18174
 18175 3399-EXIT.
 18176     EXIT.
 18177
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 332
* EL6311.cbl
 18179
 18180******************************************************************
 18181*                                                                *
 18182*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18183*                                                                *
 18184******************************************************************
 18185
 18186 3400-ADD-GOOD-CANCEL-PREM.
 18187     IF PB-OVERRIDE-LIFE
 18188       OR PB-OVERRIDE-BOTH
 18189           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18190       ELSE
 18191           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18192
 18193     IF PB-OVERRIDE-AH
 18194       OR PB-OVERRIDE-BOTH
 18195           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18196       ELSE
 18197           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18198
 18199 3499-EXIT.
 18200     EXIT.
 18201
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 333
* EL6311.cbl
 18203
 18204******************************************************************
 18205*                                                                *
 18206*           E D I T   B A T C H   D A T A                        *
 18207*                                                                *
 18208******************************************************************
 18209
 18210 3500-EDIT-BATCH-DATA.
 18211     IF PI-PREV-KEY NOT = SPACES
 18212        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18213     ELSE
 18214        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18215
 18216     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18217     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18218
 18219
 18220* EXEC CICS HANDLE CONDITION
 18221*         NOTFND      (3590-NOT-FOUND)
 18222*    END-EXEC.
 18223*    MOVE '"$I                   ! F #00015665' TO DFHEIV0
 18224     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18225     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18226     MOVE X'4620233030303135363635' TO DFHEIV0(25:11)
 18227     CALL 'kxdfhei1' USING DFHEIV0
 18228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18229
 18230
 18231     IF DRISSL   GREATER THAN ZEROS OR
 18232        DRISSL   GREATER THAN ZEROS OR
 18233        DRLFPRML GREATER THAN ZEROS OR
 18234        DRAHPRML GREATER THAN ZEROS OR
 18235        DRCANCL  GREATER THAN ZEROS OR
 18236        DRLFRFDL GREATER THAN ZEROS OR
 18237        DRAHRFDL GREATER THAN ZEROS
 18238              NEXT SENTENCE
 18239          ELSE
 18240              MOVE ER-3224    TO EMI-ERROR
 18241              MOVE -1         TO DPFENTRL
 18242              MOVE AL-UNBON   TO DPFENTRA
 18243              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18244              GO TO 8200-SEND-DATAONLY.
 18245
 18246     IF NOT MODIFY-CAP
 18247         MOVE 'UPDATE'       TO SM-READ
 18248         PERFORM 9995-SECURITY-VIOLATION
 18249         MOVE ER-0070        TO EMI-ERROR
 18250         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18251         GO TO 8100-SEND-INITIAL-MAP.
 18252
 18253        IF DRISSL GREATER THAN ZEROS
 18254           MOVE AL-UNNON         TO DRISSA
 18255           MOVE DRISSI           TO DEEDIT-FIELD
 18256           PERFORM 8600-DEEDIT
 18257           IF DEEDIT-FIELD-V0  NUMERIC
 18258              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18259           ELSE
 18260              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 334
* EL6311.cbl
 18261              MOVE -1         TO DRISSL
 18262              MOVE AL-UNBON   TO DRISSA
 18263              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18264
 18265        IF DRLFPRML GREATER THAN ZEROS
 18266           MOVE AL-UNNON         TO DRLFPRMA
 18267
 18268* EXEC CICS BIF DEEDIT
 18269*              FIELD  (DRLFPRMI)
 18270*              LENGTH (11)
 18271*          END-EXEC
 18272     MOVE 11
 18273       TO DFHEIV11
 18274*    MOVE '@"L                   #   #00015705' TO DFHEIV0
 18275     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18276     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18277     MOVE X'2020233030303135373035' TO DFHEIV0(25:11)
 18278     CALL 'kxdfhei1' USING DFHEIV0,
 18279           DRLFPRMI,
 18280           DFHEIV11
 18281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18282           IF DRLFPRMI NUMERIC
 18283              MOVE DRLFPRMI   TO WS-DRLFPRM
 18284*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18285*          PERFORM 8600-DEEDIT
 18286*          IF DEEDIT-FIELD-V2  NUMERIC
 18287*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18288           ELSE
 18289              MOVE ER-2223    TO EMI-ERROR
 18290              MOVE -1         TO DRLFPRML
 18291              MOVE AL-UNBON   TO DRLFPRMA
 18292              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18293
 18294        IF DRAHPRML GREATER THAN ZEROS
 18295           MOVE AL-UNNON         TO DRAHPRMA
 18296
 18297* EXEC CICS BIF DEEDIT
 18298*              FIELD  (DRAHPRMI)
 18299*              LENGTH (11)
 18300*          END-EXEC
 18301     MOVE 11
 18302       TO DFHEIV11
 18303*    MOVE '@"L                   #   #00015723' TO DFHEIV0
 18304     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18305     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18306     MOVE X'2020233030303135373233' TO DFHEIV0(25:11)
 18307     CALL 'kxdfhei1' USING DFHEIV0,
 18308           DRAHPRMI,
 18309           DFHEIV11
 18310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18311           IF DRAHPRMI NUMERIC
 18312              MOVE DRAHPRMI   TO WS-DRAHPRM
 18313*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18314*          PERFORM 8600-DEEDIT
 18315*          IF DEEDIT-FIELD-V2  NUMERIC
 18316*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18317           ELSE
 18318              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 335
* EL6311.cbl
 18319              MOVE -1         TO DRAHPRML
 18320              MOVE AL-UNBON   TO DRAHPRMA
 18321              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18322
 18323        IF DRCANCL GREATER THAN ZEROS
 18324           MOVE AL-UNNON         TO DRCANCA
 18325           MOVE DRCANCI          TO DEEDIT-FIELD
 18326           PERFORM 8600-DEEDIT
 18327           IF DEEDIT-FIELD-V0  NUMERIC
 18328              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18329           ELSE
 18330              MOVE ER-2223    TO EMI-ERROR
 18331              MOVE -1         TO DRCANCL
 18332              MOVE AL-UNBON   TO DRCANCL
 18333              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18334
 18335        IF DRLFRFDL GREATER THAN ZEROS
 18336           MOVE AL-UNNON         TO DRLFRFDA
 18337
 18338* EXEC CICS BIF DEEDIT
 18339*              FIELD  (DRLFRFDI)
 18340*              LENGTH (11)
 18341*          END-EXEC
 18342     MOVE 11
 18343       TO DFHEIV11
 18344*    MOVE '@"L                   #   #00015753' TO DFHEIV0
 18345     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18346     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18347     MOVE X'2020233030303135373533' TO DFHEIV0(25:11)
 18348     CALL 'kxdfhei1' USING DFHEIV0,
 18349           DRLFRFDI,
 18350           DFHEIV11
 18351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18352           IF DRLFRFDI NUMERIC
 18353              MOVE DRLFRFDI   TO WS-DRLFRFD
 18354*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18355*          PERFORM 8600-DEEDIT
 18356*          IF DEEDIT-FIELD-V2  NUMERIC
 18357*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18358           ELSE
 18359              MOVE ER-2223    TO EMI-ERROR
 18360              MOVE -1         TO DRLFRFDL
 18361              MOVE AL-UNBON   TO DRLFRFDA
 18362              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18363
 18364        IF DRAHRFDL GREATER THAN ZEROS
 18365           MOVE AL-UNNON         TO DRAHRFDA
 18366
 18367* EXEC CICS BIF DEEDIT
 18368*              FIELD  (DRAHRFDI)
 18369*              LENGTH (11)
 18370*          END-EXEC
 18371     MOVE 11
 18372       TO DFHEIV11
 18373*    MOVE '@"L                   #   #00015771' TO DFHEIV0
 18374     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18375     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18376     MOVE X'2020233030303135373731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 336
* EL6311.cbl
 18377     CALL 'kxdfhei1' USING DFHEIV0,
 18378           DRAHRFDI,
 18379           DFHEIV11
 18380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18381           IF DRAHRFDI NUMERIC
 18382              MOVE DRAHRFDI   TO WS-DRAHRFD
 18383*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18384*          PERFORM 8600-DEEDIT
 18385*          IF DEEDIT-FIELD-V2  NUMERIC
 18386*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18387           ELSE
 18388              MOVE ER-2223    TO EMI-ERROR
 18389              MOVE -1         TO DRAHRFDL
 18390              MOVE AL-UNBON   TO DRAHRFDA
 18391              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18392
 18393     IF EMI-ERROR = ZEROS
 18394        GO 3600-UPDATE-BATCH-HEADER.
 18395
 18396     GO TO 8200-SEND-DATAONLY.
 18397
 18398 3590-NOT-FOUND.
 18399     MOVE ER-2192                TO EMI-ERROR.
 18400     MOVE -1                     TO DPFENTRL.
 18401     MOVE AL-UNBON               TO DPFENTRA.
 18402     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18403     GO TO 8200-SEND-DATAONLY.
 18404
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 337
* EL6311.cbl
 18406
 18407******************************************************************
 18408*                                                                *
 18409*           U P D A T E   B A T C H   H E A D E R                *
 18410*                                                                *
 18411******************************************************************
 18412
 18413 3600-UPDATE-BATCH-HEADER.
 18414
 18415* EXEC CICS HANDLE CONDITION
 18416*         NOTFND      (3690-NOT-FOUND)
 18417*    END-EXEC.
 18418*    MOVE '"$I                   ! G #00015808' TO DFHEIV0
 18419     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18421     MOVE X'4720233030303135383038' TO DFHEIV0(25:11)
 18422     CALL 'kxdfhei1' USING DFHEIV0
 18423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18424
 18425
 18426
 18427* EXEC CICS READ
 18428*        DATASET (FILE-ID-ERPNDB)
 18429*        RIDFLD  (ERPNDB-KEY)
 18430*        SET     (ADDRESS OF PENDING-BUSINESS)
 18431*        UPDATE
 18432*    END-EXEC.
 18433*    MOVE '&"S        EU         (   #00015812' TO DFHEIV0
 18434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18435     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18436     MOVE X'2020233030303135383132' TO DFHEIV0(25:11)
 18437     CALL 'kxdfhei1' USING DFHEIV0,
 18438           FILE-ID-ERPNDB,
 18439           DFHEIV20,
 18440           DFHEIV99,
 18441           ERPNDB-KEY,
 18442           DFHEIV99,
 18443           DFHEIV99,
 18444           DFHEIV99
 18445     SET ADDRESS OF PENDING-BUSINESS TO
 18446         DFHEIV20
 18447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18448
 18449
 18450     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18451     MOVE 'B'                    TO JP-RECORD-TYPE.
 18452     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18453
 18454     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18455
 18456     PERFORM 8400-LOG-JOURNAL-RECORD.
 18457
 18458     IF DRISSL GREATER THAN ZEROS
 18459        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18460
 18461     IF DRCANCL GREATER THAN ZEROS
 18462        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18463
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 338
* EL6311.cbl
 18464
 18465     IF DRLFPRML GREATER THAN ZEROS
 18466        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18467
 18468     IF DRAHPRML GREATER THAN ZEROS
 18469        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18470
 18471     IF DRLFRFDL GREATER THAN ZEROS
 18472        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18473
 18474     IF DRAHRFDL GREATER THAN ZEROS
 18475        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18476
 18477 3670-REWRITE-BATCH-HEADER.
 18478     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18479        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18480        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18481        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18482        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18483        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18484        MOVE SPACE               TO PB-OUT-BAL-CD
 18485     ELSE
 18486        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18487
 18488     MOVE 'C'                    TO JP-RECORD-TYPE.
 18489     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18490
 18491
 18492* EXEC CICS REWRITE
 18493*         DATASET      (FILE-ID-ERPNDB)
 18494*         FROM         (PENDING-BUSINESS)
 18495*    END-EXEC.
 18496     MOVE LENGTH OF
 18497      PENDING-BUSINESS
 18498       TO DFHEIV11
 18499*    MOVE '&& L                  %   #00015860' TO DFHEIV0
 18500     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18501     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18502     MOVE X'2020233030303135383630' TO DFHEIV0(25:11)
 18503     CALL 'kxdfhei1' USING DFHEIV0,
 18504           FILE-ID-ERPNDB,
 18505           PENDING-BUSINESS,
 18506           DFHEIV11,
 18507           DFHEIV99
 18508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18509
 18510
 18511     PERFORM 8400-LOG-JOURNAL-RECORD.
 18512
 18513     GO TO 7200-DISPLAY-BATCHES.
 18514
 18515 3690-NOT-FOUND.
 18516     MOVE ER-2192                TO EMI-ERROR.
 18517     MOVE -1                     TO DPFENTRL.
 18518     MOVE AL-UNBON               TO DPFENTRA.
 18519     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18520     GO TO 8200-SEND-DATAONLY.
 18521
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 339
* EL6311.cbl
 18523
 18524******************************************************************
 18525*                                                                *
 18526*           R E - D I S P L A Y   R E C O R D                    *
 18527*                                                                *
 18528******************************************************************
 18529
 18530 3900-RE-DISPLAY-RECORD.
 18531
 18532* EXEC CICS HANDLE CONDITION
 18533*         NOTFND   (3990-NOT-FOUND)
 18534*    END-EXEC.
 18535*    MOVE '"$I                   ! H #00015885' TO DFHEIV0
 18536     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18538     MOVE X'4820233030303135383835' TO DFHEIV0(25:11)
 18539     CALL 'kxdfhei1' USING DFHEIV0
 18540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18541
 18542
 18543     IF PI-DISPLAY-ORIGINAL-BATCH
 18544         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18545     ELSE
 18546         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18547
 18548
 18549* EXEC CICS READ
 18550*         DATASET   (FILE-ID)
 18551*         RIDFLD    (PI-PREV-KEY)
 18552*         SET       (ADDRESS OF PENDING-BUSINESS)
 18553*    END-EXEC.
 18554*    MOVE '&"S        E          (   #00015894' TO DFHEIV0
 18555     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18557     MOVE X'2020233030303135383934' TO DFHEIV0(25:11)
 18558     CALL 'kxdfhei1' USING DFHEIV0,
 18559           FILE-ID,
 18560           DFHEIV20,
 18561           DFHEIV99,
 18562           PI-PREV-KEY,
 18563           DFHEIV99,
 18564           DFHEIV99,
 18565           DFHEIV99
 18566     SET ADDRESS OF PENDING-BUSINESS TO
 18567         DFHEIV20
 18568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18569
 18570
 18571     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18572
 18573     IF PB-ISSUE
 18574         GO TO 7000-DISPLAY-ISSUES.
 18575
 18576     IF PB-CANCELLATION
 18577         GO TO 7100-DISPLAY-CANCELS.
 18578
 18579     IF PB-BATCH-TRAILER
 18580         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 340
* EL6311.cbl
 18581
 18582 3990-NOT-FOUND.
 18583     MOVE LOW-VALUES             TO EL631BI.
 18584
 18585     IF PI-MAP-NAME = EL631B
 18586         MOVE -1                  TO BMAINTL
 18587     ELSE
 18588         MOVE -1                  TO CMAINTL.
 18589
 18590     GO TO 8100-SEND-INITIAL-MAP.
 18591
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 341
* EL6311.cbl
 18593
 18594***************************************************************
 18595*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18596*                                                             *
 18597*      1. START BROWSE WITH                                   *
 18598*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18599*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18600*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18601*                                                             *
 18602*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18603*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18604*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18605*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18606*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18607*               AND IS IT TO BE DISPLAYED.                    *
 18608*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18609*               DISPLAYED.                                    *
 18610*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18611*               DISPLAYED.                                    *
 18612*                                                             *
 18613*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18614*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18615***************************************************************
 18616
 18617 4000-BROWSE-DETAIL-FORWARD.
 18618     IF FIRST-TIME
 18619        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18620     ELSE
 18621        IF SHOW-RECORD
 18622           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18623           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18624           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18625           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18626           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18627        ELSE
 18628           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18629
 18630
 18631* EXEC CICS HANDLE CONDITION
 18632*         NOTFND   (4050-END-RECORDS)
 18633*         ENDFILE  (4050-END-RECORDS)
 18634*    END-EXEC.
 18635*    MOVE '"$I''                  ! I #00015959' TO DFHEIV0
 18636     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18638     MOVE X'4920233030303135393539' TO DFHEIV0(25:11)
 18639     CALL 'kxdfhei1' USING DFHEIV0
 18640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18641
 18642
 18643
 18644* EXEC CICS STARTBR
 18645*         DATASET   (FILE-ID-ERPNDB2)
 18646*         RIDFLD    (ERPNDB-ALT-KEY)
 18647*    END-EXEC.
 18648     MOVE 0
 18649       TO DFHEIV11
 18650*    MOVE '&,         G          &   #00015964' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 342
* EL6311.cbl
 18651     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18652     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18653     MOVE X'2020233030303135393634' TO DFHEIV0(25:11)
 18654     CALL 'kxdfhei1' USING DFHEIV0,
 18655           FILE-ID-ERPNDB2,
 18656           ERPNDB-ALT-KEY,
 18657           DFHEIV99,
 18658           DFHEIV11,
 18659           DFHEIV99
 18660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18661
 18662
 18663     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18664
 18665     IF FIRST-TIME OR SHOW-RECORD
 18666        MOVE SPACE               TO WS-FIRST-TIME-SW
 18667        GO TO 4005-READ-NEXT-RECORD.
 18668
 18669
 18670* EXEC CICS READNEXT
 18671*         DATASET    (FILE-ID-ERPNDB2)
 18672*         SET        (ADDRESS OF PENDING-BUSINESS)
 18673*         RIDFLD     (ERPNDB-ALT-KEY)
 18674*    END-EXEC.
 18675     MOVE 0
 18676       TO DFHEIV11
 18677*    MOVE '&.S                   )   #00015975' TO DFHEIV0
 18678     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18679     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18680     MOVE X'2020233030303135393735' TO DFHEIV0(25:11)
 18681     CALL 'kxdfhei1' USING DFHEIV0,
 18682           FILE-ID-ERPNDB2,
 18683           DFHEIV20,
 18684           DFHEIV99,
 18685           ERPNDB-ALT-KEY,
 18686           DFHEIV99,
 18687           DFHEIV11,
 18688           DFHEIV99,
 18689           DFHEIV99
 18690     SET ADDRESS OF PENDING-BUSINESS TO
 18691         DFHEIV20
 18692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18693
 18694
 18695 4005-READ-NEXT-RECORD.
 18696
 18697* EXEC CICS READNEXT
 18698*         DATASET    (FILE-ID-ERPNDB2)
 18699*         SET        (ADDRESS OF PENDING-BUSINESS)
 18700*         RIDFLD     (ERPNDB-ALT-KEY)
 18701*    END-EXEC.
 18702     MOVE 0
 18703       TO DFHEIV11
 18704*    MOVE '&.S                   )   #00015982' TO DFHEIV0
 18705     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18706     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18707     MOVE X'2020233030303135393832' TO DFHEIV0(25:11)
 18708     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 343
* EL6311.cbl
 18709           FILE-ID-ERPNDB2,
 18710           DFHEIV20,
 18711           DFHEIV99,
 18712           ERPNDB-ALT-KEY,
 18713           DFHEIV99,
 18714           DFHEIV11,
 18715           DFHEIV99,
 18716           DFHEIV99
 18717     SET ADDRESS OF PENDING-BUSINESS TO
 18718         DFHEIV20
 18719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18720
 18721
 18722     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18723
 18724     IF WS-BATCH-PREFIX = '#CL'
 18725        GO TO 4005-READ-NEXT-RECORD.
 18726
 18727     IF SHOW-RECORD
 18728        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18729           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18730           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18731           PB-STATE         NOT = PI-PB-STATE          OR
 18732           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18733           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18734           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18735           GO TO 4050-END-RECORDS
 18736        ELSE
 18737           GO TO 4010-CHECK-REC-TYPE.
 18738
 18739     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18740        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18741        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18742        PB-STATE            NOT = PI-PB-STATE          OR
 18743        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18744        GO TO 4050-END-RECORDS.
 18745
 18746     IF PB-BATCH-TRAILER
 18747        GO TO 4005-READ-NEXT-RECORD.
 18748
 18749     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18750        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18751           GO TO 4005-READ-NEXT-RECORD
 18752        ELSE
 18753           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18754              GO TO 4010-CHECK-REC-TYPE
 18755           ELSE
 18756              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18757                 GO TO 4010-CHECK-REC-TYPE
 18758              ELSE
 18759                 GO TO 4005-READ-NEXT-RECORD.
 18760
 18761     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18762        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18763           GO TO 4005-READ-NEXT-RECORD.
 18764
 18765 4010-CHECK-REC-TYPE.
 18766     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 344
* EL6311.cbl
 18767         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18768             NEXT SENTENCE
 18769         ELSE
 18770             GO TO 4005-READ-NEXT-RECORD.
 18771
 18772     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18773         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18774             NEXT SENTENCE
 18775        ELSE
 18776             GO TO 4005-READ-NEXT-RECORD.
 18777
 18778     IF NOT DISPLAY-CHANGE-RECORDS AND
 18779            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18780        GO TO 4005-READ-NEXT-RECORD.
 18781
 18782     IF DISPLAY-HOLD-RECORDS AND
 18783        NOT PB-RECORD-ON-HOLD
 18784          GO TO 4005-READ-NEXT-RECORD.
 18785
 18786     IF PB-ISSUE
 18787        IF DISPLAY-CHK-REQ-RECORDS
 18788            GO TO 4005-READ-NEXT-RECORD.
 18789
 18790     IF PB-ISSUE
 18791        IF ISSUE-WITH-WARNING
 18792           IF PB-WARNING-ERRORS
 18793              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18794                  GO TO 4005-READ-NEXT-RECORD
 18795              ELSE
 18796                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18797                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18798                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18799                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18800                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18801                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18802                 GO TO 7000-DISPLAY-ISSUES
 18803           ELSE
 18804              GO TO 4005-READ-NEXT-RECORD.
 18805
 18806     IF PB-ISSUE
 18807        IF (ISSUES-IN-ERROR AND
 18808            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18809            ALL-ISSUES
 18810            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18811            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18812            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18813            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18814            MOVE PB-SV-STATE            TO PI-SV-STATE
 18815            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18816            GO TO 7000-DISPLAY-ISSUES
 18817        ELSE
 18818            GO TO 4005-READ-NEXT-RECORD.
 18819
 18820     IF PB-CANCELLATION
 18821        IF DISPLAY-CHK-REQ-RECORDS
 18822           IF PB-C-REFUND-REQUESTED
 18823              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18824              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 345
* EL6311.cbl
 18825              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18826              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18827              MOVE PB-SV-STATE            TO PI-SV-STATE
 18828              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18829              GO TO 7100-DISPLAY-CANCELS
 18830           ELSE
 18831               GO TO 4005-READ-NEXT-RECORD.
 18832
 18833     IF PB-CANCELLATION
 18834        IF CANCEL-WITH-WARNING
 18835           IF PB-WARNING-ERRORS
 18836              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18837                  GO TO 4005-READ-NEXT-RECORD
 18838              ELSE
 18839                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18840                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18841                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18842                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18843                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18844                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18845                 GO TO 7100-DISPLAY-CANCELS
 18846           ELSE
 18847              GO TO 4005-READ-NEXT-RECORD.
 18848
 18849     IF PB-CANCELLATION
 18850        IF (CANCEL-IN-ERROR  AND
 18851            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18852            ALL-CANCELS
 18853            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18854            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18855            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18856            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18857            MOVE PB-SV-STATE            TO PI-SV-STATE
 18858            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18859            GO TO 7100-DISPLAY-CANCELS.
 18860
 18861     GO TO 4005-READ-NEXT-RECORD.
 18862
 18863 4050-END-RECORDS.
 18864******************************************************************
 18865*                                                                *
 18866*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18867*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18868*         PROGRAM.                                               *
 18869*                                                                *
 18870******************************************************************
 18871
 18872     IF BROWSE-STARTED
 18873        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18874
 18875* EXEC CICS ENDBR
 18876*            DATASET  (FILE-ID-ERPNDB2)
 18877*       END-EXEC.
 18878     MOVE 0
 18879       TO DFHEIV11
 18880*    MOVE '&2                    $   #00016140' TO DFHEIV0
 18881     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18882     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 346
* EL6311.cbl
 18883     MOVE X'2020233030303136313430' TO DFHEIV0(25:11)
 18884     CALL 'kxdfhei1' USING DFHEIV0,
 18885           FILE-ID-ERPNDB2,
 18886           DFHEIV11,
 18887           DFHEIV99
 18888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18889
 18890
 18891     IF  EIBTRNID NOT = TRANS-EXB1
 18892         IF PENDING-BUS-RECS-FOUND
 18893             NEXT SENTENCE
 18894           ELSE
 18895             MOVE '9'            TO PI-BROWSE-SW
 18896             GO TO 9400-CLEAR.
 18897
 18898     IF SHOW-RECORD
 18899        MOVE ER-2253            TO EMI-ERROR
 18900       ELSE
 18901        MOVE ER-2254            TO EMI-ERROR.
 18902
 18903     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18904
 18905     IF PI-MAP-NAME = SPACES
 18906        MOVE -1                  TO DPFENTRL
 18907        MOVE EL631D               TO PI-MAP-NAME
 18908        GO TO 8100-SEND-INITIAL-MAP.
 18909
 18910     IF PI-MAP-NAME = EL631B
 18911        MOVE -1                  TO BMAINTL
 18912     ELSE
 18913        IF PI-MAP-NAME = EL631C
 18914           MOVE -1               TO CMAINTL
 18915        ELSE
 18916           MOVE -1               TO DPFENTRL.
 18917
 18918     GO TO 8200-SEND-DATAONLY.
 18919
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 347
* EL6311.cbl
 18921
 18922***************************************************************
 18923*                                                             *
 18924*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18925*                                                             *
 18926*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18927*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18928*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18929*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18930*                                                             *
 18931*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18932*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18933*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18934*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18935*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18936*                AND IS IT TO BE DISPLAYED.                   *
 18937*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18938*                DISPLAYED.                                   *
 18939*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18940*                DISPLAYED.                                   *
 18941*                                                             *
 18942*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18943*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18944*                                                             *
 18945*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18946*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18947*                THEY ARE NOT TO BE DISPLAYED.                *
 18948*                                                             *
 18949***************************************************************
 18950
 18951 4100-BROWSE-PRIMARY-FORWARD.
 18952     IF FIRST-TIME  OR SHOW-RECORD
 18953        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18954        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18955        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18956     ELSE
 18957        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18958        IF ERPNDB-BATCH-SEQ-NO = +9999
 18959           GO TO 4150-END-BATCH
 18960        ELSE
 18961           IF DISPLAY-CHANGE-RECORDS
 18962              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18963           ELSE
 18964              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18965              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18966
 18967     IF FIRST-TIME
 18968         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18969            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18970              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18971
 18972
 18973* EXEC CICS HANDLE CONDITION
 18974*         ENDFILE  (4150-END-BATCH)
 18975*    END-EXEC.
 18976*    MOVE '"$''                   ! J #00016225' TO DFHEIV0
 18977     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18978     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 348
* EL6311.cbl
 18979     MOVE X'4A20233030303136323235' TO DFHEIV0(25:11)
 18980     CALL 'kxdfhei1' USING DFHEIV0
 18981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18982
 18983
 18984 4105-READ-NEXT.
 18985
 18986* EXEC CICS HANDLE CONDITION
 18987*         NOTFND    (4150-END-BATCH)
 18988*    END-EXEC.
 18989*    MOVE '"$I                   ! K #00016230' TO DFHEIV0
 18990     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18992     MOVE X'4B20233030303136323330' TO DFHEIV0(25:11)
 18993     CALL 'kxdfhei1' USING DFHEIV0
 18994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18995
 18996
 18997     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18998
 18999     IF PI-DISPLAY-ORIGINAL-BATCH
 19000        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19001     ELSE
 19002        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19003
 19004
 19005* EXEC CICS READ
 19006*         DATASET   (FILE-ID)
 19007*         SET       (ADDRESS OF PENDING-BUSINESS)
 19008*         RIDFLD    (ERPNDB-KEY)
 19009*         GTEQ
 19010*    END-EXEC.
 19011*    MOVE '&"S        G          (   #00016241' TO DFHEIV0
 19012     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19013     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19014     MOVE X'2020233030303136323431' TO DFHEIV0(25:11)
 19015     CALL 'kxdfhei1' USING DFHEIV0,
 19016           FILE-ID,
 19017           DFHEIV20,
 19018           DFHEIV99,
 19019           ERPNDB-KEY,
 19020           DFHEIV99,
 19021           DFHEIV99,
 19022           DFHEIV99
 19023     SET ADDRESS OF PENDING-BUSINESS TO
 19024         DFHEIV20
 19025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19026
 19027
 19028     IF PI-DISPLAY-ORIGINAL-BATCH
 19029        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19030           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19031           GO TO 4150-END-BATCH
 19032        ELSE
 19033           IF PB-BATCH-TRAILER
 19034              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19035              GO TO 4105-READ-NEXT
 19036           ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 349
* EL6311.cbl
 19037              NEXT SENTENCE
 19038     ELSE
 19039        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19040           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19041           GO TO 4150-END-BATCH.
 19042
 19043     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19044
 19045     IF WS-BATCH-PREFIX = '#CL'
 19046         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19047         GO TO 4105-READ-NEXT.
 19048
 19049     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19050     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19051     MOVE PB-STATE               TO PI-PB-STATE.
 19052     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19053
 19054     IF PB-BATCH-TRAILER
 19055        IF SHOW-RECORD
 19056           GO TO 4150-END-BATCH
 19057        ELSE
 19058           MOVE ER-2251         TO EMI-ERROR
 19059           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19060           MOVE 1               TO PI-BROWSE-TYPE
 19061           GO TO 7200-DISPLAY-BATCHES.
 19062
 19063     IF SHOW-RECORD
 19064           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19065              GO TO 4110-BUMP-SEQ
 19066           ELSE
 19067              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19068                 GO TO 4110-BUMP-SEQ
 19069              ELSE
 19070                 GO TO 4107-CHECK-REC-TYPE.
 19071
 19072     IF NOT  PI-PRIMARY-WITH-SELECT
 19073        GO TO 4107-CHECK-REC-TYPE.
 19074
 19075     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19076        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19077           GO TO 4110-BUMP-SEQ
 19078        ELSE
 19079           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19080              GO TO 4107-CHECK-REC-TYPE
 19081           ELSE
 19082              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19083                 GO TO 4107-CHECK-REC-TYPE
 19084              ELSE
 19085                 GO TO 4110-BUMP-SEQ.
 19086
 19087     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19088        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19089           GO TO 4110-BUMP-SEQ.
 19090
 19091 4107-CHECK-REC-TYPE.
 19092     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19093         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19094             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 350
* EL6311.cbl
 19095           ELSE
 19096             GO TO 4110-BUMP-SEQ.
 19097
 19098     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19099         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19100             NEXT SENTENCE
 19101           ELSE
 19102             GO TO 4110-BUMP-SEQ.
 19103
 19104     IF NOT DISPLAY-CHANGE-RECORDS AND
 19105        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19106           GO TO 4110-BUMP-SEQ.
 19107
 19108     IF DISPLAY-HOLD-RECORDS AND
 19109        NOT PB-RECORD-ON-HOLD
 19110          GO TO 4110-BUMP-SEQ.
 19111
 19112     IF PB-ISSUE
 19113        IF DISPLAY-CHK-REQ-RECORDS
 19114            GO TO 4110-BUMP-SEQ.
 19115
 19116     IF PB-ISSUE
 19117        IF ISSUE-WITH-WARNING
 19118           IF PB-WARNING-ERRORS
 19119              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19120                  GO TO 4110-BUMP-SEQ
 19121              ELSE
 19122                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19123                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19124                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19125                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19126                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19127                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19128                 GO TO 7000-DISPLAY-ISSUES
 19129        ELSE
 19130            GO TO 4110-BUMP-SEQ.
 19131
 19132     IF PB-ISSUE
 19133        IF (ISSUES-IN-ERROR AND
 19134            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19135            ALL-ISSUES
 19136            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19137            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19138            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19139            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19140            MOVE PB-SV-STATE            TO PI-SV-STATE
 19141            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19142            GO TO 7000-DISPLAY-ISSUES
 19143        ELSE
 19144            GO TO 4110-BUMP-SEQ.
 19145
 19146     IF PB-CANCELLATION
 19147        IF DISPLAY-CHK-REQ-RECORDS
 19148           IF PB-C-REFUND-REQUESTED
 19149              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19150              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19151              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19152              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 351
* EL6311.cbl
 19153              MOVE PB-SV-STATE            TO PI-SV-STATE
 19154              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19155              GO TO 7100-DISPLAY-CANCELS
 19156           ELSE
 19157              GO TO 4110-BUMP-SEQ.
 19158
 19159     IF PB-CANCELLATION
 19160        IF CANCEL-WITH-WARNING
 19161           IF PB-WARNING-ERRORS
 19162              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19163                  GO TO 4110-BUMP-SEQ
 19164              ELSE
 19165                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19166                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19167                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19168                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19169                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19170                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19171                 GO TO 7100-DISPLAY-CANCELS
 19172           ELSE
 19173              GO TO 4110-BUMP-SEQ.
 19174
 19175     IF PB-CANCELLATION
 19176        IF (CANCEL-IN-ERROR  AND
 19177            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19178            ALL-CANCELS
 19179            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19180            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19181            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19182            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19183            MOVE PB-SV-STATE            TO PI-SV-STATE
 19184            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19185            GO TO 7100-DISPLAY-CANCELS.
 19186
 19187 4110-BUMP-SEQ.
 19188     IF NOT DISPLAY-CHANGE-RECORDS
 19189        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19190        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19191     ELSE
 19192        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19193           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19194           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19195        ELSE
 19196           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19197           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19198
 19199     GO TO 4105-READ-NEXT.
 19200
 19201 4150-END-BATCH.
 19202******************************************************************
 19203*                                                                *
 19204*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19205*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19206*         PROGRAM.                                               *
 19207*                                                                *
 19208******************************************************************
 19209
 19210     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 352
* EL6311.cbl
 19211         IF PENDING-BUS-RECS-FOUND
 19212             NEXT SENTENCE
 19213           ELSE
 19214             MOVE '9'            TO PI-BROWSE-SW
 19215             GO TO 9400-CLEAR.
 19216
 19217     IF SHOW-RECORD
 19218        MOVE ER-2253             TO EMI-ERROR
 19219     ELSE
 19220        MOVE ER-2251             TO EMI-ERROR.
 19221
 19222     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19223
 19224     IF PI-MAP-NAME = SPACES
 19225        MOVE -1                  TO BMAINTL
 19226        MOVE EL631B              TO PI-MAP-NAME
 19227        GO TO 8100-SEND-INITIAL-MAP.
 19228
 19229     IF PI-MAP-NAME = EL631B
 19230        MOVE -1                  TO BMAINTL
 19231     ELSE
 19232        IF PI-MAP-NAME = EL631C
 19233           MOVE -1               TO CMAINTL
 19234        ELSE
 19235           MOVE -1               TO DPFENTRL.
 19236
 19237     GO TO 8200-SEND-DATAONLY.
 19238
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 353
* EL6311.cbl
 19240
 19241***************************************************************
 19242*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19243*                                                             *
 19244*      1. START BROWSE WITH                                   *
 19245*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19246*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19247*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19248*                                                             *
 19249*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19250*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19251*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19252*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19253*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19254*               AND IS IT TO BE DISPLAYED.                    *
 19255*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19256*               DISPLAYED.                                    *
 19257*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19258*               DISPLAYED.                                    *
 19259*                                                             *
 19260*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19261*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19262***************************************************************
 19263
 19264 4200-BROWSE-CSR-FORWARD.
 19265
 19266     IF FIRST-TIME
 19267        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19268     ELSE
 19269        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19270
 19271
 19272* EXEC CICS HANDLE CONDITION
 19273*         NOTFND   (4250-END-RECORDS)
 19274*         ENDFILE  (4250-END-RECORDS)
 19275*    END-EXEC.
 19276*    MOVE '"$I''                  ! L #00016491' TO DFHEIV0
 19277     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19278     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19279     MOVE X'4C20233030303136343931' TO DFHEIV0(25:11)
 19280     CALL 'kxdfhei1' USING DFHEIV0
 19281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19282
 19283
 19284
 19285* EXEC CICS STARTBR
 19286*         DATASET   (FILE-ID-ERPNDB4)
 19287*         RIDFLD    (ERPNDB-CSR-KEY)
 19288*    END-EXEC.
 19289     MOVE 0
 19290       TO DFHEIV11
 19291*    MOVE '&,         G          &   #00016496' TO DFHEIV0
 19292     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19293     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19294     MOVE X'2020233030303136343936' TO DFHEIV0(25:11)
 19295     CALL 'kxdfhei1' USING DFHEIV0,
 19296           FILE-ID-ERPNDB4,
 19297           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 354
* EL6311.cbl
 19298           DFHEIV99,
 19299           DFHEIV11,
 19300           DFHEIV99
 19301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19302
 19303
 19304     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19305
 19306     IF FIRST-TIME
 19307        MOVE SPACE               TO WS-FIRST-TIME-SW
 19308        GO TO 4205-READ-NEXT-RECORD.
 19309
 19310
 19311* EXEC CICS READNEXT
 19312*         DATASET    (FILE-ID-ERPNDB4)
 19313*         SET        (ADDRESS OF PENDING-BUSINESS)
 19314*         RIDFLD     (ERPNDB-CSR-KEY)
 19315*    END-EXEC.
 19316     MOVE 0
 19317       TO DFHEIV11
 19318*    MOVE '&.S                   )   #00016507' TO DFHEIV0
 19319     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19320     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19321     MOVE X'2020233030303136353037' TO DFHEIV0(25:11)
 19322     CALL 'kxdfhei1' USING DFHEIV0,
 19323           FILE-ID-ERPNDB4,
 19324           DFHEIV20,
 19325           DFHEIV99,
 19326           ERPNDB-CSR-KEY,
 19327           DFHEIV99,
 19328           DFHEIV11,
 19329           DFHEIV99,
 19330           DFHEIV99
 19331     SET ADDRESS OF PENDING-BUSINESS TO
 19332         DFHEIV20
 19333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19334
 19335
 19336 4205-READ-NEXT-RECORD.
 19337
 19338
 19339* EXEC CICS READNEXT
 19340*         DATASET    (FILE-ID-ERPNDB4)
 19341*         SET        (ADDRESS OF PENDING-BUSINESS)
 19342*         RIDFLD     (ERPNDB-CSR-KEY)
 19343*    END-EXEC.
 19344     MOVE 0
 19345       TO DFHEIV11
 19346*    MOVE '&.S                   )   #00016515' TO DFHEIV0
 19347     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19348     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19349     MOVE X'2020233030303136353135' TO DFHEIV0(25:11)
 19350     CALL 'kxdfhei1' USING DFHEIV0,
 19351           FILE-ID-ERPNDB4,
 19352           DFHEIV20,
 19353           DFHEIV99,
 19354           ERPNDB-CSR-KEY,
 19355           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 355
* EL6311.cbl
 19356           DFHEIV11,
 19357           DFHEIV99,
 19358           DFHEIV99
 19359     SET ADDRESS OF PENDING-BUSINESS TO
 19360         DFHEIV20
 19361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19362
 19363
 19364     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19365
 19366     IF WS-BATCH-PREFIX = '#CL'
 19367        GO TO 4205-READ-NEXT-RECORD.
 19368
 19369     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19370        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19371        GO TO 4250-END-RECORDS.
 19372
 19373     IF PB-BATCH-TRAILER
 19374        GO TO 4205-READ-NEXT-RECORD.
 19375
 19376     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19377        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19378           GO TO 4205-READ-NEXT-RECORD
 19379        ELSE
 19380           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19381              GO TO 4210-CHECK-REC-TYPE
 19382           ELSE
 19383              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19384                 GO TO 4210-CHECK-REC-TYPE
 19385              ELSE
 19386                 GO TO 4205-READ-NEXT-RECORD.
 19387
 19388     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19389        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19390           GO TO 4205-READ-NEXT-RECORD.
 19391
 19392 4210-CHECK-REC-TYPE.
 19393     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19394         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19395             NEXT SENTENCE
 19396         ELSE
 19397             GO TO 4205-READ-NEXT-RECORD.
 19398
 19399     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19400         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19401             NEXT SENTENCE
 19402        ELSE
 19403             GO TO 4205-READ-NEXT-RECORD.
 19404
 19405     IF NOT DISPLAY-CHANGE-RECORDS AND
 19406            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19407        GO TO 4205-READ-NEXT-RECORD.
 19408
 19409     IF DISPLAY-HOLD-RECORDS AND
 19410        NOT PB-RECORD-ON-HOLD
 19411          GO TO 4205-READ-NEXT-RECORD.
 19412
 19413     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 356
* EL6311.cbl
 19414        IF DISPLAY-CHK-REQ-RECORDS
 19415            GO TO 4205-READ-NEXT-RECORD.
 19416
 19417     IF PB-ISSUE
 19418        IF ISSUE-WITH-WARNING
 19419           IF PB-WARNING-ERRORS
 19420              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19421                  GO TO 4205-READ-NEXT-RECORD
 19422              ELSE
 19423                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19424                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19425                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19426                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19427                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19428                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19429                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19430                 GO TO 7000-DISPLAY-ISSUES
 19431           ELSE
 19432              GO TO 4205-READ-NEXT-RECORD.
 19433
 19434     IF PB-ISSUE
 19435        IF (ISSUES-IN-ERROR AND
 19436            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19437            ALL-ISSUES
 19438            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19439            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19440            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19441            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19442            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19443            MOVE PB-SV-STATE            TO PI-SV-STATE
 19444            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19445            GO TO 7000-DISPLAY-ISSUES
 19446        ELSE
 19447            GO TO 4205-READ-NEXT-RECORD.
 19448
 19449     IF PB-CANCELLATION
 19450        IF DISPLAY-CHK-REQ-RECORDS
 19451           IF PB-C-REFUND-REQUESTED
 19452              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19453              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19454              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19455              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19456              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19457              MOVE PB-SV-STATE            TO PI-SV-STATE
 19458              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19459              GO TO 7100-DISPLAY-CANCELS
 19460           ELSE
 19461               GO TO 4205-READ-NEXT-RECORD.
 19462
 19463     IF PB-CANCELLATION
 19464        IF CANCEL-WITH-WARNING
 19465           IF PB-WARNING-ERRORS
 19466              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19467                  GO TO 4205-READ-NEXT-RECORD
 19468              ELSE
 19469                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19470                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19471                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 357
* EL6311.cbl
 19472                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19473                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19474                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19475                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19476                 GO TO 7100-DISPLAY-CANCELS
 19477           ELSE
 19478              GO TO 4205-READ-NEXT-RECORD.
 19479
 19480     IF PB-CANCELLATION
 19481        IF (CANCEL-IN-ERROR  AND
 19482            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19483            ALL-CANCELS
 19484            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19485            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19486            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19487            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19488            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19489            MOVE PB-SV-STATE            TO PI-SV-STATE
 19490            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19491            GO TO 7100-DISPLAY-CANCELS.
 19492
 19493     GO TO 4205-READ-NEXT-RECORD.
 19494
 19495 4250-END-RECORDS.
 19496******************************************************************
 19497*                                                                *
 19498*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19499*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19500*         PROGRAM.                                               *
 19501*                                                                *
 19502******************************************************************
 19503
 19504     IF BROWSE-STARTED
 19505        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19506
 19507* EXEC CICS ENDBR
 19508*            DATASET  (FILE-ID-ERPNDB4)
 19509*       END-EXEC.
 19510     MOVE 0
 19511       TO DFHEIV11
 19512*    MOVE '&2                    $   #00016663' TO DFHEIV0
 19513     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19514     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19515     MOVE X'2020233030303136363633' TO DFHEIV0(25:11)
 19516     CALL 'kxdfhei1' USING DFHEIV0,
 19517           FILE-ID-ERPNDB4,
 19518           DFHEIV11,
 19519           DFHEIV99
 19520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19521
 19522
 19523     IF  EIBTRNID NOT = TRANS-EXB1
 19524         IF PENDING-BUS-RECS-FOUND
 19525             NEXT SENTENCE
 19526           ELSE
 19527             MOVE '9'            TO PI-BROWSE-SW
 19528             GO TO 9400-CLEAR.
 19529
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 358
* EL6311.cbl
 19530     IF SHOW-RECORD
 19531        MOVE ER-2253            TO EMI-ERROR
 19532       ELSE
 19533        MOVE ER-2254            TO EMI-ERROR.
 19534
 19535     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19536
 19537     IF PI-MAP-NAME = SPACES
 19538        MOVE -1                  TO DPFENTRL
 19539        MOVE EL631D               TO PI-MAP-NAME
 19540        GO TO 8100-SEND-INITIAL-MAP.
 19541
 19542     IF PI-MAP-NAME = EL631B
 19543        MOVE -1                  TO BMAINTL
 19544     ELSE
 19545        IF PI-MAP-NAME = EL631C
 19546           MOVE -1               TO CMAINTL
 19547        ELSE
 19548           MOVE -1               TO DPFENTRL.
 19549
 19550     GO TO 8200-SEND-DATAONLY.
 19551
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 359
* EL6311.cbl
 19553
 19554***************************************************************
 19555*                                                             *
 19556*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19557*                                                             *
 19558*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19559*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19560*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19561*                                                             *
 19562*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19563*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19564*          A. IS IT WITHIN THE SAME COMPANY                   *
 19565*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19566*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19567*                AND IS IT TO BE DISPLAYED.                   *
 19568*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19569*                DISPLAYED.                                   *
 19570*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19571*                DISPLAYED.                                   *
 19572*                                                             *
 19573*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19574*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19575*                                                             *
 19576*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19577*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19578*                THEY ARE NOT TO BE DISPLAYED.                *
 19579*                                                             *
 19580***************************************************************
 19581
 19582 4300-BROWSE-FILE-FORWARD.
 19583     IF FIRST-TIME OR SHOW-RECORD
 19584        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19585        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19586        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19587     ELSE
 19588        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19589        IF ERPNDB-BATCH-SEQ-NO = +9999
 19590           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19591        ELSE
 19592           IF DISPLAY-CHANGE-RECORDS
 19593              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19594           ELSE
 19595              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19596              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19597
 19598
 19599* EXEC CICS HANDLE CONDITION
 19600*         ENDFILE  (4350-END-BATCH)
 19601*         NOTFND   (4350-END-BATCH)
 19602*    END-EXEC.
 19603*    MOVE '"$''I                  ! M #00016742' TO DFHEIV0
 19604     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19605     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19606     MOVE X'4D20233030303136373432' TO DFHEIV0(25:11)
 19607     CALL 'kxdfhei1' USING DFHEIV0
 19608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19609
 19610
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 360
* EL6311.cbl
 19611 4305-READ-NEXT.
 19612     IF PI-DISPLAY-ORIGINAL-BATCH
 19613        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19614     ELSE
 19615        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19616
 19617
 19618* EXEC CICS READ
 19619*         DATASET   (FILE-ID)
 19620*         SET       (ADDRESS OF PENDING-BUSINESS)
 19621*         RIDFLD    (ERPNDB-KEY)
 19622*         GTEQ
 19623*    END-EXEC.
 19624*    MOVE '&"S        G          (   #00016753' TO DFHEIV0
 19625     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19626     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19627     MOVE X'2020233030303136373533' TO DFHEIV0(25:11)
 19628     CALL 'kxdfhei1' USING DFHEIV0,
 19629           FILE-ID,
 19630           DFHEIV20,
 19631           DFHEIV99,
 19632           ERPNDB-KEY,
 19633           DFHEIV99,
 19634           DFHEIV99,
 19635           DFHEIV99
 19636     SET ADDRESS OF PENDING-BUSINESS TO
 19637         DFHEIV20
 19638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19639
 19640
 19641     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19642        GO TO 4350-END-BATCH.
 19643
 19644     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19645                                    WS-BATCH-NO.
 19646
 19647     IF  WS-BATCH-PREFIX = '#CL'
 19648         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19649         GO TO 4305-READ-NEXT.
 19650
 19651     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19652     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19653     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19654     MOVE PB-STATE               TO PI-PB-STATE.
 19655     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19656
 19657     IF PB-BATCH-TRAILER
 19658        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19659        GO TO 4305-READ-NEXT.
 19660
 19661     IF SHOW-RECORD
 19662           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19663              GO TO 4310-BUMP-SEQ
 19664           ELSE
 19665              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19666                 GO TO 4310-BUMP-SEQ
 19667              ELSE
 19668                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 361
* EL6311.cbl
 19669
 19670     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19671        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19672           GO TO 4310-BUMP-SEQ
 19673        ELSE
 19674           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19675              GO TO 4307-CHECK-REC-TYPE
 19676           ELSE
 19677              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19678                 GO TO 4307-CHECK-REC-TYPE
 19679              ELSE
 19680                 GO TO 4310-BUMP-SEQ.
 19681
 19682     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19683        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19684           GO TO 4310-BUMP-SEQ.
 19685
 19686 4307-CHECK-REC-TYPE.
 19687     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19688         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19689             NEXT SENTENCE
 19690         ELSE
 19691             GO TO 4310-BUMP-SEQ.
 19692
 19693     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19694         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19695             NEXT SENTENCE
 19696        ELSE
 19697             GO TO 4310-BUMP-SEQ.
 19698
 19699     IF NOT DISPLAY-CHANGE-RECORDS AND
 19700            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19701        GO TO 4310-BUMP-SEQ.
 19702
 19703     IF DISPLAY-HOLD-RECORDS AND
 19704        NOT PB-RECORD-ON-HOLD
 19705          GO TO 4310-BUMP-SEQ.
 19706
 19707     IF PB-ISSUE
 19708        IF DISPLAY-CHK-REQ-RECORDS
 19709           GO TO 4310-BUMP-SEQ.
 19710
 19711     IF PB-ISSUE
 19712        IF ISSUE-WITH-WARNING
 19713           IF PB-WARNING-ERRORS
 19714              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19715                  GO TO 4310-BUMP-SEQ
 19716              ELSE
 19717                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19718                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19719                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19720                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19721                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19722                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19723                 GO TO 7000-DISPLAY-ISSUES
 19724           ELSE
 19725              GO TO 4310-BUMP-SEQ.
 19726
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 362
* EL6311.cbl
 19727     IF PB-ISSUE
 19728        IF (ISSUES-IN-ERROR AND
 19729            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19730            ALL-ISSUES
 19731            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19732            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19733            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19734            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19735            MOVE PB-SV-STATE            TO PI-SV-STATE
 19736            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19737            GO TO 7000-DISPLAY-ISSUES
 19738        ELSE
 19739            GO TO 4310-BUMP-SEQ.
 19740
 19741     IF PB-CANCELLATION
 19742        IF DISPLAY-CHK-REQ-RECORDS
 19743           IF PB-C-REFUND-REQUESTED
 19744              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19745              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19746              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19747              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19748              MOVE PB-SV-STATE            TO PI-SV-STATE
 19749              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19750              GO TO 7100-DISPLAY-CANCELS
 19751           ELSE
 19752              GO TO 4310-BUMP-SEQ.
 19753
 19754     IF PB-CANCELLATION
 19755        IF CANCEL-WITH-WARNING
 19756           IF PB-WARNING-ERRORS
 19757              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19758                  GO TO 4310-BUMP-SEQ
 19759              ELSE
 19760                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19761                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19762                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19763                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19764                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19765                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19766                 GO TO 7100-DISPLAY-CANCELS
 19767           ELSE
 19768              GO TO 4310-BUMP-SEQ.
 19769
 19770     IF PB-CANCELLATION
 19771        IF (CANCEL-IN-ERROR  AND
 19772            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19773            ALL-CANCELS
 19774            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19775            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19776            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19777            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19778            MOVE PB-SV-STATE            TO PI-SV-STATE
 19779            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19780            GO TO 7100-DISPLAY-CANCELS.
 19781
 19782 4310-BUMP-SEQ.
 19783     IF NOT DISPLAY-CHANGE-RECORDS
 19784        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 363
* EL6311.cbl
 19785        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19786     ELSE
 19787        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19788           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19789           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19790        ELSE
 19791           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19792           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19793
 19794     GO TO 4305-READ-NEXT.
 19795
 19796 4350-END-BATCH.
 19797
 19798******************************************************************
 19799*                                                                *
 19800*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19801*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19802*         PROGRAM.                                               *
 19803*                                                                *
 19804******************************************************************
 19805
 19806     IF  EIBTRNID NOT = TRANS-EXB1
 19807         IF PENDING-BUS-RECS-FOUND
 19808             NEXT SENTENCE
 19809           ELSE
 19810             MOVE '9'            TO PI-BROWSE-SW
 19811             GO TO 9400-CLEAR.
 19812
 19813     IF SHOW-RECORD
 19814        MOVE ER-2253            TO EMI-ERROR
 19815     ELSE
 19816        MOVE ER-2251            TO EMI-ERROR.
 19817
 19818     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19819
 19820     IF PI-MAP-NAME = SPACES
 19821        MOVE -1                  TO BMAINTL
 19822        MOVE EL631B               TO PI-MAP-NAME
 19823        GO TO 8100-SEND-INITIAL-MAP.
 19824
 19825     IF PI-MAP-NAME = EL631B
 19826        MOVE -1                  TO BMAINTL
 19827     ELSE
 19828        IF PI-MAP-NAME = EL631C
 19829           MOVE -1               TO CMAINTL
 19830        ELSE
 19831           MOVE -1               TO DPFENTRL.
 19832
 19833     GO TO 8200-SEND-DATAONLY.
 19834
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 364
* EL6311.cbl
 19836
 19837******************************************************************
 19838*                                                                *
 19839*        B R O W S E   D E T A I L   B A C K W A R D             *
 19840*                                                                *
 19841******************************************************************
 19842
 19843 4500-BROWSE-DETAIL-BACKWARD.
 19844
 19845     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19846
 19847
 19848* EXEC CICS HANDLE CONDITION
 19849*         NOTFND   (4570-NOT-FOUND)
 19850*         ENDFILE  (4550-END-RECORDS)
 19851*    END-EXEC
 19852*    MOVE '"$I''                  ! N #00016966' TO DFHEIV0
 19853     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19855     MOVE X'4E20233030303136393636' TO DFHEIV0(25:11)
 19856     CALL 'kxdfhei1' USING DFHEIV0
 19857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19858
 19859
 19860* EXEC CICS STARTBR
 19861*         DATASET   (FILE-ID-ERPNDB2)
 19862*         RIDFLD    (ERPNDB-ALT-KEY)
 19863*    END-EXEC.
 19864     MOVE 0
 19865       TO DFHEIV11
 19866*    MOVE '&,         G          &   #00016971' TO DFHEIV0
 19867     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19868     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19869     MOVE X'2020233030303136393731' TO DFHEIV0(25:11)
 19870     CALL 'kxdfhei1' USING DFHEIV0,
 19871           FILE-ID-ERPNDB2,
 19872           ERPNDB-ALT-KEY,
 19873           DFHEIV99,
 19874           DFHEIV11,
 19875           DFHEIV99
 19876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19877
 19878
 19879     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19880                                    WS-FIRST-TIME-SW.
 19881
 19882 4505-READ-PREV-RECORD.
 19883
 19884* EXEC CICS READPREV
 19885*         DATASET    (FILE-ID-ERPNDB2)
 19886*         SET        (ADDRESS OF PENDING-BUSINESS)
 19887*         RIDFLD     (ERPNDB-ALT-KEY)
 19888*    END-EXEC.
 19889     MOVE 0
 19890       TO DFHEIV11
 19891*    MOVE '&0S                   )   #00016980' TO DFHEIV0
 19892     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19893     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 365
* EL6311.cbl
 19894     MOVE X'2020233030303136393830' TO DFHEIV0(25:11)
 19895     CALL 'kxdfhei1' USING DFHEIV0,
 19896           FILE-ID-ERPNDB2,
 19897           DFHEIV20,
 19898           DFHEIV99,
 19899           ERPNDB-ALT-KEY,
 19900           DFHEIV99,
 19901           DFHEIV11,
 19902           DFHEIV99,
 19903           DFHEIV99
 19904     SET ADDRESS OF PENDING-BUSINESS TO
 19905         DFHEIV20
 19906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19907
 19908
 19909     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19910
 19911     IF WS-BATCH-PREFIX = '#CL'
 19912         GO TO 4505-READ-PREV-RECORD.
 19913
 19914     IF FIRST-TIME
 19915         MOVE SPACE               TO WS-FIRST-TIME-SW
 19916         GO TO 4505-READ-PREV-RECORD.
 19917
 19918     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19919        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19920        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19921        PB-STATE         NOT = PI-PB-STATE    OR
 19922        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19923          GO TO 4550-END-RECORDS.
 19924
 19925
 19926     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19927
 19928     IF PB-BATCH-TRAILER
 19929        GO TO 4505-READ-PREV-RECORD.
 19930
 19931     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19932
 19933     IF  WS-BATCH-PREFIX = '#CL'
 19934         GO TO 4505-READ-PREV-RECORD.
 19935
 19936     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19937        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19938           GO TO 4505-READ-PREV-RECORD
 19939        ELSE
 19940           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19941              GO TO 4510-CHECK-REC-TYPE
 19942           ELSE
 19943              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19944                 GO TO 4510-CHECK-REC-TYPE
 19945              ELSE
 19946                 GO TO 4505-READ-PREV-RECORD.
 19947
 19948     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19949        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19950           GO TO 4505-READ-PREV-RECORD.
 19951
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 366
* EL6311.cbl
 19952 4510-CHECK-REC-TYPE.
 19953     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19954         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19955             NEXT SENTENCE
 19956         ELSE
 19957             GO TO 4505-READ-PREV-RECORD.
 19958
 19959     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19960         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19961             NEXT SENTENCE
 19962        ELSE
 19963             GO TO 4505-READ-PREV-RECORD.
 19964
 19965     IF NOT DISPLAY-CHANGE-RECORDS AND
 19966            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19967        GO TO 4505-READ-PREV-RECORD.
 19968
 19969     IF DISPLAY-HOLD-RECORDS AND
 19970        NOT PB-RECORD-ON-HOLD
 19971          GO TO 4505-READ-PREV-RECORD.
 19972
 19973     IF PB-ISSUE
 19974        IF DISPLAY-CHK-REQ-RECORDS
 19975           GO TO 4505-READ-PREV-RECORD.
 19976
 19977     IF PB-ISSUE
 19978        IF ISSUE-WITH-WARNING
 19979           IF PB-WARNING-ERRORS
 19980              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19981                  GO TO 4505-READ-PREV-RECORD
 19982              ELSE
 19983                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19984                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19985                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19986                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19987                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19988                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19989                 GO TO 7000-DISPLAY-ISSUES
 19990           ELSE
 19991              GO TO 4505-READ-PREV-RECORD.
 19992
 19993     IF PB-ISSUE
 19994        IF (ISSUES-IN-ERROR AND
 19995            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19996            ALL-ISSUES
 19997            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19998            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19999            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20000            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20001            MOVE PB-SV-STATE            TO PI-SV-STATE
 20002            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20003            GO TO 7000-DISPLAY-ISSUES
 20004        ELSE
 20005            GO TO 4505-READ-PREV-RECORD.
 20006
 20007     IF PB-CANCELLATION
 20008        IF DISPLAY-CHK-REQ-RECORDS
 20009           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 367
* EL6311.cbl
 20010              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20011              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20012              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20013              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20014              MOVE PB-SV-STATE            TO PI-SV-STATE
 20015              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20016              GO TO 7100-DISPLAY-CANCELS
 20017           ELSE
 20018              GO TO 4505-READ-PREV-RECORD.
 20019
 20020     IF PB-CANCELLATION
 20021        IF CANCEL-WITH-WARNING
 20022           IF PB-WARNING-ERRORS
 20023              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20024                  GO TO 4505-READ-PREV-RECORD
 20025              ELSE
 20026                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20027                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20028                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20029                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20030                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20031                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20032                 GO TO 7100-DISPLAY-CANCELS
 20033           ELSE
 20034              GO TO 4505-READ-PREV-RECORD.
 20035
 20036     IF PB-CANCELLATION
 20037        IF (CANCEL-IN-ERROR  AND
 20038            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20039            ALL-CANCELS
 20040            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20041            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20042            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20043            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20044            MOVE PB-SV-STATE            TO PI-SV-STATE
 20045            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20046            GO TO 7100-DISPLAY-CANCELS.
 20047
 20048     GO TO 4505-READ-PREV-RECORD.
 20049
 20050 4550-END-RECORDS.
 20051     IF PI-MAP-NAME = EL631B
 20052        MOVE -1                  TO BMAINTL
 20053     ELSE
 20054        IF PI-MAP-NAME = EL631C
 20055           MOVE -1               TO CMAINTL
 20056        ELSE
 20057           MOVE -1               TO DPFENTRL.
 20058
 20059     MOVE ER-2255               TO EMI-ERROR.
 20060     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20061     GO TO 8200-SEND-DATAONLY.
 20062
 20063 4570-NOT-FOUND.
 20064
 20065******************************************************************
 20066*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20067******************************************************************
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 368
* EL6311.cbl
 20068
 20069
 20070* EXEC CICS RESETBR
 20071*         DATASET    (FILE-ID-ERPNDB2)
 20072*         RIDFLD     (ERPNDB-ALT-KEY)
 20073*    END-EXEC.
 20074     MOVE 0
 20075       TO DFHEIV11
 20076*    MOVE '&4         G          &   #00017146' TO DFHEIV0
 20077     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20078     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20079     MOVE X'2020233030303137313436' TO DFHEIV0(25:11)
 20080     CALL 'kxdfhei1' USING DFHEIV0,
 20081           FILE-ID-ERPNDB2,
 20082           ERPNDB-ALT-KEY,
 20083           DFHEIV99,
 20084           DFHEIV11,
 20085           DFHEIV99
 20086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20087
 20088
 20089
 20090* EXEC CICS READNEXT
 20091*         DATASET    (FILE-ID-ERPNDB2)
 20092*         SET        (ADDRESS OF PENDING-BUSINESS)
 20093*         RIDFLD     (ERPNDB-ALT-KEY)
 20094*    END-EXEC.
 20095     MOVE 0
 20096       TO DFHEIV11
 20097*    MOVE '&.S                   )   #00017151' TO DFHEIV0
 20098     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20099     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20100     MOVE X'2020233030303137313531' TO DFHEIV0(25:11)
 20101     CALL 'kxdfhei1' USING DFHEIV0,
 20102           FILE-ID-ERPNDB2,
 20103           DFHEIV20,
 20104           DFHEIV99,
 20105           ERPNDB-ALT-KEY,
 20106           DFHEIV99,
 20107           DFHEIV11,
 20108           DFHEIV99,
 20109           DFHEIV99
 20110     SET ADDRESS OF PENDING-BUSINESS TO
 20111         DFHEIV20
 20112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20113
 20114
 20115
 20116* EXEC CICS READPREV
 20117*         DATASET    (FILE-ID-ERPNDB2)
 20118*         SET        (ADDRESS OF PENDING-BUSINESS)
 20119*         RIDFLD     (ERPNDB-ALT-KEY)
 20120*    END-EXEC.
 20121     MOVE 0
 20122       TO DFHEIV11
 20123*    MOVE '&0S                   )   #00017157' TO DFHEIV0
 20124     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20125     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 369
* EL6311.cbl
 20126     MOVE X'2020233030303137313537' TO DFHEIV0(25:11)
 20127     CALL 'kxdfhei1' USING DFHEIV0,
 20128           FILE-ID-ERPNDB2,
 20129           DFHEIV20,
 20130           DFHEIV99,
 20131           ERPNDB-ALT-KEY,
 20132           DFHEIV99,
 20133           DFHEIV11,
 20134           DFHEIV99,
 20135           DFHEIV99
 20136     SET ADDRESS OF PENDING-BUSINESS TO
 20137         DFHEIV20
 20138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20139
 20140
 20141 4580-READ-PREV-RECORD.
 20142
 20143* EXEC CICS READPREV
 20144*         DATASET    (FILE-ID-ERPNDB2)
 20145*         SET        (ADDRESS OF PENDING-BUSINESS)
 20146*         RIDFLD     (ERPNDB-ALT-KEY)
 20147*    END-EXEC.
 20148     MOVE 0
 20149       TO DFHEIV11
 20150*    MOVE '&0S                   )   #00017164' TO DFHEIV0
 20151     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20152     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20153     MOVE X'2020233030303137313634' TO DFHEIV0(25:11)
 20154     CALL 'kxdfhei1' USING DFHEIV0,
 20155           FILE-ID-ERPNDB2,
 20156           DFHEIV20,
 20157           DFHEIV99,
 20158           ERPNDB-ALT-KEY,
 20159           DFHEIV99,
 20160           DFHEIV11,
 20161           DFHEIV99,
 20162           DFHEIV99
 20163     SET ADDRESS OF PENDING-BUSINESS TO
 20164         DFHEIV20
 20165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20166
 20167
 20168     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20169
 20170     IF WS-BATCH-PREFIX = '#CL'
 20171        GO TO 4580-READ-PREV-RECORD.
 20172
 20173     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20174     GO TO 4505-READ-PREV-RECORD.
 20175
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 370
* EL6311.cbl
 20177
 20178******************************************************************
 20179*                                                                *
 20180*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20181*                                                                *
 20182******************************************************************
 20183
 20184 4600-BROWSE-PRIMARY-BACKWARD.
 20185        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20186
 20187     IF ERPNDB-BATCH-SEQ-NO = +9999
 20188        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20189
 20190        IF ERPNDB-BATCH-SEQ-NO = +0000
 20191           GO TO 4650-END-BATCH
 20192        ELSE
 20193           IF PI-MAP-NAME NOT = EL631D
 20194              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20195                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20196              ELSE
 20197                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20198                 IF DISPLAY-CHANGE-RECORDS
 20199                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20200                 ELSE
 20201                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20202
 20203
 20204* EXEC CICS HANDLE CONDITION
 20205*         NOTFND    (4680-NOT-FOUND)
 20206*         ENDFILE   (4680-NOT-FOUND)
 20207*    END-EXEC.
 20208*    MOVE '"$I''                  ! O #00017205' TO DFHEIV0
 20209     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20210     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20211     MOVE X'4F20233030303137323035' TO DFHEIV0(25:11)
 20212     CALL 'kxdfhei1' USING DFHEIV0
 20213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20214
 20215
 20216 4605-READ-NEXT.
 20217     IF ERPNDB-BATCH-SEQ-NO = +0000
 20218        GO TO 4650-END-BATCH.
 20219
 20220     IF PI-DISPLAY-ORIGINAL-BATCH
 20221        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20222     ELSE
 20223        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20224
 20225
 20226* EXEC CICS READ
 20227*         DATASET   (FILE-ID)
 20228*         SET       (ADDRESS OF PENDING-BUSINESS)
 20229*         RIDFLD    (ERPNDB-KEY)
 20230*    END-EXEC.
 20231*    MOVE '&"S        E          (   #00017219' TO DFHEIV0
 20232     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20234     MOVE X'2020233030303137323139' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 371
* EL6311.cbl
 20235     CALL 'kxdfhei1' USING DFHEIV0,
 20236           FILE-ID,
 20237           DFHEIV20,
 20238           DFHEIV99,
 20239           ERPNDB-KEY,
 20240           DFHEIV99,
 20241           DFHEIV99,
 20242           DFHEIV99
 20243     SET ADDRESS OF PENDING-BUSINESS TO
 20244         DFHEIV20
 20245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20246
 20247
 20248     IF NOT  PI-PRIMARY-WITH-SELECT
 20249        GO TO 4607-CHECK-REC-TYPE.
 20250
 20251     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20252
 20253     IF  WS-BATCH-PREFIX = '#CL'
 20254         GO TO 4610-BUMP-SEQ.
 20255
 20256     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20257        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20258           GO TO 4610-BUMP-SEQ
 20259        ELSE
 20260           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20261              GO TO 4607-CHECK-REC-TYPE
 20262           ELSE
 20263              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20264                 GO TO 4607-CHECK-REC-TYPE
 20265              ELSE
 20266                 GO TO 4610-BUMP-SEQ.
 20267
 20268     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20269        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20270           GO TO 4610-BUMP-SEQ.
 20271
 20272 4607-CHECK-REC-TYPE.
 20273     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20274         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20275             NEXT SENTENCE
 20276         ELSE
 20277             GO TO 4610-BUMP-SEQ.
 20278
 20279     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20280         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20281             NEXT SENTENCE
 20282        ELSE
 20283             GO TO 4610-BUMP-SEQ.
 20284
 20285     IF NOT DISPLAY-CHANGE-RECORDS AND
 20286            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20287        GO TO 4610-BUMP-SEQ.
 20288
 20289     IF DISPLAY-HOLD-RECORDS AND
 20290        NOT PB-RECORD-ON-HOLD
 20291          GO TO 4610-BUMP-SEQ.
 20292
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 372
* EL6311.cbl
 20293     IF PB-ISSUE
 20294        IF DISPLAY-CHK-REQ-RECORDS
 20295           GO TO 4610-BUMP-SEQ.
 20296
 20297     IF PB-ISSUE
 20298        IF ISSUE-WITH-WARNING
 20299           IF PB-WARNING-ERRORS
 20300              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20301                  GO TO 4610-BUMP-SEQ
 20302              ELSE
 20303                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20304                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20305                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20306                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20307                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20308                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20309                 GO TO 7000-DISPLAY-ISSUES
 20310           ELSE
 20311              GO TO 4610-BUMP-SEQ.
 20312
 20313     IF PB-ISSUE
 20314        IF (ISSUES-IN-ERROR AND
 20315            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20316            ALL-ISSUES
 20317            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20318            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20319            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20320            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20321            MOVE PB-SV-STATE            TO PI-SV-STATE
 20322            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20323            GO TO 7000-DISPLAY-ISSUES
 20324        ELSE
 20325            GO TO 4610-BUMP-SEQ.
 20326
 20327     IF PB-CANCELLATION
 20328        IF DISPLAY-CHK-REQ-RECORDS
 20329           IF PB-C-REFUND-REQUESTED
 20330              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20331              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20332              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20333              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20334              MOVE PB-SV-STATE            TO PI-SV-STATE
 20335              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20336              GO TO 7100-DISPLAY-CANCELS
 20337           ELSE
 20338              GO TO 4610-BUMP-SEQ.
 20339
 20340     IF PB-CANCELLATION
 20341        IF CANCEL-WITH-WARNING
 20342           IF PB-WARNING-ERRORS
 20343              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20344                  GO TO 4610-BUMP-SEQ
 20345              ELSE
 20346                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20347                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20348                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20349                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20350                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 373
* EL6311.cbl
 20351                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20352                 GO TO 7100-DISPLAY-CANCELS
 20353           ELSE
 20354              GO TO 4610-BUMP-SEQ.
 20355
 20356     IF PB-CANCELLATION
 20357        IF (CANCEL-IN-ERROR  AND
 20358            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20359            ALL-CANCELS
 20360            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20361            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20362            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20363            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20364            MOVE PB-SV-STATE            TO PI-SV-STATE
 20365            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20366            GO TO 7100-DISPLAY-CANCELS.
 20367
 20368 4610-BUMP-SEQ.
 20369     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20370        GO TO 4650-END-BATCH.
 20371
 20372     IF DISPLAY-CHANGE-RECORDS
 20373        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20374           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20375        ELSE
 20376           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20377           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20378        ELSE
 20379           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20380           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20381
 20382        GO TO 4605-READ-NEXT.
 20383
 20384 4650-END-BATCH.
 20385     IF PI-MAP-NAME = EL631B
 20386        MOVE -1                  TO BMAINTL
 20387     ELSE
 20388        IF PI-MAP-NAME = EL631C
 20389           MOVE -1               TO CMAINTL
 20390        ELSE
 20391           MOVE -1               TO DPFENTRL.
 20392
 20393     MOVE ER-2252               TO EMI-ERROR.
 20394     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20395     GO TO 8200-SEND-DATAONLY.
 20396
 20397 4680-NOT-FOUND.
 20398     IF DISPLAY-CHANGE-RECORDS
 20399        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20400           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20401        ELSE
 20402           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20403           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20404     ELSE
 20405        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20406
 20407     GO TO 4605-READ-NEXT.
 20408
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 374
* EL6311.cbl
 20410
 20411******************************************************************
 20412*                                                                *
 20413*        B R O W S E   F I L E   B A C K W A R D S               *
 20414*                                                                *
 20415******************************************************************
 20416
 20417 4800-BROWSE-FILE-BACKWARD.
 20418
 20419* EXEC CICS HANDLE CONDITION
 20420*         NOTFND   (4860-NOT-FOUND)
 20421*         ENDFILE  (4850-END-RECORDS)
 20422*    END-EXEC.
 20423*    MOVE '"$I''                  ! P #00017395' TO DFHEIV0
 20424     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20426     MOVE X'5020233030303137333935' TO DFHEIV0(25:11)
 20427     CALL 'kxdfhei1' USING DFHEIV0
 20428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20429
 20430
 20431     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20432
 20433     IF PI-DISPLAY-ORIGINAL-BATCH
 20434        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20435     ELSE
 20436        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20437
 20438
 20439* EXEC CICS STARTBR
 20440*         DATASET   (FILE-ID)
 20441*         RIDFLD    (ERPNDB-KEY)
 20442*    END-EXEC.
 20443     MOVE 0
 20444       TO DFHEIV11
 20445*    MOVE '&,         G          &   #00017407' TO DFHEIV0
 20446     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20447     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20448     MOVE X'2020233030303137343037' TO DFHEIV0(25:11)
 20449     CALL 'kxdfhei1' USING DFHEIV0,
 20450           FILE-ID,
 20451           ERPNDB-KEY,
 20452           DFHEIV99,
 20453           DFHEIV11,
 20454           DFHEIV99
 20455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20456
 20457
 20458     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20459
 20460
 20461* EXEC CICS READPREV
 20462*         DATASET    (FILE-ID-ERPNDB)
 20463*         SET        (ADDRESS OF PENDING-BUSINESS)
 20464*         RIDFLD     (ERPNDB-KEY)
 20465*    END-EXEC.
 20466     MOVE 0
 20467       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 375
* EL6311.cbl
 20468*    MOVE '&0S                   )   #00017414' TO DFHEIV0
 20469     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20470     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20471     MOVE X'2020233030303137343134' TO DFHEIV0(25:11)
 20472     CALL 'kxdfhei1' USING DFHEIV0,
 20473           FILE-ID-ERPNDB,
 20474           DFHEIV20,
 20475           DFHEIV99,
 20476           ERPNDB-KEY,
 20477           DFHEIV99,
 20478           DFHEIV11,
 20479           DFHEIV99,
 20480           DFHEIV99
 20481     SET ADDRESS OF PENDING-BUSINESS TO
 20482         DFHEIV20
 20483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20484
 20485
 20486 4810-READ-PREV-RECORD.
 20487
 20488* EXEC CICS READPREV
 20489*         DATASET    (FILE-ID-ERPNDB)
 20490*         SET        (ADDRESS OF PENDING-BUSINESS)
 20491*         RIDFLD     (ERPNDB-KEY)
 20492*    END-EXEC.
 20493     MOVE 0
 20494       TO DFHEIV11
 20495*    MOVE '&0S                   )   #00017421' TO DFHEIV0
 20496     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20497     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20498     MOVE X'2020233030303137343231' TO DFHEIV0(25:11)
 20499     CALL 'kxdfhei1' USING DFHEIV0,
 20500           FILE-ID-ERPNDB,
 20501           DFHEIV20,
 20502           DFHEIV99,
 20503           ERPNDB-KEY,
 20504           DFHEIV99,
 20505           DFHEIV11,
 20506           DFHEIV99,
 20507           DFHEIV99
 20508     SET ADDRESS OF PENDING-BUSINESS TO
 20509         DFHEIV20
 20510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20511
 20512
 20513     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20514        GO TO 4850-END-RECORDS.
 20515
 20516     IF PB-BATCH-TRAILER
 20517        GO TO 4810-READ-PREV-RECORD.
 20518
 20519     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20520
 20521     IF  WS-BATCH-PREFIX = '#CL'
 20522         GO TO 4810-READ-PREV-RECORD.
 20523
 20524     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20525        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 376
* EL6311.cbl
 20526           GO TO 4810-READ-PREV-RECORD
 20527        ELSE
 20528           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20529              GO TO 4820-CHECK-REC-TYPE
 20530           ELSE
 20531              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20532                 GO TO 4820-CHECK-REC-TYPE
 20533              ELSE
 20534                 GO TO 4810-READ-PREV-RECORD.
 20535
 20536     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20537        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20538           GO TO 4810-READ-PREV-RECORD.
 20539
 20540 4820-CHECK-REC-TYPE.
 20541     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20542         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20543             NEXT SENTENCE
 20544         ELSE
 20545             GO TO 4810-READ-PREV-RECORD.
 20546
 20547     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20548         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20549             NEXT SENTENCE
 20550        ELSE
 20551             GO TO 4810-READ-PREV-RECORD.
 20552
 20553     IF NOT DISPLAY-CHANGE-RECORDS AND
 20554            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20555        GO TO 4810-READ-PREV-RECORD.
 20556
 20557     IF DISPLAY-HOLD-RECORDS AND
 20558        NOT PB-RECORD-ON-HOLD
 20559          GO TO 4810-READ-PREV-RECORD.
 20560
 20561     IF PB-ISSUE
 20562        IF DISPLAY-CHK-REQ-RECORDS
 20563           GO TO 4810-READ-PREV-RECORD.
 20564
 20565     IF PB-ISSUE
 20566        IF ISSUE-WITH-WARNING
 20567           IF PB-WARNING-ERRORS
 20568              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20569                  GO TO 4810-READ-PREV-RECORD
 20570              ELSE
 20571                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20572                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20573                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20574                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20575                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20576                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20577                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20578                 GO TO 7000-DISPLAY-ISSUES
 20579           ELSE
 20580              GO TO 4810-READ-PREV-RECORD.
 20581
 20582     IF PB-ISSUE
 20583        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 377
* EL6311.cbl
 20584            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20585            ALL-ISSUES
 20586            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20587            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20588            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20589            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20590            MOVE PB-SV-STATE            TO PI-SV-STATE
 20591            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20592            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20593            GO TO 7000-DISPLAY-ISSUES
 20594        ELSE
 20595            GO TO 4810-READ-PREV-RECORD.
 20596
 20597     IF PB-CANCELLATION
 20598        IF DISPLAY-CHK-REQ-RECORDS
 20599           IF PB-C-REFUND-REQUESTED
 20600              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20601              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20602              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20603              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20604              MOVE PB-SV-STATE            TO PI-SV-STATE
 20605              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20606              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20607              GO TO 7100-DISPLAY-CANCELS
 20608           ELSE
 20609              GO TO 4810-READ-PREV-RECORD.
 20610
 20611     IF PB-CANCELLATION
 20612        IF CANCEL-WITH-WARNING
 20613           IF PB-WARNING-ERRORS
 20614              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20615                  GO TO 4810-READ-PREV-RECORD
 20616              ELSE
 20617                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20618                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20619                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20620                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20621                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20622                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20623                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20624                 GO TO 7100-DISPLAY-CANCELS
 20625           ELSE
 20626              GO TO 4810-READ-PREV-RECORD.
 20627
 20628     IF PB-CANCELLATION
 20629        IF (CANCEL-IN-ERROR  AND
 20630            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20631            ALL-CANCELS
 20632            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20633            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20634            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20635            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20636            MOVE PB-SV-STATE            TO PI-SV-STATE
 20637            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20638            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20639            GO TO 7100-DISPLAY-CANCELS.
 20640
 20641     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 378
* EL6311.cbl
 20642
 20643 4850-END-RECORDS.
 20644     MOVE ER-2252                TO EMI-ERROR.
 20645     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20646
 20647     IF PI-MAP-NAME = EL631B
 20648        MOVE -1                  TO BPFENTRL
 20649     ELSE
 20650        MOVE -1                  TO CPFENTRL.
 20651
 20652     GO TO 8200-SEND-DATAONLY.
 20653
 20654 4860-NOT-FOUND.
 20655
 20656******************************************************************
 20657*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20658******************************************************************
 20659
 20660
 20661* EXEC CICS RESETBR
 20662*         DATASET    (FILE-ID-ERPNDB)
 20663*         RIDFLD     (ERPNDB-KEY)
 20664*     END-EXEC.
 20665     MOVE 0
 20666       TO DFHEIV11
 20667*    MOVE '&4         G          &   #00017574' TO DFHEIV0
 20668     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20669     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20670     MOVE X'2020233030303137353734' TO DFHEIV0(25:11)
 20671     CALL 'kxdfhei1' USING DFHEIV0,
 20672           FILE-ID-ERPNDB,
 20673           ERPNDB-KEY,
 20674           DFHEIV99,
 20675           DFHEIV11,
 20676           DFHEIV99
 20677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20678
 20679
 20680
 20681* EXEC CICS READNEXT
 20682*         DATASET    (FILE-ID-ERPNDB)
 20683*         SET        (ADDRESS OF PENDING-BUSINESS)
 20684*         RIDFLD     (ERPNDB-KEY)
 20685*    END-EXEC.
 20686     MOVE 0
 20687       TO DFHEIV11
 20688*    MOVE '&.S                   )   #00017579' TO DFHEIV0
 20689     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20690     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20691     MOVE X'2020233030303137353739' TO DFHEIV0(25:11)
 20692     CALL 'kxdfhei1' USING DFHEIV0,
 20693           FILE-ID-ERPNDB,
 20694           DFHEIV20,
 20695           DFHEIV99,
 20696           ERPNDB-KEY,
 20697           DFHEIV99,
 20698           DFHEIV11,
 20699           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 379
* EL6311.cbl
 20700           DFHEIV99
 20701     SET ADDRESS OF PENDING-BUSINESS TO
 20702         DFHEIV20
 20703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20704
 20705
 20706
 20707* EXEC CICS READPREV
 20708*         DATASET    (FILE-ID-ERPNDB)
 20709*         SET        (ADDRESS OF PENDING-BUSINESS)
 20710*         RIDFLD     (ERPNDB-KEY)
 20711*    END-EXEC.
 20712     MOVE 0
 20713       TO DFHEIV11
 20714*    MOVE '&0S                   )   #00017585' TO DFHEIV0
 20715     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20716     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20717     MOVE X'2020233030303137353835' TO DFHEIV0(25:11)
 20718     CALL 'kxdfhei1' USING DFHEIV0,
 20719           FILE-ID-ERPNDB,
 20720           DFHEIV20,
 20721           DFHEIV99,
 20722           ERPNDB-KEY,
 20723           DFHEIV99,
 20724           DFHEIV11,
 20725           DFHEIV99,
 20726           DFHEIV99
 20727     SET ADDRESS OF PENDING-BUSINESS TO
 20728         DFHEIV20
 20729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20730
 20731
 20732     GO TO 4810-READ-PREV-RECORD.
 20733
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 380
* EL6311.cbl
 20735
 20736******************************************************************
 20737*                                                                *
 20738*           B R O W S E   C S R   B A C K W A R D                *
 20739*                                                                *
 20740******************************************************************
 20741
 20742 4900-BROWSE-CSR-BACKWARD.
 20743
 20744     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20745
 20746
 20747* EXEC CICS HANDLE CONDITION
 20748*         NOTFND   (4970-NOT-FOUND)
 20749*         ENDFILE  (4950-END-RECORDS)
 20750*    END-EXEC
 20751*    MOVE '"$I''                  ! Q #00017605' TO DFHEIV0
 20752     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20754     MOVE X'5120233030303137363035' TO DFHEIV0(25:11)
 20755     CALL 'kxdfhei1' USING DFHEIV0
 20756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20757
 20758
 20759* EXEC CICS STARTBR
 20760*         DATASET   (FILE-ID-ERPNDB4)
 20761*         RIDFLD    (ERPNDB-CSR-KEY)
 20762*    END-EXEC.
 20763     MOVE 0
 20764       TO DFHEIV11
 20765*    MOVE '&,         G          &   #00017610' TO DFHEIV0
 20766     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20767     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20768     MOVE X'2020233030303137363130' TO DFHEIV0(25:11)
 20769     CALL 'kxdfhei1' USING DFHEIV0,
 20770           FILE-ID-ERPNDB4,
 20771           ERPNDB-CSR-KEY,
 20772           DFHEIV99,
 20773           DFHEIV11,
 20774           DFHEIV99
 20775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20776
 20777
 20778     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20779                                    WS-FIRST-TIME-SW.
 20780
 20781 4905-READ-PREV-RECORD.
 20782
 20783* EXEC CICS READPREV
 20784*         DATASET    (FILE-ID-ERPNDB4)
 20785*         SET        (ADDRESS OF PENDING-BUSINESS)
 20786*         RIDFLD     (ERPNDB-CSR-KEY)
 20787*    END-EXEC.
 20788     MOVE 0
 20789       TO DFHEIV11
 20790*    MOVE '&0S                   )   #00017619' TO DFHEIV0
 20791     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20792     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 381
* EL6311.cbl
 20793     MOVE X'2020233030303137363139' TO DFHEIV0(25:11)
 20794     CALL 'kxdfhei1' USING DFHEIV0,
 20795           FILE-ID-ERPNDB4,
 20796           DFHEIV20,
 20797           DFHEIV99,
 20798           ERPNDB-CSR-KEY,
 20799           DFHEIV99,
 20800           DFHEIV11,
 20801           DFHEIV99,
 20802           DFHEIV99
 20803     SET ADDRESS OF PENDING-BUSINESS TO
 20804         DFHEIV20
 20805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20806
 20807
 20808     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20809
 20810     IF WS-BATCH-PREFIX = '#CL'
 20811         GO TO 4905-READ-PREV-RECORD.
 20812
 20813     IF FIRST-TIME
 20814         MOVE SPACE               TO WS-FIRST-TIME-SW
 20815         GO TO 4905-READ-PREV-RECORD.
 20816
 20817     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20818        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20819        GO TO 4950-END-RECORDS.
 20820
 20821     IF PB-BATCH-TRAILER
 20822        GO TO 4905-READ-PREV-RECORD.
 20823
 20824     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20825
 20826     IF  WS-BATCH-PREFIX = '#CL'
 20827         GO TO 4905-READ-PREV-RECORD.
 20828
 20829     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20830        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20831           GO TO 4905-READ-PREV-RECORD
 20832        ELSE
 20833           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20834              GO TO 4910-CHECK-REC-TYPE
 20835           ELSE
 20836              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20837                 GO TO 4910-CHECK-REC-TYPE
 20838              ELSE
 20839                 GO TO 4905-READ-PREV-RECORD.
 20840
 20841     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20842        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20843           GO TO 4905-READ-PREV-RECORD.
 20844
 20845 4910-CHECK-REC-TYPE.
 20846     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20847         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20848             NEXT SENTENCE
 20849         ELSE
 20850             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 382
* EL6311.cbl
 20851
 20852     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20853         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20854             NEXT SENTENCE
 20855        ELSE
 20856             GO TO 4905-READ-PREV-RECORD.
 20857
 20858     IF NOT DISPLAY-CHANGE-RECORDS AND
 20859            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20860        GO TO 4905-READ-PREV-RECORD.
 20861
 20862     IF DISPLAY-HOLD-RECORDS AND
 20863        NOT PB-RECORD-ON-HOLD
 20864          GO TO 4905-READ-PREV-RECORD.
 20865
 20866     IF PB-ISSUE
 20867        IF DISPLAY-CHK-REQ-RECORDS
 20868           GO TO 4905-READ-PREV-RECORD.
 20869
 20870     IF PB-ISSUE
 20871        IF ISSUE-WITH-WARNING
 20872           IF PB-WARNING-ERRORS
 20873              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20874                  GO TO 4505-READ-PREV-RECORD
 20875              ELSE
 20876                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20877                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20878                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20879                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20880                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20881                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20882                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20883                 GO TO 7000-DISPLAY-ISSUES
 20884           ELSE
 20885              GO TO 4905-READ-PREV-RECORD.
 20886
 20887     IF PB-ISSUE
 20888        IF (ISSUES-IN-ERROR AND
 20889            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20890            ALL-ISSUES
 20891            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20892            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20893            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20894            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20895            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20896            MOVE PB-SV-STATE            TO PI-SV-STATE
 20897            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20898            GO TO 7000-DISPLAY-ISSUES
 20899        ELSE
 20900            GO TO 4905-READ-PREV-RECORD.
 20901
 20902     IF PB-CANCELLATION
 20903        IF DISPLAY-CHK-REQ-RECORDS
 20904           IF PB-C-REFUND-REQUESTED
 20905              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20906              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20907              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20908              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 383
* EL6311.cbl
 20909              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20910              MOVE PB-SV-STATE            TO PI-SV-STATE
 20911              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20912              GO TO 7100-DISPLAY-CANCELS
 20913           ELSE
 20914              GO TO 4905-READ-PREV-RECORD.
 20915
 20916     IF PB-CANCELLATION
 20917        IF CANCEL-WITH-WARNING
 20918           IF PB-WARNING-ERRORS
 20919              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20920                  GO TO 4505-READ-PREV-RECORD
 20921              ELSE
 20922                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20923                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20924                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20925                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20926                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20927                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20928                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20929                 GO TO 7100-DISPLAY-CANCELS
 20930           ELSE
 20931              GO TO 4905-READ-PREV-RECORD.
 20932
 20933     IF PB-CANCELLATION
 20934        IF (CANCEL-IN-ERROR  AND
 20935            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20936            ALL-CANCELS
 20937            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20938            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20939            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20940            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20941            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20942            MOVE PB-SV-STATE            TO PI-SV-STATE
 20943            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20944            GO TO 7100-DISPLAY-CANCELS.
 20945
 20946     GO TO 4905-READ-PREV-RECORD.
 20947
 20948 4950-END-RECORDS.
 20949     IF PI-MAP-NAME = EL631B
 20950        MOVE -1                  TO BMAINTL
 20951     ELSE
 20952        IF PI-MAP-NAME = EL631C
 20953           MOVE -1               TO CMAINTL
 20954        ELSE
 20955           MOVE -1               TO DPFENTRL.
 20956
 20957     MOVE ER-2255               TO EMI-ERROR.
 20958     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20959     GO TO 8200-SEND-DATAONLY.
 20960
 20961 4970-NOT-FOUND.
 20962
 20963******************************************************************
 20964*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20965******************************************************************
 20966
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 384
* EL6311.cbl
 20967
 20968* EXEC CICS RESETBR
 20969*         DATASET    (FILE-ID-ERPNDB4)
 20970*         RIDFLD     (ERPNDB-CSR-KEY)
 20971*    END-EXEC.
 20972     MOVE 0
 20973       TO DFHEIV11
 20974*    MOVE '&4         G          &   #00017784' TO DFHEIV0
 20975     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20976     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20977     MOVE X'2020233030303137373834' TO DFHEIV0(25:11)
 20978     CALL 'kxdfhei1' USING DFHEIV0,
 20979           FILE-ID-ERPNDB4,
 20980           ERPNDB-CSR-KEY,
 20981           DFHEIV99,
 20982           DFHEIV11,
 20983           DFHEIV99
 20984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20985
 20986
 20987
 20988* EXEC CICS READNEXT
 20989*         DATASET    (FILE-ID-ERPNDB4)
 20990*         SET        (ADDRESS OF PENDING-BUSINESS)
 20991*         RIDFLD     (ERPNDB-CSR-KEY)
 20992*    END-EXEC.
 20993     MOVE 0
 20994       TO DFHEIV11
 20995*    MOVE '&.S                   )   #00017789' TO DFHEIV0
 20996     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20997     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20998     MOVE X'2020233030303137373839' TO DFHEIV0(25:11)
 20999     CALL 'kxdfhei1' USING DFHEIV0,
 21000           FILE-ID-ERPNDB4,
 21001           DFHEIV20,
 21002           DFHEIV99,
 21003           ERPNDB-CSR-KEY,
 21004           DFHEIV99,
 21005           DFHEIV11,
 21006           DFHEIV99,
 21007           DFHEIV99
 21008     SET ADDRESS OF PENDING-BUSINESS TO
 21009         DFHEIV20
 21010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21011
 21012
 21013
 21014* EXEC CICS READPREV
 21015*         DATASET    (FILE-ID-ERPNDB4)
 21016*         SET        (ADDRESS OF PENDING-BUSINESS)
 21017*         RIDFLD     (ERPNDB-CSR-KEY)
 21018*    END-EXEC.
 21019     MOVE 0
 21020       TO DFHEIV11
 21021*    MOVE '&0S                   )   #00017795' TO DFHEIV0
 21022     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21023     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21024     MOVE X'2020233030303137373935' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 385
* EL6311.cbl
 21025     CALL 'kxdfhei1' USING DFHEIV0,
 21026           FILE-ID-ERPNDB4,
 21027           DFHEIV20,
 21028           DFHEIV99,
 21029           ERPNDB-CSR-KEY,
 21030           DFHEIV99,
 21031           DFHEIV11,
 21032           DFHEIV99,
 21033           DFHEIV99
 21034     SET ADDRESS OF PENDING-BUSINESS TO
 21035         DFHEIV20
 21036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21037
 21038
 21039 4980-READ-PREV-RECORD.
 21040
 21041* EXEC CICS READPREV
 21042*         DATASET    (FILE-ID-ERPNDB4)
 21043*         SET        (ADDRESS OF PENDING-BUSINESS)
 21044*         RIDFLD     (ERPNDB-CSR-KEY)
 21045*    END-EXEC.
 21046     MOVE 0
 21047       TO DFHEIV11
 21048*    MOVE '&0S                   )   #00017802' TO DFHEIV0
 21049     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21050     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21051     MOVE X'2020233030303137383032' TO DFHEIV0(25:11)
 21052     CALL 'kxdfhei1' USING DFHEIV0,
 21053           FILE-ID-ERPNDB4,
 21054           DFHEIV20,
 21055           DFHEIV99,
 21056           ERPNDB-CSR-KEY,
 21057           DFHEIV99,
 21058           DFHEIV11,
 21059           DFHEIV99,
 21060           DFHEIV99
 21061     SET ADDRESS OF PENDING-BUSINESS TO
 21062         DFHEIV20
 21063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21064
 21065
 21066     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21067
 21068     IF WS-BATCH-PREFIX = '#CL'
 21069        GO TO 4980-READ-PREV-RECORD.
 21070
 21071     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21072     GO TO 4905-READ-PREV-RECORD.
 21073
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 386
* EL6311.cbl
 21075
 21076
 21077******************************************************************
 21078*                                                                *
 21079*        B R O W S E   B A T C H   H E A D E R S                 *
 21080*                                                                *
 21081******************************************************************
 21082
 21083 5000-BROWSE-BATCH-HEADERS.
 21084
 21085     IF EIBTRNID NOT = TRANS-EXB1
 21086        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21087        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21088        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21089        GO TO 5010-READ-NEXT-RECORD.
 21090
 21091     IF EIBAID = DFHPF4
 21092        MOVE '0'                TO PI-EDIT-SW
 21093        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21094        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21095        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21096        GO TO 5010-READ-NEXT-RECORD.
 21097
 21098     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21099     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21100     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21101
 21102
 21103* EXEC CICS HANDLE CONDITION
 21104*         ENDFILE  (5050-NOT-FOUND)
 21105*    END-EXEC.
 21106*    MOVE '"$''                   ! R #00017844' TO DFHEIV0
 21107     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21108     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21109     MOVE X'5220233030303137383434' TO DFHEIV0(25:11)
 21110     CALL 'kxdfhei1' USING DFHEIV0
 21111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21112
 21113
 21114 5010-READ-NEXT-RECORD.
 21115
 21116* EXEC CICS HANDLE CONDITION
 21117*         NOTFND    (5050-NOT-FOUND)
 21118*    END-EXEC.
 21119*    MOVE '"$I                   ! S #00017849' TO DFHEIV0
 21120     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21121     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21122     MOVE X'5320233030303137383439' TO DFHEIV0(25:11)
 21123     CALL 'kxdfhei1' USING DFHEIV0
 21124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21125
 21126
 21127
 21128* EXEC CICS READ
 21129*         DATASET   (FILE-ID-ERPNDB)
 21130*         SET       (ADDRESS OF PENDING-BUSINESS)
 21131*         RIDFLD    (ERPNDB-KEY)
 21132*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 387
* EL6311.cbl
 21133*    END-EXEC.
 21134*    MOVE '&"S        G          (   #00017853' TO DFHEIV0
 21135     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21137     MOVE X'2020233030303137383533' TO DFHEIV0(25:11)
 21138     CALL 'kxdfhei1' USING DFHEIV0,
 21139           FILE-ID-ERPNDB,
 21140           DFHEIV20,
 21141           DFHEIV99,
 21142           ERPNDB-KEY,
 21143           DFHEIV99,
 21144           DFHEIV99,
 21145           DFHEIV99
 21146     SET ADDRESS OF PENDING-BUSINESS TO
 21147         DFHEIV20
 21148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21149
 21150
 21151     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21152         GO TO 5050-NOT-FOUND.
 21153
 21154     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21155
 21156     IF WS-BATCH-PREFIX = '#CL'
 21157         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21158         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21159         GO TO 5010-READ-NEXT-RECORD.
 21160
 21161     IF NOT PB-BATCH-TRAILER
 21162         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21163         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21164         GO TO 5010-READ-NEXT-RECORD.
 21165
 21166     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21167         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21168             NEXT SENTENCE
 21169         ELSE
 21170             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21171             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21172             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21173             GO TO 5010-READ-NEXT-RECORD.
 21174
 21175     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21176         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21177             NEXT SENTENCE
 21178        ELSE
 21179             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21180             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21181             GO TO 5010-READ-NEXT-RECORD.
 21182
 21183     IF EIBAID = DFHPF4
 21184        MOVE '0'                TO PI-EDIT-SW
 21185        GO TO 7200-DISPLAY-BATCHES.
 21186
 21187     IF PI-CSR-BROWSE
 21188        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21189           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21190           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 388
* EL6311.cbl
 21191           GO TO 5010-READ-NEXT-RECORD.
 21192
 21193     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21194       IF PI-PB-CARRIER    = SPACES AND
 21195          PI-PB-GROUPING   = SPACES AND
 21196          PI-PB-STATE      = SPACES AND
 21197          PI-PB-ACCOUNT    = SPACES
 21198            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21199            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21200            GO TO 7200-DISPLAY-BATCHES
 21201         ELSE
 21202           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21203              PI-PB-GROUPING   = PB-GROUPING AND
 21204              PI-PB-STATE      = PB-STATE    AND
 21205              PI-PB-ACCOUNT    = PB-ACCOUNT
 21206              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21207              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21208              GO TO 7200-DISPLAY-BATCHES.
 21209
 21210     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21211     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21212
 21213
 21214* EXEC CICS HANDLE CONDITION
 21215*         NOTFND    (5050-NOT-FOUND)
 21216*    END-EXEC.
 21217*    MOVE '"$I                   ! T #00017922' TO DFHEIV0
 21218     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21220     MOVE X'5420233030303137393232' TO DFHEIV0(25:11)
 21221     CALL 'kxdfhei1' USING DFHEIV0
 21222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21223
 21224
 21225
 21226* EXEC CICS READ
 21227*         DATASET   (FILE-ID-ERPNDB)
 21228*         SET       (ADDRESS OF PENDING-BUSINESS)
 21229*         RIDFLD    (ERPNDB-KEY)
 21230*         GTEQ
 21231*    END-EXEC.
 21232*    MOVE '&"S        G          (   #00017926' TO DFHEIV0
 21233     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21234     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21235     MOVE X'2020233030303137393236' TO DFHEIV0(25:11)
 21236     CALL 'kxdfhei1' USING DFHEIV0,
 21237           FILE-ID-ERPNDB,
 21238           DFHEIV20,
 21239           DFHEIV99,
 21240           ERPNDB-KEY,
 21241           DFHEIV99,
 21242           DFHEIV99,
 21243           DFHEIV99
 21244     SET ADDRESS OF PENDING-BUSINESS TO
 21245         DFHEIV20
 21246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21247
 21248
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 389
* EL6311.cbl
 21249     GO TO 5010-READ-NEXT-RECORD.
 21250
 21251 5050-NOT-FOUND.
 21252
 21253******************************************************************
 21254*                                                                *
 21255*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21256*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21257*         PROGRAM.                                               *
 21258*                                                                *
 21259******************************************************************
 21260
 21261     IF EIBTRNID NOT = TRANS-EXB1
 21262        IF PENDING-BUS-RECS-FOUND
 21263            NEXT SENTENCE
 21264          ELSE
 21265            MOVE '9'            TO PI-BROWSE-SW
 21266            GO TO 9400-CLEAR.
 21267
 21268     MOVE ER-2256                TO EMI-ERROR.
 21269     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21270
 21271     IF PI-MAP-NAME = SPACES
 21272        MOVE EL631D              TO PI-MAP-NAME
 21273        MOVE -1                  TO DPFENTRL
 21274        GO TO 8100-SEND-INITIAL-MAP.
 21275
 21276     IF PI-MAP-NAME = EL631B
 21277        MOVE -1                  TO BMAINTL
 21278     ELSE
 21279        IF PI-MAP-NAME = EL631C
 21280           MOVE -1               TO CMAINTL
 21281        ELSE
 21282           MOVE -1               TO DPFENTRL
 21283           GO TO 8200-SEND-DATAONLY.
 21284
 21285     GO TO 8100-SEND-INITIAL-MAP.
 21286
 21287     .
 21288 5100-PROCESS-POL-RESC.
 21289     MOVE ZEROS                  TO CG-LF-BENCD
 21290                                    CG-AH-BENCD
 21291                                    CG-LF-CAN-AMT
 21292                                    CG-AH-CAN-AMT
 21293     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21294                                    CG-AH-CAN-DT
 21295     MOVE SPACES                 TO CG-BATCH-NO
 21296     MOVE '4'                    TO CG-OPTION-CODE
 21297     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21298     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21299     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21300     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21301     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21302     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21303     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21304     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21305     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21306     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 390
* EL6311.cbl
 21307     MOVE PI-PREV-ALT-KEY (1:33)
 21308                                 TO CG-CERT-KEY
 21309     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21310     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21311                                    CG-AH-CAN-AMT
 21312     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21313                                    CG-AH-CAN-DT
 21314     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21315     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21316      display 'about to cancel ' cg-cert-key
 21317
 21318* EXEC CICS LINK
 21319*        PROGRAM  ('ELCANC')
 21320*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21321*    END-EXEC
 21322     MOVE LENGTH OF
 21323      CANCEL-GEN-PASS-AREA
 21324       TO DFHEIV11
 21325     MOVE 'ELCANC' TO DFHEIV1
 21326*    MOVE '."C                   (   #00018001' TO DFHEIV0
 21327     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21329     MOVE X'2020233030303138303031' TO DFHEIV0(25:11)
 21330     CALL 'kxdfhei1' USING DFHEIV0,
 21331           DFHEIV1,
 21332           CANCEL-GEN-PASS-AREA,
 21333           DFHEIV11,
 21334           DFHEIV99,
 21335           DFHEIV99,
 21336           DFHEIV99,
 21337           DFHEIV99
 21338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21339     IF CG-SUCCESS
 21340        CONTINUE
 21341     ELSE
 21342        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21343        MOVE '3'                 TO EMI-SWITCH1
 21344        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21345        EVALUATE TRUE
 21346           WHEN CG-DATE-ERROR
 21347             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21348           WHEN CG-CERT-NOT-FOUND
 21349             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21350           WHEN CG-AMOUNT-ERROR
 21351             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21352           WHEN CG-OPTION-ERROR
 21353             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21354           WHEN CG-PREV-CAN
 21355             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21356           WHEN CG-INVALID-DATA
 21357             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21358           WHEN CG-NO-ACCT-MSTR
 21359             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21360           WHEN CG-SFX-A-EXIST
 21361             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21362           WHEN CG-MISC-ERROR
 21363             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21364           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 391
* EL6311.cbl
 21365             MOVE ' ERROR - ELCANC - RETURN '
 21366                                 TO EMI-ERROR-TEXT (1) (12:25)
 21367        END-EVALUATE
 21368        GO TO 8200-SEND-DATAONLY
 21369     END-IF
 21370     .
 21371 5100-EXIT.
 21372     EXIT.
 21373
 21374******************************************************************
 21375*                                                                *
 21376*        B R O W S E   B A T C H   B A C K W A R D S             *
 21377*                                                                *
 21378******************************************************************
 21379
 21380 5500-BROWSE-BATCH-BACKWARD.
 21381
 21382* EXEC CICS HANDLE CONDITION
 21383*         NOTFND   (5550-END-RECORDS)
 21384*         ENDFILE  (5550-END-RECORDS)
 21385*    END-EXEC.
 21386*    MOVE '"$I''                  ! U #00018047' TO DFHEIV0
 21387     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21388     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21389     MOVE X'5520233030303138303437' TO DFHEIV0(25:11)
 21390     CALL 'kxdfhei1' USING DFHEIV0
 21391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21392
 21393
 21394 5505-START-BROWSE.
 21395     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21396     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21397     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21398
 21399
 21400* EXEC CICS STARTBR
 21401*         DATASET   (FILE-ID-ERPNDB)
 21402*         RIDFLD    (ERPNDB-ALT-KEY)
 21403*    END-EXEC.
 21404     MOVE 0
 21405       TO DFHEIV11
 21406*    MOVE '&,         G          &   #00018057' TO DFHEIV0
 21407     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21408     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21409     MOVE X'2020233030303138303537' TO DFHEIV0(25:11)
 21410     CALL 'kxdfhei1' USING DFHEIV0,
 21411           FILE-ID-ERPNDB,
 21412           ERPNDB-ALT-KEY,
 21413           DFHEIV99,
 21414           DFHEIV11,
 21415           DFHEIV99
 21416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21417
 21418
 21419     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21420
 21421
 21422* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 392
* EL6311.cbl
 21423*         DATASET    (FILE-ID-ERPNDB)
 21424*         SET        (ADDRESS OF PENDING-BUSINESS)
 21425*         RIDFLD     (ERPNDB-KEY)
 21426*    END-EXEC.
 21427     MOVE 0
 21428       TO DFHEIV11
 21429*    MOVE '&.S                   )   #00018064' TO DFHEIV0
 21430     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21431     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21432     MOVE X'2020233030303138303634' TO DFHEIV0(25:11)
 21433     CALL 'kxdfhei1' USING DFHEIV0,
 21434           FILE-ID-ERPNDB,
 21435           DFHEIV20,
 21436           DFHEIV99,
 21437           ERPNDB-KEY,
 21438           DFHEIV99,
 21439           DFHEIV11,
 21440           DFHEIV99,
 21441           DFHEIV99
 21442     SET ADDRESS OF PENDING-BUSINESS TO
 21443         DFHEIV20
 21444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21445
 21446
 21447
 21448* EXEC CICS READPREV
 21449*         DATASET    (FILE-ID-ERPNDB)
 21450*         SET        (ADDRESS OF PENDING-BUSINESS)
 21451*         RIDFLD     (ERPNDB-KEY)
 21452*    END-EXEC.
 21453     MOVE 0
 21454       TO DFHEIV11
 21455*    MOVE '&0S                   )   #00018070' TO DFHEIV0
 21456     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21457     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21458     MOVE X'2020233030303138303730' TO DFHEIV0(25:11)
 21459     CALL 'kxdfhei1' USING DFHEIV0,
 21460           FILE-ID-ERPNDB,
 21461           DFHEIV20,
 21462           DFHEIV99,
 21463           ERPNDB-KEY,
 21464           DFHEIV99,
 21465           DFHEIV11,
 21466           DFHEIV99,
 21467           DFHEIV99
 21468     SET ADDRESS OF PENDING-BUSINESS TO
 21469         DFHEIV20
 21470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21471
 21472
 21473
 21474* EXEC CICS READPREV
 21475*         DATASET    (FILE-ID-ERPNDB)
 21476*         SET        (ADDRESS OF PENDING-BUSINESS)
 21477*         RIDFLD     (ERPNDB-KEY)
 21478*    END-EXEC.
 21479     MOVE 0
 21480       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 393
* EL6311.cbl
 21481*    MOVE '&0S                   )   #00018076' TO DFHEIV0
 21482     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21483     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21484     MOVE X'2020233030303138303736' TO DFHEIV0(25:11)
 21485     CALL 'kxdfhei1' USING DFHEIV0,
 21486           FILE-ID-ERPNDB,
 21487           DFHEIV20,
 21488           DFHEIV99,
 21489           ERPNDB-KEY,
 21490           DFHEIV99,
 21491           DFHEIV11,
 21492           DFHEIV99,
 21493           DFHEIV99
 21494     SET ADDRESS OF PENDING-BUSINESS TO
 21495         DFHEIV20
 21496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21497
 21498
 21499     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21500        GO TO 5550-END-RECORDS.
 21501
 21502     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21503
 21504     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21505
 21506     IF  WS-BATCH-PREFIX = '#CL'
 21507             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21508
 21509* EXEC CICS ENDBR
 21510*                 DATASET  (FILE-ID-ERPNDB)
 21511*            END-EXEC
 21512     MOVE 0
 21513       TO DFHEIV11
 21514*    MOVE '&2                    $   #00018091' TO DFHEIV0
 21515     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21516     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21517     MOVE X'2020233030303138303931' TO DFHEIV0(25:11)
 21518     CALL 'kxdfhei1' USING DFHEIV0,
 21519           FILE-ID-ERPNDB,
 21520           DFHEIV11,
 21521           DFHEIV99
 21522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21523         GO TO 5505-START-BROWSE.
 21524
 21525     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21526         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21527             NEXT SENTENCE
 21528         ELSE
 21529             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21530
 21531* EXEC CICS ENDBR
 21532*                 DATASET  (FILE-ID-ERPNDB)
 21533*            END-EXEC
 21534     MOVE 0
 21535       TO DFHEIV11
 21536*    MOVE '&2                    $   #00018101' TO DFHEIV0
 21537     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21538     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 394
* EL6311.cbl
 21539     MOVE X'2020233030303138313031' TO DFHEIV0(25:11)
 21540     CALL 'kxdfhei1' USING DFHEIV0,
 21541           FILE-ID-ERPNDB,
 21542           DFHEIV11,
 21543           DFHEIV99
 21544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21545             GO TO 5505-START-BROWSE.
 21546
 21547
 21548     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21549         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21550             NEXT SENTENCE
 21551        ELSE
 21552             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21553
 21554* EXEC CICS ENDBR
 21555*                 DATASET  (FILE-ID-ERPNDB)
 21556*            END-EXEC
 21557     MOVE 0
 21558       TO DFHEIV11
 21559*    MOVE '&2                    $   #00018112' TO DFHEIV0
 21560     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21561     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21562     MOVE X'2020233030303138313132' TO DFHEIV0(25:11)
 21563     CALL 'kxdfhei1' USING DFHEIV0,
 21564           FILE-ID-ERPNDB,
 21565           DFHEIV11,
 21566           DFHEIV99
 21567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21568             GO TO 5505-START-BROWSE.
 21569
 21570     IF NOT PB-BATCH-TRAILER
 21571        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21572
 21573* EXEC CICS ENDBR
 21574*            DATASET  (FILE-ID-ERPNDB)
 21575*       END-EXEC
 21576     MOVE 0
 21577       TO DFHEIV11
 21578*    MOVE '&2                    $   #00018119' TO DFHEIV0
 21579     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21580     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21581     MOVE X'2020233030303138313139' TO DFHEIV0(25:11)
 21582     CALL 'kxdfhei1' USING DFHEIV0,
 21583           FILE-ID-ERPNDB,
 21584           DFHEIV11,
 21585           DFHEIV99
 21586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21587        GO TO 5505-START-BROWSE.
 21588
 21589     IF PI-CSR-BROWSE
 21590        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21591           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21592
 21593* EXEC CICS ENDBR
 21594*               DATASET  (FILE-ID-ERPNDB)
 21595*          END-EXEC
 21596     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 395
* EL6311.cbl
 21597       TO DFHEIV11
 21598*    MOVE '&2                    $   #00018127' TO DFHEIV0
 21599     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21600     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21601     MOVE X'2020233030303138313237' TO DFHEIV0(25:11)
 21602     CALL 'kxdfhei1' USING DFHEIV0,
 21603           FILE-ID-ERPNDB,
 21604           DFHEIV11,
 21605           DFHEIV99
 21606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21607           GO TO 5505-START-BROWSE.
 21608
 21609     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21610        IF PI-PB-CARRIER    = SPACES AND
 21611           PI-PB-GROUPING   = SPACES AND
 21612           PI-PB-STATE      = SPACES AND
 21613           PI-PB-ACCOUNT    = SPACES
 21614             GO TO 7200-DISPLAY-BATCHES
 21615          ELSE
 21616            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21617               PI-PB-GROUPING   = PB-GROUPING AND
 21618               PI-PB-STATE      = PB-STATE    AND
 21619               PI-PB-ACCOUNT    = PB-ACCOUNT
 21620                 GO TO 7200-DISPLAY-BATCHES.
 21621
 21622     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21623
 21624
 21625* EXEC CICS ENDBR
 21626*         DATASET  (FILE-ID-ERPNDB)
 21627*    END-EXEC.
 21628     MOVE 0
 21629       TO DFHEIV11
 21630*    MOVE '&2                    $   #00018147' TO DFHEIV0
 21631     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21632     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21633     MOVE X'2020233030303138313437' TO DFHEIV0(25:11)
 21634     CALL 'kxdfhei1' USING DFHEIV0,
 21635           FILE-ID-ERPNDB,
 21636           DFHEIV11,
 21637           DFHEIV99
 21638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21639
 21640
 21641     GO TO 5505-START-BROWSE.
 21642
 21643 5550-END-RECORDS.
 21644     MOVE ER-2257                TO EMI-ERROR.
 21645     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21646     MOVE -1                     TO DPFENTRL.
 21647
 21648     GO TO 8200-SEND-DATAONLY.
 21649
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 396
* EL6311.cbl
 21651
 21652******************************************************************
 21653*                                                                *
 21654*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21655*                                                                *
 21656******************************************************************
 21657
 21658 6000-CREATE-TEMP-STORAGE.
 21659
 21660
 21661* EXEC CICS HANDLE CONDITION
 21662*        QIDERR  (6050-QID-ERROR)
 21663*    END-EXEC.
 21664*    MOVE '"$N                   ! V #00018170' TO DFHEIV0
 21665     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21667     MOVE X'5620233030303138313730' TO DFHEIV0(25:11)
 21668     CALL 'kxdfhei1' USING DFHEIV0
 21669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21670
 21671
 21672
 21673* EXEC CICS WRITEQ TS
 21674*        QUEUE    (QID)
 21675*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21676*        LENGTH   (WS-COMM-LENGTH)
 21677*        ITEM     (W-ONE)
 21678*    END-EXEC.
 21679*    MOVE '*" I                  ''   #00018174' TO DFHEIV0
 21680     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 21681     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21682     MOVE X'2020233030303138313734' TO DFHEIV0(25:11)
 21683     CALL 'kxdfhei1' USING DFHEIV0,
 21684           QID,
 21685           PROGRAM-INTERFACE-BLOCK,
 21686           WS-COMM-LENGTH,
 21687           W-ONE,
 21688           DFHEIV99,
 21689           DFHEIV99
 21690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21691
 21692
 21693 6000-EXIT.
 21694      EXIT.
 21695
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 397
* EL6311.cbl
 21697
 21698******************************************************************
 21699*                                                                *
 21700*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21701*                                                                *
 21702******************************************************************
 21703
 21704 6050-RECOVER-TEMP-STORAGE.
 21705     IF PGM-NAME = XCTL-EL6312
 21706        GO TO 6050-EXIT.
 21707
 21708     IF PGM-NAME = XCTL-EL6313
 21709        GO TO 6050-EXIT.
 21710
 21711     IF PGM-NAME = XCTL-EL6315
 21712         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21713     END-IF
 21714
 21715     IF PGM-NAME = XCTL-EL6316
 21716         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21717     END-IF
 21718
 21719
 21720* EXEC CICS HANDLE CONDITION
 21721*        QIDERR  (6050-QID-ERROR)
 21722*    END-EXEC.
 21723*    MOVE '"$N                   ! W #00018207' TO DFHEIV0
 21724     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21725     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21726     MOVE X'5720233030303138323037' TO DFHEIV0(25:11)
 21727     CALL 'kxdfhei1' USING DFHEIV0
 21728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21729
 21730
 21731
 21732* EXEC CICS READQ TS
 21733*         QUEUE   (QID)
 21734*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21735*         LENGTH  (WS-COMM-LENGTH)
 21736*         ITEM    (W-ONE)
 21737*     END-EXEC.
 21738*    MOVE '*$II   L              ''   #00018211' TO DFHEIV0
 21739     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21740     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21741     MOVE X'2020233030303138323131' TO DFHEIV0(25:11)
 21742     CALL 'kxdfhei1' USING DFHEIV0,
 21743           QID,
 21744           PROGRAM-INTERFACE-BLOCK,
 21745           WS-COMM-LENGTH,
 21746           W-ONE,
 21747           DFHEIV99,
 21748           DFHEIV99
 21749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21750
 21751
 21752 6050-DELETE-TEMP-STORAGE.
 21753
 21754
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 398
* EL6311.cbl
 21755* EXEC CICS DELETEQ TS
 21756*        QUEUE   (QID)
 21757*    END-EXEC.
 21758*    MOVE '*&                    #   #00018220' TO DFHEIV0
 21759     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21760     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21761     MOVE X'2020233030303138323230' TO DFHEIV0(25:11)
 21762     CALL 'kxdfhei1' USING DFHEIV0,
 21763           QID,
 21764           DFHEIV99
 21765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21766
 21767
 21768     GO TO 6050-EXIT.
 21769
 21770 6050-QID-ERROR.
 21771     MOVE ER-0033                TO EMI-ERROR
 21772     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21773
 21774 6050-EXIT.
 21775      EXIT.
 21776
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 399
* EL6311.cbl
 21778
 21779******************************************************************
 21780*                                                                *
 21781*            T E R M   C O N V E R S I O N                       *
 21782*                                                                *
 21783******************************************************************
 21784
 21785 6100-TERM-CONVERSION.
 21786
 21787     IF PI-BPMTS = ZERO
 21788         GO TO 6199-EXIT.
 21789
 21790     IF PI-BMODE = ' ' OR 'M'
 21791         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21792         GO TO 6105-ROUND-TERM.
 21793
 21794     IF PI-BMODE = 'S'
 21795         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21796         GO TO 6105-ROUND-TERM.
 21797
 21798     IF PI-BMODE = 'W'
 21799         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21800         GO TO 6105-ROUND-TERM.
 21801
 21802     IF PI-BMODE = 'B'
 21803         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21804         GO TO 6105-ROUND-TERM.
 21805
 21806     IF PI-BMODE = 'T'
 21807         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21808
 21809 6105-ROUND-TERM.
 21810
 21811     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21812         ADD +1                  TO WS-CALC-TERM-WHOLE
 21813         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21814
 21815     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21816         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21817
 21818     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21819         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21820                                      WS-BTERM    (WS-SUB1)
 21821         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21822
 21823     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21824         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21825             MOVE -1               TO BMODEL
 21826             MOVE ER-2593          TO EMI-ERROR
 21827             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21828             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21829
 21830 6124-CHECK-BENEFIT.
 21831
 21832     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21833        GO TO 6126-COMPUTE-BENEFIT.
 21834
 21835     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 400
* EL6311.cbl
 21836
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 401
* EL6311.cbl
 21838******************************************************************
 21839**         COMPUTE TERM AND BENEFIT
 21840******************************************************************
 21841 6125-COMPUTE-TERM-BENEFIT.
 21842
 21843     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21844        PI-BPMTAMT = ZERO
 21845         GO TO 6199-EXIT.
 21846
 21847     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21848                                     WS-BTERM  (WS-SUB1).
 21849     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21850
 21851 6126-COMPUTE-BENEFIT.
 21852
 21853     IF PI-BMODE = 'M' OR  ' '
 21854         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21855
 21856     IF PI-BMODE = 'W'
 21857         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21858
 21859     IF PI-BMODE = 'S'
 21860         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21861
 21862     IF PI-BMODE = 'B'
 21863         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21864
 21865     IF PI-BMODE = 'T'
 21866         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21867
 21868     IF WS-SUB1 = +1
 21869        COMPUTE WS-BBEN (WS-SUB1) =
 21870                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21871
 21872     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21873     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21874     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21875
 21876 6199-EXIT.
 21877     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 402
* EL6311.cbl
 21879
 21880******************************************************************
 21881*                                                                *
 21882*             D I S P L A Y   I S S U E S                        *
 21883*                                                                *
 21884******************************************************************
 21885
 21886 6200-CREATE-VADS.
 21887     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21888     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21889     MOVE SPACES                 TO WS-PASS-VADS-REC
 21890
 21891* EXEC CICS GETMAIN
 21892*       SET      (ADDRESS OF PENDING-BUSINESS)
 21893*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21894*       INITIMG  (GETMAIN-SPACE)
 21895*       RESP     (WS-RESPONSE)
 21896*    END-EXEC
 21897*    MOVE ',"IL                  $  N#00018346' TO DFHEIV0
 21898     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21899     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21900     MOVE X'204E233030303138333436' TO DFHEIV0(25:11)
 21901     CALL 'kxdfhei1' USING DFHEIV0,
 21902           DFHEIV20,
 21903           ERPNDB-RECORD-LENGTH,
 21904           GETMAIN-SPACE
 21905     SET ADDRESS OF PENDING-BUSINESS TO
 21906         DFHEIV20
 21907     MOVE EIBRESP  TO WS-RESPONSE
 21908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21909
 21910* EXEC CICS READ
 21911*       INTO    (PENDING-BUSINESS)
 21912*       DATASET (FILE-ID-ERPNDB)
 21913*       RIDFLD  (ERPNDB-KEY)
 21914*       RESP    (WS-RESPONSE)
 21915*    END-EXEC
 21916     MOVE LENGTH OF
 21917      PENDING-BUSINESS
 21918       TO DFHEIV11
 21919*    MOVE '&"IL       E          (  N#00018352' TO DFHEIV0
 21920     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21921     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21922     MOVE X'204E233030303138333532' TO DFHEIV0(25:11)
 21923     CALL 'kxdfhei1' USING DFHEIV0,
 21924           FILE-ID-ERPNDB,
 21925           PENDING-BUSINESS,
 21926           DFHEIV11,
 21927           ERPNDB-KEY,
 21928           DFHEIV99,
 21929           DFHEIV99,
 21930           DFHEIV99
 21931     MOVE EIBRESP  TO WS-RESPONSE
 21932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21933     IF RESP-NORMAL
 21934        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21935        IF (RESP-NORMAL)
 21936           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 403
* EL6311.cbl
 21937              AM-CONTROL-PRIMARY (1:20))
 21938           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21939        ELSE
 21940           MOVE 'ACCOUNT NOT FOUND'
 21941                                 TO VD-ACCOUNT-NAME
 21942        END-IF
 21943        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21944                                    TO M1
 21945        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21946        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21947           (A2 > M1)
 21948           OR (WS-WORK-FIELD (A2:1) = '*')
 21949           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21950           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21951        END-PERFORM
 21952        IF A2 > M1
 21953           CONTINUE
 21954        ELSE
 21955           MOVE WS-WORK-FIELD (1:A2 - 1)
 21956                                    TO VD-ACCOUNT-NAME
 21957        END-IF
 21958        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21959        MOVE PB-CARRIER          TO VD-CARRIER
 21960        MOVE PB-GROUPING         TO VD-GROUPING
 21961        MOVE PB-STATE            TO VD-STATE
 21962        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21963        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21964        MOVE PB-CERT-NO          TO VD-CERT-NO
 21965        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21966        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21967        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21968        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21969        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21970        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21971        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21972        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21973        MOVE PB-CSR-ID           TO VD-CSR-ID
 21974        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21975        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21976        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21977        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21978        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21979        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21980        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21981        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21982        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21983        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21984        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21985        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21986        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21987     END-IF
 21988     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21989
 21990
 21991* EXEC CICS GETMAIN
 21992*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21993*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21994*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 404
* EL6311.cbl
 21995*       RESP     (WS-RESPONSE)
 21996*    END-EXEC
 21997*    MOVE ',"IL                  $  N#00018415' TO DFHEIV0
 21998     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21999     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22000     MOVE X'204E233030303138343135' TO DFHEIV0(25:11)
 22001     CALL 'kxdfhei1' USING DFHEIV0,
 22002           DFHEIV20,
 22003           ERPNDM-RECORD-LENGTH,
 22004           GETMAIN-SPACE
 22005     SET ADDRESS OF PENDING-MAILING-DATA TO
 22006         DFHEIV20
 22007     MOVE EIBRESP  TO WS-RESPONSE
 22008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22009
 22010
 22011* EXEC CICS READ
 22012*       INTO    (PENDING-MAILING-DATA)
 22013*       DATASET (FILE-ID-ERPNDM)
 22014*       RIDFLD  (ERPNDM-KEY)
 22015*       RESP    (WS-RESPONSE)
 22016*    END-EXEC
 22017     MOVE LENGTH OF
 22018      PENDING-MAILING-DATA
 22019       TO DFHEIV11
 22020*    MOVE '&"IL       E          (  N#00018422' TO DFHEIV0
 22021     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22022     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22023     MOVE X'204E233030303138343232' TO DFHEIV0(25:11)
 22024     CALL 'kxdfhei1' USING DFHEIV0,
 22025           FILE-ID-ERPNDM,
 22026           PENDING-MAILING-DATA,
 22027           DFHEIV11,
 22028           ERPNDM-KEY,
 22029           DFHEIV99,
 22030           DFHEIV99,
 22031           DFHEIV99
 22032     MOVE EIBRESP  TO WS-RESPONSE
 22033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22034
 22035     IF RESP-NORMAL
 22036        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22037        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22038        MOVE PM-CITY              TO VD-INSURED-CITY
 22039        MOVE PM-STATE             TO VD-INSURED-STATE
 22040        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22041     END-IF
 22042
 22043     MOVE 'VAC1'                  TO VD-LETTER-ID
 22044     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22045     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22046     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22047     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22048     MOVE +0                      TO VD-ARCHIVE-NO
 22049     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22050     .
 22051 6200-EXIT.
 22052     EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 405
* EL6311.cbl
 22053 6210-READ-ERACCT.
 22054     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22055     MOVE LOW-VALUES             TO ERACCT-FILL
 22056
 22057* EXEC CICS READ
 22058*         DATASET   ('ERACCT')
 22059*         INTO      (ACCOUNT-MASTER)
 22060*         RIDFLD    (ERACCT-KEY)
 22061*         GTEQ
 22062*         RESP      (WS-RESPONSE)
 22063*    END-EXEC
 22064     MOVE LENGTH OF
 22065      ACCOUNT-MASTER
 22066       TO DFHEIV11
 22067     MOVE 'ERACCT' TO DFHEIV1
 22068*    MOVE '&"IL       G          (  N#00018450' TO DFHEIV0
 22069     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22070     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22071     MOVE X'204E233030303138343530' TO DFHEIV0(25:11)
 22072     CALL 'kxdfhei1' USING DFHEIV0,
 22073           DFHEIV1,
 22074           ACCOUNT-MASTER,
 22075           DFHEIV11,
 22076           ERACCT-KEY,
 22077           DFHEIV99,
 22078           DFHEIV99,
 22079           DFHEIV99
 22080     MOVE EIBRESP  TO WS-RESPONSE
 22081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22082     .
 22083 6210-EXIT.
 22084     EXIT.
 22085
 22086 6220-READ-ERMAIL.
 22087
 22088     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22089     MOVE ' '                    TO WS-ERMAIL-SW
 22090
 22091
 22092* EXEC CICS READ
 22093*       DATASET   (FILE-ID-ERMAIL)
 22094*       SET       (ADDRESS OF MAILING-DATA)
 22095*       RIDFLD    (ERMAIL-KEY)
 22096*       RESP      (WS-RESPONSE)
 22097*    END-EXEC
 22098*    MOVE '&"S        E          (  N#00018466' TO DFHEIV0
 22099     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22100     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22101     MOVE X'204E233030303138343636' TO DFHEIV0(25:11)
 22102     CALL 'kxdfhei1' USING DFHEIV0,
 22103           FILE-ID-ERMAIL,
 22104           DFHEIV20,
 22105           DFHEIV99,
 22106           ERMAIL-KEY,
 22107           DFHEIV99,
 22108           DFHEIV99,
 22109           DFHEIV99
 22110     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 406
* EL6311.cbl
 22111         DFHEIV20
 22112     MOVE EIBRESP  TO WS-RESPONSE
 22113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22114
 22115     IF RESP-NORMAL
 22116        SET ERMAIL-FOUND TO TRUE
 22117     END-IF
 22118     .
 22119 6220-EXIT.
 22120     EXIT.
 22121
 22122 6400-CHECK-FOR-RES-REF-CLAIM.
 22123     display 'made it to 6400- for ' pi-cert-no
 22124     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22125
 22126     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22127                                    W-CL-COMP-CD.
 22128     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22129                                    W-CL-CERT-NO.
 22130     MOVE SPACES                 TO MSTR-CERT-SFX.
 22131
 22132
 22133* EXEC CICS HANDLE CONDITION
 22134*        NOTFND  (6400-CONTINUE)
 22135*        ENDFILE (6400-CONTINUE)
 22136*    END-EXEC.
 22137*    MOVE '"$I''                  ! X #00018490' TO DFHEIV0
 22138     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22140     MOVE X'5820233030303138343930' TO DFHEIV0(25:11)
 22141     CALL 'kxdfhei1' USING DFHEIV0
 22142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22143
 22144
 22145
 22146* EXEC CICS IGNORE CONDITION
 22147*        DUPKEY
 22148*    END-EXEC.
 22149*    MOVE '"*$                   !   #00018495' TO DFHEIV0
 22150     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22152     MOVE X'2020233030303138343935' TO DFHEIV0(25:11)
 22153     CALL 'kxdfhei1' USING DFHEIV0
 22154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22155
 22156
 22157
 22158* EXEC CICS STARTBR
 22159*        DATASET   (CLMS-ID)
 22160*        RIDFLD    (ELMSTR-KEY)
 22161*        GENERIC   EQUAL
 22162*        KEYLENGTH (ELMSTR-LENGTH)
 22163*    END-EXEC.
 22164     MOVE 0
 22165       TO DFHEIV11
 22166*    MOVE '&,   KG    E          &   #00018499' TO DFHEIV0
 22167     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22168     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 407
* EL6311.cbl
 22169     MOVE X'2020233030303138343939' TO DFHEIV0(25:11)
 22170     CALL 'kxdfhei1' USING DFHEIV0,
 22171           CLMS-ID,
 22172           ELMSTR-KEY,
 22173           ELMSTR-LENGTH,
 22174           DFHEIV11,
 22175           DFHEIV99
 22176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22177
 22178
 22179     display 'browse started'
 22180     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22181
 22182 6400-NEXT-CLAIM.
 22183
 22184
 22185* EXEC CICS READNEXT
 22186*        DATASET   (CLMS-ID)
 22187*        RIDFLD    (ELMSTR-KEY)
 22188*        SET       (ADDRESS OF CLAIM-MASTER)
 22189*    END-EXEC.
 22190     MOVE 0
 22191       TO DFHEIV11
 22192*    MOVE '&.S                   )   #00018511' TO DFHEIV0
 22193     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22194     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22195     MOVE X'2020233030303138353131' TO DFHEIV0(25:11)
 22196     CALL 'kxdfhei1' USING DFHEIV0,
 22197           CLMS-ID,
 22198           DFHEIV20,
 22199           DFHEIV99,
 22200           ELMSTR-KEY,
 22201           DFHEIV99,
 22202           DFHEIV11,
 22203           DFHEIV99,
 22204           DFHEIV99
 22205     SET ADDRESS OF CLAIM-MASTER TO
 22206         DFHEIV20
 22207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22208
 22209
 22210     display 'read claim for ' mstr-cert-no
 22211     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22212        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22213         GO TO 6400-CONTINUE
 22214     END-IF.
 22215
 22216     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22217        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22218        PI-STATE       NOT = CL-CERT-STATE     OR
 22219        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22220        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22221         GO TO 6400-NEXT-CLAIM
 22222     END-IF.
 22223
 22224     display 'found claim ' cl-claim-no
 22225        ' with denial type ' cl-denial-type
 22226     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 408
* EL6311.cbl
 22227         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22228         GO TO 6400-CONTINUE
 22229     END-IF.
 22230
 22231     GO TO 6400-NEXT-CLAIM.
 22232
 22233 6400-CONTINUE.
 22234
 22235     IF WS-BROWSE-STARTED-SW = 'Y'
 22236
 22237* EXEC CICS ENDBR
 22238*            DATASET   (CLMS-ID)
 22239*        END-EXEC
 22240     MOVE 0
 22241       TO DFHEIV11
 22242*    MOVE '&2                    $   #00018543' TO DFHEIV0
 22243     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22244     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22245     MOVE X'2020233030303138353433' TO DFHEIV0(25:11)
 22246     CALL 'kxdfhei1' USING DFHEIV0,
 22247           CLMS-ID,
 22248           DFHEIV11,
 22249           DFHEIV99
 22250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22251         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22252     END-IF.
 22253
 22254 6400-EXIT.
 22255     EXIT.
 22256
 22257 7000-DISPLAY-ISSUES.
 22258
 22259     IF PI-DISPLAY-ORIGINAL-BATCH
 22260        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22261        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22262     ELSE
 22263        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22264
 22265     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22266
 22267     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22268     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22269
 22270     MOVE LOW-VALUES                 TO EL631BI.
 22271     MOVE ZEROS                      TO PI-BPMTAMT
 22272                                        PI-BPMTS.
 22273     MOVE SPACE                      TO PI-BMODE
 22274                                        PI-BTYPE (1)
 22275                                        PI-BTYPE (2).
 22276     MOVE EL631B                     TO PI-MAP-NAME.
 22277     MOVE 'Y'                        TO PI-BROWSE-SW.
 22278     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22279                                        PI-HIGH-SEQ-NO.
 22280
 22281     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22282        MOVE AL-SABOF                TO BCHGTA
 22283        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22284        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 409
* EL6311.cbl
 22285     ELSE
 22286        MOVE AL-SADOF                TO BCHGTA
 22287                                        BCHGA
 22288        MOVE PB-CHG-COUNT            TO BCHGO.
 22289
 22290     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22291     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22292     MOVE WS-HR-MINS                 TO BMANTATO.
 22293
 22294     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22295        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22296        MOVE SPACE                   TO DC-OPTION-CODE
 22297        PERFORM 9700-DATE-LINK
 22298        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22299        MOVE 'INACTIVE'              TO BMOENDTO
 22300     ELSE
 22301        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22302        MOVE SPACE                   TO DC-OPTION-CODE
 22303        PERFORM 9700-DATE-LINK
 22304        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22305        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22306        MOVE SPACE                   TO DC-OPTION-CODE
 22307        PERFORM 9700-DATE-LINK
 22308        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22309
 22310*    MOVE PB-I-REFERENCE             TO BREFO.
 22311
 22312*    IF PI-COMPANY-ID EQUAL 'HER'
 22313*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22314*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22315*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22316*                MOVE WS-MEMBER-NO-1-8
 22317*                                TO  BMICRNOO.
 22318
 22319*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22320*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22321*            MOVE PB-I-MICROFILM-NO
 22322*                                TO  BMICRNOO.
 22323     IF PB-I-VIN NOT = SPACES
 22324        MOVE PB-I-VIN            TO BVINO
 22325     END-IF
 22326
 22327     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22328     MOVE PB-CERT-SFX                TO BSUFIXO.
 22329     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22330     MOVE SPACE                      TO DC-OPTION-CODE.
 22331     PERFORM 9700-DATE-LINK.
 22332     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22333
 22334     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22335     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22336     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22337     MOVE PB-I-INSURED-SEX           TO BSEXO
 22338
 22339     IF PB-I-AGE NOT = ZEROS
 22340         MOVE PB-I-AGE               TO BAGEO.
 22341
 22342     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 410
* EL6311.cbl
 22343                                 TO ELCERT-KEY
 22344     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22345     IF NOT CERT-TRL-REC-NOT-FOUND
 22346         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22347             MOVE 'AGE*'             TO BAGEDEFO
 22348         ELSE
 22349             MOVE 'AGE '             TO BAGEDEFO
 22350         END-IF
 22351     ELSE
 22352         MOVE 'AGE '             TO BAGEDEFO
 22353     END-IF
 22354
 22355     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22356         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22357         MOVE SPACE                  TO DC-OPTION-CODE
 22358         PERFORM 9700-DATE-LINK
 22359         IF NO-CONVERSION-ERROR
 22360            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22361
 22362     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22363         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22364         MOVE SPACE                  TO DC-OPTION-CODE
 22365         PERFORM 9700-DATE-LINK
 22366         IF NO-CONVERSION-ERROR
 22367            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22368
 22369     IF PB-I-EXTENTION-DAYS NUMERIC
 22370        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22371           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22372        ELSE
 22373           IF PB-I-TERM-IN-DAYS NUMERIC
 22374              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22375                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22376
 22377     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22378        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22379
 22380     MOVE PB-FORCE-CODE              TO BFORCEO.
 22381     MOVE PB-I-TERM-TYPE             TO BMODEO
 22382                                        PI-BMODE.
 22383
 22384     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22385        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22386
 22387     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22388         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22389                                        PI-BPMTS.
 22390
 22391     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22392         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22393           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22394                                        PI-BPMTAMT.
 22395
 22396     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22397     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22398     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22399     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22400     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 411
* EL6311.cbl
 22401     MOVE PB-I-SIG-SW                TO BSIGO.
 22402     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22403     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22404     MOVE PB-RECORD-BILL             TO BBILCDO.
 22405     MOVE PB-FORCE-CODE              TO BFORCEO.
 22406
 22407     IF (PB-I-LIVES NUMERIC)
 22408        AND (PB-I-LIVES > ZEROS)
 22409        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22410        IF (RESP-NORMAL)
 22411           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22412           CONTINUE
 22413        ELSE
 22414           MOVE PB-I-LIVES       TO BLIVESO
 22415        END-IF
 22416     END-IF
 22417
 22418     IF PB-I-NUM-BILLED NUMERIC AND
 22419        PB-I-NUM-BILLED GREATER THAN ZEROS
 22420        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22421*    ELSE
 22422*       MOVE ZEROS                   TO BBILLEDO.
 22423
 22424     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22425
 22426     IF PB-I-LOAN-APR NOT = +99.9999
 22427        MOVE PB-I-LOAN-APR           TO BAPRO.
 22428
 22429     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22430        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22431
 22432     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22433        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22434           MOVE AL-SANOF                TO BORIGHDA
 22435           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22436           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22437
 22438     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22439
 22440     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22441        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22442
 22443     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22444        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22445                                        PI-BTYPE (1).
 22446
 22447     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22448        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22449
 22450     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22451        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22452
 22453     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22454        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22455
 22456     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22457        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22458
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 412
* EL6311.cbl
 22459     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22460        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22461
 22462     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22463         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22464         MOVE SPACE                  TO DC-OPTION-CODE
 22465         PERFORM 9700-DATE-LINK
 22466         IF NO-CONVERSION-ERROR
 22467            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22468
 22469     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22470        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22471        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22472        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22473        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22474                 GIVING BDIFFO (1)
 22475     ELSE
 22476        MOVE SPACES                  TO BBEN-CD     (1)
 22477                                        BBEN-ABBR   (1).
 22478
 22479     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22480        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22481        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22482                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22483
 22484     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22485       IF PB-RECORD-ON-HOLD
 22486          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22487
 22488     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22489       IF PB-RECORD-RETURNED
 22490          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22491
 22492     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22493        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22494             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22495
 22496     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22497
 22498     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22499        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22500
 22501     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22502        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22503                                        PI-BTYPE (2).
 22504
 22505     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22506        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22507
 22508     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22509        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22510
 22511     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22512        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22513
 22514     IF PB-I-TOT-FEES NOT NUMERIC
 22515        MOVE ZEROS               TO PB-I-TOT-FEES
 22516     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 413
* EL6311.cbl
 22517     IF PB-I-TOT-FEES > ZEROS
 22518        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22519
 22520     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22521         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22522         MOVE SPACE                  TO DC-OPTION-CODE
 22523         PERFORM 9700-DATE-LINK
 22524         IF NO-CONVERSION-ERROR
 22525            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22526
 22527     IF PB-I-TOT-FEES > ZEROS
 22528        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22529        SUBTRACT PB-I-TOT-FEES FROM
 22530                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22531
 22532     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22533        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22534        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22535        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22536        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22537                 GIVING BDIFFO (2)
 22538     ELSE
 22539        MOVE SPACES                  TO BBEN-CD     (2)
 22540                                        BBEN-ABBR   (2).
 22541
 22542     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22543       IF PB-RECORD-ON-HOLD
 22544          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22545
 22546     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22547       IF PB-RECORD-RETURNED
 22548          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22549
 22550     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22551        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22552             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22553
 22554     MOVE PB-CSR-ID                  TO BCSRO.
 22555
 22556     IF PI-COMPANY-ID  =  'DMD'
 22557        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22558            NEXT SENTENCE
 22559        ELSE
 22560            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22561               MOVE 'NEW CERT'       TO BNCERTLI
 22562               MOVE EC-NEW-CERT      TO BNCERTO.
 22563
 22564     IF PI-COMPANY-ID  =  'DMD'
 22565        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22566            NEXT SENTENCE
 22567        ELSE
 22568           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22569               MOVE 'NEW STATE'      TO BNSTATLI
 22570               MOVE EC-NEW-STATE     TO BNSTATO.
 22571
 22572 7000-CONTINUE.
 22573     MOVE 'C'                        TO BMAINTI.
 22574     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 414
* EL6311.cbl
 22575
 22576     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22577        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22578
 22579     IF PI-6315-FINALIZED = 'Y'   AND
 22580        PB-UNFORCED-ERRORS
 22581          MOVE -1                TO BFORCEL
 22582          MOVE  1                TO SET-CURSOR-SW
 22583     END-IF
 22584
 22585     IF NO-CURSOR-SET
 22586        MOVE -1                      TO BMAINTL.
 22587
 22588     GO TO 8100-SEND-INITIAL-MAP.
 22589
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 415
* EL6311.cbl
 22591
 22592******************************************************************
 22593*                                                                *
 22594*             D I S P L A Y   C A N C E L S                      *
 22595*                                                                *
 22596******************************************************************
 22597
 22598 7100-DISPLAY-CANCELS.
 22599     IF PI-DISPLAY-ORIGINAL-BATCH
 22600        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22601        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22602     ELSE
 22603        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22604
 22605     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22606
 22607     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22608     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22609
 22610     MOVE LOW-VALUES                 TO EL631CI.
 22611     MOVE EL631C                     TO PI-MAP-NAME.
 22612     MOVE 'Y'                        TO PI-BROWSE-SW.
 22613     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22614                                        PI-HIGH-SEQ-NO.
 22615
 22616     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22617        MOVE AL-SABOF                TO CCHGTA
 22618        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22619        MOVE AL-SANON                TO CCHGA
 22620      ELSE
 22621        MOVE AL-SADOF                TO CCHGTA
 22622                                        CCHGA
 22623        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22624
 22625*    MOVE PB-C-REFERENCE             TO CREFO.
 22626
 22627*    IF PB-C-MICROFILM-NO IS NUMERIC
 22628*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22629*          MOVE PB-C-MICROFILM-NO
 22630*                                TO CMICRNOO
 22631*          MOVE AL-UNNON         TO CMICRNOA
 22632*       END-IF
 22633*    END-IF
 22634     IF PB-C-NH-INT-ON-REFS NUMERIC
 22635        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22636           MOVE PB-C-NH-INT-ON-REFS
 22637                                 TO CNHINTO
 22638           MOVE AL-SANOF         TO CNHINTA
 22639        END-IF
 22640     END-IF
 22641     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22642     MOVE PB-CERT-SFX                TO CSUFIXO.
 22643     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22644     MOVE SPACE                      TO DC-OPTION-CODE.
 22645     PERFORM 9700-DATE-LINK.
 22646     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22647
 22648     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 416
* EL6311.cbl
 22649        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22650        MOVE SPACE                   TO DC-OPTION-CODE
 22651        PERFORM 9700-DATE-LINK
 22652        IF NO-CONVERSION-ERROR
 22653           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22654
 22655     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22656        NEXT SENTENCE
 22657     ELSE
 22658        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22659
 22660     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22661        NEXT SENTENCE
 22662     ELSE
 22663        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22664
 22665     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22666        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22667        MOVE SPACE                   TO DC-OPTION-CODE
 22668        PERFORM 9700-DATE-LINK
 22669        IF NO-CONVERSION-ERROR
 22670           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22671
 22672     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22673         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22674
 22675     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22676         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22677
 22678     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22679        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22680        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22681                 GIVING CDRFND1O.
 22682
 22683     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22684        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22685        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22686                 GIVING CDRFND2O.
 22687
 22688     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22689       IF PB-RECORD-ON-HOLD
 22690          MOVE 'ON HOLD'             TO CBILIT1O.
 22691
 22692     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22693       IF PB-RECORD-RETURNED
 22694          MOVE 'RETURNED'            TO CBILIT1O.
 22695
 22696     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22697        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22698             MOVE 'OVERRIDE'         TO CBILIT1O.
 22699
 22700     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22701       IF PB-RECORD-ON-HOLD
 22702          MOVE 'ON HOLD'             TO CBILIT2O.
 22703
 22704     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22705       IF PB-RECORD-RETURNED
 22706          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 417
* EL6311.cbl
 22707
 22708     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22709        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22710             MOVE 'OVERRIDE'         TO CBILIT2O.
 22711
 22712     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22713     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22714     IF PB-C-POST-CARD-IND = 'Y'
 22715        MOVE 'Y'                     TO CPCYNO
 22716     ELSE
 22717        MOVE 'N'                     TO CPCYNO
 22718     END-IF
 22719     MOVE PB-FORCE-CODE              TO CFORCEO.
 22720     MOVE PB-RECORD-BILL             TO CBILCDO.
 22721     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22722     MOVE SPACES                     TO CINITSO.
 22723     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22724         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22725     ELSE
 22726         MOVE PB-CI-INITIALS         TO CINITSO
 22727     END-IF.
 22728
 22729     IF PB-CI-CANCEL-FEE NUMERIC
 22730        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22731        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22732     ELSE
 22733        MOVE ZEROES                  TO W-CANCEL-FEE.
 22734
 22735     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22736
 22737     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22738        ADD PB-CI-LF-PREMIUM-AMT
 22739             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22740
 22741     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22742        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22743
 22744     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22745     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22746     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22747     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22748
 22749     IF PB-C-LIVES NUMERIC
 22750        MOVE PB-C-LIVES              TO CLIVESO.
 22751
 22752     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22753        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22754
 22755     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22756        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22757        MOVE SPACE                   TO DC-OPTION-CODE
 22758        PERFORM 9700-DATE-LINK
 22759        IF NO-CONVERSION-ERROR
 22760           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22761
 22762     IF  PB-C-REFUND-CREATED
 22763         MOVE 'YES'                  TO CRFNDSWO
 22764     ELSE
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 418
* EL6311.cbl
 22765         IF PB-C-REFUND-REQUESTED
 22766            MOVE 'REQ'               TO CRFNDSWO
 22767         ELSE
 22768            MOVE 'NO'                TO CRFNDSWO.
 22769
 22770     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22771     MOVE SPACE                      TO DC-OPTION-CODE.
 22772     PERFORM 9700-DATE-LINK.
 22773     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22774     MOVE PB-INPUT-BY                TO CENTBYO.
 22775
 22776     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22777        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22778        MOVE SPACE                   TO DC-OPTION-CODE
 22779        PERFORM 9700-DATE-LINK
 22780        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22781        MOVE 'INACTIVE'              TO CMOENDTO
 22782     ELSE
 22783        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22784        MOVE SPACE                   TO DC-OPTION-CODE
 22785        PERFORM 9700-DATE-LINK
 22786        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22787        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22788        MOVE SPACE                   TO DC-OPTION-CODE
 22789        PERFORM 9700-DATE-LINK
 22790        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22791
 22792     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22793
 22794     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22795     MOVE WS-HR-MINS                 TO CMANTATO.
 22796
 22797     EVALUATE PB-LF-REFUND-TYPE
 22798        WHEN '1'
 22799           MOVE 'RULE78'            TO CLFREFNO
 22800        WHEN '2'
 22801           MOVE 'PRORAT'            TO CLFREFNO
 22802        WHEN '3'
 22803           MOVE 'CALIF'             TO CLFREFNO
 22804        WHEN '4'
 22805           MOVE 'IRREG'             TO CLFREFNO
 22806        WHEN '5'
 22807           MOVE 'NETPAY'            TO CLFREFNO
 22808        WHEN '6'
 22809           MOVE 'ATCP'              TO CLFREFNO
 22810        WHEN '7'
 22811           MOVE 'UTAH'              TO CLFREFNO
 22812        WHEN '8'
 22813           MOVE 'MEAN'              TO CLFREFNO
 22814        WHEN '9'
 22815           MOVE 'SUM '              TO CLFREFNO
 22816        WHEN 'B'
 22817           MOVE 'BALN'              TO CLFREFNO
 22818     END-EVALUATE.
 22819
 22820     EVALUATE TRUE
 22821        WHEN PB-AH-REFUND-TYPE =  '1'
 22822           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 419
* EL6311.cbl
 22823        WHEN PB-AH-REFUND-TYPE =  '2'
 22824           MOVE 'PRORAT'            TO CAHREFNO
 22825        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22826           MOVE 'CALIF'             TO CAHREFNO
 22827        WHEN PB-AH-REFUND-TYPE =  '4'
 22828           MOVE 'IRREG'             TO CAHREFNO
 22829        WHEN PB-AH-REFUND-TYPE =  '5'
 22830           MOVE 'NETPAY'            TO CAHREFNO
 22831        WHEN PB-AH-REFUND-TYPE =  '6'
 22832           MOVE 'ATCP'              TO CAHREFNO
 22833        WHEN PB-AH-REFUND-TYPE =  '7'
 22834           MOVE 'UTAH'              TO CAHREFNO
 22835        WHEN PB-AH-REFUND-TYPE =  '8'
 22836           MOVE 'MEAN'              TO CAHREFNO
 22837        WHEN PB-AH-REFUND-TYPE =  '9'
 22838           MOVE 'SUM '              TO CAHREFNO
 22839        WHEN PB-AH-REFUND-TYPE =  'B'
 22840           MOVE 'BALN'              TO CAHREFNO
 22841     END-EVALUATE.
 22842
 22843     MOVE PB-REIN-CD                 TO CREINCDO.
 22844
 22845     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22846        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22847        MOVE SPACE                   TO DC-OPTION-CODE
 22848        PERFORM 9700-DATE-LINK
 22849        IF NO-CONVERSION-ERROR
 22850           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22851
 22852     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22853        MOVE 999999                  TO WS-EXP-DT-EDIT
 22854        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22855        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22856     ELSE
 22857        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22858           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22859           MOVE SPACE                   TO DC-OPTION-CODE
 22860           PERFORM 9700-DATE-LINK
 22861           IF NO-CONVERSION-ERROR
 22862              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22863
 22864     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22865        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22866           MOVE AL-SANOF                TO CORIGHDA
 22867           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22868           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22869
 22870     MOVE PB-CSR-ID              TO CCSRO.
 22871
 22872     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22873     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22874
 22875     MOVE 'C'                    TO CMAINTI.
 22876     MOVE AL-UANON               TO CMAINTA.
 22877
 22878     IF PI-6316-FINALIZED = 'Y'  AND
 22879        PB-UNFORCED-ERRORS
 22880          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 420
* EL6311.cbl
 22881          MOVE  1                TO SET-CURSOR-SW
 22882     END-IF
 22883
 22884     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22885        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22886
 22887     IF NO-CURSOR-SET
 22888        MOVE -1                  TO CMAINTL.
 22889
 22890     GO TO 8100-SEND-INITIAL-MAP.
 22891
 22892
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 421
* EL6311.cbl
 22894***************************************************************
 22895*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22896*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22897***************************************************************
 22898
 22899 7200-DISPLAY-BATCHES.
 22900     MOVE EL631D                 TO PI-MAP-NAME.
 22901     MOVE LOW-VALUES             TO EL631DI.
 22902
 22903     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22904
 22905
 22906* EXEC CICS HANDLE CONDITION
 22907*         NOTFND   (3690-NOT-FOUND)
 22908*    END-EXEC.
 22909*    MOVE '"$I                   ! Y #00019200' TO DFHEIV0
 22910     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22911     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22912     MOVE X'5920233030303139323030' TO DFHEIV0(25:11)
 22913     CALL 'kxdfhei1' USING DFHEIV0
 22914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22915
 22916
 22917     IF PI-DISPLAY-SCREEN
 22918        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22919     ELSE
 22920        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22921
 22922     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22923     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22924
 22925
 22926* EXEC CICS READ
 22927*         DATASET   (FILE-ID-ERPNDB)
 22928*         RIDFLD    (ERPNDB-KEY)
 22929*         SET       (ADDRESS OF PENDING-BUSINESS)
 22930*    END-EXEC.
 22931*    MOVE '&"S        E          (   #00019212' TO DFHEIV0
 22932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22933     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22934     MOVE X'2020233030303139323132' TO DFHEIV0(25:11)
 22935     CALL 'kxdfhei1' USING DFHEIV0,
 22936           FILE-ID-ERPNDB,
 22937           DFHEIV20,
 22938           DFHEIV99,
 22939           ERPNDB-KEY,
 22940           DFHEIV99,
 22941           DFHEIV99,
 22942           DFHEIV99
 22943     SET ADDRESS OF PENDING-BUSINESS TO
 22944         DFHEIV20
 22945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22946
 22947
 22948     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22949     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22950     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22951     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 422
* EL6311.cbl
 22952     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22953
 22954     MOVE EL631D                 TO PI-MAP-NAME.
 22955     MOVE LOW-VALUES             TO EL631DI.
 22956     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22957
 22958*    IF PI-AR-PROCESSING
 22959*       MOVE PB-REFERENCE        TO DREFO.
 22960
 22961     MOVE PB-CSR-ID              TO DCSRO.
 22962
 22963     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22964        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22965        MOVE SPACE               TO DC-OPTION-CODE
 22966        PERFORM 9700-DATE-LINK
 22967        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22968        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22969        MOVE 'INACTIVE'          TO DLDATEO
 22970     ELSE
 22971        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22972        MOVE SPACE               TO DC-OPTION-CODE
 22973        PERFORM 9700-DATE-LINK
 22974        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22975
 22976     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22977     MOVE SPACE                  TO DC-OPTION-CODE.
 22978     PERFORM 9700-DATE-LINK.
 22979     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22980
 22981     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22982        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22983     ELSE
 22984        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22985        MOVE SPACE               TO DC-OPTION-CODE
 22986        PERFORM 9700-DATE-LINK
 22987        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22988
 22989     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22990     MOVE SPACE                  TO DC-OPTION-CODE.
 22991     PERFORM 9700-DATE-LINK.
 22992     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22993
 22994     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22995     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22996
 22997     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22998        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22999                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23000
 23001     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23002     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23003     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23004
 23005     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23006        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23007                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23008
 23009     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 423
* EL6311.cbl
 23010     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23011     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23012
 23013     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23014        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23015                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23016
 23017     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23018     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23019
 23020     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23021        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23022                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23023
 23024     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23025     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23026     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23027
 23028     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23029        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23030                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23031
 23032     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23033     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23034     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23035
 23036     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23037        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23038                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23039
 23040     MOVE -1                     TO DPFENTRL.
 23041     GO TO 8100-SEND-INITIAL-MAP.
 23042
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 424
* EL6311.cbl
 23044
 23045***************************************************************
 23046*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23047*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23048*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23049*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23050*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23051*     ARE THEN SET ACCORDINGLY.                               *
 23052*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23053*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23054*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23055***************************************************************
 23056
 23057******************************************************************
 23058*                                                                *
 23059*            E R R O R   A N A L Y S I S                         *
 23060*                                                                *
 23061******************************************************************
 23062
 23063******************************************************************
 23064*                                                                *
 23065*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23066*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23067*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23068*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23069*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23070*                                                                *
 23071*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23072*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23073*                                                                *
 23074******************************************************************
 23075
 23076 7300-FORMAT-ERRORS.
 23077     MOVE ' '                    TO PI-ERRORS-SW
 23078     IF PB-COMMON-ERRORS = LOW-VALUES
 23079        IF PB-FATAL-ERRORS
 23080           MOVE ER-2695          TO EMI-ERROR
 23081           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23082           GO TO 7399-EXIT.
 23083
 23084     MOVE +0                     TO WS-SUB4.
 23085
 23086 7310-ERROR-LOOP.
 23087
 23088     ADD +1                      TO WS-SUB4.
 23089
 23090     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23091        GO TO 7350-SET-ERROR-FLAGS.
 23092
 23093     IF PI-COMPANY-ID = 'UCL'
 23094         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23095             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23096             MOVE ' '                   TO DC-OPTION-CODE
 23097             PERFORM 9700-DATE-LINK
 23098             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23099
 23100     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 23101     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 425
* EL6311.cbl
 23102     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23103
 23104     GO TO 7310-ERROR-LOOP.
 23105
 23106
 23107 7350-SET-ERROR-FLAGS.
 23108
 23109     IF EMI-FATAL-CTR NOT = ZEROS
 23110        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23111        MOVE 'X'                 TO PB-FATAL-FLAG
 23112                                    PI-ERRORS-SW
 23113        GO TO 7355-SET-ERROR-FLAGS.
 23114
 23115     move ' ' to pi-unforced-sw
 23116     IF EMI-FORCABLE-CTR NOT = ZEROS
 23117        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23118        IF PB-ISSUE
 23119           IF PB-ISSUE-FORCE
 23120              MOVE 'F'           TO PB-FORCE-ER-CD
 23121              MOVE ER-2600       TO EMI-ERROR
 23122              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23123             ELSE
 23124              MOVE 'X'           TO PB-FORCE-ER-CD
 23125*                                   PI-ERRORS-SW
 23126          ELSE
 23127           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23128              MOVE 'F'           TO PB-FORCE-ER-CD
 23129                                    pi-unforced-sw
 23130              MOVE ER-2600       TO EMI-ERROR
 23131              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23132             ELSE
 23133              MOVE 'X'           TO PB-FORCE-ER-CD
 23134                                    pi-unforced-sw.
 23135*                                   PI-ERRORS-SW.
 23136
 23137     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23138     IF PB-ISSUE
 23139         MOVE 'I'                TO ENDT-RECORD-TYPE
 23140     ELSE
 23141         MOVE 'C'                TO ENDT-RECORD-TYPE
 23142     END-IF
 23143     MOVE +0                     TO ENDT-SEQ-NO
 23144
 23145
 23146* EXEC CICS READ
 23147*        DATASET   (FILE-ID-ERENDT)
 23148*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23149*        RIDFLD    (ERENDT-KEY)
 23150*        RESP      (WS-RESPONSE)
 23151*        GTEQ
 23152*    END-EXEC
 23153*    MOVE '&"S        G          (  N#00019415' TO DFHEIV0
 23154     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23156     MOVE X'204E233030303139343135' TO DFHEIV0(25:11)
 23157     CALL 'kxdfhei1' USING DFHEIV0,
 23158           FILE-ID-ERENDT,
 23159           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 426
* EL6311.cbl
 23160           DFHEIV99,
 23161           ERENDT-KEY,
 23162           DFHEIV99,
 23163           DFHEIV99,
 23164           DFHEIV99
 23165     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23166         DFHEIV20
 23167     MOVE EIBRESP  TO WS-RESPONSE
 23168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23169
 23170     IF RESP-NORMAL
 23171        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23172        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23173            MOVE ER-0280          TO EMI-ERROR
 23174            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23175            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23176            EVALUATE TRUE
 23177              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23178                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23179              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23180                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23181              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23182                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23183            END-EVALUATE
 23184        END-IF
 23185     END-IF
 23186
 23187
 23188
 23189     IF FIRST-ENTRY OR
 23190        EIBAID = DFHPF1 OR DFHPF2
 23191        MOVE '0'                TO PI-EDIT-SW
 23192        GO TO 7399-EXIT.
 23193
 23194 7355-SET-ERROR-FLAGS.
 23195
 23196     IF EMI-WARNING-CTR NOT = ZEROS
 23197        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23198        MOVE 'W'                 TO PB-WARN-ER-CD.
 23199
 23200     IF PB-UNFORCED-ERRORS OR
 23201        PB-FATAL-ERRORS    OR
 23202        PB-RECORD-ON-HOLD  OR
 23203        PB-RECORD-RETURNED OR
 23204        PB-CANCELLATION
 23205          NEXT SENTENCE
 23206        ELSE
 23207          GO TO 7399-EXIT.
 23208
 23209
 23210* EXEC CICS  HANDLE CONDITION
 23211*           NOTFND   (7399-EXIT)
 23212*    END-EXEC.
 23213*    MOVE '"$I                   ! Z #00019462' TO DFHEIV0
 23214     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23216     MOVE X'5A20233030303139343632' TO DFHEIV0(25:11)
 23217     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 427
* EL6311.cbl
 23218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23219
 23220
 23221     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23222     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23223     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23224     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23225
 23226
 23227* EXEC CICS READ
 23228*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23229*        DATASET (FILE-ID-ELCERT)
 23230*        RIDFLD  (ELCERT-KEY)
 23231*        UPDATE
 23232*    END-EXEC.
 23233*    MOVE '&"S        EU         (   #00019471' TO DFHEIV0
 23234     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23235     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23236     MOVE X'2020233030303139343731' TO DFHEIV0(25:11)
 23237     CALL 'kxdfhei1' USING DFHEIV0,
 23238           FILE-ID-ELCERT,
 23239           DFHEIV20,
 23240           DFHEIV99,
 23241           ELCERT-KEY,
 23242           DFHEIV99,
 23243           DFHEIV99,
 23244           DFHEIV99
 23245     SET ADDRESS OF CERTIFICATE-MASTER TO
 23246         DFHEIV20
 23247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23248
 23249
 23250
 23251     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23252     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23253
 23254     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23255        GO TO 7360-REWRITE-CERT-MASTER.
 23256
 23257     IF PB-ISSUE
 23258        IF PB-RECORD-RETURNED
 23259            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23260            GO TO 7360-REWRITE-CERT-MASTER
 23261        ELSE
 23262            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23263            GO TO 7360-REWRITE-CERT-MASTER.
 23264
 23265     IF PB-RECORD-RETURNED
 23266         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23267         GO TO 7360-REWRITE-CERT-MASTER.
 23268
 23269     IF (PB-C-LF-CANCEL-VOIDED)
 23270        or (pb-c-ah-cancel-voided)
 23271        IF (PB-UNFORCED-ERRORS OR
 23272            PB-FATAL-ERRORS    OR
 23273            PB-RECORD-ON-HOLD)
 23274            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23275            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 428
* EL6311.cbl
 23276        ELSE
 23277            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23278            GO TO 7360-REWRITE-CERT-MASTER.
 23279
 23280     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23281                            OR PB-RECORD-ON-HOLD)
 23282        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23283     ELSE
 23284        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23285
 23286 7360-REWRITE-CERT-MASTER.
 23287
 23288     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23289        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23290
 23291* EXEC CICS UNLOCK
 23292*            DATASET    (FILE-ID-ELCERT)
 23293*       END-EXEC
 23294*    MOVE '&*                    #   #00019518' TO DFHEIV0
 23295     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23296     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23297     MOVE X'2020233030303139353138' TO DFHEIV0(25:11)
 23298     CALL 'kxdfhei1' USING DFHEIV0,
 23299           FILE-ID-ELCERT,
 23300           DFHEIV99
 23301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23302        GO TO 7399-EXIT.
 23303
 23304
 23305* EXEC CICS REWRITE
 23306*         DATASET    (FILE-ID-ELCERT)
 23307*         FROM       (CERTIFICATE-MASTER)
 23308*    END-EXEC.
 23309     MOVE LENGTH OF
 23310      CERTIFICATE-MASTER
 23311       TO DFHEIV11
 23312*    MOVE '&& L                  %   #00019523' TO DFHEIV0
 23313     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23314     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23315     MOVE X'2020233030303139353233' TO DFHEIV0(25:11)
 23316     CALL 'kxdfhei1' USING DFHEIV0,
 23317           FILE-ID-ELCERT,
 23318           CERTIFICATE-MASTER,
 23319           DFHEIV11,
 23320           DFHEIV99
 23321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23322
 23323
 23324 7399-EXIT.
 23325      EXIT.
 23326
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 429
* EL6311.cbl
 23328
 23329*************************************************************
 23330*                                                           *
 23331*              S E T   A T T R I B U T E S                  *
 23332*                                                           *
 23333*************************************************************
 23334
 23335 7400-SET-ATTRIBUTES.
 23336
 23337     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23338        GO TO 7499-EXIT.
 23339
 23340**2601**
 23341
 23342     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23343        IF PB-ISSUE
 23344           MOVE AL-UABON         TO BEFFDTA
 23345           GO TO 7499-EXIT
 23346         ELSE
 23347           MOVE AL-UABON         TO CEFFDTA
 23348           GO TO 7499-EXIT.
 23349
 23350**2604**
 23351
 23352     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23353        IF PB-ISSUE
 23354           MOVE AL-UABON         TO BTYPE1A
 23355           MOVE -1               TO BTYPE1L
 23356           MOVE  1               TO SET-CURSOR-SW
 23357           GO TO 7499-EXIT.
 23358
 23359**2605**
 23360
 23361     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23362        IF PB-ISSUE
 23363           MOVE AL-UABON         TO BTYPE2A
 23364           MOVE -1               TO BTYPE2L
 23365           MOVE  1               TO SET-CURSOR-SW
 23366           GO TO 7499-EXIT.
 23367
 23368**2606**
 23369
 23370     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23371        IF PB-ISSUE
 23372           MOVE AL-UABON         TO BSIGA
 23373           MOVE -1               TO BSIGL
 23374           MOVE  1               TO SET-CURSOR-SW
 23375           GO TO 7499-EXIT.
 23376
 23377**2607**
 23378
 23379     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23380        IF PB-ISSUE
 23381           MOVE AL-UABON         TO BSIGA
 23382           MOVE -1               TO BSIGL
 23383           MOVE  1               TO SET-CURSOR-SW
 23384           GO TO 7499-EXIT.
 23385
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 430
* EL6311.cbl
 23386**2615**
 23387
 23388     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23389        IF PB-ISSUE
 23390           MOVE AL-UABOF         TO BREINA
 23391           MOVE -1               TO BREINL
 23392           GO TO 7499-EXIT.
 23393
 23394**2622**
 23395
 23396     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23397        IF PB-ISSUE
 23398           MOVE AL-UABON         TO BEFFDTA
 23399           GO TO 7499-EXIT
 23400        ELSE
 23401           MOVE AL-UABON         TO CEFFDTA
 23402           GO TO 7499-EXIT.
 23403
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 431
* EL6311.cbl
 23405
 23406*************************************************************
 23407*                                                           *
 23408*              I S S U E   E R R O R S                      *
 23409*                                                           *
 23410*************************************************************
 23411
 23412 7420-ISSUE-ERRORS.
 23413
 23414**2626**
 23415
 23416     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23417        MOVE AL-UABON            TO BCERTNOA
 23418        GO TO 7499-EXIT.
 23419
 23420**2627**
 23421
 23422     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23423        MOVE AL-UNBON            TO BAGEA
 23424        MOVE -1                  TO BAGEL
 23425        MOVE  1                  TO SET-CURSOR-SW
 23426        GO TO 7499-EXIT.
 23427
 23428**2628**
 23429
 23430     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23431        MOVE AL-UNBON            TO BAGEA
 23432        MOVE -1                  TO BAGEL
 23433        MOVE  1                  TO SET-CURSOR-SW
 23434        GO TO 7499-EXIT.
 23435
 23436**2629**
 23437
 23438     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23439        MOVE AL-UABON            TO BSEXA
 23440        MOVE -1                  TO BSEXL
 23441        MOVE  1                  TO SET-CURSOR-SW
 23442        GO TO 7499-EXIT.
 23443
 23444**2630**
 23445
 23446     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23447        MOVE -1                  TO BTYPE1L
 23448        MOVE  1                  TO SET-CURSOR-SW
 23449        GO TO 7499-EXIT.
 23450
 23451**2631**
 23452
 23453     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23454        MOVE -1                  TO BTYPE1L
 23455        MOVE  1                  TO SET-CURSOR-SW
 23456        GO TO 7499-EXIT.
 23457
 23458**2632**
 23459
 23460     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23461        MOVE AL-UNBON            TO BBEN1A
 23462        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 432
* EL6311.cbl
 23463        MOVE  1                  TO SET-CURSOR-SW
 23464        GO TO 7499-EXIT.
 23465
 23466**2633**
 23467
 23468     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23469        MOVE AL-UNBON            TO BPREM1A
 23470        MOVE -1                  TO BPREM1L
 23471        MOVE  1                  TO SET-CURSOR-SW
 23472        GO TO 7499-EXIT.
 23473
 23474**2634**
 23475
 23476     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23477        MOVE -1                  TO BTYPE2L
 23478        MOVE  1                  TO SET-CURSOR-SW
 23479        GO TO 7499-EXIT.
 23480
 23481**2635**
 23482
 23483     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23484        MOVE AL-UNBON            TO BBEN2A
 23485        MOVE -1                  TO BBEN2L
 23486        MOVE  1                  TO SET-CURSOR-SW
 23487        GO TO 7499-EXIT.
 23488
 23489**2636**
 23490
 23491     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23492        MOVE AL-UNBON            TO BPREM2A
 23493        MOVE -1                  TO BPREM2L
 23494        MOVE  1                  TO SET-CURSOR-SW
 23495        GO TO 7499-EXIT.
 23496
 23497**2639**
 23498
 23499     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23500        MOVE AL-UNBON            TO BBEN1A
 23501        MOVE -1                  TO BBEN1L
 23502        MOVE  1                  TO SET-CURSOR-SW
 23503        GO TO 7499-EXIT.
 23504
 23505**2640**
 23506
 23507     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23508        MOVE AL-UNBON            TO BBEN2A
 23509        MOVE -1                  TO BBEN2L
 23510        MOVE  1                  TO SET-CURSOR-SW
 23511        GO TO 7499-EXIT.
 23512
 23513**2647**
 23514
 23515     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23516        MOVE AL-UNBON            TO BTERM1A
 23517        MOVE -1                  TO BTERM1L
 23518        MOVE  1                  TO SET-CURSOR-SW
 23519        GO TO 7499-EXIT.
 23520
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 433
* EL6311.cbl
 23521**2648**
 23522
 23523     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23524        MOVE AL-UNBON            TO BLNTRMA
 23525        MOVE -1                  TO BLNTRML
 23526        MOVE  1                  TO SET-CURSOR-SW
 23527        GO TO 7499-EXIT.
 23528
 23529**2649**
 23530
 23531     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23532        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23533            MOVE AL-UNBON            TO BPREM1A
 23534            MOVE -1                  TO BPREM1L
 23535            MOVE  1                  TO SET-CURSOR-SW
 23536            GO TO 7499-EXIT
 23537     ELSE
 23538        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23539           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23540            MOVE AL-UNBON            TO BPREM2A
 23541            MOVE -1                  TO BPREM2L
 23542            MOVE  1                  TO SET-CURSOR-SW
 23543            GO TO 7499-EXIT.
 23544
 23545**2650**
 23546
 23547     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23548        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23549            MOVE AL-UNBON        TO BPREM1A
 23550            MOVE -1              TO BPREM1L
 23551            MOVE  1              TO SET-CURSOR-SW
 23552            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23553                MOVE AL-UNBON        TO BPREM2A
 23554                MOVE -1              TO BPREM2L
 23555                MOVE  1              TO SET-CURSOR-SW
 23556                GO TO 7499-EXIT
 23557            ELSE
 23558                GO TO 7499-EXIT
 23559        ELSE
 23560            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23561                MOVE AL-UNBON        TO BPREM2A
 23562                MOVE -1              TO BPREM2L
 23563                MOVE  1              TO SET-CURSOR-SW
 23564                GO TO 7499-EXIT
 23565            ELSE
 23566                GO TO 7499-EXIT.
 23567
 23568**2651**
 23569
 23570     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23571        MOVE AL-UABON            TO BSIGA
 23572        MOVE -1                  TO BSIGL
 23573        MOVE  1                  TO SET-CURSOR-SW
 23574        GO TO 7499-EXIT.
 23575
 23576**2653**
 23577
 23578     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 434
* EL6311.cbl
 23579        MOVE AL-UABON            TO BFREQA
 23580        MOVE -1                  TO BFREQL
 23581        MOVE  1                  TO SET-CURSOR-SW
 23582        GO TO 7499-EXIT.
 23583
 23584**2654**
 23585
 23586     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23587        MOVE AL-UABON            TO BFREQA
 23588        MOVE -1                  TO BFREQL
 23589        MOVE  1                  TO SET-CURSOR-SW
 23590        GO TO 7499-EXIT.
 23591
 23592**2655**
 23593
 23594     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23595        MOVE AL-UABON            TO BFREQA
 23596        MOVE -1                  TO BFREQL
 23597        MOVE  1                  TO SET-CURSOR-SW
 23598        GO TO 7499-EXIT.
 23599
 23600**2656**
 23601
 23602     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23603        MOVE AL-UNBON            TO BAPRA
 23604        MOVE -1                  TO BAPRL
 23605        MOVE  1                  TO SET-CURSOR-SW
 23606        GO TO 7499-EXIT.
 23607
 23608**2657**
 23609
 23610     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23611        MOVE AL-UNBON            TO BAPRA
 23612        MOVE -1                  TO BAPRL
 23613        MOVE  1                  TO SET-CURSOR-SW
 23614        GO TO 7499-EXIT.
 23615
 23616**2658**
 23617
 23618     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23619        MOVE AL-UNBON            TO BTERM2A
 23620        MOVE -1                  TO BTERM2L
 23621        MOVE  1                  TO SET-CURSOR-SW
 23622        GO TO 7499-EXIT.
 23623
 23624**2660**
 23625
 23626     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23627        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23628        MOVE -1                  TO BLSTNML
 23629        MOVE  1                  TO SET-CURSOR-SW
 23630        GO TO 7499-EXIT.
 23631
 23632
 23633**2662**
 23634
 23635     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23636        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 435
* EL6311.cbl
 23637        MOVE -1                  TO BAGEL
 23638        MOVE  1                  TO SET-CURSOR-SW
 23639        GO TO 7499-EXIT.
 23640
 23641**2663**
 23642
 23643     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23644        MOVE AL-UNBON            TO BAGEA
 23645        MOVE -1                  TO BAGEL
 23646        MOVE  1                  TO SET-CURSOR-SW
 23647        GO TO 7499-EXIT.
 23648
 23649**2664**
 23650
 23651     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23652        MOVE AL-UABON            TO BREINA
 23653        MOVE -1                  TO BREINL
 23654        MOVE  1                  TO SET-CURSOR-SW
 23655        GO TO 7499-EXIT.
 23656
 23657**2667**
 23658
 23659     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23660        MOVE AL-UNBON            TO BBEN2A
 23661        MOVE -1                  TO BBEN2L
 23662        MOVE  1                  TO SET-CURSOR-SW
 23663        GO TO 7499-EXIT.
 23664
 23665**2668**
 23666
 23667     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23668        MOVE AL-UABON            TO BEFFDTA
 23669        GO TO 7499-EXIT.
 23670
 23671**2669**
 23672
 23673     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23674       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23675       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23676        MOVE AL-UNBON            TO BAGEA
 23677        MOVE -1                  TO BAGEL
 23678        MOVE  1                  TO SET-CURSOR-SW
 23679        GO TO 7499-EXIT.
 23680
 23681**2670**
 23682
 23683     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23684        MOVE AL-UABON            TO BFORCEA
 23685        MOVE -1                  TO BFORCEL
 23686        MOVE  1                  TO SET-CURSOR-SW
 23687        GO TO 7499-EXIT.
 23688
 23689**2671**
 23690
 23691     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23692        MOVE AL-UABON            TO BEFFDTA
 23693        GO TO 7499-EXIT.
 23694
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 436
* EL6311.cbl
 23695**2672**
 23696
 23697     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23698        MOVE AL-UABON            TO BEFFDTA
 23699        GO TO 7499-EXIT.
 23700
 23701**2673**
 23702
 23703     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23704        MOVE AL-UABON            TO BEFFDTA
 23705        GO TO 7499-EXIT.
 23706
 23707**2674**
 23708
 23709     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23710        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23711        MOVE -1                  TO BTYPE1L
 23712        MOVE  1                  TO SET-CURSOR-SW
 23713        GO TO 7499-EXIT.
 23714
 23715**2677**
 23716
 23717     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23718        MOVE AL-UNBON            TO BTERM1A
 23719        MOVE -1                  TO BTERM1L
 23720        MOVE  1                  TO SET-CURSOR-SW
 23721        GO TO 7499-EXIT.
 23722
 23723**2678**
 23724
 23725     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23726        MOVE AL-UNBON            TO BTERM2A
 23727        MOVE -1                  TO BTERM2L
 23728        MOVE  1                  TO SET-CURSOR-SW
 23729        GO TO 7499-EXIT.
 23730
 23731**2679**
 23732
 23733     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23734        MOVE AL-UABON            TO BTYPE1A
 23735        MOVE -1                  TO BTYPE1L
 23736        MOVE  1                  TO SET-CURSOR-SW
 23737        GO TO 7499-EXIT.
 23738
 23739**2680**
 23740
 23741     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23742        MOVE AL-UABOF            TO B1STPMTA
 23743        MOVE -1                  TO B1STPMTL
 23744        MOVE  1                  TO SET-CURSOR-SW
 23745        GO TO 7499-EXIT.
 23746
 23747**2681**
 23748
 23749     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23750        MOVE AL-UABON            TO BDAYSA
 23751        MOVE -1                  TO BDAYSL
 23752        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 437
* EL6311.cbl
 23753        GO TO 7499-EXIT.
 23754
 23755**2682**
 23756
 23757     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23758        MOVE AL-UABON            TO BTERM1A
 23759        MOVE -1                  TO BTERM1L
 23760        MOVE  1                  TO SET-CURSOR-SW
 23761        GO TO 7499-EXIT.
 23762
 23763**2683**
 23764
 23765     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23766        MOVE AL-UABON            TO BSKPCDA
 23767        MOVE -1                  TO BSKPCDL
 23768        MOVE  1                  TO SET-CURSOR-SW
 23769        GO TO 7499-EXIT.
 23770
 23771**2684**
 23772
 23773     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23774        MOVE AL-UABON            TO BTYPE2A
 23775        MOVE -1                  TO BTYPE2L
 23776        MOVE  1                  TO SET-CURSOR-SW
 23777        GO TO 7499-EXIT.
 23778
 23779**2686**
 23780
 23781     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23782        MOVE AL-UABON            TO BTYPE2A
 23783        MOVE -1                  TO BTYPE2L
 23784        MOVE  1                  TO SET-CURSOR-SW
 23785        GO TO 7499-EXIT.
 23786
 23787**2689**
 23788
 23789     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23790        MOVE AL-UABON            TO BSIGA
 23791        MOVE -1                  TO BSIGL
 23792        MOVE  1                  TO SET-CURSOR-SW
 23793        GO TO 7499-EXIT.
 23794
 23795**2690**
 23796
 23797     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23798        MOVE AL-UABOF            TO BLNOFCRA
 23799        MOVE -1                  TO BLNOFCRL
 23800        MOVE  1                  TO SET-CURSOR-SW
 23801        GO TO 7499-EXIT.
 23802
 23803**2693**
 23804
 23805     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23806        MOVE AL-UABOF            TO BLNOFCRA
 23807        MOVE AL-UNBON            TO BBEN1A
 23808        MOVE -1                  TO BBEN1L
 23809        MOVE  1                  TO SET-CURSOR-SW
 23810        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 438
* EL6311.cbl
 23811
 23812**2720**
 23813
 23814     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23815        MOVE AL-UNBON            TO BBEN1A
 23816        MOVE -1                  TO BBEN1L
 23817        MOVE  1                  TO SET-CURSOR-SW
 23818        GO TO 7499-EXIT.
 23819
 23820**2709**
 23821
 23822*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23823*       MOVE AL-UNBON            TO BBEN1A
 23824*       MOVE -1                  TO BBEN1L
 23825*       MOVE  1                  TO SET-CURSOR-SW
 23826*       GO TO 7499-EXIT.
 23827
 23828*************************************************************
 23829*                                                           *
 23830*            C A N C E L   E R R O R S                      *
 23831*                                                           *
 23832*************************************************************
 23833
 23834**2726**
 23835
 23836     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23837        MOVE AL-UABON            TO CCERTNOA
 23838        GO TO 7499-EXIT.
 23839
 23840**2728**
 23841
 23842     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23843        MOVE AL-UABON            TO CCERTNOA
 23844        GO TO 7499-EXIT.
 23845
 23846**2729**
 23847
 23848     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23849        MOVE AL-UABON            TO CCERTNOA
 23850        GO TO 7499-EXIT.
 23851
 23852**2730**
 23853
 23854     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23855        MOVE AL-UABON            TO CCERTNOA
 23856        GO TO 7499-EXIT.
 23857
 23858**2731**
 23859
 23860     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23861        MOVE AL-UABON            TO CCANDT1A
 23862        MOVE -1                  TO CCANDT1L
 23863        MOVE  1                  TO SET-CURSOR-SW
 23864        GO TO 7499-EXIT.
 23865
 23866**2732**
 23867
 23868     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 439
* EL6311.cbl
 23869        MOVE AL-UABON            TO CCANDT1A
 23870        MOVE -1                  TO CCANDT1L
 23871        MOVE  1                  TO SET-CURSOR-SW
 23872        GO TO 7499-EXIT.
 23873
 23874**2733**
 23875
 23876     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23877        MOVE AL-UABON            TO CCANDT1A
 23878        MOVE -1                  TO CCANDT1L
 23879        MOVE  1                  TO SET-CURSOR-SW
 23880        GO TO 7499-EXIT.
 23881
 23882**2734**
 23883
 23884     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23885        MOVE AL-UNBON            TO CREFND1A
 23886        MOVE -1                  TO CREFND1L
 23887        MOVE  1                  TO SET-CURSOR-SW
 23888        GO TO 7499-EXIT.
 23889
 23890**2735**
 23891
 23892     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23893        MOVE AL-UABON            TO CCANDT2A
 23894        MOVE -1                  TO CCANDT2L
 23895        MOVE  1                  TO SET-CURSOR-SW
 23896        GO TO 7499-EXIT.
 23897
 23898**2736**
 23899
 23900     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23901        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23902            MOVE AL-UNBON        TO CREFND1A
 23903            MOVE -1              TO CREFND1L
 23904            MOVE  1              TO SET-CURSOR-SW
 23905            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23906                MOVE AL-UNBON        TO CREFND2A
 23907                MOVE -1              TO CREFND2L
 23908                MOVE  1              TO SET-CURSOR-SW
 23909                GO TO 7499-EXIT
 23910            ELSE
 23911                GO TO 7499-EXIT
 23912        ELSE
 23913            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23914                MOVE AL-UNBON        TO CREFND2A
 23915                MOVE -1              TO CREFND2L
 23916                MOVE  1              TO SET-CURSOR-SW
 23917                GO TO 7499-EXIT
 23918            ELSE
 23919                GO TO 7499-EXIT.
 23920
 23921**2738**
 23922
 23923     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23924        MOVE -1                  TO CREFND2L
 23925        MOVE  1                  TO SET-CURSOR-SW
 23926        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 440
* EL6311.cbl
 23927
 23928**2739**
 23929
 23930     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23931        MOVE -1                  TO CREFND1L
 23932        MOVE  1                  TO SET-CURSOR-SW
 23933        GO TO 7499-EXIT.
 23934
 23935**2741**
 23936
 23937     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23938        MOVE -1                  TO CREFND1L
 23939        MOVE  1                  TO SET-CURSOR-SW
 23940        GO TO 7499-EXIT.
 23941
 23942**2743**
 23943
 23944     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23945        MOVE AL-UNBON            TO CCANDT1A
 23946        MOVE -1                  TO CCANDT1L
 23947        MOVE  1                  TO SET-CURSOR-SW
 23948        GO TO 7499-EXIT.
 23949
 23950**2744**
 23951
 23952     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23953        MOVE AL-UNBON            TO CCANDT2A
 23954        MOVE -1                  TO CCANDT2L
 23955        MOVE  1                  TO SET-CURSOR-SW
 23956        GO TO 7499-EXIT.
 23957
 23958**2747**
 23959
 23960     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23961        MOVE AL-UABON            TO CLSTNMA
 23962        MOVE -1                  TO CLSTNML
 23963        MOVE  1                  TO SET-CURSOR-SW
 23964        GO TO 7499-EXIT.
 23965
 23966**2749**
 23967
 23968     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23969        MOVE AL-UABON            TO CFORCEA
 23970        MOVE -1                  TO CFORCEL
 23971        MOVE  1                  TO SET-CURSOR-SW
 23972        GO TO 7499-EXIT.
 23973
 23974**2753**
 23975
 23976     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23977        MOVE AL-UNBON            TO CCANDT1A
 23978        MOVE -1                  TO CCANDT1L
 23979        MOVE  1                  TO SET-CURSOR-SW
 23980        GO TO 7499-EXIT.
 23981
 23982**2755**
 23983
 23984     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 441
* EL6311.cbl
 23985        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23986            MOVE AL-UNBON        TO CREFND1A
 23987            MOVE -1              TO CREFND1L
 23988            MOVE  1              TO SET-CURSOR-SW
 23989            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23990                MOVE AL-UNBON        TO CREFND2A
 23991                MOVE -1              TO CREFND2L
 23992                MOVE  1              TO SET-CURSOR-SW
 23993                GO TO 7499-EXIT
 23994            ELSE
 23995                GO TO 7499-EXIT
 23996        ELSE
 23997            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23998                MOVE AL-UNBON        TO CREFND2A
 23999                MOVE -1              TO CREFND2L
 24000                MOVE  1              TO SET-CURSOR-SW
 24001            ELSE
 24002                GO TO 7499-EXIT.
 24003
 24004**2757**
 24005
 24006     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24007        MOVE AL-UNBON            TO CLIVESA
 24008        MOVE -1                  TO CLIVESL
 24009        MOVE  1                  TO SET-CURSOR-SW
 24010        GO TO 7499-EXIT.
 24011
 24012**2771**
 24013
 24014     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24015        MOVE AL-UABON            TO CCANDT2A
 24016        MOVE -1                  TO CCANDT2L
 24017        MOVE  1                  TO SET-CURSOR-SW
 24018        GO TO 7499-EXIT.
 24019
 24020**2774**
 24021
 24022     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24023        MOVE AL-UABON            TO CCANDT1A
 24024        MOVE -1                  TO CCANDT1L
 24025        MOVE  1                  TO SET-CURSOR-SW
 24026        GO TO 7499-EXIT.
 24027
 24028**2775**
 24029
 24030     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24031        MOVE AL-UABON            TO CCANDT2A
 24032        MOVE -1                  TO CCANDT2L
 24033        MOVE  1                  TO SET-CURSOR-SW
 24034        GO TO 7499-EXIT.
 24035
 24036**2776**
 24037
 24038     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24039        MOVE AL-UABON            TO CCANDT1A
 24040        MOVE -1                  TO CCANDT1L
 24041        MOVE  1                  TO SET-CURSOR-SW
 24042        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 442
* EL6311.cbl
 24043
 24044
 24045**2777**
 24046
 24047     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24048        MOVE AL-UABON            TO CCANDT2A
 24049        MOVE -1                  TO CCANDT2L
 24050        MOVE  1                  TO SET-CURSOR-SW
 24051        GO TO 7499-EXIT.
 24052
 24053**2794**
 24054
 24055     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24056        MOVE AL-UABON            TO CFORCEA
 24057        MOVE -1                  TO CFORCEL
 24058        MOVE  1                  TO SET-CURSOR-SW
 24059        GO TO 7499-EXIT.
 24060
 24061**2799**
 24062
 24063     IF PI-COMPANY-ID = 'UCL'
 24064         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24065             MOVE AL-UNBON            TO BEFFDTA
 24066             MOVE -1                  TO BEFFDTL
 24067             MOVE  1                  TO SET-CURSOR-SW
 24068             GO TO 7499-EXIT.
 24069
 24070 7499-EXIT.
 24071      EXIT.
 24072
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 443
* EL6311.cbl
 24074
 24075 7500-READ-ERLOFC.
 24076     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24077                                     ERLOFC-KEY.
 24078
 24079     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24080
 24081     IF ST-ACCNT-CNTL
 24082         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24083
 24084     IF CARR-GROUP-ST-ACCNT-CNTL
 24085         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24086         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24087         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24088
 24089     IF CARR-ST-ACCNT-CNTL
 24090         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24091         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24092
 24093     IF CARR-ACCNT-CNTL
 24094         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24095
 24096     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24097
 24098     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24099
 24100
 24101* EXEC CICS HANDLE CONDITION
 24102*        NOTFND   (7550-OFFICER-NOTFND)
 24103*    END-EXEC.
 24104*    MOVE '"$I                   ! [ #00020304' TO DFHEIV0
 24105     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24107     MOVE X'5B20233030303230333034' TO DFHEIV0(25:11)
 24108     CALL 'kxdfhei1' USING DFHEIV0
 24109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24110
 24111
 24112
 24113* EXEC CICS READ
 24114*        DATASET   (FILE-ID-ERLOFC)
 24115*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24116*        RIDFLD    (ERLOFC-KEY)
 24117*        EQUAL
 24118*    END-EXEC.
 24119*    MOVE '&"S        E          (   #00020308' TO DFHEIV0
 24120     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24121     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24122     MOVE X'2020233030303230333038' TO DFHEIV0(25:11)
 24123     CALL 'kxdfhei1' USING DFHEIV0,
 24124           FILE-ID-ERLOFC,
 24125           DFHEIV20,
 24126           DFHEIV99,
 24127           ERLOFC-KEY,
 24128           DFHEIV99,
 24129           DFHEIV99,
 24130           DFHEIV99
 24131     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 444
* EL6311.cbl
 24132         DFHEIV20
 24133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24134
 24135
 24136     GO TO 7599-EXIT.
 24137
 24138 7550-OFFICER-NOTFND.
 24139     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24140
 24141 7599-EXIT.
 24142      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 445
* EL6311.cbl
 24144******************************************************************
 24145*                                                                *
 24146*            S  E N D    I N I T I A L   M A P                   *
 24147*                                                                *
 24148******************************************************************
 24149
 24150 8100-SEND-INITIAL-MAP.
 24151     MOVE EIBTIME                TO TIME-IN.
 24152
 24153     IF EIBAID = DFHPF11
 24154        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24155        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24156
 24157
 24158     IF PI-COMPANY-ID = CLIENT-GIC
 24159        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24160                                       BCPREM-ATTRB (2).
 24161
 24162     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24163                         CLIENT-PEM OR
 24164                         CLIENT-CSO)
 24165        AND PI-DISPLAY-ORIGINAL-BATCH
 24166          IF PI-MAP-NAME = EL631B
 24167             MOVE AL-SADOF               TO BPF5HDRA
 24168                                            BPF4HDRA
 24169          ELSE
 24170             IF PI-MAP-NAME = EL631C
 24171                MOVE AL-SADOF            TO CPF5HDRA
 24172                                            CPF4HDRA.
 24173
 24174     IF PI-MAP-NAME = EL631B
 24175        MOVE AL-SADOF               TO BPF5HDRA
 24176     ELSE
 24177        MOVE AL-SADOF               TO CPF5HDRA
 24178     END-IF
 24179
 24180*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24181     IF PI-MAP-NAME = EL631B
 24182          IF PI-COMPANY-ID NOT = 'DMD'
 24183             MOVE AL-SANOF            TO BBILLEDA
 24184             MOVE AL-SADOF            TO DMDBILA.
 24185*DMD CUSTOM CODING*************END
 24186
 24187     IF PI-PROCESSOR-ID = 'LGXX'
 24188        IF PI-MAP-NAME = EL631B
 24189           MOVE AL-SABOF                    TO BREFHDGA
 24190           MOVE AL-SANOF                    TO BREFA
 24191        ELSE
 24192           IF PI-MAP-NAME = EL631C
 24193              MOVE AL-SABOF                 TO CREFHDGA
 24194              MOVE AL-SANOF                 TO CREFA.
 24195
 24196     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'CAP'
 24197        continue
 24198     ELSE
 24199        IF PI-MAP-NAME = EL631C
 24200           MOVE AL-SADOF         TO CCANTXTA
 24201                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 446
* EL6311.cbl
 24202        end-if
 24203     end-if
 24204     IF PI-MAP-NAME = EL631D
 24205        IF PI-AR-PROCESSING
 24206           MOVE AL-SANOF            TO DREFHDGA
 24207        ELSE
 24208           MOVE AL-SADOF            TO DREFHDGA.
 24209
 24210     IF (PI-COMPANY-ID NOT = 'DCC' and 'CAP' and 'CID')
 24211        AND (PI-MAP-NAME = EL631B)
 24212        MOVE AL-SADOF            TO BVINHA
 24213                                    BVINA
 24214     END-IF
 24215     IF PI-MAP-NAME = EL631B
 24216        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24217        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24218                                 TO BREGIONO
 24219        MOVE PI-PROCESSOR-ID     TO BUSERO
 24220        IF CSR-EDIT-SESSION
 24221           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24222                                 TO BHEADO
 24223           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24224        ELSE
 24225           MOVE AL-SADOF         TO BF15HDRA
 24226           MOVE '4=B-HDR      '  TO BPF4HDRO
 24227        END-IF
 24228        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24229        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24230        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24231        MOVE WS-CURRENT-DT          TO BDATEO
 24232        MOVE TIME-OUT               TO BTIMEO
 24233        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24234        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24235        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24236        IF   WS-DISPLAY-SCREEN
 24237             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24238             MOVE PB-SV-CARRIER     TO BCARRO
 24239             MOVE PB-SV-GROUPING    TO BGROUPO
 24240             MOVE PB-SV-STATE       TO BSTATEO
 24241             MOVE PB-ACCOUNT        TO BACCTO
 24242        ELSE
 24243             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24244     ELSE
 24245        IF PI-MAP-NAME = EL631C
 24246           MOVE '4=B-HDR      '     TO CPF4HDRO
 24247           IF CSR-EDIT-SESSION
 24248              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24249                                 TO CHEADO
 24250           ELSE
 24251              MOVE AL-SADOF      TO CF15HDRA
 24252           END-IF
 24253           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24254           MOVE WS-CURRENT-DT          TO CDATEO
 24255           MOVE TIME-OUT               TO CTIMEO
 24256           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24257           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24258           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24259           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 447
* EL6311.cbl
 24260           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24261           MOVE WS-C-HDG               TO CAHHDGO
 24262           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24263           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24264           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24265           IF   WS-DISPLAY-SCREEN
 24266                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24267                MOVE PB-SV-CARRIER     TO CCARRO
 24268                MOVE PB-SV-GROUPING    TO CGROUPO
 24269                MOVE PB-SV-STATE       TO CSTATEO
 24270                MOVE PB-ACCOUNT        TO CACCTO
 24271           ELSE
 24272                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24273        ELSE
 24274           MOVE WS-CURRENT-DT          TO DDATEO
 24275           MOVE TIME-OUT               TO DTIMEO
 24276           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24277                                          WS-REFUND-HDG-OVERRIDE
 24278           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24279           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24280           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24281                                          WS-REFUND-HDG-OVERRIDE
 24282           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24283           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24284           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24285           IF CSR-EDIT-SESSION
 24286              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24287                                 TO DHEADO
 24288           END-IF
 24289           IF  WS-DISPLAY-SCREEN
 24290               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24291               MOVE PB-CARRIER         TO DCARRO
 24292               MOVE PB-GROUPING        TO DGROUPO
 24293               MOVE PB-STATE           TO DSTATEO
 24294               MOVE PB-ACCOUNT         TO DACCTO
 24295               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24296           ELSE
 24297               MOVE EL631D             TO PI-MAP-NAME
 24298               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24299               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24300
 24301     MOVE SPACE                        TO WS-DISPLAY-SW.
 24302
 24303
 24304* EXEC CICS SEND
 24305*        MAP      (PI-MAP-NAME)
 24306*        MAPSET   (MAPSET-EL6311S)
 24307*        FROM     (EL631BI)
 24308*        ERASE
 24309*        CURSOR
 24310*    END-EXEC.
 24311     MOVE LENGTH OF
 24312      EL631BI
 24313       TO DFHEIV12
 24314     MOVE -1
 24315       TO DFHEIV11
 24316*    MOVE '8$     CT  E    H L F ,   #00020482' TO DFHEIV0
 24317     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 448
* EL6311.cbl
 24318     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24319     MOVE X'2020233030303230343832' TO DFHEIV0(25:11)
 24320     CALL 'kxdfhei1' USING DFHEIV0,
 24321           PI-MAP-NAME,
 24322           EL631BI,
 24323           DFHEIV12,
 24324           MAPSET-EL6311S,
 24325           DFHEIV99,
 24326           DFHEIV99,
 24327           DFHEIV99,
 24328           DFHEIV11,
 24329           DFHEIV99,
 24330           DFHEIV99,
 24331           DFHEIV99
 24332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24333
 24334
 24335     GO TO 9100-RETURN-TRAN.
 24336
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 449
* EL6311.cbl
 24338
 24339******************************************************************
 24340*                                                                *
 24341*              S E N D    D A T A O N L Y                        *
 24342*                                                                *
 24343******************************************************************
 24344
 24345 8200-SEND-DATAONLY.
 24346     MOVE EIBTIME                TO TIME-IN.
 24347
 24348     IF PI-COMPANY-ID = CLIENT-GIC
 24349        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24350                                       BCPREM-ATTRB (2).
 24351
 24352     IF PI-MAP-NAME = EL631B
 24353        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24354        MOVE WS-CURRENT-DT          TO BDATEO
 24355        MOVE TIME-OUT               TO BTIMEO
 24356        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24357        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24358        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24359        MOVE SPACES                 TO BPFENTRO
 24360        MOVE AL-UANOF               TO BPFENTRA
 24361
 24362*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24363        IF PI-COMPANY-ID NOT = 'DMD'
 24364             MOVE AL-SANOF            TO BBILLEDA
 24365             MOVE AL-SADOF            TO DMDBILA
 24366         ELSE
 24367            NEXT SENTENCE
 24368*DMD CUSTOM CODING*************END
 24369     ELSE
 24370        IF PI-MAP-NAME = EL631C
 24371           MOVE WS-CURRENT-DT          TO CDATEO
 24372           MOVE TIME-OUT               TO CTIMEO
 24373           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24374           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24375           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24376           MOVE SPACES                 TO CPFENTRO
 24377           MOVE AL-UANOF               TO CPFENTRA
 24378        ELSE
 24379           MOVE WS-CURRENT-DT          TO DDATEO
 24380           MOVE TIME-OUT               TO DTIMEO
 24381           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24382
 24383
 24384* EXEC CICS SEND
 24385*        MAP      (PI-MAP-NAME)
 24386*        MAPSET   (MAPSET-EL6311S)
 24387*        FROM     (EL631BI)
 24388*        DATAONLY
 24389*        CURSOR
 24390*    END-EXEC.
 24391     MOVE LENGTH OF
 24392      EL631BI
 24393       TO DFHEIV12
 24394     MOVE -1
 24395       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 450
* EL6311.cbl
 24396*    MOVE '8$D    CT       H L F ,   #00020538' TO DFHEIV0
 24397     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24398     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24399     MOVE X'2020233030303230353338' TO DFHEIV0(25:11)
 24400     CALL 'kxdfhei1' USING DFHEIV0,
 24401           PI-MAP-NAME,
 24402           EL631BI,
 24403           DFHEIV12,
 24404           MAPSET-EL6311S,
 24405           DFHEIV99,
 24406           DFHEIV99,
 24407           DFHEIV99,
 24408           DFHEIV11,
 24409           DFHEIV99,
 24410           DFHEIV99,
 24411           DFHEIV99
 24412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24413
 24414
 24415     GO TO 9100-RETURN-TRAN.
 24416
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 451
* EL6311.cbl
 24418
 24419******************************************************************
 24420*                                                                *
 24421*           U T I L I T Y   R O U T I N E S                      *
 24422*                                                                *
 24423******************************************************************
 24424
 24425 8300-SEND-TEXT.
 24426
 24427* EXEC CICS SEND TEXT
 24428*        FROM     (LOGOFF-TEXT)
 24429*        LENGTH   (LOGOFF-LENGTH)
 24430*        ERASE
 24431*        FREEKB
 24432*    END-EXEC.
 24433*    MOVE '8&      T  E F  H   F -   #00020557' TO DFHEIV0
 24434     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24435     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24436     MOVE X'2020233030303230353537' TO DFHEIV0(25:11)
 24437     CALL 'kxdfhei1' USING DFHEIV0,
 24438           LOGOFF-TEXT,
 24439           LOGOFF-LENGTH,
 24440           DFHEIV99,
 24441           DFHEIV99,
 24442           DFHEIV99,
 24443           DFHEIV99,
 24444           DFHEIV99,
 24445           DFHEIV99,
 24446           DFHEIV99,
 24447           DFHEIV99,
 24448           DFHEIV99,
 24449           DFHEIV99
 24450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24451
 24452
 24453
 24454* EXEC CICS RETURN
 24455*    END-EXEC.
 24456*    MOVE '.(                    ''   #00020564' TO DFHEIV0
 24457     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24458     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24459     MOVE X'2020233030303230353634' TO DFHEIV0(25:11)
 24460     CALL 'kxdfhei1' USING DFHEIV0,
 24461           DFHEIV99,
 24462           DFHEIV99,
 24463           DFHEIV99,
 24464           DFHEIV99,
 24465           DFHEIV99,
 24466           DFHEIV99
 24467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24468
 24469
 24470 8400-LOG-JOURNAL-RECORD.
 24471     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24472     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24473
 24474*    EXEC CICS JOURNAL
 24475*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 452
* EL6311.cbl
 24476*        JTYPEID     ('EL')
 24477*        FROM        (JOURNAL-RECORD)
 24478*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24479*    END-EXEC.
 24480
 24481 8600-DEEDIT.
 24482
 24483* EXEC CICS BIF DEEDIT
 24484*         FIELD   (DEEDIT-FIELD)
 24485*         LENGTH  (15)
 24486*    END-EXEC.
 24487     MOVE 15
 24488       TO DFHEIV11
 24489*    MOVE '@"L                   #   #00020579' TO DFHEIV0
 24490     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24491     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24492     MOVE X'2020233030303230353739' TO DFHEIV0(25:11)
 24493     CALL 'kxdfhei1' USING DFHEIV0,
 24494           DEEDIT-FIELD,
 24495           DFHEIV11
 24496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24497
 24498
 24499 8800-UNAUTHORIZED-ACCESS.
 24500     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24501     GO TO 8300-SEND-TEXT.
 24502
 24503 8810-PF23.
 24504     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24505     MOVE XCTL-EL005             TO PGM-NAME.
 24506     GO TO 9300-XCTL.
 24507
 24508 9100-RETURN-TRAN.
 24509     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24510
 24511     IF  PI-MAP-NAME =  EL631B
 24512         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24513
 24514     IF  PI-MAP-NAME =  EL631C
 24515         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24516
 24517     IF  PI-MAP-NAME =  EL631D
 24518         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24519
 24520
 24521* EXEC CICS RETURN
 24522*        TRANSID    (TRANS-EXB1)
 24523*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24524*        LENGTH     (1300)
 24525*    END-EXEC.
 24526     MOVE 1300
 24527       TO DFHEIV11
 24528*    MOVE '.(CT                  ''   #00020605' TO DFHEIV0
 24529     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24530     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24531     MOVE X'2020233030303230363035' TO DFHEIV0(25:11)
 24532     CALL 'kxdfhei1' USING DFHEIV0,
 24533           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 453
* EL6311.cbl
 24534           PROGRAM-INTERFACE-BLOCK,
 24535           DFHEIV11,
 24536           DFHEIV99,
 24537           DFHEIV99,
 24538           DFHEIV99
 24539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24540
 24541
 24542 9200-RETURN-MAIN-MENU.
 24543     MOVE XCTL-EL626             TO PGM-NAME.
 24544     GO TO 9300-XCTL.
 24545
 24546 9300-XCTL.
 24547
 24548* EXEC CICS XCTL
 24549*        PROGRAM    (PGM-NAME)
 24550*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24551*        LENGTH     (PI-COMM-LENGTH)
 24552*    END-EXEC.
 24553*    MOVE '.$C                   %   #00020616' TO DFHEIV0
 24554     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24555     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24556     MOVE X'2020233030303230363136' TO DFHEIV0(25:11)
 24557     CALL 'kxdfhei1' USING DFHEIV0,
 24558           PGM-NAME,
 24559           PROGRAM-INTERFACE-BLOCK,
 24560           PI-COMM-LENGTH,
 24561           DFHEIV99
 24562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24563
 24564
 24565 9400-CLEAR.
 24566     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24567     GO TO 9300-XCTL.
 24568
 24569 9500-PF12.
 24570     MOVE XCTL-EL010             TO PGM-NAME.
 24571     GO TO 9300-XCTL.
 24572
 24573 9600-PGMID-ERROR.
 24574
 24575* EXEC CICS HANDLE CONDITION
 24576*        PGMIDERR    (8300-SEND-TEXT)
 24577*    END-EXEC.
 24578*    MOVE '"$L                   ! \ #00020631' TO DFHEIV0
 24579     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24580     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24581     MOVE X'5C20233030303230363331' TO DFHEIV0(25:11)
 24582     CALL 'kxdfhei1' USING DFHEIV0
 24583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24584
 24585
 24586     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24587     MOVE ' '                    TO PI-ENTRY-CD-1.
 24588     MOVE XCTL-EL005             TO PGM-NAME.
 24589     MOVE PGM-NAME               TO LOGOFF-PGM.
 24590     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24591     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 454
* EL6311.cbl
 24592
 24593 9700-DATE-LINK.
 24594     MOVE LINK-ELDATCV           TO PGM-NAME.
 24595
 24596* EXEC CICS LINK
 24597*        PROGRAM    (PGM-NAME)
 24598*        COMMAREA   (DATE-CONVERSION-DATA)
 24599*        LENGTH     (DC-COMM-LENGTH)
 24600*    END-EXEC.
 24601*    MOVE '."C                   (   #00020644' TO DFHEIV0
 24602     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24603     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24604     MOVE X'2020233030303230363434' TO DFHEIV0(25:11)
 24605     CALL 'kxdfhei1' USING DFHEIV0,
 24606           PGM-NAME,
 24607           DATE-CONVERSION-DATA,
 24608           DC-COMM-LENGTH,
 24609           DFHEIV99,
 24610           DFHEIV99,
 24611           DFHEIV99,
 24612           DFHEIV99
 24613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24614
 24615
 24616 9800-LINK-PENDING-EDIT.
 24617     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24618     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24619
 24620     MOVE LINK-EL050             TO PGM-NAME
 24621     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24622     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24623                                    WK-CO-TOL-CLAIM
 24624                                    WK-CO-TOL-PREM
 24625                                    WK-CO-TOL-REFUND
 24626                                    WK-CO-TOL-PREM-PCT
 24627                                    WK-CO-TOL-REFUND-PCT
 24628                                    WK-REFUND-OVS-AMT
 24629                                    WK-REFUND-OVS-PCT
 24630                                    WK-ACCT-ADDR
 24631                                    WK-LIFE-EDIT-ADDR
 24632                                    WK-AH-EDIT-ADDR
 24633                                    WK-LIFE-BEN-ADDR
 24634                                    WK-AH-BEN-ADDR
 24635                                    WK-STATE-ADDR
 24636                                    WK-PLAN-ADDR
 24637                                    WK-FORM-ADDR
 24638     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24639
 24640     MOVE '6'                    TO WK-ENTRY-SW.
 24641
 24642     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24643
 24644     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24645                                    EC-AM-EXPIRATION-DT
 24646                                    EC-AM-EFFECTIVE-DT
 24647                                    EC-CM-LF-CANCEL-DT
 24648                                    EC-CM-AH-CANCEL-DT
 24649                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 455
* EL6311.cbl
 24650
 24651     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24652                                    EC-CO-TOL-REFUND
 24653                                    EC-CO-MIN-AGE
 24654                                    EC-CO-MIN-PREMIUM
 24655                                    EC-CO-MIN-TERM
 24656                                    EC-CO-MAX-TERM
 24657                                    EC-ST-TOL-PREM
 24658                                    EC-ST-TOL-REFUND
 24659                                    EC-AM-LF-TOL-PREM
 24660                                    EC-AM-AH-TOL-PREM
 24661                                    EC-AM-LF-MAX-ATT-AGE
 24662                                    EC-AM-LF-MAX-AGE
 24663                                    EC-AM-LF-MAX-TERM
 24664                                    EC-AM-LF-MAX-TOT-BEN
 24665                                    EC-AM-AH-MAX-ATT-AGE
 24666                                    EC-AM-AH-MAX-AGE
 24667                                    EC-AM-AH-MAX-TERM
 24668                                    EC-AM-AH-MAX-TOT-BEN
 24669                                    EC-AM-AH-MAX-MON-BEN
 24670                                    EC-RT-LF-MAX-ATT-AGE
 24671                                    EC-RT-LF-MAX-AGE
 24672                                    EC-RT-LF-MAX-TERM
 24673                                    EC-RT-LF-MAX-TOT-BEN
 24674                                    EC-RT-AH-MAX-ATT-AGE
 24675                                    EC-RT-AH-MAX-AGE
 24676                                    EC-RT-AH-MAX-TERM
 24677                                    EC-RT-AH-MAX-TOT-BEN
 24678                                    EC-RT-AH-MAX-MON-BEN
 24679                                    EC-RT-AH-RATE
 24680                                    EC-RT-LF-RATE
 24681                                    EC-RT-LF-NSP-RATE
 24682                                    EC-RT-AH-NSP-RATE
 24683                                    EC-CM-LF-PRIOR-REFUND
 24684                                    EC-CM-AH-PRIOR-REFUND.
 24685
 24686     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24687                                    EC-ST-TOL-PREM-PCT
 24688                                    EC-AM-LF-TOL-REFUND
 24689                                    EC-AM-LF-DEV-PERCENT
 24690                                    EC-CO-TOL-REFUND-PCT
 24691                                    EC-ST-TOL-REFUND-PCT
 24692                                    EC-AM-AH-TOL-REFUND
 24693                                    EC-AM-AH-DEV-PERCENT.
 24694
 24695
 24696* EXEC CICS LINK
 24697*         PROGRAM   (PGM-NAME)
 24698*         COMMAREA  (PASSED-RECORD)
 24699*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24700*    END-EXEC.
 24701*    MOVE '."C                   (   #00020729' TO DFHEIV0
 24702     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24703     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24704     MOVE X'2020233030303230373239' TO DFHEIV0(25:11)
 24705     CALL 'kxdfhei1' USING DFHEIV0,
 24706           PGM-NAME,
 24707           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 456
* EL6311.cbl
 24708           WS-EDIT-PASS-LENGTH,
 24709           DFHEIV99,
 24710           DFHEIV99,
 24711           DFHEIV99,
 24712           DFHEIV99
 24713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24714
 24715
 24716     MOVE '1'                    TO PI-EDIT-SW.
 24717     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24718
 24719     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24720
 24721     IF PI-COMPANY-ID = 'UCL'
 24722         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24723
 24724     IF VALID-PB-ID
 24725        GO TO 9800-EXIT.
 24726
 24727     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24728
 24729     IF PI-MAP-NAME = EL631B
 24730        MOVE -1                  TO BMAINTL
 24731       ELSE
 24732        MOVE -1                  TO CMAINTL.
 24733
 24734     GO TO 8200-SEND-DATAONLY.
 24735
 24736 9800-EXIT.
 24737      EXIT.
 24738
 24739 9900-ERROR-FORMAT.
 24740
 24741     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24742
 24743     IF NOT EMI-ERRORS-COMPLETE
 24744         MOVE LINK-EL001         TO PGM-NAME
 24745
 24746* EXEC CICS LINK
 24747*            PROGRAM    (PGM-NAME)
 24748*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24749*            LENGTH     (EMI-COMM-LENGTH)
 24750*        END-EXEC.
 24751*    MOVE '."C                   (   #00020764' TO DFHEIV0
 24752     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24753     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24754     MOVE X'2020233030303230373634' TO DFHEIV0(25:11)
 24755     CALL 'kxdfhei1' USING DFHEIV0,
 24756           PGM-NAME,
 24757           ERROR-MESSAGE-INTERFACE-BLOCK,
 24758           EMI-COMM-LENGTH,
 24759           DFHEIV99,
 24760           DFHEIV99,
 24761           DFHEIV99,
 24762           DFHEIV99
 24763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24764
 24765
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 457
* EL6311.cbl
 24766 9900-EXIT.
 24767     EXIT.
 24768
 24769 9990-ABEND.
 24770     MOVE LINK-EL004             TO PGM-NAME.
 24771     MOVE DFHEIBLK               TO EMI-LINE1.
 24772
 24773* EXEC CICS LINK
 24774*        PROGRAM   (PGM-NAME)
 24775*        COMMAREA  (EMI-LINE1)
 24776*        LENGTH    (72)
 24777*    END-EXEC.
 24778     MOVE 72
 24779       TO DFHEIV11
 24780*    MOVE '."C                   (   #00020776' TO DFHEIV0
 24781     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24783     MOVE X'2020233030303230373736' TO DFHEIV0(25:11)
 24784     CALL 'kxdfhei1' USING DFHEIV0,
 24785           PGM-NAME,
 24786           EMI-LINE1,
 24787           DFHEIV11,
 24788           DFHEIV99,
 24789           DFHEIV99,
 24790           DFHEIV99,
 24791           DFHEIV99
 24792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24793
 24794
 24795     IF PI-MAP-NAME = EL631B
 24796        MOVE -1                  TO BMAINTL
 24797       ELSE
 24798        MOVE -1                  TO CMAINTL.
 24799
 24800     IF EIBTRNID NOT = TRANS-EXB1
 24801        GO TO 8100-SEND-INITIAL-MAP
 24802       ELSE
 24803        GO TO 8200-SEND-DATAONLY.
 24804
 24805 9995-SECURITY-VIOLATION.
 24806*                            COPY ELCSCTP.
 24807******************************************************************
 24808*                                                                *
 24809*                            ELCSCTP                             *
 24810*                            VMOD=2.001                          *
 24811*                                                                *
 24812*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24813******************************************************************
 24814
 24815
 24816     MOVE EIBDATE          TO SM-JUL-DATE.
 24817     MOVE EIBTRMID         TO SM-TERMID.
 24818     MOVE THIS-PGM         TO SM-PGM.
 24819     MOVE EIBTIME          TO TIME-IN.
 24820     MOVE TIME-OUT         TO SM-TIME.
 24821     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24822
 24823
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 458
* EL6311.cbl
 24824* EXEC CICS LINK
 24825*         PROGRAM  ('EL003')
 24826*         COMMAREA (SECURITY-MESSAGE)
 24827*         LENGTH   (80)
 24828*    END-EXEC.
 24829     MOVE 'EL003' TO DFHEIV1
 24830     MOVE 80
 24831       TO DFHEIV11
 24832*    MOVE '."C                   (   #00020810' TO DFHEIV0
 24833     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24834     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24835     MOVE X'2020233030303230383130' TO DFHEIV0(25:11)
 24836     CALL 'kxdfhei1' USING DFHEIV0,
 24837           DFHEIV1,
 24838           SECURITY-MESSAGE,
 24839           DFHEIV11,
 24840           DFHEIV99,
 24841           DFHEIV99,
 24842           DFHEIV99,
 24843           DFHEIV99
 24844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24845
 24846
 24847******************************************************************
 24848
 24849
 24850 9999-DFHBACK SECTION.
 24851     MOVE '9%                    "   ' TO DFHEIV0
 24852     MOVE 'EL6311' TO DFHEIV1
 24853     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24854     GOBACK.
 24855 9999-DFHEXIT.
 24856     IF DFHEIGDJ EQUAL 0001
 24857         NEXT SENTENCE
 24858     ELSE IF DFHEIGDJ EQUAL 2
 24859         GO TO 9600-PGMID-ERROR,
 24860               9990-ABEND,
 24861               9990-ABEND,
 24862               0010-MAIN-LOGIC
 24863         DEPENDING ON DFHEIGDI
 24864     ELSE IF DFHEIGDJ EQUAL 3
 24865         GO TO 1280-BATCH-HDR-NOT-FOUND
 24866         DEPENDING ON DFHEIGDI
 24867     ELSE IF DFHEIGDJ EQUAL 4
 24868         GO TO 1290-DUPLICATE-ALT-INDEX
 24869         DEPENDING ON DFHEIGDI
 24870     ELSE IF DFHEIGDJ EQUAL 5
 24871         GO TO 1295-CERT-TRL-REC-NOTFND
 24872         DEPENDING ON DFHEIGDI
 24873     ELSE IF DFHEIGDJ EQUAL 6
 24874         GO TO 1380-BATCH-HDR-NOT-FOUND
 24875         DEPENDING ON DFHEIGDI
 24876     ELSE IF DFHEIGDJ EQUAL 7
 24877         GO TO 1385-REC-NOT-FOUND
 24878         DEPENDING ON DFHEIGDI
 24879     ELSE IF DFHEIGDJ EQUAL 8
 24880         GO TO 1386-NOTFND
 24881         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 459
* EL6311.cbl
 24882     ELSE IF DFHEIGDJ EQUAL 9
 24883         GO TO 1399-EXIT
 24884         DEPENDING ON DFHEIGDI
 24885     ELSE IF DFHEIGDJ EQUAL 10
 24886         GO TO 1480-BATCH-HDR-NOT-FOUND
 24887         DEPENDING ON DFHEIGDI
 24888     ELSE IF DFHEIGDJ EQUAL 11
 24889         GO TO 1490-RECORD-NOT-FOUND
 24890         DEPENDING ON DFHEIGDI
 24891     ELSE IF DFHEIGDJ EQUAL 12
 24892         GO TO 1405-DELETE-CERTIFICATE
 24893         DEPENDING ON DFHEIGDI
 24894     ELSE IF DFHEIGDJ EQUAL 13
 24895         GO TO 1420-CONTINUE-DELETE
 24896         DEPENDING ON DFHEIGDI
 24897     ELSE IF DFHEIGDJ EQUAL 14
 24898         GO TO 1406-DELETE-ERNOTE
 24899         DEPENDING ON DFHEIGDI
 24900     ELSE IF DFHEIGDJ EQUAL 15
 24901         GO TO 1407-DELETE-MAILING
 24902         DEPENDING ON DFHEIGDI
 24903     ELSE IF DFHEIGDJ EQUAL 16
 24904         GO TO 1420-CONTINUE-DELETE
 24905         DEPENDING ON DFHEIGDI
 24906     ELSE IF DFHEIGDJ EQUAL 17
 24907         GO TO 1480-BATCH-HDR-NOT-FOUND
 24908         DEPENDING ON DFHEIGDI
 24909     ELSE IF DFHEIGDJ EQUAL 18
 24910         GO TO 1475-DELETE-FINISHED
 24911         DEPENDING ON DFHEIGDI
 24912     ELSE IF DFHEIGDJ EQUAL 19
 24913         GO TO 2280-BATCH-HDR-NOT-FOUND
 24914         DEPENDING ON DFHEIGDI
 24915     ELSE IF DFHEIGDJ EQUAL 20
 24916         GO TO 2290-DUPLICATE-ALT-INDEX
 24917         DEPENDING ON DFHEIGDI
 24918     ELSE IF DFHEIGDJ EQUAL 21
 24919         GO TO 2380-BATCH-HDR-NOT-FOUND
 24920         DEPENDING ON DFHEIGDI
 24921     ELSE IF DFHEIGDJ EQUAL 22
 24922         GO TO 2385-REC-NOT-FOUND
 24923         DEPENDING ON DFHEIGDI
 24924     ELSE IF DFHEIGDJ EQUAL 23
 24925         GO TO 2380-BATCH-HDR-NOT-FOUND
 24926         DEPENDING ON DFHEIGDI
 24927     ELSE IF DFHEIGDJ EQUAL 24
 24928         GO TO 2485-BATCH-HDR-NOT-FOUND
 24929         DEPENDING ON DFHEIGDI
 24930     ELSE IF DFHEIGDJ EQUAL 25
 24931         GO TO 2490-RECORD-NOT-FOUND
 24932         DEPENDING ON DFHEIGDI
 24933     ELSE IF DFHEIGDJ EQUAL 26
 24934         GO TO 2475-CONTINUE-DELETE
 24935         DEPENDING ON DFHEIGDI
 24936     ELSE IF DFHEIGDJ EQUAL 27
 24937         GO TO 2485-BATCH-HDR-NOT-FOUND
 24938         DEPENDING ON DFHEIGDI
 24939     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 460
* EL6311.cbl
 24940         GO TO 2480-DELETE-FINISHED
 24941         DEPENDING ON DFHEIGDI
 24942     ELSE IF DFHEIGDJ EQUAL 29
 24943         GO TO 2820-PROCESS-REWRITE
 24944         DEPENDING ON DFHEIGDI
 24945     ELSE IF DFHEIGDJ EQUAL 30
 24946         GO TO 2885-RECORD-MISSING
 24947         DEPENDING ON DFHEIGDI
 24948     ELSE IF DFHEIGDJ EQUAL 31
 24949         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24950         DEPENDING ON DFHEIGDI
 24951     ELSE IF DFHEIGDJ EQUAL 32
 24952         GO TO 2827-DELETE-MAILING
 24953         DEPENDING ON DFHEIGDI
 24954     ELSE IF DFHEIGDJ EQUAL 33
 24955         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24956         DEPENDING ON DFHEIGDI
 24957     ELSE IF DFHEIGDJ EQUAL 34
 24958         GO TO 2920-PROCESS-REWRITE
 24959         DEPENDING ON DFHEIGDI
 24960     ELSE IF DFHEIGDJ EQUAL 35
 24961         GO TO 2985-RECORD-MISSING
 24962         DEPENDING ON DFHEIGDI
 24963     ELSE IF DFHEIGDJ EQUAL 36
 24964         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24965         DEPENDING ON DFHEIGDI
 24966     ELSE IF DFHEIGDJ EQUAL 37
 24967         GO TO 2990-DUPLICATE-RECORD
 24968         DEPENDING ON DFHEIGDI
 24969     ELSE IF DFHEIGDJ EQUAL 38
 24970         GO TO 3590-NOT-FOUND
 24971         DEPENDING ON DFHEIGDI
 24972     ELSE IF DFHEIGDJ EQUAL 39
 24973         GO TO 3690-NOT-FOUND
 24974         DEPENDING ON DFHEIGDI
 24975     ELSE IF DFHEIGDJ EQUAL 40
 24976         GO TO 3990-NOT-FOUND
 24977         DEPENDING ON DFHEIGDI
 24978     ELSE IF DFHEIGDJ EQUAL 41
 24979         GO TO 4050-END-RECORDS,
 24980               4050-END-RECORDS
 24981         DEPENDING ON DFHEIGDI
 24982     ELSE IF DFHEIGDJ EQUAL 42
 24983         GO TO 4150-END-BATCH
 24984         DEPENDING ON DFHEIGDI
 24985     ELSE IF DFHEIGDJ EQUAL 43
 24986         GO TO 4150-END-BATCH
 24987         DEPENDING ON DFHEIGDI
 24988     ELSE IF DFHEIGDJ EQUAL 44
 24989         GO TO 4250-END-RECORDS,
 24990               4250-END-RECORDS
 24991         DEPENDING ON DFHEIGDI
 24992     ELSE IF DFHEIGDJ EQUAL 45
 24993         GO TO 4350-END-BATCH,
 24994               4350-END-BATCH
 24995         DEPENDING ON DFHEIGDI
 24996     ELSE IF DFHEIGDJ EQUAL 46
 24997         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 11-Jan-17 08:55 Page 461
* EL6311.cbl
 24998               4550-END-RECORDS
 24999         DEPENDING ON DFHEIGDI
 25000     ELSE IF DFHEIGDJ EQUAL 47
 25001         GO TO 4680-NOT-FOUND,
 25002               4680-NOT-FOUND
 25003         DEPENDING ON DFHEIGDI
 25004     ELSE IF DFHEIGDJ EQUAL 48
 25005         GO TO 4860-NOT-FOUND,
 25006               4850-END-RECORDS
 25007         DEPENDING ON DFHEIGDI
 25008     ELSE IF DFHEIGDJ EQUAL 49
 25009         GO TO 4970-NOT-FOUND,
 25010               4950-END-RECORDS
 25011         DEPENDING ON DFHEIGDI
 25012     ELSE IF DFHEIGDJ EQUAL 50
 25013         GO TO 5050-NOT-FOUND
 25014         DEPENDING ON DFHEIGDI
 25015     ELSE IF DFHEIGDJ EQUAL 51
 25016         GO TO 5050-NOT-FOUND
 25017         DEPENDING ON DFHEIGDI
 25018     ELSE IF DFHEIGDJ EQUAL 52
 25019         GO TO 5050-NOT-FOUND
 25020         DEPENDING ON DFHEIGDI
 25021     ELSE IF DFHEIGDJ EQUAL 53
 25022         GO TO 5550-END-RECORDS,
 25023               5550-END-RECORDS
 25024         DEPENDING ON DFHEIGDI
 25025     ELSE IF DFHEIGDJ EQUAL 54
 25026         GO TO 6050-QID-ERROR
 25027         DEPENDING ON DFHEIGDI
 25028     ELSE IF DFHEIGDJ EQUAL 55
 25029         GO TO 6050-QID-ERROR
 25030         DEPENDING ON DFHEIGDI
 25031     ELSE IF DFHEIGDJ EQUAL 56
 25032         GO TO 6400-CONTINUE,
 25033               6400-CONTINUE
 25034         DEPENDING ON DFHEIGDI
 25035     ELSE IF DFHEIGDJ EQUAL 57
 25036         GO TO 3690-NOT-FOUND
 25037         DEPENDING ON DFHEIGDI
 25038     ELSE IF DFHEIGDJ EQUAL 58
 25039         GO TO 7399-EXIT
 25040         DEPENDING ON DFHEIGDI
 25041     ELSE IF DFHEIGDJ EQUAL 59
 25042         GO TO 7550-OFFICER-NOTFND
 25043         DEPENDING ON DFHEIGDI
 25044     ELSE IF DFHEIGDJ EQUAL 60
 25045         GO TO 8300-SEND-TEXT
 25046         DEPENDING ON DFHEIGDI.
 25047     MOVE '9%                    "   ' TO DFHEIV0
 25048     MOVE 'EL6311' TO DFHEIV1
 25049     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25050     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15276     Code:       99137
