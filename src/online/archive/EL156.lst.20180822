* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60* 120115  CR2015082700002  PEMA  ADD JNT BORROWER PROCESSING
    61* 012016  IR2016011800003  PEMA  FIXED LENGTH OF PAYEE NAME
    62* 050616  CR2015030200004  TANA  Additional pmt Pd thru exp date
    63* 013017  CR2016053100001  PEMA  ACH PROCESSING
    64* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
    65* 102617    2017101800003  TANA  Fix family leave auth level
    66* 022718    2017100200004  TANA  Set hold & pays > than 30 days
    67* 031218    2018030800002  TANA  Handle offline pmts w/ hold & pay
    68******************************************************************
    69
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page   3
* EL156.cbl
    71 ENVIRONMENT DIVISION.
    72
    73 DATA DIVISION.
    74
    75 WORKING-STORAGE SECTION.
    76 01  DFH-START PIC X(04).
    77
    78 77  FILLER  PIC X(32)  VALUE '********************************'.
    79 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    80 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    81 77  WS-SSN  PIC X(9) VALUE ZEROS.
    82 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    83 77  C0                          PIC S999 COMP-3 VALUE +0.
    84 77  C1                          PIC S999 COMP-3 VALUE +0.
    85 77  C2                          PIC S999 COMP-3 VALUE +0.
    86 77  C3                          PIC S999 COMP-3 VALUE +0.
    87 77  s1                          PIC S999 COMP-3 VALUE +0.
    88 77  s2                          pic s999 comp-3 value +0.
    89 77  P1                          PIC S999 COMP-3 VALUE +0.
    90 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    91 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    92 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    93 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    94 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    95 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    96 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    97 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    98 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    99 77  ws-max-bens                 pic s999 comp-3 value +0.
   100 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
   101 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
   102 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
   103 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
   104 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
   105 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
   106
   107*    COPY ELCSCTM.
   108******************************************************************
   109*                                                                *
   110*                                                                *
   111*                            ELCSCTM                             *
   112*                            VMOD=2.001                          *
   113*                                                                *
   114*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   115*                                                                *
   116******************************************************************
   117 01  SECURITY-MESSAGE.
   118     12  FILLER                          PIC X(30)
   119            VALUE '** LOGIC SECURITY VIOLATION -'.
   120     12  SM-READ                         PIC X(6).
   121     12  FILLER                          PIC X(5)
   122            VALUE ' PGM='.
   123     12  SM-PGM                          PIC X(6).
   124     12  FILLER                          PIC X(5)
   125            VALUE ' OPR='.
   126     12  SM-PROCESSOR-ID                 PIC X(4).
   127     12  FILLER                          PIC X(6)
   128            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page   4
* EL156.cbl
   129     12  SM-TERMID                       PIC X(4).
   130     12  FILLER                          PIC XX   VALUE SPACE.
   131     12  SM-JUL-DATE                     PIC 9(5).
   132     12  FILLER                          PIC X    VALUE SPACE.
   133     12  SM-TIME                         PIC 99.99.
   134
   135
   136*    COPY ELCSCRTY.
   137******************************************************************
   138*                                                                *
   139*                                                                *
   140*                            ELCSCRTY                            *
   141*                            VMOD=2.001                          *
   142*                                                                *
   143*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   144*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   145*        SAVED IN PI-SECURITY-ADDRESS.                           *
   146*                                                                *
   147******************************************************************
   148 01  SECURITY-CONTROL.
   149     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   150     12  FILLER                       PIC XX    VALUE 'SC'.
   151     12  SC-CREDIT-CODES.
   152         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   153             20  SC-CREDIT-DISPLAY    PIC X.
   154             20  SC-CREDIT-UPDATE     PIC X.
   155     12  SC-CLAIMS-CODES.
   156         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   157             20  SC-CLAIMS-DISPLAY    PIC X.
   158             20  SC-CLAIMS-UPDATE     PIC X.
   159
   160 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   161 01  WS-DATE-AREA.
   162     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   163     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   164     12  SAVE-DATE-CCYYMMDD.
   165         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   166         16  SAVE-DATE-YMD.
   167             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   168             20  FILLER              PIC X(04)   VALUE SPACES.
   169
   170 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   171 01  STANDARD-AREAS.
   172     12  WS-RESPONSE         PIC S9(8)   COMP.
   173         88  WS-RESP-NORMAL              VALUE +00.
   174         88  WS-RESP-ERROR               VALUE +01.
   175         88  WS-RESP-NOTFND              VALUE +13.
   176         88  WS-RESP-DUPREC              VALUE +14.
   177         88  WS-RESP-ENDFILE             VALUE +20.
   178     12  PMT-HEAD-A.
   179         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   180         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   181         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   182-        '     RESERVES  TYPE    AMOUNT'.
   183     12  PMT-HEAD-B.
   184         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   185         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   186         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page   5
* EL156.cbl
   187     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   188     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   189     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   190     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   191     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   192     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   193     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   194     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   195     12  PGM-NAME            PIC X(8).
   196     12  TIME-IN             PIC S9(7).
   197     12  TIME-OUT-R  REDEFINES TIME-IN.
   198         16  FILLER          PIC X.
   199         16  TIME-OUT        PIC 99V99.
   200         16  FILLER          PIC XX.
   201     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   202     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   203     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   204     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   205     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   206     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   207     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   208     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   209     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   210     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   211     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   212     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   213     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   214     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   215     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   216     12  WS-BLANK            PIC X       VALUE ' '.
   217
   218 01  MISC-WORK-AREAS.
   219     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   220     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   221     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   222     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   223     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   224     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   225     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   226     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   227     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   228     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   229     12  W-CALLED-NAME           PIC X(08).
   230     12  W-EOB-CODES.
   231         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   232             20  W-EOB-CODE      PIC XXX.
   233             20  W-EOB-FILLER    PIC X.
   234     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   235     12  W-NAME-LAST             PIC X(15).
   236     12  W-NAME-FIRST            PIC X(15).
   237     12  W-NAME-MIDDLE.
   238         16  FILLER              PIC X.
   239         16  W-NAME-MIDDLE-2     PIC X.
   240         16  FILLER              PIC X(13).
   241     12  W-DMD-CHECK-NO.
   242         16  W-DMD-CHECK-NO-1    PIC X(4).
   243         16  W-DMD-CHECK-NO-2    PIC X.
   244         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page   6
* EL156.cbl
   245
   246     12  WS-COMPUTE-FROM-DT  PIC XX.
   247     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   248     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   249     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   250     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   251     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   252     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   253         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   254         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   255     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   256         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   257     12  WS-UPDATE-SW        PIC X VALUE ' '.
   258     12  WS-GROUPING.
   259         16  WS-GROUP-1      PIC X VALUE SPACES.
   260         16  FILLER          PIC X(05) VALUE SPACES.
   261     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   262     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   263     12  WS-WORK-STATE-ACCT.
   264         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   265         16  FILLER          PIC X       VALUE '/'.
   266         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   267     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   268     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   269     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   270     12  QID.
   271         16  QID-TERM        PIC X(4)    VALUE SPACES.
   272         16  FILLER          PIC X(4)    VALUE '156A'.
   273     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   274     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   275     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   276     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   277     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   278     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   279     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   280     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   281     12  WS-STATUS           PIC X       VALUE SPACES.
   282     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   283     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   284     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   285     12  ws-extended-exp-dt  pic xx      value low-values.
   286     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   287     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   288     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   289     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   290     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   291     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   292     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   293     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   294     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   295     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   296     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   297     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   298     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   299     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   300     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   301     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   302     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page   7
* EL156.cbl
   303     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   304     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   305     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   306     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   307     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   308     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   309     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   310     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   311     12  WORK-DATE-FROM.
   312         16  WDF-MONTH       PIC 99        VALUE ZERO.
   313         16  WDF-DAY         PIC 99        VALUE ZERO.
   314         16  WDF-YEAR        PIC 99        VALUE ZERO.
   315     12  WORK-DATE-THRU.
   316         16  WDT-MONTH       PIC 99        VALUE ZERO.
   317         16  WDT-DAY         PIC 99        VALUE ZERO.
   318         16  WDT-YEAR        PIC 99        VALUE ZERO.
   319     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   320     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   321     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   322     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   323     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   324     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   325     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   326     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   327     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   328     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   329     12  WS-PY-WK REDEFINES WS-PY-WORK.
   330         16  WS-PY-NUM       PIC S9(7)V99.
   331         16  WS-PY-SIGN      PIC X.
   332     12  WS-DY-WORK          PIC S9(5).
   333     12  WS-DY-WK REDEFINES WS-DY-WORK.
   334         16  WS-DY-NUM       PIC S9(4).
   335         16  WS-DY-SIGN      PIC X.
   336     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   337         88  COMP-REC-FOUND              VALUE 'Y'.
   338     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   339         88  BENEFIT-FOUND       VALUE 'Y'.
   340         88  NO-BENEFIT-FOUND    VALUE 'N'.
   341     12  WS-TERMS.
   342         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   343         16  FILLER          PIC X       VALUE '/'.
   344         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   345         16  WST-REM-DAYS-GRP.
   346             20  WST-SLASH   PIC X       VALUE '/'.
   347             20  WST-REM-DAYS
   348                             PIC --9.
   349     12  WS-ACCESS.
   350         16  FILLER          PIC XX      VALUE SPACES.
   351         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   352     12  WS-STATE-ACCESS.
   353         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   354         16  FILLER          PIC XX      VALUE SPACES.
   355     12  WS-CARR-ACCESS.
   356         16  FILLER          PIC X(3)    VALUE SPACES.
   357         16  WS-CARR         PIC X       VALUE SPACES.
   358     12  DATE-WORK.
   359         16  FILLER          PIC XX      VALUE SPACES.
   360         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page   8
* EL156.cbl
   361     12  WS-SAVE-INPUT.
   362         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   363         16  WS-PAYEE        PIC XX      VALUE SPACE.
   364         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   365         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   366         16  WS-OFFLINE      PIC X       VALUE SPACE.
   367         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   368         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   369         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   370         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   371         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   372         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   373         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   374         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   375         16  WS-ETYPE        PIC X       VALUE SPACE.
   376         16  WS-CASH         PIC X       VALUE SPACE.
   377         16  WS-GROUPED      PIC X       VALUE SPACE.
   378         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   379         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   380         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   381         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   382         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   383         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   384         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   385         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   386         16  ws-int-to-rem-borr pic x value spaces.
   387     12  LAST-ERROR-LINE.
   388         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   389         16  FILLER              PIC X(30)
   390             VALUE ' FATAL ERRORS ENCOUNTERED'.
   391         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   392         16  FILLER              PIC X(28)
   393             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   394     12  WS-CHECK-AREA.
   395         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   396         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   397     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   398     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   399         16  FILLER              PIC XX.
   400         16  WS-A-CHECK-NUM-5    PIC 9(5).
   401     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   402         16  FILLER              PIC X.
   403         16  WS-A-CHECK-NUM-6    PIC 9(6).
   404     12  OPTION-1-SAVE-AREA.
   405         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   406         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   407     12  WS-WORK-ZIP.
   408         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   409         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   410     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   411                                 PIC 9(9).
   412     12  WS-FLI-PMTNOTE.
   413         16  WS-PMTOPTION        PIC XX.
   414         16  WS-DOCNAME          PIC X(28).
   415         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   416             20  WS-AMOUNT       PIC X(8).
   417             20  FILLER          PIC X(20).
   418         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page   9
* EL156.cbl
   419             20  WS-NUM-AMT      PIC 9(6)V99.
   420             20  FILLER          PIC X(20).
   421
   422     12  WS-HAN-PMTNOTE.
   423         16  WS-HAN-PMT-CODE     PIC X.
   424         16  WS-HAN-PMT-NOTE     PIC X(39).
   425
   426     12  WS-NCL-PMT-OPTION       PIC XX.
   427         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   428
   429     12  WS-CLAIM-SEQUENCE.
   430         16  FILLER              PIC X VALUE '('.
   431         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   432         16  FILLER              PIC X(04) VALUE ' OF '.
   433         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   434         16  FILLER              PIC X VALUE ')'.
   435
   436     12  WS-REFUND-AMT           PIC Z(7).99.
   437     12  WS-CALC-INT             PIC S9(7)V99.
   438     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   439
   440     12  SUB                     PIC 99 VALUE ZEROS.
   441
   442     12  WS-BOANOTE1.
   443         16  WS-BOANOTE1-DESC    PIC X(11).
   444         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   445         16  FILLER              PIC X(17).
   446     12  WS-BOANOTE2.
   447         16  WS-BOANOTE2-DESC    PIC X(11).
   448         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   449         16  FILLER              PIC X(17).
   450
   451     12  WS-NCLNOTE1.
   452         16  WS-NCLNOTE1-DESC    PIC X(11).
   453         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   454         16  FILLER              PIC X(17).
   455     12  WS-NCLNOTE2.
   456         16  WS-NCLNOTE2-DESC    PIC X(11).
   457         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   458         16  FILLER              PIC X(17).
   459
   460     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   461     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   462     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   463     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   464     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   465     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   466     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   467     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   468     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   469     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   470
   471     12  WS-AIG-WORK-AREAS.
   472         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   473             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   474         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   475             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   476         16  WS-FROM-DATE-MDY.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  10
* EL156.cbl
   477             20  WS-FROM-MO      PIC 99.
   478             20  WS-FROM-DA      PIC 99.
   479             20  WS-FROM-YR      PIC 99.
   480         16  WS-TEMP-DATE-MDY.
   481             20  WS-TEMP-MO      PIC 99.
   482             20  WS-TEMP-DA      PIC 99.
   483             20  WS-TEMP-YR      PIC 99.
   484         16  WS-BIN-FROM-DT      PIC XX.
   485         16  WS-TEMP-INC-MDY.
   486             20  WS-TEMP-INC-MO  PIC 99.
   487             20  WS-TEMP-INC-DA  PIC 99.
   488             20  WS-TEMP-INC-YR  PIC 99.
   489         16  WS-PMT-DUE-MDY.
   490             20  WS-PMT-DUE-MO   PIC 99.
   491             20  WS-PMT-DUE-DA   PIC 99.
   492             20  WS-PMT-DUE-YR   PIC 99.
   493         16  WS-PMT-DUE-DT       PIC XX.
   494         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   495         16  WS-RETRO-ELIM-DT    PIC XX.
   496         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   497             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   498         16  WS-SAVE-DUE-DA      PIC 99.
   499         16  WS-CDAYS            PIC S9(05).
   500         16  WS-DAYS-OFF         PIC S9(05).
   501         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   502             88  ELIM-SATISFIED            VALUE 'Y'.
   503         16  WS-AIG-CHECKNO.
   504             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   505             20  WS-A-CHECKNO-3-7.
   506                 24  FILLER              PIC X(3)    VALUE SPACES.
   507                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   508                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   509         16  WS-AIG-GROUPING.
   510             20  WS-A-BENE               PIC XXX.
   511             20  FILLER                  PIC XXX.
   512         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   513             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   514             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   515         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   516                 VALUE 'UNEMPLOYMENT PAYMENT'.
   517         16  WS-CHK-THRU-DT              PIC XX.
   518         16  WS-HOLD-BIN-DATE-1          PIC XX.
   519
   520 01  MISC-CSO-AREA.
   521     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   522     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   523     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   524         88  APPROVAL-NEEDED                        VALUE 'Y'.
   525     12  WS-APPROV-NOTE                  PIC X(43)
   526         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   527     12  WS-3550-APPROV-NOTE             PIC X(43)
   528         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   529     12  WS-REAUDIT-NOTE                 PIC X(43)
   530         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   531     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   532     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   533     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   534     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  11
* EL156.cbl
   535     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
   536     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   537     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   538         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   539     12  WS-PAYEE-CITY-STATE     PIC X(30).
   540     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   541         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   542     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   543     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   544     12  WS-WORK-NAME            PIC X(30).
   545     12  FILLER  REDEFINES WS-WORK-NAME.
   546         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   547     12  WS-INSURED-NAME         PIC X(30).
   548     12  FILLER  REDEFINES WS-INSURED-NAME.
   549         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   550     12  WS-PAYEE-NAME           PIC X(30).
   551     12  FILLER  REDEFINES WS-PAYEE-NAME.
   552         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   553     12  WS-HOLD-UNTIL-SW        PIC X VALUE SPACES.
   554         88  HOLD-UNTIL-CHK            VALUE 'Y'.
   555         88  HOLD-UNTIL-PMT            VALUE 'P'.
   556     12  WS-HOLD-UNTIL-DT        PIC X(02) VALUE ZERO.
   557
   558 01  ERROR-MESSAGES.
   559     12  ER-0000                 PIC X(4)  VALUE '0000'.
   560     12  ER-0004                 PIC X(4)  VALUE '0004'.
   561     12  ER-0008                 PIC X(4)  VALUE '0008'.
   562     12  ER-0019                 PIC X(4)  VALUE '0019'.
   563     12  ER-0029                 PIC X(4)  VALUE '0029'.
   564     12  ER-0042                 PIC X(4)  VALUE '0042'.
   565     12  ER-0070                 PIC X(4)  VALUE '0070'.
   566     12  ER-0130                 PIC X(4)  VALUE '0130'.
   567     12  ER-0149                 PIC X(4)  VALUE '0149'.
   568     12  ER-0154                 PIC X(4)  VALUE '0154'.
   569     12  ER-0168                 PIC X(4)  VALUE '0168'.
   570     12  ER-0169                 PIC X(4)  VALUE '0169'.
   571     12  ER-0172                 PIC X(4)  VALUE '0174'.
   572     12  ER-0198                 PIC X(4)  VALUE '0198'.
   573     12  ER-0204                 PIC X(4)  VALUE '0204'.
   574     12  ER-0206                 PIC X(4)  VALUE '0206'.
   575     12  ER-0252                 PIC X(4)  VALUE '0252'.
   576     12  ER-0254                 PIC X(4)  VALUE '0254'.
   577     12  ER-0282                 PIC X(4)  VALUE '0282'.
   578     12  ER-0283                 PIC X(4)  VALUE '0283'.
   579     12  ER-0294                 PIC X(4)  VALUE '0294'.
   580     12  ER-0338                 PIC X(4)  VALUE '0338'.
   581     12  ER-0419                 PIC X(4)  VALUE '0419'.
   582     12  ER-0420                 PIC X(4)  VALUE '0420'.
   583     12  ER-0421                 PIC X(4)  VALUE '0421'.
   584     12  ER-0422                 PIC X(4)  VALUE '0422'.
   585     12  ER-0433                 PIC X(4)  VALUE '0433'.
   586     12  ER-0436                 PIC X(4)  VALUE '0436'.
   587     12  ER-0437                 PIC X(4)  VALUE '0437'.
   588     12  ER-0438                 PIC X(4)  VALUE '0438'.
   589     12  ER-0439                 PIC X(4)  VALUE '0439'.
   590     12  ER-0440                 PIC X(4)  VALUE '0440'.
   591     12  ER-0441                 PIC X(4)  VALUE '0441'.
   592     12  ER-0442                 PIC X(4)  VALUE '0442'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  12
* EL156.cbl
   593     12  ER-0443                 PIC X(4)  VALUE '0443'.
   594     12  ER-0444                 PIC X(4)  VALUE '0444'.
   595     12  ER-0445                 PIC X(4)  VALUE '0445'.
   596     12  ER-0446                 PIC X(4)  VALUE '0446'.
   597     12  ER-0447                 PIC X(4)  VALUE '0447'.
   598     12  ER-0448                 PIC X(4)  VALUE '0448'.
   599     12  ER-0449                 PIC X(4)  VALUE '0449'.
   600     12  ER-0452                 PIC X(4)  VALUE '0452'.
   601     12  ER-0458                 PIC X(4)  VALUE '0458'.
   602     12  ER-0459                 PIC X(4)  VALUE '0459'.
   603     12  ER-0460                 PIC X(4)  VALUE '0460'.
   604     12  ER-0461                 PIC X(4)  VALUE '0461'.
   605     12  ER-0462                 PIC X(4)  VALUE '0462'.
   606     12  ER-0463                 PIC X(4)  VALUE '0463'.
   607     12  ER-0464                 PIC X(4)  VALUE '0464'.
   608     12  ER-0465                 PIC X(4)  VALUE '0465'.
   609     12  ER-0466                 PIC X(4)  VALUE '0466'.
   610     12  ER-0467                 PIC X(4)  VALUE '0467'.
   611     12  ER-0468                 PIC X(4)  VALUE '0468'.
   612     12  ER-0469                 PIC X(4)  VALUE '0469'.
   613     12  ER-0473                 PIC X(4)  VALUE '0473'.
   614     12  ER-0474                 PIC X(4)  VALUE '0474'.
   615     12  ER-0475                 PIC X(4)  VALUE '0475'.
   616     12  ER-0476                 PIC X(4)  VALUE '0476'.
   617     12  ER-0477                 PIC X(4)  VALUE '0477'.
   618     12  ER-0478                 PIC X(4)  VALUE '0478'.
   619     12  ER-0479                 PIC X(4)  VALUE '0479'.
   620     12  ER-0481                 PIC X(4)  VALUE '0481'.
   621     12  ER-0491                 PIC X(4)  VALUE '0491'.
   622     12  ER-0492                 PIC X(4)  VALUE '0492'.
   623     12  ER-0493                 PIC X(4)  VALUE '0493'.
   624     12  ER-0494                 PIC X(4)  VALUE '0494'.
   625     12  ER-0495                 PIC X(4)  VALUE '0495'.
   626     12  ER-0499                 PIC X(4)  VALUE '0499'.
   627     12  ER-0500                 PIC X(4)  VALUE '0500'.
   628     12  ER-0501                 PIC X(4)  VALUE '0501'.
   629     12  ER-0502                 PIC X(4)  VALUE '0502'.
   630     12  ER-0508                 PIC X(4)  VALUE '0508'.
   631     12  ER-0513                 PIC X(4)  VALUE '0513'.
   632     12  ER-0518                 PIC X(4)  VALUE '0518'.
   633     12  ER-0524                 PIC X(4)  VALUE '0524'.
   634     12  ER-0525                 PIC X(4)  VALUE '0525'.
   635     12  ER-0526                 PIC X(4)  VALUE '0526'.
   636     12  ER-0530                 PIC X(4)  VALUE '0530'.
   637     12  ER-0540                 PIC X(4)  VALUE '0540'.
   638     12  ER-0541                 PIC X(4)  VALUE '0541'.
   639     12  ER-0542                 PIC X(4)  VALUE '0542'.
   640     12  ER-0543                 PIC X(4)  VALUE '0543'.
   641     12  ER-0545                 PIC X(4)  VALUE '0545'.
   642     12  ER-0552                 PIC X(4)  VALUE '0552'.
   643     12  ER-0555                 PIC X(4)  VALUE '0555'.
   644     12  ER-0556                 PIC X(4)  VALUE '0556'.
   645     12  ER-0557                 PIC X(4)  VALUE '0557'.
   646     12  ER-0572                 PIC X(4)  VALUE '0572'.
   647     12  ER-0573                 PIC X(4)  VALUE '0573'.
   648     12  ER-0594                 PIC X(4)  VALUE '0594'.
   649     12  ER-0616                 PIC X(4)  VALUE '0616'.
   650     12  ER-0617                 PIC X(4)  VALUE '0617'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  13
* EL156.cbl
   651     12  ER-0618                 PIC X(4)  VALUE '0618'.
   652     12  ER-0657                 PIC X(4)  VALUE '0657'.
   653     12  ER-0658                 PIC X(4)  VALUE '0658'.
   654     12  ER-0699                 PIC X(4)  VALUE '0699'.
   655     12  ER-0730                 PIC X(4)  VALUE '0730'.
   656     12  ER-0737                 PIC X(4)  VALUE '0737'.
   657     12  ER-0760                 PIC X(4)  VALUE '0760'.
   658     12  ER-0768                 PIC X(4)  VALUE '0768'.
   659     12  ER-0769                 PIC X(4)  VALUE '0769'.
   660     12  ER-0770                 PIC X(4)  VALUE '0770'.
   661     12  ER-0802                 PIC X(4)  VALUE '0802'.
   662     12  ER-0803                 PIC X(4)  VALUE '0803'.
   663     12  ER-0819                 PIC X(4)  VALUE '0819'.
   664     12  ER-0834                 PIC X(4)  VALUE '0834'.
   665     12  ER-0836                 PIC X(4)  VALUE '0836'.
   666     12  ER-0844                 PIC X(4)  VALUE '0844'.
   667     12  ER-0845                 PIC X(4)  VALUE '0845'.
   668     12  ER-0846                 PIC X(4)  VALUE '0846'.
   669     12  ER-0849                 PIC X(4)  VALUE '0849'.
   670     12  ER-0851                 PIC X(4)  VALUE '0851'.
   671     12  ER-0872                 PIC X(4)  VALUE '0872'.
   672     12  ER-0873                 PIC X(4)  VALUE '0873'.
   673     12  ER-0874                 PIC X(4)  VALUE '0874'.
   674     12  ER-0879                 PIC X(4)  VALUE '0879'.
   675     12  ER-0919                 PIC X(4)  VALUE '0919'.
   676     12  ER-0921                 PIC X(4)  VALUE '0921'.
   677     12  ER-0923                 PIC X(4)  VALUE '0923'.
   678     12  ER-0925                 PIC X(4)  VALUE '0925'.
   679     12  ER-0944                 PIC X(4)  VALUE '0944'.
   680     12  ER-0945                 PIC X(4)  VALUE '0945'.
   681     12  ER-0946                 PIC X(4)  VALUE '0946'.
   682     12  ER-0947                 PIC X(4)  VALUE '0947'.
   683     12  ER-0948                 PIC X(4)  VALUE '0948'.
   684     12  ER-0949                 PIC X(4)  VALUE '0949'.
   685     12  ER-0950                 PIC X(4)  VALUE '0950'.
   686     12  ER-0951                 PIC X(4)  VALUE '0951'.
   687     12  ER-0954                 PIC X(4)  VALUE '0954'.
   688     12  ER-0956                 PIC X(4)  VALUE '0956'.
   689     12  ER-0967                 PIC X(4)  VALUE '0967'.
   690     12  ER-0968                 PIC X(4)  VALUE '0968'.
   691     12  ER-0974                 PIC X(4)  VALUE '0974'.
   692     12  ER-0975                 PIC X(4)  VALUE '0975'.
   693     12  ER-1561                 PIC X(4)  VALUE '1561'.
   694     12  ER-1566                 PIC X(4)  VALUE '1566'.
   695     12  ER-1567                 PIC X(4)  VALUE '1567'.
   696     12  ER-1569                 PIC X(4)  VALUE '1569'.
   697     12  er-1582                 pic x(4)  value '1582'.
   698     12  er-1657                 pic x(4)  value '1657'.
   699     12  er-1658                 pic x(4)  value '1658'.
   700     12  er-1667                 pic x(4)  value '1667'.
   701     12  er-1670                 pic x(4)  value '1670'.
   702     12  er-1671                 pic x(4)  value '1671'.
   703     12  er-1672                 pic x(4)  value '1672'.
   704     12  er-1673                 pic x(4)  value '1673'.
   705     12  er-1674                 pic x(4)  value '1674'.
   706     12  er-1677                 pic x(4)  value '1677'.
   707     12  ER-1775                 PIC X(4)  VALUE '1775'.
   708     12  ER-1880                 PIC X(4)  VALUE '1880'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  14
* EL156.cbl
   709     12  ER-2044                 PIC X(4)  VALUE '2044'.
   710     12  ER-3140                 PIC X(4)  VALUE '3140'.
   711     12  ER-3141                 PIC X(4)  VALUE '3141'.
   712     12  ER-3255                 PIC X(4)  VALUE '3255'.
   713     12  ER-3516                 PIC X(4)  VALUE '3516'.
   714     12  ER-3527                 PIC X(4)  VALUE '3527'.
   715     12  ER-3528                 PIC X(4)  VALUE '3528'.
   716     12  ER-3529                 PIC X(4)  VALUE '3529'.
   717     12  ER-3530                 PIC X(4)  VALUE '3530'.
   718     12  ER-3531                 PIC X(4)  VALUE '3531'.
   719     12  ER-3532                 PIC X(4)  VALUE '3532'.
   720     12  ER-3533                 PIC X(4)  VALUE '3533'.
   721     12  ER-3534                 PIC X(4)  VALUE '3534'.
   722     12  ER-3535                 PIC X(4)  VALUE '3535'.
   723     12  ER-3536                 PIC X(4)  VALUE '3536'.
   724     12  ER-3537                 PIC X(4)  VALUE '3537'.
   725     12  ER-3538                 PIC X(4)  VALUE '3538'.
   726     12  ER-3539                 PIC X(4)  VALUE '3539'.
   727     12  ER-3540                 PIC X(4)  VALUE '3540'.
   728     12  ER-3541                 PIC X(4)  VALUE '3541'.
   729     12  ER-3542                 PIC X(4)  VALUE '3542'.
   730     12  ER-3543                 PIC X(4)  VALUE '3543'.
   731     12  ER-3546                 PIC X(4)  VALUE '3546'.
   732     12  ER-3549                 PIC X(4)  VALUE '3549'.
   733     12  ER-3818                 PIC X(4)  VALUE '3818'.
   734     12  ER-7540                 PIC X(4)  VALUE '7540'.
   735     12  ER-7576                 PIC X(4)  VALUE '7576'.
   736     12  ER-7579                 PIC X(4)  VALUE '7579'.
   737     12  ER-7580                 PIC X(4)  VALUE '7580'.
   738     12  ER-7583                 PIC X(4)  VALUE '7583'.
   739     12  ER-7830                 PIC X(4)  VALUE '7830'.
   740     12  ER-7831                 PIC X(4)  VALUE '7831'.
   741     12  ER-7832                 PIC X(4)  VALUE '7832'.
   742     12  ER-7833                 PIC X(4)  VALUE '7833'.
   743     12  ER-7834                 PIC X(4)  VALUE '7834'.
   744     12  ER-7835                 PIC X(4)  VALUE '7835'.
   745     12  ER-7836                 PIC X(4)  VALUE '7836'.
   746     12  ER-7837                 PIC X(4)  VALUE '7837'.
   747     12  ER-7838                 PIC X(4)  VALUE '7838'.
   748     12  ER-7841                 PIC X(4)  VALUE '7841'.
   749     12  ER-7844                 PIC X(4)  VALUE '7844'.
   750     12  ER-7845                 PIC X(4)  VALUE '7845'.
   751     12  ER-8000                 PIC X(4)  VALUE '8000'.
   752     12  ER-8051                 PIC X(4)  VALUE '8051'.
   753     12  ER-8052                 PIC X(4)  VALUE '8052'.
   754     12  ER-8053                 PIC X(4)  VALUE '8053'.
   755     12  ER-8054                 PIC X(4)  VALUE '8054'.
   756     12  ER-8055                 PIC X(4)  VALUE '8055'.
   757     12  ER-8056                 PIC X(4)  VALUE '8056'.
   758     12  ER-8057                 PIC X(4)  VALUE '8057'.
   759     12  ER-8058                 PIC X(4)  VALUE '8058'.
   760     12  ER-8059                 PIC X(4)  VALUE '8059'.
   761     12  ER-8060                 PIC X(4)  VALUE '8060'.
   762     12  ER-8061                 PIC X(4)  VALUE '8061'.
   763     12  ER-8062                 PIC X(4)  VALUE '8062'.
   764     12  ER-8063                 PIC X(4)  VALUE '8063'.
   765     12  ER-8064                 PIC X(4)  VALUE '8064'.
   766     12  ER-8065                 PIC X(4)  VALUE '8065'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  15
* EL156.cbl
   767     12  ER-8066                 PIC X(4)  VALUE '8066'.
   768     12  ER-8146                 PIC X(4)  VALUE '8146'.
   769     12  ER-8147                 PIC X(4)  VALUE '8147'.
   770     12  ER-8152                 PIC X(4)  VALUE '8152'.
   771     12  ER-8153                 PIC X(4)  VALUE '8153'.
   772     12  ER-8154                 PIC X(4)  VALUE '8154'.
   773     12  ER-8155                 PIC X(4)  VALUE '8155'.
   774     12  ER-8310                 PIC X(4)  VALUE '8310'.
   775     12  ER-8311                 PIC X(4)  VALUE '8311'.
   776     12  ER-8312                 PIC X(4)  VALUE '8312'.
   777     12  ER-8313                 PIC X(4)  VALUE '8313'.
   778     12  ER-8314                 PIC X(4)  VALUE '8314'.
   779     12  ER-8315                 PIC X(4)  VALUE '8315'.
   780     12  ER-8316                 PIC X(4)  VALUE '8316'.
   781     12  ER-8317                 PIC X(4)  VALUE '8317'.
   782
   783 01  CSO-WORK-FIELDS.
   784     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   785       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   786
   787     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   788     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   789         88  CERT-NOTE-ADDED           VALUE 'Y'.
   790     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   791         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   792     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   793
   794     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   795
   796 01  SC-NP6-CERT-NOTE.
   797     12  FILLER                  PIC X(12)
   798               VALUE 'REM BENEFIT '.
   799     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   800     12  SC-NP6-COMM             PIC X(8)
   801               VALUE ' + 6 MO '.
   802     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   803     12  FILLER                  PIC X(12)
   804               VALUE ' = AMT PAID '.
   805     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   806
   807 01  SC-NP6-ORIG-NOTE.
   808     12  FILLER                  PIC X(63)  VALUE
   809         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   810 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   811     88  PDEF-FOUND                   VALUE 'Y'.
   812 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   813     88  ACCT-FOUND                   VALUE 'Y'.
   814 01  CTBL-KEY-SAVE               PIC X(5).
   815 01  CTBL-KEY.
   816     05  CTBL-COMPANY-CD         PIC X.
   817     05  CTBL-TABLE              PIC XXX.
   818     05  CTBL-BEN-TYPE           PIC X.
   819     05  CTBL-BEN-CODE           PIC XX.
   820 01  ERPDEF-KEY-SAVE             PIC X(18).
   821 01  ERPDEF-KEY.
   822     12  ERPDEF-COMPANY-CD       PIC X.
   823     12  ERPDEF-STATE            PIC XX.
   824     12  ERPDEF-PROD-CD          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  16
* EL156.cbl
   825     12  F                       PIC X(7).
   826     12  ERPDEF-BEN-TYPE         PIC X.
   827     12  ERPDEF-BEN-CODE         PIC XX.
   828     12  ERPDEF-EXP-DT           PIC XX.
   829 01  ELCRTT-KEY.
   830     05  CTRLR-COMP-CD       PIC X.
   831     05  CTRLR-CARRIER       PIC X.
   832     05  CTRLR-GROUPING      PIC X(6).
   833     05  CTRLR-STATE         PIC X(2).
   834     05  CTRLR-ACCOUNT       PIC X(10).
   835     05  CTRLR-EFF-DT        PIC XX.
   836     05  CTRLR-CERT-NO       PIC X(11).
   837     05  CTRLR-REC-TYPE      PIC X.
   838 01  ACCESS-KEYS.
   839     12  ELARCH-KEY.
   840         16  ARCH-CO             PIC X.
   841         16  ARCH-NUMBER         PIC S9(08) COMP.
   842         16  ARCH-REC-TYPE       PIC X.
   843         16  ARCH-SEQ            PIC S9(04) COMP.
   844     12  ELMSTR-KEY.
   845         16  MSTR-COMP-CD        PIC X.
   846         16  MSTR-CARRIER        PIC X.
   847         16  MSTR-CLAIM-NO       PIC X(7).
   848         16  MSTR-CERT-NO        PIC X(11).
   849     12  ELCNTL-KEY.
   850         16  CNTL-COMP-ID        PIC X(3).
   851         16  CNTL-REC-TYPE       PIC X.
   852         16  CNTL-ACCESS         PIC X(4).
   853         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   854     12  ELCERT-KEY.
   855         16  CERT-COMP-CD        PIC X.
   856         16  CERT-CARRIER        PIC X.
   857         16  CERT-GROUPING       PIC X(6).
   858         16  CERT-STATE          PIC XX.
   859         16  CERT-ACCOUNT        PIC X(10).
   860         16  CERT-EFF-DT         PIC XX.
   861         16  CERT-CERT-NO        PIC X(11).
   862     12  ELTRLR-KEY.
   863         16  TRLR-COMP-CD        PIC X.
   864         16  TRLR-CARRIER        PIC X.
   865         16  TRLR-CLAIM-NO       PIC X(7).
   866         16  TRLR-CERT-NO        PIC X(11).
   867         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   868     12  ELACTQ-KEY.
   869         16  ACTQ-COMP-CD        PIC X.
   870         16  ACTQ-CARRIER        PIC X.
   871         16  ACTQ-CLAIM-NO       PIC X(7).
   872         16  ACTQ-CERT-NO        PIC X(11).
   873     12  W-NOTE-KEY.
   874         16  W-NOTE-COMP-CD      PIC X.
   875         16  W-NOTE-CERT-KEY.
   876             20  W-NOTE-CARRIER  PIC X.
   877             20  W-NOTE-GROUPING PIC X(6).
   878             20  W-NOTE-STATE    PIC XX.
   879             20  W-NOTE-ACCOUNT  PIC X(10).
   880             20  W-NOTE-EFF-DT   PIC XX.
   881             20  W-NOTE-CERT-NO  PIC X(11).
   882     12  WS-ERACCT-SAVE-KEY      PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  17
* EL156.cbl
   883     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   884     12  ERACCT-KEY.
   885         16  ERACCT-PARTIAL-KEY.
   886             20  ACCT-COMP-CD    PIC X.
   887             20  ACCT-CARRIER    PIC X.
   888             20  ACCT-GROUPING   PIC X(6).
   889             20  ACCT-STATE      PIC XX.
   890             20  ACCT-ACCOUNT    PIC X(10).
   891         16  ACCT-EXP-DT         PIC XX.
   892         16  FILLER              PIC X(4) VALUE SPACES.
   893     12  ELCHKQ-KEY.
   894         16  CHKQ-COMP-CD        PIC X.
   895         16  CHKQ-CONTROL        PIC S9(8) COMP.
   896         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   897     12  ELBENE-KEY.
   898         16  BENE-COMP-CD         PIC X.
   899         16  BENE-RECORD-TYPE     PIC X.
   900         16  BENE-NUMBER          PIC X(10).
   901     12  ERCOMP-KEY.
   902         16  COMP-COMP-CD        PIC X.
   903         16  COMP-CARRIER        PIC X.
   904         16  COMP-GROUP          PIC X(06).
   905         16  COMP-FIN-RESP       PIC X(10).
   906         16  COMP-ACCOUNT        PIC X(10).
   907         16  COMP-TYPE           PIC X.
   908
   909     12  DLO035-KEY.
   910         16  DL35-PROCESS-TYPE   PIC X.
   911         16  DL35-CREDIT-CARD    PIC X(20).
   912         16  DL35-BEN-TYPE       PIC XX.
   913         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   914         16  DL35-RETURN-CODE    PIC XX.
   915
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  18
* EL156.cbl
   917*    COPY ELCDATE.
   918******************************************************************
   919*                                                                *
   920*                                                                *
   921*                            ELCDATE.                            *
   922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   923*                            VMOD=2.003
   924*                                                                *
   925*                                                                *
   926*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   927*                 LENGTH = 200                                   *
   928******************************************************************
   929
   930 01  DATE-CONVERSION-DATA.
   931     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   932     12  DC-OPTION-CODE                PIC X.
   933         88  BIN-TO-GREG                VALUE ' '.
   934         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   935         88  EDIT-GREG-TO-BIN           VALUE '2'.
   936         88  YMD-GREG-TO-BIN            VALUE '3'.
   937         88  MDY-GREG-TO-BIN            VALUE '4'.
   938         88  JULIAN-TO-BIN              VALUE '5'.
   939         88  BIN-PLUS-ELAPSED           VALUE '6'.
   940         88  FIND-CENTURY               VALUE '7'.
   941         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   942         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   943         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   944         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   945         88  JULIAN-TO-BIN-3            VALUE 'C'.
   946         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   947         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   948         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   949         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   950         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   951         88  CHECK-LEAP-YEAR            VALUE 'H'.
   952         88  BIN-3-TO-GREG              VALUE 'I'.
   953         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   954         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   955         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   956         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   957         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   958         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   959         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   960         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   961         88  THREE-CHARACTER-BIN
   962                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   963         88  GREGORIAN-TO-BIN
   964                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   965         88  BIN-TO-GREGORIAN
   966                  VALUES ' ' '1' 'I' '8' 'G'.
   967         88  JULIAN-TO-BINARY
   968                  VALUES '5' 'C' 'E' 'F'.
   969     12  DC-ERROR-CODE                 PIC X.
   970         88  NO-CONVERSION-ERROR        VALUE ' '.
   971         88  DATE-CONVERSION-ERROR
   972                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   973         88  DATE-IS-ZERO               VALUE '1'.
   974         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  19
* EL156.cbl
   975         88  DATE-IS-INVALID            VALUE '3'.
   976         88  DATE1-GREATER-DATE2        VALUE '4'.
   977         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   978         88  DATE-INVALID-OPTION        VALUE '9'.
   979         88  INVALID-CENTURY            VALUE 'A'.
   980         88  ONLY-CENTURY               VALUE 'B'.
   981         88  ONLY-LEAP-YEAR             VALUE 'C'.
   982         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   983     12  DC-END-OF-MONTH               PIC X.
   984         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   985     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   986         88  USE-NORMAL-PROCESS         VALUE ' '.
   987         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   988         88  ADJUST-UP-100-YRS          VALUE '2'.
   989     12  FILLER                        PIC X.
   990     12  DC-CONVERSION-DATES.
   991         16  DC-BIN-DATE-1             PIC XX.
   992         16  DC-BIN-DATE-2             PIC XX.
   993         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   994         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   995                       DC-GREG-DATE-1-EDIT.
   996             20  DC-EDIT1-MONTH        PIC 99.
   997             20  SLASH1-1              PIC X.
   998             20  DC-EDIT1-DAY          PIC 99.
   999             20  SLASH1-2              PIC X.
  1000             20  DC-EDIT1-YEAR         PIC 99.
  1001         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1002         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1003                     DC-GREG-DATE-2-EDIT.
  1004             20  DC-EDIT2-MONTH        PIC 99.
  1005             20  SLASH2-1              PIC X.
  1006             20  DC-EDIT2-DAY          PIC 99.
  1007             20  SLASH2-2              PIC X.
  1008             20  DC-EDIT2-YEAR         PIC 99.
  1009         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1010         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1011                     DC-GREG-DATE-1-YMD.
  1012             20  DC-YMD-YEAR           PIC 99.
  1013             20  DC-YMD-MONTH          PIC 99.
  1014             20  DC-YMD-DAY            PIC 99.
  1015         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1016         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1017                      DC-GREG-DATE-1-MDY.
  1018             20  DC-MDY-MONTH          PIC 99.
  1019             20  DC-MDY-DAY            PIC 99.
  1020             20  DC-MDY-YEAR           PIC 99.
  1021         16  DC-GREG-DATE-1-ALPHA.
  1022             20  DC-ALPHA-MONTH        PIC X(10).
  1023             20  DC-ALPHA-DAY          PIC 99.
  1024             20  FILLER                PIC XX.
  1025             20  DC-ALPHA-CENTURY.
  1026                 24 DC-ALPHA-CEN-N     PIC 99.
  1027             20  DC-ALPHA-YEAR         PIC 99.
  1028         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1029         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1030         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1031         16  DC-JULIAN-DATE            PIC 9(05).
  1032         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  20
* EL156.cbl
  1033                                       PIC 9(05).
  1034         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1035             20  DC-JULIAN-YEAR        PIC 99.
  1036             20  DC-JULIAN-DAYS        PIC 999.
  1037         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1038         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1039         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1040     12  DATE-CONVERSION-VARIBLES.
  1041         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1042         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1043             20  FILLER                PIC 9(3).
  1044             20  HOLD-CEN-1-CCYY.
  1045                 24  HOLD-CEN-1-CC     PIC 99.
  1046                 24  HOLD-CEN-1-YY     PIC 99.
  1047             20  HOLD-CEN-1-MO         PIC 99.
  1048             20  HOLD-CEN-1-DA         PIC 99.
  1049         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1050             20  HOLD-CEN-1-R-MO       PIC 99.
  1051             20  HOLD-CEN-1-R-DA       PIC 99.
  1052             20  HOLD-CEN-1-R-CCYY.
  1053                 24  HOLD-CEN-1-R-CC   PIC 99.
  1054                 24  HOLD-CEN-1-R-YY   PIC 99.
  1055             20  FILLER                PIC 9(3).
  1056         16  HOLD-CENTURY-1-X.
  1057             20  FILLER                PIC X(3)  VALUE SPACES.
  1058             20  HOLD-CEN-1-X-CCYY.
  1059                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1060                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1061             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1062             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1063         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1064             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1065             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1066             20  HOLD-CEN-1-R-X-CCYY.
  1067                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1068                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1069             20  FILLER                PIC XXX.
  1070         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1071         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1072         16  DC-JULIAN-DATE-1          PIC 9(07).
  1073         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1074             20  DC-JULIAN-1-CCYY.
  1075                 24  DC-JULIAN-1-CC    PIC 99.
  1076                 24  DC-JULIAN-1-YR    PIC 99.
  1077             20  DC-JULIAN-DA-1        PIC 999.
  1078         16  DC-JULIAN-DATE-2          PIC 9(07).
  1079         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1080             20  DC-JULIAN-2-CCYY.
  1081                 24  DC-JULIAN-2-CC    PIC 99.
  1082                 24  DC-JULIAN-2-YR    PIC 99.
  1083             20  DC-JULIAN-DA-2        PIC 999.
  1084         16  DC-GREG-DATE-A-EDIT.
  1085             20  DC-EDITA-MONTH        PIC 99.
  1086             20  SLASHA-1              PIC X VALUE '/'.
  1087             20  DC-EDITA-DAY          PIC 99.
  1088             20  SLASHA-2              PIC X VALUE '/'.
  1089             20  DC-EDITA-CCYY.
  1090                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  21
* EL156.cbl
  1091                 24  DC-EDITA-YEAR     PIC 99.
  1092         16  DC-GREG-DATE-B-EDIT.
  1093             20  DC-EDITB-MONTH        PIC 99.
  1094             20  SLASHB-1              PIC X VALUE '/'.
  1095             20  DC-EDITB-DAY          PIC 99.
  1096             20  SLASHB-2              PIC X VALUE '/'.
  1097             20  DC-EDITB-CCYY.
  1098                 24  DC-EDITB-CENT     PIC 99.
  1099                 24  DC-EDITB-YEAR     PIC 99.
  1100         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1101         16  DC-GREG-DATE-CYMD-R REDEFINES
  1102                              DC-GREG-DATE-CYMD.
  1103             20  DC-CYMD-CEN           PIC 99.
  1104             20  DC-CYMD-YEAR          PIC 99.
  1105             20  DC-CYMD-MONTH         PIC 99.
  1106             20  DC-CYMD-DAY           PIC 99.
  1107         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1108         16  DC-GREG-DATE-MDCY-R REDEFINES
  1109                              DC-GREG-DATE-MDCY.
  1110             20  DC-MDCY-MONTH         PIC 99.
  1111             20  DC-MDCY-DAY           PIC 99.
  1112             20  DC-MDCY-CEN           PIC 99.
  1113             20  DC-MDCY-YEAR          PIC 99.
  1114    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1115        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1116    12  DC-EL310-DATE                  PIC X(21).
  1117    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  22
* EL156.cbl
  1119*    COPY ELCLOGOF.
  1120******************************************************************
  1121*                                                                *
  1122*                                                                *
  1123*                            ELCLOGOF.                           *
  1124*                            VMOD=2.001                          *
  1125*                                                                *
  1126*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1127*                                                                *
  1128******************************************************************
  1129 01  CLASIC-LOGOFF.
  1130     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1131     12  LOGOFF-TEXT.
  1132         16  FILLER          PIC X(5)    VALUE SPACES.
  1133         16  LOGOFF-MSG.
  1134             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1135             20  FILLER      PIC X       VALUE SPACES.
  1136             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1137         16  FILLER          PIC X(80)
  1138           VALUE '* YOU ARE NOW LOGGED OFF'.
  1139         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1140         16  FILLER          PIC X       VALUE QUOTE.
  1141         16  LOGOFF-SYS-MSG  PIC X(17)
  1142           VALUE 'S CLAS-IC SYSTEM '.
  1143     12  TEXT-MESSAGES.
  1144         16  UNACCESS-MSG    PIC X(29)
  1145             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1146         16  PGMIDERR-MSG    PIC X(17)
  1147             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  23
* EL156.cbl
  1149*    COPY ELCCALC.
  1150******************************************************************
  1151*                                                                *
  1152*                           ELCCALC.                            *
  1153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1154*                            VMOD=2.025                          *
  1155*                                                                *
  1156*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1157*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1158*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1159*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1160*                                                                *
  1161*  PASSED TO ELRTRM                                              *
  1162*  -----------------                                             *
  1163*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1164*  ORIGINAL TERM                                                 *
  1165*  BEGINNING DATE                                                *
  1166*  ENDING DATE                                                   *
  1167*  COMPANY I.D.                                                  *
  1168*  ACCOUNT MASTER USER FIELD                                     *
  1169*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1170*  FREE LOOK DAYS                                                *
  1171*                                                                *
  1172*  RETURNED FROM ELRTRM                                          *
  1173*  ---------------------                                         *
  1174*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1175*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1176*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1177*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1178*----------------------------------------------------------------*
  1179*  PASSED TO ELRAMT                                              *
  1180*  ----------------                                              *
  1181*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1182*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1183*  ORIGINAL AMOUNT                                               *
  1184*  ALTERNATE BENEFIT (BALLON)                                    *
  1185*  A.P.R. - NET PAY ONLY                                         *
  1186*  METHOD
  1187*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1188*  COMPANY I.D.                                                  *
  1189*  BENEFIT TYPE                                                  *
  1190*                                                                *
  1191*  RETURNED FROM ELRAMT                                          *
  1192*  --------------------                                          *
  1193*  REMAINING AMOUNT 1 - CURRENT                                  *
  1194*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1195*  REMAINING AMOUNT FACTOR
  1196*----------------------------------------------------------------*
  1197*  PASSED TO ELRESV                                              *
  1198*  -----------------                                             *
  1199*  CERTIFICATE EFFECTIVE DATE                                    *
  1200*  VALUATION DATE                                                *
  1201*  PAID THRU DATE                                                *
  1202*  BENEFIT                                                       *
  1203*  INCURRED DATE                                                 *
  1204*  REPORTED DATE                                                 *
  1205*  ISSUE AGE                                                     *
  1206*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  24
* EL156.cbl
  1207*  CDT PERCENT                                                   *
  1208*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1209* *CLAIM TYPE (LIFE, A/H)                                        *
  1210* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1211* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1212*                                                                *
  1213*  RETURNED FROM ELRESV                                          *
  1214*  --------------------                                          *
  1215*  CDT TABLE USED                                                *
  1216*  CDT FACTOR USED                                               *
  1217*  PAY TO CURRENT RESERVE                                        *
  1218*  I.B.N.R. - A/H ONLY                                           *
  1219*  FUTURE (ACCRUED) AH ONLY                                      *
  1220*----------------------------------------------------------------*
  1221*  PASSED TO ELRATE                                              *
  1222*  ----------------                                              *
  1223*  CERT ISSUE DATE                                               *
  1224*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1225*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1226*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1227*  STATE CODE (CLIENT DEFINED)                                   *
  1228*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1229*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1230*  DEVIATION CODE                                                *
  1231*  ISSUE AGE                                                     *
  1232*  ORIGINAL BENEFIT AMOUNT                                       *
  1233*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1234*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1235*  BENEFIT KIND (LIFE OR A/H)                                    *
  1236*  A.P.R.                                                        *
  1237*  METHOD
  1238*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1239*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1240*  COMPANY I.D. (3 CHARACTER)                                    *
  1241*  BENEFIT CODE                                                  *
  1242*  BENEFIT OVERRIDE CODE                                         *
  1243*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1244*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1245*  JOINT INDICATOR (CSL ONLY)                                    *
  1246*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1247*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1248*                                                                *
  1249*  RETURNED FROM ELRATE                                          *
  1250*  --------------------                                          *
  1251*  CALCULATED PREMIUM                                            *
  1252*  PREMIUM RATE                                                  *
  1253*  MORTALITY CODE                                                *
  1254*  MAX ATTAINED AGE                                              *
  1255*  MAX AGE                                                       *
  1256*  MAX TERM                                                      *
  1257*  MAX MONTHLY BENEFIT                                           *
  1258*  MAX TOTAL BENIFIT                                             *
  1259*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1260*----------------------------------------------------------------*
  1261*  PASSED TO ELRFND                                              *
  1262*  ----------------                                              *
  1263*  CERT ISSUE DATE                                               *
  1264*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  25
* EL156.cbl
  1265*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1266*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1267*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1268*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1269*  STATE CODE (CLIENT DEFINED)                                   *
  1270*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1271*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1272*  DEVIATION CODE                                                *
  1273*  ISSUE AGE                                                     *
  1274*  ORIGINAL BENEFIT AMOUNT                                       *
  1275*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1276*  PROCESS TYPE (CANCEL)                                         *
  1277*  BENEFIT KIND (LIFE OR A/H)                                    *
  1278*  A.P.R.                                                        *
  1279*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1280*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1281*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1282*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1283*  COMPANY I.D. (3 CHARACTER)                                    *
  1284*  BENEFIT CODE                                                  *
  1285*  BENEFIT OVERRIDE CODE                                         *
  1286*                                                                *
  1287*  RETURNED FROM ELRFND                                          *
  1288*  --------------------                                          *
  1289*  CALCULATED REFUND                                             *
  1290*----------------------------------------------------------------*
  1291*  PASSED TO ELEARN                                              *
  1292*  ----------------                                              *
  1293*  CERT ISSUE DATE                                               *
  1294*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1295*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1296*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1297*  STATE CODE (CLIENT DEFINED)                                   *
  1298*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1299*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1300*  DEVIATION CODE                                                *
  1301*  ISSUE AGE                                                     *
  1302*  ORIGINAL BENEFIT AMOUNT                                       *
  1303*  BENEFIT KIND (LIFE OR A/H)                                    *
  1304*  A.P.R.                                                        *
  1305*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1306*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1307*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1308*  COMPANY I.D. (3 CHARACTER)                                    *
  1309*  BENEFIT CODE                                                  *
  1310*  BENEFIT OVERRIDE CODE                                         *
  1311*                                                                *
  1312*  RETURNED FROM ELEARN                                          *
  1313*  --------------------                                          *
  1314*  INDICATED  EARNINGS                                           *
  1315*----------------------------------------------------------------*
  1316*                 LENGTH = 450                                   *
  1317*                                                                *
  1318******************************************************************
  1319******************************************************************
  1320*                   C H A N G E   L O G
  1321*
  1322* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  26
* EL156.cbl
  1323*-----------------------------------------------------------------
  1324*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1325* EFFECTIVE    NUMBER
  1326*-----------------------------------------------------------------
  1327* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1328* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1329* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1330* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1331* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1332* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1333* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1334* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1335* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1336* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1337* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1338******************************************************************
  1339
  1340 01  CALCULATION-PASS-AREA.
  1341     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1342                                     COMP.
  1343
  1344     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1345       88  NO-CP-ERROR                             VALUE ZERO.
  1346       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1347                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1348       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1349       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1350       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1351       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1352       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1353       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1354       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1355       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1356       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1357       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1358       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1359       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1360       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1361       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1362       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1363       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1364       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1365
  1366     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1367       88  NO-CP-ERROR-2                           VALUE ZERO.
  1368***********************  INPUT AREAS ****************************
  1369
  1370     12  CP-CALCULATION-AREA.
  1371         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1372         16  CP-CERT-EFF-DT        PIC XX.
  1373         16  CP-VALUATION-DT       PIC XX.
  1374         16  CP-PAID-THRU-DT       PIC XX.
  1375         16  CP-BENEFIT-TYPE       PIC X.
  1376           88  CP-AH                               VALUE 'A' 'D'
  1377                                                   'I' 'U'.
  1378           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1379           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1380         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  27
* EL156.cbl
  1381         16  CP-REPORTED-DT        PIC XX.
  1382         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1383         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1384         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1385                                     COMP-3.
  1386         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1387                                     COMP-3.
  1388         16  CP-CDT-METHOD         PIC X.
  1389           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1390           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1391           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1392         16  CP-CLAIM-TYPE         PIC X.
  1393           88  CP-AH-CLAIM                         VALUE 'A'.
  1394           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1395         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1396                                     COMP-3.
  1397         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1398                                     COMP-3.
  1399         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1400                                     COMP-3.
  1401         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1402                                     COMP-3.
  1403         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1404                                     COMP-3.
  1405         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1406                                     COMP-3.
  1407         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1408                                     COMP-3.
  1409         16  CP-REM-TERM-METHOD    PIC X.
  1410           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1411           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1412           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1413           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1414           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1415           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1416           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1417         16  CP-EARNING-METHOD     PIC X.
  1418           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1419           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1420           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1421           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1422           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1423           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1424           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1425           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1426           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1427           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1428           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1429           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1430           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1431           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1432         16  CP-PROCESS-TYPE       PIC X.
  1433           88  CP-CLAIM                            VALUE '1'.
  1434           88  CP-CANCEL                           VALUE '2'.
  1435           88  CP-ISSUE                            VALUE '3'.
  1436         16  CP-SPECIAL-CALC-CD    PIC X.
  1437           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1438           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  28
* EL156.cbl
  1439           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1440           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1441           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1442           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1443           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1444           88  CP-FARM-PLAN                    VALUE 'F'.
  1445           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1446           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1447           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1448           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1449           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1450           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1451           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1452           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1453           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1454           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1455                                                     'W' 'X'.
  1456           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1457           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1458           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1459           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1460           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1461           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1462           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1463           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1464           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1465           88  CP-CSL-METH-1                   VALUE '5'.
  1466           88  CP-CSL-METH-2                   VALUE '6'.
  1467           88  CP-CSL-METH-3                   VALUE '7'.
  1468           88  CP-CSL-METH-4                   VALUE '8'.
  1469
  1470         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1471                                     COMP-3.
  1472         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1473         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1474         16  CP-STATE              PIC XX          VALUE SPACE.
  1475         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1476         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1477           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1478               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1479         16  CP-R78-OPTION         PIC X.
  1480           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1481           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1482
  1483         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1484         16  CP-IBNR-RESERVE-SW    PIC X.
  1485         16  CP-CLAIM-STATUS       PIC X.
  1486         16  CP-RATE-FILE          PIC X.
  1487         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1488                                     COMP-3.
  1489
  1490         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1491         16  CP-AH-OVERRIDE-CODE   PIC X.
  1492
  1493         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1494                                     COMP-3.
  1495         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1496                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  29
* EL156.cbl
  1497         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1498                                     COMP-3.
  1499         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1500                                     COMP-3.
  1501         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1502                                     COMP-3.
  1503         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1504                                  PIC S9(7)V99 COMP-3.
  1505
  1506         16  CP-PAID-FROM-DATE     PIC X(02).
  1507         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1508         16  CP-EXT-DAYS-CALC      PIC X.
  1509           88  CP-EXT-NO-CHG                   VALUE ' '.
  1510           88  CP-EXT-CHG-LF                   VALUE '1'.
  1511           88  CP-EXT-CHG-AH                   VALUE '2'.
  1512           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1513         16  CP-DOMICILE-STATE     PIC XX.
  1514         16  CP-CARRIER            PIC X.
  1515         16  CP-REIN-FLAG          PIC X.
  1516         16  CP-REM-TRM-CALC-OPTION PIC X.
  1517           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1518                      '2' '3' '4' '5'.
  1519           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1520           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1521           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1522           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1523           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1524           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1525           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1526           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1527         16  CP-SIG-SWITCH         PIC X.
  1528         16  CP-RATING-METHOD      PIC X.
  1529           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1530           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1531           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1532           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1533           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1534           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1535           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1536           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1537           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1538         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1539                                     COMP-3.
  1540         16  CP-BEN-CATEGORY       PIC X.
  1541         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1542         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1543                                   PIC S99V9(5) COMP-3.
  1544         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1545         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1546                                   PIC S99V9(5) COMP-3.
  1547         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1548         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1549         16  CP-EXPIRE-DT          PIC XX.
  1550         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1551         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1552         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1553         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1554         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  30
* EL156.cbl
  1555             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1556             88  CP-CALC-CLP              VALUE 'C'.
  1557         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1558         16  CP-CANCEL-REASON      PIC X.
  1559         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1560         16  CP-PMT-MODE           PIC X.
  1561         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1562         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1563         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1564         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1565         16  FILLER                PIC X.
  1566
  1567***************    OUTPUT FROM ELRESV   ************************
  1568
  1569         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1570
  1571         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1572                                     COMP-3.
  1573         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1574                                     COMP-3.
  1575         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1576                                     COMP-3.
  1577         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1578                                     COMP-3.
  1579         16  FILLER                PIC X(09).
  1580***************    OUTPUT FROM ELRTRM   *************************
  1581
  1582         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1583                                     COMP-3.
  1584         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1585                                     COMP-3.
  1586         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1587                                     COMP-3.
  1588         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1589                                     COMP-3.
  1590         16  FILLER                PIC X(12).
  1591
  1592***************    OUTPUT FROM ELRAMT   *************************
  1593
  1594         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1595                                     COMP-3.
  1596         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1597                                     COMP-3.
  1598         16  FILLER                PIC X(12).
  1599
  1600***************    OUTPUT FROM ELRATE   *************************
  1601
  1602         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1603                                     COMP-3.
  1604         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1605                                     COMP-3.
  1606         16  CP-MORTALITY-CODE     PIC X(4).
  1607         16  CP-RATE-EDIT-FLAG     PIC X.
  1608             88  CP-RATES-NEED-APR                  VALUE '1'.
  1609         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1610                                     COMP-3.
  1611         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1612         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  31
* EL156.cbl
  1613         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1614                                   PIC S9(7)V99 COMP-3.
  1615         16  FILLER                PIC X(07).
  1616
  1617***************    OUTPUT FROM ELRFND   *************************
  1618
  1619         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1620                                     COMP-3.
  1621         16  CP-REFUND-TYPE-USED   PIC X.
  1622           88  CP-R-AS-R78                         VALUE '1'.
  1623           88  CP-R-AS-PRORATA                     VALUE '2'.
  1624           88  CP-R-AS-CALIF                       VALUE '3'.
  1625           88  CP-R-AS-TEXAS                       VALUE '4'.
  1626           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1627           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1628           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1629           88  CP-R-AS-MEAN                        VALUE '8'.
  1630           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1631           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1632           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1633           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1634           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1635           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1636         16  FILLER                PIC X(12).
  1637
  1638***************    OUTPUT FROM ELEARN   *************************
  1639
  1640         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1641                                     COMP-3.
  1642         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1643                                     COMP-3.
  1644         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1645                                     COMP-3.
  1646         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1647                                     COMP-3.
  1648         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1649                                     COMP-3.
  1650         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1651                                     COMP-3.
  1652         16  CP-EARNING-TYPE-USED  PIC X.
  1653           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1654           88  CP-E-AS-R78                         VALUE '1'.
  1655           88  CP-E-AS-PRORATA                     VALUE '2'.
  1656           88  CP-E-AS-TEXAS                       VALUE '4'.
  1657           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1658           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1659           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1660           88  CP-E-AS-MEAN                        VALUE '8'.
  1661           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1662         16  FILLER                PIC X(12).
  1663
  1664***************    OUTPUT FROM ELPMNT   *************************
  1665
  1666         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1667                                     COMP-3.
  1668         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1669                                     COMP-3.
  1670         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  32
* EL156.cbl
  1671
  1672***************   MISC WORK AREAS    *****************************
  1673         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1674                                     COMP-3.
  1675         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1676                                     COMP-3.
  1677         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1678                                     COMP-3.
  1679         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1680                                     COMP-3.
  1681         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1682                                     COMP-3.
  1683         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1684                                     COMP-3.
  1685         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1686             88  OPEN-RATE-FILE                   VALUE 'O'.
  1687             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1688             88  IO-ERROR                         VALUE 'E'.
  1689
  1690         16  CP-FIRST-PAY-DATE     PIC XX.
  1691
  1692         16  CP-JOINT-INDICATOR    PIC X.
  1693
  1694         16  CP-RESERVE-REMAINING-TERM
  1695                                   PIC S9(4)V9    VALUE ZERO
  1696                                     COMP-3.
  1697
  1698         16  CP-INSURED-BIRTH-DT   PIC XX.
  1699
  1700         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1701                                     COMP-3.
  1702
  1703         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1704                                     COMP-3.
  1705
  1706         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1707                                     COMP-3.
  1708
  1709         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1710                                     COMP-3.
  1711
  1712         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1713                                     COMP-3.
  1714
  1715         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1716                                     COMP-3.
  1717
  1718         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1719                                     COMP-3.
  1720
  1721         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1722             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1723
  1724         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1725                                     COMP-3.
  1726         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1727                                     COMP-3.
  1728         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  33
* EL156.cbl
  1729         16  cp-extra-periods      pic 9 value zeros.
  1730         16  cp-net-only-state     pic x value spaces.
  1731         16  FILLER                PIC X(13).
  1732******************************************************************
  1733*    COPY ELCICALC.
  1734******************************************************************
  1735*                                                                *
  1736*                           ELCCICALC.                           *
  1737*                            VMOD=2.001                          *
  1738*                                                                *
  1739*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1740*                 CALCULATION MODULE                             *
  1741*                                                                *
  1742*  PASSED TO ELCLMI                                              *
  1743*  -----------------                                             *
  1744*  STATE                                                         *
  1745*  PRODUCT                                                       *
  1746*  COVERAGE                                                      *
  1747*  EFFECTIVE DATE                                                *
  1748*  INCURRED DATE                                                 *
  1749*  ESTABLISHED DATE                                              *
  1750*  LAST PAID DATE                                                *
  1751*  REPORTED DATE                                                 *
  1752*  CLAIM PAYMENT AMOUNT                                          *
  1753*                                                                *
  1754*  RETURNED FROM ELRTRM                                          *
  1755*  ---------------------                                         *
  1756*  RETURN CODE                                                   *
  1757*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1758*  CLAIM INTEREST AMOUNT                                         *
  1759*----------------------------------------------------------------*
  1760*----------------------------------------------------------------*
  1761*                 LENGTH = 100                                   *
  1762*                                                                *
  1763******************************************************************
  1764******************************************************************
  1765*                   C H A N G E   L O G
  1766*
  1767* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1768*-----------------------------------------------------------------
  1769*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1770* EFFECTIVE    NUMBER
  1771*-----------------------------------------------------------------
  1772* 120905    2004040700004  PEMA  NEW COPYBOOK
  1773* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1774******************************************************************
  1775
  1776 01  CLAIM-INT-PASS-AREA.
  1777     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1778                                     COMP.
  1779
  1780     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1781       88  NO-CI-ERROR                             VALUE ZERO.
  1782       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1783       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1784       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1785       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1786       88  CP-AMT-LT-5000                          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  34
* EL156.cbl
  1787       88  CP-ERROR-IN-DATES                       VALUE '5'.
  1788       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1789       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1790       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1791***********************  INPUT AREAS ****************************
  1792
  1793     12  CP-CALCULATION-AREA.
  1794         16  CP-COMPANY-CD         PIC X.
  1795         16  CP-STATE              PIC XX.
  1796         16  CP-PRODUCT            PIC XX.
  1797         16  CP-COVERAGE           PIC XX.
  1798         16  CP-INC-DT             PIC XX.
  1799         16  CP-EST-DT             PIC XX.
  1800         16  CP-LSTPD-DT           PIC XX.
  1801         16  CP-RPT-DT             PIC XX.
  1802         16  CP-PRF-DT             PIC XX.
  1803         16  CP-EFF-DT             PIC XX.
  1804         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1805         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1806         16  FILLER                PIC X(37).
  1807
  1808***************    OUTPUT FROM ELCLMI   ************************
  1809
  1810         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1811
  1812         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1813         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1814         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1815         16  FILLER                PIC X(19).
  1816******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  35
* EL156.cbl
  1818*    COPY ELCATTR.
  1819******************************************************************
  1820*                                                                *
  1821*                            ELCATTR.                            *
  1822*                            VMOD=2.001                          *
  1823*                                                                *
  1824*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1825*                                                                *
  1826*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1827*                                                                *
  1828*                   POS 1   P=PROTECTED                          *
  1829*                           U=UNPROTECTED                        *
  1830*                           S=ASKIP                              *
  1831*                   POS 2   A=ALPHA/NUMERIC                      *
  1832*                           N=NUMERIC                            *
  1833*                   POS 3   N=NORMAL                             *
  1834*                           B=BRIGHT                             *
  1835*                           D=DARK                               *
  1836*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1837*                           OF=MODIFIED DATA TAG OFF             *
  1838*                                                                *
  1839*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1840******************************************************************
  1841 01  ATTRIBUTE-LIST.
  1842     12  AL-PABOF            PIC X       VALUE 'Y'.
  1843     12  AL-PABON            PIC X       VALUE 'Z'.
  1844     12  AL-PADOF            PIC X       VALUE '%'.
  1845     12  AL-PADON            PIC X       VALUE '_'.
  1846     12  AL-PANOF            PIC X       VALUE '-'.
  1847     12  AL-PANON            PIC X       VALUE '/'.
  1848     12  AL-SABOF            PIC X       VALUE '8'.
  1849     12  AL-SABON            PIC X       VALUE '9'.
  1850     12  AL-SADOF            PIC X       VALUE '@'.
  1851     12  AL-SADON            PIC X       VALUE QUOTE.
  1852     12  AL-SANOF            PIC X       VALUE '0'.
  1853     12  AL-SANON            PIC X       VALUE '1'.
  1854     12  AL-UABOF            PIC X       VALUE 'H'.
  1855     12  AL-UABON            PIC X       VALUE 'I'.
  1856     12  AL-UADOF            PIC X       VALUE '<'.
  1857     12  AL-UADON            PIC X       VALUE '('.
  1858     12  AL-UANOF            PIC X       VALUE ' '.
  1859     12  AL-UANON            PIC X       VALUE 'A'.
  1860     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1861     12  AL-UNBON            PIC X       VALUE 'R'.
  1862     12  AL-UNDOF            PIC X       VALUE '*'.
  1863     12  AL-UNDON            PIC X       VALUE ')'.
  1864     12  AL-UNNOF            PIC X       VALUE '&'.
  1865     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  36
* EL156.cbl
  1867*    COPY ELCEMIB.
  1868******************************************************************
  1869*                                                                *
  1870*                                                                *
  1871*                            ELCEMIB.                            *
  1872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1873*                            VMOD=2.005                          *
  1874*                                                                *
  1875*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1876*                                                                *
  1877******************************************************************
  1878 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1879     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1880     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1881     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1882     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1883     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1884     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1885     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1886     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1887     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1888         88  EMI-NO-ERRORS                    VALUE '1'.
  1889         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1890         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1891     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1892         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1893     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1894         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1895         88  EMI-AREA1-FULL                   VALUE '2'.
  1896     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1897         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1898         88  EMI-AREA2-FULL                   VALUE '2'.
  1899     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1900         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1901         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1902         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1903         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1904         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1905     12  EMI-ERROR-LINES.
  1906         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1907         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1908         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1909         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1910             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1911                 24  EMI-ERR-NUM         PIC X(4).
  1912                 24  EMI-FILLER          PIC X.
  1913                 24  EMI-SEV             PIC X.
  1914                 24  FILLER              PIC X.
  1915             20  FILLER                  PIC X(02).
  1916     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1917         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1918             20  EMI-ERROR-NUMBER    PIC X(4).
  1919             20  EMI-FILL            PIC X.
  1920             20  EMI-SEVERITY        PIC X.
  1921             20  FILLER              PIC X.
  1922             20  EMI-ERROR-TEXT.
  1923                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1924                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  37
* EL156.cbl
  1925     12  EMI-SEVERITY-SAVE           PIC X.
  1926         88  EMI-NOTE                    VALUE 'N'.
  1927         88  EMI-WARNING                 VALUE 'W'.
  1928         88  EMI-FORCABLE                VALUE 'F'.
  1929         88  EMI-FATAL                   VALUE 'X'.
  1930     12  EMI-MESSAGE-FLAG            PIC X.
  1931         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1932         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1933     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1934     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1935         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1936         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1937         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1938     12  emi-claim-no                pic x(7).
  1939     12  emi-claim-type              pic x(6).
  1940     12  FILLER                      PIC X(124)  VALUE SPACES.
  1941     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1942     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1943     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1944     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  38
* EL156.cbl
  1946*    COPY ELCLNKLT.
  1947******************************************************************
  1948*                                                                *
  1949*                                                                *
  1950*                           ELCLNKLT                             *
  1951*                            VMOD=2.003                          *
  1952*                                                                *
  1953*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1954*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1955*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1956*                                                                *
  1957*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1958*   COMPLETING THE REQUIRED FIELDS.                              *
  1959*                                                                *
  1960*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1961*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1962*                              9999 INDICATES AN UNKNOWN ABEND   *
  1963*                                   WAS DETECTED.                *
  1964*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1965*                              CODES FOUND IN THE ERROR FILE.    *
  1966******************************************************************
  1967 01  W-1523-LINKDATA.
  1968     12  W-1523-COMMON-PI-DATA.
  1969         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1970         16  FILLER              PIC  X(67).
  1971         16  W-1523-COMPANY-CD   PIC  X(01).
  1972         16  FILLER              PIC  X(10).
  1973         16  W-1523-CONTROL-IN-PROGRESS.
  1974             20  W-1523-CARRIER  PIC  X(01).
  1975             20  W-1523-GROUPING PIC  X(06).
  1976             20  W-1523-STATE    PIC  X(02).
  1977             20  W-1523-ACCOUNT  PIC  X(10).
  1978             20  W-1523-CLAIM-CERT-GRP.
  1979                 24  W-1523-CLAIM-NO
  1980                                 PIC  X(07).
  1981                 24  W-1523-CERT-NO.
  1982                     28  W-1523-CERT-PRIME
  1983                                 PIC  X(10).
  1984                     28  W-1523-CERT-SFX
  1985                                 PIC  X(01).
  1986                 24  W-1523-CERT-EFF-DT
  1987                                 PIC  X(02).
  1988         16  FILLER              PIC X(265).
  1989
  1990     12  W-1523-WORK-AREA.
  1991         16  W-1523-FORM-NUMBER  PIC  X(04).
  1992         16  W-1523-NUMBER-COPIES
  1993                                 PIC  9(01).
  1994         16  W-1523-ADDR-TYPE    PIC  X(02).
  1995         16  W-1523-FOLLOW-UP-DATE
  1996                                 PIC  X(02).
  1997         16  W-1523-RESEND-DATE  PIC  X(02).
  1998         16  W-1523-ERROR-CODE   PIC  9(04).
  1999             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  2000             88  W-1523-FATAL-ERROR
  2001                                    VALUES  0006 0013 0042
  2002                                            0154 0168 0169
  2003                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  39
* EL156.cbl
  2004                                            0179 0186 0281
  2005                                            0332 2055 3697
  2006                                            3698 3699 3770
  2007                                            3771 3772 7675
  2008                                            9106 9808 9883
  2009                                            9887.
  2010             88  W-1523-STOP-ERRORS
  2011                                    VALUES  0013 0042 0154
  2012                                            0168 0169 0172
  2013                                            0281 0332 2055
  2014                                            3698 3699 7675
  2015                                            9106 9808 9883
  2016                                            9999.
  2017         16  W-1523-REASON       PIC  X(70).
  2018         16  W-1523-ARCHIVE-NUMBER
  2019                                 PIC  9(08).
  2020     12  W-1523-POINTER-AREA.
  2021         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2022         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2023         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2024         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2025         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  40
* EL156.cbl
  2027*    COPY ELCNWA.
  2028*****************************************************************
  2029*                                                               *
  2030*                                                               *
  2031*                            ELCNWA.                            *
  2032*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2033*                            VMOD=2.003                         *
  2034*                                                               *
  2035*            M O V E   N A M E   W O R K   A R E A.             *
  2036*                                                               *
  2037*****************************************************************.
  2038
  2039 01  WS-NAME-WORK-AREA.
  2040     05  WS-INSURED-LAST-NAME        PIC X(15).
  2041     05  WS-INSURED-1ST-NAME         PIC X(12).
  2042     05  WS-INSURED-MID-INIT         PIC X.
  2043
  2044     05  WS-NAME-WORK.
  2045         10  WS-NW                   PIC X
  2046             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2047
  2048     05  WS-NAME-WORK2.
  2049         10  WS-NW2                  PIC X
  2050             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2051                                        NWA-INDEX0.
  2052
  2053     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2054                                     COMP-3.
  2055
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  41
* EL156.cbl
  2057*    COPY ELCDMO.
  2058******************************************************************
  2059*                                                                *
  2060*                                                                *
  2061*                            ELCDMO.                             *
  2062*                            VMOD=2.004                          *
  2063*                                                                *
  2064*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2065*        COMMUNICATION AREA                                      *
  2066*   FILE TYPE = NA                                               *
  2067*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2068*                                                                *
  2069******************************************************************
  2070 01  DMO-COMMUNICATION-AREA.
  2071     12  DM-RECORD-TYPE                  PIC  X(02).
  2072             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2073             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2074             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2075     12  DM-DIST-CODE                    PIC  X(04).
  2076     12  DM-MAIL-CODE                    PIC  X(05).
  2077     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2078     12  DM-INSURED-NAME                 PIC  X(30).
  2079     12  DM-CLAIM-NO                     PIC  X(07).
  2080     12  DM-CLAIM-TYPE                   PIC  X.
  2081
  2082     12  DM-STATUS-DATA-AREA.
  2083         16  DM-CLAIM-STATUS             PIC  X.
  2084             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2085             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2086             88  DM-CLOSED                        VALUE '3'.
  2087             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2088             88  DM-DEFAULT                       VALUE '9'.
  2089         16  DM-STATUS-DATE              PIC  X(08).
  2090******YYYYMMDD
  2091         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2092             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2093             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2094             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2095             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2096             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2097             88  DM-RE-OPENED                     VALUE 'R'.
  2098             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2099             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2100             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2101         16  DM-STAT-CARRIER             PIC X.
  2102
  2103     12  DM-DRAFT-DATA-AREA.
  2104         16  DM-PAYMENT-TYPE             PIC  X.
  2105             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2106         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2107         16  DM-PAYMENT-DATE             PIC  X(08).
  2108******YYYYMMDD
  2109         16  DM-CERT-NO                  PIC  X(11).
  2110         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2111         16  DM-CARRIER                  PIC  X.
  2112
  2113     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  42
* EL156.cbl
  2115*    COPY ELCDMDCD.
  2116******************************************************************
  2117*                                                                *
  2118*                                                                *
  2119*                            ELCDMDCD.                           *
  2120*                            VMOD=2.001                          *
  2121*                                                                *
  2122*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2123*       COMMUNICATIONS AREA                                      *
  2124*                                                                *
  2125******************************************************************
  2126 01  CD-COMMUNICATION-AREA.
  2127     12  CD-SYSTEM-ID            PIC  X(02).
  2128         88 CD-CLAIMS                      VALUE 'CL'.
  2129         88 CD-CREDIT                      VALUE 'CR'.
  2130     12  CD-RECORD-TYPE          PIC  X(02).
  2131         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2132         88 CD-EOB-CODE                    VALUE 'EO'.
  2133         88 CD-ICD9-CODE                   VALUE 'I9'.
  2134         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2135         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2136         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2137         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2138         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2139     12  CD-RECORD-KEY           PIC  X(06).
  2140         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2141     12  CD-RETURN-CODE          PIC  X(02).
  2142     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2143     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2144     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2145     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  43
* EL156.cbl
  2147*    COPY ELCDCTB.
  2148******************************************************************
  2149*                                                                *
  2150*                                                                *
  2151*                            ELCDCTB.                            *
  2152*                            VMOD=2.002                          *
  2153*                                                                *
  2154*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2155*       COMMUNICATIONS AREA                                      *
  2156*                                                                *
  2157******************************************************************
  2158 01  DCT-COMMUNICATION-AREA.
  2159     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2160     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2161     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2162     12  DCT-PRODUCT-CODE         PIC  X(02).
  2163     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2164     12  DCT-RETURN-CODE          PIC  X(02).
  2165     12  DCT-MAIL-CODE            PIC  X(05).
  2166     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2167     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  44
* EL156.cbl
  2169 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2170 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2171 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2172 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  45
* EL156.cbl
  2174*    COPY ELCINTF.
  2175******************************************************************
  2176*                                                                *
  2177*                                                                *
  2178*                            ELCINTF.                            *
  2179*                            VMOD=2.017                          *
  2180*                                                                *
  2181*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2182*                                                                *
  2183*       LENGTH = 1024                                            *
  2184*                                                                *
  2185******************************************************************
  2186*                   C H A N G E   L O G
  2187*
  2188* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2189*-----------------------------------------------------------------
  2190*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2191* EFFECTIVE    NUMBER
  2192*-----------------------------------------------------------------
  2193* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2194******************************************************************
  2195 01  PROGRAM-INTERFACE-BLOCK.
  2196     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2197     12  PI-CALLING-PROGRAM              PIC X(8).
  2198     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2199     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2200     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2201     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2202     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2203     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2204     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2205     12  PI-COMPANY-ID                   PIC XXX.
  2206     12  PI-COMPANY-CD                   PIC X.
  2207
  2208     12  PI-COMPANY-PASSWORD             PIC X(8).
  2209
  2210     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2211
  2212     12  PI-CONTROL-IN-PROGRESS.
  2213         16  PI-CARRIER                  PIC X.
  2214         16  PI-GROUPING                 PIC X(6).
  2215         16  PI-STATE                    PIC XX.
  2216         16  PI-ACCOUNT                  PIC X(10).
  2217         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2218                                         PIC X(10).
  2219         16  PI-CLAIM-CERT-GRP.
  2220             20  PI-CLAIM-NO             PIC X(7).
  2221             20  PI-CERT-NO.
  2222                 25  PI-CERT-PRIME       PIC X(10).
  2223                 25  PI-CERT-SFX         PIC X.
  2224             20  PI-CERT-EFF-DT          PIC XX.
  2225         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2226             20  PI-PLAN-CODE            PIC X(2).
  2227             20  PI-REVISION-NUMBER      PIC X(3).
  2228             20  PI-PLAN-EFF-DT          PIC X(2).
  2229             20  PI-PLAN-EXP-DT          PIC X(2).
  2230             20  FILLER                  PIC X(11).
  2231         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  46
* EL156.cbl
  2232             20  PI-OE-REFERENCE-1.
  2233                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2234                 25  PI-OE-REF-1-SUFF    PIC XX.
  2235
  2236     12  PI-SESSION-IN-PROGRESS          PIC X.
  2237         88  CLAIM-SESSION                   VALUE '1'.
  2238         88  CREDIT-SESSION                  VALUE '2'.
  2239         88  WARRANTY-SESSION                VALUE '3'.
  2240         88  MORTGAGE-SESSION                VALUE '4'.
  2241         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2242
  2243
  2244*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2245
  2246     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2247     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2248
  2249     12  PI-CREDIT-USER                  PIC X.
  2250         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2251         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2252
  2253     12  PI-CLAIM-USER                   PIC X.
  2254         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2255         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2256
  2257     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2258         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2259         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2260         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2261         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2262         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2263
  2264     12  PI-PROCESSOR-ID                 PIC X(4).
  2265
  2266     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2267
  2268     12  PI-MEMBER-CAPTION               PIC X(10).
  2269
  2270     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2271         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2272
  2273     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2274     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2275     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2276     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2277
  2278     12  PI-AH-OVERRIDE-L1               PIC X.
  2279     12  PI-AH-OVERRIDE-L2               PIC XX.
  2280     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2281     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2282
  2283     12  PI-NEW-SYSTEM                   PIC X(2).
  2284
  2285     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2286     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2287         88  PI-USES-PAID-TO                 VALUE '1'.
  2288     12  PI-CRDTCRD-SYSTEM.
  2289         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  47
* EL156.cbl
  2290             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2291             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2292         16  PI-CC-MONTH-END-DT          PIC XX.
  2293     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2294
  2295     12  PI-OE-REFERENCE-2.
  2296         16  PI-OE-REF-2-PRIME           PIC X(10).
  2297         16  PI-OE-REF-2-SUFF            PIC X.
  2298
  2299     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2300
  2301     12  PI-LANGUAGE-TYPE                PIC X.
  2302             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2303             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2304             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2305
  2306     12  PI-POLICY-LINKAGE-IND           PIC X.
  2307         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2308         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2309                                                   LOW-VALUES.
  2310
  2311     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2312     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2313         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2314         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2315
  2316     12  PI-PROCESSOR-CSR-IND            PIC X.
  2317         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2318         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2319
  2320     12  FILLER                          PIC X(3).
  2321
  2322     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2323
  2324     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2325         PI-SYSTEM-LEVEL.
  2326
  2327         16  PI-ENTRY-CODES.
  2328             20  PI-ENTRY-CD-1           PIC X.
  2329             20  PI-ENTRY-CD-2           PIC X.
  2330
  2331         16  PI-RETURN-CODES.
  2332             20  PI-RETURN-CD-1          PIC X.
  2333             20  PI-RETURN-CD-2          PIC X.
  2334
  2335         16  PI-UPDATE-STATUS-SAVE.
  2336             20  PI-UPDATE-BY            PIC X(4).
  2337             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2338
  2339         16  PI-LOWER-CASE-LETTERS       PIC X.
  2340             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2341
  2342*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2343*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2344*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2345
  2346         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2347             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  48
* EL156.cbl
  2348             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2349             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2350             88  ACCNT-CNTL                  VALUE '3'.
  2351             88  CARR-ACCNT-CNTL             VALUE '4'.
  2352
  2353         16  PI-PROCESSOR-CAP-LIST.
  2354             20  PI-SYSTEM-CONTROLS.
  2355                24 PI-SYSTEM-DISPLAY     PIC X.
  2356                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2357                24 PI-SYSTEM-MODIFY      PIC X.
  2358                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2359             20  FILLER                  PIC XX.
  2360             20  PI-DISPLAY-CAP          PIC X.
  2361                 88  DISPLAY-CAP             VALUE 'Y'.
  2362             20  PI-MODIFY-CAP           PIC X.
  2363                 88  MODIFY-CAP              VALUE 'Y'.
  2364             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2365                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2366             20  PI-FORCE-CAP            PIC X.
  2367                 88  FORCE-CAP               VALUE 'Y'.
  2368
  2369         16  PI-PROGRAM-CONTROLS.
  2370             20  PI-PGM-PRINT-OPT        PIC X.
  2371             20  PI-PGM-FORMAT-OPT       PIC X.
  2372             20  PI-PGM-PROCESS-OPT      PIC X.
  2373             20  PI-PGM-TOTALS-OPT       PIC X.
  2374
  2375         16  PI-HELP-INTERFACE.
  2376             20  PI-LAST-ERROR-NO        PIC X(4).
  2377             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2378
  2379         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2380             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2381
  2382         16  PI-CR-CONTROL-IN-PROGRESS.
  2383             20  PI-CR-CARRIER           PIC X.
  2384             20  PI-CR-GROUPING          PIC X(6).
  2385             20  PI-CR-STATE             PIC XX.
  2386             20  PI-CR-ACCOUNT           PIC X(10).
  2387             20  PI-CR-FIN-RESP          PIC X(10).
  2388             20  PI-CR-TYPE              PIC X.
  2389
  2390         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2391
  2392         16  PI-CR-MONTH-END-DT          PIC XX.
  2393
  2394         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2395             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2396             88  PI-ZERO-CARRIER             VALUE '1'.
  2397             88  PI-ZERO-GROUPING            VALUE '2'.
  2398             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2399
  2400         16  PI-CARRIER-SECURITY         PIC X.
  2401             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2402
  2403         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2404             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2405             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  49
* EL156.cbl
  2406
  2407         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2408             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2409                                         INDEXED BY PI-ACCESS-NDX
  2410                                         PIC X.
  2411
  2412         16  PI-GA-BILLING-CONTROL       PIC X.
  2413             88  PI-GA-BILLING               VALUE '1'.
  2414
  2415         16  PI-MAIL-PROCESSING          PIC X.
  2416             88  PI-MAIL-YES                 VALUE 'Y'.
  2417
  2418         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2419
  2420         16  PI-AR-SYSTEM.
  2421             20  PI-AR-PROCESSING-CNTL   PIC X.
  2422                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2423             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2424             20  PI-AR-MONTH-END-DT      PIC XX.
  2425
  2426         16  PI-MP-SYSTEM.
  2427             20  PI-MORTGAGE-USER            PIC X.
  2428                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2429                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2430             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2431                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2432                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2433                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2434                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2435                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2436             20  PI-MP-MONTH-END-DT          PIC XX.
  2437             20  PI-MP-REFERENCE-NO.
  2438                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2439                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2440
  2441         16  PI-LABEL-CONTROL            PIC X(01).
  2442             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2443             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2444
  2445         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2446             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2447
  2448         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2449             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2450             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2451
  2452         16  FILLER                      PIC X(14).
  2453
  2454     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2455******************************************************************
  2456     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2457         16  PI-SAVE-FORM        PIC X(12).
  2458         16  PI-ACCT-KEY         PIC X(26).
  2459         16  PI-PAYEE-NAME       PIC X(30).
  2460         16  PI-DAILY-RATE       PIC S9(3)V99.
  2461         16  PI-MONTH-END-SAVE   PIC XX.
  2462         16  PI-BENEFIT-SAVE.
  2463             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  50
* EL156.cbl
  2464             20  PI-BEN-TYPE     PIC X.
  2465         16  PI-MANUAL-SW        PIC 9.
  2466         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2467         16  PI-PASS-SW          PIC X.
  2468         16  PI-PFKEY-USED       PIC X.
  2469         16  PI-CK-ASSIGN        PIC X.
  2470         16  PI-FATAL-COUNT      PIC 99.
  2471         16  PI-FORCE-COUNT      PIC 99.
  2472         16  PI-SAVE-INPUT.
  2473             20  PI-PMTTYPE      PIC X.
  2474             20  PI-PAYEE.
  2475                 24  PI-PAYEE-TYPE PIC X.
  2476                 24  PI-PAYEE-SEQ  PIC X.
  2477                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2478                   PI-PAYEE-SEQ    PIC S9.
  2479             20  PI-PMTNOTE1     PIC X(60).
  2480             20  PI-PMTNOTE2     PIC X(60).
  2481             20  PI-OFFLINE      PIC X.
  2482             20  PI-ECHECKNO     PIC X(7).
  2483             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2484                 28  PI-ECHECKNO-N     PIC X.
  2485                 28  PI-ECHECKNO-6     PIC X(6).
  2486             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2487                 24  PI-ECHECKNO-CR    PIC XX.
  2488                 24  PI-ECHECKNO-5     PIC X(5).
  2489             20  PI-HOLDTIL      PIC 9(6).
  2490             20  PI-EPYFROM      PIC 9(6).
  2491             20  PI-EPYTHRU      PIC 9(6).
  2492             20  PI-EDAYS        PIC S9(5).
  2493             20  PI-EPYAMT       PIC S9(7)V99.
  2494             20  PI-ERESV        PIC S9(7)V99.
  2495             20  PI-EEXPENS      PIC 9(6)V99.
  2496             20  PI-ETYPE        PIC X.
  2497             20  PI-CASH         PIC X.
  2498             20  PI-GROUPED      PIC X.
  2499             20  PI-INT-RATE     PIC S99V9(5).
  2500             20  PI-AIGFROM      PIC 9(6).
  2501             20  PI-LOAN-NO      PIC X(20).
  2502             20  PI-PROOF-DATE   PIC 9(6).
  2503             20  PI-PRINT-EOB-YN PIC X.
  2504             20  PI-PRINT-CLM-FRM-YN PIC X.
  2505             20  PI-PRINT-SURVEY-YN PIC X.
  2506             20  PI-SPECIAL-RELEASE-YN PIC X.
  2507             20  pi-int-to-rem-borr pic x.
  2508         16  PI-SAVE-COMPUTED.
  2509             20  PI-CCHECKNO     PIC X(7).
  2510             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2511                 28  PI-CCHECKNO-N     PIC X.
  2512                 28  PI-CCHECKNO-6     PIC X(6).
  2513             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2514                 24  PI-CCHECKNO-CR    PIC XX.
  2515                 24  PI-CCHECKNO-5     PIC X(5).
  2516             20  PI-CPYFROM      PIC XX.
  2517             20  PI-CPYTHRU      PIC XX.
  2518             20  PI-CDAYS        PIC S9(5).
  2519             20  PI-CPYAMT       PIC S9(7)V99.
  2520             20  PI-CRESV        PIC 9(6)V99.
  2521             20  PI-CEXPENS      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  51
* EL156.cbl
  2522             20  PI-PMT-APPR-SW  PIC X.
  2523                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2524                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2525                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2526         16  PI-PREV-CLMNO       PIC X(7).
  2527         16  PI-LF-COVERAGE-TYPE PIC X.
  2528         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2529         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2530         16  PI-PROVISIONAL-IND  PIC X.
  2531             88 PI-PROV-PMT      VALUE 'P'.
  2532         16  PI-PREV-TRLR-KEY    PIC X(22).
  2533         16  PI-SPLIT-PMT-SW     PIC X.
  2534         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2535         16  PI-ACTIVITY-CODE    PIC 99.
  2536         16  PI-RESET-SW         PIC X.
  2537         16  PI-SPECIAL-BEN-SW   PIC X.
  2538             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2539         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2540         16  PI-EXP-DT           PIC XX.
  2541         16  PI-LOAN-DUE-DAY     PIC 99.
  2542         16  PI-3RD-PARTY-SW     PIC X.
  2543         16  PI-LOAN-UPDATE-SW   PIC X.
  2544
  2545         16  PI-DMD-DATA.
  2546             20  PI-SV-CERT-KEY       PIC X(21).
  2547             20  PI-SV-CERT-NO        PIC X(11).
  2548             20  PI-SV-BEN            PIC X(10).
  2549             20  PI-SV-CCN            PIC X(16).
  2550             20  PI-INTEREST-PAID-IND PIC X.
  2551                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2552             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2553             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2554             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2555             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2556         16  PI-AT-EOB-CODES.
  2557             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2558         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2559         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2560         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2561         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2562         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2563         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2564         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2565         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2566         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2567         16  PI-LF-BENEFIT-CD         PIC X(2).
  2568         16  PI-EOB-CODES-EXIST PIC X.
  2569         16  PI-SET-NOTE2-MDT   PIC X.
  2570         16  PI-VFY-2ND-BENE          PIC X.
  2571         16  PI-CLM-TYPE              PIC X.
  2572         16  PI-APPROVAL-LEVEL        PIC X.
  2573         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2574         16  PI-REAUDIT-NEEDED        PIC X.
  2575         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2576         16  PI-AH-BENEFIT-CD         PIC XX.
  2577         16  pi-ah-term               pic s999 comp-3.
  2578         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2579         16  pi-max-ext               pic 999.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  52
* EL156.cbl
  2580         16  pi-max-ext-used          pic x.
  2581         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2582         16  PI-JOINT-COV-IND         PIC X.
  2583             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2584             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2585         16  PI-JOINT-INSURED-IND     PIC X.
  2586             88  PI-JOINT-INSURED        VALUE 'Y'.
  2587             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2588         16  pi-int-payees-name       pic x(30).
  2589         16  PI-RB-JOINT-COV-IND      PIC X.
  2590             88  PI-RB-JOINT-COVERAGE    VALUE 'J'.
  2591             88  PI-RB-SINGLE-COVERAGE   VALUE ' '.
  2592         16  pi-ach-payment           pic x.
  2593*00781          16  FILLER                   PIC X(176).
  2594*052506         16  FILLER                   PIC X(161).
  2595*031808         16  FILLER                   PIC X(154).
  2596*091808         16  FILLER                   PIC X(152).
  2597*041710         16  FILLER                   PIC X(94).
  2598         16  FILLER                   PIC X(34).
  2599
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  53
* EL156.cbl
  2601*    COPY ELCJPFX.
  2602******************************************************************
  2603*                                                                *
  2604*                                                                *
  2605*                            ELCJPFX.                            *
  2606*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2607*                            VMOD=2.002                          *
  2608*                                                                *
  2609*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2610*                                                                *
  2611*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2612*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2613*        ELCNTL - CONTROL FILE                                   *
  2614*        ELMSTR - CLAIM MASTERS                                  *
  2615*        ELTRLR - ACTIVITY TRAILERS                              *
  2616*        ELCHKQ - CHECK QUE                                      *
  2617******************************************************************
  2618 01  JOURNAL-RECORD.
  2619     12  jp-date                     pic s9(5) comp-3.
  2620     12  jp-time                     pic s9(7) comp-3.
  2621     12  JP-USER-ID                  PIC X(4).
  2622     12  JP-FILE-ID                  PIC X(8).
  2623     12  JP-PROGRAM-ID               PIC X(8).
  2624     12  JP-RECORD-TYPE              PIC X.
  2625         88 JP-ADD              VALUE 'A'.
  2626         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2627         88 JP-AFTER-CHANGE     VALUE 'C'.
  2628         88 JP-DELETE           VALUE 'D'.
  2629         88 JP-GENERIC-DELETE   VALUE 'G'.
  2630         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2631         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2632     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2633     12  JP-RECORD-AREA
  2634
  2635
  2636                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  54
* EL156.cbl
  2638*    COPY ELCAID.
  2639******************************************************************
  2640*                                                                *
  2641*                            ELCAID.                             *
  2642*                            VMOD=2.001                          *
  2643*                                                                *
  2644*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2645*                                                                *
  2646*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2647*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2648******************************************************************
  2649
  2650 01  DFHAID.
  2651   02  DFHNULL   PIC  X  VALUE  ' '.
  2652   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2653   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2654   02  DFHPEN    PIC  X  VALUE  '='.
  2655   02  DFHOPID   PIC  X  VALUE  'W'.
  2656   02  DFHPA1    PIC  X  VALUE  '%'.
  2657   02  DFHPA2    PIC  X  VALUE  '>'.
  2658   02  DFHPA3    PIC  X  VALUE  ','.
  2659   02  DFHPF1    PIC  X  VALUE  '1'.
  2660   02  DFHPF2    PIC  X  VALUE  '2'.
  2661   02  DFHPF3    PIC  X  VALUE  '3'.
  2662   02  DFHPF4    PIC  X  VALUE  '4'.
  2663   02  DFHPF5    PIC  X  VALUE  '5'.
  2664   02  DFHPF6    PIC  X  VALUE  '6'.
  2665   02  DFHPF7    PIC  X  VALUE  '7'.
  2666   02  DFHPF8    PIC  X  VALUE  '8'.
  2667   02  DFHPF9    PIC  X  VALUE  '9'.
  2668   02  DFHPF10   PIC  X  VALUE  ':'.
  2669   02  DFHPF11   PIC  X  VALUE  '#'.
  2670   02  DFHPF12   PIC  X  VALUE  '@'.
  2671   02  DFHPF13   PIC  X  VALUE  'A'.
  2672   02  DFHPF14   PIC  X  VALUE  'B'.
  2673   02  DFHPF15   PIC  X  VALUE  'C'.
  2674   02  DFHPF16   PIC  X  VALUE  'D'.
  2675   02  DFHPF17   PIC  X  VALUE  'E'.
  2676   02  DFHPF18   PIC  X  VALUE  'F'.
  2677   02  DFHPF19   PIC  X  VALUE  'G'.
  2678   02  DFHPF20   PIC  X  VALUE  'H'.
  2679   02  DFHPF21   PIC  X  VALUE  'I'.
  2680*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2681   02  DFHPF22   PIC  X  VALUE  '['.
  2682   02  DFHPF23   PIC  X  VALUE  '.'.
  2683   02  DFHPF24   PIC  X  VALUE  '<'.
  2684   02  DFHMSRE   PIC  X  VALUE  'X'.
  2685   02  DFHSTRF   PIC  X  VALUE  'h'.
  2686   02  DFHTRIG   PIC  X  VALUE  '"'.
  2687 01  FILLER    REDEFINES DFHAID.
  2688     12  FILLER              PIC X(8).
  2689     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  55
* EL156.cbl
  2691*    COPY EL156S.
  2692 01  EL156AI.
  2693     05  FILLER            PIC  X(0012).
  2694*    -------------------------------
  2695     05  RUNDTEAL PIC S9(0004) COMP.
  2696     05  RUNDTEAF PIC  X(0001).
  2697     05  FILLER REDEFINES RUNDTEAF.
  2698         10  RUNDTEAA PIC  X(0001).
  2699     05  RUNDTEAI PIC  X(0008).
  2700*    -------------------------------
  2701     05  RUNTIMAL PIC S9(0004) COMP.
  2702     05  RUNTIMAF PIC  X(0001).
  2703     05  FILLER REDEFINES RUNTIMAF.
  2704         10  RUNTIMAA PIC  X(0001).
  2705     05  RUNTIMAI PIC  X(0005).
  2706*    -------------------------------
  2707     05  SEQUL PIC S9(0004) COMP.
  2708     05  SEQUF PIC  X(0001).
  2709     05  FILLER REDEFINES SEQUF.
  2710         10  SEQUA PIC  X(0001).
  2711     05  SEQUI PIC  X(0010).
  2712*    -------------------------------
  2713     05  CLMNOL PIC S9(0004) COMP.
  2714     05  CLMNOF PIC  X(0001).
  2715     05  FILLER REDEFINES CLMNOF.
  2716         10  CLMNOA PIC  X(0001).
  2717     05  CLMNOI PIC  X(0007).
  2718*    -------------------------------
  2719     05  CARRL PIC S9(0004) COMP.
  2720     05  CARRF PIC  X(0001).
  2721     05  FILLER REDEFINES CARRF.
  2722         10  CARRA PIC  X(0001).
  2723     05  CARRI PIC  X(0001).
  2724*    -------------------------------
  2725     05  CERTNOL PIC S9(0004) COMP.
  2726     05  CERTNOF PIC  X(0001).
  2727     05  FILLER REDEFINES CERTNOF.
  2728         10  CERTNOA PIC  X(0001).
  2729     05  CERTNOI PIC  X(0010).
  2730*    -------------------------------
  2731     05  SUFXL PIC S9(0004) COMP.
  2732     05  SUFXF PIC  X(0001).
  2733     05  FILLER REDEFINES SUFXF.
  2734         10  SUFXA PIC  X(0001).
  2735     05  SUFXI PIC  X(0001).
  2736*    -------------------------------
  2737     05  CLMTYPL PIC S9(0004) COMP.
  2738     05  CLMTYPF PIC  X(0001).
  2739     05  FILLER REDEFINES CLMTYPF.
  2740         10  CLMTYPA PIC  X(0001).
  2741     05  CLMTYPI PIC  X(0006).
  2742*    -------------------------------
  2743     05  CLMSTATL PIC S9(0004) COMP.
  2744     05  CLMSTATF PIC  X(0001).
  2745     05  FILLER REDEFINES CLMSTATF.
  2746         10  CLMSTATA PIC  X(0001).
  2747     05  CLMSTATI PIC  X(0006).
  2748*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  56
* EL156.cbl
  2749     05  LSTNMEL PIC S9(0004) COMP.
  2750     05  LSTNMEF PIC  X(0001).
  2751     05  FILLER REDEFINES LSTNMEF.
  2752         10  LSTNMEA PIC  X(0001).
  2753     05  LSTNMEI PIC  X(0015).
  2754*    -------------------------------
  2755     05  FSTNMEL PIC S9(0004) COMP.
  2756     05  FSTNMEF PIC  X(0001).
  2757     05  FILLER REDEFINES FSTNMEF.
  2758         10  FSTNMEA PIC  X(0001).
  2759     05  FSTNMEI PIC  X(0012).
  2760*    -------------------------------
  2761     05  MINITL PIC S9(0004) COMP.
  2762     05  MINITF PIC  X(0001).
  2763     05  FILLER REDEFINES MINITF.
  2764         10  MINITA PIC  X(0001).
  2765     05  MINITI PIC  X(0001).
  2766*    -------------------------------
  2767     05  PRIMHDGL PIC S9(0004) COMP.
  2768     05  PRIMHDGF PIC  X(0001).
  2769     05  FILLER REDEFINES PRIMHDGF.
  2770         10  PRIMHDGA PIC  X(0001).
  2771     05  PRIMHDGI PIC  X(0012).
  2772*    -------------------------------
  2773     05  PCERTNOL PIC S9(0004) COMP.
  2774     05  PCERTNOF PIC  X(0001).
  2775     05  FILLER REDEFINES PCERTNOF.
  2776         10  PCERTNOA PIC  X(0001).
  2777     05  PCERTNOI PIC  X(0010).
  2778*    -------------------------------
  2779     05  PSUFXL PIC S9(0004) COMP.
  2780     05  PSUFXF PIC  X(0001).
  2781     05  FILLER REDEFINES PSUFXF.
  2782         10  PSUFXA PIC  X(0001).
  2783     05  PSUFXI PIC  X(0001).
  2784*    -------------------------------
  2785     05  STATUSL PIC S9(0004) COMP.
  2786     05  STATUSF PIC  X(0001).
  2787     05  FILLER REDEFINES STATUSF.
  2788         10  STATUSA PIC  X(0001).
  2789     05  STATUSI PIC  X(0010).
  2790*    -------------------------------
  2791     05  LOANHL PIC S9(0004) COMP.
  2792     05  LOANHF PIC  X(0001).
  2793     05  FILLER REDEFINES LOANHF.
  2794         10  LOANHA PIC  X(0001).
  2795     05  LOANHI PIC  X(0014).
  2796*    -------------------------------
  2797     05  LOANNOL PIC S9(0004) COMP.
  2798     05  LOANNOF PIC  X(0001).
  2799     05  FILLER REDEFINES LOANNOF.
  2800         10  LOANNOA PIC  X(0001).
  2801     05  LOANNOI PIC  X(0025).
  2802*    -------------------------------
  2803     05  DUEDAYHL PIC S9(0004) COMP.
  2804     05  DUEDAYHF PIC  X(0001).
  2805     05  FILLER REDEFINES DUEDAYHF.
  2806         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  57
* EL156.cbl
  2807     05  DUEDAYHI PIC  X(0008).
  2808*    -------------------------------
  2809     05  DUEDAYL PIC S9(0004) COMP.
  2810     05  DUEDAYF PIC  X(0001).
  2811     05  FILLER REDEFINES DUEDAYF.
  2812         10  DUEDAYA PIC  X(0001).
  2813     05  DUEDAYI PIC  X(0002).
  2814*    -------------------------------
  2815     05  ZINTHL PIC S9(0004) COMP.
  2816     05  ZINTHF PIC  X(0001).
  2817     05  FILLER REDEFINES ZINTHF.
  2818         10  ZINTHA PIC  X(0001).
  2819     05  ZINTHI PIC  X(0009).
  2820*    -------------------------------
  2821     05  ZINTL PIC S9(0004) COMP.
  2822     05  ZINTF PIC  X(0001).
  2823     05  FILLER REDEFINES ZINTF.
  2824         10  ZINTA PIC  X(0001).
  2825     05  ZINTI PIC  99V99999.
  2826*    -------------------------------
  2827     05  PTHRHDGL PIC S9(0004) COMP.
  2828     05  PTHRHDGF PIC  X(0001).
  2829     05  FILLER REDEFINES PTHRHDGF.
  2830         10  PTHRHDGA PIC  X(0001).
  2831     05  PTHRHDGI PIC  X(0014).
  2832*    -------------------------------
  2833     05  PDTHRUL PIC S9(0004) COMP.
  2834     05  PDTHRUF PIC  X(0001).
  2835     05  FILLER REDEFINES PDTHRUF.
  2836         10  PDTHRUA PIC  X(0001).
  2837     05  PDTHRUI PIC  X(0008).
  2838*    -------------------------------
  2839     05  TOTPAIDL PIC S9(0004) COMP.
  2840     05  TOTPAIDF PIC  X(0001).
  2841     05  FILLER REDEFINES TOTPAIDF.
  2842         10  TOTPAIDA PIC  X(0001).
  2843     05  TOTPAIDI PIC  X(0010).
  2844*    -------------------------------
  2845     05  COVERL PIC S9(0004) COMP.
  2846     05  COVERF PIC  X(0001).
  2847     05  FILLER REDEFINES COVERF.
  2848         10  COVERA PIC  X(0001).
  2849     05  COVERI PIC  X(0010).
  2850*    -------------------------------
  2851     05  INCURL PIC S9(0004) COMP.
  2852     05  INCURF PIC  X(0001).
  2853     05  FILLER REDEFINES INCURF.
  2854         10  INCURA PIC  X(0001).
  2855     05  INCURI PIC  X(0008).
  2856*    -------------------------------
  2857     05  LSTDTEL PIC S9(0004) COMP.
  2858     05  LSTDTEF PIC  X(0001).
  2859     05  FILLER REDEFINES LSTDTEF.
  2860         10  LSTDTEA PIC  X(0001).
  2861     05  LSTDTEI PIC  X(0008).
  2862*    -------------------------------
  2863     05  CRTSTATL PIC S9(0004) COMP.
  2864     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  58
* EL156.cbl
  2865     05  FILLER REDEFINES CRTSTATF.
  2866         10  CRTSTATA PIC  X(0001).
  2867     05  CRTSTATI PIC  X(0010).
  2868*    -------------------------------
  2869     05  EFFECTL PIC S9(0004) COMP.
  2870     05  EFFECTF PIC  X(0001).
  2871     05  FILLER REDEFINES EFFECTF.
  2872         10  EFFECTA PIC  X(0001).
  2873     05  EFFECTI PIC  X(0008).
  2874*    -------------------------------
  2875     05  TERMSL PIC S9(0004) COMP.
  2876     05  TERMSF PIC  X(0001).
  2877     05  FILLER REDEFINES TERMSF.
  2878         10  TERMSA PIC  X(0001).
  2879     05  TERMSI PIC  X(0011).
  2880*    -------------------------------
  2881     05  STACCTL PIC S9(0004) COMP.
  2882     05  STACCTF PIC  X(0001).
  2883     05  FILLER REDEFINES STACCTF.
  2884         10  STACCTA PIC  X(0001).
  2885     05  STACCTI PIC  X(0013).
  2886*    -------------------------------
  2887     05  EXPDTEHL PIC S9(0004) COMP.
  2888     05  EXPDTEHF PIC  X(0001).
  2889     05  FILLER REDEFINES EXPDTEHF.
  2890         10  EXPDTEHA PIC  X(0001).
  2891     05  EXPDTEHI PIC  X(0014).
  2892*    -------------------------------
  2893     05  EXPDTEL PIC S9(0004) COMP.
  2894     05  EXPDTEF PIC  X(0001).
  2895     05  FILLER REDEFINES EXPDTEF.
  2896         10  EXPDTEA PIC  X(0001).
  2897     05  EXPDTEI PIC  X(0008).
  2898*    -------------------------------
  2899     05  BENECAPL PIC S9(0004) COMP.
  2900     05  BENECAPF PIC  X(0001).
  2901     05  FILLER REDEFINES BENECAPF.
  2902         10  BENECAPA PIC  X(0001).
  2903     05  BENECAPI PIC  X(0013).
  2904*    -------------------------------
  2905     05  BENEL PIC S9(0004) COMP.
  2906     05  BENEF PIC  X(0001).
  2907     05  FILLER REDEFINES BENEF.
  2908         10  BENEA PIC  X(0001).
  2909     05  BENEI PIC  X(0009).
  2910*    -------------------------------
  2911     05  FORMTYPL PIC S9(0004) COMP.
  2912     05  FORMTYPF PIC  X(0001).
  2913     05  FILLER REDEFINES FORMTYPF.
  2914         10  FORMTYPA PIC  X(0001).
  2915     05  FORMTYPI PIC  X(0001).
  2916*    -------------------------------
  2917     05  PMTTYPEL PIC S9(0004) COMP.
  2918     05  PMTTYPEF PIC  X(0001).
  2919     05  FILLER REDEFINES PMTTYPEF.
  2920         10  PMTTYPEA PIC  X(0001).
  2921     05  PMTTYPEI PIC  X(0001).
  2922*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  59
* EL156.cbl
  2923     05  PAYEEL PIC S9(0004) COMP.
  2924     05  PAYEEF PIC  X(0001).
  2925     05  FILLER REDEFINES PAYEEF.
  2926         10  PAYEEA PIC  X(0001).
  2927     05  PAYEEI PIC  X(0002).
  2928*    -------------------------------
  2929     05  CHECKNOL PIC S9(0004) COMP.
  2930     05  CHECKNOF PIC  X(0001).
  2931     05  FILLER REDEFINES CHECKNOF.
  2932         10  CHECKNOA PIC  X(0001).
  2933     05  CHECKNOI PIC  X(0007).
  2934*    -------------------------------
  2935     05  OFFLINEL PIC S9(0004) COMP.
  2936     05  OFFLINEF PIC  X(0001).
  2937     05  FILLER REDEFINES OFFLINEF.
  2938         10  OFFLINEA PIC  X(0001).
  2939     05  OFFLINEI PIC  X(0001).
  2940*    -------------------------------
  2941     05  HOLDTILL PIC S9(0004) COMP.
  2942     05  HOLDTILF PIC  X(0001).
  2943     05  FILLER REDEFINES HOLDTILF.
  2944         10  HOLDTILA PIC  X(0001).
  2945     05  HOLDTILI PIC  X(0008).
  2946*    -------------------------------
  2947     05  NOTE1L PIC S9(0004) COMP.
  2948     05  NOTE1F PIC  X(0001).
  2949     05  FILLER REDEFINES NOTE1F.
  2950         10  NOTE1A PIC  X(0001).
  2951     05  NOTE1I PIC  X(0060).
  2952*    -------------------------------
  2953     05  ITRB1L PIC S9(0004) COMP.
  2954     05  ITRB1F PIC  X(0001).
  2955     05  FILLER REDEFINES ITRB1F.
  2956         10  ITRB1A PIC  X(0001).
  2957     05  ITRB1I PIC  X(0008).
  2958*    -------------------------------
  2959     05  NOTE2L PIC S9(0004) COMP.
  2960     05  NOTE2F PIC  X(0001).
  2961     05  FILLER REDEFINES NOTE2F.
  2962         10  NOTE2A PIC  X(0001).
  2963     05  NOTE2I PIC  X(0060).
  2964*    -------------------------------
  2965     05  ITRB2L PIC S9(0004) COMP.
  2966     05  ITRB2F PIC  X(0001).
  2967     05  FILLER REDEFINES ITRB2F.
  2968         10  ITRB2A PIC  X(0001).
  2969     05  ITRB2I PIC  X(0010).
  2970*    -------------------------------
  2971     05  EOBYNL PIC S9(0004) COMP.
  2972     05  EOBYNF PIC  X(0001).
  2973     05  FILLER REDEFINES EOBYNF.
  2974         10  EOBYNA PIC  X(0001).
  2975     05  EOBYNI PIC  X(0001).
  2976*    -------------------------------
  2977     05  CLMFMYNL PIC S9(0004) COMP.
  2978     05  CLMFMYNF PIC  X(0001).
  2979     05  FILLER REDEFINES CLMFMYNF.
  2980         10  CLMFMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  60
* EL156.cbl
  2981     05  CLMFMYNI PIC  X(0001).
  2982*    -------------------------------
  2983     05  SURVYYNL PIC S9(0004) COMP.
  2984     05  SURVYYNF PIC  X(0001).
  2985     05  FILLER REDEFINES SURVYYNF.
  2986         10  SURVYYNA PIC  X(0001).
  2987     05  SURVYYNI PIC  X(0001).
  2988*    -------------------------------
  2989     05  SPRELYNL PIC S9(0004) COMP.
  2990     05  SPRELYNF PIC  X(0001).
  2991     05  FILLER REDEFINES SPRELYNF.
  2992         10  SPRELYNA PIC  X(0001).
  2993     05  SPRELYNI PIC  X(0001).
  2994*    -------------------------------
  2995     05  PINTHL PIC S9(0004) COMP.
  2996     05  PINTHF PIC  X(0001).
  2997     05  FILLER REDEFINES PINTHF.
  2998         10  PINTHA PIC  X(0001).
  2999     05  PINTHI PIC  X(0004).
  3000*    -------------------------------
  3001     05  PINTL PIC S9(0004) COMP.
  3002     05  PINTF PIC  X(0001).
  3003     05  FILLER REDEFINES PINTF.
  3004         10  PINTA PIC  X(0001).
  3005     05  PINTI PIC  X(0008).
  3006*    -------------------------------
  3007     05  ITRBYNL PIC S9(0004) COMP.
  3008     05  ITRBYNF PIC  X(0001).
  3009     05  FILLER REDEFINES ITRBYNF.
  3010         10  ITRBYNA PIC  X(0001).
  3011     05  ITRBYNI PIC  X(0001).
  3012*    -------------------------------
  3013     05  PROOFDTL PIC S9(0004) COMP.
  3014     05  PROOFDTF PIC  X(0001).
  3015     05  FILLER REDEFINES PROOFDTF.
  3016         10  PROOFDTA PIC  X(0001).
  3017     05  PROOFDTI PIC  X(0008).
  3018*    -------------------------------
  3019     05  AIGFRMHL PIC S9(0004) COMP.
  3020     05  AIGFRMHF PIC  X(0001).
  3021     05  FILLER REDEFINES AIGFRMHF.
  3022         10  AIGFRMHA PIC  X(0001).
  3023     05  AIGFRMHI PIC  X(0012).
  3024*    -------------------------------
  3025     05  AIGFROML PIC S9(0004) COMP.
  3026     05  AIGFROMF PIC  X(0001).
  3027     05  FILLER REDEFINES AIGFROMF.
  3028         10  AIGFROMA PIC  X(0001).
  3029     05  AIGFROMI PIC  X(0008).
  3030*    -------------------------------
  3031     05  PMTHDGAL PIC S9(0004) COMP.
  3032     05  PMTHDGAF PIC  X(0001).
  3033     05  FILLER REDEFINES PMTHDGAF.
  3034         10  PMTHDGAA PIC  X(0001).
  3035     05  PMTHDGAI PIC  X(0066).
  3036*    -------------------------------
  3037     05  EPYFROML PIC S9(0004) COMP.
  3038     05  EPYFROMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  61
* EL156.cbl
  3039     05  FILLER REDEFINES EPYFROMF.
  3040         10  EPYFROMA PIC  X(0001).
  3041     05  EPYFROMI PIC  X(0008).
  3042*    -------------------------------
  3043     05  EPYTHRUL PIC S9(0004) COMP.
  3044     05  EPYTHRUF PIC  X(0001).
  3045     05  FILLER REDEFINES EPYTHRUF.
  3046         10  EPYTHRUA PIC  X(0001).
  3047     05  EPYTHRUI PIC  X(0008).
  3048*    -------------------------------
  3049     05  EDAYSL PIC S9(0004) COMP.
  3050     05  EDAYSF PIC  X(0001).
  3051     05  FILLER REDEFINES EDAYSF.
  3052         10  EDAYSA PIC  X(0001).
  3053     05  EDAYSI PIC  S9(6).
  3054*    -------------------------------
  3055     05  EPYAMTL PIC S9(0004) COMP.
  3056     05  EPYAMTF PIC  X(0001).
  3057     05  FILLER REDEFINES EPYAMTF.
  3058         10  EPYAMTA PIC  X(0001).
  3059     05  EPYAMTI PIC  S9(8)V99.
  3060*    -------------------------------
  3061     05  ERESVL PIC S9(0004) COMP.
  3062     05  ERESVF PIC  X(0001).
  3063     05  FILLER REDEFINES ERESVF.
  3064         10  ERESVA PIC  X(0001).
  3065     05  ERESVI PIC  S9(7)V99.
  3066*    -------------------------------
  3067     05  ETYPEL PIC S9(0004) COMP.
  3068     05  ETYPEF PIC  X(0001).
  3069     05  FILLER REDEFINES ETYPEF.
  3070         10  ETYPEA PIC  X(0001).
  3071     05  ETYPEI PIC  X(0001).
  3072*    -------------------------------
  3073     05  EEXPENSL PIC S9(0004) COMP.
  3074     05  EEXPENSF PIC  X(0001).
  3075     05  FILLER REDEFINES EEXPENSF.
  3076         10  EEXPENSA PIC  X(0001).
  3077     05  EEXPENSI PIC  9(6)V99.
  3078*    -------------------------------
  3079     05  CPYFROML PIC S9(0004) COMP.
  3080     05  CPYFROMF PIC  X(0001).
  3081     05  FILLER REDEFINES CPYFROMF.
  3082         10  CPYFROMA PIC  X(0001).
  3083     05  CPYFROMI PIC  X(0008).
  3084*    -------------------------------
  3085     05  CPYTHRUL PIC S9(0004) COMP.
  3086     05  CPYTHRUF PIC  X(0001).
  3087     05  FILLER REDEFINES CPYTHRUF.
  3088         10  CPYTHRUA PIC  X(0001).
  3089     05  CPYTHRUI PIC  X(0008).
  3090*    -------------------------------
  3091     05  CDAYSL PIC S9(0004) COMP.
  3092     05  CDAYSF PIC  X(0001).
  3093     05  FILLER REDEFINES CDAYSF.
  3094         10  CDAYSA PIC  X(0001).
  3095     05  CDAYSI PIC  9(6).
  3096*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  62
* EL156.cbl
  3097     05  CPYAMTL PIC S9(0004) COMP.
  3098     05  CPYAMTF PIC  X(0001).
  3099     05  FILLER REDEFINES CPYAMTF.
  3100         10  CPYAMTA PIC  X(0001).
  3101     05  CPYAMTI PIC  S9(8)V99.
  3102*    -------------------------------
  3103     05  CRESVL PIC S9(0004) COMP.
  3104     05  CRESVF PIC  X(0001).
  3105     05  FILLER REDEFINES CRESVF.
  3106         10  CRESVA PIC  X(0001).
  3107     05  CRESVI PIC  9(6)V99.
  3108*    -------------------------------
  3109     05  CEXPENSL PIC S9(0004) COMP.
  3110     05  CEXPENSF PIC  X(0001).
  3111     05  FILLER REDEFINES CEXPENSF.
  3112         10  CEXPENSA PIC  X(0001).
  3113     05  CEXPENSI PIC  9(6)V99.
  3114*    -------------------------------
  3115     05  ERRMSG0L PIC S9(0004) COMP.
  3116     05  ERRMSG0F PIC  X(0001).
  3117     05  FILLER REDEFINES ERRMSG0F.
  3118         10  ERRMSG0A PIC  X(0001).
  3119     05  ERRMSG0I PIC  X(0072).
  3120*    -------------------------------
  3121     05  ERRMSG1L PIC S9(0004) COMP.
  3122     05  ERRMSG1F PIC  X(0001).
  3123     05  FILLER REDEFINES ERRMSG1F.
  3124         10  ERRMSG1A PIC  X(0001).
  3125     05  ERRMSG1I PIC  X(0072).
  3126*    -------------------------------
  3127     05  ERRMSG2L PIC S9(0004) COMP.
  3128     05  ERRMSG2F PIC  X(0001).
  3129     05  FILLER REDEFINES ERRMSG2F.
  3130         10  ERRMSG2A PIC  X(0001).
  3131     05  ERRMSG2I PIC  X(0072).
  3132*    -------------------------------
  3133     05  ENTERPFL PIC S9(0004) COMP.
  3134     05  ENTERPFF PIC  X(0001).
  3135     05  FILLER REDEFINES ENTERPFF.
  3136         10  ENTERPFA PIC  X(0001).
  3137     05  ENTERPFI PIC  99.
  3138*    -------------------------------
  3139     05  PF6TITL PIC S9(0004) COMP.
  3140     05  PF6TITF PIC  X(0001).
  3141     05  FILLER REDEFINES PF6TITF.
  3142         10  PF6TITA PIC  X(0001).
  3143     05  PF6TITI PIC  X(0016).
  3144 01  EL156AO REDEFINES EL156AI.
  3145     05  FILLER            PIC  X(0012).
  3146*    -------------------------------
  3147     05  FILLER            PIC  X(0003).
  3148     05  RUNDTEAO PIC  X(0008).
  3149*    -------------------------------
  3150     05  FILLER            PIC  X(0003).
  3151     05  RUNTIMAO PIC  99.99.
  3152*    -------------------------------
  3153     05  FILLER            PIC  X(0003).
  3154     05  SEQUO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  63
* EL156.cbl
  3155*    -------------------------------
  3156     05  FILLER            PIC  X(0003).
  3157     05  CLMNOO PIC  X(0007).
  3158*    -------------------------------
  3159     05  FILLER            PIC  X(0003).
  3160     05  CARRO PIC  X(0001).
  3161*    -------------------------------
  3162     05  FILLER            PIC  X(0003).
  3163     05  CERTNOO PIC  X(0010).
  3164*    -------------------------------
  3165     05  FILLER            PIC  X(0003).
  3166     05  SUFXO PIC  X(0001).
  3167*    -------------------------------
  3168     05  FILLER            PIC  X(0003).
  3169     05  CLMTYPO PIC  X(0006).
  3170*    -------------------------------
  3171     05  FILLER            PIC  X(0003).
  3172     05  CLMSTATO PIC  X(0006).
  3173*    -------------------------------
  3174     05  FILLER            PIC  X(0003).
  3175     05  LSTNMEO PIC  X(0015).
  3176*    -------------------------------
  3177     05  FILLER            PIC  X(0003).
  3178     05  FSTNMEO PIC  X(0012).
  3179*    -------------------------------
  3180     05  FILLER            PIC  X(0003).
  3181     05  MINITO PIC  X(0001).
  3182*    -------------------------------
  3183     05  FILLER            PIC  X(0003).
  3184     05  PRIMHDGO PIC  X(0012).
  3185*    -------------------------------
  3186     05  FILLER            PIC  X(0003).
  3187     05  PCERTNOO PIC  X(0010).
  3188*    -------------------------------
  3189     05  FILLER            PIC  X(0003).
  3190     05  PSUFXO PIC  X(0001).
  3191*    -------------------------------
  3192     05  FILLER            PIC  X(0003).
  3193     05  STATUSO PIC  X(0010).
  3194*    -------------------------------
  3195     05  FILLER            PIC  X(0003).
  3196     05  LOANHO PIC  X(0014).
  3197*    -------------------------------
  3198     05  FILLER            PIC  X(0003).
  3199     05  LOANNOO PIC  X(0025).
  3200*    -------------------------------
  3201     05  FILLER            PIC  X(0003).
  3202     05  DUEDAYHO PIC  X(0008).
  3203*    -------------------------------
  3204     05  FILLER            PIC  X(0003).
  3205     05  DUEDAYO PIC  X(0002).
  3206*    -------------------------------
  3207     05  FILLER            PIC  X(0003).
  3208     05  ZINTHO PIC  X(0009).
  3209*    -------------------------------
  3210     05  FILLER            PIC  X(0003).
  3211     05  ZINTO PIC  9.99999.
  3212*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  64
* EL156.cbl
  3213     05  FILLER            PIC  X(0003).
  3214     05  PTHRHDGO PIC  X(0014).
  3215*    -------------------------------
  3216     05  FILLER            PIC  X(0003).
  3217     05  PDTHRUO PIC  X(0008).
  3218*    -------------------------------
  3219     05  FILLER            PIC  X(0003).
  3220     05  TOTPAIDO PIC  Z(6).99-.
  3221*    -------------------------------
  3222     05  FILLER            PIC  X(0003).
  3223     05  COVERO PIC  X(0010).
  3224*    -------------------------------
  3225     05  FILLER            PIC  X(0003).
  3226     05  INCURO PIC  X(0008).
  3227*    -------------------------------
  3228     05  FILLER            PIC  X(0003).
  3229     05  LSTDTEO PIC  X(0008).
  3230*    -------------------------------
  3231     05  FILLER            PIC  X(0003).
  3232     05  CRTSTATO PIC  X(0010).
  3233*    -------------------------------
  3234     05  FILLER            PIC  X(0003).
  3235     05  EFFECTO PIC  X(0008).
  3236*    -------------------------------
  3237     05  FILLER            PIC  X(0003).
  3238     05  TERMSO PIC  X(0011).
  3239*    -------------------------------
  3240     05  FILLER            PIC  X(0003).
  3241     05  STACCTO PIC  X(0013).
  3242*    -------------------------------
  3243     05  FILLER            PIC  X(0003).
  3244     05  EXPDTEHO PIC  X(0014).
  3245*    -------------------------------
  3246     05  FILLER            PIC  X(0003).
  3247     05  EXPDTEO PIC  X(0008).
  3248*    -------------------------------
  3249     05  FILLER            PIC  X(0003).
  3250     05  BENECAPO PIC  X(0013).
  3251*    -------------------------------
  3252     05  FILLER            PIC  X(0003).
  3253     05  BENEO PIC  Z(6).99.
  3254*    -------------------------------
  3255     05  FILLER            PIC  X(0003).
  3256     05  FORMTYPO PIC  X(0001).
  3257*    -------------------------------
  3258     05  FILLER            PIC  X(0003).
  3259     05  PMTTYPEO PIC  X(0001).
  3260*    -------------------------------
  3261     05  FILLER            PIC  X(0003).
  3262     05  PAYEEO PIC  X(0002).
  3263*    -------------------------------
  3264     05  FILLER            PIC  X(0003).
  3265     05  CHECKNOO PIC  X(0007).
  3266*    -------------------------------
  3267     05  FILLER            PIC  X(0003).
  3268     05  OFFLINEO PIC  X(0001).
  3269*    -------------------------------
  3270     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  65
* EL156.cbl
  3271     05  HOLDTILO PIC  99B99B99.
  3272*    -------------------------------
  3273     05  FILLER            PIC  X(0003).
  3274     05  NOTE1O PIC  X(0060).
  3275*    -------------------------------
  3276     05  FILLER            PIC  X(0003).
  3277     05  ITRB1O PIC  X(0008).
  3278*    -------------------------------
  3279     05  FILLER            PIC  X(0003).
  3280     05  NOTE2O PIC  X(0060).
  3281*    -------------------------------
  3282     05  FILLER            PIC  X(0003).
  3283     05  ITRB2O PIC  X(0010).
  3284*    -------------------------------
  3285     05  FILLER            PIC  X(0003).
  3286     05  EOBYNO PIC  X(0001).
  3287*    -------------------------------
  3288     05  FILLER            PIC  X(0003).
  3289     05  CLMFMYNO PIC  X(0001).
  3290*    -------------------------------
  3291     05  FILLER            PIC  X(0003).
  3292     05  SURVYYNO PIC  X(0001).
  3293*    -------------------------------
  3294     05  FILLER            PIC  X(0003).
  3295     05  SPRELYNO PIC  X(0001).
  3296*    -------------------------------
  3297     05  FILLER            PIC  X(0003).
  3298     05  PINTHO PIC  X(0004).
  3299*    -------------------------------
  3300     05  FILLER            PIC  X(0003).
  3301     05  PINTO PIC  Z,ZZ9.99.
  3302*    -------------------------------
  3303     05  FILLER            PIC  X(0003).
  3304     05  ITRBYNO PIC  X(0001).
  3305*    -------------------------------
  3306     05  FILLER            PIC  X(0003).
  3307     05  PROOFDTO PIC  99B99B99.
  3308*    -------------------------------
  3309     05  FILLER            PIC  X(0003).
  3310     05  AIGFRMHO PIC  X(0012).
  3311*    -------------------------------
  3312     05  FILLER            PIC  X(0003).
  3313     05  AIGFROMO PIC  99B99B99.
  3314*    -------------------------------
  3315     05  FILLER            PIC  X(0003).
  3316     05  PMTHDGAO PIC  X(0066).
  3317*    -------------------------------
  3318     05  FILLER            PIC  X(0003).
  3319     05  EPYFROMO PIC  99B99B99.
  3320*    -------------------------------
  3321     05  FILLER            PIC  X(0003).
  3322     05  EPYTHRUO PIC  99B99B99.
  3323*    -------------------------------
  3324     05  FILLER            PIC  X(0003).
  3325     05  EDAYSO PIC  Z(4)9-.
  3326*    -------------------------------
  3327     05  FILLER            PIC  X(0003).
  3328     05  EPYAMTO PIC  Z(6).99-.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  66
* EL156.cbl
  3329*    -------------------------------
  3330     05  FILLER            PIC  X(0003).
  3331     05  ERESVO PIC  Z(5).99-.
  3332*    -------------------------------
  3333     05  FILLER            PIC  X(0003).
  3334     05  ETYPEO PIC  X(0001).
  3335*    -------------------------------
  3336     05  FILLER            PIC  X(0003).
  3337     05  EEXPENSO PIC  Z(5).99.
  3338*    -------------------------------
  3339     05  FILLER            PIC  X(0003).
  3340     05  CPYFROMO PIC  99B99B99.
  3341*    -------------------------------
  3342     05  FILLER            PIC  X(0003).
  3343     05  CPYTHRUO PIC  99B99B99.
  3344*    -------------------------------
  3345     05  FILLER            PIC  X(0003).
  3346     05  CDAYSO PIC  Z(4)9-.
  3347*    -------------------------------
  3348     05  FILLER            PIC  X(0003).
  3349     05  CPYAMTO PIC  Z(6).99-.
  3350*    -------------------------------
  3351     05  FILLER            PIC  X(0003).
  3352     05  CRESVO PIC  Z(5).99.
  3353*    -------------------------------
  3354     05  FILLER            PIC  X(0003).
  3355     05  CEXPENSO PIC  Z(5).99.
  3356*    -------------------------------
  3357     05  FILLER            PIC  X(0003).
  3358     05  ERRMSG0O PIC  X(0072).
  3359*    -------------------------------
  3360     05  FILLER            PIC  X(0003).
  3361     05  ERRMSG1O PIC  X(0072).
  3362*    -------------------------------
  3363     05  FILLER            PIC  X(0003).
  3364     05  ERRMSG2O PIC  X(0072).
  3365*    -------------------------------
  3366     05  FILLER            PIC  X(0003).
  3367     05  ENTERPFO PIC  X(0002).
  3368*    -------------------------------
  3369     05  FILLER            PIC  X(0003).
  3370     05  PF6TITO PIC  X(0016).
  3371*    -------------------------------
  3372 01  EL156BI REDEFINES EL156AI.
  3373     05  FILLER            PIC  X(0012).
  3374*    -------------------------------
  3375     05  RUNDTEBL PIC S9(0004) COMP.
  3376     05  RUNDTEBF PIC  X(0001).
  3377     05  FILLER REDEFINES RUNDTEBF.
  3378         10  RUNDTEBA PIC  X(0001).
  3379     05  RUNDTEBI PIC  X(0008).
  3380*    -------------------------------
  3381     05  RUNTIMBL PIC S9(0004) COMP.
  3382     05  RUNTIMBF PIC  X(0001).
  3383     05  FILLER REDEFINES RUNTIMBF.
  3384         10  RUNTIMBA PIC  X(0001).
  3385     05  RUNTIMBI PIC  X(0005).
  3386*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  67
* EL156.cbl
  3387     05  PAYDTBL PIC S9(0004) COMP.
  3388     05  PAYDTBF PIC  X(0001).
  3389     05  FILLER REDEFINES PAYDTBF.
  3390         10  PAYDTBA PIC  X(0001).
  3391     05  PAYDTBI PIC  X(0008).
  3392*    -------------------------------
  3393     05  PAYTYPBL PIC S9(0004) COMP.
  3394     05  PAYTYPBF PIC  X(0001).
  3395     05  FILLER REDEFINES PAYTYPBF.
  3396         10  PAYTYPBA PIC  X(0001).
  3397     05  PAYTYPBI PIC  X(0015).
  3398*    -------------------------------
  3399     05  PAYAMTBL PIC S9(0004) COMP.
  3400     05  PAYAMTBF PIC  X(0001).
  3401     05  FILLER REDEFINES PAYAMTBF.
  3402         10  PAYAMTBA PIC  X(0001).
  3403     05  PAYAMTBI PIC  X(0011).
  3404*    -------------------------------
  3405     05  LOANHBL PIC S9(0004) COMP.
  3406     05  LOANHBF PIC  X(0001).
  3407     05  FILLER REDEFINES LOANHBF.
  3408         10  LOANHBA PIC  X(0001).
  3409     05  LOANHBI PIC  X(0012).
  3410*    -------------------------------
  3411     05  LOANNBL PIC S9(0004) COMP.
  3412     05  LOANNBF PIC  X(0001).
  3413     05  FILLER REDEFINES LOANNBF.
  3414         10  LOANNBA PIC  X(0001).
  3415     05  LOANNBI PIC  X(0025).
  3416*    -------------------------------
  3417     05  CKNUMHDL PIC S9(0004) COMP.
  3418     05  CKNUMHDF PIC  X(0001).
  3419     05  FILLER REDEFINES CKNUMHDF.
  3420         10  CKNUMHDA PIC  X(0001).
  3421     05  CKNUMHDI PIC  X(0012).
  3422*    -------------------------------
  3423     05  CKNUMBL PIC S9(0004) COMP.
  3424     05  CKNUMBF PIC  X(0001).
  3425     05  FILLER REDEFINES CKNUMBF.
  3426         10  CKNUMBA PIC  X(0001).
  3427     05  CKNUMBI PIC  X(0007).
  3428*    -------------------------------
  3429     05  AGTHDGL PIC S9(0004) COMP.
  3430     05  AGTHDGF PIC  X(0001).
  3431     05  FILLER REDEFINES AGTHDGF.
  3432         10  AGTHDGA PIC  X(0001).
  3433     05  AGTHDGI PIC  X(0016).
  3434*    -------------------------------
  3435     05  NAMEBL PIC S9(0004) COMP.
  3436     05  NAMEBF PIC  X(0001).
  3437     05  FILLER REDEFINES NAMEBF.
  3438         10  NAMEBA PIC  X(0001).
  3439     05  NAMEBI PIC  X(0030).
  3440*    -------------------------------
  3441     05  NAMEB2L PIC S9(0004) COMP.
  3442     05  NAMEB2F PIC  X(0001).
  3443     05  FILLER REDEFINES NAMEB2F.
  3444         10  NAMEB2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  68
* EL156.cbl
  3445     05  NAMEB2I PIC  X(0030).
  3446*    -------------------------------
  3447     05  ADDR1BL PIC S9(0004) COMP.
  3448     05  ADDR1BF PIC  X(0001).
  3449     05  FILLER REDEFINES ADDR1BF.
  3450         10  ADDR1BA PIC  X(0001).
  3451     05  ADDR1BI PIC  X(0030).
  3452*    -------------------------------
  3453     05  ADDR1B2L PIC S9(0004) COMP.
  3454     05  ADDR1B2F PIC  X(0001).
  3455     05  FILLER REDEFINES ADDR1B2F.
  3456         10  ADDR1B2A PIC  X(0001).
  3457     05  ADDR1B2I PIC  X(0030).
  3458*    -------------------------------
  3459     05  ADDR2BL PIC S9(0004) COMP.
  3460     05  ADDR2BF PIC  X(0001).
  3461     05  FILLER REDEFINES ADDR2BF.
  3462         10  ADDR2BA PIC  X(0001).
  3463     05  ADDR2BI PIC  X(0030).
  3464*    -------------------------------
  3465     05  ADDR2B2L PIC S9(0004) COMP.
  3466     05  ADDR2B2F PIC  X(0001).
  3467     05  FILLER REDEFINES ADDR2B2F.
  3468         10  ADDR2B2A PIC  X(0001).
  3469     05  ADDR2B2I PIC  X(0030).
  3470*    -------------------------------
  3471     05  CITYSTBL PIC S9(0004) COMP.
  3472     05  CITYSTBF PIC  X(0001).
  3473     05  FILLER REDEFINES CITYSTBF.
  3474         10  CITYSTBA PIC  X(0001).
  3475     05  CITYSTBI PIC  X(0030).
  3476*    -------------------------------
  3477     05  CITYST2L PIC S9(0004) COMP.
  3478     05  CITYST2F PIC  X(0001).
  3479     05  FILLER REDEFINES CITYST2F.
  3480         10  CITYST2A PIC  X(0001).
  3481     05  CITYST2I PIC  X(0030).
  3482*    -------------------------------
  3483     05  ZIPBL PIC S9(0004) COMP.
  3484     05  ZIPBF PIC  X(0001).
  3485     05  FILLER REDEFINES ZIPBF.
  3486         10  ZIPBA PIC  X(0001).
  3487     05  ZIPBI PIC  X(0009).
  3488*    -------------------------------
  3489     05  ZIPB2L PIC S9(0004) COMP.
  3490     05  ZIPB2F PIC  X(0001).
  3491     05  FILLER REDEFINES ZIPB2F.
  3492         10  ZIPB2A PIC  X(0001).
  3493     05  ZIPB2I PIC  X(0009).
  3494*    -------------------------------
  3495     05  INTHDBL PIC S9(0004) COMP.
  3496     05  INTHDBF PIC  X(0001).
  3497     05  FILLER REDEFINES INTHDBF.
  3498         10  INTHDBA PIC  X(0001).
  3499     05  INTHDBI PIC  X(0012).
  3500*    -------------------------------
  3501     05  INTAMTBL PIC S9(0004) COMP.
  3502     05  INTAMTBF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  69
* EL156.cbl
  3503     05  FILLER REDEFINES INTAMTBF.
  3504         10  INTAMTBA PIC  X(0001).
  3505     05  INTAMTBI PIC  X(0011).
  3506*    -------------------------------
  3507     05  PMTHDGBL PIC S9(0004) COMP.
  3508     05  PMTHDGBF PIC  X(0001).
  3509     05  FILLER REDEFINES PMTHDGBF.
  3510         10  PMTHDGBA PIC  X(0001).
  3511     05  PMTHDGBI PIC  X(0034).
  3512*    -------------------------------
  3513     05  CLMNOBL PIC S9(0004) COMP.
  3514     05  CLMNOBF PIC  X(0001).
  3515     05  FILLER REDEFINES CLMNOBF.
  3516         10  CLMNOBA PIC  X(0001).
  3517     05  CLMNOBI PIC  X(0007).
  3518*    -------------------------------
  3519     05  CARRBL PIC S9(0004) COMP.
  3520     05  CARRBF PIC  X(0001).
  3521     05  FILLER REDEFINES CARRBF.
  3522         10  CARRBA PIC  X(0001).
  3523     05  CARRBI PIC  X(0001).
  3524*    -------------------------------
  3525     05  CERTNOBL PIC S9(0004) COMP.
  3526     05  CERTNOBF PIC  X(0001).
  3527     05  FILLER REDEFINES CERTNOBF.
  3528         10  CERTNOBA PIC  X(0001).
  3529     05  CERTNOBI PIC  X(0010).
  3530*    -------------------------------
  3531     05  SUFXBL PIC S9(0004) COMP.
  3532     05  SUFXBF PIC  X(0001).
  3533     05  FILLER REDEFINES SUFXBF.
  3534         10  SUFXBA PIC  X(0001).
  3535     05  SUFXBI PIC  X(0001).
  3536*    -------------------------------
  3537     05  CLMTYPBL PIC S9(0004) COMP.
  3538     05  CLMTYPBF PIC  X(0001).
  3539     05  FILLER REDEFINES CLMTYPBF.
  3540         10  CLMTYPBA PIC  X(0001).
  3541     05  CLMTYPBI PIC  X(0006).
  3542*    -------------------------------
  3543     05  INCURBL PIC S9(0004) COMP.
  3544     05  INCURBF PIC  X(0001).
  3545     05  FILLER REDEFINES INCURBF.
  3546         10  INCURBA PIC  X(0001).
  3547     05  INCURBI PIC  X(0008).
  3548*    -------------------------------
  3549     05  PYFROMBL PIC S9(0004) COMP.
  3550     05  PYFROMBF PIC  X(0001).
  3551     05  FILLER REDEFINES PYFROMBF.
  3552         10  PYFROMBA PIC  X(0001).
  3553     05  PYFROMBI PIC  X(0008).
  3554*    -------------------------------
  3555     05  PYTHRUBL PIC S9(0004) COMP.
  3556     05  PYTHRUBF PIC  X(0001).
  3557     05  FILLER REDEFINES PYTHRUBF.
  3558         10  PYTHRUBA PIC  X(0001).
  3559     05  PYTHRUBI PIC  X(0008).
  3560*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  70
* EL156.cbl
  3561     05  DAYSBL PIC S9(0004) COMP.
  3562     05  DAYSBF PIC  X(0001).
  3563     05  FILLER REDEFINES DAYSBF.
  3564         10  DAYSBA PIC  X(0001).
  3565     05  DAYSBI PIC  X(0005).
  3566*    -------------------------------
  3567     05  BYBL PIC S9(0004) COMP.
  3568     05  BYBF PIC  X(0001).
  3569     05  FILLER REDEFINES BYBF.
  3570         10  BYBA PIC  X(0001).
  3571     05  BYBI PIC  X(0004).
  3572*    -------------------------------
  3573     05  PROOFDBL PIC S9(0004) COMP.
  3574     05  PROOFDBF PIC  X(0001).
  3575     05  FILLER REDEFINES PROOFDBF.
  3576         10  PROOFDBA PIC  X(0001).
  3577     05  PROOFDBI PIC  X(0008).
  3578*    -------------------------------
  3579     05  ACCTBL PIC S9(0004) COMP.
  3580     05  ACCTBF PIC  X(0001).
  3581     05  FILLER REDEFINES ACCTBF.
  3582         10  ACCTBA PIC  X(0001).
  3583     05  ACCTBI PIC  X(0010).
  3584*    -------------------------------
  3585     05  STATEBL PIC S9(0004) COMP.
  3586     05  STATEBF PIC  X(0001).
  3587     05  FILLER REDEFINES STATEBF.
  3588         10  STATEBA PIC  X(0001).
  3589     05  STATEBI PIC  X(0002).
  3590*    -------------------------------
  3591     05  GROUPBL PIC S9(0004) COMP.
  3592     05  GROUPBF PIC  X(0001).
  3593     05  FILLER REDEFINES GROUPBF.
  3594         10  GROUPBA PIC  X(0001).
  3595     05  GROUPBI PIC  X(0006).
  3596*    -------------------------------
  3597     05  ACARRBL PIC S9(0004) COMP.
  3598     05  ACARRBF PIC  X(0001).
  3599     05  FILLER REDEFINES ACARRBF.
  3600         10  ACARRBA PIC  X(0001).
  3601     05  ACARRBI PIC  X(0001).
  3602*    -------------------------------
  3603     05  ACCTNMBL PIC S9(0004) COMP.
  3604     05  ACCTNMBF PIC  X(0001).
  3605     05  FILLER REDEFINES ACCTNMBF.
  3606         10  ACCTNMBA PIC  X(0001).
  3607     05  ACCTNMBI PIC  X(0030).
  3608*    -------------------------------
  3609     05  UNDISBL PIC S9(0004) COMP.
  3610     05  UNDISBF PIC  X(0001).
  3611     05  FILLER REDEFINES UNDISBF.
  3612         10  UNDISBA PIC  X(0001).
  3613     05  UNDISBI PIC  X(0010).
  3614*    -------------------------------
  3615     05  RATEBL PIC S9(0004) COMP.
  3616     05  RATEBF PIC  X(0001).
  3617     05  FILLER REDEFINES RATEBF.
  3618         10  RATEBA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  71
* EL156.cbl
  3619     05  RATEBI PIC  X(0006).
  3620*    -------------------------------
  3621     05  ERMSG1BL PIC S9(0004) COMP.
  3622     05  ERMSG1BF PIC  X(0001).
  3623     05  FILLER REDEFINES ERMSG1BF.
  3624         10  ERMSG1BA PIC  X(0001).
  3625     05  ERMSG1BI PIC  X(0072).
  3626*    -------------------------------
  3627     05  ENTPFBL PIC S9(0004) COMP.
  3628     05  ENTPFBF PIC  X(0001).
  3629     05  FILLER REDEFINES ENTPFBF.
  3630         10  ENTPFBA PIC  X(0001).
  3631     05  ENTPFBI PIC  99.
  3632 01  EL156BO REDEFINES EL156AI.
  3633     05  FILLER            PIC  X(0012).
  3634*    -------------------------------
  3635     05  FILLER            PIC  X(0003).
  3636     05  RUNDTEBO PIC  X(0008).
  3637*    -------------------------------
  3638     05  FILLER            PIC  X(0003).
  3639     05  RUNTIMBO PIC  99.99.
  3640*    -------------------------------
  3641     05  FILLER            PIC  X(0003).
  3642     05  PAYDTBO PIC  99B99B99.
  3643*    -------------------------------
  3644     05  FILLER            PIC  X(0003).
  3645     05  PAYTYPBO PIC  X(0015).
  3646*    -------------------------------
  3647     05  FILLER            PIC  X(0003).
  3648     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3649*    -------------------------------
  3650     05  FILLER            PIC  X(0003).
  3651     05  LOANHBO PIC  X(0012).
  3652*    -------------------------------
  3653     05  FILLER            PIC  X(0003).
  3654     05  LOANNBO PIC  X(0025).
  3655*    -------------------------------
  3656     05  FILLER            PIC  X(0003).
  3657     05  CKNUMHDO PIC  X(0012).
  3658*    -------------------------------
  3659     05  FILLER            PIC  X(0003).
  3660     05  CKNUMBO PIC  X(0007).
  3661*    -------------------------------
  3662     05  FILLER            PIC  X(0003).
  3663     05  AGTHDGO PIC  X(0016).
  3664*    -------------------------------
  3665     05  FILLER            PIC  X(0003).
  3666     05  NAMEBO PIC  X(0030).
  3667*    -------------------------------
  3668     05  FILLER            PIC  X(0003).
  3669     05  NAMEB2O PIC  X(0030).
  3670*    -------------------------------
  3671     05  FILLER            PIC  X(0003).
  3672     05  ADDR1BO PIC  X(0030).
  3673*    -------------------------------
  3674     05  FILLER            PIC  X(0003).
  3675     05  ADDR1B2O PIC  X(0030).
  3676*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  72
* EL156.cbl
  3677     05  FILLER            PIC  X(0003).
  3678     05  ADDR2BO PIC  X(0030).
  3679*    -------------------------------
  3680     05  FILLER            PIC  X(0003).
  3681     05  ADDR2B2O PIC  X(0030).
  3682*    -------------------------------
  3683     05  FILLER            PIC  X(0003).
  3684     05  CITYSTBO PIC  X(0030).
  3685*    -------------------------------
  3686     05  FILLER            PIC  X(0003).
  3687     05  CITYST2O PIC  X(0030).
  3688*    -------------------------------
  3689     05  FILLER            PIC  X(0003).
  3690     05  ZIPBO PIC  ZZZZ99999.
  3691*    -------------------------------
  3692     05  FILLER            PIC  X(0003).
  3693     05  ZIPB2O PIC  ZZZZZZZZZ.
  3694*    -------------------------------
  3695     05  FILLER            PIC  X(0003).
  3696     05  INTHDBO PIC  X(0012).
  3697*    -------------------------------
  3698     05  FILLER            PIC  X(0003).
  3699     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3700*    -------------------------------
  3701     05  FILLER            PIC  X(0003).
  3702     05  PMTHDGBO PIC  X(0034).
  3703*    -------------------------------
  3704     05  FILLER            PIC  X(0003).
  3705     05  CLMNOBO PIC  X(0007).
  3706*    -------------------------------
  3707     05  FILLER            PIC  X(0003).
  3708     05  CARRBO PIC  X(0001).
  3709*    -------------------------------
  3710     05  FILLER            PIC  X(0003).
  3711     05  CERTNOBO PIC  X(0010).
  3712*    -------------------------------
  3713     05  FILLER            PIC  X(0003).
  3714     05  SUFXBO PIC  X(0001).
  3715*    -------------------------------
  3716     05  FILLER            PIC  X(0003).
  3717     05  CLMTYPBO PIC  X(0006).
  3718*    -------------------------------
  3719     05  FILLER            PIC  X(0003).
  3720     05  INCURBO PIC  X(0008).
  3721*    -------------------------------
  3722     05  FILLER            PIC  X(0003).
  3723     05  PYFROMBO PIC  99B99B99.
  3724*    -------------------------------
  3725     05  FILLER            PIC  X(0003).
  3726     05  PYTHRUBO PIC  99B99B99.
  3727*    -------------------------------
  3728     05  FILLER            PIC  X(0003).
  3729     05  DAYSBO PIC  X(0005).
  3730*    -------------------------------
  3731     05  FILLER            PIC  X(0003).
  3732     05  BYBO PIC  X(0004).
  3733*    -------------------------------
  3734     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  73
* EL156.cbl
  3735     05  PROOFDBO PIC  99B99B99.
  3736*    -------------------------------
  3737     05  FILLER            PIC  X(0003).
  3738     05  ACCTBO PIC  X(0010).
  3739*    -------------------------------
  3740     05  FILLER            PIC  X(0003).
  3741     05  STATEBO PIC  X(0002).
  3742*    -------------------------------
  3743     05  FILLER            PIC  X(0003).
  3744     05  GROUPBO PIC  X(0006).
  3745*    -------------------------------
  3746     05  FILLER            PIC  X(0003).
  3747     05  ACARRBO PIC  X(0001).
  3748*    -------------------------------
  3749     05  FILLER            PIC  X(0003).
  3750     05  ACCTNMBO PIC  X(0030).
  3751*    -------------------------------
  3752     05  FILLER            PIC  X(0003).
  3753     05  UNDISBO PIC  ZZZ,Z99.99.
  3754*    -------------------------------
  3755     05  FILLER            PIC  X(0003).
  3756     05  RATEBO PIC  ZZZ.99.
  3757*    -------------------------------
  3758     05  FILLER            PIC  X(0003).
  3759     05  ERMSG1BO PIC  X(0072).
  3760*    -------------------------------
  3761     05  FILLER            PIC  X(0003).
  3762     05  ENTPFBO PIC  X(0002).
  3763*    -------------------------------
  3764****************************************************************
  3765*
  3766* Copyright (c) 2007-2013 Dell Inc.
  3767* All rights reserved.
  3768*
  3769****************************************************************
  3770 01  DFHEIV.
  3771   02  DFHEIV0               PIC X(35).
  3772   02  DFHEIV1               PIC X(08).
  3773   02  DFHEIV2               PIC X(08).
  3774   02  DFHEIV3               PIC X(08).
  3775   02  DFHEIV4               PIC X(06).
  3776   02  DFHEIV5               PIC X(04).
  3777   02  DFHEIV6               PIC X(04).
  3778   02  DFHEIV7               PIC X(02).
  3779   02  DFHEIV8               PIC X(02).
  3780   02  DFHEIV9               PIC X(01).
  3781   02  DFHEIV10              PIC S9(7) COMP-3.
  3782   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3783   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3784   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3785   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3786   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3787   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3788   02  DFHEIV17              PIC X(04).
  3789   02  DFHEIV18              PIC X(04).
  3790   02  DFHEIV19              PIC X(04).
  3791   02  DFHEIV20              USAGE IS POINTER.
  3792   02  DFHEIV21              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  74
* EL156.cbl
  3793   02  DFHEIV22              USAGE IS POINTER.
  3794   02  DFHEIV23              USAGE IS POINTER.
  3795   02  DFHEIV24              USAGE IS POINTER.
  3796   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3797   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3798   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3799   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3800   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3801   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3802   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3803   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3804   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3805   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3806   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3807   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3808   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3809   02  FILLER                PIC X(02).
  3810   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3811   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3812   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3813   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3814   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3815   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3816   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3817 LINKAGE  SECTION.
  3818*****************************************************************
  3819*                                                               *
  3820* Copyright (c) 2007-2013 Dell Inc.                             *
  3821* All rights reserved.                                          *
  3822*                                                               *
  3823*****************************************************************
  3824 01  dfheiblk.
  3825     02  eibtime          pic s9(7) comp-3.
  3826     02  eibdate          pic s9(7) comp-3.
  3827     02  eibtrnid         pic x(4).
  3828     02  eibtaskn         pic s9(7) comp-3.
  3829     02  eibtrmid         pic x(4).
  3830     02  dfheigdi         pic s9(4) comp.
  3831     02  eibcposn         pic s9(4) comp.
  3832     02  eibcalen         pic s9(4) comp.
  3833     02  eibaid           pic x(1).
  3834     02  eibfiller1       pic x(1).
  3835     02  eibfn            pic x(2).
  3836     02  eibfiller2       pic x(2).
  3837     02  eibrcode         pic x(6).
  3838     02  eibfiller3       pic x(2).
  3839     02  eibds            pic x(8).
  3840     02  eibreqid         pic x(8).
  3841     02  eibrsrce         pic x(8).
  3842     02  eibsync          pic x(1).
  3843     02  eibfree          pic x(1).
  3844     02  eibrecv          pic x(1).
  3845     02  eibsend          pic x(1).
  3846     02  eibatt           pic x(1).
  3847     02  eibeoc           pic x(1).
  3848     02  eibfmh           pic x(1).
  3849     02  eibcompl         pic x(1).
  3850     02  eibsig           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  75
* EL156.cbl
  3851     02  eibconf          pic x(1).
  3852     02  eiberr           pic x(1).
  3853     02  eibrldbk         pic x(1).
  3854     02  eiberrcd         pic x(4).
  3855     02  eibsynrb         pic x(1).
  3856     02  eibnodat         pic x(1).
  3857     02  eibfiller5       pic x(2).
  3858     02  eibresp          pic s9(8) comp.
  3859     02  eibresp2         pic s9(8) comp.
  3860     02  dfheigdj         pic s9(4) comp.
  3861     02  dfheigdk         pic s9(4) comp.
  3862 01  DFHCOMMAREA             PIC X(1024).
  3863
  3864*    COPY ELCMSTR.
  3865******************************************************************
  3866*                                                                *
  3867*                            ELCMSTR.                            *
  3868*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3869*                            VMOD=2.012                          *
  3870*                                                                *
  3871*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3872*                                                                *
  3873*   FILE TYPE = VSAM,KSDS                                        *
  3874*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3875*                                                                *
  3876*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3877*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3878*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3879*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3880*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3881*                                                 RKP=75,LEN=21  *
  3882*                                                                *
  3883*   **** NOTE ****                                               *
  3884*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3885*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3886*                                                                *
  3887*   LOG = YES                                                    *
  3888*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3889******************************************************************
  3890*                   C H A N G E   L O G
  3891*
  3892* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3893*-----------------------------------------------------------------
  3894*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3895* EFFECTIVE    NUMBER
  3896*-----------------------------------------------------------------
  3897* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3898* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3899* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3900* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3901* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3902* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3903******************************************************************
  3904 01  CLAIM-MASTER.
  3905     12  CL-RECORD-ID                PIC XX.
  3906         88  VALID-CL-ID         VALUE 'CL'.
  3907
  3908     12  CL-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  76
* EL156.cbl
  3909         16  CL-COMPANY-CD           PIC X.
  3910         16  CL-CARRIER              PIC X.
  3911         16  CL-CLAIM-NO             PIC X(7).
  3912         16  CL-CERT-NO.
  3913             20  CL-CERT-PRIME       PIC X(10).
  3914             20  CL-CERT-SFX         PIC X.
  3915
  3916     12  CL-CONTROL-BY-NAME.
  3917         16  CL-COMPANY-CD-A1        PIC X.
  3918         16  CL-INSURED-LAST-NAME    PIC X(15).
  3919         16  CL-INSURED-NAME.
  3920             20  CL-INSURED-1ST-NAME PIC X(12).
  3921             20  CL-INSURED-MID-INIT PIC X.
  3922
  3923     12  CL-CONTROL-BY-SSN.
  3924         16  CL-COMPANY-CD-A2        PIC X.
  3925         16  CL-SOC-SEC-NO.
  3926             20  CL-SSN-STATE        PIC XX.
  3927             20  CL-SSN-ACCOUNT      PIC X(6).
  3928             20  CL-SSN-LN3          PIC X(3).
  3929
  3930     12  CL-CONTROL-BY-CERT-NO.
  3931         16  CL-COMPANY-CD-A4        PIC X.
  3932         16  CL-CERT-NO-A4.
  3933             20  CL-CERT-A4-PRIME    PIC X(10).
  3934             20  CL-CERT-A4-SFX      PIC X.
  3935
  3936     12  CL-CONTROL-BY-CCN.
  3937         16  CL-COMPANY-CD-A5        PIC X.
  3938         16  CL-CCN-A5.
  3939             20  CL-CCN.
  3940                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3941                 24  CL-CCN-PRIME-A5 PIC X(12).
  3942             20  CL-CCN-FILLER-A5    PIC X(4).
  3943
  3944     12  CL-INSURED-PROFILE-DATA.
  3945         16  CL-INSURED-BIRTH-DT     PIC XX.
  3946         16  CL-INSURED-SEX-CD       PIC X.
  3947             88  INSURED-IS-MALE        VALUE 'M'.
  3948             88  INSURED-IS-FEMALE      VALUE 'F'.
  3949             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3950         16  CL-INSURED-OCC-CD       PIC X(6).
  3951         16  FILLER                  PIC X(5).
  3952
  3953     12  CL-PROCESSING-INFO.
  3954         16  CL-PROCESSOR-ID         PIC X(4).
  3955         16  CL-CLAIM-STATUS         PIC X.
  3956             88  CLAIM-IS-OPEN          VALUE 'O'.
  3957             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3958         16  CL-CLAIM-TYPE           PIC X.
  3959*            88  AH-CLAIM               VALUE 'A'.
  3960*            88  LIFE-CLAIM             VALUE 'L'.
  3961*            88  PROPERTY-CLAIM         VALUE 'P'.
  3962*            88  IUI-CLAIM              VALUE 'I'.
  3963*            88  GAP-CLAIM              VALUE 'G'.
  3964*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3965         16  CL-CLAIM-PREM-TYPE      PIC X.
  3966             88  SINGLE-PREMIUM         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  77
* EL156.cbl
  3967             88  O-B-COVERAGE           VALUE '2'.
  3968             88  OPEN-END-COVERAGE      VALUE '3'.
  3969         16  CL-INCURRED-DT          PIC XX.
  3970         16  CL-REPORTED-DT          PIC XX.
  3971         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3972         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3973         16  CL-LAST-PMT-DT          PIC XX.
  3974         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3975         16  CL-PAID-THRU-DT         PIC XX.
  3976         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3977         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3978         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3979         16  CL-PMT-CALC-METHOD      PIC X.
  3980             88  CL-360-DAY-YR          VALUE '1'.
  3981             88  CL-365-DAY-YR          VALUE '2'.
  3982             88  CL-FULL-MONTHS         VALUE '3'.
  3983         16  CL-CAUSE-CD             PIC X(6).
  3984
  3985         16  CL-PRIME-CERT-NO.
  3986             20  CL-PRIME-CERT-PRIME PIC X(10).
  3987             20  CL-PRIME-CERT-SFX   PIC X.
  3988
  3989         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3990             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3991             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3992
  3993         16  CL-MICROFILM-NO         PIC X(10).
  3994         16  FILLER REDEFINES CL-MICROFILM-NO.
  3995             20  CL-BENEFIT-PERIOD   PIC 99.
  3996             20  FILLER              PIC X(8).
  3997         16  CL-PROG-FORM-TYPE       PIC X.
  3998         16  CL-LAST-ADD-ON-DT       PIC XX.
  3999
  4000         16  CL-LAST-REOPEN-DT       PIC XX.
  4001         16  CL-LAST-CLOSE-DT        PIC XX.
  4002         16  CL-LAST-CLOSE-REASON    PIC X(01).
  4003             88  FINAL-PAID             VALUE '1'.
  4004             88  CLAIM-DENIED           VALUE '2'.
  4005             88  AUTO-CLOSE             VALUE '3'.
  4006             88  MANUAL-CLOSE           VALUE '4'.
  4007             88  BENEFITS-CHANGED       VALUE 'C'.
  4008             88  SETUP-ERRORS           VALUE 'E'.
  4009         16  CL-ASSOC-CERT-SEQU      PIC S99.
  4010         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  4011         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  4012             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  4013         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  4014         16  FILLER                  PIC X.
  4015
  4016     12  CL-CERTIFICATE-DATA.
  4017         16  CL-CERT-ORIGIN          PIC X.
  4018             88  CERT-WAS-ONLINE        VALUE '1'.
  4019             88  CERT-WAS-CREATED       VALUE '2'.
  4020             88  COVERAGE-WAS-ADDED     VALUE '3'.
  4021         16  CL-CERT-KEY-DATA.
  4022             20  CL-CERT-CARRIER     PIC X.
  4023             20  CL-CERT-GROUPING    PIC X(6).
  4024             20  CL-CERT-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  78
* EL156.cbl
  4025             20  CL-CERT-ACCOUNT.
  4026                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  4027                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  4028             20  CL-CERT-EFF-DT      PIC XX.
  4029
  4030     12  CL-STATUS-CONTROLS.
  4031         16  CL-PRIORITY-CD          PIC X.
  4032             88  CONFIDENTIAL-DATA      VALUE '8'.
  4033             88  HIGHEST-PRIORITY       VALUE '9'.
  4034         16  CL-SUPV-ATTN-CD         PIC X.
  4035             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  4036             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  4037         16  CL-PURGED-DT            PIC XX.
  4038         16  CL-RESTORED-DT          PIC XX.
  4039         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  4040         16  CL-NEXT-RESEND-DT       PIC XX.
  4041         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  4042         16  CL-CRITICAL-PERIOD      PIC 99.
  4043*        16  FILLER                  PIC XX.
  4044         16  CL-LAST-MAINT-DT        PIC XX.
  4045         16  CL-LAST-MAINT-USER      PIC X(4).
  4046         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  4047         16  CL-LAST-MAINT-TYPE      PIC X.
  4048             88  CLAIM-SET-UP           VALUE ' '.
  4049             88  PAYMENT-MADE           VALUE '1'.
  4050             88  LETTER-SENT            VALUE '2'.
  4051             88  MASTER-WAS-ALTERED     VALUE '3'.
  4052             88  MASTER-WAS-RESTORED    VALUE '4'.
  4053             88  INCURRED-DATE-CHANGED  VALUE '5'.
  4054             88  FILE-CONVERTED         VALUE '6'.
  4055             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  4056             88  ERROR-CORRECTION       VALUE 'E'.
  4057         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4058         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4059         16  CL-BENEFICIARY          PIC X(10).
  4060         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4061         16  CL-DENIAL-TYPE          PIC X.
  4062             88  CL-TYPE-DENIAL          VALUE '1'.
  4063             88  CL-TYPE-RESCISSION      VALUE '2'.
  4064             88  CL-TYPE-REFORMATION     VALUE '3'.
  4065             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4066             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4067         16  CL-NO-OF-EXTENSIONS     PIC 99.
  4068         16  filler                  pic x(3).
  4069*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4070*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4071*        16  CL-RTW-DT               PIC XX.
  4072
  4073     12  CL-TRAILER-CONTROLS.
  4074         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4075             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4076             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4077             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4078         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4079         16  FILLER                  PIC XX.
  4080         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4081         16  CL-ADDRESS-TRAILER-CNT.
  4082             20  CL-INSURED-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  79
* EL156.cbl
  4083                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4084             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4085                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4086             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4087                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4088             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4089                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4090             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4091                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4092             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4093                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4094             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4095                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4096
  4097     12  CL-CV-REFERENCE-NO.
  4098         16  CL-CV-REFNO-PRIME       PIC X(18).
  4099         16  CL-CV-REFNO-SFX         PIC XX.
  4100
  4101     12  CL-FILE-LOCATION            PIC X(4).
  4102
  4103     12  CL-PROCESS-ERRORS.
  4104         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4105             88  NO-FATAL-ERRORS        VALUE ZERO.
  4106         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4107             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4108
  4109     12  CL-PRODUCT-CD               PIC X.
  4110
  4111     12  CL-CURRENT-KEY-DATA.
  4112         16  CL-CURRENT-CARRIER      PIC X.
  4113         16  CL-CURRENT-GROUPING     PIC X(6).
  4114         16  CL-CURRENT-STATE        PIC XX.
  4115         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4116
  4117     12  CL-ASSOCIATES               PIC X.
  4118         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4119         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4120         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  4121         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4122
  4123     12  CL-ACTIVITY-CODE            PIC 99.
  4124     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4125     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4126
  4127     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4128     12  CL-LAG-REPORT-CODE          PIC 9.
  4129     12  CL-LOAN-TYPE                PIC XX.
  4130     12  CL-LEGAL-STATE              PIC XX.
  4131
  4132     12  CL-YESNOSW                  PIC X.
  4133     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4134         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4135         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4136         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4137     12  cl-insured-type             pic x.
  4138         88  cl-claim-on-primary         value 'P'.
  4139         88  cl-claim-on-co-borrower     value 'C'.
  4140     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  80
* EL156.cbl
  4142*    COPY ELCCNTL.
  4143******************************************************************
  4144*                                                                *
  4145*                                                                *
  4146*                            ELCCNTL.                            *
  4147*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4148*                            VMOD=2.059                          *
  4149*                                                                *
  4150*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4151*                                                                *
  4152*   FILE TYPE = VSAM,KSDS                                        *
  4153*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4154*                                                                *
  4155*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4156*       ALTERNATE INDEX = NONE                                   *
  4157*                                                                *
  4158*   LOG = YES                                                    *
  4159*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4160******************************************************************
  4161*                   C H A N G E   L O G
  4162*
  4163* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4164*-----------------------------------------------------------------
  4165*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4166* EFFECTIVE    NUMBER
  4167*-----------------------------------------------------------------
  4168* 082503                   PEMA  ADD BENEFIT GROUP
  4169* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4170* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4171* 092705    2005050300006  PEMA  ADD SPP LEASES
  4172* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4173* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4174* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4175* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4176* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4177* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4178* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4179* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4180* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4181* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4182* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  4183******************************************************************
  4184*
  4185 01  CONTROL-FILE.
  4186     12  CF-RECORD-ID                       PIC XX.
  4187         88  VALID-CF-ID                        VALUE 'CF'.
  4188
  4189     12  CF-CONTROL-PRIMARY.
  4190         16  CF-COMPANY-ID                  PIC XXX.
  4191         16  CF-RECORD-TYPE                 PIC X.
  4192             88  CF-COMPANY-MASTER              VALUE '1'.
  4193             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4194             88  CF-STATE-MASTER                VALUE '3'.
  4195             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4196             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4197             88  CF-CARRIER-MASTER              VALUE '6'.
  4198             88  CF-MORTALITY-MASTER            VALUE '7'.
  4199             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  81
* EL156.cbl
  4200             88  CF-TERMINAL-MASTER             VALUE '9'.
  4201             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4202             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4203             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4204             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4205             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4206             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4207             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4208             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4209             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4210         16  CF-ACCESS-CD-GENL              PIC X(4).
  4211         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4212             20  CF-PROCESSOR               PIC X(4).
  4213         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4214             20  CF-STATE-CODE              PIC XX.
  4215             20  FILLER                     PIC XX.
  4216         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4217             20  FILLER                     PIC XX.
  4218             20  CF-HI-BEN-IN-REC           PIC XX.
  4219         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4220             20  FILLER                     PIC XXX.
  4221             20  CF-CARRIER-CNTL            PIC X.
  4222         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4223             20  FILLER                     PIC XX.
  4224             20  CF-HI-TYPE-IN-REC          PIC 99.
  4225         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4226             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4227                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4228             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4229             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4230         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4231             20  FILLER                     PIC X.
  4232             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4233         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4234             20  FILLER                     PIC XX.
  4235             20  CF-MORTGAGE-PLAN           PIC XX.
  4236         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4237
  4238     12  CF-LAST-MAINT-DT                   PIC XX.
  4239     12  CF-LAST-MAINT-BY                   PIC X(4).
  4240     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4241
  4242     12  CF-RECORD-BODY                     PIC X(728).
  4243
  4244
  4245****************************************************************
  4246*             COMPANY MASTER RECORD                            *
  4247****************************************************************
  4248
  4249     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4250         16  CF-COMPANY-ADDRESS.
  4251             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4252             20  CF-CL-IN-CARE-OF           PIC X(30).
  4253             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4254             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4255             20  CF-CL-CITY-STATE           PIC X(30).
  4256             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4257             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  82
* EL156.cbl
  4258         16  CF-COMPANY-CD                  PIC X.
  4259         16  CF-COMPANY-PASSWORD            PIC X(8).
  4260         16  CF-SECURITY-OPTION             PIC X.
  4261             88  ALL-SECURITY                   VALUE '1'.
  4262             88  COMPANY-VERIFY                 VALUE '2'.
  4263             88  PROCESSOR-VERIFY               VALUE '3'.
  4264             88  NO-SECURITY                    VALUE '4'.
  4265             88  ALL-BUT-TERM                   VALUE '5'.
  4266         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4267             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4268         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4269             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4270         16  CF-INFORCE-LOCATION            PIC X.
  4271             88  CERTS-ARE-ONLINE               VALUE '1'.
  4272             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4273             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4274         16  CF-LOWER-CASE-LETTERS          PIC X.
  4275         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4276             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4277             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4278             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4279             88  CF-ACCNT-CNTL                  VALUE '3'.
  4280             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4281
  4282         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4283         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4284
  4285         16  CF-LGX-CREDIT-USER             PIC X.
  4286             88  CO-IS-NOT-USER                 VALUE 'N'.
  4287             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4288
  4289         16 CF-CREDIT-CALC-CODES.
  4290             20  CF-CR-REM-TERM-CALC PIC X.
  4291               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4292               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4293               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4294               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4295               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4296               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4297               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4298             20  CF-CR-R78-METHOD           PIC X.
  4299               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4300               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4301
  4302         16  CF-CLAIM-CONTROL-COUNTS.
  4303             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4304                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4305
  4306             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4307                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4308
  4309             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4310                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4311
  4312             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4313                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4314
  4315         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  83
* EL156.cbl
  4316
  4317         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4318             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4319             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4320             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4321             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4322                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4323                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4324             20  CF-CO-PREM-REJECT-SW       PIC X.
  4325                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4326                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4327             20  CF-CO-REF-REJECT-SW        PIC X.
  4328                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4329                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4330
  4331         16  CF-CO-REPORTING-DT             PIC XX.
  4332         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4333         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4334           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4335           88  CF-CO-MONTH-END                  VALUE '1'.
  4336
  4337         16  CF-LGX-CLAIM-USER              PIC X.
  4338             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4339             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4340
  4341         16  CF-CREDIT-EDIT-CONTROLS.
  4342             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4343             20  CF-MIN-AGE                 PIC 99.
  4344             20  CF-DEFAULT-AGE             PIC 99.
  4345             20  CF-MIN-TERM                PIC S999      COMP-3.
  4346             20  CF-MAX-TERM                PIC S999      COMP-3.
  4347             20  CF-DEFAULT-SEX             PIC X.
  4348             20  CF-JOINT-AGE-INPUT         PIC X.
  4349                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4350             20  CF-BIRTH-DATE-INPUT        PIC X.
  4351                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4352             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4353                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4354                 88  CF-ZERO-CARRIER            VALUE '1'.
  4355                 88  CF-ZERO-GROUPING           VALUE '2'.
  4356                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4357             20  CF-EDIT-SW                 PIC X.
  4358                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4359             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4360             20  CF-CR-PR-METHOD            PIC X.
  4361               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4362               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4363             20  FILLER                     PIC X.
  4364
  4365         16  CF-CREDIT-MISC-CONTROLS.
  4366             20  CF-REIN-TABLE-SW           PIC X.
  4367                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4368             20  CF-COMP-TABLE-SW           PIC X.
  4369                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4370             20  CF-EXPERIENCE-RETENTION-AGE
  4371                                            PIC S9        COMP-3.
  4372             20  CF-CONVERSION-DT           PIC XX.
  4373             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  84
* EL156.cbl
  4374             20  CF-RUN-FREQUENCY-SW        PIC X.
  4375                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4376                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4377
  4378             20  CF-CR-CHECK-NO-CONTROL.
  4379                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4380                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4381                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4382                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4383                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4384                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4385
  4386                 24  CF-CR-CHECK-COUNT       REDEFINES
  4387                     CF-CR-CHECK-COUNTER      PIC X(4).
  4388
  4389                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4390                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4391
  4392                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4393                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4394                 24  CF-MAIL-PROCESSING       PIC X.
  4395                     88  MAIL-PROCESSING          VALUE 'Y'.
  4396
  4397         16  CF-MISC-SYSTEM-CONTROL.
  4398             20  CF-SYSTEM-C                 PIC X.
  4399                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4400             20  CF-SYSTEM-D                 PIC X.
  4401                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4402             20  CF-SOC-SEC-NO-SW            PIC X.
  4403                 88  SOC-SEC-NO-USED             VALUE '1'.
  4404             20  CF-MEMBER-NO-SW             PIC X.
  4405                 88  MEMBER-NO-USED              VALUE '1'.
  4406             20  CF-TAX-ID-NUMBER            PIC X(11).
  4407             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4408             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4409                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4410                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4411                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4412                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4413             20  CF-SYSTEM-E                 PIC X.
  4414                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4415
  4416         16  CF-LGX-LIFE-USER               PIC X.
  4417             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4418             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4419
  4420         16  CF-CR-MONTH-END-DT             PIC XX.
  4421
  4422         16  CF-FILE-MAINT-DATES.
  4423             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4424                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4425             20  CF-LAST-BATCH       REDEFINES
  4426                 CF-LAST-BATCH-NO               PIC X(4).
  4427             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4428             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4429             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4430             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4431             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  85
* EL156.cbl
  4432             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4433             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4434             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4435             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4436             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4437
  4438         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4439         16  FILLER                         PIC X.
  4440
  4441         16  CF-ALT-MORT-CODE               PIC X(4).
  4442         16  CF-MEMBER-CAPTION              PIC X(10).
  4443
  4444         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4445             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4446             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4447             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4448             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4449             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4450
  4451         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4452
  4453         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4454         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4455         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4456         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4457
  4458         16  CF-AH-OVERRIDE-L1              PIC X.
  4459         16  CF-AH-OVERRIDE-L2              PIC XX.
  4460         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4461         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4462
  4463         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4464         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4465
  4466         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4467         16  CF-AR-LAST-EL860-DT            PIC XX.
  4468         16  CF-MP-MONTH-END-DT             PIC XX.
  4469
  4470         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4471         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4472             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4473
  4474         16  CF-AR-MONTH-END-DT             PIC XX.
  4475
  4476         16  CF-CRDTCRD-USER                PIC X.
  4477             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4478             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4479
  4480         16  CF-CC-MONTH-END-DT             PIC XX.
  4481
  4482         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4483
  4484         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4485             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4486             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4487             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4488         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4489         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  86
* EL156.cbl
  4490         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4491         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4492             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4493             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4494         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4495         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4496         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4497             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4498         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4499
  4500         16  CF-CL-ZIP-CODE.
  4501             20  CF-CL-ZIP-PRIME.
  4502                 24  CF-CL-ZIP-1ST          PIC X.
  4503                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4504                 24  FILLER                 PIC X(4).
  4505             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4506         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4507             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4508             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4509             20  FILLER                     PIC XXX.
  4510
  4511         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4512         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4513         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4514         16  CF-CO-OPTION-START-DATE        PIC XX.
  4515         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4516           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4517                                                      '3' '4'.
  4518           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4519           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4520           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4521           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4522           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4523           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4524
  4525         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4526
  4527         16  CF-PAYMENT-APPROVAL-LEVELS.
  4528             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4529             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4530             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4531             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4532             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4533             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4534
  4535         16  CF-END-USER-REPORTING-USER     PIC X.
  4536             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4537             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4538
  4539         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4540             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4541             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4542
  4543         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4544
  4545         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4546         16  FILLER                         PIC X.
  4547
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  87
* EL156.cbl
  4548         16  CF-CREDIT-ARCHIVE-CNTL.
  4549             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4550             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4551             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4552
  4553         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4554
  4555         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4556             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4557             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4558
  4559         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4560             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4561             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4562
  4563         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4564
  4565         16  CF-CO-ACH-ID-CODE              PIC  X.
  4566             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4567             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4568             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4569         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4570         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4571         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4572         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4573         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4574         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4575         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4576         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4577         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4578                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4579         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4580                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4581
  4582         16  CF-CO-OVER-SHORT.
  4583             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4584             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4585
  4586*         16  FILLER                         PIC X(102).
  4587         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4588             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4589             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4590
  4591         16  CF-AH-APPROVAL-DAYS.
  4592             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4593             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4594             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4595             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4596
  4597         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4598
  4599         16  CF-APPROV-LEV-5.
  4600             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4601             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4602             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4603
  4604         16  FILLER                         PIC X(68).
  4605****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  88
* EL156.cbl
  4606*             PROCESSOR/USER RECORD                            *
  4607****************************************************************
  4608
  4609     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4610         16  CF-PROCESSOR-NAME              PIC X(30).
  4611         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4612         16  CF-PROCESSOR-TITLE             PIC X(26).
  4613         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4614                 88  MESSAGE-YES                VALUE 'Y'.
  4615                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4616
  4617*****************************************************
  4618****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4619****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4620****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4621****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4622*****************************************************
  4623
  4624         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4625             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4626             20  CF-APPLICATION-FORCE       PIC X.
  4627             20  CF-INDIVIDUAL-APP.
  4628                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4629                     28  CF-BROWSE-APP      PIC X.
  4630                     28  CF-UPDATE-APP      PIC X.
  4631
  4632         16  CF-CURRENT-TERM-ON             PIC X(4).
  4633         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4634             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4635             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4636             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4637             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4638             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4639             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4640             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4641         16  CF-PROCESSOR-CARRIER           PIC X.
  4642             88  NO-CARRIER-SECURITY            VALUE ' '.
  4643         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4644             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4645         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4646             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4647         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4648             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4649
  4650         16  CF-PROC-SYS-ACCESS-SW.
  4651             20  CF-PROC-CREDIT-CLAIMS-SW.
  4652                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4653                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4654                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4655                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4656             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4657                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4658                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4659             20  CF-PROC-LIFE-GNRLDGR-SW.
  4660                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4661                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4662                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4663                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  89
* EL156.cbl
  4664             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  4665                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4666                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4667         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4668             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4669             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4670         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4671
  4672         16  CF-APPROVAL-LEVEL                  PIC X.
  4673             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4674             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4675             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4676             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4677             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4678
  4679         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4680
  4681         16  CF-LANGUAGE-TYPE                   PIC X.
  4682             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4683             88  CF-LANG-IS-FR                      VALUE 'F'.
  4684
  4685         16  CF-CSR-IND                         PIC X.
  4686         16  FILLER                             PIC X(239).
  4687
  4688****************************************************************
  4689*             PROCESSOR/REMINDERS RECORD                       *
  4690****************************************************************
  4691
  4692     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4693         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4694             20  CF-START-REMIND-DT         PIC XX.
  4695             20  CF-END-REMIND-DT           PIC XX.
  4696             20  CF-REMINDER-TEXT           PIC X(50).
  4697         16  FILLER                         PIC X(296).
  4698
  4699
  4700****************************************************************
  4701*             STATE MASTER RECORD                              *
  4702****************************************************************
  4703
  4704     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4705         16  CF-STATE-ABBREVIATION          PIC XX.
  4706         16  CF-STATE-NAME                  PIC X(25).
  4707         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4708         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4709             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4710             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4711             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4712             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4713                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4714                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4715             20  CF-ST-PREM-REJECT-SW       PIC X.
  4716                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4717                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4718             20  CF-ST-REF-REJECT-SW        PIC X.
  4719                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4720                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4721         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  90
* EL156.cbl
  4722         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4723         16  CF-ST-REFUND-RULES.
  4724             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4725             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4726             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4727         16  CF-ST-FST-PMT-EXTENSION.
  4728             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4729             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4730                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4731                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4732                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4733                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4734         16  CF-ST-STATE-CALL.
  4735             20  CF-ST-CALL-UNEARNED        PIC X.
  4736             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4737             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4738         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4739             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4740             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4741         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4742         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4743         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4744         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4745         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4746         16  FILLER                         PIC X.
  4747         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4748             20  CF-ST-BENEFIT-CD           PIC XX.
  4749             20  CF-ST-BENEFIT-KIND         PIC X.
  4750                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4751                 88  CF-ST-AH-KIND              VALUE 'A'.
  4752             20  CF-ST-REM-TERM-CALC        PIC X.
  4753                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4754                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4755                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4756                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4757                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4758                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4759                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4760                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4761
  4762             20  CF-ST-REFUND-CALC          PIC X.
  4763                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4764                 88  ST-REFD-BY-R78             VALUE '1'.
  4765                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4766                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4767                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4768                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4769                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4770                 88  ST-REFD-UTAH               VALUE '7'.
  4771                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4772                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4773                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4774
  4775             20  CF-ST-EARNING-CALC         PIC X.
  4776                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4777                 88  ST-EARN-BY-R78             VALUE '1'.
  4778                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4779                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  91
* EL156.cbl
  4780                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4781                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4782                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4783                 88  ST-EARN-MEAN               VALUE '8'.
  4784                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4785
  4786             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4787                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4788                 88  ST-OVRD-BY-R78             VALUE '1'.
  4789                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4790                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4791                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4792                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4793                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4794                 88  ST-OVRD-MEAN               VALUE '8'.
  4795                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4796             20  cf-st-extra-periods        pic 9.
  4797*            20  FILLER                     PIC X.
  4798
  4799         16  CF-ST-COMMISSION-CAPS.
  4800             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4801             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4802             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4803             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4804         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4805                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4806                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  4807                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  4808
  4809         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4810
  4811         16  CF-ST-STATUTORY-INTEREST.
  4812             20  CF-ST-STAT-DATE-FROM       PIC X.
  4813                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4814                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4815             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4816             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4817             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4818             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4819             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4820
  4821         16  CF-ST-OVER-SHORT.
  4822             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4823             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4824
  4825         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4826
  4827         16  CF-ST-RT-CALC                  PIC X.
  4828
  4829         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4830         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4831         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4832         16  CF-ST-RF-LR-CALC               PIC X.
  4833         16  CF-ST-RF-LL-CALC               PIC X.
  4834         16  CF-ST-RF-LN-CALC               PIC X.
  4835         16  CF-ST-RF-AH-CALC               PIC X.
  4836         16  CF-ST-RF-CP-CALC               PIC X.
  4837*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  92
* EL156.cbl
  4838*CIDMOD         16  FILLER                         PIC X(192).
  4839         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4840             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4841         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4842         16  CF-ST-VFY-2ND-BENE             PIC X.
  4843         16  CF-ST-CAUSAL-STATE             PIC X.
  4844         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4845         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4846         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4847             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4848         16  CF-ST-NET-ONLY-STATE           PIC X.
  4849             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4850         16  cf-commission-cap-required     pic x.
  4851         16  CF-ST-GA-COMMISSION-CAPS.
  4852             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  4853             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  4854             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  4855             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  4856         16  CF-ST-TOT-COMMISSION-CAPS.
  4857             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  4858             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  4859             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  4860             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  4861         16  FILLER                         PIC X(156).
  4862
  4863****************************************************************
  4864*             BENEFIT MASTER RECORD                            *
  4865****************************************************************
  4866
  4867     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4868         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4869             20  CF-BENEFIT-CODE            PIC XX.
  4870             20  CF-BENEFIT-NUMERIC  REDEFINES
  4871                 CF-BENEFIT-CODE            PIC XX.
  4872             20  CF-BENEFIT-ALPHA           PIC XXX.
  4873             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4874             20  CF-BENEFIT-COMMENT         PIC X(10).
  4875
  4876             20  CF-LF-COVERAGE-TYPE        PIC X.
  4877                 88  CF-REDUCING                VALUE 'R'.
  4878                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4879
  4880             20  CF-SPECIAL-CALC-CD         PIC X.
  4881                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4882                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4883                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4884                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4885                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4886                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4887                 88  CF-FARM-PLAN               VALUE 'F'.
  4888                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4889                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4890                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4891                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4892                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4893                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4894                 88  CF-PRUDENTIAL              VALUE 'P'.
  4895                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  93
* EL156.cbl
  4896                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4897                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4898                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4899                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4900                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4901
  4902             20  CF-JOINT-INDICATOR         PIC X.
  4903                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4904
  4905*            20  FILLER                     PIC X(12).
  4906             20  cf-maximum-benefits        pic s999 comp-3.
  4907             20  FILLER                     PIC X(09).
  4908             20  CF-BENEFIT-CATEGORY        PIC X.
  4909             20  CF-LOAN-TYPE               PIC X(8).
  4910
  4911             20  CF-CO-REM-TERM-CALC        PIC X.
  4912                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4913                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4914                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4915                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4916                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4917
  4918             20  CF-CO-EARNINGS-CALC        PIC X.
  4919                 88  CO-EARN-BY-R78             VALUE '1'.
  4920                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4921                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4922                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4923                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4924                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4925                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4926                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4927
  4928             20  CF-CO-REFUND-CALC          PIC X.
  4929                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4930                 88  CO-REFD-BY-R78             VALUE '1'.
  4931                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4932                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4933                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4934                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4935                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4936                 88  CO-REFD-MEAN               VALUE '8'.
  4937                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4938                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4939                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4940
  4941             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4942                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4943                 88  CO-OVRD-BY-R78             VALUE '1'.
  4944                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4945                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4946                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4947                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4948                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4949                 88  CO-OVRD-MEAN               VALUE '8'.
  4950                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4951
  4952             20  CF-CO-BEN-I-G-CD           PIC X.
  4953                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  94
* EL156.cbl
  4954                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4955                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4956
  4957         16  FILLER                         PIC X(304).
  4958
  4959
  4960****************************************************************
  4961*             CARRIER MASTER RECORD                            *
  4962****************************************************************
  4963
  4964     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4965         16  CF-ADDRESS-DATA.
  4966             20  CF-MAIL-TO-NAME            PIC X(30).
  4967             20  CF-IN-CARE-OF              PIC X(30).
  4968             20  CF-ADDRESS-LINE-1          PIC X(30).
  4969             20  CF-ADDRESS-LINE-2          PIC X(30).
  4970             20  CF-CITY-STATE              PIC X(30).
  4971             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4972             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4973
  4974         16  CF-CLAIM-NO-CONTROL.
  4975             20  CF-CLAIM-NO-METHOD         PIC X.
  4976                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4977                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4978                 88  CLAIM-NO-SEQ               VALUE '3'.
  4979                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4980             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4981                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4982                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4983                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4984
  4985         16  CF-CHECK-NO-CONTROL.
  4986             20  CF-CHECK-NO-METHOD         PIC X.
  4987                 88  CHECK-NO-MANUAL            VALUE '1'.
  4988                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4989                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4990                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4991             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4992                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4993
  4994         16  CF-DOMICILE-STATE              PIC XX.
  4995
  4996         16  CF-EXPENSE-CONTROLS.
  4997             20  CF-EXPENSE-METHOD          PIC X.
  4998                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4999                 88  DOLLARS-PER-PMT            VALUE '2'.
  5000                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5001                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5002             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5003             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5004
  5005         16  CF-CORRESPONDENCE-CONTROL.
  5006             20  CF-LETTER-RESEND-OPT       PIC X.
  5007                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5008                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5009             20  FILLER                     PIC X(4).
  5010
  5011         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  95
* EL156.cbl
  5012             20  CF-MANUAL-SW               PIC X.
  5013                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5014             20  CF-FUTURE-SW               PIC X.
  5015                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5016             20  CF-PTC-SW                  PIC X.
  5017                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5018             20  CF-IBNR-SW                 PIC X.
  5019                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5020             20  CF-PTC-LF-SW               PIC X.
  5021                 88  CF-LF-PTC-USED             VALUE '1'.
  5022             20  CF-CDT-ACCESS-METHOD       PIC X.
  5023                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5024                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5025                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5026             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5027
  5028         16  CF-CLAIM-CALC-METHOD           PIC X.
  5029             88  360-PLUS-MONTHS                VALUE '1'.
  5030             88  365-PLUS-MONTHS                VALUE '2'.
  5031             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5032             88  360-DAILY                      VALUE '4'.
  5033             88  365-DAILY                      VALUE '5'.
  5034
  5035         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5036         16  FILLER                         PIC X(11).
  5037
  5038         16  CF-LIMIT-AMOUNTS.
  5039             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5040             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5041             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5042             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5043             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5044             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5045             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5046             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5047             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5048             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5049
  5050         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5051         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5052         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5053
  5054         16  CF-ZIP-CODE.
  5055             20  CF-ZIP-PRIME.
  5056                 24  CF-ZIP-1ST             PIC X.
  5057                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5058                 24  FILLER                 PIC X(4).
  5059             20  CF-ZIP-PLUS4               PIC X(4).
  5060         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5061             20  CF-CAN-POSTAL-1            PIC XXX.
  5062             20  CF-CAN-POSTAL-2            PIC XXX.
  5063             20  FILLER                     PIC XXX.
  5064
  5065         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5066         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5067         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5068
  5069         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  96
* EL156.cbl
  5070             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5071             88  CF-NO-RATING                   VALUE 'N'.
  5072
  5073         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5074
  5075         16  CF-CARRIER-OVER-SHORT.
  5076             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5077             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5078
  5079         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5080         16  CF-SECPAY-SWITCH               PIC X.
  5081             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5082             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5083         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5084         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5085         16  FILLER                         PIC X(444).
  5086*        16  FILLER                         PIC X(452).
  5087
  5088
  5089****************************************************************
  5090*             MORTALITY MASTER RECORD                          *
  5091****************************************************************
  5092
  5093     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5094         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5095                                INDEXED BY CF-MORT-NDX.
  5096             20  CF-MORT-TABLE              PIC X(5).
  5097             20  CF-MORT-TABLE-TYPE         PIC X.
  5098                 88  CF-MORT-JOINT              VALUE 'J'.
  5099                 88  CF-MORT-SINGLE             VALUE 'S'.
  5100                 88  CF-MORT-COMBINED           VALUE 'C'.
  5101                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5102                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5103             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5104             20  CF-MORT-AGE-METHOD         PIC XX.
  5105                 88  CF-AGE-LAST                VALUE 'AL'.
  5106                 88  CF-AGE-NEAR                VALUE 'AN'.
  5107             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5108             20  CF-MORT-ADJUSTMENT-DIRECTION
  5109                                            PIC X.
  5110                 88  CF-MINUS                   VALUE '-'.
  5111                 88  CF-PLUS                    VALUE '+'.
  5112             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5113             20  CF-MORT-JOINT-CODE         PIC X.
  5114                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5115             20  CF-MORT-PC-Q               PIC X.
  5116                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5117             20  CF-MORT-TABLE-CODE         PIC X(4).
  5118             20  CF-MORT-COMMENTS           PIC X(15).
  5119             20  FILLER                     PIC X(14).
  5120
  5121         16  FILLER                         PIC X(251).
  5122
  5123
  5124****************************************************************
  5125*             BUSSINESS TYPE MASTER RECORD                     *
  5126****************************************************************
  5127
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  97
* EL156.cbl
  5128     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5129* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5130* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5131* AND RECORD 05 IS TYPES 81-99
  5132         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5133             20  CF-BUSINESS-TITLE          PIC  X(19).
  5134             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5135                                            PIC S9V9(4) COMP-3.
  5136             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5137             20  FILLER                     PIC  X.
  5138         16  FILLER                         PIC  X(248).
  5139
  5140
  5141****************************************************************
  5142*             TERMINAL MASTER RECORD                           *
  5143****************************************************************
  5144
  5145     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5146
  5147         16  CF-COMPANY-TERMINALS.
  5148             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5149                                  PIC X(4).
  5150         16  FILLER               PIC X(248).
  5151
  5152
  5153****************************************************************
  5154*             LIFE EDIT MASTER RECORD                          *
  5155****************************************************************
  5156
  5157     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5158         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5159             20  CF-LIFE-CODE-IN            PIC XX.
  5160             20  CF-LIFE-CODE-OUT           PIC XX.
  5161         16  FILLER                         PIC X(248).
  5162
  5163
  5164****************************************************************
  5165*             AH EDIT MASTER RECORD                            *
  5166****************************************************************
  5167
  5168     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5169         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5170             20  CF-AH-CODE-IN              PIC XXX.
  5171             20  CF-AH-CODE-OUT             PIC XX.
  5172         16  FILLER                         PIC X(248).
  5173
  5174
  5175****************************************************************
  5176*             CREDIBILITY TABLES                               *
  5177****************************************************************
  5178
  5179     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5180         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5181                             INDEXED BY CF-CRDB-NDX.
  5182             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5183             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5184             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5185         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  98
* EL156.cbl
  5186
  5187
  5188****************************************************************
  5189*             REPORT CUSTOMIZATION RECORD                      *
  5190****************************************************************
  5191
  5192     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5193         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5194             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5195             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5196             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5197**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5198****       A T-TRANSFER.                                   ****
  5199             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5200
  5201         16  FILLER                         PIC XX.
  5202
  5203         16  CF-CARRIER-CNTL-OPT.
  5204             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5205                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5206                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5207             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5208                                            PIC X.
  5209         16  CF-GROUP-CNTL-OPT.
  5210             20  CF-GROUP-OPT-SEQ           PIC 9.
  5211                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5212                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5213             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5214                                            PIC X(6).
  5215         16  CF-STATE-CNTL-OPT.
  5216             20  CF-STATE-OPT-SEQ           PIC 9.
  5217                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5218                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5219             20  CF-STATE-SELECT OCCURS 3 TIMES
  5220                                            PIC XX.
  5221         16  CF-ACCOUNT-CNTL-OPT.
  5222             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5223                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5224                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5225             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5226                                            PIC X(10).
  5227         16  CF-BUS-TYP-CNTL-OPT.
  5228             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5229                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5230                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5231             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5232                                            PIC XX.
  5233         16  CF-LF-TYP-CNTL-OPT.
  5234             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5235                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5236                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5237             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5238                                            PIC XX.
  5239         16  CF-AH-TYP-CNTL-OPT.
  5240             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5241                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5242                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5243             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page  99
* EL156.cbl
  5244                                            PIC XX.
  5245         16  CF-REPTCD1-CNTL-OPT.
  5246             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5247                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5248                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5249             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5250                                            PIC X(10).
  5251         16  CF-REPTCD2-CNTL-OPT.
  5252             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5253                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5254                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5255             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5256                                            PIC X(10).
  5257         16  CF-USER1-CNTL-OPT.
  5258             20  CF-USER1-OPT-SEQ           PIC 9.
  5259                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5260                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5261             20  CF-USER1-SELECT OCCURS 3 TIMES
  5262                                            PIC X(10).
  5263         16  CF-USER2-CNTL-OPT.
  5264             20  CF-USER2-OPT-SEQ           PIC 9.
  5265                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5266                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5267             20  CF-USER2-SELECT OCCURS 3 TIMES
  5268                                            PIC X(10).
  5269         16  CF-USER3-CNTL-OPT.
  5270             20  CF-USER3-OPT-SEQ           PIC 9.
  5271                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5272                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5273             20  CF-USER3-SELECT OCCURS 3 TIMES
  5274                                            PIC X(10).
  5275         16  CF-USER4-CNTL-OPT.
  5276             20  CF-USER4-OPT-SEQ           PIC 9.
  5277                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5278                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5279             20  CF-USER4-SELECT OCCURS 3 TIMES
  5280                                            PIC X(10).
  5281         16  CF-USER5-CNTL-OPT.
  5282             20  CF-USER5-OPT-SEQ           PIC 9.
  5283                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5284                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5285             20  CF-USER5-SELECT OCCURS 3 TIMES
  5286                                            PIC X(10).
  5287         16  CF-REINS-CNTL-OPT.
  5288             20  CF-REINS-OPT-SEQ           PIC 9.
  5289                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5290                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5291             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5292                 24  CF-REINS-PRIME         PIC XXX.
  5293                 24  CF-REINS-SUB           PIC XXX.
  5294
  5295         16  CF-AGENT-CNTL-OPT.
  5296             20  CF-AGENT-OPT-SEQ           PIC 9.
  5297                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5298                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5299             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5300                                            PIC X(10).
  5301
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 100
* EL156.cbl
  5302         16  FILLER                         PIC X(43).
  5303
  5304         16  CF-LOSS-RATIO-SELECT.
  5305             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5306             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5307         16  CF-ENTRY-DATE-SELECT.
  5308             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5309             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5310         16  CF-EFFECTIVE-DATE-SELECT.
  5311             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5312             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5313
  5314         16  CF-EXCEPTION-LIST-IND          PIC X.
  5315             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5316
  5317         16  FILLER                         PIC X(318).
  5318
  5319****************************************************************
  5320*                  EXCEPTION REPORTING RECORD                  *
  5321****************************************************************
  5322
  5323     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5324         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5325             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5326
  5327         16  CF-COMBINED-LIFE-AH-OPT.
  5328             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5329             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5330             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5331             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5332
  5333         16  CF-LIFE-OPT.
  5334             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5335             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5336             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5337             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5338             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5339             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5340             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5341             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5342             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5343             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5344
  5345         16  CF-AH-OPT.
  5346             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5347             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5348             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5349             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5350             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5351             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5352             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5353             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5354             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5355             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5356
  5357         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5358             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5359             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 101
* EL156.cbl
  5360             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5361
  5362         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5363
  5364         16  FILLER                         PIC X(673).
  5365
  5366
  5367****************************************************************
  5368*             MORTGAGE SYSTEM PLAN RECORD                      *
  5369****************************************************************
  5370
  5371     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5372         16  CF-PLAN-TYPE                   PIC X.
  5373             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5374             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5375             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5376         16  CF-PLAN-ABBREV                 PIC XXX.
  5377         16  CF-PLAN-DESCRIPT               PIC X(10).
  5378         16  CF-PLAN-NOTES                  PIC X(20).
  5379         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5380         16  CF-PLAN-UNDERWRITING.
  5381             20  CF-PLAN-TERM-DATA.
  5382                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5383                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5384             20  CF-PLAN-AGE-DATA.
  5385                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5386                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5387                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5388             20  CF-PLAN-BENEFIT-DATA.
  5389                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5390                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5391                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5392                                            PIC S9(7)V99  COMP-3.
  5393         16  CF-PLAN-POLICY-FORMS.
  5394             20  CF-POLICY-FORM             PIC X(12).
  5395             20  CF-MASTER-APPLICATION      PIC X(12).
  5396             20  CF-MASTER-POLICY           PIC X(12).
  5397         16  CF-PLAN-RATING.
  5398             20  CF-RATE-CODE               PIC X(5).
  5399             20  CF-SEX-RATING              PIC X.
  5400                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5401                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5402             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5403             20  CF-SUB-STD-TYPE            PIC X.
  5404                 88  CF-PCT-OF-PREM            VALUE '1'.
  5405                 88  CF-PCT-OF-BENE            VALUE '2'.
  5406         16  CF-PLAN-PREM-TOLERANCES.
  5407             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5408             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5409         16  CF-PLAN-PYMT-TOLERANCES.
  5410             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5411             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5412         16  CF-PLAN-MISC-DATA.
  5413             20  FILLER                     PIC X.
  5414             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5415             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5416         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5417         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 102
* EL156.cbl
  5418             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5419                                                     '1'.
  5420             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5421                                                     '2'.
  5422         16  CF-MIB-SEARCH-SW               PIC X.
  5423             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5424             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5425             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5426             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5427         16  CF-ALPHA-SEARCH-SW             PIC X.
  5428             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5429             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5430             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5431             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5432             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5433             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5434             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5435             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5436             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5437             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5438                                                     'A' 'B' 'C'
  5439                                                     'X' 'Y' 'Z'.
  5440         16  CF-EFF-DT-RULE-SW              PIC X.
  5441             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5442             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5443             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5444             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5445             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5446         16  FILLER                         PIC X(4).
  5447         16  CF-HEALTH-QUESTIONS            PIC X.
  5448             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5449         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5450         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5451         16  CF-PLAN-SNGL-JNT               PIC X.
  5452             88  CF-COMBINED-PLAN              VALUE 'C'.
  5453             88  CF-JNT-PLAN                   VALUE 'J'.
  5454             88  CF-SNGL-PLAN                  VALUE 'S'.
  5455         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5456         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5457         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5458         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5459         16  CF-RERATE-CNTL                 PIC  X.
  5460             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5461             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5462             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5463             88  CF-AUTO-RECALC                 VALUE '4'.
  5464         16  CF-BENEFIT-TYPE                PIC  X.
  5465             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5466             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5467         16  CF-POLICY-FEE                  PIC S999V99
  5468                                                    COMP-3.
  5469         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5470         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5471         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5472         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5473         16  FILLER                         PIC  X(32).
  5474         16  CF-TERMINATION-FORM            PIC  X(04).
  5475         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 103
* EL156.cbl
  5476         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5477                                                       COMP-3.
  5478         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5479         16  CF-ISSUE-LETTER                PIC  X(4).
  5480         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5481         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5482             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5483             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5484         16  CF-MP-REFUND-CALC              PIC X.
  5485             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5486             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5487             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5488             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5489             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5490             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5491             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5492             88  CF-MP-REFD-MEAN                VALUE '8'.
  5493         16  CF-ALT-RATE-CODE               PIC  X(5).
  5494
  5495
  5496         16  FILLER                         PIC X(498).
  5497****************************************************************
  5498*             MORTGAGE COMPANY MASTER RECORD                   *
  5499****************************************************************
  5500
  5501     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5502         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5503         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5504             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5505             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5506             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5507             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5508             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5509
  5510         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5511         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5512         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5513         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5514         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5515
  5516         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5517             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5518         16  CF-MP-RECON-USE-IND            PIC X(1).
  5519             88  CF-MP-USE-RECON             VALUE 'Y'.
  5520         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5521             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5522         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5523             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5524             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5525         16  FILLER                         PIC X(1).
  5526         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5527             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5528         16  CF-MORTG-MIB-VERSION           PIC X.
  5529             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5530             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5531             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5532         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5533             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 104
* EL156.cbl
  5534                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5535             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5536                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5537             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5538                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5539             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5540                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5541             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5542                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5543             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5544                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5545         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5546         16  FILLER                         PIC X(7).
  5547         16  CF-MORTG-DESTINATION-SYMBOL.
  5548             20  CF-MORTG-MIB-COMM          PIC X(5).
  5549             20  CF-MORTG-MIB-TERM          PIC X(5).
  5550         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5551             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5552         16  FILLER                         PIC X(03).
  5553         16  CF-MP-CHECK-NO-CONTROL.
  5554             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5555                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5556                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5557                                                ' ' LOW-VALUES.
  5558                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5559                                               VALUE '3'.
  5560         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5561         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5562         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5563             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5564                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5565             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5566                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5567             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5568                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5569             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5570                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5571             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5572                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5573             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5574                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5575         16  CF-MORTG-BILLING-AREA.
  5576             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5577                                            PIC X.
  5578         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5579         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5580         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5581         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5582             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5583             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5584         16  FILLER                         PIC X.
  5585         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5586             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5587             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5588         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5589         16  FILLER                         PIC X(8).
  5590         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5591         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 105
* EL156.cbl
  5592         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5593         16  CF-ACH-COMPANY-ID.
  5594             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5595                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5596                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5597                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5598             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5599         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5600             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5601         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5602             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5603             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5604         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5605         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5606         16  FILLER                         PIC X(536).
  5607
  5608****************************************************************
  5609*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5610****************************************************************
  5611
  5612     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5613         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5614             20  CF-FEMALE-HEIGHT.
  5615                 24  CF-FEMALE-FT           PIC 99.
  5616                 24  CF-FEMALE-IN           PIC 99.
  5617             20  CF-FEMALE-MIN-WT           PIC 999.
  5618             20  CF-FEMALE-MAX-WT           PIC 999.
  5619         16  FILLER                         PIC X(428).
  5620
  5621     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5622         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5623             20  CF-MALE-HEIGHT.
  5624                 24  CF-MALE-FT             PIC 99.
  5625                 24  CF-MALE-IN             PIC 99.
  5626             20  CF-MALE-MIN-WT             PIC 999.
  5627             20  CF-MALE-MAX-WT             PIC 999.
  5628         16  FILLER                         PIC X(428).
  5629******************************************************************
  5630*             AUTOMATIC ACTIVITY RECORD                          *
  5631******************************************************************
  5632     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5633         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5634             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5635             20  CF-SYS-LETTER-ID           PIC X(04).
  5636             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5637             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5638             20  CF-SYS-RESET-SW            PIC X(01).
  5639             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5640             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5641
  5642         16  FILLER                         PIC X(50).
  5643
  5644         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5645             20  CF-USER-ACTIVE-SW          PIC X(01).
  5646             20  CF-USER-LETTER-ID          PIC X(04).
  5647             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5648             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5649             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 106
* EL156.cbl
  5650             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5651             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5652             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5653
  5654         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 107
* EL156.cbl
  5656*    COPY ELCCERT.
  5657******************************************************************
  5658*                                                                *
  5659*                            ELCCERT.                            *
  5660*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5661*                            VMOD=2.013                          *
  5662*                                                                *
  5663*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5664*                                                                *
  5665*   FILE TYPE = VSAM,KSDS                                        *
  5666*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5667*                                                                *
  5668*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5669*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5670*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5671*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5672*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5673*                                                                *
  5674*   LOG = YES                                                    *
  5675*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5676******************************************************************
  5677*                   C H A N G E   L O G
  5678*
  5679* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5680*-----------------------------------------------------------------
  5681*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5682* EFFECTIVE    NUMBER
  5683*-----------------------------------------------------------------
  5684* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5685* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5686* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5687* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5688* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5689* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5690* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5691* 032612  CR2011110200001  PEMA  AHL CHANGES
  5692* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5693* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5694******************************************************************
  5695
  5696 01  CERTIFICATE-MASTER.
  5697     12  CM-RECORD-ID                      PIC XX.
  5698         88  VALID-CM-ID                      VALUE 'CM'.
  5699
  5700     12  CM-CONTROL-PRIMARY.
  5701         16  CM-COMPANY-CD                 PIC X.
  5702         16  CM-CARRIER                    PIC X.
  5703         16  CM-GROUPING.
  5704             20  CM-GROUPING-PREFIX        PIC X(3).
  5705             20  CM-GROUPING-PRIME         PIC X(3).
  5706         16  CM-STATE                      PIC XX.
  5707         16  CM-ACCOUNT.
  5708             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5709             20  CM-ACCOUNT-PRIME          PIC X(6).
  5710         16  CM-CERT-EFF-DT                PIC XX.
  5711         16  CM-CERT-NO.
  5712             20  CM-CERT-PRIME             PIC X(10).
  5713             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 108
* EL156.cbl
  5714
  5715     12  CM-CONTROL-BY-NAME.
  5716         16  CM-COMPANY-CD-A1              PIC X.
  5717         16  CM-INSURED-LAST-NAME          PIC X(15).
  5718         16  CM-INSURED-INITIALS.
  5719             20  CM-INSURED-INITIAL1       PIC X.
  5720             20  CM-INSURED-INITIAL2       PIC X.
  5721
  5722     12  CM-CONTROL-BY-SSN.
  5723         16  CM-COMPANY-CD-A2              PIC X.
  5724         16  CM-SOC-SEC-NO.
  5725             20  CM-SSN-STATE              PIC XX.
  5726             20  CM-SSN-ACCOUNT            PIC X(6).
  5727             20  CM-SSN-LN3.
  5728                 25  CM-INSURED-INITIALS-A2.
  5729                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5730                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5731                 25 CM-PART-LAST-NAME-A2         PIC X.
  5732
  5733     12  CM-CONTROL-BY-CERT-NO.
  5734         16  CM-COMPANY-CD-A4              PIC X.
  5735         16  CM-CERT-NO-A4                 PIC X(11).
  5736
  5737     12  CM-CONTROL-BY-MEMB.
  5738         16  CM-COMPANY-CD-A5              PIC X.
  5739         16  CM-MEMBER-NO.
  5740             20  CM-MEMB-STATE             PIC XX.
  5741             20  CM-MEMB-ACCOUNT           PIC X(6).
  5742             20  CM-MEMB-LN4.
  5743                 25  CM-INSURED-INITIALS-A5.
  5744                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5745                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5746                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5747
  5748     12  CM-INSURED-PROFILE-DATA.
  5749         16  CM-INSURED-FIRST-NAME.
  5750             20  CM-INSURED-1ST-INIT       PIC X.
  5751             20  FILLER                    PIC X(9).
  5752         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5753         16  CM-INSURED-SEX                PIC X.
  5754             88  CM-SEX-MALE                  VALUE 'M'.
  5755             88  CM-SEX-FEMAL                 VALUE 'F'.
  5756         16  CM-INSURED-JOINT-AGE          PIC 99.
  5757         16  CM-JOINT-INSURED-NAME.
  5758             20  CM-JT-LAST-NAME           PIC X(15).
  5759             20  CM-JT-FIRST-NAME.
  5760                 24  CM-JT-1ST-INIT        PIC X.
  5761                 24  FILLER                PIC X(9).
  5762             20  CM-JT-INITIAL             PIC X.
  5763
  5764     12  CM-LIFE-DATA.
  5765         16  CM-LF-BENEFIT-CD              PIC XX.
  5766         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5767         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5768         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5769         16  CM-LF-DEV-CODE                PIC XXX.
  5770         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5771         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 109
* EL156.cbl
  5772         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5773         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5774         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5775         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5776         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5777         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5778         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5779         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5780         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5781         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5782         16  cm-temp-epiq                  pic xx.
  5783             88  EPIQ-CLASS                  value 'EQ'.
  5784*        16  FILLER                        PIC XX.
  5785
  5786     12  CM-AH-DATA.
  5787         16  CM-AH-BENEFIT-CD              PIC XX.
  5788         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5789         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5790         16  CM-AH-DEV-CODE                PIC XXX.
  5791         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5792         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5793         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5794         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5795         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5796         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5797         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5798         16  CM-AH-PAID-THRU-DT            PIC XX.
  5799             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5800         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5801         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5802         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5803         16  FILLER                        PIC X.
  5804
  5805     12  CM-LOAN-INFORMATION.
  5806         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5807         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5808                                           PIC S9(5)V99  COMP-3.
  5809         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5810         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5811         16  CM-PAY-FREQUENCY              PIC S99.
  5812         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5813         16  CM-RATE-CLASS                 PIC XX.
  5814         16  CM-BENEFICIARY                PIC X(25).
  5815         16  CM-POLICY-FORM-NO             PIC X(12).
  5816         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5817         16  CM-LAST-ADD-ON-DT             PIC XX.
  5818         16  CM-DEDUCTIBLE-AMOUNTS.
  5819             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5820             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5821         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5822             20  CM-RESIDENT-STATE         PIC XX.
  5823             20  CM-RATE-CODE              PIC X(4).
  5824             20  FILLER                    PIC XX.
  5825         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5826             20  CM-LOAN-OFFICER           PIC X(5).
  5827             20  FILLER                    PIC XXX.
  5828         16  CM-CSR-CODE                   PIC XXX.
  5829         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 110
* EL156.cbl
  5830             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5831         16  CM-POST-CARD-IND              PIC X.
  5832         16  CM-NH-INTERFACE-SW            PIC X.
  5833         16  CM-PREMIUM-TYPE               PIC X.
  5834             88  CM-SING-PRM                  VALUE '1'.
  5835             88  CM-O-B-COVERAGE              VALUE '2'.
  5836             88  CM-OPEN-END                  VALUE '3'.
  5837         16  CM-IND-GRP-TYPE               PIC X.
  5838             88  CM-INDIVIDUAL                VALUE 'I'.
  5839             88  CM-GROUP                     VALUE 'G'.
  5840         16  CM-SKIP-CODE                  PIC X.
  5841             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5842             88  SKIP-JULY                    VALUE '1'.
  5843             88  SKIP-AUGUST                  VALUE '2'.
  5844             88  SKIP-SEPTEMBER               VALUE '3'.
  5845             88  SKIP-JULY-AUG                VALUE '4'.
  5846             88  SKIP-AUG-SEPT                VALUE '5'.
  5847             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5848             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5849             88  SKIP-JUNE                    VALUE '8'.
  5850             88  SKIP-JUNE-JULY               VALUE '9'.
  5851             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5852             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5853         16  CM-PAYMENT-MODE               PIC X.
  5854             88  PAY-MONTHLY                  VALUE SPACE.
  5855             88  PAY-WEEKLY                   VALUE '1'.
  5856             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5857             88  PAY-BI-WEEKLY                VALUE '3'.
  5858             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5859         16  CM-LOAN-NUMBER                PIC X(8).
  5860         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5861         16  CM-OLD-LOF                    PIC XXX.
  5862*        16  CM-LOAN-OFFICER               PIC XXX.
  5863         16  CM-REIN-TABLE                 PIC XXX.
  5864         16  CM-SPECIAL-REIN-CODE          PIC X.
  5865         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5866         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5867         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5868
  5869     12  CM-STATUS-DATA.
  5870         16  CM-ENTRY-STATUS               PIC X.
  5871         16  CM-ENTRY-DT                   PIC XX.
  5872
  5873         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5874         16  CM-LF-CANCEL-DT               PIC XX.
  5875         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5876
  5877         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5878         16  CM-LF-DEATH-DT                PIC XX.
  5879         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5880
  5881         16  CM-LF-CURRENT-STATUS          PIC X.
  5882             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5883                                                'M' '4' '5' '9'.
  5884             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5885             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5886             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5887             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 111
* EL156.cbl
  5888             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5889             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5890             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5891             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5892             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5893             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5894             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5895             88  CM-LF-DECLINED               VALUE 'D'.
  5896             88  CM-LF-VOIDED                 VALUE 'V'.
  5897
  5898         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5899         16  CM-AH-CANCEL-DT               PIC XX.
  5900         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5901
  5902         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5903         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5904         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5905
  5906         16  CM-AH-CURRENT-STATUS          PIC X.
  5907             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5908                                                'M' '4' '5' '9'.
  5909             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5910             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5911             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5912             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5913             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5914             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5915             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5916             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5917             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5918             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5919             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5920             88  CM-AH-DECLINED               VALUE 'D'.
  5921             88  CM-AH-VOIDED                 VALUE 'V'.
  5922
  5923         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5924             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5925             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5926             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5927         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5928
  5929         16  CM-ENTRY-BATCH                PIC X(6).
  5930         16  CM-LF-EXIT-BATCH              PIC X(6).
  5931         16  CM-AH-EXIT-BATCH              PIC X(6).
  5932         16  CM-LAST-MONTH-END             PIC XX.
  5933
  5934     12  CM-NOTE-SW                        PIC X.
  5935         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5936         88  CERT-NOTES-PRESENT               VALUE '1'.
  5937         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5938         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5939         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5940         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5941         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5942         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5943     12  CM-COMP-EXCP-SW                   PIC X.
  5944         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5945         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 112
* EL156.cbl
  5946     12  CM-INSURED-ADDRESS-SW             PIC X.
  5947         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5948         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5949
  5950*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5951     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5952     12  FILLER                            PIC X.
  5953
  5954*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5955     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5956     12  FILLER                            PIC X.
  5957*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5958     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5959
  5960     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5961         88  CERT-ADDED-BATCH                 VALUE ' '.
  5962         88  CERT-ADDED-ONLINE                VALUE '1'.
  5963         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5964         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5965         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5966     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5967         88  CERT-AS-LOADED                   VALUE ' '.
  5968         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5969         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5970         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5971         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5972         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5973         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5974         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5975
  5976     12  CM-ACCOUNT-COMM-PCTS.
  5977         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5978         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5979
  5980     12  CM-USER-FIELD                     PIC X.
  5981     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5982     12  CM-CLP-STATE                      PIC XX.
  5983     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5984     12  CM-USER-RESERVED                  PIC XXX.
  5985     12  FILLER REDEFINES CM-USER-RESERVED.
  5986         16  CM-AH-CLASS-CD                PIC XX.
  5987         16  F                             PIC X.
  5988******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 113
* EL156.cbl
  5990*    COPY ELCTRLR.
  5991******************************************************************
  5992*                                                                *
  5993*                            ELCTRLR.                            *
  5994*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5995*                            VMOD=2.014                          *
  5996*                                                                *
  5997*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5998*                                                                *
  5999*   FILE TYPE = VSAM,KSDS                                        *
  6000*   RECORD SIZE = 200    RECFORM = FIXED                         *
  6001*                                                                *
  6002*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  6003*       ALTERNATE INDEX = NONE                                   *
  6004*                                                                *
  6005*   LOG = YES                                                    *
  6006*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6007******************************************************************
  6008*                   C H A N G E   L O G
  6009*
  6010* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6011*-----------------------------------------------------------------
  6012*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6013* EFFECTIVE    NUMBER
  6014*-----------------------------------------------------------------
  6015* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  6016* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  6017* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  6018* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  6019* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  6020* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  6021* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  6022* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  6023* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  6024* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  6025* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  6026* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  6027* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  6028* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  6029* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  6030* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6031* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  6032* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  6033* 040814    2014030500002  AJRA  ADD ICD CODES
  6034* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6035* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6036* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  6037******************************************************************
  6038 01  ACTIVITY-TRAILERS.
  6039     12  AT-RECORD-ID                    PIC XX.
  6040         88  VALID-AT-ID                       VALUE 'AT'.
  6041
  6042     12  AT-CONTROL-PRIMARY.
  6043         16  AT-COMPANY-CD               PIC X.
  6044         16  AT-CARRIER                  PIC X.
  6045         16  AT-CLAIM-NO                 PIC X(7).
  6046         16  AT-CERT-NO.
  6047             20  AT-CERT-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 114
* EL156.cbl
  6048             20  AT-CERT-SFX             PIC X.
  6049         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  6050             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  6051             88  AT-LAST-TRL-AVAIL            VALUE +100.
  6052             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  6053             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  6054             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  6055             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  6056             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  6057             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  6058             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  6059             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  6060             88  AT-DIAGNOSIS-TRL             VALUE +90.
  6061             88  AT-BENEFICIARY-TRL           VALUE +91.
  6062             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  6063             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  6064             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  6065             88  AT-ERROR-MSGS-TRL            VALUE +95.
  6066
  6067     12  AT-TRAILER-TYPE                 PIC X.
  6068         88  RESERVE-EXPENSE-TR               VALUE '1'.
  6069         88  PAYMENT-TR                       VALUE '2'.
  6070         88  AUTO-PAY-TR                      VALUE '3'.
  6071         88  CORRESPONDENCE-TR                VALUE '4'.
  6072         88  ADDRESS-TR                       VALUE '5'.
  6073         88  GENERAL-INFO-TR                  VALUE '6'.
  6074         88  AUTO-PROMPT-TR                   VALUE '7'.
  6075         88  DENIAL-TR                        VALUE '8'.
  6076         88  INCURRED-CHG-TR                  VALUE '9'.
  6077         88  FORM-CONTROL-TR                  VALUE 'A'.
  6078
  6079     12  AT-RECORDED-DT                  PIC XX.
  6080     12  AT-RECORDED-BY                  PIC X(4).
  6081     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6082
  6083     12  AT-TRAILER-BODY                 PIC X(165).
  6084
  6085     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6086         16  AT-RESERVE-CONTROLS.
  6087             20  AT-MANUAL-SW            PIC X.
  6088                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6089             20  AT-FUTURE-SW            PIC X.
  6090                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6091             20  AT-PTC-SW               PIC X.
  6092                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6093             20  AT-IBNR-SW              PIC X.
  6094                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6095             20  AT-PTC-LF-SW            PIC X.
  6096                 88  AT-LF-PTC-USED          VALUE '1'.
  6097             20  AT-CDT-ACCESS-METHOD    PIC X.
  6098                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6099                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6100                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6101             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6102         16  AT-LAST-COMPUTED-DT         PIC XX.
  6103         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6104         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6105         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 115
* EL156.cbl
  6106         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6107         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6108         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6109         16  AT-EXPENSE-CONTROLS.
  6110             20  AT-EXPENSE-METHOD       PIC X.
  6111                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6112                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6113                 88  PERCENT-OF-PMT           VALUE '3'.
  6114                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6115             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6116             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6117         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6118         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6119
  6120         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6121         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6122
  6123*        16  FILLER                      PIC X(53).
  6124         16  FILLER                      PIC X(47).
  6125
  6126         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6127         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6128
  6129         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6130             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6131             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6132*                    C = CLOSED
  6133*                    O = OPEN
  6134             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6135*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6136
  6137     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6138         16  AT-PAYMENT-TYPE             PIC X.
  6139             88  PARTIAL-PAYMENT                VALUE '1'.
  6140             88  FINAL-PAYMENT                  VALUE '2'.
  6141             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6142             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6143             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6144             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6145             88  VOIDED-PAYMENT                 VALUE '9'.
  6146             88  TRANSFER                       VALUE 'T'.
  6147             88  LIFE-INTEREST                  VALUE 'I'.
  6148
  6149         16  AT-CLAIM-TYPE               PIC X.
  6150             88  PAID-FOR-AH                    VALUE 'A'.
  6151             88  PAID-FOR-LIFE                  VALUE 'L'.
  6152             88  PAID-FOR-IUI                   VALUE 'I'.
  6153             88  PAID-FOR-GAP                   VALUE 'G'.
  6154             88  PAID-FOR-FAM                   VALUE 'F'.
  6155         16  AT-CLAIM-PREM-TYPE          PIC X.
  6156             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6157             88  AT-O-B-COVERAGE                VALUE '2'.
  6158             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6159         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6160         16  AT-CHECK-NO                 PIC X(7).
  6161         16  AT-PAID-FROM-DT             PIC XX.
  6162         16  AT-PAID-THRU-DT             PIC XX.
  6163         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 116
* EL156.cbl
  6164         16  AT-ACH-PAYMENT              PIC X.
  6165*        16  FILLER                      PIC X.
  6166         16  AT-PAYEES-NAME              PIC X(30).
  6167         16  AT-PAYMENT-ORIGIN           PIC X.
  6168             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6169             88  ONLINE-AUTO-PMT                VALUE '2'.
  6170             88  OFFLINE-PMT                    VALUE '3'.
  6171         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6172         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6173         16  AT-VOID-DATA.
  6174             20  AT-VOID-DT              PIC XX.
  6175*00144       20  AT-VOID-REASON          PIC X(30).
  6176             20  AT-VOID-REASON          PIC X(26).
  6177         16  AT-PMT-APPROVED-BY          PIC X(04).
  6178         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6179         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6180         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6181                                         PIC S99V9(5)  COMP-3.
  6182         16  AT-CREDIT-INTERFACE.
  6183             20  AT-PMT-SELECT-DT        PIC XX.
  6184                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6185             20  AT-PMT-ACCEPT-DT        PIC XX.
  6186                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6187             20  AT-VOID-SELECT-DT       PIC XX.
  6188                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6189             20  AT-VOID-ACCEPT-DT       PIC XX.
  6190                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6191
  6192         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6193                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6194                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6195         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6196
  6197         16  AT-FORCE-CONTROL            PIC X.
  6198             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6199         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6200         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6201         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6202         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6203         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6204         16  AT-BENEFIT-TYPE             PIC X.
  6205
  6206         16  AT-EXPENSE-TYPE             PIC X.
  6207         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6208
  6209         16  AT-PAYEE-TYPE-CD.
  6210             20  AT-PAYEE-TYPE           PIC X.
  6211                 88  INSURED-PAID           VALUE 'I'.
  6212                 88  BENEFICIARY-PAID       VALUE 'B'.
  6213                 88  ACCOUNT-PAID           VALUE 'A'.
  6214                 88  OTHER-1-PAID           VALUE 'O'.
  6215                 88  OTHER-2-PAID           VALUE 'Q'.
  6216                 88  DOCTOR-PAID            VALUE 'P'.
  6217                 88  EMPLOYER-PAID          VALUE 'E'.
  6218             20  AT-PAYEE-SEQ            PIC X.
  6219
  6220         16  AT-CASH-PAYMENT             PIC X.
  6221         16  AT-GROUPED-PAYMENT          PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 117
* EL156.cbl
  6222         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6223         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6224         16  AT-APPROVED-LEVEL           PIC X.
  6225         16  AT-VOID-TYPE                PIC X.
  6226             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6227             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6228         16  AT-AIG-UNEMP-IND            PIC X.
  6229             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6230         16  AT-ASSOCIATES               PIC X.
  6231             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6232             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6233
  6234         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6235         16  AT-CV-PMT-CODE              PIC X.
  6236             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6237             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6238             88  FULL-ADD-PAYMENT           VALUE '3'.
  6239             88  HALF-ADD-PAYMENT           VALUE '4'.
  6240             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6241             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6242             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6243             88  ADDL-PAYMENT               VALUE '8'.
  6244
  6245         16  AT-EOB-CODE1                PIC XXX.
  6246         16  AT-EOB-CODE2                PIC XXX.
  6247         16  AT-EOB-CODE3                PIC XXX.
  6248         16  FILLER REDEFINES AT-EOB-CODE3.
  6249             20  AT-PRINT-CLM-FORM       PIC X.
  6250             20  AT-PRINT-SURVEY         PIC X.
  6251             20  AT-SPECIAL-RELEASE      PIC X.
  6252         16  AT-EOB-CODE4                PIC XXX.
  6253         16  FILLER REDEFINES AT-EOB-CODE4.
  6254             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6255             20  FILLER                  PIC X.
  6256         16  AT-EOB-CODE5                PIC XXX.
  6257         16  FILLER REDEFINES AT-EOB-CODE5.
  6258             20  AT-PMT-PROOF-DT         PIC XX.
  6259             20  FILLER                  PIC X.
  6260
  6261         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6262             88  AT-PRINT-EOB            VALUE 'Y'.
  6263
  6264         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6265         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6266
  6267     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6268         16  AT-SCHEDULE-START-DT        PIC XX.
  6269         16  AT-SCHEDULE-END-DT          PIC XX.
  6270         16  AT-TERMINATED-DT            PIC XX.
  6271         16  AT-LAST-PMT-TYPE            PIC X.
  6272             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6273             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6274         16  AT-FIRST-PMT-DATA.
  6275             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6276             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6277             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6278         16  AT-REGULAR-PMT-DATA.
  6279             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 118
* EL156.cbl
  6280             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6281             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6282         16  AT-AUTO-PAYEE-CD.
  6283             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6284                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6285                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6286                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6287                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6288                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6289             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6290         16  AT-AUTO-PAY-DAY             PIC 99.
  6291         16  AT-AUTO-CASH                PIC X.
  6292             88  AT-CASH                      VALUE 'Y'.
  6293             88  AT-NON-CASH                  VALUE 'N'.
  6294*        16  FILLER                      PIC X(129).
  6295         16  AT-AUTO-END-LETTER          PIC X(4).
  6296         16  FILLER                      PIC X(125).
  6297
  6298         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6299         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6300
  6301     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6302         16  AT-LETTER-SENT-DT           PIC XX.
  6303         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6304         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6305         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6306         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6307         16  AT-LETTER-ORIGIN            PIC X.
  6308             88  ONLINE-CREATION              VALUE '1' '3'.
  6309             88  OFFLINE-CREATION             VALUE '2' '4'.
  6310             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6311             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6312         16  AT-STD-LETTER-FORM          PIC X(4).
  6313         16  AT-REASON-TEXT              PIC X(70).
  6314         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6315         16  AT-ADDRESEE-TYPE            PIC X.
  6316              88  INSURED-ADDRESEE            VALUE 'I'.
  6317              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6318              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6319              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6320              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6321              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6322              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6323         16  AT-ADDRESSEE-NAME           PIC X(30).
  6324         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6325         16  AT-RESEND-PRINT-DATE        PIC XX.
  6326         16  AT-CORR-SOL-UNSOL           PIC X.
  6327         16  AT-LETTER-PURGED-DT         PIC XX.
  6328*
  6329*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6330*
  6331         16  AT-CSO-REDEFINITION.
  6332             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6333             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6334             20  AT-LETTER-TO-BENE       PIC X(1).
  6335             20  AT-STOP-LETTER-DT       PIC X(2).
  6336             20  AT-AUTH-RCVD            PIC X(1).
  6337             20  FILLER                  PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 119
* EL156.cbl
  6338*             20  FILLER                  PIC X(27).
  6339             20  AT-CSO-LETTER-STATUS    PIC X.
  6340                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6341                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6342                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6343             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6344             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6345*
  6346*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6347*
  6348*        16  FILLER                      PIC X(26).
  6349*
  6350*        16  AT-DMD-BSR-CODE             PIC X.
  6351*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6352*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6353*
  6354*        16  AT-DMD-LETTER-STATUS        PIC X.
  6355*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6356*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6357*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6358*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6359*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6360
  6361         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6362         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6363
  6364     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6365         16  AT-ADDRESS-TYPE             PIC X.
  6366             88  INSURED-ADDRESS               VALUE 'I'.
  6367             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6368             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6369             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6370             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6371             88  OTHER-ADDRESS-1               VALUE 'O'.
  6372             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6373         16  AT-MAIL-TO-NAME             PIC X(30).
  6374         16  AT-ADDRESS-LINE-1           PIC X(30).
  6375         16  AT-ADDRESS-LINE-2           PIC X(30).
  6376         16  AT-CITY-STATE.
  6377             20  AT-CITY                 PIC X(28).
  6378             20  AT-STATE                PIC XX.
  6379         16  AT-ZIP.
  6380             20  AT-ZIP-CODE.
  6381                 24  AT-ZIP-1ST          PIC X.
  6382                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6383                 24  FILLER              PIC X(4).
  6384             20  AT-ZIP-PLUS4            PIC X(4).
  6385         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6386             20  AT-CAN-POSTAL-1         PIC XXX.
  6387             20  AT-CAN-POSTAL-2         PIC XXX.
  6388             20  FILLER                  PIC XXX.
  6389         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6390*         16  FILLER                      PIC X(23).
  6391         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6392         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6393         16  FILLER                      PIC X(13).
  6394         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6395         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 120
* EL156.cbl
  6396
  6397     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6398         16  AT-INFO-LINE-1              PIC X(60).
  6399         16  FILLER REDEFINES AT-INFO-LINE-1.
  6400             20  AT-NOTE-ERROR-NO OCCURS 15
  6401                                         PIC X(4).
  6402         16  AT-INFO-LINE-2              PIC X(60).
  6403         16  FILLER REDEFINES AT-INFO-LINE-2.
  6404             20  AT-ICD-CODE-1           PIC X(8).
  6405             20  AT-ICD-CODE-2           PIC X(8).
  6406             20  FILLER                  PIC X(44).
  6407         16  AT-INFO-TRAILER-TYPE        PIC X.
  6408             88  AT-ERRORS-NOTE          VALUE 'E'.
  6409             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6410             88  AT-CALL-NOTE            VALUE 'C'.
  6411             88  AT-MAINT-NOTE           VALUE 'M'.
  6412             88  AT-CERT-CHANGE          VALUE 'X'.
  6413             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6414             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6415             88  AT-CERT-CANCELLED       VALUE 'T'.
  6416         16  AT-CALL-TYPE                PIC X.
  6417             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6418             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6419         16  AT-NOTE-CONTINUATION        PIC X.
  6420             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6421         16  AT-EOB-CODES-EXIST          PIC X.
  6422             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6423         16  FILLER                      PIC X(35).
  6424         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6425         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6426
  6427     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6428         16  AT-PROMPT-LINE-1            PIC X(60).
  6429         16  AT-PROMPT-LINE-2            PIC X(60).
  6430         16  AT-PROMPT-START-DT          PIC XX.
  6431         16  AT-PROMPT-END-DT            PIC XX.
  6432         16  FILLER                      PIC X(35).
  6433         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6434         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6435
  6436     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6437         16  AT-DENIAL-INFO-1            PIC X(60).
  6438         16  AT-DENIAL-INFO-2            PIC X(60).
  6439         16  AT-DENIAL-DT                PIC XX.
  6440         16  AT-RETRACTION-DT            PIC XX.
  6441         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6442*         16  FILLER                      PIC X(31).
  6443         16  AT-DENIAL-PROOF-DT          PIC XX.
  6444         16  FILLER                      PIC X(29).
  6445         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6446         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6447
  6448     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6449         16  AT-OLD-INCURRED-DT          PIC XX.
  6450         16  AT-OLD-REPORTED-DT          PIC XX.
  6451         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6452         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6453         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 121
* EL156.cbl
  6454         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6455         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6456         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6457         16  FILLER                      PIC X(26).
  6458         16  AT-OLD-DIAG-CODE            PIC X(6).
  6459         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6460         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6461         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6462         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6463         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6464         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6465         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6466         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6467         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6468         16  FILLER                      PIC X(9).
  6469         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6470
  6471     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6472         16  AT-FORM-SEND-ON-DT          PIC XX.
  6473         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6474         16  AT-FORM-RE-SEND-DT          PIC XX.
  6475         16  AT-FORM-ANSWERED-DT         PIC XX.
  6476         16  AT-FORM-PRINTED-DT          PIC XX.
  6477         16  AT-FORM-REPRINT-DT          PIC XX.
  6478         16  AT-FORM-TYPE                PIC X.
  6479             88  INITIAL-FORM                  VALUE '1'.
  6480             88  PROGRESS-FORM                 VALUE '2'.
  6481         16  AT-INSTRUCT-LN-1            PIC X(28).
  6482         16  AT-INSTRUCT-LN-2            PIC X(28).
  6483         16  AT-INSTRUCT-LN-3            PIC X(28).
  6484         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6485         16  AT-FORM-ADDRESS             PIC X.
  6486             88  FORM-TO-INSURED              VALUE 'I'.
  6487             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6488             88  FORM-TO-OTHER-1              VALUE 'O'.
  6489             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6490         16  AT-RELATED-1.
  6491             20 AT-REL-CARR-1            PIC X.
  6492             20 AT-REL-CLAIM-1           PIC X(7).
  6493             20 AT-REL-CERT-1            PIC X(11).
  6494         16  AT-RELATED-2.
  6495             20 AT-REL-CARR-2            PIC X.
  6496             20 AT-REL-CLAIM-2           PIC X(7).
  6497             20 AT-REL-CERT-2            PIC X(11).
  6498         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6499         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6500         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6501         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6502         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6503         16  AT-STOP-FORM-DT             PIC X(2).
  6504
  6505         16  FILLER                      PIC X(09).
  6506         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6507         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6508******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 122
* EL156.cbl
  6510*    COPY ELCACTQ.
  6511******************************************************************
  6512*                                                                *
  6513*                            ELCACTQ.                            *
  6514*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6515*                            VMOD=2.004                          *
  6516*                                                                *
  6517*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6518*                                                                *
  6519*   FILE TYPE = VSAM,KSDS                                        *
  6520*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6521*                                                                *
  6522*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6523*       ALTERNATE INDEX = NONE                                   *
  6524*                                                                *
  6525*   LOG = YES                                                    *
  6526*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6527*                                                                *
  6528*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6529******************************************************************
  6530
  6531 01  ACTIVITY-QUE.
  6532     12  AQ-RECORD-ID                PIC XX.
  6533         88  VALID-AQ-ID                VALUE 'AQ'.
  6534
  6535     12  AQ-CONTROL-PRIMARY.
  6536         16  AQ-COMPANY-CD           PIC X.
  6537         16  AQ-CARRIER              PIC X.
  6538         16  AQ-CLAIM-NO             PIC X(7).
  6539         16  AQ-CERT-NO.
  6540             20  AQ-CERT-PRIME       PIC X(10).
  6541             20  AQ-CERT-SFX         PIC X.
  6542
  6543     12  AQ-PENDING-ACTIVITY-FLAGS.
  6544         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6545         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6546             88  PENDING-PAYMENTS       VALUE '1'.
  6547         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6548             88  PENDING-FULL-PRINT     VALUE '1'.
  6549             88  PENDING-PART-PRINT     VALUE '2'.
  6550         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6551             88  PENDING-LETTERS        VALUE '1'.
  6552         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6553             88  PENDING-RESTORE        VALUE 'C'.
  6554             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6555
  6556     12  FILLER                      PIC X(20).
  6557
  6558     12  AQ-RESEND-DATE              PIC XX.
  6559     12  AQ-FOLLOWUP-DATE            PIC XX.
  6560     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6561     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6562     12  AQ-AUTO-LETTER              PIC X(4).
  6563     12  FILLER                      PIC XX.
  6564     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6565*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 123
* EL156.cbl
  6567*    COPY ERCACCT.
  6568******************************************************************
  6569*                                                                *
  6570*                                                                *
  6571*                            ERCACCT                             *
  6572*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6573*                            VMOD=2.031                          *
  6574*                                                                *
  6575*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6576*                                                                *
  6577*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6578*   VSAM ACCOUNT MASTER FILES.                                   *
  6579*                                                                *
  6580*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6581*                                                                *
  6582*   FILE TYPE = VSAM,KSDS                                        *
  6583*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6584*                                                                *
  6585*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6586*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6587*                                                                *
  6588*   LOG = NO                                                     *
  6589*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6590*                                                                *
  6591*                                                                *
  6592******************************************************************
  6593*                   C H A N G E   L O G
  6594*
  6595* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6596*-----------------------------------------------------------------
  6597*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6598* EFFECTIVE    NUMBER
  6599*-----------------------------------------------------------------
  6600* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6601* 092705    2005050300006  PEMA  ADD SPP LEASES
  6602* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6603* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6604* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6605* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6606* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6607* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  6608******************************************************************
  6609
  6610 01  ACCOUNT-MASTER.
  6611     12  AM-RECORD-ID                      PIC XX.
  6612         88  VALID-AM-ID                      VALUE 'AM'.
  6613
  6614     12  AM-CONTROL-PRIMARY.
  6615         16  AM-COMPANY-CD                 PIC X.
  6616         16  AM-MSTR-CNTRL.
  6617             20  AM-CONTROL-A.
  6618                 24  AM-CARRIER            PIC X.
  6619                 24  AM-GROUPING.
  6620                     28 AM-GROUPING-PREFIX PIC XXX.
  6621                     28 AM-GROUPING-PRIME  PIC XXX.
  6622                 24  AM-STATE              PIC XX.
  6623                 24  AM-ACCOUNT.
  6624                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 124
* EL156.cbl
  6625                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6626             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6627                                           PIC X(19).
  6628             20  AM-CNTRL-B.
  6629                 24  AM-EXPIRATION-DT      PIC XX.
  6630                 24  FILLER                PIC X(4).
  6631             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6632                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6633
  6634     12  AM-CONTROL-BY-VAR-GRP.
  6635         16  AM-COMPANY-CD-A1              PIC X.
  6636         16  AM-VG-CARRIER                 PIC X.
  6637         16  AM-VG-GROUPING                PIC X(6).
  6638         16  AM-VG-STATE                   PIC XX.
  6639         16  AM-VG-ACCOUNT                 PIC X(10).
  6640         16  AM-VG-DATE.
  6641             20  AM-VG-EXPIRATION-DT       PIC XX.
  6642             20  FILLER                    PIC X(4).
  6643         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6644                                           PIC 9(11)      COMP-3.
  6645     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6646         16  FILLER                        PIC X(10).
  6647         16  AM-VG-KEY3.
  6648             20  AM-VG3-ACCOUNT            PIC X(10).
  6649             20  AM-VG3-EXP-DT             PIC XX.
  6650         16  FILLER                        PIC X(4).
  6651     12  AM-MAINT-INFORMATION.
  6652         16  AM-LAST-MAINT-DT              PIC XX.
  6653         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6654         16  AM-LAST-MAINT-USER            PIC X(4).
  6655         16  FILLER                        PIC XX.
  6656
  6657     12  AM-EFFECTIVE-DT                   PIC XX.
  6658     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6659
  6660     12  AM-PREV-DATES  COMP-3.
  6661         16  AM-PREV-EXP-DT                PIC 9(11).
  6662         16  AM-PREV-EFF-DT                PIC 9(11).
  6663
  6664     12  AM-REPORT-CODE-1                  PIC X(10).
  6665     12  AM-REPORT-CODE-2                  PIC X(10).
  6666
  6667     12  AM-CITY-CODE                      PIC X(4).
  6668     12  AM-COUNTY-PARISH                  PIC X(6).
  6669
  6670     12  AM-NAME                           PIC X(30).
  6671     12  AM-PERSON                         PIC X(30).
  6672     12  AM-ADDRS                          PIC X(30).
  6673     12  AM-CITY.
  6674         16  AM-ADDR-CITY                  PIC X(28).
  6675         16  AM-ADDR-STATE                 PIC XX.
  6676     12  AM-ZIP.
  6677         16  AM-ZIP-PRIME.
  6678             20  AM-ZIP-PRI-1ST            PIC X.
  6679                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6680             20  FILLER                    PIC X(4).
  6681         16  AM-ZIP-PLUS4                  PIC X(4).
  6682     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 125
* EL156.cbl
  6683         16  AM-CAN-POSTAL-1               PIC XXX.
  6684         16  AM-CAN-POSTAL-2               PIC XXX.
  6685         16  FILLER                        PIC XXX.
  6686     12  AM-TEL-NO.
  6687         16  AM-AREA-CODE                  PIC 999.
  6688         16  AM-TEL-PRE                    PIC 999.
  6689         16  AM-TEL-NBR                    PIC 9(4).
  6690     12  AM-TEL-LOC                        PIC X.
  6691         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6692         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6693
  6694     12  AM-COMM-STRUCTURE.
  6695         16  AM-DEFN-1.
  6696             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6697                 24  AM-AGT.
  6698                     28  AM-AGT-PREFIX     PIC X(4).
  6699                     28  AM-AGT-PRIME      PIC X(6).
  6700                 24  AM-COM-TYP            PIC X.
  6701                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6702                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6703                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6704                 24  AM-RECALC-LV-INDIC    PIC X.
  6705                 24  AM-RETRO-LV-INDIC     PIC X.
  6706                 24  AM-GL-CODES           PIC X.
  6707                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6708                 24  FILLER                PIC X(01).
  6709         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6710             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6711                 24  FILLER                PIC X(11).
  6712                 24  AM-L-COMA             PIC XXX.
  6713                 24  AM-J-COMA             PIC XXX.
  6714                 24  AM-A-COMA             PIC XXX.
  6715                 24  FILLER                PIC X(6).
  6716
  6717     12  AM-COMM-CHANGE-STATUS             PIC X.
  6718         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6719
  6720     12  AM-CSR-CODE                       PIC X(4).
  6721
  6722     12  AM-BILLING-STATUS                 PIC X.
  6723         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6724         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6725     12  AM-AUTO-REFUND-SW                 PIC X.
  6726         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6727         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6728     12  AM-GPCD                           PIC 99.
  6729     12  AM-IG                             PIC X.
  6730         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6731         88  AM-HAS-GROUP                     VALUE '2'.
  6732     12  AM-STATUS                         PIC X.
  6733         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6734         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6735         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6736         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6737         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6738         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6739         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  6740         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 126
* EL156.cbl
  6741         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  6742         88  AM-ACCOUNT-PENDING               VALUE '9'.
  6743     12  AM-REMIT-TO                       PIC 99.
  6744     12  AM-ID-NO                          PIC X(11).
  6745
  6746     12  AM-CAL-TABLE                      PIC XX.
  6747     12  AM-LF-DEVIATION                   PIC XXX.
  6748     12  AM-AH-DEVIATION                   PIC XXX.
  6749     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6750     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6751     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6752     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6753     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6754     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6755
  6756     12  AM-USER-FIELDS.
  6757         16  AM-FLD-1                      PIC XX.
  6758         16  AM-FLD-2                      PIC XX.
  6759         16  AM-FLD-3                      PIC XX.
  6760         16  AM-FLD-4                      PIC XX.
  6761         16  AM-FLD-5                      PIC XX.
  6762
  6763     12  AM-1ST-PROD-DATE.
  6764         16  AM-1ST-PROD-YR                PIC XX.
  6765         16  AM-1ST-PROD-MO                PIC XX.
  6766         16  AM-1ST-PROD-DA                PIC XX.
  6767     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6768     12  AM-CERTS-PURGED-DATE.
  6769         16  AM-PUR-YR                     PIC XX.
  6770         16  AM-PUR-MO                     PIC XX.
  6771         16  AM-PUR-DA                     PIC XX.
  6772     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6773     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6774     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6775     12  AM-INACTIVE-DATE.
  6776         16  AM-INA-MO                     PIC 99.
  6777         16  AM-INA-DA                     PIC 99.
  6778         16  AM-INA-YR                     PIC 99.
  6779     12  AM-AR-HI-CERT-DATE                PIC XX.
  6780
  6781     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6782     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6783
  6784     12  AM-OB-PAYMENT-MODE                PIC X.
  6785         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6786         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6787         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6788         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6789
  6790     12  AM-AH-ONLY-INDICATOR              PIC X.
  6791         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6792         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6793
  6794     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6795
  6796     12  AM-OVER-SHORT.
  6797         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6798         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 127
* EL156.cbl
  6799
  6800     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6801     12  AM-DCC-CLP-STATE                  PIC XX.
  6802
  6803     12  AM-RECALC-COMM                    PIC X.
  6804     12  AM-RECALC-REIN                    PIC X.
  6805
  6806     12  AM-REI-TABLE                      PIC XXX.
  6807     12  AM-REI-ET-LF                      PIC X.
  6808     12  AM-REI-ET-AH                      PIC X.
  6809     12  AM-REI-PE-LF                      PIC X.
  6810     12  AM-REI-PE-AH                      PIC X.
  6811     12  AM-REI-PRT-ST                     PIC X.
  6812     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6813     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6814     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6815     12  AM-REI-GROUP-A                    PIC X(6).
  6816     12  AM-REI-MORT                       PIC X(4).
  6817     12  AM-REI-PRT-OW                     PIC X.
  6818     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6819     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6820     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6821     12  AM-REI-GROUP-B                    PIC X(6).
  6822
  6823     12  AM-TRUST-TYPE                     PIC X(2).
  6824
  6825     12  AM-EMPLOYER-STMT-USED             PIC X.
  6826     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6827
  6828     12  AM-STD-AH-TYPE                    PIC XX.
  6829     12  AM-EARN-METHODS.
  6830         16  AM-EARN-METHOD-R              PIC X.
  6831             88 AM-REF-RL-R78                 VALUE 'R'.
  6832             88 AM-REF-RL-PR                  VALUE 'P'.
  6833             88 AM-REF-RL-MEAN                VALUE 'M'.
  6834             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6835         16  AM-EARN-METHOD-L              PIC X.
  6836             88 AM-REF-LL-R78                 VALUE 'R'.
  6837             88 AM-REF-LL-PR                  VALUE 'P'.
  6838             88 AM-REF-LL-MEAN                VALUE 'M'.
  6839             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6840         16  AM-EARN-METHOD-A              PIC X.
  6841             88 AM-REF-AH-R78                 VALUE 'R'.
  6842             88 AM-REF-AH-PR                  VALUE 'P'.
  6843             88 AM-REF-AH-MEAN                VALUE 'M'.
  6844             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6845             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6846             88 AM-REF-AH-NET                 VALUE 'N'.
  6847
  6848     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6849     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6850     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6851
  6852     12  AM-RET-Y-N                        PIC X.
  6853     12  AM-RET-P-E                        PIC X.
  6854     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6855     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6856     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 128
* EL156.cbl
  6857     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6858         16  AM-POOL-PRIME                 PIC XXX.
  6859         16  AM-POOL-SUB                   PIC XXX.
  6860     12  AM-RETRO-EARNINGS.
  6861         16  AM-RET-EARN-R                 PIC X.
  6862         16  AM-RET-EARN-L                 PIC X.
  6863         16  AM-RET-EARN-A                 PIC X.
  6864     12  AM-RET-ST-TAX-USE                 PIC X.
  6865         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6866         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6867     12  AM-RETRO-BEG-EARNINGS.
  6868         16  AM-RET-BEG-EARN-R             PIC X.
  6869         16  AM-RET-BEG-EARN-L             PIC X.
  6870         16  AM-RET-BEG-EARN-A             PIC X.
  6871     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6872     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6873
  6874     12  AM-USER-SELECT-OPTIONS.
  6875         16  AM-USER-SELECT-1              PIC X(10).
  6876         16  AM-USER-SELECT-2              PIC X(10).
  6877         16  AM-USER-SELECT-3              PIC X(10).
  6878         16  AM-USER-SELECT-4              PIC X(10).
  6879         16  AM-USER-SELECT-5              PIC X(10).
  6880
  6881     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6882
  6883     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6884
  6885     12  AM-RPT045A-SWITCH                 PIC X.
  6886         88  RPT045A-OFF                   VALUE 'N'.
  6887
  6888     12  AM-INSURANCE-LIMITS.
  6889         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6890         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6891
  6892     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6893         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6894
  6895     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6896         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6897         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6898
  6899     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6900
  6901     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6902     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6903     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6904     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6905     12  AM-DCC-UEF-STATE                  PIC XX.
  6906     12  FILLER                            PIC XXX.
  6907     12  AM-REPORT-CODE-3                  PIC X(10).
  6908*    12  FILLER                            PIC X(22).
  6909
  6910     12  AM-RESERVE-DATE.
  6911         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6912         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6913         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6914
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 129
* EL156.cbl
  6915     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6916     12  AM-NOTIFICATION-TYPES.
  6917         16  AM-NOTIF-OF-LETTERS           PIC X.
  6918         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6919         16  AM-NOTIF-OF-REPORTS           PIC X.
  6920         16  AM-NOTIF-OF-STATUS            PIC X.
  6921
  6922     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6923         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6924         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6925         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6926         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6927
  6928     12  AM-BENEFIT-CONTROLS.
  6929         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6930             20  AM-BENEFIT-CODE           PIC XX.
  6931             20  AM-BENEFIT-TYPE           PIC X.
  6932             20  AM-BENEFIT-REVISION       PIC XXX.
  6933             20  AM-BENEFIT-REM-TERM       PIC X.
  6934             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6935             20  FILLER                    PIC XX.
  6936         16  FILLER                        PIC X(80).
  6937
  6938     12  AM-TRANSFER-DATA.
  6939         16  AM-TRANSFERRED-FROM.
  6940             20  AM-TRNFROM-CARRIER        PIC X.
  6941             20  AM-TRNFROM-GROUPING.
  6942                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6943                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6944             20  AM-TRNFROM-STATE          PIC XX.
  6945             20  AM-TRNFROM-ACCOUNT.
  6946                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6947                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6948             20  AM-TRNFROM-DTE            PIC XX.
  6949         16  AM-TRANSFERRED-TO.
  6950             20  AM-TRNTO-CARRIER          PIC X.
  6951             20  AM-TRNTO-GROUPING.
  6952                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6953                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6954             20  AM-TRNTO-STATE            PIC XX.
  6955             20  AM-TRNTO-ACCOUNT.
  6956                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6957                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6958             20  AM-TRNTO-DTE              PIC XX.
  6959         16  FILLER                        PIC X(10).
  6960
  6961     12  AM-SAVED-REMIT-TO                 PIC 99.
  6962
  6963     12  AM-COMM-STRUCTURE-SAVED.
  6964         16  AM-DEFN-1-SAVED.
  6965             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6966                 24  AM-AGT-SV             PIC X(10).
  6967                 24  AM-COM-TYP-SV         PIC X.
  6968                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6969                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6970                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6971                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6972                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 130
* EL156.cbl
  6973                 24  AM-GL-CODES-SV        PIC X.
  6974                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6975                 24  FILLER                PIC X.
  6976         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6977             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6978                 24  FILLER                PIC X(11).
  6979                 24  AM-L-COMA-SV          PIC XXX.
  6980                 24  AM-J-COMA-SV          PIC XXX.
  6981                 24  AM-A-COMA-SV          PIC XXX.
  6982                 24  FILLER                PIC X(6).
  6983
  6984     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6985         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6986            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6987            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6988            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6989
  6990     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6991     12  FILLER                            PIC X(120).
  6992
  6993     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6994         16  AM-CONTROL-NAME               PIC X(30).
  6995         16  AM-EXECUTIVE-ONE.
  6996             20  AM-EXEC1-NAME             PIC X(15).
  6997             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6998                                                          COMP-3.
  6999             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  7000                                                          COMP-3.
  7001         16  AM-EXECUTIVE-TWO.
  7002             20  AM-EXEC2-NAME             PIC X(15).
  7003             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  7004                                                          COMP-3.
  7005             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  7006                                                          COMP-3.
  7007
  7008     12  AM-RETRO-ADDITIONAL-DATA.
  7009         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  7010         16  AM-RETRO-PREM-P-E             PIC X.
  7011         16  AM-RETRO-CLMS-P-I             PIC X.
  7012         16  AM-RETRO-RET-BRACKET-LF.
  7013             20  AM-RETRO-RET-METHOD-LF    PIC X.
  7014                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  7015                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  7016             20  AM-RETRO-RET-BASIS-LF     PIC X.
  7017                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  7018                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  7019             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  7020                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  7021                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  7022         16  AM-RETRO-RET-BRACKET-AH.
  7023             20  AM-RETRO-RET-METHOD-AH    PIC X.
  7024                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  7025                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  7026                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  7027             20  AM-RETRO-RET-BASIS-AH     PIC X.
  7028                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  7029                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  7030             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 131
* EL156.cbl
  7031                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  7032                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  7033
  7034     12  AM-COMMENTS.
  7035         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  7036
  7037     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  7038         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  7039         16  AM-FLI-BILLING-CODE           PIC X.
  7040         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  7041         16  AM-FLI-UNITED-IDENT           PIC X.
  7042         16  AM-FLI-INTEREST-LOST-DATA.
  7043             20  AM-FLI-BANK-NO            PIC X(5).
  7044             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  7045             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  7046             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  7047         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  7048             20  AM-FLI-AGT                PIC X(9).
  7049             20  AM-FLI-AGT-COMM-ACC       PIC X.
  7050             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  7051         16  FILLER                        PIC X(102).
  7052
  7053     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  7054         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7055             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7056             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7057             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7058             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7059             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7060         16  FILLER                          PIC X(10).
  7061******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 132
* EL156.cbl
  7063*    COPY ELCCHKQ.
  7064******************************************************************
  7065*                                                                *
  7066*                                                                *
  7067*                            ELCCHKQ.                            *
  7068*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7069*                            VMOD=2.007                          *
  7070*                                                                *
  7071*   FILE DESCRIPTION = CHECK QUE FILE                            *
  7072*                                                                *
  7073*   FILE TYPE = VSAM,KSDS                                        *
  7074*   RECORD SIZE = 100  RECFORM = FIXED                           *
  7075*                                                                *
  7076*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  7077*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  7078*                                                                *
  7079*   LOG = YES                                                    *
  7080*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7081******************************************************************
  7082 01  CHECK-QUE.
  7083     12  CQ-RECORD-ID                PIC XX.
  7084         88  VALID-CQ-ID         VALUE 'CQ'.
  7085
  7086     12  CQ-CONTROL-PRIMARY.
  7087         16  CQ-COMPANY-CD           PIC X.
  7088         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7089         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7090
  7091     12  CQ-CONTROL-BY-PAYEE.
  7092         16  CQ-CONTROL-BY-NUMBER.
  7093             20  CQ-COMPANY-CD-A1     PIC X.
  7094             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7095         16  CQ-PAYEE-CARRIER        PIC X.
  7096         16  CQ-PAYEE-GROUPING       PIC X(6).
  7097         16  CQ-PAYEE-STATE          PIC XX.
  7098         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7099         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7100
  7101     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7102         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7103         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7104         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7105         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7106         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7107         16  FILLER                  PIC X(3).
  7108
  7109     12  CQ-ENTRY-TYPE               PIC X.
  7110             88  CHECK-ON-QUE           VALUE 'Q'.
  7111             88  ALIGNMENT-CHECK        VALUE 'A'.
  7112             88  SPOILED-CHECK          VALUE 'S'.
  7113             88  PAYMENT-ABORTED        VALUE 'X'.
  7114
  7115     12  CQ-CLAIM-MAST-CNTL.
  7116         16  CQ-CARRIER              PIC X.
  7117         16  CQ-CLAIM-NO             PIC X(7).
  7118         16  CQ-CERT-NO.
  7119             20  CQ-CERT-PRIME       PIC X(10).
  7120             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 133
* EL156.cbl
  7121         16  CQ-CLAIM-TYPE           PIC X.
  7122             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7123             88  CQ-AH-CLAIM            VALUE 'A'.
  7124         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7125             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7126             88  CQ-O-B-COVERAGE        VALUE '2'.
  7127             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7128
  7129     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7130     12  CQ-CHECK-NUMBER             PIC X(7).
  7131     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7132     12  CQ-PAYMENT-TYPE             PIC X.
  7133             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7134             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7135             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7136             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7137             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7138             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7139             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7140             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7141     12  CQ-VOID-INDICATOR           PIC X.
  7142             88  CHECK-IS-STOPPED          VALUE 'S'.
  7143             88  CHECK-IS-VOID             VALUE 'V'.
  7144     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7145     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7146     12  CQ-CHECK-BY-USER            PIC X(4).
  7147     12  CQ-PRE-NUMBERING-SW         PIC X.
  7148       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7149       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7150
  7151     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7152     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7153     12  CQ-LEDGER-FLAG              PIC X(01).
  7154     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7155     12  CQ-LAST-UPDATED-DT          PIC XX.
  7156     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7157     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7158
  7159     12  FILLER                      PIC X(04).
  7160
  7161******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 134
* EL156.cbl
  7163*    COPY ELCBENE.
  7164******************************************************************
  7165*                                                                *
  7166*                            ELCBENE.                            *
  7167*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7168*                            VMOD=2.006                          *
  7169*                                                                *
  7170*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7171*                                                                *
  7172*   FILE TYPE = VSAM,KSDS                                        *
  7173*   RECORD SIZE = 500   RECFORM = FIX                            *
  7174*                                                                *
  7175*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7176*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7177*                                                                *
  7178*   LOG = YES                                                    *
  7179*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7180*                                                                *
  7181*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7182******************************************************************
  7183*                   C H A N G E   L O G
  7184*
  7185* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7186*-----------------------------------------------------------------
  7187*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7188* EFFECTIVE    NUMBER
  7189*-----------------------------------------------------------------
  7190* 013017  CR2016053100001  PEMA  ACH PROCESSING
  7191* 082317  CR2017082100003  PEMA  Add sub type
  7192******************************************************************
  7193
  7194 01  BENEFICIARY-MASTER.
  7195     12  BE-RECORD-ID                PIC XX.
  7196         88  VALID-BE-ID                VALUE 'BE'.
  7197
  7198     12  BE-CONTROL-PRIMARY.
  7199         16  BE-COMPANY-CD           PIC X.
  7200         16  BE-RECORD-TYPE          PIC X.
  7201             88  BENEFICIARY-RECORD  VALUE 'B'.
  7202             88  ADJUSTOR-RECORD     VALUE 'A'.
  7203         16  BE-BENEFICIARY          PIC X(10).
  7204     12  BE-CONTROL-BY-NAME.
  7205         16  BE-COMPANY-CD-A1        PIC X.
  7206         16  BE-RECORD-TYPE-A1       PIC X.
  7207         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7208         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7209
  7210     12  BE-LAST-MAINT-DT            PIC XX.
  7211     12  BE-LAST-MAINT-BY            PIC X(4).
  7212     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7213
  7214     12  BE-ADDRESS-DATA.
  7215         16  BE-MAIL-TO-NAME         PIC X(30).
  7216         16  BE-ADDRESS-LINE-1       PIC X(30).
  7217         16  BE-ADDRESS-LINE-2       PIC X(30).
  7218         16  BE-ADDRESS-LINE-3       PIC X(30).
  7219         16  BE-CITY-STATE.
  7220             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 135
* EL156.cbl
  7221             20  BE-STATE            PIC XX.
  7222         16  BE-ZIP-CODE.
  7223             20  BE-ZIP-PRIME.
  7224                 24  BE-ZIP-1ST      PIC X.
  7225                     88  BE-CANADIAN-POST-CODE
  7226                                         VALUE 'A' THRU 'Z'.
  7227                 24  FILLER          PIC X(4).
  7228             20  BE-ZIP-PLUS4        PIC X(4).
  7229         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7230             20  BE-CAN-POSTAL-1     PIC XXX.
  7231             20  BE-CAN-POSTAL-2     PIC XXX.
  7232             20  FILLER              PIC XXX.
  7233         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7234         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7235
  7236******************************************************************
  7237*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7238*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7239******************************************************************
  7240     12  BE-CARRIER                  PIC X.
  7241
  7242     12  BE-ADDRESS-DATA2.
  7243         16  BE-MAIL-TO-NAME2        PIC X(30).
  7244         16  BE-ADDRESS-LINE-12      PIC X(30).
  7245         16  BE-ADDRESS-LINE-22      PIC X(30).
  7246         16  BE-ADDRESS-LINE-32      PIC X(30).
  7247         16  BE-CITY-STATE2.
  7248             20  BE-CITY2            PIC X(28).
  7249             20  BE-STATE2           PIC XX.
  7250         16  BE-ZIP-CODE2.
  7251             20  BE-ZIP-PRIME2.
  7252                 24  BE-ZIP-1ST2     PIC X.
  7253                     88  BE-CANADIAN-POST-CODE2
  7254                                         VALUE 'A' THRU 'Z'.
  7255                 24  FILLER          PIC X(4).
  7256             20  BE-ZIP-PLUS42       PIC X(4).
  7257         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7258             20  BE-CAN-POSTAL-12    PIC XXX.
  7259             20  BE-CAN-POSTAL-22    PIC XXX.
  7260             20  FILLER              PIC XXX.
  7261         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7262         16  BE-ACH-DATA.
  7263             20  BE-ACH-YES-OR-NO    PIC X.
  7264                 88  BE-ON-ACH       VALUE 'Y'.
  7265                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  7266             20  BE-ACH-ABA-ROUTING-NUMBER
  7267                                     PIC X(15).
  7268             20  BE-ACH-BANK-ACCOUNT-NUMBER
  7269                                     PIC X(20).
  7270             20  BE-ACH-SUB-TYPE     PIC XX.
  7271             20  FILLER              PIC X(23).
  7272         16  BE-BILLING-STMT-DATA.
  7273*            20  BE-BSR              PIC X.
  7274*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  7275*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7276*            20  BE-BSR-FROM         PIC X(30).
  7277*            20  BE-BSR-DEPT         PIC X(30).
  7278             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 136
* EL156.cbl
  7279             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7280             20  BE-OUTPUT-TYPE      PIC X.
  7281                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7282                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7283
  7284     12  FILLER                      PIC X(28).
  7285******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 137
* EL156.cbl
  7287*    COPY ELCARCH.
  7288******************************************************************
  7289*                                                                *
  7290*                            ELCARCH.                            *
  7291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7292*                            VMOD=2.007                          *
  7293*                                                                *
  7294*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7295*                                                                *
  7296*   FILE TYPE = VSAM,KSDS                                        *
  7297*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7298*                                                                *
  7299*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7300*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7301*                                                                *
  7302*   LOG = NO                                                     *
  7303*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7304*                                                                *
  7305*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7306******************************************************************
  7307 01  LETTER-ARCHIVE.
  7308     12  LA-RECORD-ID                PIC XX.
  7309         88  VALID-LA-ID                VALUE 'LA'.
  7310
  7311     12  LA-CONTROL-PRIMARY.
  7312         16  LA-COMPANY-CD           PIC X.
  7313         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7314         16  LA-RECORD-TYPE          PIC X.
  7315             88  LA-HEADER-DATA         VALUE '1'.
  7316             88  LA-ADDRESS-DATA        VALUE '2'.
  7317             88  LA-TEXT-DATA           VALUE '3'.
  7318             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7319         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7320
  7321     12  LA-CONTROL-BY-TYPE.
  7322         16  LA-COMPANY-CD-A1        PIC X.
  7323         16  LA-RECORD-TYPE-A1       PIC X.
  7324         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7325         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7326
  7327     12  LA-TEXT-RECORD.
  7328         16  LA-SKIP-CONTROL         PIC XX.
  7329             88  NO-LINES-SKIPPED       VALUE SPACES.
  7330             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7331         16  LA-TEXT-LINE            PIC X(70).
  7332
  7333     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7334         16  FILLER                  PIC XX.
  7335         16  LA-ADDRESS-LINE         PIC X(30).
  7336         16  FILLER                  PIC X(40).
  7337
  7338     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7339         16  FILLER                  PIC XX.
  7340         16  LA-CARRIER              PIC X.
  7341         16  LA-CLAIM-NO             PIC X(7).
  7342         16  LA-CERT-NO.
  7343             20  LA-CERT-PRIME       PIC X(10).
  7344             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 138
* EL156.cbl
  7345         16  LA-NO-OF-COPIES         PIC S9.
  7346         16  LA-RESEND-DATE          PIC XX.
  7347         16  LA-PROCESSOR-CD         PIC X(4).
  7348         16  LA-CREATION-DT          PIC XX.
  7349         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7350         16  LA-RESEND-PRINT-DATE    PIC XX.
  7351         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7352         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7353*
  7354* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7355*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7356*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7357*   I        20  LA-DMD-RES-ST           PIC XX.
  7358*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7359*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7360*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7361*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7362*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7363*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7364*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7365*   I        20  LA-DMD-UND-CODE         PIC XX.
  7366*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7367*   V    16  FILLER                  PIC X(15).
  7368* -----
  7369*
  7370* REINSERTED  CSO  MODS
  7371*
  7372         16  FILLER.
  7373             20  FILLER                  PIC X(29).
  7374             20  LA-CSO-LETTER-STATUS    PIC X.
  7375                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7376                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7377                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7378             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7379             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7380*
  7381
  7382     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7383         16  FILLER                  PIC XX.
  7384         16  LA4-CARRIER             PIC X.
  7385         16  LA4-CLAIM-NO            PIC X(7).
  7386         16  LA4-CERT-NO.
  7387             20  LA4-CERT-PRIME      PIC X(10).
  7388             20  LA4-CERT-SFX        PIC X.
  7389         16  LA4-NO-OF-COPIES        PIC S9.
  7390         16  LA4-RESEND-DATE         PIC XX.
  7391         16  LA4-PROCESSOR-CD        PIC X(4).
  7392         16  LA4-CREATION-DT         PIC XX.
  7393         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7394         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7395         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7396         16  LA4-FORM-TYPE           PIC X.
  7397             88  LA4-INITIAL-FORM    VALUE '1'.
  7398             88  LA4-PROGRESS-FORM   VALUE '2'.
  7399         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7400         16  LA4-STATE               PIC X(02).
  7401         16  FILLER                  PIC X(31).
  7402******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 139
* EL156.cbl
  7404*    COPY ELCDAR.
  7405******************************************************************
  7406*                                                                *
  7407*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7408*   FILE TYPE = VSAM,KSDS                                        *
  7409*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7410*   BASE CLUSTER = DLYACTV                                       *
  7411*   LOG = YES                                                    *
  7412*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7413*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7414*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7415*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7416*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7417*               BY PROGRAM "LGINFCE".                            *
  7418*                                                                *
  7419******************************************************************
  7420 01  DAILY-ACTIVITY-RECORD.
  7421     05  DA-KEY.
  7422         10  DA-COMP-CD          PIC X.
  7423         10  DA-CARRIER          PIC X.
  7424         10  DA-CLAIM-NO         PIC X(7).
  7425         10  DA-CERT-NO.
  7426             15  DA-CERT-PRIME   PIC X(10).
  7427             15  DA-CERT-SFX     PIC X.
  7428     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7429     05  DA-RECORD-TYPE          PIC X.
  7430     05  FILLER                  PIC X(2).
  7431******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 140
* EL156.cbl
  7433*    COPY ERCCOMP.
  7434******************************************************************
  7435*                                                                *
  7436*                                                                *
  7437*                            ERCCOMP                             *
  7438*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7439*                            VMOD=2.019                          *
  7440*                                                                *
  7441*   ONLINE CREDIT SYSTEM                                         *
  7442*                                                                *
  7443*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7444*                                                                *
  7445*   FILE TYPE = VSAM,KSDS                                        *
  7446*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7447*                                                                *
  7448*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7449*       ALTERNATE PATH = NONE                                    *
  7450*                                                                *
  7451*   LOG = NO                                                     *
  7452*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7453*                                                                *
  7454******************************************************************
  7455*                   C H A N G E   L O G
  7456*
  7457* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7458*-----------------------------------------------------------------
  7459*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7460* EFFECTIVE    NUMBER
  7461*-----------------------------------------------------------------
  7462* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7463* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7464* 092205    2005050300006  PEMA  ADD LEASE FEE
  7465* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7466* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7467* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7468* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7469* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7470* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7471******************************************************************
  7472
  7473 01  COMPENSATION-MASTER.
  7474     12  CO-RECORD-ID                          PIC XX.
  7475         88  VALID-CO-ID                          VALUE 'CO'.
  7476
  7477     12  CO-CONTROL-PRIMARY.
  7478         16  CO-COMPANY-CD                     PIC X.
  7479         16  CO-CONTROL.
  7480             20  CO-CTL-1.
  7481                 24  CO-CARR-GROUP.
  7482                     28  CO-CARRIER            PIC X.
  7483                     28  CO-GROUPING.
  7484                         32  CO-GROUP-PREFIX   PIC XXX.
  7485                         32  CO-GROUP-PRIME    PIC XXX.
  7486                 24  CO-RESP-NO.
  7487                     28  CO-RESP-PREFIX        PIC X(4).
  7488                     28  CO-RESP-PRIME         PIC X(6).
  7489             20  CO-CTL-2.
  7490                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 141
* EL156.cbl
  7491                     28  CO-ACCT-PREFIX        PIC X(4).
  7492                     28  CO-ACCT-PRIME         PIC X(6).
  7493         16  CO-TYPE                           PIC X.
  7494             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7495             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7496             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7497
  7498     12  CO-MAINT-INFORMATION.
  7499         16  CO-LAST-MAINT-DT                  PIC XX.
  7500         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7501         16  CO-LAST-MAINT-USER                PIC X(4).
  7502     12  FILLER                                PIC XX.
  7503     12  CO-STMT-TYPE                          PIC XXX.
  7504     12  CO-COMP-TYPE                          PIC X.
  7505         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7506     12  CO-STMT-OWNER                         PIC X(4).
  7507     12  CO-BALANCE-CONTROL                    PIC X.
  7508         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7509         88  CO-NO-BALANCE                        VALUE 'N'.
  7510
  7511     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7512         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7513         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7514         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7515
  7516     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7517         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7518         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7519
  7520     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7521     12  CO-GA-DIRECT-DEP                      PIC X.
  7522     12  CO-FUTURE-SPACE                       PIC X.
  7523         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7524
  7525     12  CO-ACCT-NAME                          PIC X(30).
  7526     12  CO-MAIL-NAME                          PIC X(30).
  7527     12  CO-ADDR-1                             PIC X(30).
  7528     12  CO-ADDR-2                             PIC X(30).
  7529     12  CO-ADDR-3.
  7530         16  CO-ADDR-CITY                      PIC X(27).
  7531         16  CO-ADDR-STATE                     PIC XX.
  7532     12  CO-CSO-1099                           PIC X.
  7533     12  CO-ZIP.
  7534         16  CO-ZIP-PRIME.
  7535             20  CO-ZIP-PRI-1ST                PIC X.
  7536                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7537             20  FILLER                        PIC X(4).
  7538         16  CO-ZIP-PLUS4                      PIC X(4).
  7539     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7540         16  CO-CAN-POSTAL-1                   PIC XXX.
  7541         16  CO-CAN-POSTAL-2                   PIC XXX.
  7542         16  FILLER                            PIC XXX.
  7543     12  CO-SOC-SEC                            PIC X(13).
  7544     12  CO-TELEPHONE.
  7545         16  CO-AREA-CODE                      PIC XXX.
  7546         16  CO-PREFIX                         PIC XXX.
  7547         16  CO-PHONE                          PIC X(4).
  7548
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 142
* EL156.cbl
  7549     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7550
  7551     12  CO-AR-BAL-LEVEL                       PIC X.
  7552         88  CO-AR-REF-LVL                        VALUE '1'.
  7553         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7554         88  CO-AR-BILL-LVL                       VALUE '2'.
  7555         88  CO-AR-AGT-LVL                        VALUE '3'.
  7556         88  CO-AR-FR-LVL                         VALUE '4'.
  7557
  7558     12  CO-AR-NORMAL-PRINT                    PIC X.
  7559         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7560         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7561
  7562     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7563
  7564     12  CO-AR-REPORTING                       PIC X.
  7565         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7566         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7567
  7568     12  CO-AR-PULL-CHECK                      PIC X.
  7569         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7570         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7571
  7572     12  CO-AR-BALANCE-PRINT                   PIC X.
  7573         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7574
  7575     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7576         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7577         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7578         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7579
  7580     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7581
  7582     12  CO-USER-CODE                          PIC X.
  7583     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7584
  7585******************************************************************
  7586*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7587*    THE LAST MONTH END RUN.
  7588******************************************************************
  7589
  7590     12  CO-LAST-ACTIVITY-DATE.
  7591         16  CO-ACT-YEAR                       PIC 99.
  7592         16  CO-ACT-MONTH                      PIC 99.
  7593         16  CO-ACT-DAY                        PIC 99.
  7594
  7595     12  CO-LAST-STMT-DT.
  7596         16  CO-LAST-STMT-YEAR                 PIC 99.
  7597         16  CO-LAST-STMT-MONTH                PIC 99.
  7598         16  CO-LAST-STMT-DAY                  PIC 99.
  7599
  7600     12  CO-MO-END-TOTALS.
  7601         16  CO-MONTHLY-TOTALS.
  7602             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7603             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7604             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7605             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7606             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 143
* EL156.cbl
  7607
  7608         16  CO-AGING-TOTALS.
  7609             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7610             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7611             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7612             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7613
  7614         16  CO-YTD-TOTALS.
  7615             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7616             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7617
  7618         16  CO-OVER-UNDER-TOTALS.
  7619             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7620             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7621
  7622     12  CO-MISCELLANEOUS-TOTALS.
  7623         16  CO-FICA-TOTALS.
  7624             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7625             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7626
  7627         16  CO-CLAIM-TOTALS.
  7628             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7629             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7630
  7631******************************************************************
  7632*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7633*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7634******************************************************************
  7635
  7636     12  CO-CURRENT-TOTALS.
  7637         16  CO-CURRENT-LAST-STMT-DT.
  7638             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7639             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7640             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7641
  7642         16  CO-CURRENT-MONTHLY-TOTALS.
  7643             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7644             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7645             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7646             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7647             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7648
  7649         16  CO-CURRENT-AGING-TOTALS.
  7650             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7651             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7652             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7653             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7654
  7655         16  CO-CURRENT-YTD-TOTALS.
  7656             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7657             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7658
  7659     12  CO-PAID-COMM-TOTALS.
  7660         16  CO-YTD-PAID-COMMS.
  7661             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7662             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7663
  7664     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 144
* EL156.cbl
  7665         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7666         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7667
  7668     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7669         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7670         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7671         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7672         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7673         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7674         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7675         88  CO-FINAL-LETTER                  VALUE 'F'.
  7676         88  CO-RECONCILING                   VALUE 'R'.
  7677         88  CO-PHONE-CALL                    VALUE 'P'.
  7678         88  CO-LEGAL                         VALUE 'L'.
  7679         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7680         88  CO-WRITE-OFF                     VALUE 'W'.
  7681         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7682
  7683     12  CO-CSR-CODE                       PIC X(4).
  7684
  7685     12  CO-GA-STATUS-INFO.
  7686         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7687         16  CO-GA-TERMINATION-DT          PIC XX.
  7688         16  CO-GA-STATUS-CODE             PIC X.
  7689             88  CO-GA-ACTIVE                 VALUE 'A'.
  7690             88  CO-GA-INACTIVE               VALUE 'I'.
  7691             88  CO-GA-PENDING                VALUE 'P'.
  7692         16  CO-GA-COMMENTS.
  7693             20  CO-GA-COMMENT-1           PIC X(40).
  7694             20  CO-GA-COMMENT-2           PIC X(40).
  7695             20  CO-GA-COMMENT-3           PIC X(40).
  7696             20  CO-GA-COMMENT-4           PIC X(40).
  7697
  7698     12  CO-RPTCD2                         PIC X(10).
  7699     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7700         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7701         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7702
  7703     12  CO-TYPE-AGENT                     PIC X(01).
  7704         88  CO-CORPORATION                   VALUE 'C'.
  7705         88  CO-PARTNERSHIP                   VALUE 'P'.
  7706         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7707         88  CO-TRUST                         VALUE 'T'.
  7708         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7709
  7710     12  CO-FAXNO.
  7711         16  CO-FAX-AREA-CODE                  PIC XXX.
  7712         16  CO-FAX-PREFIX                     PIC XXX.
  7713         16  CO-FAX-PHONE                      PIC X(4).
  7714
  7715     12  CO-BANK-INFORMATION.
  7716         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7717         16  CO-BANK-TRANSIT-NON REDEFINES
  7718             CO-BANK-TRANSIT-NO                PIC 9(8).
  7719
  7720         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7721     12  CO-MISC-DEDUCT-INFO REDEFINES
  7722                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 145
* EL156.cbl
  7723         16  CO-MD-GL-ACCT                     PIC X(10).
  7724         16  CO-MD-DIV                         PIC XX.
  7725         16  CO-MD-CENTER                      PIC X(4).
  7726         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7727         16  CO-CREATE-AP-CHECK                PIC X.
  7728         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7729         16  FILLER                            PIC XXX.
  7730     12  CO-ACH-STATUS                         PIC X.
  7731         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7732         88  CO-ACH-PENDING                        VALUE 'P'.
  7733
  7734     12  CO-BILL-SW                            PIC X.
  7735     12  CO-CONTROL-NAME                       PIC X(30).
  7736     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7737     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7738     12  CO-CLP-STATE                          PIC XX.
  7739     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7740     12  CO-SPP-REFUND-EDIT                    PIC X.
  7741
  7742******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 146
* EL156.cbl
  7744*    COPY ERCDMDNT.
  7745******************************************************************
  7746*                                                                *
  7747*                            ERCDMDNT                            *
  7748*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7749*                            VMOD=2.005                          *
  7750*                                                                *
  7751*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7752*                                                                *
  7753*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7754*                                                                *
  7755*        FILE TYPE= VSAM,KSDS                                    *
  7756*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7757*                                                                *
  7758*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7759*                                                                *
  7760*        LOG = YES                                               *
  7761*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7762*                                                                *
  7763******************************************************************
  7764
  7765 01  CERTIFICATE-NOTE.
  7766     12  CN-RECORD-ID                     PIC  XX.
  7767         88  VALID-CN-ID                      VALUE 'CN'.
  7768
  7769     12  CN-CONTROL-PRIMARY.
  7770         16  CN-COMPANY-CD                PIC X.
  7771         16  CN-CERT-KEY.
  7772             20  CN-CARRIER               PIC X.
  7773             20  CN-GROUPING.
  7774                 24  CN-GROUPING-PREFIX   PIC XXX.
  7775                 24  CN-GROUPING-PRIME    PIC XXX.
  7776             20  CN-STATE                 PIC XX.
  7777             20  CN-ACCOUNT.
  7778                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7779                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7780             20  CN-CERT-EFF-DT           PIC XX.
  7781             20  CN-CERT-NO.
  7782                 24  CN-CERT-PRIME        PIC X(10).
  7783                 24  CN-CERT-SFX          PIC X.
  7784
  7785     12  CN-BILLING-START-LINE-NO         PIC 99.
  7786     12  CN-BILLING-END-LINE-NO           PIC 99.
  7787
  7788     12  CN-LINES.
  7789         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7790
  7791     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7792         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7793         16  CN-CSI-GENERAL-DATA-AREA.
  7794             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7795
  7796         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7797             CN-CSI-GENERAL-DATA-AREA.
  7798             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7799             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7800             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7801             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 147
* EL156.cbl
  7802             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7803             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7804             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7805             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7806             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7807             20  FILLER                       PIC XX.
  7808             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7809             20  FILLER                       PIC X(38).
  7810
  7811         16  CN-CSI-PRODUCT-DATA-AREA.
  7812             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7813
  7814         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7815             CN-CSI-PRODUCT-DATA-AREA.
  7816             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7817             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7818             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7819             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7820             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7821             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7822             20  FILLER                   PIC XX.
  7823             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7824             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7825             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7826             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7827             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7828             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7829             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7830             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7831             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7832             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7833             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7834             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7835             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7836             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7837             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7838             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7839             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7840             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7841             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7842             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7843             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7844             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7845             20  FILLER                   PIC X(25).
  7846
  7847         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7848             CN-CSI-CREDIT-CARD-DATA.
  7849             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7850             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7851             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7852             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7853             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7854             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7855             20  FILLER                   PIC XX.
  7856             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7857             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7858             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7859             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 148
* EL156.cbl
  7860             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7861             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7862             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7863             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7864             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7865             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7866             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7867             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7868             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7869             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7870             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7871             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7872             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7873             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7874             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7875             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7876             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7877             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7878             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7879             20  FILLER                   PIC X(17).
  7880
  7881         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7882             CN-CSI-FAMILY-LEAVE-DATA.
  7883             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7884             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7885             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7886             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7887             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7888             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7889             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7890             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7891             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7892             20  CN-CSI-SL-INT-ON-PROCEEDS
  7893                                          PIC S9(5)V99  COMP-3.
  7894             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7895             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7896             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7897             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7898             20  CN-CSI-SL-POLICY-BENEFITS
  7899                                          PIC S9(5)V99  COMP-3.
  7900             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7901             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7902             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7903             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7904             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7905             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7906             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7907             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7908             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7909             20  CN-CSI-SL-STATE-NOT      PIC X.
  7910             20  FILLER                   PIC XX.
  7911
  7912         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7913             CN-CSI-SENIOR-LIFE-DATA.
  7914             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7915             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7916             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7917                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 149
* EL156.cbl
  7918             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7919             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7920             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7921             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7922             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7923             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7924             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7925             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7926             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7927             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7928             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7929             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7930             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7931             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7932             20  CN-CSI-PP-REPAIR         PIC X.
  7933             20  CN-CSI-PP-REPLACE        PIC X.
  7934             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7935             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7936             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7937             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7938             20  FILLER                   PIC X(5).
  7939
  7940         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7941             CN-CSI-PURCH-PROP-DATA.
  7942             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7943             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7944             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7945             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7946             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7947             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7948             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7949             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7950             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7951             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7952             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7953             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7954             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7955             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7956             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7957             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7958             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7959             20  CN-CSI-EW-REPLACE        PIC X.
  7960             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7961             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7962             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7963             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7964             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7965             20  FILLER                   PIC X(4).
  7966
  7967     12  CN-LAST-MAINT-DT                 PIC XX.
  7968     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7969     12  CN-LAST-MAINT-USER               PIC X(4).
  7970     12  FILLER                           PIC X(6).
  7971
  7972******************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 150
* EL156.cbl
  7974*    COPY ERCCNOT.
  7975******************************************************************
  7976*                                                                *
  7977*                            ERCCNOT                             *
  7978*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7979*                            VMOD=2.003                          *
  7980*                                                                *
  7981*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7982*                                                                *
  7983*        FILE TYPE= VSAM,KSDS                                    *
  7984*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7985*                                                                *
  7986*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7987*                                                                *
  7988*        LOG = YES                                               *
  7989*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7990*                                                                *
  7991******************************************************************
  7992*                   C H A N G E   L O G
  7993*
  7994* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7995*-----------------------------------------------------------------
  7996*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7997* EFFECTIVE    NUMBER
  7998*-----------------------------------------------------------------
  7999* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  8000******************************************************************
  8001
  8002 01  CERT-NOTE-FILE.
  8003     12  CZ-RECORD-ID                PIC  XX.
  8004         88  VALID-CZ-ID                  VALUE 'CZ'.
  8005
  8006     12  CZ-CONTROL-PRIMARY.
  8007         16  CZ-COMPANY-CD           PIC X.
  8008         16  CZ-CARRIER              PIC X.
  8009         16  CZ-GROUPING.
  8010             20 CZ-GROUPING-PREFIX   PIC XXX.
  8011             20 CZ-GROUPING-PRIME    PIC XXX.
  8012         16  CZ-STATE                PIC XX.
  8013         16  CZ-ACCOUNT.
  8014             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  8015             20 CZ-ACCOUNT-PRIME     PIC X(6).
  8016         16  CZ-CERT-EFF-DT          PIC XX.
  8017         16  CZ-CERT-NO.
  8018             20  CZ-CERT-PRIME       PIC X(10).
  8019             20  CZ-CERT-SFX         PIC X.
  8020         16  CZ-RECORD-TYPE          PIC X.
  8021             88  CERT-NOTE           VALUE '1'.
  8022             88  CLAIM-CERT-NOTE     VALUE '2'.
  8023         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  8024
  8025     12  CZ-LAST-MAINT-DT            PIC XX.
  8026     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8027     12  CZ-LAST-MAINT-USER          PIC X(4).
  8028
  8029     12  CZ-NOTE-INFORMATION.
  8030         16  CZ-NOTE                 PIC X(63).
  8031         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 151
* EL156.cbl
  8032******************************************************************
  8033*                            COPY ERCPDEF.
  8034******************************************************************
  8035*                                                                *
  8036*                                                                *
  8037*                            ERCPDEF.                            *
  8038*                                                                *
  8039*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  8040*                                                                *
  8041*    FILE TYPE = VSAM,KSDS                                       *
  8042*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  8043*                                                                *
  8044*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  8045*                                                                *
  8046*    LOG = YES                                                   *
  8047*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8048******************************************************************
  8049*                   C H A N G E   L O G
  8050*
  8051* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8052*-----------------------------------------------------------------
  8053*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8054* EFFECTIVE    NUMBER
  8055*-----------------------------------------------------------------
  8056* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8057* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8058* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  8059******************************************************************
  8060 01  PRODUCT-MASTER.
  8061    12  PD-RECORD-ID                 PIC X(02).
  8062        88  VALID-PD-ID                  VALUE 'PD'.
  8063    12  PD-CONTROL-PRIMARY.
  8064        16  PD-COMPANY-CD            PIC X.
  8065        16  PD-STATE                 PIC XX.
  8066        16  PD-PRODUCT-CD            PIC XXX.
  8067        16  PD-FILLER                PIC X(7).
  8068        16  PD-BEN-TYPE              PIC X.
  8069        16  PD-BEN-CODE              PIC XX.
  8070        16  PD-PROD-EXP-DT           PIC XX.
  8071    12  FILLER                       PIC X(50).
  8072    12  PD-PRODUCT-DATA OCCURS 8.
  8073        16  PD-PROD-CODE             PIC X.
  8074            88  PD-PROD-LIFE           VALUE 'L'.
  8075            88  PD-PROD-PROP           VALUE 'P'.
  8076            88  PD-PROD-AH             VALUE 'A'.
  8077            88  PD-PROD-IU             VALUE 'I'.
  8078            88  PD-PROD-GAP            VALUE 'G'.
  8079            88  PD-PROD-FAML           VALUE 'F'.
  8080        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  8081        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  8082        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  8083        16  PD-MAX-TERM              PIC S999        COMP-3.
  8084        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  8085        16  FILLER                   PIC X.
  8086        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  8087        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  8088        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  8089        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 152
* EL156.cbl
  8090        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  8091        16  PD-REC-CRIT-PERIOD       PIC 99.
  8092        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  8093            20  PD-RECURRING-YN      PIC X.
  8094            20  FILLER               PIC X.
  8095        16  PD-RTW-MOS               PIC 99.
  8096        16  PD-MAX-EXTENSION         PIC 99.
  8097        16  pd-ben-pct               pic sv999 comp-3.
  8098*       16  FILLER                   PIC XX.
  8099    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  8100    12  PD-TERM-LIMITS OCCURS 15.
  8101        16  PD-LOW-TERM              PIC S999        COMP-3.
  8102        16  PD-HI-TERM               PIC S999        COMP-3.
  8103*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8104    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8105        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8106        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8107    12  PD-EARN-FACTORS.
  8108        16  FILLER OCCURS 15.
  8109            20  FILLER OCCURS 15.
  8110                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8111    12  PD-PRODUCT-DESC              PIC X(80).
  8112    12  PD-TRUNCATED                 PIC X.
  8113    12  FILLER                       PIC X(59).
  8114    12  PD-MAINT-INFORMATION.
  8115        16  PD-LAST-MAINT-DT         PIC X(02).
  8116        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8117        16  PD-LAST-MAINT-BY         PIC X(04).
  8118*                            COPY ELCCRTT.
  8119******************************************************************
  8120*                                                                *
  8121*                            ELCCRTT.                            *
  8122*                                                                *
  8123*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8124*                                                                *
  8125*   FILE TYPE = VSAM,KSDS                                        *
  8126*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8127*                                                                *
  8128*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8129*                                                                *
  8130*   LOG = YES                                                    *
  8131*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8132******************************************************************
  8133*                   C H A N G E   L O G
  8134*
  8135* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8136*-----------------------------------------------------------------
  8137*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8138* EFFECTIVE    NUMBER
  8139*-----------------------------------------------------------------
  8140* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8141* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8142* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8143* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8144* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8145* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8146* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8147* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 153
* EL156.cbl
  8148* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  8149******************************************************************
  8150
  8151 01  CERTIFICATE-TRAILERS.
  8152     12  CS-RECORD-ID                      PIC XX.
  8153         88  VALID-CS-ID                      VALUE 'CS'.
  8154
  8155     12  CS-CONTROL-PRIMARY.
  8156         16  CS-COMPANY-CD                 PIC X.
  8157         16  CS-CARRIER                    PIC X.
  8158         16  CS-GROUPING                   PIC X(6).
  8159         16  CS-STATE                      PIC XX.
  8160         16  CS-ACCOUNT                    PIC X(10).
  8161         16  CS-CERT-EFF-DT                PIC XX.
  8162         16  CS-CERT-NO.
  8163             20  CS-CERT-PRIME             PIC X(10).
  8164             20  CS-CERT-SFX               PIC X.
  8165         16  CS-TRAILER-TYPE               PIC X.
  8166             88  COMM-TRLR           VALUE 'A'.
  8167             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8168             88  CERT-DATA-TRLR      VALUE 'C'.
  8169
  8170     12  CS-DATA-AREA                      PIC X(516).
  8171
  8172     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8173         16  CS-BANK-COMMISSION-AREA.
  8174             20  CS-BANK-COMMS       OCCURS 10.
  8175                 24  CS-AGT                PIC X(10).
  8176                 24  CS-COM-TYP            PIC X.
  8177                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8178                 24  CS-RECALC-LV-INDIC    PIC X.
  8179                 24  FILLER                PIC X(10).
  8180         16  FILLER                        PIC X(256).
  8181
  8182     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8183****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8184         16  CS-MB-CLAIM-DATA OCCURS 24.
  8185             20  CS-CLAIM-NO               PIC X(7).
  8186             20  CS-CLAIM-TYPE             PIC X.
  8187                 88  CS-AH-CLM               VALUE 'A'.
  8188                 88  CS-IU-CLM               VALUE 'I'.
  8189                 88  CS-GP-CLM               VALUE 'G'.
  8190                 88  CS-LF-CLM               VALUE 'L'.
  8191                 88  CS-PR-CLM               VALUE 'P'.
  8192                 88  CS-FL-CLM               VALUE 'F'.
  8193             20  CS-INSURED-TYPE           PIC X.
  8194                 88  CS-PRIM-INSURED          VALUE 'P'.
  8195                 88  CS-CO-BORROWER           VALUE 'C'.
  8196             20  CS-BENEFIT-PERIOD         PIC 99.
  8197             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8198             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8199             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8200         16  FILLER                        PIC X(12).
  8201     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8202         16  CS-VIN-NUMBER                 PIC X(17).
  8203         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8204         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8205         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 154
* EL156.cbl
  8206         16  cs-agent-name.
  8207             20  cs-agent-fname            pic x(20).
  8208             20  cs-agent-mi               pic x.
  8209             20  cs-agent-lname            pic x(25).
  8210         16  cs-license-no                 pic x(15).
  8211         16  cs-npn-number                 pic x(10).
  8212         16  cs-agent-edit-status          pic x.
  8213             88  cs-ae-refer-to-manager      value 'M'.
  8214             88  cs-ae-cover-sheet           value 'C'.
  8215             88  cs-ae-sig-form              value 'S'.
  8216             88  cs-ae-verified              value 'V'.
  8217             88  cs-unidentified-signature   value 'U'.
  8218             88  cs-cert-returned            value 'R'.
  8219             88  cs-accept-no-commission     value 'N'.
  8220         16  cs-year                       pic 9999.
  8221         16  cs-make                       pic x(20).
  8222         16  cs-model                      pic x(20).
  8223         16  cs-future                     pic x(20).
  8224         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8225         16  FILLER                        PIC X(356). *> was 420
  8226*        16  FILLER                        PIC X(496).
  8227 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8228                          CONTROL-FILE CERTIFICATE-MASTER
  8229                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8230                          ACCOUNT-MASTER CHECK-QUE
  8231                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8232                          DAILY-ACTIVITY-RECORD
  8233                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8234                          CERT-NOTE-FILE PRODUCT-MASTER
  8235                          CERTIFICATE-TRAILERS.
  8236 0000-DFHEXIT SECTION.
  8237     MOVE '9#                    $   ' TO DFHEIV0.
  8238     MOVE 'EL156' TO DFHEIV1.
  8239     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8240
  8241     IF EIBCALEN = 0
  8242         GO TO 8800-UNAUTHORIZED-ACCESS.
  8243
  8244     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8245     MOVE EIBTRMID               TO QID-TERM.
  8246     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8247     MOVE '2'                    TO EMI-SWITCH2.
  8248     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8249     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8250
  8251     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8252     MOVE '5'                    TO DC-OPTION-CODE.
  8253     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8254     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8255                                    SAVE-BIN-DATE.
  8256     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8257     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8258
  8259     IF SAVE-DATE-YY > 70
  8260         MOVE 19                 TO SAVE-DATE-CC
  8261     ELSE
  8262         MOVE 20                 TO SAVE-DATE-CC.
  8263
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 155
* EL156.cbl
  8264     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8265         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8266     END-IF.
  8267
  8268     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8269        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
  8270     ELSE
  8271        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8272     END-IF
  8273
  8274     IF PI-PRINT-CLM-FRM-YN = 'N'
  8275         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8276     ELSE
  8277         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8278     END-IF
  8279
  8280     IF PI-PRINT-SURVEY-YN = 'N'
  8281         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8282     ELSE
  8283         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8284     END-IF
  8285
  8286     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8287         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8288     ELSE
  8289         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8290     END-IF
  8291
  8292* EXEC CICS HANDLE CONDITION
  8293*        NOTOPEN   (9990-ABEND)
  8294*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8295*        MAPFAIL   (0400-FIRST-TIME)
  8296*        DUPREC    (6180-DUPREC)
  8297*        ERROR     (9990-ABEND)
  8298*    END-EXEC.
  8299*    MOVE '"$JL?%.               ! " #00008287' TO DFHEIV0
  8300     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8302     MOVE X'2220233030303038323837' TO DFHEIV0(25:11)
  8303     CALL 'kxdfhei1' USING DFHEIV0
  8304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8305
  8306
  8307     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8308         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8309
  8310     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8311         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8312             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8313             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8314             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8315             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8316             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8317             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8318             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8319             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8320             MOVE LOW-VALUES           TO EL156AI
  8321             MOVE 'Y'                  TO FIRST-ENTRY
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 156
* EL156.cbl
  8322         ELSE
  8323             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8324             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8325             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8326             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8327             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8328             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8329             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8330             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8331
  8332     IF RETURNED-FROM NOT = SPACES
  8333        IF (RETURNED-FROM = 'EL614')
  8334           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8335           IF WS-SAVED-EOB-CODES NOT = SPACES
  8336              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8337           ELSE
  8338              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8339           END-IF
  8340        END-IF
  8341         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8342            MOVE 'Y'             TO FIRST-ENTRY
  8343            IF RETURNED-FROM = 'EL614'
  8344               AND (PI-PASS-SW NOT = 'C')
  8345               IF WS-SAVED-EOB-CODES NOT = SPACES
  8346                  MOVE WS-SAVED-EOB-CODES
  8347                                 TO PI-PMTNOTE2
  8348                                    WS-PMTNOTE2
  8349                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8350               ELSE
  8351                  MOVE SPACES    TO PI-PMTNOTE2
  8352                                    WS-PMTNOTE2
  8353                                    PI-EOB-CODES-EXIST
  8354               END-IF
  8355            END-IF
  8356            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8357            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8358            IF RETURNED-FROM = 'EL614'
  8359               GO TO 1000-EDIT-DATA
  8360            END-IF
  8361            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8362               (PAYEEI   = LOW-VALUES OR SPACES)
  8363               GO TO 8100-SEND-INITIAL-MAP
  8364            ELSE
  8365               GO TO 1000-EDIT-DATA.
  8366
  8367     IF EIBTRNID NOT = TRANS-ID
  8368         GO TO 0400-FIRST-TIME.
  8369
  8370     IF EIBAID = DFHCLEAR
  8371        IF PI-PASS-SW = 'C'
  8372           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8373           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8374           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8375           MOVE 'Y'            TO RETURNED-FROM-B
  8376           GO TO 1000-EDIT-DATA
  8377        ELSE
  8378           GO TO 9400-CLEAR.
  8379
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 157
* EL156.cbl
  8380     IF PI-PASS-SW = 'C'
  8381         MOVE MAP-NAMEB          TO MAP-NAME
  8382         IF EIBAID = DFHPF1 OR DFHPF13
  8383             GO TO 5000-UPDATE
  8384           ELSE
  8385             IF EIBAID NOT = DFHENTER
  8386                 MOVE LOW-VALUES TO EL156BI
  8387                 MOVE MAP-NAMEB  TO MAP-NAME
  8388                 MOVE ER-0029    TO EMI-ERROR
  8389                 MOVE -1         TO  ENTPFBL
  8390                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8391                 GO TO 8200-SEND-DATAONLY.
  8392
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 158
* EL156.cbl
  8394 0200-RECEIVE.
  8395     MOVE LOW-VALUES             TO EL156AI.
  8396     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8397         MOVE ER-0008            TO EMI-ERROR
  8398         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8399         IF PI-PASS-SW = 'C'
  8400             MOVE -1             TO ENTPFBL
  8401             GO TO 8200-SEND-DATAONLY
  8402         ELSE
  8403             MOVE -1             TO PMTTYPEL
  8404             GO TO 8200-SEND-DATAONLY.
  8405
  8406     IF PI-COMPANY-ID = 'DMD'
  8407         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8408
  8409     IF PI-PASS-SW = 'C'
  8410         MOVE MAP-NAMEB          TO MAP-NAME.
  8411
  8412
  8413* EXEC CICS RECEIVE
  8414*        MAP   (MAP-NAME)
  8415*        MAPSET(MAPSET-NAME)
  8416*        ASIS
  8417*        INTO  (EL156AI)
  8418*    END-EXEC.
  8419     MOVE LENGTH OF
  8420      EL156AI
  8421       TO DFHEIV11
  8422*    MOVE '8"TAI  L              ''   #00008400' TO DFHEIV0
  8423     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8424     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8425     MOVE X'2020233030303038343030' TO DFHEIV0(25:11)
  8426     CALL 'kxdfhei1' USING DFHEIV0,
  8427           MAP-NAME,
  8428           EL156AI,
  8429           DFHEIV11,
  8430           MAPSET-NAME,
  8431           DFHEIV99,
  8432           DFHEIV99
  8433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8434
  8435
  8436     IF PI-PASS-SW NOT = 'C'
  8437         GO TO 0250-MAPA.
  8438
  8439     IF ENTPFBL NOT > ZERO
  8440         MOVE MAP-NAMEB          TO MAP-NAME
  8441         MOVE ER-0029            TO EMI-ERROR
  8442         MOVE -1                 TO  ENTPFBL
  8443         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8444         GO TO 8200-SEND-DATAONLY.
  8445
  8446     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8447         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8448       ELSE
  8449         MOVE MAP-NAMEB           TO MAP-NAME
  8450         MOVE ER-0029             TO EMI-ERROR
  8451         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 159
* EL156.cbl
  8452         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8453         GO TO 8200-SEND-DATAONLY.
  8454
  8455     IF EIBAID = DFHPF1 OR DFHPF13
  8456         IF MODIFY-CAP
  8457            GO TO 5000-UPDATE
  8458          ELSE
  8459            MOVE 'UPDATE'           TO SM-READ
  8460            PERFORM 9995-SECURITY-VIOLATION
  8461            MOVE MAP-NAMEB          TO MAP-NAME
  8462            MOVE ER-0070            TO EMI-ERROR
  8463            MOVE -1                 TO  ENTPFBL
  8464            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8465            GO TO 8200-SEND-DATAONLY.
  8466
  8467 0250-MAPA.
  8468     IF ENTERPFL = 0
  8469         GO TO 0300-CHECK-PFKEYS.
  8470
  8471     IF EIBAID NOT = DFHENTER
  8472         MOVE ER-0004            TO EMI-ERROR
  8473         GO TO 0320-INPUT-ERROR.
  8474
  8475     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8476         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8477     ELSE
  8478         MOVE ER-0029            TO EMI-ERROR
  8479         GO TO 0320-INPUT-ERROR.
  8480
  8481 0300-CHECK-PFKEYS.
  8482     IF EIBAID = DFHPF7 OR DFHPF8
  8483         GO TO 8820-PF7-8.
  8484
  8485     IF EIBAID = DFHPF23
  8486         GO TO 8810-PF23.
  8487
  8488     IF EIBAID = DFHPF24
  8489         GO TO 9200-RETURN-MAIN-MENU.
  8490
  8491     IF EIBAID = DFHPF12
  8492         GO TO 9500-PF12.
  8493
  8494     IF EIBAID = DFHPF1
  8495        IF PI-PASS-SW = 'A' OR 'B'
  8496          GO TO 0330-BROWSE-FORWARD.
  8497
  8498     IF EIBAID = DFHPF2
  8499        IF PI-PASS-SW = 'A' OR 'B'
  8500          GO TO 0350-BROWSE-BACKWARD.
  8501
  8502     IF EIBAID = DFHPF6
  8503        IF PI-EOB-CODES-EXIST = 'Y'
  8504           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8505        ELSE
  8506           MOVE SPACES              TO WS-PMTNOTE2
  8507        END-IF
  8508         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8509         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 160
* EL156.cbl
  8510            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8511         END-IF
  8512         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8513         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  8514             MOVE 'EL614'        TO PGM-NAME
  8515             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8516             GO TO 9300-XCTL
  8517         ELSE
  8518             MOVE XCTL-157       TO PGM-NAME
  8519             GO TO 9300-XCTL.
  8520
  8521     IF EIBAID = DFHPF9
  8522        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8523        MOVE XCTL-141            TO PGM-NAME
  8524        GO TO 9300-XCTL.
  8525
  8526     IF EIBAID = DFHPF10
  8527        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8528        MOVE XCTL-155            TO PGM-NAME
  8529        GO TO 9300-XCTL.
  8530
  8531     MOVE SPACES                 TO ERRMSG0O
  8532                                    ERRMSG1O
  8533                                    ERRMSG2O.
  8534
  8535     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8536         IF PI-PASS-SW NOT = 'B'
  8537             MOVE ER-0422        TO EMI-ERROR
  8538             GO TO 0320-INPUT-ERROR
  8539           ELSE
  8540             GO TO 0700-TEST-FOR-CHANGES.
  8541
  8542     IF EIBAID = DFHPF11
  8543        IF PI-PASS-SW = 'C'
  8544           MOVE ER-0029          TO EMI-ERROR
  8545           GO TO 0320-INPUT-ERROR.
  8546
  8547     IF EIBAID = DFHENTER OR DFHPF11
  8548        NEXT SENTENCE
  8549     ELSE
  8550        MOVE ER-0029             TO EMI-ERROR
  8551        GO TO 0320-INPUT-ERROR.
  8552
  8553     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8554
  8555     if pi-epyfrom not = zeros
  8556        if pi-epyfrom not = ws-epyfrom
  8557           move zeros        to ws-edays
  8558        end-if
  8559     end-if
  8560
  8561     if pi-epythru not = zeros
  8562        if pi-epythru not = ws-epythru
  8563           move zeros        to ws-edays
  8564        end-if
  8565     end-if
  8566
  8567     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 161
* EL156.cbl
  8568         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8569         GO TO 1000-EDIT-DATA
  8570     ELSE
  8571         IF PI-FATAL-COUNT NOT = 0 OR
  8572            PI-FORCE-COUNT NOT = 0
  8573             GO TO 1000-EDIT-DATA
  8574         ELSE
  8575             GO TO 2000-EDIT-DONE.
  8576
  8577 0320-INPUT-ERROR.
  8578     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8579
  8580     IF ENTERPFL = 0
  8581         MOVE -1                 TO PMTTYPEL
  8582     ELSE
  8583         MOVE AL-UNBON           TO ENTERPFA
  8584         MOVE -1                 TO ENTERPFL.
  8585
  8586     GO TO 8200-SEND-DATAONLY.
  8587
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 162
* EL156.cbl
  8589 0330-BROWSE-FORWARD.
  8590
  8591     MOVE CLMNOI            TO PI-CLAIM-NO.
  8592     MOVE CARRI             TO PI-CARRIER.
  8593     MOVE CERTNOI           TO PI-CERT-PRIME.
  8594     MOVE SUFXI             TO PI-CERT-SFX.
  8595
  8596     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8597     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8598     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8599     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8600
  8601     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8602
  8603
  8604* EXEC CICS HANDLE CONDITION
  8605*         NOTFND   (0380-CLAIM-END-FILE)
  8606*         ENDFILE  (0380-CLAIM-END-FILE)
  8607*    END-EXEC.
  8608*    MOVE '"$I''                  ! # #00008574' TO DFHEIV0
  8609     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8610     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8611     MOVE X'2320233030303038353734' TO DFHEIV0(25:11)
  8612     CALL 'kxdfhei1' USING DFHEIV0
  8613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8614
  8615
  8616
  8617* EXEC CICS STARTBR
  8618*         DATASET    ('ELMSTR')
  8619*         RIDFLD     (ELMSTR-KEY)
  8620*         GTEQ
  8621*    END-EXEC.
  8622     MOVE 'ELMSTR' TO DFHEIV1
  8623     MOVE 0
  8624       TO DFHEIV11
  8625*    MOVE '&,         G          &   #00008579' TO DFHEIV0
  8626     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8627     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8628     MOVE X'2020233030303038353739' TO DFHEIV0(25:11)
  8629     CALL 'kxdfhei1' USING DFHEIV0,
  8630           DFHEIV1,
  8631           ELMSTR-KEY,
  8632           DFHEIV99,
  8633           DFHEIV11,
  8634           DFHEIV99
  8635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8636
  8637
  8638     MOVE 'Y' TO WS-BROWSE-START-SW.
  8639
  8640 0335-READNEXT.
  8641
  8642
  8643* EXEC CICS READNEXT
  8644*         DATASET    ('ELMSTR')
  8645*         RIDFLD     (ELMSTR-KEY)
  8646*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 163
* EL156.cbl
  8647*    END-EXEC.
  8648     MOVE 'ELMSTR' TO DFHEIV1
  8649     MOVE 0
  8650       TO DFHEIV11
  8651*    MOVE '&.S                   )   #00008589' TO DFHEIV0
  8652     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8653     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8654     MOVE X'2020233030303038353839' TO DFHEIV0(25:11)
  8655     CALL 'kxdfhei1' USING DFHEIV0,
  8656           DFHEIV1,
  8657           DFHEIV20,
  8658           DFHEIV99,
  8659           ELMSTR-KEY,
  8660           DFHEIV99,
  8661           DFHEIV11,
  8662           DFHEIV99,
  8663           DFHEIV99
  8664     SET ADDRESS OF CLAIM-MASTER TO
  8665         DFHEIV20
  8666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8667
  8668
  8669     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8670        GO TO 0380-CLAIM-END-FILE.
  8671
  8672     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8673        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8674        GO TO 0335-READNEXT.
  8675
  8676     IF PI-COMPANY-ID = 'CRI'
  8677         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8678            GO TO 0380-CLAIM-END-FILE.
  8679
  8680     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8681         GO TO 0335-READNEXT.
  8682
  8683     IF PI-CARRIER-SECURITY > SPACES
  8684         IF CL-CARRIER = PI-CARRIER-SECURITY
  8685             NEXT SENTENCE
  8686         ELSE
  8687             GO TO 0335-READNEXT.
  8688
  8689     IF PI-ACCOUNT-SECURITY > SPACES
  8690         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8691             NEXT SENTENCE
  8692         ELSE
  8693             GO TO 0335-READNEXT.
  8694
  8695     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8696     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8697     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8698
  8699     GO TO 0400-FIRST-TIME.
  8700
  8701 0350-BROWSE-BACKWARD.
  8702
  8703     MOVE CLMNOI            TO PI-CLAIM-NO
  8704                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 164
* EL156.cbl
  8705     MOVE CARRI             TO PI-CARRIER.
  8706     MOVE CERTNOI           TO PI-CERT-PRIME.
  8707     MOVE SUFXI             TO PI-CERT-SFX.
  8708
  8709     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8710
  8711     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8712     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8713     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8714
  8715
  8716* EXEC CICS HANDLE CONDITION
  8717*         NOTFND   (0380-CLAIM-END-FILE)
  8718*         ENDFILE  (0380-CLAIM-END-FILE)
  8719*    END-EXEC.
  8720*    MOVE '"$I''                  ! $ #00008641' TO DFHEIV0
  8721     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8722     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8723     MOVE X'2420233030303038363431' TO DFHEIV0(25:11)
  8724     CALL 'kxdfhei1' USING DFHEIV0
  8725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8726
  8727
  8728
  8729* EXEC CICS STARTBR
  8730*         DATASET    ('ELMSTR')
  8731*         RIDFLD     (ELMSTR-KEY)
  8732*         GTEQ
  8733*    END-EXEC.
  8734     MOVE 'ELMSTR' TO DFHEIV1
  8735     MOVE 0
  8736       TO DFHEIV11
  8737*    MOVE '&,         G          &   #00008646' TO DFHEIV0
  8738     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8739     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8740     MOVE X'2020233030303038363436' TO DFHEIV0(25:11)
  8741     CALL 'kxdfhei1' USING DFHEIV0,
  8742           DFHEIV1,
  8743           ELMSTR-KEY,
  8744           DFHEIV99,
  8745           DFHEIV11,
  8746           DFHEIV99
  8747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8748
  8749
  8750     MOVE 'Y' TO WS-BROWSE-START-SW.
  8751
  8752
  8753* EXEC CICS READNEXT
  8754*         DATASET    ('ELMSTR')
  8755*         RIDFLD     (ELMSTR-KEY)
  8756*         SET        (ADDRESS OF CLAIM-MASTER)
  8757*    END-EXEC.
  8758     MOVE 'ELMSTR' TO DFHEIV1
  8759     MOVE 0
  8760       TO DFHEIV11
  8761*    MOVE '&.S                   )   #00008654' TO DFHEIV0
  8762     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 165
* EL156.cbl
  8763     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8764     MOVE X'2020233030303038363534' TO DFHEIV0(25:11)
  8765     CALL 'kxdfhei1' USING DFHEIV0,
  8766           DFHEIV1,
  8767           DFHEIV20,
  8768           DFHEIV99,
  8769           ELMSTR-KEY,
  8770           DFHEIV99,
  8771           DFHEIV11,
  8772           DFHEIV99,
  8773           DFHEIV99
  8774     SET ADDRESS OF CLAIM-MASTER TO
  8775         DFHEIV20
  8776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8777
  8778
  8779
  8780* EXEC CICS READPREV
  8781*         DATASET    ('ELMSTR')
  8782*         RIDFLD     (ELMSTR-KEY)
  8783*         SET        (ADDRESS OF CLAIM-MASTER)
  8784*    END-EXEC.
  8785     MOVE 'ELMSTR' TO DFHEIV1
  8786     MOVE 0
  8787       TO DFHEIV11
  8788*    MOVE '&0S                   )   #00008660' TO DFHEIV0
  8789     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8790     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8791     MOVE X'2020233030303038363630' TO DFHEIV0(25:11)
  8792     CALL 'kxdfhei1' USING DFHEIV0,
  8793           DFHEIV1,
  8794           DFHEIV20,
  8795           DFHEIV99,
  8796           ELMSTR-KEY,
  8797           DFHEIV99,
  8798           DFHEIV11,
  8799           DFHEIV99,
  8800           DFHEIV99
  8801     SET ADDRESS OF CLAIM-MASTER TO
  8802         DFHEIV20
  8803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8804
  8805
  8806 0360-BROWSE-BACKWARD.
  8807
  8808
  8809* EXEC CICS READPREV
  8810*         DATASET    ('ELMSTR')
  8811*         RIDFLD     (ELMSTR-KEY)
  8812*         SET        (ADDRESS OF CLAIM-MASTER)
  8813*    END-EXEC.
  8814     MOVE 'ELMSTR' TO DFHEIV1
  8815     MOVE 0
  8816       TO DFHEIV11
  8817*    MOVE '&0S                   )   #00008668' TO DFHEIV0
  8818     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8819     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8820     MOVE X'2020233030303038363638' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 166
* EL156.cbl
  8821     CALL 'kxdfhei1' USING DFHEIV0,
  8822           DFHEIV1,
  8823           DFHEIV20,
  8824           DFHEIV99,
  8825           ELMSTR-KEY,
  8826           DFHEIV99,
  8827           DFHEIV11,
  8828           DFHEIV99,
  8829           DFHEIV99
  8830     SET ADDRESS OF CLAIM-MASTER TO
  8831         DFHEIV20
  8832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8833
  8834
  8835     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8836        GO TO 0380-CLAIM-END-FILE.
  8837
  8838     IF PI-COMPANY-ID = 'CRI'
  8839         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8840            GO TO 0380-CLAIM-END-FILE.
  8841
  8842     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8843         GO TO 0360-BROWSE-BACKWARD.
  8844
  8845     IF PI-CARRIER-SECURITY > SPACES
  8846         IF CL-CARRIER = PI-CARRIER-SECURITY
  8847             NEXT SENTENCE
  8848         ELSE
  8849             GO TO 0360-BROWSE-BACKWARD.
  8850
  8851     IF PI-ACCOUNT-SECURITY > SPACES
  8852         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8853             NEXT SENTENCE
  8854         ELSE
  8855             GO TO 0360-BROWSE-BACKWARD.
  8856
  8857     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8858     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8859     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8860
  8861     GO TO 0400-FIRST-TIME.
  8862
  8863 0380-CLAIM-END-FILE.
  8864
  8865     MOVE ER-0130     TO EMI-ERROR.
  8866     MOVE -1          TO CLMNOL.
  8867     MOVE AL-UABON    TO CARRA
  8868                         CLMNOA
  8869                         CERTNOA
  8870                         SUFXA.
  8871
  8872     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8873
  8874     GO TO 8200-SEND-DATAONLY.
  8875
  8876 0400-FIRST-TIME.
  8877
  8878     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 167
* EL156.cbl
  8879        MOVE 'N'         TO WS-BROWSE-START-SW
  8880
  8881* EXEC CICS ENDBR
  8882*            DATASET    ('ELMSTR')
  8883*       END-EXEC.
  8884     MOVE 'ELMSTR' TO DFHEIV1
  8885     MOVE 0
  8886       TO DFHEIV11
  8887*    MOVE '&2                    $   #00008719' TO DFHEIV0
  8888     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8889     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8890     MOVE X'2020233030303038373139' TO DFHEIV0(25:11)
  8891     CALL 'kxdfhei1' USING DFHEIV0,
  8892           DFHEIV1,
  8893           DFHEIV11,
  8894           DFHEIV99
  8895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8896
  8897
  8898     IF PI-PROCESSOR-ID = 'LGXX'
  8899         NEXT SENTENCE
  8900     ELSE
  8901
  8902* EXEC CICS READQ TS
  8903*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8904*            INTO    (SECURITY-CONTROL)
  8905*            LENGTH  (SC-COMM-LENGTH)
  8906*            ITEM    (SC-ITEM)
  8907*        END-EXEC
  8908*    MOVE '*$II   L              ''   #00008726' TO DFHEIV0
  8909     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8910     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8911     MOVE X'2020233030303038373236' TO DFHEIV0(25:11)
  8912     CALL 'kxdfhei1' USING DFHEIV0,
  8913           PI-SECURITY-TEMP-STORE-ID,
  8914           SECURITY-CONTROL,
  8915           SC-COMM-LENGTH,
  8916           SC-ITEM,
  8917           DFHEIV99,
  8918           DFHEIV99
  8919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8920         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8921         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8922
  8923     MOVE LOW-VALUES             TO EL156AI.
  8924     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8925     MOVE 'Y'                    TO FIRST-ENTRY.
  8926     GO TO 7000-SHOW-CLAIM.
  8927
  8928 0500-CREATE-TEMP-STORAGE.
  8929     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8930
  8931
  8932* EXEC CICS WRITEQ TS
  8933*        QUEUE (QID)
  8934*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8935*        LENGTH(PI-COMM-LENGTH)
  8936*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 168
* EL156.cbl
  8937*    MOVE '*"     L              ''   #00008743' TO DFHEIV0
  8938     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8940     MOVE X'2020233030303038373433' TO DFHEIV0(25:11)
  8941     CALL 'kxdfhei1' USING DFHEIV0,
  8942           QID,
  8943           PROGRAM-INTERFACE-BLOCK,
  8944           PI-COMM-LENGTH,
  8945           DFHEIV99,
  8946           DFHEIV99,
  8947           DFHEIV99
  8948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8949
  8950
  8951
  8952* EXEC CICS WRITEQ TS
  8953*        QUEUE (QID)
  8954*        FROM  (EL156AI)
  8955*        LENGTH(MAP-LENGTH)
  8956*    END-EXEC.
  8957*    MOVE '*"     L              ''   #00008749' TO DFHEIV0
  8958     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8959     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8960     MOVE X'2020233030303038373439' TO DFHEIV0(25:11)
  8961     CALL 'kxdfhei1' USING DFHEIV0,
  8962           QID,
  8963           EL156AI,
  8964           MAP-LENGTH,
  8965           DFHEIV99,
  8966           DFHEIV99,
  8967           DFHEIV99
  8968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8969
  8970
  8971 0599-EXIT.
  8972      EXIT.
  8973
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 169
* EL156.cbl
  8975 0600-RECOVER-TEMP-STORAGE.
  8976
  8977* EXEC CICS READQ TS
  8978*        QUEUE (QID)
  8979*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8980*        LENGTH(PI-COMM-LENGTH)
  8981*    END-EXEC.
  8982*    MOVE '*$I    L              ''   #00008760' TO DFHEIV0
  8983     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8984     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8985     MOVE X'2020233030303038373630' TO DFHEIV0(25:11)
  8986     CALL 'kxdfhei1' USING DFHEIV0,
  8987           QID,
  8988           PROGRAM-INTERFACE-BLOCK,
  8989           PI-COMM-LENGTH,
  8990           DFHEIV99,
  8991           DFHEIV99,
  8992           DFHEIV99
  8993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8994
  8995
  8996
  8997* EXEC CICS READQ TS
  8998*        QUEUE (QID)
  8999*        INTO  (EL156AI)
  9000*        LENGTH(MAP-LENGTH)
  9001*    END-EXEC.
  9002*    MOVE '*$I    L              ''   #00008766' TO DFHEIV0
  9003     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9004     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9005     MOVE X'2020233030303038373636' TO DFHEIV0(25:11)
  9006     CALL 'kxdfhei1' USING DFHEIV0,
  9007           QID,
  9008           EL156AI,
  9009           MAP-LENGTH,
  9010           DFHEIV99,
  9011           DFHEIV99,
  9012           DFHEIV99
  9013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9014
  9015
  9016     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  9017
  9018     IF PMTTYPEI NOT = LOW-VALUES
  9019         MOVE AL-UANON           TO PMTTYPEA.
  9020
  9021     IF PAYEEI NOT = LOW-VALUES
  9022         MOVE AL-UANON           TO PAYEEA.
  9023
  9024     IF NOTE1I NOT = LOW-VALUES
  9025         MOVE AL-UANON           TO NOTE1A.
  9026
  9027     IF (RETURNED-FROM = 'EL614')
  9028        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  9029     END-IF
  9030*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  9031*       AND (PI-EOB-CODES-EXIST = 'Y')
  9032*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 170
* EL156.cbl
  9033*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  9034     IF PI-SET-NOTE2-MDT = 'Y'
  9035         MOVE AL-SANON           TO NOTE2A
  9036     END-IF
  9037
  9038     IF OFFLINEI NOT = LOW-VALUES
  9039         MOVE AL-UANON           TO OFFLINEA.
  9040
  9041*    IF GROUPEDI NOT = LOW-VALUES
  9042*        MOVE AL-UANON           TO GROUPEDA.
  9043
  9044*    IF CASHI NOT = LOW-VALUES
  9045*        MOVE AL-UANON           TO CASHA.
  9046
  9047     IF CHECKNOI NOT = LOW-VALUES
  9048         MOVE AL-UANON           TO CHECKNOA.
  9049
  9050     IF HOLDTILI NOT = LOW-VALUES
  9051         MOVE AL-UANON           TO HOLDTILA.
  9052
  9053     IF EPYFROMI NOT = LOW-VALUES
  9054         MOVE AL-UANON           TO EPYFROMA.
  9055
  9056     IF AIGFROMI NOT = LOW-VALUES
  9057         MOVE AL-UANON           TO AIGFROMA.
  9058
  9059     IF EPYTHRUI NOT = LOW-VALUES
  9060         MOVE AL-UANON           TO EPYTHRUA.
  9061
  9062     IF EDAYSI NOT = LOW-VALUES
  9063         MOVE AL-UNNON           TO EDAYSA.
  9064
  9065     IF EPYAMTL NOT = +0
  9066         MOVE AL-UNNON           TO EPYAMTA.
  9067
  9068     IF ERESVL NOT = +0
  9069         MOVE AL-UNNON           TO ERESVA.
  9070
  9071     IF EEXPENSL NOT = +0
  9072         MOVE AL-UNNON           TO EEXPENSA.
  9073
  9074     IF ETYPEI NOT = LOW-VALUES
  9075         MOVE AL-UNNON           TO ETYPEA.
  9076
  9077     IF PROOFDTI NOT = 0
  9078         MOVE AL-UNNON           TO PROOFDTA.
  9079
  9080     IF EOBYNI = 'Y' OR 'N' OR 'S'
  9081        MOVE AL-UANON            TO EOBYNA
  9082     END-IF
  9083     IF CLMFMYNI = 'Y' OR 'N'
  9084        MOVE AL-UANON            TO CLMFMYNA
  9085     END-IF
  9086
  9087     IF SURVYYNI = 'Y' OR 'N'
  9088        IF PI-APPROVAL-LEVEL = '4' OR '5'
  9089           MOVE AL-UANON         TO SURVYYNA
  9090        END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 171
* EL156.cbl
  9091     END-IF
  9092
  9093     IF SPRELYNI = 'Y' OR 'N'
  9094        MOVE AL-UANON            TO SPRELYNA
  9095     END-IF
  9096
  9097     .
  9098 0699-EXIT.
  9099      EXIT.
  9100
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 172
* EL156.cbl
  9102 0700-TEST-FOR-CHANGES.
  9103     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  9104         MOVE ER-0433            TO EMI-ERROR
  9105         GO TO 0750-FUNCTION-ERROR.
  9106
  9107     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  9108
  9109     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9110         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9111         MOVE 'A'                TO PI-PASS-SW
  9112         GO TO 1000-EDIT-DATA.
  9113
  9114     IF PI-FATAL-COUNT NOT = 0
  9115         MOVE ER-0499            TO EMI-ERROR
  9116         GO TO 0750-FUNCTION-ERROR.
  9117
  9118     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9119         MOVE ER-0500            TO EMI-ERROR
  9120         GO TO 0750-FUNCTION-ERROR.
  9121
  9122     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9123        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9124           MOVE ER-0542          TO EMI-ERROR
  9125           MOVE -1               TO EPYAMTL
  9126           GO TO 0750-FUNCTION-ERROR.
  9127
  9128     IF PI-OFFLINE = 'Y'  OR
  9129        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9130        MOVE EIBAID              TO PI-PFKEY-USED
  9131        GO TO 5000-UPDATE.
  9132
  9133     GO TO 6000-BUILD-SCREEN-B.
  9134
  9135 0750-FUNCTION-ERROR.
  9136     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9137
  9138     IF ENTERPFL > 0
  9139         MOVE -1                 TO ENTERPFL
  9140         MOVE AL-UNBON           TO ENTERPFA
  9141         GO TO 8200-SEND-DATAONLY
  9142     ELSE
  9143         MOVE -1                 TO ENTERPFL
  9144         MOVE AL-UNNOF           TO ENTERPFA
  9145         GO TO 8200-SEND-DATAONLY.
  9146
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 173
* EL156.cbl
  9148 0800-DELETE-TS.
  9149
  9150* EXEC CICS HANDLE CONDITION
  9151*        QIDERR(0800-EXIT)
  9152*    END-EXEC.
  9153*    MOVE '"$N                   ! % #00008905' TO DFHEIV0
  9154     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9155     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9156     MOVE X'2520233030303038393035' TO DFHEIV0(25:11)
  9157     CALL 'kxdfhei1' USING DFHEIV0
  9158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9159
  9160
  9161
  9162* EXEC CICS DELETEQ TS
  9163*        QUEUE(QID)
  9164*    END-EXEC.
  9165*    MOVE '*&                    #   #00008909' TO DFHEIV0
  9166     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9167     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9168     MOVE X'2020233030303038393039' TO DFHEIV0(25:11)
  9169     CALL 'kxdfhei1' USING DFHEIV0,
  9170           QID,
  9171           DFHEIV99
  9172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9173
  9174
  9175 0800-EXIT.
  9176      EXIT.
  9177 0900-GET-DDF-LIMITS.
  9178
  9179     if cm-clp-state = zeros or spaces or low-values
  9180        move cm-state            to cm-clp-state
  9181     end-if
  9182     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9183     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9184     MOVE cm-clp-state           TO ERPDEF-STATE
  9185     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9186     evaluate true
  9187        when (cl-claim-type = 'L' or 'P')
  9188           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9189             and 'CU')
  9190           move 'L'              to erpdef-ben-type
  9191           move pi-lf-benefit-cd to erpdef-ben-code
  9192        when (cl-claim-type not = 'L' and 'P')
  9193           and (pi-ah-benefit-cd not = '00' and '  ')
  9194           move 'A'              to erpdef-ben-type
  9195           move pi-ah-benefit-cd to erpdef-ben-code
  9196        when (cl-claim-type not = 'L' and 'P')
  9197           and (pi-ah-benefit-cd = '00' or '  ')
  9198           move 'L'              to erpdef-ben-type
  9199           move pi-lf-benefit-cd to erpdef-ben-code
  9200        when (cl-claim-type = 'L' or 'P')
  9201           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9202           move 'A'              to erpdef-ben-type
  9203           move pi-ah-benefit-cd to erpdef-ben-code
  9204        when other
  9205           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 174
* EL156.cbl
  9206           move pi-ah-benefit-cd to erpdef-ben-code
  9207     end-evaluate
  9208*    if (cl-claim-type = 'L' or 'P')
  9209*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9210*          and 'CU')
  9211*       move 'L'                 to erpdef-ben-type
  9212*       move pi-lf-benefit-cd    to erpdef-ben-code
  9213*    else
  9214*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9215*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9216*    end-if
  9217     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9218
  9219     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9220
  9221
  9222* EXEC CICS STARTBR
  9223*        DATASET  ('ERPDEF')
  9224*        RIDFLD   (ERPDEF-KEY)
  9225*        GTEQ
  9226*        RESP     (WS-RESPONSE)
  9227*    END-EXEC
  9228     MOVE 'ERPDEF' TO DFHEIV1
  9229     MOVE 0
  9230       TO DFHEIV11
  9231*    MOVE '&,         G          &  N#00008959' TO DFHEIV0
  9232     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9233     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9234     MOVE X'204E233030303038393539' TO DFHEIV0(25:11)
  9235     CALL 'kxdfhei1' USING DFHEIV0,
  9236           DFHEIV1,
  9237           ERPDEF-KEY,
  9238           DFHEIV99,
  9239           DFHEIV11,
  9240           DFHEIV99
  9241     MOVE EIBRESP  TO WS-RESPONSE
  9242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9243
  9244     IF NOT WS-RESP-NORMAL
  9245        GO TO 0900-EXIT
  9246     END-IF
  9247
  9248     .
  9249 0900-READNEXT.
  9250
  9251
  9252* EXEC CICS READNEXT
  9253*       DATASET  ('ERPDEF')
  9254*       SET      (ADDRESS OF PRODUCT-MASTER)
  9255*       RIDFLD   (ERPDEF-KEY)
  9256*       RESP     (WS-RESPONSE)
  9257*    END-EXEC
  9258     MOVE 'ERPDEF' TO DFHEIV1
  9259     MOVE 0
  9260       TO DFHEIV11
  9261*    MOVE '&.S                   )  N#00008973' TO DFHEIV0
  9262     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9263     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 175
* EL156.cbl
  9264     MOVE X'204E233030303038393733' TO DFHEIV0(25:11)
  9265     CALL 'kxdfhei1' USING DFHEIV0,
  9266           DFHEIV1,
  9267           DFHEIV20,
  9268           DFHEIV99,
  9269           ERPDEF-KEY,
  9270           DFHEIV99,
  9271           DFHEIV11,
  9272           DFHEIV99,
  9273           DFHEIV99
  9274     SET ADDRESS OF PRODUCT-MASTER TO
  9275         DFHEIV20
  9276     MOVE EIBRESP  TO WS-RESPONSE
  9277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9278
  9279     IF NOT WS-RESP-NORMAL
  9280        GO TO 0900-ENDBR
  9281     END-IF
  9282
  9283     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9284        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9285           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9286        ELSE
  9287           GO TO 0900-READNEXT
  9288        END-IF
  9289     ELSE
  9290        GO TO 0900-ENDBR
  9291     END-IF
  9292
  9293     IF CM-LOAN-TERM = ZEROS
  9294        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9295     END-IF
  9296
  9297     .
  9298 0900-ENDBR.
  9299
  9300
  9301* EXEC CICS ENDBR
  9302*       DATASET  ('ERPDEF')
  9303*    END-EXEC
  9304     MOVE 'ERPDEF' TO DFHEIV1
  9305     MOVE 0
  9306       TO DFHEIV11
  9307*    MOVE '&2                    $   #00009001' TO DFHEIV0
  9308     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9309     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9310     MOVE X'2020233030303039303031' TO DFHEIV0(25:11)
  9311     CALL 'kxdfhei1' USING DFHEIV0,
  9312           DFHEIV1,
  9313           DFHEIV11,
  9314           DFHEIV99
  9315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9316
  9317     .
  9318 0900-EXIT.
  9319     EXIT.
  9320 1000-EDIT-DATA.
  9321
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 176
* EL156.cbl
  9322     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9323         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9324         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9325
  9326     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9327
  9328     IF NOT MODIFY-CAP
  9329         MOVE ER-0070            TO EMI-ERROR
  9330         MOVE -1                 TO PMTTYPEL
  9331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9332         GO TO 2000-EDIT-DONE.
  9333
  9334     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9335                         '5' AND '6'
  9336         MOVE ER-0420            TO EMI-ERROR
  9337         MOVE -1                 TO PMTTYPEL
  9338         MOVE AL-UABON           TO PMTTYPEA
  9339         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9340     ELSE
  9341         MOVE AL-UANON           TO PMTTYPEA.
  9342
  9343*    IF PI-OFFLINE = 'Y'
  9344*       IF PI-GROUPED = 'Y'
  9345*          MOVE ER-1880         TO EMI-ERROR
  9346*          MOVE -1              TO GROUPEDL
  9347*          MOVE AL-UABON        TO GROUPEDA
  9348*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9349*
  9350*    IF GROUPEDL > +0
  9351*       IF PI-GROUPED = 'Y' OR 'N'
  9352*          MOVE AL-UANON TO GROUPEDA
  9353*       ELSE
  9354*          MOVE ER-3140            TO EMI-ERROR
  9355*          MOVE -1                 TO GROUPEDL
  9356*          MOVE AL-UABON           TO GROUPEDA
  9357*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9358*
  9359*    IF CASHL > +0
  9360*       IF PI-CASH = 'Y' OR 'N'
  9361*          MOVE AL-UANON           TO CASHA
  9362*       ELSE
  9363*          MOVE ER-3141            TO EMI-ERROR
  9364*          MOVE -1                 TO CASHL
  9365*          MOVE AL-UABON           TO CASHA
  9366*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9367
  9368     IF LOANNOL > +0
  9369         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9370
  9371 1000-EDIT-PAYEE.
  9372
  9373     IF PI-PAYEE-SEQ NOT NUMERIC
  9374         MOVE ER-0294            TO  EMI-ERROR
  9375         MOVE -1                 TO  PAYEEL
  9376         MOVE AL-UABON           TO  PAYEEA
  9377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9378         GO TO 1000-CONT-EDIT.
  9379
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 177
* EL156.cbl
  9380     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9381                         'E' OR 'O' OR 'Q'
  9382         NEXT SENTENCE
  9383     ELSE
  9384         MOVE ER-0294            TO  EMI-ERROR
  9385         MOVE -1                 TO  PAYEEL
  9386         MOVE AL-UABON           TO  PAYEEA
  9387         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9388         GO TO 1000-CONT-EDIT.
  9389
  9390     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9391        (PI-PAYEE-SEQ NOT < '1' AND
  9392         PI-PAYEE-SEQ NOT > '9'))
  9393      OR
  9394        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9395         (PI-PAYEE-SEQ NOT > '9'))
  9396         MOVE AL-UANON            TO PAYEEA
  9397     ELSE
  9398         MOVE ER-0294            TO EMI-ERROR
  9399         MOVE -1                 TO PAYEEL
  9400         MOVE AL-UABON           TO PAYEEA
  9401         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9402
  9403     IF PI-COMPANY-ID = 'DMD'
  9404         IF PI-PAYEE-TYPE = 'B' AND
  9405            PI-PAYEE-SEQ NOT = '0'
  9406               MOVE ER-7841            TO EMI-ERROR
  9407               MOVE -1                 TO PAYEEL
  9408               MOVE AL-UABON           TO PAYEEA
  9409               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9410
  9411     IF PI-COMPANY-ID = 'JHL'
  9412         IF PI-PAYEE = 'B0'
  9413             NEXT SENTENCE
  9414           ELSE
  9415
  9416* EXEC CICS HANDLE CONDITION
  9417*            ENDFILE(1950-NOT-FOUND)
  9418*            NOTFND (1950-NOT-FOUND)
  9419*        END-EXEC
  9420*    MOVE '"$''I                  ! & #00009103' TO DFHEIV0
  9421     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9422     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9423     MOVE X'2620233030303039313033' TO DFHEIV0(25:11)
  9424     CALL 'kxdfhei1' USING DFHEIV0
  9425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9426         MOVE 'N'                    TO FOUND-TOL-SW
  9427         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9428         MOVE '2'                    TO CNTL-REC-TYPE
  9429         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9430         MOVE +0                     TO CNTL-SEQ-NO
  9431         MOVE 'PROC'                 TO FILE-SWITCH
  9432         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9433         IF PI-PAYEE = 'I1' AND
  9434            APPROVAL-LEVEL-2
  9435             NEXT SENTENCE
  9436           ELSE
  9437         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 178
* EL156.cbl
  9438             MOVE ER-3546        TO EMI-ERROR
  9439             MOVE -1             TO PAYEEL
  9440             MOVE AL-UABON       TO PAYEEA
  9441             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9442
  9443     IF PI-PAYEE-TYPE = 'E'
  9444        IF PI-PMTTYPE = '5' OR '6'
  9445            NEXT SENTENCE
  9446        ELSE
  9447            MOVE ER-3539            TO EMI-ERROR
  9448            MOVE -1                 TO PAYEEL
  9449            MOVE AL-UABON           TO PAYEEA
  9450            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9451
  9452 1000-CONT-EDIT.
  9453
  9454     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9455        IF PI-EPYAMT NOT NEGATIVE
  9456            MOVE ER-0421         TO EMI-ERROR
  9457            MOVE -1              TO OFFLINEL
  9458            MOVE AL-UABON        TO OFFLINEA
  9459            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9460        ELSE
  9461            MOVE AL-UANON        TO OFFLINEA.
  9462
  9463     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  9464        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9465           CONTINUE
  9466        ELSE
  9467           IF PI-PRINT-EOB-YN = 'S' AND
  9468              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9469                CONTINUE
  9470           ELSE
  9471              MOVE ER-1561       TO EMI-ERROR
  9472              MOVE -1            TO EOBYNL
  9473              MOVE AL-UABON      TO EOBYNA
  9474              PERFORM 9900-ERROR-FORMAT
  9475                                 THRU 9900-EXIT
  9476           END-IF
  9477        END-IF
  9478
  9479        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9480            MOVE ER-1566        TO EMI-ERROR
  9481            MOVE -1             TO CLMFMYNL
  9482            MOVE AL-UABON       TO CLMFMYNA
  9483            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9484        END-IF
  9485
  9486        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9487            MOVE ER-1567        TO EMI-ERROR
  9488            MOVE -1             TO SURVYYNL
  9489            MOVE AL-UABON       TO SURVYYNA
  9490            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9491        END-IF
  9492
  9493        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9494            MOVE ER-1569        TO EMI-ERROR
  9495            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 179
* EL156.cbl
  9496            MOVE AL-UABON       TO SPRELYNA
  9497            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9498        END-IF
  9499
  9500     END-IF
  9501     IF PI-EPYAMT IS NEGATIVE
  9502         IF PI-OFFLINE NOT = 'Y'
  9503             MOVE ER-0836        TO  EMI-ERROR
  9504             MOVE -1             TO  OFFLINEL
  9505             MOVE AL-UABON       TO  OFFLINEA
  9506             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9507
  9508     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9509        MOVE ER-0872             TO EMI-ERROR
  9510        MOVE -1                  TO PROOFDTL
  9511        MOVE AL-UABON            TO PROOFDTA
  9512        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9513     ELSE
  9514        MOVE '4'                TO DC-OPTION-CODE
  9515        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9516        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9517        IF DATE-CONVERSION-ERROR
  9518            MOVE ER-0873        TO EMI-ERROR
  9519            MOVE -1                  TO PROOFDTL
  9520            MOVE AL-UABON            TO PROOFDTA
  9521            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9522        ELSE
  9523            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9524            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9525                MOVE ER-0873    TO EMI-ERROR
  9526                MOVE -1                  TO PROOFDTL
  9527                MOVE AL-UABON            TO PROOFDTA
  9528                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9529            END-IF
  9530        END-IF
  9531     END-IF.
  9532
  9533     IF PI-COMPANY-ID = 'DMD'
  9534        IF NOTE1L NOT = ZEROS
  9535            MOVE ER-7844        TO  EMI-ERROR
  9536            MOVE -1             TO  NOTE1L
  9537            MOVE AL-UABON       TO  NOTE1A
  9538            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9539
  9540     IF PI-COMPANY-ID = 'DMD'
  9541        IF NOTE2L NOT = ZEROS
  9542          GO TO 1004-DMD-EOB-CHECKS.
  9543
  9544     IF NOTE1L NOT > +0
  9545         GO TO 1005-CHECK-ERRORS.
  9546
  9547     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9548         GO TO 1005-CHECK-ERRORS.
  9549
  9550     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9551         GO TO 1003-HAN-PMT-NOTES.
  9552
  9553     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 180
* EL156.cbl
  9554
  9555     IF WS-PMTOPTION NUMERIC
  9556        IF WS-PMTOPTION > '00' AND < '17'
  9557           NEXT SENTENCE
  9558        ELSE
  9559           MOVE ER-0618          TO EMI-ERROR
  9560           MOVE -1               TO NOTE1L
  9561           MOVE AL-UABON         TO NOTE1A
  9562           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9563     ELSE
  9564        GO TO 1005-CHECK-ERRORS.
  9565
  9566     IF WS-PMTOPTION = '05' AND
  9567        WS-DOCNAME = SPACES
  9568          MOVE ER-0616             TO EMI-ERROR
  9569          MOVE -1                  TO NOTE1L
  9570          MOVE AL-UABON            TO NOTE1A
  9571          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9572
  9573     IF WS-PMTOPTION = '15' OR '16'
  9574
  9575* EXEC CICS BIF DEEDIT
  9576*            FIELD (WS-AMOUNT)
  9577*            LENGTH(08)
  9578*        END-EXEC
  9579     MOVE 08
  9580       TO DFHEIV11
  9581*    MOVE '@"L                   #   #00009255' TO DFHEIV0
  9582     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9583     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9584     MOVE X'2020233030303039323535' TO DFHEIV0(25:11)
  9585     CALL 'kxdfhei1' USING DFHEIV0,
  9586           WS-AMOUNT,
  9587           DFHEIV11
  9588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9589        IF (WS-NUM-AMT = ZEROS) OR
  9590           (WS-AMOUNT NOT NUMERIC)
  9591           MOVE ER-0617          TO EMI-ERROR
  9592           MOVE -1               TO NOTE1L
  9593           MOVE AL-UABON         TO NOTE1A
  9594           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9595
  9596     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9597
  9598     GO TO 1005-CHECK-ERRORS.
  9599
  9600 1003-HAN-PMT-NOTES.
  9601
  9602     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9603
  9604     IF WS-HAN-PMT-CODE = SPACE
  9605         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9606     ELSE
  9607     IF WS-HAN-PMT-CODE = 'A'
  9608         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9609                                 TO WS-HAN-PMT-NOTE
  9610     ELSE
  9611     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 181
* EL156.cbl
  9612         MOVE ':FINAL PAYMENT / DECEASED'
  9613                                 TO WS-HAN-PMT-NOTE
  9614     ELSE
  9615     IF WS-HAN-PMT-CODE = 'C'
  9616         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9617                                 TO WS-HAN-PMT-NOTE
  9618     ELSE
  9619     IF WS-HAN-PMT-CODE = 'D'
  9620         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9621                                 TO WS-HAN-PMT-NOTE
  9622     ELSE
  9623     IF WS-HAN-PMT-CODE = 'E'
  9624         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9625                                 TO WS-HAN-PMT-NOTE
  9626     ELSE
  9627     IF WS-HAN-PMT-CODE = 'F'
  9628         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9629                                 TO WS-HAN-PMT-NOTE
  9630     ELSE
  9631     IF WS-HAN-PMT-CODE = 'P'
  9632         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9633
  9634     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9635     GO TO 1005-CHECK-ERRORS.
  9636
  9637 1004-DMD-EOB-CHECKS.
  9638
  9639     INITIALIZE PI-AT-EOB-CODES.
  9640
  9641     IF NOTE2I (20:21) > SPACES
  9642         MOVE ER-7845          TO EMI-ERROR
  9643         MOVE -1               TO NOTE2L
  9644         MOVE AL-UABON         TO NOTE2A
  9645         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9646         GO TO 1005-CHECK-ERRORS
  9647      ELSE
  9648         MOVE NOTE2I             TO W-EOB-CODES.
  9649
  9650     MOVE +1                     TO W-EOB-NDX.
  9651
  9652 1004-CHECK-EACH-EOB.
  9653
  9654     IF W-EOB-NDX > +5
  9655             OR
  9656        W-EOB-CODE (W-EOB-NDX) = SPACES
  9657         GO TO 1004-CHECK-DUP-EOB.
  9658
  9659     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9660         MOVE ER-0956            TO EMI-ERROR
  9661         MOVE -1                 TO NOTE2L
  9662         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9663         GO TO 1005-CHECK-ERRORS.
  9664
  9665     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9666     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9667     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9668     MOVE 'DLO023'               TO PGM-NAME.
  9669
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 182
* EL156.cbl
  9670
  9671* EXEC CICS LINK
  9672*        PROGRAM    (PGM-NAME)
  9673*        COMMAREA   (CD-COMMUNICATION-AREA)
  9674*        LENGTH     (CD-RCRD-LENGTH)
  9675*    END-EXEC.
  9676*    MOVE '."C                   (   #00009340' TO DFHEIV0
  9677     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9678     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9679     MOVE X'2020233030303039333430' TO DFHEIV0(25:11)
  9680     CALL 'kxdfhei1' USING DFHEIV0,
  9681           PGM-NAME,
  9682           CD-COMMUNICATION-AREA,
  9683           CD-RCRD-LENGTH,
  9684           DFHEIV99,
  9685           DFHEIV99,
  9686           DFHEIV99,
  9687           DFHEIV99
  9688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9689
  9690
  9691     IF CD-RETURN-CODE = 'OK'
  9692         GO TO 1004-CONT.
  9693
  9694     MOVE -1                     TO NOTE2L.
  9695
  9696     IF CD-RETURN-CODE = '01'
  9697         MOVE ER-8310            TO EMI-ERROR
  9698         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9699         GO TO 1005-CHECK-ERRORS.
  9700
  9701     IF CD-RETURN-CODE = '02'
  9702         MOVE ER-8311            TO EMI-ERROR
  9703         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9704         GO TO 1005-CHECK-ERRORS.
  9705
  9706     IF CD-RETURN-CODE = '03'
  9707         MOVE ER-8312            TO EMI-ERROR
  9708         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9709         GO TO 1005-CHECK-ERRORS.
  9710
  9711     IF CD-RETURN-CODE = '04'
  9712         MOVE ER-8313            TO EMI-ERROR
  9713         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9714         GO TO 1005-CHECK-ERRORS.
  9715
  9716     IF CD-RETURN-CODE = '05'
  9717         MOVE ER-8314            TO EMI-ERROR
  9718         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9719         GO TO 1005-CHECK-ERRORS.
  9720
  9721     IF CD-RETURN-CODE = '06'
  9722         MOVE ER-8315            TO EMI-ERROR
  9723         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9724         GO TO 1005-CHECK-ERRORS.
  9725
  9726     IF CD-RETURN-CODE = 'E1'
  9727         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 183
* EL156.cbl
  9728         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9729         GO TO 1005-CHECK-ERRORS.
  9730
  9731     IF CD-RETURN-CODE = 'N1'
  9732         MOVE ER-8317            TO EMI-ERROR
  9733         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9734         GO TO 1005-CHECK-ERRORS.
  9735
  9736 1004-CONT.
  9737     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9738
  9739     ADD +1 TO W-EOB-NDX.
  9740     GO TO 1004-CHECK-EACH-EOB.
  9741
  9742 1004-CHECK-DUP-EOB.
  9743     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9744         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9745                               PI-AT-EOB-CODE (3) OR
  9746                               PI-AT-EOB-CODE (4) OR
  9747                               PI-AT-EOB-CODE (5)))
  9748                  OR
  9749        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9750         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9751                               PI-AT-EOB-CODE (4) OR
  9752                               PI-AT-EOB-CODE (5)))
  9753                  OR
  9754        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9755         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9756                               PI-AT-EOB-CODE (5)))
  9757                  OR
  9758        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9759         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9760            MOVE ER-8000            TO EMI-ERROR
  9761            MOVE AL-UABON           TO NOTE2A
  9762            MOVE -1                 TO NOTE2L
  9763            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9764            GO TO 1005-CHECK-ERRORS.
  9765
  9766 1005-CHECK-ERRORS.
  9767*    IF PI-COMPANY-ID NOT = 'DMD'
  9768        GO TO 1006-CHECK-ERRORS.
  9769
  9770*********  DMD CODE START ******************
  9771*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9772*       GO TO 1006-CHECK-ERRORS.
  9773*
  9774*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9775*
  9776*    COMPUTE W-PAYMENT-TOTAL
  9777*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9778*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9779*               AND
  9780*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9781*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9782*          MOVE ER-0967    TO EMI-ERROR
  9783*          MOVE -1         TO PMTTYPEL
  9784*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9785*
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 184
* EL156.cbl
  9786*    GO TO 1006-CHECK-ERRORS.
  9787*********  DMD CODE END ******************
  9788
  9789 1006-CHECK-ERRORS.
  9790     if emi-forcable-ctr = zeros
  9791        and emi-fatal-ctr = zeros
  9792        continue
  9793     else
  9794        IF NOT EMI-NO-ERRORS
  9795           GO TO 2000-EDIT-DONE
  9796        end-if
  9797     end-if
  9798
  9799* EXEC CICS HANDLE CONDITION
  9800*        NOTFND(1950-NOT-FOUND)
  9801*    END-EXEC.
  9802*    MOVE '"$I                   ! '' #00009453' TO DFHEIV0
  9803     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9804     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9805     MOVE X'2720233030303039343533' TO DFHEIV0(25:11)
  9806     CALL 'kxdfhei1' USING DFHEIV0
  9807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9808
  9809
  9810     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9811     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9812     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9813     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9814     MOVE 'MSTR'                 TO FILE-SWITCH.
  9815
  9816     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9817
  9818     IF PI-COMPANY-ID = 'DMD'
  9819         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9820
  9821     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9822        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9823           MOVE ER-0873    TO EMI-ERROR
  9824           MOVE -1                  TO PROOFDTL
  9825           MOVE AL-UABON            TO PROOFDTA
  9826           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9827        END-IF
  9828     END-IF
  9829     if cl-benefit-period = zeros
  9830        move er-1667             to emi-error
  9831        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9832     end-if
  9833     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9834     MOVE +95                    TO TRLR-SEQ-NO
  9835
  9836* EXEC CICS READ
  9837*       DATASET  ('ELTRLR')
  9838*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9839*       RIDFLD   (ELTRLR-KEY)
  9840*       RESP     (WS-RESPONSE)
  9841*    END-EXEC
  9842     MOVE 'ELTRLR' TO DFHEIV1
  9843*    MOVE '&"S        E          (  N#00009482' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 185
* EL156.cbl
  9844     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9845     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9846     MOVE X'204E233030303039343832' TO DFHEIV0(25:11)
  9847     CALL 'kxdfhei1' USING DFHEIV0,
  9848           DFHEIV1,
  9849           DFHEIV20,
  9850           DFHEIV99,
  9851           ELTRLR-KEY,
  9852           DFHEIV99,
  9853           DFHEIV99,
  9854           DFHEIV99
  9855     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9856         DFHEIV20
  9857     MOVE EIBRESP  TO WS-RESPONSE
  9858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9859
  9860     if ws-resp-normal
  9861        perform varying s1 from +1 by +1 until
  9862           at-note-error-no (s1) = spaces
  9863           if at-note-error-no (s1) = '1662'
  9864              continue
  9865           else
  9866              move at-note-error-no (s1)
  9867                                 to emi-error
  9868              if at-note-error-no (s1) = '1653'
  9869                 evaluate true
  9870                    when cl-claim-type = 'L'
  9871                       move '  LF  '
  9872                                 to emi-claim-type
  9873                    when cl-claim-type = 'I'
  9874                       move '  IU  '
  9875                                 to emi-claim-type
  9876                    when cl-claim-type = 'A'
  9877                       move '  AH  '
  9878                                 to emi-claim-type
  9879                    when other
  9880                       move ' FMLA '
  9881                                 to emi-claim-type
  9882                 end-evaluate
  9883              end-if
  9884              PERFORM 9900-ERROR-FORMAT
  9885                                 THRU 9900-EXIT
  9886           end-if
  9887        end-perform
  9888     end-if
  9889     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9890         IF PI-PMTTYPE = '5' OR '6'
  9891             NEXT SENTENCE
  9892         ELSE
  9893             MOVE ER-0555             TO EMI-ERROR
  9894             MOVE -1                  TO PMTTYPEL
  9895             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9896
  9897     IF CL-LAST-CLOSE-REASON = '2'
  9898         IF CL-CLAIM-STATUS = 'C'
  9899             MOVE ER-0760        TO  EMI-ERROR
  9900             MOVE -1             TO  PMTTYPEL
  9901             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 186
* EL156.cbl
  9902
  9903     IF PI-ACTIVITY-CODE = 9
  9904         MOVE ER-3538            TO  EMI-ERROR
  9905         MOVE -1                 TO  PMTTYPEL
  9906         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9907
  9908     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9909         GO TO 1008-READ-CERT.
  9910**********************AIG LOGIC STARTS *********************
  9911     IF CL-CERT-PRIME = 'INCOMPLETE'
  9912         MOVE ER-3540            TO  EMI-ERROR
  9913         MOVE -1                 TO  PMTTYPEL
  9914         MOVE AL-UABON           TO  PMTTYPEA
  9915         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9916         GO TO 2000-EDIT-DONE.
  9917
  9918     IF PI-PMTTYPE = '4'
  9919         IF PI-EPYAMT IS NEGATIVE
  9920             IF PI-ECHECKNO-CR = 'CR'
  9921                 NEXT SENTENCE
  9922             ELSE
  9923                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9924
  9925     IF PI-PMTTYPE = '4'
  9926         IF PI-ECHECKNO-CR = 'CR'
  9927             IF PI-EPYAMT IS NEGATIVE
  9928                 NEXT SENTENCE
  9929             ELSE
  9930                 MOVE ER-0834    TO  EMI-ERROR
  9931                 MOVE -1         TO  EPYAMTL
  9932                 MOVE AL-UNBON   TO  EPYAMTA
  9933                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9934
  9935     IF PI-PMTTYPE = '4'
  9936         IF PI-EPYAMT IS NEGATIVE
  9937             IF PI-OFFLINE = 'Y'
  9938                 NEXT SENTENCE
  9939             ELSE
  9940                 MOVE 'Y'        TO  PI-OFFLINE
  9941                                     WS-OFFLINE
  9942                                     OFFLINEO
  9943                 MOVE AL-UANON   TO  OFFLINEA.
  9944
  9945*    IF PI-PMTTYPE = '4'
  9946*        IF PI-EPYAMT IS NEGATIVE
  9947*            IF PI-CASH = 'Y'
  9948*                NEXT SENTENCE
  9949*            ELSE
  9950*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9951*                MOVE AL-UANON   TO  CASHA
  9952*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9953*
  9954*    IF PI-CASH NOT = 'Y' AND 'N'
  9955*         IF PI-OFFLINE = 'Y'  AND
  9956*            PI-ECHECKNO-CR = 'CR'
  9957*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9958*              MOVE AL-UANON     TO  CASHA
  9959*              GO TO 1007-DEFAULT-AIG-CHECKNO.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 187
* EL156.cbl
  9960*
  9961*    IF PI-CASH NOT = 'Y' AND 'N'
  9962*        IF PI-PMTTYPE = '5' OR '6'
  9963*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9964*            MOVE AL-UANON       TO  CASHA
  9965*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9966*
  9967*    IF PI-CASH NOT = 'Y' AND 'N'
  9968*       IF CL-ASSOCIATES = 'N' OR 'A'
  9969*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9970*           MOVE AL-UANON        TO  CASHA
  9971*       ELSE
  9972*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9973*           MOVE AL-UANON        TO  CASHA.
  9974*
  9975*    IF PI-PMTTYPE = '5' OR '6'
  9976*        IF PI-CASH = 'N'
  9977*            MOVE ER-0819        TO  EMI-ERROR
  9978*            MOVE AL-UANON       TO  CASHA
  9979*            MOVE -1             TO  CASHL
  9980*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9981*
  9982*    IF CL-ASSOCIATES = 'N' OR 'A'
  9983*       IF CASHI = 'N'
  9984*        MOVE ER-3537            TO  EMI-ERROR
  9985*        MOVE AL-UANON           TO  CASHA
  9986*        MOVE -1                 TO  CASHL
  9987*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9988
  9989 1007-DEFAULT-AIG-CHECKNO.
  9990
  9991     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9992         MOVE ER-3532            TO  EMI-ERROR
  9993         MOVE -1                 TO  PMTTYPEL
  9994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9995**********************AIG LOGIC ENDS ***********************
  9996
  9997 1008-READ-CERT.
  9998
  9999     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 10000     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 10001     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 10002     MOVE CL-CERT-STATE          TO CERT-STATE.
 10003     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 10004     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 10005     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 10006     MOVE 'CERT'                 TO FILE-SWITCH.
 10007
 10008     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 10009
 10010     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10011        MOVE CM-LF-LOAN-EXPIRE-DT
 10012                                 TO WS-EXP-DT PI-EXP-DT
 10013                                    ws-extended-exp-dt
 10014     ELSE
 10015        MOVE CM-AH-LOAN-EXPIRE-DT
 10016                                 TO WS-EXP-DT PI-EXP-DT
 10017                                    ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 188
* EL156.cbl
 10018     end-if
 10019     MOVE '6'           TO DC-OPTION-CODE
 10020     if pi-dcc-product-code not = spaces
 10021        move cm-ah-benefit-cd    to pi-ah-benefit-cd
 10022        move cm-lf-benefit-cd    to pi-lf-benefit-cd
 10023        PERFORM 0900-GET-DDF-limits
 10024                                 THRU 0900-EXIT
 10025        IF PDEF-FOUND
 10026         AND CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 10027           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10028              (P1 > +8)
 10029              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 10030           END-PERFORM
 10031           IF P1 < +9
 10032              MOVE '6'           TO DC-OPTION-CODE
 10033              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10034              IF CL-NO-OF-EXTENSIONS NUMERIC
 10035               display ' 156 - no of ext ' CL-NO-OF-EXTENSIONS
 10036                 MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10037                                             PI-MAX-EXT
 10038              ELSE
 10039                 MOVE PD-MAX-EXTENSION (P1)
 10040                                 TO DC-ELAPSED-MONTHS
 10041              END-IF
 10042              PERFORM 9700-LINK-DATE-CONVERT
 10043                                 THRU 9700-EXIT
 10044              if no-conversion-error
 10045                 move dc-bin-date-2 to ws-extended-exp-dt
 10046              end-if
 10047           else
 10048              move er-1674       to emi-error
 10049              PERFORM 9900-ERROR-FORMAT
 10050                                 THRU 9900-EXIT
 10051           end-if
 10052        ELSE
 10053           IF CL-NO-OF-EXTENSIONS NUMERIC
 10054              MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10055                                          PI-MAX-EXT
 10056           ELSE
 10057              MOVE ZERO  TO DC-ELAPSED-MONTHS
 10058           END-IF
 10059           MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10060           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10061           if no-conversion-error
 10062              move dc-bin-date-2 to ws-extended-exp-dt
 10063           end-if
 10064        end-if
 10065     ELSE
 10066        IF CL-NO-OF-EXTENSIONS NUMERIC
 10067           MOVE CL-NO-OF-EXTENSIONS TO DC-ELAPSED-MONTHS
 10068                                       PI-MAX-EXT
 10069        ELSE
 10070           MOVE ZERO  TO DC-ELAPSED-MONTHS
 10071        END-IF
 10072        MOVE WS-EXP-DT     TO DC-BIN-DATE-1
 10073        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10074        if no-conversion-error
 10075           move dc-bin-date-2 to ws-extended-exp-dt
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 189
* EL156.cbl
 10076        end-if
 10077     end-if
 10078*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10079*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
 10080
 10081     IF CL-INCURRED-DT < CM-CERT-EFF-DT
 10082         MOVE ER-0458            TO EMI-ERROR
 10083         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10084
 10085     IF (CL-INCURRED-DT > WS-EXP-DT)
 10086        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
 10087        MOVE ER-1677             TO EMI-ERROR
 10088        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
 10089     END-IF
 10090     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
 10091     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
 10092         MOVE ER-0459            TO EMI-ERROR
 10093         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10094
 10095     IF CL-REPORTED-DT = LOW-VALUES
 10096        MOVE ER-0530             TO EMI-ERROR
 10097        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10098
 10099     IF PI-COMPANY-ID = 'NCL'
 10100        IF CM-CREDIT-INTERFACE-SW-1 = '2'
 10101            MOVE ER-0770            TO EMI-ERROR
 10102            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10103
 10104     IF PI-COMPANY-ID = 'NCL'
 10105        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
 10106            MOVE ER-0737            TO EMI-ERROR
 10107            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10108
 10109     IF CM-ENTRY-STATUS = 'D' OR 'V'
 10110         MOVE ER-0768            TO  EMI-ERROR
 10111         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10112
 10113     IF CM-CREDIT-INTERFACE-SW-1 = '4'
 10114         MOVE ER-0769            TO  EMI-ERROR
 10115         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
 10116
 10117     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10118         GO TO 1020-DO-LIFE-EDITS
 10119     ELSE
 10120         GO TO 1030-DO-AH-EDITS.
 10121
 10122 1010-GENERAL-ERROR.
 10123     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10124
 10125     IF EMI-MESSAGE-FORMATTED
 10126         MOVE -1                 TO PMTTYPEL.
 10127
 10128 1010-EXIT.
 10129     EXIT.
 10130
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 190
* EL156.cbl
 10132 1020-DO-LIFE-EDITS.
 10133     IF CM-LF-BENEFIT-CD = '00'
 10134         IF PI-PMTTYPE = '5' OR '6'
 10135             MOVE ER-0658        TO EMI-ERROR
 10136             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10137         ELSE
 10138            if (pi-company-id = 'DCC' or 'VPP')
 10139               and (pi-dcc-product-code not = spaces)
 10140               continue
 10141            else
 10142               MOVE ER-1775      TO EMI-ERROR
 10143               PERFORM 1040-PMTTYPE-ERROR
 10144                                 THRU 1040-EXIT
 10145            end-if
 10146         end-if
 10147     end-if
 10148
 10149     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10150     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10151         MOVE ER-0460            TO EMI-ERROR
 10152         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10153
 10154     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10155     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10156     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10157     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10158     MOVE '4'                    TO  CNTL-REC-TYPE.
 10159     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10160     MOVE 'BENE'                 TO  FILE-SWITCH.
 10161     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10162     IF NO-BENEFIT-FOUND
 10163         GO TO 1950-NOT-FOUND.
 10164
 10165     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10166
 10167     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10168         IF PI-PMTTYPE = '4'
 10169             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10170                PI-LF-COVERAGE-TYPE = 'P'
 10171                 NEXT SENTENCE
 10172             ELSE
 10173                 MOVE ER-0461        TO EMI-ERROR
 10174                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10175         ELSE
 10176            NEXT SENTENCE
 10177     ELSE
 10178         IF PI-PMTTYPE = '2'
 10179            IF NOT CM-O-B-COVERAGE
 10180              AND CM-LF-CURRENT-STATUS = '7'
 10181                MOVE ER-0462     TO EMI-ERROR
 10182                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10183
 10184     IF PI-PMTTYPE = '2'
 10185         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10186            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10187             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10188             MOVE ER-0730            TO  EMI-ERROR
 10189             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 191
* EL156.cbl
 10190             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10191
 10192     IF PI-PMTTYPE = '2'
 10193         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10194            PI-LF-COVERAGE-TYPE = 'P'
 10195             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10196                 MOVE ER-0462    TO  EMI-ERROR
 10197                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10198
 10199     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10200       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10201         MOVE ER-0466            TO EMI-ERROR
 10202         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10203
 10204     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10205         IF PI-PMTTYPE = '3'
 10206             MOVE 0436           TO EMI-ERROR
 10207             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10208             GO TO 1045-EDIT-PAYEE-ADDR
 10209         ELSE
 10210             GO TO 1045-EDIT-PAYEE-ADDR.
 10211
 10212     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10213        PI-LF-COVERAGE-TYPE = 'P'
 10214         IF PI-PMTTYPE = '3'
 10215             MOVE ER-0436          TO  EMI-ERROR
 10216             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10217         ELSE
 10218             NEXT SENTENCE
 10219     ELSE
 10220         IF PI-PMTTYPE = '1' OR '3'
 10221             MOVE ER-0436            TO EMI-ERROR
 10222             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10223*
 10224     IF PI-COMPANY-ID = 'CID' AND
 10225        CL-CERT-STATE = 'SC'  AND
 10226        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10227           MOVE ER-0879    TO  EMI-ERROR
 10228           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10229           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10230     END-IF.
 10231     IF PI-COMPANY-ID = 'AHL'
 10232        evaluate true
 10233           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10234              MOVE ER-0879       TO  EMI-ERROR
 10235              PERFORM 1040-PMTTYPE-ERROR
 10236                                 THRU 1040-EXIT
 10237              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10238           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10239                 '6D' OR '6H' OR '6R'
 10240              MOVE ER-0879       TO  EMI-ERROR
 10241              PERFORM 1040-PMTTYPE-ERROR
 10242                                 THRU 1040-EXIT
 10243              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10244           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10245              MOVE ER-0879       TO  EMI-ERROR
 10246              PERFORM 1040-PMTTYPE-ERROR
 10247                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 192
* EL156.cbl
 10248              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10249        end-evaluate
 10250     END-IF
 10251     GO TO 1045-EDIT-PAYEE-ADDR.
 10252
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 193
* EL156.cbl
 10254 1030-DO-AH-EDITS.
 10255     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10256     IF CM-AH-BENEFIT-CD = '00'
 10257         IF PI-PMTTYPE = '5' OR '6'
 10258             MOVE ER-0658        TO EMI-ERROR
 10259             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10260         ELSE
 10261             MOVE ER-1775        TO EMI-ERROR
 10262             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10263
 10264     IF CL-TOTAL-PAID-AMT = ZEROS
 10265         IF PI-PMTTYPE = '4'
 10266             MOVE ER-0438        TO EMI-ERROR
 10267             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10268
 10269     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10270         IF PI-PMTTYPE = '3'
 10271             MOVE ER-0463        TO EMI-ERROR
 10272             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10273         ELSE
 10274             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10275              AND CM-LF-CURRENT-STATUS = '7'
 10276                 MOVE ER-0465    TO EMI-ERROR
 10277                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10278
 10279     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10280         IF PI-PMTTYPE = '3'
 10281             MOVE ER-0464        TO EMI-ERROR
 10282             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10283         ELSE
 10284             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10285                 MOVE ER-0469    TO EMI-ERROR
 10286                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10287
 10288     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10289         IF PI-PMTTYPE = '3'
 10290             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10291                 MOVE ER-0467    TO EMI-ERROR
 10292                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10293             ELSE
 10294                 NEXT SENTENCE
 10295         ELSE
 10296             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10297                 MOVE ER-0468    TO EMI-ERROR
 10298                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10299
 10300     GO TO 1045-EDIT-PAYEE-ADDR.
 10301
 10302 1040-PMTTYPE-ERROR.
 10303     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10304
 10305     IF EMI-MESSAGE-FORMATTED
 10306         MOVE -1                 TO PMTTYPEL
 10307         MOVE AL-UABON           TO PMTTYPEA.
 10308
 10309 1040-EXIT.
 10310     EXIT.
 10311
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 194
* EL156.cbl
 10313 1045-EDIT-PAYEE-ADDR.
 10314
 10315     IF PI-OFFLINE = 'N' AND
 10316        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10317           < PI-PAYEE-SEQ-NUM)
 10318        OR
 10319         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10320         (PI-PAYEE-TYPE = 'B')                 AND
 10321         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10322        OR
 10323         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10324           < PI-PAYEE-SEQ-NUM)
 10325        OR
 10326         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10327           < PI-PAYEE-SEQ-NUM)
 10328        OR
 10329         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10330           < PI-PAYEE-SEQ-NUM)
 10331        OR
 10332         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10333           < PI-PAYEE-SEQ-NUM)
 10334        OR
 10335         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10336           < PI-PAYEE-SEQ-NUM))
 10337             MOVE ER-0437        TO EMI-ERROR
 10338             MOVE -1             TO PAYEEL
 10339             MOVE AL-UABON       TO PAYEEA
 10340             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10341
 10342     IF PI-OFFLINE    = 'N' AND
 10343        PI-PAYEE-TYPE = 'B' AND
 10344        PI-PAYEE-SEQ  = '0'
 10345         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10346         IF BENE-FOUND-SW = 'N'
 10347             MOVE ER-0437        TO EMI-ERROR
 10348             MOVE -1             TO PAYEEL
 10349             MOVE AL-UABON       TO PAYEEA
 10350             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10351
 10352     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10353        IF PI-OFFLINE    = 'N'  AND
 10354           PI-PAYEE-TYPE = 'B'  AND
 10355           PI-PAYEE-SEQ  = '9'
 10356             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10357             IF BENE-FOUND-SW = 'N'
 10358                MOVE ER-0437        TO EMI-ERROR
 10359                MOVE -1             TO PAYEEL
 10360                MOVE AL-UABON       TO PAYEEA
 10361                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10362
 10363*    IF PI-COMPANY-ID = 'CRI'
 10364*        IF CL-CLAIM-TYPE = 'L'
 10365*            MOVE 'N'                TO  WS-GROUPED
 10366*                                        PI-GROUPED
 10367*                                        GROUPEDI
 10368*            MOVE AL-UANON           TO  GROUPEDA
 10369*            GO TO 1050-EDIT-CHECK-NO
 10370*        ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 195
* EL156.cbl
 10371*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10372*            IF WS-GROUP-1 = 'C'
 10373*                NEXT SENTENCE
 10374*            ELSE
 10375*                MOVE 'N'            TO  WS-GROUPED
 10376*                                        PI-GROUPED
 10377*                                        GROUPEDI
 10378*                MOVE AL-UANON       TO  GROUPEDA
 10379*                GO TO 1050-EDIT-CHECK-NO.
 10380
 10381*     IF PI-GROUPED = 'Y'
 10382*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10383*           NEXT SENTENCE
 10384*        ELSE
 10385*           MOVE ER-0437        TO EMI-ERROR
 10386*           MOVE -1             TO PAYEEL
 10387**02180            MOVE AL-UABON       TO PAYEEA
 10388*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10389*
 10390*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10391*        (PI-GROUPED    = ' ')
 10392*        NEXT SENTENCE
 10393*     ELSE
 10394*
 10395     GO TO 1050-EDIT-CHECK-NO.
 10396*     IF PI-COMPANY-ID = 'CRI'
 10397*        MOVE 'N'           TO GROUPEDI
 10398*                              PI-GROUPED
 10399*                              WS-GROUPED
 10400*        MOVE AL-UANON      TO GROUPEDA.
 10401*
 10402*     IF PI-COMPANY-ID = 'CRI'
 10403*        IF PI-PAYEE-TYPE = 'B'
 10404*           IF BENE-FOUND-SW = 'Y'
 10405*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10406*                 MOVE 'Y'           TO GROUPEDI
 10407*                                       PI-GROUPED
 10408*                                       WS-GROUPED
 10409*                 MOVE AL-UANON      TO GROUPEDA
 10410*              ELSE
 10411*                 NEXT SENTENCE
 10412*           ELSE
 10413*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10414*              IF BENE-FOUND-SW = 'Y'
 10415*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10416*                    MOVE 'Y'      TO GROUPEDI
 10417*                                     PI-GROUPED
 10418*                                     WS-GROUPED
 10419*                    MOVE AL-UANON TO GROUPEDA.
 10420*
 10421
 10422     IF PI-COMPANY-ID NOT = 'CRI'
 10423        GO TO 1050-EDIT-CHECK-NO.
 10424
 10425*************** CRI CODE START ******************
 10426     IF PI-PAYEE-TYPE NOT = 'A'
 10427        GO TO 1050-EDIT-CHECK-NO.
 10428
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 196
* EL156.cbl
 10429     MOVE LOW-VALUES             TO ERACCT-KEY.
 10430     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10431     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10432     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10433     MOVE PI-STATE               TO ACCT-STATE.
 10434     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10435     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10436     MOVE 'ACCT'                 TO FILE-SWITCH.
 10437
 10438     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10439     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10440
 10441
 10442* EXEC CICS HANDLE CONDITION
 10443*         NOTFND   (1950-NOT-FOUND)
 10444*         ENDFILE  (1950-NOT-FOUND)
 10445*    END-EXEC.
 10446*    MOVE '"$I''                  ! ( #00010070' TO DFHEIV0
 10447     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10449     MOVE X'2820233030303130303730' TO DFHEIV0(25:11)
 10450     CALL 'kxdfhei1' USING DFHEIV0
 10451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10452
 10453
 10454
 10455* EXEC CICS STARTBR
 10456*         DATASET   ('ERACCT')
 10457*         RIDFLD    (ERACCT-KEY)
 10458*         GTEQ
 10459*    END-EXEC.
 10460     MOVE 'ERACCT' TO DFHEIV1
 10461     MOVE 0
 10462       TO DFHEIV11
 10463*    MOVE '&,         G          &   #00010075' TO DFHEIV0
 10464     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10465     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10466     MOVE X'2020233030303130303735' TO DFHEIV0(25:11)
 10467     CALL 'kxdfhei1' USING DFHEIV0,
 10468           DFHEIV1,
 10469           ERACCT-KEY,
 10470           DFHEIV99,
 10471           DFHEIV11,
 10472           DFHEIV99
 10473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10474
 10475
 10476 1046-READNEXT-ERACCT.
 10477
 10478
 10479* EXEC CICS READNEXT
 10480*         DATASET   ('ERACCT')
 10481*         RIDFLD    (ERACCT-KEY)
 10482*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10483*    END-EXEC.
 10484     MOVE 'ERACCT' TO DFHEIV1
 10485     MOVE 0
 10486       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 197
* EL156.cbl
 10487*    MOVE '&.S                   )   #00010083' TO DFHEIV0
 10488     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10489     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10490     MOVE X'2020233030303130303833' TO DFHEIV0(25:11)
 10491     CALL 'kxdfhei1' USING DFHEIV0,
 10492           DFHEIV1,
 10493           DFHEIV20,
 10494           DFHEIV99,
 10495           ERACCT-KEY,
 10496           DFHEIV99,
 10497           DFHEIV11,
 10498           DFHEIV99,
 10499           DFHEIV99
 10500     SET ADDRESS OF ACCOUNT-MASTER TO
 10501         DFHEIV20
 10502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10503
 10504
 10505     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10506        IF WS-ERACCT-HOLD-RECORD = SPACES
 10507           GO TO 1950-NOT-FOUND
 10508        ELSE
 10509           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10510           GO TO 1048-CONTINUE.
 10511
 10512     IF ACCT-EXP-DT = HIGH-VALUES
 10513        NEXT SENTENCE
 10514     ELSE
 10515        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10516        GO TO 1046-READNEXT-ERACCT.
 10517
 10518 1048-CONTINUE.
 10519
 10520*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10521*       MOVE 'Y'                 TO GROUPEDI
 10522*                                   PI-GROUPED
 10523*                                   WS-GROUPED
 10524*       MOVE AL-UANON            TO GROUPEDA.
 10525*************** CRI CODE END ******************
 10526
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 198
* EL156.cbl
 10528 1050-EDIT-CHECK-NO.
 10529
 10530     IF PI-OFFLINE = 'Y'
 10531         IF PI-ECHECKNO = SPACES
 10532              MOVE ER-0439        TO EMI-ERROR
 10533              GO TO 1090-CHECK-NO-ERROR
 10534           ELSE
 10535*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10536*           IF PI-ECHECKNO-N = 'N' AND
 10537*              PI-CASH       = 'Y'
 10538*                MOVE ER-3535        TO EMI-ERROR
 10539*                GO TO 1090-CHECK-NO-ERROR
 10540*             ELSE
 10541*                MOVE AL-UANON    TO CHECKNOA
 10542*                GO TO 1100-EDIT-HOLDTIL
 10543*         ELSE
 10544            MOVE AL-UANON    TO CHECKNOA
 10545            GO TO 1100-EDIT-HOLDTIL.
 10546
 10547     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10548     MOVE '6'                    TO CNTL-REC-TYPE.
 10549
 10550     IF CONTROL-IS-ACTUAL-CARRIER
 10551         MOVE PI-CARRIER         TO WS-CARR
 10552     ELSE
 10553         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10554
 10555     IF PI-COMPANY-ID = 'FIA'
 10556         MOVE PI-CARRIER         TO WS-CARR.
 10557
 10558     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10559     MOVE 0                      TO CNTL-SEQ-NO.
 10560     MOVE 'CARR'                 TO FILE-SWITCH.
 10561
 10562     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10563
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 199
* EL156.cbl
 10565     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10566         GO TO 1051-EDIT-CHECKNO-CONT.
 10567
 10568**********************AIG LOGIC STARTS**********************
 10569     IF PI-ECHECKNO = SPACES
 10570         IF CHECK-NO-MANUAL
 10571             MOVE ER-0441        TO EMI-ERROR
 10572             GO TO 1090-CHECK-NO-ERROR
 10573         ELSE
 10574             MOVE AL-UANOF       TO CHECKNOA
 10575             GO TO 1100-EDIT-HOLDTIL.
 10576
 10577     IF PI-ECHECKNO NOT = SPACES
 10578         IF CHECK-NO-MANUAL
 10579             MOVE AL-UANON       TO CHECKNOA
 10580             GO TO 1100-EDIT-HOLDTIL.
 10581
 10582     IF PI-ECHECKNO-CR = 'CR'
 10583        IF PI-OFFLINE = 'Y'
 10584            MOVE AL-UANON       TO CHECKNOA
 10585            GO TO 1100-EDIT-HOLDTIL
 10586        ELSE
 10587            MOVE ER-3534        TO EMI-ERROR
 10588            GO TO 1090-CHECK-NO-ERROR.
 10589
 10590     IF PI-ECHECKNO-N = 'N'
 10591        IF PI-CASH = 'N'
 10592            MOVE AL-UANON       TO CHECKNOA
 10593            GO TO 1100-EDIT-HOLDTIL
 10594        ELSE
 10595            MOVE ER-3535          TO EMI-ERROR
 10596            GO TO 1090-CHECK-NO-ERROR.
 10597
 10598     MOVE ER-0442        TO EMI-ERROR
 10599     GO TO 1090-CHECK-NO-ERROR.
 10600**********************AIG LOGIC ENDS************************
 10601
 10602 1051-EDIT-CHECKNO-CONT.
 10603
 10604     IF PI-COMPANY-ID = 'DMD'
 10605        IF PI-ECHECKNO NOT = SPACES
 10606           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10607              MOVE ER-0442        TO EMI-ERROR
 10608              GO TO 1090-CHECK-NO-ERROR
 10609            ELSE
 10610              GO TO 1100-EDIT-HOLDTIL
 10611          ELSE
 10612           GO TO 1100-EDIT-HOLDTIL.
 10613
 10614     IF PI-ECHECKNO = SPACES
 10615         IF CHECK-NO-MANUAL
 10616             MOVE ER-0441        TO EMI-ERROR
 10617             GO TO 1090-CHECK-NO-ERROR
 10618         ELSE
 10619             MOVE AL-UANOF       TO CHECKNOA
 10620             GO TO 1100-EDIT-HOLDTIL
 10621     ELSE
 10622         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 200
* EL156.cbl
 10623             MOVE AL-UANON       TO CHECKNOA
 10624             GO TO 1100-EDIT-HOLDTIL
 10625         ELSE
 10626             MOVE ER-0442        TO EMI-ERROR
 10627             GO TO 1090-CHECK-NO-ERROR.
 10628
 10629 1090-CHECK-NO-ERROR.
 10630     MOVE -1                     TO CHECKNOL.
 10631     MOVE AL-UABON               TO CHECKNOA.
 10632     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10633
 10634     GO TO 2000-EDIT-DONE.
 10635
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 201
* EL156.cbl
 10637 1100-EDIT-HOLDTIL.
 10638     MOVE AL-UANON               TO HOLDTILA.
 10639
 10640     IF PI-HOLDTIL = ZEROS
 10641        IF PI-OFFLINE = 'Y'
 10642           MOVE ER-0572          TO EMI-ERROR
 10643           GO TO 1105-HOLDTIL-ERROR
 10644        ELSE
 10645           GO TO 1110-EDIT-PAID-FROM.
 10646
 10647     MOVE '4'                    TO DC-OPTION-CODE.
 10648     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10649     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10650
 10651     IF DATE-CONVERSION-ERROR
 10652         MOVE ER-0446            TO EMI-ERROR
 10653         GO TO 1105-HOLDTIL-ERROR
 10654     END-IF
 10655     IF PI-OFFLINE = 'Y'
 10656        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10657           MOVE ER-0446            TO EMI-ERROR
 10658           GO TO 1105-HOLDTIL-ERROR
 10659        END-IF
 10660     END-IF
 10661
 10662     IF PI-OFFLINE = 'Y'
 10663        GO TO 1110-EDIT-PAID-FROM.
 10664
 10665     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10666     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10667     MOVE '1'                    TO DC-OPTION-CODE.
 10668     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10669
 10670*    IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10671     IF DC-ELAPSED-DAYS > 60 OR DATE-CONVERSION-ERROR
 10672         MOVE ER-0447            TO EMI-ERROR
 10673         GO TO 1105-HOLDTIL-ERROR.
 10674
 10675     GO TO 1110-EDIT-PAID-FROM.
 10676
 10677 1105-HOLDTIL-ERROR.
 10678     MOVE -1                     TO HOLDTILL.
 10679     MOVE AL-UNBON               TO HOLDTILA.
 10680     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10681
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 202
* EL156.cbl
 10683 1110-EDIT-PAID-FROM.
 10684     MOVE AL-UANON               TO EPYFROMA.
 10685
 10686     IF PI-EPYFROM = ZEROS
 10687         GO TO 1120-CALCULATE-PAID-FROM.
 10688
 10689     IF PI-PMTTYPE = '5' OR '6'
 10690         MOVE ER-0448            TO EMI-ERROR
 10691         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10692         MOVE AL-UNBON           TO EPYFROMA
 10693         MOVE -1                 TO EPYFROML
 10694         GO TO 1150-EDIT-PAID-THRU.
 10695
 10696     MOVE '4'                    TO DC-OPTION-CODE.
 10697     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10698     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10699
 10700     IF DATE-CONVERSION-ERROR
 10701         MOVE ER-0449            TO EMI-ERROR
 10702         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10703         MOVE AL-UNBON           TO EPYFROMA
 10704         MOVE -1                 TO EPYFROML
 10705     ELSE
 10706         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10707
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 203
* EL156.cbl
 10709 1120-CALCULATE-PAID-FROM.
 10710     IF PI-PMTTYPE = '5' OR '6'
 10711         GO TO 1150-EDIT-PAID-THRU.
 10712
 10713*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10714*       IF PI-PMTTYPE = '4'
 10715*         GO TO 1150-EDIT-PAID-THRU.
 10716
 10717     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10718         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10719         MOVE ' '                TO DC-OPTION-CODE
 10720         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10721         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10722         GO TO 1145-TEST-PAID-FROM.
 10723
 10724     IF PI-PMTTYPE = '4'
 10725        GO TO 1150-EDIT-PAID-THRU.
 10726
 10727     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10728     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10729     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10730     MOVE '5'                    TO CNTL-REC-TYPE.
 10731     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10732     MOVE 'BENE'                 TO FILE-SWITCH.
 10733
 10734     IF WS-BEN-CD = ZEROS
 10735         GO TO 1950-NOT-FOUND.
 10736
 10737     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10738
 10739     IF NO-BENEFIT-FOUND
 10740         GO TO 1950-NOT-FOUND.
 10741
 10742     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10743     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10744
 10745     IF PI-BEN-DAYS NOT NUMERIC
 10746        MOVE ZEROS               TO PI-BEN-DAYS.
 10747
 10748     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10749
 10750     SET HOLD-UNTIL-CHK TO TRUE
 10751     MOVE CL-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 10752     PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10753     MOVE SPACE TO WS-HOLD-UNTIL-SW
 10754     IF WS-HOLD-UNTIL-DT > CL-PAID-THRU-DT
 10755         MOVE WS-HOLD-UNTIL-DT     TO DC-BIN-DATE-1
 10756         MOVE '6'                 TO DC-OPTION-CODE
 10757         MOVE +0                  TO DC-ELAPSED-MONTHS
 10758         MOVE +1                  TO DC-ELAPSED-DAYS
 10759         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10760         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10761         GO TO 1145-TEST-PAID-FROM.
 10762
 10763     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10764        (CL-TOTAL-PAID-AMT > ZEROS)
 10765         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10766         MOVE '6'                 TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 204
* EL156.cbl
 10767         MOVE +0                  TO DC-ELAPSED-MONTHS
 10768         MOVE +1                  TO DC-ELAPSED-DAYS
 10769         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10770         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10771         GO TO 1145-TEST-PAID-FROM.
 10772
 10773******************************************************************
 10774****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10775****** SPECIAL ENTERED DATE.
 10776******************************************************************
 10777
 10778     IF PI-AIGFROM = ZEROS
 10779         GO TO 1130-CONTINUE-PAID-FROM.
 10780
 10781     MOVE AL-UANON TO AIGFROMA.
 10782
 10783     MOVE '4'                    TO DC-OPTION-CODE.
 10784     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10785     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10786
 10787     IF DATE-CONVERSION-ERROR
 10788         MOVE ER-0449            TO EMI-ERROR
 10789         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10790         MOVE AL-UNBON           TO AIGFROMA
 10791         MOVE -1                 TO AIGFROML
 10792         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10793     ELSE
 10794         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10795         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10796
 10797     GO TO 1140-CONTINUE-PAID-FROM.
 10798
 10799 1130-CONTINUE-PAID-FROM.
 10800
 10801     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10802        (CL-TOTAL-PAID-AMT = ZEROS)
 10803           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10804
 10805 1140-CONTINUE-PAID-FROM.
 10806
 10807     IF PI-BEN-TYPE = 'R'
 10808         IF PI-BEN-DAYS = ZEROS
 10809             NEXT SENTENCE
 10810         ELSE
 10811         IF PI-COMPANY-ID NOT = 'DMD'
 10812             SUBTRACT 1 FROM PI-BEN-DAYS.
 10813
 10814     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10815
 10816     IF PI-COMPANY-ID = 'DMD'
 10817         MOVE -1                 TO DC-ELAPSED-DAYS
 10818         MOVE +0                 TO DC-ELAPSED-MONTHS
 10819         MOVE '6'                TO DC-OPTION-CODE
 10820         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10821         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10822         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10823                               REMAINDER DC-ELAPSED-DAYS
 10824      ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 205
* EL156.cbl
 10825         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10826         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10827
 10828     MOVE '6'                    TO DC-OPTION-CODE.
 10829     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10830     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10831
 10832     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10833
 10834     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10835         MOVE ER-0541            TO EMI-ERROR
 10836         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10837         MOVE -1                 TO EPYFROML
 10838         MOVE AL-UNBON           TO EPYFROMA.
 10839
 10840     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10841        (PI-BENEFIT-SAVE = '60E')
 10842        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10843           (CL-TOTAL-PAID-AMT = ZEROS)
 10844             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10845             MOVE 30                  TO DC-ELAPSED-DAYS
 10846             MOVE +0                  TO DC-ELAPSED-MONTHS
 10847             MOVE '6'                 TO DC-OPTION-CODE
 10848             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10849
 10850     IF PI-BEN-TYPE = 'R'
 10851         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10852     ELSE
 10853         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10854         IF WS-SV-EPYFROM = LOW-VALUES
 10855            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10856
 10857     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10858         IF WS-USE-AIG-PAYFROM   OR
 10859            WS-AIG-RECALC-PAYFROM
 10860              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10861                                      DC-BIN-DATE-1
 10862              MOVE ' '            TO  DC-OPTION-CODE
 10863              MOVE +0             TO  DC-ELAPSED-MONTHS
 10864                                      DC-ELAPSED-DAYS
 10865              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10866              IF NO-CONVERSION-ERROR
 10867                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10868
 10869     IF PI-CPYFROM < CL-INCURRED-DT
 10870        MOVE -1                  TO EPYFROML
 10871        MOVE ER-3542             TO EMI-ERROR
 10872        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10873
 10874     IF CM-ENTRY-DT < CL-INCURRED-DT
 10875        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10876        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10877        MOVE +0                     TO DC-ELAPSED-DAYS
 10878        MOVE +0                     TO DC-ELAPSED-MONTHS
 10879        MOVE '1'                    TO DC-OPTION-CODE
 10880        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10881        ELSE
 10882        MOVE ZEROS TO DC-ELAPSED-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 206
* EL156.cbl
 10883
 10884     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10885         NEXT SENTENCE
 10886     ELSE
 10887         IF DC-ELAPSED-MONTHS < 2
 10888             MOVE ER-3255        TO EMI-ERROR
 10889             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10890
 10891 1145-TEST-PAID-FROM.
 10892     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10893         GO TO 1150-EDIT-PAID-THRU.
 10894
 10895     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10896         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10897         MOVE ' '                TO DC-OPTION-CODE
 10898         MOVE +0                 TO DC-ELAPSED-MONTHS
 10899                                    DC-ELAPSED-DAYS
 10900         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10901         IF NO-CONVERSION-ERROR
 10902             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10903         ELSE
 10904             MOVE SPACES             TO EMI-DATE-FIELD.
 10905
 10906     IF PI-HOLDTIL NOT = ZEROS
 10907        CONTINUE
 10908     ELSE
 10909     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10910         IF CL-TOTAL-PAID-AMT = ZEROS
 10911             MOVE ER-3543            TO EMI-ERROR
 10912             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10913             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10914             IF EMI-MESSAGE-FORMATTED
 10915                MOVE -1             TO EPYFROML
 10916                MOVE AL-UNBON       TO EPYFROMA
 10917             ELSE
 10918                NEXT SENTENCE
 10919         ELSE
 10920             MOVE ER-0452            TO EMI-ERROR
 10921             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10922             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10923             IF EMI-MESSAGE-FORMATTED
 10924                MOVE -1             TO EPYFROML
 10925                MOVE AL-UNBON       TO EPYFROMA.
 10926
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 207
* EL156.cbl
 10928 1150-EDIT-PAID-THRU.
 10929
 10930     MOVE AL-UANON               TO EPYTHRUA.
 10931
 10932     IF PI-EPYTHRU = ZEROS
 10933*        IF PI-PMTTYPE = '4' OR '5' OR '6'
 10934         IF PI-PMTTYPE = '5' OR '6'
 10935           OR (CL-CLAIM-TYPE NOT = 'L' AND PI-PMTTYPE = '4')
 10936             GO TO 1200-EDIT-FIND-TOLERANCES
 10937         ELSE
 10938            IF (PI-PMTTYPE = '3') OR (PI-PMTTYPE = '4') OR
 10939               (PI-PMTTYPE = '2' AND
 10940                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10941               GO TO 1152-CHECK-TYPE
 10942            ELSE
 10943               MOVE ER-0473      TO EMI-ERROR
 10944               GO TO 1170-PAID-THRU-FATAL-ERROR
 10945     ELSE
 10946         IF PI-PMTTYPE = '5' OR '6'
 10947             MOVE ER-0474        TO EMI-ERROR
 10948             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10949
 10950     MOVE '4'                    TO DC-OPTION-CODE.
 10951     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10952     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10953
 10954     IF DATE-CONVERSION-ERROR
 10955         MOVE ER-0475            TO EMI-ERROR
 10956         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10957
 10958     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10959
 10960     IF PI-COMPANY-ID = 'DMD'
 10961         IF PI-PMTTYPE NOT = '2'
 10962                 AND
 10963            WS-EXP-DT > WS-SV-EPYTHRU
 10964             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10965             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10966             MOVE '1'              TO DC-OPTION-CODE
 10967             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10968             IF DATE-CONVERSION-ERROR
 10969                 MOVE ER-0944      TO EMI-ERROR
 10970                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10971             ELSE
 10972                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10973                    DC-ELAPSED-DAYS   = 1
 10974                     MOVE ER-0945  TO EMI-ERROR
 10975                     MOVE -1       TO EPYTHRUL
 10976                     MOVE AL-UABON TO EPYTHRUA
 10977                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10978
 10979     IF PI-PMTTYPE = '4'
 10980         NEXT SENTENCE
 10981     ELSE
 10982         IF WS-SV-EPYTHRU = WS-EXP-DT
 10983             IF PI-PMTTYPE NOT = '2' AND '3'
 10984                 MOVE ER-3541    TO EMI-ERROR
 10985                 MOVE -1         TO PMTTYPEL
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 208
* EL156.cbl
 10986                 MOVE AL-UABON   TO PMTTYPEA
 10987                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10988
 10989     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10990         MOVE ER-0501            TO EMI-ERROR
 10991         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10992
 10993     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10994        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10995*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10996*              MOVE ER-0540         TO EMI-ERROR
 10997*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10998*              MOVE -1              TO EPYTHRUL
 10999*              MOVE AL-UNBON        TO EPYTHRUA
 11000*          ELSE
 11001*          IF PI-COMPANY-ID = 'DMD'
 11002*              MOVE ER-7540         TO EMI-ERROR
 11003*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11004*              MOVE -1              TO EPYTHRUL
 11005*              MOVE AL-UNBON        TO EPYTHRUA
 11006*          ELSE
 11007               IF PI-PMTTYPE NOT = '2' AND '3'
 11008                  IF PI-COMPANY-ID = '???'
 11009                      MOVE ER-7540  TO EMI-ERROR
 11010                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11011                      MOVE -1       TO EPYTHRUL
 11012                      MOVE AL-UNBON TO EPYTHRUA
 11013                  ELSE
 11014                      MOVE ER-0540  TO EMI-ERROR
 11015                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11016                      MOVE -1       TO EPYTHRUL
 11017                      MOVE AL-UNBON TO EPYTHRUA.
 11018
 11019     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11020            OR
 11021        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 11022         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 11023            OR
 11024        (PI-CPYFROM NOT = LOW-VALUES AND
 11025         PI-CPYFROM < CL-PAID-THRU-DT)
 11026        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 11027
 11028 1152-CHECK-TYPE.
 11029     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11030        OR (PI-PMTTYPE = '5' OR '6')
 11031         GO TO 1160-EDIT-PAID-THRU-AH.
 11032
 11033 1155-EDIT-PAID-THRU-LIFE.
 11034     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11035     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11036     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11037     MOVE '4'                    TO CNTL-REC-TYPE.
 11038     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11039     MOVE 'BENE'                 TO FILE-SWITCH.
 11040
 11041     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11042
 11043     IF NO-BENEFIT-FOUND
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 209
* EL156.cbl
 11044         GO TO 1950-NOT-FOUND.
 11045
 11046     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 11047
 11048     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 11049
 11050     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 11051        PI-LF-COVERAGE-TYPE = 'P'
 11052         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 11053         GO TO 1200-EDIT-FIND-TOLERANCES.
 11054
 11055     IF PI-EPYTHRU = ZEROS
 11056        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 11057
 11058     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11059         MOVE ER-0476            TO EMI-ERROR
 11060         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11061
 11062     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 11063*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 11064     move cl-critical-period    to dc-elapsed-months
 11065     MOVE +0                    TO DC-ELAPSED-DAYS.
 11066     MOVE '6'                   TO DC-OPTION-CODE.
 11067     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11068
 11069     IF (NO-CONVERSION-ERROR AND
 11070         WS-SPECIAL-CALC-CD = 'C')
 11071        IF CL-INCURRED-DT > DC-BIN-DATE-2
 11072            MOVE ER-0657 TO EMI-ERROR
 11073            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11074
 11075     IF PI-COMPANY-ID = 'NCL'
 11076         IF WS-SPECIAL-CALC-CD = 'C' AND
 11077            cl-critical-period = zeros
 11078*           CM-LF-CRITICAL-PERIOD = +0
 11079             MOVE ER-0844       TO EMI-ERROR
 11080             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11081
 11082     GO TO 1200-EDIT-FIND-TOLERANCES.
 11083
 11084 1160-EDIT-PAID-THRU-AH.
 11085     IF PI-EPYTHRU = ZEROS
 11086        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11087                                    WS-SV-EPYTHRU
 11088     ELSE
 11089        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 11090
 11091     IF WS-SV-EPYTHRU < PI-CPYFROM
 11092         MOVE ER-0508            TO EMI-ERROR
 11093         GO TO 1170-PAID-THRU-FATAL-ERROR.
 11094
 11095     perform 7975-read-acct      thru 7975-exit
 11096     move zeros                  to pi-max-ext
 11097     if PI-DCC-PRODUCT-CODE NOT = SPACES
 11098        PERFORM 0900-GET-DDF-LIMITS
 11099                                 THRU 0900-EXIT
 11100        IF PDEF-FOUND
 11101           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 210
* EL156.cbl
 11102              (P1 > +8)
 11103              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11104           END-PERFORM
 11105           IF P1 < +9
 11106              MOVE PD-MAX-extension (P1)
 11107                                 TO pi-max-ext
 11108           else
 11109              move er-1674       to emi-error
 11110              PERFORM 9900-ERROR-FORMAT
 11111                                 THRU 9900-EXIT
 11112           END-IF
 11113        else
 11114           move er-1672          to emi-error
 11115           PERFORM 9900-ERROR-FORMAT
 11116                                 THRU 9900-EXIT
 11117        END-IF
 11118     end-if
 11119     move spaces                 to pi-max-ext-used
 11120     IF PI-PMTTYPE = '3'
 11121        MOVE WS-EXP-DT           TO PI-CPYTHRU
 11122        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 11123           MOVE ER-0477          TO EMI-ERROR
 11124           PERFORM 1165-PAID-THRU-ERROR
 11125                                 THRU 1165-EXIT
 11126        ELSE
 11127           continue
 11128        end-if
 11129     ELSE
 11130        IF WS-SV-EPYTHRU > WS-EXP-DT
 11131         IF PI-DCC-PRODUCT-CODE NOT > SPACES
 11132           move ws-exp-dt        to dc-bin-date-1
 11133           move ws-sv-epythru    to dc-bin-date-2
 11134           MOVE '1'              TO DC-OPTION-CODE
 11135           MOVE +0               TO DC-ELAPSED-DAYS
 11136                                    DC-ELAPSED-MONTHS
 11137           PERFORM 9700-LINK-DATE-CONVERT
 11138                                 THRU 9700-EXIT
 11139           if no-conversion-error
 11140              if dc-elapsed-days > zeros
 11141                 add +1 to dc-elapsed-months
 11142              end-if
 11143              if dc-elapsed-months > pi-max-ext
 11144                 MOVE ER-0557    TO EMI-ERROR
 11145                 PERFORM 1165-PAID-THRU-ERROR
 11146                                 THRU 1165-EXIT
 11147              else
 11148                 move 'Y'        to pi-max-ext-used
 11149                 move er-1670    to emi-error
 11150                 perform 9900-error-format
 11151                                 thru 9900-exit
 11152              end-if
 11153           end-if
 11154         ELSE
 11155            MOVE ER-0557    TO EMI-ERROR
 11156            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT
 11157         END-IF
 11158        end-if
 11159     end-if
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 211
* EL156.cbl
 11160
 11161     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 11162         PI-PMTTYPE NOT = '3'
 11163         MOVE ER-0541        TO EMI-ERROR
 11164         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11165
 11166     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
 11167        (PI-PMTTYPE NOT = '3')
 11168         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 11169             MOVE ER-0478        TO EMI-ERROR
 11170             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11171
 11172     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11173        (PI-PMTTYPE NOT = '4')
 11174         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11175             MOVE ER-0479        TO EMI-ERROR
 11176             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11177
 11178     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11179         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11180             MOVE ER-0545        TO EMI-ERROR
 11181             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11182
 11183     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11184         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11185             MOVE ER-0481        TO EMI-ERROR
 11186             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11187
 11188*    IF PI-COMPANY-ID = 'NCL'
 11189*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11190*           CM-AH-CRITICAL-PERIOD = +0
 11191*            MOVE ER-0844        TO  EMI-ERROR
 11192*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11193
 11194*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11195     if (cl-critical-period = zeros)
 11196        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11197          GO TO 1200-EDIT-FIND-TOLERANCES.
 11198
 11199     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11200     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11201     MOVE '1'        TO DC-OPTION-CODE.
 11202     MOVE +0         TO DC-ELAPSED-DAYS
 11203                        DC-ELAPSED-MONTHS.
 11204     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11205
 11206*    IF NO-CONVERSION-ERROR
 11207*       COMPUTE ws-benefits-paid =
 11208*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11209*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11210*           MOVE ER-0657 TO EMI-ERROR
 11211*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11212
 11213     GO TO 1200-EDIT-FIND-TOLERANCES.
 11214
 11215 1165-PAID-THRU-ERROR.
 11216     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11217
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 212
* EL156.cbl
 11218     IF EMI-MESSAGE-FORMATTED
 11219         MOVE -1                 TO EPYTHRUL
 11220         MOVE AL-UNBON           TO EPYTHRUA.
 11221
 11222 1165-EXIT.
 11223     EXIT.
 11224
 11225 1166-CHECK-ALL-TRLRS.
 11226
 11227     IF PI-PMTTYPE = '4'
 11228        GO TO 1166-TRLR-EXIT.
 11229
 11230     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11231
 11232     IF HOLD-UNTIL-CHK
 11233        CONTINUE
 11234     ELSE
 11235     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11236        WS-SV-EPYFROM = LOW-VALUES
 11237          GO TO 1166-END-CHECK.
 11238
 11239
 11240* EXEC CICS HANDLE CONDITION
 11241*        ENDFILE   (1166-END-CHECK)
 11242*        NOTFND    (1166-END-CHECK)
 11243*    END-EXEC.
 11244*    MOVE '"$''I                  ! ) #00010823' TO DFHEIV0
 11245     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11246     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11247     MOVE X'2920233030303130383233' TO DFHEIV0(25:11)
 11248     CALL 'kxdfhei1' USING DFHEIV0
 11249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11250
 11251
 11252     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11253     MOVE +100                   TO TRLR-SEQ-NO.
 11254
 11255
 11256* EXEC CICS STARTBR
 11257*         DATASET    ('ELTRLR')
 11258*         RIDFLD     (ELTRLR-KEY)
 11259*         GTEQ
 11260*    END-EXEC.
 11261     MOVE 'ELTRLR' TO DFHEIV1
 11262     MOVE 0
 11263       TO DFHEIV11
 11264*    MOVE '&,         G          &   #00010831' TO DFHEIV0
 11265     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11266     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11267     MOVE X'2020233030303130383331' TO DFHEIV0(25:11)
 11268     CALL 'kxdfhei1' USING DFHEIV0,
 11269           DFHEIV1,
 11270           ELTRLR-KEY,
 11271           DFHEIV99,
 11272           DFHEIV11,
 11273           DFHEIV99
 11274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11275
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 213
* EL156.cbl
 11276
 11277     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11278
 11279 1166-READ-TRLR-NEXT.
 11280
 11281
 11282* EXEC CICS READNEXT
 11283*         DATASET    ('ELTRLR')
 11284*         RIDFLD     (ELTRLR-KEY)
 11285*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
 11286*    END-EXEC.
 11287     MOVE 'ELTRLR' TO DFHEIV1
 11288     MOVE 0
 11289       TO DFHEIV11
 11290*    MOVE '&.S                   )   #00010841' TO DFHEIV0
 11291     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11292     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11293     MOVE X'2020233030303130383431' TO DFHEIV0(25:11)
 11294     CALL 'kxdfhei1' USING DFHEIV0,
 11295           DFHEIV1,
 11296           DFHEIV20,
 11297           DFHEIV99,
 11298           ELTRLR-KEY,
 11299           DFHEIV99,
 11300           DFHEIV11,
 11301           DFHEIV99,
 11302           DFHEIV99
 11303     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11304         DFHEIV20
 11305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11306
 11307
 11308     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11309        TRLR-CARRIER  = MSTR-CARRIER  AND
 11310        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11311        TRLR-CERT-NO  = MSTR-CERT-NO
 11312          NEXT SENTENCE
 11313      ELSE
 11314          GO TO 1166-END-CHECK.
 11315
 11316* **  BYPASS ALL NON-PAYMENT TRAILERS
 11317
 11318     IF AT-TRAILER-TYPE = '2'
 11319        NEXT SENTENCE
 11320     ELSE
 11321        GO TO 1166-READ-TRLR-NEXT.
 11322
 11323* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11324
 11325     IF AT-PAYMENT-TYPE = '1' OR '2'
 11326        NEXT SENTENCE
 11327     ELSE
 11328        GO TO 1166-READ-TRLR-NEXT.
 11329
 11330* **  BYPASS ALL VOID PAYMENTS
 11331
 11332     IF AT-VOID-DT NOT = LOW-VALUES
 11333        GO TO 1166-READ-TRLR-NEXT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 214
* EL156.cbl
 11334
 11335     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11336        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11337          GO TO 1166-READ-TRLR-NEXT.
 11338     IF HOLD-UNTIL-CHK
 11339        IF AT-PAID-THRU-DT > WS-HOLD-UNTIL-DT
 11340          AND AT-TO-BE-WRITTEN-DT > ZERO
 11341           MOVE AT-PAID-THRU-DT TO WS-HOLD-UNTIL-DT
 11342        END-IF
 11343     END-IF
 11344
 11345     IF HOLD-UNTIL-CHK
 11346        CONTINUE
 11347     ELSE
 11348     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11349         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11350            OR
 11351        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11352         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
 11353        NEXT SENTENCE
 11354     ELSE
 11355         IF CL-TOTAL-PAID-AMT > ZEROS
 11356             MOVE ER-0502            TO EMI-ERROR
 11357             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11358             MOVE -1                 TO EPYTHRUL
 11359             MOVE AL-UNBON           TO EPYTHRUA.
 11360
 11361     GO TO 1166-READ-TRLR-NEXT.
 11362
 11363 1166-END-CHECK.
 11364
 11365     IF WS-BROWSE-TRLR-SW = 'Y'
 11366
 11367* EXEC CICS ENDBR
 11368*            DATASET   ('ELTRLR')
 11369*       END-EXEC.
 11370     MOVE 'ELTRLR' TO DFHEIV1
 11371     MOVE 0
 11372       TO DFHEIV11
 11373*    MOVE '&2                    $   #00010905' TO DFHEIV0
 11374     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11375     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11376     MOVE X'2020233030303130393035' TO DFHEIV0(25:11)
 11377     CALL 'kxdfhei1' USING DFHEIV0,
 11378           DFHEIV1,
 11379           DFHEIV11,
 11380           DFHEIV99
 11381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11382
 11383
 11384     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11385
 11386 1166-TRLR-EXIT.
 11387     EXIT.
 11388
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 215
* EL156.cbl
 11390 1170-PAID-THRU-FATAL-ERROR.
 11391     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11392
 11393     MOVE -1                     TO EPYTHRUL.
 11394     MOVE AL-UNBON               TO EPYTHRUA.
 11395
 11396 1200-EDIT-FIND-TOLERANCES.
 11397
 11398* EXEC CICS HANDLE CONDITION
 11399*        ENDFILE(1950-NOT-FOUND)
 11400*        NOTFND (1950-NOT-FOUND)
 11401*    END-EXEC.
 11402*    MOVE '"$''I                  ! * #00010922' TO DFHEIV0
 11403     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11405     MOVE X'2A20233030303130393232' TO DFHEIV0(25:11)
 11406     CALL 'kxdfhei1' USING DFHEIV0
 11407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11408
 11409
 11410     IF PI-PROCESSOR-ID = 'LGXX'
 11411        GO TO 1240-FIND-ACCT-TOLERANCES.
 11412
 11413     MOVE 'N'                    TO FOUND-TOL-SW.
 11414     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11415     MOVE '2'                    TO CNTL-REC-TYPE.
 11416     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11417     MOVE +0                     TO CNTL-SEQ-NO.
 11418     MOVE 'PROC'                 TO FILE-SWITCH.
 11419
 11420     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11421
 11422     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11423     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11424                                    PI-MAX-PMT-TOL.
 11425     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11426
 11427     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11428         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11429
 11430     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11431     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11432                                    PI-MAX-LF-PMT-TOL.
 11433
 11434     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11435         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11436
 11437     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11438                                    PI-MAX-EXP-PMT.
 11439
 11440 1240-FIND-ACCT-TOLERANCES.
 11441
 11442     IF WS-PMT-TOL NOT = +0
 11443         MOVE 'Y'                TO FOUND-TOL-SW.
 11444
 11445     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11446         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11447         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 216
* EL156.cbl
 11448         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11449         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11450         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11451         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11452     ELSE
 11453         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11454         MOVE PI-CARRIER             TO ACCT-CARRIER
 11455         MOVE PI-GROUPING            TO ACCT-GROUPING
 11456         MOVE PI-STATE               TO ACCT-STATE
 11457         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11458         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11459
 11460     MOVE 'ACCT'                 TO FILE-SWITCH.
 11461
 11462     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11463     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11464
 11465
 11466* EXEC CICS HANDLE CONDITION
 11467*         NOTFND   (1950-NOT-FOUND)
 11468*         ENDFILE  (1950-NOT-FOUND)
 11469*    END-EXEC.
 11470*    MOVE '"$I''                  ! + #00010982' TO DFHEIV0
 11471     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11472     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11473     MOVE X'2B20233030303130393832' TO DFHEIV0(25:11)
 11474     CALL 'kxdfhei1' USING DFHEIV0
 11475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11476
 11477
 11478
 11479* EXEC CICS STARTBR
 11480*        DATASET('ERACCT')
 11481*        RIDFLD (ERACCT-KEY)
 11482*        GTEQ
 11483*    END-EXEC.
 11484     MOVE 'ERACCT' TO DFHEIV1
 11485     MOVE 0
 11486       TO DFHEIV11
 11487*    MOVE '&,         G          &   #00010987' TO DFHEIV0
 11488     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11489     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11490     MOVE X'2020233030303130393837' TO DFHEIV0(25:11)
 11491     CALL 'kxdfhei1' USING DFHEIV0,
 11492           DFHEIV1,
 11493           ERACCT-KEY,
 11494           DFHEIV99,
 11495           DFHEIV11,
 11496           DFHEIV99
 11497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11498
 11499
 11500 1245-FIND-ACCT-TOLERANCES-LOOP.
 11501
 11502
 11503* EXEC CICS READNEXT
 11504*        DATASET('ERACCT')
 11505*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 217
* EL156.cbl
 11506*        RIDFLD (ERACCT-KEY)
 11507*    END-EXEC.
 11508     MOVE 'ERACCT' TO DFHEIV1
 11509     MOVE 0
 11510       TO DFHEIV11
 11511*    MOVE '&.S                   )   #00010995' TO DFHEIV0
 11512     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11513     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11514     MOVE X'2020233030303130393935' TO DFHEIV0(25:11)
 11515     CALL 'kxdfhei1' USING DFHEIV0,
 11516           DFHEIV1,
 11517           DFHEIV20,
 11518           DFHEIV99,
 11519           ERACCT-KEY,
 11520           DFHEIV99,
 11521           DFHEIV11,
 11522           DFHEIV99,
 11523           DFHEIV99
 11524     SET ADDRESS OF ACCOUNT-MASTER TO
 11525         DFHEIV20
 11526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11527
 11528
 11529     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11530        IF WS-ERACCT-HOLD-RECORD = SPACES
 11531           GO TO 1950-NOT-FOUND
 11532        ELSE
 11533           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11534           GO TO 1250-CONTINUE.
 11535
 11536     IF ACCT-EXP-DT = HIGH-VALUES
 11537        NEXT SENTENCE
 11538     ELSE
 11539        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11540        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11541
 11542 1250-CONTINUE.
 11543
 11544     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11545
 11546     IF FOUND-TOL-SW = 'N'
 11547         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11548
 11549********* 1260-FIND-STATE-TOLERANCES.
 11550
 11551     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11552     MOVE PI-STATE               TO WS-ST-ACCESS.
 11553     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11554     MOVE '3'                    TO CNTL-REC-TYPE.
 11555     MOVE +0                     TO CNTL-SEQ-NO.
 11556     MOVE 'STAT'                 TO FILE-SWITCH.
 11557
 11558     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11559
 11560     IF WS-PMT-TOL = +0
 11561         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11562
 11563     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 218
* EL156.cbl
 11564     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11565     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11566     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11567     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11568
 11569****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11570****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11571     IF PI-PAYEE-TYPE <> 'B'
 11572           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11573     END-IF.
 11574
 11575     IF PI-PMTTYPE      = '2'  AND
 11576        PI-SPLIT-PMT-SW = 'Y'  AND
 11577        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11578          MOVE ER-3530                TO EMI-ERROR
 11579          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11580
 11581********* 1280-FIND-BENEFIT-TOLERANCES.
 11582
 11583     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11584        OR (PI-PMTTYPE = '5' OR '6')
 11585         GO TO 1300-FIND-CARR-TOLERANCES.
 11586
 11587     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11588     MOVE '4'                    TO CNTL-REC-TYPE.
 11589     MOVE +0                     TO CNTL-SEQ-NO.
 11590     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11591     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11592     MOVE 'BENE'                 TO FILE-SWITCH.
 11593
 11594     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11595
 11596     IF NO-BENEFIT-FOUND
 11597         GO TO 1950-NOT-FOUND.
 11598
 11599     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11600     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11601     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11602
 11603
 11604* EXEC CICS HANDLE CONDITION
 11605*        NOTFND(1950-NOT-FOUND)
 11606*    END-EXEC.
 11607*    MOVE '"$I                   ! , #00011075' TO DFHEIV0
 11608     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11609     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11610     MOVE X'2C20233030303131303735' TO DFHEIV0(25:11)
 11611     CALL 'kxdfhei1' USING DFHEIV0
 11612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11613
 11614
 11615 1300-FIND-CARR-TOLERANCES.
 11616     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11617     MOVE '6'                    TO CNTL-REC-TYPE.
 11618
 11619     IF CONTROL-IS-ACTUAL-CARRIER
 11620         MOVE PI-CARRIER               TO WS-CARR
 11621     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 219
* EL156.cbl
 11622         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11623
 11624     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11625     MOVE +0                     TO CNTL-SEQ-NO.
 11626     MOVE 'CARR'                 TO FILE-SWITCH.
 11627
 11628     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11629
 11630     IF WS-DAYS-TOL = +0
 11631         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11632
 11633     IF WS-PMT-TOL = +0
 11634         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11635
 11636     IF WS-MAX-DAYS-TOL = +0
 11637         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11638
 11639     IF WS-MAX-PMT-TOL = +0
 11640         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11641                                    PI-MAX-PMT-TOL.
 11642
 11643     IF WS-MAX-LF-PMT-TOL = +0
 11644        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11645                                    PI-MAX-LF-PMT-TOL.
 11646
 11647     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11648
 11649********* 1320-FIND-COMP-TOLERANCES.
 11650
 11651     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11652     MOVE '1'                    TO CNTL-REC-TYPE.
 11653     MOVE SPACES                 TO CNTL-ACCESS.
 11654     MOVE +0                     TO CNTL-SEQ-NO.
 11655     MOVE 'COMP'                 TO FILE-SWITCH.
 11656
 11657     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11658
 11659     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11660     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11661
 11662     IF WS-PMT-TOL NOT = +0
 11663        IF WS-TOL-SEVERITY NOT = ' '
 11664         GO TO 1360-EDIT-DAYS.
 11665
 11666     IF WS-PMT-TOL = +0
 11667         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11668
 11669     IF WS-TOL-SEVERITY = ' '
 11670         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11671
 11672 1360-EDIT-DAYS.
 11673     IF PI-PMTTYPE NOT = '4'
 11674        IF PI-EDAYS NEGATIVE OR
 11675           PI-EPYAMT NEGATIVE
 11676          MOVE ER-0513             TO EMI-ERROR
 11677          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11678          MOVE -1                  TO PMTTYPEL.
 11679
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 220
* EL156.cbl
 11680     IF PI-PMTTYPE = '5' OR '6'
 11681        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11682
 11683     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11684        IF PI-PMTTYPE = '4'
 11685          MOVE PI-EDAYS          TO PI-CDAYS.
 11686
 11687     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11688         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11689
 11690     IF PI-PMTTYPE = '4'
 11691        MOVE PI-EDAYS            TO PI-CDAYS
 11692        GO TO 1400-EDIT-PAYMENT.
 11693
 11694     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11695        GO TO 1500-EDIT-EXPENSES.
 11696
 11697*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11698*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11699*          CM-AH-BENEFIT-CD = '23'              AND
 11700*          CL-CERT-STATE    = '04'              AND
 11701*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11702*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11703*            GO TO 1362-CHECK-MAX-DAYS.
 11704
 11705     IF PI-EDAYS = ZEROS
 11706*        IF PI-COMPANY-ID = 'DMD'
 11707*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11708*            MOVE -1             TO DC-ELAPSED-DAYS
 11709*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11710*            MOVE '6'            TO DC-OPTION-CODE
 11711*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11712*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11713*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11714*            MOVE '1'            TO DC-OPTION-CODE
 11715*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11716*            IF NO-CONVERSION-ERROR
 11717*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11718*                                 + DC-ODD-DAYS-OVER
 11719*               MOVE 6           TO EDAYSL
 11720*               MOVE AL-UNNON    TO EDAYSA
 11721*            ELSE
 11722*                NEXT SENTENCE
 11723*       ELSE
 11724            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11725            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11726            MOVE '1'             TO DC-OPTION-CODE
 11727            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11728            IF NO-CONVERSION-ERROR
 11729                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11730                ADD 1                 TO PI-EDAYS
 11731                MOVE AL-UNNON         TO EDAYSA.
 11732
 11733*    IF PI-COMPANY-ID = 'DMD'
 11734*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11735*        MOVE -1                 TO DC-ELAPSED-DAYS
 11736*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11737*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 221
* EL156.cbl
 11738*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11739*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11740*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11741*        MOVE '1'                TO DC-OPTION-CODE
 11742*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11743*    ELSE
 11744         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11745         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11746         MOVE '1'                TO DC-OPTION-CODE.
 11747         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11748
 11749     IF NO-CONVERSION-ERROR
 11750        IF PI-COMPANY-ID = 'DMD'
 11751            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11752                             + DC-ODD-DAYS-OVER
 11753        ELSE
 11754            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11755            ADD 1                TO PI-CDAYS.
 11756
 11757     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11758        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11759        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11760
 11761     IF PI-EDAYS NOT NUMERIC
 11762         MOVE ER-0491            TO EMI-ERROR
 11763         GO TO 1370-DAYS-ERROR.
 11764
 11765     IF CL-NO-OF-PMTS-MADE = 0
 11766        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11767        AND CL-CERT-STATE = 'MI'
 11768        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11769            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11770     END-IF.
 11771
 11772 1362-CHECK-MAX-DAYS.
 11773
 11774     IF WS-MAX-DAYS-TOL = +999
 11775         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11776
 11777     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11778         IF PI-EDAYS = ZEROS
 11779             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11780         ELSE
 11781             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11782
 11783     IF WS-MAX-DAYS-TOL NOT = ZERO
 11784        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11785           PI-CDAYS > WS-MAX-DAYS-TOL
 11786             MOVE ER-0492          TO EMI-ERROR
 11787             GO TO 1370-DAYS-ERROR.
 11788
 11789 1365-SKIP-MAX-DAYS-EDIT.
 11790     IF PI-EDAYS = ZEROS
 11791        GO TO 1400-EDIT-PAYMENT.
 11792
 11793     IF WS-DAYS-TOL NOT = ZERO
 11794        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11795           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 222
* EL156.cbl
 11796                MOVE ER-0493     TO EMI-ERROR
 11797                GO TO 1370-DAYS-ERROR.
 11798
 11799     GO TO 1400-EDIT-PAYMENT.
 11800
 11801 1370-DAYS-ERROR.
 11802     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11803
 11804     IF EMI-MESSAGE-FORMATTED
 11805         MOVE -1                 TO EDAYSL
 11806         MOVE AL-UABON           TO EDAYSA.
 11807
 11808     GO TO 1400-EDIT-PAYMENT.
 11809
 11810 1380-EDIT-EXPENSE-PMT-AMT.
 11811     IF PI-PMTTYPE = '5' OR '6'
 11812         NEXT SENTENCE
 11813     ELSE
 11814         GO TO 1400-EDIT-PAYMENT.
 11815
 11816     IF WS-MAX-EXP-PMT NOT = ZEROS
 11817        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11818            MOVE ER-3529            TO EMI-ERROR
 11819            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11820
 11821     GO TO 1500-EDIT-EXPENSES.
 11822
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 223
* EL156.cbl
 11824
 11825 1390-CHECK-PAYMENT-DAYS.
 11826
 11827     IF PI-EDAYS = 0
 11828         MOVE PI-CDAYS TO WS-PD-DAYS
 11829     ELSE
 11830         MOVE PI-EDAYS TO WS-PD-DAYS
 11831     END-IF.
 11832
 11833     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11834         IF WS-PD-DAYS = 14
 11835            GO TO 1390-EXIT
 11836         END-IF
 11837     END-IF.
 11838
 11839     IF PI-COMPANY-ID = 'AHL'  AND
 11840        CM-AH-BENEFIT-CD = '1K'
 11841         IF WS-PD-DAYS = 14
 11842            GO TO 1390-EXIT
 11843         END-IF
 11844     END-IF.
 11845
 11846     IF WS-PD-DAYS < 30
 11847         MOVE ER-3549              TO EMI-ERROR
 11848         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11849     END-IF.
 11850
 11851 1390-EXIT.
 11852      EXIT.
 11853
 11854 1400-EDIT-PAYMENT.
 11855*    IF PI-COMPANY-ID = 'DMD'
 11856*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11857*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11858
 11859     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 11860        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11861        MOVE PI-CARRIER          TO ACCT-CARRIER
 11862        MOVE PI-GROUPING         TO ACCT-GROUPING
 11863        MOVE PI-STATE            TO ACCT-STATE
 11864        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11865        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11866        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11867        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11868
 11869
 11870* EXEC CICS READ
 11871*          DATASET ('ERACCT')
 11872*          RIDFLD  (ERACCT-KEY)
 11873*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11874*          GTEQ
 11875*          resp    (WS-RESPONSE)
 11876*       END-EXEC
 11877     MOVE 'ERACCT' TO DFHEIV1
 11878*    MOVE '&"S        G          (  N#00011333' TO DFHEIV0
 11879     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11880     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11881     MOVE X'204E233030303131333333' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 224
* EL156.cbl
 11882     CALL 'kxdfhei1' USING DFHEIV0,
 11883           DFHEIV1,
 11884           DFHEIV20,
 11885           DFHEIV99,
 11886           ERACCT-KEY,
 11887           DFHEIV99,
 11888           DFHEIV99,
 11889           DFHEIV99
 11890     SET ADDRESS OF ACCOUNT-MASTER TO
 11891         DFHEIV20
 11892     MOVE EIBRESP  TO WS-RESPONSE
 11893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11894        IF WS-RESP-NORMAL
 11895           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11896           and pi-cert-eff-dt < am-expiration-dt
 11897           and pi-cert-eff-dt >= am-effective-dt
 11898           move am-dcc-product-code to pi-dcc-product-code
 11899        else
 11900           move spaces           to pi-dcc-product-code
 11901        end-if
 11902        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11903           PERFORM 0900-GET-DDF-LIMITS
 11904                                 THRU 0900-EXIT
 11905           IF PDEF-FOUND
 11906              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11907                 (P1 > +8)
 11908                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11909              END-PERFORM
 11910              IF P1 < +9
 11911                 if pd-ben-pct (p1) not numeric
 11912                    move zeros   to pd-ben-pct (p1)
 11913                 end-if
 11914                 if pd-ben-pct (p1) = zeros
 11915                    move +1      to ws-work-ben-pct
 11916                 else
 11917                    move pd-ben-pct (p1)
 11918                                 to ws-work-ben-pct
 11919                 end-if
 11920                 compute cm-ah-benefit-amt =
 11921                    cm-ah-benefit-amt * ws-work-ben-pct
 11922                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11923                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11924                 end-if
 11925              else
 11926                 move er-1674    to emi-error
 11927                 PERFORM 9900-ERROR-FORMAT
 11928                                 THRU 9900-EXIT
 11929              END-IF
 11930           else
 11931              move er-1672       to emi-error
 11932              PERFORM 9900-ERROR-FORMAT
 11933                                 THRU 9900-EXIT
 11934           END-IF
 11935        end-if
 11936     END-IF
 11937     IF PI-PMTTYPE NOT = '4'
 11938        GO TO 1405-CALC-PAYMENT.
 11939     IF PI-EDAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 225
* EL156.cbl
 11940         MOVE PI-EPYAMT           TO PI-CPYAMT
 11941         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11942         GO TO 1430-CHECK-AH-TOLERANCE.
 11943
 11944*    IF PI-COMPANY-ID = 'FIA'
 11945*       IF CERT-ACCOUNT = '0000011043'
 11946*        COMPUTE PI-DAILY-RATE ROUNDED =
 11947*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11948*        COMPUTE PI-CPYAMT ROUNDED =
 11949*                          PI-DAILY-RATE * PI-EDAYS
 11950*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11951*        GO TO 1430-CHECK-AH-TOLERANCE.
 11952
 11953     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11954         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11955         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11956         GO TO 1420-CHECK-AIG-BENEFIT.
 11957
 11958     IF WS-CALC-METHOD = '2' OR  '5'
 11959         COMPUTE PI-DAILY-RATE ROUNDED =
 11960                        (CM-AH-BENEFIT-AMT * 12) / 365
 11961         COMPUTE PI-CPYAMT ROUNDED =
 11962                           PI-DAILY-RATE * PI-EDAYS
 11963        GO TO 1420-CHECK-AIG-BENEFIT.
 11964
 11965     IF WS-CALC-METHOD = '3'
 11966         COMPUTE PI-DAILY-RATE =
 11967                         (CM-AH-BENEFIT-AMT * 12) / 365
 11968         COMPUTE PI-CPYAMT ROUNDED =
 11969                           PI-DAILY-RATE * PI-EDAYS
 11970        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 226
* EL156.cbl
 11972*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11973
 11974****************************************************************
 11975****************************************************************
 11976*                  CALCULATED FROM      PAYMENT      PAYMENT
 11977*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11978* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11979*1-01-83  1-15-83    0    15     15        15           15
 11980*1-01-83  1-30-83    0    30     30        30           30
 11981*1-01-83  1-31-83    1     0     31        30           30
 11982*1-01-83  2-01-83    1     1     32        31           31
 11983*1-01-83  2-15-83    1    15     46        45           45
 11984*1-01-83  2-28-83    2     0     59        60           60
 11985*1-01-83  3-01-83    2     1     60        61           61
 11986*1-01-83  3-31-83    3     0     90        90           90
 11987*1-15-83  1-31-83    0    17     17        17           16
 11988*1-15-83  2-01-83    0    18     18        18           17
 11989*1-15-83  2-28-83    1    14     45        44           46
 11990*1-21-83  3-09-83    1    20     48        50           49
 11991*2-05-83  3-06-83    1     2     30        32           32
 11992*2-05-83  3-23-83    1    19     47        49           49
 11993*2-15-83  2-28-83    0    14     14        14           16
 11994*2-15-83  3-01-83    0    15     15        15           17
 11995*2-21-83  3-19-83    0    27     27        27           29
 11996*2-21-83  3-20-83    1     0     28        30           30
 11997*2-21-83  4-10-83    1    18     49        30           50
 11998*2-21-83  5-19-83    2    27     88        87           89
 11999*2-21-83  5-22-83    3     2     91        92           92
 12000*3-21-83  5-19-83    1    30     60        60           59
 12001****************************************************************
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 227
* EL156.cbl
 12003 1405-CALC-PAYMENT.
 12004     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12005     MOVE ' '                    TO DC-OPTION-CODE.
 12006     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12007     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 12008     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 12009
 12010     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12011     MOVE ' '                    TO DC-OPTION-CODE.
 12012     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12013     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 12014     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 12015
 12016     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12017     MOVE -1                     TO DC-ELAPSED-DAYS.
 12018     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12019     MOVE '6'                    TO DC-OPTION-CODE.
 12020     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12021     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 12022
 12023     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 12024     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 12025     MOVE '1'                    TO DC-OPTION-CODE.
 12026     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12027
 12028     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 12029     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 12030     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 12031
 12032******************************************************************
 12033*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 12034*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 12035*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 12036******************************************************************
 12037
 12038     IF WS-CALC-METHOD = '1'           AND
 12039        DC-ELAPSED-MONTHS > ZERO AND
 12040        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 12041        WDF-DAY > WDT-DAY
 12042          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 12043          MOVE ZEROS               TO DC-ELAPSED-DAYS
 12044          MOVE -1                  TO DC-ELAPSED-MONTHS
 12045          MOVE '6'                 TO DC-OPTION-CODE
 12046          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12047          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 12048          COMPUTE WS-SAVE-ODD-DAYS =
 12049          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 12050          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 12051
 12052     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 12053     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 12054     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 12055
 12056     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 12057     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 12058
 12059*    IF PI-COMPANY-ID = 'FIA'
 12060*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 228
* EL156.cbl
 12061*        COMPUTE PI-DAILY-RATE ROUNDED =
 12062*                          (CM-AH-BENEFIT-AMT * 13) / 365
 12063*        COMPUTE PI-CPYAMT ROUNDED =
 12064*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 12065*        GO TO 1420-CHECK-AIG-BENEFIT.
 12066
 12067*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12068*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 12069*          CM-AH-BENEFIT-CD = '23'               AND
 12070*          CL-CERT-STATE    = '04'               AND
 12071*         (PI-PMTTYPE = '1' OR '2' OR '3')
 12072*            COMPUTE WS-DAILY-RATE ROUNDED =
 12073*                               CM-AH-BENEFIT-AMT / 30
 12074*            COMPUTE PI-CPYAMT ROUNDED =
 12075*                               (WS-DAILY-RATE * PI-CDAYS)
 12076*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12077*            GO TO 1420-CHECK-AIG-BENEFIT.
 12078
 12079     IF WS-CALC-METHOD = '1'
 12080         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 12081         COMPUTE PI-CPYAMT ROUNDED =
 12082             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12083             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12084         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 12085         GO TO 1420-CHECK-AIG-BENEFIT.
 12086
 12087     IF WS-CALC-METHOD = '2'
 12088         COMPUTE PI-DAILY-RATE ROUNDED =
 12089                          (CM-AH-BENEFIT-AMT * 12) / 365
 12090         COMPUTE PI-CPYAMT ROUNDED =
 12091             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 12092             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 12093         GO TO 1420-CHECK-AIG-BENEFIT.
 12094
 12095     IF WS-CALC-METHOD = '4'
 12096         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 12097         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 12098         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 12099         COMPUTE PI-CPYAMT ROUNDED =
 12100                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 12101         GO TO 1420-CHECK-AIG-BENEFIT.
 12102
 12103     IF WS-CALC-METHOD = '5'
 12104         COMPUTE PI-DAILY-RATE ROUNDED =
 12105                            (CM-AH-BENEFIT-AMT * 12) / 365
 12106         COMPUTE PI-CPYAMT ROUNDED =
 12107                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 12108         GO TO 1420-CHECK-AIG-BENEFIT.
 12109
 12110     IF WS-CALC-METHOD NOT = '3'
 12111        GO TO 1410-CHECK-PAYMENT.
 12112
 12113******   CALCULATION METHOD  3  ROUTINE
 12114     COMPUTE PI-DAILY-RATE =
 12115                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 12116
 12117******CHECK TO SEE IF WITHIN SAME MONTH
 12118     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 229
* EL156.cbl
 12119        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 12120                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 12121         GO TO 1420-CHECK-AIG-BENEFIT.
 12122
 12123******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 12124     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 12125             SAVE-ODD-DAYS-OVER = ZEROS
 12126      COMPUTE PI-CPYAMT  ROUNDED =
 12127                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 12128      GO TO 1420-CHECK-AIG-BENEFIT.
 12129
 12130******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 12131******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 12132     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12133        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 12134        IF WDF-MONTH > 12
 12135           ADD 1                 TO WDF-YEAR
 12136           SUBTRACT 12         FROM WDF-MONTH.
 12137
 12138******CONVERT THE NEW FROM MONTH TO BINARY
 12139     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 12140        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 12141        MOVE '4'              TO DC-OPTION-CODE
 12142        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12143        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 12144
 12145     IF WDF-MONTH = WDT-MONTH AND
 12146        WDF-YEAR  = WDT-YEAR
 12147          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 12148                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 12149                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 12150        ELSE
 12151          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 12152          MOVE WDT-DAY              TO THRU-PMT-DAYS
 12153          COMPUTE PI-CPYAMT ROUNDED =
 12154       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 12155       +
 12156       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 12157       +
 12158       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 12159
 12160     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 230
* EL156.cbl
 12162 1410-CHECK-PAYMENT.
 12163******PAYMENT OPTION 6
 12164******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 12165     IF SAVE-ELAPSED-MONTHS > ZERO
 12166        IF SAVE-ODD-DAYS-OVER = ZEROS
 12167           GO TO 1412-CHECK-TO-DAY
 12168        ELSE
 12169           IF WDF-DAY > WDT-DAY
 12170              IF WDF-MONTH = 02
 12171                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12172                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 12173                  GO TO 1412-CHECK-TO-DAY
 12174              ELSE
 12175                  IF FROM-DAYS-IN-MONTH = 31
 12176                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 12177                     GO TO 1412-CHECK-TO-DAY
 12178                  ELSE
 12179                     GO TO 1412-CHECK-TO-DAY
 12180           ELSE
 12181               GO TO 1412-CHECK-TO-DAY.
 12182
 12183     IF WDF-MONTH NOT = WDT-MONTH
 12184        IF WDF-MONTH = 02
 12185           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12186           IF WDF-DAY = 29
 12187              ADD 1              TO SAVE-ODD-DAYS-OVER
 12188           ELSE
 12189              ADD 2              TO SAVE-ODD-DAYS-OVER
 12190        ELSE
 12191           IF FROM-DAYS-IN-MONTH = 31
 12192              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12193
 12194 1412-CHECK-TO-DAY.
 12195        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12196           IF WDT-DAY = 28
 12197              ADD 2              TO SAVE-ODD-DAYS-OVER
 12198           ELSE
 12199              IF WDT-DAY = 29
 12200                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12201              ELSE
 12202                 NEXT SENTENCE
 12203        ELSE
 12204           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12205              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12206
 12207     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12208     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12209     COMPUTE PI-CPYAMT ROUNDED =
 12210         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12211         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12212
 12213     GO TO 1420-CHECK-AIG-BENEFIT.
 12214
 12215 1415-CHECK-LEAP-YEAR.
 12216     IF FROM-DAYS-IN-MONTH = 29
 12217        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12218
 12219 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 231
* EL156.cbl
 12220     EXIT.
 12221
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 232
* EL156.cbl
 12223 1420-CHECK-AIG-BENEFIT.
 12224
 12225     IF WS-SPECIAL-CALC-CD = 'Q'
 12226         GO TO 1425-CHECK-WHOLE-MONTH.
 12227
 12228*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12229*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12230*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12231*       (PI-PMTTYPE = '1' OR '2')
 12232*        NEXT SENTENCE
 12233*    ELSE
 12234         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12235         GO TO 1430-CHECK-AH-TOLERANCE.
 12236
 12237******************AIG LOGIC STARTS**********************
 12238*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12239*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12240*    MOVE ER-3533      TO EMI-ERROR.
 12241*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12242*    GO TO 1430-CHECK-AH-TOLERANCE.
 12243******************AIG LOGIC ENDS************************
 12244
 12245 1425-CHECK-WHOLE-MONTH.
 12246******************************************************************
 12247****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12248****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12249****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12250****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12251****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12252****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12253****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12254****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12255****          PAID * MONTHLY BENEFIT.                         ****
 12256******************************************************************
 12257
 12258     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12259
 12260     IF CL-NO-OF-PMTS-MADE > +0
 12261         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12262
 12263     IF PI-CDAYS < WS-BEN-DAYS
 12264         GO TO 1430-CHECK-AH-TOLERANCE.
 12265
 12266     IF PI-CDAYS = WS-BEN-DAYS
 12267         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12268         GO TO 1430-CHECK-AH-TOLERANCE.
 12269
 12270*    IF PI-COMPANY-ID = 'ACM'
 12271*       NEXT SENTENCE
 12272*    ELSE
 12273        GO TO 1425-NOT-ACM-W15C.
 12274
 12275*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12276*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12277*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12278*    MOVE '6'                    TO  DC-OPTION-CODE.
 12279*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12280*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 233
* EL156.cbl
 12281*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12282*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12283*       MOVE '1'                 TO  DC-OPTION-CODE
 12284*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12285*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12286*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12287*       IF NO-CONVERSION-ERROR
 12288*          IF (DC-ELAPSED-MONTHS > +0) OR
 12289*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12290*             NEXT SENTENCE
 12291*          ELSE
 12292*             MOVE +0            TO  PI-CPYAMT
 12293*             MOVE ER-0846       TO  EMI-ERROR
 12294*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12295*             GO TO 1430-CHECK-AH-TOLERANCE
 12296*       ELSE
 12297*           MOVE ER-0846         TO  EMI-ERROR
 12298*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12299*           GO TO 1430-CHECK-AH-TOLERANCE.
 12300*
 12301*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12302*       ADD +1 TO DC-ELAPSED-MONTHS.
 12303*
 12304*    COMPUTE PI-CPYAMT ROUNDED =
 12305*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12306*
 12307*    GO TO 1430-CHECK-AH-TOLERANCE.
 12308
 12309 1425-NOT-ACM-W15C.
 12310
 12311     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12312     MOVE '6'                        TO  DC-OPTION-CODE.
 12313     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12314     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12315
 12316     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12317     IF NO-CONVERSION-ERROR
 12318         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12319     ELSE
 12320         MOVE ER-0846                TO  EMI-ERROR
 12321         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12322         GO TO 1430-CHECK-AH-TOLERANCE.
 12323
 12324     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12325     MOVE '1'                        TO  DC-OPTION-CODE.
 12326     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12327     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12328     IF NO-CONVERSION-ERROR
 12329         IF DC-ODD-DAYS-OVER = +0
 12330             NEXT SENTENCE
 12331         ELSE
 12332             MOVE ER-0846            TO  EMI-ERROR
 12333             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12334             GO TO 1430-CHECK-AH-TOLERANCE
 12335     ELSE
 12336         MOVE ER-0846                TO  EMI-ERROR
 12337         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12338         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 234
* EL156.cbl
 12339
 12340     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12341         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12342
 12343     GO TO 1430-CHECK-AH-TOLERANCE.
 12344
 12345 1425-CONT-WHOLE-MONTH-PMTS.
 12346******************************************************************
 12347****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12348****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12349****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12350******************************************************************
 12351
 12352     IF PI-COMPANY-ID = 'ACM'
 12353        NEXT SENTENCE
 12354     ELSE
 12355        IF DC-ODD-DAYS-OVER = +0
 12356            NEXT SENTENCE
 12357        ELSE
 12358            MOVE ER-0845            TO  EMI-ERROR
 12359            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12360            GO TO 1430-CHECK-AH-TOLERANCE.
 12361
 12362     COMPUTE PI-CPYAMT ROUNDED =
 12363                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12364
 12365 1430-CHECK-AH-TOLERANCE.
 12366     IF PI-PMT-APPR-SW = 'G'
 12367         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12368
 12369*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12370*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12371*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12372*
 12373*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12374*      IF WDF-MONTH = 02
 12375*        IF SAVE-ELAPSED-MONTHS = 0
 12376*          NEXT SENTENCE
 12377*        ELSE
 12378*          IF SAVE-ODD-DAYS-OVER > 0
 12379*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12380*            COMPUTE WS-PMT-MOS ROUNDED =
 12381*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12382*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12383*                                     WS-PMT-MOS
 12384*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12385*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12386*          ELSE
 12387*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12388*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12389*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12390*                                     WS-PMT-MOS.
 12391
 12392     IF WS-MAX-PMT-TOL NOT = ZERO
 12393        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12394           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12395            MOVE ER-0494         TO  EMI-ERROR
 12396            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 235
* EL156.cbl
 12397            GO TO 1500-EDIT-EXPENSES.
 12398
 12399 1430-CONT-CHECK-AH-TOLERANCE.
 12400
 12401     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12402        GO TO 1500-EDIT-EXPENSES.
 12403
 12404     IF CM-O-B-COVERAGE
 12405        GO TO 1500-EDIT-EXPENSES.
 12406
 12407     IF PI-COMPANY-ID = 'NCL'
 12408       IF FOUND-TOL-SW = 'Y'
 12409         IF WS-PMT-TOL NOT = ZERO
 12410           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12411              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12412                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12413                  IF WS-NCL-PMT-OPTION = SPACES
 12414                      MOVE ER-0699 TO EMI-ERROR
 12415                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12416                  ELSE
 12417                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12418                      NEXT SENTENCE
 12419                  ELSE
 12420                  IF NOT WS-VALID-NCL-OPTION
 12421                      MOVE ER-0699 TO EMI-ERROR
 12422                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12423
 12424     IF WS-PMT-TOL NOT = ZERO
 12425        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12426           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12427           MOVE ER-0495          TO EMI-ERROR
 12428           PERFORM 1490-PAYMENT-ERROR
 12429                                 THRU 1490-EXIT
 12430        end-if
 12431     end-if
 12432
 12433     GO TO 1500-EDIT-EXPENSES.
 12434
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 236
* EL156.cbl
 12436 1440-COMPUTE-LIFE-REMAINING.
 12437
 12438     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12439        IF PI-PMTTYPE = '4'
 12440          MOVE PI-EPYAMT TO PI-CPYAMT
 12441          GO TO 1460-TEST-TYPE.
 12442
 12443     IF WS-LF-COVERAGE-TYPE = 'L'
 12444        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12445                          - CL-TOTAL-PAID-AMT
 12446        GO TO 1450-CHECK-MAX.
 12447
 12448     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12449        PI-LF-COVERAGE-TYPE = 'P'
 12450          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12451                              CM-LF-ITD-DEATH-AMT
 12452          GO TO 1450-CHECK-MAX.
 12453
 12454     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12455     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12456     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12457     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12458     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12459     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12460     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12461     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12462     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12463
 12464     PERFORM 9800-LINK-REM-TERM.
 12465
 12466     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12467     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12468     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12469     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12470     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12471     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12472     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12473     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12474     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12475     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12476     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12477     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12478     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12479     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12480     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12481     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12482     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 12483        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12484        MOVE PI-CARRIER          TO ACCT-CARRIER
 12485        MOVE PI-GROUPING         TO ACCT-GROUPING
 12486        MOVE PI-STATE            TO ACCT-STATE
 12487        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12488        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12489        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12490        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12491
 12492
 12493* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 237
* EL156.cbl
 12494*          DATASET ('ERACCT')
 12495*          RIDFLD  (ERACCT-KEY)
 12496*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12497*          GTEQ
 12498*          resp    (WS-RESPONSE)
 12499*       END-EXEC
 12500     MOVE 'ERACCT' TO DFHEIV1
 12501*    MOVE '&"S        G          (  N#00011938' TO DFHEIV0
 12502     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12503     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12504     MOVE X'204E233030303131393338' TO DFHEIV0(25:11)
 12505     CALL 'kxdfhei1' USING DFHEIV0,
 12506           DFHEIV1,
 12507           DFHEIV20,
 12508           DFHEIV99,
 12509           ERACCT-KEY,
 12510           DFHEIV99,
 12511           DFHEIV99,
 12512           DFHEIV99
 12513     SET ADDRESS OF ACCOUNT-MASTER TO
 12514         DFHEIV20
 12515     MOVE EIBRESP  TO WS-RESPONSE
 12516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12517        IF WS-RESP-NORMAL
 12518           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12519           and (pi-cert-eff-dt < am-expiration-dt)
 12520           and (pi-cert-eff-dt >= am-effective-dt)
 12521           move am-dcc-product-code to pi-dcc-product-code
 12522        else
 12523           move spaces           to pi-dcc-product-code
 12524        end-if
 12525        if pi-dcc-product-code not = spaces
 12526           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12527           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12528           PERFORM 0900-GET-DDF-limits
 12529                                 THRU 0900-EXIT
 12530           IF PDEF-FOUND
 12531              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12532                 (P1 > +8)
 12533                 OR (PD-PROD-CODE (P1) = 'L')
 12534              END-PERFORM
 12535              IF P1 < +9
 12536                 MOVE PD-MAX-AMT (P1)
 12537                                 TO CP-R-MAX-TOT-BEN
 12538              else
 12539                 move er-1674    to emi-error
 12540                 PERFORM 9900-ERROR-FORMAT
 12541                                 THRU 9900-EXIT
 12542              END-IF
 12543           else
 12544              move er-1672       to emi-error
 12545              PERFORM 9900-ERROR-FORMAT
 12546                                 THRU 9900-EXIT
 12547           END-IF
 12548        end-if
 12549     END-IF
 12550
 12551* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 238
* EL156.cbl
 12552*       PROGRAM  (LINK-REMAMT)
 12553*       COMMAREA (CALCULATION-PASS-AREA)
 12554*       LENGTH   (CP-COMM-LENGTH)
 12555*    END-EXEC.
 12556*    MOVE '."C                   (   #00011978' TO DFHEIV0
 12557     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12558     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12559     MOVE X'2020233030303131393738' TO DFHEIV0(25:11)
 12560     CALL 'kxdfhei1' USING DFHEIV0,
 12561           LINK-REMAMT,
 12562           CALCULATION-PASS-AREA,
 12563           CP-COMM-LENGTH,
 12564           DFHEIV99,
 12565           DFHEIV99,
 12566           DFHEIV99,
 12567           DFHEIV99
 12568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12569
 12570
 12571     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12572
 12573     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12574     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12575
 12576     IF PI-COMPANY-ID = 'BOA' AND
 12577        PI-PMTTYPE    = '2'   AND
 12578        PI-OFFLINE    = 'N'
 12579           GO TO 1441-COMPUTE-BOA-INTEREST.
 12580
 12581     IF PI-COMPANY-ID = 'NCL' AND
 12582        PI-PMTTYPE    = '2'   AND
 12583        PI-OFFLINE    = 'N'
 12584          GO TO 1442-COMPUTE-NCL-INTEREST
 12585       ELSE
 12586          GO TO 1445-CONTINUE.
 12587
 12588 1441-COMPUTE-BOA-INTEREST.
 12589     MOVE +0             TO WS-CALC-INT.
 12590
 12591     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12592     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12593     MOVE +0             TO DC-ELAPSED-MONTHS
 12594                            DC-ELAPSED-DAYS.
 12595     MOVE '1'            TO DC-OPTION-CODE.
 12596     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12597     IF NO-CONVERSION-ERROR
 12598         NEXT SENTENCE
 12599     ELSE
 12600         GO TO 1445-CONTINUE.
 12601
 12602     IF (PI-INT-RATE NOT > ZEROS)  AND
 12603        (DC-ELAPSED-DAYS > +30)
 12604         MOVE ER-3531            TO EMI-ERROR
 12605         MOVE -1                 TO PINTL
 12606         MOVE AL-UNBON           TO PINTA
 12607         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12608
 12609     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 239
* EL156.cbl
 12610         GO TO 1445-CONTINUE.
 12611
 12612     IF (PI-INT-RATE NOT > ZEROS)  OR
 12613        (DC-ELAPSED-DAYS NOT > +30)
 12614         MOVE PI-EPYAMT TO PI-CPYAMT
 12615         GO TO 1441-FORMAT-NOTE.
 12616
 12617     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12618                                 *  PI-INT-RATE
 12619                                 *  DC-ELAPSED-DAYS
 12620                                 /  365
 12621                                 /  100.
 12622
 12623     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12624
 12625 1441-FORMAT-NOTE.
 12626
 12627     MOVE SPACES        TO WS-BOANOTE1.
 12628     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12629     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12630     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12631     MOVE AL-UANON      TO NOTE1A.
 12632
 12633     IF WS-CALC-INT > ZEROS
 12634         MOVE SPACES        TO WS-BOANOTE2
 12635         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12636         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12637         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12638         MOVE AL-UANON      TO NOTE2A.
 12639
 12640     GO TO 1445-CONTINUE.
 12641
 12642 1442-COMPUTE-NCL-INTEREST.
 12643     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12644     MOVE PI-STATE               TO WS-ST-ACCESS.
 12645     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12646     MOVE '3'                    TO CNTL-REC-TYPE.
 12647     MOVE +0                     TO CNTL-SEQ-NO.
 12648     MOVE 'STAT'                 TO FILE-SWITCH.
 12649
 12650     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12651
 12652     MOVE +0                 TO WS-CALC-INT.
 12653
 12654     IF ST-STAT-FROM-INCURRED
 12655         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12656       ELSE
 12657     IF ST-STAT-FROM-REPORTED
 12658         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12659       ELSE
 12660         GO TO 1445-CONTINUE.
 12661
 12662     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12663     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12664     MOVE +0                 TO DC-ELAPSED-MONTHS
 12665                                DC-ELAPSED-DAYS.
 12666     MOVE '1'                TO DC-OPTION-CODE.
 12667     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 240
* EL156.cbl
 12668     IF NO-CONVERSION-ERROR
 12669         NEXT SENTENCE
 12670     ELSE
 12671         GO TO 1445-CONTINUE.
 12672
 12673     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12674        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12675         GO TO 1445-CONTINUE.
 12676
 12677     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12678                                 *  CF-ST-STAT-INTEREST.
 12679
 12680     MOVE SPACES              TO WS-NCLNOTE1.
 12681     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12682     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12683     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12684                                 PI-PMTNOTE1
 12685                                 NOTE1I.
 12686     MOVE AL-UANON            TO NOTE1A.
 12687
 12688     IF WS-CALC-INT > ZEROS
 12689         MOVE SPACES          TO WS-NCLNOTE2
 12690         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12691         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12692         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12693                                 PI-PMTNOTE2
 12694                                 NOTE2I
 12695         MOVE AL-UANON        TO NOTE2A.
 12696
 12697     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12698
 12699 1445-CONTINUE.
 12700
 12701     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12702        GO TO 1460-TEST-TYPE.
 12703
 12704     IF CM-O-B-COVERAGE
 12705        GO TO 1460-TEST-TYPE.
 12706
 12707     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12708         GO TO 1450-CHECK-MAX.
 12709
 12710     if (pi-company-id = 'DCC' or 'VPP')
 12711        and (pdef-found)
 12712        if pi-epyamt > pd-max-amt (p1)
 12713           move er-1657          to emi-error
 12714           perform 1490-payment-error
 12715                                 thru 1490-exit
 12716           go to 1460-test-type
 12717        end-if
 12718     else
 12719        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12720           > PI-EPYAMT)
 12721                         OR
 12722           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12723           < PI-EPYAMT)
 12724           MOVE ER-0594          TO EMI-ERROR
 12725           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 241
* EL156.cbl
 12726                                 THRU 1490-EXIT
 12727           GO TO 1460-TEST-TYPE
 12728        end-if
 12729     end-if
 12730     .
 12731 1450-CHECK-MAX.
 12732
 12733     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12734        PI-LF-COVERAGE-TYPE = 'P'
 12735         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12736                                   CM-LF-ITD-DEATH-AMT
 12737     ELSE
 12738         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12739                                   CL-TOTAL-PAID-AMT.
 12740
 12741     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12742          MOVE ER-0543           TO EMI-ERROR
 12743          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12744
 12745 1460-TEST-TYPE.
 12746
 12747     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12748        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12749           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12750                                   CM-LF-ALT-BENEFIT-AMT -
 12751                                   CL-TOTAL-PAID-AMT
 12752           IF PI-EPYAMT > WS-LF-BEN-AMT
 12753               MOVE ER-0543      TO EMI-ERROR
 12754               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12755           END-IF
 12756        END-IF
 12757     END-IF
 12758
 12759     IF PI-PMT-APPR-SW = 'G'
 12760       NEXT SENTENCE
 12761     ELSE
 12762       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12763         IF PI-EPYAMT = ZERO
 12764             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12765                 MOVE ER-0494    TO  EMI-ERROR
 12766                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12767                 GO TO 1500-EDIT-EXPENSES
 12768             ELSE
 12769                 NEXT SENTENCE
 12770         ELSE
 12771             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12772                 MOVE ER-0494    TO  EMI-ERROR
 12773                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12774                 GO TO 1500-EDIT-EXPENSES.
 12775
 12776     IF PI-PMTTYPE NOT = '2' OR
 12777        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12778         GO TO 1500-EDIT-EXPENSES.
 12779
 12780     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12781     MOVE ER-0526                TO EMI-ERROR.
 12782     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12783
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 242
* EL156.cbl
 12784     IF EMI-ERROR-NUMBER (1) = '0526'
 12785        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12786
 12787     IF EMI-ERROR-NUMBER (2) = '0526'
 12788        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12789
 12790     GO TO 1500-EDIT-EXPENSES.
 12791
 12792 1490-PAYMENT-ERROR.
 12793     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12794
 12795     IF EMI-MESSAGE-FORMATTED
 12796         MOVE -1                 TO EPYAMTL
 12797         MOVE AL-UNBON           TO EPYAMTA.
 12798
 12799 1490-EXIT.
 12800      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 243
* EL156.cbl
 12802 1500-EDIT-EXPENSES.
 12803     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12804         GO TO 1500-SKIP-ERROR-0556.
 12805
 12806 1500-CONTINUE-ON.
 12807
 12808     IF CM-O-B-COVERAGE
 12809        MOVE ER-0556             TO EMI-ERROR
 12810        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12811
 12812 1500-SKIP-ERROR-0556.
 12813     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12814        IF PI-EEXPENS NOT = ZEROS
 12815           MOVE ER-0524          TO EMI-ERROR
 12816           GO TO 1590-EXPENSE-ERROR
 12817        ELSE
 12818           GO TO 1600-EDIT-RESERVES.
 12819
 12820     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12821     MOVE '6'                    TO CNTL-REC-TYPE.
 12822
 12823     IF CONTROL-IS-ACTUAL-CARRIER
 12824         MOVE PI-CARRIER         TO WS-CARR
 12825     ELSE
 12826         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12827
 12828     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12829     MOVE +0                     TO CNTL-SEQ-NO.
 12830     MOVE 'CARR'                 TO FILE-SWITCH.
 12831
 12832     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12833
 12834     IF EXPENSE-CALC-MANUAL
 12835        GO TO 1600-EDIT-RESERVES.
 12836
 12837     IF DOLLARS-PER-PMT
 12838        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12839        GO TO 1600-EDIT-RESERVES.
 12840
 12841     IF DOLLARS-PER-MONTH AND
 12842        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12843       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12844       GO TO 1600-EDIT-RESERVES.
 12845
 12846     IF PERCENT-OF-PAYMENT
 12847        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12848
 12849     GO TO 1600-EDIT-RESERVES.
 12850
 12851 1590-EXPENSE-ERROR.
 12852     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12853
 12854     IF EMI-MESSAGE-FORMATTED
 12855        MOVE -1                  TO EEXPENSL
 12856        MOVE AL-UNBON            TO EEXPENSA.
 12857
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 244
* EL156.cbl
 12859 1600-EDIT-RESERVES.
 12860     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12861        IF PI-ERESV = ZEROS
 12862           GO TO 1700-EDIT-EXPENSE-TYPE
 12863        ELSE
 12864           MOVE ER-0525          TO EMI-ERROR
 12865           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12866           GO TO 1700-EDIT-EXPENSE-TYPE.
 12867
 12868     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12869     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12870     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12871
 12872     IF NOT AT-MANUAL-RESERVES-USED
 12873        IF PI-ERESV NOT = ZEROS
 12874           MOVE ER-0518          TO EMI-ERROR
 12875           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12876
 12877     IF AT-MANUAL-RESERVES-USED
 12878        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12879        GO TO 1700-EDIT-EXPENSE-TYPE.
 12880
 12881     IF AT-FUTURE-RESERVES-USED
 12882        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12883
 12884     IF AT-FUTURE-RESERVES-USED
 12885        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12886
 12887     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12888        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12889
 12890     IF AT-IBNR-RESERVES-USED
 12891        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12892
 12893     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12894     GO TO 1700-EDIT-EXPENSE-TYPE.
 12895
 12896 1690-RESERVE-ERROR.
 12897     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12898
 12899     IF EMI-MESSAGE-FORMATTED
 12900        MOVE AL-UNBON            TO ERESVA
 12901        MOVE -1                  TO ERESVL.
 12902
 12903 1690-EXIT.
 12904      EXIT.
 12905
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 245
* EL156.cbl
 12907 1700-EDIT-EXPENSE-TYPE.
 12908     IF PI-PMTTYPE NOT = '5' AND '6'
 12909        GO TO 2000-EDIT-DONE.
 12910
 12911     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12912                   '6' OR '7' OR '8' OR '9'
 12913        GO TO 2000-EDIT-DONE.
 12914
 12915 1705-EXPENSE-ERROR.
 12916     MOVE ER-0573                TO EMI-ERROR.
 12917     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12918
 12919     IF EMI-MESSAGE-FORMATTED
 12920        MOVE AL-UABON            TO ETYPEA
 12921        MOVE -1                  TO ETYPEL.
 12922
 12923     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 246
* EL156.cbl
 12925 1950-NOT-FOUND.
 12926     IF FILE-SWITCH = 'MSTR'
 12927        MOVE ER-0204             TO EMI-ERROR.
 12928
 12929     IF FILE-SWITCH = 'CARR'
 12930        MOVE ER-0252             TO EMI-ERROR.
 12931
 12932     IF FILE-SWITCH = 'COMP'
 12933        MOVE ER-0254             TO EMI-ERROR.
 12934
 12935     IF FILE-SWITCH = 'STAT'
 12936        MOVE ER-0149             TO EMI-ERROR.
 12937
 12938     IF FILE-SWITCH = 'PROC'
 12939        MOVE ER-0019             TO EMI-ERROR.
 12940
 12941     IF FILE-SWITCH = 'ACCT'
 12942        MOVE ER-0198             TO EMI-ERROR.
 12943
 12944     IF FILE-SWITCH = 'BENE'
 12945        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12946           MOVE ER-0282          TO EMI-ERROR
 12947        ELSE
 12948           MOVE ER-0283          TO EMI-ERROR.
 12949
 12950     MOVE -1                     TO PMTTYPEL.
 12951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12952
 12953     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12954                                     WS-FORCE-CTR.
 12955
 12956     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12957                                     WS-FATAL-CTR.
 12958
 12959     GO TO 8200-SEND-DATAONLY.
 12960
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 247
* EL156.cbl
 12962 2000-EDIT-DONE.
 12963     perform 2210-dcc-max-benes thru 2210-exit
 12964     if pi-company-id not = 'DCC' and 'VPP'
 12965        IF (WS-SPECIAL-CALC-CD = 'C')
 12966           and (cl-critical-period > 0)
 12967           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12968              IF PI-EPYAMT > ZEROS
 12969                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12970                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12971              ELSE
 12972                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12973                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12974              END-IF
 12975              if ws-benefits-paid > cl-critical-period
 12976                 MOVE ER-0657          TO EMI-ERROR
 12977                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12978              END-IF
 12979           END-IF
 12980        END-IF
 12981     end-if
 12982     IF PI-HOLDTIL NOT = ZEROS
 12983        MOVE PI-HOLDTIL          TO HOLDTILO
 12984        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12985
 12986     IF PI-EPYFROM NOT = ZEROS
 12987        MOVE PI-EPYFROM          TO EPYFROMO
 12988        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12989
 12990     IF PI-EPYTHRU NOT = ZEROS
 12991        MOVE PI-EPYTHRU            TO EPYTHRUO
 12992        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12993        IF PI-USES-PAID-TO
 12994           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12995           MOVE '4'                TO DC-OPTION-CODE
 12996           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12997           IF NO-CONVERSION-ERROR
 12998              MOVE +1              TO DC-ELAPSED-DAYS
 12999              MOVE +0              TO DC-ELAPSED-MONTHS
 13000              MOVE '6'             TO DC-OPTION-CODE
 13001              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13002              IF NO-CONVERSION-ERROR
 13003                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13004
 13005     MOVE PI-EDAYS               TO EDAYSO.
 13006
 13007     IF PI-AIGFROM NOT = ZEROS
 13008        MOVE PI-AIGFROM          TO AIGFROMO
 13009        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13010
 13011     MOVE PI-EPYAMT              TO EPYAMTO.
 13012     MOVE PI-ERESV               TO ERESVO.
 13013     MOVE PI-EEXPENS             TO EEXPENSO.
 13014
 13015     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13016     MOVE SPACES                 TO DC-OPTION-CODE.
 13017     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13018
 13019     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 248
* EL156.cbl
 13020        MOVE SPACES              TO CPYFROMI
 13021     ELSE
 13022        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 13023        IF PI-EPYFROM = ZEROS
 13024           MOVE AL-UANON             TO EPYFROMA
 13025           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 13026           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 13027
 13028     IF PI-USES-PAID-TO
 13029        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 13030        MOVE +1                            TO DC-ELAPSED-DAYS
 13031        MOVE +0                            TO DC-ELAPSED-MONTHS
 13032        MOVE '6'                           TO DC-OPTION-CODE
 13033        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13034        IF NO-CONVERSION-ERROR
 13035           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 13036           IF PI-EPYTHRU = ZEROS
 13037              MOVE AL-UANON                TO EPYTHRUA
 13038              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 13039              MOVE ' '                     TO DC-OPTION-CODE
 13040              MOVE +0                      TO DC-ELAPSED-DAYS
 13041                                              DC-ELAPSED-MONTHS
 13042              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13043              IF NO-CONVERSION-ERROR
 13044                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 13045                  GO TO 2001-CONTINUE
 13046              ELSE
 13047                  GO TO 2001-CONTINUE
 13048           ELSE
 13049              GO TO 2001-CONTINUE.
 13050
 13051     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13052     MOVE SPACES                 TO DC-OPTION-CODE.
 13053     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13054
 13055     IF DATE-CONVERSION-ERROR
 13056        MOVE SPACES              TO CPYTHRUI
 13057     ELSE
 13058        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13059        IF PI-EPYTHRU = ZEROS
 13060           MOVE AL-UANON TO EPYTHRUA
 13061           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 13062           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 13063
 13064 2001-CONTINUE.
 13065
 13066     MOVE PI-CDAYS               TO CDAYSO.
 13067
 13068     IF PI-EDAYS = ZEROS
 13069        MOVE AL-UNNON TO EDAYSA
 13070        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 13071
 13072     MOVE PI-CPYAMT              TO CPYAMTO.
 13073
 13074     IF PI-EPYAMT = ZEROS
 13075        MOVE AL-UNNON            TO EPYAMTA
 13076        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
 13077
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 249
* EL156.cbl
 13078     MOVE PI-CRESV               TO CRESVO.
 13079     MOVE PI-CEXPENS             TO CEXPENSO.
 13080
 13081     IF PI-EEXPENS = ZEROS
 13082        MOVE AL-UNNON TO EEXPENSA
 13083        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 13084
 13085     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 13086        AND (CL-CLAIM-TYPE = 'L')
 13087        AND (PI-OFFLINE NOT EQUAL 'Y')
 13088        IF PI-PMTTYPE = '2' OR '4'
 13089           PERFORM 2200-CALC-INTEREST
 13090                                 THRU 2200-EXIT
 13091        END-IF
 13092     END-IF
 13093     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 13094     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 13095     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 13096
 13097     IF EMI-FATAL-CTR = ZEROS
 13098        MOVE 'B'                 TO PI-PASS-SW.
 13099
 13100     IF NOT EMI-MESSAGE-FORMATTED
 13101         MOVE -1                 TO EPYFROML
 13102     ELSE
 13103         IF EMI-ERROR-NUMBER (1) = '0526' AND
 13104            EMI-ERROR-NUMBER (2) = SPACES
 13105             MOVE -1             TO EPYFROML.
 13106
 13107     GO TO 8200-SEND-DATAONLY.
 13108
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 250
* EL156.cbl
 13110 2200-CALC-INTEREST.
 13111     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 13112        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 13113        MOVE '4'                 TO DC-OPTION-CODE
 13114        PERFORM 9700-LINK-DATE-CONVERT
 13115        IF DATE-CONVERSION-ERROR
 13116            MOVE LOW-VALUES      TO CP-PRF-DT
 13117        ELSE
 13118           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 13119        END-IF
 13120     END-IF
 13121     if (pi-int-to-rem-borr <> 'Y' and 'N')
 13122        if pi-rb-joint-coverage
 13123           move 'Y'              to pi-int-to-rem-borr
 13124        end-if
 13125     end-if
 13126     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 13127        IN CLAIM-INT-PASS-AREA
 13128     MOVE CL-CERT-STATE          TO CP-STATE
 13129        IN CLAIM-INT-PASS-AREA
 13130     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 13131     MOVE 'LF'                   TO CP-COVERAGE
 13132     MOVE CL-INCURRED-DT         TO CP-INC-DT
 13133     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 13134     MOVE LOW-VALUES             TO CP-LSTPD-DT
 13135     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 13136     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 13137     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 13138
 13139* EXEC CICS LINK
 13140*       PROGRAM   ('ELCLMI')
 13141*       COMMAREA  (CLAIM-INT-PASS-AREA)
 13142*       LENGTH    (CP-CLAIM-LENGTH)
 13143*    END-EXEC
 13144     MOVE 'ELCLMI' TO DFHEIV1
 13145*    MOVE '."C                   (   #00012551' TO DFHEIV0
 13146     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 13147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13148     MOVE X'2020233030303132353531' TO DFHEIV0(25:11)
 13149     CALL 'kxdfhei1' USING DFHEIV0,
 13150           DFHEIV1,
 13151           CLAIM-INT-PASS-AREA,
 13152           CP-CLAIM-LENGTH,
 13153           DFHEIV99,
 13154           DFHEIV99,
 13155           DFHEIV99,
 13156           DFHEIV99
 13157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13158     MOVE AL-PANOF               TO PINTHA
 13159                                    PINTA
 13160     if cp-clm-int-amt = zeros
 13161        move ' ' to pi-int-to-rem-borr
 13162     end-if
 13163     IF NO-CI-ERROR
 13164        MOVE CP-CLM-INT-AMT      TO PINTO
 13165                                    PI-INT-AMT
 13166        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 13167        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 251
* EL156.cbl
 13168        MOVE AL-PANOF            TO PINTHA
 13169                                    PINTA
 13170        if pi-rb-joint-coverage
 13171           and pi-int-amt > zeros
 13172           move '  INT TO'       to itrb1o
 13173           move ' REM BORR?'     to itrb2o
 13174           move pi-int-to-rem-borr
 13175                                 to itrbyno
 13176           move al-uanon         to itrbyna
 13177           move +1               to itrbynl
 13178        else
 13179           move ' '              to pi-int-to-rem-borr
 13180        end-if
 13181     ELSE
 13182        IF CI-RETURN-CODE = '8'
 13183           MOVE ER-3818          TO EMI-ERROR
 13184           MOVE -1               TO ZINTL
 13185           PERFORM 9900-ERROR-FORMAT
 13186                                 THRU 9900-EXIT
 13187           GO TO 2200-EXIT
 13188        ELSE
 13189           MOVE ZEROS            TO PINTO
 13190                                    PI-INT-AMT
 13191                                    PI-INT-DAYS
 13192                                    PI-INT-RATE-USED
 13193        END-IF
 13194     END-IF
 13195     IF PI-INT-AMT NOT = ZEROS
 13196        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 13197           AND (CL-SOC-SEC-NO NOT = ZEROS)
 13198           CONTINUE
 13199        ELSE
 13200           MOVE CL-SOC-SEC-NO (1:3)
 13201                                 TO WS-SSN (1:3)
 13202           MOVE CL-SOC-SEC-NO (5:2)
 13203                                 TO WS-SSN (4:2)
 13204           MOVE CL-SOC-SEC-NO (8:4)
 13205                                 TO WS-SSN (6:4)
 13206           IF (WS-SSN NUMERIC)
 13207              AND (WS-SSN NOT = ZEROS)
 13208              CONTINUE
 13209           ELSE
 13210              MOVE ER-2044       TO EMI-ERROR
 13211              PERFORM 9900-ERROR-FORMAT
 13212                                 THRU 9900-EXIT
 13213           END-IF
 13214        END-IF
 13215        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13216        if pi-int-to-rem-borr = 'Y'
 13217           move +61              to trlr-seq-no
 13218        else
 13219           MOVE +51              TO TRLR-SEQ-NO
 13220        end-if
 13221
 13222* EXEC CICS READ
 13223*          DATASET  ('ELTRLR')
 13224*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13225*          RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 252
* EL156.cbl
 13226*          RESP     (WS-RESPONSE)
 13227*       END-EXEC
 13228     MOVE 'ELTRLR' TO DFHEIV1
 13229*    MOVE '&"S        E          (  N#00012619' TO DFHEIV0
 13230     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13231     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13232     MOVE X'204E233030303132363139' TO DFHEIV0(25:11)
 13233     CALL 'kxdfhei1' USING DFHEIV0,
 13234           DFHEIV1,
 13235           DFHEIV20,
 13236           DFHEIV99,
 13237           ELTRLR-KEY,
 13238           DFHEIV99,
 13239           DFHEIV99,
 13240           DFHEIV99
 13241     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13242         DFHEIV20
 13243     MOVE EIBRESP  TO WS-RESPONSE
 13244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13245        IF (NOT WS-RESP-NORMAL)
 13246                    OR
 13247           ((WS-RESP-NORMAL)
 13248           AND ((AT-ADDRESS-LINE-1 = SPACES)
 13249           OR (AT-CITY-STATE = SPACES)))
 13250           MOVE ER-0874          TO EMI-ERROR
 13251           if pi-rb-joint-coverage
 13252              move -1            to itrbynl
 13253           end-if
 13254           PERFORM 9900-ERROR-FORMAT
 13255                                 THRU 9900-EXIT
 13256        else
 13257           move at-mail-to-name  to pi-int-payees-name
 13258        END-IF
 13259     END-IF
 13260     .
 13261 2200-EXIT.
 13262     EXIT.
 13263 2210-dcc-max-benes.
 13264
 13265     move pi-ah-term             to ws-max-bens
 13266     if cl-critical-period not = zeros and spaces
 13267        move cl-critical-period  to ws-max-bens
 13268     end-if
 13269     move cm-ah-benefit-amt      to ws-monthly-benefit
 13270     if pdef-found
 13271        and (pd-max-amt (p1) not = zeros)
 13272        if pd-ben-pct (p1) not numeric
 13273           move zeros            to pd-ben-pct (p1)
 13274        end-if
 13275        if pd-ben-pct (p1) = zeros
 13276           move +1               to ws-work-ben-pct
 13277        else
 13278           move pd-ben-pct (p1)  to ws-work-ben-pct
 13279        end-if
 13280*       compute ws-monthly-benefit =
 13281*          ws-monthly-benefit * ws-work-ben-pct
 13282*       if ws-monthly-benefit > pd-max-amt (p1)
 13283*          move pd-max-amt (p1) to ws-monthly-benefit
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 253
* EL156.cbl
 13284*       end-if
 13285     end-if
 13286
 13287     move cl-cert-key-data       to elcrtt-key (2:21)
 13288     move cl-company-cd          to ctrlr-comp-cd
 13289     move cl-cert-no             to ctrlr-cert-no
 13290     move 'B'                    to ctrlr-rec-type
 13291
 13292
 13293* EXEC CICS READ
 13294*       DATASET  ('ELCRTT')
 13295*       set      (address of CERTIFICATE-TRAILERS)
 13296*       RIDFLD   (ELCRTT-KEY)
 13297*       RESP     (WS-RESPONSE)
 13298*    END-EXEC
 13299     MOVE 'ELCRTT' TO DFHEIV1
 13300*    MOVE '&"S        E          (  N#00012672' TO DFHEIV0
 13301     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13302     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13303     MOVE X'204E233030303132363732' TO DFHEIV0(25:11)
 13304     CALL 'kxdfhei1' USING DFHEIV0,
 13305           DFHEIV1,
 13306           DFHEIV20,
 13307           DFHEIV99,
 13308           ELCRTT-KEY,
 13309           DFHEIV99,
 13310           DFHEIV99,
 13311           DFHEIV99
 13312     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13313         DFHEIV20
 13314     MOVE EIBRESP  TO WS-RESPONSE
 13315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13316     IF not WS-RESP-NORMAL
 13317        go to 2210-exit
 13318     end-if
 13319
 13320*    if instypei = 'P'
 13321*       move +1 to s1
 13322*    else
 13323*       MOVE +2 to s1
 13324*    end-if
 13325
 13326*    move +1 to s1
 13327*    evaluate cl-claim-type
 13328*       when 'A'
 13329*          move +1 to s2
 13330*       when 'I'
 13331*          move +2 to s2
 13332*       when 'G'
 13333*          move +3 to s2
 13334*       when 'L'
 13335*          move +4 to s2
 13336*       when 'P'
 13337*          move +5 to s2
 13338*    end-evaluate
 13339
 13340     move zeros                  to ws-prev-days-paid
 13341                                    ws-benefits-paid
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 254
* EL156.cbl
 13342                                    ws-prev-amt-paid
 13343     perform varying s1 from +1 by +1 until
 13344        (s1 > +24)
 13345        or (cs-claim-type (s1) = spaces)
 13346        if pi-company-id not = 'DCC' and 'VPP'
 13347           if cs-claim-type (s1) = cl-claim-type
 13348              compute ws-prev-days-paid =
 13349                 ws-prev-days-paid + cs-days-paid (s1)
 13350              compute ws-prev-amt-paid =
 13351                 ws-prev-amt-paid + cs-total-paid (s1)
 13352           end-if
 13353        else
 13354           if (cs-claim-type (s1) = cl-claim-type)
 13355              and (cs-benefit-period (s1) = cl-benefit-period)
 13356              and (cs-insured-type (s1) = cl-insured-type)
 13357              compute ws-prev-days-paid =
 13358                 ws-prev-days-paid + cs-days-paid (s1)
 13359              compute ws-prev-amt-paid =
 13360                 ws-prev-amt-paid + cs-total-paid (s1)
 13361           end-if
 13362        end-if
 13363     end-perform
 13364     if pi-epyamt > zeros
 13365        compute ws-benefits-paid =
 13366           (ws-prev-amt-paid + pi-epyamt)
 13367           / ws-monthly-benefit
 13368     else
 13369        compute ws-benefits-paid =
 13370           (ws-prev-amt-paid + pi-cpyamt)
 13371           / ws-monthly-benefit
 13372     end-if
 13373*    if pi-company-id = 'DCC'
 13374     if cl-claim-type not = 'L' and 'P'
 13375        if ws-benefits-paid > ws-max-bens
 13376           move er-1658          to emi-error
 13377           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13378        end-if
 13379     end-if
 13380*    end-if
 13381*     if s1 < +25
 13382*        if pi-epyamt > zeros
 13383*           compute ws-benefits-paid =
 13384*              (cs-total-paid (s1) + PI-EPYAMT)
 13385*              / ws-monthly-benefit
 13386*        else
 13387*           compute ws-benefits-paid =
 13388*              (cs-total-paid (s1) + PI-CPYAMT)
 13389*              / ws-monthly-benefit
 13390*        end-if
 13391
 13392*       if ws-benefits-paid > pd-crit-period (p1)
 13393*        if ws-benefits-paid > ws-max-bens
 13394*           move er-1658          to emi-error
 13395*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13396*        end-if
 13397*     end-if
 13398     .
 13399 2210-exit.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 255
* EL156.cbl
 13400     exit.
 13401
 13402 2220-update-elcrtt.
 13403
 13404
 13405* EXEC CICS GETMAIN
 13406*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13407*       LENGTH   (ELCRTT-LENGTH)
 13408*       INITIMG  (GETMAIN-SPACE)
 13409*    END-EXEC
 13410*    MOVE ',"IL                  $   #00012766' TO DFHEIV0
 13411     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13412     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13413     MOVE X'2020233030303132373636' TO DFHEIV0(25:11)
 13414     CALL 'kxdfhei1' USING DFHEIV0,
 13415           DFHEIV20,
 13416           ELCRTT-LENGTH,
 13417           GETMAIN-SPACE
 13418     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13419         DFHEIV20
 13420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13421
 13422     move cl-cert-key-data       to elcrtt-key (2:21)
 13423     move cl-company-cd          to ctrlr-comp-cd
 13424     move cl-cert-no             to ctrlr-cert-no
 13425     move 'B'                    to ctrlr-rec-type
 13426
 13427
 13428* EXEC CICS READ
 13429*       UPDATE
 13430*       DATASET  (ELCRTT-DSID)
 13431*       into     (CERTIFICATE-TRAILERS)
 13432*       RIDFLD   (ELCRTT-KEY)
 13433*       RESP     (WS-RESPONSE)
 13434*    END-EXEC
 13435     MOVE LENGTH OF
 13436      CERTIFICATE-TRAILERS
 13437       TO DFHEIV11
 13438*    MOVE '&"IL       EU         (  N#00012777' TO DFHEIV0
 13439     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13440     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13441     MOVE X'204E233030303132373737' TO DFHEIV0(25:11)
 13442     CALL 'kxdfhei1' USING DFHEIV0,
 13443           ELCRTT-DSID,
 13444           CERTIFICATE-TRAILERS,
 13445           DFHEIV11,
 13446           ELCRTT-KEY,
 13447           DFHEIV99,
 13448           DFHEIV99,
 13449           DFHEIV99
 13450     MOVE EIBRESP  TO WS-RESPONSE
 13451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13452
 13453     IF WS-RESP-NORMAL
 13454        perform 2225-upd-crt-trlr thru 2225-exit
 13455
 13456* EXEC CICS REWRITE
 13457*          DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 256
* EL156.cbl
 13458*          from     (CERTIFICATE-TRAILERS)
 13459*          RESP     (WS-RESPONSE)
 13460*       END-EXEC
 13461     MOVE LENGTH OF
 13462      CERTIFICATE-TRAILERS
 13463       TO DFHEIV11
 13464*    MOVE '&& L                  %  N#00012787' TO DFHEIV0
 13465     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13466     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13467     MOVE X'204E233030303132373837' TO DFHEIV0(25:11)
 13468     CALL 'kxdfhei1' USING DFHEIV0,
 13469           ELCRTT-DSID,
 13470           CERTIFICATE-TRAILERS,
 13471           DFHEIV11,
 13472           DFHEIV99
 13473     MOVE EIBRESP  TO WS-RESPONSE
 13474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13475     else
 13476        if ws-resp-notfnd
 13477           move 'CS'             to certificate-trailers
 13478           move cl-company-cd    to cs-company-cd
 13479           move cl-cert-key-data to cs-control-primary (2:21)
 13480           move cl-cert-no       to cs-cert-no
 13481           move 'B'              to cs-trailer-type
 13482           perform varying s1 from +1 by +1 until s1 > +24
 13483              move zeros         to cs-benefit-period (s1)
 13484                                    cs-days-paid (s1)
 13485                                    cs-total-paid (s1)
 13486                                    cs-remaining-bens (s1)
 13487           end-perform
 13488           perform 2225-upd-crt-trlr
 13489                                 thru 2225-exit
 13490
 13491* EXEC CICS WRITE
 13492*             DATASET  (ELCRTT-DSID)
 13493*             from     (CERTIFICATE-TRAILERS)
 13494*             RIDFLD   (cs-control-primary)
 13495*             RESP     (WS-RESPONSE)
 13496*          END-EXEC
 13497     MOVE LENGTH OF
 13498      CERTIFICATE-TRAILERS
 13499       TO DFHEIV11
 13500*    MOVE '&$ L                  ''  N#00012807' TO DFHEIV0
 13501     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13502     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13503     MOVE X'204E233030303132383037' TO DFHEIV0(25:11)
 13504     CALL 'kxdfhei1' USING DFHEIV0,
 13505           ELCRTT-DSID,
 13506           CERTIFICATE-TRAILERS,
 13507           DFHEIV11,
 13508           cs-control-primary,
 13509           DFHEIV99,
 13510           DFHEIV99
 13511     MOVE EIBRESP  TO WS-RESPONSE
 13512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13513        end-if
 13514     END-IF
 13515
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 257
* EL156.cbl
 13516     .
 13517 2220-exit.
 13518     exit.
 13519
 13520 2225-upd-crt-trlr.
 13521
 13522*    if instypei = 'P'
 13523*       move +1 to s1
 13524*    else
 13525*       MOVE +2 to s1
 13526*    end-if
 13527
 13528*    move +1 to s1
 13529*    evaluate cl-claim-type
 13530*       when 'A'
 13531*          move +1 to s2
 13532*       when 'I'
 13533*          move +2 to s2
 13534*       when 'G'
 13535*          move +3 to s2
 13536*       when 'L'
 13537*          move +4 to s2
 13538*       when 'P'
 13539*          move +5 to s2
 13540*    end-evaluate
 13541     perform varying s1 from +1 by +1 until
 13542        (s1 > +24)
 13543        or (cl-claim-no = cs-claim-no (s1))
 13544     end-perform
 13545     if s1 < +25
 13546        compute cs-total-paid (s1) =
 13547           cs-total-paid (s1) + at-amount-paid
 13548        compute cs-days-paid (s1) =
 13549           cs-days-paid (s1) +  at-days-in-period
 13550*       compute cs-remaining-bens (s1) =
 13551*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13552        perform 2230-accum-bens-paid thru 2230-exit
 13553     end-if
 13554
 13555     .
 13556 2225-exit.
 13557     exit.
 13558 2230-accum-bens-paid.
 13559     if cl-claim-type not = 'L' and 'P'
 13560        move pi-ah-term          to ws-max-bens
 13561        if cl-critical-period not = zeros and spaces
 13562           move cl-critical-period
 13563                                 to ws-max-bens
 13564        end-if
 13565     else
 13566        move 01                  to ws-max-bens
 13567     end-if
 13568     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13569     perform varying s2 from +1 by +1 until
 13570        (s2 > +24)
 13571        or (cs-claim-no (s2) = spaces)
 13572        if pi-company-id not = 'DCC' and 'VPP'
 13573           if cs-claim-type (s2) = cl-claim-type
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 258
* EL156.cbl
 13574              compute ws-tot-days-paid =
 13575                 ws-tot-days-paid + cs-days-paid (s2)
 13576              compute ws-tot-amt-paid =
 13577                 ws-tot-amt-paid + cs-total-paid (s2)
 13578           end-if
 13579        else
 13580           if (cs-benefit-period (s2) = cl-benefit-period)
 13581              and (cs-claim-type (s2) = cl-claim-type)
 13582              and (cs-insured-type (s2) = cl-insured-type)
 13583              compute ws-tot-days-paid =
 13584                 ws-tot-days-paid + cs-days-paid (s2)
 13585              compute ws-tot-amt-paid =
 13586                 ws-tot-amt-paid + cs-total-paid (s2)
 13587           end-if
 13588        end-if
 13589     end-perform
 13590     if cl-claim-type = 'L' and 'P'
 13591        if ws-tot-amt-paid > zeros
 13592           move zeros            to cs-remaining-bens (s1)
 13593        else
 13594           move 01               to cs-remaining-bens (s1)
 13595        end-if
 13596     else
 13597        compute ws-pd-bens rounded =
 13598           ws-tot-amt-paid / pi-ah-benefit-amt
 13599        compute cs-remaining-bens (s1) =
 13600           ws-max-bens - ws-pd-bens
 13601        if cs-remaining-bens (s1) < zeros
 13602           move zeros            to cs-remaining-bens (s1)
 13603        end-if
 13604     end-if
 13605     .
 13606 2230-exit.
 13607     exit.
 13608 3000-MOVE-INPUT-TO-SAVE-AREA.
 13609     IF PMTTYPEL > 0
 13610         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13611
 13612     if ws-pmttype = '4'
 13613        if pi-rb-joint-coverage
 13614           if payeel = +0
 13615              move +2            to payeel
 13616              move al-uanon      to payeea
 13617              move 'Q1'          to payeeo
 13618           else
 13619              if payeei not = 'Q1' and 'q1'
 13620                 move er-1582    to emi-error
 13621                 PERFORM 9900-ERROR-FORMAT thru 9900-exit
 13622              end-if
 13623           end-if
 13624        end-if
 13625     end-if
 13626     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13627
 13628     IF WS-PMTTYPE = '9'
 13629         MOVE 'P'                TO PI-PROVISIONAL-IND
 13630         MOVE '1'                TO WS-PMTTYPE.
 13631
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 259
* EL156.cbl
 13632     IF PAYEEL > 0
 13633         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13634         MOVE PAYEEI             TO WS-PAYEE.
 13635
 13636     IF NOTE1L > +0
 13637         MOVE NOTE1I             TO WS-PMTNOTE1
 13638                                    WS-FLI-PMTNOTE
 13639                                    WS-HAN-PMTNOTE.
 13640
 13641     IF NOTE2L > +0
 13642         MOVE NOTE2I             TO WS-PMTNOTE2.
 13643
 13644     IF OFFLINEL > 0
 13645         MOVE OFFLINEI           TO WS-OFFLINE.
 13646
 13647     IF PROOFDTL > 0
 13648         MOVE PROOFDTI            TO DATE-WORK
 13649         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13650         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13651         MOVE '4'                 TO DC-OPTION-CODE
 13652         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13653         IF NO-CONVERSION-ERROR
 13654            MOVE NUM-WORK         TO PROOFDTO
 13655            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13656            MOVE NUM-WORK         TO WS-PROOF-DATE
 13657         ELSE
 13658            MOVE ZEROS            TO WS-PROOF-DATE
 13659         END-IF
 13660     END-IF.
 13661
 13662     IF EOBYNL > +0
 13663         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13664         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13665     END-IF
 13666
 13667     IF CLMFMYNL > +0
 13668         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13669         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13670     END-IF
 13671
 13672     IF SURVYYNL > +0
 13673         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
 13674         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13675     END-IF
 13676
 13677     IF SPRELYNL > +0
 13678         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13679         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13680     END-IF
 13681     if itrbynl <> +0
 13682        move function upper-case(itrbyni) to itrbyni
 13683        move itrbyni             to ws-int-to-rem-borr
 13684     end-if
 13685*    IF GROUPEDL > +0
 13686*        MOVE GROUPEDI           TO WS-GROUPED.
 13687*
 13688*    IF CASHL > +0
 13689*       MOVE CASHI               TO WS-CASH.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 260
* EL156.cbl
 13690     IF LOANNOL > +0
 13691         MOVE LOANNOI            TO WS-LOAN-NO.
 13692
 13693     IF CHECKNOL > 0
 13694         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13695
 13696     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13697         IF WS-AIG-CREDIT-ENTERED
 13698             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13699             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13700             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13701             MOVE AL-UANON         TO CHECKNOA.
 13702
 13703     IF HOLDTILL > 0
 13704         MOVE HOLDTILI           TO DATE-WORK
 13705         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13706         MOVE NUM-WORK           TO WS-HOLDTIL.
 13707
 13708     IF ZINTL > +0
 13709
 13710* EXEC CICS BIF DEEDIT
 13711*           FIELD   (ZINTI)
 13712*           LENGTH  (07)
 13713*       END-EXEC
 13714     MOVE 07
 13715       TO DFHEIV11
 13716*    MOVE '@"L                   #   #00013009' TO DFHEIV0
 13717     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13718     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13719     MOVE X'2020233030303133303039' TO DFHEIV0(25:11)
 13720     CALL 'kxdfhei1' USING DFHEIV0,
 13721           ZINTI,
 13722           DFHEIV11
 13723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13724        IF ZINTI NOT NUMERIC
 13725           MOVE ER-0419          TO EMI-ERROR
 13726           PERFORM 9900-ERROR-FORMAT
 13727           MOVE AL-UABON         TO ZINTA
 13728           MOVE -1               TO ZINTL
 13729        ELSE
 13730           MOVE ZINTI            TO CP-INT-RATE
 13731                                    WS-INT-RATE
 13732           MOVE CP-INT-RATE      TO ZINTO
 13733           MOVE AL-UNNON         TO ZINTA
 13734        END-IF
 13735     ELSE
 13736        MOVE ZEROS               TO CP-INT-RATE
 13737     END-IF
 13738     IF EPYFROML > 0
 13739         MOVE EPYFROMI           TO DATE-WORK
 13740         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13741         MOVE NUM-WORK           TO WS-EPYFROM.
 13742
 13743     IF AIGFROML > 0
 13744         MOVE AIGFROMI           TO DATE-WORK
 13745         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13746         MOVE NUM-WORK           TO WS-AIGFROM
 13747     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 261
* EL156.cbl
 13748         IF (AIGFROMI = LOW-VALUES) AND
 13749            (PI-AIGFROM NOT = ZEROS)
 13750              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13751
 13752     IF EPYTHRUL > +0
 13753        MOVE EPYTHRUI           TO DATE-WORK
 13754        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13755        MOVE NUM-WORK           TO WS-EPYTHRU
 13756        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13757        MOVE '4'                TO DC-OPTION-CODE
 13758        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13759        IF NO-CONVERSION-ERROR
 13760           IF PI-USES-PAID-TO
 13761              MOVE '6'                TO DC-OPTION-CODE
 13762              MOVE -1                 TO DC-ELAPSED-DAYS
 13763              MOVE +0                 TO DC-ELAPSED-MONTHS
 13764              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13765              IF NO-CONVERSION-ERROR
 13766                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13767                 MOVE ' '             TO DC-OPTION-CODE
 13768                 MOVE +0              TO DC-ELAPSED-DAYS
 13769                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13770              IF NO-CONVERSION-ERROR
 13771                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13772
 13773*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13774*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13775     IF EDAYSL > 0
 13776
 13777* EXEC CICS BIF DEEDIT
 13778*            FIELD(EDAYSI)
 13779*            LENGTH(6)
 13780*        END-EXEC
 13781     MOVE 6
 13782       TO DFHEIV11
 13783*    MOVE '@"L                   #   #00013065' TO DFHEIV0
 13784     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13785     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13786     MOVE X'2020233030303133303635' TO DFHEIV0(25:11)
 13787     CALL 'kxdfhei1' USING DFHEIV0,
 13788           EDAYSI,
 13789           DFHEIV11
 13790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13791         MOVE EDAYSI             TO WS-DY-WORK
 13792         IF WS-DY-SIGN = SPACES
 13793            MOVE WS-DY-NUM       TO WS-EDAYS
 13794            ADD 0                TO WS-EDAYS
 13795         ELSE
 13796            MOVE EDAYSI          TO WS-EDAYS
 13797            ADD 0                TO WS-EDAYS.
 13798
 13799*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13800*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13801     IF EPYAMTL > 0
 13802
 13803* EXEC CICS BIF DEEDIT
 13804*            FIELD(EPYAMTI)
 13805*            LENGTH(10)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 262
* EL156.cbl
 13806*        END-EXEC
 13807     MOVE 10
 13808       TO DFHEIV11
 13809*    MOVE '@"L                   #   #00013080' TO DFHEIV0
 13810     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13811     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13812     MOVE X'2020233030303133303830' TO DFHEIV0(25:11)
 13813     CALL 'kxdfhei1' USING DFHEIV0,
 13814           EPYAMTI,
 13815           DFHEIV11
 13816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13817         MOVE EPYAMTI            TO WS-PY-WORK
 13818         IF WS-PY-SIGN = SPACES
 13819            MOVE WS-PY-NUM       TO WS-EPYAMT
 13820            ADD 0                TO WS-EPYAMT
 13821         ELSE
 13822            MOVE EPYAMTI         TO WS-EPYAMT
 13823            ADD 0                TO WS-EPYAMT.
 13824
 13825     IF ERESVL > 0
 13826
 13827* EXEC CICS BIF DEEDIT
 13828*            FIELD(ERESVI)
 13829*            LENGTH(9)
 13830*        END-EXEC
 13831     MOVE 9
 13832       TO DFHEIV11
 13833*    MOVE '@"L                   #   #00013093' TO DFHEIV0
 13834     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13835     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13836     MOVE X'2020233030303133303933' TO DFHEIV0(25:11)
 13837     CALL 'kxdfhei1' USING DFHEIV0,
 13838           ERESVI,
 13839           DFHEIV11
 13840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13841         MOVE ERESVI TO WS-ERESV.
 13842
 13843     IF EEXPENSL > 0
 13844
 13845* EXEC CICS BIF DEEDIT
 13846*            FIELD(EEXPENSI)
 13847*            LENGTH(8)
 13848*        END-EXEC
 13849     MOVE 8
 13850       TO DFHEIV11
 13851*    MOVE '@"L                   #   #00013100' TO DFHEIV0
 13852     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13853     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13854     MOVE X'2020233030303133313030' TO DFHEIV0(25:11)
 13855     CALL 'kxdfhei1' USING DFHEIV0,
 13856           EEXPENSI,
 13857           DFHEIV11
 13858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13859         MOVE EEXPENSI           TO WS-EEXPENS.
 13860
 13861     IF ETYPEL > ZEROS
 13862         MOVE ETYPEI             TO WS-ETYPE.
 13863
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 263
* EL156.cbl
 13864     IF PI-COMPANY-ID = 'BOA'
 13865        IF PINTL > ZEROS
 13866
 13867* EXEC CICS BIF DEEDIT
 13868*            FIELD (PINTI)
 13869*            LENGTH(05)
 13870*          END-EXEC
 13871     MOVE 05
 13872       TO DFHEIV11
 13873*    MOVE '@"L                   #   #00013111' TO DFHEIV0
 13874     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13875     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13876     MOVE X'2020233030303133313131' TO DFHEIV0(25:11)
 13877     CALL 'kxdfhei1' USING DFHEIV0,
 13878           PINTI,
 13879           DFHEIV11
 13880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13881           IF PINTI NUMERIC
 13882               MOVE AL-UNNON     TO PINTA
 13883               MOVE PINTI        TO WS-INT-RATE
 13884               MOVE WS-INT-RATE  TO PINTO.
 13885
 13886 3000-EXIT.
 13887     EXIT.
 13888
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 264
* EL156.cbl
 13890 3050-REBUILD-ENTERED.
 13891
 13892     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13893
 13894     IF PI-PROV-PMT
 13895         MOVE '9'           TO PMTTYPEO
 13896     ELSE
 13897         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13898
 13899     MOVE PI-PAYEE          TO PAYEEO.
 13900     MOVE PI-PMTNOTE1       TO NOTE1O.
 13901     MOVE PI-PMTNOTE2       TO NOTE2O.
 13902     MOVE PI-OFFLINE        TO OFFLINEO.
 13903     IF PI-PROOF-DATE NOT = ZEROS
 13904         MOVE PI-PROOF-DATE TO PROOFDTO
 13905         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13906     END-IF.
 13907*    MOVE PI-GROUPED        TO GROUPEDO.
 13908
 13909*    MOVE PI-CASH           TO CASHO.
 13910
 13911     IF PI-INT-RATE > ZEROS
 13912        MOVE PI-INT-RATE         TO PINTO
 13913     end-if
 13914     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13915        IF PI-INT-AMT > ZEROS
 13916           MOVE PI-INT-AMT       TO PINTO
 13917           MOVE AL-PANOF         TO PINTA
 13918                                    PINTHA
 13919           if pi-rb-joint-coverage
 13920              move '  INT TO'    to itrb1o
 13921              move ' REM BORR?'  to itrb2o
 13922              move 'Y'           to itrbyno
 13923              move al-uanon      to itrbyna
 13924              move +1            to itrbynl
 13925           end-if
 13926        END-IF
 13927     END-IF
 13928     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13929     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13930     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13931     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13932     IF PI-HOLDTIL NOT = ZEROS
 13933        MOVE PI-HOLDTIL          TO HOLDTILO
 13934        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13935
 13936     IF PI-EPYFROM NOT = ZEROS
 13937        MOVE PI-EPYFROM          TO EPYFROMO
 13938        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13939
 13940     IF PI-AIGFROM NOT = ZEROS
 13941        MOVE PI-AIGFROM          TO AIGFROMO
 13942        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13943
 13944     IF PI-EPYTHRU NOT = ZEROS
 13945        MOVE PI-EPYTHRU          TO EPYTHRUO
 13946        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13947        IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 265
* EL156.cbl
 13948           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13949           MOVE '4'                TO DC-OPTION-CODE
 13950           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13951           IF NO-CONVERSION-ERROR
 13952              MOVE +1 TO DC-ELAPSED-DAYS
 13953              MOVE +0 TO DC-ELAPSED-MONTHS
 13954              MOVE '6' TO DC-OPTION-CODE
 13955              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13956              IF NO-CONVERSION-ERROR
 13957                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13958
 13959     IF PI-EDAYS NOT = ZEROS
 13960        MOVE PI-EDAYS TO EDAYSO.
 13961
 13962     IF PI-EPYAMT NOT = ZEROS
 13963        MOVE PI-EPYAMT TO EPYAMTO.
 13964
 13965     IF PI-ERESV NOT = ZEROS
 13966        MOVE PI-ERESV TO ERESVO.
 13967
 13968     IF PI-EEXPENS NOT = ZEROS
 13969        MOVE PI-EEXPENS TO EEXPENSO.
 13970
 13971     MOVE PI-ETYPE TO ETYPEO.
 13972
 13973     IF PI-ECHECKNO NOT = SPACES
 13974        MOVE PI-ECHECKNO         TO CHECKNOO
 13975     ELSE
 13976        MOVE PI-CCHECKNO         TO CHECKNOO.
 13977
 13978     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13979     MOVE SPACES                 TO DC-OPTION-CODE.
 13980     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13981
 13982     IF DATE-CONVERSION-ERROR
 13983        MOVE SPACES              TO CPYFROMI
 13984     ELSE
 13985        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13986
 13987     IF PI-USES-PAID-TO
 13988        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13989        MOVE +1                  TO DC-ELAPSED-DAYS
 13990        MOVE +0                  TO DC-ELAPSED-MONTHS
 13991        MOVE '6'                 TO DC-OPTION-CODE
 13992        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13993        IF NO-CONVERSION-ERROR
 13994           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13995           GO TO 3051-CONTINUE.
 13996
 13997     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13998     MOVE SPACES                 TO DC-OPTION-CODE.
 13999     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14000
 14001     IF DATE-CONVERSION-ERROR
 14002        MOVE SPACES              TO CPYTHRUI
 14003     ELSE
 14004        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 14005
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 266
* EL156.cbl
 14006 3051-CONTINUE.
 14007
 14008     IF PI-CDAYS NOT = ZEROS
 14009        MOVE PI-CDAYS TO CDAYSO.
 14010
 14011     IF PI-CPYAMT NOT = ZEROS
 14012        MOVE PI-CPYAMT TO CPYAMTO.
 14013
 14014     IF PI-CRESV NOT = ZEROS
 14015        MOVE PI-CRESV TO CRESVO.
 14016
 14017     IF PI-CEXPENS NOT = ZEROS
 14018        MOVE PI-CEXPENS TO CEXPENSO.
 14019
 14020 3059-EXIT.
 14021     EXIT.
 14022
 14023 3100-DEEDIT-DATE.
 14024
 14025* EXEC CICS BIF DEEDIT
 14026*        FIELD(DATE-WORK)
 14027*        LENGTH(8)
 14028*    END-EXEC.
 14029     MOVE 8
 14030       TO DFHEIV11
 14031*    MOVE '@"L                   #   #00013258' TO DFHEIV0
 14032     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14033     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14034     MOVE X'2020233030303133323538' TO DFHEIV0(25:11)
 14035     CALL 'kxdfhei1' USING DFHEIV0,
 14036           DATE-WORK,
 14037           DFHEIV11
 14038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14039
 14040
 14041 3100-EXIT.
 14042     EXIT.
 14043
 14044 3200-CALC-AIG-DAYS.
 14045
 14046     MOVE 'N'                    TO WS-DUE-DAY-SW.
 14047
 14048     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 14049     MOVE ' '                    TO DC-OPTION-CODE.
 14050     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14051     IF NO-CONVERSION-ERROR
 14052         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 14053     ELSE
 14054         GO TO 3290-ERROR.
 14055
 14056     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14057         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14058                                WS-BIN-FROM-DT
 14059     ELSE
 14060         IF CL-TOTAL-PAID-AMT > ZEROS
 14061             IF WS-SV-EPYFROM = LOW-VALUES
 14062                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14063                                        WS-BIN-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 267
* EL156.cbl
 14064             ELSE
 14065                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14066                                        WS-BIN-FROM-DT
 14067         ELSE
 14068             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14069                                        WS-BIN-FROM-DT.
 14070
 14071 3210-CONTINUE.
 14072
 14073     MOVE ' '                    TO DC-OPTION-CODE.
 14074     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14075     IF DATE-CONVERSION-ERROR
 14076         GO TO 3290-ERROR.
 14077
 14078     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 14079
 14080     IF PI-LOAN-DUE-DAY = 31
 14081         MOVE 30              TO WS-PMT-DUE-DA
 14082                                 WS-SAVE-DUE-DA
 14083     ELSE
 14084         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 14085                                 WS-SAVE-DUE-DA.
 14086
 14087     IF (PI-LOAN-DUE-DAY > 28) AND
 14088        (WS-PMT-DUE-MO = 2)
 14089         MOVE 'Y'                TO WS-DUE-DAY-SW
 14090         MOVE 28                 TO WS-PMT-DUE-DA.
 14091
 14092     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 14093     MOVE '4'                    TO DC-OPTION-CODE.
 14094     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14095     IF NO-CONVERSION-ERROR
 14096         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 14097     ELSE
 14098         GO TO 3290-ERROR.
 14099
 14100*--------------------------------------------------------------*
 14101*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 14102*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 14103*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 14104*                                                              *
 14105*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 14106*             INCURRED DATE      - 04/15/91                    *
 14107*             PMT DUE DATE       - 04/03/91                    *
 14108*             PMT DUE DATE       - 05/03/91                    *
 14109*--------------------------------------------------------------*
 14110
 14111     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14112        (WS-SV-AIGFROM = LOW-VALUES)
 14113         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 14114            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 14115             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14116             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14117             IF NO-CONVERSION-ERROR
 14118                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14119                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14120             ELSE
 14121                 GO TO 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 268
* EL156.cbl
 14122
 14123     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 14124        (WS-SV-AIGFROM = LOW-VALUES)
 14125         GO TO 3205-CONT-CALC-PMT.
 14126
 14127     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 14128     MOVE ' '                    TO DC-OPTION-CODE.
 14129     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14130     IF NO-CONVERSION-ERROR
 14131         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 14132     ELSE
 14133         GO TO 3290-ERROR.
 14134
 14135     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 14136        (WS-PMT-DUE-DA < WS-FROM-DA)
 14137          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 14138          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 14139          IF NO-CONVERSION-ERROR
 14140              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14141              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14142          ELSE
 14143              GO TO 3290-ERROR.
 14144
 14145 3205-CONT-CALC-PMT.
 14146
 14147*--------------------------------------------------------------*
 14148*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 14149*    BETWEEN THE PAY FROM / THRU DATES.                        *
 14150*--------------------------------------------------------------*
 14151
 14152     IF CL-TOTAL-PAID-AMT = ZEROS AND
 14153        PI-PMTTYPE = '2'
 14154          NEXT SENTENCE
 14155     ELSE
 14156        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 14157           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 14158             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 14159             MOVE ER-3527            TO EMI-ERROR
 14160             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14161             MOVE -1                 TO EPYTHRUL
 14162             MOVE AL-UNBON           TO EPYTHRUA
 14163                                        EPYFROMA
 14164             GO TO 3299-EXIT.
 14165
 14166*--------------------------------------------------------------*
 14167*    CALCULATE RETRO ELIMINATION DATE                          *
 14168*--------------------------------------------------------------*
 14169
 14170     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14171         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14172     ELSE
 14173         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 14174
 14175     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 14176     MOVE +0             TO DC-ELAPSED-MONTHS.
 14177     MOVE '6'            TO DC-OPTION-CODE.
 14178     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14179     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 269
* EL156.cbl
 14180         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 14181     ELSE
 14182         GO TO 3290-ERROR.
 14183
 14184 3210-CHECK-PMT-DATE.
 14185
 14186*--------------------------------------------------------------*
 14187*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 14188*    THE ENTERED PAY FROM DATE                                 *
 14189*--------------------------------------------------------------*
 14190
 14191     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 14192         NEXT SENTENCE
 14193     ELSE
 14194         GO TO 3220-COMPUTE-DAYS.
 14195
 14196     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 14197     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14198     IF NO-CONVERSION-ERROR
 14199         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 14200         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14201         GO TO 3210-CHECK-PMT-DATE
 14202     ELSE
 14203         GO TO 3290-ERROR.
 14204
 14205 3220-COMPUTE-DAYS.
 14206
 14207     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 14208     MOVE ZEROS         TO WS-CDAYS.
 14209     MOVE 'N'           TO WS-ELIMINATION-SW.
 14210
 14211*--------------------------------------------------------------*
 14212*    COMPUTE CALIFORNIA DUE DAYS                               *
 14213*--------------------------------------------------------------*
 14214
 14215     IF CL-TOTAL-PAID-AMT > ZEROS
 14216         MOVE 'Y' TO WS-ELIMINATION-SW
 14217         GO TO 3240-FIRST-PMT-DUE
 14218     ELSE
 14219        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 14220            NEXT SENTENCE
 14221        ELSE
 14222            GO TO 3240-FIRST-PMT-DUE.
 14223
 14224 3230-NEXT-PMT-DUE.
 14225
 14226     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 14227     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 14228     IF NO-CONVERSION-ERROR
 14229         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 14230         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14231     ELSE
 14232         GO TO 3290-ERROR.
 14233
 14234 3240-FIRST-PMT-DUE.
 14235
 14236     IF CL-TOTAL-PAID-AMT > ZEROS
 14237         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 270
* EL156.cbl
 14238     ELSE
 14239        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14240            GO TO 3230-NEXT-PMT-DUE.
 14241
 14242     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14243         GO TO 3250-VERIFY-ELIMINATION.
 14244
 14245     ADD +30 TO WS-CDAYS.
 14246     MOVE 'Y' TO WS-ELIMINATION-SW.
 14247     GO TO 3230-NEXT-PMT-DUE.
 14248
 14249 3250-VERIFY-ELIMINATION.
 14250
 14251     IF ELIM-SATISFIED
 14252         GO TO 3260-END-CALC.
 14253
 14254     IF PI-PMTTYPE = '1'
 14255         MOVE ZEROS TO WS-CDAYS
 14256         GO TO 3260-END-CALC.
 14257
 14258     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14259         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14260     ELSE
 14261         IF CL-TOTAL-PAID-AMT > ZEROS
 14262             IF WS-SV-EPYFROM = LOW-VALUES
 14263                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14264             ELSE
 14265                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14266         ELSE
 14267             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14268
 14269     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14270     MOVE '1'                    TO DC-OPTION-CODE.
 14271     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14272     IF NO-CONVERSION-ERROR
 14273         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14274     ELSE
 14275         GO TO 3290-ERROR.
 14276
 14277     IF CL-TOTAL-PAID-AMT > ZEROS
 14278         MOVE WS-DAYS-OFF TO WS-CDAYS
 14279     ELSE
 14280         IF PI-BEN-DAYS > WS-DAYS-OFF
 14281             MOVE ZEROS TO WS-CDAYS
 14282         ELSE
 14283             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14284
 14285 3260-END-CALC.
 14286
 14287     MOVE WS-CDAYS TO PI-CDAYS.
 14288
 14289     IF PI-EDAYS = ZEROS
 14290         MOVE PI-CDAYS TO PI-EDAYS
 14291         MOVE AL-UNNON TO EDAYSA.
 14292
 14293     GO TO 3299-EXIT.
 14294
 14295 3290-ERROR.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 271
* EL156.cbl
 14296
 14297     MOVE ER-3528            TO EMI-ERROR.
 14298     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14299     MOVE -1                 TO CDAYSL.
 14300     MOVE AL-UNBON           TO CDAYSA.
 14301
 14302 3299-EXIT.
 14303     EXIT.
 14304
 14305 3300-BUMP-DATE.
 14306
 14307     IF WS-RESTORE-DUE-DAY
 14308         MOVE 'N'              TO WS-DUE-DAY-SW
 14309         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14310         ADD 1                 TO WS-PMT-DUE-MO
 14311         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14312         MOVE '4'              TO DC-OPTION-CODE
 14313         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14314         IF NO-CONVERSION-ERROR
 14315             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14316             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14317             GO TO 3399-EXIT
 14318         ELSE
 14319             MOVE '9'          TO DC-ERROR-CODE
 14320             GO TO 3399-EXIT.
 14321
 14322     IF (WS-PMT-DUE-MO = 1) AND
 14323        (WS-SAVE-DUE-DA > 28)
 14324           MOVE 'Y' TO WS-DUE-DAY-SW.
 14325
 14326     MOVE +0                 TO DC-ELAPSED-DAYS.
 14327     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14328     MOVE '6'                TO DC-OPTION-CODE.
 14329     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14330
 14331 3399-EXIT.
 14332     EXIT.
 14333
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 272
* EL156.cbl
 14335 3400-COMPUTE-EXPIRY.
 14336
 14337     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14338     MOVE +0                    TO DC-ELAPSED-DAYS
 14339                                   DC-ODD-DAYS-OVER.
 14340     MOVE '1'                   TO DC-END-OF-MONTH.
 14341     MOVE '6'                   TO DC-OPTION-CODE.
 14342
 14343     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14344         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14345     ELSE
 14346         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14347
 14348     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14349     IF NO-CONVERSION-ERROR
 14350         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14351     ELSE
 14352         GO TO 3390-CONTINUE.
 14353
 14354     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14355         GO TO 3390-CONTINUE.
 14356
 14357     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14358     MOVE '4'                    TO CNTL-REC-TYPE.
 14359     MOVE +0                     TO CNTL-SEQ-NO.
 14360     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14361     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14362     MOVE 'BENE'                 TO FILE-SWITCH.
 14363
 14364     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14365
 14366     IF NO-BENEFIT-FOUND
 14367         GO TO 3390-CONTINUE.
 14368
 14369     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 14370        IF (PI-OFFLINE = 'Y') OR
 14371           (PI-PMTTYPE = '7')
 14372           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14373                                     THRU 9870-EXIT
 14374           IF ERROR-ON-OUTPUT
 14375             MOVE -1                 TO ENTERPFL
 14376             MOVE AL-UANON           TO ENTERPFA
 14377             MOVE MAP-NAMEA          TO MAP-NAME
 14378             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14379             GO TO 8200-SEND-DATAONLY.
 14380
 14381     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14382        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14383        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14384          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14385          MOVE +0        TO DC-ELAPSED-DAYS
 14386          MOVE +1        TO DC-ELAPSED-MONTHS
 14387          MOVE 6         TO DC-OPTION-CODE
 14388          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14389          IF NO-CONVERSION-ERROR
 14390              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14391
 14392 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 273
* EL156.cbl
 14393
 14394      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14395         MOVE CM-AH-LOAN-EXPIRE-DT
 14396                                 TO DC-BIN-DATE-1
 14397      ELSE
 14398         MOVE CM-LF-LOAN-EXPIRE-DT
 14399                                 TO DC-BIN-DATE-1
 14400      END-IF
 14401
 14402      MOVE ' '                    TO DC-OPTION-CODE.
 14403      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14404      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14405      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14406
 14407 3499-EXIT.
 14408     EXIT.
 14409
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 274
* EL156.cbl
 14411
 14412 3600-CHECK-VERIFICATION.
 14413
 14414     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14415
 14416     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14417
 14418     IF PI-PAYEE-TYPE = 'I'
 14419        GO TO 3600-READ-TRAILER.
 14420
 14421     IF PI-PAYEE-TYPE = 'B'
 14422        ADD +10                  TO TRLR-SEQ-NO
 14423        GO TO 3600-READ-TRAILER.
 14424
 14425     IF PI-PAYEE-TYPE = 'A'
 14426        ADD +20                  TO TRLR-SEQ-NO
 14427        GO TO 3600-READ-TRAILER.
 14428
 14429     IF PI-PAYEE-TYPE = 'O'
 14430        ADD +50                  TO TRLR-SEQ-NO
 14431        GO TO 3600-READ-TRAILER.
 14432
 14433     IF PI-PAYEE-TYPE = 'Q'
 14434        ADD +60                  TO TRLR-SEQ-NO
 14435        GO TO 3600-READ-TRAILER.
 14436
 14437     IF PI-PAYEE-TYPE = 'P'
 14438        ADD +30                  TO TRLR-SEQ-NO
 14439        GO TO 3600-READ-TRAILER.
 14440
 14441     IF PI-PAYEE-TYPE = 'E'
 14442        ADD +40                  TO TRLR-SEQ-NO.
 14443
 14444 3600-READ-TRAILER.
 14445
 14446
 14447* EXEC CICS HANDLE CONDITION
 14448*         NOTFND(3600-CONTINUE)
 14449*    END-EXEC.
 14450*    MOVE '"$I                   ! - #00013668' TO DFHEIV0
 14451     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14453     MOVE X'2D20233030303133363638' TO DFHEIV0(25:11)
 14454     CALL 'kxdfhei1' USING DFHEIV0
 14455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14456
 14457
 14458     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14459
 14460 3600-CONTINUE.
 14461
 14462     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14463         GO TO 3600-AH-VERIFY
 14464     END-IF.
 14465
 14466     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14467       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14468         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 275
* EL156.cbl
 14469           MOVE ER-7576            TO EMI-ERROR
 14470           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14471           MOVE -1                 TO PAYEEL
 14472           MOVE AL-UABON           TO PAYEEA
 14473           GO TO 3600-EXIT
 14474         END-IF
 14475       END-IF
 14476     END-IF.
 14477
 14478     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14479     MOVE 1 TO WS-SUB2
 14480     MOVE SPACES TO WS-PAYEE-NAME
 14481     PERFORM VARYING WS-SUB FROM 1 BY 1
 14482             UNTIL WS-SUB > 30
 14483         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14484            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14485                 WS-PAYEE-NAME-X (WS-SUB2)
 14486            ADD +1 TO WS-SUB2
 14487         END-IF
 14488     END-PERFORM.
 14489
 14490     STRING CL-INSURED-1ST-NAME
 14491            CL-INSURED-MID-INIT
 14492            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14493     MOVE 1 TO WS-SUB2
 14494     MOVE SPACES TO WS-INSURED-NAME
 14495     PERFORM VARYING WS-SUB FROM 1 BY 1
 14496             UNTIL WS-SUB > 30
 14497         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14498            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14499                 WS-INSURED-NAME-X (WS-SUB2)
 14500            ADD +1 TO WS-SUB2
 14501         END-IF
 14502     END-PERFORM.
 14503
 14504     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14505        MOVE ER-7579            TO EMI-ERROR
 14506        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14507        MOVE -1                 TO PAYEEL
 14508        MOVE AL-UABON           TO PAYEEA
 14509     END-IF.
 14510
 14511     IF PI-PMTTYPE = '4'  AND
 14512        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14513        PI-PAYEE-TYPE <> 'I'
 14514          MOVE ER-7580          TO EMI-ERROR
 14515          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14516          MOVE -1               TO PAYEEL
 14517          MOVE AL-UABON         TO PAYEEA
 14518     END-IF.
 14519
 14520     GO TO 3600-EXIT.
 14521
 14522 3600-AH-VERIFY.
 14523
 14524     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14525        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14526           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 276
* EL156.cbl
 14527           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14528           MOVE -1                 TO PAYEEL
 14529           MOVE AL-UABON           TO PAYEEA
 14530        END-IF
 14531     END-IF.
 14532
 14533
 14534 3600-EXIT.
 14535     EXIT.
 14536
 14537 5000-UPDATE.
 14538
 14539     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14540
 14541     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14542
 14543     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14544        PI-OFFLINE = 'Y'
 14545        NEXT SENTENCE
 14546     ELSE
 14547        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14548
 14549*    IF PI-COMPANY-ID = 'CRI'
 14550*       IF PI-PMTTYPE = '1' OR  '2'
 14551*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14552*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14553*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14554
 14555*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14556*       IF PI-PMTTYPE = '1'
 14557*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14558*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14559
 14560     IF PI-PMTTYPE      = '2' AND
 14561        PI-SPLIT-PMT-SW = 'Y' AND
 14562        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14563          MOVE ER-3530                TO EMI-ERROR
 14564          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14565
 14566     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14567        AND (CL-CLAIM-TYPE = 'L')
 14568        IF PI-PMTTYPE = '2' OR '4'
 14569           IF PI-INT-AMT NOT = ZEROS
 14570              PERFORM 7110-BUILD-PMT-TRLR
 14571                                 THRU 7130-EXIT
 14572           ELSE
 14573              IF PI-PMTTYPE = '2'
 14574                 PERFORM 7140-BUILD-NOTE-TRLR
 14575                                 THRU 7170-EXIT
 14576              END-IF
 14577           END-IF
 14578        END-IF
 14579     END-IF
 14580*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14581*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14582*            MOVE 'N'                 TO  WS-LETTER-SW.
 14583
 14584*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 277
* EL156.cbl
 14585*        IF CL-NO-OF-PMTS-MADE = +1
 14586*                OR
 14587*           PI-PMTTYPE = '2'
 14588*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14589
 14590     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14591
 14592*    IF PI-COMPANY-ID = 'DMD'
 14593*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14594*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14595
 14596
 14597* EXEC CICS REWRITE
 14598*         DATASET('ELMSTR')
 14599*         FROM(CLAIM-MASTER)
 14600*     END-EXEC.
 14601     MOVE LENGTH OF
 14602      CLAIM-MASTER
 14603       TO DFHEIV11
 14604     MOVE 'ELMSTR' TO DFHEIV1
 14605*    MOVE '&& L                  %   #00013810' TO DFHEIV0
 14606     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14607     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14608     MOVE X'2020233030303133383130' TO DFHEIV0(25:11)
 14609     CALL 'kxdfhei1' USING DFHEIV0,
 14610           DFHEIV1,
 14611           CLAIM-MASTER,
 14612           DFHEIV11,
 14613           DFHEIV99
 14614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14615
 14616
 14617     IF WS-LETTER-SW = 'N'
 14618         GO TO 5000-END-UPDATE.
 14619
 14620 5000-GENERATE-AUTO-LETTER.
 14621
 14622
 14623* EXEC CICS LINK
 14624*        PROGRAM    (LINK-1523)
 14625*        COMMAREA   (W-1523-LINKDATA)
 14626*        LENGTH     (W-1523-COMM-LENGTH)
 14627*    END-EXEC.
 14628*    MOVE '."C                   (   #00013820' TO DFHEIV0
 14629     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14630     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14631     MOVE X'2020233030303133383230' TO DFHEIV0(25:11)
 14632     CALL 'kxdfhei1' USING DFHEIV0,
 14633           LINK-1523,
 14634           W-1523-LINKDATA,
 14635           W-1523-COMM-LENGTH,
 14636           DFHEIV99,
 14637           DFHEIV99,
 14638           DFHEIV99,
 14639           DFHEIV99
 14640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14641
 14642
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 278
* EL156.cbl
 14643     IF W-1523-FATAL-ERROR
 14644         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14645         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14646         MOVE ER-0802                TO  EMI-ERROR
 14647         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14648
 14649     IF W-1523-ERROR-CODE = 0191
 14650         MOVE ER-0803                TO  EMI-ERROR
 14651         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14652
 14653     IF PI-COMPANY-ID      = 'HAN' AND
 14654        PI-PMTTYPE         = '1'   AND
 14655        PI-3RD-PARTY-SW    = 'Y'   AND
 14656        W-1523-FORM-NUMBER = 'EOB1'
 14657           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14658           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14659           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14660           GO TO 5000-GENERATE-AUTO-LETTER.
 14661
 14662 5000-END-UPDATE.
 14663
 14664     MOVE ER-0000                TO EMI-ERROR.
 14665     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14666     GO TO 7000-SHOW-CLAIM.
 14667
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 279
* EL156.cbl
 14669 5000-MOVE-NAME.
 14670     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14671     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14672     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14673
 14674 5000-EXIT.
 14675     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 280
* EL156.cbl
 14677 5300-CREATE-DMO.
 14678
 14679     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14680     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14681     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14682
 14683
 14684* EXEC CICS HANDLE CONDITION
 14685*         NOTFND   (5300-NOTE-NOT-FOUND)
 14686*    END-EXEC.
 14687*    MOVE '"$I                   ! . #00013866' TO DFHEIV0
 14688     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14689     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14690     MOVE X'2E20233030303133383636' TO DFHEIV0(25:11)
 14691     CALL 'kxdfhei1' USING DFHEIV0
 14692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14693
 14694
 14695
 14696* EXEC CICS READ
 14697*         DATASET('ERNOTE')
 14698*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14699*         RIDFLD (W-NOTE-KEY)
 14700*    END-EXEC.
 14701     MOVE 'ERNOTE' TO DFHEIV1
 14702*    MOVE '&"S        E          (   #00013870' TO DFHEIV0
 14703     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14704     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14705     MOVE X'2020233030303133383730' TO DFHEIV0(25:11)
 14706     CALL 'kxdfhei1' USING DFHEIV0,
 14707           DFHEIV1,
 14708           DFHEIV20,
 14709           DFHEIV99,
 14710           W-NOTE-KEY,
 14711           DFHEIV99,
 14712           DFHEIV99,
 14713           DFHEIV99
 14714     SET ADDRESS OF CERTIFICATE-NOTE TO
 14715         DFHEIV20
 14716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14717
 14718
 14719     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14720     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14721     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14722
 14723     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14724         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14725     ELSE
 14726         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14727
 14728     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14729     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14730     MOVE 'DLO006'               TO PGM-NAME.
 14731
 14732
 14733* EXEC CICS LINK
 14734*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 281
* EL156.cbl
 14735*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14736*        LENGTH     (DCT-RCRD-LENGTH)
 14737*    END-EXEC.
 14738*    MOVE '."C                   (   #00013889' TO DFHEIV0
 14739     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14740     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14741     MOVE X'2020233030303133383839' TO DFHEIV0(25:11)
 14742     CALL 'kxdfhei1' USING DFHEIV0,
 14743           PGM-NAME,
 14744           DCT-COMMUNICATION-AREA,
 14745           DCT-RCRD-LENGTH,
 14746           DFHEIV99,
 14747           DFHEIV99,
 14748           DFHEIV99,
 14749           DFHEIV99
 14750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14751
 14752
 14753     IF DCT-RETURN-CODE = 'OK'
 14754         GO TO 5300-CONT.
 14755
 14756     IF DCT-RETURN-CODE = '01' OR '02'
 14757         GO TO 5300-EXIT.
 14758
 14759     IF DCT-RETURN-CODE = '03'
 14760         MOVE ER-0951            TO EMI-ERROR
 14761         GO TO 5300-BAD-EXIT.
 14762
 14763     IF DCT-RETURN-CODE = '04'
 14764         MOVE ER-0946            TO EMI-ERROR
 14765         GO TO 5300-BAD-EXIT.
 14766
 14767     IF DCT-RETURN-CODE = '05'
 14768         MOVE ER-0947            TO EMI-ERROR
 14769         GO TO 5300-BAD-EXIT.
 14770
 14771     IF DCT-RETURN-CODE = '06'
 14772         MOVE ER-0921            TO EMI-ERROR
 14773         GO TO 5300-BAD-EXIT.
 14774
 14775     IF DCT-RETURN-CODE = '07'
 14776         MOVE ER-0849            TO EMI-ERROR
 14777         GO TO 5300-BAD-EXIT.
 14778
 14779     IF DCT-RETURN-CODE = '08'
 14780         MOVE ER-0948            TO EMI-ERROR
 14781         GO TO 5300-BAD-EXIT.
 14782
 14783     IF DCT-RETURN-CODE = 'N1'
 14784         MOVE ER-0950            TO EMI-ERROR
 14785         GO TO 5300-BAD-EXIT.
 14786
 14787     IF DCT-RETURN-CODE = 'E1'
 14788         MOVE ER-0974            TO EMI-ERROR
 14789         GO TO 5300-BAD-EXIT.
 14790
 14791     IF DCT-RETURN-CODE = 'E2'
 14792         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 282
* EL156.cbl
 14793         GO TO 5300-BAD-EXIT.
 14794
 14795     IF DCT-RETURN-CODE NOT = 'OK'
 14796         MOVE ER-0949            TO EMI-ERROR
 14797         GO TO 5300-BAD-EXIT.
 14798
 14799 5300-CONT.
 14800
 14801     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14802     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14803     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14804     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14805     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14806     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14807     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14808     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14809
 14810     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14811     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14812     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14813     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14814     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14815
 14816     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14817
 14818     IF PI-PMTTYPE = '2'
 14819         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14820         MOVE '4'                TO DM-CLAIM-STATUS
 14821     ELSE
 14822         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14823         MOVE '2'                TO DM-CLAIM-STATUS.
 14824
 14825     MOVE 'DLO025'               TO PGM-NAME.
 14826
 14827
 14828* EXEC CICS LINK
 14829*        PROGRAM    (PGM-NAME)
 14830*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14831*        LENGTH     (DM-DMO-LENGTH)
 14832*    END-EXEC.
 14833*    MOVE '."C                   (   #00013969' TO DFHEIV0
 14834     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14835     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14836     MOVE X'2020233030303133393639' TO DFHEIV0(25:11)
 14837     CALL 'kxdfhei1' USING DFHEIV0,
 14838           PGM-NAME,
 14839           DMO-COMMUNICATION-AREA,
 14840           DM-DMO-LENGTH,
 14841           DFHEIV99,
 14842           DFHEIV99,
 14843           DFHEIV99,
 14844           DFHEIV99
 14845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14846
 14847
 14848     IF DM-RETURN-CODE = 'OK'
 14849         GO TO 5300-EXIT.
 14850
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 283
* EL156.cbl
 14851     IF DM-RETURN-CODE = '01'
 14852         MOVE ER-8051            TO EMI-ERROR
 14853         GO TO 5300-BAD-EXIT.
 14854
 14855     IF DM-RETURN-CODE = '02'
 14856         MOVE ER-8052            TO EMI-ERROR
 14857         GO TO 5300-BAD-EXIT.
 14858
 14859     IF DM-RETURN-CODE = '03'
 14860         MOVE ER-8053            TO EMI-ERROR
 14861         GO TO 5300-BAD-EXIT.
 14862
 14863     IF DM-RETURN-CODE = '04'
 14864         MOVE ER-8054            TO EMI-ERROR
 14865         GO TO 5300-BAD-EXIT.
 14866
 14867     IF DM-RETURN-CODE = '05'
 14868         MOVE ER-8055            TO EMI-ERROR
 14869         GO TO 5300-BAD-EXIT.
 14870
 14871     IF DM-RETURN-CODE = '06'
 14872         MOVE ER-8056            TO EMI-ERROR
 14873         GO TO 5300-BAD-EXIT.
 14874
 14875     IF DM-RETURN-CODE = '07'
 14876         MOVE ER-8057            TO EMI-ERROR
 14877         GO TO 5300-BAD-EXIT.
 14878
 14879     IF DM-RETURN-CODE = '08'
 14880         MOVE ER-8058            TO EMI-ERROR
 14881         GO TO 5300-BAD-EXIT.
 14882
 14883     IF DM-RETURN-CODE = '09'
 14884         MOVE ER-8059            TO EMI-ERROR
 14885         GO TO 5300-BAD-EXIT.
 14886
 14887     IF DM-RETURN-CODE = '10'
 14888         MOVE ER-8060            TO EMI-ERROR
 14889         GO TO 5300-BAD-EXIT.
 14890
 14891     IF DM-RETURN-CODE = '11'
 14892         MOVE ER-8061            TO EMI-ERROR
 14893         GO TO 5300-BAD-EXIT.
 14894
 14895     IF DM-RETURN-CODE = '12'
 14896         MOVE ER-8062            TO EMI-ERROR
 14897         GO TO 5300-BAD-EXIT.
 14898
 14899     IF DM-RETURN-CODE = '13'
 14900         MOVE ER-8063            TO EMI-ERROR
 14901         GO TO 5300-BAD-EXIT.
 14902
 14903     IF DM-RETURN-CODE = '14'
 14904         MOVE ER-8064            TO EMI-ERROR
 14905         GO TO 5300-BAD-EXIT.
 14906
 14907     IF DM-RETURN-CODE = '15'
 14908         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 284
* EL156.cbl
 14909         GO TO 5300-BAD-EXIT.
 14910
 14911     IF DM-RETURN-CODE = '16'
 14912         MOVE ER-8154            TO EMI-ERROR
 14913         GO TO 5300-BAD-EXIT.
 14914
 14915     IF DM-RETURN-CODE = '17'
 14916         MOVE ER-8155            TO EMI-ERROR
 14917         GO TO 5300-BAD-EXIT.
 14918
 14919     IF DM-RETURN-CODE = 'N1'
 14920         MOVE ER-8152            TO EMI-ERROR
 14921         GO TO 5300-BAD-EXIT.
 14922
 14923     IF DM-RETURN-CODE = 'E1'
 14924         MOVE ER-8153            TO EMI-ERROR
 14925         GO TO 5300-BAD-EXIT.
 14926
 14927     MOVE ER-8066            TO EMI-ERROR.
 14928     GO TO 5300-BAD-EXIT.
 14929
 14930 5300-NOTE-NOT-FOUND.
 14931
 14932     MOVE ER-0954                TO EMI-ERROR.
 14933     GO TO 5300-BAD-EXIT.
 14934
 14935 5300-BAD-EXIT.
 14936
 14937* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14938*    MOVE '6"R                   !   #00014063' TO DFHEIV0
 14939     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14940     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14941     MOVE X'2020233030303134303633' TO DFHEIV0(25:11)
 14942     CALL 'kxdfhei1' USING DFHEIV0
 14943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14944
 14945     IF MAP-NAME = 'EL156A'
 14946         MOVE -1             TO ENTERPFL
 14947       ELSE
 14948         MOVE LOW-VALUES     TO EL156BI
 14949         MOVE -1             TO ENTPFBL.
 14950
 14951     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14952     GO TO 8200-SEND-DATAONLY.
 14953
 14954 5300-EXIT.
 14955     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 285
* EL156.cbl
 14957 5350-FORMAT-LAST-NAME-1ST.
 14958*****************************************************************
 14959*             M O V E   N A M E   R O U T I N E                 *
 14960*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14961*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14962*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14963*                  FIELD                   VALUE                *
 14964*           W-NAME-LAST    (CL15)      SMITH                    *
 14965*           W-NAME-FIRST   (CL15)      JOHN                     *
 14966*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14967*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14968*     CONTAIN                                                   *
 14969*                SMITH, JOHN ALLEN                              *
 14970*     OR                                                        *
 14971*                SMITH, JOHN A.                                 *
 14972*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14973*     COPYBOOK, ELCNWA.                                         *
 14974*****************************************************************.
 14975
 14976     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14977     MOVE ZERO                   TO  WS-NAME-SW.
 14978     SET NWA-INDEX               TO +1.
 14979
 14980     IF W-NAME-LAST   = SPACES AND
 14981        W-NAME-MIDDLE = SPACES
 14982         MOVE +1                 TO WS-NAME-SW.
 14983
 14984     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14985     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14986
 14987     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14988     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14989
 14990     SET NWA-INDEX UP BY +1.
 14991
 14992     IF W-NAME-MIDDLE NOT = SPACES
 14993         IF W-NAME-MIDDLE-2 = SPACES
 14994             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14995             SET NWA-INDEX UP BY +1
 14996             MOVE '.'            TO WS-NW (NWA-INDEX)
 14997             SET NWA-INDEX UP BY +2
 14998         ELSE
 14999             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15000             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 15001
 15002 5350-EXIT.
 15003     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 286
* EL156.cbl
 15005 5360-MOVE-NAME.
 15006
 15007     IF WS-NAME-SW > +1
 15008         GO TO 5360-EXIT.
 15009
 15010     IF WS-NAME-WORK2 = SPACES
 15011         GO TO 5360-EXIT.
 15012
 15013     SET NWA-INDEX2            TO +1.
 15014     SET NWA-INDEX3            TO +2.
 15015
 15016 5360-MOVE-NAME-CYCLE.
 15017
 15018     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 15019
 15020     IF NWA-INDEX < +30
 15021         SET NWA-INDEX UP BY +1
 15022     ELSE
 15023         ADD +2                TO  WS-NAME-SW
 15024         GO TO 5360-EXIT.
 15025
 15026     IF NWA-INDEX2 < +20
 15027         SET NWA-INDEX3 UP BY +1
 15028         SET NWA-INDEX2 UP BY +1.
 15029
 15030     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 15031        WS-NW2 (NWA-INDEX3) = SPACES
 15032         IF WS-NAME-SW = ZERO
 15033             MOVE ','            TO  WS-NW (NWA-INDEX)
 15034             SET NWA-INDEX UP BY +2
 15035             MOVE +1             TO  WS-NAME-SW
 15036             GO TO 5360-EXIT
 15037         ELSE
 15038             GO TO 5360-EXIT.
 15039
 15040     GO TO 5360-MOVE-NAME-CYCLE.
 15041
 15042 5360-EXIT.
 15043     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 287
* EL156.cbl
 15045 6000-BUILD-SCREEN-B.
 15046     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 15047     MOVE PI-CARRIER             TO MSTR-CARRIER.
 15048     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 15049     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 15050
 15051     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 15052
 15053 6050-BUILD-SCREEN.
 15054     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 15055     MOVE LOW-VALUES             TO EL156BI.
 15056     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 15057
 15058     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 15059
 15060     IF PI-PAYEE-TYPE = 'I'
 15061        GO TO 6060-READ-TRAILER.
 15062
 15063     IF PI-PAYEE-TYPE = 'B'
 15064        ADD +10                  TO TRLR-SEQ-NO
 15065        GO TO 6060-READ-TRAILER.
 15066
 15067     IF PI-PAYEE-TYPE = 'A'
 15068        ADD +20                  TO TRLR-SEQ-NO
 15069        GO TO 6060-READ-TRAILER.
 15070
 15071     IF PI-PAYEE-TYPE = 'O'
 15072        ADD +50                  TO TRLR-SEQ-NO
 15073        GO TO 6060-READ-TRAILER.
 15074
 15075     IF PI-PAYEE-TYPE = 'Q'
 15076        ADD +60                  TO TRLR-SEQ-NO
 15077        GO TO 6060-READ-TRAILER.
 15078
 15079     IF PI-PAYEE-TYPE = 'P'
 15080        ADD +30                  TO TRLR-SEQ-NO
 15081        GO TO 6060-READ-TRAILER.
 15082
 15083     IF PI-PAYEE-TYPE = 'E'
 15084        ADD +40                  TO TRLR-SEQ-NO.
 15085
 15086 6060-READ-TRAILER.
 15087
 15088     IF PI-PAYEE-TYPE    = 'A' AND
 15089        PI-PAYEE-SEQ-NUM = 0
 15090          GO TO 6061-READ-ACCOUNT.
 15091
 15092     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 15093        (PI-PAYEE-TYPE    = 'B')             AND
 15094        (PI-PAYEE-SEQ-NUM = 9)
 15095          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15096          IF BENE-FOUND-SW = 'N'
 15097            GO TO 6065-NOT-FOUND
 15098          ELSE
 15099            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15100            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15101            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15102*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 288
* EL156.cbl
 15103            STRING BE-CITY ' ' BE-STATE
 15104               DELIMITED BY '  ' INTO CITYSTBO
 15105            END-STRING
 15106            MOVE BE-ZIP-CODE       TO ZIPBO
 15107            GO TO 6061-READ-ACCOUNT.
 15108
 15109     IF PI-PAYEE-TYPE    = 'B' AND
 15110        PI-PAYEE-SEQ-NUM = 0
 15111          PERFORM 7920-READ-BENE THRU 7920-EXIT
 15112          IF BENE-FOUND-SW = 'N'
 15113            GO TO 6065-NOT-FOUND
 15114          ELSE
 15115            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 15116            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 15117            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 15118*           MOVE BE-CITY-STATE     TO CITYSTBO
 15119            STRING BE-CITY ' ' BE-STATE
 15120               DELIMITED BY '  ' INTO CITYSTBO
 15121            END-STRING
 15122            MOVE BE-ZIP-CODE       TO ZIPBO
 15123            if be-ach-yes-or-no = 'Y'
 15124               move 'Y'          to pi-ach-payment
 15125            else
 15126               move 'N'          to pi-ach-payment
 15127            end-if
 15128            GO TO 6061-READ-ACCOUNT.
 15129
 15130
 15131* EXEC CICS HANDLE CONDITION
 15132*         NOTFND(6065-NOT-FOUND)
 15133*     END-EXEC.
 15134*    MOVE '"$I                   ! / #00014249' TO DFHEIV0
 15135     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15136     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15137     MOVE X'2F20233030303134323439' TO DFHEIV0(25:11)
 15138     CALL 'kxdfhei1' USING DFHEIV0
 15139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15140
 15141
 15142     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15143
 15144     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 15145     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 15146     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 15147     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 15148*    MOVE AT-CITY-STATE          TO CITYSTBO.
 15149     STRING AT-CITY ' ' AT-STATE
 15150        DELIMITED BY '  ' INTO CITYSTBO
 15151     END-STRING
 15152     MOVE AT-ZIP-CODE            TO ZIPBO.
 15153
 15154 6061-READ-ACCOUNT.
 15155
 15156* EXEC CICS HANDLE CONDITION
 15157*         NOTFND(6068-ACCT-NOT-FND)
 15158*     END-EXEC.
 15159*    MOVE '"$I                   ! 0 #00014266' TO DFHEIV0
 15160     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 289
* EL156.cbl
 15161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15162     MOVE X'3020233030303134323636' TO DFHEIV0(25:11)
 15163     CALL 'kxdfhei1' USING DFHEIV0
 15164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15165
 15166
 15167
 15168* EXEC CICS READ
 15169*         DATASET('ERACCT')
 15170*         SET    (ADDRESS OF ACCOUNT-MASTER)
 15171*         RIDFLD (PI-ACCT-KEY)
 15172*     END-EXEC.
 15173     MOVE 'ERACCT' TO DFHEIV1
 15174*    MOVE '&"S        E          (   #00014270' TO DFHEIV0
 15175     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15176     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15177     MOVE X'2020233030303134323730' TO DFHEIV0(25:11)
 15178     CALL 'kxdfhei1' USING DFHEIV0,
 15179           DFHEIV1,
 15180           DFHEIV20,
 15181           DFHEIV99,
 15182           PI-ACCT-KEY,
 15183           DFHEIV99,
 15184           DFHEIV99,
 15185           DFHEIV99
 15186     SET ADDRESS OF ACCOUNT-MASTER TO
 15187         DFHEIV20
 15188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15189
 15190
 15191     MOVE AM-CARRIER             TO ACARRBO.
 15192     MOVE AM-GROUPING            TO GROUPBO.
 15193     MOVE AM-STATE               TO STATEBO.
 15194     MOVE AM-ACCOUNT             TO ACCTBO.
 15195     MOVE AM-NAME                TO ACCTNMBO.
 15196
 15197     IF PI-PAYEE-TYPE = 'A' AND
 15198        PI-PAYEE-SEQ-NUM = 0
 15199          MOVE AM-NAME             TO NAMEBO
 15200                                      PI-PAYEE-NAME
 15201          MOVE AM-ADDRS            TO ADDR1BO
 15202          MOVE SPACES              TO ADDR2BO
 15203*         MOVE AM-CITY             TO CITYSTBO
 15204          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 15205             DELIMITED BY '  ' INTO CITYSTBO
 15206          END-STRING
 15207          MOVE AM-ZIP-PRIME        TO WS-ZIP
 15208          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 15209          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 15210          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 15211
 15212***  We don't really need the code below because we don't do the
 15213***  AK thing anymore.  However, we may have a state special
 15214***  of some sort in the future so why not just leave it??
 15215     IF CITYSTBO EQUAL SPACES
 15216         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15217         GO TO 6070-FORMAT-DATA
 15218     END-IF.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 290
* EL156.cbl
 15219
 15220     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 15221     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 15222     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 15223     PERFORM VARYING WS-SUB FROM 30 BY -1
 15224          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 15225        IF WS-END-SUB = 0  AND
 15226           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 15227              OR LOW-VALUES  OR '.')
 15228            CONTINUE
 15229        ELSE
 15230            IF WS-END-SUB = 0
 15231                MOVE WS-SUB TO WS-END-SUB
 15232            ELSE
 15233                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 15234                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 15235                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15236                END-IF
 15237            END-IF
 15238        END-IF
 15239        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15240            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15241            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15242        END-IF
 15243     END-PERFORM.
 15244
 15245     IF WS-BEG-SUB > 0
 15246         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15247         IF WS-STATE-LENGTH = 2
 15248             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15249                  TO PI-CHECK-STATE-FOR-AK
 15250         ELSE
 15251             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15252                'ALASKA'
 15253                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15254             ELSE
 15255                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15256             END-IF
 15257         END-IF
 15258     ELSE
 15259         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15260     END-IF.
 15261
 15262     GO TO 6070-FORMAT-DATA.
 15263
 15264 6065-NOT-FOUND.
 15265     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15266     GO TO 6061-READ-ACCOUNT.
 15267
 15268 6068-ACCT-NOT-FND.
 15269     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15270
 15271 6070-FORMAT-DATA.
 15272     IF PI-HOLDTIL = ZEROS
 15273        MOVE SAVE-DATE           TO PAYDTBI
 15274       ELSE
 15275        MOVE PI-HOLDTIL          TO PAYDTBO
 15276        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 291
* EL156.cbl
 15277
 15278     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15279     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15280
 15281     IF EIBAID = DFHPF3 OR DFHPF4
 15282        NEXT SENTENCE
 15283     ELSE
 15284       GO TO 6071-CONTINUE.
 15285
 15286     MOVE PI-EPYFROM          TO PYFROMBO.
 15287     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15288
 15289     IF NOT PI-USES-PAID-TO
 15290        MOVE PI-EPYTHRU          TO PYTHRUBO
 15291        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15292     ELSE
 15293        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15294        MOVE '4'              TO DC-OPTION-CODE
 15295        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15296        IF NO-CONVERSION-ERROR
 15297           MOVE +1            TO DC-ELAPSED-DAYS
 15298           MOVE +0            TO DC-ELAPSED-MONTHS
 15299           MOVE '6'           TO DC-OPTION-CODE
 15300           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15301           IF NO-CONVERSION-ERROR
 15302              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15303
 15304     MOVE PI-EDAYS            TO DAYSBO.
 15305     MOVE PI-EPYAMT           TO PAYAMTBO.
 15306     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15307        IF PI-INT-AMT > ZEROS
 15308           MOVE PI-INT-AMT       TO INTAMTBO
 15309        END-IF
 15310     END-IF
 15311     GO TO 6072-SET-TYPE.
 15312
 15313 6071-CONTINUE.
 15314
 15315     IF PI-CPYFROM NOT = LOW-VALUES
 15316        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15317        MOVE SPACES              TO DC-OPTION-CODE
 15318        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15319        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15320
 15321     IF PI-CPYTHRU NOT = LOW-VALUES
 15322        IF NOT PI-USES-PAID-TO
 15323           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15324           MOVE SPACES             TO DC-OPTION-CODE
 15325           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15326           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15327        ELSE
 15328           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15329           MOVE '6'                TO DC-OPTION-CODE
 15330           MOVE +1                 TO DC-ELAPSED-DAYS
 15331           MOVE +0                 TO DC-ELAPSED-MONTHS
 15332           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15333           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15334
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 292
* EL156.cbl
 15335     MOVE PI-CDAYS               TO DAYSBO.
 15336     MOVE PI-CPYAMT              TO PAYAMTBO.
 15337     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15338        IF PI-INT-AMT > ZEROS
 15339           MOVE PI-INT-AMT       TO INTAMTBO
 15340        END-IF
 15341     END-IF
 15342     .
 15343 6072-SET-TYPE.
 15344     IF PI-PMTTYPE = '1'
 15345        MOVE 'PARTIAL'           TO PAYTYPBO.
 15346
 15347     IF PI-PMTTYPE = '2'
 15348        MOVE 'FINAL'             TO PAYTYPBO.
 15349
 15350     IF PI-PMTTYPE = '3'
 15351        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15352
 15353     IF PI-PMTTYPE = '4'
 15354        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15355
 15356     IF PI-PMTTYPE = '5'
 15357        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15358
 15359     IF PI-PMTTYPE = '6'
 15360        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15361
 15362     IF PI-PROV-PMT
 15363        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15364
 15365     IF PI-ECHECKNO NOT = SPACES
 15366        MOVE PI-ECHECKNO         TO CKNUMBO
 15367     ELSE
 15368        MOVE PI-CCHECKNO         TO CKNUMBO.
 15369
 15370     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 15371        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15372        MOVE +91                 TO  TRLR-SEQ-NO
 15373
 15374* EXEC CICS READ
 15375*           DATASET  ('ELTRLR')
 15376*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15377*           RIDFLD   (ELTRLR-KEY)
 15378*           RESP     (WS-RESPONSE)
 15379*       END-EXEC
 15380     MOVE 'ELTRLR' TO DFHEIV1
 15381*    MOVE '&"S        E          (  N#00014458' TO DFHEIV0
 15382     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15383     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15384     MOVE X'204E233030303134343538' TO DFHEIV0(25:11)
 15385     CALL 'kxdfhei1' USING DFHEIV0,
 15386           DFHEIV1,
 15387           DFHEIV20,
 15388           DFHEIV99,
 15389           ELTRLR-KEY,
 15390           DFHEIV99,
 15391           DFHEIV99,
 15392           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 293
* EL156.cbl
 15393     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15394         DFHEIV20
 15395     MOVE EIBRESP  TO WS-RESPONSE
 15396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15397
 15398        IF WS-RESP-NORMAL
 15399           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15400        ELSE
 15401           MOVE SPACES           TO  LOANNBO
 15402        END-IF
 15403     END-IF
 15404
 15405*       MOVE PI-LOAN-NO          TO LOANNBO
 15406
 15407     IF CKNUMBO = SPACES
 15408         MOVE SPACES             TO CKNUMHDO.
 15409
 15410     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15411     MOVE CL-CARRIER             TO CARRBO.
 15412     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15413     MOVE CL-CERT-SFX            TO SUFXBO.
 15414
 15415     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15416        EVALUATE CL-CLAIM-TYPE
 15417           WHEN 'I'
 15418              MOVE '  IU  '      TO CLMTYPBO
 15419           WHEN 'G'
 15420              MOVE ' GAP  '      TO CLMTYPBO
 15421           WHEN 'F'
 15422              MOVE ' FMLA '      TO CLMTYPBO
 15423           WHEN OTHER
 15424              MOVE PI-AH-OVERRIDE-L6
 15425                                 TO CLMTYPBO
 15426        END-EVALUATE
 15427        MOVE ZEROS               TO UNDISBO
 15428*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15429        IF PI-PMTTYPE = '5' OR '6'
 15430           GO TO 6073-GET-NOTIFY-DATA
 15431        ELSE
 15432           MOVE PI-DAILY-RATE    TO RATEBO
 15433           GO TO 6073-GET-NOTIFY-DATA.
 15434
 15435     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15436
 15437     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15438        MOVE ZEROS               TO UNDISBO
 15439     ELSE
 15440        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15441
 15442 6073-GET-NOTIFY-DATA.
 15443
 15444     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15445
 15446     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15447         MOVE SPACES             TO  NAMEB2O
 15448                                     ADDR1B2O
 15449                                     ADDR2B2O
 15450                                     CITYST2O
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 294
* EL156.cbl
 15451                                     AGTHDGO
 15452         MOVE ZEROS              TO  ZIPB2O
 15453         GO TO 6080-SET-INCURRED.
 15454
 15455     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
 15456     MOVE +29                    TO  TRLR-SEQ-NO.
 15457
 15458
 15459* EXEC CICS HANDLE CONDITION
 15460*        NOTFND   (6074-GET-COMP-DATA)
 15461*    END-EXEC.
 15462*    MOVE '"$I                   ! 1 #00014525' TO DFHEIV0
 15463     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15465     MOVE X'3120233030303134353235' TO DFHEIV0(25:11)
 15466     CALL 'kxdfhei1' USING DFHEIV0
 15467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15468
 15469
 15470     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15471
 15472     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15473     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15474     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15475*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15476     STRING AT-CITY ' ' AT-STATE
 15477        DELIMITED BY '  ' INTO CITYST2O
 15478     END-STRING
 15479     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15480     GO TO 6080-SET-INCURRED.
 15481
 15482 6074-GET-COMP-DATA.
 15483
 15484     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15485         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15486
 15487     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15488         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15489                                         ADDR1B2O
 15490                                         ADDR2B2O
 15491                                         CITYST2O
 15492         MOVE ZEROS                  TO  ZIPB2O
 15493         GO TO 6080-SET-INCURRED.
 15494
 15495     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15496     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15497     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15498     MOVE AM-GROUPING            TO  COMP-GROUP.
 15499     MOVE 'A'                    TO  COMP-TYPE.
 15500     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15501                                 TO  COMP-FIN-RESP.
 15502
 15503     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15504         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15505                                       'G' OR 'B' or 'S'
 15506             MOVE 'G'            TO  COMP-TYPE
 15507             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15508         ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 295
* EL156.cbl
 15509             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15510                                 TO  COMP-ACCOUNT
 15511     ELSE
 15512         MOVE 'G'                TO  COMP-TYPE
 15513         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
 15514
 15515     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15516
 15517     IF COMP-REC-FOUND
 15518         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15519         MOVE CO-ADDR-1          TO  ADDR1B2O
 15520         MOVE CO-ADDR-2          TO  ADDR2B2O
 15521*        MOVE CO-ADDR-3          TO  CITYST2O
 15522         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15523            DELIMITED BY '  ' INTO CITYST2O
 15524         END-STRING
 15525         MOVE CO-ZIP             TO  ZIPB2O
 15526     ELSE
 15527         MOVE 'NO COMP ADDRESS AVAILABLE'
 15528                                 TO  NAMEB2O
 15529                                     ADDR1B2O
 15530                                     ADDR2B2O
 15531                                     CITYST2O
 15532         MOVE ZEROS               TO ZIPB2O.
 15533
 15534 6080-SET-INCURRED.
 15535     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15536     MOVE SPACES                 TO DC-OPTION-CODE.
 15537     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15538     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15539     MOVE PI-PROCESSOR-ID        TO BYBO.
 15540     MOVE MAP-NAMEB              TO MAP-NAME.
 15541     MOVE 'C'                    TO PI-PASS-SW.
 15542     MOVE EIBAID                 TO PI-PFKEY-USED.
 15543     MOVE -1                     TO ENTPFBL.
 15544     GO TO 8100-SEND-INITIAL-MAP.
 15545
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 296
* EL156.cbl
 15547 6100-BUILD-PAYMENT-TRAILER.
 15548
 15549     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15550     MOVE '6'                    TO CNTL-REC-TYPE.
 15551
 15552     IF CONTROL-IS-ACTUAL-CARRIER
 15553         MOVE PI-CARRIER         TO WS-CARR
 15554     ELSE
 15555         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15556
 15557     IF PI-COMPANY-ID = 'FIA'
 15558         MOVE PI-CARRIER         TO  WS-CARR.
 15559
 15560     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15561     MOVE 0                      TO CNTL-SEQ-NO.
 15562     MOVE 'CARR'                 TO FILE-SWITCH.
 15563
 15564     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15565
 15566     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15567         IF PI-OFFLINE     = 'Y' AND
 15568            PI-ECHECKNO-CR = 'CR'
 15569              GO TO 6110-READ-CONTROL
 15570         ELSE
 15571            IF PI-CASH = 'N'
 15572                GO TO 6110-READ-CONTROL.
 15573
 15574     IF CHECK-NO-MANUAL    OR
 15575        CHECK-NO-AT-PRINT  OR
 15576        PI-OFFLINE = 'Y'
 15577          GO TO 6130-BUILD-TRAILER.
 15578     IF PI-COMPANY-ID = 'FIA'
 15579         NEXT SENTENCE
 15580     ELSE
 15581         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15582             GO TO 6110-READ-CONTROL.
 15583
 15584     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15585
 15586     IF CHECK-CNT-RESET-VALUE
 15587        MOVE +1                  TO CF-CHECK-COUNTER
 15588     ELSE
 15589        ADD +1                   TO CF-CHECK-COUNTER.
 15590
 15591     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15592
 15593     IF CHECK-NO-CARR-SEQ
 15594        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15595
 15596     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15597
 15598     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15599     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15600        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15601         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15602         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15603            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
 15604         MOVE WRK-NEXT-AUDIT-CHK-NO TO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 297
* EL156.cbl
 15605                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15606     END-IF.
 15607
 15608     GO TO 6120-REWRITE.
 15609
 15610 6105-STATE-CHECK-NUMBER.
 15611     IF CHECK-NO-MANUAL    OR
 15612        CHECK-NO-AT-PRINT  OR
 15613        PI-OFFLINE = 'Y'
 15614           GO TO 6130-BUILD-TRAILER
 15615     END-IF.
 15616
 15617     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15618     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15619     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15620     MOVE '3'                TO CNTL-REC-TYPE.
 15621     MOVE +0                 TO CNTL-SEQ-NO.
 15622     MOVE 'STAT'             TO FILE-SWITCH.
 15623     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15624
 15625     IF CF-ST-CHECK-CNT-RESET
 15626         MOVE +1             TO CF-ST-CHECK-COUNTER
 15627     ELSE
 15628         ADD +1              TO CF-ST-CHECK-COUNTER
 15629     END-IF.
 15630
 15631     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15632     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15633     GO TO 6120-REWRITE.
 15634
 15635 6110-READ-CONTROL.
 15636     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15637     MOVE '1'                    TO CNTL-REC-TYPE.
 15638     MOVE SPACES                 TO CNTL-ACCESS.
 15639     MOVE 0                      TO CNTL-SEQ-NO.
 15640
 15641     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15642
 15643     IF CO-CHECK-COUNT-RESET
 15644        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15645     ELSE
 15646        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15647
 15648     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15649
 15650     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15651         IF PI-OFFLINE     = 'Y'  AND
 15652            PI-ECHECKNO-CR = 'CR'
 15653              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15654              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15655              MOVE AL-UANON           TO CHECKNOA
 15656              GO TO 6120-REWRITE
 15657         ELSE
 15658         IF PI-CASH = 'N'
 15659             MOVE 'N'                TO PI-ECHECKNO-N
 15660             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15661             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15662             MOVE AL-UANON           TO CHECKNOA
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 298
* EL156.cbl
 15663             GO TO 6120-REWRITE.
 15664
 15665     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15666
 15667 6120-REWRITE.
 15668
 15669* EXEC CICS REWRITE
 15670*         DATASET('ELCNTL')
 15671*         FROM(CONTROL-FILE)
 15672*     END-EXEC.
 15673     MOVE LENGTH OF
 15674      CONTROL-FILE
 15675       TO DFHEIV11
 15676     MOVE 'ELCNTL' TO DFHEIV1
 15677*    MOVE '&& L                  %   #00014727' TO DFHEIV0
 15678     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15679     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15680     MOVE X'2020233030303134373237' TO DFHEIV0(25:11)
 15681     CALL 'kxdfhei1' USING DFHEIV0,
 15682           DFHEIV1,
 15683           CONTROL-FILE,
 15684           DFHEIV11,
 15685           DFHEIV99
 15686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15687
 15688
 15689     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15690
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 299
* EL156.cbl
 15692 6130-BUILD-TRAILER.
 15693
 15694
 15695* EXEC CICS GETMAIN
 15696*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15697*         LENGTH    (200)
 15698*         INITIMG   (GETMAIN-SPACE)
 15699*     END-EXEC.
 15700     MOVE 200
 15701       TO DFHEIV11
 15702*    MOVE ',"IL                  $   #00014737' TO DFHEIV0
 15703     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15704     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15705     MOVE X'2020233030303134373337' TO DFHEIV0(25:11)
 15706     CALL 'kxdfhei1' USING DFHEIV0,
 15707           DFHEIV20,
 15708           DFHEIV11,
 15709           GETMAIN-SPACE
 15710     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15711         DFHEIV20
 15712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15713
 15714
 15715     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15716                                    AT-PREV-PAID-THRU-DT.
 15717     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15718     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15719     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15720     MOVE 'AT'                   TO AT-RECORD-ID.
 15721     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15722
 15723     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15724        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15725           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15726     ELSE
 15727           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15728           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15729
 15730     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15731         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15732             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15733             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15734           ELSE
 15735             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15736             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15737
 15738     MOVE '2'                    TO AT-TRAILER-TYPE.
 15739     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15740                                    AT-PAYMENT-LAST-MAINT-DT.
 15741     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15742                                    AT-PAYMENT-LAST-UPDATED-BY.
 15743     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15744     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15745     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15746     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15747
 15748     IF PI-PMT-APPROVED
 15749        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 300
* EL156.cbl
 15750           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15751
 15752     IF PI-PFKEY-USED = DFHPF5
 15753        GO TO 6140-PF5-ENTERED.
 15754
 15755     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15756     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15757
 15758     IF PI-AIG-SPECIAL-BENEFIT
 15759         IF WS-1ST-SPECIAL-PMT
 15760             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15761             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15762                                        AT-AMOUNT-PAID
 15763         ELSE
 15764             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15765
 15766     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15767
 15768     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15769     MOVE '4'                    TO DC-OPTION-CODE.
 15770     PERFORM 9700-LINK-DATE-CONVERT.
 15771
 15772     IF DATE-CONVERSION-ERROR
 15773        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15774     ELSE
 15775        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15776
 15777     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15778     MOVE '4'                    TO DC-OPTION-CODE.
 15779     PERFORM 9700-LINK-DATE-CONVERT.
 15780
 15781     IF DATE-CONVERSION-ERROR
 15782        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15783     ELSE
 15784        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15785
 15786     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD
 15787     move pi-ach-payment         to at-ach-payment
 15788     GO TO 6150-FINISH-MOVE.
 15789
 15790 6140-PF5-ENTERED.
 15791     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15792     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15793
 15794     IF PI-AIG-SPECIAL-BENEFIT
 15795         IF WS-1ST-SPECIAL-PMT
 15796             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15797             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15798                                        AT-AMOUNT-PAID
 15799         ELSE
 15800             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15801
 15802     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15803     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15804     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15805
 15806 6150-FINISH-MOVE.
 15807
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 301
* EL156.cbl
 15808     IF PI-ECHECKNO = SPACES
 15809         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15810     ELSE
 15811         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15812
 15813     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15814     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15815
 15816*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15817*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15818
 15819     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15820         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15821
 15822     IF PI-OFFLINE = 'N'
 15823        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15824        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15825     ELSE
 15826        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15827        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15828
 15829     move pi-ach-payment         to at-ach-payment
 15830     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15831
 15832     IF WS-2ND-SPECIAL-PMT
 15833         MOVE 'Y'                TO AT-CASH-PAYMENT
 15834         MOVE SPACES             TO AT-CHECK-NO
 15835         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15836         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15837         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15838         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15839
 15840     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15841                                    AT-TO-BE-WRITTEN-DT.
 15842
 15843     IF PI-HOLDTIL NOT = ZEROS
 15844        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15845        MOVE '4'                 TO DC-OPTION-CODE
 15846        PERFORM 9700-LINK-DATE-CONVERT
 15847        IF PI-OFFLINE = 'N'
 15848           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15849           MOVE 'P'              TO WS-HOLD-UNTIL-SW
 15850        ELSE
 15851           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15852
 15853     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15854     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15855                                    AT-CHECK-QUE-SEQUENCE.
 15856
 15857     IF PI-PFKEY-USED = DFHPF4
 15858        MOVE '1'                 TO AT-FORCE-CONTROL.
 15859
 15860     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15861        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15862        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15863        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15864
 15865     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 302
* EL156.cbl
 15866                                    AT-VOID-SELECT-DT
 15867                                    AT-VOID-ACCEPT-DT
 15868                                    AT-VOID-DT.
 15869     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15870        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15871        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15872        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15873        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15874     ELSE
 15875        MOVE ZEROS               TO AT-DAILY-RATE
 15876                                    AT-ELIMINATION-DAYS
 15877        MOVE SPACES              TO AT-BENEFIT-TYPE
 15878     END-IF
 15879     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15880     MOVE '4'                    TO DC-OPTION-CODE.
 15881     PERFORM 9700-LINK-DATE-CONVERT.
 15882     IF DATE-CONVERSION-ERROR
 15883         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15884     ELSE
 15885         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15886     END-IF.
 15887     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15888     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15889     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15890     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15891     IF (PI-REAUDIT-NEEDED = 'Y')
 15892        or (pi-max-ext-used = 'Y')
 15893        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15894         PERFORM 6155-READ-CONTROL
 15895         PERFORM 6157-SET-APP-LEVEL
 15896         IF AT-APPROVAL-LEVEL-REQD < '4'
 15897            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15898         END-IF
 15899         MOVE 'Y' TO WS-NEED-APPROVAL
 15900         GO TO 6170-WRITE
 15901     END-IF.
 15902*******************************************************
 15903     IF NOT PI-PMT-GRADUATED
 15904         GO TO 6170-WRITE.
 15905     PERFORM 6155-READ-CONTROL.
 15906
 15907     IF PAID-FOR-LIFE
 15908         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15909             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15910                                     WS-PMT-APPROVAL-SW
 15911             GO TO 6170-WRITE.
 15912
 15913*05999      IF PAID-FOR-AH
 15914     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15915         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15916             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15917                                     WS-PMT-APPROVAL-SW
 15918             GO TO 6170-WRITE.
 15919
 15920     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15921
 15922     PERFORM 6157-SET-APP-LEVEL.
 15923
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 303
* EL156.cbl
 15924     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15925
 15926     IF NOT PI-PMT-GRADUATED
 15927         GO TO 6170-WRITE.
 15928
 15929
 15930* EXEC CICS HANDLE CONDITION
 15931*        NOTFND   (6170-WRITE)
 15932*    END-EXEC.
 15933*    MOVE '"$I                   ! 2 #00014957' TO DFHEIV0
 15934     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15936     MOVE X'3220233030303134393537' TO DFHEIV0(25:11)
 15937     CALL 'kxdfhei1' USING DFHEIV0
 15938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15939
 15940
 15941     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15942     MOVE '2'                    TO CNTL-REC-TYPE.
 15943     MOVE +0                     TO CNTL-SEQ-NO.
 15944     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15945
 15946
 15947* EXEC CICS READ
 15948*         DATASET  ('ELCNTL')
 15949*         SET      (ADDRESS OF CONTROL-FILE)
 15950*         RIDFLD   (ELCNTL-KEY)
 15951*    END-EXEC.
 15952     MOVE 'ELCNTL' TO DFHEIV1
 15953*    MOVE '&"S        E          (   #00014966' TO DFHEIV0
 15954     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15955     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15956     MOVE X'2020233030303134393636' TO DFHEIV0(25:11)
 15957     CALL 'kxdfhei1' USING DFHEIV0,
 15958           DFHEIV1,
 15959           DFHEIV20,
 15960           DFHEIV99,
 15961           ELCNTL-KEY,
 15962           DFHEIV99,
 15963           DFHEIV99,
 15964           DFHEIV99
 15965     SET ADDRESS OF CONTROL-FILE TO
 15966         DFHEIV20
 15967     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15968
 15969
 15970     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15971
 15972     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15973                         OR '4' OR '5'
 15974         NEXT SENTENCE
 15975     ELSE
 15976         MOVE 'Y' TO WS-NEED-APPROVAL
 15977         GO TO 6170-WRITE.
 15978
 15979     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15980         MOVE 'Y' TO WS-NEED-APPROVAL
 15981         IF WS-APPROVAL-LEVEL = '1'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 304
* EL156.cbl
 15982             MOVE '2'        TO  AT-APPROVED-LEVEL
 15983                            WS-SAVE-APPROVED-LEVEL
 15984             GO TO 6170-WRITE
 15985         ELSE
 15986             IF WS-APPROVAL-LEVEL = '2'
 15987                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15988                                WS-SAVE-APPROVED-LEVEL
 15989                 GO TO 6170-WRITE
 15990             ELSE IF WS-APPROVAL-LEVEL = '3'
 15991                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15992                                WS-SAVE-APPROVED-LEVEL
 15993                 GO TO 6170-WRITE
 15994             ELSE IF WS-APPROVAL-LEVEL = '4'
 15995                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15996                                WS-SAVE-APPROVED-LEVEL
 15997                 GO TO 6170-WRITE.
 15998
 15999     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 16000                             WS-PMT-APPROVAL-SW.
 16001     MOVE SPACES         TO  AT-APPROVED-LEVEL
 16002                             AT-APPROVAL-LEVEL-REQD.
 16003
 16004*******************************************************
 16005 6155-READ-CONTROL.
 16006     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 16007     MOVE '1'                    TO CNTL-REC-TYPE.
 16008     MOVE SPACES                 TO CNTL-ACCESS.
 16009     MOVE +0                     TO CNTL-SEQ-NO.
 16010     MOVE 'COMP'                 TO FILE-SWITCH.
 16011
 16012     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 16013 6157-SET-APP-LEVEL.
 16014******A&H Limits are set as a monthly payment.  Calculate the mont
 16015******equivalent of the amount paid today
 16016     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 16017        PI-SAVE-ODD-DAYS-OVER > 0
 16018           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 16019                               / 30) + PI-SAVE-ELAPSED-MONTHS
 16020           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 16021                                  WS-CALC-PMT-MONTHS
 16022     ELSE
 16023           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 16024     END-IF.
 16025*06007      IF ((PAID-FOR-AH) AND
 16026     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16027           OR PAID-FOR-FAM) AND
 16028*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16029        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 16030              OR
 16031        ((PAID-FOR-LIFE) AND
 16032        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 16033            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16034       ELSE
 16035*06014      IF ((PAID-FOR-AH)  AND
 16036         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16037           OR PAID-FOR-FAM) AND
 16038*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16039           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 305
* EL156.cbl
 16040              OR
 16041        ((PAID-FOR-LIFE) AND
 16042        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 16043            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16044         ELSE
 16045*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 16046           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16047                OR PAID-FOR-FAM) AND
 16048               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 16049              OR
 16050          ((PAID-FOR-LIFE) AND
 16051          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 16052            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16053       ELSE
 16054           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16055                OR PAID-FOR-FAM) AND
 16056               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 16057              OR
 16058          ((PAID-FOR-LIFE) AND
 16059          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 16060            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16061       ELSE
 16062            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16063
 16064     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16065           OR PAID-FOR-FAM) AND
 16066        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 16067        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 16068            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 16069        END-IF
 16070     ELSE
 16071     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16072           OR PAID-FOR-FAM) AND
 16073        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 16074        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 16075            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 16076        END-IF
 16077     ELSE
 16078     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16079           OR PAID-FOR-FAM) AND
 16080        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 16081        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 16082            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 16083        END-IF
 16084     ELSE
 16085     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16086           OR PAID-FOR-FAM) AND
 16087        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 16088        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 16089            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 16090        END-IF
 16091     ELSE
 16092     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP
 16093           OR PAID-FOR-FAM)
 16094            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 16095
 16096 6170-WRITE.
 16097
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 306
* EL156.cbl
 16098     if pi-company-id = 'DCC' or 'VPP'
 16099        PERFORM 0900-GET-DDF-limits
 16100                                 THRU 0900-EXIT
 16101     end-if
 16102     perform 2220-update-elcrtt  thru 2220-exit
 16103     IF PI-COMPANY-ID = 'DMD'
 16104        IF PI-AT-EOB-CODES NOT = SPACES
 16105           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16106           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16107           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16108           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16109           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16110
 16111
 16112* EXEC CICS HANDLE CONDITION
 16113*        DUPREC    (6180-DUPREC)
 16114*    END-EXEC.
 16115*    MOVE '"$%                   ! 3 #00015113' TO DFHEIV0
 16116     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16117     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16118     MOVE X'3320233030303135313133' TO DFHEIV0(25:11)
 16119     CALL 'kxdfhei1' USING DFHEIV0
 16120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16121
 16122
 16123
 16124* EXEC CICS WRITE
 16125*         DATASET       ('ELTRLR')
 16126*         FROM          (ACTIVITY-TRAILERS)
 16127*         RIDFLD        (AT-CONTROL-PRIMARY)
 16128*     END-EXEC.
 16129     MOVE LENGTH OF
 16130      ACTIVITY-TRAILERS
 16131       TO DFHEIV11
 16132     MOVE 'ELTRLR' TO DFHEIV1
 16133*    MOVE '&$ L                  ''   #00015117' TO DFHEIV0
 16134     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16135     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16136     MOVE X'2020233030303135313137' TO DFHEIV0(25:11)
 16137     CALL 'kxdfhei1' USING DFHEIV0,
 16138           DFHEIV1,
 16139           ACTIVITY-TRAILERS,
 16140           DFHEIV11,
 16141           AT-CONTROL-PRIMARY,
 16142           DFHEIV99,
 16143           DFHEIV99
 16144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16145
 16146
 16147     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 16148        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 16149*06088           GO TO 6199-EXIT.
 16150           GO TO 6176-APPROVAL-NOTE.
 16151
 16152
 16153* EXEC CICS GETMAIN
 16154*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16155*         LENGTH    (200)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 307
* EL156.cbl
 16156*         INITIMG   (GETMAIN-SPACE)
 16157*     END-EXEC.
 16158     MOVE 200
 16159       TO DFHEIV11
 16160*    MOVE ',"IL                  $   #00015128' TO DFHEIV0
 16161     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16162     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16163     MOVE X'2020233030303135313238' TO DFHEIV0(25:11)
 16164     CALL 'kxdfhei1' USING DFHEIV0,
 16165           DFHEIV20,
 16166           DFHEIV11,
 16167           GETMAIN-SPACE
 16168     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16169         DFHEIV20
 16170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16171
 16172
 16173     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16174
 16175     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 16176     MOVE 'AT'                   TO AT-RECORD-ID.
 16177     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 16178     MOVE '6'                    TO AT-TRAILER-TYPE.
 16179     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 16180                                    AT-GEN-INFO-LAST-MAINT-DT
 16181     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 16182                                    AT-GEN-INFO-LAST-UPDATED-BY
 16183     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 16184
 16185     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 16186     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 16187     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 16188
 16189     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 16190
 16191 6175-WRITE.
 16192
 16193
 16194* EXEC CICS HANDLE CONDITION
 16195*        DUPREC    (6190-DUPREC)
 16196*    END-EXEC.
 16197*    MOVE '"$%                   ! 4 #00015154' TO DFHEIV0
 16198     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16199     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16200     MOVE X'3420233030303135313534' TO DFHEIV0(25:11)
 16201     CALL 'kxdfhei1' USING DFHEIV0
 16202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16203
 16204
 16205
 16206* EXEC CICS WRITE
 16207*         DATASET     ('ELTRLR')
 16208*         FROM        (ACTIVITY-TRAILERS)
 16209*         RIDFLD      (AT-CONTROL-PRIMARY)
 16210*     END-EXEC.
 16211     MOVE LENGTH OF
 16212      ACTIVITY-TRAILERS
 16213       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 308
* EL156.cbl
 16214     MOVE 'ELTRLR' TO DFHEIV1
 16215*    MOVE '&$ L                  ''   #00015158' TO DFHEIV0
 16216     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16217     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16218     MOVE X'2020233030303135313538' TO DFHEIV0(25:11)
 16219     CALL 'kxdfhei1' USING DFHEIV0,
 16220           DFHEIV1,
 16221           ACTIVITY-TRAILERS,
 16222           DFHEIV11,
 16223           AT-CONTROL-PRIMARY,
 16224           DFHEIV99,
 16225           DFHEIV99
 16226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16227
 16228
 16229 6176-APPROVAL-NOTE.
 16230
 16231     IF NOT APPROVAL-NEEDED
 16232         GO TO 6199-EXIT.
 16233
 16234
 16235* EXEC CICS GETMAIN
 16236*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16237*        LENGTH    (200)
 16238*        INITIMG   (GETMAIN-SPACE)
 16239*    END-EXEC.
 16240     MOVE 200
 16241       TO DFHEIV11
 16242*    MOVE ',"IL                  $   #00015169' TO DFHEIV0
 16243     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16244     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16245     MOVE X'2020233030303135313639' TO DFHEIV0(25:11)
 16246     CALL 'kxdfhei1' USING DFHEIV0,
 16247           DFHEIV20,
 16248           DFHEIV11,
 16249           GETMAIN-SPACE
 16250     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16251         DFHEIV20
 16252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16253
 16254
 16255     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16256
 16257     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16258     MOVE 'AT'               TO AT-RECORD-ID
 16259     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16260     MOVE '6'                TO AT-TRAILER-TYPE
 16261     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16262                                AT-GEN-INFO-LAST-MAINT-DT
 16263     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16264                                AT-GEN-INFO-LAST-UPDATED-BY
 16265     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16266
 16267     IF PI-REAUDIT-NEEDED = 'Y'
 16268         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16269     ELSE
 16270         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16271     END-IF
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 309
* EL156.cbl
 16272     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16273         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16274     END-IF
 16275     MOVE SPACES             TO AT-INFO-LINE-2
 16276
 16277     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16278 6177-WRITE.
 16279
 16280
 16281* EXEC CICS HANDLE CONDITION
 16282*        DUPREC    (6185-DUPREC)
 16283*    END-EXEC.
 16284*    MOVE '"$%                   ! 5 #00015200' TO DFHEIV0
 16285     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16286     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16287     MOVE X'3520233030303135323030' TO DFHEIV0(25:11)
 16288     CALL 'kxdfhei1' USING DFHEIV0
 16289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16290
 16291
 16292
 16293* EXEC CICS WRITE
 16294*         DATASET     ('ELTRLR')
 16295*         FROM        (ACTIVITY-TRAILERS)
 16296*         RIDFLD      (AT-CONTROL-PRIMARY)
 16297*     END-EXEC.
 16298     MOVE LENGTH OF
 16299      ACTIVITY-TRAILERS
 16300       TO DFHEIV11
 16301     MOVE 'ELTRLR' TO DFHEIV1
 16302*    MOVE '&$ L                  ''   #00015204' TO DFHEIV0
 16303     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16304     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16305     MOVE X'2020233030303135323034' TO DFHEIV0(25:11)
 16306     CALL 'kxdfhei1' USING DFHEIV0,
 16307           DFHEIV1,
 16308           ACTIVITY-TRAILERS,
 16309           DFHEIV11,
 16310           AT-CONTROL-PRIMARY,
 16311           DFHEIV99,
 16312           DFHEIV99
 16313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16314
 16315
 16316
 16317     GO TO 6199-EXIT.
 16318
 16319 6180-DUPREC.
 16320
 16321     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16322     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16323     GO TO 6170-WRITE.
 16324
 16325 6185-DUPREC.
 16326     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16327     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16328     GO TO 6177-WRITE.
 16329
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 310
* EL156.cbl
 16330 6190-DUPREC.
 16331     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16332     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16333     GO TO 6175-WRITE.
 16334
 16335 6199-EXIT.
 16336      EXIT.
 16337
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 311
* EL156.cbl
 16339 6200-UPDATE-CLAIM-MSTR.
 16340     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16341     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16342     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16343     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16344
 16345     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16346
 16347     MOVE ZEROS                  TO W-INTEREST.
 16348
 16349     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 16350        IF (PI-OFFLINE = 'Y') OR
 16351           (PI-PMTTYPE = '7')
 16352           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16353                                 THRU 9870-EXIT
 16354        END-IF
 16355     END-IF
 16356     IF NOT ERROR-ON-OUTPUT
 16357        CONTINUE
 16358     ELSE
 16359
 16360* EXEC CICS REWRITE
 16361*          DATASET('ELMSTR')
 16362*          FROM(CLAIM-MASTER)
 16363*       END-EXEC
 16364     MOVE LENGTH OF
 16365      CLAIM-MASTER
 16366       TO DFHEIV11
 16367     MOVE 'ELMSTR' TO DFHEIV1
 16368*    MOVE '&& L                  %   #00015253' TO DFHEIV0
 16369     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16370     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16371     MOVE X'2020233030303135323533' TO DFHEIV0(25:11)
 16372     CALL 'kxdfhei1' USING DFHEIV0,
 16373           DFHEIV1,
 16374           CLAIM-MASTER,
 16375           DFHEIV11,
 16376           DFHEIV99
 16377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16378
 16379        MOVE -1                  TO ENTPFBL
 16380        MOVE AL-UANON            TO ENTPFBA
 16381        MOVE MAP-NAMEB           TO MAP-NAME
 16382        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16383        GO TO 8200-SEND-DATAONLY
 16384     END-IF
 16385
 16386     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16387
 16388     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16389
 16390     IF PI-AIG-SPECIAL-BENEFIT
 16391         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16392
 16393     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16394
 16395     IF PI-SPECIAL-BEN-SW = 'Y'
 16396         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 312
* EL156.cbl
 16397         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16398
 16399     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16400         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16401     ELSE
 16402         IF PI-PMTTYPE NOT = '4'
 16403            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16404
 16405     IF PI-PMTTYPE = '5' OR '6'
 16406        GO TO  6250-SET-MAINT.
 16407
 16408     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16409                                         CL-LAG-REPORT-CODE.
 16410
 16411     IF CL-ACTIVITY-CODE = 09
 16412         GO TO 6200-CONT-UPDATE.
 16413
 16414     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16415         IF CL-ACTIVITY-CODE = 11
 16416             GO TO 6200-CONT-UPDATE.
 16417
 16418     IF WS-ACT-REC-FOUND-SW = 'N'
 16419         GO TO 6200-CONT-UPDATE.
 16420
 16421     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16422         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16423         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16424         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16425
 16426     IF WS-UPDATE-SW = 'Y'
 16427         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16428                                         CL-NEXT-FOLLOWUP-DT.
 16429
 16430 6200-CONT-UPDATE.
 16431
 16432     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16433       IF CLAIM-IS-CLOSED
 16434         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16435           IF WS-OPEN-CLOSE-SW = '2'
 16436             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16437                                        CL-LAST-CLOSE-DT.
 16438
 16439     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16440        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16441        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16442
 16443     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16444        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16445        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16446        MOVE 'C'                 TO CL-CLAIM-STATUS
 16447        IF PI-PMTTYPE = '2'
 16448           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16449              or 'F')
 16450           CONTINUE
 16451        ELSE
 16452           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16453        END-IF
 16454     ELSE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 313
* EL156.cbl
 16455        IF PI-PMTTYPE = '2' OR '3'
 16456           IF PI-PMTTYPE = '2' AND
 16457              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16458                 or 'F')
 16459              CONTINUE
 16460           ELSE
 16461              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16462           END-IF
 16463        END-IF
 16464     END-IF
 16465
 16466     IF PI-PMTTYPE = '4'
 16467        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16468
 16469     IF PI-COMPANY-ID = 'CVL'
 16470         IF PI-LOAN-UPDATE-SW = 'Y'
 16471             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16472             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16473             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16474             MOVE CL-CERT-STATE      TO  CERT-STATE
 16475             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16476             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16477             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16478             MOVE 'CERT'             TO  FILE-SWITCH
 16479             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16480             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16481             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16482
 16483     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16484        GO TO 6220-USE-COMPUTED.
 16485
 16486     IF (PI-PMTTYPE = '4')  AND
 16487        (PI-EPYAMT < ZEROS)
 16488          COMPUTE CL-NO-OF-DAYS-PAID =
 16489                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16490          IF CL-NO-OF-DAYS-PAID < +0
 16491              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16492          ELSE
 16493              NEXT SENTENCE
 16494     ELSE
 16495          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16496
 16497     IF HOLD-UNTIL-PMT
 16498        CONTINUE
 16499     ELSE
 16500     IF PI-PROCESSOR-ID = 'FIX '
 16501        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16502           NEXT SENTENCE
 16503        ELSE
 16504           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16505     ELSE
 16506        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16507
 16508     IF PI-PMTTYPE = '4'
 16509        GO TO 6250-SET-MAINT.
 16510
 16511     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16512     MOVE '4'                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 314
* EL156.cbl
 16513     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 16514     IF HOLD-UNTIL-PMT
 16515        CONTINUE
 16516     ELSE
 16517     IF DATE-CONVERSION-ERROR
 16518        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16519     ELSE
 16520        ADD 1                 TO CL-NO-OF-PMTS-MADE
 16521        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16522           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16523           IF PI-AIG-SPECIAL-BENEFIT
 16524               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16525           ELSE
 16526               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16527
 16528     GO TO 6250-SET-MAINT.
 16529
 16530 6220-USE-COMPUTED.
 16531
 16532     IF (PI-PMTTYPE = '4')  AND
 16533        (PI-CPYAMT < ZEROS)
 16534          COMPUTE CL-NO-OF-DAYS-PAID =
 16535                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16536          IF CL-NO-OF-DAYS-PAID < +0
 16537              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16538          ELSE
 16539              NEXT SENTENCE
 16540     ELSE
 16541          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16542
 16543     IF NOT HOLD-UNTIL-PMT
 16544        ADD 1                    TO CL-NO-OF-PMTS-MADE
 16545        ADD PI-CPYAMT            TO CL-TOTAL-PAID-AMT.
 16546
 16547     IF PI-PMTTYPE = '4'
 16548        GO TO 6250-SET-MAINT.
 16549
 16550     IF PI-AIG-SPECIAL-BENEFIT
 16551         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16552     ELSE
 16553         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16554
 16555     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16556       AND NOT HOLD-UNTIL-PMT
 16557        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16558
 16559 6250-SET-MAINT.
 16560     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16561
 16562     IF PI-PROCESSOR-ID = 'FIX '
 16563        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16564           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16565        ELSE
 16566           NEXT SENTENCE
 16567     ELSE
 16568        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16569
 16570     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 315
* EL156.cbl
 16571     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16572     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16573
 16574 6299-EXIT.
 16575      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 316
* EL156.cbl
 16577 6300-UPDATE-CERT.
 16578
 16579*  ADD CERTNOTE FOR SC NP+6
 16580     IF PI-COMPANY-ID = 'CID' AND
 16581       (PI-PMTTYPE = '2' OR '3') AND
 16582        CL-CERT-STATE = 'SC'  AND
 16583        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16584           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16585     END-IF.
 16586
 16587     IF PI-COMPANY-ID = 'AHL' AND
 16588       (PI-PMTTYPE = '2' OR '3') AND
 16589        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16590           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16591           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16592     END-IF.
 16593
 16594     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16595     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16596     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16597     MOVE CL-CERT-STATE    TO CERT-STATE.
 16598     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16599     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16600     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16601     MOVE 'CERT'           TO FILE-SWITCH.
 16602
 16603     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16604
 16605     IF CERT-NOTE-ADDED
 16606        IF CM-NOTE-SW = ' '
 16607           MOVE '4'             TO CM-NOTE-SW
 16608        ELSE
 16609           IF CM-NOTE-SW = '1'
 16610               MOVE '5'           TO CM-NOTE-SW
 16611           ELSE
 16612              IF CM-NOTE-SW = '2'
 16613                 MOVE '6'         TO CM-NOTE-SW
 16614              ELSE
 16615                 IF CM-NOTE-SW = '3'
 16616                    MOVE '7'      TO CM-NOTE-SW
 16617                 END-IF
 16618              END-IF
 16619           END-IF
 16620        END-IF
 16621     END-IF.
 16622
 16623     IF PI-COMPANY-ID = 'CVL'
 16624         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16625         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16626
 16627     IF PI-PMTTYPE NOT = '4'
 16628        GO TO 6340-UPDATE-CERT.
 16629
 16630     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16631        IF PI-PFKEY-USED = DFHPF5
 16632           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16633        ELSE
 16634           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 317
* EL156.cbl
 16635
 16636*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16637*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16638*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16639*               PI-LF-COVERAGE-TYPE = 'P'
 16640*                GO TO 6350-REWRITE-CERT.
 16641
 16642     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16643       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16644          PI-LF-COVERAGE-TYPE = 'P'
 16645           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16646                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16647                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16648                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16649                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16650                GO TO 6350-REWRITE-CERT
 16651            ELSE
 16652                GO TO 6350-REWRITE-CERT.
 16653
 16654     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16655         GO TO 6350-REWRITE-CERT.
 16656
 16657     IF NOT CM-AH-LUMP-SUM-DISAB
 16658        GO TO 6380-UNLOCK-CERT.
 16659
 16660     IF PI-PFKEY-USED = DFHPF5
 16661        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16662                                    CM-AH-ITD-AH-PMT
 16663        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16664        GO TO 6350-REWRITE-CERT
 16665     ELSE
 16666        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16667                                    CM-AH-ITD-AH-PMT
 16668        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16669        GO TO 6350-REWRITE-CERT.
 16670
 16671 6340-UPDATE-CERT.
 16672
 16673     IF CL-CLAIM-TYPE = 'L'
 16674         IF PI-PFKEY-USED = DFHPF5
 16675             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16676         ELSE
 16677             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16678
 16679     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16680         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16681             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16682                PI-LF-COVERAGE-TYPE = 'P'
 16683                 GO TO 6350-REWRITE-CERT.
 16684
 16685     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16686       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16687          PI-LF-COVERAGE-TYPE = 'P'
 16688           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16689                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16690                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16691                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16692                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 318
* EL156.cbl
 16693                GO TO 6350-REWRITE-CERT.
 16694
 16695     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16696         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16697            PI-LF-COVERAGE-TYPE NOT = 'P'
 16698             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16699             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16700             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16701             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16702             GO TO 6350-REWRITE-CERT.
 16703
 16704     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16705         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16706         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16707         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16708         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16709         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16710         IF PI-PFKEY-USED = DFHPF5
 16711             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16712                                        CM-AH-ITD-AH-PMT
 16713             GO TO 6350-REWRITE-CERT
 16714         ELSE
 16715             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16716                                        CM-AH-ITD-AH-PMT
 16717             GO TO 6350-REWRITE-CERT.
 16718
 16719 6350-REWRITE-CERT.
 16720
 16721
 16722* EXEC CICS REWRITE
 16723*         DATASET  ('ELCERT')
 16724*         FROM(CERTIFICATE-MASTER)
 16725*     END-EXEC.
 16726     MOVE LENGTH OF
 16727      CERTIFICATE-MASTER
 16728       TO DFHEIV11
 16729     MOVE 'ELCERT' TO DFHEIV1
 16730*    MOVE '&& L                  %   #00015600' TO DFHEIV0
 16731     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16732     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16733     MOVE X'2020233030303135363030' TO DFHEIV0(25:11)
 16734     CALL 'kxdfhei1' USING DFHEIV0,
 16735           DFHEIV1,
 16736           CERTIFICATE-MASTER,
 16737           DFHEIV11,
 16738           DFHEIV99
 16739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16740
 16741
 16742     GO TO 6399-EXIT.
 16743
 16744 6380-UNLOCK-CERT.
 16745
 16746* EXEC CICS UNLOCK
 16747*         DATASET  ('ELCERT')
 16748*     END-EXEC.
 16749     MOVE 'ELCERT' TO DFHEIV1
 16750*    MOVE '&*                    #   #00015608' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 319
* EL156.cbl
 16751     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16752     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16753     MOVE X'2020233030303135363038' TO DFHEIV0(25:11)
 16754     CALL 'kxdfhei1' USING DFHEIV0,
 16755           DFHEIV1,
 16756           DFHEIV99
 16757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16758
 16759
 16760 6399-EXIT.
 16761      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 320
* EL156.cbl
 16763 6400-UPDATE-ZERO-TRAILER.
 16764     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16765     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16766
 16767     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16768
 16769     IF PI-EPYAMT NOT = ZEROS
 16770         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16771     ELSE
 16772         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16773
 16774     IF PI-ERESV NOT = ZEROS
 16775        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16776
 16777     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16778        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16779
 16780     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16781        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16782     ELSE
 16783        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16784
 16785     IF PI-PMTTYPE = '5'
 16786        IF PI-EPYAMT = ZEROS
 16787           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16788        ELSE
 16789           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16790
 16791     IF PI-PMTTYPE = '6'
 16792        IF PI-EPYAMT = ZEROS
 16793           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16794        ELSE
 16795           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16796
 16797 6420-CHECK-OPEN-CLOSE.
 16798     IF PI-PMTTYPE = '5' OR '6'
 16799        GO TO 6450-REWRITE.
 16800
 16801     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16802         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16803             IF CLAIM-IS-CLOSED
 16804                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16805                 MOVE 1          TO  SUB-1
 16806                 GO TO 6440-AIG-LOOP.
 16807
 16808     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16809        GO TO 6450-REWRITE.
 16810
 16811     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16812        GO TO 6450-REWRITE.
 16813
 16814     MOVE 1                      TO SUB-1.
 16815
 16816 6430-LOOP.
 16817     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16818        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16819        IF PI-PMTTYPE = '1' OR '4'
 16820           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 321
* EL156.cbl
 16821           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16822           GO TO 6450-REWRITE
 16823        ELSE
 16824           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16825           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16826           GO TO 6450-REWRITE.
 16827
 16828     IF SUB-1 = 6
 16829      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16830      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16831      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16832      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16833      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16834      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16835      GO TO 6430-LOOP.
 16836
 16837     ADD 1                       TO SUB-1.
 16838     GO TO 6430-LOOP.
 16839
 16840
 16841 6440-AIG-LOOP.
 16842
 16843     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16844       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16845       IF WS-OPEN-CLOSE-SW = '1'
 16846         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16847         IF PI-PMTTYPE = '2'
 16848           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16849           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16850         ELSE
 16851           IF PI-PMTTYPE = '3'
 16852             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16853             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16854           ELSE
 16855             IF PI-PMTTYPE = '4'
 16856               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16857               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16858             ELSE
 16859               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16860               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16861       ELSE
 16862         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16863         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16864         GO TO 6450-REWRITE.
 16865
 16866     IF SUB-1 = 6
 16867      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16868      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16869      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16870      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16871      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16872      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16873      GO TO 6440-AIG-LOOP.
 16874
 16875     ADD 1                       TO SUB-1.
 16876     GO TO 6440-AIG-LOOP.
 16877
 16878 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 322
* EL156.cbl
 16879     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16880     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16881     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16882
 16883     IF PI-COMPANY-ID = 'DMD'
 16884         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16885         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16886         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16887         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16888         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16889
 16890
 16891* EXEC CICS REWRITE
 16892*         DATASET  ('ELTRLR')
 16893*         FROM     (ACTIVITY-TRAILERS)
 16894*     END-EXEC.
 16895     MOVE LENGTH OF
 16896      ACTIVITY-TRAILERS
 16897       TO DFHEIV11
 16898     MOVE 'ELTRLR' TO DFHEIV1
 16899*    MOVE '&& L                  %   #00015742' TO DFHEIV0
 16900     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16901     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16902     MOVE X'2020233030303135373432' TO DFHEIV0(25:11)
 16903     CALL 'kxdfhei1' USING DFHEIV0,
 16904           DFHEIV1,
 16905           ACTIVITY-TRAILERS,
 16906           DFHEIV11,
 16907           DFHEIV99
 16908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16909
 16910
 16911 6499-EXIT.
 16912      EXIT.
 16913
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 323
* EL156.cbl
 16915 6500-READ-DLO035.
 16916     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16917     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16918     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16919     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16920
 16921
 16922* EXEC CICS LINK
 16923*        PROGRAM    ('DLO035')
 16924*        COMMAREA   (DLO035-KEY)
 16925*        LENGTH     (DL35-LENGTH)
 16926*    END-EXEC.
 16927     MOVE 'DLO035' TO DFHEIV1
 16928*    MOVE '."C                   (   #00015757' TO DFHEIV0
 16929     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16930     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16931     MOVE X'2020233030303135373537' TO DFHEIV0(25:11)
 16932     CALL 'kxdfhei1' USING DFHEIV0,
 16933           DFHEIV1,
 16934           DLO035-KEY,
 16935           DL35-LENGTH,
 16936           DFHEIV99,
 16937           DFHEIV99,
 16938           DFHEIV99,
 16939           DFHEIV99
 16940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16941
 16942
 16943     IF DL35-RETURN-CODE = 'OK'
 16944         GO TO 6500-EXIT.
 16945
 16946     IF DL35-RETURN-CODE = '01'
 16947         MOVE ER-7830            TO EMI-ERROR
 16948         GO TO 6500-BAD-EXIT.
 16949
 16950     IF DL35-RETURN-CODE = '02'
 16951         MOVE ER-7831            TO EMI-ERROR
 16952         GO TO 6500-BAD-EXIT.
 16953
 16954     IF DL35-RETURN-CODE = '03'
 16955         MOVE ER-7832            TO EMI-ERROR
 16956         GO TO 6500-BAD-EXIT.
 16957
 16958     IF DL35-RETURN-CODE = '04'
 16959         MOVE ER-7833            TO EMI-ERROR
 16960         GO TO 6500-BAD-EXIT.
 16961
 16962     IF DL35-RETURN-CODE = '05'
 16963         MOVE ER-7834            TO EMI-ERROR
 16964         GO TO 6500-BAD-EXIT.
 16965
 16966     IF DL35-RETURN-CODE = '06'
 16967         MOVE ER-7835            TO EMI-ERROR
 16968         GO TO 6500-BAD-EXIT.
 16969
 16970     IF DL35-RETURN-CODE = '07'
 16971         MOVE ER-7836            TO EMI-ERROR
 16972         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 324
* EL156.cbl
 16973
 16974     IF DL35-RETURN-CODE = 'E1'
 16975         MOVE ER-7837            TO EMI-ERROR
 16976         GO TO 6500-BAD-EXIT.
 16977
 16978     IF DL35-RETURN-CODE NOT = 'OK'
 16979         MOVE ER-7838            TO EMI-ERROR
 16980         GO TO 6500-BAD-EXIT.
 16981
 16982 6500-EXIT.
 16983      EXIT.
 16984
 16985 6500-BAD-EXIT.
 16986
 16987* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16988*    MOVE '6"R                   !   #00015806' TO DFHEIV0
 16989     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16991     MOVE X'2020233030303135383036' TO DFHEIV0(25:11)
 16992     CALL 'kxdfhei1' USING DFHEIV0
 16993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16994
 16995     MOVE -1                 TO PMTTYPEL.
 16996     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16997     GO TO 8200-SEND-DATAONLY.
 16998
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 325
* EL156.cbl
 17000 6600-UPDATE-DLO035.
 17001     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 17002     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 17003     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 17004     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 17005
 17006
 17007* EXEC CICS LINK
 17008*        PROGRAM    ('DLO035')
 17009*        COMMAREA   (DLO035-KEY)
 17010*        LENGTH     (DL35-LENGTH)
 17011*    END-EXEC.
 17012     MOVE 'DLO035' TO DFHEIV1
 17013*    MOVE '."C                   (   #00015818' TO DFHEIV0
 17014     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17015     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17016     MOVE X'2020233030303135383138' TO DFHEIV0(25:11)
 17017     CALL 'kxdfhei1' USING DFHEIV0,
 17018           DFHEIV1,
 17019           DLO035-KEY,
 17020           DL35-LENGTH,
 17021           DFHEIV99,
 17022           DFHEIV99,
 17023           DFHEIV99,
 17024           DFHEIV99
 17025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17026
 17027
 17028     IF DL35-RETURN-CODE = 'OK'
 17029         GO TO 6600-EXIT.
 17030
 17031     IF DL35-RETURN-CODE = '01'
 17032         MOVE ER-7830            TO EMI-ERROR
 17033         GO TO 6500-BAD-EXIT.
 17034
 17035     IF DL35-RETURN-CODE = '02'
 17036         MOVE ER-7831            TO EMI-ERROR
 17037         GO TO 6500-BAD-EXIT.
 17038
 17039     IF DL35-RETURN-CODE = '03'
 17040         MOVE ER-7832            TO EMI-ERROR
 17041         GO TO 6500-BAD-EXIT.
 17042
 17043     IF DL35-RETURN-CODE = '04'
 17044         MOVE ER-7833            TO EMI-ERROR
 17045         GO TO 6500-BAD-EXIT.
 17046
 17047     IF DL35-RETURN-CODE = '05'
 17048         MOVE ER-7834            TO EMI-ERROR
 17049         GO TO 6500-BAD-EXIT.
 17050
 17051     IF DL35-RETURN-CODE = '06'
 17052         MOVE ER-7835            TO EMI-ERROR
 17053         GO TO 6500-BAD-EXIT.
 17054
 17055     IF DL35-RETURN-CODE = '07'
 17056         MOVE ER-7836            TO EMI-ERROR
 17057         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 326
* EL156.cbl
 17058
 17059     IF DL35-RETURN-CODE = 'E1'
 17060         MOVE ER-7837            TO EMI-ERROR
 17061         GO TO 6500-BAD-EXIT.
 17062
 17063     IF DL35-RETURN-CODE NOT = 'OK'
 17064         MOVE ER-7838            TO EMI-ERROR
 17065         GO TO 6500-BAD-EXIT.
 17066
 17067 6600-EXIT.
 17068      EXIT.
 17069
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 327
* EL156.cbl
 17071 6700-UPDATE-ACTQ.
 17072***************************************************************
 17073*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 17074*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 17075*    ONE ALREADY THERE.                                       *
 17076***************************************************************
 17077
 17078
 17079* EXEC CICS HANDLE CONDITION
 17080*         NOTFND(6720-BUILD-NEW-RECORD)
 17081*     END-EXEC.
 17082*    MOVE '"$I                   ! 6 #00015874' TO DFHEIV0
 17083     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17084     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17085     MOVE X'3620233030303135383734' TO DFHEIV0(25:11)
 17086     CALL 'kxdfhei1' USING DFHEIV0
 17087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17088
 17089
 17090
 17091* EXEC CICS READ
 17092*         DATASET('ELACTQ')
 17093*         RIDFLD (ELMSTR-KEY)
 17094*         SET    (ADDRESS OF ACTIVITY-QUE)
 17095*         UPDATE
 17096*     END-EXEC.
 17097     MOVE 'ELACTQ' TO DFHEIV1
 17098*    MOVE '&"S        EU         (   #00015878' TO DFHEIV0
 17099     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17100     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17101     MOVE X'2020233030303135383738' TO DFHEIV0(25:11)
 17102     CALL 'kxdfhei1' USING DFHEIV0,
 17103           DFHEIV1,
 17104           DFHEIV20,
 17105           DFHEIV99,
 17106           ELMSTR-KEY,
 17107           DFHEIV99,
 17108           DFHEIV99,
 17109           DFHEIV99
 17110     SET ADDRESS OF ACTIVITY-QUE TO
 17111         DFHEIV20
 17112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17113
 17114
 17115     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17116
 17117     IF PI-AIG-SPECIAL-BENEFIT AND
 17118        PI-CASH = 'Y'
 17119         ADD 2                   TO AQ-PAYMENT-COUNTER
 17120     ELSE
 17121         ADD 1                   TO AQ-PAYMENT-COUNTER.
 17122
 17123     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 17124         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 17125
 17126     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 17127
 17128     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 328
* EL156.cbl
 17129         IF WS-PMT-APPROVAL-SW = 'A'
 17130             NEXT SENTENCE
 17131         ELSE
 17132            IF PI-AIG-SPECIAL-BENEFIT AND
 17133               PI-CASH = 'Y'
 17134                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17135                                     WS-PMT-UNAPPROVED-CNT
 17136            ELSE
 17137                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17138                                     WS-PMT-UNAPPROVED-CNT
 17139     ELSE
 17140         IF PI-PMT-APPR-SW = 'Y'
 17141            IF PI-AIG-SPECIAL-BENEFIT AND
 17142               PI-CASH = 'Y'
 17143                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17144                                     WS-PMT-UNAPPROVED-CNT
 17145            ELSE
 17146                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17147                                     WS-PMT-UNAPPROVED-CNT.
 17148
 17149     IF WS-PMT-UNAPPROVED-CNT > ZERO
 17150         MOVE ER-3536 TO EMI-ERROR
 17151         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17152
 17153     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 17154
 17155
 17156* EXEC CICS REWRITE
 17157*         DATASET('ELACTQ')
 17158*         FROM   (ACTIVITY-QUE)
 17159*     END-EXEC.
 17160     MOVE LENGTH OF
 17161      ACTIVITY-QUE
 17162       TO DFHEIV11
 17163     MOVE 'ELACTQ' TO DFHEIV1
 17164*    MOVE '&& L                  %   #00015925' TO DFHEIV0
 17165     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17166     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17167     MOVE X'2020233030303135393235' TO DFHEIV0(25:11)
 17168     CALL 'kxdfhei1' USING DFHEIV0,
 17169           DFHEIV1,
 17170           ACTIVITY-QUE,
 17171           DFHEIV11,
 17172           DFHEIV99
 17173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17174
 17175
 17176     GO TO 6799-EXIT.
 17177
 17178 6720-BUILD-NEW-RECORD.
 17179
 17180* EXEC CICS GETMAIN
 17181*         SET    (ADDRESS OF ACTIVITY-QUE)
 17182*         LENGTH (60)
 17183*         INITIMG(GETMAIN-SPACE)
 17184*     END-EXEC.
 17185     MOVE 60
 17186       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 329
* EL156.cbl
 17187*    MOVE ',"IL                  $   #00015933' TO DFHEIV0
 17188     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17189     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17190     MOVE X'2020233030303135393333' TO DFHEIV0(25:11)
 17191     CALL 'kxdfhei1' USING DFHEIV0,
 17192           DFHEIV20,
 17193           DFHEIV11,
 17194           GETMAIN-SPACE
 17195     SET ADDRESS OF ACTIVITY-QUE TO
 17196         DFHEIV20
 17197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17198
 17199
 17200     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 17201
 17202     IF PI-AIG-SPECIAL-BENEFIT AND
 17203        PI-CASH = 'Y'
 17204         MOVE 2                  TO AQ-PAYMENT-COUNTER
 17205     ELSE
 17206         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 17207
 17208     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 17209     MOVE 'AQ'                   TO AQ-RECORD-ID.
 17210     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 17211     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 17212                                    AQ-FOLLOWUP-DATE.
 17213     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 17214     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 17215
 17216     IF PI-PMT-GRADUATED
 17217         IF WS-PMT-APPROVAL-SW = 'A'
 17218             NEXT SENTENCE
 17219         ELSE
 17220            IF PI-AIG-SPECIAL-BENEFIT AND
 17221               PI-CASH = 'Y'
 17222                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17223            ELSE
 17224                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 17225     ELSE
 17226         IF PI-PMT-APPR-SW = 'Y'
 17227            IF PI-AIG-SPECIAL-BENEFIT AND
 17228               PI-CASH = 'Y'
 17229                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 17230            ELSE
 17231                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 17232
 17233     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 17234         MOVE ER-3536 TO EMI-ERROR
 17235         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17236
 17237
 17238* EXEC CICS WRITE
 17239*         DATASET('ELACTQ')
 17240*         RIDFLD (ELMSTR-KEY)
 17241*         FROM   (ACTIVITY-QUE)
 17242*     END-EXEC.
 17243     MOVE LENGTH OF
 17244      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 330
* EL156.cbl
 17245       TO DFHEIV11
 17246     MOVE 'ELACTQ' TO DFHEIV1
 17247*    MOVE '&$ L                  ''   #00015976' TO DFHEIV0
 17248     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17249     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17250     MOVE X'2020233030303135393736' TO DFHEIV0(25:11)
 17251     CALL 'kxdfhei1' USING DFHEIV0,
 17252           DFHEIV1,
 17253           ACTIVITY-QUE,
 17254           DFHEIV11,
 17255           ELMSTR-KEY,
 17256           DFHEIV99,
 17257           DFHEIV99
 17258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17259
 17260
 17261 6799-EXIT.
 17262      EXIT.
 17263
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 331
* EL156.cbl
 17265 6800-BUILD-FORM-TRAILER.
 17266
 17267
 17268* EXEC CICS GETMAIN
 17269*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17270*         LENGTH   (200)
 17271*         INITIMG  (GETMAIN-SPACE)
 17272*    END-EXEC.
 17273     MOVE 200
 17274       TO DFHEIV11
 17275*    MOVE ',"IL                  $   #00015988' TO DFHEIV0
 17276     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17277     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17278     MOVE X'2020233030303135393838' TO DFHEIV0(25:11)
 17279     CALL 'kxdfhei1' USING DFHEIV0,
 17280           DFHEIV20,
 17281           DFHEIV11,
 17282           GETMAIN-SPACE
 17283     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17284         DFHEIV20
 17285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17286
 17287
 17288     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17289
 17290     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17291     MOVE 'AT'                   TO AT-RECORD-ID.
 17292     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17293
 17294     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17295     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17296                                    AT-FORM-LAST-MAINT-DT
 17297                                    AT-FORM-SEND-ON-DT.
 17298     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17299                                    AT-FORM-LAST-UPDATED-BY.
 17300     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17301     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17302     MOVE '6'                    TO DC-OPTION-CODE.
 17303     MOVE +29                    TO DC-ELAPSED-DAYS.
 17304     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17305     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17306     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17307
 17308     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17309         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17310
 17311     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17312                                    AT-FORM-RE-SEND-DT
 17313                                    AT-EMP-FORM-ANSWERED-DT
 17314                                    AT-PHY-FORM-ANSWERED-DT
 17315                                    AT-EMP-FORM-SEND-ON-DT
 17316                                    AT-PHY-FORM-SEND-ON-DT
 17317                                    AT-FORM-PRINTED-DT
 17318                                    AT-FORM-REPRINT-DT.
 17319     MOVE '2'                    TO AT-FORM-TYPE.
 17320
 17321     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17322     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 332
* EL156.cbl
 17323
 17324     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17325         NEXT SENTENCE
 17326     ELSE
 17327         IF CL-PROG-FORM-TYPE NOT = 'S'
 17328            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17329
 17330
 17331* EXEC CICS WRITE
 17332*         DATASET  ('ELTRLR')
 17333*         FROM     (ACTIVITY-TRAILERS)
 17334*         RIDFLD   (AT-CONTROL-PRIMARY)
 17335*     END-EXEC.
 17336     MOVE LENGTH OF
 17337      ACTIVITY-TRAILERS
 17338       TO DFHEIV11
 17339     MOVE 'ELTRLR' TO DFHEIV1
 17340*    MOVE '&$ L                  ''   #00016036' TO DFHEIV0
 17341     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17342     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17343     MOVE X'2020233030303136303336' TO DFHEIV0(25:11)
 17344     CALL 'kxdfhei1' USING DFHEIV0,
 17345           DFHEIV1,
 17346           ACTIVITY-TRAILERS,
 17347           DFHEIV11,
 17348           AT-CONTROL-PRIMARY,
 17349           DFHEIV99,
 17350           DFHEIV99
 17351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17352
 17353
 17354 6899-EXIT.
 17355      EXIT.
 17356
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 333
* EL156.cbl
 17358 6900-BUILD-ARCHIVE-HEADER.
 17359
 17360     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17361     MOVE '1'                    TO CNTL-REC-TYPE.
 17362     MOVE +0                     TO CNTL-SEQ-NO.
 17363     MOVE SPACES                 TO CNTL-ACCESS.
 17364
 17365
 17366* EXEC CICS READ
 17367*         DATASET  ('ELCNTL')
 17368*         SET      (ADDRESS OF CONTROL-FILE)
 17369*         RIDFLD   (ELCNTL-KEY)
 17370*         UPDATE
 17371*    END-EXEC.
 17372     MOVE 'ELCNTL' TO DFHEIV1
 17373*    MOVE '&"S        EU         (   #00016053' TO DFHEIV0
 17374     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17375     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17376     MOVE X'2020233030303136303533' TO DFHEIV0(25:11)
 17377     CALL 'kxdfhei1' USING DFHEIV0,
 17378           DFHEIV1,
 17379           DFHEIV20,
 17380           DFHEIV99,
 17381           ELCNTL-KEY,
 17382           DFHEIV99,
 17383           DFHEIV99,
 17384           DFHEIV99
 17385     SET ADDRESS OF CONTROL-FILE TO
 17386         DFHEIV20
 17387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17388
 17389
 17390     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17391     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17392
 17393
 17394* EXEC CICS REWRITE
 17395*         FROM     (CONTROL-FILE)
 17396*         DATASET  ('ELCNTL')
 17397*    END-EXEC.
 17398     MOVE LENGTH OF
 17399      CONTROL-FILE
 17400       TO DFHEIV11
 17401     MOVE 'ELCNTL' TO DFHEIV1
 17402*    MOVE '&& L                  %   #00016063' TO DFHEIV0
 17403     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17404     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17405     MOVE X'2020233030303136303633' TO DFHEIV0(25:11)
 17406     CALL 'kxdfhei1' USING DFHEIV0,
 17407           DFHEIV1,
 17408           CONTROL-FILE,
 17409           DFHEIV11,
 17410           DFHEIV99
 17411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17412
 17413
 17414
 17415* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 334
* EL156.cbl
 17416*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17417*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17418*    END-EXEC.
 17419*    MOVE '"$$%                  ! 7 #00016068' TO DFHEIV0
 17420     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17422     MOVE X'3720233030303136303638' TO DFHEIV0(25:11)
 17423     CALL 'kxdfhei1' USING DFHEIV0
 17424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17425
 17426
 17427
 17428* EXEC CICS GETMAIN
 17429*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17430*         LENGTH  (ELARCH-LENGTH)
 17431*         INITIMG (GETMAIN-SPACE)
 17432*    END-EXEC.
 17433*    MOVE ',"IL                  $   #00016073' TO DFHEIV0
 17434     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17435     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17436     MOVE X'2020233030303136303733' TO DFHEIV0(25:11)
 17437     CALL 'kxdfhei1' USING DFHEIV0,
 17438           DFHEIV20,
 17439           ELARCH-LENGTH,
 17440           GETMAIN-SPACE
 17441     SET ADDRESS OF LETTER-ARCHIVE TO
 17442         DFHEIV20
 17443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17444
 17445
 17446     MOVE 'LA'                   TO LA-RECORD-ID.
 17447     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17448                                    LA-ARCHIVE-NO-A1.
 17449     MOVE '4'                    TO LA-RECORD-TYPE
 17450                                    LA-RECORD-TYPE-A1.
 17451     MOVE +0                     TO LA-LINE-SEQ-NO
 17452                                    LA-LINE-SEQ-NO-A1.
 17453     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17454                                    LA-COMPANY-CD-A1.
 17455     MOVE CL-CARRIER             TO LA4-CARRIER.
 17456     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17457     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17458     MOVE CL-CERT-STATE          TO LA4-STATE.
 17459     MOVE +0                     TO LA4-NO-OF-COPIES.
 17460     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17461     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17462     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17463                                    LA4-INITIAL-PRINT-DATE
 17464                                    LA4-RESEND-PRINT-DATE
 17465                                    LA4-FORM-REM-PRINT-DT.
 17466     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17467     MOVE '2'                    TO LA4-FORM-TYPE.
 17468
 17469
 17470* EXEC CICS WRITE
 17471*         DATASET  ('ELARCH')
 17472*         FROM     (LETTER-ARCHIVE)
 17473*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 335
* EL156.cbl
 17474*    END-EXEC.
 17475     MOVE LENGTH OF
 17476      LETTER-ARCHIVE
 17477       TO DFHEIV11
 17478     MOVE 'ELARCH' TO DFHEIV1
 17479*    MOVE '&$ L                  ''   #00016102' TO DFHEIV0
 17480     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17481     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17482     MOVE X'2020233030303136313032' TO DFHEIV0(25:11)
 17483     CALL 'kxdfhei1' USING DFHEIV0,
 17484           DFHEIV1,
 17485           LETTER-ARCHIVE,
 17486           DFHEIV11,
 17487           LA-CONTROL-PRIMARY,
 17488           DFHEIV99,
 17489           DFHEIV99
 17490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17491
 17492
 17493 6999-EXIT.
 17494      EXIT.
 17495
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 336
* EL156.cbl
 17497 7000-SHOW-CLAIM.
 17498     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17499     MOVE 'A'                    TO PI-PASS-SW.
 17500     MOVE LOW-VALUES             TO PI-CPYFROM
 17501                                    PI-MONTH-END-SAVE
 17502                                    PI-CPYTHRU.
 17503
 17504     MOVE ZEROS                  TO PI-FATAL-COUNT
 17505                                    PI-DAILY-RATE
 17506                                    PI-BEN-DAYS
 17507                                    PI-MANUAL-SW
 17508                                    PI-SAVE-CURSOR
 17509                                    PI-FORCE-COUNT
 17510                                    PI-HOLDTIL
 17511                                    PI-EPYFROM
 17512                                    PI-EPYTHRU
 17513                                    PI-EDAYS
 17514                                    PI-EPYAMT
 17515                                    PI-ERESV
 17516                                    PI-EEXPENS
 17517                                    PI-CDAYS
 17518                                    PI-CPYAMT
 17519                                    PI-CRESV
 17520                                    PI-CEXPENS
 17521                                    PI-INT-RATE
 17522                                    PI-AIGFROM.
 17523     MOVE ZEROS                  TO PI-PROOF-DATE.
 17524     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17525                                    PI-REM-BEN-AMT
 17526                                    PI-MO-BEN-AMT
 17527                                    pi-ah-term.
 17528
 17529     MOVE LOW-VALUES             TO EL156AI.
 17530     MOVE MAP-NAMEA              TO MAP-NAME.
 17531
 17532* EXEC CICS HANDLE CONDITION
 17533*        NOTFND   (7010-BUILD-MAP)
 17534*    END-EXEC.
 17535*    MOVE '"$I                   ! 8 #00016146' TO DFHEIV0
 17536     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17537     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17538     MOVE X'3820233030303136313436' TO DFHEIV0(25:11)
 17539     CALL 'kxdfhei1' USING DFHEIV0
 17540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17541
 17542
 17543     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17544     MOVE '2'                    TO CNTL-REC-TYPE.
 17545     MOVE +0                     TO CNTL-SEQ-NO.
 17546     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17547
 17548
 17549* EXEC CICS READ
 17550*         DATASET  ('ELCNTL')
 17551*         SET      (ADDRESS OF CONTROL-FILE)
 17552*         RIDFLD   (ELCNTL-KEY)
 17553*    END-EXEC.
 17554     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 337
* EL156.cbl
 17555*    MOVE '&"S        E          (   #00016155' TO DFHEIV0
 17556     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17557     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17558     MOVE X'2020233030303136313535' TO DFHEIV0(25:11)
 17559     CALL 'kxdfhei1' USING DFHEIV0,
 17560           DFHEIV1,
 17561           DFHEIV20,
 17562           DFHEIV99,
 17563           ELCNTL-KEY,
 17564           DFHEIV99,
 17565           DFHEIV99,
 17566           DFHEIV99
 17567     SET ADDRESS OF CONTROL-FILE TO
 17568         DFHEIV20
 17569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17570
 17571
 17572     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17573
 17574     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17575         MOVE AL-UANON      TO SURVYYNA
 17576     END-IF.
 17577
 17578
 17579     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17580     MOVE '1'                    TO CNTL-REC-TYPE.
 17581     MOVE SPACES                 TO CNTL-ACCESS.
 17582     MOVE +0                     TO CNTL-SEQ-NO.
 17583
 17584
 17585* EXEC CICS READ
 17586*         DATASET  ('ELCNTL')
 17587*         SET      (ADDRESS OF CONTROL-FILE)
 17588*         RIDFLD   (ELCNTL-KEY)
 17589*    END-EXEC.
 17590     MOVE 'ELCNTL' TO DFHEIV1
 17591*    MOVE '&"S        E          (   #00016173' TO DFHEIV0
 17592     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17593     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17594     MOVE X'2020233030303136313733' TO DFHEIV0(25:11)
 17595     CALL 'kxdfhei1' USING DFHEIV0,
 17596           DFHEIV1,
 17597           DFHEIV20,
 17598           DFHEIV99,
 17599           ELCNTL-KEY,
 17600           DFHEIV99,
 17601           DFHEIV99,
 17602           DFHEIV99
 17603     SET ADDRESS OF CONTROL-FILE TO
 17604         DFHEIV20
 17605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17606
 17607
 17608     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17609
 17610 7010-BUILD-MAP.
 17611
 17612
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 338
* EL156.cbl
 17613* EXEC CICS HANDLE CONDITION
 17614*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17615*    END-EXEC.
 17616*    MOVE '"$I                   ! 9 #00016183' TO DFHEIV0
 17617     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17619     MOVE X'3920233030303136313833' TO DFHEIV0(25:11)
 17620     CALL 'kxdfhei1' USING DFHEIV0
 17621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17622
 17623
 17624     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17625     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17626     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17627     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17628     MOVE 'MSTR'                 TO FILE-SWITCH.
 17629
 17630     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17631
 17632     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17633     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17634     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17635     MOVE CL-CCN                 TO PI-SV-CCN.
 17636
 17637     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17638     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17639     MOVE CL-CLAIM-NO            TO CLMNOO.
 17640     MOVE CL-CARRIER             TO CARRO.
 17641     MOVE CL-CERT-PRIME          TO CERTNOO.
 17642     MOVE CL-CERT-SFX            TO SUFXO.
 17643
 17644     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17645        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17646        CONTINUE
 17647     ELSE
 17648        MOVE AL-SADOF            TO ZINTHA
 17649                                    ZINTA
 17650                                    PINTHA
 17651                                    PINTA
 17652     END-IF
 17653     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17654     EVALUATE TRUE
 17655     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17656         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17657     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17658         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17659
 17660     WHEN CL-CLAIM-TYPE = 'I'
 17661         MOVE '  IU  '           TO CLMTYPO
 17662     WHEN CL-CLAIM-TYPE = 'G'
 17663         MOVE ' GAP  '           TO CLMTYPO
 17664     WHEN CL-CLAIM-TYPE = 'F'
 17665         MOVE ' FMLA '           TO CLMTYPO
 17666     END-EVALUATE.
 17667     IF CLAIM-IS-OPEN
 17668         MOVE ' OPEN'            TO CLMSTATO
 17669     ELSE
 17670         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 339
* EL156.cbl
 17671
 17672     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17673
 17674     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17675         MOVE SPACES             TO  PCERTNOO
 17676                                     PSUFXO
 17677                                     PRIMHDGO
 17678                                     SEQUO
 17679         MOVE AL-SADOF           TO  PCERTNOA
 17680                                     PSUFXA
 17681                                     PRIMHDGA
 17682                                     SEQUA
 17683     ELSE
 17684         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17685         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17686         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17687         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17688         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17689         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17690         MOVE AL-SANON               TO  PCERTNOA
 17691                                         PSUFXA
 17692                                         PRIMHDGA
 17693         MOVE AL-SABON               TO  SEQUA.
 17694
 17695     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17696
 17697     IF CL-NO-OF-PMTS-MADE = 0 AND
 17698        CL-TOTAL-PAID-AMT = 0
 17699         NEXT SENTENCE
 17700     ELSE
 17701         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17702             IF NOT PI-USES-PAID-TO
 17703                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17704                 MOVE ' '                 TO DC-OPTION-CODE
 17705                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17706                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17707             ELSE
 17708                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17709                 MOVE '6'                 TO DC-OPTION-CODE
 17710                 MOVE +1                  TO DC-ELAPSED-DAYS
 17711                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17712                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17713                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17714
 17715     IF MAP-NAME = 'EL156A'
 17716        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17717           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17718             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17719           end-if
 17720        end-if
 17721     end-if
 17722     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17723         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17724         MOVE ' '                TO DC-OPTION-CODE
 17725         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17726         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17727
 17728     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 340
* EL156.cbl
 17729         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17730         MOVE ' '                TO DC-OPTION-CODE
 17731         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17732         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17733
 17734     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17735
 17736     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17737         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17738         MOVE ' '                TO DC-OPTION-CODE
 17739         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17740         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17741
 17742     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17743         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17744         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17745     ELSE
 17746         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17747         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17748
 17749     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17750     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17751     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17752     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17753                                    PI-GROUPING.
 17754     MOVE CL-CERT-STATE          TO CERT-STATE
 17755                                    PI-STATE.
 17756     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17757                                    PI-ACCOUNT.
 17758     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17759     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17760     MOVE 'CERT'                 TO FILE-SWITCH.
 17761
 17762     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17763     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17764        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17765        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17766            MOVE 'N' TO PI-JOINT-INSURED-IND
 17767     ELSE
 17768            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17769     END-IF.
 17770
 17771     perform 7975-read-acct      thru 7975-exit
 17772     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17773     MOVE PI-STATE               TO WS-ST-ACCESS.
 17774     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17775     MOVE '3'                    TO CNTL-REC-TYPE.
 17776     MOVE +0                     TO CNTL-SEQ-NO.
 17777     MOVE 'STAT'                 TO FILE-SWITCH.
 17778
 17779     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17780
 17781     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17782     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17783
 17784     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17785        GO TO 7020-BYPASS-BENEFIT.
 17786
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 341
* EL156.cbl
 17787     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17788     MOVE '4'                    TO CNTL-REC-TYPE.
 17789     MOVE +0                     TO CNTL-SEQ-NO.
 17790     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17791     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17792     MOVE 'BENE'                 TO FILE-SWITCH.
 17793
 17794     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17795
 17796     IF NO-BENEFIT-FOUND
 17797        GO TO 7020-BYPASS-BENEFIT.
 17798
 17799     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17800     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17801     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17802
 17803 7020-BYPASS-BENEFIT.
 17804
 17805*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17806*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17807*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17808
 17809     move zeros                  to PI-MAX-BENEFIT-AMT
 17810     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17811     move cm-ah-orig-term        to pi-ah-term
 17812     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17813     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17814          'G' and 'F'
 17815         GO TO 7021-GO-TO-LIFE.
 17816
 17817     IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 17818        and (acct-found)
 17819        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17820        PERFORM 0900-GET-DDF-limits
 17821                                 THRU 0900-EXIT
 17822        IF PDEF-FOUND
 17823           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17824              (P1 > +8)
 17825              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17826           END-PERFORM
 17827           IF P1 < +9
 17828              if pd-ben-pct (p1) not numeric
 17829                 move zeros      to pd-ben-pct (p1)
 17830              end-if
 17831              if pd-ben-pct (p1) = zeros
 17832                 move +1         to ws-work-ben-pct
 17833              else
 17834                 move pd-ben-pct (p1)
 17835                                 to ws-work-ben-pct
 17836              end-if
 17837              compute cm-ah-benefit-amt =
 17838                 cm-ah-benefit-amt * ws-work-ben-pct
 17839              move pd-max-amt (p1) to pi-max-benefit-amt
 17840           END-IF
 17841        END-IF
 17842     end-if
 17843     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17844     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 342
* EL156.cbl
 17845     if (pi-max-benefit-amt not = zeros)
 17846        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17847        move pi-max-benefit-amt  to beneo
 17848     else
 17849        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17850     end-if
 17851     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17852     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17853                                    CP-ORIGINAL-TERM.
 17854     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17855
 17856*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17857*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17858*    ELSE
 17859         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17860
 17861     MOVE ' '                    TO DC-OPTION-CODE.
 17862     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17863     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17864
 17865     IF PI-COMPANY-ID = 'DMD'
 17866         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17867         GO TO 7023-BYPASS-REMAINING-TERM.
 17868
 17869     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17870     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17871     GO TO 7022-AROUND-LIFE.
 17872
 17873 7021-GO-TO-LIFE.
 17874
 17875     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17876     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17877     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17878                                    CP-ORIGINAL-TERM.
 17879     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17880     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17881     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17882     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17883
 17884     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17885         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17886     ELSE
 17887         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17888
 17889     MOVE ' '                    TO DC-OPTION-CODE.
 17890     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17891     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17892
 17893 7022-AROUND-LIFE.
 17894
 17895     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17896     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17897     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17898     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17899     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17900     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17901     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17902
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 343
* EL156.cbl
 17903     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17904
 17905     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17906        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17907           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17908
 17909     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17910        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17911           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17912
 17913 7023-BYPASS-REMAINING-TERM.
 17914     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17915       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17916          MOVE ZEROS                  TO BENEO
 17917       ELSE
 17918          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17919          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17920          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17921          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17922          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17923          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17924          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17925          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17926          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17927          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17928          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17929          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17930          IF (PI-COMPANY-ID = 'DCC' or 'VPP')
 17931             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17932             PERFORM 0900-GET-DDF-limits
 17933                                 THRU 0900-EXIT
 17934             IF PDEF-FOUND
 17935                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17936                   (P1 > +8)
 17937                   OR (PD-PROD-CODE (P1) = 'L')
 17938                END-PERFORM
 17939                IF P1 < +9
 17940                   MOVE PD-MAX-AMT (P1)
 17941                                 TO CP-R-MAX-TOT-BEN
 17942                END-IF
 17943             END-IF
 17944          END-IF
 17945
 17946* EXEC CICS LINK
 17947*            PROGRAM  (LINK-REMAMT)
 17948*            COMMAREA (CALCULATION-PASS-AREA)
 17949*            LENGTH   (CP-COMM-LENGTH)
 17950*         END-EXEC
 17951*    MOVE '."C                   (   #00016508' TO DFHEIV0
 17952     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17953     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17954     MOVE X'2020233030303136353038' TO DFHEIV0(25:11)
 17955     CALL 'kxdfhei1' USING DFHEIV0,
 17956           LINK-REMAMT,
 17957           CALCULATION-PASS-AREA,
 17958           CP-COMM-LENGTH,
 17959           DFHEIV99,
 17960           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 344
* EL156.cbl
 17961           DFHEIV99,
 17962           DFHEIV99
 17963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17964          MOVE CP-REMAINING-AMT       TO BENEO
 17965       end-if
 17966     end-if
 17967     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17968     MOVE +95                    TO TRLR-SEQ-NO
 17969
 17970* EXEC CICS READ
 17971*       DATASET  ('ELTRLR')
 17972*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17973*       RIDFLD   (ELTRLR-KEY)
 17974*       RESP     (WS-RESPONSE)
 17975*    END-EXEC
 17976     MOVE 'ELTRLR' TO DFHEIV1
 17977*    MOVE '&"S        E          (  N#00016518' TO DFHEIV0
 17978     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17979     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17980     MOVE X'204E233030303136353138' TO DFHEIV0(25:11)
 17981     CALL 'kxdfhei1' USING DFHEIV0,
 17982           DFHEIV1,
 17983           DFHEIV20,
 17984           DFHEIV99,
 17985           ELTRLR-KEY,
 17986           DFHEIV99,
 17987           DFHEIV99,
 17988           DFHEIV99
 17989     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17990         DFHEIV20
 17991     MOVE EIBRESP  TO WS-RESPONSE
 17992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17993
 17994     if ws-resp-normal
 17995        perform varying s1 from +1 by +1 until
 17996           at-note-error-no (s1) = spaces
 17997           move at-note-error-no (s1)
 17998                                 to emi-error
 17999           if at-note-error-no (s1) = '1653'
 18000              evaluate true
 18001                 when cl-claim-type = 'L'
 18002                    move '  LF  '
 18003                                 to emi-claim-type
 18004                 when cl-claim-type = 'I'
 18005                    move '  IU  '
 18006                                 to emi-claim-type
 18007                 when cl-claim-type = 'F'
 18008                    move ' FMLA '
 18009                                 to emi-claim-type
 18010                 when other
 18011                    move '  AH  '
 18012                                 to emi-claim-type
 18013              end-evaluate
 18014           end-if
 18015           PERFORM 9900-ERROR-FORMAT
 18016                                 THRU 9900-EXIT
 18017        end-perform
 18018     end-if
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 345
* EL156.cbl
 18019     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 18020         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 18021            WS-LF-COVERAGE-TYPE = 'P'
 18022             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 18023                                        CM-LF-ITD-DEATH-AMT
 18024             MOVE WS-REMAINING-AMT  TO  BENEO.
 18025
 18026     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 18027     MOVE BENEO                  TO PI-REM-BEN-AMT.
 18028     MOVE WS-TERMS               TO TERMSO.
 18029
 18030     IF WS-STATUS = '6' OR '7' OR '8'
 18031         MOVE AL-SABOF           TO CRTSTATA.
 18032
 18033     IF WS-STATUS = '1' OR '4'
 18034        IF CP-REMAINING-TERM-3 = ZEROS
 18035           MOVE 'EXPIRED'        TO CRTSTATO
 18036        ELSE
 18037           MOVE 'ACTIVE  '       TO CRTSTATO.
 18038
 18039     IF WS-STATUS = '2'
 18040         MOVE 'PEND    '         TO CRTSTATO.
 18041
 18042     IF WS-STATUS = '3'
 18043         MOVE 'RESTORE '         TO CRTSTATO.
 18044
 18045     IF WS-STATUS = '5'
 18046         MOVE 'REISSUE '         TO CRTSTATO.
 18047
 18048     IF WS-STATUS = '6'
 18049         MOVE 'LMP DIS'          TO CRTSTATO.
 18050
 18051     IF WS-STATUS = '7'
 18052         MOVE 'DEATH'            TO CRTSTATO.
 18053
 18054     IF WS-STATUS = '8'
 18055         MOVE 'CANCEL'           TO CRTSTATO.
 18056
 18057     IF WS-STATUS = '9'
 18058         MOVE 'RE-ONLY '         TO CRTSTATO.
 18059
 18060     IF WS-STATUS = 'V'
 18061         MOVE 'VOID  '           TO CRTSTATO.
 18062
 18063     IF WS-STATUS = 'D'
 18064         MOVE 'DECLINE '         TO CRTSTATO.
 18065
 18066     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 18067         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 18068         MOVE '5'                TO CNTL-REC-TYPE
 18069     ELSE
 18070         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 18071         MOVE '4'                TO CNTL-REC-TYPE.
 18072
 18073     MOVE '** NONE **'           TO COVERO.
 18074     MOVE AL-SABON               TO COVERA.
 18075
 18076     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 346
* EL156.cbl
 18077         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 18078             MOVE CM-BENEFICIARY TO LOANNOO
 18079             MOVE AL-UANON       TO LOANNOA.
 18080
 18081     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 18082        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 18083        MOVE +91                 TO  TRLR-SEQ-NO
 18084
 18085* EXEC CICS READ
 18086*           DATASET  ('ELTRLR')
 18087*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18088*           RIDFLD   (ELTRLR-KEY)
 18089*           RESP     (WS-RESPONSE)
 18090*       END-EXEC
 18091     MOVE 'ELTRLR' TO DFHEIV1
 18092*    MOVE '&"S        E          (  N#00016615' TO DFHEIV0
 18093     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18094     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18095     MOVE X'204E233030303136363135' TO DFHEIV0(25:11)
 18096     CALL 'kxdfhei1' USING DFHEIV0,
 18097           DFHEIV1,
 18098           DFHEIV20,
 18099           DFHEIV99,
 18100           ELTRLR-KEY,
 18101           DFHEIV99,
 18102           DFHEIV99,
 18103           DFHEIV99
 18104     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18105         DFHEIV20
 18106     MOVE EIBRESP  TO WS-RESPONSE
 18107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18108
 18109        IF WS-RESP-NORMAL
 18110           MOVE AT-INFO-LINE-1   TO  LOANNOO
 18111        ELSE
 18112           MOVE SPACES           TO  LOANNOO
 18113        END-IF
 18114*052506
 18115*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 18116*052506
 18117     END-IF
 18118
 18119     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 18120        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 18121
 18122     IF WS-BEN-CD = ZEROS
 18123         GO TO 7050-SHOW-CONTINUE.
 18124
 18125     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 18126     MOVE WS-ACCESS              TO CNTL-ACCESS.
 18127     MOVE +0                     TO CNTL-SEQ-NO.
 18128     MOVE 'BENE'                 TO FILE-SWITCH.
 18129
 18130     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 18131     IF BENEFIT-FOUND
 18132        MOVE CF-JOINT-INDICATOR (SUB-1)
 18133                                 TO PI-JOINT-COV-IND
 18134                                    PI-RB-JOINT-COV-IND
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 347
* EL156.cbl
 18135        MOVE CF-BENEFIT-DESCRIP (SUB-1)
 18136                                 TO COVERO
 18137        MOVE AL-SANON            TO COVERA
 18138     END-IF
 18139     if (cntl-rec-type = '4')   *> Life claim
 18140        and (cm-ah-benefit-cd not = zeros) *> AH coverage
 18141        MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
 18142        MOVE CM-AH-BENEFIT-CD TO WS-BEN-CD
 18143        MOVE '5'              TO CNTL-REC-TYPE
 18144        MOVE WS-ACCESS        TO CNTL-ACCESS
 18145        MOVE +0               TO CNTL-SEQ-NO
 18146        MOVE 'BENE'           TO FILE-SWITCH
 18147        PERFORM 7200-FIND-BENEFIT
 18148                              THRU 7200-EXIT
 18149        IF (BENEFIT-FOUND)
 18150           and (pi-rb-joint-cov-ind) not = 'J'
 18151           MOVE CF-JOINT-INDICATOR (SUB-1)
 18152                              TO PI-rb-JOINT-COV-IND
 18153        end-if
 18154     end-if
 18155     .
 18156 7050-SHOW-CONTINUE.
 18157
 18158     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 18159        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 18160            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 18161     END-IF
 18162
 18163     IF PI-COMPANY-ID = 'DMD'
 18164         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 18165
 18166     MOVE -1                     TO PMTTYPEL.
 18167     GO TO 8100-SEND-INITIAL-MAP.
 18168
 18169 7100-SHOW-RECORD-NOT-FOUND.
 18170     IF FILE-SWITCH = 'MSTR'
 18171         MOVE ER-0204            TO EMI-ERROR.
 18172
 18173     IF FILE-SWITCH = 'CERT'
 18174         MOVE ER-0206            TO EMI-ERROR.
 18175
 18176     IF FILE-SWITCH = 'STAT'
 18177         MOVE ER-0149            TO EMI-ERROR.
 18178
 18179     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18180
 18181     MOVE -1                     TO PMTTYPEL.
 18182     GO TO 8100-SEND-INITIAL-MAP
 18183
 18184     .
 18185 7110-BUILD-PMT-TRLR.
 18186     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 18187     MOVE +51                    TO TRLR-SEQ-NO
 18188
 18189* EXEC CICS READ
 18190*        DATASET  ('ELTRLR')
 18191*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 18192*        RIDFLD   (ELTRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 348
* EL156.cbl
 18193*        RESP     (WS-RESPONSE)
 18194*    END-EXEC
 18195     MOVE 'ELTRLR' TO DFHEIV1
 18196*    MOVE '&"S        E          (  N#00016701' TO DFHEIV0
 18197     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18198     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18199     MOVE X'204E233030303136373031' TO DFHEIV0(25:11)
 18200     CALL 'kxdfhei1' USING DFHEIV0,
 18201           DFHEIV1,
 18202           DFHEIV20,
 18203           DFHEIV99,
 18204           ELTRLR-KEY,
 18205           DFHEIV99,
 18206           DFHEIV99,
 18207           DFHEIV99
 18208     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18209         DFHEIV20
 18210     MOVE EIBRESP  TO WS-RESPONSE
 18211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18212     IF WS-RESP-NORMAL
 18213        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
 18214     END-IF
 18215     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 18216
 18217* EXEC CICS GETMAIN
 18218*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18219*         LENGTH    (200)
 18220*         INITIMG   (GETMAIN-SPACE)
 18221*     END-EXEC
 18222     MOVE 200
 18223       TO DFHEIV11
 18224*    MOVE ',"IL                  $   #00016711' TO DFHEIV0
 18225     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18226     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18227     MOVE X'2020233030303136373131' TO DFHEIV0(25:11)
 18228     CALL 'kxdfhei1' USING DFHEIV0,
 18229           DFHEIV20,
 18230           DFHEIV11,
 18231           GETMAIN-SPACE
 18232     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18233         DFHEIV20
 18234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18235     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 18236                                    AT-PREV-PAID-THRU-DT
 18237     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 18238     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18239     MOVE 'AT'                   TO AT-RECORD-ID
 18240     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18241     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 18242     MOVE '2'                    TO AT-TRAILER-TYPE
 18243     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18244                                    AT-PAYMENT-LAST-MAINT-DT
 18245     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18246                                    AT-PAYMENT-LAST-UPDATED-BY
 18247     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18248     MOVE 'I'                    TO AT-PAYMENT-TYPE
 18249     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 18250     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 349
* EL156.cbl
 18251     MOVE +0                     TO AT-EXPENSE-PER-PMT
 18252     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 18253     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 18254     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 18255     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 18256     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 18257     if pi-int-to-rem-borr = 'Y'
 18258        move 'Q1'                to at-payee-type-cd
 18259     else
 18260        MOVE 'O1'                TO AT-PAYEE-TYPE-CD
 18261     end-if
 18262     MOVE PI-int-payees-name     TO AT-PAYEES-NAME
 18263     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 18264     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 18265     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 18266     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 18267                                    AT-TO-BE-WRITTEN-DT
 18268     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 18269                                    AT-CHECK-QUE-SEQUENCE
 18270                                    AT-ADDL-RESERVE
 18271     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 18272                                    AT-VOID-SELECT-DT
 18273                                    AT-VOID-ACCEPT-DT
 18274                                    AT-VOID-DT
 18275                                    AT-PMT-PROOF-DT
 18276                                    AT-INT-PMT-SELECT-DT
 18277     MOVE ZEROS                  TO AT-DAILY-RATE
 18278                                    AT-ELIMINATION-DAYS
 18279     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18280*    EXEC CICS HANDLE CONDITION
 18281*        DUPREC    (7120-DUPREC)
 18282*    END-EXEC
 18283     .
 18284 7115-WRITE-INT-TRLR.
 18285
 18286* EXEC CICS WRITE
 18287*         DATASET       ('ELTRLR')
 18288*         FROM          (ACTIVITY-TRAILERS)
 18289*         RIDFLD        (AT-CONTROL-PRIMARY)
 18290*         RESP          (WS-RESPONSE)
 18291*     END-EXEC
 18292     MOVE LENGTH OF
 18293      ACTIVITY-TRAILERS
 18294       TO DFHEIV11
 18295     MOVE 'ELTRLR' TO DFHEIV1
 18296*    MOVE '&$ L                  ''  N#00016766' TO DFHEIV0
 18297     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18298     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18299     MOVE X'204E233030303136373636' TO DFHEIV0(25:11)
 18300     CALL 'kxdfhei1' USING DFHEIV0,
 18301           DFHEIV1,
 18302           ACTIVITY-TRAILERS,
 18303           DFHEIV11,
 18304           AT-CONTROL-PRIMARY,
 18305           DFHEIV99,
 18306           DFHEIV99
 18307     MOVE EIBRESP  TO WS-RESPONSE
 18308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 350
* EL156.cbl
 18309      IF WS-RESP-DUPREC
 18310         GO TO 7120-DUPREC
 18311      END-IF
 18312     GO TO 7130-EXIT
 18313     .
 18314 7120-DUPREC.
 18315     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18316     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18317     GO TO 7115-WRITE-INT-TRLR
 18318     .
 18319 7130-EXIT.
 18320      EXIT.
 18321 7140-BUILD-NOTE-TRLR.
 18322
 18323
 18324* EXEC CICS GETMAIN
 18325*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18326*         LENGTH    (200)
 18327*         INITIMG   (GETMAIN-SPACE)
 18328*     END-EXEC
 18329     MOVE 200
 18330       TO DFHEIV11
 18331*    MOVE ',"IL                  $   #00016786' TO DFHEIV0
 18332     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18333     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18334     MOVE X'2020233030303136373836' TO DFHEIV0(25:11)
 18335     CALL 'kxdfhei1' USING DFHEIV0,
 18336           DFHEIV20,
 18337           DFHEIV11,
 18338           GETMAIN-SPACE
 18339     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18340         DFHEIV20
 18341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18342     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18343     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18344     MOVE 'AT'                   TO AT-RECORD-ID
 18345     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18346     MOVE '6'                    TO AT-TRAILER-TYPE
 18347     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18348                                    AT-GEN-INFO-LAST-MAINT-DT
 18349     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18350                                    AT-GEN-INFO-LAST-UPDATED-BY
 18351     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18352     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18353     .
 18354 7150-WRITE.
 18355
 18356* EXEC CICS HANDLE CONDITION
 18357*        DUPREC    (7160-DUPREC)
 18358*    END-EXEC
 18359*    MOVE '"$%                   ! : #00016804' TO DFHEIV0
 18360     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18362     MOVE X'3A20233030303136383034' TO DFHEIV0(25:11)
 18363     CALL 'kxdfhei1' USING DFHEIV0
 18364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18365
 18366* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 351
* EL156.cbl
 18367*         DATASET     ('ELTRLR')
 18368*         FROM        (ACTIVITY-TRAILERS)
 18369*         RIDFLD      (AT-CONTROL-PRIMARY)
 18370*         RESP        (WS-RESPONSE)
 18371*     END-EXEC
 18372     MOVE LENGTH OF
 18373      ACTIVITY-TRAILERS
 18374       TO DFHEIV11
 18375     MOVE 'ELTRLR' TO DFHEIV1
 18376*    MOVE '&$ L                  ''  N#00016807' TO DFHEIV0
 18377     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18378     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18379     MOVE X'204E233030303136383037' TO DFHEIV0(25:11)
 18380     CALL 'kxdfhei1' USING DFHEIV0,
 18381           DFHEIV1,
 18382           ACTIVITY-TRAILERS,
 18383           DFHEIV11,
 18384           AT-CONTROL-PRIMARY,
 18385           DFHEIV99,
 18386           DFHEIV99
 18387     MOVE EIBRESP  TO WS-RESPONSE
 18388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18389      IF WS-RESP-DUPREC
 18390         GO TO 7160-DUPREC
 18391      END-IF
 18392     GO TO 7170-EXIT
 18393     .
 18394 7160-DUPREC.
 18395     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18396     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18397     GO TO 7150-WRITE
 18398     .
 18399 7170-EXIT.
 18400      EXIT.
 18401
 18402 7180-ADD-CERT-NOTE.
 18403*ADD CERT NOTE FOR SC NP+6
 18404
 18405
 18406* EXEC CICS GETMAIN
 18407*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18408*         LENGTH    (150)
 18409*         INITIMG   (GETMAIN-SPACE)
 18410*     END-EXEC.
 18411     MOVE 150
 18412       TO DFHEIV11
 18413*    MOVE ',"IL                  $   #00016829' TO DFHEIV0
 18414     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18415     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18416     MOVE X'2020233030303136383239' TO DFHEIV0(25:11)
 18417     CALL 'kxdfhei1' USING DFHEIV0,
 18418           DFHEIV20,
 18419           DFHEIV11,
 18420           GETMAIN-SPACE
 18421     SET ADDRESS OF CERT-NOTE-FILE TO
 18422         DFHEIV20
 18423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18424
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 352
* EL156.cbl
 18425
 18426     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18427     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18428     MOVE +1                     TO WRK-NOTE-SEQ.
 18429     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18430     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18431     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18432     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18433     MOVE CL-CERT-STATE          TO CZ-STATE.
 18434     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18435     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18436     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18437     MOVE '2'                    TO CZ-RECORD-TYPE.
 18438     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18439     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18440     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18441     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18442     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18443     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18444     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18445     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18446     IF PI-COMPANY-ID = 'AHL'
 18447        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18448           CONTINUE
 18449        ELSE
 18450           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18451              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18452           ELSE
 18453              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18454           END-IF
 18455        END-IF
 18456     END-IF
 18457     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18458     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18459
 18460 7181-WRITE.
 18461
 18462
 18463* EXEC CICS WRITE
 18464*         DATASET     ('ERCNOT')
 18465*         FROM        (CERT-NOTE-FILE)
 18466*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18467*         RESP        (WS-RESPONSE)
 18468*    END-EXEC.
 18469     MOVE LENGTH OF
 18470      CERT-NOTE-FILE
 18471       TO DFHEIV11
 18472     MOVE 'ERCNOT' TO DFHEIV1
 18473*    MOVE '&$ L                  ''  N#00016871' TO DFHEIV0
 18474     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18475     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18476     MOVE X'204E233030303136383731' TO DFHEIV0(25:11)
 18477     CALL 'kxdfhei1' USING DFHEIV0,
 18478           DFHEIV1,
 18479           CERT-NOTE-FILE,
 18480           DFHEIV11,
 18481           CZ-CONTROL-PRIMARY,
 18482           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 353
* EL156.cbl
 18483           DFHEIV99
 18484     MOVE EIBRESP  TO WS-RESPONSE
 18485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18486
 18487
 18488     IF WS-RESP-DUPREC
 18489         GO TO 7182-DUPREC
 18490     END-IF.
 18491
 18492     SET CERT-NOTE-ADDED TO TRUE.
 18493
 18494     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18495         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18496     END-IF.
 18497
 18498     GO TO 7189-EXIT.
 18499
 18500 7182-DUPREC.
 18501
 18502     ADD +1                      TO  WRK-NOTE-SEQ.
 18503     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18504     GO TO 7181-WRITE.
 18505
 18506 7189-EXIT.
 18507      EXIT.
 18508
 18509 7190-ADD-ORIG-NOTE.
 18510
 18511
 18512* EXEC CICS GETMAIN
 18513*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18514*         LENGTH    (150)
 18515*         INITIMG   (GETMAIN-SPACE)
 18516*     END-EXEC.
 18517     MOVE 150
 18518       TO DFHEIV11
 18519*    MOVE ',"IL                  $   #00016901' TO DFHEIV0
 18520     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18521     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18522     MOVE X'2020233030303136393031' TO DFHEIV0(25:11)
 18523     CALL 'kxdfhei1' USING DFHEIV0,
 18524           DFHEIV20,
 18525           DFHEIV11,
 18526           GETMAIN-SPACE
 18527     SET ADDRESS OF CERT-NOTE-FILE TO
 18528         DFHEIV20
 18529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18530
 18531
 18532     ADD +1                      TO WRK-NOTE-SEQ.
 18533     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18534     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18535     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18536     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18537     MOVE CL-CERT-STATE          TO CZ-STATE.
 18538     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18539     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18540     MOVE CL-CERT-NO             TO CZ-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 354
* EL156.cbl
 18541     MOVE '2'                    TO CZ-RECORD-TYPE.
 18542     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18543     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18544     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18545     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18546     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18547     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18548
 18549 7191-WRITE.
 18550
 18551
 18552* EXEC CICS WRITE
 18553*         DATASET     ('ERCNOT')
 18554*         FROM        (CERT-NOTE-FILE)
 18555*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18556*         RESP        (WS-RESPONSE)
 18557*    END-EXEC.
 18558     MOVE LENGTH OF
 18559      CERT-NOTE-FILE
 18560       TO DFHEIV11
 18561     MOVE 'ERCNOT' TO DFHEIV1
 18562*    MOVE '&$ L                  ''  N#00016926' TO DFHEIV0
 18563     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18564     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18565     MOVE X'204E233030303136393236' TO DFHEIV0(25:11)
 18566     CALL 'kxdfhei1' USING DFHEIV0,
 18567           DFHEIV1,
 18568           CERT-NOTE-FILE,
 18569           DFHEIV11,
 18570           CZ-CONTROL-PRIMARY,
 18571           DFHEIV99,
 18572           DFHEIV99
 18573     MOVE EIBRESP  TO WS-RESPONSE
 18574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18575
 18576
 18577     IF WS-RESP-DUPREC
 18578         GO TO 7192-DUPREC
 18579     END-IF.
 18580
 18581     GO TO 7199-EXIT.
 18582
 18583 7192-DUPREC.
 18584
 18585     ADD +1                      TO  WRK-NOTE-SEQ.
 18586     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18587     GO TO 7191-WRITE.
 18588
 18589 7199-EXIT.
 18590      EXIT.
 18591 7200-FIND-BENEFIT.
 18592     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18593
 18594
 18595* EXEC CICS HANDLE CONDITION
 18596*        ENDFILE(7200-EXIT)
 18597*        NOTFND(7200-EXIT)
 18598*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 355
* EL156.cbl
 18599*    MOVE '"$''I                  ! ; #00016950' TO DFHEIV0
 18600     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18602     MOVE X'3B20233030303136393530' TO DFHEIV0(25:11)
 18603     CALL 'kxdfhei1' USING DFHEIV0
 18604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18605
 18606
 18607
 18608* EXEC CICS READ
 18609*        DATASET('ELCNTL')
 18610*        SET(ADDRESS OF CONTROL-FILE)
 18611*        RIDFLD(ELCNTL-KEY)
 18612*        GTEQ
 18613*    END-EXEC.
 18614     MOVE 'ELCNTL' TO DFHEIV1
 18615*    MOVE '&"S        G          (   #00016955' TO DFHEIV0
 18616     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18617     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18618     MOVE X'2020233030303136393535' TO DFHEIV0(25:11)
 18619     CALL 'kxdfhei1' USING DFHEIV0,
 18620           DFHEIV1,
 18621           DFHEIV20,
 18622           DFHEIV99,
 18623           ELCNTL-KEY,
 18624           DFHEIV99,
 18625           DFHEIV99,
 18626           DFHEIV99
 18627     SET ADDRESS OF CONTROL-FILE TO
 18628         DFHEIV20
 18629     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18630
 18631
 18632     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18633        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18634           GO TO 7200-EXIT.
 18635
 18636     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18637         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18638            ((SUB-1 > 8) OR
 18639            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18640
 18641     IF SUB-1 NOT = 9
 18642         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18643
 18644     GO TO 7200-EXIT.
 18645
 18646 7200-BENEFIT-DUMMY.
 18647
 18648 7200-DUMMY-EXIT.
 18649     EXIT.
 18650
 18651 7200-EXIT.
 18652     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 356
* EL156.cbl
 18654*052506
 18655*052506 7250-FIND-LETTER-TRLR.
 18656*052506     EXEC CICS HANDLE CONDITION
 18657*052506         ENDFILE  (7250-END)
 18658*052506         NOTFND   (7250-END)
 18659*052506     END-EXEC.
 18660*052506
 18661*052506     EXEC CICS STARTBR
 18662*052506         DATASET   ('ELTRLR')
 18663*052506         RIDFLD    (ELTRLR-KEY)
 18664*052506         GTEQ
 18665*052506     END-EXEC.
 18666*052506
 18667*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18668*052506
 18669*052506 7250-FIND-LOOP.
 18670*052506     EXEC CICS READNEXT
 18671*052506         DATASET   ('ELTRLR')
 18672*052506         RIDFLD    (ELTRLR-KEY)
 18673*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18674*052506     END-EXEC.
 18675*052506
 18676*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18677*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18678*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18679*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18680*052506        GO TO 7250-END
 18681*052506     END-IF.
 18682*052506
 18683*052506     IF AT-TRAILER-TYPE NOT = '4'
 18684*052506         GO TO 7250-FIND-LOOP
 18685*052506     END-IF.
 18686*052506
 18687*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18688*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18689*052506     END-IF.
 18690*052506
 18691*052506     GO TO 7250-FIND-LOOP.
 18692*052506
 18693*052506 7250-END.
 18694*052506
 18695*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18696*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18697*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18698*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18699*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18700*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18701*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18702*052506     END-IF.
 18703*052506
 18704*052506     EXEC CICS ENDBR
 18705*052506          DATASET    ('ELTRLR')
 18706*052506     END-EXEC.
 18707*052506
 18708*052506 7250-EXIT.
 18709*052506     EXIT.
 18710*052506     EJECT
 18711*052506
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 357
* EL156.cbl
 18712 7300-CHECK-AUTO-ACTIVITY.
 18713
 18714     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18715         NEXT SENTENCE
 18716     ELSE
 18717         GO TO 7399-EXIT.
 18718
 18719     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18720
 18721     IF WS-ACT-REC-FOUND-SW = 'N'
 18722         GO TO 7399-EXIT.
 18723
 18724     IF PI-ACTIVITY-CODE = 09
 18725         GO TO 7300-CONT-AUTO-ACTIVITY.
 18726
 18727     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18728        (PI-ACTIVITY-CODE = 11)
 18729         GO TO 7300-CONT-AUTO-ACTIVITY.
 18730
 18731     IF PI-PROVISIONAL-IND = 'P'
 18732         IF PI-PMTTYPE = '1'
 18733             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18734                 MOVE 'N'    TO  PI-RESET-SW
 18735                 GO TO 7399-EXIT.
 18736
 18737     IF PI-PMTTYPE = '1'
 18738         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18739             MOVE 'N'        TO  PI-RESET-SW
 18740             GO TO 7399-EXIT.
 18741
 18742     IF PI-PMTTYPE = '2' OR '3'
 18743         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18744             MOVE 'N'        TO  PI-RESET-SW
 18745             GO TO 7399-EXIT.
 18746
 18747     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18748         IF PI-PROVISIONAL-IND = 'P'
 18749             NEXT SENTENCE
 18750         ELSE
 18751             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18752
 18753 7300-CONT-AUTO-ACTIVITY.
 18754
 18755     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18756         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18757         MOVE '4'            TO DC-OPTION-CODE
 18758         MOVE +0             TO DC-ELAPSED-DAYS
 18759                                DC-ELAPSED-MONTHS
 18760         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18761         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18762         IF PI-USES-PAID-TO
 18763             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18764             IF NO-CONVERSION-ERROR
 18765                 MOVE +1     TO DC-ELAPSED-DAYS
 18766                 MOVE +0     TO DC-ELAPSED-MONTHS
 18767                 MOVE '6'    TO DC-OPTION-CODE
 18768                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18769                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 358
* EL156.cbl
 18770                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18771
 18772     IF PI-PFKEY-USED = DFHPF5
 18773         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18774         IF PI-USES-PAID-TO
 18775             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18776             MOVE +1                  TO DC-ELAPSED-DAYS
 18777             MOVE +0                  TO DC-ELAPSED-MONTHS
 18778             MOVE '6'                 TO DC-OPTION-CODE
 18779             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18780             IF NO-CONVERSION-ERROR
 18781                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18782
 18783     IF WS-CHK-THRU-DT < PI-EXP-DT
 18784         NEXT SENTENCE
 18785     ELSE
 18786         MOVE 03                     TO  WS-ACTIVITY-CODE
 18787         GO TO 7390-PROCESS-ACTIVITY.
 18788
 18789     IF PI-PROV-PMT
 18790         MOVE 09                     TO  WS-ACTIVITY-CODE
 18791     ELSE
 18792        IF PI-PMTTYPE = '1'
 18793            MOVE 02                  TO  WS-ACTIVITY-CODE
 18794        ELSE
 18795        IF PI-PMTTYPE = '2' OR '3'
 18796            MOVE 07                  TO  WS-ACTIVITY-CODE
 18797        ELSE
 18798        IF PI-PMTTYPE = '4'
 18799            MOVE 00                  TO  WS-ACTIVITY-CODE
 18800        ELSE
 18801            MOVE 'N'                 TO  PI-RESET-SW
 18802            GO TO 7399-EXIT.
 18803
 18804 7390-PROCESS-ACTIVITY.
 18805
 18806     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18807
 18808 7399-EXIT.
 18809     EXIT.
 18810
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 359
* EL156.cbl
 18812 7400-CHECK-AUTO-ACTIVITY.
 18813
 18814
 18815* EXEC CICS HANDLE CONDITION
 18816*        NOTFND   (7400-NOT-FOUND)
 18817*    END-EXEC.
 18818*    MOVE '"$I                   ! < #00017144' TO DFHEIV0
 18819     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18821     MOVE X'3C20233030303137313434' TO DFHEIV0(25:11)
 18822     CALL 'kxdfhei1' USING DFHEIV0
 18823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18824
 18825
 18826     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18827     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18828     MOVE SPACES                 TO  CNTL-ACCESS.
 18829     MOVE +0                     TO  CNTL-SEQ-NO.
 18830
 18831
 18832* EXEC CICS READ
 18833*        DATASET   ('ELCNTL')
 18834*        RIDFLD    (ELCNTL-KEY)
 18835*        SET       (ADDRESS OF CONTROL-FILE)
 18836*    END-EXEC.
 18837     MOVE 'ELCNTL' TO DFHEIV1
 18838*    MOVE '&"S        E          (   #00017153' TO DFHEIV0
 18839     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18841     MOVE X'2020233030303137313533' TO DFHEIV0(25:11)
 18842     CALL 'kxdfhei1' USING DFHEIV0,
 18843           DFHEIV1,
 18844           DFHEIV20,
 18845           DFHEIV99,
 18846           ELCNTL-KEY,
 18847           DFHEIV99,
 18848           DFHEIV99,
 18849           DFHEIV99
 18850     SET ADDRESS OF CONTROL-FILE TO
 18851         DFHEIV20
 18852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18853
 18854
 18855     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18856     GO TO 7400-EXIT.
 18857
 18858 7400-NOT-FOUND.
 18859     MOVE 'N'                        TO  PI-RESET-SW
 18860                                         WS-LETTER-SW
 18861                                         WS-ACT-REC-FOUND-SW.
 18862
 18863     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18864
 18865 7400-EXIT.
 18866     EXIT.
 18867
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 360
* EL156.cbl
 18869 7450-FORMAT-AUTO-LETTER.
 18870
 18871     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18872         MOVE 'Y'                    TO PI-RESET-SW
 18873         GO TO 7450-CONTINUE-PROCESS.
 18874
 18875     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18876
 18877     IF SUB > 9
 18878         SUBTRACT 9 FROM SUB
 18879         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18880     ELSE
 18881         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18882
 18883 7450-CONTINUE-PROCESS.
 18884
 18885     IF WS-ACTIVITY-CODE = ZEROS
 18886         MOVE 'N'                    TO  WS-LETTER-SW
 18887         GO TO 7450-EXIT.
 18888
 18889     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18890
 18891     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18892         MOVE 'N'                    TO  PI-RESET-SW
 18893                                         WS-LETTER-SW
 18894         GO TO 7450-EXIT.
 18895
 18896     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18897         MOVE 'N'                    TO  WS-LETTER-SW
 18898         GO TO 7450-EXIT.
 18899
 18900     MOVE 'Y'                        TO  WS-LETTER-SW.
 18901     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18902     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18903
 18904     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18905
 18906     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18907         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18908         MOVE '6'                    TO  DC-OPTION-CODE
 18909         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18910         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18911         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18912         IF NO-CONVERSION-ERROR
 18913             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18914         ELSE
 18915              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18916
 18917     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18918         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18919         MOVE '6'                    TO  DC-OPTION-CODE
 18920         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18921         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18922         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18923         IF NO-CONVERSION-ERROR
 18924             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18925         ELSE
 18926             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 361
* EL156.cbl
 18927
 18928 7450-EXIT.
 18929     EXIT.
 18930
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 362
* EL156.cbl
 18932 7500-RESET-AUTO-ACTIVITY.
 18933
 18934     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18935     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18936     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18937     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18938     MOVE +100                   TO  TRLR-SEQ-NO.
 18939
 18940 7500-STARTBR-TRLR.
 18941
 18942
 18943* EXEC CICS HANDLE CONDITION
 18944*        ENDFILE  (7590-END)
 18945*        NOTFND   (7590-END)
 18946*    END-EXEC.
 18947*    MOVE '"$''I                  ! = #00017246' TO DFHEIV0
 18948     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18949     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18950     MOVE X'3D20233030303137323436' TO DFHEIV0(25:11)
 18951     CALL 'kxdfhei1' USING DFHEIV0
 18952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18953
 18954
 18955
 18956* EXEC CICS STARTBR
 18957*        DATASET   ('ELTRLR')
 18958*        RIDFLD    (ELTRLR-KEY)
 18959*        GTEQ
 18960*    END-EXEC.
 18961     MOVE 'ELTRLR' TO DFHEIV1
 18962     MOVE 0
 18963       TO DFHEIV11
 18964*    MOVE '&,         G          &   #00017251' TO DFHEIV0
 18965     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18966     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18967     MOVE X'2020233030303137323531' TO DFHEIV0(25:11)
 18968     CALL 'kxdfhei1' USING DFHEIV0,
 18969           DFHEIV1,
 18970           ELTRLR-KEY,
 18971           DFHEIV99,
 18972           DFHEIV11,
 18973           DFHEIV99
 18974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18975
 18976
 18977     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18978
 18979 7500-READ-NEXT.
 18980
 18981
 18982* EXEC CICS READNEXT
 18983*        DATASET   ('ELTRLR')
 18984*        RIDFLD    (ELTRLR-KEY)
 18985*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18986*    END-EXEC.
 18987     MOVE 'ELTRLR' TO DFHEIV1
 18988     MOVE 0
 18989       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 363
* EL156.cbl
 18990*    MOVE '&.S                   )   #00017261' TO DFHEIV0
 18991     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18992     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18993     MOVE X'2020233030303137323631' TO DFHEIV0(25:11)
 18994     CALL 'kxdfhei1' USING DFHEIV0,
 18995           DFHEIV1,
 18996           DFHEIV20,
 18997           DFHEIV99,
 18998           ELTRLR-KEY,
 18999           DFHEIV99,
 19000           DFHEIV11,
 19001           DFHEIV99,
 19002           DFHEIV99
 19003     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19004         DFHEIV20
 19005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19006
 19007
 19008     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 19009        PI-CARRIER    NOT = TRLR-CARRIER  OR
 19010        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 19011        PI-CERT-NO    NOT = TRLR-CERT-NO
 19012         GO TO 7590-END.
 19013
 19014     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 19015         GO TO 7500-READ-NEXT.
 19016
 19017     IF AT-TRAILER-TYPE NOT = '4'
 19018         GO TO 7500-READ-NEXT.
 19019
 19020     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 19021         GO TO 7500-READ-NEXT.
 19022
 19023     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 19024        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 19025         GO TO 7500-READ-NEXT.
 19026
 19027     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 19028        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 19029        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 19030         GO TO 7500-READ-NEXT.
 19031
 19032     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 19033                         AND
 19034        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 19035                         AND
 19036        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 19037            GO TO 7500-READ-NEXT.
 19038
 19039     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 19040
 19041
 19042* EXEC CICS ENDBR
 19043*        DATASET   ('ELTRLR')
 19044*    END-EXEC.
 19045     MOVE 'ELTRLR' TO DFHEIV1
 19046     MOVE 0
 19047       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 364
* EL156.cbl
 19048*    MOVE '&2                    $   #00017300' TO DFHEIV0
 19049     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19050     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19051     MOVE X'2020233030303137333030' TO DFHEIV0(25:11)
 19052     CALL 'kxdfhei1' USING DFHEIV0,
 19053           DFHEIV1,
 19054           DFHEIV11,
 19055           DFHEIV99
 19056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19057
 19058
 19059     MOVE 'N'                        TO  WS-BROWSE-SW.
 19060
 19061
 19062* EXEC CICS READ
 19063*        DATASET   ('ELTRLR')
 19064*        RIDFLD    (ELTRLR-KEY)
 19065*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 19066*        UPDATE
 19067*    END-EXEC.
 19068     MOVE 'ELTRLR' TO DFHEIV1
 19069*    MOVE '&"S        EU         (   #00017306' TO DFHEIV0
 19070     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19071     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19072     MOVE X'2020233030303137333036' TO DFHEIV0(25:11)
 19073     CALL 'kxdfhei1' USING DFHEIV0,
 19074           DFHEIV1,
 19075           DFHEIV20,
 19076           DFHEIV99,
 19077           ELTRLR-KEY,
 19078           DFHEIV99,
 19079           DFHEIV99,
 19080           DFHEIV99
 19081     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19082         DFHEIV20
 19083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19084
 19085
 19086     MOVE 'Y'                        TO  WS-UPDATE-SW.
 19087
 19088     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 19089         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 19090     ELSE
 19091         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 19092             NEXT SENTENCE
 19093         ELSE
 19094             GO TO 7500-REWRITE-TRLR.
 19095
 19096     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 19097
 19098     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 19099     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 19100     MOVE '1'                        TO  ARCH-REC-TYPE.
 19101     MOVE +0                         TO  ARCH-SEQ.
 19102
 19103     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 19104
 19105 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 365
* EL156.cbl
 19106
 19107
 19108* EXEC CICS REWRITE
 19109*        DATASET   ('ELTRLR')
 19110*        FROM      (ACTIVITY-TRAILERS)
 19111*    END-EXEC.
 19112     MOVE LENGTH OF
 19113      ACTIVITY-TRAILERS
 19114       TO DFHEIV11
 19115     MOVE 'ELTRLR' TO DFHEIV1
 19116*    MOVE '&& L                  %   #00017334' TO DFHEIV0
 19117     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19118     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19119     MOVE X'2020233030303137333334' TO DFHEIV0(25:11)
 19120     CALL 'kxdfhei1' USING DFHEIV0,
 19121           DFHEIV1,
 19122           ACTIVITY-TRAILERS,
 19123           DFHEIV11,
 19124           DFHEIV99
 19125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19126
 19127
 19128     GO TO 7500-STARTBR-TRLR.
 19129
 19130 7590-END.
 19131
 19132     IF WS-BROWSE-SW = 'Y'
 19133         MOVE 'N'                    TO  WS-BROWSE-SW
 19134
 19135* EXEC CICS ENDBR
 19136*            DATASET   ('ELTRLR')
 19137*        END-EXEC.
 19138     MOVE 'ELTRLR' TO DFHEIV1
 19139     MOVE 0
 19140       TO DFHEIV11
 19141*    MOVE '&2                    $   #00017345' TO DFHEIV0
 19142     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19143     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19144     MOVE X'2020233030303137333435' TO DFHEIV0(25:11)
 19145     CALL 'kxdfhei1' USING DFHEIV0,
 19146           DFHEIV1,
 19147           DFHEIV11,
 19148           DFHEIV99
 19149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19150
 19151
 19152 7599-EXIT.
 19153     EXIT.
 19154
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 366
* EL156.cbl
 19156 7600-READ-ARCH-UPDATE.
 19157
 19158
 19159* EXEC CICS HANDLE CONDITION
 19160*        NOTFND   (7699-EXIT)
 19161*    END-EXEC.
 19162*    MOVE '"$I                   ! > #00017355' TO DFHEIV0
 19163     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19165     MOVE X'3E20233030303137333535' TO DFHEIV0(25:11)
 19166     CALL 'kxdfhei1' USING DFHEIV0
 19167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19168
 19169
 19170
 19171* EXEC CICS READ
 19172*        DATASET   ('ELARCH')
 19173*        RIDFLD    (ELARCH-KEY)
 19174*        SET       (ADDRESS OF LETTER-ARCHIVE)
 19175*        UPDATE
 19176*    END-EXEC.
 19177     MOVE 'ELARCH' TO DFHEIV1
 19178*    MOVE '&"S        EU         (   #00017359' TO DFHEIV0
 19179     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19180     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19181     MOVE X'2020233030303137333539' TO DFHEIV0(25:11)
 19182     CALL 'kxdfhei1' USING DFHEIV0,
 19183           DFHEIV1,
 19184           DFHEIV20,
 19185           DFHEIV99,
 19186           ELARCH-KEY,
 19187           DFHEIV99,
 19188           DFHEIV99,
 19189           DFHEIV99
 19190     SET ADDRESS OF LETTER-ARCHIVE TO
 19191         DFHEIV20
 19192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19193
 19194
 19195     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 19196
 19197
 19198* EXEC CICS REWRITE
 19199*        DATASET   ('ELARCH')
 19200*        FROM      (LETTER-ARCHIVE)
 19201*    END-EXEC.
 19202     MOVE LENGTH OF
 19203      LETTER-ARCHIVE
 19204       TO DFHEIV11
 19205     MOVE 'ELARCH' TO DFHEIV1
 19206*    MOVE '&& L                  %   #00017368' TO DFHEIV0
 19207     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19208     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19209     MOVE X'2020233030303137333638' TO DFHEIV0(25:11)
 19210     CALL 'kxdfhei1' USING DFHEIV0,
 19211           DFHEIV1,
 19212           LETTER-ARCHIVE,
 19213           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 367
* EL156.cbl
 19214           DFHEIV99
 19215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19216
 19217
 19218 7699-EXIT.
 19219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 368
* EL156.cbl
 19221 7700-GET-DCT.
 19222
 19223     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 19224     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 19225     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 19226     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 19227                                    PI-MAX-BENEFIT-AMT
 19228                                    PI-MAX-BENEFIT-PYMT
 19229                                    PI-MIN-PAYMENT-AMT
 19230                                    PI-TIME-OF-LOSS-BAL.
 19231
 19232
 19233* EXEC CICS HANDLE CONDITION
 19234*         NOTFND (5300-NOTE-NOT-FOUND)
 19235*     END-EXEC.
 19236*    MOVE '"$I                   ! ? #00017387' TO DFHEIV0
 19237     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19238     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19239     MOVE X'3F20233030303137333837' TO DFHEIV0(25:11)
 19240     CALL 'kxdfhei1' USING DFHEIV0
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244
 19245* EXEC CICS READ
 19246*         DATASET('ERNOTE')
 19247*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 19248*         RIDFLD (W-NOTE-KEY)
 19249*     END-EXEC.
 19250     MOVE 'ERNOTE' TO DFHEIV1
 19251*    MOVE '&"S        E          (   #00017391' TO DFHEIV0
 19252     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19253     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19254     MOVE X'2020233030303137333931' TO DFHEIV0(25:11)
 19255     CALL 'kxdfhei1' USING DFHEIV0,
 19256           DFHEIV1,
 19257           DFHEIV20,
 19258           DFHEIV99,
 19259           W-NOTE-KEY,
 19260           DFHEIV99,
 19261           DFHEIV99,
 19262           DFHEIV99
 19263     SET ADDRESS OF CERTIFICATE-NOTE TO
 19264         DFHEIV20
 19265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19266
 19267
 19268     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 19269     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 19270     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 19271     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 19272     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 19273
 19274     IF PI-PAYEE-TYPE NOT = 'B'
 19275         GO TO 7700-EXIT.
 19276
 19277     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19278     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 369
* EL156.cbl
 19279     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19280
 19281     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19282         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19283     ELSE
 19284         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19285
 19286     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19287     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19288     MOVE 'DLO006'               TO PGM-NAME.
 19289
 19290
 19291* EXEC CICS LINK
 19292*        PROGRAM    (PGM-NAME)
 19293*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19294*        LENGTH     (DCT-RCRD-LENGTH)
 19295*    END-EXEC.
 19296*    MOVE '."C                   (   #00017419' TO DFHEIV0
 19297     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19298     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19299     MOVE X'2020233030303137343139' TO DFHEIV0(25:11)
 19300     CALL 'kxdfhei1' USING DFHEIV0,
 19301           PGM-NAME,
 19302           DCT-COMMUNICATION-AREA,
 19303           DCT-RCRD-LENGTH,
 19304           DFHEIV99,
 19305           DFHEIV99,
 19306           DFHEIV99,
 19307           DFHEIV99
 19308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19309
 19310
 19311     IF DCT-RETURN-CODE = 'OK'
 19312         GO TO 7700-CONT.
 19313
 19314     IF DCT-RETURN-CODE = '01' OR '02'
 19315         GO TO 7700-SET-TO-YES.
 19316
 19317     IF DCT-RETURN-CODE = '03'
 19318
 19319* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19320*    MOVE '6"R                   !   #00017432' TO DFHEIV0
 19321     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19323     MOVE X'2020233030303137343332' TO DFHEIV0(25:11)
 19324     CALL 'kxdfhei1' USING DFHEIV0
 19325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19326         MOVE ER-0951            TO EMI-ERROR
 19327         MOVE -1                 TO PMTTYPEL
 19328         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19329         GO TO 8200-SEND-DATAONLY.
 19330
 19331     IF DCT-RETURN-CODE = '04'
 19332
 19333* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19334*    MOVE '6"R                   !   #00017439' TO DFHEIV0
 19335     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19336     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 370
* EL156.cbl
 19337     MOVE X'2020233030303137343339' TO DFHEIV0(25:11)
 19338     CALL 'kxdfhei1' USING DFHEIV0
 19339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19340         MOVE ER-0946            TO EMI-ERROR
 19341         MOVE -1                 TO PMTTYPEL
 19342         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19343         GO TO 8200-SEND-DATAONLY.
 19344
 19345     IF DCT-RETURN-CODE = '05'
 19346
 19347* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19348*    MOVE '6"R                   !   #00017446' TO DFHEIV0
 19349     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19351     MOVE X'2020233030303137343436' TO DFHEIV0(25:11)
 19352     CALL 'kxdfhei1' USING DFHEIV0
 19353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19354         MOVE ER-0947            TO EMI-ERROR
 19355         MOVE -1                 TO PMTTYPEL
 19356         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19357         GO TO 8200-SEND-DATAONLY.
 19358
 19359     IF DCT-RETURN-CODE = '06'
 19360
 19361* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19362*    MOVE '6"R                   !   #00017453' TO DFHEIV0
 19363     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19365     MOVE X'2020233030303137343533' TO DFHEIV0(25:11)
 19366     CALL 'kxdfhei1' USING DFHEIV0
 19367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19368         MOVE ER-0921            TO EMI-ERROR
 19369         MOVE -1                 TO PMTTYPEL
 19370         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19371         GO TO 8200-SEND-DATAONLY.
 19372
 19373     IF DCT-RETURN-CODE = '07'
 19374
 19375* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19376*    MOVE '6"R                   !   #00017460' TO DFHEIV0
 19377     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19378     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19379     MOVE X'2020233030303137343630' TO DFHEIV0(25:11)
 19380     CALL 'kxdfhei1' USING DFHEIV0
 19381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19382         MOVE ER-0919            TO EMI-ERROR
 19383         MOVE -1                 TO PMTTYPEL
 19384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19385         GO TO 8200-SEND-DATAONLY.
 19386
 19387     IF DCT-RETURN-CODE = '08'
 19388
 19389* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19390*    MOVE '6"R                   !   #00017467' TO DFHEIV0
 19391     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19392     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19393     MOVE X'2020233030303137343637' TO DFHEIV0(25:11)
 19394     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 371
* EL156.cbl
 19395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19396         MOVE ER-0948            TO EMI-ERROR
 19397         MOVE -1                 TO PMTTYPEL
 19398         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19399         GO TO 8200-SEND-DATAONLY.
 19400
 19401     IF DCT-RETURN-CODE = 'N1'
 19402
 19403* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19404*    MOVE '6"R                   !   #00017474' TO DFHEIV0
 19405     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19406     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19407     MOVE X'2020233030303137343734' TO DFHEIV0(25:11)
 19408     CALL 'kxdfhei1' USING DFHEIV0
 19409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19410         MOVE ER-0950            TO EMI-ERROR
 19411         MOVE -1                 TO PMTTYPEL
 19412         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19413         GO TO 8200-SEND-DATAONLY.
 19414
 19415     IF DCT-RETURN-CODE = 'E1'
 19416
 19417* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19418*    MOVE '6"R                   !   #00017481' TO DFHEIV0
 19419     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19421     MOVE X'2020233030303137343831' TO DFHEIV0(25:11)
 19422     CALL 'kxdfhei1' USING DFHEIV0
 19423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19424         MOVE ER-0974            TO EMI-ERROR
 19425         MOVE -1                 TO PMTTYPEL
 19426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19427         GO TO 8200-SEND-DATAONLY.
 19428
 19429     IF DCT-RETURN-CODE = 'E2'
 19430
 19431* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19432*    MOVE '6"R                   !   #00017488' TO DFHEIV0
 19433     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19434     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19435     MOVE X'2020233030303137343838' TO DFHEIV0(25:11)
 19436     CALL 'kxdfhei1' USING DFHEIV0
 19437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19438         MOVE ER-0975            TO EMI-ERROR
 19439         MOVE -1                 TO PMTTYPEL
 19440         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19441         GO TO 8200-SEND-DATAONLY.
 19442
 19443     IF DCT-RETURN-CODE NOT = 'OK'
 19444
 19445* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19446*    MOVE '6"R                   !   #00017495' TO DFHEIV0
 19447     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19449     MOVE X'2020233030303137343935' TO DFHEIV0(25:11)
 19450     CALL 'kxdfhei1' USING DFHEIV0
 19451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19452         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 372
* EL156.cbl
 19453         MOVE -1                 TO PMTTYPEL
 19454         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19455         GO TO 8200-SEND-DATAONLY.
 19456
 19457 7700-CONT.
 19458
 19459*    MOVE 'N'                    TO CASHO.
 19460*    MOVE +1                     TO CASHL.
 19461*    MOVE AL-UANON               TO CASHA.
 19462
 19463     IF PI-OFFLINE = 'Y'
 19464         GO TO 7700-EXIT.
 19465
 19466     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19467     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19468     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19469     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19470     MOVE +7                     TO CHECKNOL.
 19471     MOVE AL-UANON               TO CHECKNOA.
 19472     GO TO 7700-EXIT.
 19473
 19474 7700-SET-TO-YES.
 19475
 19476*    MOVE 'Y'                    TO CASHO.
 19477*    MOVE +1                     TO CASHL.
 19478*    MOVE AL-UANON               TO CASHA.
 19479
 19480 7700-EXIT.
 19481     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 373
* EL156.cbl
 19483 7800-READ-COMP-MSTR.
 19484
 19485
 19486* EXEC CICS HANDLE CONDITION
 19487*        NOTFND   (7800-COMP-NOTFND)
 19488*    END-EXEC.
 19489*    MOVE '"$I                   ! @ #00017529' TO DFHEIV0
 19490     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19492     MOVE X'4020233030303137353239' TO DFHEIV0(25:11)
 19493     CALL 'kxdfhei1' USING DFHEIV0
 19494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19495
 19496
 19497
 19498* EXEC CICS READ
 19499*        DATASET   ('ERCOMP')
 19500*        RIDFLD    (ERCOMP-KEY)
 19501*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19502*    END-EXEC.
 19503     MOVE 'ERCOMP' TO DFHEIV1
 19504*    MOVE '&"S        E          (   #00017533' TO DFHEIV0
 19505     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19506     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19507     MOVE X'2020233030303137353333' TO DFHEIV0(25:11)
 19508     CALL 'kxdfhei1' USING DFHEIV0,
 19509           DFHEIV1,
 19510           DFHEIV20,
 19511           DFHEIV99,
 19512           ERCOMP-KEY,
 19513           DFHEIV99,
 19514           DFHEIV99,
 19515           DFHEIV99
 19516     SET ADDRESS OF COMPENSATION-MASTER TO
 19517         DFHEIV20
 19518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19519
 19520
 19521     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19522     GO TO 7800-COMP-EXIT.
 19523
 19524 7800-COMP-NOTFND.
 19525     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19526
 19527 7800-COMP-EXIT.
 19528     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 374
* EL156.cbl
 19530 7900-READ-CLAIM.
 19531
 19532* EXEC CICS READ
 19533*        DATASET  ('ELMSTR')
 19534*        SET      (ADDRESS OF CLAIM-MASTER)
 19535*        RIDFLD   (ELMSTR-KEY)
 19536*    END-EXEC.
 19537     MOVE 'ELMSTR' TO DFHEIV1
 19538*    MOVE '&"S        E          (   #00017549' TO DFHEIV0
 19539     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19540     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19541     MOVE X'2020233030303137353439' TO DFHEIV0(25:11)
 19542     CALL 'kxdfhei1' USING DFHEIV0,
 19543           DFHEIV1,
 19544           DFHEIV20,
 19545           DFHEIV99,
 19546           ELMSTR-KEY,
 19547           DFHEIV99,
 19548           DFHEIV99,
 19549           DFHEIV99
 19550     SET ADDRESS OF CLAIM-MASTER TO
 19551         DFHEIV20
 19552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19553
 19554
 19555 7900-EXIT.
 19556      EXIT.
 19557
 19558 7910-READ-CLAIM-UPDATE.
 19559
 19560* EXEC CICS READ
 19561*        DATASET  ('ELMSTR')
 19562*        SET      (ADDRESS OF CLAIM-MASTER)
 19563*        RIDFLD   (ELMSTR-KEY)
 19564*        UPDATE
 19565*    END-EXEC.
 19566     MOVE 'ELMSTR' TO DFHEIV1
 19567*    MOVE '&"S        EU         (   #00017559' TO DFHEIV0
 19568     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19569     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19570     MOVE X'2020233030303137353539' TO DFHEIV0(25:11)
 19571     CALL 'kxdfhei1' USING DFHEIV0,
 19572           DFHEIV1,
 19573           DFHEIV20,
 19574           DFHEIV99,
 19575           ELMSTR-KEY,
 19576           DFHEIV99,
 19577           DFHEIV99,
 19578           DFHEIV99
 19579     SET ADDRESS OF CLAIM-MASTER TO
 19580         DFHEIV20
 19581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19582
 19583
 19584 7910-EXIT.
 19585      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 375
* EL156.cbl
 19587 7920-READ-BENE.
 19588     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19589     MOVE 'B'                TO BENE-RECORD-TYPE.
 19590     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19591
 19592     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19593        IF PI-PAYEE-TYPE    = 'B' AND
 19594           PI-PAYEE-SEQ-NUM = 9
 19595             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19596             MOVE WS-A-BENE           TO BENE-NUMBER.
 19597
 19598
 19599* EXEC CICS HANDLE CONDITION
 19600*        NOTFND   (7920-NOT-FOUND)
 19601*    END-EXEC.
 19602*    MOVE '"$I                   ! A #00017580' TO DFHEIV0
 19603     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19605     MOVE X'4120233030303137353830' TO DFHEIV0(25:11)
 19606     CALL 'kxdfhei1' USING DFHEIV0
 19607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19608
 19609
 19610
 19611* EXEC CICS READ
 19612*        DATASET  ('ELBENE')
 19613*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19614*        RIDFLD   (ELBENE-KEY)
 19615*    END-EXEC.
 19616     MOVE 'ELBENE' TO DFHEIV1
 19617*    MOVE '&"S        E          (   #00017584' TO DFHEIV0
 19618     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19619     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19620     MOVE X'2020233030303137353834' TO DFHEIV0(25:11)
 19621     CALL 'kxdfhei1' USING DFHEIV0,
 19622           DFHEIV1,
 19623           DFHEIV20,
 19624           DFHEIV99,
 19625           ELBENE-KEY,
 19626           DFHEIV99,
 19627           DFHEIV99,
 19628           DFHEIV99
 19629     SET ADDRESS OF BENEFICIARY-MASTER TO
 19630         DFHEIV20
 19631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19632
 19633
 19634     MOVE 'Y' TO BENE-FOUND-SW.
 19635     GO TO 7920-EXIT.
 19636
 19637 7920-NOT-FOUND.
 19638     MOVE 'N'                    TO BENE-FOUND-SW.
 19639
 19640 7920-EXIT.
 19641      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 376
* EL156.cbl
 19643 7930-READ-CONTROL.
 19644
 19645* EXEC CICS READ
 19646*        DATASET  ('ELCNTL')
 19647*        SET      (ADDRESS OF CONTROL-FILE)
 19648*        RIDFLD   (ELCNTL-KEY)
 19649*    END-EXEC.
 19650     MOVE 'ELCNTL' TO DFHEIV1
 19651*    MOVE '&"S        E          (   #00017600' TO DFHEIV0
 19652     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19653     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19654     MOVE X'2020233030303137363030' TO DFHEIV0(25:11)
 19655     CALL 'kxdfhei1' USING DFHEIV0,
 19656           DFHEIV1,
 19657           DFHEIV20,
 19658           DFHEIV99,
 19659           ELCNTL-KEY,
 19660           DFHEIV99,
 19661           DFHEIV99,
 19662           DFHEIV99
 19663     SET ADDRESS OF CONTROL-FILE TO
 19664         DFHEIV20
 19665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19666
 19667
 19668 7930-EXIT.
 19669      EXIT.
 19670
 19671 7940-READ-CONTROL-UPDATE.
 19672
 19673* EXEC CICS READ
 19674*        DATASET  ('ELCNTL')
 19675*        SET      (ADDRESS OF CONTROL-FILE)
 19676*        RIDFLD   (ELCNTL-KEY)
 19677*        UPDATE
 19678*    END-EXEC.
 19679     MOVE 'ELCNTL' TO DFHEIV1
 19680*    MOVE '&"S        EU         (   #00017610' TO DFHEIV0
 19681     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19682     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19683     MOVE X'2020233030303137363130' TO DFHEIV0(25:11)
 19684     CALL 'kxdfhei1' USING DFHEIV0,
 19685           DFHEIV1,
 19686           DFHEIV20,
 19687           DFHEIV99,
 19688           ELCNTL-KEY,
 19689           DFHEIV99,
 19690           DFHEIV99,
 19691           DFHEIV99
 19692     SET ADDRESS OF CONTROL-FILE TO
 19693         DFHEIV20
 19694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19695
 19696
 19697 7940-EXIT.
 19698      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 377
* EL156.cbl
 19700 7950-READ-TRAILER.
 19701
 19702* EXEC CICS READ
 19703*        DATASET  ('ELTRLR')
 19704*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19705*        RIDFLD   (ELTRLR-KEY)
 19706*    END-EXEC.
 19707     MOVE 'ELTRLR' TO DFHEIV1
 19708*    MOVE '&"S        E          (   #00017621' TO DFHEIV0
 19709     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19710     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19711     MOVE X'2020233030303137363231' TO DFHEIV0(25:11)
 19712     CALL 'kxdfhei1' USING DFHEIV0,
 19713           DFHEIV1,
 19714           DFHEIV20,
 19715           DFHEIV99,
 19716           ELTRLR-KEY,
 19717           DFHEIV99,
 19718           DFHEIV99,
 19719           DFHEIV99
 19720     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19721         DFHEIV20
 19722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19723
 19724
 19725 7950-EXIT.
 19726      EXIT.
 19727
 19728 7960-READ-TRAILER-UPDATE.
 19729
 19730* EXEC CICS READ
 19731*        DATASET  ('ELTRLR')
 19732*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19733*        RIDFLD   (ELTRLR-KEY)
 19734*        UPDATE
 19735*    END-EXEC.
 19736     MOVE 'ELTRLR' TO DFHEIV1
 19737*    MOVE '&"S        EU         (   #00017631' TO DFHEIV0
 19738     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19739     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19740     MOVE X'2020233030303137363331' TO DFHEIV0(25:11)
 19741     CALL 'kxdfhei1' USING DFHEIV0,
 19742           DFHEIV1,
 19743           DFHEIV20,
 19744           DFHEIV99,
 19745           ELTRLR-KEY,
 19746           DFHEIV99,
 19747           DFHEIV99,
 19748           DFHEIV99
 19749     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19750         DFHEIV20
 19751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19752
 19753
 19754 7960-EXIT.
 19755      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 378
* EL156.cbl
 19757 7970-READ-CERT.
 19758
 19759* EXEC CICS READ
 19760*        DATASET  ('ELCERT')
 19761*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19762*        RIDFLD   (ELCERT-KEY)
 19763*    END-EXEC.
 19764     MOVE 'ELCERT' TO DFHEIV1
 19765*    MOVE '&"S        E          (   #00017642' TO DFHEIV0
 19766     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19767     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19768     MOVE X'2020233030303137363432' TO DFHEIV0(25:11)
 19769     CALL 'kxdfhei1' USING DFHEIV0,
 19770           DFHEIV1,
 19771           DFHEIV20,
 19772           DFHEIV99,
 19773           ELCERT-KEY,
 19774           DFHEIV99,
 19775           DFHEIV99,
 19776           DFHEIV99
 19777     SET ADDRESS OF CERTIFICATE-MASTER TO
 19778         DFHEIV20
 19779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19780
 19781
 19782 7970-EXIT.
 19783      EXIT.
 19784 7975-read-acct.
 19785
 19786     move spaces              to WS-ACCT-RECORD-SW
 19787                                 pi-dcc-product-code
 19788
 19789     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19790     MOVE PI-CARRIER          TO ACCT-CARRIER
 19791     MOVE PI-GROUPING         TO ACCT-GROUPING
 19792     MOVE PI-STATE            TO ACCT-STATE
 19793     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19794     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19795     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19796     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19797
 19798
 19799* EXEC CICS READ
 19800*       DATASET ('ERACCT')
 19801*       RIDFLD  (ERACCT-KEY)
 19802*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19803*       GTEQ
 19804*       resp    (WS-RESPONSE)
 19805*    END-EXEC
 19806     MOVE 'ERACCT' TO DFHEIV1
 19807*    MOVE '&"S        G          (  N#00017664' TO DFHEIV0
 19808     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19810     MOVE X'204E233030303137363634' TO DFHEIV0(25:11)
 19811     CALL 'kxdfhei1' USING DFHEIV0,
 19812           DFHEIV1,
 19813           DFHEIV20,
 19814           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 379
* EL156.cbl
 19815           ERACCT-KEY,
 19816           DFHEIV99,
 19817           DFHEIV99,
 19818           DFHEIV99
 19819     SET ADDRESS OF ACCOUNT-MASTER TO
 19820         DFHEIV20
 19821     MOVE EIBRESP  TO WS-RESPONSE
 19822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19823     IF WS-RESP-NORMAL
 19824        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19825        and pi-cert-eff-dt < am-expiration-dt
 19826        and pi-cert-eff-dt >= am-effective-dt
 19827        move am-dcc-product-code to pi-dcc-product-code
 19828        set acct-found to true
 19829     end-if
 19830
 19831     .
 19832 7975-exit.
 19833     exit.
 19834 7980-READ-CERT-UPDATE.
 19835
 19836* EXEC CICS READ
 19837*        DATASET  ('ELCERT')
 19838*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19839*        RIDFLD   (ELCERT-KEY)
 19840*        UPDATE
 19841*    END-EXEC.
 19842     MOVE 'ELCERT' TO DFHEIV1
 19843*    MOVE '&"S        EU         (   #00017683' TO DFHEIV0
 19844     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19845     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19846     MOVE X'2020233030303137363833' TO DFHEIV0(25:11)
 19847     CALL 'kxdfhei1' USING DFHEIV0,
 19848           DFHEIV1,
 19849           DFHEIV20,
 19850           DFHEIV99,
 19851           ELCERT-KEY,
 19852           DFHEIV99,
 19853           DFHEIV99,
 19854           DFHEIV99
 19855     SET ADDRESS OF CERTIFICATE-MASTER TO
 19856         DFHEIV20
 19857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19858
 19859
 19860 7980-EXIT.
 19861      EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 380
* EL156.cbl
 19863 8000-LOAD-ERROR-MESSAGES.
 19864     IF PI-PASS-SW = 'C'
 19865        MOVE EMI-LINE1           TO ERMSG1BO
 19866     ELSE
 19867        MOVE EMI-LINE1           TO ERRMSG1O
 19868        MOVE EMI-LINE2           TO ERRMSG2O.
 19869
 19870 8000-EXIT.
 19871     EXIT.
 19872
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 381
* EL156.cbl
 19874
 19875 8010-DMD-ERROR-CHECKS.
 19876     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19877
 19878     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19879         GO TO 8051-ISSUE-ERROR.
 19880
 19881     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19882     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19883     MOVE '3'                    TO DC-OPTION-CODE.
 19884     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19885     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19886         GO TO 8051-ISSUE-ERROR.
 19887
 19888     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19889       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19890                           OR
 19891          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19892           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19893             MOVE ER-0851         TO EMI-ERROR
 19894             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19895       END-IF
 19896       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19897             MOVE ER-8147         TO EMI-ERROR
 19898             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19899
 19900     GO TO 8090-EXIT.
 19901
 19902 8051-ISSUE-ERROR.
 19903     MOVE ER-8146            TO EMI-ERROR.
 19904     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19905     GO TO 8090-EXIT.
 19906
 19907 8090-EXIT.
 19908      EXIT.
 19909
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 382
* EL156.cbl
 19911 8100-SEND-INITIAL-MAP.
 19912
 19913     MOVE SAVE-DATE              TO RUNDTEAO.
 19914     MOVE EIBTIME                TO TIME-IN.
 19915     MOVE TIME-OUT               TO RUNTIMAO.
 19916     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19917
 19918     IF MAP-NAME = 'EL156A'
 19919        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 19920           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19921        END-IF
 19922        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 19923           MOVE 'N'     TO SURVYYNO
 19924        END-IF
 19925     END-IF
 19926*    IF MAP-NAME = 'EL156A'
 19927*       IF PI-COMPANY-ID = 'CRI'
 19928*          NEXT SENTENCE
 19929*       ELSE
 19930*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19931
 19932     IF MAP-NAME = 'EL156A'
 19933        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19934           NEXT SENTENCE
 19935        ELSE
 19936           MOVE AL-SADOF TO  PINTA    PINTHA.
 19937
 19938     IF MAP-NAME = 'EL156A'
 19939        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19940            NEXT SENTENCE
 19941        ELSE
 19942           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19943
 19944*    IF MAP-NAME = 'EL156A'
 19945*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19946*          NEXT SENTENCE
 19947*       ELSE
 19948*          MOVE AL-SADOF TO CASHHA CASHA.
 19949
 19950     IF MAP-NAME = 'EL156A'
 19951        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19952                        or 'VPP'
 19953           NEXT SENTENCE
 19954        ELSE
 19955           MOVE AL-SADOF        TO  LOANHA
 19956                                    LOANNOA.
 19957
 19958     IF MAP-NAME = 'EL156A'
 19959        MOVE -1                 TO  ENTERPFL
 19960        IF PI-USES-PAID-TO
 19961           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19962           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19963           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19964        ELSE
 19965           NEXT SENTENCE
 19966     ELSE
 19967        IF MAP-NAME = 'EL156B'
 19968           IF PI-USES-PAID-TO
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 383
* EL156.cbl
 19969              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19970              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19971
 19972
 19973* EXEC CICS SEND
 19974*        MAP   (MAP-NAME)
 19975*        MAPSET(MAPSET-NAME)
 19976*        FROM  (EL156AI)
 19977*        ERASE
 19978*        CURSOR
 19979*    END-EXEC.
 19980     MOVE LENGTH OF
 19981      EL156AI
 19982       TO DFHEIV12
 19983     MOVE -1
 19984       TO DFHEIV11
 19985*    MOVE '8$     CT  E    H L F ,   #00017802' TO DFHEIV0
 19986     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19987     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19988     MOVE X'2020233030303137383032' TO DFHEIV0(25:11)
 19989     CALL 'kxdfhei1' USING DFHEIV0,
 19990           MAP-NAME,
 19991           EL156AI,
 19992           DFHEIV12,
 19993           MAPSET-NAME,
 19994           DFHEIV99,
 19995           DFHEIV99,
 19996           DFHEIV99,
 19997           DFHEIV11,
 19998           DFHEIV99,
 19999           DFHEIV99,
 20000           DFHEIV99
 20001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20002
 20003
 20004     GO TO 9100-RETURN-TRAN.
 20005
 20006 8200-SEND-DATAONLY.
 20007
 20008     IF FIRST-ENTRY = 'Y'
 20009         GO TO 8100-SEND-INITIAL-MAP.
 20010
 20011     IF RETURNED-FROM-B = 'Y'
 20012         GO TO 8100-SEND-INITIAL-MAP.
 20013
 20014     MOVE SAVE-DATE              TO RUNDTEAO.
 20015     MOVE EIBTIME                TO TIME-IN.
 20016     MOVE TIME-OUT               TO RUNTIMAO.
 20017
 20018     IF EIBAID = DFHPF11
 20019        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 20020        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20021        MOVE 'EL001   '          TO RETURNED-FROM
 20022        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 20023        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 20024        GO TO 8100-SEND-INITIAL-MAP.
 20025
 20026     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 384
* EL156.cbl
 20027
 20028     IF MAP-NAME =  'EL156A'
 20029        MOVE -1                 TO  ENTERPFL
 20030        IF PI-USES-PAID-TO
 20031           MOVE 'PAID TO DATE :' TO PTHRHDGO
 20032           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 20033           MOVE PMT-HEAD-A      TO  PMTHDGAO
 20034        ELSE
 20035           NEXT SENTENCE
 20036     ELSE
 20037        IF MAP-NAME = 'EL156B'
 20038           IF PI-USES-PAID-TO
 20039              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 20040              MOVE PMT-HEAD-B     TO PMTHDGBO.
 20041
 20042     IF MAP-NAME =  'EL156A'
 20043        IF PI-COMPANY-ID = 'BOA'
 20044            IF PI-INT-RATE NUMERIC
 20045                MOVE PI-INT-RATE TO PINTO.
 20046     IF MAP-NAME = 'EL156A'
 20047        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
 20048           MOVE 'PF6=EOB CODES'  TO PF6TITO
 20049*          MOVE 'Y'              TO EOBYNO
 20050        END-IF
 20051     END-IF
 20052
 20053
 20054* EXEC CICS SEND
 20055*        MAP   (MAP-NAME)
 20056*        MAPSET(MAPSET-NAME)
 20057*        FROM  (EL156AI)
 20058*        DATAONLY
 20059*        CURSOR
 20060*    END-EXEC.
 20061     MOVE LENGTH OF
 20062      EL156AI
 20063       TO DFHEIV12
 20064     MOVE -1
 20065       TO DFHEIV11
 20066*    MOVE '8$D    CT       H L F ,   #00017859' TO DFHEIV0
 20067     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 20068     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 20069     MOVE X'2020233030303137383539' TO DFHEIV0(25:11)
 20070     CALL 'kxdfhei1' USING DFHEIV0,
 20071           MAP-NAME,
 20072           EL156AI,
 20073           DFHEIV12,
 20074           MAPSET-NAME,
 20075           DFHEIV99,
 20076           DFHEIV99,
 20077           DFHEIV99,
 20078           DFHEIV11,
 20079           DFHEIV99,
 20080           DFHEIV99,
 20081           DFHEIV99
 20082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20083
 20084
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 385
* EL156.cbl
 20085     GO TO 9100-RETURN-TRAN.
 20086
 20087 8300-SEND-TEXT.
 20088
 20089* EXEC CICS SEND TEXT
 20090*        FROM(LOGOFF-TEXT)
 20091*        LENGTH(LOGOFF-LENGTH)
 20092*        ERASE
 20093*        FREEKB
 20094*    END-EXEC.
 20095*    MOVE '8&      T  E F  H   F -   #00017870' TO DFHEIV0
 20096     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 20097     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 20098     MOVE X'2020233030303137383730' TO DFHEIV0(25:11)
 20099     CALL 'kxdfhei1' USING DFHEIV0,
 20100           LOGOFF-TEXT,
 20101           LOGOFF-LENGTH,
 20102           DFHEIV99,
 20103           DFHEIV99,
 20104           DFHEIV99,
 20105           DFHEIV99,
 20106           DFHEIV99,
 20107           DFHEIV99,
 20108           DFHEIV99,
 20109           DFHEIV99,
 20110           DFHEIV99,
 20111           DFHEIV99
 20112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20113
 20114
 20115
 20116* EXEC CICS RETURN
 20117*    END-EXEC.
 20118*    MOVE '.(                    ''   #00017877' TO DFHEIV0
 20119     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 20120     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20121     MOVE X'2020233030303137383737' TO DFHEIV0(25:11)
 20122     CALL 'kxdfhei1' USING DFHEIV0,
 20123           DFHEIV99,
 20124           DFHEIV99,
 20125           DFHEIV99,
 20126           DFHEIV99,
 20127           DFHEIV99,
 20128           DFHEIV99
 20129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20130
 20131
 20132 8500-FILE-NOTOPEN.
 20133     IF FILE-SWITCH = 'MSTR'
 20134         MOVE ER-0154            TO EMI-ERROR.
 20135     IF FILE-SWITCH = 'TRLR'
 20136         MOVE ER-0172            TO EMI-ERROR.
 20137     IF FILE-SWITCH = 'CERT'
 20138         MOVE ER-0169            TO EMI-ERROR.
 20139     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 20140                      'PROC' OR 'STAT'
 20141         MOVE ER-0042            TO EMI-ERROR.
 20142     IF FILE-SWITCH = 'ACTQ'
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 386
* EL156.cbl
 20143         MOVE ER-0338            TO EMI-ERROR.
 20144     IF FILE-SWITCH = 'ACCT'
 20145         MOVE ER-0168            TO EMI-ERROR.
 20146
 20147     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20148     MOVE -1                     TO PMTTYPEL.
 20149
 20150     IF FIRST-ENTRY = 'Y'
 20151         GO TO 8100-SEND-INITIAL-MAP.
 20152
 20153     GO TO 8200-SEND-DATAONLY.
 20154
 20155 8600-PGRM-NOT-FOUND.
 20156
 20157     MOVE ER-0923                TO EMI-ERROR.
 20158     MOVE -1                     TO ENTPFBL.
 20159     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20160
 20161     IF FIRST-ENTRY = 'Y'
 20162         GO TO 8100-SEND-INITIAL-MAP
 20163     ELSE
 20164         GO TO 8200-SEND-DATAONLY.
 20165
 20166 8800-UNAUTHORIZED-ACCESS.
 20167     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 20168     GO TO 8300-SEND-TEXT.
 20169
 20170 8810-PF23.
 20171     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 20172     MOVE XCTL-005               TO PGM-NAME.
 20173     GO TO 9300-XCTL.
 20174
 20175 8820-PF7-8.
 20176     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 20177     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 20178                                    PI-SAVED-PROGRAM-2
 20179                                    PI-SAVED-PROGRAM-3
 20180                                    PI-SAVED-PROGRAM-4
 20181                                    PI-SAVED-PROGRAM-5
 20182                                    PI-SAVED-PROGRAM-6
 20183                                    PI-RETURN-TO-PROGRAM.
 20184     IF EIBAID = DFHPF8
 20185        MOVE XCTL-132            TO PGM-NAME
 20186     ELSE
 20187        MOVE XCTL-130            TO PGM-NAME.
 20188
 20189     GO TO 9300-XCTL.
 20190
 20191 9100-RETURN-TRAN.
 20192     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 20193     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 20194
 20195
 20196* EXEC CICS RETURN
 20197*        TRANSID(TRANS-ID)
 20198*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20199*        LENGTH(PI-COMM-LENGTH)
 20200*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 387
* EL156.cbl
 20201*    MOVE '.(CT                  ''   #00017943' TO DFHEIV0
 20202     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 20203     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20204     MOVE X'2020233030303137393433' TO DFHEIV0(25:11)
 20205     CALL 'kxdfhei1' USING DFHEIV0,
 20206           TRANS-ID,
 20207           PROGRAM-INTERFACE-BLOCK,
 20208           PI-COMM-LENGTH,
 20209           DFHEIV99,
 20210           DFHEIV99,
 20211           DFHEIV99
 20212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20213
 20214
 20215 9200-RETURN-MAIN-MENU.
 20216     MOVE XCTL-126               TO PGM-NAME.
 20217     GO TO 9300-XCTL.
 20218
 20219 9300-XCTL.
 20220
 20221* EXEC CICS XCTL
 20222*        PROGRAM(PGM-NAME)
 20223*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 20224*        LENGTH(PI-COMM-LENGTH)
 20225*    END-EXEC.
 20226*    MOVE '.$C                   %   #00017954' TO DFHEIV0
 20227     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 20228     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20229     MOVE X'2020233030303137393534' TO DFHEIV0(25:11)
 20230     CALL 'kxdfhei1' USING DFHEIV0,
 20231           PGM-NAME,
 20232           PROGRAM-INTERFACE-BLOCK,
 20233           PI-COMM-LENGTH,
 20234           DFHEIV99
 20235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20236
 20237
 20238 9400-CLEAR.
 20239     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 20240     GO TO 9300-XCTL.
 20241
 20242 9500-PF12.
 20243     MOVE XCTL-010               TO PGM-NAME.
 20244     GO TO 9300-XCTL.
 20245
 20246 9700-LINK-DATE-CONVERT.
 20247     MOVE LINK-ELDATCV           TO PGM-NAME.
 20248
 20249* EXEC CICS LINK
 20250*        PROGRAM   (PGM-NAME)
 20251*        COMMAREA  (DATE-CONVERSION-DATA)
 20252*        LENGTH    (DC-COMM-LENGTH)
 20253*    END-EXEC.
 20254*    MOVE '."C                   (   #00017970' TO DFHEIV0
 20255     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20256     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20257     MOVE X'2020233030303137393730' TO DFHEIV0(25:11)
 20258     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 388
* EL156.cbl
 20259           PGM-NAME,
 20260           DATE-CONVERSION-DATA,
 20261           DC-COMM-LENGTH,
 20262           DFHEIV99,
 20263           DFHEIV99,
 20264           DFHEIV99,
 20265           DFHEIV99
 20266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20267
 20268
 20269 9700-EXIT.
 20270     EXIT.
 20271
 20272 9800-LINK-REM-TERM.
 20273     MOVE LINK-REMTERM TO PGM-NAME.
 20274
 20275
 20276* EXEC CICS LINK
 20277*        PROGRAM   (PGM-NAME)
 20278*        COMMAREA  (CALCULATION-PASS-AREA)
 20279*        LENGTH    (CP-COMM-LENGTH)
 20280*    END-EXEC.
 20281*    MOVE '."C                   (   #00017982' TO DFHEIV0
 20282     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20283     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20284     MOVE X'2020233030303137393832' TO DFHEIV0(25:11)
 20285     CALL 'kxdfhei1' USING DFHEIV0,
 20286           PGM-NAME,
 20287           CALCULATION-PASS-AREA,
 20288           CP-COMM-LENGTH,
 20289           DFHEIV99,
 20290           DFHEIV99,
 20291           DFHEIV99,
 20292           DFHEIV99
 20293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20294
 20295
 20296 9800-EXIT.
 20297     EXIT.
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 389
* EL156.cbl
 20299 9830-DMD-REMAINING-TERM.
 20300
 20301     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20302         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20303
 20304     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20305                              CM-PMT-EXTENSION-DAYS.
 20306
 20307     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20308                                  CL-NO-OF-DAYS-PAID.
 20309
 20310     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20311         GIVING W-REM REMAINDER W-REM-DAYS.
 20312
 20313     MOVE W-REM                  TO WST-REM.
 20314
 20315     IF W-REM-DAYS > ZEROS
 20316         MOVE '/'                TO WST-SLASH
 20317         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20318     ELSE
 20319         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20320
 20321 9830-EXIT.
 20322     EXIT.
 20323
 20324 9870-OUTPUT-ACTIVITY-RECORD.
 20325
 20326
 20327* EXEC CICS GETMAIN
 20328*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20329*         LENGTH(25)
 20330*         INITIMG(WS-BLANK)
 20331*    END-EXEC.
 20332     MOVE 25
 20333       TO DFHEIV11
 20334*    MOVE ',"IL                  $   #00018018' TO DFHEIV0
 20335     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20336     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20337     MOVE X'2020233030303138303138' TO DFHEIV0(25:11)
 20338     CALL 'kxdfhei1' USING DFHEIV0,
 20339           DFHEIV20,
 20340           DFHEIV11,
 20341           WS-BLANK
 20342     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20343         DFHEIV20
 20344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20345
 20346
 20347     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20348     MOVE ELMSTR-KEY             TO DA-KEY.
 20349     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20350
 20351     IF PI-PMTTYPE EQUAL '7'
 20352         MOVE 'V'                TO DA-RECORD-TYPE
 20353     ELSE
 20354         MOVE 'P'                TO DA-RECORD-TYPE.
 20355
 20356
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 390
* EL156.cbl
 20357* EXEC CICS HANDLE CONDITION
 20358*         NOTOPEN(9870-NOTOPEN)
 20359*         DUPREC(9870-EXIT)
 20360*    END-EXEC.
 20361*    MOVE '"$J%                  ! B #00018033' TO DFHEIV0
 20362     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20364     MOVE X'4220233030303138303333' TO DFHEIV0(25:11)
 20365     CALL 'kxdfhei1' USING DFHEIV0
 20366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20367
 20368
 20369
 20370* EXEC CICS WRITE
 20371*         DATASET('DLYACTV')
 20372*         RIDFLD(DA-KEY)
 20373*         FROM(DAILY-ACTIVITY-RECORD)
 20374*         LENGTH(25)
 20375*    END-EXEC.
 20376     MOVE 'DLYACTV' TO DFHEIV1
 20377     MOVE 25
 20378       TO DFHEIV11
 20379*    MOVE '&$ L                  ''   #00018038' TO DFHEIV0
 20380     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20381     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20382     MOVE X'2020233030303138303338' TO DFHEIV0(25:11)
 20383     CALL 'kxdfhei1' USING DFHEIV0,
 20384           DFHEIV1,
 20385           DAILY-ACTIVITY-RECORD,
 20386           DFHEIV11,
 20387           DA-KEY,
 20388           DFHEIV99,
 20389           DFHEIV99
 20390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20391
 20392     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20393     GO TO 9870-EXIT.
 20394
 20395 9870-NOTOPEN.
 20396
 20397     MOVE '2955'                 TO EMI-ERROR.
 20398     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20399
 20400 9870-EXIT.
 20401     EXIT.
 20402
 20403 9900-ERROR-FORMAT.
 20404
 20405     IF EMI-ERROR = ER-0923
 20406         MOVE PGM-NAME           TO W-CALLED-NAME.
 20407
 20408     MOVE LINK-001      TO PGM-NAME.
 20409     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20410
 20411
 20412* EXEC CICS LINK
 20413*        PROGRAM (PGM-NAME)
 20414*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 391
* EL156.cbl
 20415*        LENGTH  (EMI-COMM-LENGTH)
 20416*    END-EXEC.
 20417*    MOVE '."C                   (   #00018063' TO DFHEIV0
 20418     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20419     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20420     MOVE X'2020233030303138303633' TO DFHEIV0(25:11)
 20421     CALL 'kxdfhei1' USING DFHEIV0,
 20422           PGM-NAME,
 20423           ERROR-MESSAGE-INTERFACE-BLOCK,
 20424           EMI-COMM-LENGTH,
 20425           DFHEIV99,
 20426           DFHEIV99,
 20427           DFHEIV99,
 20428           DFHEIV99
 20429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20430
 20431
 20432     IF EMI-ERROR = ER-0923
 20433         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20434
 20435 9900-EXIT.
 20436     EXIT.
 20437
 20438 9990-ABEND.
 20439     MOVE LINK-004               TO PGM-NAME.
 20440     MOVE DFHEIBLK               TO EMI-LINE1.
 20441
 20442* EXEC CICS LINK
 20443*        PROGRAM   (PGM-NAME)
 20444*        COMMAREA  (EMI-LINE1)
 20445*        LENGTH    (64)
 20446*    END-EXEC.
 20447     MOVE 64
 20448       TO DFHEIV11
 20449*    MOVE '."C                   (   #00018078' TO DFHEIV0
 20450     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20451     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20452     MOVE X'2020233030303138303738' TO DFHEIV0(25:11)
 20453     CALL 'kxdfhei1' USING DFHEIV0,
 20454           PGM-NAME,
 20455           EMI-LINE1,
 20456           DFHEIV11,
 20457           DFHEIV99,
 20458           DFHEIV99,
 20459           DFHEIV99,
 20460           DFHEIV99
 20461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20462
 20463
 20464     MOVE 'EL156A'               TO  MAP-NAME.
 20465     MOVE LOW-VALUES             TO  EL156AO.
 20466     GO TO 8100-SEND-INITIAL-MAP.
 20467
 20468 9995-SECURITY-VIOLATION.
 20469*    COPY ELCSCTP.
 20470******************************************************************
 20471*                                                                *
 20472*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 392
* EL156.cbl
 20473*                            VMOD=2.001                          *
 20474*                                                                *
 20475*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20476******************************************************************
 20477
 20478
 20479     MOVE EIBDATE          TO SM-JUL-DATE.
 20480     MOVE EIBTRMID         TO SM-TERMID.
 20481     MOVE THIS-PGM         TO SM-PGM.
 20482     MOVE EIBTIME          TO TIME-IN.
 20483     MOVE TIME-OUT         TO SM-TIME.
 20484     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20485
 20486
 20487* EXEC CICS LINK
 20488*         PROGRAM  ('EL003')
 20489*         COMMAREA (SECURITY-MESSAGE)
 20490*         LENGTH   (80)
 20491*    END-EXEC.
 20492     MOVE 'EL003' TO DFHEIV1
 20493     MOVE 80
 20494       TO DFHEIV11
 20495*    MOVE '."C                   (   #00018106' TO DFHEIV0
 20496     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20497     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20498     MOVE X'2020233030303138313036' TO DFHEIV0(25:11)
 20499     CALL 'kxdfhei1' USING DFHEIV0,
 20500           DFHEIV1,
 20501           SECURITY-MESSAGE,
 20502           DFHEIV11,
 20503           DFHEIV99,
 20504           DFHEIV99,
 20505           DFHEIV99,
 20506           DFHEIV99
 20507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20508
 20509
 20510******************************************************************
 20511
 20512
 20513
 20514 9999-DFHBACK SECTION.
 20515     MOVE '9%                    "   ' TO DFHEIV0
 20516     MOVE 'EL156' TO DFHEIV1
 20517     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20518     GOBACK.
 20519 9999-DFHEXIT.
 20520     IF DFHEIGDJ EQUAL 0001
 20521         NEXT SENTENCE
 20522     ELSE IF DFHEIGDJ EQUAL 2
 20523         GO TO 9990-ABEND,
 20524               8600-PGRM-NOT-FOUND,
 20525               0400-FIRST-TIME,
 20526               6180-DUPREC,
 20527               9990-ABEND
 20528         DEPENDING ON DFHEIGDI
 20529     ELSE IF DFHEIGDJ EQUAL 3
 20530         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 393
* EL156.cbl
 20531               0380-CLAIM-END-FILE
 20532         DEPENDING ON DFHEIGDI
 20533     ELSE IF DFHEIGDJ EQUAL 4
 20534         GO TO 0380-CLAIM-END-FILE,
 20535               0380-CLAIM-END-FILE
 20536         DEPENDING ON DFHEIGDI
 20537     ELSE IF DFHEIGDJ EQUAL 5
 20538         GO TO 0800-EXIT
 20539         DEPENDING ON DFHEIGDI
 20540     ELSE IF DFHEIGDJ EQUAL 6
 20541         GO TO 1950-NOT-FOUND,
 20542               1950-NOT-FOUND
 20543         DEPENDING ON DFHEIGDI
 20544     ELSE IF DFHEIGDJ EQUAL 7
 20545         GO TO 1950-NOT-FOUND
 20546         DEPENDING ON DFHEIGDI
 20547     ELSE IF DFHEIGDJ EQUAL 8
 20548         GO TO 1950-NOT-FOUND,
 20549               1950-NOT-FOUND
 20550         DEPENDING ON DFHEIGDI
 20551     ELSE IF DFHEIGDJ EQUAL 9
 20552         GO TO 1166-END-CHECK,
 20553               1166-END-CHECK
 20554         DEPENDING ON DFHEIGDI
 20555     ELSE IF DFHEIGDJ EQUAL 10
 20556         GO TO 1950-NOT-FOUND,
 20557               1950-NOT-FOUND
 20558         DEPENDING ON DFHEIGDI
 20559     ELSE IF DFHEIGDJ EQUAL 11
 20560         GO TO 1950-NOT-FOUND,
 20561               1950-NOT-FOUND
 20562         DEPENDING ON DFHEIGDI
 20563     ELSE IF DFHEIGDJ EQUAL 12
 20564         GO TO 1950-NOT-FOUND
 20565         DEPENDING ON DFHEIGDI
 20566     ELSE IF DFHEIGDJ EQUAL 13
 20567         GO TO 3600-CONTINUE
 20568         DEPENDING ON DFHEIGDI
 20569     ELSE IF DFHEIGDJ EQUAL 14
 20570         GO TO 5300-NOTE-NOT-FOUND
 20571         DEPENDING ON DFHEIGDI
 20572     ELSE IF DFHEIGDJ EQUAL 15
 20573         GO TO 6065-NOT-FOUND
 20574         DEPENDING ON DFHEIGDI
 20575     ELSE IF DFHEIGDJ EQUAL 16
 20576         GO TO 6068-ACCT-NOT-FND
 20577         DEPENDING ON DFHEIGDI
 20578     ELSE IF DFHEIGDJ EQUAL 17
 20579         GO TO 6074-GET-COMP-DATA
 20580         DEPENDING ON DFHEIGDI
 20581     ELSE IF DFHEIGDJ EQUAL 18
 20582         GO TO 6170-WRITE
 20583         DEPENDING ON DFHEIGDI
 20584     ELSE IF DFHEIGDJ EQUAL 19
 20585         GO TO 6180-DUPREC
 20586         DEPENDING ON DFHEIGDI
 20587     ELSE IF DFHEIGDJ EQUAL 20
 20588         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 12-Mar-18 13:42 Page 394
* EL156.cbl
 20589         DEPENDING ON DFHEIGDI
 20590     ELSE IF DFHEIGDJ EQUAL 21
 20591         GO TO 6185-DUPREC
 20592         DEPENDING ON DFHEIGDI
 20593     ELSE IF DFHEIGDJ EQUAL 22
 20594         GO TO 6720-BUILD-NEW-RECORD
 20595         DEPENDING ON DFHEIGDI
 20596     ELSE IF DFHEIGDJ EQUAL 23
 20597         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20598               6900-BUILD-ARCHIVE-HEADER
 20599         DEPENDING ON DFHEIGDI
 20600     ELSE IF DFHEIGDJ EQUAL 24
 20601         GO TO 7010-BUILD-MAP
 20602         DEPENDING ON DFHEIGDI
 20603     ELSE IF DFHEIGDJ EQUAL 25
 20604         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20605         DEPENDING ON DFHEIGDI
 20606     ELSE IF DFHEIGDJ EQUAL 26
 20607         GO TO 7160-DUPREC
 20608         DEPENDING ON DFHEIGDI
 20609     ELSE IF DFHEIGDJ EQUAL 27
 20610         GO TO 7200-EXIT,
 20611               7200-EXIT
 20612         DEPENDING ON DFHEIGDI
 20613     ELSE IF DFHEIGDJ EQUAL 28
 20614         GO TO 7400-NOT-FOUND
 20615         DEPENDING ON DFHEIGDI
 20616     ELSE IF DFHEIGDJ EQUAL 29
 20617         GO TO 7590-END,
 20618               7590-END
 20619         DEPENDING ON DFHEIGDI
 20620     ELSE IF DFHEIGDJ EQUAL 30
 20621         GO TO 7699-EXIT
 20622         DEPENDING ON DFHEIGDI
 20623     ELSE IF DFHEIGDJ EQUAL 31
 20624         GO TO 5300-NOTE-NOT-FOUND
 20625         DEPENDING ON DFHEIGDI
 20626     ELSE IF DFHEIGDJ EQUAL 32
 20627         GO TO 7800-COMP-NOTFND
 20628         DEPENDING ON DFHEIGDI
 20629     ELSE IF DFHEIGDJ EQUAL 33
 20630         GO TO 7920-NOT-FOUND
 20631         DEPENDING ON DFHEIGDI
 20632     ELSE IF DFHEIGDJ EQUAL 34
 20633         GO TO 9870-NOTOPEN,
 20634               9870-EXIT
 20635         DEPENDING ON DFHEIGDI.
 20636     MOVE '9%                    "   ' TO DFHEIV0
 20637     MOVE 'EL156' TO DFHEIV1
 20638     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20639     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12772     Code:       76771
