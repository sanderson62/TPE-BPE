* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51******************************************************************
    52 ENVIRONMENT DIVISION.
    53
    54 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   3
* EL050.cbl
    56 WORKING-STORAGE SECTION.
    57 01  DFH-START PIC X(04).
    58
    59 77  FILLER   PIC X(32) VALUE '********************************'.
    60 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    61 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    62
    63 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    64 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    65                                   USAGE POINTER.
    66 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    67 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    68 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    69                                   USAGE IS POINTER.
    70 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    72                                   USAGE IS POINTER.
    73 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    75                                   USAGE IS POINTER.
    76
    77 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    78 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    79                                   USAGE IS POINTER.
    80
    81*    COPY ELC50WS.
    82*****************************************************************
    83*                                                               *
    84*                            ELC50WS.                           *
    85*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    86*                            VMOD=2.061.                        *
    87*                                                               *
    88*   THIS IS THE WORKING STORAGE FOR EL050                       *
    89*                                   EL517                       *
    90*****************************************************************
    91******************************************************************
    92*                   C H A N G E   L O G
    93*
    94* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    95*-----------------------------------------------------------------
    96*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    97* EFFECTIVE    NUMBER
    98*-----------------------------------------------------------------
    99* 123102                   PEMA  ADD DCC PROCESSING
   100* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   101* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   102* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   103* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   104* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   105* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   106* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   107* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   108* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   109* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   110* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   111* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   112* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   113* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   4
* EL050.cbl
   114* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   115* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   116* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   117* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   118* 030309  CR2009021700001  PEMA  ADD ER-2883
   119* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   120* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   121* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   122* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   123* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   124* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   125* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   126* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   127* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   128* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   129* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   130* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   131* 061412  CR2011022800001  AJRA  NAPERSOFT
   132* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   133* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   134* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   135* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   136* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   137* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   138* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   139* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   140*-----------------------------------------------------------------
   141
   142 01  WORK-AREAS.
   143
   144*****************************************************************
   145*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   146*****************************************************************
   147
   148     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   149     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   150     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   151     12  WS-NAME-EDIT-WORK-AREA.
   152         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   153         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   154             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   155         16  WS-WORK-NAME.
   156             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   157             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   158             20  FILLER           PIC X(10)     VALUE SPACES.
   159         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   160             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   161
   162*****************************************************************
   163*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   164*****************************************************************
   165
   166     12  WS-ERRESC-KEY.
   167         16 WS-ERRESC-SEARCH-KEY.
   168             20  WS-ERRESC-COMPANY-CD PIC  X.
   169             20  WS-ERRESC-CARRIER    PIC  X.
   170             20  WS-ERRESC-GROUP      PIC X(6).
   171             20  WS-ERRESC-STATE      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   5
* EL050.cbl
   172             20  WS-ERRESC-ACCOUNT    PIC X(10).
   173         16 WS-ERRESC-RESIDUAL-KEY.
   174             20  WS-ERRESC-AGENT      PIC X(10).
   175             20  WS-ERRESC-RES-STATE  PIC XX.
   176             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   177*                                          YYYYMMDD
   178     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   179     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   180
   181*RESIDENT STATE TAX MASTER(ERRESS)
   182*
   183     12  WS-ERRESS-KEY.
   184         16  WS-ERRESS-COMPANY-CD      PIC  X.
   185         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   186         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   187         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   188*                                          YYYYMMDD
   189
   190     12  WS-CONTRACT-DATE              PIC 9(8).
   191*                                          YYYYMMDD
   192     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   193     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   194         16 WS-YEAR-YY                 PIC   9999.
   195         16 FILLER                     PIC 9(4).
   196*                                          YYYYMMDD
   197     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   198     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   199     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   200     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   201
   202     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   203         88  DPRB-1ST-TIME                      VALUE ' '.
   204
   205*****************************************************************
   206*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   207*****************************************************************
   208
   209     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   210     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   211     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   212     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   213     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   214     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   215     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   216     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   217     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   218     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   219     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   220         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   221         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   222     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   223         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   224         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   225     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   226
   227     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   228     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   229
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   6
* EL050.cbl
   230     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   231     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   232     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   233     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   234     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   235     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   236     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   237     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   241     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   243     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   244     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   245     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   248     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   249     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   250     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   251     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   261     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   262     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   263     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   264     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   266     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   267     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   268     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   269     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   270     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   271     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   272     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   273     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   274     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   275     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   276     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   278     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   279     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   280     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   281     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   282     12  WS-2671-SW               PIC X         VALUE SPACE.
   283     12  WS-2672-SW               PIC X         VALUE SPACE.
   284     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   285         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   286     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   287         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   7
* EL050.cbl
   288     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   289
   290     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   291         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   292         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   293         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   294         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   295
   296     12  WS-CREDIT-EDIT-CONTROLS.
   297         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   298         16  WS-MIN-AGE           PIC 99                VALUE  0.
   299         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   300         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   301         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   302         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   303
   304     12  WS-AGE-FIELDS.
   305         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   306         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   307         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   308         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   309
   310     12  WS-SAVE-ALLOWABLE-BENEFIT.
   311         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   312         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   313         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   314         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   315         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   316         16  FILLER                      PIC XX.
   317
   318     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   319     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   320     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   321     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   322     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   323     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   324     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   325     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   326     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   327     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   328
   329     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   330     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   331     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   332     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   333     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   334     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   335     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   336     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   337         88  WS-REDUCING              VALUE 'R'.
   338         88  WS-LEVEL                 VALUE 'L' 'P'.
   339     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   340
   341     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   342     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   343     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   344     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   345     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   8
* EL050.cbl
   346     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   347     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   348     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   349     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   350
   351     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   352     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   353     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   354     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   355     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   356     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   357     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   358     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   359     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   360     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   361     12  WS-ACCT-SIG-SW.
   362         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   363         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   364     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   365     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   366     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   367     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   368     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   369     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   370     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   371     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   372     12  WS-INITIALS.
   373         16  WS-INIT-1            PIC X         VALUE SPACES.
   374         16  WS-INIT-2            PIC X         VALUE SPACES.
   375
   376     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   377     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   378     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   379     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   380     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   381*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   382     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   383     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   384     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   385     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   386     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   387     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   388     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   389     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   390     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   391     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   392     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   393     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   394     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   395     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   396     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   397     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   398     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   399     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   400     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   401     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   402     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   403     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page   9
* EL050.cbl
   404******** FLA
   405     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   406     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   407     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   408     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   409     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   410********
   411     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   412     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   413     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   414     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   415     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   416     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   417     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   418     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   419     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   420     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   421
   422     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   423         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   424                                         '0' THRU '9'.
   425
   426     12  NUMBER-OF-MONTHS.
   427         16  SK-MO OCCURS 12 TIMES PIC X.
   428
   429     12  WS-WORK-DATE.
   430         16  WS-YEAR            PIC 99    VALUE 00.
   431         16  WS-MONTH           PIC 99    VALUE 00.
   432         16  WS-DAY             PIC 99    VALUE 00.
   433
   434     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   435     12  WS-WORK-CRIT-DEV       REDEFINES
   436         WS-WORK-LF-CRIT-PER    PIC X(03).
   437
   438     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   439     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   440
   441     12  WS-WORK-DATE-FROM.
   442         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   443         16  FILLER             PIC X  VALUE SPACE.
   444         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   445         16  FILLER             PIC X         VALUE SPACE.
   446         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   447
   448     12  WS-WORK-DATE-THRU.
   449         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   450         16  FILLER             PIC X         VALUE SPACE.
   451         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   452         16  FILLER             PIC X         VALUE SPACE.
   453         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   454
   455     12  WS-LF-INPUT-CD.
   456         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   457         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   458
   459     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   460     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   461         16  WS-AH-INPUT-CD-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  10
* EL050.cbl
   462         16  WS-AH-INPUT-CD-2-3 PIC XX.
   463
   464     12  WS-SWITCHES.
   465         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   466         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   467             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   468         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   469             88  BANK-ACCT-FOUND          VALUE 'Y'.
   470         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   471             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   472         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   473             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   474         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   475             88  COMP-MASTER-FOUND        VALUE 'Y'.
   476         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   477             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   478         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   479             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   480         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   481             88  STAT-MASTER-FOUND        VALUE 'Y'.
   482         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   483             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   484         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   485             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   486         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   487             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   488         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   489             88  FORM-MASTER-FOUND        VALUE 'Y'.
   490         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   491             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   492         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   493             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   494         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   495             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   496         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   497             88  NO-BENEFIT-FOUND         VALUE 'N'.
   498         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   499             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   500         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   501             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   502         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   503             88  AH-BENEFIT-FOUND         VALUE ' '.
   504             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   505         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   506             88  LF-BENEFIT-FOUND         VALUE ' '.
   507             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   508         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   509             88  NO-STATE-RECORD          VALUE '1'.
   510         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   511             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   512         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   513             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   514         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   515             88  CERT-WAS-FOUND           VALUE ' '.
   516             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   517         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   518             88  BROWSE-STARTED           VALUE 'Y'.
   519         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  11
* EL050.cbl
   520             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   521         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   522             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   523         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   524             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   525         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   526             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   527         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   528             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   529         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   530             88  APP-CERT-USED            VALUE 'Y' 'A'.
   531         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   532             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   533             88  FIRST-TIME-THROUGH       VALUE '1'.
   534             88  CTBL-NOT-FOUND           VALUE '2'.
   535
   536         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   537             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   538
   539         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   540             88  DLO-ERROR-FOUND          VALUE 'Y'.
   541
   542********FLA
   543     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   544     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   545********
   546     12  RC-SW-1                  PIC X           VALUE '0'.
   547     12  RC-SW-2                  PIC X           VALUE '0'.
   548     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   549     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   550     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   551     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   552     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   553     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   554     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   555     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   556     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   557     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   558     12  LIT-SPACES               PIC X           VALUE SPACES.
   559     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   560     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   561     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   562     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   563     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   564     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   565     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   566         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   567         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   568     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   569         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   570
   571 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   572     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   573     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   574 01  WS-CRI-SSN-WORK-AREA.
   575     05  WS-CRI-SOC-SEC-NO.
   576         10  WS-SS-REPT-CD       PIC X(5).
   577         10  WS-SS-LAST-NAME     PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  12
* EL050.cbl
   578         10  WS-SS-INITIAL       PIC X.
   579
   580     05  WS-CRI-REPORT-CODE.
   581         10  FILLER              PIC X(5).
   582         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   583
   584     05  WS-CRI-LAST-NAME.
   585         10  WS-CRI-NAME-MOVE    PIC X(5).
   586         10  FILLER              PIC X(10).
   587
   588 01  WS-NUM-TABLE                PIC X(26)  VALUE
   589     '12345678012345070923456789'.
   590 01  FILLER REDEFINES WS-NUM-TABLE.
   591     05  WS-NUM OCCURS 26        PIC 9.
   592 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   593 01  V1                          PIC S999 COMP-3.
   594 01  V2                          PIC S999 COMP-3.
   595 01  V3                          PIC S999 COMP-3.
   596 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   597 01  FILLER REDEFINES WS-WORK-VIN.
   598     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   599 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   600 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   601 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   602 01  WS-HEX-WORK.
   603     05  FILLER                  PIC X  VALUE LOW-VALUES.
   604     05  WS-HEX-BYTE             PIC X.
   605 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   606 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   607 01  WS-WORK-HIN-ROW-B.
   608     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   609
   610 01  ws-benefit-cd-chg-sw      pic x value spaces.
   611     88  benefit-code-chg           value 'Y'.
   612 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   613 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   614     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   615 01  WS-ROW-D-TABLE.
   616     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   617
   618 01  WS-HIN-TABLE-B.
   619     05  F                       PIC XX VALUE 'A2'.
   620     05  F                       PIC XX VALUE 'B3'.
   621     05  F                       PIC XX VALUE 'C4'.
   622     05  F                       PIC XX VALUE 'D5'.
   623     05  F                       PIC XX VALUE 'E6'.
   624     05  F                       PIC XX VALUE 'F7'.
   625     05  F                       PIC XX VALUE 'G8'.
   626     05  F                       PIC XX VALUE 'H9'.
   627     05  F                       PIC XX VALUE 'I1'.
   628     05  F                       PIC XX VALUE 'J2'.
   629     05  F                       PIC XX VALUE 'K3'.
   630     05  F                       PIC XX VALUE 'L4'.
   631     05  F                       PIC XX VALUE 'M5'.
   632     05  F                       PIC XX VALUE 'N6'.
   633     05  F                       PIC XX VALUE 'O0'.
   634     05  F                       PIC XX VALUE 'P7'.
   635     05  F                       PIC XX VALUE 'Q0'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  13
* EL050.cbl
   636     05  F                       PIC XX VALUE 'R8'.
   637     05  F                       PIC XX VALUE 'S9'.
   638     05  F                       PIC XX VALUE 'T2'.
   639     05  F                       PIC XX VALUE 'U3'.
   640     05  F                       PIC XX VALUE 'V4'.
   641     05  F                       PIC XX VALUE 'W5'.
   642     05  F                       PIC XX VALUE 'X6'.
   643     05  F                       PIC XX VALUE 'Y7'.
   644     05  F                       PIC XX VALUE 'Z8'.
   645 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   646     05  WS-VAL-IN               PIC X.
   647     05  WS-VAL-OUT              PIC 9.
   648 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   649 01  WS-COMPARE-BINARY-DATES.
   650     05  WS-971231                PIC XX VALUE X'92FF'.
   651     05  WS-931231                PIC XX VALUE X'8CFF'.
   652     05  WS-791231                PIC XX VALUE X'77FF'.
   653     05  WS-771001                PIC XX VALUE X'74A1'.
   654     05  WS-820301                PIC XX VALUE X'7B41'.
   655     05  WS-831031                PIC XX VALUE X'7DBF'.
   656     05  WS-831231                PIC XX VALUE X'7DFF'.
   657     05  WS-810831                PIC XX VALUE X'7A7F'.
   658     05  WS-830901                PIC XX VALUE X'7D81'.
   659
   660 01  FILE-ACCESS-IDS.
   661     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   662     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   663     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   664     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   665     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   666     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   667     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   668     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   669     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   670     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   671     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   672     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   673     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   674     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   675     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   676     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   677     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   678 01  DD-IU-SW                    PIC X   VALUE ' '.
   679     88  DD-IU-PRESENT                 VALUE 'Y'.
   680
   681 01  ACCESS-KEYS.
   682     12  ELMSTR-KEY.
   683         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   684         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   685     12  W-CLAIM-KEY.
   686         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   687         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   688
   689     12  ELCNTL-KEY.
   690         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   691         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   692         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   693         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  14
* EL050.cbl
   694
   695     12  ELCERT-KEY.
   696         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   697         16  CERT-CARRIER         PIC X       VALUE SPACE.
   698         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   699         16  CERT-STATE           PIC XX      VALUE SPACES.
   700         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   701         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   702         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   703
   704     12  ELCERT2-KEY.
   705         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   706         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   707
   708     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   709
   710     12  ELCERT-SAVE.
   711         16  FILLER                      PIC XX    VALUE SPACES.
   712
   713         16  WCS-CONTROL-PRIMARY.
   714             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   715             20  WCS-CARRIER             PIC X     VALUE SPACE.
   716             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   717             20  WCS-STATE               PIC XX    VALUE SPACES.
   718             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   719             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   720             20  WCS-CERT-NO.
   721                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   722                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   723
   724         16  CS-CONTROL-BY-NAME.
   725             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   726             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   727             20  CS-INSURED-INITIALS.
   728                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   729                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   730
   731         16  CS-CONTROL-BY-SSN.
   732             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   733             20  CS-SOC-SEC-NO.
   734                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   735                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   736                 24  CS-SSN-LN3.
   737                     28 CS-INSURED-INITIALS-A2   PIC XX
   738                                     VALUE SPACES.
   739                     28 CS-PART-LAST-NAME-A2     PIC X
   740                                     VALUE SPACE.
   741
   742         16  CS-CONTROL-BY-CERT-NO.
   743             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   744             20  CS-CERT-NO-A4           PIC X(11)
   745                                     VALUE SPACES.
   746
   747         16  CS-CONTROL-BY-MEMB.
   748             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   749             20  CS-MEMBER-NO.
   750                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   751                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  15
* EL050.cbl
   752                 24  CS-MEMB-LN4.
   753                     28 CS-INSURED-INITIALS-A5   PIC XX
   754                                      VALUE SPACES.
   755                     28 CS-PART-LAST-NAME-A5     PIC XX
   756                                      VALUE SPACES.
   757
   758         16  FILLER              PIC X(360) VALUE SPACES.
   759
   760     12  ERACCT-KEY.
   761         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   762         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   763         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   764         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   765         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   766         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   767
   768     12  ERCOMP-KEY.
   769         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   770         16  COMP-CARRIER         PIC X     VALUE SPACES.
   771         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   772         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   773         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   774         16  COMP-TYPE            PIC X     VALUE SPACES.
   775
   776     12  ERLOFC-KEY.
   777         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   778         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   779         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   780         16  LOFC-STATE           PIC XX    VALUE SPACES.
   781         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   782         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   783
   784     12  WS-ELCRTT-KEY.
   785         16  WS-ELCRTT-PRIMARY       PIC X(33).
   786         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   787
   788     12  ERBXRF-KEY.
   789         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   790         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   791         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   792         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   793
   794     12  ERAGTC-KEY.
   795         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   796         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   797         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   798         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   799         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   800         16  AGTC-TYPE            PIC X     VALUE SPACES.
   801
   802     12  ERPLAN-KEY.
   803         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   804         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   805         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   806         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   807         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   808         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   809         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  16
* EL050.cbl
   810         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   811
   812     12  ERFORM-KEY.
   813         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   814         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   815         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   816         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   817
   818     12  ERREIN-KEY.
   819         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   820         16  REIN-TYPE            PIC X     VALUE SPACES.
   821         16  REIN-TABLE-CO.
   822             20  REIN-CODE-1      PIC X     VALUE SPACE.
   823             20  REIN-CODE-2      PIC X     VALUE SPACE.
   824             20  REIN-CODE-3      PIC X     VALUE SPACE.
   825         16  FILLER               PIC X(3)  VALUE SPACES.
   826
   827     12  ERCTBL-KEY.
   828         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   829         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   830         16  CTBL-CNTRL-2.
   831             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   832             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   833
   834     12  ELCRTO-KEY.
   835         16  ELCRTO-COMPANY-CD       PIC X.
   836         16  ELCRTO-CARRIER          PIC X.
   837         16  ELCRTO-GROUPING         PIC X(6).
   838         16  ELCRTO-STATE            PIC XX.
   839         16  ELCRTO-ACCOUNT          PIC X(10).
   840         16  ELCRTO-CERT-EFF-DT      PIC XX.
   841         16  ELCRTO-CERT-NO.
   842             20  ELCRTO-CERT-PRIME   PIC X(10).
   843             20  ELCRTO-CERT-SFX     PIC X.
   844         16  ELCRTO-RECORD-TYPE      PIC X.
   845         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   846
   847
   848     12  WS-ACCESS.
   849         16  FILLER               PIC XX    VALUE SPACES.
   850         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   851
   852     12  WS-CARR-ACCESS.
   853         16  FILLER               PIC X(3)  VALUE SPACES.
   854         16  WS-CARR              PIC X     VALUE SPACE.
   855*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   856*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   857     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   858         88  WS-DMD-LF-RATING   VALUE 'Y'.
   859         88  WS-DMD-AH-RATING   VALUE 'Y'.
   860         88  WS-DMD-NO-RATING   VALUE 'N'.
   861
   862     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   863         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   864                                         'NJ' 'NL'
   865                                         'PJ' 'PL'
   866                                         'SJ' 'SL'.
   867     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  17
* EL050.cbl
   868         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   869                                         'NI' 'NJ' 'NL' 'NU'
   870                                         'PJ' 'PL' 'PI' 'PU'
   871                                         'SI' 'SJ' 'SL' 'SU'
   872                                         'MX' 'MY' 'MZ'.
   873 01  ERPDEF-KEY-SAVE             PIC X(18).
   874 01  ERPDEF-KEY.
   875     12  ERPDEF-COMPANY-CD       PIC X.
   876     12  ERPDEF-STATE            PIC XX.
   877     12  ERPDEF-PROD-CD          PIC XXX.
   878     12  F                       PIC X(7).
   879     12  ERPDEF-BEN-TYPE         PIC X.
   880     12  ERPDEF-BEN-CODE         PIC XX.
   881     12  ERPDEF-EXP-DT           PIC XX.
   882
   883 01  ELSTAT-KEY-SAVE             PIC X(20).
   884 01  ELSTAT-KEY.
   885     12  ELSTAT-COMPANY-ID       PIC XXX.
   886     12  ELSTAT-CARRIER          PIC X.
   887     12  ELSTAT-GROUP            PIC X(6).
   888     12  ELSTAT-STATE            PIC XX.
   889     12  ELSTAT-EXP-DT           PIC 9(8).
   890 01  WS-ERROR-VALUES.
   891     12  ER-1570                     PIC S9(4)   VALUE +1570.
   892     12  ER-1571                     PIC S9(4)   VALUE +1571.
   893     12  er-1572                     pic s9(4)   value +1572.
   894     12  er-1573                     pic s9(4)   value +1573.
   895     12  er-1574                     pic s9(4)   value +1574.
   896     12  ER-1575                     PIC S9(4)   VALUE +1575.
   897     12  ER-1891                     PIC S9(4)   VALUE +1891.
   898     12  ER-1892                     PIC S9(4)   VALUE +1892.
   899     12  ER-1893                     PIC S9(4)   VALUE +1893.
   900     12  ER-1894                     PIC S9(4)   VALUE +1894.
   901     12  ER-1895                     PIC S9(4)   VALUE +1895.
   902     12  ER-1896                     PIC S9(4)   VALUE +1896.
   903     12  ER-1897                     PIC S9(4)   VALUE +1897.
   904     12  ER-1898                     PIC S9(4)   VALUE +1898.
   905     12  ER-1899                     PIC S9(4)   VALUE +1899.
   906     12  ER-1900                     PIC S9(4)   VALUE +1900.
   907     12  ER-1901                     PIC S9(4)   VALUE +1901.
   908     12  ER-1902                     PIC S9(4)   VALUE +1902.
   909     12  ER-1903                     PIC S9(4)   VALUE +1903.
   910     12  ER-1904                     PIC S9(4)   VALUE +1904.
   911     12  ER-1905                     PIC S9(4)   VALUE +1905.
   912     12  ER-1906                     PIC S9(4)   VALUE +1906.
   913     12  ER-1907                     PIC S9(4)   VALUE +1907.
   914     12  ER-1909                     PIC S9(4)   VALUE +1909.
   915     12  ER-1910                     PIC S9(4)   VALUE +1910.
   916     12  ER-1911                     PIC S9(4)   VALUE +1911.
   917     12  ER-1912                     PIC S9(4)   VALUE +1912.
   918     12  ER-1913                     PIC S9(4)   VALUE +1913.
   919     12  ER-1914                     PIC S9(4)   VALUE +1914.
   920     12  ER-1915                     PIC S9(4)   VALUE +1915.
   921     12  ER-1916                     PIC S9(4)   VALUE +1916.
   922     12  ER-1917                     PIC S9(4)   VALUE +1917.
   923     12  ER-1918                     PIC S9(4)   VALUE +1918.
   924     12  ER-1919                     PIC S9(4)   VALUE +1919.
   925     12  ER-1920                     PIC S9(4)   VALUE +1920.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  18
* EL050.cbl
   926     12  ER-1921                     PIC S9(4)   VALUE +1921.
   927     12  ER-1922                     PIC S9(4)   VALUE +1922.
   928     12  ER-1923                     PIC S9(4)   VALUE +1923.
   929     12  ER-1924                     PIC S9(4)   VALUE +1924.
   930     12  ER-1925                     PIC S9(4)   VALUE +1925.
   931     12  ER-1926                     PIC S9(4)   VALUE +1926.
   932     12  ER-1927                     PIC S9(4)   VALUE +1927.
   933     12  ER-2393                     PIC S9(4)   VALUE +2393.
   934     12  ER-2600                     PIC S9(4)   VALUE +2600.
   935     12  ER-2601                     PIC S9(4)   VALUE +2601.
   936     12  ER-2602                     PIC S9(4)   VALUE +2602.
   937     12  ER-2603                     PIC S9(4)   VALUE +2603.
   938     12  ER-2604                     PIC S9(4)   VALUE +2604.
   939     12  ER-2605                     PIC S9(4)   VALUE +2605.
   940     12  ER-2606                     PIC S9(4)   VALUE +2606.
   941     12  ER-2607                     PIC S9(4)   VALUE +2607.
   942     12  ER-2608                     PIC S9(4)   VALUE +2608.
   943     12  ER-2609                     PIC S9(4)   VALUE +2609.
   944     12  ER-2610                     PIC S9(4)   VALUE +2610.
   945     12  ER-2611                     PIC S9(4)   VALUE +2611.
   946     12  ER-2612                     PIC S9(4)   VALUE +2612.
   947     12  ER-2613                     PIC S9(4)   VALUE +2613.
   948     12  ER-2614                     PIC S9(4)   VALUE +2614.
   949     12  ER-2615                     PIC S9(4)   VALUE +2615.
   950     12  ER-2616                     PIC S9(4)   VALUE +2616.
   951     12  ER-2617                     PIC S9(4)   VALUE +2617.
   952     12  ER-2618                     PIC S9(4)   VALUE +2618.
   953     12  ER-2619                     PIC S9(4)   VALUE +2619.
   954     12  ER-2620                     PIC S9(4)   VALUE +2620.
   955     12  ER-2621                     PIC S9(4)   VALUE +2621.
   956     12  ER-2622                     PIC S9(4)   VALUE +2622.
   957     12  ER-2623                     PIC S9(4)   VALUE +2623.
   958     12  ER-2624                     PIC S9(4)   VALUE +2624.
   959     12  ER-2625                     PIC S9(4)   VALUE +2625.
   960     12  ER-2626                     PIC S9(4)   VALUE +2626.
   961     12  ER-2627                     PIC S9(4)   VALUE +2627.
   962     12  ER-2628                     PIC S9(4)   VALUE +2628.
   963     12  ER-2629                     PIC S9(4)   VALUE +2629.
   964     12  ER-2630                     PIC S9(4)   VALUE +2630.
   965     12  ER-2631                     PIC S9(4)   VALUE +2631.
   966     12  ER-2632                     PIC S9(4)   VALUE +2632.
   967     12  ER-2633                     PIC S9(4)   VALUE +2633.
   968     12  ER-2634                     PIC S9(4)   VALUE +2634.
   969     12  ER-2635                     PIC S9(4)   VALUE +2635.
   970     12  ER-2636                     PIC S9(4)   VALUE +2636.
   971     12  ER-2637                     PIC S9(4)   VALUE +2637.
   972     12  ER-2638                     PIC S9(4)   VALUE +2638.
   973     12  ER-2639                     PIC S9(4)   VALUE +2639.
   974     12  ER-2640                     PIC S9(4)   VALUE +2640.
   975     12  ER-2641                     PIC S9(4)   VALUE +2641.
   976     12  ER-2642                     PIC S9(4)   VALUE +2642.
   977     12  ER-2643                     PIC S9(4)   VALUE +2643.
   978     12  ER-2644                     PIC S9(4)   VALUE +2644.
   979     12  ER-2645                     PIC S9(4)   VALUE +2645.
   980     12  ER-2646                     PIC S9(4)   VALUE +2646.
   981     12  ER-2647                     PIC S9(4)   VALUE +2647.
   982     12  ER-2648                     PIC S9(4)   VALUE +2648.
   983     12  ER-2649                     PIC S9(4)   VALUE +2649.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  19
* EL050.cbl
   984     12  ER-2650                     PIC S9(4)   VALUE +2650.
   985     12  ER-2651                     PIC S9(4)   VALUE +2651.
   986     12  ER-2652                     PIC S9(4)   VALUE +2652.
   987     12  ER-2653                     PIC S9(4)   VALUE +2653.
   988     12  ER-2654                     PIC S9(4)   VALUE +2654.
   989     12  ER-2655                     PIC S9(4)   VALUE +2655.
   990     12  ER-2656                     PIC S9(4)   VALUE +2656.
   991     12  ER-2657                     PIC S9(4)   VALUE +2657.
   992     12  ER-2658                     PIC S9(4)   VALUE +2658.
   993     12  ER-2659                     PIC S9(4)   VALUE +2659.
   994     12  ER-2660                     PIC S9(4)   VALUE +2660.
   995     12  ER-2661                     PIC S9(4)   VALUE +2661.
   996     12  ER-2662                     PIC S9(4)   VALUE +2662.
   997     12  ER-2663                     PIC S9(4)   VALUE +2663.
   998     12  ER-2664                     PIC S9(4)   VALUE +2664.
   999     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1000     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1001     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1002     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1003     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1004     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1005     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1006     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1007     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1008     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1009     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1010     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1011     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1012     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1013     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1014     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1015     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1016     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1017     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1018     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1019     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1020     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1021     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1022     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1023     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1024     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1025     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1026     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1027     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1028     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1029     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1030     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1031     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1032     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1033     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1034     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1035     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1036     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1037     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1038     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1039     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1040     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1041     12  ER-2709                     PIC S9(4)   VALUE +2709.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  20
* EL050.cbl
  1042     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1043     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1044     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1045     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1046     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1047     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1048     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1049     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1050     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1051     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1052     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1053     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1054     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1055     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1056     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1057     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1058     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1059     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1060     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1061     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1062     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1063     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1064     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1065     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1066     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1067     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1068     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1069     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1070     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1071     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1072     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1073     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1074     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1075     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1076     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1077     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1078     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1079     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1080     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1081     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1082     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1083     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1084     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1085     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1086     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1087     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1088     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1089     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1090     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1091     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1092     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1093     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1094     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1095     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1096     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1097     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1098     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1099     12  ER-2775                     PIC S9(4)   VALUE +2775.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  21
* EL050.cbl
  1100     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1101     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1102     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1103     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1104     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1105     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1106     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1107     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1108     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1109     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1110     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1111     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1112     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1113     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1114     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1115     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1116     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1117     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1118     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1119     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1120     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1121     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1122     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1123     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1124     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1125     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1126     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1127     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1128     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1129     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1130     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1131     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1132     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1133     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1134     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1135     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1136     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1137     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1138     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1139     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1140     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1141     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1142     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1143     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1144     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1145     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1146     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1147     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1148     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1149     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1150     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1151     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1152     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1153     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1154     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1155     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1156     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1157     12  ER-7815                     PIC S9(4)   VALUE +7815.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  22
* EL050.cbl
  1158     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1159     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1160     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1161     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1162     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1163     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1164     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1165     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1166     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1167     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1168     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1169     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1170     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1171     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1172     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1173     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1174     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1175     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1176     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1177     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1178     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1179     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1180     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1181     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1182     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1183     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1184     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1185     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1186     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1187     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1188     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1189     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1190     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1191     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1192     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1193     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1194     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1195     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1196     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1197     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1198     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1199     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1200     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1201     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1202     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1203     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1204     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1205     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1206     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1207     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1208     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1209     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1210     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1211     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1212     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1213     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1214     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1215     12  ER-8113                     PIC S9(4)   VALUE +8113.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  23
* EL050.cbl
  1216     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1217     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1218     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1219     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1220     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1221     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1222     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1223     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1224     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1225     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1226     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1227     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1228     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1229     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1230     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1231     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1232     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1233     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1234     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1235     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1236     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1237     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1238******************************************************************
  1239***************   END OF ELC50WS     ****************************
  1240******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  24
* EL050.cbl
  1243 01  WORKING-STORAGE-WORK-AREAS.
  1244     12  WS-RESPONSE             PIC S9(8)  COMP.
  1245         88  WS-RESP-NORMAL           VALUE +00.
  1246         88  WS-RESP-ERROR            VALUE +01.
  1247         88  WS-RESP-NOTFND           VALUE +13.
  1248         88  WS-RESP-DUPREC           VALUE +14.
  1249         88  WS-RESP-ENDFILE          VALUE +20.
  1250     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1251     12  WORK-AREAS.
  1252         16  WK-CONV-GREG.
  1253             24  WCG-CENT             PIC XX.
  1254             24  WCG-REST             PIC X(4).
  1255         16  WORK-GREGORIAN-DATE.
  1256             24  WK-GREG-CENT         PIC XX.
  1257             24  WK-GREG-DATE-YYMMDD.
  1258                 28  WK-GREG-YYMM     PIC X(4).
  1259                 28  WK-GREG-DD       PIC XX.
  1260
  1261         16  WORK-SELECT-DATE.
  1262             24  WK-SELECT-CENT            PIC XX.
  1263             24  WK-SELECT-DATE-YYMMDD.
  1264                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1265                 28  FILLER                PIC XX.
  1266
  1267         16  WK-FORM-NO.
  1268             24  WK-FORM-BANK-ID       PIC X(5).
  1269             24  WK-FORM-UNDRWRTR      PIC X(1).
  1270             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1271
  1272         16  WK-MEMBER-NO.
  1273             24  WK-MEMBER-1-6        PIC X(6).
  1274             24  WK-MEMBER-7-12       PIC X(6).
  1275
  1276         16  WK-FULL-CERT-NO.
  1277             24  WK-CERT-POS-1-2      PIC X(2).
  1278             24  WK-CERT-POS-3        PIC X(1).
  1279             24  WK-CERT-POS-4        PIC X(1).
  1280             24  WK-CERT-POS-5-6      PIC X(2).
  1281             24  WK-CERT-POS-7        PIC X(1).
  1282             24  WK-CERT-POS-8-11     PIC X(4).
  1283
  1284         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1285             88  VALID-RATE-CODE        VALUE 'Y'.
  1286             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1287
  1288         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1289         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1290         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1291         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1292         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1293         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1294         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1295         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1296         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1297         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1298
  1299* DLO001
  1300 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  25
* EL050.cbl
  1301     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1302     12  DMPF-RETURN-CODE          PIC XX.
  1303         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1304         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1305         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1306         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1307         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1308         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1309
  1310* DLO002
  1311 01  WS-DLO-INTERNAL-POLICY-FORM.
  1312     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1313     12  DIPF-RETURN-CODE          PIC XX.
  1314         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1315         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1316         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1317         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1318         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1319         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1320
  1321* DLO003
  1322 01  WS-DLO-VALID-BANK-ID.
  1323     12  DVBI-BANK-ID              PIC X(5).
  1324     12  DVBI-BANK-ID-TYPE         PIC X.
  1325         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1326         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1327         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1328         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1329         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1330     12  DVBI-RETURN-CODE          PIC XX.
  1331         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1332         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1333         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1334         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1335         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1336         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1337         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1338         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1339         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1340
  1341* DLO007
  1342 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1343     12  DCUA-RES-STATE            PIC XX.
  1344     12  DCUA-BEN-TYPE             PIC XX.
  1345     12  DCUA-SYS-IDENT            PIC X.
  1346         88  DCUA-CLAIM                        VALUE 'C'.
  1347         88  DCUA-PREMIUM                      VALUE 'P'.
  1348     12  DCUA-COVERAGE-RULE        PIC X.
  1349     12  DCUA-CLIENT-ID            PIC X(10).
  1350     12  DCUA-EFF-DATE             PIC X(8).
  1351     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1352     12  DCUA-RETURN-CODE          PIC XX.
  1353         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1354     12  DCUA-CERT-NUMBER          PIC X(11).
  1355     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1356     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1357
  1358* DLO011
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  26
* EL050.cbl
  1359 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1360     12  DPRB-RATE-CODE            PIC X(4).
  1361     12  DPRB-COVERAGE-CATEG       PIC X.
  1362     12  DPRB-RETURN-CODE          PIC XX.
  1363         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1364         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1365         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1366         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1367         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1368         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1369         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1370         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1371         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1372     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1373     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1374     12  DPRB-BEN-TYPE             PIC XX.
  1375
  1376* DLO017
  1377 01  WS-DLO-VALID-RATE-CODE.
  1378     12  DVRC-RATE-CODE            PIC X(4).
  1379     12  DVRC-RETURN-CODE          PIC XX.
  1380         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1381         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1382         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1383         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1384         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1385         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1386
  1387* DLO019
  1388 01  WS-DLO-ORIG-COV-CAT.
  1389     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1390     12  DOCC-RETURN-CODE          PIC XX.
  1391     12  DOCC-ORIG-COV-CAT         PIC X.
  1392     12  DOCC-UNDERWITER           PIC XX.
  1393     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1394     12  DOCC-FILLER               PIC X(6).
  1395
  1396* DLO021
  1397 01  WS-DLO-VALID-LOAN-OFFICER.
  1398     12  DVLO-LOAN-OFFICER.
  1399         16  DVLO-BILL-TYPE        PIC X.
  1400         16  DVLO-BILL-SOURCE      PIC X.
  1401         16  DVLO-BATCH-TYPE       PIC X.
  1402     12  DVLO-RETURN-CODE          PIC XX.
  1403         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1404         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1405         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1406         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1407         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1408         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1409
  1410* DLO022
  1411 01  WS-DLO-VALID-STATE-CODE.
  1412     12  DVSC-STATE-CODE           PIC XX.
  1413     12  DVSC-RETURN-CODE          PIC XX.
  1414         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1415
  1416* DLO023
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  27
* EL050.cbl
  1417 01  WS-DLO-VALID-CODE-VALUES.
  1418     12  DVCV-SYSTEM-ID            PIC XX.
  1419         88  DVCV-CLAIMS                       VALUE 'CL'.
  1420         88  DVCV-CREDIT                       VALUE 'CR'.
  1421     12  DVCV-RECORD-TYPE          PIC XX.
  1422         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1423         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1424         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1425         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1426         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1427         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1428         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1429         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1430     12  DVCV-RECORD-KEY           PIC X(6).
  1431     12  DVCV-RETURN-CODE          PIC XX.
  1432         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1433         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1434         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1435         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1436         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1437         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1438         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1439     12  DVCV-CODE-DESC            PIC X(60).
  1440     12  DVCV-GEN-DESC-1           PIC X(20).
  1441     12  DVCV-GEN-DESC-2           PIC X(20).
  1442     12  DVCV-GEN-DESC-3           PIC X(20).
  1443
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  28
* EL050.cbl
  1445*    COPY ERCBXRF.
  1446******************************************************************
  1447*                                                                *
  1448*                                                                *
  1449*                            ERCBXRF                             *
  1450*                                                                *
  1451*   ONLINE CREDIT SYSTEM                                         *
  1452*                                                                *
  1453*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1454*                                                                *
  1455*   FILE TYPE = VSAM,KSDS                                        *
  1456*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1457*                                                                *
  1458*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1459*       ALTERNATE PATH = NONE                                    *
  1460*                                                                *
  1461*   LOG = NO                                                     *
  1462*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1463*                                                                *
  1464******************************************************************
  1465
  1466 01  BANK-CROSS-REFERENCE.
  1467     12  BK-RECORD-ID                PIC XX.
  1468         88  VALID-BK-ID             VALUE 'BK'.
  1469
  1470     12  BK-CONTROL-PRIMARY.
  1471         16  BK-COMPANY-CD           PIC X.
  1472         16  BK-CARRIER              PIC X.
  1473         16  BK-GROUPING             PIC X(6).
  1474         16  BK-BANK-NO              PIC X(10).
  1475
  1476     12  BK-MAINT-INFORMATION.
  1477         16  BK-LAST-MAINT-DT        PIC XX.
  1478         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1479         16  BK-LAST-MAINT-USER      PIC X(4).
  1480         16  FILLER                  PIC X(9).
  1481
  1482     12  FILLER                      PIC X(37).
  1483
  1484     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1485
  1486     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1487                            DEPENDING ON BK-BANK-POINTER-CNT.
  1488         16  BK-AM-ACCOUNT           PIC X(10).
  1489         16  BK-AM-EXP-DT            PIC XX.
  1490         16  BK-AM-EFF-DT            PIC XX.
  1491         16  BK-AM-STATE             PIC XX.
  1492         16  FILLER                  PIC X(20).
  1493
  1494******************************************************************
  1495
  1496*    COPY ERCCOMP.
  1497******************************************************************
  1498*                                                                *
  1499*                                                                *
  1500*                            ERCCOMP                             *
  1501*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1502*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  29
* EL050.cbl
  1503*                                                                *
  1504*   ONLINE CREDIT SYSTEM                                         *
  1505*                                                                *
  1506*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1507*                                                                *
  1508*   FILE TYPE = VSAM,KSDS                                        *
  1509*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1510*                                                                *
  1511*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1512*       ALTERNATE PATH = NONE                                    *
  1513*                                                                *
  1514*   LOG = NO                                                     *
  1515*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1516*                                                                *
  1517******************************************************************
  1518*                   C H A N G E   L O G
  1519*
  1520* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1521*-----------------------------------------------------------------
  1522*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1523* EFFECTIVE    NUMBER
  1524*-----------------------------------------------------------------
  1525* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1526* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1527* 092205    2005050300006  PEMA  ADD LEASE FEE
  1528* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1529* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1530* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1531* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1532* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1533* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1534******************************************************************
  1535
  1536 01  COMPENSATION-MASTER.
  1537     12  CO-RECORD-ID                          PIC XX.
  1538         88  VALID-CO-ID                          VALUE 'CO'.
  1539
  1540     12  CO-CONTROL-PRIMARY.
  1541         16  CO-COMPANY-CD                     PIC X.
  1542         16  CO-CONTROL.
  1543             20  CO-CTL-1.
  1544                 24  CO-CARR-GROUP.
  1545                     28  CO-CARRIER            PIC X.
  1546                     28  CO-GROUPING.
  1547                         32  CO-GROUP-PREFIX   PIC XXX.
  1548                         32  CO-GROUP-PRIME    PIC XXX.
  1549                 24  CO-RESP-NO.
  1550                     28  CO-RESP-PREFIX        PIC X(4).
  1551                     28  CO-RESP-PRIME         PIC X(6).
  1552             20  CO-CTL-2.
  1553                 24  CO-ACCOUNT.
  1554                     28  CO-ACCT-PREFIX        PIC X(4).
  1555                     28  CO-ACCT-PRIME         PIC X(6).
  1556         16  CO-TYPE                           PIC X.
  1557             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1558             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1559             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1560
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  30
* EL050.cbl
  1561     12  CO-MAINT-INFORMATION.
  1562         16  CO-LAST-MAINT-DT                  PIC XX.
  1563         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1564         16  CO-LAST-MAINT-USER                PIC X(4).
  1565     12  FILLER                                PIC XX.
  1566     12  CO-STMT-TYPE                          PIC XXX.
  1567     12  CO-COMP-TYPE                          PIC X.
  1568         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1569     12  CO-STMT-OWNER                         PIC X(4).
  1570     12  CO-BALANCE-CONTROL                    PIC X.
  1571         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1572         88  CO-NO-BALANCE                        VALUE 'N'.
  1573
  1574     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1575         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1576         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1577         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1578
  1579     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1580         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1581         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1582
  1583     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1584     12  CO-GA-DIRECT-DEP                      PIC X.
  1585     12  CO-FUTURE-SPACE                       PIC X.
  1586         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1587
  1588     12  CO-ACCT-NAME                          PIC X(30).
  1589     12  CO-MAIL-NAME                          PIC X(30).
  1590     12  CO-ADDR-1                             PIC X(30).
  1591     12  CO-ADDR-2                             PIC X(30).
  1592     12  CO-ADDR-3.
  1593         16  CO-ADDR-CITY                      PIC X(27).
  1594         16  CO-ADDR-STATE                     PIC XX.
  1595     12  CO-CSO-1099                           PIC X.
  1596     12  CO-ZIP.
  1597         16  CO-ZIP-PRIME.
  1598             20  CO-ZIP-PRI-1ST                PIC X.
  1599                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1600             20  FILLER                        PIC X(4).
  1601         16  CO-ZIP-PLUS4                      PIC X(4).
  1602     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1603         16  CO-CAN-POSTAL-1                   PIC XXX.
  1604         16  CO-CAN-POSTAL-2                   PIC XXX.
  1605         16  FILLER                            PIC XXX.
  1606     12  CO-SOC-SEC                            PIC X(13).
  1607     12  CO-TELEPHONE.
  1608         16  CO-AREA-CODE                      PIC XXX.
  1609         16  CO-PREFIX                         PIC XXX.
  1610         16  CO-PHONE                          PIC X(4).
  1611
  1612     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1613
  1614     12  CO-AR-BAL-LEVEL                       PIC X.
  1615         88  CO-AR-REF-LVL                        VALUE '1'.
  1616         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1617         88  CO-AR-BILL-LVL                       VALUE '2'.
  1618         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  31
* EL050.cbl
  1619         88  CO-AR-FR-LVL                         VALUE '4'.
  1620
  1621     12  CO-AR-NORMAL-PRINT                    PIC X.
  1622         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1623         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1624
  1625     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1626
  1627     12  CO-AR-REPORTING                       PIC X.
  1628         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1629         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1630
  1631     12  CO-AR-PULL-CHECK                      PIC X.
  1632         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1633         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1634
  1635     12  CO-AR-BALANCE-PRINT                   PIC X.
  1636         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1637
  1638     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1639         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1640         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1641         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1642
  1643     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1644
  1645     12  CO-USER-CODE                          PIC X.
  1646     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1647
  1648******************************************************************
  1649*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1650*    THE LAST MONTH END RUN.
  1651******************************************************************
  1652
  1653     12  CO-LAST-ACTIVITY-DATE.
  1654         16  CO-ACT-YEAR                       PIC 99.
  1655         16  CO-ACT-MONTH                      PIC 99.
  1656         16  CO-ACT-DAY                        PIC 99.
  1657
  1658     12  CO-LAST-STMT-DT.
  1659         16  CO-LAST-STMT-YEAR                 PIC 99.
  1660         16  CO-LAST-STMT-MONTH                PIC 99.
  1661         16  CO-LAST-STMT-DAY                  PIC 99.
  1662
  1663     12  CO-MO-END-TOTALS.
  1664         16  CO-MONTHLY-TOTALS.
  1665             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1666             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1667             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1668             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1669             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1670
  1671         16  CO-AGING-TOTALS.
  1672             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1673             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1674             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1675             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1676
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  32
* EL050.cbl
  1677         16  CO-YTD-TOTALS.
  1678             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1679             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1680
  1681         16  CO-OVER-UNDER-TOTALS.
  1682             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1683             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1684
  1685     12  CO-MISCELLANEOUS-TOTALS.
  1686         16  CO-FICA-TOTALS.
  1687             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1688             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1689
  1690         16  CO-CLAIM-TOTALS.
  1691             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1692             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1693
  1694******************************************************************
  1695*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1696*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1697******************************************************************
  1698
  1699     12  CO-CURRENT-TOTALS.
  1700         16  CO-CURRENT-LAST-STMT-DT.
  1701             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1702             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1703             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1704
  1705         16  CO-CURRENT-MONTHLY-TOTALS.
  1706             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1707             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1708             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1709             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1710             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1711
  1712         16  CO-CURRENT-AGING-TOTALS.
  1713             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1714             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1715             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1716             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1717
  1718         16  CO-CURRENT-YTD-TOTALS.
  1719             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1720             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1721
  1722     12  CO-PAID-COMM-TOTALS.
  1723         16  CO-YTD-PAID-COMMS.
  1724             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1725             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1726
  1727     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1728         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1729         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1730
  1731     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1732         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1733         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1734         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  33
* EL050.cbl
  1735         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1736         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1737         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1738         88  CO-FINAL-LETTER                  VALUE 'F'.
  1739         88  CO-RECONCILING                   VALUE 'R'.
  1740         88  CO-PHONE-CALL                    VALUE 'P'.
  1741         88  CO-LEGAL                         VALUE 'L'.
  1742         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1743         88  CO-WRITE-OFF                     VALUE 'W'.
  1744         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1745
  1746     12  CO-CSR-CODE                       PIC X(4).
  1747
  1748     12  CO-GA-STATUS-INFO.
  1749         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1750         16  CO-GA-TERMINATION-DT          PIC XX.
  1751         16  CO-GA-STATUS-CODE             PIC X.
  1752             88  CO-GA-ACTIVE                 VALUE 'A'.
  1753             88  CO-GA-INACTIVE               VALUE 'I'.
  1754             88  CO-GA-PENDING                VALUE 'P'.
  1755         16  CO-GA-COMMENTS.
  1756             20  CO-GA-COMMENT-1           PIC X(40).
  1757             20  CO-GA-COMMENT-2           PIC X(40).
  1758             20  CO-GA-COMMENT-3           PIC X(40).
  1759             20  CO-GA-COMMENT-4           PIC X(40).
  1760
  1761     12  CO-RPTCD2                         PIC X(10).
  1762     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1763         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1764         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1765
  1766     12  CO-TYPE-AGENT                     PIC X(01).
  1767         88  CO-CORPORATION                   VALUE 'C'.
  1768         88  CO-PARTNERSHIP                   VALUE 'P'.
  1769         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1770         88  CO-TRUST                         VALUE 'T'.
  1771         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1772
  1773     12  CO-FAXNO.
  1774         16  CO-FAX-AREA-CODE                  PIC XXX.
  1775         16  CO-FAX-PREFIX                     PIC XXX.
  1776         16  CO-FAX-PHONE                      PIC X(4).
  1777
  1778     12  CO-BANK-INFORMATION.
  1779         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1780         16  CO-BANK-TRANSIT-NON REDEFINES
  1781             CO-BANK-TRANSIT-NO                PIC 9(8).
  1782
  1783         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1784     12  CO-MISC-DEDUCT-INFO REDEFINES
  1785                  CO-BANK-INFORMATION.
  1786         16  CO-MD-GL-ACCT                     PIC X(10).
  1787         16  CO-MD-DIV                         PIC XX.
  1788         16  CO-MD-CENTER                      PIC X(4).
  1789         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1790         16  CO-CREATE-AP-CHECK                PIC X.
  1791         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1792         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  34
* EL050.cbl
  1793     12  CO-ACH-STATUS                         PIC X.
  1794         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1795         88  CO-ACH-PENDING                        VALUE 'P'.
  1796
  1797     12  CO-BILL-SW                            PIC X.
  1798     12  CO-CONTROL-NAME                       PIC X(30).
  1799     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1800     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1801     12  CO-CLP-STATE                          PIC XX.
  1802     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1803     12  CO-SPP-REFUND-EDIT                    PIC X.
  1804
  1805******************************************************************
  1806
  1807*    COPY ERCAGTC.
  1808******************************************************************
  1809*                                                                *
  1810*                                                                *
  1811*                            ERCAGTC                             *
  1812*                            VMOD=2.001                          *
  1813*                                                                *
  1814*   ONLINE CREDIT SYSTEM                                         *
  1815*                                                                *
  1816*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1817*                                                                *
  1818*   FILE TYPE = VSAM,KSDS                                        *
  1819*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1820*                                                                *
  1821*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1822*       ALTERNATE PATH = NONE                                    *
  1823*                                                                *
  1824*   LOG = NO                                                     *
  1825*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1826*                                                                *
  1827******************************************************************
  1828*                   C H A N G E   L O G
  1829*
  1830* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1831*-----------------------------------------------------------------
  1832*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1833* EFFECTIVE    NUMBER
  1834*-----------------------------------------------------------------
  1835* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1836* 111004                         NEW FILE AND COPYBOOK
  1837* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1838******************************************************************
  1839 01  AGENT-COMMISSIONS.
  1840     12  AG-RECORD-ID                          PIC XX.
  1841         88  VALID-CO-ID                          VALUE 'AG'.
  1842     12  AG-CONTROL-PRIMARY.
  1843         16  AG-COMPANY-CD                     PIC X.
  1844         16  AG-CONTROL.
  1845             20  AG-CTL-1.
  1846                 24  AG-CARR-GROUP.
  1847                     28  AG-CARRIER            PIC X.
  1848                     28  AG-GROUPING           PIC X(6).
  1849                 24  AG-BANK                   PIC X(10).
  1850             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  35
* EL050.cbl
  1851                 24  AG-EXP-DT                 PIC XX.
  1852         16  AG-TYPE                           PIC X.
  1853             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1854             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1855     12  AG-MAINT-INFORMATION.
  1856         16  AG-LAST-MAINT-DT                  PIC XX.
  1857         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1858         16  AG-LAST-MAINT-USER                PIC X(4).
  1859         16  FILLER                            PIC X(10).
  1860     12  AG-EFF-DT                             PIC XX.
  1861     12  AG-COMM-STRUCTURE.
  1862         16  AG-AGT-COMMS OCCURS 10.
  1863             20  AG-AGT                PIC X(10).
  1864             20  AG-COM-TYP            PIC X.
  1865             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1866             20  AG-RECALC-LV-INDIC    PIC X.
  1867             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1868             20  AG-LRCALC-LV-INDIC    PIC X.
  1869             20  FILLER                PIC X(05).
  1870     12  FILLER                  PIC X(145).
  1871******************************************************************
  1872*    COPY ERCRESS.
  1873******************************************************************
  1874*                                                                *
  1875*                            ERCRESS                             *
  1876*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1877*                            VMOD=2.002                          *
  1878*                                                                *
  1879*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1880*                                                                *
  1881*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1882*   VSAM RESIDENT STATE TAX MASTER                              *
  1883*                                                                *
  1884*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1885*                                                                *
  1886*   FILE TYPE = VSAM,KSDS                                        *
  1887*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1888*                                                                *
  1889*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1890*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1891*                                                                *
  1892*   LOG = NO                                                     *
  1893*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1894*                                                                *
  1895*                                                                *
  1896******************************************************************
  1897
  1898 01  RESIDENT-STATE-TAX-MASTER.
  1899
  1900     10  ERRESS-PRIMARY-KEY.
  1901         15  RES-COMPANY-CD        PIC X.
  1902         15  RES-RESIDENT-STATE    PIC XX.
  1903         15  RES-COVERAGE-CATEGORY PIC X.
  1904         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1905*                                      YYYYMMDD
  1906*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1907
  1908     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  36
* EL050.cbl
  1909
  1910         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1911         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1912         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1913         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1914
  1915     10 RES-RECALC-SW              PIC   X.
  1916         88 RECALC                VALUE 'Y'.
  1917         88 NO-RECALC             VALUE 'N'.
  1918     10  RES-MAINT-BY              PIC X(4).
  1919     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1920     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1921*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  37
* EL050.cbl
  1923*    COPY ERCRESC.
  1924******************************************************************
  1925*                                                                *
  1926*                            ERCRESC                             *
  1927*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1928*                            VMOD=2.003                          *
  1929*                                                                *
  1930*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1931*                                                                *
  1932*   FILE TYPE = VSAM,KSDS                                        *
  1933*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1934*                                                                *
  1935*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1936*       ALTERNATE PATH1 = NONE                                   *
  1937*                                                                *
  1938*   LOG = NO                                                     *
  1939*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1940*                                                                *
  1941******************************************************************
  1942
  1943 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1944
  1945     10  ERRESC-RECORD-KEY.
  1946         15  RESC-COMPANY-CD           PIC   X.
  1947         15  RESC-CARRIER              PIC   X.
  1948         15  RESC-GROUP                PIC   X(6).
  1949         15  RESC-STATE                PIC   XX.
  1950         15  RESC-ACCOUNT              PIC   X(10).
  1951         15  RESC-AGENT                PIC   X(10).
  1952         15  RESC-RESIDENT-STATE       PIC   XX.
  1953         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1954*                                           YYYYMMDD
  1955     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1956
  1957     10  RESC-COMM-RECORD-DATA.
  1958         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1959             20 RESC-COVERAGE-CAT      PIC    X.
  1960             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1961             20 RESC-COMMISSION-TAB REDEFINES
  1962                RESC-COMMISSION-PER    PIC  XXX.
  1963
  1964     10  RESC-MAINT-BY                 PIC X(4).
  1965     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1966     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1967*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  38
* EL050.cbl
  1969*    COPY ERCPLAN.
  1970******************************************************************
  1971*                                                                *
  1972*                                                                *
  1973*                            ERCPLAN                             *
  1974*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1975*                            VMOD=2.003                          *
  1976*                                                                *
  1977*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  1978*                                                                *
  1979*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  1980*   PLAN MASTER                                                  *
  1981*                                                                *
  1982*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  1983*                                                                *
  1984*   FILE TYPE = VSAM,KSDS                                        *
  1985*   RECORD SIZE = 420   RECFORM = FIX                            *
  1986*                                                                *
  1987*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  1988*       ALTERNATE PATH1 = N/A                                    *
  1989*                                                                *
  1990*   LOG = NO                                                     *
  1991*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1992*                                                                *
  1993*                                                                *
  1994******************************************************************
  1995
  1996 01  PLAN-MASTER.
  1997     12  PL-RECORD-ID                      PIC XX.
  1998         88  VALID-PL-ID                      VALUE 'PL'.
  1999
  2000     12  PL-CONTROL-PRIMARY.
  2001         16  PL-COMPANY-CD                 PIC X.
  2002         16  PL-MSTR-CNTRL.
  2003             20  PL-CONTROL-A.
  2004                 24  PL-CARRIER            PIC X.
  2005                 24  PL-GROUPING           PIC X(6).
  2006                 24  PL-STATE              PIC XX.
  2007                 24  PL-ACCOUNT            PIC X(10).
  2008             20  PL-BENEFIT-TYPE           PIC X.
  2009             20  PL-BENEFIT-CODE           PIC XX.
  2010             20  PL-REVISION-NO            PIC X(3).
  2011
  2012     12  PL-CONTROL-BY-VAR-GRP.
  2013         16  PL-COMPANY-CD-A1              PIC X.
  2014         16  PL-VG-CARRIER                 PIC X.
  2015         16  PL-VG-GROUPING                PIC X(6).
  2016         16  PL-VG-STATE                   PIC XX.
  2017         16  PL-VG-ACCOUNT                 PIC X(10).
  2018         16  PL-BENEFIT-TYPE-A1            PIC X.
  2019         16  PL-BENEFIT-CODE-A1            PIC XX.
  2020         16  PL-REVISION-NO-A1             PIC 999.
  2021
  2022     12  PL-MAINT-INFORMATION.
  2023         16  PL-LAST-MAINT-DT              PIC XX.
  2024         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2025         16  PL-LAST-MAINT-USER            PIC X(4).
  2026         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  39
* EL050.cbl
  2027
  2028     12  PL-LIABILITY-LIMITS.
  2029         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2030         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2031             20  PL-LM-AGE                 PIC S99        COMP-3.
  2032             20  PL-LM-DUR                 PIC S999       COMP-3.
  2033             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2034             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2035
  2036     12  FILLER                            PIC X(30).
  2037
  2038     12  PL-GL-ACCOUNT-NOS.
  2039         16  PL-PREMIUM-GL                 PIC X(8).
  2040         16  PL-COMM-GL                    PIC X(8).
  2041         16  PL-CLAIM-GL                   PIC X(8).
  2042     12  FILLER                            PIC X(24).
  2043     12  PL-TOLERANCES.
  2044         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2045         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2046         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2047         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2048         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2049         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2050     12  PL-OVER-SHORT.
  2051         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2052         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2053     12  FILLER                            PIC X(24).
  2054     12  PLAN-MISC.
  2055         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2056         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2057         16  PL-IG                         PIC X.
  2058         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2059         16  PL-POLICY-FORM                PIC X(12).
  2060         16  PL-EDIT-FOR-FORM              PIC X(01).
  2061         16  PL-DEV-CODE                   PIC XXX.
  2062         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2063         16  PL-CALC-METHOD                PIC X.
  2064         16  PL-BENEFIT-GROUP              PIC X(05).
  2065         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2066
  2067         16  FILLER                        PIC X(99).
  2068******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  40
* EL050.cbl
  2070*    COPY ELCCERT.
  2071******************************************************************
  2072*                                                                *
  2073*                            ELCCERT.                            *
  2074*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2075*                            VMOD=2.013                          *
  2076*                                                                *
  2077*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2078*                                                                *
  2079*   FILE TYPE = VSAM,KSDS                                        *
  2080*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2081*                                                                *
  2082*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2083*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2084*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2085*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2086*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2087*                                                                *
  2088*   LOG = YES                                                    *
  2089*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2090******************************************************************
  2091*                   C H A N G E   L O G
  2092*
  2093* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2094*-----------------------------------------------------------------
  2095*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2096* EFFECTIVE    NUMBER
  2097*-----------------------------------------------------------------
  2098* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2099* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2100* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2101* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2102* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2103* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2104* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2105* 032612  CR2011110200001  PEMA  AHL CHANGES
  2106******************************************************************
  2107
  2108 01  CERTIFICATE-MASTER.
  2109     12  CM-RECORD-ID                      PIC XX.
  2110         88  VALID-CM-ID                      VALUE 'CM'.
  2111
  2112     12  CM-CONTROL-PRIMARY.
  2113         16  CM-COMPANY-CD                 PIC X.
  2114         16  CM-CARRIER                    PIC X.
  2115         16  CM-GROUPING.
  2116             20  CM-GROUPING-PREFIX        PIC X(3).
  2117             20  CM-GROUPING-PRIME         PIC X(3).
  2118         16  CM-STATE                      PIC XX.
  2119         16  CM-ACCOUNT.
  2120             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2121             20  CM-ACCOUNT-PRIME          PIC X(6).
  2122         16  CM-CERT-EFF-DT                PIC XX.
  2123         16  CM-CERT-NO.
  2124             20  CM-CERT-PRIME             PIC X(10).
  2125             20  CM-CERT-SFX               PIC X.
  2126
  2127     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  41
* EL050.cbl
  2128         16  CM-COMPANY-CD-A1              PIC X.
  2129         16  CM-INSURED-LAST-NAME          PIC X(15).
  2130         16  CM-INSURED-INITIALS.
  2131             20  CM-INSURED-INITIAL1       PIC X.
  2132             20  CM-INSURED-INITIAL2       PIC X.
  2133
  2134     12  CM-CONTROL-BY-SSN.
  2135         16  CM-COMPANY-CD-A2              PIC X.
  2136         16  CM-SOC-SEC-NO.
  2137             20  CM-SSN-STATE              PIC XX.
  2138             20  CM-SSN-ACCOUNT            PIC X(6).
  2139             20  CM-SSN-LN3.
  2140                 25  CM-INSURED-INITIALS-A2.
  2141                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2142                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2143                 25 CM-PART-LAST-NAME-A2         PIC X.
  2144
  2145     12  CM-CONTROL-BY-CERT-NO.
  2146         16  CM-COMPANY-CD-A4              PIC X.
  2147         16  CM-CERT-NO-A4                 PIC X(11).
  2148
  2149     12  CM-CONTROL-BY-MEMB.
  2150         16  CM-COMPANY-CD-A5              PIC X.
  2151         16  CM-MEMBER-NO.
  2152             20  CM-MEMB-STATE             PIC XX.
  2153             20  CM-MEMB-ACCOUNT           PIC X(6).
  2154             20  CM-MEMB-LN4.
  2155                 25  CM-INSURED-INITIALS-A5.
  2156                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2157                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2158                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2159
  2160     12  CM-INSURED-PROFILE-DATA.
  2161         16  CM-INSURED-FIRST-NAME.
  2162             20  CM-INSURED-1ST-INIT       PIC X.
  2163             20  FILLER                    PIC X(9).
  2164         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2165         16  CM-INSURED-SEX                PIC X.
  2166             88  CM-SEX-MALE                  VALUE 'M'.
  2167             88  CM-SEX-FEMAL                 VALUE 'F'.
  2168         16  CM-INSURED-JOINT-AGE          PIC 99.
  2169         16  CM-JOINT-INSURED-NAME.
  2170             20  CM-JT-LAST-NAME           PIC X(15).
  2171             20  CM-JT-FIRST-NAME.
  2172                 24  CM-JT-1ST-INIT        PIC X.
  2173                 24  FILLER                PIC X(9).
  2174             20  CM-JT-INITIAL             PIC X.
  2175
  2176     12  CM-LIFE-DATA.
  2177         16  CM-LF-BENEFIT-CD              PIC XX.
  2178         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2179         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2180         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2181         16  CM-LF-DEV-CODE                PIC XXX.
  2182         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2183         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2184         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2185         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  42
* EL050.cbl
  2186         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2187         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2188         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2189         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2190         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2191         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2192         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2193         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2194         16  FILLER                        PIC XX.
  2195
  2196     12  CM-AH-DATA.
  2197         16  CM-AH-BENEFIT-CD              PIC XX.
  2198         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2199         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2200         16  CM-AH-DEV-CODE                PIC XXX.
  2201         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2202         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2203         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2204         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2205         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2206         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2207         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2208         16  CM-AH-PAID-THRU-DT            PIC XX.
  2209             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2210         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2211         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2212         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2213         16  FILLER                        PIC X.
  2214
  2215     12  CM-LOAN-INFORMATION.
  2216         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2217         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2218                                           PIC S9(5)V99  COMP-3.
  2219         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2220         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2221         16  CM-PAY-FREQUENCY              PIC S99.
  2222         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2223         16  CM-RATE-CLASS                 PIC XX.
  2224         16  CM-BENEFICIARY                PIC X(25).
  2225         16  CM-POLICY-FORM-NO             PIC X(12).
  2226         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2227         16  CM-LAST-ADD-ON-DT             PIC XX.
  2228         16  CM-DEDUCTIBLE-AMOUNTS.
  2229             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2230             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2231         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2232             20  CM-RESIDENT-STATE         PIC XX.
  2233             20  CM-RATE-CODE              PIC X(4).
  2234             20  FILLER                    PIC XX.
  2235         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2236             20  CM-LOAN-OFFICER           PIC X(5).
  2237             20  FILLER                    PIC XXX.
  2238         16  CM-CSR-CODE                   PIC XXX.
  2239         16  CM-UNDERWRITING-CODE          PIC X.
  2240             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  2241         16  CM-POST-CARD-IND              PIC X.
  2242         16  CM-NH-INTERFACE-SW            PIC X.
  2243         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  43
* EL050.cbl
  2244             88  CM-SING-PRM                  VALUE '1'.
  2245             88  CM-O-B-COVERAGE              VALUE '2'.
  2246             88  CM-OPEN-END                  VALUE '3'.
  2247         16  CM-IND-GRP-TYPE               PIC X.
  2248             88  CM-INDIVIDUAL                VALUE 'I'.
  2249             88  CM-GROUP                     VALUE 'G'.
  2250         16  CM-SKIP-CODE                  PIC X.
  2251             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2252             88  SKIP-JULY                    VALUE '1'.
  2253             88  SKIP-AUGUST                  VALUE '2'.
  2254             88  SKIP-SEPTEMBER               VALUE '3'.
  2255             88  SKIP-JULY-AUG                VALUE '4'.
  2256             88  SKIP-AUG-SEPT                VALUE '5'.
  2257             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2258             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2259             88  SKIP-JUNE                    VALUE '8'.
  2260             88  SKIP-JUNE-JULY               VALUE '9'.
  2261             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2262             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2263         16  CM-PAYMENT-MODE               PIC X.
  2264             88  PAY-MONTHLY                  VALUE SPACE.
  2265             88  PAY-WEEKLY                   VALUE '1'.
  2266             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2267             88  PAY-BI-WEEKLY                VALUE '3'.
  2268             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2269         16  CM-LOAN-NUMBER                PIC X(8).
  2270         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2271         16  CM-OLD-LOF                    PIC XXX.
  2272*        16  CM-LOAN-OFFICER               PIC XXX.
  2273         16  CM-REIN-TABLE                 PIC XXX.
  2274         16  CM-SPECIAL-REIN-CODE          PIC X.
  2275         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2276         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2277         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2278
  2279     12  CM-STATUS-DATA.
  2280         16  CM-ENTRY-STATUS               PIC X.
  2281         16  CM-ENTRY-DT                   PIC XX.
  2282
  2283         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2284         16  CM-LF-CANCEL-DT               PIC XX.
  2285         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2286
  2287         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2288         16  CM-LF-DEATH-DT                PIC XX.
  2289         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2290
  2291         16  CM-LF-CURRENT-STATUS          PIC X.
  2292             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2293                                                'M' '4' '5' '9'.
  2294             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2295             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2296             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2297             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2298             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  2299             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2300             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2301             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  44
* EL050.cbl
  2302             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2303             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2304             88  CM-LF-DECLINED               VALUE 'D'.
  2305             88  CM-LF-VOIDED                 VALUE 'V'.
  2306
  2307         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2308         16  CM-AH-CANCEL-DT               PIC XX.
  2309         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2310
  2311         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2312         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2313         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2314
  2315         16  CM-AH-CURRENT-STATUS          PIC X.
  2316             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2317                                                'M' '4' '5' '9'.
  2318             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2319             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2320             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2321             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2322             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2323             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2324             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2325             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2326             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2327             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2328             88  CM-AH-DECLINED               VALUE 'D'.
  2329             88  CM-AH-VOIDED                 VALUE 'V'.
  2330
  2331         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2332             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2333             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2334             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2335         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2336
  2337         16  CM-ENTRY-BATCH                PIC X(6).
  2338         16  CM-LF-EXIT-BATCH              PIC X(6).
  2339         16  CM-AH-EXIT-BATCH              PIC X(6).
  2340         16  CM-LAST-MONTH-END             PIC XX.
  2341
  2342     12  CM-NOTE-SW                        PIC X.
  2343         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2344         88  CERT-NOTES-PRESENT               VALUE '1'.
  2345         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2346         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2347         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2348         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2349         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2350         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2351     12  CM-COMP-EXCP-SW                   PIC X.
  2352         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2353         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2354     12  CM-INSURED-ADDRESS-SW             PIC X.
  2355         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2356         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2357
  2358*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2359     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  45
* EL050.cbl
  2360     12  FILLER                            PIC X.
  2361
  2362*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2363     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2364     12  FILLER                            PIC X.
  2365*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2366     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2367
  2368     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2369         88  CERT-ADDED-BATCH                 VALUE ' '.
  2370         88  CERT-ADDED-ONLINE                VALUE '1'.
  2371         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2372         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2373         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2374     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2375         88  CERT-AS-LOADED                   VALUE ' '.
  2376         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2377         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2378         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2379         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2380         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2381         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2382         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2383
  2384     12  CM-ACCOUNT-COMM-PCTS.
  2385         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2386         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2387
  2388     12  CM-USER-FIELD                     PIC X.
  2389     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2390     12  CM-CLP-STATE                      PIC XX.
  2391     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2392     12  CM-USER-RESERVED                  PIC XXX.
  2393     12  FILLER REDEFINES CM-USER-RESERVED.
  2394         16  CM-AH-CLASS-CD                PIC XX.
  2395         16  F                             PIC X.
  2396******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  46
* EL050.cbl
  2398*    COPY ERCMAIL.
  2399******************************************************************
  2400*                                                                *
  2401*                                                                *
  2402*                            ERCMAIL                             *
  2403*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2404*                            VMOD=2.003                          *
  2405*                                                                *
  2406*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2407*                                                                *
  2408*   FILE TYPE = VSAM,KSDS                                        *
  2409*   RECORD SIZE = 374   RECFORM = FIX                            *
  2410*                                                                *
  2411*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2412*   ALTERNATE PATH    = NOT USED                                 *
  2413*                                                                *
  2414*   LOG = YES                                                    *
  2415*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2416******************************************************************
  2417*                   C H A N G E   L O G
  2418*
  2419* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2420*-----------------------------------------------------------------
  2421*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2422* EFFECTIVE    NUMBER
  2423*-----------------------------------------------------------------
  2424* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2425* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2426* 111108                   PEMA  ADD CRED BENE ADDR2
  2427******************************************************************
  2428
  2429 01  MAILING-DATA.
  2430     12  MA-RECORD-ID                      PIC XX.
  2431         88  VALID-MA-ID                       VALUE 'MA'.
  2432
  2433     12  MA-CONTROL-PRIMARY.
  2434         16  MA-COMPANY-CD                 PIC X.
  2435         16  MA-CARRIER                    PIC X.
  2436         16  MA-GROUPING.
  2437             20  MA-GROUPING-PREFIX        PIC XXX.
  2438             20  MA-GROUPING-PRIME         PIC XXX.
  2439         16  MA-STATE                      PIC XX.
  2440         16  MA-ACCOUNT.
  2441             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2442             20  MA-ACCOUNT-PRIME          PIC X(6).
  2443         16  MA-CERT-EFF-DT                PIC XX.
  2444         16  MA-CERT-NO.
  2445             20  MA-CERT-PRIME             PIC X(10).
  2446             20  MA-CERT-SFX               PIC X.
  2447
  2448     12  FILLER                            PIC XX.
  2449
  2450     12  MA-ACCESS-CONTROL.
  2451         16  MA-SOURCE-SYSTEM              PIC XX.
  2452             88  MA-FROM-CREDIT                VALUE 'CR'.
  2453             88  MA-FROM-VSI                   VALUE 'VS'.
  2454             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2455             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  47
* EL050.cbl
  2456         16  MA-RECORD-ADD-DT              PIC XX.
  2457         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2458         16  MA-LAST-MAINT-DT              PIC XX.
  2459         16  MA-LAST-MAINT-BY              PIC XXXX.
  2460         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2461
  2462     12  MA-PROFILE-INFO.
  2463         16  MA-QUALIFY-CODE-1             PIC XX.
  2464         16  MA-QUALIFY-CODE-2             PIC XX.
  2465         16  MA-QUALIFY-CODE-3             PIC XX.
  2466         16  MA-QUALIFY-CODE-4             PIC XX.
  2467         16  MA-QUALIFY-CODE-5             PIC XX.
  2468
  2469         16  MA-INSURED-LAST-NAME          PIC X(15).
  2470         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2471         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2472         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2473         16  MA-INSURED-BIRTH-DT           PIC XX.
  2474         16  MA-INSURED-SEX                PIC X.
  2475             88  MA-SEX-MALE                   VALUE 'M'.
  2476             88  MA-SEX-FEMALE                 VALUE 'F'.
  2477         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2478
  2479         16  MA-ADDRESS-CORRECTED          PIC X.
  2480         16  MA-JOINT-BIRTH-DT             PIC XX.
  2481*        16  FILLER                        PIC X(12).
  2482
  2483         16  MA-ADDRESS-LINE-1             PIC X(30).
  2484         16  MA-ADDRESS-LINE-2             PIC X(30).
  2485         16  MA-CITY-STATE.
  2486             20  MA-CITY                   PIC X(28).
  2487             20  MA-ADDR-STATE             PIC XX.
  2488         16  MA-ZIP.
  2489             20  MA-ZIP-CODE.
  2490                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2491                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2492                 24  FILLER                PIC X(4).
  2493             20  MA-ZIP-PLUS4              PIC X(4).
  2494         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2495             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2496             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2497             20  FILLER                    PIC X(3).
  2498
  2499         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2500
  2501         16  FILLER                        PIC XXX.
  2502*        16  FILLER                        PIC X(10).
  2503
  2504     12  MA-CRED-BENE-INFO.
  2505         16  MA-CRED-BENE-NAME                 PIC X(25).
  2506         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2507         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2508         16  MA-CRED-BENE-CTYST.
  2509             20  MA-CRED-BENE-CITY             PIC X(28).
  2510             20  MA-CRED-BENE-STATE            PIC XX.
  2511         16  MA-CRED-BENE-ZIP.
  2512             20  MA-CB-ZIP-CODE.
  2513                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  48
* EL050.cbl
  2514                     88  MA-CB-CANADIAN-POST-CODE
  2515                                           VALUE 'A' THRU 'Z'.
  2516                 24  FILLER                    PIC X(4).
  2517             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2518         16  MA-CB-CANADIAN-POSTAL-CODE
  2519                            REDEFINES MA-CRED-BENE-ZIP.
  2520             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2521             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2522             20  FILLER                        PIC X(3).
  2523     12  MA-POST-CARD-MAIL-DATA.
  2524         16  MA-MAIL-DATA OCCURS 7.
  2525             20  MA-MAIL-TYPE              PIC X.
  2526                 88  MA-12MO-MAILING           VALUE '1'.
  2527                 88  MA-EXP-MAILING            VALUE '2'.
  2528             20  MA-MAIL-STATUS            PIC X.
  2529                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2530                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2531                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2532             20  MA-MAIL-DATE              PIC XX.
  2533     12  FILLER                            PIC XX.
  2534     12  FILLER                            PIC XX.
  2535*    12  FILLER                            PIC X(30).
  2536******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  49
* EL050.cbl
  2538*    COPY ERCPNDM.
  2539******************************************************************
  2540*                                                                *
  2541*                                                                *
  2542*                            ERCPNDM                             *
  2543*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2544*                            VMOD=2.003                          *
  2545*                                                                *
  2546*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2547*                                                                *
  2548*   FILE TYPE = VSAM,KSDS                                        *
  2549*   RECORD SIZE = 374   RECFORM = FIX                            *
  2550*                                                                *
  2551*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2552*   ALTERNATE PATH    = NOT USED                                 *
  2553*                                                                *
  2554*   LOG = YES                                                    *
  2555*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2556******************************************************************
  2557*                   C H A N G E   L O G
  2558*
  2559* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2560*-----------------------------------------------------------------
  2561*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2562* EFFECTIVE    NUMBER
  2563*-----------------------------------------------------------------
  2564* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2565* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2566* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2567******************************************************************
  2568
  2569 01  PENDING-MAILING-DATA.
  2570     12  PM-RECORD-ID                      PIC XX.
  2571         88  VALID-MA-ID                       VALUE 'PM'.
  2572
  2573     12  PM-CONTROL-PRIMARY.
  2574         16  PM-COMPANY-CD                 PIC X.
  2575         16  PM-ENTRY-BATCH                PIC X(6).
  2576         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2577         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2578
  2579     12  FILLER                            PIC X(14).
  2580
  2581     12  PM-ACCESS-CONTROL.
  2582         16  PM-SOURCE-SYSTEM              PIC XX.
  2583             88  PM-FROM-CREDIT                VALUE 'CR'.
  2584             88  PM-FROM-VSI                   VALUE 'VS'.
  2585             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2586             88  PM-FROM-OTHER                 VALUE 'OT'.
  2587         16  PM-RECORD-ADD-DT              PIC XX.
  2588         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2589         16  PM-LAST-MAINT-DT              PIC XX.
  2590         16  PM-LAST-MAINT-BY              PIC XXXX.
  2591         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2592
  2593     12  PM-PROFILE-INFO.
  2594         16  PM-QUALIFY-CODE-1             PIC XX.
  2595         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  50
* EL050.cbl
  2596         16  PM-QUALIFY-CODE-3             PIC XX.
  2597         16  PM-QUALIFY-CODE-4             PIC XX.
  2598         16  PM-QUALIFY-CODE-5             PIC XX.
  2599
  2600         16  PM-INSURED-LAST-NAME          PIC X(15).
  2601         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2602         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2603         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2604         16  PM-INSURED-BIRTH-DT           PIC XX.
  2605         16  PM-INSURED-SEX                PIC X.
  2606             88  PM-SEX-MALE                   VALUE 'M'.
  2607             88  PM-SEX-FEMALE                 VALUE 'F'.
  2608         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2609
  2610         16  PM-ADDRESS-CORRECTED          PIC X.
  2611         16  PM-JOINT-BIRTH-DT             PIC XX.
  2612*        16  FILLER                        PIC X(12).
  2613
  2614         16  PM-ADDRESS-LINE-1             PIC X(30).
  2615         16  PM-ADDRESS-LINE-2             PIC X(30).
  2616         16  PM-CITY-STATE.
  2617             20  PM-CITY                   PIC X(28).
  2618             20  PM-STATE                  PIC XX.
  2619         16  PM-ZIP.
  2620             20  PM-ZIP-CODE.
  2621                 24  PM-ZIP-1              PIC X.
  2622                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2623                 24  FILLER                PIC X(4).
  2624             20  PM-ZIP-PLUS4              PIC X(4).
  2625         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2626             20  PM-CAN-POST1              PIC XXX.
  2627             20  PM-CAN-POST2              PIC XXX.
  2628             20  FILLER                    PIC XXX.
  2629
  2630         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2631
  2632         16  FILLER                        PIC X(03).
  2633
  2634     12  PM-CRED-BENE-INFO.
  2635         16  PM-CRED-BENE-NAME             PIC X(25).
  2636         16  PM-CRED-BENE-ADDR             PIC X(30).
  2637         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2638         16  PM-CRED-BENE-CTYST.
  2639             20  PM-CRED-BENE-CITY         PIC X(28).
  2640             20  PM-CRED-BENE-STATE        PIC XX.
  2641         16  PM-CRED-BENE-ZIP.
  2642             20  PM-CB-ZIP-CODE.
  2643                 24  PM-CB-ZIP-1           PIC X.
  2644                     88  PM-CB-CANADIAN-POST-CODE
  2645                                  VALUE 'A' THRU 'Z'.
  2646                 24  FILLER                PIC X(4).
  2647             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2648         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2649             20  PM-CB-CAN-POST1           PIC XXX.
  2650             20  PM-CB-CAN-POST2           PIC XXX.
  2651             20  FILLER                    PIC XXX.
  2652     12  PM-POST-CARD-MAIL-DATA.
  2653         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  51
* EL050.cbl
  2654             20  PM-MAIL-TYPE              PIC X.
  2655                 88  PM-12MO-MAILING           VALUE '1'.
  2656                 88  PM-EXP-MAILING            VALUE '2'.
  2657             20  PM-MAIL-STATUS            PIC X.
  2658                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2659                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2660                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2661             20  PM-MAIL-DATE              PIC XX.
  2662     12  FILLER                            PIC XX.
  2663     12  FILLER                            PIC X(12).
  2664*    12  FILLER                            PIC X(30).
  2665
  2666******************************************************************
  2667*                                COPY ERCLOFC.
  2668******************************************************************
  2669*                                                                *
  2670*                                                                *
  2671*                            ERCLOFC                             *
  2672*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2673*                            VMOD=2.003                          *
  2674*                                                                *
  2675*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2676*                                                                *
  2677*   FILE TYPE = VSAM,KSDS                                        *
  2678*   RECORD SIZE = 670   RECFORM = FIX                            *
  2679*                                                                *
  2680*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2681*                                                                *
  2682*   LOG = YES                                                    *
  2683*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2684*                                                                *
  2685******************************************************************
  2686
  2687 01  LOAN-OFFICER-MASTER.
  2688     12  LO-RECORD-ID                PIC XX.
  2689         88  VALID-LO-ID                VALUE 'LO'.
  2690
  2691     12  LO-CONTROL-PRIMARY.
  2692         16  LO-COMPANY-CD           PIC X.
  2693         16  LO-CARRIER              PIC X.
  2694         16  LO-GROUPING.
  2695             20  LO-GROUPING-PREFIX  PIC XXX.
  2696             20  LO-GROUPING-PRIME   PIC XXX.
  2697         16  LO-STATE                PIC XX.
  2698         16  LO-ACCOUNT.
  2699             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2700             20  LO-ACCOUNT-PRIME    PIC X(6).
  2701         16  LO-OFFICER-CODE         PIC X(5).
  2702
  2703     12  LO-OFFICER-NAME             PIC X(30).
  2704
  2705     12  LO-LAST-MAINT-DT            PIC XX.
  2706     12  LO-LAST-USER                PIC X(4).
  2707     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2708
  2709     12  LO-COMP-CONTROL             PIC X.
  2710             88  LO-SHOW-COMP           VALUE 'Y'.
  2711             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  52
* EL050.cbl
  2712     12  LO-DETAIL-CONTROL           PIC X.
  2713             88  LO-PRINT-DETAIL        VALUE 'D'.
  2714             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2715
  2716     12  LO-SV-CARRIER               PIC X.
  2717     12  LO-SV-GROUPING              PIC X(6).
  2718     12  LO-SV-STATE                 PIC XX.
  2719
  2720     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2721     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2722
  2723     12  LO-OFFICER-INFO.
  2724         16  FILLER OCCURS 12 TIMES.
  2725             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2726             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2727             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2728             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2729             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2730             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2731             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2732             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2733     12  FILLER                      PIC X(198).
  2734******************************************************************
  2735*                                COPY ERCPDEF.
  2736******************************************************************
  2737*                                                                *
  2738*                                                                *
  2739*                            ERCPDEF.                            *
  2740*                                                                *
  2741*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2742*                                                                *
  2743*    FILE TYPE = VSAM,KSDS                                       *
  2744*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2745*                                                                *
  2746*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2747*                                                                *
  2748*    LOG = YES                                                   *
  2749*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2750******************************************************************
  2751*                   C H A N G E   L O G
  2752*
  2753* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2754*-----------------------------------------------------------------
  2755*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2756* EFFECTIVE    NUMBER
  2757*-----------------------------------------------------------------
  2758* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2759* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2760******************************************************************
  2761 01  PRODUCT-MASTER.
  2762    12  PD-RECORD-ID                 PIC X(02).
  2763        88  VALID-PD-ID                  VALUE 'PD'.
  2764    12  PD-CONTROL-PRIMARY.
  2765        16  PD-COMPANY-CD            PIC X.
  2766        16  PD-STATE                 PIC XX.
  2767        16  PD-PRODUCT-CD            PIC XXX.
  2768        16  PD-FILLER                PIC X(7).
  2769        16  PD-BEN-TYPE              PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  53
* EL050.cbl
  2770        16  PD-BEN-CODE              PIC XX.
  2771        16  PD-PROD-EXP-DT           PIC XX.
  2772    12  FILLER                       PIC X(50).
  2773    12  PD-PRODUCT-DATA OCCURS 8.
  2774        16  PD-PROD-CODE             PIC X.
  2775            88  PD-PROD-LIFE           VALUE 'L'.
  2776            88  PD-PROD-PROP           VALUE 'P'.
  2777            88  PD-PROD-AH             VALUE 'A'.
  2778            88  PD-PROD-IU             VALUE 'I'.
  2779            88  PD-PROD-GAP            VALUE 'G'.
  2780            88  PD-PROD-FAML           VALUE 'F'.
  2781        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2782        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2783        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2784        16  PD-MAX-TERM              PIC S999        COMP-3.
  2785        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2786        16  FILLER                   PIC X.
  2787        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2788        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2789        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2790        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2791        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2792        16  PD-REC-CRIT-PERIOD       PIC 99.
  2793        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2794            20  PD-RECURRING-YN      PIC X.
  2795            20  FILLER               PIC X.
  2796        16  PD-RTW-MOS               PIC 99.
  2797        16  PD-MAX-EXTENSION         PIC 99.
  2798        16  FILLER                   PIC XX.
  2799    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2800    12  PD-TERM-LIMITS OCCURS 15.
  2801        16  PD-LOW-TERM              PIC S999        COMP-3.
  2802        16  PD-HI-TERM               PIC S999        COMP-3.
  2803*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2804    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2805        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2806        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2807    12  PD-EARN-FACTORS.
  2808        16  FILLER OCCURS 15.
  2809            20  FILLER OCCURS 15.
  2810                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2811    12  PD-PRODUCT-DESC              PIC X(80).
  2812    12  PD-TRUNCATED                 PIC X.
  2813    12  FILLER                       PIC X(59).
  2814    12  PD-MAINT-INFORMATION.
  2815        16  PD-LAST-MAINT-DT         PIC X(02).
  2816        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2817        16  PD-LAST-MAINT-BY         PIC X(04).
  2818*                                COPY ELCSTATE.
  2819******************************************************************
  2820*                                                                *
  2821*                                                                *
  2822*                            ELCSTATE.                           *
  2823*                                                                *
  2824*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2825*                                                                *
  2826*   FILE TYPE = VSAM,KSDS                                        *
  2827*   RECORD SIZE = 250  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  54
* EL050.cbl
  2828*                                                                *
  2829*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2830*       ALTERNATE INDEX = NONE                                   *
  2831*                                                                *
  2832*   LOG = YES                                                    *
  2833*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2834******************************************************************
  2835*                   C H A N G E   L O G
  2836*
  2837* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2838*-----------------------------------------------------------------
  2839*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2840* EFFECTIVE    NUMBER
  2841*-----------------------------------------------------------------
  2842* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2843******************************************************************
  2844*
  2845 01  STATE-FILE.
  2846     12  SF-RECORD-ID                       PIC XX.
  2847         88  VALID-CF-ID                        VALUE 'SF'.
  2848     12  SF-CONTROL-PRIMARY.
  2849         16  SF-COMPANY-ID                  PIC XXX.
  2850         16  SF-CARRIER-CODE                PIC X.
  2851         16  SF-GROUPING                    PIC X(6).
  2852         16  SF-STATE-CODE                  PIC XX.
  2853         16  SF-EXPIRE-DATE                 PIC 9(8).
  2854****************************************************************
  2855*             STATE CONTROLS
  2856****************************************************************
  2857     12  SF-LAST-MAINT-DT                   PIC XX.
  2858     12  SF-LAST-MAINT-BY                   PIC X(4).
  2859     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2860     12  SF-STATE-RT-CONTROLS.
  2861         16  SF-ST-RT-CALC                  PIC X.
  2862     12  SF-ST-TAX-CONTROLS.
  2863         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2864         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2865         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2866     12  SF-ST-REFUND-OPTIONS.
  2867         16  SF-ST-RF-LR-CALC               PIC X.
  2868         16  SF-ST-RF-LL-CALC               PIC X.
  2869         16  SF-ST-RF-LN-CALC               PIC X.
  2870         16  SF-ST-RF-AH-CALC               PIC X.
  2871         16  SF-ST-RF-CP-CALC               PIC X.
  2872     12  SF-ST-UNEARN-PREM-OPTIONS.
  2873         16  SF-ST-LUEP-R78                 PIC X.
  2874         16  SF-ST-LUEP-PRO                 PIC X.
  2875         16  SF-ST-LUEP-ST                  PIC X.
  2876         16  SF-ST-LUEP-DOM                 PIC X.
  2877         16  SF-ST-AUEP-R78                 PIC X.
  2878         16  SF-ST-AUEP-PRO                 PIC X.
  2879         16  SF-ST-AUEP-ST                  PIC X.
  2880         16  SF-ST-AUEP-DOM                 PIC X.
  2881         16  SF-ST-CUEP-R78                 PIC X.
  2882         16  SF-ST-CUEP-PRO                 PIC X.
  2883         16  SF-ST-CUEP-ST                  PIC X.
  2884         16  SF-ST-CUEP-DOM                 PIC X.
  2885     12  SF-ST-EARN-PREM-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  55
* EL050.cbl
  2886         16  SF-ST-LEP-R78                  PIC X.
  2887         16  SF-ST-LEP-PRO                  PIC X.
  2888         16  SF-ST-LEP-ST                   PIC X.
  2889         16  SF-ST-LEP-DOM                  PIC X.
  2890         16  SF-ST-AEP-R78                  PIC X.
  2891         16  SF-ST-AEP-PRO                  PIC X.
  2892         16  SF-ST-AEP-ST                   PIC X.
  2893         16  SF-ST-AEP-DOM                  PIC X.
  2894         16  SF-ST-CEP-R78                  PIC X.
  2895         16  SF-ST-CEP-PRO                  PIC X.
  2896         16  SF-ST-CEP-ST                   PIC X.
  2897         16  SF-ST-CEP-DOM                  PIC X.
  2898     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  56
* EL050.cbl
  2900*    COPY ELCCRTT.
  2901******************************************************************
  2902*                                                                *
  2903*                            ELCCRTT.                            *
  2904*                                                                *
  2905*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2906*                                                                *
  2907*   FILE TYPE = VSAM,KSDS                                        *
  2908*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2909*                                                                *
  2910*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2911*                                                                *
  2912*   LOG = YES                                                    *
  2913*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2914******************************************************************
  2915*                   C H A N G E   L O G
  2916*
  2917* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2918*-----------------------------------------------------------------
  2919*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2920* EFFECTIVE    NUMBER
  2921*-----------------------------------------------------------------
  2922* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2923* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2924* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2925* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2926* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2927* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2928* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2929******************************************************************
  2930
  2931 01  CERTIFICATE-TRAILERS.
  2932     12  CS-RECORD-ID                      PIC XX.
  2933         88  VALID-CS-ID                      VALUE 'CS'.
  2934
  2935     12  CS-CONTROL-PRIMARY.
  2936         16  CS-COMPANY-CD                 PIC X.
  2937         16  CS-CARRIER                    PIC X.
  2938         16  CS-GROUPING                   PIC X(6).
  2939         16  CS-STATE                      PIC XX.
  2940         16  CS-ACCOUNT                    PIC X(10).
  2941         16  CS-CERT-EFF-DT                PIC XX.
  2942         16  CS-CERT-NO.
  2943             20  CS-CERT-PRIME             PIC X(10).
  2944             20  CS-CERT-SFX               PIC X.
  2945         16  CS-TRAILER-TYPE               PIC X.
  2946             88  COMM-TRLR           VALUE 'A'.
  2947             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2948             88  CERT-DATA-TRLR      VALUE 'C'.
  2949
  2950     12  CS-DATA-AREA                      PIC X(516).
  2951
  2952     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2953         16  CS-BANK-COMMISSION-AREA.
  2954             20  CS-BANK-COMMS       OCCURS 10.
  2955                 24  CS-AGT                PIC X(10).
  2956                 24  CS-COM-TYP            PIC X.
  2957                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  57
* EL050.cbl
  2958                 24  CS-RECALC-LV-INDIC    PIC X.
  2959                 24  FILLER                PIC X(10).
  2960         16  FILLER                        PIC X(256).
  2961
  2962     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2963****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  2964         16  CS-MB-CLAIM-DATA OCCURS 24.
  2965             20  CS-CLAIM-NO               PIC X(7).
  2966             20  CS-CLAIM-TYPE             PIC X.
  2967                 88  CS-AH-CLM               VALUE 'A'.
  2968                 88  CS-IU-CLM               VALUE 'I'.
  2969                 88  CS-GP-CLM               VALUE 'G'.
  2970                 88  CS-LF-CLM               VALUE 'L'.
  2971                 88  CS-PR-CLM               VALUE 'P'.
  2972                 88  CS-FL-CLM               VALUE 'F'.
  2973             20  CS-INSURED-TYPE           PIC X.
  2974                 88  CS-PRIM-INSURED          VALUE 'P'.
  2975                 88  CS-CO-BORROWER           VALUE 'C'.
  2976             20  CS-BENEFIT-PERIOD         PIC 99.
  2977             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  2978             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  2979             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  2980         16  FILLER                        PIC X(12).
  2981     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  2982         16  CS-VIN-NUMBER                 PIC X(17).
  2983         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  2984         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  2985         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  2986         16  FILLER                        PIC X(496).
  2987*    COPY ELCCRTO.
  2988******************************************************************
  2989*                                                                *
  2990*                            ELCCRTO.                            *
  2991*                                                                *
  2992*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  2993*                                                                *
  2994*   FILE TYPE = VSAM,KSDS                                        *
  2995*   RECORD SIZE = 524  RECFORM = FIXED                           *
  2996*                                                                *
  2997*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  2998*                                                                *
  2999*   LOG = YES                                                    *
  3000*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3001******************************************************************
  3002*                   C H A N G E   L O G
  3003*
  3004* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3005*-----------------------------------------------------------------
  3006*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3007* EFFECTIVE    NUMBER
  3008*-----------------------------------------------------------------
  3009* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3010* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3011* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3012* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3013* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3014******************************************************************
  3015 01  ORIGINAL-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  58
* EL050.cbl
  3016     12  OC-RECORD-ID                      PIC XX.
  3017         88  VALID-OC-ID                      VALUE 'OC'.
  3018     12  OC-CONTROL-PRIMARY.
  3019         16  OC-COMPANY-CD                 PIC X.
  3020         16  OC-CARRIER                    PIC X.
  3021         16  OC-GROUPING                   PIC X(6).
  3022         16  OC-STATE                      PIC XX.
  3023         16  OC-ACCOUNT                    PIC X(10).
  3024         16  OC-CERT-EFF-DT                PIC XX.
  3025         16  OC-CERT-NO.
  3026             20  OC-CERT-PRIME             PIC X(10).
  3027             20  OC-CERT-SFX               PIC X.
  3028         16  OC-RECORD-TYPE                PIC X.
  3029         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3030     12  OC-LAST-MAINT-DT                  PIC XX.
  3031     12  OC-LAST-MAINT-BY                  PIC X(4).
  3032     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3033     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3034     12  FILLER                            PIC X(49).
  3035     12  OC-ORIG-REC.
  3036         16  OC-INS-LAST-NAME              PIC X(15).
  3037         16  OC-INS-FIRST-NAME             PIC X(10).
  3038         16  OC-INS-MIDDLE-INIT            PIC X.
  3039         16  OC-INS-AGE                    PIC S999     COMP-3.
  3040         16  OC-JNT-LAST-NAME              PIC X(15).
  3041         16  OC-JNT-FIRST-NAME             PIC X(10).
  3042         16  OC-JNT-MIDDLE-INIT            PIC X.
  3043         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3044         16  OC-LF-BENCD                   PIC XX.
  3045         16  OC-LF-TERM                    PIC S999      COMP-3.
  3046         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3047         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3048         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3049         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3050         16  OC-LF-EXP-DT                  PIC XX.
  3051         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3052         16  OC-LF-CANCEL-DT               PIC XX.
  3053         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3054         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3055         16  OC-AH-BENCD                   PIC XX.
  3056         16  OC-AH-TERM                    PIC S999      COMP-3.
  3057         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3058         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3059         16  OC-AH-EXP-DT                  PIC XX.
  3060         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3061         16  OC-AH-CP                      PIC 99.
  3062         16  OC-AH-CANCEL-DT               PIC XX.
  3063         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3064         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3065         16  OC-CRED-BENE-NAME             PIC X(25).
  3066         16  OC-1ST-PMT-DT                 PIC XX.
  3067         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3068         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3069         16  OC-ISSUE-TRAN-IND             PIC X.
  3070         16  OC-CANCEL-TRAN-IND            PIC X.
  3071         16  FILLER                        PIC X(211).
  3072
  3073     12  FILLER                            PIC X(50).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  59
* EL050.cbl
  3074******************************************************************
  3075
  3076*    COPY ELCDATE.
  3077******************************************************************
  3078*                                                                *
  3079*                                                                *
  3080*                            ELCDATE.                            *
  3081*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3082*                            VMOD=2.003
  3083*                                                                *
  3084*                                                                *
  3085*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3086*                 LENGTH = 200                                   *
  3087******************************************************************
  3088
  3089 01  DATE-CONVERSION-DATA.
  3090     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3091     12  DC-OPTION-CODE                PIC X.
  3092         88  BIN-TO-GREG                VALUE ' '.
  3093         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3094         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3095         88  YMD-GREG-TO-BIN            VALUE '3'.
  3096         88  MDY-GREG-TO-BIN            VALUE '4'.
  3097         88  JULIAN-TO-BIN              VALUE '5'.
  3098         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3099         88  FIND-CENTURY               VALUE '7'.
  3100         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3101         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3102         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3103         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3104         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3105         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3106         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3107         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3108         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3109         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3110         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3111         88  BIN-3-TO-GREG              VALUE 'I'.
  3112         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3113         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3114         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3115         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3116         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3117         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3118         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3119         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3120         88  THREE-CHARACTER-BIN
  3121                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3122         88  GREGORIAN-TO-BIN
  3123                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3124         88  BIN-TO-GREGORIAN
  3125                  VALUES ' ' '1' 'I' '8' 'G'.
  3126         88  JULIAN-TO-BINARY
  3127                  VALUES '5' 'C' 'E' 'F'.
  3128     12  DC-ERROR-CODE                 PIC X.
  3129         88  NO-CONVERSION-ERROR        VALUE ' '.
  3130         88  DATE-CONVERSION-ERROR
  3131                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  60
* EL050.cbl
  3132         88  DATE-IS-ZERO               VALUE '1'.
  3133         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3134         88  DATE-IS-INVALID            VALUE '3'.
  3135         88  DATE1-GREATER-DATE2        VALUE '4'.
  3136         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3137         88  DATE-INVALID-OPTION        VALUE '9'.
  3138         88  INVALID-CENTURY            VALUE 'A'.
  3139         88  ONLY-CENTURY               VALUE 'B'.
  3140         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3141         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3142     12  DC-END-OF-MONTH               PIC X.
  3143         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3144     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3145         88  USE-NORMAL-PROCESS         VALUE ' '.
  3146         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3147         88  ADJUST-UP-100-YRS          VALUE '2'.
  3148     12  FILLER                        PIC X.
  3149     12  DC-CONVERSION-DATES.
  3150         16  DC-BIN-DATE-1             PIC XX.
  3151         16  DC-BIN-DATE-2             PIC XX.
  3152         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3153         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3154                       DC-GREG-DATE-1-EDIT.
  3155             20  DC-EDIT1-MONTH        PIC 99.
  3156             20  SLASH1-1              PIC X.
  3157             20  DC-EDIT1-DAY          PIC 99.
  3158             20  SLASH1-2              PIC X.
  3159             20  DC-EDIT1-YEAR         PIC 99.
  3160         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3161         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3162                     DC-GREG-DATE-2-EDIT.
  3163             20  DC-EDIT2-MONTH        PIC 99.
  3164             20  SLASH2-1              PIC X.
  3165             20  DC-EDIT2-DAY          PIC 99.
  3166             20  SLASH2-2              PIC X.
  3167             20  DC-EDIT2-YEAR         PIC 99.
  3168         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3169         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3170                     DC-GREG-DATE-1-YMD.
  3171             20  DC-YMD-YEAR           PIC 99.
  3172             20  DC-YMD-MONTH          PIC 99.
  3173             20  DC-YMD-DAY            PIC 99.
  3174         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3175         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3176                      DC-GREG-DATE-1-MDY.
  3177             20  DC-MDY-MONTH          PIC 99.
  3178             20  DC-MDY-DAY            PIC 99.
  3179             20  DC-MDY-YEAR           PIC 99.
  3180         16  DC-GREG-DATE-1-ALPHA.
  3181             20  DC-ALPHA-MONTH        PIC X(10).
  3182             20  DC-ALPHA-DAY          PIC 99.
  3183             20  FILLER                PIC XX.
  3184             20  DC-ALPHA-CENTURY.
  3185                 24 DC-ALPHA-CEN-N     PIC 99.
  3186             20  DC-ALPHA-YEAR         PIC 99.
  3187         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3188         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3189         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  61
* EL050.cbl
  3190         16  DC-JULIAN-DATE            PIC 9(05).
  3191         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3192                                       PIC 9(05).
  3193         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3194             20  DC-JULIAN-YEAR        PIC 99.
  3195             20  DC-JULIAN-DAYS        PIC 999.
  3196         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3197         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3198         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3199     12  DATE-CONVERSION-VARIBLES.
  3200         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3201         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3202             20  FILLER                PIC 9(3).
  3203             20  HOLD-CEN-1-CCYY.
  3204                 24  HOLD-CEN-1-CC     PIC 99.
  3205                 24  HOLD-CEN-1-YY     PIC 99.
  3206             20  HOLD-CEN-1-MO         PIC 99.
  3207             20  HOLD-CEN-1-DA         PIC 99.
  3208         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3209             20  HOLD-CEN-1-R-MO       PIC 99.
  3210             20  HOLD-CEN-1-R-DA       PIC 99.
  3211             20  HOLD-CEN-1-R-CCYY.
  3212                 24  HOLD-CEN-1-R-CC   PIC 99.
  3213                 24  HOLD-CEN-1-R-YY   PIC 99.
  3214             20  FILLER                PIC 9(3).
  3215         16  HOLD-CENTURY-1-X.
  3216             20  FILLER                PIC X(3)  VALUE SPACES.
  3217             20  HOLD-CEN-1-X-CCYY.
  3218                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3219                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3220             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3221             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3222         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3223             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3224             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3225             20  HOLD-CEN-1-R-X-CCYY.
  3226                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3227                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3228             20  FILLER                PIC XXX.
  3229         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3230         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3231         16  DC-JULIAN-DATE-1          PIC 9(07).
  3232         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3233             20  DC-JULIAN-1-CCYY.
  3234                 24  DC-JULIAN-1-CC    PIC 99.
  3235                 24  DC-JULIAN-1-YR    PIC 99.
  3236             20  DC-JULIAN-DA-1        PIC 999.
  3237         16  DC-JULIAN-DATE-2          PIC 9(07).
  3238         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3239             20  DC-JULIAN-2-CCYY.
  3240                 24  DC-JULIAN-2-CC    PIC 99.
  3241                 24  DC-JULIAN-2-YR    PIC 99.
  3242             20  DC-JULIAN-DA-2        PIC 999.
  3243         16  DC-GREG-DATE-A-EDIT.
  3244             20  DC-EDITA-MONTH        PIC 99.
  3245             20  SLASHA-1              PIC X VALUE '/'.
  3246             20  DC-EDITA-DAY          PIC 99.
  3247             20  SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  62
* EL050.cbl
  3248             20  DC-EDITA-CCYY.
  3249                 24  DC-EDITA-CENT     PIC 99.
  3250                 24  DC-EDITA-YEAR     PIC 99.
  3251         16  DC-GREG-DATE-B-EDIT.
  3252             20  DC-EDITB-MONTH        PIC 99.
  3253             20  SLASHB-1              PIC X VALUE '/'.
  3254             20  DC-EDITB-DAY          PIC 99.
  3255             20  SLASHB-2              PIC X VALUE '/'.
  3256             20  DC-EDITB-CCYY.
  3257                 24  DC-EDITB-CENT     PIC 99.
  3258                 24  DC-EDITB-YEAR     PIC 99.
  3259         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3260         16  DC-GREG-DATE-CYMD-R REDEFINES
  3261                              DC-GREG-DATE-CYMD.
  3262             20  DC-CYMD-CEN           PIC 99.
  3263             20  DC-CYMD-YEAR          PIC 99.
  3264             20  DC-CYMD-MONTH         PIC 99.
  3265             20  DC-CYMD-DAY           PIC 99.
  3266         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3267         16  DC-GREG-DATE-MDCY-R REDEFINES
  3268                              DC-GREG-DATE-MDCY.
  3269             20  DC-MDCY-MONTH         PIC 99.
  3270             20  DC-MDCY-DAY           PIC 99.
  3271             20  DC-MDCY-CEN           PIC 99.
  3272             20  DC-MDCY-YEAR          PIC 99.
  3273    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3274        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3275    12  DC-EL310-DATE                  PIC X(21).
  3276    12  FILLER                         PIC X(28).
  3277
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  63
* EL050.cbl
  3279*    COPY ELCCALC.
  3280******************************************************************
  3281*                                                                *
  3282*                           ELCCALC.                            *
  3283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3284*                            VMOD=2.025                          *
  3285*                                                                *
  3286*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3287*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3288*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3289*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3290*                                                                *
  3291*  PASSED TO ELRTRM                                              *
  3292*  -----------------                                             *
  3293*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3294*  ORIGINAL TERM                                                 *
  3295*  BEGINNING DATE                                                *
  3296*  ENDING DATE                                                   *
  3297*  COMPANY I.D.                                                  *
  3298*  ACCOUNT MASTER USER FIELD                                     *
  3299*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3300*  FREE LOOK DAYS                                                *
  3301*                                                                *
  3302*  RETURNED FROM ELRTRM                                          *
  3303*  ---------------------                                         *
  3304*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3305*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3306*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3307*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3308*----------------------------------------------------------------*
  3309*  PASSED TO ELRAMT                                              *
  3310*  ----------------                                              *
  3311*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3312*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3313*  ORIGINAL AMOUNT                                               *
  3314*  ALTERNATE BENEFIT (BALLON)                                    *
  3315*  A.P.R. - NET PAY ONLY                                         *
  3316*  METHOD
  3317*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3318*  COMPANY I.D.                                                  *
  3319*  BENEFIT TYPE                                                  *
  3320*                                                                *
  3321*  RETURNED FROM ELRAMT                                          *
  3322*  --------------------                                          *
  3323*  REMAINING AMOUNT 1 - CURRENT                                  *
  3324*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3325*  REMAINING AMOUNT FACTOR
  3326*----------------------------------------------------------------*
  3327*  PASSED TO ELRESV                                              *
  3328*  -----------------                                             *
  3329*  CERTIFICATE EFFECTIVE DATE                                    *
  3330*  VALUATION DATE                                                *
  3331*  PAID THRU DATE                                                *
  3332*  BENEFIT                                                       *
  3333*  INCURRED DATE                                                 *
  3334*  REPORTED DATE                                                 *
  3335*  ISSUE AGE                                                     *
  3336*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  64
* EL050.cbl
  3337*  CDT PERCENT                                                   *
  3338*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3339* *CLAIM TYPE (LIFE, A/H)                                        *
  3340* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3341* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3342*                                                                *
  3343*  RETURNED FROM ELRESV                                          *
  3344*  --------------------                                          *
  3345*  CDT TABLE USED                                                *
  3346*  CDT FACTOR USED                                               *
  3347*  PAY TO CURRENT RESERVE                                        *
  3348*  I.B.N.R. - A/H ONLY                                           *
  3349*  FUTURE (ACCRUED) AH ONLY                                      *
  3350*----------------------------------------------------------------*
  3351*  PASSED TO ELRATE                                              *
  3352*  ----------------                                              *
  3353*  CERT ISSUE DATE                                               *
  3354*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3355*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3356*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3357*  STATE CODE (CLIENT DEFINED)                                   *
  3358*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3359*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3360*  DEVIATION CODE                                                *
  3361*  ISSUE AGE                                                     *
  3362*  ORIGINAL BENEFIT AMOUNT                                       *
  3363*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3364*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3365*  BENEFIT KIND (LIFE OR A/H)                                    *
  3366*  A.P.R.                                                        *
  3367*  METHOD
  3368*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3369*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3370*  COMPANY I.D. (3 CHARACTER)                                    *
  3371*  BENEFIT CODE                                                  *
  3372*  BENEFIT OVERRIDE CODE                                         *
  3373*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3374*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3375*  JOINT INDICATOR (CSL ONLY)                                    *
  3376*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3377*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3378*                                                                *
  3379*  RETURNED FROM ELRATE                                          *
  3380*  --------------------                                          *
  3381*  CALCULATED PREMIUM                                            *
  3382*  PREMIUM RATE                                                  *
  3383*  MORTALITY CODE                                                *
  3384*  MAX ATTAINED AGE                                              *
  3385*  MAX AGE                                                       *
  3386*  MAX TERM                                                      *
  3387*  MAX MONTHLY BENEFIT                                           *
  3388*  MAX TOTAL BENIFIT                                             *
  3389*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3390*----------------------------------------------------------------*
  3391*  PASSED TO ELRFND                                              *
  3392*  ----------------                                              *
  3393*  CERT ISSUE DATE                                               *
  3394*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  65
* EL050.cbl
  3395*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3396*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3397*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3398*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3399*  STATE CODE (CLIENT DEFINED)                                   *
  3400*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3401*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3402*  DEVIATION CODE                                                *
  3403*  ISSUE AGE                                                     *
  3404*  ORIGINAL BENEFIT AMOUNT                                       *
  3405*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3406*  PROCESS TYPE (CANCEL)                                         *
  3407*  BENEFIT KIND (LIFE OR A/H)                                    *
  3408*  A.P.R.                                                        *
  3409*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3410*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3411*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3412*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3413*  COMPANY I.D. (3 CHARACTER)                                    *
  3414*  BENEFIT CODE                                                  *
  3415*  BENEFIT OVERRIDE CODE                                         *
  3416*                                                                *
  3417*  RETURNED FROM ELRFND                                          *
  3418*  --------------------                                          *
  3419*  CALCULATED REFUND                                             *
  3420*----------------------------------------------------------------*
  3421*  PASSED TO ELEARN                                              *
  3422*  ----------------                                              *
  3423*  CERT ISSUE DATE                                               *
  3424*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3425*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3426*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3427*  STATE CODE (CLIENT DEFINED)                                   *
  3428*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3429*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3430*  DEVIATION CODE                                                *
  3431*  ISSUE AGE                                                     *
  3432*  ORIGINAL BENEFIT AMOUNT                                       *
  3433*  BENEFIT KIND (LIFE OR A/H)                                    *
  3434*  A.P.R.                                                        *
  3435*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3436*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3437*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3438*  COMPANY I.D. (3 CHARACTER)                                    *
  3439*  BENEFIT CODE                                                  *
  3440*  BENEFIT OVERRIDE CODE                                         *
  3441*                                                                *
  3442*  RETURNED FROM ELEARN                                          *
  3443*  --------------------                                          *
  3444*  INDICATED  EARNINGS                                           *
  3445*----------------------------------------------------------------*
  3446*                 LENGTH = 450                                   *
  3447*                                                                *
  3448******************************************************************
  3449******************************************************************
  3450*                   C H A N G E   L O G
  3451*
  3452* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  66
* EL050.cbl
  3453*-----------------------------------------------------------------
  3454*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3455* EFFECTIVE    NUMBER
  3456*-----------------------------------------------------------------
  3457* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3458* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3459* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3460* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3461* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3462* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3463* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3464* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3465* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3466******************************************************************
  3467
  3468 01  CALCULATION-PASS-AREA.
  3469     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3470                                     COMP.
  3471
  3472     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3473       88  NO-CP-ERROR                             VALUE ZERO.
  3474       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3475                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3476       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3477       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3478       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3479       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3480       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3481       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3482       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3483       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3484       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3485       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3486       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3487       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3488       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3489       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3490       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3491       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3492       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3493
  3494     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3495       88  NO-CP-ERROR-2                           VALUE ZERO.
  3496***********************  INPUT AREAS ****************************
  3497
  3498     12  CP-CALCULATION-AREA.
  3499         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3500         16  CP-CERT-EFF-DT        PIC XX.
  3501         16  CP-VALUATION-DT       PIC XX.
  3502         16  CP-PAID-THRU-DT       PIC XX.
  3503         16  CP-BENEFIT-TYPE       PIC X.
  3504           88  CP-AH                               VALUE 'A' 'D'
  3505                                                   'I' 'U'.
  3506           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3507           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3508         16  CP-INCURRED-DT        PIC XX.
  3509         16  CP-REPORTED-DT        PIC XX.
  3510         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  67
* EL050.cbl
  3511         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3512         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3513                                     COMP-3.
  3514         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3515                                     COMP-3.
  3516         16  CP-CDT-METHOD         PIC X.
  3517           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3518           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3519           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3520         16  CP-CLAIM-TYPE         PIC X.
  3521           88  CP-AH-CLAIM                         VALUE 'A'.
  3522           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3523         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3524                                     COMP-3.
  3525         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3526                                     COMP-3.
  3527         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3528                                     COMP-3.
  3529         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3530                                     COMP-3.
  3531         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3532                                     COMP-3.
  3533         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3534                                     COMP-3.
  3535         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3536                                     COMP-3.
  3537         16  CP-REM-TERM-METHOD    PIC X.
  3538           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3539           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3540           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3541           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3542           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3543           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3544           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3545         16  CP-EARNING-METHOD     PIC X.
  3546           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3547           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3548           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3549           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3550           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3551           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3552           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3553           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3554           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3555           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3556           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3557           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3558           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3559           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3560         16  CP-PROCESS-TYPE       PIC X.
  3561           88  CP-CLAIM                            VALUE '1'.
  3562           88  CP-CANCEL                           VALUE '2'.
  3563           88  CP-ISSUE                            VALUE '3'.
  3564         16  CP-SPECIAL-CALC-CD    PIC X.
  3565           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3566           88  CP-1-MTH-INTEREST               VALUE ' '.
  3567           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3568           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  68
* EL050.cbl
  3569           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3570           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3571           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3572           88  CP-FARM-PLAN                    VALUE 'F'.
  3573           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3574           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3575           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3576           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3577           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3578           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3579           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3580           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3581           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3582           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3583                                                     'W' 'X'.
  3584           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3585           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3586           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3587           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3588           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3589           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3590           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3591           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3592           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3593           88  CP-CSL-METH-1                   VALUE '5'.
  3594           88  CP-CSL-METH-2                   VALUE '6'.
  3595           88  CP-CSL-METH-3                   VALUE '7'.
  3596           88  CP-CSL-METH-4                   VALUE '8'.
  3597
  3598         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3599                                     COMP-3.
  3600         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3601         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3602         16  CP-STATE              PIC XX          VALUE SPACE.
  3603         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3604         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3605           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3606               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3607         16  CP-R78-OPTION         PIC X.
  3608           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3609           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3610
  3611         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3612         16  CP-IBNR-RESERVE-SW    PIC X.
  3613         16  CP-CLAIM-STATUS       PIC X.
  3614         16  CP-RATE-FILE          PIC X.
  3615         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3616                                     COMP-3.
  3617
  3618         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3619         16  CP-AH-OVERRIDE-CODE   PIC X.
  3620
  3621         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3622                                     COMP-3.
  3623         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3624                                   PIC S9(5)V99 COMP-3.
  3625         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3626                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  69
* EL050.cbl
  3627         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3628                                     COMP-3.
  3629         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3630                                     COMP-3.
  3631         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3632                                  PIC S9(7)V99 COMP-3.
  3633
  3634         16  CP-PAID-FROM-DATE     PIC X(02).
  3635         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3636         16  CP-EXT-DAYS-CALC      PIC X.
  3637           88  CP-EXT-NO-CHG                   VALUE ' '.
  3638           88  CP-EXT-CHG-LF                   VALUE '1'.
  3639           88  CP-EXT-CHG-AH                   VALUE '2'.
  3640           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3641         16  CP-DOMICILE-STATE     PIC XX.
  3642         16  CP-CARRIER            PIC X.
  3643         16  CP-REIN-FLAG          PIC X.
  3644         16  CP-REM-TRM-CALC-OPTION PIC X.
  3645           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3646                      '2' '3' '4' '5'.
  3647           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3648           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3649           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3650           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3651           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3652           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3653           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3654           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3655         16  CP-SIG-SWITCH         PIC X.
  3656         16  CP-RATING-METHOD      PIC X.
  3657           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3658           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3659           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3660           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3661           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3662           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3663           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3664           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3665           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3666         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3667                                     COMP-3.
  3668         16  CP-BEN-CATEGORY       PIC X.
  3669         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3670         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3671                                   PIC S99V9(5) COMP-3.
  3672         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3673         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3674                                   PIC S99V9(5) COMP-3.
  3675         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3676         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3677         16  CP-EXPIRE-DT          PIC XX.
  3678         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3679         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3680         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3681         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3682         16  CP-DDF-SPEC-CALC      PIC X.
  3683             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3684             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  70
* EL050.cbl
  3685         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3686         16  CP-CANCEL-REASON      PIC X.
  3687         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3688         16  CP-PMT-MODE           PIC X.
  3689         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3690         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3691         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3692         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3693         16  FILLER                PIC X.
  3694
  3695***************    OUTPUT FROM ELRESV   ************************
  3696
  3697         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3698
  3699         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3700                                     COMP-3.
  3701         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3702                                     COMP-3.
  3703         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3704                                     COMP-3.
  3705         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3706                                     COMP-3.
  3707         16  FILLER                PIC X(09).
  3708***************    OUTPUT FROM ELRTRM   *************************
  3709
  3710         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3711                                     COMP-3.
  3712         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3713                                     COMP-3.
  3714         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3715                                     COMP-3.
  3716         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3717                                     COMP-3.
  3718         16  FILLER                PIC X(12).
  3719
  3720***************    OUTPUT FROM ELRAMT   *************************
  3721
  3722         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3723                                     COMP-3.
  3724         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3725                                     COMP-3.
  3726         16  FILLER                PIC X(12).
  3727
  3728***************    OUTPUT FROM ELRATE   *************************
  3729
  3730         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3731                                     COMP-3.
  3732         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3733                                     COMP-3.
  3734         16  CP-MORTALITY-CODE     PIC X(4).
  3735         16  CP-RATE-EDIT-FLAG     PIC X.
  3736             88  CP-RATES-NEED-APR                  VALUE '1'.
  3737         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3738                                     COMP-3.
  3739         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3740         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3741         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3742                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  71
* EL050.cbl
  3743         16  FILLER                PIC X(07).
  3744
  3745***************    OUTPUT FROM ELRFND   *************************
  3746
  3747         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3748                                     COMP-3.
  3749         16  CP-REFUND-TYPE-USED   PIC X.
  3750           88  CP-R-AS-R78                         VALUE '1'.
  3751           88  CP-R-AS-PRORATA                     VALUE '2'.
  3752           88  CP-R-AS-CALIF                       VALUE '3'.
  3753           88  CP-R-AS-TEXAS                       VALUE '4'.
  3754           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3755           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3756           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3757           88  CP-R-AS-MEAN                        VALUE '8'.
  3758           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3759           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3760           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3761           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3762           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3763           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3764         16  FILLER                PIC X(12).
  3765
  3766***************    OUTPUT FROM ELEARN   *************************
  3767
  3768         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3769                                     COMP-3.
  3770         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3771                                     COMP-3.
  3772         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3773                                     COMP-3.
  3774         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3775                                     COMP-3.
  3776         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3779                                     COMP-3.
  3780         16  CP-EARNING-TYPE-USED  PIC X.
  3781           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3782           88  CP-E-AS-R78                         VALUE '1'.
  3783           88  CP-E-AS-PRORATA                     VALUE '2'.
  3784           88  CP-E-AS-TEXAS                       VALUE '4'.
  3785           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3786           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3787           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3788           88  CP-E-AS-MEAN                        VALUE '8'.
  3789           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3790         16  FILLER                PIC X(12).
  3791
  3792***************    OUTPUT FROM ELPMNT   *************************
  3793
  3794         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3795                                     COMP-3.
  3796         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3797                                     COMP-3.
  3798         16  FILLER                PIC X(12).
  3799
  3800***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  72
* EL050.cbl
  3801         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3804                                     COMP-3.
  3805         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3806                                     COMP-3.
  3807         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3808                                     COMP-3.
  3809         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3810                                     COMP-3.
  3811         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3812                                     COMP-3.
  3813         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3814             88  OPEN-RATE-FILE                   VALUE 'O'.
  3815             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3816             88  IO-ERROR                         VALUE 'E'.
  3817
  3818         16  CP-FIRST-PAY-DATE     PIC XX.
  3819
  3820         16  CP-JOINT-INDICATOR    PIC X.
  3821
  3822         16  CP-RESERVE-REMAINING-TERM
  3823                                   PIC S9(4)V9    VALUE ZERO
  3824                                     COMP-3.
  3825
  3826         16  CP-INSURED-BIRTH-DT   PIC XX.
  3827
  3828         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3829                                     COMP-3.
  3830
  3831         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3832                                     COMP-3.
  3833
  3834         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3835                                     COMP-3.
  3836
  3837         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3838                                     COMP-3.
  3839
  3840         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3841                                     COMP-3.
  3842
  3843         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3844                                     COMP-3.
  3845
  3846         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3847                                     COMP-3.
  3848
  3849         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3850             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3851
  3852         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3853                                     COMP-3.
  3854         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3855                                     COMP-3.
  3856         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3857         16  FILLER                PIC X(15).
  3858******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  73
* EL050.cbl
  3860******************************************************************
  3861*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3862*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3863*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3864*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3865*** MODIFICATION.                                              ***
  3866*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3867*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3868******************************************************************
  3869*    COPY ERCPNDB.
  3870******************************************************************
  3871*                                                                *
  3872*                                                                *
  3873*                            ERCPNDB.                            *
  3874*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3875*                            VMOD=2.025                          *
  3876*                                                                *
  3877*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3878*                                                                *
  3879******************************************************************
  3880*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3881*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3882******************************************************************
  3883*                                                                *
  3884*                                                                *
  3885*   FILE TYPE = VSAM,KSDS                                        *
  3886*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3887*                                                                *
  3888*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3889*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3890*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3891*                                                 RKP=13,LEN=36  *
  3892*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3893*                                      AND CHG-SEQ.)             *
  3894*                                                RKP=49,LEN=11   *
  3895*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3896*                                      AND CHG-SEQ.)             *
  3897*                                                RKP=60,LEN=15   *
  3898*                                                                *
  3899*   LOG = NO                                                     *
  3900*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3901******************************************************************
  3902******************************************************************
  3903*                   C H A N G E   L O G
  3904*
  3905* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3906*-----------------------------------------------------------------
  3907*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3908* EFFECTIVE    NUMBER
  3909*-----------------------------------------------------------------
  3910* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3911* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3912* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3913* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3914* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3915* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3916* 032306                   PEMA  ADD BOW LOAN NUMBER
  3917* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  74
* EL050.cbl
  3918* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3919* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3920* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3921* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3922* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3923* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3924* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3925******************************************************************
  3926
  3927 01  PENDING-BUSINESS.
  3928     12  PB-RECORD-ID                     PIC XX.
  3929         88  VALID-PB-ID                        VALUE 'PB'.
  3930
  3931     12  PB-CONTROL-PRIMARY.
  3932         16  PB-COMPANY-CD                PIC X.
  3933         16  PB-ENTRY-BATCH               PIC X(6).
  3934         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3935         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3936
  3937     12  PB-CONTROL-BY-ACCOUNT.
  3938         16  PB-COMPANY-CD-A1             PIC X.
  3939         16  PB-CARRIER                   PIC X.
  3940         16  PB-GROUPING.
  3941             20  PB-GROUPING-PREFIX       PIC XXX.
  3942             20  PB-GROUPING-PRIME        PIC XXX.
  3943         16  PB-STATE                     PIC XX.
  3944         16  PB-ACCOUNT.
  3945             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3946             20  PB-ACCOUNT-PRIME         PIC X(6).
  3947         16  PB-CERT-EFF-DT               PIC XX.
  3948         16  PB-CERT-NO.
  3949             20  PB-CERT-PRIME            PIC X(10).
  3950             20  PB-CERT-SFX              PIC X.
  3951         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3952
  3953         16  PB-RECORD-TYPE               PIC X.
  3954             88  PB-MAILING-DATA                VALUE '0'.
  3955             88  PB-ISSUE                       VALUE '1'.
  3956             88  PB-CANCELLATION                VALUE '2'.
  3957             88  PB-BATCH-TRAILER               VALUE '9'.
  3958
  3959     12  PB-CONTROL-BY-ORIG-BATCH.
  3960         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3961         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3962         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3963         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3964
  3965     12  PB-CONTROL-BY-CSR.
  3966         16  PB-CSR-COMPANY-CD            PIC X.
  3967         16  PB-CSR-ID                    PIC X(4).
  3968         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3969         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3970         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3971******************************************************************
  3972*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3973******************************************************************
  3974
  3975     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  75
* EL050.cbl
  3976     12  PB-LAST-MAINT-BY                 PIC X(4).
  3977     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3978
  3979     12  PB-RECORD-BODY                   PIC X(375).
  3980
  3981     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3982         16  PB-CERT-ORIGIN               PIC X.
  3983             88  CLASIC-CREATED-CERT         VALUE '1'.
  3984         16  PB-I-NAME.
  3985             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  3986             20  PB-I-INSURED-FIRST-NAME.
  3987                 24  PB-I-INSURED-1ST-INIT PIC X.
  3988                 24  FILLER                PIC X(9).
  3989             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3990         16  PB-I-AGE                     PIC S99   COMP-3.
  3991         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3992         16  PB-I-BIRTHDAY                PIC XX.
  3993         16  PB-I-INSURED-SEX             PIC X.
  3994             88  PB-SEX-MALE     VALUE 'M'.
  3995             88  PB-SEX-FEMALE   VALUE 'F'.
  3996
  3997         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3998         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3999         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4000         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4001         16  PB-I-SKIP-CODE               PIC X.
  4002             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4003             88  PB-SKIP-JULY              VALUE '1'.
  4004             88  PB-SKIP-AUGUST            VALUE '2'.
  4005             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4006             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4007             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4008             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4009             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4010             88  PB-SKIP-JUNE              VALUE '8'.
  4011             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4012             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4013             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4014         16  PB-I-TERM-TYPE               PIC X.
  4015             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4016             88  PB-PAID-WEEKLY            VALUE 'W'.
  4017             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4018             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4019             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4020         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4021         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4022         16  PB-I-DATA-ENTRY-SW           PIC X.
  4023             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4024             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4025             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4026             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4027         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4028         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4029*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4030         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4031         16  FILLER                       PIC X.
  4032
  4033         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  76
* EL050.cbl
  4034             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4035             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4036                                                   '90' THRU '99'.
  4037         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4038                                          PIC XX.
  4039         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4040         16  PB-I-AMOUNT-FINANCED REDEFINES
  4041                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4042         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4043         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4044                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4045         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4046         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4047         16  PB-I-CLP-AMOUNT REDEFINES
  4048                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4049         16  PB-I-LF-CALC-FLAG            PIC X.
  4050             88 PB-COMP-LF-PREM               VALUE '?'.
  4051         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4052         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4053         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4054         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4055         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4056         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4057         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4058         16  PB-I-LF-ABBR                 PIC XXX.
  4059         16  PB-I-LF-INPUT-CD             PIC XX.
  4060
  4061         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4062             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4063             88  PB-INVALID-AH               VALUE '  ' '00'
  4064                                                   '90' THRU '99'.
  4065         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4066         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4067         16  PB-I-AH-CALC-FLAG            PIC X.
  4068             88 PB-COMP-AH-PREM                  VALUE '?'.
  4069         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4070         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4071         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4072         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4073         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4074         16  PB-I-AH-ABBR                 PIC XXX.
  4075         16  PB-I-AH-INPUT-CD             PIC XXX.
  4076
  4077         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4078         16  PB-I-REIN-TABLE              PIC XXX.
  4079         16  PB-I-BUSINESS-TYPE           PIC 99.
  4080         16  PB-I-INDV-GRP-CD             PIC X.
  4081         16  PB-I-MORT-CODE.
  4082             20  PB-I-TABLE               PIC X.
  4083             20  PB-I-INTEREST            PIC XX.
  4084             20  PB-I-MORT-TYP            PIC X.
  4085         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4086         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4087         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4088         16  PB-I-INDV-GRP-OVRD           PIC X.
  4089         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4090         16  PB-I-SIG-SW                  PIC X.
  4091             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  77
* EL050.cbl
  4092         16  PB-I-RATE-CLASS              PIC XX.
  4093         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4094         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4095         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4096         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4097         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4098         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4099         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4100         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4101         16  PB-I-OB-FLAG                 PIC X.
  4102             88  PB-I-OB                      VALUE 'B'.
  4103             88  PB-I-SUMMARY                 VALUE 'Z'.
  4104         16  PB-I-ENTRY-STATUS            PIC X.
  4105             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4106                                              'M' '5' '9' '2'.
  4107             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4108             88  PB-I-POLICY-PENDING          VALUE '2'.
  4109             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4110             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4111             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4112             88  PB-I-REIN-ONLY               VALUE '9'.
  4113             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4114             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4115             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4116             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4117         16  PB-I-INT-CODE                PIC X.
  4118             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4119             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4120         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4121         16  PB-I-SOC-SEC-NO              PIC X(11).
  4122         16  PB-I-MEMBER-NO               PIC X(12).
  4123         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4124*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4125         16  PB-I-OLD-LOF                 PIC XXX.
  4126         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4127         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4128         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4129         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4130         16  PB-I-LIFE-INDICATOR          PIC X.
  4131             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4132         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4133         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4134                                          PIC S9(5)V99    COMP-3.
  4135         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4136             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4137             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4138         16  PB-I-1ST-PMT-DT              PIC XX.
  4139         16  PB-I-JOINT-INSURED.
  4140             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4141             20 PB-I-JOINT-FIRST-NAME.
  4142                24  PB-I-JOINT-FIRST-INIT PIC X.
  4143                24  FILLER                PIC X(9).
  4144             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4145*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4146         16  PB-I-BENEFICIARY-NAME.
  4147             20  PB-I-BANK-NUMBER         PIC X(10).
  4148             20  FILLER                   PIC X(15).
  4149         16  PB-I-LAST-ADD-ON-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  78
* EL050.cbl
  4150         16  PB-I-REFERENCE               PIC X(12).
  4151         16  FILLER REDEFINES PB-I-REFERENCE.
  4152             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4153             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4154             20  PB-I-CLP-STATE           PIC XX.
  4155         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4156             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4157             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4158             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4159         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4160         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4161         16  PB-I-RESIDENT-STATE          PIC XX.
  4162         16  PB-I-RATE-CODE               PIC X(4).
  4163         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4164         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4165         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4166         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4167         16  PB-I-BANK-NOCHRGB            PIC 99.
  4168         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4169         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4170
  4171     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4172         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4173             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4174         16  PB-C-CANCEL-ORIGIN           PIC X.
  4175             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4176         16  PB-C-LF-CANCEL-DT            PIC XX.
  4177         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4178         16  PB-C-LF-CALC-REQ             PIC X.
  4179             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4180         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4181         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4182         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4183             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4184         16  PB-C-AH-CANCEL-DT            PIC XX.
  4185         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4186         16  PB-C-AH-CALC-REQ             PIC X.
  4187             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4188         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4189         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4190         16  PB-C-LAST-NAME               PIC X(15).
  4191         16  PB-C-REFUND-SW               PIC X.
  4192             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4193             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4194         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4195         16  PB-C-PAYEE-CODE              PIC X(6).
  4196         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4197         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4198         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4199         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4200         16  PB-C-REFERENCE               PIC X(12).
  4201         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4202         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4203         16  PB-C-POST-CARD-IND           PIC X.
  4204         16  PB-C-CANCEL-REASON           PIC X.
  4205         16  PB-C-REF-INTERFACE-SW        PIC X.
  4206         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4207         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  79
* EL050.cbl
  4208         16  FILLER                       PIC X(01).
  4209*        16  FILLER                       PIC X(18).
  4210         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4211*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4212         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4213         16  PB-CANCELED-CERT-DATA.
  4214             20  PB-CI-INSURED-NAME.
  4215                 24  PB-CI-LAST-NAME      PIC X(15).
  4216                 24  PB-CI-INITIALS       PIC XX.
  4217             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4218             20  PB-CI-INSURED-SEX        PIC X.
  4219             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4220             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4221             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4222             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4223             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4224             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4225             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4226             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4227             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4228             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4229             20  PB-CI-RATE-CLASS         PIC XX.
  4230             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4231             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4232             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4233             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4234             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4235             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4236             20  PB-CI-LF-ABBR            PIC X(3).
  4237             20  PB-CI-AH-ABBR            PIC X(3).
  4238             20  PB-CI-OB-FLAG            PIC X.
  4239                 88  PB-CI-OB                VALUE 'B'.
  4240             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4241                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4242                                           'M' '4' '5' '9' '2'.
  4243                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4244                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4245                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4246                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4247                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4248                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4249                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4250                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4251                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4252                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4253                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4254                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4255             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4256                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4257                                           'M' '4' '5' '9' '2'.
  4258                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4259                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4260                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4261                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4262                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4263                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4264                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4265                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  80
* EL050.cbl
  4266                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4267                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4268                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4269                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4270             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4271             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4272             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4273             20  PB-CI-MEMBER-NO          PIC X(12).
  4274             20  PB-CI-INT-CODE           PIC X.
  4275                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4276                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4277             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4278             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4279             20  PB-CI-COMP-EXCP-SW       PIC X.
  4280                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4281                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4282             20  PB-CI-ENTRY-STATUS       PIC X.
  4283             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4284             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4285             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4286             20  PB-CI-DEATH-DT           PIC XX.
  4287             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4288             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4289             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4290             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4291             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4292             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4293             20  PB-CI-ENTRY-DT              PIC XX.
  4294             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4295             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4296             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4297             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4298             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4299             20  PB-CI-OLD-LOF               PIC XXX.
  4300*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4301             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4302             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4303             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4304             20  PB-CI-INDV-GRP-CD           PIC X.
  4305             20  PB-CI-BENEFICIARY-NAME.
  4306                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4307                 24  FILLER                  PIC X(15).
  4308             20  PB-CI-NOTE-SW               PIC X.
  4309             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4310             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4311             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4312             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4313             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4314             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4315             20  PB-CI-FIRST-NAME            PIC X(10).
  4316             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4317
  4318         16  FILLER                       PIC X(13).
  4319*032306  16  FILLER                       PIC X(27).
  4320*        16  FILLER                       PIC X(46).
  4321
  4322     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4323         16  FILLER                       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  81
* EL050.cbl
  4324         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4325         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4326         16  PB-M-INSURED-MID-INIT        PIC X.
  4327         16  PB-M-INSURED-AGE             PIC 99.
  4328         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4329         16  PB-M-INSURED-SEX             PIC X.
  4330         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4331         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4332         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4333         16  PB-M-INSURED-CITY-STATE.
  4334             20  PB-M-INSURED-CITY        PIC X(28).
  4335             20  PB-M-INSURED-STATE       PIC XX.
  4336         16  PB-M-INSURED-ZIP-CODE.
  4337             20  PB-M-INSURED-ZIP-PRIME.
  4338                 24  PB-M-INSURED-ZIP-1   PIC X.
  4339                     88  PB-M-CANADIAN-POST-CODE
  4340                                             VALUE 'A' THRU 'Z'.
  4341                 24  FILLER               PIC X(4).
  4342             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4343         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4344                                        PB-M-INSURED-ZIP-CODE.
  4345             20  PM-M-INS-CAN-POST1       PIC XXX.
  4346             20  PM-M-INS-CAN-POST2       PIC XXX.
  4347             20  FILLER                   PIC XXX.
  4348         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4349         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4350         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4351         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4352         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4353         16  PB-M-CRED-BENE-CITYST.
  4354             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4355             20  PB-M-CRED-BENE-STATE     PIC XX.
  4356         16  FILLER                       PIC X(92).
  4357
  4358     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4359         16  FILLER                       PIC X(10).
  4360         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4361         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4362         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4363         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4364         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4365         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4366         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4367         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4368         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4369         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4370         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4371         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4372         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4373         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4374         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4375         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4376         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4377         16  PB-ACCOUNT-NAME              PIC X(30).
  4378         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4379         16  PB-REFERENCE                 PIC X(12).
  4380         16  PB-B-RECEIVED-DT             PIC XX.
  4381         16  FILLER                       PIC X(234).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  82
* EL050.cbl
  4382
  4383     12  PB-RECORD-STATUS.
  4384         16  PB-CREDIT-SELECT-DT          PIC XX.
  4385         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4386         16  PB-BILLED-DT                 PIC XX.
  4387         16  PB-BILLING-STATUS            PIC X.
  4388             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4389             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4390             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4391         16  PB-RECORD-BILL               PIC X.
  4392             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4393             88  PB-RECORD-RETURNED           VALUE 'R'.
  4394             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4395             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4396             88  PB-OVERRIDE-AH               VALUE 'A'.
  4397             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4398         16  PB-BATCH-ENTRY               PIC X.
  4399             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4400             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4401             88  PB-REISSUED-CERT             VALUE 'E'.
  4402             88  PB-MONTHLY-CERT              VALUE 'M'.
  4403             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4404             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4405             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4406         16  PB-FORCE-CODE                PIC X.
  4407             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4408             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4409             88  PB-CANCEL-FORCE              VALUE '8'.
  4410             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4411             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4412             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4413             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4414             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4415             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4416             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4417         16  PB-FATAL-FLAG                PIC X.
  4418             88  PB-FATAL-ERRORS              VALUE 'X'.
  4419         16  PB-FORCE-ER-CD               PIC X.
  4420             88  PB-FORCE-ERRORS              VALUE 'F'.
  4421             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4422         16  PB-WARN-ER-CD                PIC X.
  4423             88  PB-WARNING-ERRORS            VALUE 'W'.
  4424         16  FILLER                       PIC X.
  4425         16  PB-OUT-BAL-CD                PIC X.
  4426             88  PB-OUT-OF-BAL                VALUE 'O'.
  4427         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4428         16  PB-AH-OVERRIDE-L1            PIC X.
  4429         16  PB-INPUT-DT                  PIC XX.
  4430         16  PB-INPUT-BY                  PIC X(4).
  4431         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4432         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4433         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4434         16  PB-LF-EARNING-METHOD         PIC X.
  4435         16  PB-AH-EARNING-METHOD         PIC X.
  4436         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4437         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4438         16  PB-REIN-CD                   PIC XXX.
  4439         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  83
* EL050.cbl
  4440         16  PB-AH-REFUND-TYPE            PIC X.
  4441         16  PB-ACCT-EFF-DT               PIC XX.
  4442         16  PB-ACCT-EXP-DT               PIC XX.
  4443         16  PB-COMPANY-ID                PIC X(3).
  4444         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4445         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4446         16  PB-SV-CARRIER                PIC X.
  4447         16  PB-SV-GROUPING               PIC X(6).
  4448         16  PB-SV-STATE                  PIC XX.
  4449         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4450         16  PB-GA-BILLING-INFO.
  4451             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4452                                          PIC XX.
  4453         16  PB-SV-REMIT-TO  REDEFINES
  4454             PB-GA-BILLING-INFO           PIC X(10).
  4455         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4456         16  PB-I-LOAN-OFFICER            PIC X(5).
  4457         16  PB-I-VIN                     PIC X(17).
  4458
  4459         16  FILLER                       PIC X(04).
  4460         16  IMNET-BYPASS-SW              PIC X.
  4461
  4462******************************************************************
  4463*                COMMON EDIT ERRORS                              *
  4464******************************************************************
  4465
  4466     12  PB-COMMON-ERRORS.
  4467         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4468                                           PIC S9(4)     COMP.
  4469
  4470******************************************************************
  4471
  4472* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4473*    COPY ELC50W1.
  4474******************************************************************
  4475*                                                                *
  4476*                                                                *
  4477*                             ELC50W1                            *
  4478*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4479*                            VMOD=2.004                          *
  4480*                                                                *
  4481*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4482*                                                                *
  4483*                                                                *
  4484******************************************************************
  4485
  4486     12  WK-WORK-AREA.
  4487         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4488         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4489         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4490         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4491         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4492         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  4493         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4494         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4495         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4496         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4497         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  84
* EL050.cbl
  4498         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4499         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4500         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4501         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4502         16  WK-CREDIT-EDIT-CONTROLS.
  4503             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4504             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4505             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4506             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4507             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4508             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4509         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4510         16  WK-SAVE-REIN-DATA.
  4511             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4512             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4513             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4514         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4515             88  ENTRY-FROM-EL6311       VALUE '6'.
  4516         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4517         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4518     12  WK-RECORD-ADDRESSES.
  4519         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4520         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4521         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4522         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4523         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4524         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4525         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4526         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4527     12  WK-OVER-SHORT-AREA.
  4528         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4529         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4530         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4531             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4532         16  FILLER                   PIC X(5) VALUE SPACES.
  4533
  4534*    COPY ELCEDITC.
  4535******************************************************************
  4536*                                                                *
  4537*                                                                *
  4538*                            ELCEDITC                            *
  4539*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4540*                            VMOD=2.012                          *
  4541*                                                                *
  4542*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4543*                     EL6313, EL050 AND EL517.                   *
  4544*                                                                *
  4545******************************************************************
  4546******************************************************************
  4547*                   C H A N G E   L O G
  4548*
  4549* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4550*-----------------------------------------------------------------
  4551*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4552* EFFECTIVE    NUMBER
  4553*-----------------------------------------------------------------
  4554* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4555******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  85
* EL050.cbl
  4556
  4557     12  EDIT-CRITERIA-DATA.
  4558         16  EC-CO-MONTH-END-DT       PIC XX.
  4559         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4560         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4561         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4562         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4563         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4564         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4565         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4566         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4567         16  EC-CO-REM-TERM-CALC      PIC X.
  4568               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4569               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4570               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4571               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4572
  4573         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4574               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4575               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4576               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4577               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4578               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4579               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4580               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4581               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4582               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4583               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4584
  4585         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4586               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4587               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4588               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4589               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4590               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4591               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4592               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4593               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4594
  4595         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4596                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4597                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4598
  4599         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4600                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4601                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4602                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4603                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4604                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4605                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4606                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4607                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4608
  4609         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4610               88  EC-BR-REDUCING                   VALUE 'R'.
  4611               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4612
  4613         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  86
* EL050.cbl
  4614         16  EC-BR-LF-DESC             PIC X(10).
  4615         16  EC-BR-AH-DESC             PIC X(10).
  4616         16  EC-BR-LF-COMMENT          PIC X(10).
  4617         16  EC-BR-AH-COMMENT          PIC X(10).
  4618
  4619         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4620               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4621               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4622               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4623               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4624
  4625         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4626               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4627               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4628               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4629               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4630
  4631         16  EC-BR-LF-REFUND-CALC      PIC X.
  4632                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4633                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4634                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4635                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4636                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4637                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4638                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4639
  4640         16  EC-BR-AH-REFUND-CALC      PIC X.
  4641                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4642                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4643                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4644                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4645                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4646                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4647                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4648                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4649
  4650         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4651                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4652                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4653                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4654
  4655         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4656                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4657                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4658                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4659
  4660         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4661         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4662         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4663         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4664
  4665         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4666         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  4667                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4668                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4669                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4670                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4671
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  87
* EL050.cbl
  4672         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4673               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4674               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4675               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4676               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4677               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4678
  4679         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4680               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4681               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4682               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4683               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4684               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4685
  4686         16  EC-ST-LF-REFUND-CALC      PIC X.
  4687                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4688                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4689                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4690                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4691                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4692                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4693                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4694                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4695
  4696         16  EC-ST-AH-REFUND-CALC      PIC X.
  4697                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4698                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4699                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4700                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4701                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4702                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4703                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4704                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4705
  4706         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4707         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4708         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4709         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4710         16  EC-AM-EXPIRATION-DT       PIC XX.
  4711         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4712         16  EC-AM-CLASS-CD            PIC XX.
  4713         16  EC-AM-LF-DEVIATION        PIC XXX.
  4714         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4715         16  EC-AM-AH-DEVIATION        PIC XXX.
  4716         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4717         16  EC-AM-PHONE-NO            PIC X(10).
  4718
  4719         16  EC-AM-LF-REFUND-CALC      PIC X.
  4720                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4721                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4722                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4723                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4724                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  4725                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4726                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4727
  4728         16  EC-AM-AH-REFUND-CALC      PIC X.
  4729                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  88
* EL050.cbl
  4730                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4731                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4732                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4733                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4734                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4735                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4736
  4737         16  EC-AM-BEN-I-G-CD          PIC X.
  4738                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4739                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4740                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4741
  4742         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4743         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4744         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4745         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4746         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4747         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4748         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4749         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4750         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4751
  4752         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4753         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4754         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4755         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4756         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4757         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4758         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4759         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4760         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4761         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4762         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4763         16  EC-RT-LF-NSP-ST           PIC XX.
  4764         16  EC-RT-AH-NSP-ST           PIC XX.
  4765         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4766         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4767
  4768         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4769             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4770                                             'M' '5' '9' '2'.
  4771             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4772             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4773             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4774             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4775             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4776             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4777             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4778             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4779             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4780             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4781
  4782         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  4783             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4784                                             'M' '5' '9' '2'.
  4785             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4786             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4787             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  89
* EL050.cbl
  4788             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4789             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4790             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4791             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4792             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4793             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4794             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4795
  4796         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4797         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4798         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4799         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4800         16  EC-CM-DEATH-DT            PIC XX.
  4801
  4802*DMD CUSTOM CODING FIELDS BELOW
  4803*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4804         16  EC-BR-DMD-RATING-SW       PIC X.
  4805                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4806                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4807                 88  NO-DMD-RATING               VALUE 'N'.
  4808
  4809         16  EC-NEW-CERT               PIC X(11).
  4810         16  EC-NEW-STATE              PIC XX.
  4811         16  FILLER                    PIC X.
  4812*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4813         16  OVER-SHORT-EDIT-FIELDS.
  4814             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4815             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4816             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4817             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4818             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4819             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4820             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4821             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4822             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4823         16  FILLER                    PIC X(71).
  4824******************************************************************
  4825
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  90
* EL050.cbl
  4827*    COPY ELCDIFRD.
  4828******************************************************************
  4829*                                                                *
  4830*                                                                *
  4831*                            ELCDIFRD.                           *
  4832*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4833*                            VMOD=2.004                          *
  4834*                                                                *
  4835*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4836*                                                                *
  4837******************************************************************
  4838*
  4839  01  WS-DIFFERENCE-CALCULATION.
  4840        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4841        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4842        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4843        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4844        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4845        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4846        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4847        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4848        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4849        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4850        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4851
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  91
* EL050.cbl
  4853****************************************************************
  4854*
  4855* Copyright (c) 2007 by Clerity Solutions, Inc.
  4856* All rights reserved.
  4857*
  4858****************************************************************
  4859 01  DFHEIV.
  4860   02  DFHEIV0               PIC X(35).
  4861   02  DFHEIV1               PIC X(08).
  4862   02  DFHEIV2               PIC X(08).
  4863   02  DFHEIV3               PIC X(08).
  4864   02  DFHEIV4               PIC X(06).
  4865   02  DFHEIV5               PIC X(04).
  4866   02  DFHEIV6               PIC X(04).
  4867   02  DFHEIV7               PIC X(02).
  4868   02  DFHEIV8               PIC X(02).
  4869   02  DFHEIV9               PIC X(01).
  4870   02  DFHEIV10              PIC S9(7) COMP-3.
  4871   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4872   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4873   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4874   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4875   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4876   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4877   02  DFHEIV17              PIC X(04).
  4878   02  DFHEIV18              PIC X(04).
  4879   02  DFHEIV19              PIC X(04).
  4880   02  DFHEIV20              USAGE IS POINTER.
  4881   02  DFHEIV21              USAGE IS POINTER.
  4882   02  DFHEIV22              USAGE IS POINTER.
  4883   02  DFHEIV23              USAGE IS POINTER.
  4884   02  DFHEIV24              USAGE IS POINTER.
  4885   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4886   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4887   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4888   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4889   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4890   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4891   02  FILLER                PIC X(02).
  4892   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4893   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4894   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4895   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4896   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4897 LINKAGE  SECTION.
  4898*****************************************************************
  4899*                                                               *
  4900* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4901* All rights reserved.                                          *
  4902*                                                               *
  4903*****************************************************************
  4904 01  dfheiblk.
  4905     02  eibtime          pic s9(7) comp-3.
  4906     02  eibdate          pic s9(7) comp-3.
  4907     02  eibtrnid         pic x(4).
  4908     02  eibtaskn         pic s9(7) comp-3.
  4909     02  eibtrmid         pic x(4).
  4910     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  92
* EL050.cbl
  4911     02  eibcposn         pic s9(4) comp.
  4912     02  eibcalen         pic s9(4) comp.
  4913     02  eibaid           pic x(1).
  4914     02  eibfiller1       pic x(1).
  4915     02  eibfn            pic x(2).
  4916     02  eibfiller2       pic x(2).
  4917     02  eibrcode         pic x(6).
  4918     02  eibfiller3       pic x(2).
  4919     02  eibds            pic x(8).
  4920     02  eibreqid         pic x(8).
  4921     02  eibrsrce         pic x(8).
  4922     02  eibsync          pic x(1).
  4923     02  eibfree          pic x(1).
  4924     02  eibrecv          pic x(1).
  4925     02  eibsend          pic x(1).
  4926     02  eibatt           pic x(1).
  4927     02  eibeoc           pic x(1).
  4928     02  eibfmh           pic x(1).
  4929     02  eibcompl         pic x(1).
  4930     02  eibsig           pic x(1).
  4931     02  eibconf          pic x(1).
  4932     02  eiberr           pic x(1).
  4933     02  eibrldbk         pic x(1).
  4934     02  eiberrcd         pic x(4).
  4935     02  eibsynrb         pic x(1).
  4936     02  eibnodat         pic x(1).
  4937     02  eibfiller5       pic x(2).
  4938     02  eibresp          pic 9(09) comp.
  4939     02  eibresp2         pic 9(09) comp.
  4940     02  dfheigdj         pic s9(4) comp.
  4941     02  dfheigdk         pic s9(4) comp.
  4942
  4943 01  DFHCOMMAREA                   PIC X(1036).
  4944
  4945*01 PARMLIST .
  4946*    02  FILLER                    PIC S9(8)   COMP.
  4947*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  4948*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  4949*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  4950*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  4951*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  4952*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  4953*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  4954
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  93
* EL050.cbl
  4956*    COPY ELCCNTL.
  4957******************************************************************
  4958*                                                                *
  4959*                                                                *
  4960*                            ELCCNTL.                            *
  4961*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4962*                            VMOD=2.059                          *
  4963*                                                                *
  4964*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4965*                                                                *
  4966*   FILE TYPE = VSAM,KSDS                                        *
  4967*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4968*                                                                *
  4969*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4970*       ALTERNATE INDEX = NONE                                   *
  4971*                                                                *
  4972*   LOG = YES                                                    *
  4973*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4974******************************************************************
  4975*                   C H A N G E   L O G
  4976*
  4977* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4978*-----------------------------------------------------------------
  4979*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4980* EFFECTIVE    NUMBER
  4981*-----------------------------------------------------------------
  4982* 082503                   PEMA  ADD BENEFIT GROUP
  4983* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4984* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4985* 092705    2005050300006  PEMA  ADD SPP LEASES
  4986* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4987* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4988* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4989* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4990* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4991* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4992* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4993* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4994* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4995* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4996******************************************************************
  4997*
  4998 01  CONTROL-FILE.
  4999     12  CF-RECORD-ID                       PIC XX.
  5000         88  VALID-CF-ID                        VALUE 'CF'.
  5001
  5002     12  CF-CONTROL-PRIMARY.
  5003         16  CF-COMPANY-ID                  PIC XXX.
  5004         16  CF-RECORD-TYPE                 PIC X.
  5005             88  CF-COMPANY-MASTER              VALUE '1'.
  5006             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5007             88  CF-STATE-MASTER                VALUE '3'.
  5008             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5009             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5010             88  CF-CARRIER-MASTER              VALUE '6'.
  5011             88  CF-MORTALITY-MASTER            VALUE '7'.
  5012             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5013             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  94
* EL050.cbl
  5014             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5015             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5016             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5017             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5018             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5019             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5020             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5021             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5022             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5023         16  CF-ACCESS-CD-GENL              PIC X(4).
  5024         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5025             20  CF-PROCESSOR               PIC X(4).
  5026         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5027             20  CF-STATE-CODE              PIC XX.
  5028             20  FILLER                     PIC XX.
  5029         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5030             20  FILLER                     PIC XX.
  5031             20  CF-HI-BEN-IN-REC           PIC XX.
  5032         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5033             20  FILLER                     PIC XXX.
  5034             20  CF-CARRIER-CNTL            PIC X.
  5035         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5036             20  FILLER                     PIC XX.
  5037             20  CF-HI-TYPE-IN-REC          PIC 99.
  5038         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5039             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5040                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5041             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5042             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5043         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5044             20  FILLER                     PIC X.
  5045             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5046         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5047             20  FILLER                     PIC XX.
  5048             20  CF-MORTGAGE-PLAN           PIC XX.
  5049         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5050
  5051     12  CF-LAST-MAINT-DT                   PIC XX.
  5052     12  CF-LAST-MAINT-BY                   PIC X(4).
  5053     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5054
  5055     12  CF-RECORD-BODY                     PIC X(728).
  5056
  5057
  5058****************************************************************
  5059*             COMPANY MASTER RECORD                            *
  5060****************************************************************
  5061
  5062     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5063         16  CF-COMPANY-ADDRESS.
  5064             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5065             20  CF-CL-IN-CARE-OF           PIC X(30).
  5066             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5067             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5068             20  CF-CL-CITY-STATE           PIC X(30).
  5069             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5070             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5071         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  95
* EL050.cbl
  5072         16  CF-COMPANY-PASSWORD            PIC X(8).
  5073         16  CF-SECURITY-OPTION             PIC X.
  5074             88  ALL-SECURITY                   VALUE '1'.
  5075             88  COMPANY-VERIFY                 VALUE '2'.
  5076             88  PROCESSOR-VERIFY               VALUE '3'.
  5077             88  NO-SECURITY                    VALUE '4'.
  5078             88  ALL-BUT-TERM                   VALUE '5'.
  5079         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5080             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5081         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5082             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5083         16  CF-INFORCE-LOCATION            PIC X.
  5084             88  CERTS-ARE-ONLINE               VALUE '1'.
  5085             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5086             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5087         16  CF-LOWER-CASE-LETTERS          PIC X.
  5088         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5089             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5090             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5091             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5092             88  CF-ACCNT-CNTL                  VALUE '3'.
  5093             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5094
  5095         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5096         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5097
  5098         16  CF-LGX-CREDIT-USER             PIC X.
  5099             88  CO-IS-NOT-USER                 VALUE 'N'.
  5100             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5101
  5102         16 CF-CREDIT-CALC-CODES.
  5103             20  CF-CR-REM-TERM-CALC PIC X.
  5104               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5105               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5106               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5107               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5108               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5109               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5110               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5111             20  CF-CR-R78-METHOD           PIC X.
  5112               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5113               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5114
  5115         16  CF-CLAIM-CONTROL-COUNTS.
  5116             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5117                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5118
  5119             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5120                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5121
  5122             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5123                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5124
  5125             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5126                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5127
  5128         16  CF-CURRENT-MONTH-END           PIC XX.
  5129
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  96
* EL050.cbl
  5130         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5131             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5132             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5133             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5134             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5135                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5136                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5137             20  CF-CO-PREM-REJECT-SW       PIC X.
  5138                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5139                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5140             20  CF-CO-REF-REJECT-SW        PIC X.
  5141                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5142                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5143
  5144         16  CF-CO-REPORTING-DT             PIC XX.
  5145         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5146         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5147           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5148           88  CF-CO-MONTH-END                  VALUE '1'.
  5149
  5150         16  CF-LGX-CLAIM-USER              PIC X.
  5151             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5152             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5153
  5154         16  CF-CREDIT-EDIT-CONTROLS.
  5155             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5156             20  CF-MIN-AGE                 PIC 99.
  5157             20  CF-DEFAULT-AGE             PIC 99.
  5158             20  CF-MIN-TERM                PIC S999      COMP-3.
  5159             20  CF-MAX-TERM                PIC S999      COMP-3.
  5160             20  CF-DEFAULT-SEX             PIC X.
  5161             20  CF-JOINT-AGE-INPUT         PIC X.
  5162                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5163             20  CF-BIRTH-DATE-INPUT        PIC X.
  5164                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5165             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5166                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5167                 88  CF-ZERO-CARRIER            VALUE '1'.
  5168                 88  CF-ZERO-GROUPING           VALUE '2'.
  5169                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5170             20  CF-EDIT-SW                 PIC X.
  5171                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5172             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5173             20  CF-CR-PR-METHOD            PIC X.
  5174               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5175               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5176             20  FILLER                     PIC X.
  5177
  5178         16  CF-CREDIT-MISC-CONTROLS.
  5179             20  CF-REIN-TABLE-SW           PIC X.
  5180                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5181             20  CF-COMP-TABLE-SW           PIC X.
  5182                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5183             20  CF-EXPERIENCE-RETENTION-AGE
  5184                                            PIC S9        COMP-3.
  5185             20  CF-CONVERSION-DT           PIC XX.
  5186             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5187             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  97
* EL050.cbl
  5188                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5189                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5190
  5191             20  CF-CR-CHECK-NO-CONTROL.
  5192                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5193                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5194                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5195                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5196                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5197                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5198
  5199                 24  CF-CR-CHECK-COUNT       REDEFINES
  5200                     CF-CR-CHECK-COUNTER      PIC X(4).
  5201
  5202                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5203                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5204
  5205                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5206                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5207                 24  CF-MAIL-PROCESSING       PIC X.
  5208                     88  MAIL-PROCESSING          VALUE 'Y'.
  5209
  5210         16  CF-MISC-SYSTEM-CONTROL.
  5211             20  CF-SYSTEM-C                 PIC X.
  5212                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5213             20  CF-SYSTEM-D                 PIC X.
  5214                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5215             20  CF-SOC-SEC-NO-SW            PIC X.
  5216                 88  SOC-SEC-NO-USED             VALUE '1'.
  5217             20  CF-MEMBER-NO-SW             PIC X.
  5218                 88  MEMBER-NO-USED              VALUE '1'.
  5219             20  CF-TAX-ID-NUMBER            PIC X(11).
  5220             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5221             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5222                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5223                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5224                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5225                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5226             20  CF-SYSTEM-E                 PIC X.
  5227                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5228
  5229         16  CF-LGX-LIFE-USER               PIC X.
  5230             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5231             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5232
  5233         16  CF-CR-MONTH-END-DT             PIC XX.
  5234
  5235         16  CF-FILE-MAINT-DATES.
  5236             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5237                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5238             20  CF-LAST-BATCH       REDEFINES
  5239                 CF-LAST-BATCH-NO               PIC X(4).
  5240             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5241             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5242             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5243             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5244             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5245             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  98
* EL050.cbl
  5246             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5247             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5248             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5249             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5250
  5251         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5252         16  FILLER                         PIC X.
  5253
  5254         16  CF-ALT-MORT-CODE               PIC X(4).
  5255         16  CF-MEMBER-CAPTION              PIC X(10).
  5256
  5257         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5258             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5259             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5260             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5261             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5262             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5263
  5264         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5265
  5266         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5267         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5268         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5269         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5270
  5271         16  CF-AH-OVERRIDE-L1              PIC X.
  5272         16  CF-AH-OVERRIDE-L2              PIC XX.
  5273         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5274         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5275
  5276         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5277         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5278
  5279         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5280         16  CF-AR-LAST-EL860-DT            PIC XX.
  5281         16  CF-MP-MONTH-END-DT             PIC XX.
  5282
  5283         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5284         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5285             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5286
  5287         16  CF-AR-MONTH-END-DT             PIC XX.
  5288
  5289         16  CF-CRDTCRD-USER                PIC X.
  5290             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5291             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5292
  5293         16  CF-CC-MONTH-END-DT             PIC XX.
  5294
  5295         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5296
  5297         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5298             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5299             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5300             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5301         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5302         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5303         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page  99
* EL050.cbl
  5304         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5305             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5306             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5307         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5308         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5309         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5310             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5311         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5312
  5313         16  CF-CL-ZIP-CODE.
  5314             20  CF-CL-ZIP-PRIME.
  5315                 24  CF-CL-ZIP-1ST          PIC X.
  5316                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5317                 24  FILLER                 PIC X(4).
  5318             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5319         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5320             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5321             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5322             20  FILLER                     PIC XXX.
  5323
  5324         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5325         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5326         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5327         16  CF-CO-OPTION-START-DATE        PIC XX.
  5328         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5329           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5330                                                      '3' '4'.
  5331           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5332           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5333           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5334           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5335           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5336           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5337
  5338         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5339
  5340         16  CF-PAYMENT-APPROVAL-LEVELS.
  5341             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5342             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5343             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5344             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5345             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5346             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5347
  5348         16  CF-END-USER-REPORTING-USER     PIC X.
  5349             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5350             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5351
  5352         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5353             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5354             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5355
  5356         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5357
  5358         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5359         16  FILLER                         PIC X.
  5360
  5361         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 100
* EL050.cbl
  5362             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5363             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5364             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5365
  5366         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5367
  5368         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5369             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5370             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5371
  5372         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5373             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5374             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5375
  5376         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5377
  5378         16  CF-CO-ACH-ID-CODE              PIC  X.
  5379             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5380             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5381             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5382         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5383         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5384         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5385         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5386         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5387         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5388         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5389         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5390         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5391                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5392         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5393                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5394
  5395         16  CF-CO-OVER-SHORT.
  5396             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5397             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5398
  5399*         16  FILLER                         PIC X(102).
  5400         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5401             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5402             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5403
  5404         16  CF-AH-APPROVAL-DAYS.
  5405             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5406             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5407             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5408             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5409
  5410         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5411
  5412         16  CF-APPROV-LEV-5.
  5413             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5414             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5415             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5416
  5417         16  FILLER                         PIC X(68).
  5418****************************************************************
  5419*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 101
* EL050.cbl
  5420****************************************************************
  5421
  5422     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5423         16  CF-PROCESSOR-NAME              PIC X(30).
  5424         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5425         16  CF-PROCESSOR-TITLE             PIC X(26).
  5426         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5427                 88  MESSAGE-YES                VALUE 'Y'.
  5428                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5429
  5430*****************************************************
  5431****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5432****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5433****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5434****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5435*****************************************************
  5436
  5437         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5438             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5439             20  CF-APPLICATION-FORCE       PIC X.
  5440             20  CF-INDIVIDUAL-APP.
  5441                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5442                     28  CF-BROWSE-APP      PIC X.
  5443                     28  CF-UPDATE-APP      PIC X.
  5444
  5445         16  CF-CURRENT-TERM-ON             PIC X(4).
  5446         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5447             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5448             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5449             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5450             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5451             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5452             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5453             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5454         16  CF-PROCESSOR-CARRIER           PIC X.
  5455             88  NO-CARRIER-SECURITY            VALUE ' '.
  5456         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5457             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5458         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5459             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5460         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5461             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5462
  5463         16  CF-PROC-SYS-ACCESS-SW.
  5464             20  CF-PROC-CREDIT-CLAIMS-SW.
  5465                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5466                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5467                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5468                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5469             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5470                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5471                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5472             20  CF-PROC-LIFE-GNRLDGR-SW.
  5473                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5474                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5475                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5476                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5477             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 102
* EL050.cbl
  5478                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5479                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5480         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5481             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5482             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5483         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5484
  5485         16  CF-APPROVAL-LEVEL                  PIC X.
  5486             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5487             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5488             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5489             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5490             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5491
  5492         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5493
  5494         16  CF-LANGUAGE-TYPE                   PIC X.
  5495             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5496             88  CF-LANG-IS-FR                      VALUE 'F'.
  5497
  5498         16  CF-CSR-IND                         PIC X.
  5499         16  FILLER                             PIC X(239).
  5500
  5501****************************************************************
  5502*             PROCESSOR/REMINDERS RECORD                       *
  5503****************************************************************
  5504
  5505     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5506         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5507             20  CF-START-REMIND-DT         PIC XX.
  5508             20  CF-END-REMIND-DT           PIC XX.
  5509             20  CF-REMINDER-TEXT           PIC X(50).
  5510         16  FILLER                         PIC X(296).
  5511
  5512
  5513****************************************************************
  5514*             STATE MASTER RECORD                              *
  5515****************************************************************
  5516
  5517     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5518         16  CF-STATE-ABBREVIATION          PIC XX.
  5519         16  CF-STATE-NAME                  PIC X(25).
  5520         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5521         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5522             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5523             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5524             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5525             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5526                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5527                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5528             20  CF-ST-PREM-REJECT-SW       PIC X.
  5529                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5530                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5531             20  CF-ST-REF-REJECT-SW        PIC X.
  5532                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5533                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5534         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5535         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 103
* EL050.cbl
  5536         16  CF-ST-REFUND-RULES.
  5537             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5538             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5539             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5540         16  CF-ST-FST-PMT-EXTENSION.
  5541             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5542             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5543                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5544                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5545                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5546                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5547         16  CF-ST-STATE-CALL.
  5548             20  CF-ST-CALL-UNEARNED        PIC X.
  5549             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5550             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5551         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5552             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5553             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5554         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5555         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5556         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5557         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5558         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5559         16  FILLER                         PIC X.
  5560         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5561             20  CF-ST-BENEFIT-CD           PIC XX.
  5562             20  CF-ST-BENEFIT-KIND         PIC X.
  5563                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5564                 88  CF-ST-AH-KIND              VALUE 'A'.
  5565             20  CF-ST-REM-TERM-CALC        PIC X.
  5566                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5567                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5568                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5569                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5570                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5571                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5572                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5573                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5574
  5575             20  CF-ST-REFUND-CALC          PIC X.
  5576                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5577                 88  ST-REFD-BY-R78             VALUE '1'.
  5578                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5579                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5580                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5581                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5582                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5583                 88  ST-REFD-UTAH               VALUE '7'.
  5584                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5585                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5586                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5587
  5588             20  CF-ST-EARNING-CALC         PIC X.
  5589                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5590                 88  ST-EARN-BY-R78             VALUE '1'.
  5591                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5592                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5593                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 104
* EL050.cbl
  5594                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5595                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5596                 88  ST-EARN-MEAN               VALUE '8'.
  5597                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5598
  5599             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5600                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5601                 88  ST-OVRD-BY-R78             VALUE '1'.
  5602                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5603                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5604                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5605                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5606                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5607                 88  ST-OVRD-MEAN               VALUE '8'.
  5608                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5609             20  FILLER                     PIC X.
  5610
  5611         16  CF-ST-COMMISSION-CAPS.
  5612             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5613             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5614             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5615             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5616         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5617                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5618
  5619         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5620
  5621         16  CF-ST-STATUTORY-INTEREST.
  5622             20  CF-ST-STAT-DATE-FROM       PIC X.
  5623                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5624                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5625             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5626             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5627             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5628             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5629             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5630
  5631         16  CF-ST-OVER-SHORT.
  5632             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5633             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5634
  5635         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5636
  5637         16  CF-ST-RT-CALC                  PIC X.
  5638
  5639         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5640         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5641         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5642         16  CF-ST-RF-LR-CALC               PIC X.
  5643         16  CF-ST-RF-LL-CALC               PIC X.
  5644         16  CF-ST-RF-LN-CALC               PIC X.
  5645         16  CF-ST-RF-AH-CALC               PIC X.
  5646         16  CF-ST-RF-CP-CALC               PIC X.
  5647*        16  FILLER                         PIC X(206).
  5648*CIDMOD         16  FILLER                         PIC X(192).
  5649         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5650             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5651         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 105
* EL050.cbl
  5652         16  CF-ST-VFY-2ND-BENE             PIC X.
  5653         16  CF-ST-CAUSAL-STATE             PIC X.
  5654         16  FILLER                         PIC X(185).
  5655
  5656****************************************************************
  5657*             BENEFIT MASTER RECORD                            *
  5658****************************************************************
  5659
  5660     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5661         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5662             20  CF-BENEFIT-CODE            PIC XX.
  5663             20  CF-BENEFIT-NUMERIC  REDEFINES
  5664                 CF-BENEFIT-CODE            PIC XX.
  5665             20  CF-BENEFIT-ALPHA           PIC XXX.
  5666             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5667             20  CF-BENEFIT-COMMENT         PIC X(10).
  5668
  5669             20  CF-LF-COVERAGE-TYPE        PIC X.
  5670                 88  CF-REDUCING                VALUE 'R'.
  5671                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5672
  5673             20  CF-SPECIAL-CALC-CD         PIC X.
  5674                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5675                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5676                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5677                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5678                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5679                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5680                 88  CF-FARM-PLAN               VALUE 'F'.
  5681                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5682                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5683                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5684                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5685                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5686                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5687                 88  CF-PRUDENTIAL              VALUE 'P'.
  5688                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5689                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5690                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5691                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5692                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5693                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5694
  5695             20  CF-JOINT-INDICATOR         PIC X.
  5696                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5697
  5698*            20  FILLER                     PIC X(12).
  5699             20  cf-maximum-benefits        pic s999 comp-3.
  5700             20  FILLER                     PIC X(09).
  5701             20  CF-BENEFIT-CATEGORY        PIC X.
  5702             20  CF-LOAN-TYPE               PIC X(8).
  5703
  5704             20  CF-CO-REM-TERM-CALC        PIC X.
  5705                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5706                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5707                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5708                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5709                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 106
* EL050.cbl
  5710
  5711             20  CF-CO-EARNINGS-CALC        PIC X.
  5712                 88  CO-EARN-BY-R78             VALUE '1'.
  5713                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5714                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5715                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5716                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5717                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5718                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5719                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5720
  5721             20  CF-CO-REFUND-CALC          PIC X.
  5722                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5723                 88  CO-REFD-BY-R78             VALUE '1'.
  5724                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5725                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5726                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5727                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5728                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5729                 88  CO-REFD-MEAN               VALUE '8'.
  5730                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5731                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5732                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5733
  5734             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5735                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5736                 88  CO-OVRD-BY-R78             VALUE '1'.
  5737                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5738                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5739                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5740                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5741                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5742                 88  CO-OVRD-MEAN               VALUE '8'.
  5743                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5744
  5745             20  CF-CO-BEN-I-G-CD           PIC X.
  5746                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5747                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5748                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5749
  5750         16  FILLER                         PIC X(304).
  5751
  5752
  5753****************************************************************
  5754*             CARRIER MASTER RECORD                            *
  5755****************************************************************
  5756
  5757     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5758         16  CF-ADDRESS-DATA.
  5759             20  CF-MAIL-TO-NAME            PIC X(30).
  5760             20  CF-IN-CARE-OF              PIC X(30).
  5761             20  CF-ADDRESS-LINE-1          PIC X(30).
  5762             20  CF-ADDRESS-LINE-2          PIC X(30).
  5763             20  CF-CITY-STATE              PIC X(30).
  5764             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5765             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5766
  5767         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 107
* EL050.cbl
  5768             20  CF-CLAIM-NO-METHOD         PIC X.
  5769                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5770                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5771                 88  CLAIM-NO-SEQ               VALUE '3'.
  5772                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5773             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5774                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5775                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5776                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5777
  5778         16  CF-CHECK-NO-CONTROL.
  5779             20  CF-CHECK-NO-METHOD         PIC X.
  5780                 88  CHECK-NO-MANUAL            VALUE '1'.
  5781                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5782                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5783                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5784             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5785                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5786
  5787         16  CF-DOMICILE-STATE              PIC XX.
  5788
  5789         16  CF-EXPENSE-CONTROLS.
  5790             20  CF-EXPENSE-METHOD          PIC X.
  5791                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5792                 88  DOLLARS-PER-PMT            VALUE '2'.
  5793                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5794                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5795             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5796             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5797
  5798         16  CF-CORRESPONDENCE-CONTROL.
  5799             20  CF-LETTER-RESEND-OPT       PIC X.
  5800                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5801                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5802             20  FILLER                     PIC X(4).
  5803
  5804         16  CF-RESERVE-CONTROLS.
  5805             20  CF-MANUAL-SW               PIC X.
  5806                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5807             20  CF-FUTURE-SW               PIC X.
  5808                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5809             20  CF-PTC-SW                  PIC X.
  5810                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5811             20  CF-IBNR-SW                 PIC X.
  5812                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5813             20  CF-PTC-LF-SW               PIC X.
  5814                 88  CF-LF-PTC-USED             VALUE '1'.
  5815             20  CF-CDT-ACCESS-METHOD       PIC X.
  5816                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5817                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5818                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5819             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5820
  5821         16  CF-CLAIM-CALC-METHOD           PIC X.
  5822             88  360-PLUS-MONTHS                VALUE '1'.
  5823             88  365-PLUS-MONTHS                VALUE '2'.
  5824             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5825             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 108
* EL050.cbl
  5826             88  365-DAILY                      VALUE '5'.
  5827
  5828         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5829         16  FILLER                         PIC X(11).
  5830
  5831         16  CF-LIMIT-AMOUNTS.
  5832             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5833             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5834             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5835             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5836             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5837             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5838             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5839             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5840             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5841             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5842
  5843         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5844         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5845         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5846
  5847         16  CF-ZIP-CODE.
  5848             20  CF-ZIP-PRIME.
  5849                 24  CF-ZIP-1ST             PIC X.
  5850                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5851                 24  FILLER                 PIC X(4).
  5852             20  CF-ZIP-PLUS4               PIC X(4).
  5853         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5854             20  CF-CAN-POSTAL-1            PIC XXX.
  5855             20  CF-CAN-POSTAL-2            PIC XXX.
  5856             20  FILLER                     PIC XXX.
  5857
  5858         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5859         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5860         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5861
  5862         16  CF-RATING-SWITCH               PIC X.
  5863             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5864             88  CF-NO-RATING                   VALUE 'N'.
  5865
  5866         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5867
  5868         16  CF-CARRIER-OVER-SHORT.
  5869             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5870             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5871
  5872         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5873         16  CF-SECPAY-SWITCH               PIC X.
  5874             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5875             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5876         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5877         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5878         16  FILLER                         PIC X(444).
  5879*        16  FILLER                         PIC X(452).
  5880
  5881
  5882****************************************************************
  5883*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 109
* EL050.cbl
  5884****************************************************************
  5885
  5886     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5887         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5888                                INDEXED BY CF-MORT-NDX.
  5889             20  CF-MORT-TABLE              PIC X(5).
  5890             20  CF-MORT-TABLE-TYPE         PIC X.
  5891                 88  CF-MORT-JOINT              VALUE 'J'.
  5892                 88  CF-MORT-SINGLE             VALUE 'S'.
  5893                 88  CF-MORT-COMBINED           VALUE 'C'.
  5894                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5895                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5896             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5897             20  CF-MORT-AGE-METHOD         PIC XX.
  5898                 88  CF-AGE-LAST                VALUE 'AL'.
  5899                 88  CF-AGE-NEAR                VALUE 'AN'.
  5900             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5901             20  CF-MORT-ADJUSTMENT-DIRECTION
  5902                                            PIC X.
  5903                 88  CF-MINUS                   VALUE '-'.
  5904                 88  CF-PLUS                    VALUE '+'.
  5905             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5906             20  CF-MORT-JOINT-CODE         PIC X.
  5907                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5908             20  CF-MORT-PC-Q               PIC X.
  5909                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5910             20  CF-MORT-TABLE-CODE         PIC X(4).
  5911             20  CF-MORT-COMMENTS           PIC X(15).
  5912             20  FILLER                     PIC X(14).
  5913
  5914         16  FILLER                         PIC X(251).
  5915
  5916
  5917****************************************************************
  5918*             BUSSINESS TYPE MASTER RECORD                     *
  5919****************************************************************
  5920
  5921     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5922* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5923* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5924* AND RECORD 05 IS TYPES 81-99
  5925         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5926             20  CF-BUSINESS-TITLE          PIC  X(19).
  5927             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5928                                            PIC S9V9(4) COMP-3.
  5929             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5930             20  FILLER                     PIC  X.
  5931         16  FILLER                         PIC  X(248).
  5932
  5933
  5934****************************************************************
  5935*             TERMINAL MASTER RECORD                           *
  5936****************************************************************
  5937
  5938     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5939
  5940         16  CF-COMPANY-TERMINALS.
  5941             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 110
* EL050.cbl
  5942                                  PIC X(4).
  5943         16  FILLER               PIC X(248).
  5944
  5945
  5946****************************************************************
  5947*             LIFE EDIT MASTER RECORD                          *
  5948****************************************************************
  5949
  5950     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5951         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5952             20  CF-LIFE-CODE-IN            PIC XX.
  5953             20  CF-LIFE-CODE-OUT           PIC XX.
  5954         16  FILLER                         PIC X(248).
  5955
  5956
  5957****************************************************************
  5958*             AH EDIT MASTER RECORD                            *
  5959****************************************************************
  5960
  5961     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5962         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5963             20  CF-AH-CODE-IN              PIC XXX.
  5964             20  CF-AH-CODE-OUT             PIC XX.
  5965         16  FILLER                         PIC X(248).
  5966
  5967
  5968****************************************************************
  5969*             CREDIBILITY TABLES                               *
  5970****************************************************************
  5971
  5972     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5973         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5974                             INDEXED BY CF-CRDB-NDX.
  5975             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5976             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5977             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5978         16  FILLER                         PIC  X(332).
  5979
  5980
  5981****************************************************************
  5982*             REPORT CUSTOMIZATION RECORD                      *
  5983****************************************************************
  5984
  5985     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5986         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5987             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5988             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5989             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5990**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5991****       A T-TRANSFER.                                   ****
  5992             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5993
  5994         16  FILLER                         PIC XX.
  5995
  5996         16  CF-CARRIER-CNTL-OPT.
  5997             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5998                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5999                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 111
* EL050.cbl
  6000             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6001                                            PIC X.
  6002         16  CF-GROUP-CNTL-OPT.
  6003             20  CF-GROUP-OPT-SEQ           PIC 9.
  6004                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6005                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6006             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6007                                            PIC X(6).
  6008         16  CF-STATE-CNTL-OPT.
  6009             20  CF-STATE-OPT-SEQ           PIC 9.
  6010                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6011                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6012             20  CF-STATE-SELECT OCCURS 3 TIMES
  6013                                            PIC XX.
  6014         16  CF-ACCOUNT-CNTL-OPT.
  6015             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6016                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6017                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6018             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6019                                            PIC X(10).
  6020         16  CF-BUS-TYP-CNTL-OPT.
  6021             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6022                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6023                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6024             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6025                                            PIC XX.
  6026         16  CF-LF-TYP-CNTL-OPT.
  6027             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6028                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6029                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6030             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6031                                            PIC XX.
  6032         16  CF-AH-TYP-CNTL-OPT.
  6033             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6034                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6035                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6036             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6037                                            PIC XX.
  6038         16  CF-REPTCD1-CNTL-OPT.
  6039             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6040                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6041                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6042             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6043                                            PIC X(10).
  6044         16  CF-REPTCD2-CNTL-OPT.
  6045             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6046                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6047                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6048             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6049                                            PIC X(10).
  6050         16  CF-USER1-CNTL-OPT.
  6051             20  CF-USER1-OPT-SEQ           PIC 9.
  6052                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6053                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6054             20  CF-USER1-SELECT OCCURS 3 TIMES
  6055                                            PIC X(10).
  6056         16  CF-USER2-CNTL-OPT.
  6057             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 112
* EL050.cbl
  6058                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6059                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6060             20  CF-USER2-SELECT OCCURS 3 TIMES
  6061                                            PIC X(10).
  6062         16  CF-USER3-CNTL-OPT.
  6063             20  CF-USER3-OPT-SEQ           PIC 9.
  6064                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6065                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6066             20  CF-USER3-SELECT OCCURS 3 TIMES
  6067                                            PIC X(10).
  6068         16  CF-USER4-CNTL-OPT.
  6069             20  CF-USER4-OPT-SEQ           PIC 9.
  6070                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6071                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6072             20  CF-USER4-SELECT OCCURS 3 TIMES
  6073                                            PIC X(10).
  6074         16  CF-USER5-CNTL-OPT.
  6075             20  CF-USER5-OPT-SEQ           PIC 9.
  6076                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6077                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6078             20  CF-USER5-SELECT OCCURS 3 TIMES
  6079                                            PIC X(10).
  6080         16  CF-REINS-CNTL-OPT.
  6081             20  CF-REINS-OPT-SEQ           PIC 9.
  6082                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6083                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6084             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6085                 24  CF-REINS-PRIME         PIC XXX.
  6086                 24  CF-REINS-SUB           PIC XXX.
  6087
  6088         16  CF-AGENT-CNTL-OPT.
  6089             20  CF-AGENT-OPT-SEQ           PIC 9.
  6090                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6091                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6092             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6093                                            PIC X(10).
  6094
  6095         16  FILLER                         PIC X(43).
  6096
  6097         16  CF-LOSS-RATIO-SELECT.
  6098             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6099             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6100         16  CF-ENTRY-DATE-SELECT.
  6101             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6102             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6103         16  CF-EFFECTIVE-DATE-SELECT.
  6104             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6105             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6106
  6107         16  CF-EXCEPTION-LIST-IND          PIC X.
  6108             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6109
  6110         16  FILLER                         PIC X(318).
  6111
  6112****************************************************************
  6113*                  EXCEPTION REPORTING RECORD                  *
  6114****************************************************************
  6115
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 113
* EL050.cbl
  6116     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6117         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6118             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6119
  6120         16  CF-COMBINED-LIFE-AH-OPT.
  6121             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6122             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6123             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6124             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6125
  6126         16  CF-LIFE-OPT.
  6127             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6128             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6129             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6130             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6131             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6132             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6133             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6134             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6135             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6136             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6137
  6138         16  CF-AH-OPT.
  6139             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6140             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6141             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6142             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6143             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6144             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6145             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6146             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6147             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6148             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6149
  6150         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6151             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6152             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6153             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6154
  6155         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6156
  6157         16  FILLER                         PIC X(673).
  6158
  6159
  6160****************************************************************
  6161*             MORTGAGE SYSTEM PLAN RECORD                      *
  6162****************************************************************
  6163
  6164     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6165         16  CF-PLAN-TYPE                   PIC X.
  6166             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6167             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6168             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6169         16  CF-PLAN-ABBREV                 PIC XXX.
  6170         16  CF-PLAN-DESCRIPT               PIC X(10).
  6171         16  CF-PLAN-NOTES                  PIC X(20).
  6172         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6173         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 114
* EL050.cbl
  6174             20  CF-PLAN-TERM-DATA.
  6175                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6176                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6177             20  CF-PLAN-AGE-DATA.
  6178                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6179                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6180                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6181             20  CF-PLAN-BENEFIT-DATA.
  6182                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6183                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6184                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6185                                            PIC S9(7)V99  COMP-3.
  6186         16  CF-PLAN-POLICY-FORMS.
  6187             20  CF-POLICY-FORM             PIC X(12).
  6188             20  CF-MASTER-APPLICATION      PIC X(12).
  6189             20  CF-MASTER-POLICY           PIC X(12).
  6190         16  CF-PLAN-RATING.
  6191             20  CF-RATE-CODE               PIC X(5).
  6192             20  CF-SEX-RATING              PIC X.
  6193                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6194                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6195             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6196             20  CF-SUB-STD-TYPE            PIC X.
  6197                 88  CF-PCT-OF-PREM            VALUE '1'.
  6198                 88  CF-PCT-OF-BENE            VALUE '2'.
  6199         16  CF-PLAN-PREM-TOLERANCES.
  6200             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6201             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6202         16  CF-PLAN-PYMT-TOLERANCES.
  6203             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6204             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6205         16  CF-PLAN-MISC-DATA.
  6206             20  FILLER                     PIC X.
  6207             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6208             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6209         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6210         16  CF-PLAN-IND-GRP                PIC X.
  6211             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6212                                                     '1'.
  6213             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6214                                                     '2'.
  6215         16  CF-MIB-SEARCH-SW               PIC X.
  6216             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6217             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6218             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6219             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6220         16  CF-ALPHA-SEARCH-SW             PIC X.
  6221             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6222             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6223             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6224             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6225             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6226             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6227             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6228             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6229             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6230             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6231                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 115
* EL050.cbl
  6232                                                     'X' 'Y' 'Z'.
  6233         16  CF-EFF-DT-RULE-SW              PIC X.
  6234             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6235             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6236             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6237             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6238             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6239         16  FILLER                         PIC X(4).
  6240         16  CF-HEALTH-QUESTIONS            PIC X.
  6241             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6242         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6243         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6244         16  CF-PLAN-SNGL-JNT               PIC X.
  6245             88  CF-COMBINED-PLAN              VALUE 'C'.
  6246             88  CF-JNT-PLAN                   VALUE 'J'.
  6247             88  CF-SNGL-PLAN                  VALUE 'S'.
  6248         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6249         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6250         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6251         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6252         16  CF-RERATE-CNTL                 PIC  X.
  6253             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6254             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6255             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6256             88  CF-AUTO-RECALC                 VALUE '4'.
  6257         16  CF-BENEFIT-TYPE                PIC  X.
  6258             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6259             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6260         16  CF-POLICY-FEE                  PIC S999V99
  6261                                                    COMP-3.
  6262         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6263         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6264         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6265         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6266         16  FILLER                         PIC  X(32).
  6267         16  CF-TERMINATION-FORM            PIC  X(04).
  6268         16  FILLER                         PIC  X(08).
  6269         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6270                                                       COMP-3.
  6271         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6272         16  CF-ISSUE-LETTER                PIC  X(4).
  6273         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6274         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6275             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6276             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6277         16  CF-MP-REFUND-CALC              PIC X.
  6278             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6279             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6280             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6281             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6282             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6283             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6284             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6285             88  CF-MP-REFD-MEAN                VALUE '8'.
  6286         16  CF-ALT-RATE-CODE               PIC  X(5).
  6287
  6288
  6289         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 116
* EL050.cbl
  6290****************************************************************
  6291*             MORTGAGE COMPANY MASTER RECORD                   *
  6292****************************************************************
  6293
  6294     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6295         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6296         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6297             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6298             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6299             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6300             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6301             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6302
  6303         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6304         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6305         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6306         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6307         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6308
  6309         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6310             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6311         16  CF-MP-RECON-USE-IND            PIC X(1).
  6312             88  CF-MP-USE-RECON             VALUE 'Y'.
  6313         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6314             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6315         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6316             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6317             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6318         16  FILLER                         PIC X(1).
  6319         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6320             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6321         16  CF-MORTG-MIB-VERSION           PIC X.
  6322             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6323             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6324             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6325         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6326             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6327                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6328             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6329                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6330             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6331                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6332             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6333                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6334             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6335                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6336             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6337                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6338         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6339         16  FILLER                         PIC X(7).
  6340         16  CF-MORTG-DESTINATION-SYMBOL.
  6341             20  CF-MORTG-MIB-COMM          PIC X(5).
  6342             20  CF-MORTG-MIB-TERM          PIC X(5).
  6343         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6344             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6345         16  FILLER                         PIC X(03).
  6346         16  CF-MP-CHECK-NO-CONTROL.
  6347             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 117
* EL050.cbl
  6348                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6349                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6350                                                ' ' LOW-VALUES.
  6351                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6352                                               VALUE '3'.
  6353         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6354         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6355         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6356             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6357                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6358             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6359                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6360             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6361                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6362             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6363                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6364             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6365                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6366             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6367                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6368         16  CF-MORTG-BILLING-AREA.
  6369             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6370                                            PIC X.
  6371         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6372         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6373         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6374         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6375             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6376             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6377         16  FILLER                         PIC X.
  6378         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6379             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6380             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6381         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6382         16  FILLER                         PIC X(8).
  6383         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6384         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6385         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6386         16  CF-ACH-COMPANY-ID.
  6387             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6388                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6389                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6390                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6391             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6392         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6393             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6394         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6395             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6396             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6397         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6398         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6399         16  FILLER                         PIC X(536).
  6400
  6401****************************************************************
  6402*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6403****************************************************************
  6404
  6405     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 118
* EL050.cbl
  6406         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6407             20  CF-FEMALE-HEIGHT.
  6408                 24  CF-FEMALE-FT           PIC 99.
  6409                 24  CF-FEMALE-IN           PIC 99.
  6410             20  CF-FEMALE-MIN-WT           PIC 999.
  6411             20  CF-FEMALE-MAX-WT           PIC 999.
  6412         16  FILLER                         PIC X(428).
  6413
  6414     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6415         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6416             20  CF-MALE-HEIGHT.
  6417                 24  CF-MALE-FT             PIC 99.
  6418                 24  CF-MALE-IN             PIC 99.
  6419             20  CF-MALE-MIN-WT             PIC 999.
  6420             20  CF-MALE-MAX-WT             PIC 999.
  6421         16  FILLER                         PIC X(428).
  6422******************************************************************
  6423*             AUTOMATIC ACTIVITY RECORD                          *
  6424******************************************************************
  6425     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6426         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6427             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6428             20  CF-SYS-LETTER-ID           PIC X(04).
  6429             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6430             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6431             20  CF-SYS-RESET-SW            PIC X(01).
  6432             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6433             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6434
  6435         16  FILLER                         PIC X(50).
  6436
  6437         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6438             20  CF-USER-ACTIVE-SW          PIC X(01).
  6439             20  CF-USER-LETTER-ID          PIC X(04).
  6440             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6441             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6442             20  CF-USER-RESET-SW           PIC X(01).
  6443             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6444             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6445             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6446
  6447         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 119
* EL050.cbl
  6449*    COPY ERCACCT.
  6450******************************************************************
  6451*                                                                *
  6452*                                                                *
  6453*                            ERCACCT                             *
  6454*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6455*                            VMOD=2.031                          *
  6456*                                                                *
  6457*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6458*                                                                *
  6459*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6460*   VSAM ACCOUNT MASTER FILES.                                   *
  6461*                                                                *
  6462*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6463*                                                                *
  6464*   FILE TYPE = VSAM,KSDS                                        *
  6465*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6466*                                                                *
  6467*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6468*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6469*                                                                *
  6470*   LOG = NO                                                     *
  6471*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6472*                                                                *
  6473*                                                                *
  6474******************************************************************
  6475*                   C H A N G E   L O G
  6476*
  6477* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6478*-----------------------------------------------------------------
  6479*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6480* EFFECTIVE    NUMBER
  6481*-----------------------------------------------------------------
  6482* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6483* 092705    2005050300006  PEMA  ADD SPP LEASES
  6484* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6485* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6486* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6487* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6488* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6489******************************************************************
  6490
  6491 01  ACCOUNT-MASTER.
  6492     12  AM-RECORD-ID                      PIC XX.
  6493         88  VALID-AM-ID                      VALUE 'AM'.
  6494
  6495     12  AM-CONTROL-PRIMARY.
  6496         16  AM-COMPANY-CD                 PIC X.
  6497         16  AM-MSTR-CNTRL.
  6498             20  AM-CONTROL-A.
  6499                 24  AM-CARRIER            PIC X.
  6500                 24  AM-GROUPING.
  6501                     28 AM-GROUPING-PREFIX PIC XXX.
  6502                     28 AM-GROUPING-PRIME  PIC XXX.
  6503                 24  AM-STATE              PIC XX.
  6504                 24  AM-ACCOUNT.
  6505                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6506                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 120
* EL050.cbl
  6507             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6508                                           PIC X(19).
  6509             20  AM-CNTRL-B.
  6510                 24  AM-EXPIRATION-DT      PIC XX.
  6511                 24  FILLER                PIC X(4).
  6512             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6513                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6514
  6515     12  AM-CONTROL-BY-VAR-GRP.
  6516         16  AM-COMPANY-CD-A1              PIC X.
  6517         16  AM-VG-CARRIER                 PIC X.
  6518         16  AM-VG-GROUPING                PIC X(6).
  6519         16  AM-VG-STATE                   PIC XX.
  6520         16  AM-VG-ACCOUNT                 PIC X(10).
  6521         16  AM-VG-DATE.
  6522             20  AM-VG-EXPIRATION-DT       PIC XX.
  6523             20  FILLER                    PIC X(4).
  6524         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6525                                           PIC 9(11)      COMP-3.
  6526     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6527         16  FILLER                        PIC X(10).
  6528         16  AM-VG-KEY3.
  6529             20  AM-VG3-ACCOUNT            PIC X(10).
  6530             20  AM-VG3-EXP-DT             PIC XX.
  6531         16  FILLER                        PIC X(4).
  6532     12  AM-MAINT-INFORMATION.
  6533         16  AM-LAST-MAINT-DT              PIC XX.
  6534         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6535         16  AM-LAST-MAINT-USER            PIC X(4).
  6536         16  FILLER                        PIC XX.
  6537
  6538     12  AM-EFFECTIVE-DT                   PIC XX.
  6539     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6540
  6541     12  AM-PREV-DATES  COMP-3.
  6542         16  AM-PREV-EXP-DT                PIC 9(11).
  6543         16  AM-PREV-EFF-DT                PIC 9(11).
  6544
  6545     12  AM-REPORT-CODE-1                  PIC X(10).
  6546     12  AM-REPORT-CODE-2                  PIC X(10).
  6547
  6548     12  AM-CITY-CODE                      PIC X(4).
  6549     12  AM-COUNTY-PARISH                  PIC X(6).
  6550
  6551     12  AM-NAME                           PIC X(30).
  6552     12  AM-PERSON                         PIC X(30).
  6553     12  AM-ADDRS                          PIC X(30).
  6554     12  AM-CITY.
  6555         16  AM-ADDR-CITY                  PIC X(28).
  6556         16  AM-ADDR-STATE                 PIC XX.
  6557     12  AM-ZIP.
  6558         16  AM-ZIP-PRIME.
  6559             20  AM-ZIP-PRI-1ST            PIC X.
  6560                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6561             20  FILLER                    PIC X(4).
  6562         16  AM-ZIP-PLUS4                  PIC X(4).
  6563     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6564         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 121
* EL050.cbl
  6565         16  AM-CAN-POSTAL-2               PIC XXX.
  6566         16  FILLER                        PIC XXX.
  6567     12  AM-TEL-NO.
  6568         16  AM-AREA-CODE                  PIC 999.
  6569         16  AM-TEL-PRE                    PIC 999.
  6570         16  AM-TEL-NBR                    PIC 9(4).
  6571     12  AM-TEL-LOC                        PIC X.
  6572         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6573         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6574
  6575     12  AM-COMM-STRUCTURE.
  6576         16  AM-DEFN-1.
  6577             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6578                 24  AM-AGT.
  6579                     28  AM-AGT-PREFIX     PIC X(4).
  6580                     28  AM-AGT-PRIME      PIC X(6).
  6581                 24  AM-COM-TYP            PIC X.
  6582                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6583                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6584                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6585                 24  AM-RECALC-LV-INDIC    PIC X.
  6586                 24  AM-RETRO-LV-INDIC     PIC X.
  6587                 24  AM-GL-CODES           PIC X.
  6588                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6589                 24  FILLER                PIC X(01).
  6590         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6591             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6592                 24  FILLER                PIC X(11).
  6593                 24  AM-L-COMA             PIC XXX.
  6594                 24  AM-J-COMA             PIC XXX.
  6595                 24  AM-A-COMA             PIC XXX.
  6596                 24  FILLER                PIC X(6).
  6597
  6598     12  AM-COMM-CHANGE-STATUS             PIC X.
  6599         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6600
  6601     12  AM-CSR-CODE                       PIC X(4).
  6602
  6603     12  AM-BILLING-STATUS                 PIC X.
  6604         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6605         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6606     12  AM-AUTO-REFUND-SW                 PIC X.
  6607         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6608         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6609     12  AM-GPCD                           PIC 99.
  6610     12  AM-IG                             PIC X.
  6611         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6612         88  AM-HAS-GROUP                     VALUE '2'.
  6613     12  AM-STATUS                         PIC X.
  6614         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6615         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6616         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6617         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6618         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6619         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6620     12  AM-REMIT-TO                       PIC 99.
  6621     12  AM-ID-NO                          PIC X(11).
  6622
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 122
* EL050.cbl
  6623     12  AM-CAL-TABLE                      PIC XX.
  6624     12  AM-LF-DEVIATION                   PIC XXX.
  6625     12  AM-AH-DEVIATION                   PIC XXX.
  6626     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6627     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6628     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6629     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6630     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6631     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6632
  6633     12  AM-USER-FIELDS.
  6634         16  AM-FLD-1                      PIC XX.
  6635         16  AM-FLD-2                      PIC XX.
  6636         16  AM-FLD-3                      PIC XX.
  6637         16  AM-FLD-4                      PIC XX.
  6638         16  AM-FLD-5                      PIC XX.
  6639
  6640     12  AM-1ST-PROD-DATE.
  6641         16  AM-1ST-PROD-YR                PIC XX.
  6642         16  AM-1ST-PROD-MO                PIC XX.
  6643         16  AM-1ST-PROD-DA                PIC XX.
  6644     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6645     12  AM-CERTS-PURGED-DATE.
  6646         16  AM-PUR-YR                     PIC XX.
  6647         16  AM-PUR-MO                     PIC XX.
  6648         16  AM-PUR-DA                     PIC XX.
  6649     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6650     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6651     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6652     12  AM-INACTIVE-DATE.
  6653         16  AM-INA-MO                     PIC 99.
  6654         16  AM-INA-DA                     PIC 99.
  6655         16  AM-INA-YR                     PIC 99.
  6656     12  AM-AR-HI-CERT-DATE                PIC XX.
  6657
  6658     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6659     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6660
  6661     12  AM-OB-PAYMENT-MODE                PIC X.
  6662         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6663         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6664         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6665         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6666
  6667     12  AM-AH-ONLY-INDICATOR              PIC X.
  6668         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6669         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6670
  6671     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6672
  6673     12  AM-OVER-SHORT.
  6674         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6675         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6676
  6677     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6678     12  AM-DCC-CLP-STATE                  PIC XX.
  6679
  6680     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 123
* EL050.cbl
  6681     12  AM-RECALC-REIN                    PIC X.
  6682
  6683     12  AM-REI-TABLE                      PIC XXX.
  6684     12  AM-REI-ET-LF                      PIC X.
  6685     12  AM-REI-ET-AH                      PIC X.
  6686     12  AM-REI-PE-LF                      PIC X.
  6687     12  AM-REI-PE-AH                      PIC X.
  6688     12  AM-REI-PRT-ST                     PIC X.
  6689     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6690     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6691     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6692     12  AM-REI-GROUP-A                    PIC X(6).
  6693     12  AM-REI-MORT                       PIC X(4).
  6694     12  AM-REI-PRT-OW                     PIC X.
  6695     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6696     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6697     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6698     12  AM-REI-GROUP-B                    PIC X(6).
  6699
  6700     12  AM-TRUST-TYPE                     PIC X(2).
  6701
  6702     12  AM-EMPLOYER-STMT-USED             PIC X.
  6703     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6704
  6705     12  AM-STD-AH-TYPE                    PIC XX.
  6706     12  AM-EARN-METHODS.
  6707         16  AM-EARN-METHOD-R              PIC X.
  6708             88 AM-REF-RL-R78                 VALUE 'R'.
  6709             88 AM-REF-RL-PR                  VALUE 'P'.
  6710             88 AM-REF-RL-MEAN                VALUE 'M'.
  6711             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6712         16  AM-EARN-METHOD-L              PIC X.
  6713             88 AM-REF-LL-R78                 VALUE 'R'.
  6714             88 AM-REF-LL-PR                  VALUE 'P'.
  6715             88 AM-REF-LL-MEAN                VALUE 'M'.
  6716             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6717         16  AM-EARN-METHOD-A              PIC X.
  6718             88 AM-REF-AH-R78                 VALUE 'R'.
  6719             88 AM-REF-AH-PR                  VALUE 'P'.
  6720             88 AM-REF-AH-MEAN                VALUE 'M'.
  6721             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6722             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6723             88 AM-REF-AH-NET                 VALUE 'N'.
  6724
  6725     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6726     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6727     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6728
  6729     12  AM-RET-Y-N                        PIC X.
  6730     12  AM-RET-P-E                        PIC X.
  6731     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6732     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6733     12  AM-RET-GRP                        PIC X(6).
  6734     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6735         16  AM-POOL-PRIME                 PIC XXX.
  6736         16  AM-POOL-SUB                   PIC XXX.
  6737     12  AM-RETRO-EARNINGS.
  6738         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 124
* EL050.cbl
  6739         16  AM-RET-EARN-L                 PIC X.
  6740         16  AM-RET-EARN-A                 PIC X.
  6741     12  AM-RET-ST-TAX-USE                 PIC X.
  6742         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6743         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6744     12  AM-RETRO-BEG-EARNINGS.
  6745         16  AM-RET-BEG-EARN-R             PIC X.
  6746         16  AM-RET-BEG-EARN-L             PIC X.
  6747         16  AM-RET-BEG-EARN-A             PIC X.
  6748     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6749     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6750
  6751     12  AM-USER-SELECT-OPTIONS.
  6752         16  AM-USER-SELECT-1              PIC X(10).
  6753         16  AM-USER-SELECT-2              PIC X(10).
  6754         16  AM-USER-SELECT-3              PIC X(10).
  6755         16  AM-USER-SELECT-4              PIC X(10).
  6756         16  AM-USER-SELECT-5              PIC X(10).
  6757
  6758     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6759
  6760     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6761
  6762     12  AM-RPT045A-SWITCH                 PIC X.
  6763         88  RPT045A-OFF                   VALUE 'N'.
  6764
  6765     12  AM-INSURANCE-LIMITS.
  6766         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6767         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6768
  6769     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6770         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6771
  6772     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6773         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6774         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6775
  6776     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6777
  6778     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6779     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6780     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6781     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6782     12  AM-DCC-UEF-STATE                  PIC XX.
  6783     12  FILLER                            PIC XXX.
  6784     12  AM-REPORT-CODE-3                  PIC X(10).
  6785*    12  FILLER                            PIC X(22).
  6786
  6787     12  AM-RESERVE-DATE.
  6788         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6789         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6790         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6791
  6792     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6793     12  AM-NOTIFICATION-TYPES.
  6794         16  AM-NOTIF-OF-LETTERS           PIC X.
  6795         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6796         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 125
* EL050.cbl
  6797         16  AM-NOTIF-OF-STATUS            PIC X.
  6798
  6799     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6800         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6801         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6802         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6803         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6804
  6805     12  AM-BENEFIT-CONTROLS.
  6806         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6807             20  AM-BENEFIT-CODE           PIC XX.
  6808             20  AM-BENEFIT-TYPE           PIC X.
  6809             20  AM-BENEFIT-REVISION       PIC XXX.
  6810             20  AM-BENEFIT-REM-TERM       PIC X.
  6811             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6812             20  FILLER                    PIC XX.
  6813         16  FILLER                        PIC X(80).
  6814
  6815     12  AM-TRANSFER-DATA.
  6816         16  AM-TRANSFERRED-FROM.
  6817             20  AM-TRNFROM-CARRIER        PIC X.
  6818             20  AM-TRNFROM-GROUPING.
  6819                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6820                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6821             20  AM-TRNFROM-STATE          PIC XX.
  6822             20  AM-TRNFROM-ACCOUNT.
  6823                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6824                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6825             20  AM-TRNFROM-DTE            PIC XX.
  6826         16  AM-TRANSFERRED-TO.
  6827             20  AM-TRNTO-CARRIER          PIC X.
  6828             20  AM-TRNTO-GROUPING.
  6829                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6830                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6831             20  AM-TRNTO-STATE            PIC XX.
  6832             20  AM-TRNTO-ACCOUNT.
  6833                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6834                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6835             20  AM-TRNTO-DTE              PIC XX.
  6836         16  FILLER                        PIC X(10).
  6837
  6838     12  AM-SAVED-REMIT-TO                 PIC 99.
  6839
  6840     12  AM-COMM-STRUCTURE-SAVED.
  6841         16  AM-DEFN-1-SAVED.
  6842             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6843                 24  AM-AGT-SV             PIC X(10).
  6844                 24  AM-COM-TYP-SV         PIC X.
  6845                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6846                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6847                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6848                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6849                 24  FILLER                PIC X.
  6850                 24  AM-GL-CODES-SV        PIC X.
  6851                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6852                 24  FILLER                PIC X.
  6853         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6854             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 126
* EL050.cbl
  6855                 24  FILLER                PIC X(11).
  6856                 24  AM-L-COMA-SV          PIC XXX.
  6857                 24  AM-J-COMA-SV          PIC XXX.
  6858                 24  AM-A-COMA-SV          PIC XXX.
  6859                 24  FILLER                PIC X(6).
  6860
  6861     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6862         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6863            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6864            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6865            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6866
  6867     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6868     12  FILLER                            PIC X(120).
  6869
  6870     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6871         16  AM-CONTROL-NAME               PIC X(30).
  6872         16  AM-EXECUTIVE-ONE.
  6873             20  AM-EXEC1-NAME             PIC X(15).
  6874             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6875                                                          COMP-3.
  6876             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6877                                                          COMP-3.
  6878         16  AM-EXECUTIVE-TWO.
  6879             20  AM-EXEC2-NAME             PIC X(15).
  6880             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6881                                                          COMP-3.
  6882             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6883                                                          COMP-3.
  6884
  6885     12  AM-RETRO-ADDITIONAL-DATA.
  6886         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6887         16  AM-RETRO-PREM-P-E             PIC X.
  6888         16  AM-RETRO-CLMS-P-I             PIC X.
  6889         16  AM-RETRO-RET-BRACKET-LF.
  6890             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6891                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6892                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6893             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6894                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6895                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6896             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6897                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6898                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6899         16  AM-RETRO-RET-BRACKET-AH.
  6900             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6901                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6902                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6903                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6904             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6905                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6906                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6907             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6908                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6909                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6910
  6911     12  AM-COMMENTS.
  6912         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 127
* EL050.cbl
  6913
  6914     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6915         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6916         16  AM-FLI-BILLING-CODE           PIC X.
  6917         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6918         16  AM-FLI-UNITED-IDENT           PIC X.
  6919         16  AM-FLI-INTEREST-LOST-DATA.
  6920             20  AM-FLI-BANK-NO            PIC X(5).
  6921             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6922             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6923             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6924         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6925             20  AM-FLI-AGT                PIC X(9).
  6926             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6927             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6928         16  FILLER                        PIC X(102).
  6929
  6930     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6931         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6932             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6933             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6934             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6935             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6936             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6937         16  FILLER                          PIC X(10).
  6938******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 128
* EL050.cbl
  6940*    COPY ERCREIN.
  6941******************************************************************
  6942*                                                                *
  6943*                            ERCREIN                             *
  6944*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6945*                            VMOD=2.010                          *
  6946*                                                                *
  6947*   ONLINE CREDIT SYSTEM                                         *
  6948*                                                                *
  6949*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6950*                                                                *
  6951*   FILE TYPE = VSAM,KSDS                                        *
  6952*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6953*                                                                *
  6954*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6955*       ALTERNATE PATH = NONE                                    *
  6956*                                                                *
  6957*   LOG = NO                                                     *
  6958*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6959*                                                                *
  6960******************************************************************
  6961*                   C H A N G E   L O G
  6962*
  6963* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6964*-----------------------------------------------------------------
  6965*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6966* EFFECTIVE    NUMBER
  6967*-----------------------------------------------------------------
  6968* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6969* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6970******************************************************************
  6971 01  REINSURANCE-RECORD.
  6972     12  RE-RECORD-ID                      PIC XX.
  6973         88  VALID-RE-ID                      VALUE 'RE'.
  6974
  6975     12  RE-CONTROL-PRIMARY.
  6976         16  RE-COMPANY-CD                 PIC X.
  6977         16  RE-KEY.
  6978             20  RE-CODE                   PIC X.
  6979                 88  RE-TABLE-RECORD          VALUE 'A'.
  6980                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6981             20  RE-TABLE                  PIC XXX.
  6982             20  FILLER                    PIC XXX.
  6983         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6984             20  FILLER                    PIC X.
  6985             20  RE-COMPANY.
  6986                 24  RE-COMP-PRIME         PIC XXX.
  6987                 24  RE-COMP-SUB           PIC XXX.
  6988
  6989     12  RE-MAINT-INFORMATION.
  6990         16  RE-LAST-MAINT-DT              PIC XX.
  6991         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6992         16  RE-LAST-MAINT-USER            PIC X(4).
  6993         16  FILLER                        PIC X(10).
  6994
  6995     12  RE-TABLE-DATA.
  6996         16  RE-100-COMP                   PIC 99.
  6997
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 129
* EL050.cbl
  6998         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6999             20  RE-REI-COMP-NO.
  7000                 24  RE-REI-COMP           PIC XXX.
  7001                 24  RE-REI-COMP-SUB       PIC XXX.
  7002             20  RE-LF-QC                  PIC X.
  7003             20  RE-AH-QC                  PIC X.
  7004             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7005             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7006             20  RE-LFAGE-LO               PIC 99.
  7007             20  RE-LFAGE-HI               PIC 99.
  7008             20  RE-AHAGE-LO               PIC 99.
  7009             20  RE-AHAGE-HI               PIC 99.
  7010             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7011             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7012             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7013             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7014             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7015             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7016             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7017             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7018             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7019             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7020             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7021             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7022             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7023             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7024             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7025             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7026             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7027             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7028             20  RE-LF-BEN-CODE            PIC X.
  7029             20  RE-AH-BEN-CODE            PIC X.
  7030             20  RE-INTERACTIVE            PIC X.
  7031             20  RE-REMAINING              PIC X.
  7032             20  RE-LF-RUNOFF-SW           PIC X.
  7033             20  RE-AH-RUNOFF-SW           PIC X.
  7034             20  FILLER                    PIC X(19).
  7035
  7036         16  RE-COMP-INFO-END              PIC X(6).
  7037         16  RE-NSP-ST-CD-LF               PIC XX.
  7038         16  RE-NSP-ST-CD-AH               PIC XX.
  7039         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7040             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7041
  7042         16  FILLER                        PIC X(27).
  7043
  7044     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7045         16  RE-NAME                       PIC X(30).
  7046         16  RE-LF-PE                      PIC X.
  7047         16  RE-AH-PE                      PIC X.
  7048         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7049         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7050         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7051         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7052         16  RE-PRT-ST                     PIC X.
  7053         16  RE-PRT-OW                     PIC X.
  7054         16  RE-MORT-CODE                  PIC X(4).
  7055         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 130
* EL050.cbl
  7056         16  RE-ZERO-LF-FEE                PIC X.
  7057         16  RE-ZERO-AH-FEE                PIC X.
  7058         16  RE-CEDE-NAME                  PIC X(30).
  7059         16  RE-LF-COMM                    PIC X.
  7060         16  RE-AH-COMM                    PIC X.
  7061         16  RE-LF-TAX                     PIC X.
  7062         16  RE-AH-TAX                     PIC X.
  7063         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7064         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7065         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7066
  7067         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7068             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7069
  7070         16  RE-LF-CEDING-FEE-BRACKETS.
  7071             20  RE-LF-FEE-METHOD          PIC X.
  7072                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7073                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7074                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7075                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7076             20  RE-LF-FEE-BASIS           PIC X.
  7077                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7078                 88  RE-LF-NET-CEDED               VALUE '2'.
  7079                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7080                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7081                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7082                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7083                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7084                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7085             20  FILLER                    PIC XXX.
  7086             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7087                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7088                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7089
  7090         16  RE-AH-CEDING-FEE-BRACKETS.
  7091             20  RE-AH-FEE-METHOD          PIC X.
  7092                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7093                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7094                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7095                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7096             20  RE-AH-FEE-BASIS           PIC X.
  7097                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7098                 88  RE-AH-NET-CEDED               VALUE '2'.
  7099                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7100                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7101                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7102                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7103                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7104                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7105             20  FILLER                    PIC XXX.
  7106             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7107                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7108                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7109
  7110         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7111
  7112         16  RE-OLD-CEDING-STMT            PIC X.
  7113
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 131
* EL050.cbl
  7114         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7115         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7116         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7117         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7118         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7119         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7120         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7121         16  RE-MORT-SW                    PIC X.
  7122         16  RE-CEDING-TYPE-FLAG           PIC X.
  7123             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7124             88  RE-CEDED                          VALUE 'C'.
  7125             88  RE-ASSUMED                        VALUE 'A'.
  7126             88  RE-PHANTOM                        VALUE 'P'.
  7127
  7128         16  RE-CEDING-STMT-OPT-A          PIC X.
  7129             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7130         16  RE-CEDING-STMT-OPT-B          PIC X.
  7131             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7132         16  RE-CEDING-STMT-OPT-C          PIC X.
  7133             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7134         16  RE-CEDING-STMT-OPT-D          PIC X.
  7135             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7136         16  RE-CEDING-STMT-OPT-E          PIC X.
  7137             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7138
  7139         16  RE-PRT-CRSV                   PIC X.
  7140
  7141         16  RE-GL-CENTER                  PIC X(4).
  7142
  7143         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7144
  7145         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7146
  7147         16  RE-EARN-STOP-CODE             PIC X.
  7148             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7149             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7150
  7151         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7152             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7153
  7154         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7155         16  FILLER                        PIC X(2281).
  7156
  7157         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7158
  7159******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 132
* EL050.cbl
  7161*    COPY ERCCTBL.
  7162******************************************************************
  7163*                                                                *
  7164*                                                                *
  7165*                            ERCCTBL                             *
  7166*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7167*                            VMOD=2.003
  7168*                                                                *
  7169*   ONLINE CREDIT SYSTEM                                         *
  7170*                                                                *
  7171*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7172*                                                                *
  7173*   FILE TYPE = VSAM,KSDS                                        *
  7174*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7175*                                                                *
  7176*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7177*       ALTERNATE PATH = NONE                                    *
  7178*                                                                *
  7179*   LOG = NO                                                     *
  7180*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7181*                                                                *
  7182*                                                                *
  7183******************************************************************
  7184
  7185 01  COMM-TABLE-RECORD.
  7186     12  CT-RECORD-ID                      PIC XX.
  7187         88  VALID-CT-ID                      VALUE 'CT'.
  7188
  7189     12  CT-CONTROL-PRIMARY.
  7190         16  CT-COMPANY-CD                 PIC X.
  7191         16  CT-TABLE                      PIC XXX.
  7192         16  CT-CNTRL-2.
  7193             20  CT-BEN-TYPE               PIC X.
  7194             20  CT-BEN-CODE               PIC XX.
  7195
  7196     12  CT-MAINT-INFORMATION.
  7197         16  CT-LAST-MAINT-DT              PIC XX.
  7198         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7199         16  CT-LAST-MAINT-USER            PIC X(4).
  7200         16  FILLER                        PIC X(31).
  7201
  7202     12  CT-LIMITS.
  7203         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7204
  7205         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7206
  7207         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7208
  7209     12  CT-RATES.
  7210         16  CT-RTX          OCCURS 27 TIMES.
  7211             20  CT-RT                     PIC SV9(5)     COMP-3.
  7212             20  CT-RT-R   REDEFINES
  7213                 CT-RT                     PIC XXX.
  7214
  7215     12  FILLER                            PIC  X(42).
  7216
  7217******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 133
* EL050.cbl
  7219*    COPY ERCFORM.
  7220******************************************************************
  7221*                                                                *
  7222*                                                                *
  7223*                            ERCFORM.                            *
  7224*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7225*                            VMOD=2.003                          *
  7226*                                                                *
  7227*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7228*                                                                *
  7229*    FILE TYPE = VSAM,KSDS                                       *
  7230*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7231*                                                                *
  7232*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7233*                                                                *
  7234*    LOG = YES                                                   *
  7235*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7236******************************************************************
  7237 01  FORM-MASTER.
  7238    12  FO-RECORD-ID                 PIC X(02).
  7239        88  VALID-FO-ID                  VALUE 'FO'.
  7240
  7241    12  FO-CONTROL-PRIMARY.
  7242        16  FO-COMPANY-CD            PIC X(01).
  7243        16  FO-STATE                 PIC X(02).
  7244        16  FO-FORM-ID               PIC X(12).
  7245        16  FO-FORM-EXP-DT           PIC X(02).
  7246
  7247    12  FO-POLICY-FORM-DATA.
  7248        16  FO-IND-GRP-CD            PIC X(01).
  7249        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7250        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7251        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7252        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7253        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7254        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7255        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7256        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7257        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7258        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7259        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7260        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7261        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7262        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7263        16  FO-APP-CERT-USE-CD       PIC X(01).
  7264
  7265    12  FILLER                       PIC X(29).
  7266
  7267    12  FO-FORM-PLAN-TABLE.
  7268        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7269            20  FO-PLAN-TYPE         PIC X(01).
  7270            20  FO-PLAN-ID           PIC X(02).
  7271            20  FO-PLAN-TERM         PIC 9(03).
  7272            20  FO-PLAN-REFUND-METHOD
  7273                                     PIC X.
  7274
  7275    12  FILLER                       PIC X(30).
  7276
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 134
* EL050.cbl
  7277    12  FO-COMMENTS-AREA.
  7278        16  FO-COMMENT-LINE-1        PIC X(78).
  7279
  7280    12  FILLER                       PIC X(20).
  7281
  7282    12  FO-MAINT-INFORMATION.
  7283        16  FO-LAST-MAINT-DT         PIC X(02).
  7284        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7285        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 135
* EL050.cbl
  7287*    COPY ELCMSTR.
  7288******************************************************************
  7289*                                                                *
  7290*                            ELCMSTR.                            *
  7291*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7292*                            VMOD=2.012                          *
  7293*                                                                *
  7294*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7295*                                                                *
  7296*   FILE TYPE = VSAM,KSDS                                        *
  7297*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7298*                                                                *
  7299*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7300*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7301*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7302*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7303*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7304*                                                 RKP=75,LEN=21  *
  7305*                                                                *
  7306*   **** NOTE ****                                               *
  7307*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7308*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7309*                                                                *
  7310*   LOG = YES                                                    *
  7311*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7312******************************************************************
  7313*                   C H A N G E   L O G
  7314*
  7315* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7316*-----------------------------------------------------------------
  7317*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7318* EFFECTIVE    NUMBER
  7319*-----------------------------------------------------------------
  7320* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7321* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7322* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7323* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7324* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7325******************************************************************
  7326 01  CLAIM-MASTER.
  7327     12  CL-RECORD-ID                PIC XX.
  7328         88  VALID-CL-ID         VALUE 'CL'.
  7329
  7330     12  CL-CONTROL-PRIMARY.
  7331         16  CL-COMPANY-CD           PIC X.
  7332         16  CL-CARRIER              PIC X.
  7333         16  CL-CLAIM-NO             PIC X(7).
  7334         16  CL-CERT-NO.
  7335             20  CL-CERT-PRIME       PIC X(10).
  7336             20  CL-CERT-SFX         PIC X.
  7337
  7338     12  CL-CONTROL-BY-NAME.
  7339         16  CL-COMPANY-CD-A1        PIC X.
  7340         16  CL-INSURED-LAST-NAME    PIC X(15).
  7341         16  CL-INSURED-NAME.
  7342             20  CL-INSURED-1ST-NAME PIC X(12).
  7343             20  CL-INSURED-MID-INIT PIC X.
  7344
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 136
* EL050.cbl
  7345     12  CL-CONTROL-BY-SSN.
  7346         16  CL-COMPANY-CD-A2        PIC X.
  7347         16  CL-SOC-SEC-NO.
  7348             20  CL-SSN-STATE        PIC XX.
  7349             20  CL-SSN-ACCOUNT      PIC X(6).
  7350             20  CL-SSN-LN3          PIC X(3).
  7351
  7352     12  CL-CONTROL-BY-CERT-NO.
  7353         16  CL-COMPANY-CD-A4        PIC X.
  7354         16  CL-CERT-NO-A4.
  7355             20  CL-CERT-A4-PRIME    PIC X(10).
  7356             20  CL-CERT-A4-SFX      PIC X.
  7357
  7358     12  CL-CONTROL-BY-CCN.
  7359         16  CL-COMPANY-CD-A5        PIC X.
  7360         16  CL-CCN-A5.
  7361             20  CL-CCN.
  7362                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7363                 24  CL-CCN-PRIME-A5 PIC X(12).
  7364             20  CL-CCN-FILLER-A5    PIC X(4).
  7365
  7366     12  CL-INSURED-PROFILE-DATA.
  7367         16  CL-INSURED-BIRTH-DT     PIC XX.
  7368         16  CL-INSURED-SEX-CD       PIC X.
  7369             88  INSURED-IS-MALE        VALUE 'M'.
  7370             88  INSURED-IS-FEMALE      VALUE 'F'.
  7371             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7372         16  CL-INSURED-OCC-CD       PIC X(6).
  7373         16  FILLER                  PIC X(5).
  7374
  7375     12  CL-PROCESSING-INFO.
  7376         16  CL-PROCESSOR-ID         PIC X(4).
  7377         16  CL-CLAIM-STATUS         PIC X.
  7378             88  CLAIM-IS-OPEN          VALUE 'O'.
  7379             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7380         16  CL-CLAIM-TYPE           PIC X.
  7381*            88  AH-CLAIM               VALUE 'A'.
  7382*            88  LIFE-CLAIM             VALUE 'L'.
  7383*            88  PROPERTY-CLAIM         VALUE 'P'.
  7384*            88  IUI-CLAIM              VALUE 'I'.
  7385*            88  GAP-CLAIM              VALUE 'G'.
  7386*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7387         16  CL-CLAIM-PREM-TYPE      PIC X.
  7388             88  SINGLE-PREMIUM         VALUE '1'.
  7389             88  O-B-COVERAGE           VALUE '2'.
  7390             88  OPEN-END-COVERAGE      VALUE '3'.
  7391         16  CL-INCURRED-DT          PIC XX.
  7392         16  CL-REPORTED-DT          PIC XX.
  7393         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7394         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7395         16  CL-LAST-PMT-DT          PIC XX.
  7396         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7397         16  CL-PAID-THRU-DT         PIC XX.
  7398         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7399         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7400         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7401         16  CL-PMT-CALC-METHOD      PIC X.
  7402             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 137
* EL050.cbl
  7403             88  CL-365-DAY-YR          VALUE '2'.
  7404             88  CL-FULL-MONTHS         VALUE '3'.
  7405         16  CL-CAUSE-CD             PIC X(6).
  7406
  7407         16  CL-PRIME-CERT-NO.
  7408             20  CL-PRIME-CERT-PRIME PIC X(10).
  7409             20  CL-PRIME-CERT-SFX   PIC X.
  7410
  7411         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7412             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7413             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7414
  7415         16  CL-MICROFILM-NO         PIC X(10).
  7416         16  FILLER REDEFINES CL-MICROFILM-NO.
  7417             20  CL-BENEFIT-PERIOD   PIC 99.
  7418             20  FILLER              PIC X(8).
  7419         16  CL-PROG-FORM-TYPE       PIC X.
  7420         16  CL-LAST-ADD-ON-DT       PIC XX.
  7421
  7422         16  CL-LAST-REOPEN-DT       PIC XX.
  7423         16  CL-LAST-CLOSE-DT        PIC XX.
  7424         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7425             88  FINAL-PAID             VALUE '1'.
  7426             88  CLAIM-DENIED           VALUE '2'.
  7427             88  AUTO-CLOSE             VALUE '3'.
  7428             88  MANUAL-CLOSE           VALUE '4'.
  7429             88  BENEFITS-CHANGED       VALUE 'C'.
  7430             88  SETUP-ERRORS           VALUE 'E'.
  7431         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7432         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7433         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7434             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7435         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7436         16  FILLER                  PIC X.
  7437
  7438     12  CL-CERTIFICATE-DATA.
  7439         16  CL-CERT-ORIGIN          PIC X.
  7440             88  CERT-WAS-ONLINE        VALUE '1'.
  7441             88  CERT-WAS-CREATED       VALUE '2'.
  7442             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7443         16  CL-CERT-KEY-DATA.
  7444             20  CL-CERT-CARRIER     PIC X.
  7445             20  CL-CERT-GROUPING    PIC X(6).
  7446             20  CL-CERT-STATE       PIC XX.
  7447             20  CL-CERT-ACCOUNT.
  7448                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7449                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7450             20  CL-CERT-EFF-DT      PIC XX.
  7451
  7452     12  CL-STATUS-CONTROLS.
  7453         16  CL-PRIORITY-CD          PIC X.
  7454             88  CONFIDENTIAL-DATA      VALUE '8'.
  7455             88  HIGHEST-PRIORITY       VALUE '9'.
  7456         16  CL-SUPV-ATTN-CD         PIC X.
  7457             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7458             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7459         16  CL-PURGED-DT            PIC XX.
  7460         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 138
* EL050.cbl
  7461         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7462         16  CL-NEXT-RESEND-DT       PIC XX.
  7463         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7464         16  CL-CRITICAL-PERIOD      PIC 99.
  7465*        16  FILLER                  PIC XX.
  7466         16  CL-LAST-MAINT-DT        PIC XX.
  7467         16  CL-LAST-MAINT-USER      PIC X(4).
  7468         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7469         16  CL-LAST-MAINT-TYPE      PIC X.
  7470             88  CLAIM-SET-UP           VALUE ' '.
  7471             88  PAYMENT-MADE           VALUE '1'.
  7472             88  LETTER-SENT            VALUE '2'.
  7473             88  MASTER-WAS-ALTERED     VALUE '3'.
  7474             88  MASTER-WAS-RESTORED    VALUE '4'.
  7475             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7476             88  FILE-CONVERTED         VALUE '6'.
  7477             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7478             88  ERROR-CORRECTION       VALUE 'E'.
  7479         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7480         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7481         16  CL-BENEFICIARY          PIC X(10).
  7482         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7483         16  CL-DENIAL-TYPE          PIC X.
  7484             88  CL-TYPE-DENIAL          VALUE '1'.
  7485             88  CL-TYPE-RESCISSION      VALUE '2'.
  7486             88  CL-TYPE-REFORMATION     VALUE '3'.
  7487             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7488             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7489         16  filler                  pic x(5).
  7490*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7491*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7492*        16  CL-RTW-DT               PIC XX.
  7493
  7494     12  CL-TRAILER-CONTROLS.
  7495         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7496             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7497             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7498             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7499         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7500         16  FILLER                  PIC XX.
  7501         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7502         16  CL-ADDRESS-TRAILER-CNT.
  7503             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7504                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7505             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7506                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7507             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7508                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7509             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7510                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7511             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7512                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7513             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7514                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7515             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7516                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7517
  7518     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 139
* EL050.cbl
  7519         16  CL-CV-REFNO-PRIME       PIC X(18).
  7520         16  CL-CV-REFNO-SFX         PIC XX.
  7521
  7522     12  CL-FILE-LOCATION            PIC X(4).
  7523
  7524     12  CL-PROCESS-ERRORS.
  7525         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7526             88  NO-FATAL-ERRORS        VALUE ZERO.
  7527         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7528             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7529
  7530     12  CL-PRODUCT-CD               PIC X.
  7531
  7532     12  CL-CURRENT-KEY-DATA.
  7533         16  CL-CURRENT-CARRIER      PIC X.
  7534         16  CL-CURRENT-GROUPING     PIC X(6).
  7535         16  CL-CURRENT-STATE        PIC XX.
  7536         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7537
  7538     12  CL-ASSOCIATES               PIC X.
  7539         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7540         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7541         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7542         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7543
  7544     12  CL-ACTIVITY-CODE            PIC 99.
  7545     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7546     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7547
  7548     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7549     12  CL-LAG-REPORT-CODE          PIC 9.
  7550     12  CL-LOAN-TYPE                PIC XX.
  7551     12  CL-LEGAL-STATE              PIC XX.
  7552
  7553     12  CL-YESNOSW                  PIC X.
  7554     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7555         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7556         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7557         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7558     12  cl-insured-type             pic x.
  7559         88  cl-claim-on-primary         value 'P'.
  7560         88  cl-claim-on-co-borrower     value 'C'.
  7561     12  cl-benefit-expiration-dt    PIC XX.
  7562
  7563 01  PLAN-RECORDS.
  7564     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7565     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7566
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 140
* EL050.cbl
  7568 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7569                          ACCOUNT-MASTER REINSURANCE-RECORD
  7570                          COMM-TABLE-RECORD FORM-MASTER
  7571                          CLAIM-MASTER PLAN-RECORDS.
  7572 0000-DFHEXIT SECTION.
  7573     MOVE '9#                    $   ' TO DFHEIV0.
  7574     MOVE 'EL050' TO DFHEIV1.
  7575     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7576
  7577     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7578
  7579
  7580* EXEC CICS  HANDLE CONDITION
  7581*           ERROR    (9300-ABEND)
  7582*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7583*    END-EXEC.
  7584*    MOVE '"$.J                  ! " #00007575' TO DFHEIV0
  7585     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7586     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7587     MOVE X'2220233030303037353735' TO DFHEIV0(25:11)
  7588     CALL 'kxdfhei1' USING DFHEIV0
  7589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7590
  7591
  7592 0000-COPY-PROCEDURE-DIV.
  7593*                          COPY ELC50PD.
  7594******************************************************************
  7595*                                                                *
  7596*                            ELC50PD                             *
  7597*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7598*                            VMOD=2.188                          *
  7599*                                                                *
  7600******************************************************************
  7601*                   C H A N G E   L O G
  7602*
  7603* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7604*-----------------------------------------------------------------
  7605*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7606* EFFECTIVE    NUMBER
  7607*-----------------------------------------------------------------
  7608* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7609* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7610* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7611*                             2709 AND 2718
  7612* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7613* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7614* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7615* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7616* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7617*                                IS OPEN OR CNC DT < PD THRU
  7618* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7619* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7620* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7621* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7622* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7623* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7624* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7625* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 141
* EL050.cbl
  7626* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7627* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7628* 020906                   PEMA  EXPAND LOAN OFFICER
  7629* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7630* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7631* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7632* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7633* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7634* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7635* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7636* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7637* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7638* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7639* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7640* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7641* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7642* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7643* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7644* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7645* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7646* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7647* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7648* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7649* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7650* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7651* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7652* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7653* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7654*                                UPDATE VIN ON CERT TRAILER
  7655* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7656* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7657* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7658* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7659* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7660* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7661* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7662* 040610  IR2010030800001  PEMA  INIT ALTERNATE BENEFIT
  7663* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7664* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7665* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7666* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7667* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7668* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7669* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7670* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7671* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7672* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7673* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7674* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7675* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7676* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7677* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7678* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7679* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7680* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7681* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7682* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7683* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 142
* EL050.cbl
  7684* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7685* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7686* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7687* 032912  CR2011110200001  PEMA  AHL CHANGES
  7688* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7689* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7690* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7691* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7692* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7693* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7694* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7695* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7696* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7697* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7698* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7699* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7700* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7701* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7702* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7703* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7704* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7705* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7706* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7707* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7708* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7709* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7710* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7711******************************************************************
  7712************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7713******************************************************************
  7714
  7715     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7716
  7717     MOVE SPACES                 TO PB-FATAL-FLAG
  7718                                    PB-FORCE-ER-CD
  7719                                    PB-WARN-ER-CD
  7720                                    PB-OUT-BAL-CD.
  7721
  7722     MOVE SPACE                  TO WS-IG-OVRD-AH
  7723                                    WS-IG-OVRD-LF
  7724                                    WS-IG-OVRD-AM
  7725                                    WS-IG-OVRD
  7726                                    WS-IG-OVRD-AH-PL
  7727                                    WS-IG-OVRD-LF-PL
  7728                                    WS-IG-OVRD-AH-BEN
  7729                                    WS-IG-OVRD-LF-BEN.
  7730
  7731******************************************************************
  7732*************       INITIALIZE COMMON ERRORS       ***************
  7733******************************************************************
  7734
  7735     MOVE +0                     TO PB-NO-OF-ERRORS.
  7736     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7737
  7738******************************************************************
  7739
  7740     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7741     SET JULIAN-TO-BIN           TO TRUE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 143
* EL050.cbl
  7742*    MOVE 5                      TO DC-OPTION-CODE.
  7743     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7744     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7745
  7746     MOVE ZERO                   TO  SUB4.
  7747
  7748 0040-INITIALIZE-GA-BILL-DT.
  7749
  7750     ADD +1                      TO  SUB4.
  7751
  7752     IF  SUB4 GREATER THAN +5
  7753         GO TO 0050-CHECK-CNTL-FOUND.
  7754
  7755     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7756         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7757
  7758     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7759
  7760 0050-CHECK-CNTL-FOUND.
  7761
  7762     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7763        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7764                                         WS-AH-REM-TERM-CALC
  7765                                         EC-CO-REM-TERM-CALC
  7766        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7767        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7768        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7769                                         WS-TOL-AH-CLAIM
  7770        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7771                                         WS-TOL-AH-PREM
  7772                                         EC-CO-TOL-PREM
  7773        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7774                                         WS-TOL-AH-REFUND
  7775                                         EC-CO-TOL-REFUND
  7776        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7777                                         WS-AH-REFUND-OVS-AMT
  7778                                         EC-CO-OVR-SHT-AMT
  7779        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7780                                         WS-TOL-AH-PREM-PCT
  7781                                         EC-CO-TOL-PREM-PCT
  7782        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7783                                         WS-TOL-AH-REFUND-PCT
  7784                                         EC-CO-TOL-REFUND-PCT
  7785        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7786                                         WS-AH-REFUND-OVS-PCT
  7787                                         EC-CO-OVR-SHT-PCT
  7788        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7789        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7790        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7791        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7792        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7793        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7794        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7795        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7796        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7797        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7798        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7799        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 144
* EL050.cbl
  7800                                         EC-CO-MONTH-END-DT
  7801        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7802          GO TO 0100-READ-ACCT.
  7803
  7804     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7805     MOVE SPACES                 TO CNTL-ACCESS.
  7806     MOVE '1'                    TO CNTL-REC-TYPE.
  7807     MOVE +0                     TO CNTL-SEQ-NO.
  7808
  7809     MOVE '1' TO RC-SW-1.
  7810     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7811     IF NOT CF-COMPANY-MASTER
  7812         MOVE ZEROS             TO WK-CO-TOL-PREM
  7813                                   WK-CO-TOL-CLAIM
  7814                                   WK-CO-TOL-REFUND
  7815                                   WK-REFUND-OVS-AMT
  7816                                   WK-REFUND-OVS-PCT
  7817                                   WK-CO-TOL-PREM-PCT
  7818                                   WK-CO-TOL-REFUND-PCT
  7819                                   WK-DEFAULT-APR
  7820                                   WK-CO-MAX-CAP
  7821        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7822                                   WK-CR-R78-METHOD
  7823                                   WK-CO-REF-REJECT-SW
  7824                                   WK-CO-PREM-REJECT-SW
  7825                                   WK-REM-TRM-CALC-OPTION
  7826                                   WK-BIRTH-DATE-INPUT
  7827                                   WK-JOINT-AGE-INPUT
  7828        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7829        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7830        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7831        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7832          GO TO 0099-COMPANY-NOT-FOUND.
  7833
  7834     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7835        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7836     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7837        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7838     IF CF-CO-TOL-CAP NOT NUMERIC
  7839        MOVE +0                    TO CF-CO-TOL-CAP.
  7840     IF CF-DEFAULT-APR NOT NUMERIC
  7841        MOVE +0                    TO CF-DEFAULT-APR.
  7842
  7843     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7844     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7845     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7846     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7847     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7848     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7849     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7850     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7851     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7852     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7853     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7854     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7855
  7856     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7857          CF-CO-OVR-SHT-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 145
* EL050.cbl
  7858        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7859
  7860     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7861          CF-CO-OVR-SHT-PCT > +0
  7862        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7863
  7864     IF CF-VALID-REM-TRM-OPTION
  7865         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7866     ELSE
  7867         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7868
  7869     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7870     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7871     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7872     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7873
  7874     GO TO 0050-CHECK-CNTL-FOUND.
  7875
  7876 0099-COMPANY-NOT-FOUND.
  7877
  7878     MOVE ER-2616                TO WS-ERROR.
  7879     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7880
  7881 0100-READ-ACCT.
  7882
  7883     MOVE SPACES                 TO DATE-RANGE-SW.
  7884
  7885     IF WK-ACCT-ADDR = ZEROS
  7886        GO TO 0102-ACCT-GETMAIN.
  7887
  7888     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7889     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7890     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7891
  7892     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7893        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7894        GO TO 0105-READ-ACCT
  7895     END-IF
  7896
  7897     IF PB-CARRIER NOT = SPACES
  7898        IF PB-CARRIER NOT = AM-VG-CARRIER
  7899           GO TO 0105-READ-ACCT.
  7900
  7901     IF PB-STATE NOT = SPACES
  7902        IF PB-STATE NOT = AM-VG-STATE
  7903           GO TO 0105-READ-ACCT.
  7904
  7905     IF PB-GROUPING NOT = SPACES
  7906        IF PB-GROUPING NOT = AM-VG-GROUPING
  7907           GO TO 0105-READ-ACCT.
  7908
  7909     MOVE 'X'                 TO DATE-RANGE-SW.
  7910
  7911     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7912        MOVE 'X'                 TO DATE-RANGE-SW
  7913        GO TO 0105-READ-ACCT.
  7914
  7915     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 146
* EL050.cbl
  7916        GO TO 0105-READ-ACCT.
  7917
  7918     GO TO 0180-ACCOUNT-FOUND.
  7919
  7920 0102-ACCT-GETMAIN.
  7921     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7922     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7923
  7924 0105-READ-ACCT.
  7925     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  7926     MOVE PB-CARRIER             TO ACCT-CARRIER.
  7927     MOVE PB-GROUPING            TO ACCT-GROUPING.
  7928     MOVE PB-STATE               TO ACCT-STATE.
  7929     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  7930     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  7931
  7932     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  7933
  7934     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  7935
  7936 0110-FIND-ACCT-TOLERANCES-LOOP.
  7937     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  7938
  7939     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7940        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7941        GO TO 0199-ACCT-NOT-FOUND
  7942     END-IF
  7943     IF PB-CARRIER NOT = SPACES
  7944        IF PB-CARRIER NOT = AM-VG-CARRIER
  7945           GO TO 0199-ACCT-NOT-FOUND.
  7946
  7947     IF PB-STATE NOT = SPACES
  7948        IF PB-STATE NOT = AM-VG-STATE
  7949           GO TO 0199-ACCT-NOT-FOUND.
  7950
  7951     IF PB-GROUPING NOT = SPACES
  7952        IF PB-GROUPING NOT = AM-VG-GROUPING
  7953           GO TO 0199-ACCT-NOT-FOUND.
  7954
  7955     MOVE 'X'                    TO DATE-RANGE-SW.
  7956
  7957     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7958        MOVE 'X'                 TO DATE-RANGE-SW
  7959        GO TO 0199-ACCT-NOT-FOUND.
  7960
  7961     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7962        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  7963
  7964 0180-ACCOUNT-FOUND.
  7965     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  7966     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  7967     MOVE AM-STATE               TO PB-SV-STATE.
  7968     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  7969
  7970     IF AM-CANCEL-FEE  NOT NUMERIC
  7971        MOVE ZEROS TO AM-CANCEL-FEE.
  7972
  7973     IF AM-MAX-MON-BEN NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 147
* EL050.cbl
  7974        MOVE ZEROS TO AM-MAX-MON-BEN.
  7975
  7976     IF AM-MAX-TOT-BEN NOT NUMERIC
  7977        MOVE ZEROS TO AM-MAX-TOT-BEN.
  7978
  7979     IF AM-CLP-TOL-PCT NOT NUMERIC
  7980        MOVE +0                  TO AM-CLP-TOL-PCT
  7981     END-IF
  7982     IF AM-SPP-LEASE-COMM NOT NUMERIC
  7983        MOVE +0                  TO AM-SPP-LEASE-COMM
  7984     END-IF
  7985     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7986        MOVE ER-2611             TO   WS-ERROR
  7987        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7988
  7989     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  7990        MOVE ER-2621             TO   WS-ERROR
  7991        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7992
  7993     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  7994        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  7995        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  7996        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  7997         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  7998
  7999     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8000     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8001     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8002     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8003     IF AM-CLP-TOL-PCT NOT = ZEROS
  8004        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8005     END-IF
  8006     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8007        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8008     END-IF
  8009*    IF PB-COMPANY-ID = 'DCC'
  8010*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8011*                                   WS-ADMIN-FEES
  8012*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8013*          (SUB5 > +10)
  8014*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8015*             AND (AM-A-COM (SUB5) NUMERIC)
  8016*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8017*                + (AM-A-COM (SUB5) * 1000)
  8018*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8019*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8020*                + (AM-A-COM (SUB5) * 1000)
  8021*             END-IF
  8022*             IF AM-COM-TYP (SUB5) = 'N'
  8023*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8024*                + (AM-A-COM (SUB5) * 1000)
  8025*             END-IF
  8026*          END-IF
  8027*       END-PERFORM
  8028*    END-IF
  8029     IF (PB-COMPANY-ID = 'DCC')
  8030        AND (PB-ISSUE)
  8031        MOVE +0                  TO WS-ACCT-ADDL-CLP
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 148
* EL050.cbl
  8032        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8033           (SUB5 > +10)
  8034           MOVE +0 TO WS-WK-RATE
  8035           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8036              IF (AM-A-COM (SUB5) NUMERIC)
  8037                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8038                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8039              ELSE
  8040                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8041                 IF PB-ISSUE
  8042                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8043                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8044                 ELSE
  8045                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8046                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8047                 END-IF
  8048                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8049                 MOVE ZEROS             TO WS-SUB1
  8050                                           WS-COMMISSION
  8051                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8052                 MOVE '0530'               TO CTBL-SW
  8053                 MOVE ' '                  TO WS-CTBL-READ-SW
  8054                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8055                 IF FIRST-TIME-THROUGH
  8056                    MOVE 'AA'              TO CTBL-BEN-CODE
  8057                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8058                 END-IF
  8059                 IF CTBL-TABLE-FOUND
  8060                    IF PB-ISSUE
  8061                       COMPUTE WS-COMM-CK-AMT =
  8062                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8063                    ELSE
  8064                       COMPUTE WS-COMM-CK-AMT =
  8065                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8066                    END-IF
  8067                    PERFORM 8800-GET-COMP-RATE
  8068                              THRU 8800-EXIT
  8069                 END-IF
  8070              END-IF
  8071              COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8072                + (WS-WK-RATE * 1000)
  8073           END-IF
  8074        END-PERFORM
  8075     END-IF
  8076     IF PB-COMPANY-ID EQUAL 'CRI'
  8077         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8078
  8079     IF PB-COMPANY-ID EQUAL 'NCL'
  8080         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8081     END-IF
  8082
  8083     GO TO 0200-READ-CERT.
  8084
  8085 0199-ACCT-NOT-FOUND.
  8086
  8087     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8088
  8089     IF DATE-RANGE-SW NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 149
* EL050.cbl
  8090        MOVE ER-2601             TO WS-ERROR
  8091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8092     ELSE
  8093        MOVE ER-2619             TO WS-ERROR
  8094        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8095
  8096     GO TO 9990-RETURN.
  8097
  8098 0200-READ-CERT.
  8099
  8100     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8101     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8102     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8103     MOVE PB-SV-STATE            TO CERT-STATE.
  8104     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8105     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8106     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8107
  8108     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8109
  8110     IF CERT-WAS-NOT-FOUND
  8111        GO TO 0299-CERT-NOT-FOUND.
  8112
  8113     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8114        MOVE ER-2759             TO WS-ERROR
  8115        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8116        GO TO 0298-UNLOCK-RETURN.
  8117
  8118     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8119         MOVE ER-2758            TO WS-ERROR
  8120         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8121         GO TO 0298-UNLOCK-RETURN.
  8122
  8123     IF PB-ISSUE
  8124        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8125           IF CERT-WAS-CREATED-FOR-CLAIM
  8126              NEXT SENTENCE
  8127            ELSE
  8128              MOVE ER-2626       TO WS-ERROR
  8129              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8130              GO TO 0298-UNLOCK-RETURN.
  8131
  8132     IF NOT PB-CANCELLATION
  8133        GO TO 0300-CONTINUE-EDIT.
  8134
  8135     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8136     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8137     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8138     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8139     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8140     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8141
  8142     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8143     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8144     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8145     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8146     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8147     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 150
* EL050.cbl
  8148     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8149     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8150     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8151
  8152     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8153     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8154     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8155     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8156     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8157     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8158     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8159
  8160     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8161     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8162
  8163     MOVE CM-CREDIT-INTERFACE-SW-1
  8164                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8165     MOVE CM-CREDIT-INTERFACE-SW-2
  8166                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8167
  8168     IF CM-O-B-COVERAGE
  8169         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8170
  8171     IF CM-LIVES NOT NUMERIC
  8172         MOVE ZERO                TO CM-LIVES.
  8173
  8174     IF CM-BILLED NOT NUMERIC
  8175         MOVE ZERO                TO CM-BILLED.
  8176
  8177     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8178         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8179         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8180         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8181         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8182         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8183         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8184         MOVE CM-LIVES             TO PB-CI-LIVES
  8185*The next line causes a problem with my change  I dont think it is
  8186*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8187
  8188     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8189     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8190     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8191     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8192     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8193     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8194
  8195     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8196     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8197     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8198     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8199
  8200     IF CM-LIFE-COMM-PCT NUMERIC
  8201         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8202     ELSE
  8203         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8204
  8205     IF CM-AH-COMM-PCT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 151
* EL050.cbl
  8206         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8207     ELSE
  8208         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8209
  8210     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8211
  8212     IF CM-LOAN-APR       NOT NUMERIC
  8213           MOVE ZERO               TO CM-LOAN-APR.
  8214
  8215     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8216           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8217
  8218     IF CM-LOAN-TERM      NOT NUMERIC
  8219           MOVE ZERO               TO CM-LOAN-TERM.
  8220
  8221     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8222           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8223
  8224     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8225           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8226
  8227     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8228     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8229     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8230     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8231     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8232     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8233     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8234     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8235     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8236     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8237     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8238     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8239
  8240     IF CM-STATE = CM-SSN-STATE
  8241         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8242
  8243     IF CM-STATE NOT = CM-MEMB-STATE
  8244         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8245
  8246     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8247
  8248     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8249        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8250        IF CM-ADDL-CLP NOT NUMERIC
  8251           MOVE +0               TO CM-ADDL-CLP
  8252        END-IF
  8253        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8254        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8255           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8256        END-IF
  8257     END-IF
  8258     IF PB-COMPANY-ID = 'DCC'
  8259        MOVE +0                  TO WS-ADMIN-FEES
  8260                                    WS-CSO-ADMIN-FEE
  8261                                    WS-COMM-AND-MFEE
  8262                                    WS-1ST-YR-ALLOW
  8263        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 152
* EL050.cbl
  8264           (SUB5 > +10)
  8265           MOVE +0 TO WS-WK-RATE
  8266           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8267              IF (AM-A-COM (SUB5) NUMERIC)
  8268                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8269                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8270              ELSE
  8271                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8272                 IF PB-ISSUE
  8273                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8274                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8275                 ELSE
  8276                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8277                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8278                 END-IF
  8279                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8280                 MOVE ZEROS             TO WS-SUB1
  8281                                           WS-COMMISSION
  8282                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8283                 MOVE '0530'               TO CTBL-SW
  8284                 MOVE ' '                  TO WS-CTBL-READ-SW
  8285                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8286                 IF FIRST-TIME-THROUGH
  8287                    MOVE 'AA'              TO CTBL-BEN-CODE
  8288                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8289                 END-IF
  8290                 IF CTBL-TABLE-FOUND
  8291                    IF PB-ISSUE
  8292                       COMPUTE WS-COMM-CK-AMT =
  8293                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8294                    ELSE
  8295                       COMPUTE WS-COMM-CK-AMT =
  8296                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8297                    END-IF
  8298                    PERFORM 8800-GET-COMP-RATE
  8299                              THRU 8800-EXIT
  8300                 END-IF
  8301              END-IF
  8302              IF AM-COM-TYP (SUB5) = 'I'
  8303                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8304                   + (WS-WK-RATE * 1000)
  8305              END-IF
  8306              IF AM-COM-TYP (SUB5) = 'N'
  8307                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8308                   + (WS-WK-RATE * 1000)
  8309              END-IF
  8310              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8311                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8312                   + (WS-WK-RATE * 1000)
  8313              END-IF
  8314              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8315                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8316                   + (WS-WK-RATE * 1000)
  8317              END-IF
  8318           END-IF
  8319        END-PERFORM
  8320     END-IF
  8321     GO TO 0300-CONTINUE-EDIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 153
* EL050.cbl
  8322
  8323 0298-UNLOCK-RETURN.
  8324      PERFORM 9250-UNLOCK-RETURN
  8325      GO TO 9990-RETURN.
  8326
  8327 0299-CERT-NOT-FOUND.
  8328
  8329     MOVE '1'                     TO CERT-STATUS-SW.
  8330
  8331     IF PB-COMPANY-ID = 'UCL'
  8332         IF WS-ERROR = ER-2799
  8333             GO TO 3000-CONTINUE-EDIT.
  8334
  8335     IF NOT PB-CANCELLATION
  8336         GO TO 0300-CONTINUE-EDIT.
  8337
  8338     MOVE ER-2726                  TO  WS-ERROR.
  8339     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8340     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8341     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8342                                    PB-CI-LF-TERM
  8343                                    PB-C-LF-REM-TERM
  8344                                    PB-CI-AH-TERM
  8345                                    PB-C-AH-REM-TERM
  8346                                    PB-CI-LF-BENEFIT-CD
  8347                                    PB-CI-LF-BENEFIT-AMT
  8348                                    PB-CI-LF-ALT-BENEFIT-AMT
  8349                                    PB-CI-LF-PREMIUM-AMT
  8350                                    PB-CI-LF-ALT-PREMIUM-AMT
  8351                                    PB-CI-AH-BENEFIT-CD
  8352                                    PB-CI-AH-BENEFIT-AMT
  8353                                    PB-CI-AH-PREMIUM-AMT
  8354                                    PB-CI-PAY-FREQUENCY
  8355                                    PB-CI-LOAN-APR
  8356                                    PB-CI-LOAN-TERM
  8357                                    PB-CI-LIFE-COMMISSION
  8358                                    PB-CI-AH-COMMISSION
  8359                                    PB-CI-CURR-SEQ
  8360                                    PB-CI-AH-CANCEL-AMT
  8361                                    PB-CI-LF-CANCEL-AMT
  8362                                    PB-CI-RATE-DEV-PCT-LF
  8363                                    PB-CI-RATE-DEV-PCT-AH
  8364                                    PB-CI-EXTENTION-DAYS
  8365                                    PB-CI-TERM-IN-DAYS
  8366                                    PB-CI-LIVES
  8367                                    PB-CI-LF-CRIT-PER
  8368                                    PB-CI-AH-CRIT-PER
  8369                                    PB-CI-ADDL-CLP
  8370                                    PB-CI-DDF-IU-RATE-UP.
  8371
  8372     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8373                                    PB-CI-AH-SETTLEMENT-DT
  8374                                    PB-CI-DEATH-DT
  8375                                    PB-CI-LF-PRIOR-CANCEL-DT
  8376                                    PB-CI-AH-PRIOR-CANCEL-DT
  8377                                    PB-CI-ENTRY-DT
  8378                                    PB-CI-LF-EXPIRE-DT
  8379                                    PB-CI-AH-EXPIRE-DT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 154
* EL050.cbl
  8380                                    PB-CI-LOAN-1ST-PMT-DT.
  8381
  8382     IF ACCOUNT-MAST-FOUND
  8383        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8384        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8385
  8386
  8387 0300-CONTINUE-EDIT.
  8388
  8389     IF PB-ISSUE
  8390        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8391            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8392
  8393     IF PB-ISSUE
  8394        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8395            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8396
  8397     IF PB-ISSUE
  8398       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8399          (AM-NO-AH-ONLY)
  8400           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8401               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8402                   MOVE ER-2679 TO WS-ERROR
  8403                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8404
  8405     IF PB-ISSUE
  8406        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8407        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8408        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8409     ELSE
  8410        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8411        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8412        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8413
  8414     MOVE 'N'                    TO PLAN-MASTER-SW
  8415                                    PLAN-MASTER-LIFE-SW
  8416                                    FORM-MASTER-SW
  8417                                    WS-APP-CERT-SW.
  8418
  8419     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8420                                    WS-PL-TOL-LF-REFUND
  8421                                    WS-PL-REF-OVS-AMT
  8422                                    WS-PL-TOL-LF-PREM-PCT
  8423                                    WS-PL-TOL-LF-REFUND-PCT
  8424                                    WS-PL-REF-OVS-PCT
  8425                                    WS-PL-TOL-LF-CLAIM.
  8426
  8427     IF PB-COMPANY-ID = 'NCL'
  8428       IF PB-ISSUE
  8429         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8430             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8431             IF FORM-MASTER-FOUND
  8432                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8433
  8434     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8435        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8436
  8437********************** MON CODE **********************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 155
* EL050.cbl
  8438     IF PB-COMPANY-ID = 'MON'
  8439     IF PB-ISSUE
  8440     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8441        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8442             PB-I-LOAN-APR = ZERO)
  8443               MOVE 14.0         TO PB-I-LOAN-APR.
  8444******************************************************
  8445
  8446     IF PB-COMPANY-ID = 'NCL'
  8447       IF PB-ISSUE
  8448           IF FORM-MASTER-FOUND
  8449             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8450                AM-DISMBR-COVERAGE
  8451                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8452                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8453                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8454                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8455                                           PB-I-LIFE-BENEFIT-CD.
  8456
  8457     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8458
  8459     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8460         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8461         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8462         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8463         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8464         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8465           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8466             GO TO 0301-LIFE-BENEFIT-SEARCH
  8467         ELSE
  8468             NEXT SENTENCE
  8469     ELSE
  8470         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8471
  8472     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8473     MOVE '4'                    TO CNTL-REC-TYPE.
  8474     MOVE +0                     TO CNTL-SEQ-NO.
  8475     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8476
  8477     MOVE '1' TO RC-SW-2.
  8478     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8479
  8480     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8481        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8482         GO TO 0305-BENEFIT-NOT-FOUND.
  8483
  8484     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8485
  8486 0301-LIFE-BENEFIT-SEARCH.
  8487
  8488     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8489
  8490     IF NO-BENEFIT-FOUND
  8491        GO TO 0305-BENEFIT-NOT-FOUND.
  8492
  8493     IF WS-BEN-CD = '99'
  8494        GO TO 0305-BENEFIT-NOT-FOUND.
  8495
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 156
* EL050.cbl
  8496     IF PB-COMPANY-ID = 'NCL'
  8497         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8498             GO TO 0304-LIFE-BENEFIT-FOUND.
  8499
  8500     MOVE +1                     TO SUB5.
  8501     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8502
  8503* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8504* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8505     IF PB-COMPANY-ID = 'DMD'
  8506         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8507
  8508 0302-EDIT-ACCT-LF-BENEFITS.
  8509
  8510     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8511        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8512           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8513                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8514           GO TO 03XX-GET-LIFE-ERPLAN.
  8515
  8516     IF SUB5 LESS THAN +20
  8517        ADD +1                   TO SUB5
  8518        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8519
  8520     MOVE +1                     TO SUB5.
  8521
  8522     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8523        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8524
  8525 0303-EDIT-DMD-EXTRA-BENEFITS.
  8526
  8527     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8528        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8529           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8530                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8531           GO TO 03XX-GET-LIFE-ERPLAN.
  8532
  8533     IF SUB5 LESS THAN +30
  8534        ADD +1                   TO SUB5
  8535        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8536
  8537     MOVE +1                     TO SUB5.
  8538
  8539 03XX-EDIT-FOR-NINETY-LF.
  8540
  8541***************************************************************
  8542*                                                             *
  8543*    NINETY BENEFIT PLAN TYPES:                               *
  8544*                                                             *
  8545*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8546*      92 = ALL GROUP REDUCING BENEFITS                       *
  8547*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8548*      94 = ALL GROUP LEVEL BENEFITS                          *
  8549*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8550*           BENEFIT CONTROLS.                                 *
  8551*      99 = ALL BENEFITS                                      *
  8552*                                                             *
  8553***************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 157
* EL050.cbl
  8554
  8555     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8556                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8557
  8558     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8559       AND
  8560        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8561        GO TO 03XX-GET-LIFE-ERPLAN.
  8562
  8563     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8564       AND
  8565        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8566        IF CF-REDUCING (SUB3)
  8567           IF (PB-I-INDV-GRP-OVRD = 'I')
  8568              OR
  8569           ((AM-IG = '1') AND
  8570           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8571              OR
  8572           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8573           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8574           (AM-IG NOT = '2'))
  8575              GO TO 03XX-GET-LIFE-ERPLAN.
  8576
  8577     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8578       AND
  8579        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8580        IF CF-REDUCING (SUB3)
  8581           IF (PB-I-INDV-GRP-OVRD = 'G')
  8582              OR
  8583           ((AM-IG = '2') AND
  8584           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8585              OR
  8586           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8587           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8588           (AM-IG NOT = '1'))
  8589              GO TO 03XX-GET-LIFE-ERPLAN.
  8590
  8591     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8592       AND
  8593        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8594        IF CF-LEVEL    (SUB3)
  8595           IF (PB-I-INDV-GRP-OVRD = 'I')
  8596              OR
  8597           ((AM-IG = '1') AND
  8598           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8599              OR
  8600           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8601           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8602            (AM-IG NOT = '2'))
  8603              GO TO 03XX-GET-LIFE-ERPLAN.
  8604
  8605     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8606       AND
  8607        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8608        IF CF-LEVEL    (SUB3)
  8609           IF (PB-I-INDV-GRP-OVRD = 'G')
  8610              OR
  8611           ((AM-IG = '2') AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 158
* EL050.cbl
  8612           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8613              OR
  8614           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8615           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8616           (AM-IG NOT = '1'))
  8617              GO TO 03XX-GET-LIFE-ERPLAN.
  8618
  8619     IF SUB5 LESS THAN +20
  8620        ADD +1                   TO SUB5
  8621        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8622
  8623     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8624
  8625     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8626        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8627
  8628     MOVE +1                     TO SUB5.
  8629
  8630 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8631
  8632     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8633                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8634
  8635     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8636       AND
  8637        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8638        GO TO 03XX-GET-LIFE-ERPLAN.
  8639
  8640     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8641       AND
  8642        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8643        IF CF-REDUCING (SUB3)
  8644           IF (PB-I-INDV-GRP-OVRD = 'I')
  8645              OR
  8646           ((AM-IG = '1') AND
  8647           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8648              OR
  8649           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8650           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8651           (AM-IG NOT = '2'))
  8652              GO TO 03XX-GET-LIFE-ERPLAN.
  8653
  8654     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8655       AND
  8656        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8657        IF CF-REDUCING (SUB3)
  8658           IF (PB-I-INDV-GRP-OVRD = 'G')
  8659              OR
  8660           ((AM-IG = '2') AND
  8661           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8662              OR
  8663           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8664           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8665           (AM-IG NOT = '1'))
  8666              GO TO 03XX-GET-LIFE-ERPLAN.
  8667
  8668     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8669       AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 159
* EL050.cbl
  8670        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8671        IF CF-LEVEL    (SUB3)
  8672           IF (PB-I-INDV-GRP-OVRD = 'I')
  8673              OR
  8674           ((AM-IG = '1') AND
  8675           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8676              OR
  8677           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8678           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8679            (AM-IG NOT = '2'))
  8680              GO TO 03XX-GET-LIFE-ERPLAN.
  8681
  8682     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8683       AND
  8684        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8685        IF CF-LEVEL    (SUB3)
  8686           IF (PB-I-INDV-GRP-OVRD = 'G')
  8687              OR
  8688           ((AM-IG = '2') AND
  8689           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8690              OR
  8691           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8692           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8693           (AM-IG NOT = '1'))
  8694              GO TO 03XX-GET-LIFE-ERPLAN.
  8695
  8696     IF SUB5 LESS THAN +30
  8697        ADD +1                   TO SUB5
  8698        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8699
  8700     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8701
  8702 03XX-EDIT-FOR-NINETY-LF-CONT.
  8703
  8704     MOVE +99                    TO SUB5.
  8705
  8706     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8707        IF PB-ISSUE
  8708           MOVE ER-1924          TO  WS-ERROR
  8709           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8710
  8711     GO TO 0304-LIFE-BENEFIT-FOUND.
  8712
  8713 03XX-GET-LIFE-ERPLAN.
  8714
  8715     IF WK-PLAN-ADDR EQUAL +0
  8716        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8717
  8718     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8719     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8720     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8721     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8722     MOVE 'Y'                    TO PLAN-MASTER-SW
  8723                                    PLAN-MASTER-LIFE-SW.
  8724     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8725
  8726 03XX-ERPLAN-LIFE-GETMAIN.
  8727
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 160
* EL050.cbl
  8728     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8729     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8730
  8731 03XX-ERPLAN-LIFE-READ.
  8732
  8733     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8734     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8735     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8736     MOVE PB-SV-STATE            TO PLAN-STATE.
  8737     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8738     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8739     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8740     MOVE WS-SAVE-BENEFIT-REVISION
  8741                                 TO PLAN-REVISION-NO.
  8742
  8743     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8744     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8745
  8746     IF PB-COMPANY-ID = 'NCL'
  8747       IF NOT LF-PLAN-MASTER-FOUND
  8748         IF NOT PB-POLICY-IS-DECLINED  AND
  8749            NOT PB-POLICY-IS-VOIDED
  8750             MOVE  ER-1921         TO  WS-ERROR
  8751             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8752             GO TO 0304-LIFE-BENEFIT-FOUND.
  8753
  8754     IF NOT LF-PLAN-MASTER-FOUND
  8755        GO TO 0304-LIFE-BENEFIT-FOUND.
  8756
  8757 XXXX-CHECK-LF-PLAN-KEY.
  8758
  8759     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8760        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8761        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8762        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8763        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8764        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8765        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8766        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8767        MOVE 'N'                 TO PLAN-MASTER-SW
  8768          GO TO 03XX-ERPLAN-LIFE-READ.
  8769
  8770     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8771
  8772     IF  PB-CANCELLATION
  8773         GO TO  0303-LF-ACCT-BEN-FOUND.
  8774
  8775     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8776        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8777           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8778           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8779              MOVE ER-2644             TO WS-ERROR
  8780              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8781           ELSE
  8782              NEXT SENTENCE
  8783        ELSE
  8784           IF PB-COMPANY-ID NOT = 'NCL'
  8785              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 161
* EL050.cbl
  8786                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8787
  8788 0303-LF-ACCT-BEN-FOUND.
  8789
  8790     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8791
  8792     IF PL-DEV-CODE NOT = SPACES
  8793        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8794
  8795     IF PL-DEV-PCT NUMERIC AND
  8796        PL-DEV-PCT NOT = ZEROS
  8797        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8798
  8799     IF PL-TOL-PREM-AMT GREATER THAN +0
  8800        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8801
  8802     IF PL-TOL-REF-AMT GREATER THAN +0
  8803        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8804
  8805     IF PL-TOL-PREM-PCT GREATER THAN +0
  8806        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8807
  8808     IF PL-TOL-REF-PCT GREATER THAN +0
  8809        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8810
  8811     IF PL-TOL-CLM-AMT GREATER THAN +0
  8812        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8813
  8814     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8815                          PL-OVER-SHORT-AMT > +0
  8816        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8817
  8818     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8819                          PL-OVER-SHORT-PCT > +0
  8820        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8821
  8822     IF PL-SALES-TAX NUMERIC AND
  8823                          PL-SALES-TAX > +0
  8824         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8825
  8826     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8827        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8828                                    WS-IG-OVRD-AM.
  8829
  8830 0304-LIFE-BENEFIT-FOUND.
  8831
  8832     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8833
  8834     IF PB-ISSUE
  8835        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8836     ELSE
  8837        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8838
  8839     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8840     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8841     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8842     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8843     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 162
* EL050.cbl
  8844                                         WS-LF-REFUND-CALC.
  8845     if (ws-lf-earnings-calc = '5')
  8846        and (pb-i-loan-apr = zeros)
  8847        and (benefit-code-chg)
  8848        move +99.9999 to pb-i-loan-apr
  8849     end-if
  8850
  8851     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8852        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8853
  8854     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8855        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8856     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8857
  8858     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8859     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8860     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8861     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8862     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8863     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8864
  8865     IF PB-COMPANY-ID = 'NCL'  AND
  8866        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8867         NEXT SENTENCE
  8868     ELSE
  8869         IF SUB5 NOT GREATER THAN +20
  8870            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8871               MOVE WS-SAVE-BENEFIT-REM-TERM
  8872                                      TO WS-AM-LF-BENE-REM-TERM
  8873                                         EC-BR-LF-REM-TERM-CALC.
  8874
  8875     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8876     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8877
  8878     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8879
  8880 0305-BENEFIT-NOT-FOUND.
  8881
  8882     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8883     MOVE ER-2604                TO WS-ERROR.
  8884     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8885
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 163
* EL050.cbl
  8887
  8888 0310-FIND-AH-BENEFIT-RECORD.
  8889
  8890     MOVE 'N'                    TO PLAN-MASTER-SW
  8891                                    PLAN-MASTER-AH-SW.
  8892
  8893     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8894                                    WS-PL-TOL-AH-REFUND
  8895                                    WS-AH-PL-REF-OVS-AMT
  8896                                    WS-PL-TOL-AH-PREM-PCT
  8897                                    WS-PL-TOL-AH-REFUND-PCT
  8898                                    WS-AH-PL-REF-OVS-PCT
  8899                                    WS-PL-TOL-AH-CLAIM.
  8900     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8901
  8902
  8903     if pb-issue
  8904        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8905           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8906        end-if
  8907        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8908           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8909           GO TO 0399-BENEFIT-NOT-FOUND
  8910        end-if
  8911     end-if
  8912
  8913     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8914        GO TO 0400-FIND-CARRIER.
  8915
  8916     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8917
  8918     IF WK-AH-BEN-ADDR NOT = ZEROS
  8919         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  8920         SET ELCNTL-FILE-ADDRESSED TO TRUE
  8921         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8922         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8923           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8924             GO TO 0311-AH-BENEFIT-SEARCH
  8925         ELSE
  8926             NEXT SENTENCE
  8927     ELSE
  8928         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8929
  8930     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8931     MOVE '5'                    TO CNTL-REC-TYPE.
  8932     MOVE +0                     TO CNTL-SEQ-NO.
  8933     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8934
  8935     MOVE '2' TO RC-SW-2.
  8936     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8937
  8938     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8939        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8940          GO TO 0399-BENEFIT-NOT-FOUND.
  8941
  8942     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  8943
  8944 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 164
* EL050.cbl
  8945
  8946     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8947
  8948     IF NO-BENEFIT-FOUND
  8949         GO TO 0399-BENEFIT-NOT-FOUND.
  8950
  8951     IF WS-BEN-CD = '99'
  8952        GO TO 0399-BENEFIT-NOT-FOUND.
  8953
  8954     IF PB-COMPANY-ID  =  'NCL'
  8955         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8956             GO TO 0314-A-H-BENEFIT-FOUND.
  8957
  8958     MOVE +1                     TO SUB5.
  8959     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8960
  8961* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8962* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8963     IF PB-COMPANY-ID = 'DMD'
  8964         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8965
  8966 0312-EDIT-ACCT-AH-BENEFITS.
  8967
  8968     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8969        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  8970           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8971                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8972           GO TO 03XX-GET-AH-ERPLAN.
  8973
  8974     IF SUB5 LESS THAN +20
  8975        ADD +1                   TO SUB5
  8976        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  8977
  8978     MOVE +1                     TO SUB5.
  8979
  8980     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8981        GO TO 03XX-EDIT-FOR-NINETY-AH.
  8982
  8983 0313-EDIT-DMD-EXTRA-BENEFITS.
  8984
  8985     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  8986        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  8987           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8988                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8989           GO TO 03XX-GET-AH-ERPLAN.
  8990
  8991     IF SUB5 LESS THAN +30
  8992        ADD +1                   TO SUB5
  8993        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  8994
  8995     MOVE +1                     TO SUB5.
  8996
  8997 03XX-EDIT-FOR-NINETY-AH.
  8998
  8999***************************************************************
  9000*                                                             *
  9001*    NINETY BENEFIT PLAN TYPES:                               *
  9002*                                                             *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 165
* EL050.cbl
  9003*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9004*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9005*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9006*           BENEFIT CONTROLS.                                 *
  9007*      99 = ALL BENEFITS.                                     *
  9008*                                                             *
  9009***************************************************************
  9010
  9011     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9012                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9013
  9014     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9015       AND
  9016        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9017        GO TO 03XX-GET-AH-ERPLAN.
  9018
  9019     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9020       AND
  9021        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9022           IF (PB-I-INDV-GRP-OVRD = 'I')
  9023              OR
  9024           ((AM-IG = '1') AND
  9025           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9026              OR
  9027           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9028           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9029           (AM-IG NOT = '2'))
  9030              GO TO 03XX-GET-AH-ERPLAN.
  9031
  9032     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9033       AND
  9034        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9035           IF (PB-I-INDV-GRP-OVRD = 'G')
  9036              OR
  9037           ((AM-IG = '2') AND
  9038           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9039              OR
  9040           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9041           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9042           (AM-IG NOT = '1'))
  9043              GO TO 03XX-GET-AH-ERPLAN.
  9044
  9045     IF SUB5 LESS THAN +20
  9046        ADD +1                   TO SUB5
  9047        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9048
  9049     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9050        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9051
  9052     MOVE +1                    TO SUB5.
  9053
  9054 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9055
  9056     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9057                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9058
  9059     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9060       AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 166
* EL050.cbl
  9061        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9062        GO TO 03XX-GET-AH-ERPLAN.
  9063
  9064     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9065       AND
  9066        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9067           IF (PB-I-INDV-GRP-OVRD = 'I')
  9068              OR
  9069           ((AM-IG = '1') AND
  9070           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9071              OR
  9072           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9073           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9074           (AM-IG NOT = '2'))
  9075              GO TO 03XX-GET-AH-ERPLAN.
  9076
  9077     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9078       AND
  9079        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9080           IF (PB-I-INDV-GRP-OVRD = 'G')
  9081              OR
  9082           ((AM-IG = '2') AND
  9083           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9084              OR
  9085           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9086           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9087           (AM-IG NOT = '1'))
  9088              GO TO 03XX-GET-AH-ERPLAN.
  9089
  9090     IF SUB5 LESS THAN +30
  9091        ADD +1                   TO SUB5
  9092        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9093
  9094 03XX-EDIT-FOR-NINETY-AH-CONT.
  9095
  9096     MOVE +99                    TO SUB5.
  9097
  9098     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9099
  9100     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9101        IF PB-ISSUE
  9102           MOVE ER-1925          TO  WS-ERROR
  9103           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9104
  9105     GO TO 0314-A-H-BENEFIT-FOUND.
  9106
  9107 03XX-GET-AH-ERPLAN.
  9108
  9109     IF WK-PLAN-ADDR EQUAL +0
  9110         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9111
  9112     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9113     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9114     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9115     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9116     MOVE 'Y'                    TO PLAN-MASTER-SW
  9117                                    PLAN-MASTER-AH-SW.
  9118*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 167
* EL050.cbl
  9119     GO TO 03XX-ERPLAN-AH-READ.
  9120
  9121 03XX-ERPLAN-AH-GETMAIN.
  9122
  9123     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9124     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9125
  9126 03XX-ERPLAN-AH-READ.
  9127
  9128     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9129     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9130     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9131     MOVE PB-SV-STATE            TO PLAN-STATE.
  9132     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9133     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9134     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9135     MOVE WS-SAVE-BENEFIT-REVISION
  9136                                 TO PLAN-REVISION-NO.
  9137
  9138     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9139     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9140
  9141     IF PB-COMPANY-ID = 'NCL'
  9142       IF NOT AH-PLAN-MASTER-FOUND
  9143         IF NOT PB-POLICY-IS-DECLINED  AND
  9144            NOT PB-POLICY-IS-VOIDED
  9145             MOVE  ER-1922         TO  WS-ERROR
  9146             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9147             GO TO 0314-A-H-BENEFIT-FOUND.
  9148
  9149     IF NOT AH-PLAN-MASTER-FOUND
  9150        GO TO 0314-A-H-BENEFIT-FOUND.
  9151
  9152 XXXX-CHECK-AH-PLAN-KEY.
  9153
  9154     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9155        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9156        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9157        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9158        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9159        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9160        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9161        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9162        MOVE 'N'                 TO PLAN-MASTER-SW
  9163          GO TO 03XX-ERPLAN-AH-READ.
  9164
  9165     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9166
  9167     IF  PB-CANCELLATION
  9168         GO TO  0313-AH-ACCT-BEN-FOUND.
  9169
  9170     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9171       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9172          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9173          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9174             MOVE ER-2644             TO WS-ERROR
  9175             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9176          ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 168
* EL050.cbl
  9177             NEXT SENTENCE
  9178       ELSE
  9179          IF PB-COMPANY-ID NOT = 'NCL'
  9180             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9181                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9182
  9183 0313-AH-ACCT-BEN-FOUND.
  9184
  9185     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9186
  9187     IF PL-DEV-CODE NOT = SPACES
  9188        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9189
  9190     IF PL-DEV-PCT NUMERIC AND
  9191        PL-DEV-PCT NOT = ZEROS
  9192        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9193
  9194     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9195        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9196
  9197     IF PL-TOL-REF-AMT NOT EQUAL +0
  9198        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9199
  9200     IF PL-TOL-PREM-PCT GREATER THAN +0
  9201        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9202
  9203     IF PL-TOL-REF-PCT GREATER THAN +0
  9204        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9205
  9206     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9207        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9208
  9209     IF PL-OVER-SHORT-AMT NUMERIC AND
  9210                          PL-OVER-SHORT-AMT > +0
  9211        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9212
  9213     IF PL-OVER-SHORT-PCT NUMERIC AND
  9214                          PL-OVER-SHORT-PCT > +0
  9215        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9216
  9217     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9218        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9219        IF WS-IG-OVRD-AM EQUAL SPACES
  9220            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9221
  9222 0314-A-H-BENEFIT-FOUND.
  9223
  9224     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9225
  9226     IF PB-ISSUE
  9227        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9228       ELSE
  9229        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9230
  9231     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD.
  9232     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9233     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9234     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 169
* EL050.cbl
  9235                                         WS-AH-REFUND-CALC.
  9236
  9237     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9238        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9239
  9240     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9241        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9242     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9243
  9244     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9245     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9246     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9247     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9248     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9249     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9250
  9251     IF PB-COMPANY-ID = 'NCL'  AND
  9252        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9253         NEXT SENTENCE
  9254     ELSE
  9255         IF SUB5 NOT GREATER THAN +20
  9256            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9257                MOVE WS-SAVE-BENEFIT-REM-TERM
  9258                                      TO WS-AM-AH-BENE-REM-TERM
  9259                                         EC-BR-AH-REM-TERM-CALC.
  9260
  9261     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9262     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9263
  9264     GO TO 0400-FIND-CARRIER.
  9265
  9266 0399-BENEFIT-NOT-FOUND.
  9267
  9268     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9269     MOVE ER-2605                TO WS-ERROR.
  9270     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9271
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 170
* EL050.cbl
  9273
  9274 0400-FIND-CARRIER.
  9275
  9276     MOVE PB-SV-CARRIER          TO WS-CARR.
  9277
  9278     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9279     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9280     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9281     MOVE '6'                    TO CNTL-REC-TYPE.
  9282
  9283*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9284     MOVE SPACE                  TO WS-DMD-RATING-SW
  9285                                    EC-BR-DMD-RATING-SW.
  9286
  9287     MOVE '2'                    TO RC-SW-1.
  9288     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9289
  9290     IF NOT CF-CARRIER-MASTER
  9291        GO TO 0400-CARRIER-NOT-FOUND.
  9292
  9293 0400-BUILD-CARR-TOL.
  9294
  9295     IF CF-CR-TOL-PREM NUMERIC AND
  9296        CF-CR-TOL-PREM GREATER THAN +0
  9297        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9298                                    WS-TOL-AH-PREM.
  9299
  9300     IF CF-CR-TOL-REFUND NUMERIC AND
  9301        CF-CR-TOL-REFUND GREATER THAN +0
  9302        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9303                                    WS-TOL-AH-REFUND.
  9304
  9305     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9306        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9307        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9308                                    WS-AH-REFUND-OVS-AMT.
  9309
  9310     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9311        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9312        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9313                                    WS-AH-REFUND-OVS-PCT.
  9314
  9315     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9316        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9317        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9318                                    WS-TOL-AH-PREM-PCT.
  9319
  9320     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9321        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9322        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9323                                     WS-TOL-AH-REFUND-PCT.
  9324
  9325     IF CF-COMPANY-ID EQUAL 'DMD'
  9326         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9327                                    EC-BR-DMD-RATING-SW.
  9328
  9329     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9330     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 171
* EL050.cbl
  9331        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9332     END-IF
  9333     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9334        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9335     END-IF
  9336     IF WS-TOL-CLP-PCT = ZEROS
  9337        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9338     END-IF
  9339
  9340     IF WS-SPP-LEASE-COMM = ZEROS
  9341        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9342     END-IF
  9343     GO TO 0400-FIND-ERPDEF.
  9344
  9345 0400-CARRIER-NOT-FOUND.
  9346
  9347     MOVE ER-2602                TO WS-ERROR.
  9348     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9349
  9350 0400-FIND-ERPDEF.
  9351     IF PB-COMPANY-ID = 'DCC'
  9352        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9353        CONTINUE
  9354     ELSE
  9355        GO TO 0400-FIND-ERCOMP
  9356     END-IF
  9357     MOVE ' '                    TO PDEF-MASTER-SW
  9358     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9359     MOVE PB-STATE               TO ERPDEF-STATE
  9360     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9361     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9362     IF PB-ISSUE
  9363        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9364     ELSE
  9365        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9366     END-IF
  9367     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9368     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9369     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9370     IF PDEF-MASTER-FOUND
  9371        MOVE 'N'                 TO PDEF-MASTER-SW
  9372        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9373        IF PDEF-MASTER-FOUND
  9374           IF (ERPDEF-KEY-SAVE (1:16) =
  9375                        PD-CONTROL-PRIMARY (1:16))
  9376              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9377              CONTINUE
  9378           ELSE
  9379              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9380              IF (ERPDEF-KEY-SAVE (1:16) =
  9381                        PD-CONTROL-PRIMARY (1:16))
  9382                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9383                 CONTINUE
  9384              ELSE
  9385                 MOVE 'N'        TO PDEF-MASTER-SW
  9386              END-IF
  9387           END-IF
  9388        END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 172
* EL050.cbl
  9389        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9390     END-IF
  9391     IF PDEF-MASTER-FOUND
  9392        IF PD-TRUNCATED = 'Y'
  9393           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9394        END-IF
  9395     END-IF
  9396     .
  9397 0400-FIND-ERCOMP.
  9398     IF PB-COMPANY-ID = 'DCC'
  9399        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9400           (WS-SUB1 > +10)
  9401           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9402                 OR 'A' OR 'N'
  9403              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9404              MOVE PB-CARRIER    TO COMP-CARRIER
  9405              MOVE PB-GROUPING   TO COMP-GROUPING
  9406              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9407              MOVE AM-AGT (WS-SUB1)
  9408                                 TO COMP-FIN-RESP
  9409              MOVE 'G'           TO COMP-TYPE
  9410              PERFORM 8582-READ-COMPENSATION-MASTER
  9411                                 THRU 8582-EXIT
  9412              IF COMP-MASTER-FOUND
  9413                 IF CO-GA-INACTIVE
  9414                    MOVE ER-2763 TO WS-ERROR
  9415                    PERFORM 9900-ERROR-FORMAT
  9416                                 THRU 9900-EXIT
  9417                    MOVE +11     TO WS-SUB1
  9418                 END-IF
  9419                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9420                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9421                    MOVE ER-2788 TO WS-ERROR
  9422                    PERFORM 9900-ERROR-FORMAT
  9423                                 THRU 9900-EXIT
  9424                    MOVE +11     TO WS-SUB1
  9425                 END-IF
  9426              END-IF
  9427           END-IF
  9428        END-PERFORM
  9429     END-IF
  9430     IF PB-COMPANY-ID = 'DCC'
  9431        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9432           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9433                                    WS-CLP-STATE
  9434        ELSE
  9435           MOVE SPACES           TO PB-I-CLP-STATE
  9436                                    WS-CLP-STATE
  9437        END-IF
  9438     END-IF
  9439
  9440     IF (PB-COMPANY-ID = 'DCC')
  9441        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9442        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9443        CONTINUE
  9444     ELSE
  9445        GO TO 0400-FIND-STATE-RECORD
  9446     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 173
* EL050.cbl
  9447     MOVE SPACES                 TO WS-CLP-STATE
  9448     MOVE +0                     TO WS-BANK-FEE
  9449                                    WS-BANK-LFEE
  9450                                    WS-BANK-NOCHRGB
  9451
  9452     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9453     IF (PB-ISSUE)
  9454        AND (PB-I-BANK-NUMBER NOT =
  9455            SPACES AND ZEROS AND LOW-VALUES)
  9456        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9457     ELSE
  9458        IF (PB-CANCELLATION)
  9459           AND (PB-CI-BANK-NUMBER NOT =
  9460                SPACES AND ZEROS AND LOW-VALUES)
  9461           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9462        END-IF
  9463     END-IF
  9464     IF COMP-FIN-RESP NOT = LOW-VALUES
  9465        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9466        MOVE PB-CARRIER          TO COMP-CARRIER
  9467        MOVE PB-GROUPING         TO COMP-GROUPING
  9468        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9469        MOVE 'B'                 TO COMP-TYPE
  9470        PERFORM 8582-READ-COMPENSATION-MASTER
  9471                                 THRU 8582-EXIT
  9472        IF COMP-MASTER-FOUND
  9473           IF CO-MAX-BANK-FEE NOT NUMERIC
  9474              MOVE +0            TO CO-MAX-BANK-FEE
  9475           END-IF
  9476           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9477              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9478           END-IF
  9479           IF CO-GA-INACTIVE
  9480              MOVE ER-2763       TO WS-ERROR
  9481              PERFORM 9900-ERROR-FORMAT
  9482                                 THRU 9900-EXIT
  9483           END-IF
  9484           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9485              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9486              MOVE ER-2788 TO WS-ERROR
  9487              PERFORM 9900-ERROR-FORMAT
  9488                                 THRU 9900-EXIT
  9489              MOVE +11     TO WS-SUB1
  9490           END-IF
  9491           IF WS-AH-BEN-CATEGORY = 'G'
  9492              MOVE CO-MAX-BANK-FEE
  9493                                 TO WS-BANK-FEE
  9494                                    PB-I-BANK-FEE
  9495           ELSE
  9496              MOVE CO-MAX-BANK-FEE-LEASE
  9497                                 TO WS-BANK-LFEE
  9498                                    PB-I-BANK-FEE
  9499           END-IF
  9500           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9501              AND (WS-AH-REFUND-CALC = 'G'))
  9502                        OR
  9503              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9504              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 174
* EL050.cbl
  9505              CONTINUE
  9506           ELSE
  9507              MOVE ER-2789 TO WS-ERROR
  9508              PERFORM 9900-ERROR-FORMAT
  9509                                 THRU 9900-EXIT
  9510           END-IF
  9511           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9512                                    PB-I-CLP-STATE
  9513           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9514           MOVE CO-CARRIER       TO BXRF-CARRIER
  9515           MOVE CO-GROUPING      TO BXRF-GROUPING
  9516           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9517           MOVE BXRF-MAX-REC-LENGTH
  9518                                 TO BXRF-REC-LENGTH
  9519           PERFORM 8584-READ-BANK-CROSS-REF
  9520                                 THRU 8584-EXIT
  9521           IF BXRF-MASTER-FOUND
  9522              MOVE ' '           TO BANK-ACCT-SW
  9523              MOVE BK-BANK-POINTER-CNT
  9524                                 TO BK-BANK-POINTER-CNT
  9525              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9526                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9527                 OR (BANK-ACCT-FOUND)
  9528                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9529                    AND (BK-AM-EXP-DT (WS-SUB1)
  9530                                 > PB-CERT-EFF-DT)
  9531                    AND (BK-AM-EFF-DT (WS-SUB1)
  9532                                 NOT > PB-CERT-EFF-DT)
  9533                    SET BANK-ACCT-FOUND TO TRUE
  9534                 END-IF
  9535              END-PERFORM
  9536              IF NOT BANK-ACCT-FOUND
  9537                 MOVE ZEROS      TO WS-BANK-FEE
  9538                                    WS-BANK-LFEE
  9539                 MOVE ER-2869    TO WS-ERROR
  9540                 PERFORM 9900-ERROR-FORMAT
  9541                                 THRU 9900-EXIT
  9542              ELSE
  9543                 PERFORM 5000-PROCESS-REPS
  9544                                 THRU 5000-EXIT
  9545                 IF AGENT-MASTER-FOUND
  9546                    MOVE +0      TO WS-BANK-FEE
  9547                                    WS-BANK-LFEE
  9548*                   MOVE AG-SPP-FEES (1)
  9549*                                TO PB-I-BANK-FEE
  9550*                                   WS-BANK-FEE
  9551                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9552                       (WS-SUB1 > +10)
  9553                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9554                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9555                       END-IF
  9556                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9557                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9558                       END-IF
  9559                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9560                          AG-SPP-FEES (WS-SUB1)
  9561                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9562                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 175
* EL050.cbl
  9563                    END-PERFORM
  9564                    IF WS-AH-BEN-CATEGORY = 'G'
  9565                       MOVE WS-BANK-FEE
  9566                                 TO PB-I-BANK-FEE
  9567                    ELSE
  9568                       MOVE WS-BANK-LFEE
  9569                                 TO PB-I-BANK-FEE
  9570                    END-IF
  9571                 END-IF
  9572              END-IF
  9573           END-IF
  9574        ELSE
  9575           MOVE ER-2879          TO WS-ERROR
  9576           PERFORM 9900-ERROR-FORMAT
  9577                                 THRU 9900-EXIT
  9578        END-IF
  9579     ELSE
  9580        MOVE ER-2879             TO WS-ERROR
  9581        PERFORM 9900-ERROR-FORMAT
  9582                                 THRU 9900-EXIT
  9583     END-IF
  9584     IF WS-AH-BEN-CATEGORY = 'G'
  9585        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9586        + WS-BANK-FEE
  9587     ELSE
  9588        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9589        + WS-BANK-LFEE
  9590     END-IF
  9591     .
  9592 0400-FIND-STATE-RECORD.
  9593
  9594     IF WK-STATE-ADDR NOT = ZEROS
  9595         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9596         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9597         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9598         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9599         IF PB-SV-STATE = CF-STATE-CODE
  9600             GO TO 0405-CONTINUE-EDIT
  9601         ELSE
  9602             NEXT SENTENCE
  9603     ELSE
  9604         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9605
  9606     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9607     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9608     MOVE '3'                    TO CNTL-REC-TYPE.
  9609     MOVE +0                     TO CNTL-SEQ-NO.
  9610
  9611     MOVE '3'                    TO RC-SW-2.
  9612     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9613
  9614     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9615        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9616        PB-SV-STATE   NOT = CF-STATE-CODE)
  9617        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9618                                    WS-TOL-AH-CLAIM
  9619                                    WS-MINIMUM-REFUND
  9620                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 176
* EL050.cbl
  9621                                    WS-TOL-AH-PREM
  9622                                    WS-TOL-LF-REFUND
  9623                                    WS-TOL-AH-REFUND
  9624                                    EC-ST-TOL-PREM-PCT
  9625                                    WS-TOL-LF-PREM-PCT
  9626                                    WS-TOL-AH-PREM-PCT
  9627                                    EC-ST-TOL-REFUND-PCT
  9628                                    WS-TOL-LF-REFUND-PCT
  9629                                    WS-TOL-AH-REFUND-PCT
  9630                                    EC-ST-TOL-PREM
  9631                                    EC-ST-TOL-REFUND
  9632                                    EC-ST-FST-PMT-DAYS-MAX
  9633                                    WS-FREE-LOOK-PERIOD
  9634                                    WS-ST-LF-PREM-TAX
  9635                                    WS-ST-AH-PREM-TAX-I
  9636                                    WS-ST-AH-PREM-TAX-G
  9637                                    WS-BANK-FEE
  9638                                    WS-BANK-LFEE
  9639                                    WS-TOL-CLP-PCT
  9640                                    WS-SPP-LEASE-COMM
  9641        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9642                                    EC-ST-FST-PMT-DAYS-CHG
  9643                                    WS-LF-REM-TERM-CALC
  9644                                    WS-LF-REFUND-CALC
  9645                                    EC-ST-LF-REM-TERM-CALC
  9646                                    EC-ST-LF-REFUND-CALC
  9647                                    WS-AH-REM-TERM-CALC
  9648                                    WS-AH-REFUND-CALC
  9649                                    WS-LF-BEN-CATEGORY
  9650                                    WS-AH-BEN-CATEGORY
  9651                                    WS-CLP-STATE
  9652                                    WS-ST-REFUND-CLAIM-FLAG
  9653                                    WS-ST-CAUSAL-STATE
  9654                                    EC-ST-AH-REM-TERM-CALC
  9655                                    EC-ST-AH-REFUND-CALC
  9656          GO TO 0499-STATE-NOT-FOUND.
  9657
  9658     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9659
  9660 0405-CONTINUE-EDIT.
  9661
  9662     if pb-company-id = 'AHL'
  9663        continue
  9664     else
  9665        IF PB-CERT-PRIME NOT NUMERIC
  9666           MOVE ER-2722          TO WS-ERROR
  9667           PERFORM 9900-ERROR-FORMAT
  9668                                 THRU 9900-EXIT
  9669        end-if
  9670     END-IF
  9671*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9672*       MOVE +0                  TO SUB3
  9673*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9674*       IF SUB3 > +0
  9675*          MOVE ER-2722          TO WS-ERROR
  9676*          PERFORM 9900-ERROR-FORMAT
  9677*                                THRU 9900-EXIT
  9678*       END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 177
* EL050.cbl
  9679*    END-IF
  9680*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9681*       IF PB-CERT-PRIME NOT NUMERIC
  9682*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9683*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9684*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9685*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9686*
  9687*          MOVE ER-2722          TO WS-ERROR
  9688*          PERFORM 9900-ERROR-FORMAT
  9689*                                THRU 9900-EXIT
  9690*       END-IF
  9691*    END-IF
  9692
  9693     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9694
  9695     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9696        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9697                                    WS-TOL-AH-CLAIM.
  9698
  9699     IF CF-ST-REFUND-MIN NOT NUMERIC
  9700        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9701
  9702     IF CF-ST-REFUND-MIN NOT = ZEROS
  9703        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9704
  9705     IF CF-ST-TOL-PREM  NOT = ZEROS
  9706        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9707                                    WS-TOL-AH-PREM
  9708        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9709
  9710     IF CF-ST-TOL-REFUND NOT = ZEROS
  9711        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9712                                    WS-TOL-AH-REFUND
  9713        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9714
  9715     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9716        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9717        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9718                                    WS-AH-REFUND-OVS-AMT
  9719                                    EC-ST-OVR-SHT-AMT.
  9720
  9721     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9722        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9723        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9724                                    WS-TOL-LF-PREM-PCT
  9725                                    WS-TOL-AH-PREM-PCT.
  9726
  9727     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9728        CF-ST-TOL-REF-PCT GREATER THAN +0
  9729        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9730                                    WS-TOL-LF-REFUND-PCT
  9731                                    WS-TOL-AH-REFUND-PCT.
  9732
  9733     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9734        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9735        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9736                                    WS-AH-REFUND-OVS-PCT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 178
* EL050.cbl
  9737                                    EC-ST-OVR-SHT-PCT.
  9738
  9739     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9740     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9741
  9742     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9743          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9744
  9745     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9746     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9747     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9748
  9749     IF CF-ST-LF-PREM-TAX NUMERIC
  9750        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9751     END-IF
  9752     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9753        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9754     END-IF
  9755     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9756        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9757     END-IF
  9758
  9759     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9760         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9761     END-IF.
  9762
  9763     IF CF-ST-CAUSAL-STATE > SPACES
  9764         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9765     END-IF.
  9766
  9767     IF WS-LF-BENEFIT-CD = ZEROS
  9768        GO TO 0410-CHECK-AH.
  9769
  9770     IF CF-ST-RT-CALC NOT = SPACES
  9771        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9772                                    EC-ST-LF-REM-TERM-CALC
  9773     END-IF
  9774
  9775     IF WS-LF-COVERAGE-TYPE = 'R'
  9776        IF WS-LF-EARNINGS-CALC = '5'
  9777           IF CF-ST-RF-LN-CALC > '0'
  9778              MOVE CF-ST-RF-LN-CALC
  9779                                 TO WS-LF-REFUND-CALC
  9780                                    EC-ST-LF-REFUND-CALC
  9781           END-IF
  9782        ELSE
  9783           IF CF-ST-RF-LR-CALC > '0'
  9784              MOVE CF-ST-RF-LR-CALC
  9785                                 TO WS-LF-REFUND-CALC
  9786                                    EC-ST-LF-REFUND-CALC
  9787           END-IF
  9788        END-IF
  9789     ELSE
  9790        IF CF-ST-RF-LL-CALC > '0'
  9791           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9792                                    EC-ST-LF-REFUND-CALC
  9793        END-IF
  9794     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 179
* EL050.cbl
  9795
  9796     IF CF-ST-RT-CALC NOT = SPACES
  9797        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9798                                    EC-ST-LF-REM-TERM-CALC
  9799     END-IF
  9800
  9801     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9802     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9803
  9804     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9805
  9806     IF NO-BENEFIT-FOUND
  9807        GO TO 0410-CHECK-AH.
  9808
  9809     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9810        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9811                                 TO EC-ST-LF-REM-TERM-CALC
  9812                                    WS-LF-REM-TERM-CALC
  9813     END-IF
  9814
  9815     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9816        MOVE CF-ST-REFUND-CALC (SUB3)
  9817                                 TO WS-LF-REFUND-CALC
  9818                                    EC-ST-LF-REFUND-CALC
  9819     END-IF
  9820*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9821
  9822     .
  9823 0410-CHECK-AH.
  9824
  9825     IF WS-AH-BENEFIT-CD = ZEROS
  9826        GO TO 0500-SET-ACCOUNT.
  9827
  9828     IF CF-ST-RT-CALC NOT = SPACES
  9829        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9830                                    EC-ST-AH-REM-TERM-CALC
  9831     END-IF
  9832
  9833     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9834        IF CF-ST-RF-CP-CALC > '0'
  9835           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9836                                    EC-ST-AH-REFUND-CALC
  9837        END-IF
  9838     ELSE
  9839        IF CF-ST-RF-AH-CALC > '0'
  9840           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9841                                    EC-ST-AH-REFUND-CALC
  9842        END-IF
  9843     END-IF
  9844     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9845     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9846
  9847     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9848
  9849     IF NO-BENEFIT-FOUND
  9850        GO TO 0500-SET-ACCOUNT.
  9851
  9852     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 180
* EL050.cbl
  9853        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9854                                 TO WS-AH-REM-TERM-CALC
  9855                                    EC-ST-AH-REM-TERM-CALC
  9856     END-IF
  9857
  9858     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9859        MOVE CF-ST-REFUND-CALC (SUB3)
  9860                                 TO WS-AH-REFUND-CALC
  9861                                    EC-ST-AH-REFUND-CALC
  9862     END-IF
  9863
  9864*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9865
  9866     GO TO 0500-SET-ACCOUNT.
  9867
  9868 0499-STATE-NOT-FOUND.
  9869
  9870     MOVE ER-2603                TO WS-ERROR.
  9871     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9872
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 181
* EL050.cbl
  9874
  9875 0500-SET-ACCOUNT.
  9876*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9877     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9878        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9879        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9880        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9881        MOVE '3'                 TO CNTL-REC-TYPE
  9882        MOVE +0                  TO CNTL-SEQ-NO
  9883
  9884        MOVE '3'                 TO RC-SW-2
  9885        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
  9886
  9887        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9888           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9889           WS-CLP-STATE  NOT = CF-STATE-CODE)
  9890           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
  9891                                    WS-ST-AH-PREM-TAX-I
  9892                                    WS-ST-AH-PREM-TAX-G
  9893        ELSE
  9894           IF CF-ST-LF-PREM-TAX NUMERIC
  9895              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9896           END-IF
  9897           IF CF-ST-AH-PREM-TAX-I NUMERIC
  9898              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9899           END-IF
  9900           IF CF-ST-AH-PREM-TAX-G NUMERIC
  9901              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9902           END-IF
  9903        END-IF
  9904        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
  9905     END-IF
  9906*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
  9907*  FOR DCC ONLY
  9908     IF PB-COMPANY-ID = 'DCC'
  9909
  9910     MOVE ' '                    TO STAT-MASTER-SW
  9911     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
  9912     MOVE PB-CARRIER             TO ELSTAT-CARRIER
  9913     MOVE PB-GROUPING            TO ELSTAT-GROUP
  9914     MOVE PB-STATE               TO ELSTAT-STATE
  9915     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9916        MOVE WS-CLP-STATE        TO ELSTAT-STATE
  9917     END-IF
  9918
  9919     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  9920     SET BIN-TO-GREG             TO TRUE
  9921     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
  9922     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
  9923     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
  9924
  9925     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
  9926     IF STAT-MASTER-FOUND
  9927        MOVE 'N'                 TO STAT-MASTER-SW
  9928        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9929        IF STAT-MASTER-FOUND
  9930           IF (ELSTAT-KEY-SAVE (1:12) =
  9931                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 182
* EL050.cbl
  9932              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9933                 MOVE 'F'        TO STAT-MASTER-SW
  9934              ELSE
  9935                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
  9936                 IF (STAT-MASTER-FOUND)
  9937                    AND (ELSTAT-KEY-SAVE (1:12) =
  9938                        SF-CONTROL-PRIMARY (1:12))
  9939                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
  9940                    MOVE 'F'     TO STAT-MASTER-SW
  9941                 END-IF
  9942              END-IF
  9943           END-IF
  9944        END-IF
  9945     END-IF
  9946
  9947     IF STAT-MASTER-SW = 'F'
  9948        IF SF-ST-LF-PREM-TAX NUMERIC
  9949           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9950        END-IF
  9951        IF SF-ST-AH-PREM-TAX-I NUMERIC
  9952           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9953        END-IF
  9954        IF SF-ST-AH-PREM-TAX-G NUMERIC
  9955           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9956        END-IF
  9957     END-IF
  9958
  9959     END-IF
  9960     IF (PB-COMPANY-ID = 'DCC')
  9961        AND (PB-ISSUE)
  9962        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
  9963        AND (AM-DCC-PRODUCT-CODE = 'DDF')
  9964        AND (AM-GPCD = 06)
  9965        MOVE 'Y'                 TO WS-GOOD-HIN
  9966        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
  9967           MOVE PB-I-VIN         TO WS-WORK-VIN
  9968           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
  9969              (V1 > 16)
  9970              IF WS-WORK-VIN (V1:1) NUMERIC
  9971                 MOVE WS-WORK-VIN-N (V1)
  9972                                 TO WS-ROW-B-VAL (V1)
  9973              ELSE
  9974                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
  9975                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
  9976                    OR (V2 > 26)
  9977                 END-PERFORM
  9978                 IF V2 < 27
  9979                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
  9980                 ELSE
  9981                    MOVE 'N'     TO WS-GOOD-HIN
  9982                 END-IF
  9983              END-IF
  9984              COMPUTE WS-ROW-D-VAL (V1) =
  9985                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
  9986              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
  9987                 WS-ROW-D-VAL (V1)
  9988           END-PERFORM
  9989           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 183
* EL050.cbl
  9990           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
  9991             REMAINDER WS-VIN-REMAINDER
  9992           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
  9993              CONTINUE
  9994           ELSE
  9995              MOVE 'N'           TO WS-GOOD-HIN
  9996           END-IF
  9997        ELSE
  9998           MOVE 'N'              TO WS-GOOD-HIN
  9999        END-IF
 10000        IF WS-GOOD-HIN NOT = 'Y'
 10001           MOVE ER-3826           TO WS-ERROR
 10002           PERFORM 9900-ERROR-FORMAT
 10003                                 THRU 9900-EXIT
 10004        END-IF
 10005     END-IF
 10006     IF (PB-COMPANY-ID = 'DCC')
 10007        AND (PB-ISSUE)
 10008        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10009        AND (AM-GPCD NOT = 06)
 10010        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10011          MOVE PB-I-VIN          TO WS-WORK-VIN
 10012          MOVE +8                TO V2
 10013          MOVE ZEROS             TO WS-VIN-TOTAL
 10014          PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10015           (V1 > 17)
 10016             IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 10017                MOVE ER-3825     TO WS-ERROR
 10018                PERFORM 9900-ERROR-FORMAT
 10019                                 THRU 9900-EXIT
 10020             ELSE
 10021                IF V1 = 8
 10022                   MOVE 10       TO V2
 10023                END-IF
 10024                IF V1 = 9
 10025                   MOVE 0        TO V2
 10026                END-IF
 10027                IF V1 = 10
 10028                   MOVE 9        TO V2
 10029                END-IF
 10030                IF WS-WORK-VIN (V1:1) NUMERIC
 10031                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10032                    + (WS-WORK-VIN-N (V1) * V2)
 10033                ELSE
 10034                   MOVE WS-WORK-VIN (V1:1)
 10035                                 TO WS-HEX-BYTE
 10036                   COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 10037                   COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 10038                    + (WS-NUM (V3) * V2)
 10039                END-IF
 10040                COMPUTE V2 = V2 - 1
 10041             END-IF
 10042          END-PERFORM
 10043          MOVE ZEROS TO WS-VIN-REMAINDER
 10044          DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 10045             REMAINDER WS-VIN-REMAINDER
 10046          IF ((WS-WORK-VIN (9:1) = 'X')
 10047             AND (WS-VIN-REMAINDER = 10))
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 184
* EL050.cbl
 10048                     OR
 10049             (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 10050             CONTINUE
 10051          ELSE
 10052             MOVE ER-3826        TO WS-ERROR
 10053             PERFORM 9900-ERROR-FORMAT
 10054                                 THRU 9900-EXIT
 10055          END-IF
 10056        ELSE
 10057          MOVE ER-3826           TO WS-ERROR
 10058          PERFORM 9900-ERROR-FORMAT
 10059                                 THRU 9900-EXIT
 10060        END-IF
 10061     END-IF
 10062******************************************************************
 10063******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10064******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10065******* METHODS.
 10066******************************************************************
 10067     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10068        IF PB-CANCELLATION
 10069           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10070              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10071                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10072                IF FORM-MASTER-FOUND
 10073                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10074******************************************************************
 10075
 10076     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10077     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10078
 10079     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10080     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10081     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10082     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10083
 10084
 10085     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10086     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
 10087     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10088
 10089     IF AM-LF-OB-RATE NOT NUMERIC
 10090         MOVE ZERO               TO AM-LF-OB-RATE.
 10091
 10092     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10093         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10094
 10095     IF AM-AH-OB-RATE NOT NUMERIC
 10096         MOVE ZERO               TO AM-AH-OB-RATE.
 10097
 10098     IF WS-LF-JOINT-INDICATOR = 'J'
 10099         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10100     ELSE
 10101         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10102
 10103     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10104
 10105     IF WS-IG-OVRD-AM  EQUAL SPACE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 185
* EL050.cbl
 10106         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10107
 10108     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10109         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10110                                       WS-IG-OVRD
 10111     ELSE
 10112         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10113             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10114                                       WS-IG-OVRD
 10115         ELSE
 10116             MOVE AM-IG             TO WS-IG-OVRD-AH
 10117                                       WS-IG-OVRD.
 10118
 10119     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10120         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10121                                       WS-IG-OVRD
 10122     ELSE
 10123         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10124             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10125                                       WS-IG-OVRD
 10126         ELSE
 10127             MOVE AM-IG             TO WS-IG-OVRD-LF
 10128                                       WS-IG-OVRD.
 10129
 10130     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10131     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10132     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10133     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10134     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10135
 10136     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10137     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10138     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10139     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10140
 10141     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10142     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10143     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10144     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
 10145     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10146     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10147     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10148
 10149     IF WS-ACCT-AH-DEV-PCT > +0
 10150        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10151     ELSE
 10152        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10153
 10154     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10155        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10156     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10157        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10158
 10159        IF AM-EARN-METHOD-L = 'S'
 10160            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10161                                        WS-LF-REFUND-CALC.
 10162
 10163        IF AM-EARN-METHOD-R = 'S'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 186
* EL050.cbl
 10164            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10165                                        WS-LF-REFUND-CALC.
 10166
 10167     IF WS-LF-COVERAGE-TYPE = 'R'
 10168         IF AM-EARN-METHOD-R = 'R'
 10169            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10170                                    WS-LF-REFUND-CALC.
 10171     IF WS-LF-COVERAGE-TYPE = 'R'
 10172         IF AM-EARN-METHOD-R = 'P'
 10173            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10174                                    WS-LF-REFUND-CALC.
 10175     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10176         IF AM-EARN-METHOD-L = 'R'
 10177            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10178                                    WS-LF-REFUND-CALC.
 10179     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10180         IF AM-EARN-METHOD-L = 'P'
 10181            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10182                                    WS-LF-REFUND-CALC.
 10183     IF WS-LF-COVERAGE-TYPE = 'R'
 10184         IF AM-EARN-METHOD-R = 'A'
 10185            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10186                                    WS-LF-REFUND-CALC.
 10187     IF WS-LF-COVERAGE-TYPE = 'R'
 10188         IF AM-EARN-METHOD-R = 'M'
 10189            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10190                                    WS-LF-REFUND-CALC.
 10191     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10192         IF AM-EARN-METHOD-L = 'A'
 10193            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10194                                    WS-LF-REFUND-CALC.
 10195     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10196         IF AM-EARN-METHOD-L = 'M'
 10197            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10198                                    WS-LF-REFUND-CALC.
 10199
 10200     IF AM-EARN-METHOD-A = 'R'
 10201        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10202                                    WS-AH-REFUND-CALC.
 10203     IF AM-EARN-METHOD-A = 'P'
 10204        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10205                                    WS-AH-REFUND-CALC.
 10206     IF AM-EARN-METHOD-A = 'C'
 10207        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10208                                    WS-AH-REFUND-CALC.
 10209     IF AM-EARN-METHOD-A = 'A'
 10210        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10211                                    WS-AH-REFUND-CALC.
 10212     IF AM-EARN-METHOD-A = 'M'
 10213        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10214                                    WS-AH-REFUND-CALC.
 10215     IF AM-EARN-METHOD-A = 'N'
 10216        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10217                                    WS-AH-REFUND-CALC.
 10218     IF AM-EARN-METHOD-A = 'S'
 10219        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10220                                    WS-AH-REFUND-CALC.
 10221
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 187
* EL050.cbl
 10222     IF AM-TOL-PREM NOT = ZEROS
 10223        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10224                                    WS-TOL-AH-PREM.
 10225
 10226     IF AM-OVR-SHT-AMT NUMERIC AND
 10227                  AM-OVR-SHT-AMT > 0
 10228        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10229                                    EC-AM-LF-OVR-SHT-AMT
 10230                                    WS-AH-REFUND-OVS-AMT
 10231                                    EC-AM-AH-OVR-SHT-AMT.
 10232
 10233     IF AM-OVR-SHT-PCT NUMERIC AND
 10234                    AM-OVR-SHT-PCT > 0
 10235        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10236                                    EC-AM-LF-OVR-SHT-PCT
 10237                                    WS-AH-REFUND-OVS-PCT
 10238                                    EC-AM-AH-OVR-SHT-PCT.
 10239
 10240     IF AM-TOL-REF-PCT NUMERIC AND
 10241                  AM-TOL-REF-PCT > 0
 10242        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10243                                    WS-TOL-AH-REFUND-PCT.
 10244
 10245     IF AM-TOL-REF  NOT = ZEROS  AND
 10246                  AM-TOL-REF NUMERIC
 10247        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10248                                    EC-AM-LF-TOL-REFUND
 10249                                    WS-TOL-AH-REFUND
 10250                                    EC-AM-AH-TOL-REFUND.
 10251
 10252     IF AM-TOL-CLM  NOT = ZEROS
 10253        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10254                                    WS-TOL-AH-CLAIM.
 10255
 10256     IF AM-CLP-TOL-PCT NOT NUMERIC
 10257        MOVE +0                  TO AM-CLP-TOL-PCT
 10258     END-IF
 10259
 10260     IF AM-SPP-LEASE-COMM NOT NUMERIC
 10261        MOVE +0                  TO AM-SPP-LEASE-COMM
 10262     END-IF
 10263     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10264        MOVE WS-PL-TOL-LF-PREM-PCT
 10265                                 TO WS-TOL-LF-PREM-PCT.
 10266
 10267     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10268        MOVE WS-PL-TOL-AH-PREM-PCT
 10269                                 TO WS-TOL-AH-PREM-PCT.
 10270
 10271     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10272        MOVE WS-PL-TOL-LF-REFUND-PCT
 10273                                 TO WS-TOL-LF-REFUND-PCT.
 10274
 10275     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10276        MOVE WS-PL-TOL-AH-REFUND-PCT
 10277                                 TO WS-TOL-AH-REFUND-PCT.
 10278
 10279     IF WS-PL-REF-OVS-AMT > +0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 188
* EL050.cbl
 10280        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10281
 10282     IF WS-PL-REF-OVS-PCT > +0
 10283        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10284
 10285     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10286        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10287     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10288        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10289     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10290        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10291     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10292        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10293     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10294        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10295     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10296        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10297
 10298     IF WS-AH-PL-REF-OVS-AMT > +0
 10299        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10300
 10301     IF WS-AH-PL-REF-OVS-PCT > +0
 10302        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10303
 10304     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10305     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10306
 10307     IF PB-CANCELLATION
 10308        GO TO 3000-CONTINUE-EDIT.
 10309
 10310     MOVE +1 TO SUB1.
 10311     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10312     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10313
 10314     IF CF-COMPANY-ID = 'DMD'
 10315       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10316         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10317        ELSE
 10318         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
 10319
 10320  0525-FIND-ACCT-COMM.
 10321     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10322        NEXT SENTENCE
 10323      ELSE
 10324         ADD +1 TO SUB1
 10325         IF SUB1 LESS +11
 10326            GO TO 0525-FIND-ACCT-COMM
 10327          ELSE
 10328             GO TO 0560-EDIT-CONTINUE.
 10329
 10330     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10331     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10332                                    PB-I-LIFE-COMMISSION.
 10333***  IF PB-COMPANY-ID = 'CRI'
 10334     IF PB-PREM-ACCTNG-ONLY
 10335         GO TO 0560-EDIT-CONTINUE.
 10336
 10337     MOVE '0530' TO CTBL-SW.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 189
* EL050.cbl
 10338     MOVE ' '    TO WS-CTBL-READ-SW.
 10339
 10340
 10341 0530-GET-AH-COMP.
 10342     IF NO-AH-COVERAGE  OR
 10343        NO-AH-BENEFIT-MATCH
 10344           GO TO 0540-NEXT-READ-STEP.
 10345
 10346     IF AM-A-COM (SUB1) NUMERIC
 10347        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10348         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10349         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10350         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10351         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10352     ELSE
 10353          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10354          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10355          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10356          MOVE ZEROS             TO WS-SUB1
 10357                                    WS-COMMISSION
 10358          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10359          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10360          IF WS-COMMISSION > ZEROS
 10361             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10362             GO TO 0540-NEXT-READ-STEP
 10363          END-IF
 10364          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10365          IF CTBL-TABLE-FOUND
 10366             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10367                                        PB-I-AH-TERM
 10368             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10369             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10370             GO TO 0540-NEXT-READ-STEP
 10371          ELSE
 10372             IF FIRST-TIME-THROUGH
 10373                 GO TO 0530-GET-AH-COMP
 10374             ELSE
 10375                 MOVE ER-2609                TO WS-ERROR
 10376                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10377
 10378 0540-NEXT-READ-STEP.
 10379     MOVE '0540' TO CTBL-SW.
 10380     MOVE ' '    TO WS-CTBL-READ-SW.
 10381
 10382 0540-GET-LF-COMP.
 10383     IF NO-LIFE-COVERAGE  OR
 10384        NO-LF-BENEFIT-MATCH
 10385           GO TO 0560-EDIT-CONTINUE.
 10386
 10387     IF WS-LF-JOINT-INDICATOR = 'J'
 10388        IF AM-J-COM (SUB1) NUMERIC
 10389           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10390           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10391           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10392           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10393           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10394        ELSE
 10395           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 190
* EL050.cbl
 10396           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10397           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10398           MOVE ZEROS                TO WS-SUB1
 10399                                        WS-COMMISSION
 10400           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10401           IF WS-COMMISSION > ZEROS
 10402              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10403              GO TO 0560-EDIT-CONTINUE
 10404           END-IF
 10405           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10406           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10407           IF CTBL-TABLE-FOUND
 10408              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10409              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10410              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10411              GO TO 0560-EDIT-CONTINUE
 10412           ELSE
 10413              IF FIRST-TIME-THROUGH
 10414                  GO TO 0540-GET-LF-COMP
 10415              ELSE
 10416                  MOVE ER-2609                TO WS-ERROR
 10417                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10418                  GO TO 0560-EDIT-CONTINUE.
 10419
 10420     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10421        IF AM-L-COM (SUB1) NUMERIC
 10422           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10423           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10424           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10425           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10426           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10427        ELSE
 10428           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10429           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10430           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10431           MOVE ZEROS                TO WS-SUB1
 10432                                        WS-COMMISSION
 10433           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10434           IF WS-COMMISSION IS GREATER THAN ZEROS
 10435              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10436              GO TO 0560-EDIT-CONTINUE
 10437           END-IF
 10438           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10439           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10440           IF CTBL-TABLE-FOUND
 10441              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10442              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10443              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10444              GO TO 0560-EDIT-CONTINUE
 10445           ELSE
 10446              IF FIRST-TIME-THROUGH
 10447                  GO TO 0540-GET-LF-COMP
 10448              ELSE
 10449                  MOVE ER-2609                TO WS-ERROR
 10450                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10451
 10452*    GO TO 0560-EDIT-CONTINUE.
 10453
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 191
* EL050.cbl
 10454 0560-EDIT-CONTINUE.
 10455     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10456                                    WS-AH-PMF-COMM
 10457*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10458*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10459     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10460        (SUB1 > +10)
 10461        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10462           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10463           MOVE '0530'           TO CTBL-SW
 10464           MOVE ' '              TO WS-CTBL-READ-SW
 10465           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10466           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10467           MOVE '0540'           TO CTBL-SW
 10468           MOVE ' '              TO WS-CTBL-READ-SW
 10469           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10470        END-IF
 10471     END-PERFORM
 10472     GO TO 0564-EDIT-CONTINUE
 10473     .
 10474 0561-CHECK-AH.
 10475     IF (NO-AH-COVERAGE)
 10476        OR (NO-AH-BENEFIT-MATCH)
 10477        CONTINUE
 10478     ELSE
 10479        IF (AM-A-COM (SUB1) NUMERIC)
 10480           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10481           IF (AM-COM-TYP (SUB1) = 'A')
 10482              AND (WS-AH-PMF-COMM = ZEROS)
 10483              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10484           END-IF
 10485           CONTINUE
 10486        ELSE
 10487           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10488           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10489           MOVE PB-AH-OVERRIDE-L1
 10490                                 TO CTBL-BEN-TYPE
 10491           MOVE ZEROS            TO WS-SUB1
 10492                                    WS-COMMISSION
 10493           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10494           PERFORM 8300-READ-CTBL-TABLE
 10495                                 THRU 8300-EXIT
 10496           IF CTBL-TABLE-FOUND
 10497              IF (AM-COM-TYP (SUB1) = 'A')
 10498                 AND (WS-AH-PMF-COMM = ZEROS)
 10499                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10500                                        PB-I-AH-TERM
 10501                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10502                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10503              END-IF
 10504              CONTINUE
 10505           ELSE
 10506              IF FIRST-TIME-THROUGH
 10507                 GO TO 0561-CHECK-AH
 10508              ELSE
 10509                 MOVE ER-2609    TO WS-ERROR
 10510                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10511              END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 192
* EL050.cbl
 10512           END-IF
 10513        END-IF
 10514     END-IF
 10515     .
 10516 0561-EXIT.
 10517     EXIT.
 10518 0563-CHECK-LF.
 10519     IF (NO-LIFE-COVERAGE)
 10520        OR (NO-LF-BENEFIT-MATCH)
 10521        CONTINUE
 10522     ELSE
 10523        IF WS-LF-JOINT-INDICATOR = 'J'
 10524           IF AM-J-COM (SUB1) NUMERIC
 10525              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10526              IF (AM-COM-TYP (SUB1) = 'A')
 10527                 AND (WS-LF-PMF-COMM = ZEROS)
 10528                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10529              END-IF
 10530              CONTINUE
 10531           ELSE
 10532              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10533              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10534              MOVE PB-LIFE-OVERRIDE-L1
 10535                                 TO CTBL-BEN-TYPE
 10536              MOVE ZEROS         TO WS-SUB1
 10537                                    WS-COMMISSION
 10538              MOVE AM-J-COMA (SUB1)
 10539                                 TO CTBL-TABLE
 10540              PERFORM 8300-READ-CTBL-TABLE
 10541                                 THRU 8300-EXIT
 10542              IF CTBL-TABLE-FOUND
 10543                 IF (AM-COM-TYP (SUB1) = 'A')
 10544                    AND (WS-LF-PMF-COMM = ZEROS)
 10545                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10546                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10547                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10548                 END-IF
 10549                 CONTINUE
 10550              ELSE
 10551                 IF FIRST-TIME-THROUGH
 10552                    GO TO 0563-CHECK-LF
 10553                 ELSE
 10554                    MOVE ER-2609 TO WS-ERROR
 10555                    PERFORM 9900-ERROR-FORMAT
 10556                                 THRU 9900-EXIT
 10557*                   GO TO 0560-EDIT-CONTINUE
 10558                 END-IF
 10559              END-IF
 10560           END-IF
 10561        ELSE
 10562           IF AM-L-COM (SUB1) NUMERIC
 10563              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10564              IF (AM-COM-TYP (SUB1) = 'A')
 10565                 AND (WS-LF-PMF-COMM = ZEROS)
 10566                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10567              END-IF
 10568              CONTINUE
 10569           ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 193
* EL050.cbl
 10570              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10571              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10572              MOVE PB-LIFE-OVERRIDE-L1
 10573                                 TO CTBL-BEN-TYPE
 10574              MOVE ZEROS         TO WS-SUB1
 10575                                    WS-COMMISSION
 10576              MOVE AM-L-COMA (SUB1)
 10577                                 TO CTBL-TABLE
 10578              PERFORM 8300-READ-CTBL-TABLE
 10579                                 THRU 8300-EXIT
 10580              IF CTBL-TABLE-FOUND
 10581                 CONTINUE
 10582              ELSE
 10583                 IF FIRST-TIME-THROUGH
 10584                    GO TO 0563-CHECK-LF
 10585                 ELSE
 10586                    MOVE ER-2609 TO WS-ERROR
 10587                    PERFORM 9900-ERROR-FORMAT
 10588                                 THRU 9900-EXIT
 10589                 END-IF
 10590              END-IF
 10591           END-IF
 10592        END-IF
 10593     END-IF
 10594     .
 10595 0563-EXIT.
 10596     EXIT.
 10597 0564-EDIT-CONTINUE.
 10598
 10599     IF  PB-COMPANY-ID EQUAL 'DMD'
 10600         IF PB-I-NUM-BILLED EQUAL ZEROS
 10601            MOVE ER-8148       TO WS-ERROR
 10602            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10603
 10604*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10605*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10606*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10607*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10608*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10609*         IF NO-CONVERSION-ERROR
 10610*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10611*         ELSE
 10612*             IF PB-COMPANY-ID EQUAL 'HAN'
 10613*                 MOVE ZEROS     TO PB-I-AGE.
 10614     IF PB-I-BIRTHDAY > LOW-VALUES
 10615        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10616        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10617        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10618        PERFORM 8500-DATE-CONVERT
 10619                                 THRU 8500-EXIT
 10620        IF NO-CONVERSION-ERROR
 10621           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10622           IF PB-I-AGE > ZEROS
 10623              IF WS-WORK-AGE NOT = PB-I-AGE
 10624                 MOVE ER-9501    TO WS-ERROR
 10625                 PERFORM 9900-ERROR-FORMAT
 10626                                 THRU 9900-EXIT
 10627              END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 194
* EL050.cbl
 10628           ELSE
 10629              MOVE WS-WORK-AGE   TO PB-I-AGE
 10630           END-IF
 10631        END-IF
 10632     END-IF
 10633     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10634                                   WS-INS-AGE-SET
 10635     IF PB-I-AGE = ZEROS
 10636        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10637           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10638                                   WS-INS-AGE-SET
 10639           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10640
 10641     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10642                                   WS-AH-EDIT-AGE.
 10643
 10644     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10645        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10646        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10647        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10648        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10649        IF NO-CONVERSION-ERROR
 10650           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10651           IF PB-I-JOINT-AGE > 0
 10652              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10653                 MOVE ER-9503    TO WS-ERROR
 10654                 PERFORM 9900-ERROR-FORMAT
 10655                                 THRU 9900-EXIT
 10656              END-IF
 10657           ELSE
 10658              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10659           END-IF
 10660        ELSE
 10661           MOVE ZEROS            TO PB-I-JOINT-AGE
 10662        END-IF
 10663     END-IF
 10664     IF PB-I-JOINT-AGE NOT NUMERIC
 10665        MOVE ZERO               TO PB-I-JOINT-AGE.
 10666
 10667     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10668                                   WS-JNT-AGE-SET
 10669     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10670        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10671           (WS-AH-JOINT-INDICATOR = 'J')
 10672           IF PB-I-JOINT-AGE = ZEROS
 10673               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10674                                          WS-JNT-AGE-SET
 10675               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10676           END-IF
 10677        END-IF
 10678     END-IF
 10679
 10680     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10681     IF WS-LF-JOINT-INDICATOR = 'J'
 10682        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10683        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10684            IF  PB-I-JOINT-AGE = ZERO
 10685                MOVE ER-2686       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 195
* EL050.cbl
 10686                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10687            ELSE
 10688                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10689                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10690                    IF PB-COMPANY-ID NOT = 'LBL'
 10691                        MOVE ER-2685    TO WS-ERROR
 10692                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10693
 10694     IF WS-AH-JOINT-INDICATOR = 'J'
 10695        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10696            IF  PB-I-JOINT-AGE = ZERO
 10697                MOVE ER-2686       TO WS-ERROR
 10698                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10699            ELSE
 10700                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10701                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10702                                           WS-EDIT-AGE
 10703                    IF PB-COMPANY-ID NOT = 'LBL'
 10704                        MOVE ER-2685    TO WS-ERROR
 10705                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10706
 10707******************************************************************
 10708*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10709******************************************************************
 10710
 10711     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10712        (WS-AH-SPECIAL-CALC-CD = 'O')
 10713        NEXT SENTENCE
 10714     ELSE
 10715        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10716          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10717           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10718            WS-AH-JOINT-INDICATOR = 'J')  AND
 10719           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10720            MOVE ER-2627             TO WS-ERROR
 10721            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10722
 10723     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10724        (WS-AH-SPECIAL-CALC-CD = 'O')
 10725         NEXT SENTENCE
 10726     ELSE
 10727         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10728            WS-AH-JOINT-INDICATOR = 'J'
 10729             IF PB-I-JOINT-INSURED = SPACES
 10730                 IF PB-COMPANY-ID NOT = 'JAL'
 10731                     MOVE ER-2696    TO WS-ERROR
 10732                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10733
 10734     IF PB-COMPANY-ID NOT = 'BOA'
 10735        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10736           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10737           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10738               PB-I-JOINT-INSURED NOT = SPACES)
 10739                MOVE ER-2691         TO WS-ERROR
 10740                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10741
 10742     IF PB-COMPANY-ID = 'BOA'
 10743        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 196
* EL050.cbl
 10744           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10745            IF PB-I-JOINT-AGE NOT = ZEROS
 10746                MOVE ER-2691         TO WS-ERROR
 10747                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10748
 10749     IF PB-COMPANY-ID = 'CRI'
 10750        IF PB-I-SIG-SW = 'J'
 10751           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10752              WS-AH-JOINT-INDICATOR NOT = 'J'
 10753              MOVE ER-2675       TO WS-ERROR
 10754              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10755
 10756     IF PB-COMPANY-ID = 'CRI'
 10757        IF PB-I-SIG-SW = 'S'
 10758           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10759              WS-AH-JOINT-INDICATOR = 'J'
 10760              MOVE ER-2676       TO WS-ERROR
 10761              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10762
 10763     IF PB-COMPANY-ID = 'CVL'
 10764         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10765            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10766              MOVE ER-2783           TO WS-ERROR
 10767              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10768     IF (WS-LF-JOINT-INDICATOR = 'J')
 10769        AND (WS-AH-JOINT-INDICATOR = 'J')
 10770        AND (PB-I-LF-TERM > 120)
 10771        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10772        MOVE ER-2783             TO WS-ERROR
 10773        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10774     END-IF
 10775     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10776
 10777     IF PB-I-INDV-GRP-OVRD = 'I'
 10778        MOVE ER-2666             TO WS-ERROR
 10779        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10780        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10781
 10782     IF PB-I-INDV-GRP-OVRD = 'G'
 10783        MOVE ER-2666             TO WS-ERROR
 10784        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10785        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10786
 10787     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10788        NEXT SENTENCE
 10789     ELSE
 10790        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10791
 10792     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10793        IF WS-ERROR = ER-2666
 10794           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10795           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10796
 10797     IF PB-COMPANY-ID = 'CID'
 10798        IF PB-STATE = 'UT' OR 'MO'
 10799           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10800                 OR '76' OR '77')
 10801                      OR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 197
* EL050.cbl
 10802               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10803                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10804                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10805                   OR '2K' OR '2L'))
 10806              AND PB-I-INDV-GRP-CD = 'I'
 10807              MOVE ER-2721             TO WS-ERROR
 10808              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10809           END-IF
 10810        END-IF
 10811     END-IF
 10812
 10813     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10814     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10815        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10816     ELSE
 10817        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10818     END-IF
 10819
 10820*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10821*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10822     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10823                                    ACCOUNT-AH-CK-SW.
 10824
 10825     IF PB-REISSUED-CERT       OR
 10826        PB-REIN-ONLY-CERT      OR
 10827        PB-POLICY-IS-DECLINED  OR
 10828        PB-POLICY-IS-VOIDED
 10829*       OR PB-MONTHLY-CERT
 10830         GO TO 3000-CONTINUE-EDIT.
 10831
 10832     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10833        IF WS-EDIT-AGE           > +65
 10834           MOVE ER-2709          TO WS-ERROR
 10835           PERFORM 9900-ERROR-FORMAT
 10836                                 THRU 9900-EXIT
 10837        ELSE
 10838           IF WS-EDIT-AGE        > +55
 10839              MOVE ER-2718       TO WS-ERROR
 10840              PERFORM 9900-ERROR-FORMAT
 10841                                 THRU 9900-EXIT
 10842           END-IF
 10843        END-IF
 10844     IF PB-COMPANY-ID = 'DCC'
 10845        IF WS-EDIT-AGE           > +65
 10846           MOVE ER-2709          TO WS-ERROR
 10847           PERFORM 9900-ERROR-FORMAT
 10848                                 THRU 9900-EXIT
 10849        END-IF
 10850     END-IF
 10851     .
 10852
 10853 0565-LIFE-PLAN-LIMIT-EDITS.
 10854
 10855     IF NOT LF-PLAN-MASTER-FOUND
 10856        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10857                                    EC-AM-LF-MAX-TOT-BEN
 10858        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10859
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 198
* EL050.cbl
 10860     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10861
 10862     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10863         IF PL-LM-AGE (1) = ZEROS
 10864             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10865
 10866     IF NO-LF-BENEFIT-MATCH          OR
 10867        WS-LF-BENEFIT-CD = ZEROS     OR
 10868        WS-LF-SPECIAL-CALC-CD = 'M'
 10869        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10870
 10871     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10872     MOVE +1                     TO SUB2.
 10873
 10874     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10875        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10876           MOVE +5   TO SUB2
 10877           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10878              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10879              (PL-LM-AGE (SUB2) EQUAL +0)
 10880              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10881              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10882
 10883     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10884
 10885     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10886                               + PB-I-LF-ALT-BENEFIT-AMT.
 10887
 10888 0568-CHECK-LIFE-ATT-AGE.
 10889
 10890     IF PL-ATT-AGE NUMERIC AND
 10891        PL-ATT-AGE > +0
 10892        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10893     END-IF
 10894*    IF PL-ATT-AGE NUMERIC AND
 10895*       PL-ATT-AGE > +0
 10896*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10897*       IF PB-I-BIRTHDAY > LOW-VALUES
 10898*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10899*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10900*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10901*          SET BIN-PLUS-ELAPSED  TO TRUE
 10902*          PERFORM 8500-DATE-CONVERT
 10903*                                THRU 8500-EXIT
 10904*          IF NO-CONVERSION-ERROR
 10905*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10906*             MOVE ER-2669       TO WS-ERROR
 10907*             PERFORM 9900-ERROR-FORMAT
 10908*                                THRU 9900-EXIT
 10909*          END-IF
 10910*       ELSE
 10911*          IF WS-ATT-AGE >= PL-ATT-AGE
 10912*             MOVE ER-2669       TO WS-ERROR
 10913*             PERFORM 9900-ERROR-FORMAT
 10914*                                THRU 9900-EXIT
 10915*          END-IF
 10916*       END-IF
 10917*    END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 199
* EL050.cbl
 10918     .
 10919 0570-CHECK-LIFE-LIMITS.
 10920
 10921     IF PB-COMPANY-ID EQUAL 'CRI'
 10922        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10923           IF SUB2 GREATER THAN +4
 10924              MOVE ER-2637 TO WS-ERROR
 10925              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10926              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10927
 10928     IF PB-COMPANY-ID  =  'NCL'
 10929        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 10930            SUB2 GREATER THAN +8
 10931             MOVE 'U'         TO PB-BATCH-ENTRY
 10932             MOVE ER-2637     TO WS-ERROR
 10933             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10934             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10935
 10936     IF SUB2 > +8
 10937        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10938           AND (PB-I-SIG-SW = 'Y')
 10939           CONTINUE
 10940        ELSE
 10941           MOVE ER-2637          TO WS-ERROR
 10942           PERFORM 9900-ERROR-FORMAT
 10943                                 THRU 9900-EXIT
 10944        END-IF
 10945        GO TO 0580-AH-PLAN-LIMIT-EDITS
 10946     END-IF
 10947     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 10948     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 10949     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 10950
 10951     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 10952        ADD +1  TO SUB2
 10953        GO TO 0570-CHECK-LIFE-LIMITS.
 10954
 10955     IF PB-COMPANY-ID = 'NCL'
 10956         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
 10957
 10958     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 10959        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 10960        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 10961           AND (PB-I-SIG-SW = 'Y')
 10962           CONTINUE
 10963        ELSE
 10964           MOVE ER-2637          TO WS-ERROR
 10965           PERFORM 9900-ERROR-FORMAT
 10966                                 THRU 9900-EXIT
 10967        END-IF
 10968     END-IF
 10969     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10970
 10971
 10972 0570-CHECK-NCL-LIFE-LIMITS.
 10973
 10974     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 10975        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 200
* EL050.cbl
 10976         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 10977
 10978     IF APP-CERT-USED
 10979         IF SUB2  LESS THAN  +5
 10980             MOVE +5          TO SUB2
 10981             GO TO 0570-CHECK-LIFE-LIMITS.
 10982
 10983     MOVE ER-2637             TO WS-ERROR.
 10984     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10985
 10986     MOVE 'U'                 TO PB-BATCH-ENTRY.
 10987
 10988 0575-CHECK-NCL-SIG-SWITCH.
 10989
 10990     IF NOT APP-CERT-USED
 10991         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10992
 10993     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 10994        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 10995        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 10996        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 10997         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10998
 10999     IF SUB2 GREATER THAN +4
 11000         IF PL-LM-AGE (5) = ZEROS  AND
 11001            PL-LM-AGE (6) = ZEROS  AND
 11002            PL-LM-AGE (7) = ZEROS  AND
 11003            PL-LM-AGE (8) = ZEROS
 11004             MOVE  ER-1927        TO WS-ERROR
 11005             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11006             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11007         ELSE
 11008             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11009                 MOVE  ER-1920    TO WS-ERROR
 11010                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11011
 11012     IF PB-I-SIG-SW  = 'Y'
 11013       IF NOT PB-I-POLICY-ACCEPTED  AND
 11014          NOT PB-I-POLICY-DECLINED
 11015           MOVE 'U'               TO PB-BATCH-ENTRY
 11016           MOVE  ER-1926          TO WS-ERROR
 11017           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11018
 11019
 11020 0580-AH-PLAN-LIMIT-EDITS.
 11021
 11022     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11023        IF PB-I-AH-BENEFIT-AMT > +1250
 11024           MOVE ER-2702          TO WS-ERROR
 11025           PERFORM 9900-ERROR-FORMAT
 11026                                 THRU 9900-EXIT
 11027        END-IF
 11028     END-IF
 11029
 11030     IF (PB-COMPANY-ID = 'DCC')
 11031        AND (PB-MONTHLY-CERT)
 11032        IF PB-I-AH-BENEFIT-AMT > +3000
 11033           MOVE ER-2881          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 201
* EL050.cbl
 11034           PERFORM 9900-ERROR-FORMAT
 11035                                 THRU 9900-EXIT
 11036        END-IF
 11037     END-IF
 11038     IF NOT AH-PLAN-MASTER-FOUND
 11039        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11040        GO TO 3000-CONTINUE-EDIT.
 11041
 11042     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11043
 11044     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11045         IF PL-LM-AGE (1) = ZEROS
 11046             GO TO 3000-CONTINUE-EDIT.
 11047
 11048     IF NO-AH-BENEFIT-MATCH          OR
 11049        WS-AH-BENEFIT-CD = ZEROS     OR
 11050        WS-AH-SPECIAL-CALC-CD = 'M'
 11051        GO TO 3000-CONTINUE-EDIT.
 11052
 11053     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11054     MOVE +1                     TO SUB2.
 11055
 11056     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11057        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11058           MOVE +5 TO SUB2
 11059           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11060              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11061              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11062              (PL-LM-AGE (SUB2) EQUAL +0)
 11063              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11064              GO TO 3000-CONTINUE-EDIT.
 11065
 11066     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11067
 11068 0590-CHECK-AH-ATT-AGE.
 11069
 11070     IF PL-ATT-AGE NUMERIC AND
 11071        PL-ATT-AGE GREATER THAN +0
 11072        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
 11073     END-IF
 11074*       IF WS-ATT-AGE >= PL-ATT-AGE
 11075*          MOVE ER-3054          TO WS-ERROR
 11076*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11077     .
 11078 0597-CHECK-AH-LIMITS.
 11079
 11080     IF PB-COMPANY-ID EQUAL 'CRI'
 11081        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11082           IF SUB2 GREATER THAN +4
 11083              MOVE ER-2638       TO WS-ERROR
 11084              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11085              GO TO 3000-CONTINUE-EDIT.
 11086
 11087     IF PB-COMPANY-ID  =  'NCL'
 11088        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11089            SUB2 GREATER THAN +8
 11090             MOVE 'U'            TO PB-BATCH-ENTRY
 11091             MOVE ER-2638        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 202
* EL050.cbl
 11092             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11093             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11094
 11095     IF SUB2 > +8
 11096        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11097           AND (PB-I-SIG-SW = 'Y')
 11098           CONTINUE
 11099        ELSE
 11100           MOVE ER-2638          TO WS-ERROR
 11101           PERFORM 9900-ERROR-FORMAT
 11102                                 THRU 9900-EXIT
 11103        END-IF
 11104        GO TO 3000-CONTINUE-EDIT
 11105     END-IF
 11106
 11107     IF PB-COMPANY-ID = 'CRI'
 11108        IF WS-ERROR = ER-2638
 11109           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11110
 11111     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11112     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11113     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11114     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11115
 11116     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11117        ADD +1                   TO SUB2
 11118        GO TO 0597-CHECK-AH-LIMITS.
 11119
 11120     IF PB-COMPANY-ID = 'NCL'
 11121         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11122
 11123     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11124        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11125        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11126                                 > PL-LM-AMT (SUB2))
 11127        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11128           AND (PB-I-SIG-SW = 'Y')
 11129           CONTINUE
 11130        ELSE
 11131           MOVE ER-2638          TO WS-ERROR
 11132           PERFORM 9900-ERROR-FORMAT
 11133                                 THRU 9900-EXIT
 11134        END-IF
 11135     END-IF
 11136
 11137     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11138         IF  WS-ERROR    EQUAL    ER-2638
 11139             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11140                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11141                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11142                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11143                MOVE  ER-1910    TO  WS-ERROR
 11144                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11145
 11146     IF PB-COMPANY-ID = 'CRI'
 11147        IF WS-ERROR = ER-2638
 11148            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11149            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 203
* EL050.cbl
 11150            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11151
 11152     GO TO 3000-CONTINUE-EDIT.
 11153
 11154 0597-CHECK-NCL-AH-LIMITS.
 11155
 11156     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11157        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11158        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11159                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11160         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11161
 11162     IF APP-CERT-USED
 11163         IF SUB2  LESS THAN  +5
 11164             MOVE +5             TO SUB2
 11165             GO TO 0597-CHECK-AH-LIMITS.
 11166
 11167     MOVE ER-2638                TO WS-ERROR.
 11168     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11169
 11170     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11171
 11172 0599-CHECK-NCL-SIG-SWITCH.
 11173
 11174     IF NOT APP-CERT-USED
 11175         GO TO 3000-CONTINUE-EDIT.
 11176
 11177     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11178        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11179        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11180        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11181         GO TO 3000-CONTINUE-EDIT.
 11182
 11183     IF SUB2 GREATER THAN +4
 11184         IF PL-LM-AGE (5) = ZEROS  AND
 11185            PL-LM-AGE (6) = ZEROS  AND
 11186            PL-LM-AGE (7) = ZEROS  AND
 11187            PL-LM-AGE (8) = ZEROS
 11188             MOVE  ER-1927        TO WS-ERROR
 11189             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11190             GO TO 3000-CONTINUE-EDIT
 11191         ELSE
 11192             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11193                 MOVE  ER-1920    TO WS-ERROR
 11194                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11195
 11196     IF PB-I-SIG-SW  = 'Y'
 11197       IF NOT PB-I-POLICY-ACCEPTED  AND
 11198          NOT PB-I-POLICY-DECLINED
 11199           MOVE 'U'               TO PB-BATCH-ENTRY
 11200           MOVE  ER-1926          TO WS-ERROR
 11201           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11202
 11203******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 204
* EL050.cbl
 11205
 11206 3000-CONTINUE-EDIT.
 11207
 11208     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11209     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11210     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11211     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11212     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11213
 11214     IF BROWSE-STARTED
 11215        PERFORM 9990-RETURN THRU 9990-EXIT
 11216        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11217
 11218     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11219        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11220        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11221        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11222*       MOVE 1                   TO DC-OPTION-CODE
 11223        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11224        IF DATE-CONVERSION-ERROR
 11225           MOVE ER-2622          TO WS-ERROR
 11226           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11227        ELSE
 11228           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11229              MOVE ER-2623       TO WS-ERROR
 11230              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11231           ELSE
 11232              MOVE ER-2622       TO WS-ERROR
 11233              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11234
 11235     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11236     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11237     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11238*    MOVE 1                      TO DC-OPTION-CODE.
 11239     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11240     IF DATE-CONVERSION-ERROR
 11241        GO TO 3005-EDIT-CONTINUE
 11242     ELSE
 11243        IF DC-ELAPSED-DAYS GREATER +180
 11244           MOVE ER-2613          TO WS-ERROR
 11245           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11246        ELSE
 11247           IF DC-ELAPSED-DAYS GREATER +90
 11248              MOVE ER-2612       TO WS-ERROR
 11249              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11250           ELSE
 11251             IF DC-ELAPSED-DAYS GREATER +60
 11252                MOVE ER-2614     TO WS-ERROR
 11253                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11254
 11255 3005-EDIT-CONTINUE.
 11256
 11257     IF PB-CANCELLATION
 11258         GO TO 3700-EDIT-CANCEL.
 11259
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 205
* EL050.cbl
 11261******************************************************************
 11262*                  E D I T   I S S U E                           *
 11263******************************************************************
 11264
 11265 3020-EDIT-ISSUE.
 11266
 11267      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11268      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11269      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11270      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11271      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11272
 11273     IF PB-ISSUE-FORCE
 11274        OR PB-ISSUE-DATE-FORCED
 11275        OR PB-FORCE-OFF
 11276        OR PB-OVERCHARGE-FORCE
 11277        CONTINUE
 11278     ELSE
 11279        MOVE ER-2670             TO WS-ERROR
 11280        PERFORM 9900-ERROR-FORMAT
 11281                                 THRU 9900-EXIT
 11282     END-IF
 11283     .
 11284 3022-SET-POLICY-STATUS.
 11285
 11286     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11287
 11288     IF (PB-REISSUED-CERT)
 11289             OR
 11290        ((PB-COMPANY-ID NOT = 'DCC')
 11291         AND (PB-MONTHLY-CERT))
 11292         MOVE '5'                TO PB-I-ENTRY-STATUS
 11293         MOVE 'E'                TO PB-BATCH-ENTRY
 11294     END-IF
 11295
 11296     IF PB-COMPANY-ID = 'DCC'
 11297        IF PB-MONTHLY-CERT
 11298           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11299        END-IF
 11300     END-IF
 11301     IF PB-POLICY-IS-DECLINED
 11302         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11303     IF PB-POLICY-IS-VOIDED
 11304         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11305     IF PB-NEEDS-UNDERWRITING
 11306         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11307     IF PB-REIN-ONLY-CERT
 11308         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11309     IF PB-PREM-ACCTNG-ONLY
 11310         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11311
 11312     MOVE SPACE                  TO PB-I-OB-FLAG.
 11313
 11314     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11315         MOVE ER-2665            TO WS-ERROR
 11316         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11317         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11318
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 206
* EL050.cbl
 11319     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11320        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11321           MOVE 'Z'             TO PB-I-OB-FLAG.
 11322
 11323     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11324        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11325           MOVE 'Z'             TO PB-I-OB-FLAG.
 11326
 11327     IF ACCOUNT-MAST-FOUND
 11328         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11329         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11330         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11331         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11332         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11333         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11334         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11335     END-IF
 11336
 11337     IF ACCOUNT-MAST-FOUND
 11338        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11339         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11340
 11341     IF (ACCOUNT-MAST-FOUND)
 11342        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11343        IF PB-REISSUED-CERT
 11344           CONTINUE
 11345        ELSE
 11346           MOVE ER-2608          TO WS-ERROR
 11347           PERFORM 9900-ERROR-FORMAT
 11348                                 THRU 9900-EXIT
 11349         END-IF
 11350     END-IF
 11351
 11352     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11353        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11354        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11355
 11356**********   DMD CUSTOM CODE FOLLOWS  **********
 11357 3024-EDIT-DMD-FIELDS.
 11358     IF PB-COMPANY-ID NOT = 'DMD'
 11359        GO TO 3025-EDIT-REINSURANCE.
 11360
 11361*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11362*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11363*** ERROR IF THEY ARE NOT EQUAL.
 11364
 11365     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11366     SET BIN-TO-GREG               TO TRUE.
 11367     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11368     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11369**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11370
 11371     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11372     SET BIN-TO-GREG               TO TRUE.
 11373     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11374     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11375**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11376
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 207
* EL050.cbl
 11377     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11378        MOVE ER-8116               TO WS-ERROR
 11379        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11380
 11381     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11382
 11383     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11384                                      WK-FULL-CERT-NO.
 11385     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11386
 11387     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11388
 11389     IF PB-VALID-LIFE
 11390        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11391     ELSE
 11392        IF PB-VALID-AH
 11393          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11394
 11395
 11396     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11397     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11398     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11399                                      DCUA-UNDRWRTR-CODE
 11400                                      DCUA-UNDRWRTR-GROUP-CODE
 11401                                      DCUA-RETURN-CODE.
 11402
 11403****************************************************************
 11404*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11405***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11406***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11407***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11408***   TO THIS RECORD.                                        ***
 11409****************************************************************
 11410     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11411     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11412     IF DCUA-SUCCESSFUL-PROCESS
 11413        GO TO 3024-EDIT-DL7-CONT.
 11414
 11415     IF DCUA-RETURN-CODE EQUAL '01'
 11416        MOVE ER-8110               TO WS-ERROR
 11417        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11418        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11419        GO TO 3024-EDIT-DL7-CONT.
 11420
 11421     IF DCUA-RETURN-CODE EQUAL '02'
 11422        MOVE ER-8111               TO WS-ERROR
 11423        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11424        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11425        GO TO 3024-EDIT-DL7-CONT.
 11426
 11427     IF DCUA-RETURN-CODE EQUAL '03'
 11428        MOVE ER-8074               TO WS-ERROR
 11429        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11430        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11431        GO TO 3024-EDIT-DL7-CONT.
 11432
 11433     IF DCUA-RETURN-CODE EQUAL '04'
 11434        MOVE ER-8075               TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 208
* EL050.cbl
 11435        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11436        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11437        GO TO 3024-EDIT-DL7-CONT.
 11438
 11439     IF DCUA-RETURN-CODE EQUAL '05'
 11440        MOVE ER-8076               TO WS-ERROR
 11441        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11442        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11443        GO TO 3024-EDIT-DL7-CONT.
 11444
 11445     IF DCUA-RETURN-CODE EQUAL '06'
 11446        MOVE ER-8077               TO WS-ERROR
 11447        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11448        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11449        GO TO 3024-EDIT-DL7-CONT.
 11450
 11451     IF DCUA-RETURN-CODE EQUAL '07'
 11452        MOVE ER-8078               TO WS-ERROR
 11453        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11455        GO TO 3024-EDIT-DL7-CONT.
 11456
 11457     IF DCUA-RETURN-CODE EQUAL 'E1'
 11458        MOVE ER-8079               TO WS-ERROR
 11459        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11460        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11461        GO TO 3024-EDIT-DL7-CONT.
 11462
 11463     IF DCUA-RETURN-CODE EQUAL 'E2'
 11464        MOVE ER-8080               TO WS-ERROR
 11465        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11467        GO TO 3024-EDIT-DL7-CONT.
 11468
 11469     IF DCUA-RETURN-CODE EQUAL 'E3'
 11470        MOVE ER-8098               TO WS-ERROR
 11471        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11472        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11473        GO TO 3024-EDIT-DL7-CONT.
 11474
 11475     IF DCUA-RETURN-CODE EQUAL 'C1'
 11476        MOVE ER-8099               TO WS-ERROR
 11477        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11479        GO TO 3024-EDIT-DL7-CONT.
 11480
 11481     IF DCUA-RETURN-CODE EQUAL 'U1'
 11482        MOVE ER-8109               TO WS-ERROR
 11483        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11485        GO TO 3024-EDIT-DL7-CONT.
 11486
 11487     IF DCUA-RETURN-CODE EQUAL 'N1'
 11488        MOVE ER-8112               TO WS-ERROR
 11489        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11490        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11491        GO TO 3024-EDIT-DL7-CONT.
 11492
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 209
* EL050.cbl
 11493     IF DCUA-RETURN-CODE EQUAL 'N2'
 11494        MOVE ER-8113               TO WS-ERROR
 11495        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11497        GO TO 3024-EDIT-DL7-CONT.
 11498
 11499     IF DCUA-RETURN-CODE EQUAL 'N3'
 11500        MOVE ER-8114               TO WS-ERROR
 11501        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11502        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11503        GO TO 3024-EDIT-DL7-CONT.
 11504
 11505     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11506     MOVE ER-8097                  TO WS-ERROR.
 11507     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11508     GO TO 3024-EDIT-DL7-CONT.
 11509
 11510 3024-EDIT-DL7-CONT.
 11511
 11512     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11513     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11514     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11515        NEXT SENTENCE
 11516     ELSE
 11517        MOVE ER-9263               TO WS-ERROR
 11518        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11519
 11520******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11521******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11522     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11523        NEXT SENTENCE
 11524     ELSE
 11525        MOVE ER-8039               TO WS-ERROR
 11526        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11527
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 210
* EL050.cbl
 11529****************************************************************
 11530*** VALIDATE STATE  : DLO022                                 ***
 11531****************************************************************
 11532     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11533     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11534
 11535     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11536     IF DVSC-SUCCESSFUL-EDIT
 11537        GO TO 3024-EDIT-DL22-CONT.
 11538
 11539     IF DVSC-RETURN-CODE EQUAL '01'
 11540        MOVE ER-8300               TO WS-ERROR
 11541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11542        GO TO 3024-EDIT-DL22-CONT.
 11543
 11544     IF DVSC-RETURN-CODE EQUAL '02'
 11545        MOVE ER-8301               TO WS-ERROR
 11546        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11547        GO TO 3024-EDIT-DL22-CONT.
 11548
 11549     IF DVSC-RETURN-CODE EQUAL '03'
 11550        MOVE ER-8302               TO WS-ERROR
 11551        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11552        GO TO 3024-EDIT-DL22-CONT.
 11553
 11554     IF DVSC-RETURN-CODE EQUAL 'N1'
 11555        MOVE ER-8304               TO WS-ERROR
 11556        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11557        GO TO 3024-EDIT-DL22-CONT.
 11558
 11559     MOVE ER-8303                  TO WS-ERROR
 11560     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11561
 11562 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 211
* EL050.cbl
 11564****************************************************************
 11565*** VALIDATE LOAN OFFICER : DLO021                           ***
 11566****************************************************************
 11567
 11568     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11569     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11570     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11571     IF DVLO-SUCCESSFUL-EDIT
 11572        GO TO 3024-EDIT-DL21-CONT.
 11573
 11574     IF DVLO-RETURN-CODE EQUAL '01'
 11575        MOVE ER-8081               TO WS-ERROR
 11576        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11577        GO TO 3024-EDIT-DL21-CONT.
 11578
 11579     IF DVLO-RETURN-CODE EQUAL '02'
 11580        MOVE ER-8082               TO WS-ERROR
 11581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11582        GO TO 3024-EDIT-DL21-CONT.
 11583
 11584     IF DVLO-RETURN-CODE EQUAL '03'
 11585        MOVE ER-8083               TO WS-ERROR
 11586        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11587        GO TO 3024-EDIT-DL21-CONT.
 11588
 11589     IF DVLO-RETURN-CODE EQUAL '04'
 11590        MOVE ER-8084               TO WS-ERROR
 11591        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11592        GO TO 3024-EDIT-DL21-CONT.
 11593
 11594     IF DVLO-RETURN-CODE EQUAL '05'
 11595        MOVE ER-8085               TO WS-ERROR
 11596        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11597        GO TO 3024-EDIT-DL21-CONT.
 11598
 11599     MOVE ER-7825                  TO WS-ERROR
 11600     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11601     GO TO 3024-EDIT-DL21-CONT.
 11602
 11603 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 212
* EL050.cbl
 11605
 11606****************************************************************
 11607*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11608****************************************************************
 11609
 11610     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11611     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11612     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11613     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11614     IF DIPF-SUCCESSFUL-EDIT
 11615        GO TO 3024-EDIT-DL02-CONT.
 11616
 11617     IF DIPF-RETURN-CODE EQUAL '01'
 11618        MOVE ER-8086               TO WS-ERROR
 11619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11620        GO TO 3024-EDIT-DL02-CONT.
 11621
 11622     IF DIPF-RETURN-CODE EQUAL '02'
 11623        MOVE ER-8087               TO WS-ERROR
 11624        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11625        GO TO 3024-EDIT-DL02-CONT.
 11626
 11627     IF DIPF-RETURN-CODE EQUAL '03'
 11628        MOVE ER-8088               TO WS-ERROR
 11629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11630        GO TO 3024-EDIT-DL02-CONT.
 11631
 11632     MOVE ER-8095                  TO WS-ERROR
 11633     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11634     GO TO 3024-EDIT-DL02-CONT.
 11635
 11636 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 213
* EL050.cbl
 11638
 11639****************************************************************
 11640*** VALIDATE BANK ID : DLO003                                ***
 11641****************************************************************
 11642
 11643     MOVE WK-GREG-CENT           TO WCG-CENT.
 11644     MOVE WK-GREG-YYMM           TO WCG-REST.
 11645     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11646        MOVE ER-8040               TO WS-ERROR
 11647        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11648
 11649     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11650     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11651     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11652     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11653     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11654     IF DVBI-SUCCESSFUL-EDIT
 11655        GO TO 3024-EDIT-DL03-CONT.
 11656
 11657     IF DVBI-RETURN-CODE EQUAL '01'
 11658        MOVE ER-8089               TO WS-ERROR
 11659        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11660        GO TO 3024-EDIT-DL03-CONT.
 11661
 11662     IF DVBI-RETURN-CODE EQUAL '02'
 11663        MOVE ER-8090               TO WS-ERROR
 11664        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11665        GO TO 3024-EDIT-DL03-CONT.
 11666
 11667     IF DVBI-RETURN-CODE EQUAL '03'
 11668        MOVE ER-8091               TO WS-ERROR
 11669        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11670        GO TO 3024-EDIT-DL03-CONT.
 11671
 11672     IF DVBI-RETURN-CODE EQUAL '04'
 11673        MOVE ER-8092               TO WS-ERROR
 11674        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11675        GO TO 3024-EDIT-DL03-CONT.
 11676
 11677     IF DVBI-RETURN-CODE EQUAL '05'
 11678        MOVE ER-8093               TO WS-ERROR
 11679        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11680        GO TO 3024-EDIT-DL03-CONT.
 11681
 11682     IF DVBI-RETURN-CODE EQUAL '06'
 11683        MOVE ER-8094               TO WS-ERROR
 11684        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11685        GO TO 3024-EDIT-DL03-CONT.
 11686
 11687     MOVE ER-8096                  TO WS-ERROR
 11688     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11689     GO TO 3024-EDIT-DL03-CONT.
 11690
 11691 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 214
* EL050.cbl
 11693
 11694     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11695        NEXT SENTENCE
 11696     ELSE
 11697        MOVE ER-8042               TO WS-ERROR
 11698        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11699
 11700     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11701     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11702     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11703
 11704     IF DMPF-RETURN-CODE = '01'
 11705        MOVE ER-8067               TO WS-ERROR
 11706        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11707        GO TO 3024-EDIT-DL01-CONT.
 11708
 11709     IF DMPF-RETURN-CODE = '02'
 11710        MOVE ER-8068               TO WS-ERROR
 11711        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11712        GO TO 3024-EDIT-DL01-CONT.
 11713
 11714     IF DMPF-RETURN-CODE = '03'
 11715        MOVE ER-8069               TO WS-ERROR
 11716        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11717        GO TO 3024-EDIT-DL01-CONT.
 11718
 11719     IF DMPF-RETURN-CODE = 'E1'
 11720        MOVE ER-8070               TO WS-ERROR
 11721        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11722        GO TO 3024-EDIT-DL01-CONT.
 11723
 11724     IF DMPF-RETURN-CODE = 'N1'
 11725        MOVE ER-8071               TO WS-ERROR
 11726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11727        GO TO 3024-EDIT-DL01-CONT.
 11728
 11729     IF DMPF-RETURN-CODE NOT = 'OK'
 11730        MOVE ER-8072               TO WS-ERROR
 11731        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11732
 11733 3024-EDIT-DL01-CONT.
 11734******************************************************************
 11735***  VALIDATES RATE CODES : DLO017                             ***
 11736******************************************************************
 11737
 11738      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11739      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11740      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11741      IF DVRC-SUCCESSFUL-EDIT
 11742        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11743        GO TO 3024-CHECK-VALID-RATE.
 11744
 11745      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11746
 11747      IF DVRC-RETURN-CODE EQUAL '01'
 11748         MOVE ER-7817                   TO WS-ERROR
 11749         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11750         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 215
* EL050.cbl
 11751
 11752      IF DVRC-RETURN-CODE EQUAL '02'
 11753         MOVE ER-7818                   TO WS-ERROR
 11754         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11755         GO TO 3025-EDIT-REINSURANCE.
 11756
 11757      IF DVRC-RETURN-CODE EQUAL '03'
 11758         MOVE ER-7819                   TO WS-ERROR
 11759         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11760         GO TO 3025-EDIT-REINSURANCE.
 11761
 11762       MOVE ER-7820                     TO WS-ERROR.
 11763       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11764       GO TO 3025-EDIT-REINSURANCE.
 11765
 11766******************************************************************
 11767***  GET PREMIUM RATES : DLO011                                ***
 11768******************************************************************
 11769
 11770 3024-CHECK-VALID-RATE.
 11771
 11772     IF VALID-RATE-CODE
 11773        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11774        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11775        MOVE SPACES                TO DPRB-RETURN-CODE
 11776        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11777     ELSE
 11778         GO TO 3025-EDIT-REINSURANCE.
 11779
 11780      IF DPRB-SUCCESSFUL-PROCESS
 11781         IF PB-VALID-LIFE
 11782             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11783             GO TO 3025-EDIT-REINSURANCE
 11784         ELSE
 11785             IF PB-VALID-AH
 11786                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11787                 GO TO 3025-EDIT-REINSURANCE.
 11788
 11789      IF DPRB-RETURN-CODE EQUAL '01'
 11790         MOVE ER-7812                   TO WS-ERROR
 11791         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11792         GO TO 3025-EDIT-REINSURANCE.
 11793
 11794      IF DPRB-RETURN-CODE EQUAL '02'
 11795         MOVE ER-7813                   TO WS-ERROR
 11796         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11797         GO TO 3025-EDIT-REINSURANCE.
 11798
 11799      IF DPRB-RETURN-CODE EQUAL '03'
 11800         MOVE ER-7814                   TO WS-ERROR
 11801         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11802         GO TO 3025-EDIT-REINSURANCE.
 11803
 11804      IF DPRB-RETURN-CODE EQUAL '04'
 11805         IF NOT DPRB-1ST-TIME
 11806            MOVE ER-7815                   TO WS-ERROR
 11807            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11808            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 216
* EL050.cbl
 11809          ELSE
 11810         IF PB-VALID-LIFE
 11811            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11812          ELSE
 11813            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11814         END-IF
 11815         MOVE SPACES                TO DOCC-RETURN-CODE
 11816         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11817         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11818         IF DOCC-RETURN-CODE = 'OK'
 11819             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11820             GO TO 3024-CHECK-VALID-RATE
 11821           ELSE
 11822             MOVE ER-7823               TO WS-ERROR
 11823             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11824             GO TO 3025-EDIT-REINSURANCE.
 11825
 11826       MOVE ER-7816                     TO WS-ERROR.
 11827       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11828       GO TO 3025-EDIT-REINSURANCE.
 11829
 11830**********   DMD CUSTOM CODE ABOVE    **********
 11831
 11832 3025-EDIT-REINSURANCE.
 11833     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11834         GO TO 3027-EDIT-CONTINUE.
 11835
 11836     MOVE LOW-VALUES               TO ERREIN-KEY.
 11837     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11838     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11839                                      REIN-CODE-2
 11840                                      REIN-CODE-3.
 11841     MOVE 'A'                      TO REIN-TYPE.
 11842
 11843     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11844
 11845     MOVE '3026' TO REIN-SW.
 11846     MOVE ' '                   TO WS-REIN-READ-SW.
 11847
 11848     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11849     IF REIN-TABLE-NOT-FOUND
 11850         GO TO 3026-NO-SPEC-TABLE.
 11851
 11852     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11853     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11854                                   WS-NSP-ST-CD-LF.
 11855     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11856                                   WS-NSP-ST-CD-AH.
 11857
 11858     GO TO 3040-EDIT-CONTINUE.
 11859
 11860 3026-NO-SPEC-TABLE.
 11861
 11862     MOVE ER-2664                TO WS-ERROR.
 11863     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11864     GO TO 3040-EDIT-CONTINUE.
 11865
 11866 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 217
* EL050.cbl
 11867
 11868     IF PB-I-REIN-TABLE = SPACES
 11869       GO TO 3040-EDIT-CONTINUE.
 11870
 11871     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11872          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11873          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11874           GO TO 3040-EDIT-CONTINUE.
 11875
 11876     MOVE LOW-VALUES            TO ERREIN-KEY.
 11877     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11878     MOVE 'A'                   TO REIN-TYPE.
 11879     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11880
 11881     MOVE '3028'                TO REIN-SW.
 11882     MOVE ' '                   TO WS-REIN-READ-SW.
 11883
 11884     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11885     IF REIN-TABLE-NOT-FOUND
 11886         GO TO 3028-NO-REIN-TABLE.
 11887
 11888     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11889     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11890                                   WS-NSP-ST-CD-LF.
 11891     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11892                                   WS-NSP-ST-CD-AH.
 11893
 11894     GO TO 3040-EDIT-CONTINUE.
 11895
 11896 3028-NO-REIN-TABLE.
 11897
 11898     MOVE ER-2615                TO WS-ERROR.
 11899     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11900     GO TO 3040-EDIT-CONTINUE.
 11901
 11902 3040-EDIT-CONTINUE.
 11903
 11904     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11905         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11906
 11907     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11908         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11909
 11910     IF (NOT PB-REISSUED-CERT)
 11911        AND (NOT PB-MONTHLY-CERT)
 11912        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11913            MOVE '001'           TO PB-I-LF-TERM
 11914            MOVE 'M'             TO PB-I-INSURED-SEX.
 11915
 11916     IF (NOT PB-REISSUED-CERT)
 11917        AND (NOT PB-MONTHLY-CERT)
 11918        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11919            MOVE '001'           TO PB-I-AH-TERM
 11920            MOVE 'M'             TO PB-I-INSURED-SEX.
 11921
 11922 3040-EDIT-1ST-PMT-DT.
 11923     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 11924     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 218
* EL050.cbl
 11925         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 11926
 11927******************************************************************
 11928*                                                                *
 11929*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 11930*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 11931*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 11932*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 11933*                                                                *
 11934******************************************************************
 11935
 11936     IF PB-EFF-DT-PROCESSING
 11937        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 11938                                    PB-I-LF-EXPIRE-DT
 11939                                    PB-I-AH-EXPIRE-DT
 11940        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 11941        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 11942        MOVE ZERO                TO DC-ELAPSED-DAYS
 11943        MOVE +1                  TO DC-ELAPSED-MONTHS
 11944        SET BIN-PLUS-ELAPSED     TO TRUE
 11945*       MOVE 6                   TO DC-OPTION-CODE
 11946        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11947        IF NO-CONVERSION-ERROR
 11948           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 11949
 11950******************************************************************
 11951*                                                                *
 11952*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 11953*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 11954*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11955*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 11956*                                                                *
 11957******************************************************************
 11958
 11959     IF PB-EXT-DAYS-PROCESSING
 11960          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 11961                                         PB-I-LF-EXPIRE-DT
 11962                                         PB-I-AH-EXPIRE-DT
 11963          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 11964          MOVE ZERO                   TO DC-ELAPSED-DAYS
 11965          MOVE +1                     TO DC-ELAPSED-MONTHS
 11966          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 11967          SET BIN-PLUS-ELAPSED        TO TRUE
 11968*         MOVE 6                      TO DC-OPTION-CODE
 11969          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11970          IF NO-CONVERSION-ERROR
 11971             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 11972
 11973******************************************************************
 11974*                                                                *
 11975*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 11976*        BASED ON THE OLDEST EXPIRE DATE.                        *
 11977*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 11978*        (EXPIRE DATE - (TERM -1))  *  -1.
 11979*                                                                *
 11980******************************************************************
 11981
 11982     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 219
* EL050.cbl
 11983        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 11984           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 11985              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11986              MOVE PB-I-AH-TERM      TO WS-TERM
 11987           ELSE
 11988              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11989              MOVE PB-I-LF-TERM      TO WS-TERM
 11990        ELSE
 11991           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 11992              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 11993              MOVE PB-I-LF-TERM      TO WS-TERM
 11994           ELSE
 11995              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 11996              MOVE PB-I-AH-TERM      TO WS-TERM.
 11997
 11998     IF PB-EXPIRE-DT-PROCESSING
 11999        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12000        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12001        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12002        MOVE ZERO                TO DC-ELAPSED-DAYS
 12003                                    DC-ODD-DAYS-OVER
 12004          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12005          SET BIN-PLUS-ELAPSED    TO TRUE
 12006*         MOVE 6                  TO DC-OPTION-CODE
 12007          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12008          IF NO-CONVERSION-ERROR
 12009             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12010
 12011******************************************************************
 12012*                                                                *
 12013*            1ST PAYMENT DATE PROCESSING                         *
 12014*                                                                *
 12015******************************************************************
 12016
 12017     IF PB-1ST-PMT-DT-PROCESSING
 12018        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12019                                    PB-I-AH-EXPIRE-DT
 12020        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12021
 12022     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12023         NEXT SENTENCE
 12024     ELSE
 12025         MOVE ER-2680                 TO WS-ERROR
 12026         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12027         GO TO 3060-ORIG-TERM-CHECK.
 12028
 12029     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12030     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12031     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12032*    MOVE 1                      TO DC-OPTION-CODE.
 12033     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12034                                    DC-ELAPSED-DAYS
 12035                                    DC-ODD-DAYS-OVER.
 12036
 12037     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12038
 12039     IF DATE-CONVERSION-ERROR
 12040        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 220
* EL050.cbl
 12041
 12042     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12043     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12044        AND (WS-LF-COVERAGE-TYPE = 'L')
 12045        IF (DC-ELAPSED-MONTHS > 1)
 12046                      OR
 12047           ((DC-ELAPSED-MONTHS = 1)
 12048           AND (DC-ODD-DAYS-OVER > 0))
 12049           MOVE ER-2882          TO WS-ERROR
 12050           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12051        END-IF
 12052     END-IF
 12053     if dc-elapsed-months > 0
 12054        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12055        + dc-odd-days-over
 12056     end-if
 12057     IF PB-EXT-DAYS-PROCESSING
 12058        CONTINUE
 12059     ELSE
 12060        IF DC-ELAPSED-MONTHS = +0
 12061           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12062        ELSE
 12063           IF (WS-LF-EARNINGS-CALC = '4')
 12064              AND (DC-ELAPSED-MONTHS > ZERO)
 12065              AND (DC-ELAPSED-DAYS > ZERO)
 12066              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12067           ELSE
 12068              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12069                                 THRU 6499-EXIT
 12070              MOVE WS-ODD-DAYS-OVER
 12071                                 TO PB-I-EXTENTION-DAYS
 12072           END-IF
 12073        END-IF
 12074     END-IF
 12075******************************************************************
 12076*                                                                *
 12077*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12078*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12079*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12080*            AND ANY ODD DAYS.                                   *
 12081*                                                                *
 12082******************************************************************
 12083
 12084     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12085                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12086     IF WS-LF-EARNINGS-CALC NOT = '4'
 12087        IF DC-ELAPSED-DAYS > ZEROS
 12088           MOVE ER-2681          TO WS-ERROR
 12089           PERFORM 9900-ERROR-FORMAT
 12090                                 THRU 9900-EXIT
 12091        END-IF
 12092     END-IF
 12093
 12094     IF WS-LF-EARNINGS-CALC NOT = '4'
 12095        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12096           MOVE ER-2681          TO WS-ERROR
 12097           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12098
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 221
* EL050.cbl
 12099     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12100        (PB-I-LF-TERM NOT = ZERO) AND
 12101         NOT NO-LIFE-COVERAGE
 12102          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12103          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12104          IF WS-LF-EARNINGS-CALC = '4'
 12105             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12106             PB-I-PAY-FREQUENCY
 12107          END-IF
 12108          MOVE ZERO              TO DC-ELAPSED-DAYS
 12109                                    DC-ODD-DAYS-OVER
 12110          MOVE 1                 TO DC-END-OF-MONTH
 12111          SET BIN-PLUS-ELAPSED        TO TRUE
 12112*         MOVE 6                 TO DC-OPTION-CODE
 12113          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12114          IF NO-CONVERSION-ERROR
 12115             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12116             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12117                (WS-LF-SPECIAL-CALC-CD = 'L')
 12118                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12119                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12120                  MOVE +1             TO DC-ELAPSED-MONTHS
 12121                  SET BIN-PLUS-ELAPSED  TO TRUE
 12122*                 MOVE 6              TO DC-OPTION-CODE
 12123                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12124                  IF NO-CONVERSION-ERROR
 12125                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12126
 12127* okay, i had to move the new att age edit down here because the
 12128* expiration date could get recalculated and i need the exp date
 12129     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12130        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12131        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12132        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12133           AND ZEROS
 12134           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12135           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12136           SET ELAPSED-BETWEEN-BIN TO TRUE
 12137           PERFORM 8500-DATE-CONVERT
 12138                                 THRU 8500-EXIT
 12139           IF NO-CONVERSION-ERROR
 12140              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12141                 MOVE ER-2669       TO WS-ERROR
 12142*                PERFORM 9900-ERROR-FORMAT
 12143*                                THRU 9900-EXIT
 12144              END-IF
 12145           END-IF
 12146        ELSE
 12147           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12148           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12149              MOVE ER-2669       TO WS-ERROR
 12150*             PERFORM 9900-ERROR-FORMAT
 12151*                                THRU 9900-EXIT
 12152           ELSE
 12153              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12154                 MOVE ER-1570    TO WS-ERROR
 12155                 PERFORM 9900-ERROR-FORMAT
 12156                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 222
* EL050.cbl
 12157              END-IF
 12158           END-IF
 12159        END-IF
 12160        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12161           AND ZEROS
 12162           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12163           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12164           SET ELAPSED-BETWEEN-BIN TO TRUE
 12165           PERFORM 8500-DATE-CONVERT
 12166                                 THRU 8500-EXIT
 12167           IF NO-CONVERSION-ERROR
 12168              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12169                 MOVE ER-2669       TO WS-ERROR
 12170*                PERFORM 9900-ERROR-FORMAT
 12171*                                THRU 9900-EXIT
 12172              END-IF
 12173           END-IF
 12174        ELSE
 12175           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12176             (PB-I-LF-TERM / 12)
 12177           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12178              MOVE ER-2669       TO WS-ERROR
 12179*             PERFORM 9900-ERROR-FORMAT
 12180*                                THRU 9900-EXIT
 12181           ELSE
 12182              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12183                 MOVE ER-1571    TO WS-ERROR
 12184                 PERFORM 9900-ERROR-FORMAT
 12185                                 THRU 9900-EXIT
 12186              END-IF
 12187           END-IF
 12188        END-IF
 12189        IF WS-ERROR = ER-2669
 12190           PERFORM 9900-ERROR-FORMAT
 12191                                 THRU 9900-EXIT
 12192        END-IF
 12193     END-IF
 12194     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12195        (PB-I-AH-TERM NOT = ZERO) AND
 12196         NOT NO-AH-COVERAGE
 12197          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12198             AND (PB-COMPANY-ID = 'DCC')
 12199             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12200             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12201          ELSE
 12202             IF WS-LF-EARNINGS-CALC = '4'
 12203                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12204                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12205                PB-I-PAY-FREQUENCY
 12206             ELSE
 12207                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12208                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12209             END-IF
 12210          END-IF
 12211          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12212                                         DC-ODD-DAYS-OVER
 12213          MOVE 1                      TO DC-END-OF-MONTH
 12214          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 223
* EL050.cbl
 12215*         MOVE 6                      TO DC-OPTION-CODE
 12216          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12217          IF NO-CONVERSION-ERROR
 12218             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12219     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12220        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12221        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12222        IF PB-I-BIRTHDAY > LOW-VALUES
 12223           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12224           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12225           SET ELAPSED-BETWEEN-BIN TO TRUE
 12226           PERFORM 8500-DATE-CONVERT
 12227                                 THRU 8500-EXIT
 12228           IF NO-CONVERSION-ERROR
 12229              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12230                 MOVE ER-3054       TO WS-ERROR
 12231*                PERFORM 9900-ERROR-FORMAT
 12232*                                THRU 9900-EXIT
 12233              END-IF
 12234           END-IF
 12235        ELSE
 12236           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12237           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12238              MOVE ER-3054       TO WS-ERROR
 12239*             PERFORM 9900-ERROR-FORMAT
 12240*                                THRU 9900-EXIT
 12241           END-IF
 12242        END-IF
 12243        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12244           AND ZEROS
 12245           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12246           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12247           SET ELAPSED-BETWEEN-BIN TO TRUE
 12248           PERFORM 8500-DATE-CONVERT
 12249                                 THRU 8500-EXIT
 12250           IF NO-CONVERSION-ERROR
 12251              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12252                 MOVE ER-3054       TO WS-ERROR
 12253*                PERFORM 9900-ERROR-FORMAT
 12254*                                THRU 9900-EXIT
 12255              END-IF
 12256           END-IF
 12257        ELSE
 12258           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12259             (PB-I-AH-TERM / 12)
 12260           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12261              MOVE ER-3054       TO WS-ERROR
 12262*             PERFORM 9900-ERROR-FORMAT
 12263*                                THRU 9900-EXIT
 12264           END-IF
 12265        END-IF
 12266        IF WS-ERROR = ER-3054
 12267           PERFORM 9900-ERROR-FORMAT
 12268                                 THRU 9900-EXIT
 12269        END-IF
 12270     END-IF
 12271     MOVE SPACE                       TO DC-END-OF-MONTH.
 12272
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 224
* EL050.cbl
 12273     IF PB-COMPANY-ID = 'NCB'
 12274        GO TO 3040-EDIT-EXTENSION-DAYS.
 12275
 12276     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12277       AND
 12278        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12279        NEXT SENTENCE
 12280     ELSE
 12281        GO TO 3040-EDIT-EXTENSION-DAYS.
 12282
 12283     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12284        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12285        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12286     ELSE
 12287        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12288        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12289
 12290     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12291*    MOVE '1'      TO DC-OPTION-CODE
 12292     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12293     IF (NO-CONVERSION-ERROR)
 12294        AND (DC-ELAPSED-MONTHS > +1)
 12295        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12296        MOVE ER-2668   TO WS-ERROR
 12297        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12298
 12299 3040-EDIT-EXTENSION-DAYS.
 12300
 12301     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12302        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12303         GO TO 3050-EDIT-TERM-IN-DAYS
 12304     ELSE
 12305         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12306
 12307     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12308         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12309     ELSE
 12310        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12311           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12312           MOVE ER-2681         TO WS-ERROR
 12313           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12314
 12315     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12316        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12317        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12318         GO TO 3060-ORIG-TERM-CHECK.
 12319
 12320     GO TO 3060-ORIG-TERM-CHECK.
 12321
 12322 3050-EDIT-TERM-IN-DAYS.
 12323
 12324     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12325
 12326     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12327         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12328     ELSE
 12329         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12330            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 225
* EL050.cbl
 12331            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12332
 12333     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12334                                       REMAINDER WS-WORK-TERM.
 12335     IF WS-WORK-TERM GREATER THAN ZERO
 12336         ADD +1 TO PB-I-LF-TERM.
 12337
 12338     IF NOT NO-AH-COVERAGE
 12339         MOVE ER-2684            TO WS-ERROR
 12340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12341
 12342
 12343 3060-ORIG-TERM-CHECK.
 12344
 12345******************************************************************
 12346*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12347******************************************************************
 12348
 12349     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12350        NEXT SENTENCE
 12351     ELSE
 12352        IF NOT NO-LIFE-COVERAGE
 12353           IF PB-I-LF-TERM NUMERIC
 12354              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12355              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12356              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12357                  NEXT SENTENCE
 12358           ELSE
 12359              MOVE ER-2647       TO WS-ERROR
 12360              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12361
 12362     IF NOT NO-AH-COVERAGE
 12363         IF PB-I-AH-TERM NUMERIC
 12364            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12365            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12366            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12367             NEXT SENTENCE
 12368          ELSE
 12369              MOVE ER-2658       TO WS-ERROR
 12370              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12371
 12372     IF PB-COMPANY-ID = 'NCB'
 12373        GO TO 3070-LOAN-TERM-CHECK.
 12374
 12375     IF POLICY-HAS-AH
 12376       AND
 12377        POLICY-HAS-LIFE
 12378       AND
 12379        PB-I-LF-TERM NUMERIC
 12380       AND
 12381        PB-I-AH-TERM NUMERIC
 12382        NEXT SENTENCE
 12383     ELSE
 12384        GO TO 3070-LOAN-TERM-CHECK.
 12385
 12386     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12387     IF WS-TEX-FACT-2 LESS THAN +0
 12388        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 226
* EL050.cbl
 12389
 12390     IF WS-TEX-FACT-2 GREATER THAN +1
 12391        MOVE ER-2668             TO WS-ERROR
 12392        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12393
 12394 3070-LOAN-TERM-CHECK.
 12395
 12396     IF (WS-LF-BENEFIT-CD = ZERO)
 12397         OR (NO-LF-BENEFIT-MATCH)
 12398            GO TO 3125-EDIT-PMT-FREQ.
 12399*    IF PB-COMPANY-ID NOT = 'DCC'
 12400*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12401*          AND 'V' AND 'W' AND 'X'
 12402*          GO TO 3125-EDIT-PMT-FREQ
 12403*       END-IF
 12404*    ELSE
 12405*       IF WS-AH-DCC-TRUNC = 'T'
 12406*          CONTINUE
 12407*       ELSE
 12408*          GO TO 3125-EDIT-PMT-FREQ
 12409*       END-IF
 12410*    END-IF
 12411     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12412                    OR
 12413        ((PB-COMPANY-ID = 'DCC')
 12414        AND (WS-AH-DCC-TRUNC = 'T'))
 12415        CONTINUE
 12416     ELSE
 12417        GO TO 3125-EDIT-PMT-FREQ
 12418     END-IF
 12419     IF PB-I-LOAN-TERM NOT NUMERIC
 12420         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12421
 12422     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12423        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12424*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12425        PB-I-LOAN-TERM NOT GREATER THAN +360
 12426         NEXT SENTENCE
 12427     ELSE
 12428         MOVE ER-2648            TO WS-ERROR
 12429         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12430
 12431     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12432        MOVE ER-3058             TO WS-ERROR
 12433        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12434     end-if
 12435
 12436     IF WS-STATE-ABBREVIATION = 'NC'
 12437        IF PB-I-LOAN-TERM > +59
 12438           CONTINUE
 12439        ELSE
 12440           MOVE ER-2792          TO WS-ERROR
 12441           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12442        END-IF
 12443     END-IF
 12444
 12445     .
 12446 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 227
* EL050.cbl
 12447     IF (WS-LF-BENEFIT-CD = ZERO)
 12448         OR (NO-LF-BENEFIT-MATCH)
 12449            GO TO 3127-EDIT-LOAN-OFFICER.
 12450     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12451                    OR
 12452        ((PB-COMPANY-ID = 'DCC')
 12453        AND (WS-AH-DCC-TRUNC = 'T'))
 12454                    OR
 12455         (PB-COMPANY-ID = 'AHL')
 12456        CONTINUE
 12457     ELSE
 12458        IF (PB-I-LOAN-TERM > ZEROS)
 12459           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12460           MOVE ER-1575          TO WS-ERROR
 12461           PERFORM 9900-ERROR-FORMAT
 12462                                 THRU 9900-EXIT
 12463        END-IF
 12464     END-IF
 12465     IF WS-LF-EARNINGS-CALC NOT = '4'
 12466         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12467            MOVE ER-2653         TO WS-ERROR
 12468            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12469            GO TO 3127-EDIT-LOAN-OFFICER
 12470         ELSE
 12471            GO TO 3127-EDIT-LOAN-OFFICER.
 12472
 12473     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12474         MOVE ER-2655            TO WS-ERROR
 12475         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12476         GO TO 3127-EDIT-LOAN-OFFICER.
 12477
 12478     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12479         MOVE ER-2654            TO WS-ERROR
 12480         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12481         GO TO 3127-EDIT-LOAN-OFFICER.
 12482
 12483     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12484         GIVING WS-TEX-FACT-2
 12485             REMAINDER WS-TEX-FACT-3.
 12486
 12487*    IF WS-TEX-FACT-3 NOT = ZERO
 12488*       MOVE ER-2654             TO WS-ERROR
 12489*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12490
 12491
 12492 3127-EDIT-LOAN-OFFICER.
 12493
 12494     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12495        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12496           MOVE ER-2690          TO WS-ERROR
 12497           PERFORM 9900-ERROR-FORMAT
 12498                                 THRU 9900-EXIT
 12499        ELSE
 12500           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12501           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12502           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12503           MOVE PB-SV-STATE      TO LOFC-STATE
 12504           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 228
* EL050.cbl
 12505           MOVE PB-I-LOAN-OFFICER
 12506                                 TO LOFC-CODE
 12507           PERFORM 8586-READ-LOAN-OFFICER
 12508                                 THRU 8586-EXIT
 12509           IF (NOT LOFC-MASTER-FOUND)
 12510              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12511              MOVE ER-3006       TO WS-ERROR
 12512              PERFORM 9900-ERROR-FORMAT
 12513                                 THRU 9900-EXIT
 12514           END-IF
 12515        END-IF
 12516     END-IF
 12517     .
 12518 3129-EDIT-APR.
 12519
 12520     IF (WS-LF-BENEFIT-CD = ZERO)
 12521        OR (NO-LF-BENEFIT-MATCH)
 12522        IF PB-COMPANY-ID NOT = 'DCC'
 12523           GO TO 3130-EDIT-AGE
 12524*       ELSE
 12525*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12526*             GO TO 3130-EDIT-AGE
 12527*          END-IF
 12528        END-IF
 12529     END-IF
 12530
 12531     IF (WS-STATE-ABBREVIATION = 'OH')
 12532         AND (PB-I-RATE-CLASS NOT = 'L ')
 12533         AND (PB-I-LF-TERM GREATER THAN 60)
 12534         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12535         GO TO 3129-APR-CONT.
 12536
 12537     IF (WS-STATE-ABBREVIATION = 'RI')
 12538         AND (PB-I-LF-TERM GREATER THAN 60)
 12539         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12540         GO TO 3129-APR-CONT.
 12541
 12542     IF (WS-STATE-ABBREVIATION = 'UT')
 12543         AND (PB-I-LF-TERM GREATER THAN 62)
 12544         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12545         AND (PB-CERT-EFF-DT LESS WS-830901)
 12546         GO TO 3129-APR-CONT.
 12547
 12548     IF PB-COMPANY-ID = 'LAP'
 12549        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12550           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12551              MOVE ER-2656         TO WS-ERROR
 12552              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12553              GO TO 3130-EDIT-AGE.
 12554
 12555     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12556        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12557        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12558        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12559        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12560        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12561         GO TO 3130-EDIT-AGE.
 12562
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 229
* EL050.cbl
 12563 3129-APR-CONT.
 12564     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12565         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12566         GO TO 3130-EDIT-AGE.
 12567
 12568     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12569         WS-AH-BENEFIT-CD (1:1) = 'S')
 12570        AND (PB-COMPANY-ID = 'DCC')
 12571        AND (PB-I-LOAN-APR = ZERO)
 12572        MOVE ER-2657             TO WS-ERROR
 12573        PERFORM 9900-ERROR-FORMAT
 12574                                 THRU 9900-EXIT
 12575        GO TO 3130-EDIT-AGE
 12576     END-IF
 12577*    IF PB-I-LOAN-APR = ZERO
 12578*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12579*    END-IF
 12580
 12581     if pb-i-loan-apr = +99.9999
 12582        move er-2656             to ws-error
 12583        PERFORM 9900-ERROR-FORMAT
 12584                                 THRU 9900-EXIT
 12585        GO TO 3130-EDIT-AGE
 12586     end-if
 12587*    IF PB-I-LOAN-APR = ZERO
 12588*       MOVE ER-2656             TO WS-ERROR
 12589*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12590*       GO TO 3130-EDIT-AGE.
 12591
 12592*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12593     if pb-i-loan-apr not = +99.9999
 12594        IF PB-I-LOAN-APR > +30.000
 12595           MOVE ER-2657          TO WS-ERROR
 12596           PERFORM 9900-ERROR-FORMAT
 12597                                 THRU 9900-EXIT
 12598        end-if
 12599     end-if
 12600     .
 12601 3130-EDIT-AGE.
 12602
 12603******************************************************************
 12604*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12605******************************************************************
 12606
 12607     IF NOT NO-LIFE-COVERAGE
 12608        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12609           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12610               MOVE ER-2628             TO WS-ERROR
 12611               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12612
 12613     IF NOT NO-AH-COVERAGE
 12614        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12615           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12616               MOVE ER-2628         TO WS-ERROR
 12617               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12618
 12619 3133-SEX-CODE.
 12620     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 230
* EL050.cbl
 12621         IF WS-DEFAULT-SEX = 'M'
 12622             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12623          ELSE
 12624             IF WS-DEFAULT-SEX = 'F'
 12625             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12626
 12627     IF PB-I-INSURED-SEX = '1'
 12628         MOVE 'M' TO PB-I-INSURED-SEX.
 12629
 12630     IF PB-I-INSURED-SEX = '2'
 12631         MOVE 'F' TO PB-I-INSURED-SEX.
 12632
 12633 3134-SIG-SW-EDIT.
 12634     IF PB-I-SIG-SW = SPACE
 12635         MOVE 'N'                TO  PB-I-SIG-SW.
 12636
 12637     IF PB-COMPANY-ID = 'NCL'
 12638         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12639             NEXT SENTENCE
 12640         ELSE
 12641             MOVE ER-1923        TO  WS-ERROR
 12642             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12643     ELSE
 12644     IF PB-COMPANY-ID = 'CRI'
 12645         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12646             NEXT SENTENCE
 12647         ELSE
 12648             MOVE ER-2606        TO  WS-ERROR
 12649             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12650     ELSE
 12651     IF PB-COMPANY-ID = 'TMS'
 12652         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12653             NEXT SENTENCE
 12654         ELSE
 12655             MOVE ER-2689        TO  WS-ERROR
 12656             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12657     ELSE
 12658         IF PB-I-SIG-SW = 'Y' OR 'N'
 12659             NEXT SENTENCE
 12660         ELSE
 12661             MOVE ER-2651        TO  WS-ERROR
 12662             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12663
 12664     IF PB-COMPANY-ID = 'FLA'
 12665         IF (WS-EDIT-AGE GREATER 54  OR
 12666             WS-AH-EDIT-AGE GREATER 54)  AND
 12667            PB-I-SIG-SW = 'N'
 12668            MOVE ER-2651         TO  WS-ERROR
 12669            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12670
 12671 3135-NAME-EDIT.
 12672
 12673     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12674        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12675        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12676           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12677                                 TO PB-I-JOINT-FIRST-NAME
 12678        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 231
* EL050.cbl
 12679     END-IF
 12680     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12681        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12682        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12683           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12684                                 TO PB-I-JOINT-LAST-NAME
 12685        END-PERFORM
 12686     END-IF
 12687     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12688        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12689        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12690           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12691                                 TO PB-I-INSURED-FIRST-NAME
 12692        END-PERFORM
 12693     END-IF
 12694     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12695        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12696        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12697           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12698                                 TO PB-I-INSURED-LAST-NAME
 12699        END-PERFORM
 12700     END-IF
 12701     IF PB-I-INSURED-LAST-NAME = SPACES
 12702       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12703       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12704           MOVE ER-2660    TO WS-ERROR
 12705           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12706
 12707 3136-EDIT-SEX.
 12708
 12709******************************************************************
 12710*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12711******************************************************************
 12712
 12713     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12714        (WS-AH-SPECIAL-CALC-CD = 'O')
 12715        NEXT SENTENCE
 12716     ELSE
 12717        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12718           NEXT SENTENCE
 12719        ELSE
 12720           MOVE ER-2629            TO WS-ERROR
 12721           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12722
 12723 3137-EDIT-EFF-DATE.
 12724
 12725     IF PB-REISSUED-CERT       OR
 12726        PB-POLICY-IS-DECLINED  OR
 12727        PB-POLICY-IS-VOIDED
 12728         GO TO 3139-EDIT-COVERAGE-CODES.
 12729
 12730     MOVE SPACE                  TO WS-2671-SW
 12731                                    WS-2672-SW.
 12732
 12733     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12734         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12735             MOVE ER-2703        TO WS-ERROR
 12736             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 232
* EL050.cbl
 12737             GO TO 3139-EDIT-COVERAGE-CODES.
 12738
 12739     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12740         GO TO 3139-EDIT-COVERAGE-CODES.
 12741
 12742     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12743     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12744*    MOVE '1'                    TO DC-OPTION-CODE.
 12745     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12746     MOVE +0                     TO DC-ELAPSED-MONTHS
 12747                                    DC-ELAPSED-DAYS.
 12748     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12749
 12750     IF DATE-CONVERSION-ERROR
 12751         GO TO 3139-EDIT-COVERAGE-CODES.
 12752
 12753     IF DC-ELAPSED-DAYS GREATER +180
 12754         MOVE ER-2672            TO WS-ERROR
 12755         MOVE 'Y'                TO WS-2672-SW
 12756         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12757     END-IF
 12758
 12759     IF WS-ERROR = ER-2671  AND
 12760        PB-COMPANY-ID  = 'LBL'
 12761        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12762        MOVE SPACE               TO WS-2671-SW
 12763        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12764
 12765     IF PB-ISSUE-DATE-FORCED  AND
 12766      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12767         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12768         MOVE ER-2673            TO WS-ERROR
 12769         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12770         MOVE SPACE              TO WS-2671-SW
 12771                                    WS-2672-SW.
 12772
 12773     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12774         IF PB-ISSUE-DATE-FORCED
 12775             MOVE ER-2600          TO  WS-ERROR
 12776             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12777         ELSE
 12778             MOVE ER-2692          TO  WS-ERROR
 12779             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12780
 12781
 12782 3139-EDIT-COVERAGE-CODES.
 12783
 12784     if pb-company-id not = 'AHL'
 12785        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12786           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12787           MOVE ER-2787          TO WS-ERROR
 12788           PERFORM 9900-ERROR-FORMAT
 12789                                 THRU 9900-EXIT
 12790        END-IF
 12791     end-if
 12792     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12793        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12794                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 233
* EL050.cbl
 12795           MOVE ER-2719          TO WS-ERROR
 12796           PERFORM 9900-ERROR-FORMAT
 12797                                 THRU 9900-EXIT
 12798        END-IF
 12799     END-IF
 12800
 12801     IF PB-POLICY-IS-DECLINED  OR
 12802        PB-POLICY-IS-VOIDED
 12803         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12804
 12805     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12806        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12807         MOVE ER-2630                TO WS-ERROR
 12808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12809
 12810     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12811        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12812        PB-I-LF-PREMIUM-AMT = ZERO
 12813         GO TO 3140-CHECK-AH-FOR-ZERO.
 12814
 12815     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12816        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12817        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12818         GO TO 3140-CHECK-AH-FOR-ZERO.
 12819
 12820     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12821        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12822        MOVE ER-2631             TO WS-ERROR
 12823        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12824     END-IF
 12825
 12826
 12827******************************************************************
 12828*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12829******************************************************************
 12830
 12831     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12832        NEXT SENTENCE
 12833     ELSE
 12834        IF PB-I-LF-BENEFIT-AMT = ZERO
 12835           MOVE ER-2632             TO WS-ERROR
 12836           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12837
 12838
 12839******************************************************************
 12840*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12841******************************************************************
 12842
 12843     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12844        CONTINUE
 12845     ELSE
 12846        IF PB-I-LF-PREMIUM-AMT = ZERO
 12847           IF (NOT PB-COMP-LF-PREM)
 12848              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12849              MOVE ER-2633       TO WS-ERROR
 12850              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12851           END-IF
 12852        END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 234
* EL050.cbl
 12853     END-IF
 12854     .
 12855 3140-CHECK-AH-FOR-ZERO.
 12856
 12857     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12858        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12859        PB-I-AH-PREMIUM-AMT = ZERO
 12860         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12861
 12862     IF PB-COMPANY-ID = 'CSL'  AND
 12863        PB-I-AH-BENEFIT-CD = ZERO  AND
 12864        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12865        PB-I-AH-PREMIUM-AMT = ZERO
 12866         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12867
 12868     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12869        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12870        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12871         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12872
 12873     IF PB-I-AH-BENEFIT-CD = ZERO
 12874         MOVE ER-2634            TO WS-ERROR
 12875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12876
 12877******************************************************************
 12878*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12879******************************************************************
 12880
 12881     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12882        NEXT SENTENCE
 12883     ELSE
 12884        IF PB-I-AH-BENEFIT-AMT = ZERO
 12885           MOVE ER-2635             TO WS-ERROR
 12886           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12887
 12888******************************************************************
 12889*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12890******************************************************************
 12891
 12892     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12893        NEXT SENTENCE
 12894     ELSE
 12895        IF PB-I-AH-PREMIUM-AMT = ZERO
 12896            IF NOT PB-COMP-AH-PREM
 12897                MOVE ER-2636    TO WS-ERROR
 12898                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12899
 12900
 12901 3140-EDIT-MAX-AMT-SIZES.
 12902* CUSTOM CODE FOR CLIENT    'DMD'
 12903     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12904                                     WS-RES-MUNI-TAX
 12905                                     PB-I-STATE-TAX
 12906                                     PB-I-MUNI-TAX.
 12907
 12908     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12909
 12910     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 235
* EL050.cbl
 12911        GO TO 3150-RATE-OUTSTAND-BAL.
 12912
 12913     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12914        GO TO 3150-RATE-OUTSTAND-BAL.
 12915
 12916     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12917        GO TO 3150-RATE-OUTSTAND-BAL.
 12918
 12919     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 12920                             OR 'RIC')
 12921        GO TO 3150-RATE-OUTSTAND-BAL.
 12922
 12923     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 12924        IF PB-I-LOAN-APR GREATER THAN ZEROS
 12925            GO TO 3150-RATE-OUTSTAND-BAL
 12926        ELSE
 12927           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 12928               GO TO 3150-RATE-OUTSTAND-BAL.
 12929
 12930     IF NOT PB-NO-MONTHS-SKIPPED
 12931        GO TO 3150-RATE-OUTSTAND-BAL.
 12932
 12933     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 12934        GO TO 3150-RATE-OUTSTAND-BAL.
 12935
 12936     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 12937        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 12938           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 12939             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 12940           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 12941           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 12942              MOVE ER-2693     TO WS-ERROR
 12943              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12944              GO TO 3150-RATE-OUTSTAND-BAL
 12945           ELSE
 12946              GO TO 3150-RATE-OUTSTAND-BAL.
 12947
 12948 3150-RATE-OUTSTAND-BAL.
 12949
 12950* DMD RATING TEST
 12951     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 12952         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 12953         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 12954         MOVE ER-2687                 TO WS-ERROR
 12955         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12956         MOVE 'B'                     TO PB-I-OB-FLAG
 12957         GO TO 3260-EDIT-CONTINUE.
 12958
 12959     IF  PB-COMPANY-ID   EQUAL    'CRI'
 12960         IF  WS-ERROR    EQUAL    ER-2693
 12961             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 12962                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12963                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12964                 MOVE  +0            TO  WS-ERROR.
 12965
 12966     IF  PB-COMPANY-ID   EQUAL    'CDL'
 12967         IF  WS-ERROR    EQUAL    ER-2693
 12968             IF WS-STATE-ABBREVIATION EQUAL 'NC'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 236
* EL050.cbl
 12969                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12970                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12971                 MOVE  +0            TO  WS-ERROR.
 12972
 12973     IF PLAN-MASTER-AH-SW = 'Y'
 12974        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12975            IF  WS-ERROR    EQUAL    ER-2693
 12976              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12977                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12978                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12979                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12980                 MOVE  ER-1910           TO  WS-ERROR
 12981                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12982
 12983     IF PLAN-MASTER-AH-SW = 'Y'
 12984        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12985            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 12986               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 12987               MOVE  ER-1910           TO  WS-ERROR
 12988               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 12989
 12990     IF PLAN-MASTER-AH-SW = 'Y'
 12991        IF  PB-COMPANY-ID   EQUAL    'CRI'
 12992            IF  WS-ERROR    EQUAL    ER-2693
 12993                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 12994                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12995                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 12996                 MOVE  +0       TO  WS-ERROR.
 12997
 12998     IF WS-ERROR = ER-2693
 12999        IF PB-COMPANY-ID = 'JAL' AND
 13000           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13001           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13002           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13003
 13004     IF WS-ERROR = ER-2693
 13005        IF PB-COMPANY-ID = 'NCL'  AND
 13006           PB-I-AH-BENEFIT-CD = 'OA'
 13007           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13008           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13009
 13010     IF WS-ERROR = ER-2693
 13011        IF PB-COMPANY-ID = 'CNL' AND
 13012           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13013           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13014           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13015
 13016     IF WS-ERROR = ER-2693
 13017        IF PB-COMPANY-ID = 'HER'
 13018           IF WS-LEVEL
 13019              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13020              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13021
 13022     IF ((LF-BENEFIT-FOUND) AND
 13023         (NOT NO-LIFE-COVERAGE)  AND
 13024         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13025       OR   ((AH-BENEFIT-FOUND) AND
 13026             (NOT NO-AH-COVERAGE)    AND
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 237
* EL050.cbl
 13027             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13028         NEXT SENTENCE
 13029     ELSE
 13030         GO TO 3215-EDIT-RATES.
 13031
 13032     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13033        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13034           MOVE ER-2674          TO WS-ERROR
 13035           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13036           GO TO 3215-EDIT-RATES.
 13037
 13038     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13039        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13040           MOVE ER-2674          TO WS-ERROR
 13041           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13042           GO TO 3215-EDIT-RATES.
 13043
 13044     MOVE 'B'                    TO PB-I-OB-FLAG.
 13045
 13046     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13047         NEXT SENTENCE
 13048     ELSE
 13049         IF NOT NO-LIFE-COVERAGE
 13050             IF WS-ACCT-LF-OB-RT = ZERO
 13051                MOVE ER-2641    TO WS-ERROR
 13052                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13053
 13054     IF PB-COMPANY-ID = 'CRI'
 13055       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13056         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13057         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13058         IF WS-ERROR = ER-2675
 13059            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13060            MOVE ER-2687              TO WS-ERROR
 13061            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13062         ELSE
 13063            MOVE ER-2687              TO WS-ERROR
 13064            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13065
 13066
 13067     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13068         NEXT SENTENCE
 13069     ELSE
 13070       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13071            NEXT SENTENCE
 13072       ELSE
 13073         IF NOT NO-AH-COVERAGE
 13074             IF WS-ACCT-AH-OB-RT = ZERO
 13075                MOVE ER-2642    TO WS-ERROR
 13076                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13077
 13078     IF PB-COMPANY-ID = 'CRI'
 13079       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13080         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13081         IF WS-ERROR = ER-2676
 13082            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13083            MOVE ER-2687              TO WS-ERROR
 13084            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 238
* EL050.cbl
 13085         ELSE
 13086            MOVE ER-2687              TO WS-ERROR
 13087            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13088
 13089     IF PB-COMPANY-ID NOT = 'GIC'
 13090         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13091            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13092     ELSE
 13093         IF PB-I-LF-PREM-CALC = ZEROS
 13094             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13095                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13096
 13097     IF PB-COMPANY-ID NOT = 'GIC'
 13098         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13099            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13100     ELSE
 13101         IF PB-I-AH-PREM-CALC = ZEROS
 13102             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13103                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13104
 13105     MOVE ZEROS TO PB-I-MORT-CODE.
 13106
 13107     GO TO 3260-EDIT-CONTINUE.
 13108
 13109
 13110 3215-EDIT-RATES.
 13111     IF ACCOUNT-MAST-FOUND
 13112         NEXT SENTENCE
 13113     ELSE
 13114         GO TO 3999-END-EDIT.
 13115
 13116 3220-CHECK-LF-RATES.
 13117
 13118     IF PB-COMPANY-ID = 'DCC'
 13119        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13120        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13121        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13122           AND (NOT WS-LF-CASH))
 13123                           OR
 13124           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13125           AND (NOT WS-AH-CASH)))
 13126                       AND
 13127           (PB-I-ENTRY-STATUS NOT = '5')
 13128           MOVE 'M'              TO PB-BATCH-ENTRY
 13129                                    PB-I-ENTRY-STATUS
 13130        END-IF
 13131     END-IF
 13132     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13133                                    PB-I-AH-PREM-CALC
 13134                                    PB-I-LF-ALT-PREM-CALC
 13135                                    PB-I-LF-ALT-RATE
 13136                                    PB-I-LF-REI-RATE
 13137                                    PB-I-LF-ALT-REI-RATE
 13138                                    PB-I-AH-REI-RATE
 13139                                    PB-I-TOT-FEES-CALC.
 13140
 13141     IF PB-COMPANY-ID EQUAL 'DMD'
 13142        NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 239
* EL050.cbl
 13143     ELSE
 13144        MOVE ZEROS               TO PB-I-LF-RATE
 13145                                    PB-I-AH-RATE.
 13146
 13147     IF PB-I-TOT-FEES NOT NUMERIC
 13148        MOVE ZEROS               TO PB-I-TOT-FEES
 13149     END-IF
 13150     IF PB-I-LIVES NOT NUMERIC
 13151         MOVE ZERO               TO PB-I-LIVES.
 13152
 13153     IF PB-I-NUM-BILLED NOT NUMERIC
 13154         MOVE ZERO               TO PB-I-NUM-BILLED.
 13155
 13156     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13157        MOVE +0                  TO PB-I-LF-PREM-TAX
 13158     END-IF
 13159
 13160     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13161        MOVE +0                  TO PB-I-AH-PREM-TAX
 13162     END-IF
 13163
 13164     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13165        PB-I-PAY-FREQUENCY = ZEROS
 13166            MOVE 12 TO CP-PAY-FREQUENCY
 13167     ELSE
 13168            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13169
 13170     IF PB-I-STATE-TAX NOT NUMERIC
 13171         MOVE ZEROS               TO PB-I-STATE-TAX.
 13172
 13173     IF PB-I-MUNI-TAX NOT NUMERIC
 13174         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13175
 13176     MOVE SPACES                 TO CP-BEN-CATEGORY
 13177     IF PB-COMPANY-ID  = 'CSL'  AND
 13178        PB-I-LF-TERM NOT = ZERO
 13179        COMPUTE WS-PAYMENT-AMT =
 13180             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13181        COMPUTE WS-CSL-AMT1 =
 13182             PB-I-LF-TERM * AM-MAX-MON-BEN
 13183        COMPUTE WS-CSL-AMT2 =
 13184             WS-PAYMENT-AMT * PB-I-LF-TERM
 13185        IF CP-PAY-FREQUENCY NOT = 12
 13186           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13187           MOVE '8' TO WS-CSL-CALC-CD
 13188        ELSE
 13189           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13190              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13191               AM-MAX-TOT-BEN
 13192               MOVE '6' TO WS-CSL-CALC-CD
 13193           ELSE
 13194              IF (WS-CSL-AMT1  GREATER THAN
 13195                 AM-MAX-TOT-BEN) AND
 13196                 (WS-CSL-AMT2  GREATER THAN
 13197                 AM-MAX-TOT-BEN)
 13198                 MOVE '7' TO WS-CSL-CALC-CD
 13199              ELSE
 13200                 MOVE '5' TO WS-CSL-CALC-CD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 240
* EL050.cbl
 13201
 13202     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13203         NEXT SENTENCE
 13204     ELSE
 13205         GO TO 3300-CHECK-AH-RATES.
 13206
 13207*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13208
 13209     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13210        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13211              OR
 13212           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13213           MOVE ER-2618          TO WS-ERROR
 13214           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13215           GO TO 3300-CHECK-AH-RATES.
 13216
 13217     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13218           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13219                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13220
 13221     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13222         MOVE ER-2687             TO WS-ERROR
 13223         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13224         MOVE 'Z000'              TO PB-I-MORT-CODE
 13225         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13226         GO TO 3300-CHECK-AH-RATES.
 13227
 13228     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13229        IF PB-I-LIVES = ZERO
 13230           MOVE ER-2688          TO WS-ERROR
 13231           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13232
 13233     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13234
 13235     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13236     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13237     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13238     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13239     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13240     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13241     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13242     MOVE '3'                    TO CP-PROCESS-TYPE.
 13243     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13244     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13245
 13246******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13247     IF PB-COMPANY-ID EQUAL 'CDL'
 13248         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13249            CP-EARN-AS-NET-PAY)
 13250             IF PB-CERT-EFF-DT GREATER  WS-931231
 13251                 MOVE '1'        TO CP-EARNING-METHOD.
 13252*******
 13253
 13254     MOVE PB-SV-STATE            TO CP-STATE.
 13255     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13256     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13257     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 13258     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 241
* EL050.cbl
 13259     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13260                                    CP-RATING-BENEFIT-AMT.
 13261     IF CP-STATE-STD-ABBRV = 'OR'
 13262         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13263                                         PB-I-LF-ALT-BENEFIT-AMT.
 13264     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13265     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13266     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13267     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13268     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13269     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13270     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13271     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13272     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13273                                    CP-REMAINING-TERM
 13274                                    CP-LOAN-TERM.
 13275
 13276     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13277         NEXT SENTENCE
 13278     ELSE
 13279         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13280             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13281                                           PB-I-LF-PREMIUM-AMT.
 13282
 13283     IF PB-COMPANY-ID EQUAL 'CSL'
 13284        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13285           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13286                                         PB-I-LF-PREMIUM-AMT.
 13287
 13288     IF PB-COMPANY-ID EQUAL 'NCB'
 13289         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13290            CP-EARN-AS-NET-PAY
 13291             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13292                 PB-I-LF-PREMIUM-AMT.
 13293
 13294     IF (CP-TRUNCATED-LIFE)
 13295        or ((pb-company-id = 'AHL')
 13296           and (pb-i-loan-term > pb-i-lf-term))
 13297        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13298
 13299     IF PB-COMPANY-ID EQUAL 'CRI'
 13300        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13301
 13302     IF CP-TERM-IS-DAYS
 13303         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13304     ELSE
 13305         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13306     IF PB-COMPANY-ID = 'DCC'
 13307        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13308        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13309        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13310        IF WS-LF-BEN-CATEGORY = 'D'
 13311           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13312           MOVE PB-I-LIFE-COMMISSION
 13313                                 TO CP-DCC-ACT-COMM
 13314           MOVE WS-LF-BEN-CATEGORY
 13315                                 TO CP-BEN-CATEGORY
 13316        END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 242
* EL050.cbl
 13317        IF (CP-BENEFIT-CD (1:1) = 'P')
 13318           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13319           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13320           add pb-i-ah-premium-amt to cp-original-premium
 13321        END-IF
 13322     END-IF
 13323     IF PB-COMPANY-ID = 'CSL'
 13324         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13325         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13326         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13327
 13328     IF PB-COMPANY-ID = 'CSL'
 13329        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13330
 13331     IF (CP-SPECIAL-CALC-CD = 'H')
 13332        OR (PB-COMPANY-ID = 'DCC')
 13333         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13334                                    TO CP-ALTERNATE-BENEFIT
 13335         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13336
 13337     IF (PB-COMPANY-ID = 'CID')
 13338        AND (WS-LF-EARNINGS-CALC = 'B')
 13339        AND (CP-STATE-STD-ABBRV = 'MN')
 13340        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13341                                 TO CP-ALTERNATE-BENEFIT
 13342        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13343     END-IF
 13344     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13345     MOVE 'R'                   TO CP-RATE-FILE.
 13346     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13347
 13348     IF CP-ERROR-RATE-NOT-FOUND
 13349        MOVE ER-2641            TO WS-ERROR
 13350        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13351        GO TO 3300-CHECK-AH-RATES.
 13352
 13353     IF PB-COMPANY-ID EQUAL 'CRI'
 13354        IF CP-ERROR-NO-LIMITS-CRI
 13355           IF NOT ACCOUNT-LIFE-CHECKED
 13356              MOVE ER-2607      TO WS-ERROR
 13357              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13358
 13359******************************************************************
 13360*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13361*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13362******************************************************************
 13363
 13364* CALC LIFE AGE AT EXPIRATION.
 13365
 13366     COMPUTE WS-AGE-AT-EXPIRE =
 13367          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13368
 13369*    IF PB-STATE = 'CO' OR 'UT'
 13370*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13371*        MOVE 'F'            TO PB-FATAL-FLAG
 13372*        MOVE ER-2709        TO WS-ERROR
 13373*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13374*        GO TO PREMIUM-EDITING-IS-BYPASSED.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 243
* EL050.cbl
 13375
 13376*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13377*        MOVE 'X'            TO PB-FATAL-FLAG
 13378*        MOVE ER-2718        TO WS-ERROR
 13379*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13380*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13381
 13382* CALC A & H AGE AT EXPIRATION.
 13383
 13384     COMPUTE WS-AGE-AT-EXPIRE =
 13385          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13386
 13387*    IF PB-STATE = 'CO' OR 'UT'
 13388*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13389*        MOVE 'F'            TO PB-FATAL-FLAG
 13390*        MOVE ER-2709        TO WS-ERROR
 13391*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13392*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13393
 13394*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13395*        MOVE 'X'            TO PB-FATAL-FLAG
 13396*        MOVE ER-2718        TO WS-ERROR
 13397*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13398*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13399
 13400     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13401        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13402
 13403     IF WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z'
 13404        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13405     end-if
 13406
 13407     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13408        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13409
 13410     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13411         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13412         MOVE ER-2639        TO WS-ERROR
 13413         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13414
 13415
 13416******************************************************************
 13417*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13418******************************************************************
 13419
 13420 PREMIUM-EDITING-IS-BYPASSED.
 13421     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13422        AND (CP-R-MAX-ATT-AGE > +0)
 13423        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13424        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13425           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13426           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13427           MOVE '1'              TO DC-OPTION-CODE
 13428           PERFORM 8500-DATE-CONVERT
 13429                                 THRU 8500-EXIT
 13430           IF NO-CONVERSION-ERROR
 13431              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13432                 MOVE ER-2661       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 244
* EL050.cbl
 13433*                PERFORM 9900-ERROR-FORMAT
 13434*                                THRU 9900-EXIT
 13435              END-IF
 13436           END-IF
 13437        ELSE
 13438           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13439           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13440              MOVE ER-2661       TO WS-ERROR
 13441*             PERFORM 9900-ERROR-FORMAT
 13442*                                THRU 9900-EXIT
 13443           ELSE
 13444              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13445                 MOVE ER-1570    TO WS-ERROR
 13446                 PERFORM 9900-ERROR-FORMAT
 13447                                 THRU 9900-EXIT
 13448              END-IF
 13449           END-IF
 13450        END-IF
 13451        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13452           MOVE PB-I-JOINT-BIRTHDAY
 13453                                 TO DC-BIN-DATE-1
 13454           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13455           MOVE '1'              TO DC-OPTION-CODE
 13456           PERFORM 8500-DATE-CONVERT
 13457                                 THRU 8500-EXIT
 13458           IF NO-CONVERSION-ERROR
 13459              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13460                 MOVE ER-2661       TO WS-ERROR
 13461*                PERFORM 9900-ERROR-FORMAT
 13462*                                THRU 9900-EXIT
 13463              END-IF
 13464           ELSE
 13465              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13466           END-IF
 13467        ELSE
 13468           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13469             (PB-I-LF-TERM / 12)
 13470           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13471              MOVE ER-2661       TO WS-ERROR
 13472*             PERFORM 9900-ERROR-FORMAT
 13473*                                THRU 9900-EXIT
 13474           ELSE
 13475              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13476                 MOVE ER-1571    TO WS-ERROR
 13477                 PERFORM 9900-ERROR-FORMAT
 13478                                 THRU 9900-EXIT
 13479              END-IF
 13480           END-IF
 13481        END-IF
 13482        IF WS-ERROR = ER-2661
 13483           PERFORM 9900-ERROR-FORMAT
 13484                                 THRU 9900-EXIT
 13485        END-IF
 13486     END-IF
 13487*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13488*       MOVE ER-2661             TO WS-ERROR
 13489*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13490
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 245
* EL050.cbl
 13491     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13492        MOVE ER-2662             TO WS-ERROR
 13493        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13494
 13495     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13496        MOVE ER-2677             TO WS-ERROR
 13497        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13498
 13499     IF CP-ERROR-LOAN-TERM
 13500        MOVE ER-2648             TO WS-ERROR
 13501        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13502
 13503 3221-CHECK-ERROR-RATE-OPEN.
 13504
 13505     IF CP-ERROR-RATE-FILE-NOTOPEN
 13506         GO TO 3990-FILES-NOT-OPEN.
 13507
 13508     IF PB-COMPANY-ID NOT = 'DMD'
 13509        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13510     END-IF
 13511     .
 13512 3221-CONTINUE.
 13513     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13514                                    WS-DCC-AH-RATE
 13515     IF PB-COMPANY-ID = 'DCC'
 13516        IF WS-LF-BEN-CATEGORY = 'D'
 13517           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13518              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13519        END-IF
 13520     END-IF
 13521     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13522*   X'A4FF' = 12/31/2009
 13523     IF (PB-COMPANY-ID = 'CID')
 13524        AND (WS-LF-EARNINGS-CALC = 'B')
 13525        AND (CP-STATE-STD-ABBRV = 'MN')
 13526        AND (PB-CERT-EFF-DT > X'A4FF')
 13527        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13528     END-IF
 13529     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13530
 13531     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13532     IF (PB-COMPANY-ID = 'DCC')
 13533        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13534        AND (PB-I-POLICY-IS-MONTHLY)
 13535        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13536        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13537     END-IF
 13538     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13539     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13540     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13541     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13542     IF (PB-COMPANY-ID = 'DCC')
 13543        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13544        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13545        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13546        MOVE ER-2786             TO WS-ERROR
 13547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13548     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 246
* EL050.cbl
 13549
 13550     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13551
 13552******************************************************************
 13553*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13554******************************************************************
 13555     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13556        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13557
 13558     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13559        GO TO 3225-CHECK-ALT-LIFE-RATE
 13560     ELSE
 13561       IF PB-I-LF-RATE = ZERO
 13562          MOVE ER-2641          TO WS-ERROR
 13563          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13564
 13565 3225-CHECK-ALT-LIFE-RATE.
 13566
 13567     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13568        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13569        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13570         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13571
 13572     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13573         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13574             AND PB-COMPANY-ID NOT = 'DCC')
 13575                   OR
 13576              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13577              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13578              AND PB-COMPANY-ID NOT = 'DCC')
 13579             MOVE ER-2720        TO  WS-ERROR
 13580             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13581             GO TO 3225-RATING-CONT
 13582         ELSE
 13583             GO TO 3225-RATING-CONT.
 13584     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13585        AND (AM-GPCD = 01 OR 06 OR 15)
 13586        MOVE ER-2798             TO WS-ERROR
 13587        PERFORM 9900-ERROR-FORMAT
 13588                                 THRU 9900-EXIT
 13589*       GO TO 3225-RATING-CONT
 13590     END-IF
 13591     IF (PB-COMPANY-ID = 'CID')
 13592        AND (WS-LF-EARNINGS-CALC = 'B')
 13593        AND (CP-STATE-STD-ABBRV = 'MN')
 13594        AND (PB-CERT-EFF-DT > X'A4FF')
 13595        GO TO 3225-RATING-CONT
 13596     END-IF
 13597     IF PB-COMPANY-ID = 'DCC'
 13598        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13599           AND (PB-I-POLICY-IS-MONTHLY)
 13600           GO TO 3225-RATING-CONT
 13601        END-IF
 13602     END-IF
 13603
 13604     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13605        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13606        CP-EARN-AS-REG-BALLOON
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 247
* EL050.cbl
 13607        NEXT SENTENCE
 13608     ELSE
 13609        MOVE '2'                 TO CP-EARNING-METHOD.
 13610
 13611 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13612
 13613     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13614
 13615     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13616        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13617        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13618         NEXT SENTENCE
 13619     ELSE
 13620         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13621
 13622     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13623     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13624     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13625                                     CP-RATING-BENEFIT-AMT.
 13626     IF CP-STATE-STD-ABBRV = 'OR'
 13627         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13628                                         PB-I-LF-ALT-BENEFIT-AMT.
 13629     IF PB-COMPANY-ID = 'DCC'
 13630        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13631     END-IF
 13632     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13633     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13634     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13635                                    CP-REMAINING-TERM
 13636                                    CP-LOAN-TERM.
 13637     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13638        ADD +1                   TO CP-ORIGINAL-TERM
 13639                                    CP-REMAINING-TERM
 13640                                    CP-LOAN-TERM.
 13641
 13642     MOVE 'R'                   TO CP-RATE-FILE.
 13643     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13644
 13645     IF CP-ERROR-RATE-NOT-FOUND
 13646         MOVE ER-2641            TO WS-ERROR
 13647         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13648         GO TO 3300-CHECK-AH-RATES.
 13649
 13650     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13651     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13652
 13653     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13654         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13655
 13656     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13657                               + PB-I-LF-ALT-BENEFIT-AMT.
 13658
 13659     IF ACCOUNT-LIFE-CHECKED  OR
 13660        PB-POLICY-IS-VOIDED   OR
 13661        (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13662        GO TO 3225-CONTINUE.
 13663
 13664     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 248
* EL050.cbl
 13665        GO TO 3225-CONTINUE.
 13666
 13667     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13668                             EC-RT-LF-MAX-TOT-BEN
 13669        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13670        MOVE ER-2639       TO WS-ERROR
 13671        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13672
 13673 3225-CONTINUE.
 13674     IF PB-I-LF-ALT-RATE = ZERO
 13675         MOVE ER-2659            TO WS-ERROR
 13676         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13677
 13678     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13679        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13680        MOVE ER-2698             TO WS-ERROR
 13681        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13682
 13683 3225-RATING-CONT.
 13684
 13685     IF WS-LF-SPECIAL-CALC-CD = 'E'
 13686         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13687         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13688         IF (PB-COMPANY-ID = 'DCC')
 13689            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13690            CONTINUE
 13691         ELSE
 13692            MOVE ER-2687         TO WS-ERROR
 13693            PERFORM 9900-ERROR-FORMAT
 13694                                 THRU 9900-EXIT
 13695         END-IF
 13696         GO TO 3290-EDIT-LF-REIN-RATE
 13697     END-IF
 13698
 13699* DMD RATING TEST
 13700     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13701         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13702         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13703         MOVE ER-2687                 TO WS-ERROR
 13704         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13705         GO TO 3290-EDIT-LF-REIN-RATE.
 13706
 13707 3230-CLIENT-MORT-CD-SPECIALS.
 13708
 13709     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13710     SET BIN-TO-GREG          TO TRUE.
 13711*    MOVE ' '                 TO DC-OPTION-CODE.
 13712     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13713     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13714
 13715 C-POS-3230-MORT-CD.
 13716     IF PB-COMPANY-ID = 'POS' AND
 13717        PB-SV-CARRIER = '2'
 13718         NEXT SENTENCE
 13719     ELSE
 13720         GO TO C-POS-3240-MORT-CD.
 13721
 13722     IF PB-SV-GROUPING = '030'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 249
* EL050.cbl
 13723        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13724         MOVE '2350' TO PB-I-MORT-CODE
 13725      ELSE
 13726         MOVE '3300' TO PB-I-MORT-CODE.
 13727
 13728
 13729 C-POS-3240-MORT-CD.
 13730     IF PB-COMPANY-ID = 'POS' AND
 13731        PB-SV-CARRIER = '1'
 13732         NEXT SENTENCE
 13733     ELSE
 13734         GO TO 3230-CONTINUE.
 13735
 13736     IF PB-SV-STATE = '45' OR '47'
 13737        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13738         MOVE '5200' TO PB-I-MORT-CODE
 13739     ELSE
 13740         MOVE '8300' TO PB-I-MORT-CODE.
 13741
 13742 3230-CONTINUE.
 13743
 13744     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13745        GO TO 3240-CONTINUE
 13746     END-IF
 13747
 13748     IF PB-CERT-EFF-DT > WS-971231
 13749        GO TO 3240-CONTINUE
 13750     END-IF
 13751
 13752     IF LF-BENEFIT-FOUND AND
 13753        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13754         MOVE 'F250'       TO PB-I-MORT-CODE
 13755     ELSE
 13756         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13757             MOVE '7250'   TO PB-I-MORT-CODE
 13758         ELSE
 13759             MOVE '4251'   TO PB-I-MORT-CODE
 13760         END-IF
 13761     END-IF
 13762
 13763     .
 13764 3240-CONTINUE.
 13765
 13766     IF PB-COMPANY-ID NOT = 'GNL'
 13767         GO TO 3256-CONTINUE.
 13768
 13769     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13770         MOVE 'A300' TO PB-I-MORT-CODE
 13771     ELSE
 13772         MOVE '8350' TO PB-I-MORT-CODE.
 13773
 13774 3256-CONTINUE.
 13775     IF PB-COMPANY-ID NOT = 'ABL'
 13776         GO TO 3260-EDIT-CONTINUE.
 13777
 13778     IF PB-I-LF-TERM GREATER THAN 59
 13779         MOVE 'F550' TO PB-I-MORT-CODE
 13780     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 250
* EL050.cbl
 13781         MOVE 'E550' TO PB-I-MORT-CODE.
 13782
 13783 3260-EDIT-CONTINUE.
 13784     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13785
 13786 3290-EDIT-LF-REIN-RATE.
 13787     IF LF-REIN-NSP-NOT-USED
 13788         GO TO 3290-RATING-CONT.
 13789
 13790     IF PB-COMPANY-ID = 'DCC'
 13791        GO TO 3290-RATING-CONT.
 13792     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13793     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13794     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13795     MOVE '3'                   TO CP-PROCESS-TYPE.
 13796     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13797
 13798******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13799     IF PB-COMPANY-ID EQUAL 'CDL'
 13800         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13801            CP-EARN-AS-NET-PAY)
 13802             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13803*            MOVE SPACE          TO DC-OPTION-CODE
 13804             SET BIN-TO-GREG     TO TRUE
 13805             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13806***  Y2K PROJ 7744
 13807             IF DC-GREG-DATE-CYMD GREATER 19931231
 13808                 MOVE '1'        TO CP-EARNING-METHOD.
 13809***  Y2K PROJ 7744
 13810*******
 13811
 13812     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13813     MOVE PB-SV-STATE           TO CP-STATE.
 13814     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13815     MOVE ZERO                  TO CP-DEVIATION-CODE
 13816                                   CP-RATE-DEV-PCT.
 13817     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13818     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13819                                   CP-RATING-BENEFIT-AMT.
 13820
 13821************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13822     IF PB-COMPANY-ID EQUAL 'NCB'
 13823         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13824            CP-EARN-AS-NET-PAY
 13825             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13826                 PB-I-LF-PREMIUM-AMT.
 13827************
 13828
 13829     IF CP-STATE-STD-ABBRV = 'OR'
 13830         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13831                                         PB-I-LF-ALT-BENEFIT-AMT.
 13832     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13833     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13834     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13835     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13836     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13837     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13838     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 251
* EL050.cbl
 13839     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13840                                   CP-REMAINING-TERM
 13841                                   CP-LOAN-TERM.
 13842     IF CP-TRUNCATED-LIFE
 13843        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13844
 13845     IF CP-TERM-IS-DAYS
 13846         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13847     ELSE
 13848         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13849
 13850     IF PB-COMPANY-ID = 'DCC'
 13851        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13852     END-IF
 13853     IF PB-COMPANY-ID NOT = 'TIC'
 13854          MOVE ZERO          TO CP-CLASS-CODE.
 13855
 13856     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13857
 13858     MOVE 'R'                   TO CP-RATE-FILE.
 13859     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13860
 13861     IF CP-ERROR-RATE-NOT-FOUND
 13862        IF PB-I-OB
 13863           MOVE ER-2625      TO WS-ERROR
 13864           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13865           GO TO 3299-EDIT-CONTINUE
 13866        ELSE
 13867           MOVE ER-2643      TO WS-ERROR
 13868           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13869           GO TO 3299-EDIT-CONTINUE.
 13870
 13871     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13872
 13873     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13874     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13875
 13876     IF PB-I-LF-REI-RATE = ZERO
 13877         MOVE ER-2643        TO WS-ERROR
 13878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13879
 13880 3290-CHECK-ALT-REIN-RATE.
 13881
 13882     IF WS-LF-EARNINGS-CALC NOT = 'B'
 13883        GO TO 3290-RATING-CONT.
 13884
 13885     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13886     MOVE '2'                    TO CP-EARNING-METHOD.
 13887     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 13888     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13889     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13890     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13891                                     CP-RATING-BENEFIT-AMT.
 13892     IF CP-STATE-STD-ABBRV = 'OR'
 13893         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13894                                         PB-I-LF-ALT-BENEFIT-AMT.
 13895     IF PB-COMPANY-ID = 'DCC'
 13896        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 252
* EL050.cbl
 13897     END-IF
 13898     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13899     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13900     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13901                                    CP-REMAINING-TERM
 13902                                    CP-LOAN-TERM.
 13903     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13904        ADD +1                   TO CP-ORIGINAL-TERM
 13905                                    CP-REMAINING-TERM
 13906                                    CP-LOAN-TERM.
 13907
 13908     MOVE 'R'                   TO CP-RATE-FILE.
 13909     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13910
 13911     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 13912
 13913     IF PB-I-LF-ALT-REI-RATE = ZERO
 13914         MOVE ER-2643            TO WS-ERROR
 13915         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13916
 13917 3290-RATING-CONT.
 13918
 13919     IF PB-I-OB
 13920*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13921        GO TO 3300-CHECK-AH-RATES.
 13922
 13923 3299-EDIT-CONTINUE.
 13924
 13925     IF  PB-I-MORT-CODE GREATER THAN SPACES
 13926         NEXT SENTENCE
 13927     ELSE
 13928         MOVE ER-2620           TO WS-ERROR
 13929         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13930
 13931 3300-CHECK-AH-RATES.
 13932     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 13933         NEXT SENTENCE
 13934     ELSE
 13935         GO TO 3340-CALCULATE-PREMIUM-AMT.
 13936
 13937     IF (WS-AH-SPECIAL-CALC-CD = 'E')   OR
 13938        ((CF-COMPANY-ID = 'DMD') AND
 13939                (NO-DMD-RATING))
 13940         IF (PB-COMPANY-ID = 'DCC')
 13941            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13942            CONTINUE
 13943         ELSE
 13944            MOVE ER-2687         TO WS-ERROR
 13945            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13946         END-IF
 13947         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13948         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 13949     END-IF
 13950
 13951     IF PB-I-OB
 13952        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 13953
 13954     IF WS-AH-SPECIAL-CALC-CD = 'M'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 253
* EL050.cbl
 13955         MOVE ER-2687             TO WS-ERROR
 13956         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13957         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 13958         GO TO 3999-END-EDIT.
 13959
 13960*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 13961     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 13962        IF PB-I-AH-CRIT-PER = ZERO
 13963           IF PB-COMPANY-ID = 'DCC'
 13964              AND AM-DCC-PRODUCT-CODE = 'DDF'
 13965              CONTINUE
 13966           ELSE
 13967              MOVE ER-2618       TO WS-ERROR
 13968              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13969              GO TO 3999-END-EDIT
 13970           END-IF
 13971        END-IF
 13972     END-IF
 13973     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13974     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13975     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13976     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13977     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13978     MOVE PB-SV-STATE            TO CP-STATE.
 13979     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13980     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 13981     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 13982*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 13983     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 13984     MOVE '3'                    TO CP-PROCESS-TYPE.
 13985     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 13986     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13987                                    CP-RATING-BENEFIT-AMT.
 13988     IF PB-COMPANY-ID = 'CID'
 13989               OR
 13990        CP-STATE-STD-ABBRV = 'OR'
 13991         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 13992                                         PB-I-AH-TERM.
 13993     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 13994        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 13995           AND (PB-I-POLICY-IS-MONTHLY)
 13996           MOVE PB-I-LF-BENEFIT-AMT
 13997                                 TO CP-NET-BENEFIT-AMT
 13998           move pb-i-ah-premium-amt to cp-original-premium
 13999           add pb-i-lf-premium-amt to cp-original-premium
 14000        END-IF
 14001     END-IF
 14002     MOVE SPACES                 TO CP-BEN-CATEGORY
 14003     IF PB-COMPANY-ID = 'DCC'
 14004        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14005        EVALUATE TRUE
 14006           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14007              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14008              MOVE PB-I-LF-BENEFIT-AMT
 14009                                 TO CP-RATING-BENEFIT-AMT
 14010              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14011           WHEN WS-AH-BEN-CATEGORY = 'G'
 14012              MOVE PB-I-UNPAID-CASH-PRICE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 254
* EL050.cbl
 14013                                 TO CP-RATING-BENEFIT-AMT
 14014           WHEN WS-AH-BEN-CATEGORY = 'D'
 14015              MOVE WS-AH-PMF-COMM
 14016                                 TO CP-DCC-PMF-COMM
 14017              MOVE PB-I-AH-COMMISSION
 14018                                 TO CP-DCC-ACT-COMM
 14019        END-EVALUATE
 14020     END-IF
 14021     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14022     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14023     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14024     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14025     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14026     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14027     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14028                                    CP-REMAINING-TERM
 14029                                    WS-WORK-TERM.
 14030     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14031
 14032     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14033     SET BIN-TO-GREG             TO TRUE.
 14034*    MOVE ' '                    TO DC-OPTION-CODE.
 14035     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14036     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14037
 14038     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14039     IF NOT VALID-SKIP-CODE
 14040         MOVE ER-2683            TO WS-ERROR
 14041         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14042         GO TO 3320-RATE-CONTINUE.
 14043
 14044     IF PB-NO-MONTHS-SKIPPED
 14045         GO TO 3320-RATE-CONTINUE.
 14046
 14047     MOVE SPACE TO NUMBER-OF-MONTHS.
 14048
 14049     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14050         MOVE 'S'                TO SK-MO (6).
 14051     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14052         MOVE 'S'                TO SK-MO (7).
 14053     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14054         MOVE 'S'                TO SK-MO (8).
 14055     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14056         MOVE 'S'                TO SK-MO (9).
 14057     IF PB-I-SKIP-CODE = 'A'
 14058         MOVE 'S'                TO SK-MO (10).
 14059
 14060     MOVE 1                      TO SUB2.
 14061     MOVE PB-I-AH-TERM           TO SUB3.
 14062     MOVE WS-MONTH               TO SUB1.
 14063     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14064     GO TO 3320-RATE-CONTINUE.
 14065
 14066 3310-GET-SKIP-MO.
 14067     IF SUB1 = 13
 14068         MOVE 1                  TO SUB1.
 14069
 14070     IF SK-MO (SUB1) = 'S'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 255
* EL050.cbl
 14071         SUBTRACT 1 FROM WS-WORK-TERM.
 14072
 14073     ADD 1 TO SUB2
 14074              SUB1.
 14075
 14076 3320-RATE-CONTINUE.
 14077
 14078     IF WS-WORK-TERM = ZERO
 14079         MOVE 1                  TO WS-WORK-TERM.
 14080
 14081     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14082                                    CP-LOAN-TERM.
 14083
 14084     IF PB-COMPANY-ID EQUAL 'DMD'
 14085         NEXT SENTENCE
 14086     ELSE
 14087         MOVE ZERO               TO PB-I-AH-RATE
 14088                                    PB-I-AH-REI-RATE.
 14089
 14090
 14091     IF PB-COMPANY-ID EQUAL 'CRI'
 14092        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14093
 14094     IF PB-COMPANY-ID = 'CSL'
 14095         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14096         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14097         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14098         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14099
 14100     IF PB-COMPANY-ID = 'DCC'
 14101        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14102           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14103              PB-I-RATE-DEV-PCT-LF
 14104        END-IF
 14105        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14106                                 TO CP-ALTERNATE-BENEFIT
 14107        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14108        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14109        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14110     END-IF
 14111     IF (PB-COMPANY-ID = 'CID')
 14112        AND (WS-LF-EARNINGS-CALC = 'B')
 14113        AND (CP-STATE-STD-ABBRV = 'MN')
 14114        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14115     ELSE
 14116        MOVE ' '                 TO CP-AH-BALLOON-SW
 14117     END-IF
 14118     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14119     MOVE 'R'                   TO CP-RATE-FILE.
 14120     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14121
 14122     IF CP-ERROR-RATE-NOT-FOUND
 14123        IF PB-I-OB
 14124           MOVE ER-2624          TO WS-ERROR
 14125           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14126           GO TO 3340-CALCULATE-PREMIUM-AMT
 14127        ELSE
 14128          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 256
* EL050.cbl
 14129              NEXT SENTENCE
 14130          ELSE
 14131           MOVE ER-2642          TO WS-ERROR
 14132           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14133           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14134
 14135     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14136        CP-ERROR-DIV-BY-ZERO
 14137           MOVE ER-3782          TO WS-ERROR
 14138           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14139
 14140     IF PB-COMPANY-ID EQUAL 'CRI'
 14141        IF CP-ERROR-NO-LIMITS-CRI
 14142           IF NOT ACCOUNT-AH-CHECKED
 14143              MOVE ER-2607          TO WS-ERROR
 14144              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14145
 14146     IF ACCOUNT-AH-CHECKED
 14147        NEXT SENTENCE
 14148     ELSE
 14149       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14150          MOVE ER-2640           TO WS-ERROR
 14151          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14152
 14153     IF PB-COMPANY-ID = 'CRI'
 14154         IF WS-ERROR = ER-2640
 14155             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14156     IF ACCOUNT-AH-CHECKED
 14157        CONTINUE
 14158     ELSE
 14159        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14160           AND (CP-R-MAX-ATT-AGE > +0)
 14161           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14162           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14163              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14164              MOVE PB-I-AH-EXPIRE-DT
 14165                                 TO DC-BIN-DATE-2
 14166              MOVE '1'           TO DC-OPTION-CODE
 14167              PERFORM 8500-DATE-CONVERT
 14168                                 THRU 8500-EXIT
 14169              IF NO-CONVERSION-ERROR
 14170                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14171                    MOVE ER-2661       TO WS-ERROR
 14172*                   PERFORM 9900-ERROR-FORMAT
 14173*                                THRU 9900-EXIT
 14174                 END-IF
 14175              END-IF
 14176           ELSE
 14177              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14178              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14179                 MOVE ER-2661    TO WS-ERROR
 14180*                PERFORM 9900-ERROR-FORMAT
 14181*                                THRU 9900-EXIT
 14182              ELSE
 14183                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14184                    MOVE ER-1570 TO WS-ERROR
 14185                    PERFORM 9900-ERROR-FORMAT
 14186                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 257
* EL050.cbl
 14187                 END-IF
 14188              END-IF
 14189           END-IF
 14190           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14191              MOVE PB-I-JOINT-BIRTHDAY
 14192                                    TO DC-BIN-DATE-1
 14193              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14194              MOVE '1'              TO DC-OPTION-CODE
 14195              PERFORM 8500-DATE-CONVERT
 14196                                    THRU 8500-EXIT
 14197              IF NO-CONVERSION-ERROR
 14198                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14199                    MOVE ER-2661       TO WS-ERROR
 14200*                   PERFORM 9900-ERROR-FORMAT
 14201*                                   THRU 9900-EXIT
 14202                 END-IF
 14203              END-IF
 14204           ELSE
 14205              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14206                (PB-I-AH-TERM / 12)
 14207              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14208                 MOVE ER-2661       TO WS-ERROR
 14209*                PERFORM 9900-ERROR-FORMAT
 14210*                                   THRU 9900-EXIT
 14211              ELSE
 14212                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14213                    MOVE ER-1571 TO WS-ERROR
 14214                    PERFORM 9900-ERROR-FORMAT
 14215                                 THRU 9900-EXIT
 14216                 END-IF
 14217              END-IF
 14218           END-IF
 14219           IF WS-ERROR = ER-2661
 14220              PERFORM 9900-ERROR-FORMAT
 14221                                    THRU 9900-EXIT
 14222           END-IF
 14223        END-IF
 14224     END-IF
 14225*    IF ACCOUNT-AH-CHECKED
 14226*       NEXT SENTENCE
 14227*    ELSE
 14228*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14229*          MOVE ER-2661          TO WS-ERROR
 14230*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14231
 14232     IF ACCOUNT-AH-CHECKED
 14233        NEXT SENTENCE
 14234     ELSE
 14235        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14236           MOVE ER-2663          TO WS-ERROR
 14237           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14238
 14239     IF ACCOUNT-AH-CHECKED OR
 14240        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14241         PB-POLICY-IS-VOIDED
 14242        NEXT SENTENCE
 14243     ELSE
 14244        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 258
* EL050.cbl
 14245           MOVE ER-2667            TO WS-ERROR
 14246           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14247
 14248     IF PB-COMPANY-ID = 'CRI'
 14249         IF WS-ERROR = ER-2667
 14250             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14251
 14252     IF ACCOUNT-AH-CHECKED
 14253        NEXT SENTENCE
 14254     ELSE
 14255        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14256           MOVE ER-2678            TO WS-ERROR
 14257           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14258
 14259     IF CP-ERROR-RATE-FILE-NOTOPEN
 14260         GO TO 3990-FILES-NOT-OPEN.
 14261
 14262 3321-CONTINUE.
 14263     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14264     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14265     IF (PB-COMPANY-ID = 'DCC')
 14266        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14267        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14268                                    PB-I-LF-ALT-PREM-CALC
 14269        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14270        IF WS-AH-BEN-CATEGORY = 'G'
 14271           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14272           + PB-I-ADDL-CLP)
 14273           * (1 + WS-TOL-CLP-PCT)
 14274*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14275        ELSE
 14276           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14277           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14278*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14279        END-IF
 14280        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14281                                 TO PB-I-AH-PREM-CALC
 14282        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14283           MOVE ER-8152          TO WS-ERROR
 14284           PERFORM 9900-ERROR-FORMAT
 14285                                 THRU 9900-EXIT
 14286        ELSE
 14287           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14288                 PB-I-ADDL-CLP)
 14289              MOVE ER-8148       TO WS-ERROR
 14290              PERFORM 9900-ERROR-FORMAT
 14291                                 THRU 9900-EXIT
 14292           END-IF
 14293        END-IF
 14294     END-IF
 14295     IF (PB-COMPANY-ID = 'DCC')
 14296        AND (PB-I-POLICY-IS-MONTHLY)
 14297        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14298        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14299        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14300           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14301        END-IF
 14302     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 259
* EL050.cbl
 14303     IF (PB-COMPANY-ID = 'DCC')
 14304        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14305        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14306        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14307        MOVE ER-2786             TO WS-ERROR
 14308        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14309     END-IF
 14310     MOVE +0                     TO PB-I-AH-CLP
 14311     IF PB-COMPANY-ID = 'DCC'
 14312        IF WS-AH-BEN-CATEGORY = 'D'
 14313           COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT *
 14314              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14315        ELSE
 14316           IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14317              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14318           END-IF
 14319        END-IF
 14320     END-IF
 14321     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14322
 14323     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14324         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14325
 14326     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14327         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14328
 14329     IF PB-COMPANY-ID = 'CRI'
 14330         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14331            PB-I-PAYMENT-AMOUNT = ZERO
 14332             NEXT SENTENCE
 14333         ELSE
 14334             COMPUTE PB-I-AH-PREM-CALC =
 14335                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14336                 (CP-PREMIUM-RATE / 100)
 14337             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14338                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14339                                             PB-I-RATE-DEV-PCT-AH.
 14340
 14341     IF PB-I-AH-RATE  = ZERO
 14342       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14343           NEXT SENTENCE
 14344       ELSE
 14345         MOVE ER-2642            TO WS-ERROR
 14346         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14347
 14348     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14349     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14350     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
 14351     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14352     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14353     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14354
 14355     IF (PB-COMPANY-ID = 'DCC')
 14356        AND (WS-AH-BEN-CATEGORY = 'G')
 14357        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14358        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14359        IF CP-DEVIATION-CODE NOT = '000'
 14360           MOVE '000'            TO CP-DEVIATION-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 260
* EL050.cbl
 14361           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14362           IF NO-CP-ERROR
 14363              COMPUTE PB-I-DDF-IU-RATE-UP =
 14364              PB-I-AH-CLP - CP-CALC-PREMIUM
 14365           ELSE
 14366              MOVE ER-3057        TO WS-ERROR
 14367              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14368           END-IF
 14369        END-IF
 14370     END-IF
 14371     .
 14372 3335-EDIT-AH-REIN-NSP-RATE.
 14373     IF AH-REIN-NSP-NOT-USED
 14374         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14375
 14376     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14377     IF PB-COMPANY-ID = 'DCC'
 14378         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14379     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14380     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14381     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14382     MOVE PB-SV-STATE            TO CP-STATE.
 14383     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14384     MOVE ZERO                   TO CP-DEVIATION-CODE
 14385                                    CP-RATE-DEV-PCT.
 14386*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14387     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14388     MOVE '3'                    TO CP-PROCESS-TYPE.
 14389     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14390     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14391                                    CP-RATING-BENEFIT-AMT.
 14392     IF CP-STATE-STD-ABBRV = 'OR'
 14393         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14394                                         PB-I-AH-TERM.
 14395     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14396     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14397     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14398     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14399     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14400     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14401                                    CP-REMAINING-TERM
 14402                                    WS-WORK-TERM.
 14403     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14404     IF PB-COMPANY-ID = 'DCC'
 14405        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14406     END-IF
 14407     IF  PB-COMPANY-ID = 'TIC'
 14408         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14409            MOVE ZERO TO CP-CLASS-CODE.
 14410
 14411     IF PB-COMPANY-ID NOT = 'TIC'
 14412          MOVE ZERO          TO CP-CLASS-CODE.
 14413
 14414     MOVE ZERO               TO CP-DEVIATION-CODE.
 14415
 14416     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14417
 14418     MOVE ZERO               TO PB-I-AH-REI-RATE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 261
* EL050.cbl
 14419
 14420     MOVE 'R'                   TO CP-RATE-FILE.
 14421     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14422
 14423     IF CP-ERROR-RATE-NOT-FOUND
 14424         MOVE ER-2645        TO WS-ERROR
 14425         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14426         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14427
 14428     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14429
 14430     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14431     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14432
 14433     IF PB-I-AH-REI-RATE = ZERO
 14434         MOVE ER-2645        TO WS-ERROR
 14435         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14436
 14437
 14438 3340-CALCULATE-PREMIUM-AMT.
 14439
 14440     IF PB-COMPANY-ID = 'NCL'
 14441         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14442             WS-AH-SPECIAL-CALC-CD = 'O')
 14443             GO TO 3999-END-EDIT.
 14444
 14445     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14446                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14447                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14448                         OR 'AHL'
 14449         NEXT SENTENCE
 14450     ELSE
 14451         IF WS-STATE-ABBREVIATION = 'CT'
 14452             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14453                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14454                 COMPUTE PB-I-LF-PREM-CALC =
 14455                                     PB-I-LF-PREM-CALC * .90
 14456                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14457                                     PB-I-LF-ALT-PREM-CALC * .90
 14458                 COMPUTE PB-I-AH-PREM-CALC =
 14459                                     PB-I-AH-PREM-CALC * .90.
 14460
 14461     IF PB-COMP-LF-PREM
 14462        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14463        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14464
 14465     IF PB-COMP-AH-PREM
 14466        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14467
 14468 3340-CHECK-DCC-TOT-FEES.
 14469     IF (PB-COMPANY-ID = 'DCC')
 14470        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14471        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14472        AND (PB-I-POLICY-IS-MONTHLY)
 14473        CONTINUE
 14474     ELSE
 14475        GO TO 3340-EDIT-LF-AH-TOL
 14476     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 262
* EL050.cbl
 14477     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14478     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14479     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14480        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14481           PB-I-RATE-DEV-PCT-LF
 14482     END-IF
 14483     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14484        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14485           PB-I-RATE-DEV-PCT-AH
 14486     END-IF
 14487     MOVE 'N'                    TO CP-BEN-CATEGORY
 14488     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14489
 14490     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14491     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14492     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14493     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14494     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14495     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14496     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14497     MOVE '3'                    TO CP-PROCESS-TYPE.
 14498     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14499     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14500
 14501     MOVE PB-SV-STATE            TO CP-STATE.
 14502     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14503     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14504     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14505     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14506     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14507                                    CP-RATING-BENEFIT-AMT.
 14508     IF CP-STATE-STD-ABBRV = 'OR'
 14509         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14510                                         PB-I-LF-ALT-BENEFIT-AMT.
 14511     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14512     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14513     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14514     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14515     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14516     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14517     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14518     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14519     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14520                                    CP-REMAINING-TERM
 14521                                    CP-LOAN-TERM.
 14522     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14523        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14524           PB-I-LF-PREMIUM-AMT
 14525     end-if
 14526
 14527     IF CP-TRUNCATED-LIFE
 14528        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14529
 14530     IF CP-TERM-IS-DAYS
 14531         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14532     ELSE
 14533         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14534
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 263
* EL050.cbl
 14535     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14536     IF CP-SPECIAL-CALC-CD = 'H'
 14537         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14538                                    TO CP-ALTERNATE-BENEFIT
 14539         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14540     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14541     MOVE 'R'                    TO CP-RATE-FILE
 14542     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14543     IF NOT CP-ERROR-RATE-NOT-FOUND
 14544        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14545        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14546           AND (CP-BENEFIT-CD (1:1) = 'S')
 14547           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14548                                    PB-I-LF-PREMIUM-AMT
 14549        END-IF
 14550     ELSE
 14551        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14552     END-IF
 14553     .
 14554 3340-EDIT-LF-AH-TOL.
 14555
 14556***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14557***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14558***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14559***
 14560     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14561         PB-I-AH-PREMIUM-AMT
 14562          GIVING WS-CALC-WORK.
 14563
 14564     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14565        AND WS-CALC-WORK NOT = ZERO
 14566         MOVE ER-2649            TO WS-ERROR
 14567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14568
 14569     SUBTRACT PB-I-LF-PREM-CALC
 14570             FROM PB-I-LF-PREMIUM-AMT
 14571                 GIVING WS-UNSIGN-WRK1.
 14572
 14573     SUBTRACT PB-I-LF-ALT-PREM-CALC
 14574             FROM PB-I-LF-ALT-PREMIUM-AMT
 14575                 GIVING WS-UNSIGN-WRK4.
 14576
 14577     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14578                                + WS-UNSIGN-WRK4.
 14579
 14580     SUBTRACT PB-I-AH-PREM-CALC
 14581             FROM PB-I-AH-PREMIUM-AMT
 14582                 GIVING WS-UNSIGN-WRK2.
 14583
 14584******************************************************************
 14585*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14586******************************************************************
 14587
 14588     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14589         MOVE ZERO TO WS-UNSIGN-WRK1.
 14590
 14591     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14592         MOVE ZERO TO WS-UNSIGN-WRK2.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 264
* EL050.cbl
 14593
 14594     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14595             GIVING WS-UNSIGN-WRK3.
 14596
 14597 3342-CONTINUE.
 14598
 14599     IF (PB-I-LF-RATE = ZERO  AND
 14600         PB-I-AH-RATE = ZERO)
 14601         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14602            WS-AH-SPECIAL-CALC-CD = 'O'
 14603              NEXT SENTENCE
 14604         ELSE
 14605             GO TO 3345-EDIT-CONTINUE.
 14606
 14607     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14608         NEXT SENTENCE
 14609     ELSE
 14610     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14611        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14612           IF (PB-REISSUED-CERT         OR
 14613               PB-POLICY-IS-DECLINED    OR
 14614               PB-POLICY-IS-VOIDED)
 14615              NEXT SENTENCE
 14616           ELSE
 14617              IF WS-PREM-REJECT-SW = SPACE
 14618                 MOVE ER-2652    TO WS-ERROR
 14619                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14620                 GO TO 3344-CHECK-AH
 14621              ELSE
 14622                 MOVE ER-2650    TO WS-ERROR
 14623                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14624                 GO TO 3344-CHECK-AH.
 14625
 14626***
 14627***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14628***
 14629
 14630     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14631         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
 14632            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14633             (1 + WS-TOL-LF-PREM-PCT)
 14634         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14635            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14636             (1 - WS-TOL-LF-PREM-PCT)
 14637     ELSE
 14638         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14639         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14640
 14641***
 14642***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14643***
 14644
 14645     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14646         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14647          WS-TOL-LF-PREM.
 14648
 14649     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14650         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 265
* EL050.cbl
 14651          WS-TOL-LF-PREM.
 14652
 14653     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14654        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14655
 14656     IF PB-REISSUED-CERT
 14657        or PB-POLICY-IS-DECLINED
 14658        or PB-POLICY-IS-VOIDED
 14659        continue
 14660     ELSE
 14661        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14662              > WS-TOL-LF-HIGH-PREM-AMT)
 14663           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14664              < WS-TOL-LF-LOW-PREM-AMT))
 14665                      or
 14666           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14667              > WS-TOL-LF-HIGH-PREM-PCT)
 14668           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14669              < WS-TOL-LF-LOW-PREM-PCT))
 14670           IF WS-PREM-REJECT-SW = SPACE
 14671              MOVE ER-2652       TO WS-ERROR
 14672              PERFORM 9900-ERROR-FORMAT
 14673                                 THRU 9900-EXIT
 14674           ELSE
 14675              MOVE ER-2650       TO WS-ERROR
 14676              PERFORM 9900-ERROR-FORMAT
 14677                                 THRU 9900-EXIT
 14678           end-if
 14679        end-if
 14680     end-if
 14681
 14682*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14683*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14684*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14685*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14686
 14687     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14688        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14689                      OR
 14690           ((PB-COMPANY-ID = 'DCC')
 14691           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14692           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14693           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14694        END-IF
 14695     END-IF
 14696
 14697     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14698        IF WS-COMP-MAX-CAP GREATER THAN +0
 14699           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14700              IF (PB-REISSUED-CERT         OR
 14701                  PB-POLICY-IS-DECLINED    OR
 14702                  PB-POLICY-IS-VOIDED)
 14703                 NEXT SENTENCE
 14704              ELSE
 14705                  MOVE ER-2646   TO  WS-ERROR
 14706                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14707
 14708 3344-CVL-TOLERANCE-CHECK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 266
* EL050.cbl
 14709
 14710      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14711          GO TO 3344-CHECK-AH.
 14712
 14713      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14714          GO TO 3344-CHECK-AH.
 14715
 14716      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14717                                     WS-UNSIGN-WRK6.
 14718
 14719      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14720          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14721                                 + PB-I-LF-PREMIUM-AMT
 14722                                 - PB-I-LF-PREM-CALC.
 14723
 14724      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14725          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14726                                 + PB-I-LF-ALT-PREMIUM-AMT
 14727                                 - PB-I-LF-ALT-PREM-CALC.
 14728
 14729      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14730          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14731              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14732                 MOVE ER-2652    TO  WS-ERROR
 14733                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14734              ELSE
 14735                 MOVE ER-2650    TO  WS-ERROR
 14736                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14737
 14738      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14739          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14740              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14741                 MOVE ER-2652    TO  WS-ERROR
 14742                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14743              ELSE
 14744                 MOVE ER-2650    TO  WS-ERROR
 14745                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14746
 14747 3344-CHECK-AH.
 14748
 14749****************************************************************
 14750***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14751***
 14752
 14753     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14754         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14755             (1 + WS-TOL-AH-PREM-PCT)
 14756         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14757             (1 - WS-TOL-AH-PREM-PCT)
 14758     ELSE
 14759         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14760         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14761
 14762***
 14763***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14764***
 14765
 14766     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 267
* EL050.cbl
 14767         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14768
 14769     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14770         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14771
 14772     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14773        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14774
 14775     IF (PB-REISSUED-CERT)
 14776        OR (PB-POLICY-IS-DECLINED)
 14777        OR (PB-POLICY-IS-VOIDED)
 14778        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14779        CONTINUE
 14780     ELSE
 14781        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14782              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14783                          or
 14784           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14785              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14786           IF WS-PREM-REJECT-SW = SPACE
 14787              MOVE ER-3052       TO WS-ERROR
 14788              PERFORM 9900-ERROR-FORMAT
 14789                                 THRU 9900-EXIT
 14790           ELSE
 14791              MOVE ER-3050       TO WS-ERROR
 14792              PERFORM 9900-ERROR-FORMAT
 14793                                 THRU 9900-EXIT
 14794           END-IF
 14795        END-IF
 14796     END-IF
 14797     if (pb-company-id = 'DCC')
 14798        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14799        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14800        and (pb-i-policy-is-monthly)
 14801        compute ws-tol-ah-high-prem-amt =
 14802           pb-i-tot-fees-calc + ws-tol-ah-prem
 14803        compute ws-tol-ah-low-prem-amt =
 14804           pb-i-tot-fees-calc - ws-tol-ah-prem
 14805        if ws-tol-ah-prem-pct > zeros
 14806           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14807              (1 + ws-tol-ah-prem-pct)
 14808           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14809              (1 - ws-tol-ah-prem-pct)
 14810        else
 14811           move +9999999.99      to ws-tol-ah-high-prem-pct
 14812           move +0               to ws-tol-ah-low-prem-pct
 14813        end-if
 14814        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14815            or
 14816           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14817                          or
 14818           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14819           or
 14820           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14821            move er-3049         to ws-error
 14822           perform 9900-error-format
 14823                                 thru 9900-exit
 14824
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 268
* EL050.cbl
 14825        end-if
 14826     end-if
 14827     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14828         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14829             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14830             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14831
 14832     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14833        IF WS-COMP-MAX-CAP GREATER THAN +0
 14834           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14835              IF (PB-REISSUED-CERT         OR
 14836                  PB-POLICY-IS-DECLINED    OR
 14837                  PB-POLICY-IS-VOIDED)
 14838                 NEXT SENTENCE
 14839              ELSE
 14840                  MOVE ER-2646   TO  WS-ERROR
 14841                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14842
 14843     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 14844        (WS-COMP-MAX-CAP EQUAL +0)
 14845           GO TO 3345-EDIT-CONTINUE.
 14846
 14847     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 14848        GREATER THAN WS-COMP-MAX-CAP
 14849           MOVE ER-2646          TO  WS-ERROR
 14850           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14851
 14852 3345-EDIT-CONTINUE.
 14853
 14854*    IF PB-COMPANY-ID    EQUAL    'NCL'
 14855*       IF PB-ENTRY-BATCH   NUMERIC
 14856*          IF PB-ISSUE
 14857*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 14858*          ELSE
 14859*              IF PB-CANCELLATION
 14860*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 14861
 14862*    IF  PB-COMPANY-ID    EQUAL    'HER'
 14863*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
 14864*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 14865*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 14866*        ELSE
 14867*            MOVE  ER-1909            TO  WS-ERROR
 14868*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 14869
 14870     IF PB-I-POLICY-ACCEPTED
 14871        IF PB-POLICY-IS-DECLINED  OR
 14872           PB-REISSUED-CERT  OR
 14873           PB-REIN-ONLY-CERT  OR
 14874           PB-POLICY-IS-VOIDED
 14875            MOVE  ER-1891         TO  WS-ERROR
 14876            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14877        ELSE
 14878            MOVE SPACE            TO  PB-BATCH-ENTRY
 14879            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 14880
 14881     IF PB-I-POLICY-DECLINED
 14882        IF PB-REISSUED-CERT  OR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 269
* EL050.cbl
 14883           PB-REIN-ONLY-CERT  OR
 14884           PB-POLICY-IS-VOIDED
 14885            MOVE  ER-1906         TO  WS-ERROR
 14886            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14887        ELSE
 14888            MOVE  'D'             TO  PB-BATCH-ENTRY
 14889                                      PB-I-ENTRY-STATUS.
 14890
 14891     IF PB-I-NEEDS-UNDERWRITING
 14892        IF PB-POLICY-IS-DECLINED OR
 14893           PB-REISSUED-CERT  OR
 14894           PB-REIN-ONLY-CERT  OR
 14895           PB-POLICY-IS-VOIDED
 14896            MOVE  ER-1907         TO  WS-ERROR
 14897            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 14898        ELSE
 14899            MOVE 'U'              TO  PB-BATCH-ENTRY
 14900                                      PB-I-ENTRY-STATUS.
 14901
 14902     IF PB-NEEDS-UNDERWRITING
 14903        MOVE  ER-1901             TO  WS-ERROR
 14904        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 14905     IF PB-COMPANY-ID = 'DCC'
 14906        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 14907        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 14908        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14909           AND (NOT WS-LF-CASH))
 14910                           OR
 14911           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 14912           AND (NOT WS-AH-CASH)))
 14913                       AND
 14914           (PB-I-ENTRY-STATUS NOT = '5')
 14915           MOVE 'M'              TO PB-BATCH-ENTRY
 14916                                    PB-I-ENTRY-STATUS
 14917        END-IF
 14918     END-IF
 14919     IF  PB-COMPANY-ID NOT = 'NCL'
 14920         GO TO 3999-END-EDIT.
 14921
 14922     IF PB-REISSUED-CERT  OR
 14923        PB-POLICY-IS-DECLINED  OR
 14924        PB-POLICY-IS-VOIDED  OR
 14925        PB-I-OB
 14926         GO TO 3999-END-EDIT.
 14927
 14928     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 14929         MOVE  ER-2644            TO  WS-ERROR
 14930         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 14931         GO TO 3999-END-EDIT.
 14932
 14933     MOVE 'N'                     TO  FORM-MASTER-SW.
 14934     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 14935
 14936     IF NOT FORM-MASTER-FOUND
 14937         GO TO 3999-END-EDIT.
 14938
 14939     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 14940                                      FORM-MASTER-AH-SW.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 270
* EL050.cbl
 14941
 14942     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14943         MOVE  +1                 TO SUB6
 14944         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 14945
 14946     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 14947         MOVE  +1                 TO SUB6
 14948         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 14949
 14950     IF LF-FORM-MASTER-FOUND  OR
 14951        AH-FORM-MASTER-FOUND
 14952         GO TO 3360-CHECK-FORM-LIMITS
 14953     ELSE
 14954         GO TO 3999-END-EDIT.
 14955
 14956******************************************************************
 14957*                  3350-GET-ERFORM                               *
 14958*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 14959*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 14960******************************************************************
 14961
 14962 3350-GET-ERFORM.
 14963
 14964     IF  WK-FORM-ADDR      EQUAL    ZEROS
 14965         GO TO  3350-ERFORM-GETMAIN.
 14966
 14967     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 14968     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 14969     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 14970     MOVE 'Y'                     TO FORM-MASTER-SW.
 14971
 14972     IF PB-CANCELLATION
 14973         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14974            PB-SV-STATE          EQUAL   FO-STATE       AND
 14975            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 14976              GO TO 3350-EXIT
 14977         ELSE
 14978             NEXT SENTENCE
 14979     ELSE
 14980         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 14981            PB-SV-STATE          EQUAL   FO-STATE       AND
 14982            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 14983              GO TO 3350-EXIT.
 14984
 14985 3350-ERFORM-GETMAIN.
 14986
 14987     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 14988     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 14989
 14990 3350-ERFORM-READ.
 14991
 14992     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 14993     MOVE  PB-SV-STATE            TO  FORM-STATE.
 14994     IF PB-CANCELLATION
 14995         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 14996     ELSE
 14997         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 14998     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 271
* EL050.cbl
 14999
 15000     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15001
 15002     IF FORM-MASTER-FOUND
 15003       IF PB-CANCELLATION
 15004          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15005             PB-SV-STATE          EQUAL   FO-STATE       AND
 15006             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15007              GO  TO 3350-EXIT
 15008          ELSE
 15009              NEXT SENTENCE
 15010       ELSE
 15011          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15012             PB-SV-STATE          EQUAL   FO-STATE       AND
 15013             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15014              GO  TO 3350-EXIT.
 15015
 15016     MOVE  'N'                    TO  FORM-MASTER-SW.
 15017     MOVE  ER-1895                TO  WS-ERROR.
 15018     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15019
 15020 3350-EXIT.
 15021      EXIT.
 15022
 15023******************************************************************
 15024*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15025*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15026*   VALID FOR THE POLICY FORM USED.                              *
 15027******************************************************************
 15028
 15029 3355-EDIT-FORM-LF-BENEFITS.
 15030
 15031     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15032        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15033         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15034         GO TO   3355-EXIT.
 15035
 15036     IF  SUB6    LESS THAN   +40
 15037         ADD  +1      TO  SUB6
 15038         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15039
 15040     MOVE  ER-1896         TO  WS-ERROR.
 15041     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15042
 15043 3355-EXIT.
 15044      EXIT.
 15045
 15046******************************************************************
 15047*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15048*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15049*   VALID FOR THE POLICY FORM USED.                              *
 15050******************************************************************
 15051
 15052 3356-EDIT-FORM-AH-BENEFITS.
 15053
 15054     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15055        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15056         MOVE  'Y'                TO  FORM-MASTER-AH-SW
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 272
* EL050.cbl
 15057         GO TO  3356-EXIT.
 15058
 15059      IF  SUB6    LESS THAN     +40
 15060          ADD  +1      TO  SUB6
 15061          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15062
 15063     MOVE  ER-1897         TO  WS-ERROR.
 15064     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15065
 15066 3356-EXIT.
 15067      EXIT.
 15068
 15069******************************************************************
 15070*                  3357-BENEFIT-SEARCH                           *
 15071*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15072*   CANCELLATIONS ONLY.                                          *
 15073******************************************************************
 15074 3357-BENEFIT-SEARCH.
 15075     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15076         MOVE +1                          TO SUB6
 15077         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15078
 15079     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15080         MOVE +1                          TO SUB6
 15081         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15082
 15083 3357-EXIT.
 15084     EXIT.
 15085
 15086******************************************************************
 15087*                  3358-BENEFIT-LIFE-SEARCH                      *
 15088*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15089*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15090*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15091******************************************************************
 15092 3358-BENEFIT-LIFE-SEARCH.
 15093     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15094       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15095         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15096           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15097              IF FO-PLAN-REFUND-METHOD (SUB6)
 15098                     IS GREATER THAN SPACES
 15099                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15100                                          WS-LF-REFUND-CALC
 15101                 GO TO 3358-EXIT.
 15102
 15103     IF SUB6 LESS THAN +40
 15104         ADD +1                 TO SUB6
 15105         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15106
 15107 3358-EXIT.
 15108     EXIT.
 15109******************************************************************
 15110*                  3359-BENEFIT-AH-SEARCH                        *
 15111*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15112*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15113*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15114******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 273
* EL050.cbl
 15115 3359-BENEFIT-AH-SEARCH.
 15116     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15117       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15118         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15119           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15120              IF FO-PLAN-REFUND-METHOD (SUB6)
 15121                      IS GREATER THAN SPACES
 15122                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15123                                          WS-AH-REFUND-CALC
 15124                 GO TO 3359-EXIT.
 15125
 15126     IF SUB6 LESS THAN +40
 15127         ADD +1                 TO SUB6
 15128         GO TO 3359-BENEFIT-AH-SEARCH.
 15129
 15130 3359-EXIT.
 15131     EXIT.
 15132
 15133******************************************************************
 15134*                  3360-CHECK-FORM-LIMITS                        *
 15135*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15136*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15137******************************************************************
 15138
 15139 3360-CHECK-FORM-LIMITS.
 15140
 15141     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15142         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15143
 15144     IF NOT LF-FORM-MASTER-FOUND
 15145         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15146
 15147 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15148
 15149     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15150       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15151        WS-LF-JOINT-INDICATOR = 'J'  AND
 15152        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15153         IF PB-COMPANY-ID = 'NCL'
 15154            MOVE  ER-1911          TO  WS-ERROR
 15155            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15156         ELSE
 15157            MOVE  ER-1892          TO  WS-ERROR
 15158            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15159
 15160 3360-CHECK-FORM-LF-ATT-AGE.
 15161
 15162     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15163
 15164     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15165         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15166         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15167            IF PB-COMPANY-ID = 'NCL'
 15168                MOVE  ER-1913      TO  WS-ERROR
 15169                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15170            ELSE
 15171                MOVE  ER-1894      TO  WS-ERROR
 15172                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 274
* EL050.cbl
 15173
 15174 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15175
 15176     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15177         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15178         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15179            IF PB-COMPANY-ID = 'NCL'
 15180                MOVE  ER-1914      TO  WS-ERROR
 15181                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15182            ELSE
 15183                MOVE  ER-1899      TO  WS-ERROR
 15184                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15185
 15186 3360-CHECK-FORM-LF-TERM-BAMT.
 15187
 15188     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15189         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15190         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15191           IF  PB-COMPANY-ID = 'NCL'
 15192               MOVE  ER-1916       TO  WS-ERROR
 15193               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15194           ELSE
 15195               MOVE  ER-1902       TO  WS-ERROR
 15196               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15197
 15198     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15199                                    PB-I-LF-ALT-BENEFIT-AMT.
 15200
 15201     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15202         FO-MAX-LF-AMT   GREATER THAN   ZEROS
 15203         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15204             IF  PB-COMPANY-ID = 'NCL'
 15205                 MOVE  ER-1918     TO  WS-ERROR
 15206                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15207             ELSE
 15208                 MOVE  ER-1904     TO  WS-ERROR
 15209                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15210
 15211******************************************************************
 15212*                  3360-CHECK-FORM-AH-LIMITS                     *
 15213*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15214*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15215******************************************************************
 15216
 15217 3360-CHECK-FORM-AH-LIMITS.
 15218
 15219     IF NOT AH-FORM-MASTER-FOUND
 15220         GO TO 3999-END-EDIT.
 15221
 15222 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15223
 15224     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15225       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15226        WS-AH-JOINT-INDICATOR = 'J'  AND
 15227        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15228         IF PB-COMPANY-ID = 'NCL'
 15229            MOVE  ER-1912          TO  WS-ERROR
 15230            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 275
* EL050.cbl
 15231         ELSE
 15232            MOVE  ER-1893          TO  WS-ERROR
 15233            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15234
 15235 3360-CHECK-FORM-AH-ATT-AGE.
 15236
 15237     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15238
 15239     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15240         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15241         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15242            IF PB-COMPANY-ID = 'NCL'
 15243                MOVE  ER-1913      TO  WS-ERROR
 15244                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15245            ELSE
 15246                MOVE  ER-1894      TO  WS-ERROR
 15247                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15248
 15249 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15250
 15251     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15252         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15253         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15254            IF PB-COMPANY-ID = 'NCL'
 15255                MOVE  ER-1915      TO  WS-ERROR
 15256                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15257            ELSE
 15258                MOVE  ER-1900      TO  WS-ERROR
 15259                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15260
 15261 3360-CHECK-FORM-AH-TERM-BAMT.
 15262
 15263     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15264         FO-AH-MAX-TERM    GREATER THAN  +0
 15265         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15266             IF  PB-COMPANY-ID = 'NCL'
 15267                 MOVE  ER-1917     TO  WS-ERROR
 15268                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15269             ELSE
 15270                  MOVE  ER-1903    TO  WS-ERROR
 15271                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15272
 15273     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15274         FO-MAX-AH-AMT    GREATER THAN  +0
 15275         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15276             IF  PB-COMPANY-ID = 'NCL'
 15277                 MOVE  ER-1919     TO  WS-ERROR
 15278                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15279             ELSE
 15280                 MOVE  ER-1905     TO  WS-ERROR
 15281                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15282
 15283     GO TO 3999-END-EDIT.
 15284
 15285******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 276
* EL050.cbl
 15287******************************************************************
 15288*                  E D I T   C A N C E L                         *
 15289******************************************************************
 15290
 15291 3700-EDIT-CANCEL.
 15292     IF PB-COMPANY-ID = 'DMD'
 15293         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15294                                         WS-RES-MUNI-TAX
 15295                                         PB-CI-STATE-TAX
 15296                                         PB-CI-MUNI-TAX
 15297         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15298
 15299*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15300*       IF PB-ENTRY-BATCH  NUMERIC
 15301*          IF PB-CANCELLATION
 15302*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15303*          ELSE
 15304*             IF PB-ISSUE
 15305*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15306
 15307     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15308        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15309     END-IF
 15310*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15311*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15312
 15313     IF CM-ENTRY-STATUS = 'V'
 15314        MOVE ER-2780             TO WS-ERROR
 15315        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15316        GO TO 3999-END-EDIT.
 15317
 15318     IF CM-ENTRY-STATUS = 'D'
 15319        MOVE ER-2781             TO WS-ERROR
 15320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15321        GO TO 3999-END-EDIT.
 15322
 15323     IF CM-ENTRY-STATUS = 'U'
 15324        MOVE ER-2782             TO WS-ERROR
 15325        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15326
 15327***************************************************************
 15328*                                                             *
 15329*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15330*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15331*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15332*   OF ANOTHER COVERAGE.                                      *
 15333*                                                             *
 15334***************************************************************
 15335
 15336     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15337                                    PB-C-AH-CANCEL-VOID-SW.
 15338
 15339     IF PB-C-LF-CANCEL-AMT = ZERO
 15340        NEXT SENTENCE
 15341     ELSE
 15342        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15343           AND
 15344           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 277
* EL050.cbl
 15345               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15346               MOVE ER-2745           TO WS-ERROR
 15347               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15348
 15349     IF PB-C-AH-CANCEL-AMT = ZERO
 15350        NEXT SENTENCE
 15351     ELSE
 15352        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15353           AND
 15354           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15355               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15356               MOVE ER-2745           TO WS-ERROR
 15357               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15358
 15359     IF WS-LF-EARNINGS-CALC = '4'
 15360        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15361
 15362     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15363     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15364     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15365     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15366     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15367     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15368
 15369     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15370                                      PB-C-AH-REF-CALC.
 15371     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15372
 15373******************************************************************
 15374*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15375*             TO VALIDATE COVERAGE.                              *
 15376******************************************************************
 15377
 15378     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15379        PB-C-LF-CANCEL-AMT = ZEROS
 15380          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15381      ELSE
 15382          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15383
 15384     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15385        PB-C-AH-CANCEL-AMT = ZEROS
 15386          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15387      ELSE
 15388          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15389
 15390     EVALUATE TRUE
 15391         WHEN PB-CANCEL-FORCE             OR
 15392              PB-CANCEL-DATE-FORCED       OR
 15393              PB-FORCE-OFF
 15394                  IF PB-COMPANY-ID = 'ACE'
 15395                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15396                  END-IF
 15397         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15398               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15399              (PB-COMPANY-ID = 'ACE' )
 15400                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15401         WHEN OTHER
 15402              IF PB-COMPANY-ID = 'ACE'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 278
* EL050.cbl
 15403                 MOVE ER-2794              TO WS-ERROR
 15404              ELSE
 15405                 MOVE ER-2749              TO WS-ERROR
 15406              END-IF
 15407              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15408     END-EVALUATE.
 15409
 15410
 15411*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15412*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15413*            MOVE  ER-1909            TO  WS-ERROR
 15414*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15415*        ELSE
 15416*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15417
 15418     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15419     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15420        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15421     ELSE
 15422        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15423     END-IF
 15424     .
 15425 3705-EDIT-CANCEL-DT.
 15426
 15427     IF LF-COVERAGE-CANCELLED
 15428        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15429         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15430         MOVE WS-CURRENT-MONTH-END
 15431                                 TO DC-BIN-DATE-2
 15432         SET ELAPSED-BETWEEN-BIN TO TRUE
 15433*        MOVE 1                  TO DC-OPTION-CODE
 15434         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15435         IF DATE-CONVERSION-ERROR
 15436            NEXT SENTENCE
 15437          ELSE
 15438             IF DC-ELAPSED-DAYS GREATER +180
 15439                IF PB-CANCEL-DATE-FORCED  OR
 15440                   PB-CANCEL-DATE-FORCED-NO-FEE
 15441                      MOVE ER-2751  TO WS-ERROR
 15442                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15443                 ELSE
 15444                   MOVE ER-2752  TO WS-ERROR
 15445                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15446
 15447     IF AH-COVERAGE-CANCELLED
 15448        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15449         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15450         MOVE WS-CURRENT-MONTH-END
 15451                                 TO DC-BIN-DATE-2
 15452         SET ELAPSED-BETWEEN-BIN TO TRUE
 15453*        MOVE 1                  TO DC-OPTION-CODE
 15454         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15455         IF DATE-CONVERSION-ERROR
 15456            NEXT SENTENCE
 15457          ELSE
 15458             IF DC-ELAPSED-DAYS GREATER +180
 15459                IF PB-CANCEL-DATE-FORCED OR
 15460                   PB-CANCEL-DATE-FORCED-NO-FEE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 279
* EL050.cbl
 15461                      MOVE ER-2751  TO WS-ERROR
 15462                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15463                 ELSE
 15464                   MOVE ER-2752  TO WS-ERROR
 15465                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15466
 15467     IF WS-ERROR = ER-2752
 15468        AND (PB-COMPANY-ID = 'ABL'
 15469         OR  PB-COMPANY-ID = 'FGL'
 15470         OR  PB-COMPANY-ID = 'IST'
 15471         OR  PB-COMPANY-ID = 'JHL'
 15472         OR  PB-COMPANY-ID = 'LAP'
 15473         OR  PB-COMPANY-ID = 'LBL'
 15474         OR  PB-COMPANY-ID = 'NCB'
 15475         OR  PB-COMPANY-ID = 'NLI'
 15476         OR  PB-COMPANY-ID = 'OFI'
 15477         OR  PB-COMPANY-ID = 'PLI'
 15478         OR  PB-COMPANY-ID = 'TAO'
 15479         OR  PB-COMPANY-ID = 'TIC'
 15480         OR  PB-COMPANY-ID = 'HER'
 15481         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15482         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15483            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15484            MOVE ER-2762     TO WS-ERROR
 15485            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15486
 15487     IF LF-COVERAGE-CANCELLED
 15488        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15489        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15490             MOVE ER-2733         TO WS-ERROR
 15491             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15492
 15493     IF AH-COVERAGE-CANCELLED
 15494        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15495        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15496              MOVE ER-2733        TO WS-ERROR
 15497              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15498
 15499     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15500        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15501        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15502           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15503            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15504              IF PB-COMPANY-ID NOT = 'LAP'
 15505               MOVE ER-2704            TO WS-ERROR
 15506               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15507
 15508     IF CERT-WAS-NOT-FOUND
 15509         GO TO 3999-END-EDIT.
 15510
 15511     IF PB-COMPANY-ID EQUAL 'CDC'
 15512        IF LF-COVERAGE-CANCELLED
 15513           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15514            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15515            MOVE PB-C-LF-CANCEL-DT
 15516                                 TO DC-BIN-DATE-2
 15517            SET ELAPSED-BETWEEN-BIN TO TRUE
 15518*           MOVE 1               TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 280
* EL050.cbl
 15519            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15520            IF DATE-CONVERSION-ERROR
 15521               NEXT SENTENCE
 15522             ELSE
 15523                IF DC-ELAPSED-DAYS GREATER +60
 15524                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15525
 15526     IF PB-COMPANY-ID EQUAL 'CDC'
 15527        IF AH-COVERAGE-CANCELLED
 15528           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15529            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15530            MOVE PB-C-AH-CANCEL-DT
 15531                                 TO DC-BIN-DATE-2
 15532            MOVE +0              TO DC-ELAPSED-DAYS
 15533                                    DC-ELAPSED-MONTHS
 15534            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15535*           MOVE 1               TO DC-OPTION-CODE
 15536            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15537            IF DATE-CONVERSION-ERROR
 15538               NEXT SENTENCE
 15539             ELSE
 15540                IF DC-ELAPSED-DAYS GREATER +60
 15541                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15542
 15543     MOVE +0                     TO DC-ELAPSED-DAYS
 15544                                    DC-ELAPSED-MONTHS.
 15545
 15546     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15547        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15548          MOVE 'Z'                TO PB-CI-OB-FLAG
 15549          MOVE ER-2767            TO WS-ERROR
 15550          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15551          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15552          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15553          GO TO 3775-OVER-REF-CHK
 15554        ELSE
 15555          MOVE ZEROS              TO PB-CI-LIVES
 15556                                     PB-C-LIVES
 15557          IF PB-CI-OB-FLAG NOT = 'B'
 15558             MOVE SPACE           TO PB-CI-OB-FLAG.
 15559
 15560     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15561         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15562     ELSE
 15563         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15564
 15565     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15566        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15567            MOVE ER-2760         TO WS-ERROR
 15568            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15569
 15570     IF LF-COVERAGE-CANCELLED
 15571        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15572         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15573            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15574               MOVE ER-2774       TO WS-ERROR
 15575               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15576
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 281
* EL050.cbl
 15577     IF AH-COVERAGE-CANCELLED
 15578        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15579         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15580            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15581               MOVE ER-2775       TO WS-ERROR
 15582               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15583
 15584     IF LF-COVERAGE-CANCELLED
 15585        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15586         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15587            MOVE ER-2776         TO WS-ERROR
 15588            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15589
 15590     IF AH-COVERAGE-CANCELLED
 15591        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15592         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15593            MOVE ER-2777         TO WS-ERROR
 15594            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15595
 15596     IF LF-COVERAGE-CANCELLED
 15597        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15598        if pb-ci-lf-expire-dt = low-values or spaces
 15599           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15600           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15601           MOVE PB-CI-EXTENTION-DAYS
 15602                                 TO DC-ELAPSED-DAYS
 15603           SET BIN-PLUS-ELAPSED  TO TRUE
 15604           PERFORM 8500-DATE-CONVERT
 15605                                 THRU 8500-EXIT
 15606           IF DATE-CONVERSION-ERROR
 15607              move low-values    to dc-bin-date-2
 15608           end-if
 15609        else
 15610           move pb-ci-lf-expire-dt
 15611                                 to dc-bin-date-2
 15612        end-if
 15613        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15614           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15615                             OR  'FIA'
 15616              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15617           ELSE
 15618              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15619              MOVE ER-2731       TO WS-ERROR
 15620              PERFORM 9900-ERROR-FORMAT
 15621                                 THRU 9900-EXIT
 15622           end-if
 15623        end-if
 15624     end-if
 15625*    IF LF-COVERAGE-CANCELLED
 15626*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15627*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15628*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15629*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15630*        SET BIN-PLUS-ELAPSED      TO TRUE
 15631*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15632*        IF DATE-CONVERSION-ERROR
 15633*           NEXT SENTENCE
 15634*         ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 282
* EL050.cbl
 15635*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15636*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15637*                            OR  'FIA'
 15638*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15639*              ELSE
 15640*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15641*               MOVE ER-2731       TO WS-ERROR
 15642*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15643     .
 15644 3705-EDIT-AH-CANCEL-DT.
 15645     IF AH-COVERAGE-CANCELLED
 15646        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15647        if pb-ci-AH-expire-dt = low-values or spaces
 15648           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15649           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15650           MOVE PB-CI-EXTENTION-DAYS
 15651                                 TO DC-ELAPSED-DAYS
 15652           SET BIN-PLUS-ELAPSED  TO TRUE
 15653           PERFORM 8500-DATE-CONVERT
 15654                                 THRU 8500-EXIT
 15655           IF DATE-CONVERSION-ERROR
 15656              move low-values    to dc-bin-date-2
 15657           end-if
 15658        else
 15659           move pb-ci-ah-expire-dt
 15660                                 to dc-bin-date-2
 15661        end-if
 15662        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15663           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15664                             OR  'FIA'
 15665              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15666           ELSE
 15667              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15668              MOVE ER-2771       TO WS-ERROR
 15669              PERFORM 9900-ERROR-FORMAT
 15670                                 THRU 9900-EXIT
 15671           end-if
 15672        end-if
 15673     end-if
 15674*    IF AH-COVERAGE-CANCELLED
 15675*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15676*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15677*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15678*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15679**       MOVE 6                    TO DC-OPTION-CODE
 15680*        SET BIN-PLUS-ELAPSED      TO TRUE
 15681*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15682*        IF DATE-CONVERSION-ERROR
 15683*           NEXT SENTENCE
 15684*         ELSE
 15685*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15686*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15687*                             OR 'FIA'
 15688*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15689*             ELSE
 15690*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15691*              MOVE ER-2771       TO WS-ERROR
 15692*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 283
* EL050.cbl
 15693     .
 15694 3705-EDIT-CONTINUED.
 15695
 15696*    IF LF-COVERAGE-CANCELLED
 15697*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15698*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15699*            MOVE ER-2727         TO WS-ERROR
 15700*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15701*
 15702*    IF AH-COVERAGE-CANCELLED
 15703*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15704*        IF PB-COMPANY-ID = 'ACE'
 15705*           MOVE ER-2727        TO WS-ERROR
 15706*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15707*        ELSE
 15708*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15709*              MOVE ER-2727     TO WS-ERROR
 15710*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15711
 15712     IF PB-COMPANY-ID = 'ACE'
 15713       IF AH-COVERAGE-CANCELLED
 15714         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15715           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15716              MOVE ER-2732      TO WS-ERROR
 15717              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15718
 15719     IF PB-COMPANY-ID      EQUAL   'HER'
 15720        IF WS-ERROR        EQUAL   ER-2727
 15721            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15722            MOVE  ER-2725          TO  WS-ERROR
 15723            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15724
 15725     IF PB-C-CLAIM-CREATED-CANCEL
 15726            MOVE ER-2748         TO WS-ERROR
 15727            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15728
 15729     IF PB-C-LAST-NAME NOT = SPACES
 15730         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15731            MOVE ER-2747         TO WS-ERROR
 15732            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15733
 15734 3710-EDIT-LUMP-SUM-PRIOR.
 15735
 15736     IF AH-COVERAGE-CANCELLED
 15737         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15738             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15739                MOVE ER-2735    TO WS-ERROR
 15740                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15741
 15742     IF LF-COVERAGE-CANCELLED
 15743         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15744             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15745                MOVE ER-2735    TO WS-ERROR
 15746                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15747
 15748 3710-EDIT-PRIOR-DEATH.
 15749
 15750*    IF LF-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 284
* EL050.cbl
 15751*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15752*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15753*           (NOT PB-CI-OB)
 15754*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15755*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15756*                   MOVE ER-2732  TO WS-ERROR
 15757*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15758*
 15759*    IF AH-COVERAGE-CANCELLED
 15760*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15761*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15762*           (NOT PB-CI-OB)
 15763*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15764*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15765*                   MOVE ER-2732  TO WS-ERROR
 15766*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15767
 15768     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15769         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15770            (NOT PB-COMP-LF-CANCEL)
 15771             NEXT SENTENCE
 15772         ELSE
 15773           IF PB-C-LF-CANCEL-VOIDED
 15774              NEXT SENTENCE
 15775           ELSE
 15776              MOVE ER-2753      TO WS-ERROR
 15777              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15778
 15779     IF CANCEL-FUTURE-DT
 15780         GO TO 3999-END-EDIT.
 15781
 15782 3715-GET-REMAIN-TERM-LF.
 15783
 15784     IF NO-LF-BENEFIT-MATCH  OR
 15785        WS-LF-BENEFIT-CD = ZEROS
 15786        GO TO 3730-GET-AH-REMAIN-TERM.
 15787
 15788     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 15789     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15790     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 15791     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 15792     MOVE PB-SV-STATE            TO CP-STATE.
 15793     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 15794     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 15795     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 15796     MOVE '2'                    TO CP-PROCESS-TYPE.
 15797     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 15798     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 15799     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 15800     IF (PB-COMPANY-ID = 'CID')
 15801        AND (CP-STATE-STD-ABBRV = 'WI')
 15802        MOVE '7'                 TO CP-REM-TERM-METHOD
 15803        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15804     ELSE
 15805        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 15806        MOVE WS-REM-TRM-CALC-OPTION
 15807                                 TO CP-REM-TRM-CALC-OPTION
 15808     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 285
* EL050.cbl
 15809**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 15810     IF (PB-COMPANY-ID = 'CID')
 15811        AND (CP-STATE-STD-ABBRV = 'MO')
 15812        AND (PB-CERT-EFF-DT >= X'9B41')
 15813        AND (PB-CERT-EFF-DT <= X'A2FB')
 15814        MOVE '7'                 TO CP-REM-TERM-METHOD
 15815        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 15816     END-IF
 15817     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 15818                                    CP-LOAN-TERM.
 15819     IF CP-TRUNCATED-LIFE
 15820        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 15821
 15822     IF CP-TERM-IS-DAYS
 15823         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 15824     ELSE
 15825         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 15826
 15827     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 15828
 15829     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 15830
 15831     IF LF-COVERAGE-CANCELLED
 15832        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 15833        NEXT SENTENCE
 15834      ELSE
 15835          GO TO 3730-GET-AH-REMAIN-TERM.
 15836
 15837 3720-GET-LF-REFUND.
 15838
 15839     IF PB-C-LF-CANCEL-VOIDED
 15840        GO TO 3730-GET-AH-REMAIN-TERM
 15841     end-if
 15842
 15843     IF PB-COMPANY-ID EQUAL 'BOA'
 15844         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15845         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15846         GO TO 3730-GET-AH-REMAIN-TERM.
 15847
 15848     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 15849        (WS-AH-SPECIAL-CALC-CD = 'M')
 15850         MOVE ER-2767            TO WS-ERROR
 15851         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15852         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15853         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15854         GO TO 3780-UPDATE-CANCEL-CERT.
 15855
 15856*    if (ws-lf-earnings-calc = '6')
 15857*       or (pb-c-lf-refund-override = '6')
 15858*       move cp-remaining-term-1 to cp-remaining-term-2
 15859*    end-if
 15860     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 15861
 15862     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 15863     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 15864     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15865     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 15866     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 286
* EL050.cbl
 15867     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 15868     IF (PB-COMPANY-ID = 'DCC')
 15869        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 15870        IF PDEF-MASTER-FOUND
 15871           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15872              (V1 > +8)
 15873              OR (PD-PROD-CODE (V1) = 'L')
 15874           END-PERFORM
 15875           IF V1 < +9
 15876              MOVE PD-MAX-AMT (V1)
 15877                           TO CP-R-MAX-TOT-BEN
 15878                              EC-AM-LF-MAX-TOT-BEN
 15879           END-IF
 15880        ELSE
 15881        MOVE ' '                 TO PDEF-MASTER-SW
 15882        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 15883        MOVE PB-STATE            TO ERPDEF-STATE
 15884        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 15885        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 15886        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 15887        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 15888        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 15889        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 15890        IF PDEF-MASTER-FOUND
 15891           MOVE 'N'              TO PDEF-MASTER-SW
 15892           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15893           IF PDEF-MASTER-FOUND
 15894              IF (ERPDEF-KEY-SAVE (1:16) =
 15895                           PD-CONTROL-PRIMARY (1:16))
 15896                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15897                 CONTINUE
 15898              ELSE
 15899                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 15900                 IF (ERPDEF-KEY-SAVE (1:16) =
 15901                           PD-CONTROL-PRIMARY (1:16))
 15902                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 15903                    CONTINUE
 15904                 ELSE
 15905                    MOVE 'N'     TO PDEF-MASTER-SW
 15906                 END-IF
 15907              END-IF
 15908
 15909              IF PDEF-MASTER-FOUND
 15910                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15911                    (V1 > +8)
 15912                    OR (PD-PROD-CODE (V1) = 'L')
 15913                 END-PERFORM
 15914                 IF V1 < +9
 15915                    MOVE PD-MAX-AMT (V1)
 15916                                 TO CP-R-MAX-TOT-BEN
 15917                                    EC-AM-LF-MAX-TOT-BEN
 15918                 END-IF
 15919              END-IF
 15920           END-IF
 15921           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 15922        END-IF
 15923        END-IF
 15924     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 287
* EL050.cbl
 15925     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 15926
 15927     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 15928
 15929     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 15930                                    PB-C-LF-REM-TERM.
 15931
 15932     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 15933     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 15934
 15935     IF PB-COMPANY-ID EQUAL 'FLC'
 15936        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 15937           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 15938           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 15939                    + PB-CI-LF-ALT-PREMIUM-AMT)
 15940                    - CM-LF-ITD-DEATH-AMT
 15941           IF PB-C-LF-REF-CALC LESS THAN +0
 15942              MOVE +0            TO PB-C-LF-REF-CALC
 15943              GO TO 3730-GET-AH-REMAIN-TERM
 15944           ELSE
 15945              GO TO 3730-GET-AH-REMAIN-TERM.
 15946
 15947     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 15948                            OR '4' OR '5' OR '6' OR '8'
 15949                            OR '9' OR 'G'
 15950        MOVE PB-C-LF-REFUND-OVERRIDE
 15951                                 TO CP-EARNING-METHOD.
 15952
 15953     if pb-company-id = 'AHL'
 15954        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 15955        if cp-class-code = spaces
 15956           move zeros            to cp-class-code
 15957        end-if
 15958     ELSE
 15959        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 15960     END-IF
 15961*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 15962     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 15963     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 15964                                    CP-RATING-BENEFIT-AMT.
 15965     IF CP-STATE-STD-ABBRV = 'OR'
 15966         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 15967                                         PB-CI-LF-ALT-BENEFIT-AMT.
 15968     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 15969     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 15970     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 15971     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 15972     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 15973     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 15974     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 15975     IF WS-DEFAULT-APR NOT NUMERIC
 15976         MOVE ZEROS TO WS-DEFAULT-APR.
 15977****   N O T E   ****
 15978*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 15979*      THE OH HARD CODING IN ELCRFNDP
 15980
 15981     IF PB-COMPANY-ID = 'CID'
 15982        IF CP-STATE-STD-ABBRV = 'OH'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 288
* EL050.cbl
 15983           MOVE WS-LF-EARNINGS-CALC
 15984                                 TO CP-EARNING-METHOD
 15985        END-IF
 15986     END-IF
 15987
 15988****   N O T E   ****
 15989
 15990     IF CP-EARN-AS-NET-PAY
 15991         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 15992            IF WS-DEFAULT-APR GREATER THAN ZEROS
 15993                MOVE WS-DEFAULT-APR
 15994                                 TO  CP-LOAN-APR
 15995                MOVE ER-3780     TO  WS-ERROR
 15996                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 15997            ELSE
 15998                MOVE ER-3781     TO  WS-ERROR
 15999                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16000*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16001     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16002
 16003     IF CP-REFUND-TYPE-USED NOT = SPACE
 16004         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16005
 16006     IF CP-ERROR-RATE-IS-ZERO OR
 16007        CP-ERROR-RATE-NOT-FOUND
 16008        MOVE ER-2740             TO WS-ERROR
 16009        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16010
 16011     IF CP-ERROR-RATE-FILE-NOTOPEN
 16012        MOVE ER-2617             TO WS-ERROR
 16013        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16014
 16015     IF PB-COMPANY-ID = 'DCC'
 16016        AND PB-CI-ENTRY-STATUS = 'M'
 16017        MOVE +0                  TO PB-C-LF-REF-CALC
 16018     ELSE
 16019        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16020     END-IF
 16021
 16022     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16023         GO TO 3730-GET-AH-REMAIN-TERM.
 16024
 16025*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16026*       ADD +1                   TO PB-C-LF-REM-TERM
 16027*                                   CP-REMAINING-TERM
 16028*                                   CP-ORIGINAL-TERM.
 16029
 16030     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16031     MOVE '2'                    TO CP-EARNING-METHOD
 16032                                    CP-RATING-METHOD.
 16033     IF PB-COMPANY-ID = 'CID'
 16034        IF (CP-STATE-STD-ABBRV = 'MN')
 16035           AND (PB-CERT-EFF-DT > X'A4FF')
 16036           AND (WS-LF-EARNINGS-CALC = 'B')
 16037           MOVE '5'              TO CP-EARNING-METHOD
 16038           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16039        END-IF
 16040     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 289
* EL050.cbl
 16041     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16042                                        CP-REMAINING-BENEFIT
 16043                                        CP-RATING-BENEFIT-AMT.
 16044     IF CP-STATE-STD-ABBRV = 'OR'
 16045         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16046                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16047     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16048     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16049
 16050     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16051
 16052     IF CP-ERROR-RATE-IS-ZERO OR
 16053        CP-ERROR-RATE-NOT-FOUND
 16054        MOVE ER-2740             TO WS-ERROR
 16055        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16056
 16057     IF CP-ERROR-RATE-FILE-NOTOPEN
 16058        MOVE ER-2617             TO WS-ERROR
 16059        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16060
 16061     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16062
 16063******************************************************************
 16064
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 290
* EL050.cbl
 16066 3730-GET-AH-REMAIN-TERM.
 16067     IF NO-AH-BENEFIT-MATCH  OR
 16068        WS-AH-BENEFIT-CD = ZEROS
 16069         GO TO 3770-CHECK-REFUNDS.
 16070
 16071     IF PB-CI-AH-LUMP-SUM-DISAB
 16072         IF  PB-C-AH-CANCEL-AMT = ZERO
 16073            IF NOT PB-COMP-AH-CANCEL
 16074             GO TO 3770-CHECK-REFUNDS.
 16075
 16076     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16077     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16078     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16079     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16080     MOVE PB-SV-STATE            TO CP-STATE.
 16081     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16082     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16083     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16084     MOVE '2'                    TO CP-PROCESS-TYPE.
 16085     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16086     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16087     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16088     IF (PB-COMPANY-ID = 'CID')
 16089        AND (CP-STATE-STD-ABBRV = 'WI')
 16090        MOVE '7'                 TO CP-REM-TERM-METHOD
 16091        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16092     ELSE
 16093        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16094        MOVE WS-REM-TRM-CALC-OPTION
 16095                                 TO CP-REM-TRM-CALC-OPTION
 16096     END-IF
 16097     IF (PB-COMPANY-ID = 'CID')
 16098        AND (CP-STATE-STD-ABBRV = 'MO')
 16099        AND (PB-CERT-EFF-DT >= X'9B41')
 16100        AND (PB-CERT-EFF-DT <= X'A2FB')
 16101        MOVE '7'                 TO CP-REM-TERM-METHOD
 16102        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16103     END-IF
 16104     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16105                                    CP-LOAN-TERM.
 16106     IF NOT CP-TERM-IS-DAYS
 16107         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16108
 16109     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16110
 16111     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16112
 16113     IF AH-COVERAGE-CANCELLED
 16114        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16115        NEXT SENTENCE
 16116      ELSE
 16117         GO TO 3770-CHECK-REFUNDS.
 16118
 16119 3740-GET-AH-REFUND.
 16120
 16121     IF PB-C-AH-CANCEL-VOIDED
 16122        GO TO 3780-UPDATE-CANCEL-CERT
 16123     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 291
* EL050.cbl
 16124
 16125     IF PB-COMPANY-ID = 'BOA'
 16126         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16127         GO TO 3770-CHECK-REFUNDS.
 16128
 16129     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16130*    MOVE ' '                    TO DC-OPTION-CODE
 16131     SET BIN-TO-GREG             TO TRUE
 16132     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16133     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16134                                    PB-C-AH-REM-TERM.
 16135     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16136     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16137
 16138     IF PB-COMPANY-ID EQUAL 'FLC'
 16139        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16140           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16141           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16142                    - CM-AH-ITD-AH-PMT)
 16143           IF PB-C-AH-REF-CALC LESS THAN +0
 16144              MOVE +0            TO PB-C-AH-REF-CALC
 16145              GO TO 3770-CHECK-REFUNDS
 16146           ELSE
 16147              GO TO 3770-CHECK-REFUNDS.
 16148
 16149     IF PB-COMPANY-ID = 'DCC'
 16150        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16151            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16152           MOVE 'S'              TO CP-EARNING-METHOD
 16153        END-IF
 16154     END-IF
 16155     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16156                            OR '4' OR '5' OR '6' OR '8'
 16157                            OR '9' OR 'G' OR 'S'
 16158        MOVE PB-C-AH-REFUND-OVERRIDE
 16159                                 TO CP-EARNING-METHOD.
 16160
 16161     if pb-company-id = 'AHL'
 16162        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16163        if cp-class-code = spaces
 16164           move zeros            to cp-class-code
 16165        end-if
 16166     ELSE
 16167        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16168     END-IF
 16169*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16170     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16171     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16172                                    CP-RATING-BENEFIT-AMT.
 16173     IF CP-STATE-STD-ABBRV = 'OR'
 16174         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16175                                         PB-CI-AH-TERM.
 16176     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16177     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16178     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16179     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16180     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16181     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 292
* EL050.cbl
 16182
 16183     IF CP-STATE-STD-ABBRV = 'OH'
 16184        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16185                                AND 'CID' AND 'DCC' AND 'AHL')
 16186           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16187              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16188              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16189              MOVE '6' TO CP-EARNING-METHOD
 16190           END-IF
 16191        END-IF
 16192        IF PB-COMPANY-ID = 'CID'
 16193           IF NO-LIFE-COVERAGE
 16194              IF CP-CRITICAL-PERIOD
 16195                 MOVE '2'       TO CP-EARNING-METHOD
 16196              ELSE
 16197                 MOVE '6'       TO CP-EARNING-METHOD
 16198              END-IF
 16199           ELSE
 16200              IF WS-LF-COVERAGE-TYPE = 'L'
 16201                 MOVE '2'       TO CP-EARNING-METHOD
 16202              ELSE
 16203                 IF (PB-CI-LF-TERM > +60) OR
 16204                    (WS-LF-EARNINGS-CALC = '5')
 16205                    IF CP-CRITICAL-PERIOD
 16206                       MOVE '2'  TO CP-EARNING-METHOD
 16207                    ELSE
 16208                       MOVE '6'  TO CP-EARNING-METHOD
 16209                    END-IF
 16210                 ELSE
 16211                    MOVE '1'     TO CP-EARNING-METHOD
 16212                 END-IF
 16213              END-IF
 16214           END-IF
 16215        END-IF
 16216     END-IF
 16217
 16218*    IF CP-STATE-STD-ABBRV = 'VA'
 16219*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16220*          IF CP-ORIGINAL-TERM GREATER 61
 16221*             MOVE '6' TO CP-EARNING-METHOD
 16222*          ELSE
 16223*             MOVE '1' TO CP-EARNING-METHOD.
 16224
 16225     IF WS-DEFAULT-APR NOT NUMERIC
 16226         MOVE ZEROS TO WS-DEFAULT-APR.
 16227     IF CP-EARN-AS-NET-PAY
 16228         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16229            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16230                MOVE WS-DEFAULT-APR
 16231                                 TO  CP-LOAN-APR
 16232                MOVE ER-3780     TO  WS-ERROR
 16233                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16234            ELSE
 16235                MOVE ER-3781     TO  WS-ERROR
 16236                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16237     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16238     IF PB-COMPANY-ID = 'DCC'
 16239        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 293
* EL050.cbl
 16240        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16241        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16242     END-IF
 16243     IF PB-COMPANY-ID = 'DCC'
 16244        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16245        AND (CP-EARNING-METHOD = 'D')
 16246        AND (CP-CANCEL-REASON NOT = 'R')
 16247        CONTINUE
 16248     ELSE
 16249        GO TO 3750-CONTINUE
 16250     END-IF
 16251     MOVE ' '                    TO DD-IU-SW
 16252     IF NOT PDEF-MASTER-FOUND
 16253        MOVE ' '                 TO PDEF-MASTER-SW
 16254        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16255        MOVE PB-STATE            TO ERPDEF-STATE
 16256        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16257        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16258        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16259        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16260        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16261        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16262        IF PDEF-MASTER-FOUND
 16263           MOVE 'N'              TO PDEF-MASTER-SW
 16264           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16265           IF PDEF-MASTER-FOUND
 16266              IF (ERPDEF-KEY-SAVE (1:16) =
 16267                           PD-CONTROL-PRIMARY (1:16))
 16268                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16269                 CONTINUE
 16270              ELSE
 16271                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16272                 IF (ERPDEF-KEY-SAVE (1:16) =
 16273                           PD-CONTROL-PRIMARY (1:16))
 16274                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16275                    CONTINUE
 16276                 ELSE
 16277                    MOVE ER-2740 TO WS-ERROR
 16278                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16279                    GO TO 3770-CHECK-REFUNDS
 16280                 END-IF
 16281              END-IF
 16282           END-IF
 16283           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16284        END-IF
 16285     END-IF
 16286     IF PDEF-MASTER-FOUND
 16287        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16288           (V1 > +8)
 16289           OR (PD-PROD-CODE (V1) = 'I')
 16290        END-PERFORM
 16291        IF V1 < +9
 16292           SET DD-IU-PRESENT        TO TRUE
 16293        END-IF
 16294        IF WS-AH-DCC-TRUNC = 'T'
 16295           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16296        ELSE
 16297           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 294
* EL050.cbl
 16298        END-IF
 16299        EVALUATE TRUE
 16300           WHEN WS-TERM > +168
 16301              MOVE 15               TO V1
 16302           WHEN WS-TERM > +156
 16303              MOVE 14               TO V1
 16304           WHEN WS-TERM > +144
 16305              MOVE 13               TO V1
 16306           WHEN WS-TERM > +132
 16307              MOVE 12               TO V1
 16308           WHEN WS-TERM > +120
 16309              MOVE 11               TO V1
 16310           WHEN WS-TERM > +108
 16311              MOVE 10               TO V1
 16312           WHEN WS-TERM > +96
 16313              MOVE 9                TO V1
 16314           WHEN WS-TERM > +84
 16315              MOVE 8                TO V1
 16316           WHEN WS-TERM > +72
 16317              MOVE 7                TO V1
 16318           WHEN WS-TERM > +60
 16319              MOVE 6                TO V1
 16320           WHEN WS-TERM > +48
 16321              MOVE 5                TO V1
 16322           WHEN WS-TERM > +36
 16323              MOVE 4                TO V1
 16324           WHEN WS-TERM > +24
 16325              MOVE 3                TO V1
 16326           WHEN WS-TERM > +12
 16327              MOVE 2                TO V1
 16328           WHEN OTHER
 16329              MOVE 1                TO V1
 16330        END-EVALUATE
 16331
 16332        EVALUATE TRUE
 16333*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16334*             < +13)
 16335*             AND (DD-IU-PRESENT)
 16336*             MOVE 2                TO V2
 16337*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16338*             MOVE 1                TO V2
 16339           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16340              MOVE 2                TO V2
 16341           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16342              MOVE 3                TO V2
 16343           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16344              MOVE 4                TO V2
 16345           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16346              MOVE 5                TO V2
 16347           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16348              MOVE 6                TO V2
 16349           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16350              MOVE 7                TO V2
 16351           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16352              MOVE 8                TO V2
 16353           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16354              MOVE 9                TO V2
 16355           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 295
* EL050.cbl
 16356              MOVE 10               TO V2
 16357           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16358              MOVE 11               TO V2
 16359           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16360              MOVE 12               TO V2
 16361           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16362              MOVE 13               TO V2
 16363           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16364              MOVE 14               TO V2
 16365           WHEN OTHER
 16366              MOVE 15               TO V2
 16367        END-EVALUATE
 16368
 16369        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16370                                 TO CP-DDF-LO-FACT
 16371        MOVE PD-UEP-FACTOR (V1 V2)
 16372                                 TO CP-DDF-HI-FACT
 16373
 16374        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16375        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16376        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16377           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16378        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16379        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16380        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16381           + PD-1ST-YR-ADMIN-ALLOW
 16382
 16383        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16384*       IF PI-CLP-YN = 'Y'
 16385*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16386*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16387*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16388*       END-IF
 16389
 16390        IF DD-IU-PRESENT
 16391           MOVE 'I'              TO CP-EARNING-METHOD
 16392        END-IF
 16393        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16394                                     CP-CLP-RATE-UP
 16395        IF CP-IU-RATE-UP NOT = ZEROS
 16396           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16397              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16398           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16399              / (1 - WS-WORK-FACT)
 16400        END-IF
 16401     END-IF
 16402     .
 16403 3750-CONTINUE.
 16404     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16405
 16406     IF CP-REFUND-TYPE-USED NOT = SPACE
 16407         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16408
 16409     IF CP-ERROR-RATE-IS-ZERO OR
 16410        CP-ERROR-RATE-NOT-FOUND
 16411        MOVE ER-2740             TO WS-ERROR
 16412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16413
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 296
* EL050.cbl
 16414     IF CP-ERROR-RATE-FILE-NOTOPEN
 16415        MOVE ER-2617             TO WS-ERROR
 16416        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16417     IF PB-COMPANY-ID = 'DCC'
 16418        AND PB-CI-ENTRY-STATUS = 'M'
 16419        MOVE +0                  TO PB-C-AH-REF-CALC
 16420     ELSE
 16421        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16422     END-IF
 16423     IF PB-COMPANY-ID = 'DCC'
 16424        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16425        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16426        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16427        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16428        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16429        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16430        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16431        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16432*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16433     END-IF
 16434     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 297
* EL050.cbl
 16436
 16437 3770-CHECK-REFUNDS.
 16438
 16439     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16440        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16441           MOVE ER-2766          TO WS-ERROR
 16442           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16443           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16444           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16445              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16446
 16447     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16448        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16449           MOVE ER-2766          TO WS-ERROR
 16450           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16451           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16452           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16453              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16454
 16455     IF PB-COMP-LF-CANCEL
 16456        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16457        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16458           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16459              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16460
 16461     IF PB-COMP-AH-CANCEL
 16462        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16463        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16464           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16465              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16466
 16467     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16468             GIVING WS-UNSIGN-WRK1
 16469     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16470             GIVING WS-UNSIGN-WRK2.
 16471
 16472     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16473         MOVE ZERO TO WS-UNSIGN-WRK1.
 16474
 16475     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16476         MOVE ZERO TO WS-UNSIGN-WRK2.
 16477
 16478     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16479
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 298
* EL050.cbl
 16481
 16482 3772-CONTINUE.
 16483
 16484**********************************
 16485*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16486*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16487*** DOUBLES THE TOLERANCE AMOUNT.
 16488***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16489**********************************
 16490     IF PB-COMPANY-ID = 'MON'
 16491     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16492         IF WS-REF-REJECT-SW = SPACE
 16493             MOVE ER-2754        TO WS-ERROR
 16494             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16495           ELSE
 16496             MOVE ER-2736        TO WS-ERROR
 16497             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16498**********************************
 16499
 16500 3773-CONTINUE.
 16501
 16502     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16503        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16504           MOVE ER-2723          TO WS-ERROR
 16505           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16506
 16507     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16508        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16509           MOVE ER-2724          TO WS-ERROR
 16510           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16511
 16512     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16513         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16514             (1 + WS-LF-REFUND-OVS-PCT)
 16515     ELSE
 16516         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16517
 16518     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16519         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16520             (1 - WS-TOL-LF-REFUND-PCT)
 16521     ELSE
 16522         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16523
 16524     IF (PB-COMPANY-ID = 'DCC')
 16525        AND (PB-CI-ENTRY-STATUS = 'M')
 16526        AND (PB-C-LF-CANCEL-AMT > +0)
 16527        MOVE ER-3843             TO WS-ERROR
 16528        PERFORM 9900-ERROR-FORMAT
 16529                                 THRU 9900-EXIT
 16530     END-IF
 16531     EVALUATE TRUE
 16532        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16533           CONTINUE
 16534        WHEN PB-C-LF-CANCEL-AMT = +0
 16535                 AND PB-C-LF-REF-CALC > +0
 16536           CONTINUE
 16537        WHEN WS-LF-REFUND-OVS-AMT = 0
 16538                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 299
* EL050.cbl
 16539           CONTINUE
 16540        WHEN OTHER
 16541           IF WS-TOL-LF-REFUND  = +0
 16542              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16543           END-IF
 16544           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16545                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16546                          (PB-C-LF-CANCEL-AMT))
 16547              CONTINUE
 16548           ELSE
 16549              IF WS-LF-REFUND-OVS-AMT = +0
 16550                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16551              END-IF
 16552              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16553                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16554                                       PB-C-LF-CANCEL-AMT)
 16555                 CONTINUE
 16556              ELSE
 16557                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16558                   MOVE ER-2754   TO  WS-ERROR
 16559                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16560                 ELSE
 16561                    MOVE ER-2736   TO  WS-ERROR
 16562                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16563                 END-IF
 16564              END-IF
 16565           END-IF
 16566     END-EVALUATE.
 16567
 16568     EVALUATE TRUE
 16569        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16570           CONTINUE
 16571        WHEN PB-C-LF-CANCEL-AMT = +0
 16572                 AND PB-C-LF-REF-CALC > +0
 16573           CONTINUE
 16574        WHEN OTHER
 16575           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16576               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16577              CONTINUE
 16578           ELSE
 16579              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16580               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16581                CONTINUE
 16582              ELSE
 16583                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16584                     MOVE ER-2754   TO  WS-ERROR
 16585                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16586                 ELSE
 16587                     MOVE ER-2736   TO  WS-ERROR
 16588                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16589                 END-IF
 16590              END-IF
 16591           END-IF
 16592     END-EVALUATE.
 16593
 16594     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16595         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16596             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 300
* EL050.cbl
 16597     ELSE
 16598         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16599
 16600     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16601         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16602             (1 - WS-TOL-AH-REFUND-PCT)
 16603     ELSE
 16604         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16605
 16606     IF (PB-COMPANY-ID = 'DCC')
 16607        AND (PB-CI-ENTRY-STATUS = 'M')
 16608        AND (PB-C-AH-CANCEL-AMT > +0)
 16609        MOVE ER-3843             TO WS-ERROR
 16610        PERFORM 9900-ERROR-FORMAT
 16611                                 THRU 9900-EXIT
 16612     END-IF
 16613     EVALUATE TRUE
 16614        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16615           CONTINUE
 16616*       WHEN PB-C-AH-REF-CALC = +0 AND
 16617*                  PB-C-AH-CANCEL-AMT > +0
 16618        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16619                   PB-C-AH-REF-CALC > +0
 16620           CONTINUE
 16621        WHEN WS-AH-REFUND-OVS-AMT = +0
 16622                AND WS-TOL-AH-REFUND = +0
 16623           CONTINUE
 16624        WHEN OTHER
 16625           IF WS-TOL-AH-REFUND = +0
 16626              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16627           END-IF
 16628           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16629               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16630                                         PB-C-AH-CANCEL-AMT)
 16631              CONTINUE
 16632           ELSE
 16633              IF WS-AH-REFUND-OVS-AMT = +0
 16634                 MOVE +9999999.99 TO
 16635                         WS-AH-REFUND-OVS-AMT
 16636              END-IF
 16637              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16638                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16639                                         PB-C-AH-CANCEL-AMT)
 16640                 CONTINUE
 16641              ELSE
 16642                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16643                    MOVE ER-2754   TO  WS-ERROR
 16644                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16645                 ELSE
 16646                    MOVE ER-2736   TO  WS-ERROR
 16647                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16648                 END-IF
 16649              END-IF
 16650           END-IF
 16651     END-EVALUATE.
 16652
 16653     EVALUATE TRUE
 16654        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 301
* EL050.cbl
 16655           CONTINUE
 16656*       WHEN PB-C-AH-REF-CALC > +0 AND
 16657*                  PB-C-AH-CANCEL-AMT = +0
 16658        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16659                   PB-C-AH-REF-CALC = +0
 16660           CONTINUE
 16661        WHEN OTHER
 16662           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16663               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16664              CONTINUE
 16665           ELSE
 16666              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16667                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16668                 CONTINUE
 16669              ELSE
 16670                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16671                     MOVE ER-2754   TO  WS-ERROR
 16672                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16673                 ELSE
 16674                     MOVE ER-2736   TO  WS-ERROR
 16675                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16676                 END-IF
 16677              END-IF
 16678           END-IF
 16679     END-EVALUATE.
 16680
 16681     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16682        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16683        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16684           AND  PB-C-LF-REF-CALC < +1.00
 16685           AND  PB-C-AH-REF-CALC < +1.00
 16686           CONTINUE
 16687        ELSE
 16688           IF (PB-COMPANY-ID = 'DCC')
 16689              AND (PB-CI-ENTRY-STATUS = 'M')
 16690              CONTINUE
 16691           ELSE
 16692              MOVE ER-2741       TO WS-ERROR
 16693              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16694           END-IF
 16695        END-IF
 16696     END-IF
 16697
 16698     IF (PB-C-LF-CANCEL-AMT = ZERO
 16699        AND WS-LF-BENEFIT-CD NOT = ZERO
 16700        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16701        AND PB-C-LF-REF-CALC NOT = ZERO)
 16702        OR
 16703        (PB-C-LF-CANCEL-AMT = ZERO
 16704        AND WS-LF-BENEFIT-CD NOT = ZERO
 16705        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16706             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16707                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16708                NEXT SENTENCE
 16709             ELSE
 16710                MOVE ER-2739        TO WS-ERROR
 16711                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16712
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 302
* EL050.cbl
 16713     IF (PB-C-AH-CANCEL-AMT = ZERO
 16714        AND WS-AH-BENEFIT-CD NOT = ZERO
 16715        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16716        AND PB-C-AH-REF-CALC NOT = ZERO)
 16717        OR
 16718        (PB-C-AH-CANCEL-AMT = ZERO
 16719        AND WS-AH-BENEFIT-CD NOT = ZERO
 16720        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16721             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16722                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16723                NEXT SENTENCE
 16724             ELSE
 16725                MOVE ER-2738        TO WS-ERROR
 16726                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16727
 16728 3775-OVER-REF-CHK.
 16729
 16730     IF PB-CI-ENTRY-STATUS = '5'
 16731        GO TO 3780-UPDATE-CANCEL-CERT.
 16732
 16733     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16734                              PB-CI-LF-ALT-PREMIUM-AMT.
 16735
 16736     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16737        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16738                                 PB-C-LF-REF-CALC
 16739      ELSE
 16740        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16741                                 PB-C-LF-CANCEL-AMT.
 16742
 16743     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16744        MOVE ER-2755             TO WS-ERROR
 16745        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16746
 16747     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16748
 16749     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16750        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16751                                 PB-C-AH-REF-CALC
 16752      ELSE
 16753        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16754                                 PB-C-AH-CANCEL-AMT.
 16755
 16756     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16757        MOVE ER-2778             TO WS-ERROR
 16758        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16759
 16760     IF PB-CI-OB-FLAG NOT = 'Z'
 16761        NEXT SENTENCE
 16762       ELSE
 16763         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16764            MOVE ER-2757           TO WS-ERROR
 16765            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16766
 16767 3780-UPDATE-CANCEL-CERT.
 16768
 16769     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16770        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 303
* EL050.cbl
 16771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16772
 16773     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16774         MOVE ER-2729              TO WS-ERROR
 16775         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16776
 16777     IF PB-CI-LF-BENEFIT-CD = ZERO
 16778         GO TO 3780-UPDATE-CONT-1.
 16779
 16780     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16781         GO TO 3780-UPDATE-CONT-1.
 16782
 16783     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16784       AND
 16785        (PB-C-LF-CANCEL-AMT NEGATIVE)
 16786       AND
 16787        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 16788       AND
 16789        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 16790            NEXT SENTENCE
 16791       ELSE
 16792        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16793          AND
 16794***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16795***       AND
 16796           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 16797            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16798               MOVE ER-2730      TO WS-ERROR
 16799               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16800               GO TO 3999-END-EDIT
 16801            ELSE
 16802               GO TO 3999-END-EDIT
 16803        ELSE
 16804            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 16805               MOVE ER-2765           TO WS-ERROR
 16806               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16807               GO TO 3785-CHECK-NH.
 16808*              GO TO 3999-END-EDIT.
 16809
 16810 3780-UPDATE-CONT-1.
 16811     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 16812
 16813     IF PB-CI-AH-BENEFIT-CD = ZERO
 16814         GO TO 3780-UPDATE-CONT-2.
 16815
 16816     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 16817         GO TO 3780-UPDATE-CONT-2.
 16818
 16819     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 16820
 16821     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16822       AND
 16823        (PB-C-AH-CANCEL-AMT NEGATIVE)
 16824       AND
 16825        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 16826       AND
 16827        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 16828            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 304
* EL050.cbl
 16829       ELSE
 16830        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 16831          AND
 16832***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 16833***       AND
 16834           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 16835           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 16836            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16837               MOVE ER-2773      TO WS-ERROR
 16838               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16839               GO TO 3999-END-EDIT
 16840            ELSE
 16841               GO TO 3999-END-EDIT
 16842            END-IF
 16843           ELSE
 16844             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16845                MOVE ER-2890 TO WS-ERROR
 16846                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16847                GO TO 3999-END-EDIT
 16848             ELSE
 16849                GO TO 3785-CHECK-NH
 16850             END-IF
 16851           END-IF
 16852          ELSE
 16853            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 16854              IF WS-AH-CLAIM-RESCINDED = 'Y'
 16855                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 16856                   MOVE ER-2890 TO WS-ERROR
 16857                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16858                   GO TO 3999-END-EDIT
 16859                ELSE
 16860                   MOVE ER-2765 TO WS-ERROR
 16861                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16862                   GO TO 3785-CHECK-NH
 16863                END-IF
 16864              ELSE
 16865               MOVE ER-2765      TO WS-ERROR
 16866               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16867               GO TO 3785-CHECK-NH.
 16868*              GO TO 3999-END-EDIT.
 16869
 16870 3780-UPDATE-CONT-2.
 16871
 16872     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 16873        AND WS-LF-BENEFIT-CD = ZERO
 16874           MOVE ER-2743           TO WS-ERROR
 16875           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16876
 16877     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 16878        AND WS-AH-BENEFIT-CD = ZERO
 16879           MOVE ER-2744           TO WS-ERROR
 16880           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16881
 16882     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 16883        (PB-C-AH-CANCEL-AMT NEGATIVE))
 16884        AND
 16885        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 16886         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 305
* EL050.cbl
 16887           MOVE ER-2746           TO WS-ERROR
 16888           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16889
 16890     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 16891       AND
 16892        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 16893             MOVE ER-2737        TO WS-ERROR
 16894             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16895
 16896     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 16897       AND
 16898        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 16899             MOVE ER-2737        TO WS-ERROR
 16900             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16901
 16902     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 16903         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 16904             OR 'CID' OR 'DCC' OR 'AHL'
 16905             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 16906         ELSE
 16907             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 16908                 MOVE ER-2768    TO WS-ERROR
 16909                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16910             ELSE
 16911                 MOVE ER-2756    TO WS-ERROR
 16912                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16913
 16914     IF CERT-PEND-ISSUE-RETURNED
 16915        MOVE ER-2772             TO WS-ERROR
 16916        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16917 3785-CHECK-NH.
 16918     IF PB-STATE NOT = 'NH'
 16919        GO TO 3999-END-EDIT
 16920     END-IF
 16921
 16922     MOVE ER-2796                TO WS-ERROR
 16923     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 16924     IF (PB-C-REF-INTERFACE-SW = 'Y')
 16925        OR (CM-NH-INTERFACE-SW = 'Y')
 16926        MOVE ER-2793             TO WS-ERROR
 16927        PERFORM 9900-ERROR-FORMAT
 16928                                 THRU 9900-EXIT
 16929     END-IF
 16930     MOVE +0                     TO WS-PAYMENT-AMT
 16931     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 16932        GO TO 3999-END-EDIT
 16933     END-IF
 16934     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 16935        GO TO 3999-END-EDIT
 16936     END-IF
 16937     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16938     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 16939     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 16940        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 16941     END-IF
 16942     MOVE '1'                    TO DC-OPTION-CODE
 16943     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16944     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 306
* EL050.cbl
 16945        IF DC-ELAPSED-DAYS < +16
 16946           GO TO 3999-END-EDIT
 16947        END-IF
 16948     END-IF
 16949     MOVE +0                     TO DC-ELAPSED-DAYS
 16950     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 16951     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 16952     MOVE '1'                    TO DC-OPTION-CODE
 16953     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 16954     IF NO-CONVERSION-ERROR
 16955        IF DC-ELAPSED-DAYS > +30
 16956           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 16957        ELSE
 16958           GO TO 3999-END-EDIT
 16959        END-IF
 16960     ELSE
 16961        GO TO 3999-END-EDIT
 16962     END-IF
 16963     COMPUTE WS-PAYMENT-AMT ROUNDED =
 16964        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 16965           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 16966     IF WS-PAYMENT-AMT < 600.00
 16967        GO TO 3999-END-EDIT
 16968     END-IF
 16969     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 16970
 16971     IF (ERMAIL-FOUND = ' ')
 16972         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 16973         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 16974        GO TO 3999-END-EDIT
 16975     END-IF
 16976     MOVE ER-2795                TO WS-ERROR
 16977     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16978
 16979     GO TO 3999-END-EDIT.
 16980******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 307
* EL050.cbl
 16982 3990-FILES-NOT-OPEN.
 16983
 16984     MOVE ER-2617                TO WS-ERROR.
 16985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16986     GO TO 9990-RETURN.
 16987
 16988 3999-END-EDIT.
 16989
 16990     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 16991
 16992     IF PB-CANCELLATION AND CERT-WAS-FOUND
 16993         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 16994         IF CERTIFICATE-MASTER = ELCERT-SAVE
 16995             PERFORM 9250-UNLOCK-RETURN
 16996             GO TO 9990-RETURN
 16997          ELSE
 16998             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 16999             GO TO 9990-RETURN.
 17000
 17001     IF PB-CANCELLATION
 17002          GO TO 9990-RETURN.
 17003
 17004     IF CERT-WAS-NOT-FOUND
 17005        MOVE SPACES              TO CERTIFICATE-MASTER.
 17006
 17007     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17008
 17009     IF CERT-WAS-FOUND
 17010         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17011             PERFORM 9250-UNLOCK-RETURN
 17012          ELSE
 17013            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17014      ELSE
 17015         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17016
 17017     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17018        IF PB-COMPANY-ID = 'DCC' AND
 17019           (PB-CARRIER = '2' OR '4' OR '6')
 17020              PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17021        END-IF
 17022     END-IF.
 17023
 17024     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17025         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17026     END-IF.
 17027     move ' '                    to ws-ins-age-defaulted
 17028     perform 8150-read-elcrtt    thru 8150-exit
 17029     if ws-ins-age-defaulted = 'Y'
 17030        move er-1573             to ws-error
 17031        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17032     end-if
 17033
 17034     if ws-jnt-age-defaulted = 'Y'
 17035        move er-1574             to ws-error
 17036        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17037     end-if
 17038
 17039     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 308
* EL050.cbl
 17040     IF ((PB-COMPANY-ID = 'DCC')
 17041        AND (WS-NO-SECURE-PAY))
 17042                  OR
 17043        (WS-LF-SPECIAL-CALC-CD = 'O'
 17044        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17045        SET SKIP-ADDR-EDIT       TO TRUE
 17046     END-IF
 17047     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17048        AND (NOT SKIP-ADDR-EDIT)
 17049        MOVE ER-2963             TO WS-ERROR
 17050        PERFORM 9900-ERROR-FORMAT
 17051                                 THRU 9900-EXIT
 17052        GO TO 9990-RETURN
 17053     END-IF
 17054     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
 17055     IF ERPNDM-FOUND NOT = 'X'
 17056        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17057           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17058           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17059           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17060           AND (NOT SKIP-ADDR-EDIT)
 17061           MOVE ER-2694          TO WS-ERROR
 17062           PERFORM 9900-ERROR-FORMAT
 17063                                 THRU 9900-EXIT
 17064        END-IF
 17065        MOVE ' '                 TO STATE-RECORD-ERROR
 17066        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17067        MOVE PM-STATE            TO CNTL-ACCESS
 17068        MOVE '3'                 TO CNTL-REC-TYPE
 17069        MOVE +0                  TO CNTL-SEQ-NO
 17070        MOVE '0'                 TO RC-SW-2
 17071        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17072        IF (NO-STATE-RECORD)
 17073           OR (CF-RECORD-TYPE NOT = '3')
 17074           OR (PM-STATE NOT = CF-STATE-CODE)
 17075           IF (PM-STATE = SPACES)
 17076              AND (SKIP-ADDR-EDIT)
 17077              CONTINUE
 17078           ELSE
 17079              MOVE ER-2963       TO WS-ERROR
 17080              PERFORM 9900-ERROR-FORMAT
 17081                                 THRU 9900-EXIT
 17082           END-IF
 17083        END-IF
 17084        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17085           MOVE ER-2883          TO WS-ERROR
 17086           PERFORM 9900-ERROR-FORMAT
 17087                                 THRU 9900-EXIT
 17088        END-IF
 17089        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17090           MOVE ' '                 TO STATE-RECORD-ERROR
 17091           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17092           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17093           MOVE '3'                 TO CNTL-REC-TYPE
 17094           MOVE +0                  TO CNTL-SEQ-NO
 17095           MOVE '0'                 TO RC-SW-2
 17096           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17097           IF NO-STATE-RECORD
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 309
* EL050.cbl
 17098              OR (CF-RECORD-TYPE NOT = '3')
 17099              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17100              MOVE ER-2964          TO WS-ERROR
 17101              PERFORM 9900-ERROR-FORMAT
 17102                                    THRU 9900-EXIT
 17103           END-IF
 17104        END-IF
 17105     ELSE
 17106        IF NOT SKIP-ADDR-EDIT
 17107           MOVE ER-2393          TO WS-ERROR
 17108           PERFORM 9900-ERROR-FORMAT
 17109                                 THRU 9900-EXIT
 17110        END-IF
 17111     END-IF
 17112
 17113     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17114
 17115     IF (ERMAIL-FOUND = ' ' AND
 17116        ERPNDM-FOUND = ' ')
 17117        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17118           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17119           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17120          OR
 17121           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17122          OR
 17123           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17124           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17125           GO TO 3999-UNLOCK-ERMAIL.
 17126
 17127     IF ERPNDM-FOUND = 'X'
 17128        GO TO 3999-UNLOCK-ERMAIL.
 17129
 17130     IF PM-INSURED-LAST-NAME      = SPACES
 17131        AND PM-INSURED-FIRST-NAME = SPACES
 17132        AND PM-ADDRESS-LINE-1     = SPACES
 17133        AND PM-ADDRESS-LINE-2     = SPACES
 17134        AND PM-CITY-STATE         = SPACES
 17135        AND PM-CRED-BENE-NAME     = SPACES
 17136        AND PM-CRED-BENE-ADDR     = SPACES
 17137        AND PM-CRED-BENE-CTYST    = SPACES
 17138        GO TO 3999-UNLOCK-ERMAIL
 17139     END-IF
 17140
 17141     MOVE SPACES                 TO MAILING-DATA.
 17142
 17143     MOVE 'MA'                   TO MA-RECORD-ID.
 17144     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17145     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17146     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17147     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17148     MOVE PB-SV-STATE            TO MA-STATE.
 17149     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17150     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17151
 17152     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17153     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17154
 17155     IF ERMAIL-FOUND = ' '
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 310
* EL050.cbl
 17156        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17157     ELSE
 17158        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17159        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17160        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17161
 17162     GO TO 9990-RETURN.
 17163
 17164 3999-UNLOCK-ERMAIL.
 17165     IF ERMAIL-FOUND = ' '
 17166        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17167
 17168     GO TO 9990-RETURN.
 17169******************************************************************
 17170
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 311
* EL050.cbl
 17172 4000-UPDATE-CANCELLED-CERT.
 17173     IF CERT-WAS-NOT-FOUND
 17174        GO TO 4299-EXIT.
 17175
 17176*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17177     IF PB-C-NH-INT-ON-REFS > ZEROS
 17178        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17179     END-IF
 17180     IF PB-C-REF-INTERFACE-SW = 'Y'
 17181        MOVE PB-C-REF-INTERFACE-SW
 17182                                 TO CM-NH-INTERFACE-SW
 17183     END-IF
 17184     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17185     IF ERMAIL-FOUND = 'X'
 17186        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17187        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17188        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17189        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17190           MOVE ER-2694          TO WS-ERROR
 17191           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17192     END-IF
 17193
 17194     IF PB-C-POST-CARD-IND = 'Y'
 17195        MOVE +8                  TO SUB
 17196*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17197        IF ERMAIL-FOUND = ' '
 17198           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17199              (SUB > +7)
 17200              OR (MA-MAIL-STATUS (SUB) = '1')
 17201           END-PERFORM
 17202        END-IF
 17203        IF (SUB > +7)
 17204           OR (ERMAIL-FOUND = 'X')
 17205           MOVE ER-3789          TO WS-ERROR
 17206           PERFORM 9900-ERROR-FORMAT
 17207                                 THRU 9900-EXIT
 17208        END-IF
 17209     ELSE
 17210        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17211     END-IF
 17212
 17213     IF ERMAIL-FOUND = ' '
 17214        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17215     END-IF.
 17216
 17217     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17218
 17219     IF PB-CI-OB-FLAG = 'Z'
 17220        GO TO 4150-SUMMARY-CERT-CANCEL.
 17221
 17222     IF PB-C-LF-CANCEL-VOIDED
 17223         PERFORM 4200-REVERSE-LF-CANCEL.
 17224     IF PB-C-AH-CANCEL-VOIDED
 17225         PERFORM 4200-REVERSE-AH-CANCEL.
 17226
 17227 4100-APPLY-LF-CANCEL.
 17228
 17229     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 312
* EL050.cbl
 17230
 17231 4100-CHECK-LF-ERRORS.
 17232
 17233     ADD +1                       TO WS-SUB.
 17234
 17235     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17236        IF LF-COVERAGE-CANCELLED
 17237           GO TO 4100-LF-CANCEL-CONT
 17238        ELSE
 17239           GO TO 4100-UPDATE-LF-COVERAGE.
 17240
 17241     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17242                                   ER-2729 OR
 17243                                   ER-2730 OR
 17244                                   ER-2731 OR
 17245                                   ER-2732 OR
 17246                                   ER-2737 OR
 17247                                   ER-2740 OR
 17248                                   ER-2743 OR
 17249                                   ER-2749 OR
 17250                                   ER-2750 OR
 17251                                   ER-2755 OR
 17252                                   ER-2757 OR
 17253                                   ER-2760 OR
 17254                                   ER-2772 OR
 17255                                   ER-2774 OR
 17256                                   ER-2776 OR
 17257                                   ER-2794
 17258        GO TO 4100-UPDATE-LF-COVERAGE.
 17259
 17260     GO TO 4100-CHECK-LF-ERRORS.
 17261
 17262 4100-UPDATE-LF-COVERAGE.
 17263
 17264     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17265     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17266     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17267        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17268     END-IF
 17269     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17270                                      TO CM-CREDIT-INTERFACE-SW-2.
 17271     IF CM-LF-CANCEL-DT = LOW-VALUE
 17272         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17273
 17274     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17275         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17276                                         CM-LF-STATUS-AT-CANCEL.
 17277
 17278     GO TO 4100-APPLY-AH-CANCEL.
 17279
 17280 4100-LF-CANCEL-CONT.
 17281     IF PB-C-LF-CANCEL-VOIDED
 17282         GO TO 4100-APPLY-AH-CANCEL.
 17283
 17284     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17285         GO TO 4100-APPLY-AH-CANCEL.
 17286
 17287     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 313
* EL050.cbl
 17288        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17289           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17290        ELSE
 17291           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17292
 17293     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17294     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17295
 17296     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17297         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17298
 17299     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17300        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17301         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17302         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17303
 17304     IF PB-RECORD-RETURNED
 17305        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17306      ELSE
 17307        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17308
 17309 4100-APPLY-AH-CANCEL.
 17310
 17311     MOVE +0                      TO WS-SUB.
 17312
 17313 4100-CHECK-AH-ERRORS.
 17314
 17315     ADD +1                       TO WS-SUB.
 17316
 17317     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17318        IF AH-COVERAGE-CANCELLED
 17319           GO TO 4100-AH-CANCEL-CONT
 17320        ELSE
 17321           GO TO 4100-UPDATE-AH-COVERAGE.
 17322
 17323     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17324                                   ER-2729 OR
 17325                                   ER-2732 OR
 17326                                   ER-2737 OR
 17327                                   ER-2740 OR
 17328                                   ER-2744 OR
 17329                                   ER-2749 OR
 17330                                   ER-2750 OR
 17331                                   ER-2778 OR
 17332                                   ER-2757 OR
 17333                                   ER-2760 OR
 17334                                   ER-2771 OR
 17335                                   ER-2772 OR
 17336                                   ER-2773 OR
 17337                                   ER-2775 OR
 17338                                   ER-2777 OR
 17339                                   ER-2794
 17340        GO TO 4100-UPDATE-AH-COVERAGE.
 17341
 17342     GO TO 4100-CHECK-AH-ERRORS.
 17343
 17344 4100-UPDATE-AH-COVERAGE.
 17345
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 314
* EL050.cbl
 17346     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17347     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17348     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17349     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17350                                      TO CM-CREDIT-INTERFACE-SW-2.
 17351     IF CM-AH-CANCEL-DT = LOW-VALUE
 17352         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17353
 17354     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17355         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17356                                         CM-AH-STATUS-AT-CANCEL.
 17357
 17358     IF LF-COVERAGE-CANCELLED
 17359         IF PB-RECORD-RETURNED
 17360              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17361          ELSE
 17362              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17363
 17364     GO TO 4299-EXIT.
 17365
 17366 4100-AH-CANCEL-CONT.
 17367     IF PB-C-AH-CANCEL-VOIDED
 17368         GO TO 4299-EXIT.
 17369
 17370     if cm-credit-interface-sw-2 = ' '
 17371        if pb-fatal-errors or pb-unforced-errors
 17372           move '4'              to cm-credit-interface-sw-2
 17373        else
 17374           move '1'              to cm-credit-interface-sw-2
 17375        end-if
 17376     end-if
 17377     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17378         GO TO 4299-EXIT.
 17379
 17380     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17381        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17382           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17383        ELSE
 17384           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17385
 17386     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17387     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17388
 17389     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17390         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17391
 17392     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17393         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17394         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17395
 17396     IF PB-RECORD-RETURNED
 17397        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17398      ELSE
 17399        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17400
 17401     GO TO 4299-EXIT.
 17402
 17403 4150-SUMMARY-CERT-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 315
* EL050.cbl
 17404     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17405
 17406     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17407        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17408                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17409     ELSE
 17410        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17411                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17412
 17413     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17414        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17415                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17416     ELSE
 17417        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17418                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17419
 17420     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17421        NEXT SENTENCE
 17422     ELSE
 17423        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17424
 17425     GO TO 4299-EXIT.
 17426
 17427 4200-REVERSE-LF-CANCEL.
 17428     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17429
 17430     IF CM-LF-CANCEL-APPLIED
 17431        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17432        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17433        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17434
 17435     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17436
 17437     IF PB-RECORD-RETURNED
 17438        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17439       ELSE
 17440        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17441
 17442 4200-REVERSE-LF-EXIT.
 17443       EXIT.
 17444
 17445 4200-REVERSE-AH-CANCEL.
 17446     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17447
 17448     IF CM-AH-CANCEL-APPLIED
 17449        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17450        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17451        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17452
 17453     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17454
 17455     IF PB-RECORD-RETURNED
 17456        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17457       ELSE
 17458        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17459
 17460 4200-REVERSE-AH-EXIT.
 17461       EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 316
* EL050.cbl
 17462
 17463 4299-EXIT.
 17464       EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 317
* EL050.cbl
 17466
 17467 4500-UPDATE-NEW-CERT.
 17468     IF CERT-WAS-FOUND
 17469         NEXT SENTENCE
 17470       ELSE
 17471         GO TO 4520-BUILD-NEW-KEY.
 17472
 17473     IF  CLASIC-CREATED-CERT
 17474         GO TO 4999-EXIT.
 17475
 17476     IF  CERT-WAS-CREATED-FOR-CLAIM
 17477         GO TO 4520-BUILD-NEW-KEY.
 17478
 17479     IF CERT-ADDED-BATCH
 17480        IF CM-RECORD-ID = 'CM'
 17481            GO TO 4999-EXIT.
 17482
 17483 4520-BUILD-NEW-KEY.
 17484* BUILD CONTROL PRIMARY
 17485
 17486     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17487                                       CM-COMPANY-CD-A1
 17488                                       CM-COMPANY-CD-A2
 17489                                       CM-COMPANY-CD-A4
 17490                                       CM-COMPANY-CD-A5.
 17491
 17492     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17493     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17494     MOVE PB-SV-STATE               TO CM-STATE.
 17495     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17496     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17497     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17498     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17499
 17500     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17501
 17502     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17503     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17504     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17505     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17506
 17507     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17508        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17509
 17510     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17511         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17512         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17513         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17514         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17515     ELSE
 17516         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17517
 17518     IF PB-COMPANY-ID   EQUAL  'CRI'
 17519         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17520         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17521         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17522         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17523         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 318
* EL050.cbl
 17524
 17525     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17526        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17527         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17528
 17529     IF PB-COMPANY-ID  = 'LBL'
 17530        IF PB-I-JOINT-COVERAGE
 17531            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17532                                           PB-I-MEMBER-NO
 17533            GO TO 4550-CONT-CERT-PROCESS.
 17534
 17535     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17536        NEXT SENTENCE
 17537     ELSE
 17538        GO TO 4540-BUILD-MEMBER-NO.
 17539
 17540******************************************************************
 17541*                                                                *
 17542*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17543*    FOR 'MON'.                                                  *
 17544*                                                                *
 17545******************************************************************
 17546
 17547     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17548     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17549     MOVE +1                     TO WS-SUB1
 17550                                    WS-SUB2.
 17551
 17552 4530-EDIT-MEMB-NAME.
 17553
 17554     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17555        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17556        ADD +1                       TO WS-SUB2.
 17557
 17558     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17559        ADD +1                       TO WS-SUB1
 17560        GO TO 4530-EDIT-MEMB-NAME.
 17561
 17562     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17563     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17564     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17565*    MOVE SPACE                      TO DC-OPTION-CODE.
 17566     SET  BIN-TO-GREG                TO TRUE.
 17567     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17568     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17569
 17570     GO TO 4550-CONT-CERT-PROCESS.
 17571
 17572******************************************************************
 17573*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17574******************************************************************
 17575
 17576 4540-BUILD-MEMBER-NO.
 17577
 17578     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17579         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17580         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17581         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 319
* EL050.cbl
 17582         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17583     ELSE
 17584         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17585
 17586     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17587        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17588         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17589
 17590 4550-CONT-CERT-PROCESS.
 17591
 17592*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17593*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17594*    ELSE
 17595*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17596
 17597     IF CERT-WAS-CREATED-FOR-CLAIM
 17598        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17599        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17600
 17601     IF CERT-AND-CLAIM-ONLINE
 17602        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17603        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17604
 17605     MOVE 'CM'                     TO CM-RECORD-ID.
 17606     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17607
 17608     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17609        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17610        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17611     ELSE
 17612        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17613        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17614
 17615     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17616     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17617     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17618     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17619     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17620     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17621     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17622                                      CM-LF-ITD-CANCEL-AMT
 17623                                      CM-LF-ITD-DEATH-AMT
 17624                                      CM-AH-ITD-AH-PMT
 17625                                      CM-AH-ITD-LUMP-PMT
 17626                                      CM-AH-ITD-CANCEL-AMT
 17627                                      CM-LF-NSP-PREMIUM-AMT
 17628                                      CM-AH-NSP-PREMIUM-AMT.
 17629*                                     CM-CLAIM-DEDUCT-WITHHELD
 17630*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17631     if pb-i-loan-apr = +99.9999
 17632        move zeros                 to cm-loan-apr
 17633     else
 17634        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17635     end-if
 17636     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17637     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17638     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17639     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 320
* EL050.cbl
 17640     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17641     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17642     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17643     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17644     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17645     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17646     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17647
 17648     IF PB-I-LIVES NOT NUMERIC
 17649         MOVE ZERO                 TO PB-I-LIVES.
 17650
 17651     IF PB-I-NUM-BILLED NOT NUMERIC
 17652         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17653
 17654     MOVE PB-I-LIVES               TO CM-LIVES.
 17655     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17656
 17657     IF PB-COMPANY-ID EQUAL  'DMD'
 17658         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17659         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17660
 17661     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17662     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17663     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17664     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17665     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17666     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17667
 17668     IF PB-I-LF-POLICY-FEE NUMERIC
 17669        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17670     ELSE
 17671        MOVE +0                    TO CM-LF-POLICY-FEE.
 17672
 17673     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17674        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17675        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17676     ELSE
 17677        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17678
 17679     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17680     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17681     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17682     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17683     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17684     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17685     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17686     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17687     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17688
 17689     IF PB-I-AH-POLICY-FEE NUMERIC
 17690        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17691     ELSE
 17692        MOVE +0                    TO CM-AH-POLICY-FEE.
 17693
 17694     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17695        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17696     ELSE
 17697        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 321
* EL050.cbl
 17698
 17699     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17700     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17701
 17702     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17703                                      CM-LF-DEATH-EXIT-DT
 17704                                      CM-AH-SETTLEMENT-EXIT-DT.
 17705
 17706*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17707*                       'TIH' OR 'OFL' OR 'FLA' OR
 17708*                       'TII' OR 'TMS' OR 'CRI' OR
 17709*                       'NCL'
 17710     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17711
 17712     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17713         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17714            MOVE '2'                TO CM-PREMIUM-TYPE.
 17715
 17716     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17717         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17718            MOVE '2'                TO CM-PREMIUM-TYPE.
 17719
 17720     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17721         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17722     ELSE
 17723         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17724         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17725
 17726     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17727     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 17728     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 17729     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 17730     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 17731     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 17732     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 17733     MOVE SPACE                     TO CM-PAYMENT-MODE.
 17734
 17735     IF PB-NO-MONTHS-SKIPPED
 17736         MOVE SPACE                 TO CM-SKIP-CODE
 17737     ELSE
 17738         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 17739
 17740     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 17741     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 17742                                       CM-LF-STATUS-AT-CANCEL.
 17743
 17744     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 17745     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 17746                                       CM-AH-STATUS-AT-CANCEL.
 17747
 17748     MOVE '1'                       TO CM-ENTRY-STATUS.
 17749
 17750     IF PB-REISSUED-CERT
 17751        MOVE '5'                    TO CM-ENTRY-STATUS.
 17752
 17753     IF PB-MONTHLY-CERT
 17754        MOVE 'M'                    TO CM-ENTRY-STATUS.
 17755
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 322
* EL050.cbl
 17756     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 17757     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 17758     IF PB-POLICY-IS-DECLINED
 17759        MOVE 'D'                    TO CM-ENTRY-STATUS.
 17760
 17761     IF PB-POLICY-IS-VOIDED
 17762        MOVE 'V'                    TO CM-ENTRY-STATUS.
 17763
 17764     IF PB-NEEDS-UNDERWRITING
 17765        MOVE 'U'                    TO CM-ENTRY-STATUS.
 17766
 17767     IF PB-REIN-ONLY-CERT
 17768        MOVE '9'                    TO CM-ENTRY-STATUS.
 17769
 17770     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 17771         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 17772     ELSE
 17773         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 17774
 17775     IF PB-RECORD-RETURNED
 17776        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 17777      ELSE
 17778        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 17779
 17780     IF PB-I-MAIL-ADDRS-PRESENT
 17781        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 17782
 17783     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 17784                                       CM-ENTRY-DT.
 17785
 17786 4999-EXIT.
 17787     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 323
* EL050.cbl
 17789
 17790 5000-PROCESS-REPS.
 17791     MOVE ' '                    TO AGTC-MASTER-SW
 17792     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 17793     MOVE CO-TYPE                TO AGTC-TYPE
 17794     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 17795     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 17796     IF (AGTC-MASTER-SW NOT = 'N')
 17797        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 17798        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 17799        PERFORM 8583-READ-ERAGTC-NEXT
 17800                                 THRU 8583-EXIT
 17801     END-IF
 17802     IF AGTC-MASTER-SW = 'N'
 17803        CONTINUE
 17804     ELSE
 17805        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 17806           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 17807              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 17808              MOVE 'Y'           TO AGTC-MASTER-SW
 17809           END-IF
 17810        END-IF
 17811     END-IF
 17812     .
 17813 5000-EXIT.
 17814     EXIT.
 17815 6370-EDIT-INPUT-LF-CODE.
 17816     move ' ' to ws-benefit-cd-chg-sw
 17817     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 17818        MOVE +1                  TO SUB
 17819        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 17820        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17821        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17822        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17823        GO TO 6370-SEARCH-LOOP.
 17824
 17825     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17826
 17827     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17828     MOVE SPACES                 TO CNTL-ACCESS.
 17829*    MOVE 'L'                    TO CNTL-REC-TYPE.
 17830     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 17831     MOVE +0                     TO CNTL-SEQ-NO.
 17832     MOVE '4' TO RC-SW-2.
 17833     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17834
 17835     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17836        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17837        GO TO 6370-NO-LF-FOUND.
 17838
 17839     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 17840     MOVE +1                     TO SUB.
 17841
 17842 6370-SEARCH-LOOP.
 17843     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 17844         GO TO 6370-NO-LF-FOUND.
 17845
 17846     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 324
* EL050.cbl
 17847        if (pb-i-lf-benefit-cd not = zeros and spaces)
 17848           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 17849           set benefit-code-chg to true
 17850        end-if
 17851        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 17852        GO TO 6370-HER-NET-PAY-CHECK.
 17853
 17854     ADD 1   TO SUB.
 17855*    IF SUB GREATER 120
 17856     IF SUB GREATER 200
 17857         GO TO 6370-NO-LF-FOUND.
 17858
 17859     GO TO 6370-SEARCH-LOOP.
 17860
 17861 6370-NO-LF-FOUND.
 17862
 17863     if (pb-i-lf-benefit-cd not = zeros and spaces)
 17864        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 17865        set benefit-code-chg to true
 17866     end-if
 17867     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 17868
 17869 6370-HER-NET-PAY-CHECK.
 17870
 17871     IF PB-COMPANY-ID = 'CID'
 17872        IF PB-SV-STATE = 'CA' OR 'MN'
 17873           IF PB-I-LF-BENEFIT-CD = '02'
 17874              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 17875           ELSE
 17876              IF PB-I-LF-BENEFIT-CD = '04'
 17877                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 17878              END-IF
 17879           END-IF
 17880        END-IF
 17881     END-IF
 17882
 17883     IF PB-COMPANY-ID NOT = 'HER'
 17884         GO TO 6370-EXIT.
 17885
 17886     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 17887         GO TO 6370-EXIT.
 17888
 17889     IF PB-I-LF-TERM NOT NUMERIC
 17890         MOVE ZEROS              TO PB-I-LF-TERM.
 17891
 17892     IF PB-I-LOAN-TERM NOT NUMERIC
 17893         MOVE ZEROS              TO PB-I-LOAN-TERM.
 17894
 17895     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 17896         GO TO 6370-EXIT.
 17897
 17898     IF PB-I-LF-BENEFIT-CD = '33'
 17899         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 17900
 17901     IF PB-I-LF-BENEFIT-CD = '34'
 17902         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 17903
 17904 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 325
* EL050.cbl
 17905     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 326
* EL050.cbl
 17907
 17908 6380-EDIT-INPUT-AH-CODE.
 17909     IF WK-AH-EDIT-ADDR NOT = ZEROS
 17910        MOVE +1                  TO SUB
 17911        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 17912        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 17913        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 17914        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 17915        GO TO 6380-SEARCH-LOOP.
 17916
 17917     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 17918
 17919     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 17920     MOVE SPACES                 TO CNTL-ACCESS.
 17921     MOVE 'A'                    TO CNTL-REC-TYPE.
 17922*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 17923     MOVE +0                     TO CNTL-SEQ-NO.
 17924     MOVE '5' TO RC-SW-2.
 17925     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 17926
 17927     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 17928        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 17929        GO TO 6380-NO-AH-FOUND.
 17930
 17931     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 17932     MOVE +1 TO SUB.
 17933
 17934 6380-SEARCH-LOOP.
 17935     IF CF-AH-CODE-OUT (SUB) = ZEROS
 17936         GO TO 6380-NO-AH-FOUND.
 17937
 17938     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 17939         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 17940         GO TO 6380-CSO-AH-ONLY-CHECKS.
 17941
 17942     ADD 1   TO SUB.
 17943     IF SUB GREATER THAN 96
 17944*    IF SUB GREATER THAN 300
 17945         GO TO 6380-NO-AH-FOUND.
 17946
 17947     GO TO 6380-SEARCH-LOOP.
 17948
 17949 6380-NO-AH-FOUND.
 17950
 17951     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 17952
 17953     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 17954         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 17955     ELSE
 17956         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 17957
 17958 6380-CSO-AH-ONLY-CHECKS.
 17959
 17960     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 17961        NEXT SENTENCE
 17962      ELSE
 17963        GO TO 6380-EXIT.
 17964
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 327
* EL050.cbl
 17965     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 17966         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 17967
 17968
 17969     GO TO 6380-EXIT
 17970     .
 17971 6380-CSO-LIFE-WITH-AH-CHECKS.
 17972
 17973
 17974     .
 17975 6380-EXIT.
 17976     EXIT.
 17977
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 328
* EL050.cbl
 17979
 17980 6400-COMPUTE-EXTENSION-DAYS.
 17981
 17982******************************************************************
 17983*                                                                *
 17984*                   COMPUTE EXTENSION DAYS                       *
 17985*                                                                *
 17986*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 17987*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 17988*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 17989*    THE EXTENSION DAYS.                                         *
 17990*                                                                *
 17991******************************************************************
 17992
 17993     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 17994     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 17995
 17996******************************************************************
 17997*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 17998*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 17999******************************************************************
 18000
 18001     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18002        COMPUTE WS-ODD-DAYS-OVER =
 18003               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18004     ELSE
 18005        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18006
 18007     IF WS-ODD-DAYS-OVER = ZEROS
 18008           GO TO 6499-EXIT
 18009     ELSE
 18010        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18011           IF WS-WDF-MONTH = 02
 18012              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18013              ADD 2       TO  WS-ODD-DAYS-OVER
 18014              GO TO 6499-EXIT
 18015           ELSE
 18016              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18017                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18018                 GO TO 6499-EXIT
 18019               ELSE
 18020                 GO TO 6499-EXIT
 18021        ELSE
 18022           GO TO 6499-EXIT.
 18023
 18024 6412-CHECK-TO-DAY.
 18025
 18026        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18027           IF WS-WDT-DAY = 28
 18028              ADD 2              TO WS-ODD-DAYS-OVER
 18029           ELSE
 18030              IF WS-WDT-DAY = 29
 18031                 ADD 1           TO WS-ODD-DAYS-OVER
 18032              ELSE
 18033                 NEXT SENTENCE
 18034        ELSE
 18035           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18036              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 329
* EL050.cbl
 18037
 18038     GO TO 6499-EXIT.
 18039
 18040
 18041 6415-CHECK-LEAP-YEAR.
 18042
 18043     IF DC-DAYS-IN-MONTH = 29
 18044        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18045
 18046 6415-EXIT.
 18047     EXIT.
 18048
 18049 6499-EXIT.
 18050      EXIT.
 18051
 18052 6500-END.
 18053     EXIT.
 18054
 18055
 18056******************************************************************
 18057************* PROCEDURE DIVISION FOR EL050 ***********************
 18058********************** ELC50PD END *******************************
 18059
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 330
* EL050.cbl
 18061
 18062**START***********************************************************
 18063*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18064*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18065******************************************************************
 18066*
 18067 6600-GET-STATE-MUNICIPAL-TAX.
 18068
 18069     IF PB-COMPANY-ID NOT = 'DMD'
 18070         GO TO 6640-EXIT.
 18071
 18072     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18073     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18074     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18075*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18076*
 18077***  Y2K PROJ 7744
 18078     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18079     SET BIN-TO-GREG          TO TRUE.
 18080     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18081
 18082     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18083
 18084     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18085     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18086
 18087
 18088* EXEC CICS HANDLE CONDITION
 18089*        INVREQ    (6610-START-BROWSE)
 18090*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18091*        NOTFND    (6630-END-OF-FILE)
 18092*    END-EXEC.
 18093*    MOVE '"$8JI                 ! # #00018075' TO DFHEIV0
 18094     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18096     MOVE X'2320233030303138303735' TO DFHEIV0(25:11)
 18097     CALL 'kxdfhei1' USING DFHEIV0
 18098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18099
 18100
 18101 6610-START-BROWSE.
 18102
 18103
 18104* EXEC CICS HANDLE CONDITION
 18105*        NOTFND    (6630-END-OF-FILE)
 18106*        DISABLED  (6630-ERRESS-PROBLEM)
 18107*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18108*        ENDFILE   (6630-END-OF-FILE)
 18109*    END-EXEC.
 18110*    MOVE '"$IcJ''                ! $ #00018083' TO DFHEIV0
 18111     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18112     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18113     MOVE X'2420233030303138303833' TO DFHEIV0(25:11)
 18114     CALL 'kxdfhei1' USING DFHEIV0
 18115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18116
 18117
 18118
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 331
* EL050.cbl
 18119* EXEC CICS STARTBR
 18120*        DATASET (FILE-ID-ERRESS)
 18121*        RIDFLD  (WS-ERRESS-KEY)
 18122*        GTEQ
 18123*    END-EXEC.
 18124     MOVE 0
 18125       TO DFHEIV11
 18126*    MOVE '&,         G          &   #00018090' TO DFHEIV0
 18127     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18128     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18129     MOVE X'2020233030303138303930' TO DFHEIV0(25:11)
 18130     CALL 'kxdfhei1' USING DFHEIV0,
 18131           FILE-ID-ERRESS,
 18132           WS-ERRESS-KEY,
 18133           DFHEIV99,
 18134           DFHEIV11,
 18135           DFHEIV99
 18136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18137
 18138
 18139 6620-READ-NEXT-ERRESS-MASTER.
 18140
 18141
 18142* EXEC CICS HANDLE CONDITION
 18143*        NOTFND    (6630-END-OF-FILE)
 18144*        ENDFILE   (6630-END-OF-FILE)
 18145*        DISABLED  (6630-ERRESS-PROBLEM)
 18146*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18147*    END-EXEC.
 18148*    MOVE '"$I''cJ                ! % #00018098' TO DFHEIV0
 18149     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18150     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18151     MOVE X'2520233030303138303938' TO DFHEIV0(25:11)
 18152     CALL 'kxdfhei1' USING DFHEIV0
 18153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18154
 18155
 18156
 18157* EXEC CICS READNEXT
 18158*        DATASET (FILE-ID-ERRESS)
 18159*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18160*        RIDFLD  (WS-ERRESS-KEY)
 18161*    END-EXEC.
 18162     MOVE LENGTH OF
 18163      RESIDENT-STATE-TAX-MASTER
 18164       TO DFHEIV12
 18165     MOVE 0
 18166       TO DFHEIV11
 18167*    MOVE '&.IL                  )   #00018105' TO DFHEIV0
 18168     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18169     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18170     MOVE X'2020233030303138313035' TO DFHEIV0(25:11)
 18171     CALL 'kxdfhei1' USING DFHEIV0,
 18172           FILE-ID-ERRESS,
 18173           RESIDENT-STATE-TAX-MASTER,
 18174           DFHEIV12,
 18175           WS-ERRESS-KEY,
 18176           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 332
* EL050.cbl
 18177           DFHEIV11,
 18178           DFHEIV99,
 18179           DFHEIV99
 18180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18181
 18182
 18183     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18184
 18185* EXEC CICS ENDBR
 18186*            DATASET (FILE-ID-ERRESS)
 18187*       END-EXEC
 18188     MOVE 0
 18189       TO DFHEIV11
 18190*    MOVE '&2                    $   #00018112' TO DFHEIV0
 18191     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18192     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18193     MOVE X'2020233030303138313132' TO DFHEIV0(25:11)
 18194     CALL 'kxdfhei1' USING DFHEIV0,
 18195           FILE-ID-ERRESS,
 18196           DFHEIV11,
 18197           DFHEIV99
 18198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18199        GO TO 6630-END-OF-FILE.
 18200
 18201     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18202        NEXT SENTENCE
 18203      ELSE
 18204        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18205
 18206*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18207*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18208*
 18209     MOVE +2                     TO WS-SUB1.
 18210
 18211     IF PB-ISSUE
 18212     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18213        MOVE +1                  TO WS-SUB1.
 18214
 18215     IF PB-CANCELLATION
 18216     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18217        MOVE +1                  TO WS-SUB1.
 18218*
 18219*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18220*
 18221***  Y2K PROJ 7744
 18222     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18223***  Y2K PROJ 7744
 18224
 18225*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18226* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18227* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18228
 18229     ADD 1                    TO WS-YEAR-YY.
 18230
 18231     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18232         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18233                              TO WS-RES-STATE-TAX
 18234         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 333
* EL050.cbl
 18235                              TO WS-RES-MUNI-TAX
 18236     ELSE
 18237         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18238                              TO WS-RES-STATE-TAX
 18239         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18240                              TO WS-RES-MUNI-TAX.
 18241
 18242*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18243
 18244     IF PB-CANCELLATION
 18245         GO TO 6640-CANCEL-TAX.
 18246
 18247     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18248         COMPUTE PB-I-STATE-TAX ROUNDED =
 18249                                   PB-I-LF-PREMIUM-AMT
 18250                                 * WS-RES-STATE-TAX
 18251         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18252                                   PB-I-LF-PREMIUM-AMT
 18253                                 * WS-RES-MUNI-TAX
 18254     ELSE
 18255     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18256         COMPUTE PB-I-STATE-TAX ROUNDED =
 18257                                   PB-I-AH-PREMIUM-AMT
 18258                                 * WS-RES-STATE-TAX
 18259         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18260                                   PB-I-AH-PREMIUM-AMT
 18261                                 * WS-RES-MUNI-TAX.
 18262
 18263
 18264* EXEC CICS ENDBR
 18265*         DATASET (FILE-ID-ERRESS)
 18266*    END-EXEC.
 18267     MOVE 0
 18268       TO DFHEIV11
 18269*    MOVE '&2                    $   #00018179' TO DFHEIV0
 18270     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18271     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18272     MOVE X'2020233030303138313739' TO DFHEIV0(25:11)
 18273     CALL 'kxdfhei1' USING DFHEIV0,
 18274           FILE-ID-ERRESS,
 18275           DFHEIV11,
 18276           DFHEIV99
 18277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18278
 18279
 18280     GO TO 6640-EXIT.
 18281
 18282 6640-CANCEL-TAX.
 18283     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18284
 18285     IF PB-C-LF-CANCEL-AMT > ZEROS
 18286         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18287                                   PB-C-LF-CANCEL-AMT
 18288                                 * WS-RES-STATE-TAX
 18289         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18290                                   PB-C-LF-CANCEL-AMT
 18291                                *  WS-RES-MUNI-TAX
 18292     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 334
* EL050.cbl
 18293     IF PB-C-AH-CANCEL-AMT > ZEROS
 18294         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18295                                   PB-C-AH-CANCEL-AMT
 18296                                 * WS-RES-STATE-TAX
 18297         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18298                                   PB-C-AH-CANCEL-AMT
 18299                                *  WS-RES-MUNI-TAX.
 18300
 18301
 18302* EXEC CICS ENDBR
 18303*         DATASET (FILE-ID-ERRESS)
 18304*    END-EXEC.
 18305     MOVE 0
 18306       TO DFHEIV11
 18307*    MOVE '&2                    $   #00018204' TO DFHEIV0
 18308     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18309     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18310     MOVE X'2020233030303138323034' TO DFHEIV0(25:11)
 18311     CALL 'kxdfhei1' USING DFHEIV0,
 18312           FILE-ID-ERRESS,
 18313           DFHEIV11,
 18314           DFHEIV99
 18315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18316
 18317
 18318     GO TO 6640-EXIT.
 18319
 18320 6630-END-OF-FILE.
 18321     MOVE ER-8002              TO WS-ERROR.
 18322     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18323
 18324     GO TO 6640-EXIT.
 18325
 18326 6630-ERRESS-PROBLEM.
 18327     MOVE ER-8044              TO WS-ERROR.
 18328     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18329
 18330 6640-EXIT.
 18331     EXIT.
 18332
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 335
* EL050.cbl
 18334 6650-GET-RES-STATE-COMM.
 18335
 18336     IF PB-COMPANY-ID NOT = 'DMD'
 18337         GO TO 6700-COMM-EXIT.
 18338
 18339     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18340     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18341     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18342     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18343     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18344     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18345     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18346
 18347*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18348*
 18349***  Y2K PROJ 7744
 18350     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18351     SET BIN-TO-GREG          TO TRUE.
 18352     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18353
 18354     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18355***  Y2K PROJ 7744
 18356
 18357     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18358
 18359
 18360* EXEC CICS HANDLE CONDITION
 18361*        INVREQ    (6660-START-BROWSE)
 18362*        DISABLED  (6690-ERRESC-PROBLEM)
 18363*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18364*        NOTFND    (6690-END-OF-FILE)
 18365*    END-EXEC.
 18366*    MOVE '"$8cJI                ! & #00018249' TO DFHEIV0
 18367     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18368     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18369     MOVE X'2620233030303138323439' TO DFHEIV0(25:11)
 18370     CALL 'kxdfhei1' USING DFHEIV0
 18371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18372
 18373
 18374
 18375* EXEC CICS RESETBR
 18376*        DATASET (FILE-ID-ERRESC)
 18377*        RIDFLD  (WS-ERRESC-KEY)
 18378*    END-EXEC.
 18379     MOVE 0
 18380       TO DFHEIV11
 18381*    MOVE '&4         G          &   #00018256' TO DFHEIV0
 18382     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18383     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18384     MOVE X'2020233030303138323536' TO DFHEIV0(25:11)
 18385     CALL 'kxdfhei1' USING DFHEIV0,
 18386           FILE-ID-ERRESC,
 18387           WS-ERRESC-KEY,
 18388           DFHEIV99,
 18389           DFHEIV11,
 18390           DFHEIV99
 18391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 336
* EL050.cbl
 18392
 18393
 18394 6660-START-BROWSE.
 18395
 18396
 18397* EXEC CICS HANDLE CONDITION
 18398*        NOTFND    (6690-END-OF-FILE)
 18399*        DISABLED  (6690-ERRESC-PROBLEM)
 18400*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18401*        ENDFILE   (6690-END-OF-FILE)
 18402*    END-EXEC.
 18403*    MOVE '"$IcJ''                ! '' #00018263' TO DFHEIV0
 18404     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18405     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18406     MOVE X'2720233030303138323633' TO DFHEIV0(25:11)
 18407     CALL 'kxdfhei1' USING DFHEIV0
 18408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18409
 18410
 18411
 18412* EXEC CICS STARTBR
 18413*        DATASET (FILE-ID-ERRESC)
 18414*        RIDFLD  (WS-ERRESC-KEY)
 18415*        GTEQ
 18416*    END-EXEC.
 18417     MOVE 0
 18418       TO DFHEIV11
 18419*    MOVE '&,         G          &   #00018270' TO DFHEIV0
 18420     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18422     MOVE X'2020233030303138323730' TO DFHEIV0(25:11)
 18423     CALL 'kxdfhei1' USING DFHEIV0,
 18424           FILE-ID-ERRESC,
 18425           WS-ERRESC-KEY,
 18426           DFHEIV99,
 18427           DFHEIV11,
 18428           DFHEIV99
 18429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18430
 18431
 18432     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18433
 18434 6670-READ-NEXT-ERRESC-MASTER.
 18435
 18436
 18437* EXEC CICS HANDLE CONDITION
 18438*        NOTFND    (6690-END-OF-FILE)
 18439*        DISABLED  (6690-ERRESC-PROBLEM)
 18440*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18441*        ENDFILE   (6690-END-OF-FILE)
 18442*    END-EXEC.
 18443*    MOVE '"$IcJ''                ! ( #00018280' TO DFHEIV0
 18444     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18446     MOVE X'2820233030303138323830' TO DFHEIV0(25:11)
 18447     CALL 'kxdfhei1' USING DFHEIV0
 18448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18449
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 337
* EL050.cbl
 18450
 18451
 18452* EXEC CICS READNEXT
 18453*        DATASET (FILE-ID-ERRESC)
 18454*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18455*        RIDFLD  (ERRESC-RECORD-KEY)
 18456*    END-EXEC.
 18457     MOVE LENGTH OF
 18458      ACCOUNT-RESIDENT-ST-COMMISSION
 18459       TO DFHEIV12
 18460     MOVE 0
 18461       TO DFHEIV11
 18462*    MOVE '&.IL                  )   #00018287' TO DFHEIV0
 18463     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18464     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18465     MOVE X'2020233030303138323837' TO DFHEIV0(25:11)
 18466     CALL 'kxdfhei1' USING DFHEIV0,
 18467           FILE-ID-ERRESC,
 18468           ACCOUNT-RESIDENT-ST-COMMISSION,
 18469           DFHEIV12,
 18470           ERRESC-RECORD-KEY,
 18471           DFHEIV99,
 18472           DFHEIV11,
 18473           DFHEIV99,
 18474           DFHEIV99
 18475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18476
 18477
 18478     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18479        NEXT SENTENCE
 18480     ELSE
 18481
 18482* EXEC CICS ENDBR
 18483*            DATASET (FILE-ID-ERRESC)
 18484*       END-EXEC
 18485     MOVE 0
 18486       TO DFHEIV11
 18487*    MOVE '&2                    $   #00018296' TO DFHEIV0
 18488     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18489     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18490     MOVE X'2020233030303138323936' TO DFHEIV0(25:11)
 18491     CALL 'kxdfhei1' USING DFHEIV0,
 18492           FILE-ID-ERRESC,
 18493           DFHEIV11,
 18494           DFHEIV99
 18495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18496        GO TO 6690-END-OF-FILE.
 18497
 18498     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18499
 18500* EXEC CICS ENDBR
 18501*            DATASET (FILE-ID-ERRESC)
 18502*       END-EXEC
 18503     MOVE 0
 18504       TO DFHEIV11
 18505*    MOVE '&2                    $   #00018302' TO DFHEIV0
 18506     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18507     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 338
* EL050.cbl
 18508     MOVE X'2020233030303138333032' TO DFHEIV0(25:11)
 18509     CALL 'kxdfhei1' USING DFHEIV0,
 18510           FILE-ID-ERRESC,
 18511           DFHEIV11,
 18512           DFHEIV99
 18513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18514        GO TO 6690-END-OF-FILE.
 18515
 18516     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18517        NEXT SENTENCE
 18518      ELSE
 18519        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18520
 18521* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18522*
 18523     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18524
 18525     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18526
 18527     IF WS-SUB1 > ZERO
 18528         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18529             PERFORM 6680-SET-COMMISSION
 18530         ELSE
 18531             PERFORM 6680-SET-TABLE-CODE.
 18532
 18533
 18534* EXEC CICS ENDBR
 18535*         DATASET (FILE-ID-ERRESC)
 18536*    END-EXEC.
 18537     MOVE 0
 18538       TO DFHEIV11
 18539*    MOVE '&2                    $   #00018324' TO DFHEIV0
 18540     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18541     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18542     MOVE X'2020233030303138333234' TO DFHEIV0(25:11)
 18543     CALL 'kxdfhei1' USING DFHEIV0,
 18544           FILE-ID-ERRESC,
 18545           DFHEIV11,
 18546           DFHEIV99
 18547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18548
 18549
 18550     GO TO 6700-COMM-EXIT.
 18551
 18552 6680-SET-TABLE-CODE.
 18553     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18554        MOVE ZEROS             TO WS-SUB1
 18555     ELSE
 18556* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18557* TO COMPUTE AH COMMISSION.
 18558        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18559        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18560        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18561        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18562        PERFORM 6680-READ-CTBL-TABLE
 18563        IF WS-CTBL-READ-SW NOT = 'Y'
 18564           MOVE ZEROS          TO WS-SUB1.
 18565
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 339
* EL050.cbl
 18566 6680-READ-CTBL-TABLE.
 18567*
 18568* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18569* TO COMPUTE LIFE COMMISSION
 18570
 18571     IF CTBL-SW = '0540'
 18572        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18573        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18574        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18575
 18576     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18577
 18578     IF CTBL-TABLE-FOUND
 18579        IF CTBL-SW = '0530'
 18580             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18581                                    * PB-I-AH-TERM
 18582             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18583             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18584        ELSE
 18585             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18586             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18587             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18588     ELSE
 18589        IF FIRST-TIME-THROUGH
 18590            GO TO 6680-READ-CTBL-TABLE
 18591        ELSE
 18592            MOVE ZEROS         TO WS-SUB1.
 18593
 18594 6680-SET-COMMISSION.
 18595     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18596           MOVE ZEROS          TO WS-SUB1
 18597       ELSE
 18598           MOVE RESC-COMMISSION-PER (WS-SUB)
 18599                               TO WS-COMMISSION
 18600           IF CTBL-SW = '0530'
 18601               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18602           ELSE
 18603               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18604
 18605 6680-SEARCH-CATEGORY.
 18606     ADD +1                   TO WS-SUB.
 18607     IF WS-SUB > +12
 18608         GO TO 6680-EXIT.
 18609
 18610     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18611          MOVE WS-SUB         TO WS-SUB1
 18612          GO TO 6680-EXIT.
 18613
 18614     GO TO 6680-SEARCH-CATEGORY.
 18615
 18616 6680-EXIT.
 18617     EXIT.
 18618
 18619 6690-END-OF-FILE.
 18620     GO TO 6700-COMM-EXIT.
 18621
 18622 6690-ERRESC-PROBLEM.
 18623      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 340
* EL050.cbl
 18624      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18625
 18626      GO TO 6700-COMM-EXIT.
 18627
 18628 6700-COMM-EXIT.
 18629     EXIT.
 18630
 18631 7000-GET-RATE.
 18632
 18633* EXEC CICS LINK
 18634*        PROGRAM    ('ELRATE')
 18635*        COMMAREA   (CALCULATION-PASS-AREA)
 18636*        LENGTH     (CP-COMM-LENGTH)
 18637*    END-EXEC.
 18638     MOVE 'ELRATE' TO DFHEIV1
 18639*    MOVE '."C                   (   #00018410' TO DFHEIV0
 18640     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18641     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18642     MOVE X'2020233030303138343130' TO DFHEIV0(25:11)
 18643     CALL 'kxdfhei1' USING DFHEIV0,
 18644           DFHEIV1,
 18645           CALCULATION-PASS-AREA,
 18646           CP-COMM-LENGTH,
 18647           DFHEIV99,
 18648           DFHEIV99,
 18649           DFHEIV99,
 18650           DFHEIV99
 18651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18652
 18653
 18654 7000-EXIT.
 18655     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 341
* EL050.cbl
 18657 7100-FIND-BENEFIT-IN-STATE.
 18658     MOVE 'N'                    TO BEN-SEARCH-SW.
 18659
 18660     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18661         VARYING SUB3 FROM 1 BY 1 UNTIL
 18662            ((SUB3 GREATER 50) OR
 18663              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18664               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18665
 18666     IF SUB3 NOT = 51
 18667         MOVE 'Y'                TO BEN-SEARCH-SW.
 18668
 18669     GO TO 7199-EXIT.
 18670
 18671 7100-BENEFIT-DUMMY.
 18672
 18673 7100-DUMMY-EXIT.
 18674     EXIT.
 18675
 18676 7199-EXIT.
 18677     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 342
* EL050.cbl
 18679 7200-FIND-BENEFIT.
 18680     MOVE 'N'                    TO BEN-SEARCH-SW.
 18681
 18682     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18683         VARYING SUB3 FROM 1 BY 1 UNTIL
 18684            ((SUB3 GREATER 8) OR
 18685            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18686
 18687     IF SUB3 NOT = 9
 18688         MOVE 'Y'                TO BEN-SEARCH-SW.
 18689
 18690     GO TO 7200-EXIT.
 18691
 18692 7200-BENEFIT-DUMMY.
 18693
 18694 7200-DUMMY-EXIT.
 18695     EXIT.
 18696
 18697 7200-EXIT.
 18698     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 343
* EL050.cbl
 18700 7250-LOOK-FOR-RESCINDED-CLAIM.
 18701     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18702                                    W-CL-COMP-CD.
 18703     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18704                                    W-CL-CERT-NO.
 18705
 18706
 18707* EXEC CICS HANDLE CONDITION
 18708*        NOTFND  (7250-CONTINUE)
 18709*        ENDFILE (7250-CONTINUE)
 18710*    END-EXEC.
 18711*    MOVE '"$I''                  ! ) #00018468' TO DFHEIV0
 18712     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18714     MOVE X'2920233030303138343638' TO DFHEIV0(25:11)
 18715     CALL 'kxdfhei1' USING DFHEIV0
 18716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18717
 18718
 18719
 18720* EXEC CICS IGNORE CONDITION
 18721*        DUPKEY
 18722*    END-EXEC.
 18723*    MOVE '"*$                   !   #00018473' TO DFHEIV0
 18724     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18725     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18726     MOVE X'2020233030303138343733' TO DFHEIV0(25:11)
 18727     CALL 'kxdfhei1' USING DFHEIV0
 18728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18729
 18730
 18731
 18732* EXEC CICS STARTBR
 18733*        DATASET   (CLMS-ID)
 18734*        RIDFLD    (ELMSTR-KEY)
 18735*        GENERIC   EQUAL
 18736*        KEYLENGTH (ELMSTR-LENGTH)
 18737*    END-EXEC.
 18738     MOVE 0
 18739       TO DFHEIV11
 18740*    MOVE '&,   KG    E          &   #00018477' TO DFHEIV0
 18741     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18742     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18743     MOVE X'2020233030303138343737' TO DFHEIV0(25:11)
 18744     CALL 'kxdfhei1' USING DFHEIV0,
 18745           CLMS-ID,
 18746           ELMSTR-KEY,
 18747           ELMSTR-LENGTH,
 18748           DFHEIV11,
 18749           DFHEIV99
 18750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18751
 18752
 18753     MOVE 'Y'                    TO W-BROWSE-SW.
 18754
 18755 7250-NEXT-CLAIM.
 18756
 18757
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 344
* EL050.cbl
 18758* EXEC CICS READNEXT
 18759*        DATASET   (CLMS-ID)
 18760*        RIDFLD    (ELMSTR-KEY)
 18761*        SET       (ADDRESS OF CLAIM-MASTER)
 18762*    END-EXEC.
 18763     MOVE 0
 18764       TO DFHEIV11
 18765*    MOVE '&.S                   )   #00018488' TO DFHEIV0
 18766     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18767     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18768     MOVE X'2020233030303138343838' TO DFHEIV0(25:11)
 18769     CALL 'kxdfhei1' USING DFHEIV0,
 18770           CLMS-ID,
 18771           DFHEIV20,
 18772           DFHEIV99,
 18773           ELMSTR-KEY,
 18774           DFHEIV99,
 18775           DFHEIV11,
 18776           DFHEIV99,
 18777           DFHEIV99
 18778     SET ADDRESS OF CLAIM-MASTER TO
 18779         DFHEIV20
 18780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18781
 18782
 18783     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18784        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18785         GO TO 7250-CONTINUE
 18786     END-IF.
 18787
 18788     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18789        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18790        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18791        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18792        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18793         GO TO 7250-NEXT-CLAIM
 18794     END-IF.
 18795
 18796     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18797        OR (CL-CLAIM-TYPE = 'I')
 18798        OR (CL-CLAIM-TYPE = 'G')
 18799        OR (CL-CLAIM-TYPE = 'F')
 18800          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18801              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 18802              GO TO 7250-CONTINUE
 18803          END-IF
 18804     END-IF.
 18805
 18806     GO TO 7250-NEXT-CLAIM.
 18807
 18808 7250-CONTINUE.
 18809
 18810     IF W-BROWSE-SW = 'Y'
 18811
 18812* EXEC CICS ENDBR
 18813*            DATASET   (CLMS-ID)
 18814*        END-EXEC
 18815     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 345
* EL050.cbl
 18816       TO DFHEIV11
 18817*    MOVE '&2                    $   #00018522' TO DFHEIV0
 18818     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18819     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18820     MOVE X'2020233030303138353232' TO DFHEIV0(25:11)
 18821     CALL 'kxdfhei1' USING DFHEIV0,
 18822           CLMS-ID,
 18823           DFHEIV11,
 18824           DFHEIV99
 18825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18826         MOVE 'N' TO W-BROWSE-SW
 18827     END-IF.
 18828
 18829 7250-EXIT.
 18830     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 346
* EL050.cbl
 18832 7300-CHECK-FOR-OPEN-CLMS.
 18833
 18834*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 18835*    MOVE SPACES                 TO CNTL-ACCESS.
 18836*    MOVE '1'                    TO CNTL-REC-TYPE.
 18837*    MOVE +0                     TO CNTL-SEQ-NO.
 18838
 18839*    MOVE '3'                    TO RC-SW-1.
 18840*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 18841
 18842*    IF NOT CF-COMPANY-MASTER
 18843*         PERFORM 0099-COMPANY-NOT-FOUND
 18844*         GO TO 7300-EXIT.
 18845
 18846     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18847                                    W-CL-COMP-CD.
 18848     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18849                                    W-CL-CERT-NO.
 18850
 18851
 18852* EXEC CICS HANDLE CONDITION
 18853*        NOTFND  (7300-CONTINUE)
 18854*        ENDFILE (7300-CONTINUE)
 18855*    END-EXEC.
 18856*    MOVE '"$I''                  ! * #00018550' TO DFHEIV0
 18857     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18858     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18859     MOVE X'2A20233030303138353530' TO DFHEIV0(25:11)
 18860     CALL 'kxdfhei1' USING DFHEIV0
 18861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18862
 18863
 18864
 18865* EXEC CICS IGNORE CONDITION
 18866*        DUPKEY
 18867*    END-EXEC.
 18868*    MOVE '"*$                   !   #00018555' TO DFHEIV0
 18869     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 18870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18871     MOVE X'2020233030303138353535' TO DFHEIV0(25:11)
 18872     CALL 'kxdfhei1' USING DFHEIV0
 18873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18874
 18875
 18876
 18877* EXEC CICS STARTBR
 18878*        DATASET   (CLMS-ID)
 18879*        RIDFLD    (ELMSTR-KEY)
 18880*        GENERIC   EQUAL
 18881*        KEYLENGTH (ELMSTR-LENGTH)
 18882*    END-EXEC.
 18883     MOVE 0
 18884       TO DFHEIV11
 18885*    MOVE '&,   KG    E          &   #00018559' TO DFHEIV0
 18886     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 18887     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18888     MOVE X'2020233030303138353539' TO DFHEIV0(25:11)
 18889     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 347
* EL050.cbl
 18890           CLMS-ID,
 18891           ELMSTR-KEY,
 18892           ELMSTR-LENGTH,
 18893           DFHEIV11,
 18894           DFHEIV99
 18895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18896
 18897
 18898     MOVE 'Y'                    TO W-BROWSE-SW.
 18899
 18900 7300-NEXT-CLAIM.
 18901
 18902
 18903* EXEC CICS READNEXT
 18904*        DATASET   (CLMS-ID)
 18905*        RIDFLD    (ELMSTR-KEY)
 18906*        SET       (ADDRESS OF CLAIM-MASTER)
 18907*    END-EXEC.
 18908     MOVE 0
 18909       TO DFHEIV11
 18910*    MOVE '&.S                   )   #00018570' TO DFHEIV0
 18911     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18912     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18913     MOVE X'2020233030303138353730' TO DFHEIV0(25:11)
 18914     CALL 'kxdfhei1' USING DFHEIV0,
 18915           CLMS-ID,
 18916           DFHEIV20,
 18917           DFHEIV99,
 18918           ELMSTR-KEY,
 18919           DFHEIV99,
 18920           DFHEIV11,
 18921           DFHEIV99,
 18922           DFHEIV99
 18923     SET ADDRESS OF CLAIM-MASTER TO
 18924         DFHEIV20
 18925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18926
 18927
 18928     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 18929        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 18930         GO TO 7300-CONTINUE.
 18931
 18932     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 18933        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 18934        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 18935        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 18936        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 18937         GO TO 7300-NEXT-CLAIM.
 18938
 18939*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 18940     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 18941        OR (CL-CLAIM-TYPE = 'I')
 18942        OR (CL-CLAIM-TYPE = 'G')
 18943        OR (CL-CLAIM-TYPE = 'F')
 18944        IF CLAIM-IS-OPEN
 18945           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 18946             AND PB-C-AH-CANCEL-DT > SPACES
 18947              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 348
* EL050.cbl
 18948              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18949           END-IF
 18950           EVALUATE TRUE
 18951             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 18952                 MOVE ER-2884      TO WS-ERROR
 18953             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 18954                 MOVE ER-2887      TO WS-ERROR
 18955             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 18956                 MOVE ER-2886      TO WS-ERROR
 18957             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 18958                 MOVE ER-2888      TO WS-ERROR
 18959             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 18960                 MOVE ER-2885      TO WS-ERROR
 18961             WHEN OTHER
 18962                 MOVE ER-2768      TO WS-ERROR
 18963           END-EVALUATE
 18964           IF PB-C-AH-CANCEL-VOIDED OR
 18965              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18966                NOT AH-COVERAGE-CANCELLED)
 18967               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18968               MOVE ER-2768      TO WS-ERROR
 18969           END-IF
 18970           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18971           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 18972              PB-FORCE-CODE NOT EQUAL '8'
 18973               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 18974           END-IF
 18975           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 18976           GO TO 7300-NEXT-CLAIM
 18977        ELSE
 18978           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 18979*****THIS IS A RESCISSION OR REFORMATION
 18980              IF AH-COVERAGE-CANCELLED
 18981                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 18982                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 18983                    MOVE 1                   TO DC-ELAPSED-DAYS
 18984                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 18985                    SET BIN-PLUS-ELAPSED     TO TRUE
 18986                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 18987                    IF NO-CONVERSION-ERROR
 18988                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 18989                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 18990                          MOVE ER-2897 TO WS-ERROR
 18991                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18992                          GO TO 7300-NEXT-CLAIM
 18993                       END-IF
 18994                    END-IF
 18995                 ELSE
 18996                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 18997                     MOVE ER-2890 TO WS-ERROR
 18998                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18999                     GO TO 7300-NEXT-CLAIM
 19000                   END-IF
 19001                 END-IF
 19002              END-IF
 19003           ELSE
 19004              IF CL-DENIAL-TYPE = '1'  AND
 19005                 CL-TOTAL-PAID-AMT = 0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 349
* EL050.cbl
 19006                    GO TO 7300-NEXT-CLAIM
 19007              END-IF
 19008              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19009               AND PB-C-AH-CANCEL-DT > SPACES
 19010                 MOVE ER-2756        TO WS-ERROR
 19011                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19012                 GO TO 7300-NEXT-CLAIM
 19013              END-IF
 19014           END-IF
 19015        END-IF
 19016     ELSE
 19017*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19018        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19019           IF CLAIM-IS-OPEN
 19020              MOVE ER-2889      TO WS-ERROR
 19021              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19022              GO TO 7300-NEXT-CLAIM
 19023           ELSE
 19024              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19025*****THIS IS A RESCISSION OR REFORMATION
 19026                 IF (LF-COVERAGE-CANCELLED AND
 19027                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19028                       MOVE ER-2890 TO WS-ERROR
 19029                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19030                       GO TO 7300-NEXT-CLAIM
 19031                 END-IF
 19032              ELSE
 19033                 IF CL-DENIAL-TYPE = '1'  AND
 19034                    CL-TOTAL-PAID-AMT = 0
 19035                       GO TO 7300-NEXT-CLAIM
 19036                 END-IF
 19037                 IF (AH-COVERAGE-CANCELLED AND
 19038                     PB-C-AH-CANCEL-DT <> CL-INCURRED-DT AND
 19039                     WS-AH-CLAIM-RESCINDED <> 'Y') OR
 19040                    (LF-COVERAGE-CANCELLED AND
 19041                     PB-C-LF-CANCEL-DT <> CL-INCURRED-DT AND
 19042                     WS-ST-REFUND-CLAIM-FLAG = '4')
 19043                       MOVE ER-2965 TO WS-ERROR
 19044                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19045                       GO TO 7300-NEXT-CLAIM
 19046                 END-IF
 19047                 IF LF-COVERAGE-CANCELLED
 19048                  IF CL-TOTAL-PAID-AMT > 0
 19049                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19050                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19051                        MOVE ER-2891 TO WS-ERROR
 19052                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19053                        GO TO 7300-NEXT-CLAIM
 19054                      END-IF
 19055                    ELSE
 19056****only show this error if cert num matches exactly
 19057                      IF PB-CERT-NO = CL-CERT-NO
 19058                         MOVE ER-2892 TO WS-ERROR
 19059                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19060                         GO TO 7300-NEXT-CLAIM
 19061                      END-IF
 19062                    END-IF
 19063                  END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 350
* EL050.cbl
 19064                 END-IF
 19065              END-IF
 19066           END-IF
 19067        END-IF
 19068     END-IF
 19069
 19070     GO TO 7300-NEXT-CLAIM.
 19071
 19072 7300-CONTINUE.
 19073
 19074     IF W-BROWSE-SW = 'Y'
 19075
 19076* EXEC CICS ENDBR
 19077*            DATASET   (CLMS-ID)
 19078*        END-EXEC.
 19079     MOVE 0
 19080       TO DFHEIV11
 19081*    MOVE '&2                    $   #00018723' TO DFHEIV0
 19082     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19083     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19084     MOVE X'2020233030303138373233' TO DFHEIV0(25:11)
 19085     CALL 'kxdfhei1' USING DFHEIV0,
 19086           CLMS-ID,
 19087           DFHEIV11,
 19088           DFHEIV99
 19089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19090
 19091
 19092 7300-EXIT.
 19093     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 351
* EL050.cbl
 19095
 19096 7400-GET-REMAIN-TERM.
 19097
 19098* EXEC CICS LINK
 19099*        PROGRAM    ('ELRTRM')
 19100*        COMMAREA   (CALCULATION-PASS-AREA)
 19101*        LENGTH     (CP-COMM-LENGTH)
 19102*    END-EXEC.
 19103     MOVE 'ELRTRM' TO DFHEIV1
 19104*    MOVE '."C                   (   #00018732' TO DFHEIV0
 19105     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19107     MOVE X'2020233030303138373332' TO DFHEIV0(25:11)
 19108     CALL 'kxdfhei1' USING DFHEIV0,
 19109           DFHEIV1,
 19110           CALCULATION-PASS-AREA,
 19111           CP-COMM-LENGTH,
 19112           DFHEIV99,
 19113           DFHEIV99,
 19114           DFHEIV99,
 19115           DFHEIV99
 19116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19117
 19118
 19119 7400-EXIT.
 19120     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 352
* EL050.cbl
 19122
 19123 7500-GET-REMAIN-AMOUNT.
 19124
 19125* EXEC CICS LINK
 19126*        PROGRAM    ('ELRAMT')
 19127*        COMMAREA   (CALCULATION-PASS-AREA)
 19128*        LENGTH     (CP-COMM-LENGTH)
 19129*    END-EXEC.
 19130     MOVE 'ELRAMT' TO DFHEIV1
 19131*    MOVE '."C                   (   #00018743' TO DFHEIV0
 19132     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19133     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19134     MOVE X'2020233030303138373433' TO DFHEIV0(25:11)
 19135     CALL 'kxdfhei1' USING DFHEIV0,
 19136           DFHEIV1,
 19137           CALCULATION-PASS-AREA,
 19138           CP-COMM-LENGTH,
 19139           DFHEIV99,
 19140           DFHEIV99,
 19141           DFHEIV99,
 19142           DFHEIV99
 19143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19144
 19145
 19146 7500-EXIT.
 19147     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 353
* EL050.cbl
 19149
 19150 7600-GET-REFUND.
 19151
 19152* EXEC CICS LINK
 19153*        PROGRAM    ('ELRFND')
 19154*        COMMAREA   (CALCULATION-PASS-AREA)
 19155*        LENGTH     (CP-COMM-LENGTH)
 19156*    END-EXEC.
 19157     MOVE 'ELRFND' TO DFHEIV1
 19158*    MOVE '."C                   (   #00018754' TO DFHEIV0
 19159     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19160     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19161     MOVE X'2020233030303138373534' TO DFHEIV0(25:11)
 19162     CALL 'kxdfhei1' USING DFHEIV0,
 19163           DFHEIV1,
 19164           CALCULATION-PASS-AREA,
 19165           CP-COMM-LENGTH,
 19166           DFHEIV99,
 19167           DFHEIV99,
 19168           DFHEIV99,
 19169           DFHEIV99
 19170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19171
 19172
 19173 7600-EXIT.
 19174     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 354
* EL050.cbl
 19176 7700-CALL-DL1.
 19177
 19178* EXEC CICS LINK
 19179*        PROGRAM    ('DLO001')
 19180*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19181*        LENGTH     (DLO001-COMM-LENGTH)
 19182*    END-EXEC.
 19183     MOVE 'DLO001' TO DFHEIV1
 19184*    MOVE '."C                   (   #00018764' TO DFHEIV0
 19185     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19186     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19187     MOVE X'2020233030303138373634' TO DFHEIV0(25:11)
 19188     CALL 'kxdfhei1' USING DFHEIV0,
 19189           DFHEIV1,
 19190           WS-DLO-MASTER-POLICY-FORM,
 19191           DLO001-COMM-LENGTH,
 19192           DFHEIV99,
 19193           DFHEIV99,
 19194           DFHEIV99,
 19195           DFHEIV99
 19196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19197
 19198
 19199 7700-EXIT.
 19200     EXIT.
 19201
 19202 7710-CALL-DL2.
 19203
 19204* EXEC CICS LINK
 19205*        PROGRAM    ('DLO002')
 19206*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19207*        LENGTH     (DLO002-COMM-LENGTH)
 19208*    END-EXEC.
 19209     MOVE 'DLO002' TO DFHEIV1
 19210*    MOVE '."C                   (   #00018774' TO DFHEIV0
 19211     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19212     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19213     MOVE X'2020233030303138373734' TO DFHEIV0(25:11)
 19214     CALL 'kxdfhei1' USING DFHEIV0,
 19215           DFHEIV1,
 19216           WS-DLO-INTERNAL-POLICY-FORM,
 19217           DLO002-COMM-LENGTH,
 19218           DFHEIV99,
 19219           DFHEIV99,
 19220           DFHEIV99,
 19221           DFHEIV99
 19222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19223
 19224
 19225 7710-EXIT.
 19226     EXIT.
 19227
 19228 7720-CALL-DL3.
 19229
 19230* EXEC CICS LINK
 19231*        PROGRAM    ('DLO003')
 19232*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19233*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 355
* EL050.cbl
 19234*    END-EXEC.
 19235     MOVE 'DLO003' TO DFHEIV1
 19236*    MOVE '."C                   (   #00018784' TO DFHEIV0
 19237     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19239     MOVE X'2020233030303138373834' TO DFHEIV0(25:11)
 19240     CALL 'kxdfhei1' USING DFHEIV0,
 19241           DFHEIV1,
 19242           WS-DLO-VALID-BANK-ID,
 19243           DLO003-COMM-LENGTH,
 19244           DFHEIV99,
 19245           DFHEIV99,
 19246           DFHEIV99,
 19247           DFHEIV99
 19248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19249
 19250
 19251 7720-EXIT.
 19252     EXIT.
 19253
 19254 7730-CALL-DL7.
 19255
 19256* EXEC CICS LINK
 19257*        PROGRAM    ('DLO007')
 19258*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19259*        LENGTH     (DLO007-COMM-LENGTH)
 19260*    END-EXEC.
 19261     MOVE 'DLO007' TO DFHEIV1
 19262*    MOVE '."C                   (   #00018794' TO DFHEIV0
 19263     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19264     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19265     MOVE X'2020233030303138373934' TO DFHEIV0(25:11)
 19266     CALL 'kxdfhei1' USING DFHEIV0,
 19267           DFHEIV1,
 19268           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19269           DLO007-COMM-LENGTH,
 19270           DFHEIV99,
 19271           DFHEIV99,
 19272           DFHEIV99,
 19273           DFHEIV99
 19274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19275
 19276
 19277 7730-EXIT.
 19278     EXIT.
 19279
 19280 7740-CALL-DL11.
 19281
 19282* EXEC CICS LINK
 19283*        PROGRAM    ('DLO011')
 19284*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19285*        LENGTH     (DLO011-COMM-LENGTH)
 19286*    END-EXEC.
 19287     MOVE 'DLO011' TO DFHEIV1
 19288*    MOVE '."C                   (   #00018804' TO DFHEIV0
 19289     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19290     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19291     MOVE X'2020233030303138383034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 356
* EL050.cbl
 19292     CALL 'kxdfhei1' USING DFHEIV0,
 19293           DFHEIV1,
 19294           WS-DLO-PREM-RATES-BEN-TYPE,
 19295           DLO011-COMM-LENGTH,
 19296           DFHEIV99,
 19297           DFHEIV99,
 19298           DFHEIV99,
 19299           DFHEIV99
 19300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19301
 19302
 19303 7740-EXIT.
 19304     EXIT.
 19305
 19306 7750-CALL-DL17.
 19307
 19308* EXEC CICS LINK
 19309*        PROGRAM    ('DLO017')
 19310*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19311*        LENGTH     (DLO017-COMM-LENGTH)
 19312*    END-EXEC.
 19313     MOVE 'DLO017' TO DFHEIV1
 19314*    MOVE '."C                   (   #00018814' TO DFHEIV0
 19315     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19316     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19317     MOVE X'2020233030303138383134' TO DFHEIV0(25:11)
 19318     CALL 'kxdfhei1' USING DFHEIV0,
 19319           DFHEIV1,
 19320           WS-DLO-VALID-RATE-CODE,
 19321           DLO017-COMM-LENGTH,
 19322           DFHEIV99,
 19323           DFHEIV99,
 19324           DFHEIV99,
 19325           DFHEIV99
 19326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19327
 19328
 19329 7750-EXIT.
 19330     EXIT.
 19331
 19332 7755-CALL-DL19.
 19333
 19334* EXEC CICS LINK
 19335*        PROGRAM    ('DLO019')
 19336*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19337*        LENGTH     (DLO019-COMM-LENGTH)
 19338*    END-EXEC.
 19339     MOVE 'DLO019' TO DFHEIV1
 19340*    MOVE '."C                   (   #00018824' TO DFHEIV0
 19341     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19343     MOVE X'2020233030303138383234' TO DFHEIV0(25:11)
 19344     CALL 'kxdfhei1' USING DFHEIV0,
 19345           DFHEIV1,
 19346           WS-DLO-ORIG-COV-CAT,
 19347           DLO019-COMM-LENGTH,
 19348           DFHEIV99,
 19349           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 357
* EL050.cbl
 19350           DFHEIV99,
 19351           DFHEIV99
 19352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19353
 19354
 19355 7755-EXIT.
 19356     EXIT.
 19357
 19358 7760-CALL-DL21.
 19359
 19360* EXEC CICS LINK
 19361*        PROGRAM    ('DLO021')
 19362*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19363*        LENGTH     (DLO021-COMM-LENGTH)
 19364*    END-EXEC.
 19365     MOVE 'DLO021' TO DFHEIV1
 19366*    MOVE '."C                   (   #00018834' TO DFHEIV0
 19367     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19369     MOVE X'2020233030303138383334' TO DFHEIV0(25:11)
 19370     CALL 'kxdfhei1' USING DFHEIV0,
 19371           DFHEIV1,
 19372           WS-DLO-VALID-LOAN-OFFICER,
 19373           DLO021-COMM-LENGTH,
 19374           DFHEIV99,
 19375           DFHEIV99,
 19376           DFHEIV99,
 19377           DFHEIV99
 19378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19379
 19380
 19381 7760-EXIT.
 19382     EXIT.
 19383
 19384 7770-CALL-DL22.
 19385
 19386* EXEC CICS LINK
 19387*        PROGRAM    ('DLO022')
 19388*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19389*        LENGTH     (DLO022-COMM-LENGTH)
 19390*    END-EXEC.
 19391     MOVE 'DLO022' TO DFHEIV1
 19392*    MOVE '."C                   (   #00018844' TO DFHEIV0
 19393     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19394     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19395     MOVE X'2020233030303138383434' TO DFHEIV0(25:11)
 19396     CALL 'kxdfhei1' USING DFHEIV0,
 19397           DFHEIV1,
 19398           WS-DLO-VALID-STATE-CODE,
 19399           DLO022-COMM-LENGTH,
 19400           DFHEIV99,
 19401           DFHEIV99,
 19402           DFHEIV99,
 19403           DFHEIV99
 19404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19405
 19406
 19407 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 358
* EL050.cbl
 19408     EXIT.
 19409
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 359
* EL050.cbl
 19411
 19412 7800-REWRITE-CERT.
 19413******************************************************************
 19414*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19415*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19416******************************************************************
 19417
 19418     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19419        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19420        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19421        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19422
 19423* EXEC CICS REWRITE
 19424*                  DATASET (CERT-ID)
 19425*                  FROM    (CERTIFICATE-MASTER)
 19426*              END-EXEC
 19427     MOVE LENGTH OF
 19428      CERTIFICATE-MASTER
 19429       TO DFHEIV11
 19430*    MOVE '&& L                  %   #00018865' TO DFHEIV0
 19431     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19432     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19433     MOVE X'2020233030303138383635' TO DFHEIV0(25:11)
 19434     CALL 'kxdfhei1' USING DFHEIV0,
 19435           CERT-ID,
 19436           CERTIFICATE-MASTER,
 19437           DFHEIV11,
 19438           DFHEIV99
 19439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19440        GO TO 7800-EXIT.
 19441
 19442       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19443       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19444
 19445 7800-EXIT.
 19446      EXIT.
 19447
 19448 7900-DELETE-CERT.
 19449
 19450* EXEC CICS DELETE
 19451*        DATASET (CERT-ID)
 19452*    END-EXEC.
 19453*    MOVE '&(                    &   #00018878' TO DFHEIV0
 19454     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19455     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19456     MOVE X'2020233030303138383738' TO DFHEIV0(25:11)
 19457     CALL 'kxdfhei1' USING DFHEIV0,
 19458           CERT-ID,
 19459           DFHEIV99,
 19460           DFHEIV99,
 19461           DFHEIV99,
 19462           DFHEIV99
 19463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19464
 19465
 19466 7900-EXIT.
 19467     EXIT.
 19468
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 360
* EL050.cbl
 19469 8000-WRITE-CERT.
 19470
 19471* EXEC CICS HANDLE CONDITION
 19472*        DUPKEY    (8000-FREE-MAIN)
 19473*    END-EXEC.
 19474*    MOVE '"$$                   ! + #00018886' TO DFHEIV0
 19475     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19476     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19477     MOVE X'2B20233030303138383836' TO DFHEIV0(25:11)
 19478     CALL 'kxdfhei1' USING DFHEIV0
 19479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19480
 19481
 19482
 19483* EXEC CICS WRITE
 19484*        DATASET     (CERT-ID)
 19485*        FROM        (CERTIFICATE-MASTER)
 19486*        RIDFLD      (ELCERT-KEY)
 19487*    END-EXEC.
 19488     MOVE LENGTH OF
 19489      CERTIFICATE-MASTER
 19490       TO DFHEIV11
 19491*    MOVE '&$ L                  ''   #00018890' TO DFHEIV0
 19492     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19493     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19494     MOVE X'2020233030303138383930' TO DFHEIV0(25:11)
 19495     CALL 'kxdfhei1' USING DFHEIV0,
 19496           CERT-ID,
 19497           CERTIFICATE-MASTER,
 19498           DFHEIV11,
 19499           ELCERT-KEY,
 19500           DFHEIV99,
 19501           DFHEIV99
 19502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19503
 19504
 19505 8000-FREE-MAIN.
 19506
 19507 8000-EXIT.
 19508      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 361
* EL050.cbl
 19510
 19511 8100-READ-ERPNDM.
 19512
 19513* EXEC CICS HANDLE CONDITION
 19514*         NOTFND     (8100-NOTFND)
 19515*         ENDFILE    (8100-NOTFND)
 19516*    END-EXEC.
 19517*    MOVE '"$I''                  ! , #00018903' TO DFHEIV0
 19518     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19519     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19520     MOVE X'2C20233030303138393033' TO DFHEIV0(25:11)
 19521     CALL 'kxdfhei1' USING DFHEIV0
 19522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19523
 19524
 19525     MOVE SPACES                 TO ERPNDM-FOUND.
 19526     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19527
 19528
 19529* EXEC CICS READ
 19530*         DATASET   (FILE-ERPNDM)
 19531*         RIDFLD    (PM-CONTROL-PRIMARY)
 19532*         INTO      (PENDING-MAILING-DATA)
 19533*    END-EXEC.
 19534     MOVE LENGTH OF
 19535      PENDING-MAILING-DATA
 19536       TO DFHEIV11
 19537*    MOVE '&"IL       E          (   #00018911' TO DFHEIV0
 19538     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19539     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19540     MOVE X'2020233030303138393131' TO DFHEIV0(25:11)
 19541     CALL 'kxdfhei1' USING DFHEIV0,
 19542           FILE-ERPNDM,
 19543           PENDING-MAILING-DATA,
 19544           DFHEIV11,
 19545           PM-CONTROL-PRIMARY,
 19546           DFHEIV99,
 19547           DFHEIV99,
 19548           DFHEIV99
 19549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19550
 19551
 19552     GO TO 8100-EXIT.
 19553
 19554 8100-NOTFND.
 19555
 19556     MOVE 'X'                    TO ERPNDM-FOUND.
 19557     MOVE ER-2694                TO WS-ERROR.
 19558     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19559     MOVE ER-2883                TO WS-ERROR
 19560     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19561     .
 19562 8100-EXIT.
 19563     EXIT.
 19564
 19565 8110-READ-ERMAIL.
 19566
 19567* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 362
* EL050.cbl
 19568*         NOTFND     (8110-NOTFND)
 19569*         ENDFILE    (8110-NOTFND)
 19570*    END-EXEC.
 19571*    MOVE '"$I''                  ! - #00018931' TO DFHEIV0
 19572     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19574     MOVE X'2D20233030303138393331' TO DFHEIV0(25:11)
 19575     CALL 'kxdfhei1' USING DFHEIV0
 19576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19577
 19578
 19579     MOVE SPACES                 TO ERMAIL-FOUND.
 19580     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19581     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19582     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19583     MOVE PB-SV-STATE            TO MA-STATE.
 19584
 19585
 19586* EXEC CICS READ
 19587*         UPDATE
 19588*         DATASET   (FILE-ERMAIL)
 19589*         RIDFLD    (MA-CONTROL-PRIMARY)
 19590*         INTO      (MAILING-DATA)
 19591*    END-EXEC.
 19592     MOVE LENGTH OF
 19593      MAILING-DATA
 19594       TO DFHEIV11
 19595*    MOVE '&"IL       EU         (   #00018942' TO DFHEIV0
 19596     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19597     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19598     MOVE X'2020233030303138393432' TO DFHEIV0(25:11)
 19599     CALL 'kxdfhei1' USING DFHEIV0,
 19600           FILE-ERMAIL,
 19601           MAILING-DATA,
 19602           DFHEIV11,
 19603           MA-CONTROL-PRIMARY,
 19604           DFHEIV99,
 19605           DFHEIV99,
 19606           DFHEIV99
 19607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19608
 19609
 19610     GO TO 8110-EXIT.
 19611
 19612 8110-NOTFND.
 19613     MOVE 'X'                    TO ERMAIL-FOUND.
 19614
 19615 8110-EXIT.
 19616     EXIT.
 19617
 19618 8120-REWRITE-ERMAIL.
 19619
 19620* EXEC CICS REWRITE
 19621*         DATASET    (FILE-ERMAIL)
 19622*         FROM       (MAILING-DATA)
 19623*    END-EXEC.
 19624     MOVE LENGTH OF
 19625      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 363
* EL050.cbl
 19626       TO DFHEIV11
 19627*    MOVE '&& L                  %   #00018958' TO DFHEIV0
 19628     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19629     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19630     MOVE X'2020233030303138393538' TO DFHEIV0(25:11)
 19631     CALL 'kxdfhei1' USING DFHEIV0,
 19632           FILE-ERMAIL,
 19633           MAILING-DATA,
 19634           DFHEIV11,
 19635           DFHEIV99
 19636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19637
 19638
 19639 8120-EXIT.
 19640     EXIT.
 19641
 19642 8130-WRITE-ERMAIL.
 19643
 19644* EXEC CICS HANDLE CONDITION
 19645*         DUPKEY   (8130-EXIT)
 19646*    END-EXEC.
 19647*    MOVE '"$$                   ! . #00018967' TO DFHEIV0
 19648     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19649     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19650     MOVE X'2E20233030303138393637' TO DFHEIV0(25:11)
 19651     CALL 'kxdfhei1' USING DFHEIV0
 19652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19653
 19654
 19655
 19656* EXEC CICS WRITE
 19657*         DATASET     (FILE-ERMAIL)
 19658*         RIDFLD      (MA-CONTROL-PRIMARY)
 19659*         FROM        (MAILING-DATA)
 19660*    END-EXEC.
 19661     MOVE LENGTH OF
 19662      MAILING-DATA
 19663       TO DFHEIV11
 19664*    MOVE '&$ L                  ''   #00018971' TO DFHEIV0
 19665     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19666     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19667     MOVE X'2020233030303138393731' TO DFHEIV0(25:11)
 19668     CALL 'kxdfhei1' USING DFHEIV0,
 19669           FILE-ERMAIL,
 19670           MAILING-DATA,
 19671           DFHEIV11,
 19672           MA-CONTROL-PRIMARY,
 19673           DFHEIV99,
 19674           DFHEIV99
 19675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19676
 19677
 19678 8130-EXIT.
 19679     EXIT.
 19680
 19681 8140-UNLOCK-ERMAIL.
 19682
 19683* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 364
* EL050.cbl
 19684*         DATASET   (FILE-ERMAIL)
 19685*    END-EXEC.
 19686*    MOVE '&*                    #   #00018981' TO DFHEIV0
 19687     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19688     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19689     MOVE X'2020233030303138393831' TO DFHEIV0(25:11)
 19690     CALL 'kxdfhei1' USING DFHEIV0,
 19691           FILE-ERMAIL,
 19692           DFHEIV99
 19693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19694
 19695
 19696 8140-EXIT.
 19697     EXIT.
 19698
 19699 8150-read-elcrtt.
 19700
 19701
 19702* EXEC CICS HANDLE CONDITION
 19703*        NOTFND   (8150-exit)
 19704*    END-EXEC
 19705*    MOVE '"$I                   ! / #00018990' TO DFHEIV0
 19706     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19708     MOVE X'2F20233030303138393930' TO DFHEIV0(25:11)
 19709     CALL 'kxdfhei1' USING DFHEIV0
 19710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19711
 19712     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19713     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19714
 19715
 19716* EXEC CICS READ
 19717*        DATASET  (CRTT-ID)
 19718*        RIDFLD   (WS-ELCRTT-KEY)
 19719*        INTO     (CERTIFICATE-TRAILERS)
 19720*    END-EXEC
 19721     MOVE LENGTH OF
 19722      CERTIFICATE-TRAILERS
 19723       TO DFHEIV11
 19724*    MOVE '&"IL       E          (   #00018997' TO DFHEIV0
 19725     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19726     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19727     MOVE X'2020233030303138393937' TO DFHEIV0(25:11)
 19728     CALL 'kxdfhei1' USING DFHEIV0,
 19729           CRTT-ID,
 19730           CERTIFICATE-TRAILERS,
 19731           DFHEIV11,
 19732           WS-ELCRTT-KEY,
 19733           DFHEIV99,
 19734           DFHEIV99,
 19735           DFHEIV99
 19736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19737
 19738     move cs-ins-age-default-flag to ws-ins-age-defaulted
 19739     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 19740
 19741     .
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 365
* EL050.cbl
 19742 8150-exit.
 19743     exit.
 19744 8180-UPDATE-VIN-NUMBER.
 19745
 19746* EXEC CICS HANDLE CONDITION
 19747*        NOTFND   (8180-NOTFND)
 19748*    END-EXEC.
 19749*    MOVE '"$I                   ! 0 #00019010' TO DFHEIV0
 19750     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19752     MOVE X'3020233030303139303130' TO DFHEIV0(25:11)
 19753     CALL 'kxdfhei1' USING DFHEIV0
 19754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19755
 19756
 19757     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19758     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19759
 19760
 19761* EXEC CICS READ
 19762*        UPDATE
 19763*        DATASET  (CRTT-ID)
 19764*        RIDFLD   (WS-ELCRTT-KEY)
 19765*        INTO     (CERTIFICATE-TRAILERS)
 19766*    END-EXEC.
 19767     MOVE LENGTH OF
 19768      CERTIFICATE-TRAILERS
 19769       TO DFHEIV11
 19770*    MOVE '&"IL       EU         (   #00019017' TO DFHEIV0
 19771     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19772     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19773     MOVE X'2020233030303139303137' TO DFHEIV0(25:11)
 19774     CALL 'kxdfhei1' USING DFHEIV0,
 19775           CRTT-ID,
 19776           CERTIFICATE-TRAILERS,
 19777           DFHEIV11,
 19778           WS-ELCRTT-KEY,
 19779           DFHEIV99,
 19780           DFHEIV99,
 19781           DFHEIV99
 19782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19783
 19784
 19785     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 19786         MOVE PB-I-VIN TO CS-VIN-NUMBER
 19787
 19788* EXEC CICS REWRITE
 19789*           DATASET  (CRTT-ID)
 19790*           FROM     (CERTIFICATE-TRAILERS)
 19791*        END-EXEC
 19792     MOVE LENGTH OF
 19793      CERTIFICATE-TRAILERS
 19794       TO DFHEIV11
 19795*    MOVE '&& L                  %   #00019026' TO DFHEIV0
 19796     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19797     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19798     MOVE X'2020233030303139303236' TO DFHEIV0(25:11)
 19799     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 366
* EL050.cbl
 19800           CRTT-ID,
 19801           CERTIFICATE-TRAILERS,
 19802           DFHEIV11,
 19803           DFHEIV99
 19804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19805     ELSE
 19806
 19807* EXEC CICS UNLOCK
 19808*          DATASET  (CRTT-ID)
 19809*       END-EXEC
 19810*    MOVE '&*                    #   #00019031' TO DFHEIV0
 19811     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 19812     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 19813     MOVE X'2020233030303139303331' TO DFHEIV0(25:11)
 19814     CALL 'kxdfhei1' USING DFHEIV0,
 19815           CRTT-ID,
 19816           DFHEIV99
 19817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19818     END-IF.
 19819
 19820     GO TO 8180-EXIT.
 19821
 19822 8180-NOTFND.
 19823
 19824     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19825     MOVE 'CS'         TO CS-RECORD-ID.
 19826     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19827     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19828     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19829     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 19830
 19831* EXEC CICS WRITE
 19832*       DATASET  (CRTT-ID)
 19833*       RIDFLD   (WS-ELCRTT-KEY)
 19834*       FROM     (CERTIFICATE-TRAILERS)
 19835*    END-EXEC.
 19836     MOVE LENGTH OF
 19837      CERTIFICATE-TRAILERS
 19838       TO DFHEIV11
 19839*    MOVE '&$ L                  ''   #00019046' TO DFHEIV0
 19840     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19841     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19842     MOVE X'2020233030303139303436' TO DFHEIV0(25:11)
 19843     CALL 'kxdfhei1' USING DFHEIV0,
 19844           CRTT-ID,
 19845           CERTIFICATE-TRAILERS,
 19846           DFHEIV11,
 19847           WS-ELCRTT-KEY,
 19848           DFHEIV99,
 19849           DFHEIV99
 19850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19851
 19852
 19853 8180-EXIT.
 19854     EXIT.
 19855
 19856 8190-UPDATE-REFUND-CLAIM-FLAG.
 19857
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 367
* EL050.cbl
 19858* EXEC CICS HANDLE CONDITION
 19859*        NOTFND   (8190-NOTFND)
 19860*    END-EXEC.
 19861*    MOVE '"$I                   ! 1 #00019056' TO DFHEIV0
 19862     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19864     MOVE X'3120233030303139303536' TO DFHEIV0(25:11)
 19865     CALL 'kxdfhei1' USING DFHEIV0
 19866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19867
 19868
 19869     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19870     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19871
 19872
 19873* EXEC CICS READ
 19874*        UPDATE
 19875*        DATASET  (CRTT-ID)
 19876*        RIDFLD   (WS-ELCRTT-KEY)
 19877*        INTO     (CERTIFICATE-TRAILERS)
 19878*    END-EXEC.
 19879     MOVE LENGTH OF
 19880      CERTIFICATE-TRAILERS
 19881       TO DFHEIV11
 19882*    MOVE '&"IL       EU         (   #00019063' TO DFHEIV0
 19883     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19884     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19885     MOVE X'2020233030303139303633' TO DFHEIV0(25:11)
 19886     CALL 'kxdfhei1' USING DFHEIV0,
 19887           CRTT-ID,
 19888           CERTIFICATE-TRAILERS,
 19889           DFHEIV11,
 19890           WS-ELCRTT-KEY,
 19891           DFHEIV99,
 19892           DFHEIV99,
 19893           DFHEIV99
 19894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19895
 19896
 19897     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19898
 19899* EXEC CICS REWRITE
 19900*       DATASET  (CRTT-ID)
 19901*       FROM     (CERTIFICATE-TRAILERS)
 19902*    END-EXEC.
 19903     MOVE LENGTH OF
 19904      CERTIFICATE-TRAILERS
 19905       TO DFHEIV11
 19906*    MOVE '&& L                  %   #00019071' TO DFHEIV0
 19907     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19908     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19909     MOVE X'2020233030303139303731' TO DFHEIV0(25:11)
 19910     CALL 'kxdfhei1' USING DFHEIV0,
 19911           CRTT-ID,
 19912           CERTIFICATE-TRAILERS,
 19913           DFHEIV11,
 19914           DFHEIV99
 19915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 368
* EL050.cbl
 19916
 19917
 19918     GO TO 8190-EXIT.
 19919
 19920 8190-NOTFND.
 19921
 19922     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 19923     MOVE 'CS'         TO CS-RECORD-ID.
 19924     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 19925     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 19926     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 19927     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 19928
 19929* EXEC CICS WRITE
 19930*       DATASET  (CRTT-ID)
 19931*       RIDFLD   (WS-ELCRTT-KEY)
 19932*       FROM     (CERTIFICATE-TRAILERS)
 19933*    END-EXEC.
 19934     MOVE LENGTH OF
 19935      CERTIFICATE-TRAILERS
 19936       TO DFHEIV11
 19937*    MOVE '&$ L                  ''   #00019086' TO DFHEIV0
 19938     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19939     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19940     MOVE X'2020233030303139303836' TO DFHEIV0(25:11)
 19941     CALL 'kxdfhei1' USING DFHEIV0,
 19942           CRTT-ID,
 19943           CERTIFICATE-TRAILERS,
 19944           DFHEIV11,
 19945           WS-ELCRTT-KEY,
 19946           DFHEIV99,
 19947           DFHEIV99
 19948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19949
 19950
 19951 8190-EXIT.
 19952     EXIT.
 19953
 19954 8195-UPDATE-AGE-FLAGS.
 19955
 19956* EXEC CICS HANDLE CONDITION
 19957*        NOTFND   (8195-NOTFND)
 19958*    END-EXEC.
 19959*    MOVE '"$I                   ! 2 #00019096' TO DFHEIV0
 19960     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19961     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19962     MOVE X'3220233030303139303936' TO DFHEIV0(25:11)
 19963     CALL 'kxdfhei1' USING DFHEIV0
 19964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19965
 19966
 19967     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 19968     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 19969
 19970
 19971* EXEC CICS READ
 19972*        UPDATE
 19973*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 369
* EL050.cbl
 19974*        RIDFLD   (WS-ELCRTT-KEY)
 19975*        INTO     (CERTIFICATE-TRAILERS)
 19976*    END-EXEC.
 19977     MOVE LENGTH OF
 19978      CERTIFICATE-TRAILERS
 19979       TO DFHEIV11
 19980*    MOVE '&"IL       EU         (   #00019103' TO DFHEIV0
 19981     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19982     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19983     MOVE X'2020233030303139313033' TO DFHEIV0(25:11)
 19984     CALL 'kxdfhei1' USING DFHEIV0,
 19985           CRTT-ID,
 19986           CERTIFICATE-TRAILERS,
 19987           DFHEIV11,
 19988           WS-ELCRTT-KEY,
 19989           DFHEIV99,
 19990           DFHEIV99,
 19991           DFHEIV99
 19992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19993
 19994
 19995     IF WS-INS-AGE-SET = 'Y'
 19996        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 19997     END-IF
 19998     IF WS-JNT-AGE-SET = 'Y'
 19999        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20000     END-IF
 20001
 20002
 20003* EXEC CICS REWRITE
 20004*       DATASET  (CRTT-ID)
 20005*       FROM     (CERTIFICATE-TRAILERS)
 20006*    END-EXEC.
 20007     MOVE LENGTH OF
 20008      CERTIFICATE-TRAILERS
 20009       TO DFHEIV11
 20010*    MOVE '&& L                  %   #00019117' TO DFHEIV0
 20011     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20012     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20013     MOVE X'2020233030303139313137' TO DFHEIV0(25:11)
 20014     CALL 'kxdfhei1' USING DFHEIV0,
 20015           CRTT-ID,
 20016           CERTIFICATE-TRAILERS,
 20017           DFHEIV11,
 20018           DFHEIV99
 20019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20020
 20021
 20022     GO TO 8195-EXIT.
 20023
 20024 8195-NOTFND.
 20025
 20026     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20027     MOVE 'CS'         TO CS-RECORD-ID.
 20028     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20029     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20030     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20031     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 370
* EL050.cbl
 20032     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20033
 20034* EXEC CICS WRITE
 20035*       DATASET  (CRTT-ID)
 20036*       RIDFLD   (WS-ELCRTT-KEY)
 20037*       FROM     (CERTIFICATE-TRAILERS)
 20038*    END-EXEC.
 20039     MOVE LENGTH OF
 20040      CERTIFICATE-TRAILERS
 20041       TO DFHEIV11
 20042*    MOVE '&$ L                  ''   #00019133' TO DFHEIV0
 20043     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20044     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20045     MOVE X'2020233030303139313333' TO DFHEIV0(25:11)
 20046     CALL 'kxdfhei1' USING DFHEIV0,
 20047           CRTT-ID,
 20048           CERTIFICATE-TRAILERS,
 20049           DFHEIV11,
 20050           WS-ELCRTT-KEY,
 20051           DFHEIV99,
 20052           DFHEIV99
 20053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20054
 20055
 20056 8195-EXIT.
 20057     EXIT.
 20058
 20059 8200-READ-REIN-TABLE.
 20060
 20061* EXEC CICS HANDLE CONDITION
 20062*         NOTFND   (8200-NOTFND)
 20063*    END-EXEC.
 20064*    MOVE '"$I                   ! 3 #00019143' TO DFHEIV0
 20065     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20067     MOVE X'3320233030303139313433' TO DFHEIV0(25:11)
 20068     CALL 'kxdfhei1' USING DFHEIV0
 20069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20070
 20071
 20072
 20073* EXEC CICS READ
 20074*        DATASET     (REIN-ID)
 20075*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20076*        RIDFLD      (ERREIN-KEY)
 20077*    END-EXEC.
 20078*    MOVE '&"S        E          (   #00019147' TO DFHEIV0
 20079     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20081     MOVE X'2020233030303139313437' TO DFHEIV0(25:11)
 20082     CALL 'kxdfhei1' USING DFHEIV0,
 20083           REIN-ID,
 20084           DFHEIV20,
 20085           DFHEIV99,
 20086           ERREIN-KEY,
 20087           DFHEIV99,
 20088           DFHEIV99,
 20089           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 371
* EL050.cbl
 20090     SET ADDRESS OF REINSURANCE-RECORD TO
 20091         DFHEIV20
 20092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20093
 20094
 20095     GO TO 8200-EXIT.
 20096
 20097 8200-NOTFND.
 20098     MOVE 'N'             TO WS-REIN-READ-SW.
 20099
 20100 8200-EXIT.
 20101      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 372
* EL050.cbl
 20103
 20104 8300-READ-CTBL-TABLE.
 20105
 20106* EXEC CICS HANDLE CONDITION
 20107*        NOTFND    (8300-NOTFND)
 20108*        DISABLED  (8300-ERRESS-PROBLEM)
 20109*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20110*        ENDFILE   (8300-NOTFND)
 20111*    END-EXEC.
 20112*    MOVE '"$IcJ''                ! 4 #00019163' TO DFHEIV0
 20113     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20114     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20115     MOVE X'3420233030303139313633' TO DFHEIV0(25:11)
 20116     CALL 'kxdfhei1' USING DFHEIV0
 20117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20118
 20119
 20120
 20121* EXEC CICS READ
 20122*        DATASET     (CTBL-ID)
 20123*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20124*        RIDFLD      (ERCTBL-KEY)
 20125*    END-EXEC.
 20126*    MOVE '&"S        E          (   #00019170' TO DFHEIV0
 20127     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20128     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20129     MOVE X'2020233030303139313730' TO DFHEIV0(25:11)
 20130     CALL 'kxdfhei1' USING DFHEIV0,
 20131           CTBL-ID,
 20132           DFHEIV20,
 20133           DFHEIV99,
 20134           ERCTBL-KEY,
 20135           DFHEIV99,
 20136           DFHEIV99,
 20137           DFHEIV99
 20138     SET ADDRESS OF COMM-TABLE-RECORD TO
 20139         DFHEIV20
 20140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20141
 20142
 20143     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20144
 20145     GO TO 8300-EXIT.
 20146
 20147 8300-NOTFND.
 20148
 20149     IF CTBL-SW = '0530'
 20150         MOVE 'AA'                     TO WS-AH-COMP-CD
 20151         MOVE '0550'                   TO CTBL-SW
 20152         MOVE '1'                      TO WS-CTBL-READ-SW
 20153         GO TO 8300-EXIT.
 20154
 20155     IF CTBL-SW = '0540'
 20156         MOVE 'AA'                     TO WS-LF-COMP-CD
 20157         MOVE '0550'                   TO CTBL-SW
 20158         MOVE '1'                      TO WS-CTBL-READ-SW
 20159         GO TO 8300-EXIT.
 20160
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 373
* EL050.cbl
 20161     IF CTBL-SW = '0550'
 20162         MOVE '2'                      TO WS-CTBL-READ-SW
 20163         GO TO 8300-EXIT.
 20164
 20165     GO TO 8300-EXIT.
 20166
 20167 8300-ERRESS-PROBLEM.
 20168
 20169      MOVE ER-8050              TO WS-ERROR.
 20170      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20171
 20172     GO TO 8300-EXIT.
 20173
 20174 8300-EXIT.
 20175      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 374
* EL050.cbl
 20177
 20178
 20179 8400-GETMAIN-ERFORM.
 20180
 20181
 20182* EXEC CICS   GETMAIN
 20183*        LENGTH  (500)
 20184*        SET     (ADDRESS OF FORM-MASTER)
 20185*    END-EXEC.
 20186     MOVE 500
 20187       TO DFHEIV11
 20188*    MOVE '," L                  $   #00019214' TO DFHEIV0
 20189     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20190     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20191     MOVE X'2020233030303139323134' TO DFHEIV0(25:11)
 20192     CALL 'kxdfhei1' USING DFHEIV0,
 20193           DFHEIV20,
 20194           DFHEIV11,
 20195           DFHEIV99
 20196     SET ADDRESS OF FORM-MASTER TO
 20197         DFHEIV20
 20198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20199
 20200
 20201     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20202
 20203 8400-EXIT.
 20204      EXIT.
 20205
 20206 8450-READ-FORM-MASTER.
 20207
 20208
 20209* EXEC CICS  HANDLE CONDITION
 20210*        NOTFND   (8450-FORM-NOT-FOUND)
 20211*        ENDFILE  (8450-FORM-NOT-FOUND)
 20212*    END-EXEC.
 20213*    MOVE '"$I''                  ! 5 #00019226' TO DFHEIV0
 20214     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20216     MOVE X'3520233030303139323236' TO DFHEIV0(25:11)
 20217     CALL 'kxdfhei1' USING DFHEIV0
 20218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20219
 20220
 20221
 20222* EXEC CICS   READ
 20223*        DATASET   (FORM-ID)
 20224*        RIDFLD    (ERFORM-KEY)
 20225*        INTO      (FORM-MASTER)
 20226*        GTEQ
 20227*    END-EXEC.
 20228     MOVE LENGTH OF
 20229      FORM-MASTER
 20230       TO DFHEIV11
 20231*    MOVE '&"IL       G          (   #00019231' TO DFHEIV0
 20232     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20234     MOVE X'2020233030303139323331' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 375
* EL050.cbl
 20235     CALL 'kxdfhei1' USING DFHEIV0,
 20236           FORM-ID,
 20237           FORM-MASTER,
 20238           DFHEIV11,
 20239           ERFORM-KEY,
 20240           DFHEIV99,
 20241           DFHEIV99,
 20242           DFHEIV99
 20243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20244
 20245
 20246     MOVE  'Y'           TO  FORM-MASTER-SW.
 20247
 20248     GO TO  8450-EXIT.
 20249
 20250 8450-FORM-NOT-FOUND.
 20251
 20252     MOVE  'N'           TO  FORM-MASTER-SW.
 20253
 20254 8450-EXIT.
 20255      EXIT.
 20256
 20257 8500-DATE-CONVERT.
 20258
 20259* EXEC CICS LINK
 20260*        PROGRAM    ('ELDATCV')
 20261*        COMMAREA   (DATE-CONVERSION-DATA)
 20262*        LENGTH     (DC-COMM-LENGTH)
 20263*    END-EXEC.
 20264     MOVE 'ELDATCV' TO DFHEIV1
 20265*    MOVE '."C                   (   #00019250' TO DFHEIV0
 20266     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20268     MOVE X'2020233030303139323530' TO DFHEIV0(25:11)
 20269     CALL 'kxdfhei1' USING DFHEIV0,
 20270           DFHEIV1,
 20271           DATE-CONVERSION-DATA,
 20272           DC-COMM-LENGTH,
 20273           DFHEIV99,
 20274           DFHEIV99,
 20275           DFHEIV99,
 20276           DFHEIV99
 20277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20278
 20279
 20280 8500-EXIT.
 20281     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 376
* EL050.cbl
 20283
 20284 8555-RELOAD-CONTROL-FILE.
 20285     CONTINUE.
 20286
 20287 8555-EXIT.
 20288     EXIT.
 20289
 20290 8557-GETMAIN-ERPLAN.
 20291
 20292
 20293* EXEC CICS GETMAIN
 20294*        LENGTH    (840)
 20295*        SET       (ADDRESS OF PLAN-RECORDS)
 20296*    END-EXEC.
 20297     MOVE 840
 20298       TO DFHEIV11
 20299*    MOVE '," L                  $   #00019268' TO DFHEIV0
 20300     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20301     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20302     MOVE X'2020233030303139323638' TO DFHEIV0(25:11)
 20303     CALL 'kxdfhei1' USING DFHEIV0,
 20304           DFHEIV20,
 20305           DFHEIV11,
 20306           DFHEIV99
 20307     SET ADDRESS OF PLAN-RECORDS TO
 20308         DFHEIV20
 20309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20310
 20311
 20312     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20313
 20314 8557-EXIT.
 20315     EXIT.
 20316
 20317 8560-GETMAIN.
 20318
 20319* EXEC CICS GETMAIN
 20320*        LENGTH    (2000)
 20321*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20322*    END-EXEC.
 20323     MOVE 2000
 20324       TO DFHEIV11
 20325*    MOVE '," L                  $   #00019279' TO DFHEIV0
 20326     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20327     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20328     MOVE X'2020233030303139323739' TO DFHEIV0(25:11)
 20329     CALL 'kxdfhei1' USING DFHEIV0,
 20330           DFHEIV20,
 20331           DFHEIV11,
 20332           DFHEIV99
 20333     SET ADDRESS OF ACCOUNT-MASTER TO
 20334         DFHEIV20
 20335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20336
 20337
 20338     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20339
 20340 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 377
* EL050.cbl
 20341     EXIT.
 20342
 20343 8570-START-ACCOUNT-MASTER.
 20344
 20345* EXEC CICS HANDLE CONDITION
 20346*        NOTFND    (0199-ACCT-NOT-FOUND)
 20347*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20348*    END-EXEC.
 20349*    MOVE '"$I''                  ! 6 #00019290' TO DFHEIV0
 20350     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20352     MOVE X'3620233030303139323930' TO DFHEIV0(25:11)
 20353     CALL 'kxdfhei1' USING DFHEIV0
 20354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20355
 20356
 20357
 20358* EXEC CICS STARTBR
 20359*        DATASET    (ACCT-ID)
 20360*        RIDFLD     (ERACCT-KEY)
 20361*        GTEQ
 20362*    END-EXEC.
 20363     MOVE 0
 20364       TO DFHEIV11
 20365*    MOVE '&,         G          &   #00019295' TO DFHEIV0
 20366     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20367     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20368     MOVE X'2020233030303139323935' TO DFHEIV0(25:11)
 20369     CALL 'kxdfhei1' USING DFHEIV0,
 20370           ACCT-ID,
 20371           ERACCT-KEY,
 20372           DFHEIV99,
 20373           DFHEIV11,
 20374           DFHEIV99
 20375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20376
 20377
 20378 8570-EXIT.
 20379     EXIT.
 20380
 20381 8580-READ-ACCOUNT-MASTER.
 20382
 20383* EXEC CICS HANDLE CONDITION
 20384*        NOTFND    (0199-ACCT-NOT-FOUND)
 20385*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20386*    END-EXEC.
 20387*    MOVE '"$I''                  ! 7 #00019305' TO DFHEIV0
 20388     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20390     MOVE X'3720233030303139333035' TO DFHEIV0(25:11)
 20391     CALL 'kxdfhei1' USING DFHEIV0
 20392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20393
 20394
 20395
 20396* EXEC CICS READNEXT
 20397*        DATASET     (ACCT-ID)
 20398*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 378
* EL050.cbl
 20399*        RIDFLD      (ERACCT-KEY)
 20400*    END-EXEC.
 20401     MOVE LENGTH OF
 20402      ACCOUNT-MASTER
 20403       TO DFHEIV12
 20404     MOVE 0
 20405       TO DFHEIV11
 20406*    MOVE '&.IL                  )   #00019310' TO DFHEIV0
 20407     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20408     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20409     MOVE X'2020233030303139333130' TO DFHEIV0(25:11)
 20410     CALL 'kxdfhei1' USING DFHEIV0,
 20411           ACCT-ID,
 20412           ACCOUNT-MASTER,
 20413           DFHEIV12,
 20414           ERACCT-KEY,
 20415           DFHEIV99,
 20416           DFHEIV11,
 20417           DFHEIV99,
 20418           DFHEIV99
 20419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20420
 20421
 20422 8580-EXIT.
 20423     EXIT.
 20424
 20425 8582-READ-COMPENSATION-MASTER.
 20426
 20427* EXEC CICS HANDLE CONDITION
 20428*        NOTFND    (8582-COMP-NOT-FOUND)
 20429*        ENDFILE   (8582-COMP-NOT-FOUND)
 20430*    END-EXEC.
 20431*    MOVE '"$I''                  ! 8 #00019320' TO DFHEIV0
 20432     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20434     MOVE X'3820233030303139333230' TO DFHEIV0(25:11)
 20435     CALL 'kxdfhei1' USING DFHEIV0
 20436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20437
 20438
 20439
 20440* EXEC CICS READ
 20441*        DATASET     (COMP-ID)
 20442*        INTO        (COMPENSATION-MASTER)
 20443*        RIDFLD      (ERCOMP-KEY)
 20444*    END-EXEC.
 20445     MOVE LENGTH OF
 20446      COMPENSATION-MASTER
 20447       TO DFHEIV11
 20448*    MOVE '&"IL       E          (   #00019325' TO DFHEIV0
 20449     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20450     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20451     MOVE X'2020233030303139333235' TO DFHEIV0(25:11)
 20452     CALL 'kxdfhei1' USING DFHEIV0,
 20453           COMP-ID,
 20454           COMPENSATION-MASTER,
 20455           DFHEIV11,
 20456           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 379
* EL050.cbl
 20457           DFHEIV99,
 20458           DFHEIV99,
 20459           DFHEIV99
 20460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20461
 20462
 20463     MOVE 'Y'                    TO COMP-MASTER-SW
 20464
 20465     GO TO 8582-EXIT
 20466     .
 20467 8582-COMP-NOT-FOUND.
 20468
 20469     MOVE 'N'                    TO COMP-MASTER-SW.
 20470
 20471 8582-EXIT.
 20472     EXIT.
 20473
 20474 8583-READ-ERAGTC.
 20475
 20476* EXEC CICS HANDLE CONDITION
 20477*        NOTFND    (8583-AGTC-NOT-FOUND)
 20478*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20479*    END-EXEC.
 20480*    MOVE '"$I''                  ! 9 #00019343' TO DFHEIV0
 20481     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20482     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20483     MOVE X'3920233030303139333433' TO DFHEIV0(25:11)
 20484     CALL 'kxdfhei1' USING DFHEIV0
 20485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20486
 20487
 20488
 20489* EXEC CICS STARTBR
 20490*        DATASET    (AGTC-ID)
 20491*        RIDFLD     (ERAGTC-KEY)
 20492*        GTEQ
 20493*    END-EXEC.
 20494     MOVE 0
 20495       TO DFHEIV11
 20496*    MOVE '&,         G          &   #00019348' TO DFHEIV0
 20497     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20498     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20499     MOVE X'2020233030303139333438' TO DFHEIV0(25:11)
 20500     CALL 'kxdfhei1' USING DFHEIV0,
 20501           AGTC-ID,
 20502           ERAGTC-KEY,
 20503           DFHEIV99,
 20504           DFHEIV11,
 20505           DFHEIV99
 20506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20507
 20508
 20509 8583-READ-ERAGTC-NEXT.
 20510
 20511* EXEC CICS READNEXT
 20512*        DATASET     (AGTC-ID)
 20513*        INTO        (AGENT-COMMISSIONS)
 20514*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 380
* EL050.cbl
 20515*    END-EXEC.
 20516     MOVE LENGTH OF
 20517      AGENT-COMMISSIONS
 20518       TO DFHEIV12
 20519     MOVE 0
 20520       TO DFHEIV11
 20521*    MOVE '&.IL                  )   #00019355' TO DFHEIV0
 20522     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20523     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20524     MOVE X'2020233030303139333535' TO DFHEIV0(25:11)
 20525     CALL 'kxdfhei1' USING DFHEIV0,
 20526           AGTC-ID,
 20527           AGENT-COMMISSIONS,
 20528           DFHEIV12,
 20529           ERAGTC-KEY,
 20530           DFHEIV99,
 20531           DFHEIV11,
 20532           DFHEIV99,
 20533           DFHEIV99
 20534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20535
 20536
 20537*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20538
 20539     GO TO 8583-EXIT
 20540     .
 20541 8583-AGTC-NOT-FOUND.
 20542
 20543     MOVE 'N'                    TO AGTC-MASTER-SW.
 20544
 20545 8583-EXIT.
 20546     EXIT.
 20547
 20548 8584-READ-BANK-CROSS-REF.
 20549
 20550* EXEC CICS HANDLE CONDITION
 20551*        NOTFND    (8584-BXRF-NOT-FOUND)
 20552*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20553*    END-EXEC.
 20554*    MOVE '"$I''                  ! : #00019373' TO DFHEIV0
 20555     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20556     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20557     MOVE X'3A20233030303139333733' TO DFHEIV0(25:11)
 20558     CALL 'kxdfhei1' USING DFHEIV0
 20559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20560
 20561
 20562
 20563* EXEC CICS READ
 20564*        DATASET     (BXRF-ID)
 20565*        INTO        (BANK-CROSS-REFERENCE)
 20566*        RIDFLD      (ERBXRF-KEY)
 20567*        LENGTH      (BXRF-REC-LENGTH)
 20568*    END-EXEC.
 20569*    MOVE '&"IL       E          (   #00019378' TO DFHEIV0
 20570     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20572     MOVE X'2020233030303139333738' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 381
* EL050.cbl
 20573     CALL 'kxdfhei1' USING DFHEIV0,
 20574           BXRF-ID,
 20575           BANK-CROSS-REFERENCE,
 20576           BXRF-REC-LENGTH,
 20577           ERBXRF-KEY,
 20578           DFHEIV99,
 20579           DFHEIV99,
 20580           DFHEIV99
 20581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20582
 20583
 20584     MOVE 'Y'                    TO BXRF-MASTER-SW
 20585
 20586     GO TO 8584-EXIT
 20587     .
 20588 8584-BXRF-NOT-FOUND.
 20589
 20590     MOVE 'N'                    TO BXRF-MASTER-SW.
 20591
 20592 8584-EXIT.
 20593     EXIT.
 20594
 20595 8585-READ-PLAN-MASTER.
 20596
 20597
 20598* EXEC CICS HANDLE CONDITION
 20599*        NOTFND    (8585-PLAN-NOT-FOUND)
 20600*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20601*    END-EXEC.
 20602*    MOVE '"$I''                  ! ; #00019398' TO DFHEIV0
 20603     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20605     MOVE X'3B20233030303139333938' TO DFHEIV0(25:11)
 20606     CALL 'kxdfhei1' USING DFHEIV0
 20607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20608
 20609
 20610
 20611* EXEC CICS READ
 20612*        DATASET     (PLAN-ID)
 20613*        INTO        (PLAN-MASTER)
 20614*        RIDFLD      (ERPLAN-KEY)
 20615*    END-EXEC.
 20616     MOVE LENGTH OF
 20617      PLAN-MASTER
 20618       TO DFHEIV11
 20619*    MOVE '&"IL       E          (   #00019403' TO DFHEIV0
 20620     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20621     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20622     MOVE X'2020233030303139343033' TO DFHEIV0(25:11)
 20623     CALL 'kxdfhei1' USING DFHEIV0,
 20624           PLAN-ID,
 20625           PLAN-MASTER,
 20626           DFHEIV11,
 20627           ERPLAN-KEY,
 20628           DFHEIV99,
 20629           DFHEIV99,
 20630           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 382
* EL050.cbl
 20631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20632
 20633
 20634     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20635
 20636     GO TO 8585-EXIT.
 20637
 20638 8585-PLAN-NOT-FOUND.
 20639
 20640     MOVE 'N'                    TO PLAN-MASTER-SW.
 20641
 20642 8585-EXIT.
 20643     EXIT.
 20644
 20645 8586-READ-LOAN-OFFICER.
 20646
 20647* EXEC CICS READ
 20648*        DATASET     (LOFC-ID)
 20649*        INTO        (LOAN-OFFICER-MASTER)
 20650*        RIDFLD      (ERLOFC-KEY)
 20651*        RESP        (WS-RESPONSE)
 20652*    END-EXEC
 20653     MOVE LENGTH OF
 20654      LOAN-OFFICER-MASTER
 20655       TO DFHEIV11
 20656*    MOVE '&"IL       E          (  N#00019421' TO DFHEIV0
 20657     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20658     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20659     MOVE X'204E233030303139343231' TO DFHEIV0(25:11)
 20660     CALL 'kxdfhei1' USING DFHEIV0,
 20661           LOFC-ID,
 20662           LOAN-OFFICER-MASTER,
 20663           DFHEIV11,
 20664           ERLOFC-KEY,
 20665           DFHEIV99,
 20666           DFHEIV99,
 20667           DFHEIV99
 20668     MOVE EIBRESP  TO WS-RESPONSE
 20669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20670
 20671     IF WS-RESP-NORMAL
 20672        MOVE 'Y'                 TO LOFC-MASTER-SW
 20673     ELSE
 20674        MOVE 'N'                 TO LOFC-MASTER-SW
 20675     END-IF
 20676     .
 20677 8586-EXIT.
 20678     EXIT.
 20679 8587-START-ERPDEF.
 20680
 20681* EXEC CICS STARTBR
 20682*       DATASET   (PDEF-ID)
 20683*       RIDFLD    (ERPDEF-KEY)
 20684*       GTEQ
 20685*       RESP      (WS-RESPONSE)
 20686*    END-EXEC
 20687     MOVE 0
 20688       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 383
* EL050.cbl
 20689*    MOVE '&,         G          &  N#00019437' TO DFHEIV0
 20690     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20691     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20692     MOVE X'204E233030303139343337' TO DFHEIV0(25:11)
 20693     CALL 'kxdfhei1' USING DFHEIV0,
 20694           PDEF-ID,
 20695           ERPDEF-KEY,
 20696           DFHEIV99,
 20697           DFHEIV11,
 20698           DFHEIV99
 20699     MOVE EIBRESP  TO WS-RESPONSE
 20700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20701     IF WS-RESP-NORMAL
 20702        MOVE 'Y'                 TO PDEF-MASTER-SW
 20703     ELSE
 20704        MOVE 'N'                 TO PDEF-MASTER-SW
 20705     END-IF
 20706     .
 20707 8587-EXIT.
 20708     EXIT.
 20709 8588-READ-ERPDEF.
 20710
 20711* EXEC CICS READNEXT
 20712*       DATASET   (PDEF-ID)
 20713*       RIDFLD    (ERPDEF-KEY)
 20714*       INTO      (PRODUCT-MASTER)
 20715*       RESP      (WS-RESPONSE)
 20716*    END-EXEC
 20717     MOVE LENGTH OF
 20718      PRODUCT-MASTER
 20719       TO DFHEIV12
 20720     MOVE 0
 20721       TO DFHEIV11
 20722*    MOVE '&.IL                  )  N#00019452' TO DFHEIV0
 20723     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20724     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20725     MOVE X'204E233030303139343532' TO DFHEIV0(25:11)
 20726     CALL 'kxdfhei1' USING DFHEIV0,
 20727           PDEF-ID,
 20728           PRODUCT-MASTER,
 20729           DFHEIV12,
 20730           ERPDEF-KEY,
 20731           DFHEIV99,
 20732           DFHEIV11,
 20733           DFHEIV99,
 20734           DFHEIV99
 20735     MOVE EIBRESP  TO WS-RESPONSE
 20736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20737     IF WS-RESP-NORMAL
 20738        MOVE 'Y'                 TO PDEF-MASTER-SW
 20739     ELSE
 20740        MOVE 'N'                 TO PDEF-MASTER-SW
 20741     END-IF
 20742     .
 20743 8588-EXIT.
 20744     EXIT.
 20745 8589-ENDBR-ERPDEF.
 20746
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 384
* EL050.cbl
 20747* EXEC CICS ENDBR
 20748*       DATASET   (PDEF-ID)
 20749*    END-EXEC
 20750     MOVE 0
 20751       TO DFHEIV11
 20752*    MOVE '&2                    $   #00019467' TO DFHEIV0
 20753     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20754     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20755     MOVE X'2020233030303139343637' TO DFHEIV0(25:11)
 20756     CALL 'kxdfhei1' USING DFHEIV0,
 20757           PDEF-ID,
 20758           DFHEIV11,
 20759           DFHEIV99
 20760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20761     .
 20762 8589-EXIT.
 20763     EXIT.
 20764 8590-READ-CERT-MASTER.
 20765     IF PB-COMPANY-ID = 'UCL'
 20766         GO TO 8690-READ-CERT-MASTER-UCL.
 20767
 20768
 20769* EXEC CICS HANDLE CONDITION
 20770*         NOTFND    (0299-CERT-NOT-FOUND)
 20771*    END-EXEC.
 20772*    MOVE '"$I                   ! < #00019477' TO DFHEIV0
 20773     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20775     MOVE X'3C20233030303139343737' TO DFHEIV0(25:11)
 20776     CALL 'kxdfhei1' USING DFHEIV0
 20777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20778
 20779
 20780
 20781* EXEC CICS READ
 20782*        DATASET     (CERT-ID)
 20783*        INTO        (CERTIFICATE-MASTER)
 20784*        RIDFLD      (ELCERT-KEY)
 20785*        UPDATE
 20786*    END-EXEC.
 20787     MOVE LENGTH OF
 20788      CERTIFICATE-MASTER
 20789       TO DFHEIV11
 20790*    MOVE '&"IL       EU         (   #00019481' TO DFHEIV0
 20791     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20792     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20793     MOVE X'2020233030303139343831' TO DFHEIV0(25:11)
 20794     CALL 'kxdfhei1' USING DFHEIV0,
 20795           CERT-ID,
 20796           CERTIFICATE-MASTER,
 20797           DFHEIV11,
 20798           ELCERT-KEY,
 20799           DFHEIV99,
 20800           DFHEIV99,
 20801           DFHEIV99
 20802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20803
 20804
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 385
* EL050.cbl
 20805 8590-EXIT.
 20806     EXIT.
 20807
 20808 8690-READ-CERT-MASTER-UCL.
 20809
 20810* EXEC CICS HANDLE CONDITION
 20811*         NOTFND    (8700-READ-CERT-MASTER)
 20812*    END-EXEC.
 20813*    MOVE '"$I                   ! = #00019492' TO DFHEIV0
 20814     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20816     MOVE X'3D20233030303139343932' TO DFHEIV0(25:11)
 20817     CALL 'kxdfhei1' USING DFHEIV0
 20818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20819
 20820
 20821 8690-READ-CERT-CONT.
 20822
 20823* EXEC CICS READ
 20824*        DATASET     (CERT-ID)
 20825*        INTO        (CERTIFICATE-MASTER)
 20826*        RIDFLD      (ELCERT-KEY)
 20827*        UPDATE
 20828*    END-EXEC.
 20829     MOVE LENGTH OF
 20830      CERTIFICATE-MASTER
 20831       TO DFHEIV11
 20832*    MOVE '&"IL       EU         (   #00019497' TO DFHEIV0
 20833     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20834     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20835     MOVE X'2020233030303139343937' TO DFHEIV0(25:11)
 20836     CALL 'kxdfhei1' USING DFHEIV0,
 20837           CERT-ID,
 20838           CERTIFICATE-MASTER,
 20839           DFHEIV11,
 20840           ELCERT-KEY,
 20841           DFHEIV99,
 20842           DFHEIV99,
 20843           DFHEIV99
 20844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20845
 20846
 20847     GO TO 8590-EXIT.
 20848
 20849 8700-READ-CERT-MASTER.
 20850     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 20851     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 20852
 20853* EXEC CICS HANDLE CONDITION
 20854*         DUPKEY    (8720-COMP-ACCOUNTS)
 20855*         ENDFILE   (8730-END-BROWSE)
 20856*         NOTFND    (8740-NOT-FOUND)
 20857*    END-EXEC.
 20858*    MOVE '"$$''I                 ! > #00019509' TO DFHEIV0
 20859     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 20860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20861     MOVE X'3E20233030303139353039' TO DFHEIV0(25:11)
 20862     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 386
* EL050.cbl
 20863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20864
 20865
 20866
 20867* EXEC CICS STARTBR
 20868*        DATASET     ('ELCERT5')
 20869*        RIDFLD      (ELCERT2-KEY)
 20870*        EQUAL
 20871*    END-EXEC.
 20872     MOVE 'ELCERT5' TO DFHEIV1
 20873     MOVE 0
 20874       TO DFHEIV11
 20875*    MOVE '&,         E          &   #00019515' TO DFHEIV0
 20876     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 20877     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20878     MOVE X'2020233030303139353135' TO DFHEIV0(25:11)
 20879     CALL 'kxdfhei1' USING DFHEIV0,
 20880           DFHEIV1,
 20881           ELCERT2-KEY,
 20882           DFHEIV99,
 20883           DFHEIV11,
 20884           DFHEIV99
 20885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20886
 20887
 20888 8710-READ-NEXT.
 20889
 20890* EXEC CICS READNEXT
 20891*        DATASET     ('ELCERT5')
 20892*        INTO        (CERTIFICATE-MASTER)
 20893*        RIDFLD      (ELCERT2-KEY)
 20894*    END-EXEC.
 20895     MOVE LENGTH OF
 20896      CERTIFICATE-MASTER
 20897       TO DFHEIV12
 20898     MOVE 'ELCERT5' TO DFHEIV1
 20899     MOVE 0
 20900       TO DFHEIV11
 20901*    MOVE '&.IL                  )   #00019522' TO DFHEIV0
 20902     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20903     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20904     MOVE X'2020233030303139353232' TO DFHEIV0(25:11)
 20905     CALL 'kxdfhei1' USING DFHEIV0,
 20906           DFHEIV1,
 20907           CERTIFICATE-MASTER,
 20908           DFHEIV12,
 20909           ELCERT2-KEY,
 20910           DFHEIV99,
 20911           DFHEIV11,
 20912           DFHEIV99,
 20913           DFHEIV99
 20914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20915
 20916
 20917 8720-COMP-ACCOUNTS.
 20918
 20919* EXEC CICS ENTER
 20920*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 387
* EL050.cbl
 20921*         FROM (PB-C-LAST-NAME)
 20922*    END-EXEC.
 20923     MOVE 001
 20924       TO DFHEIV11
 20925*    MOVE ':$F                   %   #00019529' TO DFHEIV0
 20926     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20927     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20928     MOVE X'2020233030303139353239' TO DFHEIV0(25:11)
 20929     CALL 'kxdfhei1' USING DFHEIV0,
 20930           DFHEIV11,
 20931           PB-C-LAST-NAME,
 20932           DFHEIV99,
 20933           DFHEIV99
 20934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20935
 20936
 20937
 20938* EXEC CICS ENTER
 20939*         TRACEID (002)
 20940*         FROM (CM-INSURED-LAST-NAME)
 20941*    END-EXEC.
 20942     MOVE 002
 20943       TO DFHEIV11
 20944*    MOVE ':$F                   %   #00019534' TO DFHEIV0
 20945     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 20946     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20947     MOVE X'2020233030303139353334' TO DFHEIV0(25:11)
 20948     CALL 'kxdfhei1' USING DFHEIV0,
 20949           DFHEIV11,
 20950           CM-INSURED-LAST-NAME,
 20951           DFHEIV99,
 20952           DFHEIV99
 20953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20954
 20955
 20956     IF PB-CERT-NO NOT = CM-CERT-NO
 20957         GO TO 8730-END-BROWSE.
 20958
 20959     IF PB-ACCOUNT = CM-ACCOUNT
 20960         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 20961             MOVE ER-2799        TO WS-ERROR
 20962             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 20963             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 20964             GO TO 8730-END-BROWSE.
 20965
 20966     GO TO 8710-READ-NEXT.
 20967
 20968 8730-END-BROWSE.
 20969
 20970* EXEC CICS ENDBR
 20971*         DATASET    ('ELCERT5')
 20972*    END-EXEC.
 20973     MOVE 'ELCERT5' TO DFHEIV1
 20974     MOVE 0
 20975       TO DFHEIV11
 20976*    MOVE '&2                    $   #00019552' TO DFHEIV0
 20977     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20978     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 388
* EL050.cbl
 20979     MOVE X'2020233030303139353532' TO DFHEIV0(25:11)
 20980     CALL 'kxdfhei1' USING DFHEIV0,
 20981           DFHEIV1,
 20982           DFHEIV11,
 20983           DFHEIV99
 20984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20985
 20986
 20987 8740-NOT-FOUND.
 20988     GO TO 0299-CERT-NOT-FOUND.
 20989
 20990 8750-START-ELSTAT.
 20991
 20992* EXEC CICS STARTBR
 20993*       DATASET   (STAT-ID)
 20994*       RIDFLD    (ELSTAT-KEY)
 20995*       GTEQ
 20996*       RESP      (WS-RESPONSE)
 20997*    END-EXEC
 20998     MOVE 0
 20999       TO DFHEIV11
 21000*    MOVE '&,         G          &  N#00019560' TO DFHEIV0
 21001     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21002     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21003     MOVE X'204E233030303139353630' TO DFHEIV0(25:11)
 21004     CALL 'kxdfhei1' USING DFHEIV0,
 21005           STAT-ID,
 21006           ELSTAT-KEY,
 21007           DFHEIV99,
 21008           DFHEIV11,
 21009           DFHEIV99
 21010     MOVE EIBRESP  TO WS-RESPONSE
 21011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21012     IF WS-RESP-NORMAL
 21013        MOVE 'Y'                 TO STAT-MASTER-SW
 21014     ELSE
 21015        MOVE 'N'                 TO STAT-MASTER-SW
 21016     END-IF
 21017     .
 21018 8750-EXIT.
 21019     EXIT.
 21020 8752-READ-ELSTAT.
 21021
 21022* EXEC CICS READNEXT
 21023*       DATASET   (STAT-ID)
 21024*       RIDFLD    (ELSTAT-KEY)
 21025*       INTO      (STATE-FILE)
 21026*       RESP      (WS-RESPONSE)
 21027*    END-EXEC
 21028     MOVE LENGTH OF
 21029      STATE-FILE
 21030       TO DFHEIV12
 21031     MOVE 0
 21032       TO DFHEIV11
 21033*    MOVE '&.IL                  )  N#00019575' TO DFHEIV0
 21034     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21035     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21036     MOVE X'204E233030303139353735' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 389
* EL050.cbl
 21037     CALL 'kxdfhei1' USING DFHEIV0,
 21038           STAT-ID,
 21039           STATE-FILE,
 21040           DFHEIV12,
 21041           ELSTAT-KEY,
 21042           DFHEIV99,
 21043           DFHEIV11,
 21044           DFHEIV99,
 21045           DFHEIV99
 21046     MOVE EIBRESP  TO WS-RESPONSE
 21047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21048     IF WS-RESP-NORMAL
 21049        MOVE 'Y'                 TO STAT-MASTER-SW
 21050     ELSE
 21051        MOVE 'N'                 TO STAT-MASTER-SW
 21052     END-IF
 21053     .
 21054 8752-EXIT.
 21055     EXIT.
 21056 8800-GET-COMP-RATE.
 21057     MOVE +1 TO IB.
 21058     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21059         ADD +9 TO IB
 21060         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21061             ADD +9 TO IB
 21062             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21063                MOVE ZEROS       TO WS-WK-RATE
 21064                GO TO 8800-EXIT.
 21065
 21066     IF PB-I-AGE GREATER CT-AGE (1)
 21067         ADD +3 TO IB
 21068         IF PB-I-AGE GREATER CT-AGE (2)
 21069             ADD +3 TO IB
 21070             IF PB-I-AGE GREATER CT-AGE (3)
 21071                MOVE ZEROS       TO WS-WK-RATE
 21072                GO TO 8800-EXIT.
 21073
 21074     IF WS-WORK-TERM GREATER CT-TRM (1)
 21075         ADD +1 TO IB
 21076         IF WS-WORK-TERM GREATER CT-TRM (2)
 21077             ADD +1 TO IB
 21078             IF WS-WORK-TERM GREATER CT-TRM (3)
 21079                MOVE ZEROS       TO WS-WK-RATE
 21080                GO TO 8800-EXIT.
 21081
 21082     IF CT-RT (IB) NOT NUMERIC
 21083         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21084         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21085         GO TO 8800-GET-COMP-RATE.
 21086
 21087     MOVE CT-RT (IB) TO WS-WK-RATE.
 21088
 21089 8800-EXIT.
 21090     EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 390
* EL050.cbl
 21092 8900-ADDRESS-FILE.
 21093     IF ERACCT-FILE-ADDRESSED
 21094         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21095         GO TO 8900-ADDRESS-EXIT.
 21096
 21097     IF ELCNTL-FILE-ADDRESSED
 21098         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21099         GO TO 8900-ADDRESS-EXIT.
 21100
 21101     IF ERPLAN-FILE-ADDRESSED
 21102         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21103         GO TO 8900-ADDRESS-EXIT.
 21104
 21105     IF ERFORM-FILE-ADDRESSED
 21106         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21107         GO TO 8900-ADDRESS-EXIT.
 21108
 21109 8900-ADDRESS-EXIT.
 21110     EXIT.
 21111
 21112 9000-READ-CONTROL.
 21113
 21114* EXEC CICS HANDLE CONDITION
 21115*        NOTFND    (9000-NOTFND)
 21116*    END-EXEC.
 21117*    MOVE '"$I                   ! ? #00019646' TO DFHEIV0
 21118     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21119     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21120     MOVE X'3F20233030303139363436' TO DFHEIV0(25:11)
 21121     CALL 'kxdfhei1' USING DFHEIV0
 21122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21123
 21124
 21125
 21126* EXEC CICS READ
 21127*        DATASET     (CNTL-ID)
 21128*        SET         (ADDRESS OF CONTROL-FILE)
 21129*        RIDFLD      (ELCNTL-KEY)
 21130*        GTEQ
 21131*    END-EXEC.
 21132*    MOVE '&"S        G          (   #00019650' TO DFHEIV0
 21133     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21134     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21135     MOVE X'2020233030303139363530' TO DFHEIV0(25:11)
 21136     CALL 'kxdfhei1' USING DFHEIV0,
 21137           CNTL-ID,
 21138           DFHEIV20,
 21139           DFHEIV99,
 21140           ELCNTL-KEY,
 21141           DFHEIV99,
 21142           DFHEIV99,
 21143           DFHEIV99
 21144     SET ADDRESS OF CONTROL-FILE TO
 21145         DFHEIV20
 21146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21147
 21148
 21149     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 391
* EL050.cbl
 21150
 21151 9000-NOTFND.
 21152     IF RC-SW-1 = '1'
 21153        MOVE ER-2616              TO WS-ERROR
 21154        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21155        GO TO 9000-EXIT.
 21156
 21157     IF RC-SW-1 = '2'
 21158        MOVE ER-2602              TO WS-ERROR
 21159        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21160
 21161 9000-EXIT.
 21162      EXIT.
 21163
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 392
* EL050.cbl
 21165 9100-READ-CONTROL.
 21166
 21167* EXEC CICS HANDLE CONDITION
 21168*        NOTFND  (9100-NOTFND)
 21169*        ENDFILE (9100-NOTFND)
 21170*    END-EXEC.
 21171*    MOVE '"$I''                  ! @ #00019674' TO DFHEIV0
 21172     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21174     MOVE X'4020233030303139363734' TO DFHEIV0(25:11)
 21175     CALL 'kxdfhei1' USING DFHEIV0
 21176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21177
 21178
 21179
 21180* EXEC CICS READ
 21181*        DATASET     (CNTL-ID)
 21182*        INTO        (CONTROL-FILE)
 21183*        RIDFLD      (ELCNTL-KEY)
 21184*        GTEQ
 21185*    END-EXEC.
 21186     MOVE LENGTH OF
 21187      CONTROL-FILE
 21188       TO DFHEIV11
 21189*    MOVE '&"IL       G          (   #00019679' TO DFHEIV0
 21190     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21191     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21192     MOVE X'2020233030303139363739' TO DFHEIV0(25:11)
 21193     CALL 'kxdfhei1' USING DFHEIV0,
 21194           CNTL-ID,
 21195           CONTROL-FILE,
 21196           DFHEIV11,
 21197           ELCNTL-KEY,
 21198           DFHEIV99,
 21199           DFHEIV99,
 21200           DFHEIV99
 21201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21202
 21203
 21204     GO TO 9100-EXIT.
 21205
 21206 9100-NOTFND.
 21207     IF RC-SW-2 = '0'
 21208        MOVE '1'                  TO STATE-RECORD-ERROR
 21209        GO TO 9100-EXIT
 21210     END-IF
 21211     IF RC-SW-2 = '1'
 21212        MOVE '1'                  TO LF-BENEFIT-ERROR
 21213        MOVE ER-2604              TO WS-ERROR
 21214        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21215        GO TO 9100-EXIT.
 21216
 21217     IF RC-SW-2 = '2'
 21218        MOVE '1'                  TO AH-BENEFIT-ERROR
 21219        MOVE ER-2605              TO WS-ERROR
 21220        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21221        GO TO 9100-EXIT.
 21222
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 393
* EL050.cbl
 21223     IF RC-SW-2 = '3'
 21224         MOVE ER-2603           TO WS-ERROR
 21225         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21226         GO TO 9100-EXIT.
 21227
 21228     IF RC-SW-2 = '4'
 21229         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21230         GO TO 9100-EXIT.
 21231
 21232     IF RC-SW-2 = '5'
 21233         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21234         IF WS-AH-INPUT-CD-1 = SPACE
 21235             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21236         ELSE
 21237             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21238
 21239 9100-EXIT.
 21240      EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 394
* EL050.cbl
 21242 9200-CONTROL-GETMAIN.
 21243
 21244* EXEC CICS GETMAIN
 21245*         LENGTH   (750)
 21246*         SET      (ADDRESS OF CONTROL-FILE)
 21247*    END-EXEC.
 21248     MOVE 750
 21249       TO DFHEIV11
 21250*    MOVE '," L                  $   #00019725' TO DFHEIV0
 21251     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21252     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21253     MOVE X'2020233030303139373235' TO DFHEIV0(25:11)
 21254     CALL 'kxdfhei1' USING DFHEIV0,
 21255           DFHEIV20,
 21256           DFHEIV11,
 21257           DFHEIV99
 21258     SET ADDRESS OF CONTROL-FILE TO
 21259         DFHEIV20
 21260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21261
 21262
 21263     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21264
 21265 9200-EXIT.
 21266     EXIT.
 21267
 21268 9250-UNLOCK-RETURN.
 21269
 21270* EXEC CICS UNLOCK
 21271*        DATASET   (CERT-ID)
 21272*    END-EXEC.
 21273*    MOVE '&*                    #   #00019736' TO DFHEIV0
 21274     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21275     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21276     MOVE X'2020233030303139373336' TO DFHEIV0(25:11)
 21277     CALL 'kxdfhei1' USING DFHEIV0,
 21278           CERT-ID,
 21279           DFHEIV99
 21280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21281
 21282
 21283 9300-ABEND.
 21284     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21285
 21286
 21287* EXEC CICS LINK
 21288*        PROGRAM   ('EL004')
 21289*        COMMAREA  (WS-ERROR-LINE)
 21290*        LENGTH    (72)
 21291*    END-EXEC.
 21292     MOVE 'EL004' TO DFHEIV1
 21293     MOVE 72
 21294       TO DFHEIV11
 21295*    MOVE '."C                   (   #00019743' TO DFHEIV0
 21296     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21297     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21298     MOVE X'2020233030303139373433' TO DFHEIV0(25:11)
 21299     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 395
* EL050.cbl
 21300           DFHEIV1,
 21301           WS-ERROR-LINE,
 21302           DFHEIV11,
 21303           DFHEIV99,
 21304           DFHEIV99,
 21305           DFHEIV99,
 21306           DFHEIV99
 21307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21308
 21309
 21310     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21311
 21312
 21313* EXEC CICS ABEND
 21314*        ABCODE ('EL50')
 21315*    END-EXEC.
 21316     MOVE 'EL50' TO DFHEIV5
 21317*    MOVE '.,A                   "   #00019751' TO DFHEIV0
 21318     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21319     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21320     MOVE X'2020233030303139373531' TO DFHEIV0(25:11)
 21321     CALL 'kxdfhei1' USING DFHEIV0,
 21322           DFHEIV5
 21323     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21324
 21325
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 396
* EL050.cbl
 21327
 21328******************************************************************
 21329*                                                                *
 21330*            E R R O R   F O R M A T   R O U T I N E             *
 21331*                                                                *
 21332******************************************************************
 21333
 21334 9900-ERROR-FORMAT.
 21335
 21336     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21337                    PB-COMMON-ERROR (2) OR
 21338                    PB-COMMON-ERROR (3) OR
 21339                    PB-COMMON-ERROR (4) OR
 21340                    PB-COMMON-ERROR (5) OR
 21341                    PB-COMMON-ERROR (6) OR
 21342                    PB-COMMON-ERROR (7) OR
 21343                    PB-COMMON-ERROR (8) OR
 21344                    PB-COMMON-ERROR (9) OR
 21345                    PB-COMMON-ERROR (10)
 21346        GO TO 9900-EXIT.
 21347
 21348     IF PB-NO-OF-ERRORS = +10
 21349        GO TO 9900-EXIT.
 21350
 21351     ADD +1  TO PB-NO-OF-ERRORS.
 21352     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21353                                       (PB-NO-OF-ERRORS).
 21354 9900-EXIT.
 21355     EXIT.
 21356
 21357 9990-RETURN.
 21358     IF BROWSE-STARTED
 21359
 21360* EXEC CICS ENDBR
 21361*            DATASET  (ACCT-ID)
 21362*       END-EXEC.
 21363     MOVE 0
 21364       TO DFHEIV11
 21365*    MOVE '&2                    $   #00019788' TO DFHEIV0
 21366     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21367     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21368     MOVE X'2020233030303139373838' TO DFHEIV0(25:11)
 21369     CALL 'kxdfhei1' USING DFHEIV0,
 21370           ACCT-ID,
 21371           DFHEIV11,
 21372           DFHEIV99
 21373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21374
 21375
 21376 9990-EXIT.
 21377     EXIT.
 21378
 21379
 21380****Check for CRTO record, add one if not found.
 21381 9991-CHECK-FOR-ELCRTO.
 21382
 21383* EXEC CICS HANDLE CONDITION
 21384*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 397
* EL050.cbl
 21385*         ENDFILE (9991-CRTO-NOT-FOUND)
 21386*     END-EXEC.
 21387*    MOVE '"$I''                  ! A #00019798' TO DFHEIV0
 21388     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21390     MOVE X'4120233030303139373938' TO DFHEIV0(25:11)
 21391     CALL 'kxdfhei1' USING DFHEIV0
 21392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21393
 21394     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21395     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21396     MOVE +0                     TO ELCRTO-SEQ-NO
 21397
 21398
 21399* EXEC CICS READ
 21400*       DATASET   ('ELCRTO')
 21401*       INTO      (ORIGINAL-CERTIFICATE)
 21402*       RIDFLD    (ELCRTO-KEY)
 21403*       GTEQ
 21404*       RESP      (WS-RESPONSE)
 21405*    END-EXEC
 21406     MOVE LENGTH OF
 21407      ORIGINAL-CERTIFICATE
 21408       TO DFHEIV11
 21409     MOVE 'ELCRTO' TO DFHEIV1
 21410*    MOVE '&"IL       G          (  N#00019806' TO DFHEIV0
 21411     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21412     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21413     MOVE X'204E233030303139383036' TO DFHEIV0(25:11)
 21414     CALL 'kxdfhei1' USING DFHEIV0,
 21415           DFHEIV1,
 21416           ORIGINAL-CERTIFICATE,
 21417           DFHEIV11,
 21418           ELCRTO-KEY,
 21419           DFHEIV99,
 21420           DFHEIV99,
 21421           DFHEIV99
 21422     MOVE EIBRESP  TO WS-RESPONSE
 21423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21424
 21425     IF WS-RESP-NORMAL
 21426        AND (OC-CONTROL-PRIMARY (1:33) =
 21427                 PB-CONTROL-BY-ACCOUNT (1:33))
 21428        AND (OC-RECORD-TYPE =  'I')
 21429           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21430               GO TO 9991-CHECK-INDICATORS
 21431           ELSE
 21432               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21433               GO TO 9991-CRTO-ADD-REC
 21434           END-IF
 21435     END-IF.
 21436
 21437 9991-CRTO-NOT-FOUND.
 21438
 21439     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21440     MOVE 'OC'                TO OC-RECORD-ID
 21441     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21442                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 398
* EL050.cbl
 21443     MOVE +4096               TO OC-KEY-SEQ-NO.
 21444
 21445 9991-CRTO-ADD-REC.
 21446
 21447     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21448     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21449     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21450     MOVE 'I'                 TO OC-RECORD-TYPE
 21451     IF PB-ISSUE
 21452         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21453         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21454         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21455         MOVE PB-I-AGE               TO OC-INS-AGE
 21456         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21457         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21458         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21459         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21460         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21461         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21462         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21463         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21464         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21465         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21466         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21467         IF PB-I-JOINT-COMMISSION > +0
 21468             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21469         ELSE
 21470             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21471         END-IF
 21472         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21473         MOVE +0                     TO OC-LF-CANCEL-AMT
 21474                                        OC-LF-ITD-CANCEL-AMT
 21475         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21476         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21477         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21478         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21479         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21480         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21481         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21482         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21483         MOVE +0                     TO OC-AH-CANCEL-AMT
 21484                                        OC-AH-ITD-CANCEL-AMT
 21485         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21486         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21487         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21488     ELSE
 21489         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21490         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21491         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21492         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21493         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21494         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21495         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21496         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21497         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21498          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21499             MOVE SPACES             TO OC-LF-BENCD
 21500             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 399
* EL050.cbl
 21501                                        OC-LF-BEN-AMT
 21502                                        OC-LF-PRM-AMT
 21503                                        OC-LF-ALT-BEN-AMT
 21504                                        OC-LF-ALT-PRM-AMT
 21505                                        OC-LF-COMM-PCT
 21506                                        OC-LF-CANCEL-AMT
 21507             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21508             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21509         ELSE
 21510             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21511             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21512             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21513             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21514             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21515             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21516             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21517             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21518             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21519             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21520         END-IF
 21521         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21522         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21523          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21524             MOVE SPACES             TO OC-AH-BENCD
 21525             MOVE ZEROS              TO OC-AH-TERM
 21526                                        OC-AH-BEN-AMT
 21527                                        OC-AH-PRM-AMT
 21528                                        OC-AH-COMM-PCT
 21529                                        OC-AH-CANCEL-AMT
 21530                                        OC-AH-CP
 21531             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21532             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21533         ELSE
 21534             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21535             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21536             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21537             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21538             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21539             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21540             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21541             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21542             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21543         END-IF
 21544         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21545         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21546         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21547         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21548     END-IF
 21549     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21550
 21551     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21552
 21553
 21554* EXEC CICS READ
 21555*         DATASET   (FILE-ERMAIL)
 21556*         RIDFLD    (MA-CONTROL-PRIMARY)
 21557*         INTO      (MAILING-DATA)
 21558*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 400
* EL050.cbl
 21559*    END-EXEC
 21560     MOVE LENGTH OF
 21561      MAILING-DATA
 21562       TO DFHEIV11
 21563*    MOVE '&"IL       E          (  N#00019942' TO DFHEIV0
 21564     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21565     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21566     MOVE X'204E233030303139393432' TO DFHEIV0(25:11)
 21567     CALL 'kxdfhei1' USING DFHEIV0,
 21568           FILE-ERMAIL,
 21569           MAILING-DATA,
 21570           DFHEIV11,
 21571           MA-CONTROL-PRIMARY,
 21572           DFHEIV99,
 21573           DFHEIV99,
 21574           DFHEIV99
 21575     MOVE EIBRESP  TO WS-RESPONSE
 21576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21577
 21578     IF WS-RESP-NORMAL
 21579         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21580     END-IF.
 21581
 21582     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21583     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21584
 21585
 21586* EXEC CICS READ
 21587*         DATASET  (CRTT-ID)
 21588*         RIDFLD   (WS-ELCRTT-KEY)
 21589*         INTO     (CERTIFICATE-TRAILERS)
 21590*         RESP     (WS-RESPONSE)
 21591*    END-EXEC
 21592     MOVE LENGTH OF
 21593      CERTIFICATE-TRAILERS
 21594       TO DFHEIV11
 21595*    MOVE '&"IL       E          (  N#00019956' TO DFHEIV0
 21596     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21597     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21598     MOVE X'204E233030303139393536' TO DFHEIV0(25:11)
 21599     CALL 'kxdfhei1' USING DFHEIV0,
 21600           CRTT-ID,
 21601           CERTIFICATE-TRAILERS,
 21602           DFHEIV11,
 21603           WS-ELCRTT-KEY,
 21604           DFHEIV99,
 21605           DFHEIV99,
 21606           DFHEIV99
 21607     MOVE EIBRESP  TO WS-RESPONSE
 21608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21609
 21610     IF WS-RESP-NORMAL
 21611         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21612         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21613     END-IF.
 21614
 21615
 21616* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 401
* EL050.cbl
 21617*       DATASET   ('ELCRTO')
 21618*       FROM      (ORIGINAL-CERTIFICATE)
 21619*       RIDFLD    (OC-CONTROL-PRIMARY)
 21620*       RESP      (WS-RESPONSE)
 21621*    END-EXEC.
 21622     MOVE LENGTH OF
 21623      ORIGINAL-CERTIFICATE
 21624       TO DFHEIV11
 21625     MOVE 'ELCRTO' TO DFHEIV1
 21626*    MOVE '&$ L                  ''  N#00019968' TO DFHEIV0
 21627     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21628     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21629     MOVE X'204E233030303139393638' TO DFHEIV0(25:11)
 21630     CALL 'kxdfhei1' USING DFHEIV0,
 21631           DFHEIV1,
 21632           ORIGINAL-CERTIFICATE,
 21633           DFHEIV11,
 21634           OC-CONTROL-PRIMARY,
 21635           DFHEIV99,
 21636           DFHEIV99
 21637     MOVE EIBRESP  TO WS-RESPONSE
 21638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21639
 21640
 21641     GO TO 9991-EXIT.
 21642
 21643 9991-CHECK-INDICATORS.
 21644
 21645     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21646         GO TO 9991-EXIT
 21647     END-IF.
 21648
 21649     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21650         GO TO 9991-EXIT
 21651     END-IF.
 21652
 21653
 21654* EXEC CICS READ
 21655*       DATASET   ('ELCRTO')
 21656*       INTO      (ORIGINAL-CERTIFICATE)
 21657*       RIDFLD    (OC-CONTROL-PRIMARY)
 21658*       UPDATE
 21659*       RESP      (WS-RESPONSE)
 21660*    END-EXEC
 21661     MOVE LENGTH OF
 21662      ORIGINAL-CERTIFICATE
 21663       TO DFHEIV11
 21664     MOVE 'ELCRTO' TO DFHEIV1
 21665*    MOVE '&"IL       EU         (  N#00019987' TO DFHEIV0
 21666     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21667     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21668     MOVE X'204E233030303139393837' TO DFHEIV0(25:11)
 21669     CALL 'kxdfhei1' USING DFHEIV0,
 21670           DFHEIV1,
 21671           ORIGINAL-CERTIFICATE,
 21672           DFHEIV11,
 21673           OC-CONTROL-PRIMARY,
 21674           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 402
* EL050.cbl
 21675           DFHEIV99,
 21676           DFHEIV99
 21677     MOVE EIBRESP  TO WS-RESPONSE
 21678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21679     IF WS-RESP-NORMAL
 21680        IF PB-ISSUE
 21681          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21682          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21683          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21684          MOVE PB-I-AGE               TO OC-INS-AGE
 21685          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21686          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21687          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21688          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21689          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21690          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21691          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21692          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21693          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21694          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21695          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21696          IF PB-I-JOINT-COMMISSION > +0
 21697              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21698          ELSE
 21699              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21700          END-IF
 21701          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21702          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21703          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21704          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21705          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21706          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21707          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21708          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21709          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21710
 21711          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21712
 21713* EXEC CICS READ
 21714*             DATASET   (FILE-ERMAIL)
 21715*             RIDFLD    (MA-CONTROL-PRIMARY)
 21716*             INTO      (MAILING-DATA)
 21717*             RESP      (WS-RESPONSE)
 21718*         END-EXEC
 21719     MOVE LENGTH OF
 21720      MAILING-DATA
 21721       TO DFHEIV11
 21722*    MOVE '&"IL       E          (  N#00020027' TO DFHEIV0
 21723     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21724     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21725     MOVE X'204E233030303230303237' TO DFHEIV0(25:11)
 21726     CALL 'kxdfhei1' USING DFHEIV0,
 21727           FILE-ERMAIL,
 21728           MAILING-DATA,
 21729           DFHEIV11,
 21730           MA-CONTROL-PRIMARY,
 21731           DFHEIV99,
 21732           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 403
* EL050.cbl
 21733           DFHEIV99
 21734     MOVE EIBRESP  TO WS-RESPONSE
 21735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21736          IF WS-RESP-NORMAL
 21737             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21738          END-IF
 21739
 21740          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21741          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21742
 21743* EXEC CICS READ
 21744*             DATASET  (CRTT-ID)
 21745*             RIDFLD   (WS-ELCRTT-KEY)
 21746*             INTO     (CERTIFICATE-TRAILERS)
 21747*             RESP     (WS-RESPONSE)
 21748*         END-EXEC
 21749     MOVE LENGTH OF
 21750      CERTIFICATE-TRAILERS
 21751       TO DFHEIV11
 21752*    MOVE '&"IL       E          (  N#00020039' TO DFHEIV0
 21753     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21754     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21755     MOVE X'204E233030303230303339' TO DFHEIV0(25:11)
 21756     CALL 'kxdfhei1' USING DFHEIV0,
 21757           CRTT-ID,
 21758           CERTIFICATE-TRAILERS,
 21759           DFHEIV11,
 21760           WS-ELCRTT-KEY,
 21761           DFHEIV99,
 21762           DFHEIV99,
 21763           DFHEIV99
 21764     MOVE EIBRESP  TO WS-RESPONSE
 21765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21766          IF WS-RESP-NORMAL
 21767             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 21768                               OC-INS-AGE-DEFAULT-FLAG
 21769             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 21770                               OC-JNT-AGE-DEFAULT-FLAG
 21771          END-IF
 21772
 21773        ELSE
 21774          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21775             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21776             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21777             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 21778          END-IF
 21779          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 21780             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21781             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21782             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 21783          END-IF
 21784          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 21785        END-IF
 21786
 21787* EXEC CICS REWRITE
 21788*          DATASET   ('ELCRTO')
 21789*          FROM      (ORIGINAL-CERTIFICATE)
 21790*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 404
* EL050.cbl
 21791*       END-EXEC
 21792     MOVE LENGTH OF
 21793      ORIGINAL-CERTIFICATE
 21794       TO DFHEIV11
 21795     MOVE 'ELCRTO' TO DFHEIV1
 21796*    MOVE '&& L                  %  N#00020065' TO DFHEIV0
 21797     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 21798     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21799     MOVE X'204E233030303230303635' TO DFHEIV0(25:11)
 21800     CALL 'kxdfhei1' USING DFHEIV0,
 21801           DFHEIV1,
 21802           ORIGINAL-CERTIFICATE,
 21803           DFHEIV11,
 21804           DFHEIV99
 21805     MOVE EIBRESP  TO WS-RESPONSE
 21806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21807     END-IF.
 21808
 21809 9991-EXIT.
 21810     EXIT.
 21811
 21812
 21813 9999-RETURN.
 21814     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 21815
 21816
 21817* EXEC CICS RETURN
 21818*    END-EXEC.
 21819*    MOVE '.(                    ''   #00020079' TO DFHEIV0
 21820     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 21821     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21822     MOVE X'2020233030303230303739' TO DFHEIV0(25:11)
 21823     CALL 'kxdfhei1' USING DFHEIV0,
 21824           DFHEIV99,
 21825           DFHEIV99,
 21826           DFHEIV99,
 21827           DFHEIV99,
 21828           DFHEIV99,
 21829           DFHEIV99
 21830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21831
 21832
 21833
 21834* GOBACK.
 21835     MOVE '9%                    "   ' TO DFHEIV0
 21836     MOVE 'EL050' TO DFHEIV1
 21837     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21838     GOBACK.
 21839
 21840 9999-DFHBACK SECTION.
 21841     MOVE '9%                    "   ' TO DFHEIV0
 21842     MOVE 'EL050' TO DFHEIV1
 21843     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21844     GOBACK.
 21845 9999-DFHEXIT.
 21846     IF DFHEIGDJ EQUAL 0001
 21847         NEXT SENTENCE
 21848     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 405
* EL050.cbl
 21849         GO TO 9300-ABEND,
 21850               3990-FILES-NOT-OPEN
 21851         DEPENDING ON DFHEIGDI
 21852     ELSE IF DFHEIGDJ EQUAL 3
 21853         GO TO 6610-START-BROWSE,
 21854               6630-ERRESS-PROBLEM,
 21855               6630-END-OF-FILE
 21856         DEPENDING ON DFHEIGDI
 21857     ELSE IF DFHEIGDJ EQUAL 4
 21858         GO TO 6630-END-OF-FILE,
 21859               6630-ERRESS-PROBLEM,
 21860               6630-ERRESS-PROBLEM,
 21861               6630-END-OF-FILE
 21862         DEPENDING ON DFHEIGDI
 21863     ELSE IF DFHEIGDJ EQUAL 5
 21864         GO TO 6630-END-OF-FILE,
 21865               6630-END-OF-FILE,
 21866               6630-ERRESS-PROBLEM,
 21867               6630-ERRESS-PROBLEM
 21868         DEPENDING ON DFHEIGDI
 21869     ELSE IF DFHEIGDJ EQUAL 6
 21870         GO TO 6660-START-BROWSE,
 21871               6690-ERRESC-PROBLEM,
 21872               6690-ERRESC-PROBLEM,
 21873               6690-END-OF-FILE
 21874         DEPENDING ON DFHEIGDI
 21875     ELSE IF DFHEIGDJ EQUAL 7
 21876         GO TO 6690-END-OF-FILE,
 21877               6690-ERRESC-PROBLEM,
 21878               6690-ERRESC-PROBLEM,
 21879               6690-END-OF-FILE
 21880         DEPENDING ON DFHEIGDI
 21881     ELSE IF DFHEIGDJ EQUAL 8
 21882         GO TO 6690-END-OF-FILE,
 21883               6690-ERRESC-PROBLEM,
 21884               6690-ERRESC-PROBLEM,
 21885               6690-END-OF-FILE
 21886         DEPENDING ON DFHEIGDI
 21887     ELSE IF DFHEIGDJ EQUAL 9
 21888         GO TO 7250-CONTINUE,
 21889               7250-CONTINUE
 21890         DEPENDING ON DFHEIGDI
 21891     ELSE IF DFHEIGDJ EQUAL 10
 21892         GO TO 7300-CONTINUE,
 21893               7300-CONTINUE
 21894         DEPENDING ON DFHEIGDI
 21895     ELSE IF DFHEIGDJ EQUAL 11
 21896         GO TO 8000-FREE-MAIN
 21897         DEPENDING ON DFHEIGDI
 21898     ELSE IF DFHEIGDJ EQUAL 12
 21899         GO TO 8100-NOTFND,
 21900               8100-NOTFND
 21901         DEPENDING ON DFHEIGDI
 21902     ELSE IF DFHEIGDJ EQUAL 13
 21903         GO TO 8110-NOTFND,
 21904               8110-NOTFND
 21905         DEPENDING ON DFHEIGDI
 21906     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 406
* EL050.cbl
 21907         GO TO 8130-EXIT
 21908         DEPENDING ON DFHEIGDI
 21909     ELSE IF DFHEIGDJ EQUAL 15
 21910         GO TO 8150-exit
 21911         DEPENDING ON DFHEIGDI
 21912     ELSE IF DFHEIGDJ EQUAL 16
 21913         GO TO 8180-NOTFND
 21914         DEPENDING ON DFHEIGDI
 21915     ELSE IF DFHEIGDJ EQUAL 17
 21916         GO TO 8190-NOTFND
 21917         DEPENDING ON DFHEIGDI
 21918     ELSE IF DFHEIGDJ EQUAL 18
 21919         GO TO 8195-NOTFND
 21920         DEPENDING ON DFHEIGDI
 21921     ELSE IF DFHEIGDJ EQUAL 19
 21922         GO TO 8200-NOTFND
 21923         DEPENDING ON DFHEIGDI
 21924     ELSE IF DFHEIGDJ EQUAL 20
 21925         GO TO 8300-NOTFND,
 21926               8300-ERRESS-PROBLEM,
 21927               8300-ERRESS-PROBLEM,
 21928               8300-NOTFND
 21929         DEPENDING ON DFHEIGDI
 21930     ELSE IF DFHEIGDJ EQUAL 21
 21931         GO TO 8450-FORM-NOT-FOUND,
 21932               8450-FORM-NOT-FOUND
 21933         DEPENDING ON DFHEIGDI
 21934     ELSE IF DFHEIGDJ EQUAL 22
 21935         GO TO 0199-ACCT-NOT-FOUND,
 21936               0199-ACCT-NOT-FOUND
 21937         DEPENDING ON DFHEIGDI
 21938     ELSE IF DFHEIGDJ EQUAL 23
 21939         GO TO 0199-ACCT-NOT-FOUND,
 21940               0199-ACCT-NOT-FOUND
 21941         DEPENDING ON DFHEIGDI
 21942     ELSE IF DFHEIGDJ EQUAL 24
 21943         GO TO 8582-COMP-NOT-FOUND,
 21944               8582-COMP-NOT-FOUND
 21945         DEPENDING ON DFHEIGDI
 21946     ELSE IF DFHEIGDJ EQUAL 25
 21947         GO TO 8583-AGTC-NOT-FOUND,
 21948               8583-AGTC-NOT-FOUND
 21949         DEPENDING ON DFHEIGDI
 21950     ELSE IF DFHEIGDJ EQUAL 26
 21951         GO TO 8584-BXRF-NOT-FOUND,
 21952               8584-BXRF-NOT-FOUND
 21953         DEPENDING ON DFHEIGDI
 21954     ELSE IF DFHEIGDJ EQUAL 27
 21955         GO TO 8585-PLAN-NOT-FOUND,
 21956               8585-PLAN-NOT-FOUND
 21957         DEPENDING ON DFHEIGDI
 21958     ELSE IF DFHEIGDJ EQUAL 28
 21959         GO TO 0299-CERT-NOT-FOUND
 21960         DEPENDING ON DFHEIGDI
 21961     ELSE IF DFHEIGDJ EQUAL 29
 21962         GO TO 8700-READ-CERT-MASTER
 21963         DEPENDING ON DFHEIGDI
 21964     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 10-Jul-14 07:12 Page 407
* EL050.cbl
 21965         GO TO 8720-COMP-ACCOUNTS,
 21966               8730-END-BROWSE,
 21967               8740-NOT-FOUND
 21968         DEPENDING ON DFHEIGDI
 21969     ELSE IF DFHEIGDJ EQUAL 31
 21970         GO TO 9000-NOTFND
 21971         DEPENDING ON DFHEIGDI
 21972     ELSE IF DFHEIGDJ EQUAL 32
 21973         GO TO 9100-NOTFND,
 21974               9100-NOTFND
 21975         DEPENDING ON DFHEIGDI
 21976     ELSE IF DFHEIGDJ EQUAL 33
 21977         GO TO 9991-CRTO-NOT-FOUND,
 21978               9991-CRTO-NOT-FOUND
 21979         DEPENDING ON DFHEIGDI.
 21980     MOVE '9%                    "   ' TO DFHEIV0
 21981     MOVE 'EL050' TO DFHEIV1
 21982     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 21983     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40032     Code:       88457
