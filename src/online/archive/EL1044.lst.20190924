* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page   1
* EL1044.cbl
* Options: int("EL1044.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1044.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1044.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1044.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1044.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page   2
* EL1044.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS FOR ACCOUNT SERVICES
    19*    SCREENS     - EL1044Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31******************************************************************
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 122011    2011022800001  AJRA  ADD ELCZREC COPYBOOK
    40* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
    41* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
    42* 080113    2013062000003  AJRA  ADD BARCODE,RETURN ENV FLAG
    43* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    44* 010914    2013090300001  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    45* 030516  CR2016012700004  PEMA  Add acct summ code of 5
    46******************************************************************
    47 ENVIRONMENT DIVISION.
    48 DATA DIVISION.
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*   EL1044 WORKING STORAGE     *'.
    53 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    54 77  M1                          PIC S999 COMP-3 VALUE +0.
    55 77  M2                          PIC S999 COMP-3 VALUE +0.
    56 77  WS-STOP-SW                  PIC X  VALUE ' '.
    57     88  I-SAY-TO-STOP              VALUE 'Y'.
    58 77  WS-FIND-SW                  PIC X  VALUE ' '.
    59     88  WE-FOUND-IT                VALUE 'Y'.
    60 77  WS-DONE-WITH-ENCC           PIC X  VALUE ' '.
    61     88  DONE-WITH-ENCC             VALUE 'Y'.
    62 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    63 01  ACCESS-KEYS.
    64     12  ELLETR-KEY.
    65         16  ELLETR-COMPANY-CD   PIC X.
    66         16  ELLETR-ACCESS-CD    PIC X(12).
    67         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    68
    69     12  ELENCC-KEY.
    70         16  ELENCC-COMPANY-CD    PIC X.
    71         16  ELENCC-REC-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page   3
* EL1044.cbl
    72         16  ELENCC-ENC-CODE      PIC X(5).
    73         16  F                    PIC X(09).
    74 01  WS-DATE-AREA.
    75     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
    76     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    77 01  MISC-WORK-AREAS.
    78     12  WS-RESPONSE             PIC S9(8)   COMP.
    79         88  RESP-NORMAL              VALUE +00.
    80         88  RESP-ERROR               VALUE +01.
    81         88  RESP-NOTFND              VALUE +13.
    82         88  RESP-NOTOPEN             VALUE +19.
    83         88  RESP-ENDFILE             VALUE +20.
    84     12  WS-NUMVAL.
    85         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    86         16  WS-9V999-OF-DEEDIT REDEFINES
    87             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    88     12  DEEDIT-FIELD                PIC X(11).
    89     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    90                                     PIC S9(11).
    91     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    92                                     PIC S9(09)V99.
    93
    94     12  WS-TEST-STATE               PIC X(2) VALUE SPACES.
    95         88 STATE-SPECIFIC    VALUES 'AK','AL','AR','AS','AZ',
    96            'CA','CO','CT','DC','DE','FL','GA','GU','HI','IA',
    97            'ID','IL','IN','KS','KY','LA','MA','MD','ME','MI',
    98            'MN','MO','MS','MT','NC','ND','NE','NH','NJ','NM',
    99            'NV','NY','OH','OK','OR','PA','PR','RI','SC','SD',
   100            'TN','TX','UT','VA','VI','VT','WA','WI','WV','WY'.
   101 01  STANDARD-AREAS.
   102     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
   103     12  TRANS-ID                    PIC X(04)   VALUE 'EX1F'.
   104     12  PGM-NAME                    PIC X(08).
   105     12  TIME-IN                     PIC S9(07).
   106     12  TIME-OUT-R  REDEFINES TIME-IN.
   107         16  FILLER                  PIC X(01).
   108         16  TIME-OUT                PIC 99V99.
   109         16  FILLER                  PIC X(02).
   110     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
   111     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
   112     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
   113     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
   114     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
   115     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
   116     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
   117     12  THIS-PGM                    PIC X(08)   VALUE 'EL1044'.
   118     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
   119     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
   120     12  ELENCC-FILE-ID              PIC X(08)   VALUE 'ELENCC'.
   121     12  ELENCC-LENGTH               PIC S9(04)  VALUE +400  COMP.
   122     12  SUB                         PIC 9(02).
   123     12  SUB-1                       PIC 9(02).
   124     12  SUB2                        PIC 9(02).
   125     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   126     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1044S'.
   127     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL1044Z'.
   128     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
   129     12  HOLD-ENC-CODES              PIC X(120)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page   4
* EL1044.cbl
   130     12  WS-SUB1                     PIC S9(03).
   131     12  WS-SUB2                     PIC S9(03).
   132     12  WS-SUB3                     PIC S9(03).
   133****  Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   134*                                    COPY ELCZREC.
   135******************************************************************
   136*                                                                *
   137*                                                                *
   138*                            ELCZREC.                            *
   139*                                                                *
   140*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   141*                                                                *
   142******************************************************************
   143*-----------------------------------------------------------------
   144*                   C H A N G E   L O G
   145*
   146* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   147*-----------------------------------------------------------------
   148*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   149* EFFECTIVE    NUMBER
   150*-----------------------------------------------------------------
   151* 122011    2011022800001  AJRA  NEW FILE
   152* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   153* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   154* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   155* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   156*-----------------------------------------------------------------
   157 01  W-Z-CONTROL-DATA.
   158     05  W-NUMBER-OF-COPIES      PIC  9.
   159     05  FILLER                  PIC  X.
   160     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   161     05  FILLER                  PIC  X.
   162     05  W-DAYS-TO-RESEND        PIC  999.
   163     05  FILLER                  PIC  X.
   164     05  W-FORM-TO-RESEND        PIC  X(4).
   165     05  W-ADD-BAR-CODE          PIC  X.
   166     05  W-PROMPT-LETTER         PIC  X.
   167     05  W-HAS-RETURN-ENV        PIC  X.
   168     05  W-ENCLOSURE-CD          PIC  XXX.
   169     05  W-SIG-FLAG-DEFAULT      PIC  X.
   170     05  W-AUTO-CLOSE-IND        PIC  X.
   171     05  FILLER                  PIC  X.
   172     05  W-LETTER-TO-BENE        PIC  X.
   173     05  FILLER                  PIC  X.
   174     05  W-LETTER-TO-ACCT        PIC  X.
   175     05  FILLER                  PIC  X.
   176     05  W-LETTER-TYPE           PIC  X.
   177     05  FILLER                  PIC  X.
   178     05  W-PRINT-CERTIFICATE     PIC  X.
   179     05  FILLER                  PIC  X.
   180     05  W-REFUND-REQUIRED       PIC  X.
   181     05  FILLER                  PIC  X.
   182     05  W-ONBASE-CODE           PIC  XX.
   183     05  FILLER                  PIC  X.
   184     05  W-ACCT-SUMM             PIC  X.
   185     05  FILLER                  PIC  X.
   186     05  W-CSO-SUMM              PIC  X.
   187     05  FILLER                  PIC  X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page   5
* EL1044.cbl
   188     05  W-REASONS-REQUIRED      PIC  X.
   189     05  FILLER                  PIC  X(29).
   190*                                    COPY ELCSCTM.
   191******************************************************************
   192*                                                                *
   193*                                                                *
   194*                            ELCSCTM                             *
   195*                            VMOD=2.001                          *
   196*                                                                *
   197*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   198*                                                                *
   199******************************************************************
   200 01  SECURITY-MESSAGE.
   201     12  FILLER                          PIC X(30)
   202            VALUE '** LOGIC SECURITY VIOLATION -'.
   203     12  SM-READ                         PIC X(6).
   204     12  FILLER                          PIC X(5)
   205            VALUE ' PGM='.
   206     12  SM-PGM                          PIC X(6).
   207     12  FILLER                          PIC X(5)
   208            VALUE ' OPR='.
   209     12  SM-PROCESSOR-ID                 PIC X(4).
   210     12  FILLER                          PIC X(6)
   211            VALUE ' TERM='.
   212     12  SM-TERMID                       PIC X(4).
   213     12  FILLER                          PIC XX   VALUE SPACE.
   214     12  SM-JUL-DATE                     PIC 9(5).
   215     12  FILLER                          PIC X    VALUE SPACE.
   216     12  SM-TIME                         PIC 99.99.
   217
   218*                                    COPY ELCSCRTY.
   219******************************************************************
   220*                                                                *
   221*                                                                *
   222*                            ELCSCRTY                            *
   223*                            VMOD=2.001                          *
   224*                                                                *
   225*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   226*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   227*        SAVED IN PI-SECURITY-ADDRESS.                           *
   228*                                                                *
   229******************************************************************
   230 01  SECURITY-CONTROL.
   231     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   232     12  FILLER                       PIC XX    VALUE 'SC'.
   233     12  SC-CREDIT-CODES.
   234         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   235             20  SC-CREDIT-DISPLAY    PIC X.
   236             20  SC-CREDIT-UPDATE     PIC X.
   237     12  SC-CLAIMS-CODES.
   238         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   239             20  SC-CLAIMS-DISPLAY    PIC X.
   240             20  SC-CLAIMS-UPDATE     PIC X.
   241 01  ERROR-MESSAGES.
   242     12  ER-0000                     PIC X(04)   VALUE '0000'.
   243     12  ER-0005                     PIC X(04)   VALUE '0005'.
   244     12  ER-0023                     PIC X(04)   VALUE '0023'.
   245     12  ER-0029                     PIC X(04)   VALUE '0029'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page   6
* EL1044.cbl
   246     12  ER-0050                     PIC X(04)   VALUE '0050'.
   247     12  ER-0068                     PIC X(04)   VALUE '0068'.
   248     12  ER-0070                     PIC X(04)   VALUE '0070'.
   249     12  ER-0130                     PIC X(04)   VALUE '0130'.
   250     12  ER-0131                     PIC X(04)   VALUE '0131'.
   251     12  ER-0132                     PIC X(04)   VALUE '0132'.
   252     12  ER-0138                     PIC X(04)   VALUE '0138'.
   253     12  ER-0144                     PIC X(04)   VALUE '0144'.
   254     12  ER-0145                     PIC X(04)   VALUE '0145'.
   255     12  ER-0184                     PIC X(04)   VALUE '0184'.
   256     12  ER-0418                     PIC X(04)   VALUE '0418'.
   257     12  ER-0491                     PIC X(04)   VALUE '0491'.
   258     12  ER-0582                     PIC X(04)   VALUE '0582'.
   259     12  ER-0627                     PIC X(04)   VALUE '0627'.
   260     12  ER-0701                     PIC X(04)   VALUE '0701'.
   261     12  ER-0702                     PIC X(04)   VALUE '0702'.
   262     12  ER-0703                     PIC X(04)   VALUE '0703'.
   263     12  ER-0704                     PIC X(04)   VALUE '0704'.
   264     12  ER-0705                     PIC X(04)   VALUE '0705'.
   265     12  ER-0706                     PIC X(04)   VALUE '0706'.
   266     12  ER-0707                     PIC X(04)   VALUE '0707'.
   267     12  ER-0708                     PIC X(04)   VALUE '0708'.
   268     12  ER-0709                     PIC X(04)   VALUE '0709'.
   269     12  ER-0710                     PIC X(04)   VALUE '0710'.
   270     12  ER-0711                     PIC X(04)   VALUE '0711'.
   271     12  ER-0712                     PIC X(04)   VALUE '0712'.
   272     12  ER-0713                     PIC X(04)   VALUE '0713'.
   273     12  ER-0717                     PIC X(04)   VALUE '0717'.
   274     12  ER-0718                     PIC X(04)   VALUE '0718'.
   275     12  ER-0719                     PIC X(04)   VALUE '0719'.
   276     12  ER-0720                     PIC X(04)   VALUE '0720'.
   277     12  ER-0721                     PIC X(04)   VALUE '0721'.
   278     12  ER-0722                     PIC X(04)   VALUE '0722'.
   279     12  ER-0723                     PIC X(04)   VALUE '0723'.
   280     12  ER-0724                     PIC X(04)   VALUE '0724'.
   281     12  ER-0725                     PIC X(04)   VALUE '0725'.
   282     12  ER-0726                     PIC X(04)   VALUE '0726'.
   283     12  ER-0727                     PIC X(04)   VALUE '0727'.
   284     12  ER-0729                     PIC X(04)   VALUE '0729'.
   285     12  ER-0754                     PIC X(04)   VALUE '0754'.
   286     12  ER-1560                     PIC X(04)   VALUE '1560'.
   287     12  ER-1562                     PIC X(04)   VALUE '1562'.
   288     12  ER-1564                     PIC X(04)   VALUE '1564'.
   289     12  ER-2241                     PIC X(04)   VALUE '2241'.
   290     12  ER-2276                     PIC X(04)   VALUE '2276'.
   291     12  ER-3804                     PIC X(04)   VALUE '3804'.
   292     12  ER-3820                     PIC X(04)   VALUE '3820'.
   293     12  ER-3821                     PIC X(04)   VALUE '3821'.
   294     12  ER-7008                     PIC X(04)   VALUE '7008'.
   295     12  ER-7031                     PIC X(04)   VALUE '7031'.
   296     12  ER-7123                     PIC X(04)   VALUE '7123'.
   297     12  ER-8150                     PIC X(04)   VALUE '8150'.
   298     12  ER-9999                     PIC XXXX    VALUE '9999'.
   299*                                    COPY ELCDATE.
   300******************************************************************
   301*                                                                *
   302*                                                                *
   303*                            ELCDATE.                            *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page   7
* EL1044.cbl
   304*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   305*                            VMOD=2.003
   306*                                                                *
   307*                                                                *
   308*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   309*                 LENGTH = 200                                   *
   310******************************************************************
   311
   312 01  DATE-CONVERSION-DATA.
   313     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   314     12  DC-OPTION-CODE                PIC X.
   315         88  BIN-TO-GREG                VALUE ' '.
   316         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   317         88  EDIT-GREG-TO-BIN           VALUE '2'.
   318         88  YMD-GREG-TO-BIN            VALUE '3'.
   319         88  MDY-GREG-TO-BIN            VALUE '4'.
   320         88  JULIAN-TO-BIN              VALUE '5'.
   321         88  BIN-PLUS-ELAPSED           VALUE '6'.
   322         88  FIND-CENTURY               VALUE '7'.
   323         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   324         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   325         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   326         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   327         88  JULIAN-TO-BIN-3            VALUE 'C'.
   328         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   329         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   330         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   331         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   332         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   333         88  CHECK-LEAP-YEAR            VALUE 'H'.
   334         88  BIN-3-TO-GREG              VALUE 'I'.
   335         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   336         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   337         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   338         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   339         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   340         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   341         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   342         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   343         88  THREE-CHARACTER-BIN
   344                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   345         88  GREGORIAN-TO-BIN
   346                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   347         88  BIN-TO-GREGORIAN
   348                  VALUES ' ' '1' 'I' '8' 'G'.
   349         88  JULIAN-TO-BINARY
   350                  VALUES '5' 'C' 'E' 'F'.
   351     12  DC-ERROR-CODE                 PIC X.
   352         88  NO-CONVERSION-ERROR        VALUE ' '.
   353         88  DATE-CONVERSION-ERROR
   354                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   355         88  DATE-IS-ZERO               VALUE '1'.
   356         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   357         88  DATE-IS-INVALID            VALUE '3'.
   358         88  DATE1-GREATER-DATE2        VALUE '4'.
   359         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   360         88  DATE-INVALID-OPTION        VALUE '9'.
   361         88  INVALID-CENTURY            VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page   8
* EL1044.cbl
   362         88  ONLY-CENTURY               VALUE 'B'.
   363         88  ONLY-LEAP-YEAR             VALUE 'C'.
   364         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   365     12  DC-END-OF-MONTH               PIC X.
   366         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   367     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   368         88  USE-NORMAL-PROCESS         VALUE ' '.
   369         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   370         88  ADJUST-UP-100-YRS          VALUE '2'.
   371     12  FILLER                        PIC X.
   372     12  DC-CONVERSION-DATES.
   373         16  DC-BIN-DATE-1             PIC XX.
   374         16  DC-BIN-DATE-2             PIC XX.
   375         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   376         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   377                       DC-GREG-DATE-1-EDIT.
   378             20  DC-EDIT1-MONTH        PIC 99.
   379             20  SLASH1-1              PIC X.
   380             20  DC-EDIT1-DAY          PIC 99.
   381             20  SLASH1-2              PIC X.
   382             20  DC-EDIT1-YEAR         PIC 99.
   383         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   384         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   385                     DC-GREG-DATE-2-EDIT.
   386             20  DC-EDIT2-MONTH        PIC 99.
   387             20  SLASH2-1              PIC X.
   388             20  DC-EDIT2-DAY          PIC 99.
   389             20  SLASH2-2              PIC X.
   390             20  DC-EDIT2-YEAR         PIC 99.
   391         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   392         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   393                     DC-GREG-DATE-1-YMD.
   394             20  DC-YMD-YEAR           PIC 99.
   395             20  DC-YMD-MONTH          PIC 99.
   396             20  DC-YMD-DAY            PIC 99.
   397         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   398         16  DC-GREG-DATE-1-MDY-R REDEFINES
   399                      DC-GREG-DATE-1-MDY.
   400             20  DC-MDY-MONTH          PIC 99.
   401             20  DC-MDY-DAY            PIC 99.
   402             20  DC-MDY-YEAR           PIC 99.
   403         16  DC-GREG-DATE-1-ALPHA.
   404             20  DC-ALPHA-MONTH        PIC X(10).
   405             20  DC-ALPHA-DAY          PIC 99.
   406             20  FILLER                PIC XX.
   407             20  DC-ALPHA-CENTURY.
   408                 24 DC-ALPHA-CEN-N     PIC 99.
   409             20  DC-ALPHA-YEAR         PIC 99.
   410         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   411         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   412         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   413         16  DC-JULIAN-DATE            PIC 9(05).
   414         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   415                                       PIC 9(05).
   416         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   417             20  DC-JULIAN-YEAR        PIC 99.
   418             20  DC-JULIAN-DAYS        PIC 999.
   419         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page   9
* EL1044.cbl
   420         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   421         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   422     12  DATE-CONVERSION-VARIBLES.
   423         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   424         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   425             20  FILLER                PIC 9(3).
   426             20  HOLD-CEN-1-CCYY.
   427                 24  HOLD-CEN-1-CC     PIC 99.
   428                 24  HOLD-CEN-1-YY     PIC 99.
   429             20  HOLD-CEN-1-MO         PIC 99.
   430             20  HOLD-CEN-1-DA         PIC 99.
   431         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   432             20  HOLD-CEN-1-R-MO       PIC 99.
   433             20  HOLD-CEN-1-R-DA       PIC 99.
   434             20  HOLD-CEN-1-R-CCYY.
   435                 24  HOLD-CEN-1-R-CC   PIC 99.
   436                 24  HOLD-CEN-1-R-YY   PIC 99.
   437             20  FILLER                PIC 9(3).
   438         16  HOLD-CENTURY-1-X.
   439             20  FILLER                PIC X(3)  VALUE SPACES.
   440             20  HOLD-CEN-1-X-CCYY.
   441                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   442                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   443             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   444             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   445         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   446             20  HOLD-CEN-1-R-X-MO     PIC XX.
   447             20  HOLD-CEN-1-R-X-DA     PIC XX.
   448             20  HOLD-CEN-1-R-X-CCYY.
   449                 24  HOLD-CEN-1-R-X-CC PIC XX.
   450                 24  HOLD-CEN-1-R-X-YY PIC XX.
   451             20  FILLER                PIC XXX.
   452         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   453         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   454         16  DC-JULIAN-DATE-1          PIC 9(07).
   455         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   456             20  DC-JULIAN-1-CCYY.
   457                 24  DC-JULIAN-1-CC    PIC 99.
   458                 24  DC-JULIAN-1-YR    PIC 99.
   459             20  DC-JULIAN-DA-1        PIC 999.
   460         16  DC-JULIAN-DATE-2          PIC 9(07).
   461         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   462             20  DC-JULIAN-2-CCYY.
   463                 24  DC-JULIAN-2-CC    PIC 99.
   464                 24  DC-JULIAN-2-YR    PIC 99.
   465             20  DC-JULIAN-DA-2        PIC 999.
   466         16  DC-GREG-DATE-A-EDIT.
   467             20  DC-EDITA-MONTH        PIC 99.
   468             20  SLASHA-1              PIC X VALUE '/'.
   469             20  DC-EDITA-DAY          PIC 99.
   470             20  SLASHA-2              PIC X VALUE '/'.
   471             20  DC-EDITA-CCYY.
   472                 24  DC-EDITA-CENT     PIC 99.
   473                 24  DC-EDITA-YEAR     PIC 99.
   474         16  DC-GREG-DATE-B-EDIT.
   475             20  DC-EDITB-MONTH        PIC 99.
   476             20  SLASHB-1              PIC X VALUE '/'.
   477             20  DC-EDITB-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  10
* EL1044.cbl
   478             20  SLASHB-2              PIC X VALUE '/'.
   479             20  DC-EDITB-CCYY.
   480                 24  DC-EDITB-CENT     PIC 99.
   481                 24  DC-EDITB-YEAR     PIC 99.
   482         16  DC-GREG-DATE-CYMD         PIC 9(08).
   483         16  DC-GREG-DATE-CYMD-R REDEFINES
   484                              DC-GREG-DATE-CYMD.
   485             20  DC-CYMD-CEN           PIC 99.
   486             20  DC-CYMD-YEAR          PIC 99.
   487             20  DC-CYMD-MONTH         PIC 99.
   488             20  DC-CYMD-DAY           PIC 99.
   489         16  DC-GREG-DATE-MDCY         PIC 9(08).
   490         16  DC-GREG-DATE-MDCY-R REDEFINES
   491                              DC-GREG-DATE-MDCY.
   492             20  DC-MDCY-MONTH         PIC 99.
   493             20  DC-MDCY-DAY           PIC 99.
   494             20  DC-MDCY-CEN           PIC 99.
   495             20  DC-MDCY-YEAR          PIC 99.
   496    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   497        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   498    12  DC-EL310-DATE                  PIC X(21).
   499    12  FILLER                         PIC X(28).
   500*                                    COPY ELCLOGOF.
   501******************************************************************
   502*                                                                *
   503*                                                                *
   504*                            ELCLOGOF.                           *
   505*                            VMOD=2.001                          *
   506*                                                                *
   507*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   508*                                                                *
   509******************************************************************
   510 01  CLASIC-LOGOFF.
   511     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   512     12  LOGOFF-TEXT.
   513         16  FILLER          PIC X(5)    VALUE SPACES.
   514         16  LOGOFF-MSG.
   515             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   516             20  FILLER      PIC X       VALUE SPACES.
   517             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   518         16  FILLER          PIC X(80)
   519           VALUE '* YOU ARE NOW LOGGED OFF'.
   520         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   521         16  FILLER          PIC X       VALUE QUOTE.
   522         16  LOGOFF-SYS-MSG  PIC X(17)
   523           VALUE 'S CLAS-IC SYSTEM '.
   524     12  TEXT-MESSAGES.
   525         16  UNACCESS-MSG    PIC X(29)
   526             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   527         16  PGMIDERR-MSG    PIC X(17)
   528             VALUE 'PROGRAM NOT FOUND'.
   529*                                    COPY ELCATTR.
   530******************************************************************
   531*                                                                *
   532*                            ELCATTR.                            *
   533*                            VMOD=2.001                          *
   534*                                                                *
   535*             LIST OF STANDARD ATTRIBUTE VALUES                  *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  11
* EL1044.cbl
   536*                                                                *
   537*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   538*                                                                *
   539*                   POS 1   P=PROTECTED                          *
   540*                           U=UNPROTECTED                        *
   541*                           S=ASKIP                              *
   542*                   POS 2   A=ALPHA/NUMERIC                      *
   543*                           N=NUMERIC                            *
   544*                   POS 3   N=NORMAL                             *
   545*                           B=BRIGHT                             *
   546*                           D=DARK                               *
   547*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   548*                           OF=MODIFIED DATA TAG OFF             *
   549*                                                                *
   550*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   551******************************************************************
   552 01  ATTRIBUTE-LIST.
   553     12  AL-PABOF            PIC X       VALUE 'Y'.
   554     12  AL-PABON            PIC X       VALUE 'Z'.
   555     12  AL-PADOF            PIC X       VALUE '%'.
   556     12  AL-PADON            PIC X       VALUE '_'.
   557     12  AL-PANOF            PIC X       VALUE '-'.
   558     12  AL-PANON            PIC X       VALUE '/'.
   559     12  AL-SABOF            PIC X       VALUE '8'.
   560     12  AL-SABON            PIC X       VALUE '9'.
   561     12  AL-SADOF            PIC X       VALUE '@'.
   562     12  AL-SADON            PIC X       VALUE QUOTE.
   563     12  AL-SANOF            PIC X       VALUE '0'.
   564     12  AL-SANON            PIC X       VALUE '1'.
   565     12  AL-UABOF            PIC X       VALUE 'H'.
   566     12  AL-UABON            PIC X       VALUE 'I'.
   567     12  AL-UADOF            PIC X       VALUE '<'.
   568     12  AL-UADON            PIC X       VALUE '('.
   569     12  AL-UANOF            PIC X       VALUE ' '.
   570     12  AL-UANON            PIC X       VALUE 'A'.
   571     12  AL-UNBOF            PIC X       VALUE 'Q'.
   572     12  AL-UNBON            PIC X       VALUE 'R'.
   573     12  AL-UNDOF            PIC X       VALUE '*'.
   574     12  AL-UNDON            PIC X       VALUE ')'.
   575     12  AL-UNNOF            PIC X       VALUE '&'.
   576     12  AL-UNNON            PIC X       VALUE 'J'.
   577*                                    COPY ELCEMIB.
   578******************************************************************
   579*                                                                *
   580*                                                                *
   581*                            ELCEMIB.                            *
   582*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   583*                            VMOD=2.005                          *
   584*                                                                *
   585*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   586*                                                                *
   587******************************************************************
   588 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   589     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   590     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   591     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   592     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   593     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  12
* EL1044.cbl
   594     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   595     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   596     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   597     12  EMI-SWITCH1             PIC X        VALUE '1'.
   598         88  EMI-NO-ERRORS                    VALUE '1'.
   599         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   600         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   601     12  EMI-SWITCH2             PIC X        VALUE '1'.
   602         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   603     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   604         88  EMI-AREA1-EMPTY                  VALUE '1'.
   605         88  EMI-AREA1-FULL                   VALUE '2'.
   606     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   607         88  EMI-AREA2-EMPTY                  VALUE '1'.
   608         88  EMI-AREA2-FULL                   VALUE '2'.
   609     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   610         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   611         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   612         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   613         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   614         88  EMI-BYPASS-FATALS                VALUE 'X'.
   615     12  EMI-ERROR-LINES.
   616         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   617         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   618         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   619         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   620             20  EMI-ERR-CODES OCCURS 10 TIMES.
   621                 24  EMI-ERR-NUM         PIC X(4).
   622                 24  EMI-FILLER          PIC X.
   623                 24  EMI-SEV             PIC X.
   624                 24  FILLER              PIC X.
   625             20  FILLER                  PIC X(02).
   626     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   627         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   628             20  EMI-ERROR-NUMBER    PIC X(4).
   629             20  EMI-FILL            PIC X.
   630             20  EMI-SEVERITY        PIC X.
   631             20  FILLER              PIC X.
   632             20  EMI-ERROR-TEXT.
   633                 24  EMI-TEXT-VARIABLE   PIC X(10).
   634                 24  FILLER          PIC X(55).
   635     12  EMI-SEVERITY-SAVE           PIC X.
   636         88  EMI-NOTE                    VALUE 'N'.
   637         88  EMI-WARNING                 VALUE 'W'.
   638         88  EMI-FORCABLE                VALUE 'F'.
   639         88  EMI-FATAL                   VALUE 'X'.
   640     12  EMI-MESSAGE-FLAG            PIC X.
   641         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   642         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   643     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   644     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   645         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   646         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   647         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   648     12  emi-claim-no                pic x(7).
   649     12  emi-claim-type              pic x(6).
   650     12  FILLER                      PIC X(124)  VALUE SPACES.
   651     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  13
* EL1044.cbl
   652     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   653     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   654     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   655*                                    COPY ELCJPFX.
   656******************************************************************
   657*                                                                *
   658*                                                                *
   659*                            ELCJPFX.                            *
   660*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   661*                            VMOD=2.002                          *
   662*                                                                *
   663*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   664*                                                                *
   665*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   666*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   667*        ELCNTL - CONTROL FILE                                   *
   668*        ELMSTR - CLAIM MASTERS                                  *
   669*        ELTRLR - ACTIVITY TRAILERS                              *
   670*        ELCHKQ - CHECK QUE                                      *
   671******************************************************************
   672 01  JOURNAL-RECORD.
   673     12  jp-date                     pic s9(5) comp-3.
   674     12  jp-time                     pic s9(7) comp-3.
   675     12  JP-USER-ID                  PIC X(4).
   676     12  JP-FILE-ID                  PIC X(8).
   677     12  JP-PROGRAM-ID               PIC X(8).
   678     12  JP-RECORD-TYPE              PIC X.
   679         88 JP-ADD              VALUE 'A'.
   680         88 JP-BEFORE-CHANGE    VALUE 'B'.
   681         88 JP-AFTER-CHANGE     VALUE 'C'.
   682         88 JP-DELETE           VALUE 'D'.
   683         88 JP-GENERIC-DELETE   VALUE 'G'.
   684         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   685         88 JP-KEY-CHG-ADD      VALUE 'N'.
   686     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   687     12  JP-RECORD-AREA
   688
   689
   690                                     PIC X(530).
   691*                                    COPY ELCINTF.
   692******************************************************************
   693*                                                                *
   694*                                                                *
   695*                            ELCINTF.                            *
   696*                            VMOD=2.017                          *
   697*                                                                *
   698*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   699*                                                                *
   700*       LENGTH = 1024                                            *
   701*                                                                *
   702******************************************************************
   703*                   C H A N G E   L O G
   704*
   705* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   706*-----------------------------------------------------------------
   707*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   708* EFFECTIVE    NUMBER
   709*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  14
* EL1044.cbl
   710* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   711******************************************************************
   712 01  PROGRAM-INTERFACE-BLOCK.
   713     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   714     12  PI-CALLING-PROGRAM              PIC X(8).
   715     12  PI-SAVED-PROGRAM-1              PIC X(8).
   716     12  PI-SAVED-PROGRAM-2              PIC X(8).
   717     12  PI-SAVED-PROGRAM-3              PIC X(8).
   718     12  PI-SAVED-PROGRAM-4              PIC X(8).
   719     12  PI-SAVED-PROGRAM-5              PIC X(8).
   720     12  PI-SAVED-PROGRAM-6              PIC X(8).
   721     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   722     12  PI-COMPANY-ID                   PIC XXX.
   723     12  PI-COMPANY-CD                   PIC X.
   724
   725     12  PI-COMPANY-PASSWORD             PIC X(8).
   726
   727     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   728
   729     12  PI-CONTROL-IN-PROGRESS.
   730         16  PI-CARRIER                  PIC X.
   731         16  PI-GROUPING                 PIC X(6).
   732         16  PI-STATE                    PIC XX.
   733         16  PI-ACCOUNT                  PIC X(10).
   734         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   735                                         PIC X(10).
   736         16  PI-CLAIM-CERT-GRP.
   737             20  PI-CLAIM-NO             PIC X(7).
   738             20  PI-CERT-NO.
   739                 25  PI-CERT-PRIME       PIC X(10).
   740                 25  PI-CERT-SFX         PIC X.
   741             20  PI-CERT-EFF-DT          PIC XX.
   742         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   743             20  PI-PLAN-CODE            PIC X(2).
   744             20  PI-REVISION-NUMBER      PIC X(3).
   745             20  PI-PLAN-EFF-DT          PIC X(2).
   746             20  PI-PLAN-EXP-DT          PIC X(2).
   747             20  FILLER                  PIC X(11).
   748         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   749             20  PI-OE-REFERENCE-1.
   750                 25  PI-OE-REF-1-PRIME   PIC X(18).
   751                 25  PI-OE-REF-1-SUFF    PIC XX.
   752
   753     12  PI-SESSION-IN-PROGRESS          PIC X.
   754         88  CLAIM-SESSION                   VALUE '1'.
   755         88  CREDIT-SESSION                  VALUE '2'.
   756         88  WARRANTY-SESSION                VALUE '3'.
   757         88  MORTGAGE-SESSION                VALUE '4'.
   758         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   759
   760
   761*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   762
   763     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   764     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   765
   766     12  PI-CREDIT-USER                  PIC X.
   767         88  PI-NOT-CREDIT-USER              VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  15
* EL1044.cbl
   768         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   769
   770     12  PI-CLAIM-USER                   PIC X.
   771         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   772         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   773
   774     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   775         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   776         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   777         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   778         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   779         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   780
   781     12  PI-PROCESSOR-ID                 PIC X(4).
   782
   783     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   784
   785     12  PI-MEMBER-CAPTION               PIC X(10).
   786
   787     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   788         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   789
   790     12  PI-LIFE-OVERRIDE-L1             PIC X.
   791     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   792     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   793     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   794
   795     12  PI-AH-OVERRIDE-L1               PIC X.
   796     12  PI-AH-OVERRIDE-L2               PIC XX.
   797     12  PI-AH-OVERRIDE-L6               PIC X(6).
   798     12  PI-AH-OVERRIDE-L12              PIC X(12).
   799
   800     12  PI-NEW-SYSTEM                   PIC X(2).
   801
   802     12  PI-PRIMARY-CERT-NO              PIC X(11).
   803     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   804         88  PI-USES-PAID-TO                 VALUE '1'.
   805     12  PI-CRDTCRD-SYSTEM.
   806         16  PI-CRDTCRD-USER             PIC X.
   807             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   808             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   809         16  PI-CC-MONTH-END-DT          PIC XX.
   810     12  PI-PROCESSOR-PRINTER            PIC X(4).
   811
   812     12  PI-OE-REFERENCE-2.
   813         16  PI-OE-REF-2-PRIME           PIC X(10).
   814         16  PI-OE-REF-2-SUFF            PIC X.
   815
   816     12  PI-REM-TRM-CALC-OPTION          PIC X.
   817
   818     12  PI-LANGUAGE-TYPE                PIC X.
   819             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   820             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   821             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   822
   823     12  PI-POLICY-LINKAGE-IND           PIC X.
   824         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   825         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  16
* EL1044.cbl
   826                                                   LOW-VALUES.
   827
   828     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   829     12  PI-CLAIM-PW-SESSION             PIC X(1).
   830         88  PI-CLAIM-CREDIT                 VALUE '1'.
   831         88  PI-CLAIM-CONVEN                 VALUE '2'.
   832
   833     12  PI-PROCESSOR-CSR-IND            PIC X.
   834         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   835         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   836
   837     12  FILLER                          PIC X(3).
   838
   839     12  PI-SYSTEM-LEVEL                 PIC X(145).
   840
   841     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   842         PI-SYSTEM-LEVEL.
   843
   844         16  PI-ENTRY-CODES.
   845             20  PI-ENTRY-CD-1           PIC X.
   846             20  PI-ENTRY-CD-2           PIC X.
   847
   848         16  PI-RETURN-CODES.
   849             20  PI-RETURN-CD-1          PIC X.
   850             20  PI-RETURN-CD-2          PIC X.
   851
   852         16  PI-UPDATE-STATUS-SAVE.
   853             20  PI-UPDATE-BY            PIC X(4).
   854             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   855
   856         16  PI-LOWER-CASE-LETTERS       PIC X.
   857             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   858
   859*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   860*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   861*            88  CARRIER-CLM-CNTL            VALUE '2'.
   862
   863         16  PI-CERT-ACCESS-CONTROL      PIC X.
   864             88  ST-ACCNT-CNTL               VALUE ' '.
   865             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   866             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   867             88  ACCNT-CNTL                  VALUE '3'.
   868             88  CARR-ACCNT-CNTL             VALUE '4'.
   869
   870         16  PI-PROCESSOR-CAP-LIST.
   871             20  PI-SYSTEM-CONTROLS.
   872                24 PI-SYSTEM-DISPLAY     PIC X.
   873                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   874                24 PI-SYSTEM-MODIFY      PIC X.
   875                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   876             20  FILLER                  PIC XX.
   877             20  PI-DISPLAY-CAP          PIC X.
   878                 88  DISPLAY-CAP             VALUE 'Y'.
   879             20  PI-MODIFY-CAP           PIC X.
   880                 88  MODIFY-CAP              VALUE 'Y'.
   881             20  PI-MSG-AT-LOGON-CAP     PIC X.
   882                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   883             20  PI-FORCE-CAP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  17
* EL1044.cbl
   884                 88  FORCE-CAP               VALUE 'Y'.
   885
   886         16  PI-PROGRAM-CONTROLS.
   887             20  PI-PGM-PRINT-OPT        PIC X.
   888             20  PI-PGM-FORMAT-OPT       PIC X.
   889             20  PI-PGM-PROCESS-OPT      PIC X.
   890             20  PI-PGM-TOTALS-OPT       PIC X.
   891
   892         16  PI-HELP-INTERFACE.
   893             20  PI-LAST-ERROR-NO        PIC X(4).
   894             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   895
   896         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   897             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   898
   899         16  PI-CR-CONTROL-IN-PROGRESS.
   900             20  PI-CR-CARRIER           PIC X.
   901             20  PI-CR-GROUPING          PIC X(6).
   902             20  PI-CR-STATE             PIC XX.
   903             20  PI-CR-ACCOUNT           PIC X(10).
   904             20  PI-CR-FIN-RESP          PIC X(10).
   905             20  PI-CR-TYPE              PIC X.
   906
   907         16  PI-CR-BATCH-NUMBER          PIC X(6).
   908
   909         16  PI-CR-MONTH-END-DT          PIC XX.
   910
   911         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   912             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   913             88  PI-ZERO-CARRIER             VALUE '1'.
   914             88  PI-ZERO-GROUPING            VALUE '2'.
   915             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   916
   917         16  PI-CARRIER-SECURITY         PIC X.
   918             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   919
   920         16  PI-ACCOUNT-SECURITY         PIC X(10).
   921             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   922             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   923
   924         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   925             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   926                                         INDEXED BY PI-ACCESS-NDX
   927                                         PIC X.
   928
   929         16  PI-GA-BILLING-CONTROL       PIC X.
   930             88  PI-GA-BILLING               VALUE '1'.
   931
   932         16  PI-MAIL-PROCESSING          PIC X.
   933             88  PI-MAIL-YES                 VALUE 'Y'.
   934
   935         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   936
   937         16  PI-AR-SYSTEM.
   938             20  PI-AR-PROCESSING-CNTL   PIC X.
   939                 88  PI-AR-PROCESSING        VALUE 'Y'.
   940             20  PI-AR-SUMMARY-CODE      PIC X(6).
   941             20  PI-AR-MONTH-END-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  18
* EL1044.cbl
   942
   943         16  PI-MP-SYSTEM.
   944             20  PI-MORTGAGE-USER            PIC X.
   945                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   946                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   947             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   948                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   949                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   950                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   951                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   952                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   953             20  PI-MP-MONTH-END-DT          PIC XX.
   954             20  PI-MP-REFERENCE-NO.
   955                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   956                 24  PI-MP-REFERENCE-SFX     PIC XX.
   957
   958         16  PI-LABEL-CONTROL            PIC X(01).
   959             88  PI-CREATE-LABELS                    VALUE 'Y'.
   960             88  PI-BYPASS-LABELS                    VALUE 'N'.
   961
   962         16  PI-BILL-GROUPING-CODE       PIC X(01).
   963             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   964
   965         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   966             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   967             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   968
   969         16  FILLER                      PIC X(14).
   970
   971     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   972******************************************************************
   973     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   974*                                    COPY ELC1042.
   975******************************************************************
   976*                                                                *
   977*                                                                *
   978*                           ELC1042                              *
   979*                            VMOD=2.002                          *
   980*                                                                *
   981*    NOTE                                                        *
   982*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   983*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   984*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   985*        TO THESE PROGRAMS.                                      *
   986*                                                                *
   987*    NOTE                                                        *
   988*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   989*        USE ONLY!                                               *
   990*                                                                *
   991******************************************************************
   992
   993         16  PI-1042-WA.
   994             20  PI-ACTION       PIC  X(01).
   995                 88 PI-SHOW-MODE           VALUE '1'.
   996                 88 PI-CLEAR-MODE          VALUE '2'.
   997                 88 PI-CREATE-MODE         VALUE '3'.
   998             20  PI-COMM-CONTROL PIC  X(12).
   999             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  19
* EL1044.cbl
  1000             20  PI-EOF-SW       PIC  X(01).
  1001                 88  PI-FILE-EOF           VALUE 'Y'.
  1002             20  PI-FILETYP      PIC  X(01).
  1003             20  PI-FORM-SQUEEZE-CONTROL
  1004                                 PIC  X(01).
  1005                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1006                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1007             20  PI-LAST-CONTROL PIC  X(12).
  1008             20  PI-TEMP-STOR-ITEMS
  1009                                 PIC S9(04) COMP.
  1010             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1011             20  PI-UPDATE-SW    PIC  9(01).
  1012                 88 ANY-UPDATES            VALUE 1.
  1013             20  PI-104-SCREEN-SENT-IND
  1014                                 PIC  X(01).
  1015                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1016                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1017             20  PI-1042-SCREEN-SENT-IND
  1018                                 PIC  X(01).
  1019                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1020                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1021             20  PI-1042-ARCHIVE-IND
  1022                                 PIC  X(01).
  1023                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1024             20  FILLER          PIC  X(29).
  1025         16  PI-PREV-LETR-KEY        PIC X(15).
  1026         16  PI-CURR-LETR-KEY        PIC X(15).
  1027         16  PI-UPDATE-DT            PIC XX.
  1028         16  PI-ENC-CODES            PIC X(120).
  1029         16  PI-SPLIT-SUB            PIC S9(3)  COMP.
  1030         16  FILLER                  PIC X(434).
  1031*                                    COPY ELCAID.
  1032******************************************************************
  1033*                                                                *
  1034*                            ELCAID.                             *
  1035*                            VMOD=2.001                          *
  1036*                                                                *
  1037*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1038*                                                                *
  1039*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1040*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1041******************************************************************
  1042
  1043 01  DFHAID.
  1044   02  DFHNULL   PIC  X  VALUE  ' '.
  1045   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1046   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1047   02  DFHPEN    PIC  X  VALUE  '='.
  1048   02  DFHOPID   PIC  X  VALUE  'W'.
  1049   02  DFHPA1    PIC  X  VALUE  '%'.
  1050   02  DFHPA2    PIC  X  VALUE  '>'.
  1051   02  DFHPA3    PIC  X  VALUE  ','.
  1052   02  DFHPF1    PIC  X  VALUE  '1'.
  1053   02  DFHPF2    PIC  X  VALUE  '2'.
  1054   02  DFHPF3    PIC  X  VALUE  '3'.
  1055   02  DFHPF4    PIC  X  VALUE  '4'.
  1056   02  DFHPF5    PIC  X  VALUE  '5'.
  1057   02  DFHPF6    PIC  X  VALUE  '6'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  20
* EL1044.cbl
  1058   02  DFHPF7    PIC  X  VALUE  '7'.
  1059   02  DFHPF8    PIC  X  VALUE  '8'.
  1060   02  DFHPF9    PIC  X  VALUE  '9'.
  1061   02  DFHPF10   PIC  X  VALUE  ':'.
  1062   02  DFHPF11   PIC  X  VALUE  '#'.
  1063   02  DFHPF12   PIC  X  VALUE  '@'.
  1064   02  DFHPF13   PIC  X  VALUE  'A'.
  1065   02  DFHPF14   PIC  X  VALUE  'B'.
  1066   02  DFHPF15   PIC  X  VALUE  'C'.
  1067   02  DFHPF16   PIC  X  VALUE  'D'.
  1068   02  DFHPF17   PIC  X  VALUE  'E'.
  1069   02  DFHPF18   PIC  X  VALUE  'F'.
  1070   02  DFHPF19   PIC  X  VALUE  'G'.
  1071   02  DFHPF20   PIC  X  VALUE  'H'.
  1072   02  DFHPF21   PIC  X  VALUE  'I'.
  1073*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1074   02  DFHPF22   PIC  X  VALUE  '['.
  1075   02  DFHPF23   PIC  X  VALUE  '.'.
  1076   02  DFHPF24   PIC  X  VALUE  '<'.
  1077   02  DFHMSRE   PIC  X  VALUE  'X'.
  1078   02  DFHSTRF   PIC  X  VALUE  'h'.
  1079   02  DFHTRIG   PIC  X  VALUE  '"'.
  1080 01  FILLER    REDEFINES DFHAID.
  1081     12  FILLER                      PIC X(08).
  1082     12  PF-VALUES                   PIC X         OCCURS 24.
  1083*                                    COPY EL1044S.
  1084 01  EL1044ZI.
  1085     05  FILLER            PIC  X(0012).
  1086*    -------------------------------
  1087     05  DATEL PIC S9(0004) COMP.
  1088     05  DATEF PIC  X(0001).
  1089     05  FILLER REDEFINES DATEF.
  1090         10  DATEA PIC  X(0001).
  1091     05  FILLER            PIC  X(3).
  1092     05  DATEI PIC  X(0008).
  1093*    -------------------------------
  1094     05  TIMEL PIC S9(0004) COMP.
  1095     05  TIMEF PIC  X(0001).
  1096     05  FILLER REDEFINES TIMEF.
  1097         10  TIMEA PIC  X(0001).
  1098     05  FILLER            PIC  X(3).
  1099     05  TIMEI PIC  X(0005).
  1100*    -------------------------------
  1101     05  CMPNYIDL PIC S9(0004) COMP.
  1102     05  CMPNYIDF PIC  X(0001).
  1103     05  FILLER REDEFINES CMPNYIDF.
  1104         10  CMPNYIDA PIC  X(0001).
  1105     05  FILLER            PIC  X(3).
  1106     05  CMPNYIDI PIC  X(0003).
  1107*    -------------------------------
  1108     05  USERIDL PIC S9(0004) COMP.
  1109     05  USERIDF PIC  X(0001).
  1110     05  FILLER REDEFINES USERIDF.
  1111         10  USERIDA PIC  X(0001).
  1112     05  FILLER            PIC  X(3).
  1113     05  USERIDI PIC  X(0004).
  1114*    -------------------------------
  1115     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  21
* EL1044.cbl
  1116     05  MAINTF PIC  X(0001).
  1117     05  FILLER REDEFINES MAINTF.
  1118         10  MAINTA PIC  X(0001).
  1119     05  FILLER            PIC  X(3).
  1120     05  MAINTI PIC  X(0001).
  1121*    -------------------------------
  1122     05  LSTUSRL PIC S9(0004) COMP.
  1123     05  LSTUSRF PIC  X(0001).
  1124     05  FILLER REDEFINES LSTUSRF.
  1125         10  LSTUSRA PIC  X(0001).
  1126     05  FILLER            PIC  X(3).
  1127     05  LSTUSRI PIC  X(0004).
  1128*    -------------------------------
  1129     05  LSTDTEL PIC S9(0004) COMP.
  1130     05  LSTDTEF PIC  X(0001).
  1131     05  FILLER REDEFINES LSTDTEF.
  1132         10  LSTDTEA PIC  X(0001).
  1133     05  FILLER            PIC  X(3).
  1134     05  LSTDTEI PIC  X(0008).
  1135*    -------------------------------
  1136     05  ZLETRL PIC S9(0004) COMP.
  1137     05  ZLETRF PIC  X(0001).
  1138     05  FILLER REDEFINES ZLETRF.
  1139         10  ZLETRA PIC  X(0001).
  1140     05  FILLER            PIC  X(3).
  1141     05  ZLETRI PIC  X(0004).
  1142*    -------------------------------
  1143     05  ZCOPIESL PIC S9(0004) COMP.
  1144     05  ZCOPIESF PIC  X(0001).
  1145     05  FILLER REDEFINES ZCOPIESF.
  1146         10  ZCOPIESA PIC  X(0001).
  1147     05  FILLER            PIC  X(3).
  1148     05  ZCOPIESI PIC  X(0001).
  1149*    -------------------------------
  1150     05  ZPROMPTL PIC S9(0004) COMP.
  1151     05  ZPROMPTF PIC  X(0001).
  1152     05  FILLER REDEFINES ZPROMPTF.
  1153         10  ZPROMPTA PIC  X(0001).
  1154     05  FILLER            PIC  X(3).
  1155     05  ZPROMPTI PIC  X(0001).
  1156*    -------------------------------
  1157     05  ZENCCDL PIC S9(0004) COMP.
  1158     05  ZENCCDF PIC  X(0001).
  1159     05  FILLER REDEFINES ZENCCDF.
  1160         10  ZENCCDA PIC  X(0001).
  1161     05  FILLER            PIC  X(3).
  1162     05  ZENCCDI PIC  X(0003).
  1163*    -------------------------------
  1164     05  ZRDAYSL PIC S9(0004) COMP.
  1165     05  ZRDAYSF PIC  X(0001).
  1166     05  FILLER REDEFINES ZRDAYSF.
  1167         10  ZRDAYSA PIC  X(0001).
  1168     05  FILLER            PIC  X(3).
  1169     05  ZRDAYSI PIC  X(0003).
  1170*    -------------------------------
  1171     05  ZFORML PIC S9(0004) COMP.
  1172     05  ZFORMF PIC  X(0001).
  1173     05  FILLER REDEFINES ZFORMF.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  22
* EL1044.cbl
  1174         10  ZFORMA PIC  X(0001).
  1175     05  FILLER            PIC  X(3).
  1176     05  ZFORMI PIC  X(0004).
  1177*    -------------------------------
  1178     05  ZBENEL PIC S9(0004) COMP.
  1179     05  ZBENEF PIC  X(0001).
  1180     05  FILLER REDEFINES ZBENEF.
  1181         10  ZBENEA PIC  X(0001).
  1182     05  FILLER            PIC  X(3).
  1183     05  ZBENEI PIC  X(0001).
  1184*    -------------------------------
  1185     05  ZACCTL PIC S9(0004) COMP.
  1186     05  ZACCTF PIC  X(0001).
  1187     05  FILLER REDEFINES ZACCTF.
  1188         10  ZACCTA PIC  X(0001).
  1189     05  FILLER            PIC  X(3).
  1190     05  ZACCTI PIC  X(0001).
  1191*    -------------------------------
  1192     05  ZTYPEL PIC S9(0004) COMP.
  1193     05  ZTYPEF PIC  X(0001).
  1194     05  FILLER REDEFINES ZTYPEF.
  1195         10  ZTYPEA PIC  X(0001).
  1196     05  FILLER            PIC  X(3).
  1197     05  ZTYPEI PIC  X(0001).
  1198*    -------------------------------
  1199     05  ZPRTCRTL PIC S9(0004) COMP.
  1200     05  ZPRTCRTF PIC  X(0001).
  1201     05  FILLER REDEFINES ZPRTCRTF.
  1202         10  ZPRTCRTA PIC  X(0001).
  1203     05  FILLER            PIC  X(3).
  1204     05  ZPRTCRTI PIC  X(0001).
  1205*    -------------------------------
  1206     05  ZREFREQL PIC S9(0004) COMP.
  1207     05  ZREFREQF PIC  X(0001).
  1208     05  FILLER REDEFINES ZREFREQF.
  1209         10  ZREFREQA PIC  X(0001).
  1210     05  FILLER            PIC  X(3).
  1211     05  ZREFREQI PIC  X(0001).
  1212*    -------------------------------
  1213     05  ZONBASEL PIC S9(0004) COMP.
  1214     05  ZONBASEF PIC  X(0001).
  1215     05  FILLER REDEFINES ZONBASEF.
  1216         10  ZONBASEA PIC  X(0001).
  1217     05  FILLER            PIC  X(3).
  1218     05  ZONBASEI PIC  X(0002).
  1219*    -------------------------------
  1220     05  ZACTSUML PIC S9(0004) COMP.
  1221     05  ZACTSUMF PIC  X(0001).
  1222     05  FILLER REDEFINES ZACTSUMF.
  1223         10  ZACTSUMA PIC  X(0001).
  1224     05  FILLER            PIC  X(3).
  1225     05  ZACTSUMI PIC  X(0001).
  1226*    -------------------------------
  1227     05  ZCSOSUML PIC S9(0004) COMP.
  1228     05  ZCSOSUMF PIC  X(0001).
  1229     05  FILLER REDEFINES ZCSOSUMF.
  1230         10  ZCSOSUMA PIC  X(0001).
  1231     05  FILLER            PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  23
* EL1044.cbl
  1232     05  ZCSOSUMI PIC  X(0001).
  1233*    -------------------------------
  1234     05  ZREASONL PIC S9(0004) COMP.
  1235     05  ZREASONF PIC  X(0001).
  1236     05  FILLER REDEFINES ZREASONF.
  1237         10  ZREASONA PIC  X(0001).
  1238     05  FILLER            PIC  X(3).
  1239     05  ZREASONI PIC  X(0001).
  1240*    -------------------------------
  1241     05  ZBARCODL PIC S9(0004) COMP.
  1242     05  ZBARCODF PIC  X(0001).
  1243     05  FILLER REDEFINES ZBARCODF.
  1244         10  ZBARCODA PIC  X(0001).
  1245     05  FILLER            PIC  X(3).
  1246     05  ZBARCODI PIC  X(0001).
  1247*    -------------------------------
  1248     05  ZRETENVL PIC S9(0004) COMP.
  1249     05  ZRETENVF PIC  X(0001).
  1250     05  FILLER REDEFINES ZRETENVF.
  1251         10  ZRETENVA PIC  X(0001).
  1252     05  FILLER            PIC  X(3).
  1253     05  ZRETENVI PIC  X(0001).
  1254*    -------------------------------
  1255     05  ZSIGFLGL PIC S9(0004) COMP.
  1256     05  ZSIGFLGF PIC  X(0001).
  1257     05  FILLER REDEFINES ZSIGFLGF.
  1258         10  ZSIGFLGA PIC  X(0001).
  1259     05  FILLER            PIC  X(3).
  1260     05  ZSIGFLGI PIC  X(0001).
  1261*    -------------------------------
  1262     05  ZCODES1L PIC S9(0004) COMP.
  1263     05  ZCODES1F PIC  X(0001).
  1264     05  FILLER REDEFINES ZCODES1F.
  1265         10  ZCODES1A PIC  X(0001).
  1266     05  FILLER            PIC  X(3).
  1267     05  ZCODES1I PIC  X(0053).
  1268*    -------------------------------
  1269     05  ZCODES2L PIC S9(0004) COMP.
  1270     05  ZCODES2F PIC  X(0001).
  1271     05  FILLER REDEFINES ZCODES2F.
  1272         10  ZCODES2A PIC  X(0001).
  1273     05  FILLER            PIC  X(3).
  1274     05  ZCODES2I PIC  X(0078).
  1275*    -------------------------------
  1276     05  ZFADAYSL PIC S9(0004) COMP.
  1277     05  ZFADAYSF PIC  X(0001).
  1278     05  FILLER REDEFINES ZFADAYSF.
  1279         10  ZFADAYSA PIC  X(0001).
  1280     05  FILLER            PIC  X(3).
  1281     05  ZFADAYSI PIC  X(0003).
  1282*    -------------------------------
  1283     05  ZACLOSEL PIC S9(0004) COMP.
  1284     05  ZACLOSEF PIC  X(0001).
  1285     05  FILLER REDEFINES ZACLOSEF.
  1286         10  ZACLOSEA PIC  X(0001).
  1287     05  FILLER            PIC  X(3).
  1288     05  ZACLOSEI PIC  X(0001).
  1289*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  24
* EL1044.cbl
  1290     05  ERRMSGL PIC S9(0004) COMP.
  1291     05  ERRMSGF PIC  X(0001).
  1292     05  FILLER REDEFINES ERRMSGF.
  1293         10  ERRMSGA PIC  X(0001).
  1294     05  FILLER            PIC  X(3).
  1295     05  ERRMSGI PIC  X(0072).
  1296*    -------------------------------
  1297     05  PFKEYL PIC S9(0004) COMP.
  1298     05  PFKEYF PIC  X(0001).
  1299     05  FILLER REDEFINES PFKEYF.
  1300         10  PFKEYA PIC  X(0001).
  1301     05  FILLER            PIC  X(3).
  1302     05  PFKEYI PIC  99.
  1303 01  EL1044ZO REDEFINES EL1044ZI.
  1304     05  FILLER            PIC  X(0012).
  1305*    -------------------------------
  1306     05  FILLER            PIC  X(3).
  1307     05  DATEC PIC  X(0001).
  1308     05  DATEH PIC  X(0001).
  1309     05  DATEU PIC  X(0001).
  1310     05  DATEO PIC  X(0008).
  1311*    -------------------------------
  1312     05  FILLER            PIC  X(3).
  1313     05  TIMEC PIC  X(0001).
  1314     05  TIMEH PIC  X(0001).
  1315     05  TIMEU PIC  X(0001).
  1316     05  TIMEO PIC  99.99.
  1317*    -------------------------------
  1318     05  FILLER            PIC  X(3).
  1319     05  CMPNYIDC PIC  X(0001).
  1320     05  CMPNYIDH PIC  X(0001).
  1321     05  CMPNYIDU PIC  X(0001).
  1322     05  CMPNYIDO PIC  X(0003).
  1323*    -------------------------------
  1324     05  FILLER            PIC  X(3).
  1325     05  USERIDC PIC  X(0001).
  1326     05  USERIDH PIC  X(0001).
  1327     05  USERIDU PIC  X(0001).
  1328     05  USERIDO PIC  X(0004).
  1329*    -------------------------------
  1330     05  FILLER            PIC  X(3).
  1331     05  MAINTC PIC  X(0001).
  1332     05  MAINTH PIC  X(0001).
  1333     05  MAINTU PIC  X(0001).
  1334     05  MAINTO PIC  X(0001).
  1335*    -------------------------------
  1336     05  FILLER            PIC  X(3).
  1337     05  LSTUSRC PIC  X(0001).
  1338     05  LSTUSRH PIC  X(0001).
  1339     05  LSTUSRU PIC  X(0001).
  1340     05  LSTUSRO PIC  X(0004).
  1341*    -------------------------------
  1342     05  FILLER            PIC  X(3).
  1343     05  LSTDTEC PIC  X(0001).
  1344     05  LSTDTEH PIC  X(0001).
  1345     05  LSTDTEU PIC  X(0001).
  1346     05  LSTDTEO PIC  X(0008).
  1347*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  25
* EL1044.cbl
  1348     05  FILLER            PIC  X(3).
  1349     05  ZLETRC PIC  X(0001).
  1350     05  ZLETRH PIC  X(0001).
  1351     05  ZLETRU PIC  X(0001).
  1352     05  ZLETRO PIC  X(0004).
  1353*    -------------------------------
  1354     05  FILLER            PIC  X(3).
  1355     05  ZCOPIESC PIC  X(0001).
  1356     05  ZCOPIESH PIC  X(0001).
  1357     05  ZCOPIESU PIC  X(0001).
  1358     05  ZCOPIESO PIC  9.
  1359*    -------------------------------
  1360     05  FILLER            PIC  X(3).
  1361     05  ZPROMPTC PIC  X(0001).
  1362     05  ZPROMPTH PIC  X(0001).
  1363     05  ZPROMPTU PIC  X(0001).
  1364     05  ZPROMPTO PIC  X(0001).
  1365*    -------------------------------
  1366     05  FILLER            PIC  X(3).
  1367     05  ZENCCDC PIC  X(0001).
  1368     05  ZENCCDH PIC  X(0001).
  1369     05  ZENCCDU PIC  X(0001).
  1370     05  ZENCCDO PIC  X(0003).
  1371*    -------------------------------
  1372     05  FILLER            PIC  X(3).
  1373     05  ZRDAYSC PIC  X(0001).
  1374     05  ZRDAYSH PIC  X(0001).
  1375     05  ZRDAYSU PIC  X(0001).
  1376     05  ZRDAYSO PIC  999.
  1377*    -------------------------------
  1378     05  FILLER            PIC  X(3).
  1379     05  ZFORMC PIC  X(0001).
  1380     05  ZFORMH PIC  X(0001).
  1381     05  ZFORMU PIC  X(0001).
  1382     05  ZFORMO PIC  X(0004).
  1383*    -------------------------------
  1384     05  FILLER            PIC  X(3).
  1385     05  ZBENEC PIC  X(0001).
  1386     05  ZBENEH PIC  X(0001).
  1387     05  ZBENEU PIC  X(0001).
  1388     05  ZBENEO PIC  X(0001).
  1389*    -------------------------------
  1390     05  FILLER            PIC  X(3).
  1391     05  ZACCTC PIC  X(0001).
  1392     05  ZACCTH PIC  X(0001).
  1393     05  ZACCTU PIC  X(0001).
  1394     05  ZACCTO PIC  X(0001).
  1395*    -------------------------------
  1396     05  FILLER            PIC  X(3).
  1397     05  ZTYPEC PIC  X(0001).
  1398     05  ZTYPEH PIC  X(0001).
  1399     05  ZTYPEU PIC  X(0001).
  1400     05  ZTYPEO PIC  X(0001).
  1401*    -------------------------------
  1402     05  FILLER            PIC  X(3).
  1403     05  ZPRTCRTC PIC  X(0001).
  1404     05  ZPRTCRTH PIC  X(0001).
  1405     05  ZPRTCRTU PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  26
* EL1044.cbl
  1406     05  ZPRTCRTO PIC  X(0001).
  1407*    -------------------------------
  1408     05  FILLER            PIC  X(3).
  1409     05  ZREFREQC PIC  X(0001).
  1410     05  ZREFREQH PIC  X(0001).
  1411     05  ZREFREQU PIC  X(0001).
  1412     05  ZREFREQO PIC  X(0001).
  1413*    -------------------------------
  1414     05  FILLER            PIC  X(3).
  1415     05  ZONBASEC PIC  X(0001).
  1416     05  ZONBASEH PIC  X(0001).
  1417     05  ZONBASEU PIC  X(0001).
  1418     05  ZONBASEO PIC  X(0002).
  1419*    -------------------------------
  1420     05  FILLER            PIC  X(3).
  1421     05  ZACTSUMC PIC  X(0001).
  1422     05  ZACTSUMH PIC  X(0001).
  1423     05  ZACTSUMU PIC  X(0001).
  1424     05  ZACTSUMO PIC  X(0001).
  1425*    -------------------------------
  1426     05  FILLER            PIC  X(3).
  1427     05  ZCSOSUMC PIC  X(0001).
  1428     05  ZCSOSUMH PIC  X(0001).
  1429     05  ZCSOSUMU PIC  X(0001).
  1430     05  ZCSOSUMO PIC  X(0001).
  1431*    -------------------------------
  1432     05  FILLER            PIC  X(3).
  1433     05  ZREASONC PIC  X(0001).
  1434     05  ZREASONH PIC  X(0001).
  1435     05  ZREASONU PIC  X(0001).
  1436     05  ZREASONO PIC  X(0001).
  1437*    -------------------------------
  1438     05  FILLER            PIC  X(3).
  1439     05  ZBARCODC PIC  X(0001).
  1440     05  ZBARCODH PIC  X(0001).
  1441     05  ZBARCODU PIC  X(0001).
  1442     05  ZBARCODO PIC  X(0001).
  1443*    -------------------------------
  1444     05  FILLER            PIC  X(3).
  1445     05  ZRETENVC PIC  X(0001).
  1446     05  ZRETENVH PIC  X(0001).
  1447     05  ZRETENVU PIC  X(0001).
  1448     05  ZRETENVO PIC  X(0001).
  1449*    -------------------------------
  1450     05  FILLER            PIC  X(3).
  1451     05  ZSIGFLGC PIC  X(0001).
  1452     05  ZSIGFLGH PIC  X(0001).
  1453     05  ZSIGFLGU PIC  X(0001).
  1454     05  ZSIGFLGO PIC  X(0001).
  1455*    -------------------------------
  1456     05  FILLER            PIC  X(3).
  1457     05  ZCODES1C PIC  X(0001).
  1458     05  ZCODES1H PIC  X(0001).
  1459     05  ZCODES1U PIC  X(0001).
  1460     05  ZCODES1O PIC  X(0053).
  1461*    -------------------------------
  1462     05  FILLER            PIC  X(3).
  1463     05  ZCODES2C PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  27
* EL1044.cbl
  1464     05  ZCODES2H PIC  X(0001).
  1465     05  ZCODES2U PIC  X(0001).
  1466     05  ZCODES2O PIC  X(0078).
  1467*    -------------------------------
  1468     05  FILLER            PIC  X(3).
  1469     05  ZFADAYSC PIC  X(0001).
  1470     05  ZFADAYSH PIC  X(0001).
  1471     05  ZFADAYSU PIC  X(0001).
  1472     05  ZFADAYSO PIC  999.
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(3).
  1475     05  ZACLOSEC PIC  X(0001).
  1476     05  ZACLOSEH PIC  X(0001).
  1477     05  ZACLOSEU PIC  X(0001).
  1478     05  ZACLOSEO PIC  X(0001).
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(3).
  1481     05  ERRMSGC PIC  X(0001).
  1482     05  ERRMSGH PIC  X(0001).
  1483     05  ERRMSGU PIC  X(0001).
  1484     05  ERRMSGO PIC  X(0072).
  1485*    -------------------------------
  1486     05  FILLER            PIC  X(3).
  1487     05  PFKEYC PIC  X(0001).
  1488     05  PFKEYH PIC  X(0001).
  1489     05  PFKEYU PIC  X(0001).
  1490     05  PFKEYO PIC  99.
  1491*    -------------------------------
  1492****************************************************************
  1493*
  1494* Copyright (c) 2007-2013 Dell Inc.
  1495* All rights reserved.
  1496*
  1497****************************************************************
  1498 01  DFHEIV.
  1499   02  DFHEIV0               PIC X(35).
  1500   02  DFHEIV1               PIC X(08).
  1501   02  DFHEIV2               PIC X(08).
  1502   02  DFHEIV3               PIC X(08).
  1503   02  DFHEIV4               PIC X(06).
  1504   02  DFHEIV5               PIC X(04).
  1505   02  DFHEIV6               PIC X(04).
  1506   02  DFHEIV7               PIC X(02).
  1507   02  DFHEIV8               PIC X(02).
  1508   02  DFHEIV9               PIC X(01).
  1509   02  DFHEIV10              PIC S9(7) COMP-3.
  1510   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1511   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1512   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1513   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1514   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1515   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1516   02  DFHEIV17              PIC X(04).
  1517   02  DFHEIV18              PIC X(04).
  1518   02  DFHEIV19              PIC X(04).
  1519   02  DFHEIV20              USAGE IS POINTER.
  1520   02  DFHEIV21              USAGE IS POINTER.
  1521   02  DFHEIV22              USAGE IS POINTER.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  28
* EL1044.cbl
  1522   02  DFHEIV23              USAGE IS POINTER.
  1523   02  DFHEIV24              USAGE IS POINTER.
  1524   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1525   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1526   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1527   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1528   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1529   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1530   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1531   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1532   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1533   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1534   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1535   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1536   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1537   02  FILLER                PIC X(02).
  1538   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1539   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1540   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1541   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1542   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1543   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1544   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1545 LINKAGE  SECTION.
  1546*****************************************************************
  1547*                                                               *
  1548* Copyright (c) 2007-2013 Dell Inc.                             *
  1549* All rights reserved.                                          *
  1550*                                                               *
  1551*****************************************************************
  1552 01  dfheiblk.
  1553     02  eibtime          pic s9(7) comp-3.
  1554     02  eibdate          pic s9(7) comp-3.
  1555     02  eibtrnid         pic x(4).
  1556     02  eibtaskn         pic s9(7) comp-3.
  1557     02  eibtrmid         pic x(4).
  1558     02  dfheigdi         pic s9(4) comp.
  1559     02  eibcposn         pic s9(4) comp.
  1560     02  eibcalen         pic s9(4) comp.
  1561     02  eibaid           pic x(1).
  1562     02  eibfiller1       pic x(1).
  1563     02  eibfn            pic x(2).
  1564     02  eibfiller2       pic x(2).
  1565     02  eibrcode         pic x(6).
  1566     02  eibfiller3       pic x(2).
  1567     02  eibds            pic x(8).
  1568     02  eibreqid         pic x(8).
  1569     02  eibrsrce         pic x(8).
  1570     02  eibsync          pic x(1).
  1571     02  eibfree          pic x(1).
  1572     02  eibrecv          pic x(1).
  1573     02  eibsend          pic x(1).
  1574     02  eibatt           pic x(1).
  1575     02  eibeoc           pic x(1).
  1576     02  eibfmh           pic x(1).
  1577     02  eibcompl         pic x(1).
  1578     02  eibsig           pic x(1).
  1579     02  eibconf          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  29
* EL1044.cbl
  1580     02  eiberr           pic x(1).
  1581     02  eibrldbk         pic x(1).
  1582     02  eiberrcd         pic x(4).
  1583     02  eibsynrb         pic x(1).
  1584     02  eibnodat         pic x(1).
  1585     02  eibfiller5       pic x(2).
  1586     02  eibresp          pic s9(8) comp.
  1587     02  eibresp2         pic s9(8) comp.
  1588     02  dfheigdj         pic s9(4) comp.
  1589     02  dfheigdk         pic s9(4) comp.
  1590 01  DFHCOMMAREA                     PIC X(1024).
  1591*                                    COPY ELCTEXT.
  1592******************************************************************
  1593*                                                                *
  1594*                                                                *
  1595*                            ELCTEXT.                            *
  1596*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1597*                            VMOD=2.008                          *
  1598*                                                                *
  1599*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1600*                                     FORM LETTERS,              *
  1601*                                     CERT FORM DISPLAY.
  1602*                                                                *
  1603*   FILE TYPE = VSAM,KSDS                                        *
  1604*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1605*                                                                *
  1606*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1607*       ALTERNATE INDEX = NONE                                   *
  1608*                                                                *
  1609*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1610*       ALTERNATE INDEX = NONE                                   *
  1611*                                                                *
  1612*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1613*       ALTERNATE INDEX = NONE                                   *
  1614*                                                                *
  1615*   LOG = NO                                                     *
  1616*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1617******************************************************************
  1618 01  TEXT-FILES.
  1619     12  TEXT-FILE-ID                PIC XX.
  1620         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1621         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1622         88  HELP-FILE-TEXT             VALUE 'TH'.
  1623
  1624     12  TX-CONTROL-PRIMARY.
  1625         16  TX-COMPANY-CD           PIC X.
  1626             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1627         16  TX-ACCESS-CD-GENL       PIC X(12).
  1628
  1629         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1630             20  TX-LETTER-NO        PIC X(4).
  1631             20  FILLER              PIC X(8).
  1632
  1633         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1634             20  TX-FORM-NO          PIC X(12).
  1635
  1636         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1637             20  TX-HELP-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  30
* EL1044.cbl
  1638                 88  HELP-FOR-GENERAL   VALUE ' '.
  1639                 88  HELP-BY-SCREEN     VALUE 'S'.
  1640                 88  HELP-BY-ERROR      VALUE 'E'.
  1641             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1642                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1643             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1644                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1645             20  FILLER              PIC X(4).
  1646
  1647         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1648
  1649     12  TX-PROCESS-CONTROL          PIC XX.
  1650         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1651
  1652     12  TX-TEXT-LINE                PIC X(70).
  1653
  1654     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1655         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1656         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1657         88  TX-VALID-FORM-SQUEEZE-VALUE
  1658                                        VALUE 'Y' ' '.
  1659
  1660     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1661         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1662         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1663         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1664         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1665         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1666         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1667         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1668                                              'K' 'N' ' '
  1669                                              'Z'.
  1670
  1671     12  TX-ARCHIVE-SW               PIC X.
  1672         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1673         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1674         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1675
  1676     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1677     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1678
  1679     12  TX-BSR-CODE                 PIC X.
  1680         88  TX-BSR-LETTER              VALUE 'B'.
  1681         88  TX-NON-BSR-LETTER          VALUE ' '.
  1682
  1683     12  FILLER                      PIC X.
  1684*****************************************************************
  1685*                                    COPY ELCENCC.
  1686******************************************************************
  1687*                                                                *
  1688*                                                                *
  1689*                            ELCENCC                             *
  1690*                            VMOD=2.001                          *
  1691*                                                                *
  1692*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  1693*                                                                *
  1694*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  1695*   A NAPERSOFT DOCUMENT                                         *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  31
* EL1044.cbl
  1696*                                                                *
  1697*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  1698*                                                                *
  1699*   FILE TYPE = VSAM,KSDS                                        *
  1700*   RECORD SIZE = 400   RECFORM = FIX                            *
  1701*                                                                *
  1702*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  1703*                                                                *
  1704*   LOG = NO                                                     *
  1705*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1706*                                                                *
  1707*                                                                *
  1708******************************************************************
  1709*                   C H A N G E   L O G
  1710*
  1711* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1712*-----------------------------------------------------------------
  1713*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1714* EFFECTIVE    NUMBER
  1715*-----------------------------------------------------------------
  1716* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  1717* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  1718******************************************************************
  1719 01  ENCLOSURE-CODES.
  1720     12  NC-RECORD-ID                      PIC XX.
  1721         88  VALID-NC-ID                      VALUE 'NC'.
  1722     12  NC-CONTROL-PRIMARY.
  1723         16  NC-COMPANY-CD                 PIC X.
  1724         16  NC-REC-TYPE                   PIC X.
  1725             88  NC-CLAIMS                   VALUE '1'.
  1726             88  NC-ADMIN                    VALUE '2'.
  1727         16  NC-ENC-CODE                   PIC X(5).
  1728         16  FILLER                        PIC X(09).
  1729     12  NC-MAINT-INFORMATION.
  1730         16  NC-LAST-MAINT-DT              PIC XX.
  1731         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1732         16  NC-LAST-MAINT-USER            PIC X(4).
  1733         16  FILLER                        PIC XX.
  1734     12  NC-OUTPUT-STACK                   PIC XXX.
  1735     12  NC-ENCLOSURE-LINE                 PIC X(100).
  1736     12  NC-ATTACHMENTS                    PIC X(255).
  1737     12  NC-FUTURE                         PIC X(12).
  1738******************************************************************
  1739 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES
  1740                          ENCLOSURE-CODES.
  1741 0000-DFHEXIT SECTION.
  1742     MOVE '9#                    $   ' TO DFHEIV0.
  1743     MOVE 'EL1044' TO DFHEIV1.
  1744     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1745     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1746     MOVE '5'                    TO DC-OPTION-CODE
  1747     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1748     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1749     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1750     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1751     IF EIBCALEN = 0
  1752        GO TO 8800-UNAUTHORIZED-ACCESS.
  1753     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  32
* EL1044.cbl
  1754     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1755     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1756
  1757* EXEC CICS HANDLE CONDITION
  1758*        DUPREC     (8850-DUPREC)
  1759*        NOTOPEN    (8870-NOTOPEN)
  1760*        NOTFND     (8880-NOT-FOUND)
  1761*        PGMIDERR   (9600-PGMID-ERROR)
  1762*        ERROR      (9990-ABEND)
  1763*    END-EXEC.
  1764*    MOVE '"$%JIL.               ! " #00001752' TO DFHEIV0
  1765     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1767     MOVE X'2220233030303031373532' TO DFHEIV0(25:11)
  1768     CALL 'kxdfhei1' USING DFHEIV0
  1769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1770
  1771     .
  1772 0150-SET-PROGRAM-SAVES.
  1773     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  1774         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1775             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1776             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1777             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1778             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1779             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1780             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1781             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1782             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1783         ELSE
  1784             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1785             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1786             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1787             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1788             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1789             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1790             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1791             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1792     ELSE
  1793         GO TO 0200-RECEIVE.
  1794*    DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
  1795     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1796     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1797     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1798     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1799                                    PI-PREV-LETR-KEY
  1800
  1801     PERFORM 6500-BUILD-CURRENT-CODES THRU 6500-EXIT
  1802
  1803     GO TO 1000-SHOW-LETR-RECORD
  1804     .
  1805 0200-RECEIVE.
  1806     IF EIBAID = DFHCLEAR
  1807        GO TO 9400-CLEAR.
  1808     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1809         MOVE LOW-VALUES             TO  EL1044ZI
  1810         MOVE ER-7008                TO  EMI-ERROR
  1811         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  33
* EL1044.cbl
  1812         MOVE -1                     TO  MAINTL
  1813         GO TO 8200-SEND-DATAONLY.
  1814     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  1815         NEXT SENTENCE
  1816     ELSE
  1817
  1818* EXEC CICS READQ TS
  1819*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1820*            INTO   (SECURITY-CONTROL)
  1821*            LENGTH (SC-COMM-LENGTH)
  1822*            ITEM   (SC-ITEM)
  1823*        END-EXEC
  1824*    MOVE '*$II   L              ''   #00001805' TO DFHEIV0
  1825     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1826     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1827     MOVE X'2020233030303031383035' TO DFHEIV0(25:11)
  1828     CALL 'kxdfhei1' USING DFHEIV0,
  1829           PI-SECURITY-TEMP-STORE-ID,
  1830           SECURITY-CONTROL,
  1831           SC-COMM-LENGTH,
  1832           SC-ITEM,
  1833           DFHEIV99,
  1834           DFHEIV99
  1835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1836         MOVE SC-CREDIT-DISPLAY (3)  TO  PI-DISPLAY-CAP
  1837         MOVE SC-CREDIT-UPDATE  (3)  TO  PI-MODIFY-CAP.
  1838
  1839* EXEC CICS RECEIVE
  1840*        MAP      (WS-MAP-NAME)
  1841*        MAPSET   (MAPSET-NAME)
  1842*        INTO     (EL1044ZI)
  1843*    END-EXEC
  1844     MOVE LENGTH OF
  1845      EL1044ZI
  1846       TO DFHEIV11
  1847*    MOVE '8"T I  L              ''   #00001813' TO DFHEIV0
  1848     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1849     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1850     MOVE X'2020233030303031383133' TO DFHEIV0(25:11)
  1851     CALL 'kxdfhei1' USING DFHEIV0,
  1852           WS-MAP-NAME,
  1853           EL1044ZI,
  1854           DFHEIV11,
  1855           MAPSET-NAME,
  1856           DFHEIV99,
  1857           DFHEIV99
  1858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1859     IF PFKEYL = +0
  1860         GO TO 0300-CHECK-PFKEYS.
  1861     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
  1862         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1863     ELSE
  1864         MOVE ER-0029                TO  EMI-ERROR
  1865         GO TO 0320-INPUT-ERROR.
  1866 0300-CHECK-PFKEYS.
  1867     IF EIBAID EQUAL DFHPF23
  1868         GO TO 8810-PF23.
  1869     IF EIBAID EQUAL DFHPF24
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  34
* EL1044.cbl
  1870         GO TO 9200-RETURN-MAIN-MENU.
  1871     IF EIBAID EQUAL DFHPF12
  1872         GO TO 9500-PF12.
  1873     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1874         MOVE ER-0050            TO EMI-ERROR
  1875         GO TO 0320-INPUT-ERROR.
  1876     IF EIBAID EQUAL DFHENTER
  1877         GO TO 0330-EDIT-DATA.
  1878     MOVE ER-0029                    TO  EMI-ERROR.
  1879 0320-INPUT-ERROR.
  1880     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1881     MOVE AL-UNBON                   TO  PFKEYA.
  1882     MOVE -1                         TO  PFKEYL.
  1883     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  35
* EL1044.cbl
  1885 0330-EDIT-DATA.
  1886     IF NOT DISPLAY-CAP
  1887         MOVE 'READ'                 TO  SM-READ
  1888         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1889         MOVE ER-0070                TO  EMI-ERROR
  1890         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1891         MOVE -1                     TO  MAINTL
  1892         GO TO 8100-SEND-INITIAL-MAP.
  1893     IF MAINTI EQUAL 'S'
  1894        GO TO 1000-SHOW-LETR-RECORD.
  1895     IF MAINTI = 'C' OR 'A'
  1896        IF NOT MODIFY-CAP
  1897           PERFORM 9995-SECURITY-VIOLATION
  1898                                 THRU 9995-EXIT
  1899           MOVE ER-0070          TO EMI-ERROR
  1900           PERFORM 9900-ERROR-FORMAT
  1901                                 THRU 9900-EXIT
  1902           MOVE LOW-VALUES       TO EL1044ZO
  1903           MOVE -1               TO MAINTL
  1904           GO TO 8100-SEND-INITIAL-MAP
  1905        END-IF
  1906     END-IF
  1907     IF MAINTI = 'C'
  1908        GO TO 2000-CHANGE-LETR-RECORD
  1909     END-IF
  1910     IF MAINTI = 'A'
  1911        GO TO 3000-ADD-LETR-RECORD
  1912     END-IF
  1913     MOVE ER-0023                    TO  EMI-ERROR.
  1914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1915     MOVE -1                         TO  MAINTL.
  1916     MOVE AL-UABON                   TO  MAINTA.
  1917     GO TO 8200-SEND-DATAONLY.
  1918 1000-SHOW-LETR-RECORD.
  1919     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1920
  1921* EXEC CICS STARTBR
  1922*        DATASET   (ELLETR-FILE-ID)
  1923*        RIDFLD    (ELLETR-KEY)
  1924*        GTEQ
  1925*        RESP      (WS-RESPONSE)
  1926*    END-EXEC
  1927     MOVE 0
  1928       TO DFHEIV11
  1929*    MOVE '&,         G          &  N#00001881' TO DFHEIV0
  1930     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1931     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1932     MOVE X'204E233030303031383831' TO DFHEIV0(25:11)
  1933     CALL 'kxdfhei1' USING DFHEIV0,
  1934           ELLETR-FILE-ID,
  1935           ELLETR-KEY,
  1936           DFHEIV99,
  1937           DFHEIV11,
  1938           DFHEIV99
  1939     MOVE EIBRESP  TO WS-RESPONSE
  1940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1941     IF RESP-NORMAL
  1942        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  36
* EL1044.cbl
  1943           OR WE-FOUND-IT
  1944
  1945* EXEC CICS READNEXT
  1946*              DATASET    (ELLETR-FILE-ID)
  1947*              SET        (ADDRESS OF TEXT-FILES)
  1948*              RIDFLD     (ELLETR-KEY)
  1949*              RESP       (WS-RESPONSE)
  1950*          END-EXEC
  1951     MOVE 0
  1952       TO DFHEIV11
  1953*    MOVE '&.S                   )  N#00001890' TO DFHEIV0
  1954     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1955     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1956     MOVE X'204E233030303031383930' TO DFHEIV0(25:11)
  1957     CALL 'kxdfhei1' USING DFHEIV0,
  1958           ELLETR-FILE-ID,
  1959           DFHEIV20,
  1960           DFHEIV99,
  1961           ELLETR-KEY,
  1962           DFHEIV99,
  1963           DFHEIV11,
  1964           DFHEIV99,
  1965           DFHEIV99
  1966     SET ADDRESS OF TEXT-FILES TO
  1967         DFHEIV20
  1968     MOVE EIBRESP  TO WS-RESPONSE
  1969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1970           IF (RESP-NORMAL)
  1971              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1972              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1973                 SET WE-FOUND-IT   TO TRUE
  1974              END-IF
  1975           ELSE
  1976              SET I-SAY-TO-STOP  TO TRUE
  1977           END-IF
  1978        END-PERFORM
  1979     END-IF
  1980     IF WE-FOUND-IT
  1981        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1982                                    PI-PREV-LETR-KEY
  1983        GO TO 7000-BUILD-OUTPUT-MAP
  1984     END-IF
  1985     MOVE ER-0418                TO EMI-ERROR.
  1986     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1987     MOVE -1                     TO MAINTL
  1988     MOVE 'A'                    TO MAINTI
  1989     MOVE AL-UANON               TO MAINTA
  1990     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1991     MOVE +4                     TO ZLETRL
  1992     MOVE AL-UANON               TO ZLETRA
  1993     GO TO 8100-SEND-INITIAL-MAP
  1994     .
  1995 2000-CHANGE-LETR-RECORD.
  1996*    display ' curr   ' pi-curr-letr-key
  1997*    display ' prev   ' pi-prev-letr-key
  1998     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  1999        MOVE ER-0145             TO EMI-ERROR
  2000        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  37
* EL1044.cbl
  2001        MOVE -1                  TO MAINTL
  2002        GO TO 8200-SEND-DATAONLY
  2003     END-IF
  2004     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  2005     IF NOT EMI-NO-ERRORS
  2006         GO TO 8200-SEND-DATAONLY.
  2007     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  2008     .
  2009 2000-CHANGE-CONTINUE.
  2010
  2011* EXEC CICS READ
  2012*        DATASET    (ELLETR-FILE-ID)
  2013*        SET        (ADDRESS OF TEXT-FILES)
  2014*        RIDFLD     (ELLETR-KEY)
  2015*        UPDATE
  2016*        RESP       (WS-RESPONSE)
  2017*    END-EXEC
  2018*    MOVE '&"S        EU         (  N#00001937' TO DFHEIV0
  2019     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2020     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2021     MOVE X'204E233030303031393337' TO DFHEIV0(25:11)
  2022     CALL 'kxdfhei1' USING DFHEIV0,
  2023           ELLETR-FILE-ID,
  2024           DFHEIV20,
  2025           DFHEIV99,
  2026           ELLETR-KEY,
  2027           DFHEIV99,
  2028           DFHEIV99,
  2029           DFHEIV99
  2030     SET ADDRESS OF TEXT-FILES TO
  2031         DFHEIV20
  2032     MOVE EIBRESP  TO WS-RESPONSE
  2033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2034     IF RESP-NOTFND
  2035        IF ELLETR-SEQ-NO = +0
  2036           GO TO 2000-CONTINUE-CHANGE
  2037        END-IF
  2038     END-IF
  2039     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  2040        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  2041
  2042* EXEC CICS UNLOCK
  2043*            DATASET   (ELLETR-FILE-ID)
  2044*        END-EXEC
  2045*    MOVE '&*                    #   #00001951' TO DFHEIV0
  2046     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2047     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2048     MOVE X'2020233030303031393531' TO DFHEIV0(25:11)
  2049     CALL 'kxdfhei1' USING DFHEIV0,
  2050           ELLETR-FILE-ID,
  2051           DFHEIV99
  2052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2053         MOVE ER-0068                TO  EMI-ERROR
  2054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2055         GO TO 1000-SHOW-LETR-RECORD.
  2056     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2057     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2058     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  38
* EL1044.cbl
  2059     IF ZCOPIESL > +0
  2060        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2061     END-IF
  2062     IF ZFADAYSL > +0
  2063        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2064     END-IF
  2065     IF ZRDAYSL > +0
  2066        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2067     END-IF
  2068     IF ZFORML > +0
  2069        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2070     END-IF
  2071     IF ZPROMPTL > +0
  2072        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2073     END-IF
  2074     IF ZENCCDL > +0
  2075        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2076     END-IF
  2077     IF ZACLOSEL > +0
  2078        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2079     END-IF
  2080     IF ZBENEL > +0
  2081        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2082     END-IF
  2083     IF ZACCTL > +0
  2084        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  2085     END-IF
  2086     IF ZTYPEL > +0
  2087        MOVE ZTYPEI              TO W-LETTER-TYPE
  2088     END-IF
  2089     IF ZPRTCRTL > +0
  2090        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  2091     END-IF
  2092     IF ZREFREQL > +0
  2093        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  2094     END-IF
  2095     IF ZONBASEL > +0
  2096         MOVE ZONBASEI           TO W-ONBASE-CODE
  2097     END-IF
  2098
  2099     IF ZACTSUML > +0
  2100         MOVE ZACTSUMI           TO W-ACCT-SUMM
  2101     END-IF
  2102
  2103     IF ZCSOSUML > +0
  2104         MOVE ZCSOSUMI           TO W-CSO-SUMM
  2105     END-IF
  2106
  2107     IF ZREASONL > +0
  2108        MOVE ZREASONI            TO W-REASONS-REQUIRED
  2109     END-IF
  2110
  2111     IF ZBARCODL > +0
  2112        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  2113     END-IF
  2114
  2115     IF ZRETENVL > +0
  2116        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  39
* EL1044.cbl
  2117     END-IF
  2118
  2119     IF ZSIGFLGL > +0
  2120        MOVE ZSIGFLGI            TO W-SIG-FLAG-DEFAULT
  2121     END-IF
  2122     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2123     .
  2124 2000-CONTINUE-CHANGE.
  2125
  2126* EXEC CICS REWRITE
  2127*        DATASET   (ELLETR-FILE-ID)
  2128*        FROM      (TEXT-FILES)
  2129*    END-EXEC.
  2130     MOVE LENGTH OF
  2131      TEXT-FILES
  2132       TO DFHEIV11
  2133*    MOVE '&& L                  %   #00002027' TO DFHEIV0
  2134     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2135     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2136     MOVE X'2020233030303032303237' TO DFHEIV0(25:11)
  2137     CALL 'kxdfhei1' USING DFHEIV0,
  2138           ELLETR-FILE-ID,
  2139           TEXT-FILES,
  2140           DFHEIV11,
  2141           DFHEIV99
  2142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2143
  2144     MOVE ER-0000                    TO  EMI-ERROR.
  2145     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2146     GO TO 1000-SHOW-LETR-RECORD
  2147     .
  2148 3000-ADD-LETR-RECORD.
  2149*    display ' curr   ' pi-curr-letr-key
  2150*    display ' prev   ' pi-prev-letr-key
  2151     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  2152     .
  2153 3000-CONTINUE-ADD.
  2154     IF NOT EMI-NO-ERRORS
  2155        GO TO 8200-SEND-DATAONLY
  2156     END-IF
  2157     MOVE SPACES                 TO ELLETR-KEY
  2158     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  2159     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  2160     MOVE +0                     TO ELLETR-SEQ-NO
  2161
  2162* EXEC CICS READ
  2163*        DATASET    (ELLETR-FILE-ID)
  2164*        SET        (ADDRESS OF TEXT-FILES)
  2165*        RIDFLD     (ELLETR-KEY)
  2166*        GTEQ
  2167*        RESP       (WS-RESPONSE)
  2168*    END-EXEC
  2169*    MOVE '&"S        G          (  N#00002049' TO DFHEIV0
  2170     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2172     MOVE X'204E233030303032303439' TO DFHEIV0(25:11)
  2173     CALL 'kxdfhei1' USING DFHEIV0,
  2174           ELLETR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  40
* EL1044.cbl
  2175           DFHEIV20,
  2176           DFHEIV99,
  2177           ELLETR-KEY,
  2178           DFHEIV99,
  2179           DFHEIV99,
  2180           DFHEIV99
  2181     SET ADDRESS OF TEXT-FILES TO
  2182         DFHEIV20
  2183     MOVE EIBRESP  TO WS-RESPONSE
  2184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2185     IF RESP-NORMAL
  2186        IF TX-LETTER-NO = ZLETRI
  2187           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  2188              MOVE ER-0132       TO EMI-ERROR
  2189              PERFORM 9900-ERROR-FORMAT
  2190                                 THRU 9900-EXIT
  2191              MOVE -1            TO ZLETRL
  2192              MOVE AL-UABON      TO ZLETRA
  2193              GO TO 8200-SEND-DATAONLY
  2194           ELSE
  2195              MOVE +0            TO WS-SEQ-NO-TO-USE
  2196           END-IF
  2197        ELSE
  2198           MOVE +1               TO WS-SEQ-NO-TO-USE
  2199        END-IF
  2200     ELSE
  2201        MOVE +1                  TO WS-SEQ-NO-TO-USE
  2202     END-IF
  2203
  2204* EXEC CICS GETMAIN
  2205*       SET(ADDRESS OF TEXT-FILES)
  2206*       LENGTH(ELLETR-LENGTH)
  2207*    END-EXEC
  2208*    MOVE '," L                  $   #00002074' TO DFHEIV0
  2209     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  2210     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2211     MOVE X'2020233030303032303734' TO DFHEIV0(25:11)
  2212     CALL 'kxdfhei1' USING DFHEIV0,
  2213           DFHEIV20,
  2214           ELLETR-LENGTH,
  2215           DFHEIV99
  2216     SET ADDRESS OF TEXT-FILES TO
  2217         DFHEIV20
  2218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2219     MOVE SPACES                 TO TEXT-FILES
  2220     MOVE 'TL'                   TO TEXT-FILE-ID
  2221     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  2222     MOVE ZLETRI                 TO TX-LETTER-NO
  2223     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  2224     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  2225     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2226     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2227     MOVE SPACES                 TO W-Z-CONTROL-DATA
  2228     IF ZCOPIESL > +0
  2229        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2230     ELSE
  2231        MOVE 1                   TO W-NUMBER-OF-COPIES
  2232     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  41
* EL1044.cbl
  2233     IF ZFADAYSL > +0
  2234        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2235     END-IF
  2236     IF ZRDAYSL > +0
  2237        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2238     ELSE
  2239        MOVE ZEROS               TO W-DAYS-TO-RESEND
  2240     END-IF
  2241     IF ZFORML > +0
  2242        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2243     END-IF
  2244     IF ZPROMPTL > +0
  2245        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2246     END-IF
  2247     IF ZENCCDL > +0
  2248        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2249     END-IF
  2250     IF ZACLOSEL > +0
  2251        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2252     END-IF
  2253     IF ZBENEL > +0
  2254        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2255     END-IF
  2256     IF ZACCTL > +0
  2257        MOVE ZACCTI              TO W-LETTER-TO-ACCT
  2258     END-IF
  2259     IF ZTYPEL > +0
  2260        MOVE ZTYPEI              TO W-LETTER-TYPE
  2261     END-IF
  2262     IF ZPRTCRTL > +0
  2263        MOVE ZPRTCRTI            TO W-PRINT-CERTIFICATE
  2264     END-IF
  2265     IF ZREFREQL > +0
  2266        MOVE ZREFREQI            TO W-REFUND-REQUIRED
  2267     END-IF
  2268     IF ZONBASEL > +0
  2269        MOVE ZONBASEI            TO W-ONBASE-CODE
  2270     END-IF
  2271
  2272     IF ZACTSUML > +0
  2273         MOVE ZACTSUMI           TO W-ACCT-SUMM
  2274     END-IF
  2275
  2276     IF ZCSOSUML > +0
  2277         MOVE ZCSOSUMI           TO W-CSO-SUMM
  2278     END-IF
  2279
  2280     IF ZREASONL > +0
  2281        MOVE ZREASONI            TO W-REASONS-REQUIRED
  2282     END-IF
  2283
  2284     IF ZBARCODL > +0
  2285        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  2286     END-IF
  2287
  2288     IF ZRETENVL > +0
  2289        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  2290     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  42
* EL1044.cbl
  2291
  2292     IF ZSIGFLGL > +0
  2293        MOVE ZSIGFLGI            TO W-SIG-FLAG-DEFAULT
  2294     END-IF
  2295     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2296     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  2297                                    PI-CURR-LETR-KEY
  2298                                    PI-PREV-LETR-KEY
  2299
  2300* EXEC CICS WRITE
  2301*       DATASET (ELLETR-FILE-ID)
  2302*       FROM    (TEXT-FILES)
  2303*       RIDFLD  (ELLETR-KEY)
  2304*    END-EXEC
  2305     MOVE LENGTH OF
  2306      TEXT-FILES
  2307       TO DFHEIV11
  2308*    MOVE '&$ L                  ''   #00002159' TO DFHEIV0
  2309     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2310     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2311     MOVE X'2020233030303032313539' TO DFHEIV0(25:11)
  2312     CALL 'kxdfhei1' USING DFHEIV0,
  2313           ELLETR-FILE-ID,
  2314           TEXT-FILES,
  2315           DFHEIV11,
  2316           ELLETR-KEY,
  2317           DFHEIV99,
  2318           DFHEIV99
  2319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2320     MOVE ER-0000                    TO  EMI-ERROR.
  2321     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2322     GO TO 1000-SHOW-LETR-RECORD
  2323     .
  2324 5000-FIND-NEXT-PROD-RECORD.
  2325*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  2326*
  2327*    EXEC CICS STARTBR
  2328*        DATASET   (ELLETR-FILE-ID)
  2329*        RIDFLD    (ELLETR-KEY)
  2330*        GTEQ
  2331*        RESP      (WS-RESPONSE)
  2332*    END-EXEC
  2333*
  2334*    IF NOT RESP-NORMAL
  2335*       MOVE -1                  TO PFKEYL
  2336*       MOVE ER-0130             TO EMI-ERROR
  2337*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2338*       GO TO 8200-SEND-DATAONLY
  2339*    END-IF
  2340     .
  2341 5000-READNEXT-LOOP.
  2342*    EXEC CICS READNEXT
  2343*        DATASET   (ELLETR-FILE-ID)
  2344*        SET       (ADDRESS OF PRODUCT-MASTER)
  2345*        RIDFLD    (ELLETR-KEY)
  2346*        RESP      (WS-RESPONSE)
  2347*    END-EXEC
  2348*
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  43
* EL1044.cbl
  2349*    IF (NOT RESP-NORMAL)
  2350*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  2351*       PERFORM 5000-END-BROWSE
  2352*       MOVE -1                  TO PFKEYL
  2353*       MOVE ER-0130             TO EMI-ERROR
  2354*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2355*       GO TO 1000-SHOW-LETR-RECORD
  2356*    END-IF
  2357*
  2358*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  2359*       GO TO 5000-READNEXT-LOOP
  2360*    END-IF
  2361*
  2362*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2363*
  2364*    PERFORM 5000-END-BROWSE
  2365*    GO TO 7000-BUILD-OUTPUT-MAP
  2366     .
  2367 5000-END-BROWSE.
  2368*    EXEC CICS ENDBR
  2369*        DATASET   (ELLETR-FILE-ID)
  2370*    END-EXEC
  2371     .
  2372 5100-FIND-PREV-PROD-RECORD.
  2373*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  2374*    IF STATEL > +0
  2375*       MOVE STATEI              TO ELLETR-STATE
  2376*    END-IF
  2377*    IF PRODCDL > +0
  2378*       MOVE PRODCDI             TO ELLETR-PROD-CD
  2379*    END-IF
  2380*    IF BENTYPL > +0
  2381*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  2382*    IF BENCODEL > +0
  2383*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2384*    IF EXPDTL IS GREATER THAN +0
  2385*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2386*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2387*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2388*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2389*        ELSE
  2390*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2391*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2392*          END-STRING
  2393*           MOVE 'L'                    TO  DC-OPTION-CODE
  2394*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2395*            IF NO-CONVERSION-ERROR
  2396*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2397*            ELSE
  2398*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2399*
  2400*    EXEC CICS HANDLE CONDITION
  2401*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2402*    END-EXEC.
  2403*
  2404*    EXEC CICS STARTBR
  2405*        DATASET   (ELLETR-FILE-ID)
  2406*        RIDFLD    (ELLETR-KEY)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  44
* EL1044.cbl
  2407*        GTEQ
  2408*    END-EXEC.
  2409 5100-READPREV-LOOP.
  2410*    EXEC CICS READPREV
  2411*        DATASET   (ELLETR-FILE-ID)
  2412*        SET       (ADDRESS OF PRODUCT-MASTER)
  2413*        RIDFLD    (ELLETR-KEY)
  2414*    END-EXEC.
  2415*
  2416*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2417*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2418*
  2419*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2420*        GO TO 5100-READPREV-LOOP.
  2421*
  2422*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2423*
  2424*    GO TO 7000-BUILD-OUTPUT-MAP.
  2425 5100-END-BROWSE.
  2426*    EXEC CICS ENDBR
  2427*        DATASET   (ELLETR-FILE-ID)
  2428*    END-EXEC.
  2429 5100-UNSUCCESSFUL-SEARCH.
  2430     PERFORM 5100-END-BROWSE.
  2431     MOVE ER-0131                    TO  EMI-ERROR.
  2432     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2433     GO TO 1000-SHOW-LETR-RECORD.
  2434     .
  2435 6000-EDIT-INPUT-DATA.
  2436     IF MAINTI = 'A'
  2437        IF ZLETRL > +0
  2438           AND ZLETRI NOT = SPACES
  2439           CONTINUE
  2440        ELSE
  2441           MOVE AL-UNBON         TO ZCOPIESA
  2442           MOVE -1               TO ZCOPIESL
  2443           MOVE ER-0005          TO EMI-ERROR
  2444           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2445        END-IF
  2446     END-IF
  2447     IF ZCOPIESL > +0
  2448        IF ZCOPIESI NUMERIC
  2449           CONTINUE
  2450        ELSE
  2451           MOVE AL-UNBON         TO ZCOPIESA
  2452           MOVE -1               TO ZCOPIESL
  2453           MOVE ER-0184          TO EMI-ERROR
  2454           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2455        END-IF
  2456     END-IF
  2457     IF ZFADAYSL > +0
  2458       IF ZFADAYSI NOT EQUAL SPACES
  2459          IF ZFADAYSI NUMERIC
  2460             CONTINUE
  2461          ELSE
  2462             MOVE AL-UNBON         TO ZFADAYSA
  2463             MOVE -1               TO ZFADAYSL
  2464             MOVE ER-0491          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  45
* EL1044.cbl
  2465             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2466          END-IF
  2467       END-IF
  2468     END-IF
  2469     IF ZRDAYSL > +0
  2470       IF ZRDAYSI NOT EQUAL SPACES
  2471          IF ZRDAYSI NUMERIC
  2472             CONTINUE
  2473          ELSE
  2474             MOVE AL-UNBON         TO ZRDAYSA
  2475             MOVE -1               TO ZRDAYSL
  2476             MOVE ER-0491          TO EMI-ERROR
  2477             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2478          END-IF
  2479       END-IF
  2480     END-IF
  2481     IF ZPROMPTL > +0
  2482        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2483           CONTINUE
  2484        ELSE
  2485           MOVE AL-UABON         TO ZPROMPTA
  2486           MOVE -1               TO ZPROMPTL
  2487           MOVE ER-0627          TO EMI-ERROR
  2488           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2489        END-IF
  2490     END-IF
  2491     IF MAINTI = 'A'
  2492        AND ZENCCDL <= 0
  2493        MOVE AL-UABON            TO ZENCCDA
  2494        MOVE -1                  TO ZENCCDL
  2495        MOVE ER-1560             TO EMI-ERROR
  2496        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2497     END-IF
  2498     IF ZENCCDL > +0
  2499        IF ZENCCDI = '@'
  2500            CONTINUE
  2501        ELSE
  2502           MOVE SPACES             TO ELENCC-KEY
  2503           MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2504           MOVE '2'                TO ELENCC-REC-TYPE
  2505           MOVE ZENCCDI            TO ELENCC-ENC-CODE
  2506
  2507
  2508* EXEC CICS READ
  2509*              DATASET    (ELENCC-FILE-ID)
  2510*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2511*              RIDFLD     (ELENCC-KEY)
  2512*              RESP       (WS-RESPONSE)
  2513*          END-EXEC
  2514*    MOVE '&"S        E          (  N#00002351' TO DFHEIV0
  2515     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2517     MOVE X'204E233030303032333531' TO DFHEIV0(25:11)
  2518     CALL 'kxdfhei1' USING DFHEIV0,
  2519           ELENCC-FILE-ID,
  2520           DFHEIV20,
  2521           DFHEIV99,
  2522           ELENCC-KEY,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  46
* EL1044.cbl
  2523           DFHEIV99,
  2524           DFHEIV99,
  2525           DFHEIV99
  2526     SET ADDRESS OF ENCLOSURE-CODES TO
  2527         DFHEIV20
  2528     MOVE EIBRESP  TO WS-RESPONSE
  2529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2530
  2531           IF RESP-NORMAL
  2532              CONTINUE
  2533           ELSE
  2534              MOVE AL-UABON         TO ZENCCDA
  2535              MOVE -1               TO ZENCCDL
  2536              MOVE ER-1560          TO EMI-ERROR
  2537              PERFORM 9900-ERROR-FORMAT
  2538                                 THRU 9900-EXIT
  2539           END-IF
  2540        END-IF
  2541     END-IF
  2542     IF MAINTI = 'A'
  2543        AND ZTYPEL <= 0
  2544        MOVE AL-UABON            TO ZTYPEA
  2545        MOVE -1                  TO ZTYPEL
  2546        MOVE ER-1564             TO EMI-ERROR
  2547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2548     END-IF
  2549     IF ZTYPEL > +0
  2550        IF ZTYPEI = 'C' OR 'P' OR 'U'
  2551           CONTINUE
  2552        ELSE
  2553           MOVE -1               TO ZTYPEL
  2554           MOVE AL-UABON         TO ZTYPEA
  2555           MOVE ER-1564          TO EMI-ERROR
  2556           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2557        END-IF
  2558     END-IF
  2559     IF ZACLOSEL > +0
  2560        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2561           CONTINUE
  2562        ELSE
  2563           MOVE -1               TO ZACLOSEL
  2564           MOVE AL-UABON         TO ZACLOSEA
  2565           MOVE ER-1562          TO EMI-ERROR
  2566           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2567        END-IF
  2568     END-IF
  2569     IF ZPRTCRTL > +0
  2570        IF ZPRTCRTI = 'Y' OR 'N' OR ' '
  2571           CONTINUE
  2572        ELSE
  2573           MOVE AL-UABON         TO ZPRTCRTA
  2574           MOVE -1               TO ZPRTCRTL
  2575           MOVE ER-0627          TO EMI-ERROR
  2576           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2577        END-IF
  2578     END-IF
  2579     IF ZREFREQL > +0
  2580        IF ZREFREQI = 'Y' OR 'N' OR ' '
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  47
* EL1044.cbl
  2581           CONTINUE
  2582        ELSE
  2583           MOVE AL-UABON         TO ZREFREQA
  2584           MOVE -1               TO ZREFREQL
  2585           MOVE ER-0627          TO EMI-ERROR
  2586           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2587        END-IF
  2588     END-IF
  2589     IF MAINTI = 'A'
  2590        AND ZONBASEL <= 0
  2591        MOVE AL-UABON            TO ZONBASEA
  2592        MOVE -1                  TO ZONBASEL
  2593        MOVE ER-3804             TO EMI-ERROR
  2594        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2595     END-IF
  2596     IF ZONBASEL > +0
  2597        IF ZONBASEI = ' '
  2598           MOVE AL-UABON            TO ZONBASEA
  2599           MOVE -1                  TO ZONBASEL
  2600           MOVE ER-3804             TO EMI-ERROR
  2601           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2602        END-IF
  2603     END-IF
  2604
  2605     IF ZACTSUML > +0
  2606        IF ZACTSUMI = '1' OR '2' OR '5' or ' '
  2607           CONTINUE
  2608        ELSE
  2609           MOVE AL-UABON         TO ZACTSUMA
  2610           MOVE -1               TO ZACTSUML
  2611           MOVE ER-3820          TO EMI-ERROR
  2612           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2613        END-IF
  2614     END-IF
  2615
  2616     IF ZCSOSUML > +0
  2617        IF ZCSOSUMI = '3' OR '4' OR ' '
  2618           CONTINUE
  2619        ELSE
  2620           MOVE AL-UABON         TO ZCSOSUMA
  2621           MOVE -1               TO ZCSOSUML
  2622           MOVE ER-3821          TO EMI-ERROR
  2623           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2624        END-IF
  2625     END-IF
  2626
  2627     IF ZREASONL > +0
  2628        IF ZREASONI = 'Y' OR 'N' OR ' '
  2629           CONTINUE
  2630        ELSE
  2631           MOVE AL-UABON         TO ZREASONA
  2632           MOVE -1               TO ZREASONL
  2633           MOVE ER-0627          TO EMI-ERROR
  2634           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2635        END-IF
  2636     END-IF
  2637
  2638     IF ZBARCODL > +0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  48
* EL1044.cbl
  2639        IF ZBARCODI = 'Y' OR 'N' OR ' '
  2640           CONTINUE
  2641        ELSE
  2642           MOVE AL-UABON         TO ZBARCODA
  2643           MOVE -1               TO ZBARCODL
  2644           MOVE ER-0627          TO EMI-ERROR
  2645           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2646        END-IF
  2647     END-IF
  2648
  2649     IF ZRETENVL > +0
  2650        IF ZRETENVI = 'Y' OR 'N' OR ' '
  2651           CONTINUE
  2652        ELSE
  2653           MOVE AL-UABON         TO ZRETENVA
  2654           MOVE -1               TO ZRETENVL
  2655           MOVE ER-0627          TO EMI-ERROR
  2656           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2657        END-IF
  2658     END-IF
  2659
  2660     IF ZSIGFLGL > +0
  2661        IF ZSIGFLGI = 'Y' OR 'N' OR ' '
  2662           CONTINUE
  2663        ELSE
  2664           MOVE AL-UABON         TO ZSIGFLGA
  2665           MOVE -1               TO ZSIGFLGL
  2666           MOVE ER-0627          TO EMI-ERROR
  2667           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2668        END-IF
  2669     END-IF
  2670
  2671     .
  2672 6000-EXIT.
  2673     EXIT.
  2674
  2675
  2676 6500-BUILD-CURRENT-CODES.
  2677      MOVE SPACES             TO ELENCC-KEY
  2678      MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2679      MOVE '2'                TO ELENCC-REC-TYPE
  2680      MOVE LOW-VALUES         TO ELENCC-ENC-CODE
  2681      MOVE SPACES             TO HOLD-ENC-CODES
  2682      MOVE '@'                TO HOLD-ENC-CODES (1:1)
  2683      MOVE HOLD-ENC-CODES     TO PI-ENC-CODES
  2684
  2685
  2686* EXEC CICS STARTBR
  2687*        DATASET   (ELENCC-FILE-ID)
  2688*        RIDFLD    (ELENCC-KEY)
  2689*        GTEQ
  2690*        RESP      (WS-RESPONSE)
  2691*     END-EXEC
  2692     MOVE 0
  2693       TO DFHEIV11
  2694*    MOVE '&,         G          &  N#00002512' TO DFHEIV0
  2695     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2696     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  49
* EL1044.cbl
  2697     MOVE X'204E233030303032353132' TO DFHEIV0(25:11)
  2698     CALL 'kxdfhei1' USING DFHEIV0,
  2699           ELENCC-FILE-ID,
  2700           ELENCC-KEY,
  2701           DFHEIV99,
  2702           DFHEIV11,
  2703           DFHEIV99
  2704     MOVE EIBRESP  TO WS-RESPONSE
  2705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2706
  2707      IF RESP-NORMAL
  2708        PERFORM UNTIL DONE-WITH-ENCC
  2709           MOVE PI-ENC-CODES TO HOLD-ENC-CODES
  2710
  2711* EXEC CICS READNEXT
  2712*              DATASET    (ELENCC-FILE-ID)
  2713*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2714*              RIDFLD     (ELENCC-KEY)
  2715*              RESP       (WS-RESPONSE)
  2716*          END-EXEC
  2717     MOVE 0
  2718       TO DFHEIV11
  2719*    MOVE '&.S                   )  N#00002522' TO DFHEIV0
  2720     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2721     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2722     MOVE X'204E233030303032353232' TO DFHEIV0(25:11)
  2723     CALL 'kxdfhei1' USING DFHEIV0,
  2724           ELENCC-FILE-ID,
  2725           DFHEIV20,
  2726           DFHEIV99,
  2727           ELENCC-KEY,
  2728           DFHEIV99,
  2729           DFHEIV11,
  2730           DFHEIV99,
  2731           DFHEIV99
  2732     SET ADDRESS OF ENCLOSURE-CODES TO
  2733         DFHEIV20
  2734     MOVE EIBRESP  TO WS-RESPONSE
  2735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2736           IF (RESP-NORMAL)
  2737              AND (ELENCC-COMPANY-CD = PI-COMPANY-CD)
  2738              AND (ELENCC-REC-TYPE = '2')
  2739                 PERFORM VARYING WS-SUB1 FROM 5 BY -1
  2740                      UNTIL ELENCC-ENC-CODE (WS-SUB1:1) <> ' '
  2741                 END-PERFORM
  2742                 IF WS-SUB1 > 2
  2743                     SUBTRACT +1 FROM WS-SUB1
  2744                 END-IF
  2745                 MOVE ELENCC-ENC-CODE (WS-SUB1:2) TO
  2746                             WS-TEST-STATE
  2747                 IF STATE-SPECIFIC AND
  2748                    ELENCC-ENC-CODE NOT = 'ENV'
  2749                    CONTINUE
  2750                 ELSE
  2751                    STRING HOLD-ENC-CODES DELIMITED BY ' '
  2752                         ','
  2753                         ELENCC-ENC-CODE DELIMITED BY ' '
  2754                    INTO PI-ENC-CODES
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  50
* EL1044.cbl
  2755                 END-IF
  2756           ELSE
  2757              SET DONE-WITH-ENCC  TO TRUE
  2758           END-IF
  2759        END-PERFORM
  2760     END-IF
  2761
  2762     MOVE +53 TO PI-SPLIT-SUB
  2763     PERFORM UNTIL PI-ENC-CODES (PI-SPLIT-SUB:1) = ' ' OR ','
  2764         SUBTRACT +1 FROM PI-SPLIT-SUB
  2765     END-PERFORM
  2766
  2767     .
  2768 6500-EXIT.
  2769     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  51
* EL1044.cbl
  2771 7000-BUILD-OUTPUT-MAP.
  2772     MOVE LOW-VALUES             TO EL1044ZO
  2773     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2774     MOVE TX-LETTER-NO           TO ZLETRO
  2775     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2776     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2777     MOVE W-DAYS-TO-RESEND       TO ZRDAYSO
  2778     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2779     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2780     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2781     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2782     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2783     MOVE W-LETTER-TO-ACCT       TO ZACCTO
  2784     MOVE W-LETTER-TYPE          TO ZTYPEO
  2785     MOVE W-PRINT-CERTIFICATE    TO ZPRTCRTO
  2786     MOVE W-REFUND-REQUIRED      TO ZREFREQO
  2787     MOVE W-ONBASE-CODE          TO ZONBASEO
  2788     MOVE W-ACCT-SUMM            TO ZACTSUMO
  2789     MOVE W-CSO-SUMM             TO ZCSOSUMO
  2790     MOVE W-REASONS-REQUIRED     TO ZREASONO
  2791     MOVE W-ADD-BAR-CODE         TO ZBARCODO
  2792     MOVE W-HAS-RETURN-ENV       TO ZRETENVO
  2793     MOVE W-SIG-FLAG-DEFAULT     TO ZSIGFLGO
  2794     MOVE PI-SPLIT-SUB           TO WS-SUB1
  2795     COMPUTE WS-SUB2 = PI-SPLIT-SUB + 1
  2796     COMPUTE WS-SUB3 = 120 - PI-SPLIT-SUB
  2797     MOVE PI-ENC-CODES (1:WS-SUB1) TO ZCODES1O
  2798     MOVE PI-ENC-CODES (WS-SUB2:WS-SUB3) TO ZCODES2O
  2799     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2800                                    PI-UPDATE-BY
  2801     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2802                                    DC-BIN-DATE-1
  2803     MOVE ' '                    TO DC-OPTION-CODE
  2804     MOVE +0                     TO DC-ELAPSED-DAYS
  2805                                     DC-ELAPSED-MONTHS.
  2806     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2807     IF NO-CONVERSION-ERROR
  2808        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2809     ELSE
  2810        MOVE LOW-VALUES          TO LSTDTEO
  2811     END-IF
  2812     MOVE -1                     TO MAINTL
  2813     .
  2814 8100-SEND-INITIAL-MAP.
  2815     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2816     MOVE EIBTIME                    TO  TIME-IN.
  2817     MOVE SAVE-DATE                  TO  DATEO.
  2818     MOVE TIME-OUT                   TO  TIMEO
  2819     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2820     MOVE PI-PROCESSOR-ID        TO USERIDO
  2821
  2822* EXEC CICS SEND
  2823*        MAP      (WS-MAP-NAME)
  2824*        MAPSET   (MAPSET-NAME)
  2825*        FROM     (EL1044ZO)
  2826*        ERASE
  2827*        CURSOR
  2828*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  52
* EL1044.cbl
  2829     MOVE LENGTH OF
  2830      EL1044ZO
  2831       TO DFHEIV12
  2832     MOVE -1
  2833       TO DFHEIV11
  2834*    MOVE '8$     CT  E    H L F ,   #00002613' TO DFHEIV0
  2835     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2836     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2837     MOVE X'2020233030303032363133' TO DFHEIV0(25:11)
  2838     CALL 'kxdfhei1' USING DFHEIV0,
  2839           WS-MAP-NAME,
  2840           EL1044ZO,
  2841           DFHEIV12,
  2842           MAPSET-NAME,
  2843           DFHEIV99,
  2844           DFHEIV99,
  2845           DFHEIV99,
  2846           DFHEIV11,
  2847           DFHEIV99,
  2848           DFHEIV99,
  2849           DFHEIV99
  2850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2851
  2852     MOVE '044Z'                 TO PI-CURRENT-SCREEN-NO
  2853     GO TO 9100-RETURN-TRAN
  2854     .
  2855 8200-SEND-DATAONLY.
  2856     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2857     MOVE EIBTIME                    TO  TIME-IN.
  2858     MOVE SAVE-DATE                  TO  DATEO.
  2859     MOVE TIME-OUT                   TO  TIMEO.
  2860     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2861     MOVE PI-PROCESSOR-ID        TO USERIDO
  2862
  2863* EXEC CICS SEND
  2864*        MAP      (WS-MAP-NAME)
  2865*        MAPSET   (MAPSET-NAME)
  2866*        FROM     (EL1044ZO)
  2867*        DATAONLY
  2868*        CURSOR
  2869*    END-EXEC.
  2870     MOVE LENGTH OF
  2871      EL1044ZO
  2872       TO DFHEIV12
  2873     MOVE -1
  2874       TO DFHEIV11
  2875*    MOVE '8$D    CT       H L F ,   #00002631' TO DFHEIV0
  2876     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2877     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2878     MOVE X'2020233030303032363331' TO DFHEIV0(25:11)
  2879     CALL 'kxdfhei1' USING DFHEIV0,
  2880           WS-MAP-NAME,
  2881           EL1044ZO,
  2882           DFHEIV12,
  2883           MAPSET-NAME,
  2884           DFHEIV99,
  2885           DFHEIV99,
  2886           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  53
* EL1044.cbl
  2887           DFHEIV11,
  2888           DFHEIV99,
  2889           DFHEIV99,
  2890           DFHEIV99
  2891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2892
  2893     GO TO 9100-RETURN-TRAN
  2894     .
  2895 8300-SEND-TEXT.
  2896
  2897* EXEC CICS SEND TEXT
  2898*        FROM  (LOGOFF-TEXT)
  2899*        LENGTH(LOGOFF-LENGTH)
  2900*        ERASE
  2901*        FREEKB
  2902*    END-EXEC.
  2903*    MOVE '8&      T  E F  H   F -   #00002641' TO DFHEIV0
  2904     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2905     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2906     MOVE X'2020233030303032363431' TO DFHEIV0(25:11)
  2907     CALL 'kxdfhei1' USING DFHEIV0,
  2908           LOGOFF-TEXT,
  2909           LOGOFF-LENGTH,
  2910           DFHEIV99,
  2911           DFHEIV99,
  2912           DFHEIV99,
  2913           DFHEIV99,
  2914           DFHEIV99,
  2915           DFHEIV99,
  2916           DFHEIV99,
  2917           DFHEIV99,
  2918           DFHEIV99,
  2919           DFHEIV99
  2920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2921
  2922
  2923* EXEC CICS RETURN
  2924*        END-EXEC.
  2925*    MOVE '.(                    ''   #00002647' TO DFHEIV0
  2926     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2927     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2928     MOVE X'2020233030303032363437' TO DFHEIV0(25:11)
  2929     CALL 'kxdfhei1' USING DFHEIV0,
  2930           DFHEIV99,
  2931           DFHEIV99,
  2932           DFHEIV99,
  2933           DFHEIV99,
  2934           DFHEIV99,
  2935           DFHEIV99
  2936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2937
  2938     .
  2939 8500-DEEDIT.
  2940     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2941                                 TO WS-9V999-OF-DEEDIT
  2942     .
  2943 8500-EXIT.
  2944     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  54
* EL1044.cbl
  2945 8600-DEEDIT.
  2946     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2947                                 TO WS-NUMVAL-OF-DEEDIT
  2948     .
  2949 8600-EXIT.
  2950     EXIT.
  2951 8800-UNAUTHORIZED-ACCESS.
  2952     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2953     GO TO 8300-SEND-TEXT.
  2954 8810-PF23.
  2955     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2956     MOVE XCTL-005                   TO  PGM-NAME.
  2957     GO TO 9300-XCTL.
  2958 8850-DUPREC.
  2959     MOVE ER-0132                    TO  EMI-ERROR.
  2960     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2961     MOVE -1                         TO  MAINTL
  2962     MOVE AL-UABON                   TO  ZLETRA
  2963     GO TO 8100-SEND-INITIAL-MAP.
  2964 8870-NOTOPEN.
  2965     MOVE LOW-VALUES                 TO  EL1044ZO.
  2966     MOVE -1                         TO  MAINTL.
  2967     MOVE ER-0701                    TO  EMI-ERROR.
  2968     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2969     GO TO 8100-SEND-INITIAL-MAP.
  2970 8880-NOT-FOUND.
  2971     MOVE ER-0702                    TO  EMI-ERROR.
  2972     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2973     MOVE -1                         TO  MAINTL
  2974     MOVE AL-UABON                   TO  ZLETRA
  2975     GO TO 8100-SEND-INITIAL-MAP.
  2976     .
  2977 9100-RETURN-TRAN.
  2978     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2979
  2980* EXEC CICS RETURN
  2981*        TRANSID    (TRANS-ID)
  2982*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2983*        LENGTH     (PI-COMM-LENGTH)
  2984*    END-EXEC.
  2985*    MOVE '.(CT                  ''   #00002690' TO DFHEIV0
  2986     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2987     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2988     MOVE X'2020233030303032363930' TO DFHEIV0(25:11)
  2989     CALL 'kxdfhei1' USING DFHEIV0,
  2990           TRANS-ID,
  2991           PROGRAM-INTERFACE-BLOCK,
  2992           PI-COMM-LENGTH,
  2993           DFHEIV99,
  2994           DFHEIV99,
  2995           DFHEIV99
  2996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2997
  2998 9200-RETURN-MAIN-MENU.
  2999     MOVE XCTL-626                   TO  PGM-NAME.
  3000     GO TO 9300-XCTL.
  3001 9300-XCTL.
  3002
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  55
* EL1044.cbl
  3003* EXEC CICS XCTL
  3004*        PROGRAM    (PGM-NAME)
  3005*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3006*        LENGTH     (PI-COMM-LENGTH)
  3007*    END-EXEC.
  3008*    MOVE '.$C                   %   #00002699' TO DFHEIV0
  3009     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3010     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3011     MOVE X'2020233030303032363939' TO DFHEIV0(25:11)
  3012     CALL 'kxdfhei1' USING DFHEIV0,
  3013           PGM-NAME,
  3014           PROGRAM-INTERFACE-BLOCK,
  3015           PI-COMM-LENGTH,
  3016           DFHEIV99
  3017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3018
  3019 9400-CLEAR.
  3020     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  3021     GO TO 9300-XCTL.
  3022 9500-PF12.
  3023     MOVE XCTL-010                   TO  PGM-NAME.
  3024     GO TO 9300-XCTL.
  3025 9600-PGMID-ERROR.
  3026
  3027* EXEC CICS HANDLE CONDITION
  3028*        PGMIDERR   (8300-SEND-TEXT)
  3029*    END-EXEC.
  3030*    MOVE '"$L                   ! # #00002711' TO DFHEIV0
  3031     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3032     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3033     MOVE X'2320233030303032373131' TO DFHEIV0(25:11)
  3034     CALL 'kxdfhei1' USING DFHEIV0
  3035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3036
  3037     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  3038     MOVE ' '                        TO  PI-ENTRY-CD-1.
  3039     MOVE XCTL-005                   TO  PGM-NAME.
  3040     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  3041     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  3042     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  56
* EL1044.cbl
  3044 9700-LINK-DATE-CONVERT.
  3045
  3046* EXEC CICS LINK
  3047*        PROGRAM    ('ELDATCV')
  3048*        COMMAREA   (DATE-CONVERSION-DATA)
  3049*        LENGTH     (DC-COMM-LENGTH)
  3050*    END-EXEC.
  3051     MOVE 'ELDATCV' TO DFHEIV1
  3052*    MOVE '."C                   (   #00002722' TO DFHEIV0
  3053     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3055     MOVE X'2020233030303032373232' TO DFHEIV0(25:11)
  3056     CALL 'kxdfhei1' USING DFHEIV0,
  3057           DFHEIV1,
  3058           DATE-CONVERSION-DATA,
  3059           DC-COMM-LENGTH,
  3060           DFHEIV99,
  3061           DFHEIV99,
  3062           DFHEIV99,
  3063           DFHEIV99
  3064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3065
  3066 9700-EXIT.
  3067     EXIT.
  3068 9900-ERROR-FORMAT.
  3069     IF NOT EMI-ERRORS-COMPLETE
  3070         MOVE LINK-001               TO  PGM-NAME
  3071
  3072* EXEC CICS LINK
  3073*            PROGRAM    (PGM-NAME)
  3074*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3075*            LENGTH     (EMI-COMM-LENGTH)
  3076*        END-EXEC.
  3077*    MOVE '."C                   (   #00002732' TO DFHEIV0
  3078     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3079     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3080     MOVE X'2020233030303032373332' TO DFHEIV0(25:11)
  3081     CALL 'kxdfhei1' USING DFHEIV0,
  3082           PGM-NAME,
  3083           ERROR-MESSAGE-INTERFACE-BLOCK,
  3084           EMI-COMM-LENGTH,
  3085           DFHEIV99,
  3086           DFHEIV99,
  3087           DFHEIV99,
  3088           DFHEIV99
  3089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3090
  3091 9900-EXIT.
  3092     EXIT.
  3093 9990-ABEND.
  3094     MOVE LINK-004                   TO  PGM-NAME.
  3095     MOVE DFHEIBLK                   TO  EMI-LINE1.
  3096
  3097* EXEC CICS LINK
  3098*        PROGRAM   (PGM-NAME)
  3099*        COMMAREA  (EMI-LINE1)
  3100*        LENGTH    (72)
  3101*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  57
* EL1044.cbl
  3102     MOVE 72
  3103       TO DFHEIV11
  3104*    MOVE '."C                   (   #00002742' TO DFHEIV0
  3105     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3106     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3107     MOVE X'2020233030303032373432' TO DFHEIV0(25:11)
  3108     CALL 'kxdfhei1' USING DFHEIV0,
  3109           PGM-NAME,
  3110           EMI-LINE1,
  3111           DFHEIV11,
  3112           DFHEIV99,
  3113           DFHEIV99,
  3114           DFHEIV99,
  3115           DFHEIV99
  3116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3117
  3118     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  58
* EL1044.cbl
  3120 9995-SECURITY-VIOLATION.
  3121*                            COPY ELCSCTP.
  3122******************************************************************
  3123*                                                                *
  3124*                            ELCSCTP                             *
  3125*                            VMOD=2.001                          *
  3126*                                                                *
  3127*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3128******************************************************************
  3129
  3130
  3131     MOVE EIBDATE          TO SM-JUL-DATE.
  3132     MOVE EIBTRMID         TO SM-TERMID.
  3133     MOVE THIS-PGM         TO SM-PGM.
  3134     MOVE EIBTIME          TO TIME-IN.
  3135     MOVE TIME-OUT         TO SM-TIME.
  3136     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3137
  3138
  3139* EXEC CICS LINK
  3140*         PROGRAM  ('EL003')
  3141*         COMMAREA (SECURITY-MESSAGE)
  3142*         LENGTH   (80)
  3143*    END-EXEC.
  3144     MOVE 'EL003' TO DFHEIV1
  3145     MOVE 80
  3146       TO DFHEIV11
  3147*    MOVE '."C                   (   #00002767' TO DFHEIV0
  3148     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3150     MOVE X'2020233030303032373637' TO DFHEIV0(25:11)
  3151     CALL 'kxdfhei1' USING DFHEIV0,
  3152           DFHEIV1,
  3153           SECURITY-MESSAGE,
  3154           DFHEIV11,
  3155           DFHEIV99,
  3156           DFHEIV99,
  3157           DFHEIV99,
  3158           DFHEIV99
  3159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3160
  3161
  3162******************************************************************
  3163
  3164 9995-EXIT.
  3165     EXIT.
  3166
  3167 9999-DFHBACK SECTION.
  3168     MOVE '9%                    "   ' TO DFHEIV0
  3169     MOVE 'EL1044' TO DFHEIV1
  3170     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3171     GOBACK.
  3172 9999-DFHEXIT.
  3173     IF DFHEIGDJ EQUAL 0001
  3174         NEXT SENTENCE
  3175     ELSE IF DFHEIGDJ EQUAL 2
  3176         GO TO 8850-DUPREC,
  3177               8870-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:30 Page  59
* EL1044.cbl
  3178               8880-NOT-FOUND,
  3179               9600-PGMID-ERROR,
  3180               9990-ABEND
  3181         DEPENDING ON DFHEIGDI
  3182     ELSE IF DFHEIGDJ EQUAL 3
  3183         GO TO 8300-SEND-TEXT
  3184         DEPENDING ON DFHEIGDI.
  3185     MOVE '9%                    "   ' TO DFHEIV0
  3186     MOVE 'EL1044' TO DFHEIV1
  3187     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3188     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5500     Code:        8643
