* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54******************************************************************
    55 ENVIRONMENT DIVISION.
    56
    57 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   3
* EL050.cbl
    59 WORKING-STORAGE SECTION.
    60 01  DFH-START PIC X(04).
    61
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    65
    66 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    67 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    68                                   USAGE POINTER.
    69 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    70 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    72                                   USAGE IS POINTER.
    73 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    78                                   USAGE IS POINTER.
    79
    80 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    82                                   USAGE IS POINTER.
    83
    84*    COPY ELC50WS.
    85*****************************************************************
    86*                                                               *
    87*                            ELC50WS.                           *
    88*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    89*                            VMOD=2.061.                        *
    90*                                                               *
    91*   THIS IS THE WORKING STORAGE FOR EL050                       *
    92*                                   EL517                       *
    93*****************************************************************
    94******************************************************************
    95*                   C H A N G E   L O G
    96*
    97* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    98*-----------------------------------------------------------------
    99*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   100* EFFECTIVE    NUMBER
   101*-----------------------------------------------------------------
   102* 123102                   PEMA  ADD DCC PROCESSING
   103* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   104* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   105* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   106* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   107* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   108* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   109* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   110* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   111* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   112* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   113* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   114* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   115* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   116* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   4
* EL050.cbl
   117* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   118* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   119* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   120* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   121* 030309  CR2009021700001  PEMA  ADD ER-2883
   122* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   123* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   124* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   125* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   126* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   127* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   128* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   129* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   130* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   132* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   133* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   134* 061412  CR2011022800001  AJRA  NAPERSOFT
   135* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   136* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   137* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   138* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   139* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   140* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   141* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   142* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   143* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   144* 091114  IR2014091000001  TANA  ADD ERROR 2898
   145*-----------------------------------------------------------------
   146
   147 01  WORK-AREAS.
   148
   149*****************************************************************
   150*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   151*****************************************************************
   152
   153     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   154     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   155     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   156     12  WS-NAME-EDIT-WORK-AREA.
   157         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   158         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   159             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   160         16  WS-WORK-NAME.
   161             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   162             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   163             20  FILLER           PIC X(10)     VALUE SPACES.
   164         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   165             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   166
   167*****************************************************************
   168*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   169*****************************************************************
   170
   171     12  WS-ERRESC-KEY.
   172         16 WS-ERRESC-SEARCH-KEY.
   173             20  WS-ERRESC-COMPANY-CD PIC  X.
   174             20  WS-ERRESC-CARRIER    PIC  X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   5
* EL050.cbl
   175             20  WS-ERRESC-GROUP      PIC X(6).
   176             20  WS-ERRESC-STATE      PIC XX.
   177             20  WS-ERRESC-ACCOUNT    PIC X(10).
   178         16 WS-ERRESC-RESIDUAL-KEY.
   179             20  WS-ERRESC-AGENT      PIC X(10).
   180             20  WS-ERRESC-RES-STATE  PIC XX.
   181             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   182*                                          YYYYMMDD
   183     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   184     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   185
   186*RESIDENT STATE TAX MASTER(ERRESS)
   187*
   188     12  WS-ERRESS-KEY.
   189         16  WS-ERRESS-COMPANY-CD      PIC  X.
   190         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   191         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   192         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   193*                                          YYYYMMDD
   194
   195     12  WS-CONTRACT-DATE              PIC 9(8).
   196*                                          YYYYMMDD
   197     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   198     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   199         16 WS-YEAR-YY                 PIC   9999.
   200         16 FILLER                     PIC 9(4).
   201*                                          YYYYMMDD
   202     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   203     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   204     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   205     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   206
   207     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   208         88  DPRB-1ST-TIME                      VALUE ' '.
   209
   210*****************************************************************
   211*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   212*****************************************************************
   213
   214     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   215     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   216     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   217     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   218     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   219     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   220     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   221     12  ws-st-agent-sig-edit    pic x          value spaces.
   222     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   223     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   224     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   225     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   226         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   227         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   228     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   229         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   230         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   231     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
   232
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   6
* EL050.cbl
   233     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   234     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   235
   236     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   237     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   238     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   242     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   243     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   244     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   247     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   250     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   251     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   252     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   267     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   269     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   271     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   272     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   273     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   274     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   275     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   276     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   284     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   285     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   286     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   287     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   288     12  WS-2671-SW               PIC X         VALUE SPACE.
   289     12  WS-2672-SW               PIC X         VALUE SPACE.
   290     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   7
* EL050.cbl
   291         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   292     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   293         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   294     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   295
   296     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   297         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   298         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   299         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   300         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   301
   302     12  WS-CREDIT-EDIT-CONTROLS.
   303         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   304         16  WS-MIN-AGE           PIC 99                VALUE  0.
   305         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   306         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   307         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   308         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   309
   310     12  WS-AGE-FIELDS.
   311         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   312         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   313         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   314         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   315
   316     12  WS-SAVE-ALLOWABLE-BENEFIT.
   317         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   318         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   319         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   320         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   321         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   322         16  FILLER                      PIC XX.
   323
   324     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   325     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   326     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   327     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   328     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   329     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   330     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   331     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   332     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   333     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   334
   335     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   336     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   337     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   338     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   339     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   340     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   341     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   342     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   343         88  WS-REDUCING              VALUE 'R'.
   344         88  WS-LEVEL                 VALUE 'L' 'P'.
   345     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   346
   347     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
   348     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   8
* EL050.cbl
   349     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   350     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   351     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   352     12  ws-ah-max-bens           pic 99        value zeros.
   353     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   354     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   355     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   356     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   357
   358     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   359     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   360     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   361     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   362     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   363     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   364     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   365     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   366     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   367     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   368     12  WS-ACCT-SIG-SW.
   369         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   370         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   371     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   372     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   373     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   374     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   376     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   377     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   378     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   379     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   380     12  WS-INITIALS.
   381         16  WS-INIT-1            PIC X         VALUE SPACES.
   382         16  WS-INIT-2            PIC X         VALUE SPACES.
   383
   384     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   385     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   386     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   387     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   388     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   389*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   390     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   391     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   392     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   393     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   394     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   395     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   396     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   397     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   398     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   399     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   400     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   401     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   402     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   403     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   404     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   405     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
   406     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page   9
* EL050.cbl
   407     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   408     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   409     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   410     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   411     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   412******** FLA
   413     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   414     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   416     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   417     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   418********
   419     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   420     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   421     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   422     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   423     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   424     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   425     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   426     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   427     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   428     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   429
   430     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   431         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   432                                         '0' THRU '9'.
   433
   434     12  NUMBER-OF-MONTHS.
   435         16  SK-MO OCCURS 12 TIMES PIC X.
   436
   437     12  WS-WORK-DATE.
   438         16  WS-YEAR            PIC 99    VALUE 00.
   439         16  WS-MONTH           PIC 99    VALUE 00.
   440         16  WS-DAY             PIC 99    VALUE 00.
   441
   442     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   443     12  WS-WORK-CRIT-DEV       REDEFINES
   444         WS-WORK-LF-CRIT-PER    PIC X(03).
   445
   446     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   447     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   448
   449     12  WS-WORK-DATE-FROM.
   450         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   451         16  FILLER             PIC X  VALUE SPACE.
   452         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   453         16  FILLER             PIC X         VALUE SPACE.
   454         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   455
   456     12  WS-WORK-DATE-THRU.
   457         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   458         16  FILLER             PIC X         VALUE SPACE.
   459         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   460         16  FILLER             PIC X         VALUE SPACE.
   461         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   462
   463     12  WS-LF-INPUT-CD.
   464         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  10
* EL050.cbl
   465         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   466
   467     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   468     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   469         16  WS-AH-INPUT-CD-1   PIC X.
   470         16  WS-AH-INPUT-CD-2-3 PIC XX.
   471
   472     12  WS-SWITCHES.
   473         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   474         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   475             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   476         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   477             88  BANK-ACCT-FOUND          VALUE 'Y'.
   478         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   479             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   480         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   481             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   482         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   483             88  COMP-MASTER-FOUND        VALUE 'Y'.
   484         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   485             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   486         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   487             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   488         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   489             88  STAT-MASTER-FOUND        VALUE 'Y'.
   490         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   491             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   492         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   493             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   494         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   495             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   496         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   497             88  FORM-MASTER-FOUND        VALUE 'Y'.
   498         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   499             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   500         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   501             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   502         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   503             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   504         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   505             88  NO-BENEFIT-FOUND         VALUE 'N'.
   506         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   507             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   508         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   509             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   510         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   511             88  AH-BENEFIT-FOUND         VALUE ' '.
   512             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   513         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   514             88  LF-BENEFIT-FOUND         VALUE ' '.
   515             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   516         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   517             88  NO-STATE-RECORD          VALUE '1'.
   518         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   519             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   520         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   521             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
   522         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  11
* EL050.cbl
   523             88  CERT-WAS-FOUND           VALUE ' '.
   524             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   525         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   526             88  BROWSE-STARTED           VALUE 'Y'.
   527         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   528             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   529         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   530             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   531         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   532             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   533         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   534             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   535         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   536             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   537         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   538             88  APP-CERT-USED            VALUE 'Y' 'A'.
   539         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   540             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   541             88  FIRST-TIME-THROUGH       VALUE '1'.
   542             88  CTBL-NOT-FOUND           VALUE '2'.
   543
   544         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   545             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   546
   547         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   548             88  DLO-ERROR-FOUND          VALUE 'Y'.
   549
   550********FLA
   551     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   552     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   553********
   554     12  RC-SW-1                  PIC X           VALUE '0'.
   555     12  RC-SW-2                  PIC X           VALUE '0'.
   556     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   557     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   558     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   559     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   560     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   561     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   562     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   563     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   564     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   565     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   566     12  LIT-SPACES               PIC X           VALUE SPACES.
   567     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   568     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   569     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   570     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   571     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   572     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   573     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   574         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   575         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   576     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   577         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   578
   579 01  WS-EXTRA-PERIODS-BY-STATE.
   580     12  WS-INT-PERIODS          PIC 9.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  12
* EL050.cbl
   581     12  WS-EXTRA-PMTS           PIC 9.
   582 01  ws-net-only-state           pic x value 'N'.
   583 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   584     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   585     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   586 01  WS-CRI-SSN-WORK-AREA.
   587     05  WS-CRI-SOC-SEC-NO.
   588         10  WS-SS-REPT-CD       PIC X(5).
   589         10  WS-SS-LAST-NAME     PIC X(5).
   590         10  WS-SS-INITIAL       PIC X.
   591
   592     05  WS-CRI-REPORT-CODE.
   593         10  FILLER              PIC X(5).
   594         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   595
   596     05  WS-CRI-LAST-NAME.
   597         10  WS-CRI-NAME-MOVE    PIC X(5).
   598         10  FILLER              PIC X(10).
   599
   600 01  WS-NUM-TABLE                PIC X(26)  VALUE
   601     '12345678012345070923456789'.
   602 01  FILLER REDEFINES WS-NUM-TABLE.
   603     05  WS-NUM OCCURS 26        PIC 9.
   604 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   605 01  V1                          PIC S999 COMP-3.
   606 01  V2                          PIC S999 COMP-3.
   607 01  V3                          PIC S999 COMP-3.
   608 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   609 01  FILLER REDEFINES WS-WORK-VIN.
   610     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   611 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   612 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   613 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   614 01  WS-HEX-WORK.
   615     05  FILLER                  PIC X  VALUE LOW-VALUES.
   616     05  WS-HEX-BYTE             PIC X.
   617 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   618 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   619 01  WS-WORK-HIN-ROW-B.
   620     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   621
   622 01  ws-benefit-cd-chg-sw      pic x value spaces.
   623     88  benefit-code-chg           value 'Y'.
   624 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   625 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   626     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   627 01  WS-ROW-D-TABLE.
   628     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   629
   630 01  WS-HIN-TABLE-B.
   631     05  F                       PIC XX VALUE 'A2'.
   632     05  F                       PIC XX VALUE 'B3'.
   633     05  F                       PIC XX VALUE 'C4'.
   634     05  F                       PIC XX VALUE 'D5'.
   635     05  F                       PIC XX VALUE 'E6'.
   636     05  F                       PIC XX VALUE 'F7'.
   637     05  F                       PIC XX VALUE 'G8'.
   638     05  F                       PIC XX VALUE 'H9'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  13
* EL050.cbl
   639     05  F                       PIC XX VALUE 'I1'.
   640     05  F                       PIC XX VALUE 'J2'.
   641     05  F                       PIC XX VALUE 'K3'.
   642     05  F                       PIC XX VALUE 'L4'.
   643     05  F                       PIC XX VALUE 'M5'.
   644     05  F                       PIC XX VALUE 'N6'.
   645     05  F                       PIC XX VALUE 'O0'.
   646     05  F                       PIC XX VALUE 'P7'.
   647     05  F                       PIC XX VALUE 'Q0'.
   648     05  F                       PIC XX VALUE 'R8'.
   649     05  F                       PIC XX VALUE 'S9'.
   650     05  F                       PIC XX VALUE 'T2'.
   651     05  F                       PIC XX VALUE 'U3'.
   652     05  F                       PIC XX VALUE 'V4'.
   653     05  F                       PIC XX VALUE 'W5'.
   654     05  F                       PIC XX VALUE 'X6'.
   655     05  F                       PIC XX VALUE 'Y7'.
   656     05  F                       PIC XX VALUE 'Z8'.
   657 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   658     05  WS-VAL-IN               PIC X.
   659     05  WS-VAL-OUT              PIC 9.
   660 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   661 01  WS-COMPARE-BINARY-DATES.
   662     05  WS-971231                PIC XX VALUE X'92FF'.
   663     05  WS-931231                PIC XX VALUE X'8CFF'.
   664     05  WS-791231                PIC XX VALUE X'77FF'.
   665     05  WS-771001                PIC XX VALUE X'74A1'.
   666     05  WS-820301                PIC XX VALUE X'7B41'.
   667     05  WS-831031                PIC XX VALUE X'7DBF'.
   668     05  WS-831231                PIC XX VALUE X'7DFF'.
   669     05  WS-810831                PIC XX VALUE X'7A7F'.
   670     05  WS-830901                PIC XX VALUE X'7D81'.
   671
   672 01  FILE-ACCESS-IDS.
   673     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   674     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   675     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   676     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   677     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   678     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   679     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   680     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   681     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   682     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   683     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   684     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   685     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   686     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   687     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   688     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   689     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   690 01  DD-IU-SW                    PIC X   VALUE ' '.
   691     88  DD-IU-PRESENT                 VALUE 'Y'.
   692
   693 01  ACCESS-KEYS.
   694     12  ELMSTR-KEY.
   695         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   696         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  14
* EL050.cbl
   697     12  W-CLAIM-KEY.
   698         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   699         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   700
   701     12  ELCNTL-KEY.
   702         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   703         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   704         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   705         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   706
   707     12  ELCERT-KEY.
   708         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   709         16  CERT-CARRIER         PIC X       VALUE SPACE.
   710         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   711         16  CERT-STATE           PIC XX      VALUE SPACES.
   712         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   713         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   714         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   715
   716     12  ELCERT2-KEY.
   717         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   718         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   719
   720     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   721
   722     12  ELCERT-SAVE.
   723         16  FILLER                      PIC XX    VALUE SPACES.
   724
   725         16  WCS-CONTROL-PRIMARY.
   726             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   727             20  WCS-CARRIER             PIC X     VALUE SPACE.
   728             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   729             20  WCS-STATE               PIC XX    VALUE SPACES.
   730             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   731             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   732             20  WCS-CERT-NO.
   733                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   734                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   735
   736         16  CS-CONTROL-BY-NAME.
   737             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   738             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   739             20  CS-INSURED-INITIALS.
   740                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   741                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   742
   743         16  CS-CONTROL-BY-SSN.
   744             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   745             20  CS-SOC-SEC-NO.
   746                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   747                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   748                 24  CS-SSN-LN3.
   749                     28 CS-INSURED-INITIALS-A2   PIC XX
   750                                     VALUE SPACES.
   751                     28 CS-PART-LAST-NAME-A2     PIC X
   752                                     VALUE SPACE.
   753
   754         16  CS-CONTROL-BY-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  15
* EL050.cbl
   755             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   756             20  CS-CERT-NO-A4           PIC X(11)
   757                                     VALUE SPACES.
   758
   759         16  CS-CONTROL-BY-MEMB.
   760             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   761             20  CS-MEMBER-NO.
   762                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   763                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   764                 24  CS-MEMB-LN4.
   765                     28 CS-INSURED-INITIALS-A5   PIC XX
   766                                      VALUE SPACES.
   767                     28 CS-PART-LAST-NAME-A5     PIC XX
   768                                      VALUE SPACES.
   769
   770         16  FILLER              PIC X(360) VALUE SPACES.
   771
   772     12  ERACCT-KEY.
   773         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   774         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   775         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   776         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   777         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   778         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   779
   780     12  ERCOMP-KEY.
   781         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   782         16  COMP-CARRIER         PIC X     VALUE SPACES.
   783         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   784         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   785         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   786         16  COMP-TYPE            PIC X     VALUE SPACES.
   787
   788     12  ERLOFC-KEY.
   789         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   790         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   791         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   792         16  LOFC-STATE           PIC XX    VALUE SPACES.
   793         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   794         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   795
   796     12  WS-ELCRTT-KEY.
   797         16  WS-ELCRTT-PRIMARY       PIC X(33).
   798         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   799
   800     12  ERBXRF-KEY.
   801         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   802         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   803         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   804         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   805
   806     12  ERAGTC-KEY.
   807         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   808         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   809         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   810         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   811         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
   812         16  AGTC-TYPE            PIC X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  16
* EL050.cbl
   813
   814     12  ERPLAN-KEY.
   815         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   816         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   817         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   818         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   819         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   820         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   821         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   822         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   823
   824     12  ERFORM-KEY.
   825         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   826         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   827         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   828         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   829
   830     12  ERREIN-KEY.
   831         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   832         16  REIN-TYPE            PIC X     VALUE SPACES.
   833         16  REIN-TABLE-CO.
   834             20  REIN-CODE-1      PIC X     VALUE SPACE.
   835             20  REIN-CODE-2      PIC X     VALUE SPACE.
   836             20  REIN-CODE-3      PIC X     VALUE SPACE.
   837         16  FILLER               PIC X(3)  VALUE SPACES.
   838
   839     12  ERCTBL-KEY.
   840         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   841         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   842         16  CTBL-CNTRL-2.
   843             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   844             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   845
   846     12  ELCRTO-KEY.
   847         16  ELCRTO-COMPANY-CD       PIC X.
   848         16  ELCRTO-CARRIER          PIC X.
   849         16  ELCRTO-GROUPING         PIC X(6).
   850         16  ELCRTO-STATE            PIC XX.
   851         16  ELCRTO-ACCOUNT          PIC X(10).
   852         16  ELCRTO-CERT-EFF-DT      PIC XX.
   853         16  ELCRTO-CERT-NO.
   854             20  ELCRTO-CERT-PRIME   PIC X(10).
   855             20  ELCRTO-CERT-SFX     PIC X.
   856         16  ELCRTO-RECORD-TYPE      PIC X.
   857         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   858
   859
   860     12  WS-ACCESS.
   861         16  FILLER               PIC XX    VALUE SPACES.
   862         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   863
   864     12  WS-CARR-ACCESS.
   865         16  FILLER               PIC X(3)  VALUE SPACES.
   866         16  WS-CARR              PIC X     VALUE SPACE.
   867*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   868*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   869     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
   870         88  WS-DMD-LF-RATING   VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  17
* EL050.cbl
   871         88  WS-DMD-AH-RATING   VALUE 'Y'.
   872         88  WS-DMD-NO-RATING   VALUE 'N'.
   873
   874     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   875         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   876                                         'NJ' 'NL'
   877                                         'PJ' 'PL'
   878                                         'SJ' 'SL'.
   879     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   880         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   881                                         'NI' 'NJ' 'NL' 'NU'
   882                                         'PJ' 'PL' 'PI' 'PU'
   883                                         'SI' 'SJ' 'SL' 'SU'
   884                                         'MX' 'MY' 'MZ'.
   885 01  ERPDEF-KEY-SAVE             PIC X(18).
   886 01  ERPDEF-KEY.
   887     12  ERPDEF-COMPANY-CD       PIC X.
   888     12  ERPDEF-STATE            PIC XX.
   889     12  ERPDEF-PROD-CD          PIC XXX.
   890     12  F                       PIC X(7).
   891     12  ERPDEF-BEN-TYPE         PIC X.
   892     12  ERPDEF-BEN-CODE         PIC XX.
   893     12  ERPDEF-EXP-DT           PIC XX.
   894
   895 01  ELSTAT-KEY-SAVE             PIC X(20).
   896 01  ELSTAT-KEY.
   897     12  ELSTAT-COMPANY-ID       PIC XXX.
   898     12  ELSTAT-CARRIER          PIC X.
   899     12  ELSTAT-GROUP            PIC X(6).
   900     12  ELSTAT-STATE            PIC XX.
   901     12  ELSTAT-EXP-DT           PIC 9(8).
   902 01  WS-ERROR-VALUES.
   903     12  ER-1570                     PIC S9(4)   VALUE +1570.
   904     12  ER-1571                     PIC S9(4)   VALUE +1571.
   905     12  er-1572                     pic s9(4)   value +1572.
   906     12  er-1573                     pic s9(4)   value +1573.
   907     12  er-1574                     pic s9(4)   value +1574.
   908     12  ER-1575                     PIC S9(4)   VALUE +1575.
   909     12  er-1576                     pic s9(4)   value +1576.
   910     12  er-1743                     pic s9(4)   value +1743.
   911     12  er-1744                     pic s9(4)   value +1744.
   912     12  er-1745                     pic s9(4)   value +1745.
   913     12  er-1746                     pic s9(4)   value +1746.
   914     12  er-1747                     pic s9(4)   value +1747.
   915     12  er-1748                     pic s9(4)   value +1748.
   916     12  ER-1891                     PIC S9(4)   VALUE +1891.
   917     12  ER-1892                     PIC S9(4)   VALUE +1892.
   918     12  ER-1893                     PIC S9(4)   VALUE +1893.
   919     12  ER-1894                     PIC S9(4)   VALUE +1894.
   920     12  ER-1895                     PIC S9(4)   VALUE +1895.
   921     12  ER-1896                     PIC S9(4)   VALUE +1896.
   922     12  ER-1897                     PIC S9(4)   VALUE +1897.
   923     12  ER-1898                     PIC S9(4)   VALUE +1898.
   924     12  ER-1899                     PIC S9(4)   VALUE +1899.
   925     12  ER-1900                     PIC S9(4)   VALUE +1900.
   926     12  ER-1901                     PIC S9(4)   VALUE +1901.
   927     12  ER-1902                     PIC S9(4)   VALUE +1902.
   928     12  ER-1903                     PIC S9(4)   VALUE +1903.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  18
* EL050.cbl
   929     12  ER-1904                     PIC S9(4)   VALUE +1904.
   930     12  ER-1905                     PIC S9(4)   VALUE +1905.
   931     12  ER-1906                     PIC S9(4)   VALUE +1906.
   932     12  ER-1907                     PIC S9(4)   VALUE +1907.
   933     12  ER-1909                     PIC S9(4)   VALUE +1909.
   934     12  ER-1910                     PIC S9(4)   VALUE +1910.
   935     12  ER-1911                     PIC S9(4)   VALUE +1911.
   936     12  ER-1912                     PIC S9(4)   VALUE +1912.
   937     12  ER-1913                     PIC S9(4)   VALUE +1913.
   938     12  ER-1914                     PIC S9(4)   VALUE +1914.
   939     12  ER-1915                     PIC S9(4)   VALUE +1915.
   940     12  ER-1916                     PIC S9(4)   VALUE +1916.
   941     12  ER-1917                     PIC S9(4)   VALUE +1917.
   942     12  ER-1918                     PIC S9(4)   VALUE +1918.
   943     12  ER-1919                     PIC S9(4)   VALUE +1919.
   944     12  ER-1920                     PIC S9(4)   VALUE +1920.
   945     12  ER-1921                     PIC S9(4)   VALUE +1921.
   946     12  ER-1922                     PIC S9(4)   VALUE +1922.
   947     12  ER-1923                     PIC S9(4)   VALUE +1923.
   948     12  ER-1924                     PIC S9(4)   VALUE +1924.
   949     12  ER-1925                     PIC S9(4)   VALUE +1925.
   950     12  ER-1926                     PIC S9(4)   VALUE +1926.
   951     12  ER-1927                     PIC S9(4)   VALUE +1927.
   952     12  ER-2393                     PIC S9(4)   VALUE +2393.
   953     12  ER-2600                     PIC S9(4)   VALUE +2600.
   954     12  ER-2601                     PIC S9(4)   VALUE +2601.
   955     12  ER-2602                     PIC S9(4)   VALUE +2602.
   956     12  ER-2603                     PIC S9(4)   VALUE +2603.
   957     12  ER-2604                     PIC S9(4)   VALUE +2604.
   958     12  ER-2605                     PIC S9(4)   VALUE +2605.
   959     12  ER-2606                     PIC S9(4)   VALUE +2606.
   960     12  ER-2607                     PIC S9(4)   VALUE +2607.
   961     12  ER-2608                     PIC S9(4)   VALUE +2608.
   962     12  ER-2609                     PIC S9(4)   VALUE +2609.
   963     12  ER-2610                     PIC S9(4)   VALUE +2610.
   964     12  ER-2611                     PIC S9(4)   VALUE +2611.
   965     12  ER-2612                     PIC S9(4)   VALUE +2612.
   966     12  ER-2613                     PIC S9(4)   VALUE +2613.
   967     12  ER-2614                     PIC S9(4)   VALUE +2614.
   968     12  ER-2615                     PIC S9(4)   VALUE +2615.
   969     12  ER-2616                     PIC S9(4)   VALUE +2616.
   970     12  ER-2617                     PIC S9(4)   VALUE +2617.
   971     12  ER-2618                     PIC S9(4)   VALUE +2618.
   972     12  ER-2619                     PIC S9(4)   VALUE +2619.
   973     12  ER-2620                     PIC S9(4)   VALUE +2620.
   974     12  ER-2621                     PIC S9(4)   VALUE +2621.
   975     12  ER-2622                     PIC S9(4)   VALUE +2622.
   976     12  ER-2623                     PIC S9(4)   VALUE +2623.
   977     12  ER-2624                     PIC S9(4)   VALUE +2624.
   978     12  ER-2625                     PIC S9(4)   VALUE +2625.
   979     12  ER-2626                     PIC S9(4)   VALUE +2626.
   980     12  ER-2627                     PIC S9(4)   VALUE +2627.
   981     12  ER-2628                     PIC S9(4)   VALUE +2628.
   982     12  ER-2629                     PIC S9(4)   VALUE +2629.
   983     12  ER-2630                     PIC S9(4)   VALUE +2630.
   984     12  ER-2631                     PIC S9(4)   VALUE +2631.
   985     12  ER-2632                     PIC S9(4)   VALUE +2632.
   986     12  ER-2633                     PIC S9(4)   VALUE +2633.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  19
* EL050.cbl
   987     12  ER-2634                     PIC S9(4)   VALUE +2634.
   988     12  ER-2635                     PIC S9(4)   VALUE +2635.
   989     12  ER-2636                     PIC S9(4)   VALUE +2636.
   990     12  ER-2637                     PIC S9(4)   VALUE +2637.
   991     12  ER-2638                     PIC S9(4)   VALUE +2638.
   992     12  ER-2639                     PIC S9(4)   VALUE +2639.
   993     12  ER-2640                     PIC S9(4)   VALUE +2640.
   994     12  ER-2641                     PIC S9(4)   VALUE +2641.
   995     12  ER-2642                     PIC S9(4)   VALUE +2642.
   996     12  ER-2643                     PIC S9(4)   VALUE +2643.
   997     12  ER-2644                     PIC S9(4)   VALUE +2644.
   998     12  ER-2645                     PIC S9(4)   VALUE +2645.
   999     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1000     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1001     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1002     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1003     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1004     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1005     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1006     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1007     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1008     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1009     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1010     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1011     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1012     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1013     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1014     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1015     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1016     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1017     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1018     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1019     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1020     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1021     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1022     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1023     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1024     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1025     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1026     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1027     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1028     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1029     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1030     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1031     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1032     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1033     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1034     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1035     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1036     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1037     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1038     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1039     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1040     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1041     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1042     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1043     12  ER-2690                     PIC S9(4)   VALUE +2690.
  1044     12  ER-2691                     PIC S9(4)   VALUE +2691.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  20
* EL050.cbl
  1045     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1046     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1047     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1048     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1049     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1050     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1051     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1052     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1053     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1054     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1055     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1056     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1057     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1058     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1059     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1060     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1061     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1062     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1063     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1064     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1065     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1066     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1067     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1068     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1069     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1070     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1071     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1072     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1073     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1074     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1075     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1076     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1077     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1078     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1079     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1080     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1081     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1082     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1083     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1084     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1085     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1086     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1087     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1088     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1089     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1090     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1091     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1092     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1093     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1094     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1095     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1096     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1097     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1098     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1099     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1100     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1101     12  ER-2758                     PIC S9(4)   VALUE +2758.
  1102     12  ER-2759                     PIC S9(4)   VALUE +2759.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  21
* EL050.cbl
  1103     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1104     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1105     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1106     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1107     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1108     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1109     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1110     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1111     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1112     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1113     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1114     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1115     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1116     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1117     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1118     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1119     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1120     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1121     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1122     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1123     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1124     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1125     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1126     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1127     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1128     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1129     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1130     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1131     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1132     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1133     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1134     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1135     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1136     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1137     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1138     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1139     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1140     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1141     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1142     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1143     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1144     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1145     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1146     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1147     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1148     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1149     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1150     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1151     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1152     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1153     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1154     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1155     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1156     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1157     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1158     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1159     12  ER-3006                     PIC S9(4)   VALUE +3006.
  1160     12  ER-3049                     PIC S9(4)   VALUE +3049.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  22
* EL050.cbl
  1161     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1162     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1163     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1164     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1165     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1166     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1167     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1168     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1169     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1170     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1171     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1172     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1173     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1174     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1175     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1176     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1177     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1178     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1179     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1180     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1181     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1182     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1183     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1184     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1185     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1186     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1187     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1188     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1189     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1190     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1191     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1192     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1193     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1194     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1195     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1196     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1197     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1198     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1199     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1200     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1201     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1202     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1203     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1204     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1205     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1206     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1207     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1208     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1209     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1210     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1211     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1212     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1213     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1214     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1215     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1216     12  ER-8085                     PIC S9(4)   VALUE +8085.
  1217     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1218     12  ER-8087                     PIC S9(4)   VALUE +8087.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  23
* EL050.cbl
  1219     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1220     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1221     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1222     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1223     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1224     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1225     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1226     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1227     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1228     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1229     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1230     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1231     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1232     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1233     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1234     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1235     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1236     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1237     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1238     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1239     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1240     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1241     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1242     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1243     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1244     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1245     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1246     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1247     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1248     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1249     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1250     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1251     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1252     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1253     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1254     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1255     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1256     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1257     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1258     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1259******************************************************************
  1260***************   END OF ELC50WS     ****************************
  1261******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  24
* EL050.cbl
  1264 01  WORKING-STORAGE-WORK-AREAS.
  1265     12  WS-RESPONSE             PIC S9(8)  COMP.
  1266         88  WS-RESP-NORMAL           VALUE +00.
  1267         88  WS-RESP-ERROR            VALUE +01.
  1268         88  WS-RESP-NOTFND           VALUE +13.
  1269         88  WS-RESP-DUPREC           VALUE +14.
  1270         88  WS-RESP-ENDFILE          VALUE +20.
  1271     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1272     12  WORK-AREAS.
  1273         16  WK-CONV-GREG.
  1274             24  WCG-CENT             PIC XX.
  1275             24  WCG-REST             PIC X(4).
  1276         16  WORK-GREGORIAN-DATE.
  1277             24  WK-GREG-CENT         PIC XX.
  1278             24  WK-GREG-DATE-YYMMDD.
  1279                 28  WK-GREG-YYMM     PIC X(4).
  1280                 28  WK-GREG-DD       PIC XX.
  1281
  1282         16  WORK-SELECT-DATE.
  1283             24  WK-SELECT-CENT            PIC XX.
  1284             24  WK-SELECT-DATE-YYMMDD.
  1285                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1286                 28  FILLER                PIC XX.
  1287
  1288         16  WK-FORM-NO.
  1289             24  WK-FORM-BANK-ID       PIC X(5).
  1290             24  WK-FORM-UNDRWRTR      PIC X(1).
  1291             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1292
  1293         16  WK-MEMBER-NO.
  1294             24  WK-MEMBER-1-6        PIC X(6).
  1295             24  WK-MEMBER-7-12       PIC X(6).
  1296
  1297         16  WK-FULL-CERT-NO.
  1298             24  WK-CERT-POS-1-2      PIC X(2).
  1299             24  WK-CERT-POS-3        PIC X(1).
  1300             24  WK-CERT-POS-4        PIC X(1).
  1301             24  WK-CERT-POS-5-6      PIC X(2).
  1302             24  WK-CERT-POS-7        PIC X(1).
  1303             24  WK-CERT-POS-8-11     PIC X(4).
  1304
  1305         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1306             88  VALID-RATE-CODE        VALUE 'Y'.
  1307             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1308
  1309         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1310         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1311         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1312         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1313         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1314         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1315         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1316         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1317         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1318         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1319
  1320* DLO001
  1321 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  25
* EL050.cbl
  1322     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1323     12  DMPF-RETURN-CODE          PIC XX.
  1324         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1325         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1326         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1327         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1328         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1329         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1330
  1331* DLO002
  1332 01  WS-DLO-INTERNAL-POLICY-FORM.
  1333     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1334     12  DIPF-RETURN-CODE          PIC XX.
  1335         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1336         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1337         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1338         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1339         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1340         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1341
  1342* DLO003
  1343 01  WS-DLO-VALID-BANK-ID.
  1344     12  DVBI-BANK-ID              PIC X(5).
  1345     12  DVBI-BANK-ID-TYPE         PIC X.
  1346         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1347         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1348         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1349         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1350         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1351     12  DVBI-RETURN-CODE          PIC XX.
  1352         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1353         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1354         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1355         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1356         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1357         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1358         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1359         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1360         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1361
  1362* DLO007
  1363 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1364     12  DCUA-RES-STATE            PIC XX.
  1365     12  DCUA-BEN-TYPE             PIC XX.
  1366     12  DCUA-SYS-IDENT            PIC X.
  1367         88  DCUA-CLAIM                        VALUE 'C'.
  1368         88  DCUA-PREMIUM                      VALUE 'P'.
  1369     12  DCUA-COVERAGE-RULE        PIC X.
  1370     12  DCUA-CLIENT-ID            PIC X(10).
  1371     12  DCUA-EFF-DATE             PIC X(8).
  1372     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1373     12  DCUA-RETURN-CODE          PIC XX.
  1374         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1375     12  DCUA-CERT-NUMBER          PIC X(11).
  1376     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1377     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1378
  1379* DLO011
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  26
* EL050.cbl
  1380 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1381     12  DPRB-RATE-CODE            PIC X(4).
  1382     12  DPRB-COVERAGE-CATEG       PIC X.
  1383     12  DPRB-RETURN-CODE          PIC XX.
  1384         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1385         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1386         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1387         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1388         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1389         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1390         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1391         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1392         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1393     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1394     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1395     12  DPRB-BEN-TYPE             PIC XX.
  1396
  1397* DLO017
  1398 01  WS-DLO-VALID-RATE-CODE.
  1399     12  DVRC-RATE-CODE            PIC X(4).
  1400     12  DVRC-RETURN-CODE          PIC XX.
  1401         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1402         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1403         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1404         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1405         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1406         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1407
  1408* DLO019
  1409 01  WS-DLO-ORIG-COV-CAT.
  1410     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1411     12  DOCC-RETURN-CODE          PIC XX.
  1412     12  DOCC-ORIG-COV-CAT         PIC X.
  1413     12  DOCC-UNDERWITER           PIC XX.
  1414     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1415     12  DOCC-FILLER               PIC X(6).
  1416
  1417* DLO021
  1418 01  WS-DLO-VALID-LOAN-OFFICER.
  1419     12  DVLO-LOAN-OFFICER.
  1420         16  DVLO-BILL-TYPE        PIC X.
  1421         16  DVLO-BILL-SOURCE      PIC X.
  1422         16  DVLO-BATCH-TYPE       PIC X.
  1423     12  DVLO-RETURN-CODE          PIC XX.
  1424         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1425         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1426         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1427         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1428         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1429         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1430
  1431* DLO022
  1432 01  WS-DLO-VALID-STATE-CODE.
  1433     12  DVSC-STATE-CODE           PIC XX.
  1434     12  DVSC-RETURN-CODE          PIC XX.
  1435         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1436
  1437* DLO023
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  27
* EL050.cbl
  1438 01  WS-DLO-VALID-CODE-VALUES.
  1439     12  DVCV-SYSTEM-ID            PIC XX.
  1440         88  DVCV-CLAIMS                       VALUE 'CL'.
  1441         88  DVCV-CREDIT                       VALUE 'CR'.
  1442     12  DVCV-RECORD-TYPE          PIC XX.
  1443         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1444         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1445         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1446         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1447         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1448         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1449         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1450         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1451     12  DVCV-RECORD-KEY           PIC X(6).
  1452     12  DVCV-RETURN-CODE          PIC XX.
  1453         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1454         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1455         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1456         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1457         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1458         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1459         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1460     12  DVCV-CODE-DESC            PIC X(60).
  1461     12  DVCV-GEN-DESC-1           PIC X(20).
  1462     12  DVCV-GEN-DESC-2           PIC X(20).
  1463     12  DVCV-GEN-DESC-3           PIC X(20).
  1464
  1465****  this is for aggregate report.
  1466****  Length is erpndb + 100 of passed-key-area
  1467 01  ws-passed-key-length        pic s9(4) comp value +587.
  1468 01  ws-pass-to-pemaggo.
  1469     05  ws-passed-erpndb        pic x(585).
  1470     05  ws-exceed-limit-yn      pic x.
  1471     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  28
* EL050.cbl
  1473*    COPY ERCBXRF.
  1474******************************************************************
  1475*                                                                *
  1476*                                                                *
  1477*                            ERCBXRF                             *
  1478*                                                                *
  1479*   ONLINE CREDIT SYSTEM                                         *
  1480*                                                                *
  1481*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1482*                                                                *
  1483*   FILE TYPE = VSAM,KSDS                                        *
  1484*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1485*                                                                *
  1486*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1487*       ALTERNATE PATH = NONE                                    *
  1488*                                                                *
  1489*   LOG = NO                                                     *
  1490*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1491*                                                                *
  1492******************************************************************
  1493
  1494 01  BANK-CROSS-REFERENCE.
  1495     12  BK-RECORD-ID                PIC XX.
  1496         88  VALID-BK-ID             VALUE 'BK'.
  1497
  1498     12  BK-CONTROL-PRIMARY.
  1499         16  BK-COMPANY-CD           PIC X.
  1500         16  BK-CARRIER              PIC X.
  1501         16  BK-GROUPING             PIC X(6).
  1502         16  BK-BANK-NO              PIC X(10).
  1503
  1504     12  BK-MAINT-INFORMATION.
  1505         16  BK-LAST-MAINT-DT        PIC XX.
  1506         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1507         16  BK-LAST-MAINT-USER      PIC X(4).
  1508         16  FILLER                  PIC X(9).
  1509
  1510     12  FILLER                      PIC X(37).
  1511
  1512     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1513
  1514     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1515                            DEPENDING ON BK-BANK-POINTER-CNT.
  1516         16  BK-AM-ACCOUNT           PIC X(10).
  1517         16  BK-AM-EXP-DT            PIC XX.
  1518         16  BK-AM-EFF-DT            PIC XX.
  1519         16  BK-AM-STATE             PIC XX.
  1520         16  FILLER                  PIC X(20).
  1521
  1522******************************************************************
  1523
  1524*    COPY ERCCOMP.
  1525******************************************************************
  1526*                                                                *
  1527*                                                                *
  1528*                            ERCCOMP                             *
  1529*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1530*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  29
* EL050.cbl
  1531*                                                                *
  1532*   ONLINE CREDIT SYSTEM                                         *
  1533*                                                                *
  1534*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1535*                                                                *
  1536*   FILE TYPE = VSAM,KSDS                                        *
  1537*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1538*                                                                *
  1539*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1540*       ALTERNATE PATH = NONE                                    *
  1541*                                                                *
  1542*   LOG = NO                                                     *
  1543*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1544*                                                                *
  1545******************************************************************
  1546*                   C H A N G E   L O G
  1547*
  1548* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1549*-----------------------------------------------------------------
  1550*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1551* EFFECTIVE    NUMBER
  1552*-----------------------------------------------------------------
  1553* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1554* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1555* 092205    2005050300006  PEMA  ADD LEASE FEE
  1556* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1557* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1558* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1559* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1560* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1561* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1562******************************************************************
  1563
  1564 01  COMPENSATION-MASTER.
  1565     12  CO-RECORD-ID                          PIC XX.
  1566         88  VALID-CO-ID                          VALUE 'CO'.
  1567
  1568     12  CO-CONTROL-PRIMARY.
  1569         16  CO-COMPANY-CD                     PIC X.
  1570         16  CO-CONTROL.
  1571             20  CO-CTL-1.
  1572                 24  CO-CARR-GROUP.
  1573                     28  CO-CARRIER            PIC X.
  1574                     28  CO-GROUPING.
  1575                         32  CO-GROUP-PREFIX   PIC XXX.
  1576                         32  CO-GROUP-PRIME    PIC XXX.
  1577                 24  CO-RESP-NO.
  1578                     28  CO-RESP-PREFIX        PIC X(4).
  1579                     28  CO-RESP-PRIME         PIC X(6).
  1580             20  CO-CTL-2.
  1581                 24  CO-ACCOUNT.
  1582                     28  CO-ACCT-PREFIX        PIC X(4).
  1583                     28  CO-ACCT-PRIME         PIC X(6).
  1584         16  CO-TYPE                           PIC X.
  1585             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1586             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1587             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1588
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  30
* EL050.cbl
  1589     12  CO-MAINT-INFORMATION.
  1590         16  CO-LAST-MAINT-DT                  PIC XX.
  1591         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1592         16  CO-LAST-MAINT-USER                PIC X(4).
  1593     12  FILLER                                PIC XX.
  1594     12  CO-STMT-TYPE                          PIC XXX.
  1595     12  CO-COMP-TYPE                          PIC X.
  1596         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1597     12  CO-STMT-OWNER                         PIC X(4).
  1598     12  CO-BALANCE-CONTROL                    PIC X.
  1599         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1600         88  CO-NO-BALANCE                        VALUE 'N'.
  1601
  1602     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1603         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1604         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1605         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1606
  1607     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1608         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1609         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1610
  1611     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1612     12  CO-GA-DIRECT-DEP                      PIC X.
  1613     12  CO-FUTURE-SPACE                       PIC X.
  1614         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1615
  1616     12  CO-ACCT-NAME                          PIC X(30).
  1617     12  CO-MAIL-NAME                          PIC X(30).
  1618     12  CO-ADDR-1                             PIC X(30).
  1619     12  CO-ADDR-2                             PIC X(30).
  1620     12  CO-ADDR-3.
  1621         16  CO-ADDR-CITY                      PIC X(27).
  1622         16  CO-ADDR-STATE                     PIC XX.
  1623     12  CO-CSO-1099                           PIC X.
  1624     12  CO-ZIP.
  1625         16  CO-ZIP-PRIME.
  1626             20  CO-ZIP-PRI-1ST                PIC X.
  1627                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1628             20  FILLER                        PIC X(4).
  1629         16  CO-ZIP-PLUS4                      PIC X(4).
  1630     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1631         16  CO-CAN-POSTAL-1                   PIC XXX.
  1632         16  CO-CAN-POSTAL-2                   PIC XXX.
  1633         16  FILLER                            PIC XXX.
  1634     12  CO-SOC-SEC                            PIC X(13).
  1635     12  CO-TELEPHONE.
  1636         16  CO-AREA-CODE                      PIC XXX.
  1637         16  CO-PREFIX                         PIC XXX.
  1638         16  CO-PHONE                          PIC X(4).
  1639
  1640     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1641
  1642     12  CO-AR-BAL-LEVEL                       PIC X.
  1643         88  CO-AR-REF-LVL                        VALUE '1'.
  1644         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1645         88  CO-AR-BILL-LVL                       VALUE '2'.
  1646         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  31
* EL050.cbl
  1647         88  CO-AR-FR-LVL                         VALUE '4'.
  1648
  1649     12  CO-AR-NORMAL-PRINT                    PIC X.
  1650         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1651         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1652
  1653     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1654
  1655     12  CO-AR-REPORTING                       PIC X.
  1656         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1657         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1658
  1659     12  CO-AR-PULL-CHECK                      PIC X.
  1660         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1661         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1662
  1663     12  CO-AR-BALANCE-PRINT                   PIC X.
  1664         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1665
  1666     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1667         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1668         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1669         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1670
  1671     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1672
  1673     12  CO-USER-CODE                          PIC X.
  1674     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1675
  1676******************************************************************
  1677*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1678*    THE LAST MONTH END RUN.
  1679******************************************************************
  1680
  1681     12  CO-LAST-ACTIVITY-DATE.
  1682         16  CO-ACT-YEAR                       PIC 99.
  1683         16  CO-ACT-MONTH                      PIC 99.
  1684         16  CO-ACT-DAY                        PIC 99.
  1685
  1686     12  CO-LAST-STMT-DT.
  1687         16  CO-LAST-STMT-YEAR                 PIC 99.
  1688         16  CO-LAST-STMT-MONTH                PIC 99.
  1689         16  CO-LAST-STMT-DAY                  PIC 99.
  1690
  1691     12  CO-MO-END-TOTALS.
  1692         16  CO-MONTHLY-TOTALS.
  1693             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1694             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1695             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1696             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1697             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1698
  1699         16  CO-AGING-TOTALS.
  1700             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1701             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1702             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1703             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1704
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  32
* EL050.cbl
  1705         16  CO-YTD-TOTALS.
  1706             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1707             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1708
  1709         16  CO-OVER-UNDER-TOTALS.
  1710             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1711             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1712
  1713     12  CO-MISCELLANEOUS-TOTALS.
  1714         16  CO-FICA-TOTALS.
  1715             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1716             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1717
  1718         16  CO-CLAIM-TOTALS.
  1719             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1720             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1721
  1722******************************************************************
  1723*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1724*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1725******************************************************************
  1726
  1727     12  CO-CURRENT-TOTALS.
  1728         16  CO-CURRENT-LAST-STMT-DT.
  1729             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1730             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1731             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1732
  1733         16  CO-CURRENT-MONTHLY-TOTALS.
  1734             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1735             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1736             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1737             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1738             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1739
  1740         16  CO-CURRENT-AGING-TOTALS.
  1741             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1742             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1743             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1744             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1745
  1746         16  CO-CURRENT-YTD-TOTALS.
  1747             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1748             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1749
  1750     12  CO-PAID-COMM-TOTALS.
  1751         16  CO-YTD-PAID-COMMS.
  1752             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1753             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1754
  1755     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1756         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1757         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1758
  1759     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1760         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1761         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1762         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  33
* EL050.cbl
  1763         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1764         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1765         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1766         88  CO-FINAL-LETTER                  VALUE 'F'.
  1767         88  CO-RECONCILING                   VALUE 'R'.
  1768         88  CO-PHONE-CALL                    VALUE 'P'.
  1769         88  CO-LEGAL                         VALUE 'L'.
  1770         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1771         88  CO-WRITE-OFF                     VALUE 'W'.
  1772         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1773
  1774     12  CO-CSR-CODE                       PIC X(4).
  1775
  1776     12  CO-GA-STATUS-INFO.
  1777         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1778         16  CO-GA-TERMINATION-DT          PIC XX.
  1779         16  CO-GA-STATUS-CODE             PIC X.
  1780             88  CO-GA-ACTIVE                 VALUE 'A'.
  1781             88  CO-GA-INACTIVE               VALUE 'I'.
  1782             88  CO-GA-PENDING                VALUE 'P'.
  1783         16  CO-GA-COMMENTS.
  1784             20  CO-GA-COMMENT-1           PIC X(40).
  1785             20  CO-GA-COMMENT-2           PIC X(40).
  1786             20  CO-GA-COMMENT-3           PIC X(40).
  1787             20  CO-GA-COMMENT-4           PIC X(40).
  1788
  1789     12  CO-RPTCD2                         PIC X(10).
  1790     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1791         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1792         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1793
  1794     12  CO-TYPE-AGENT                     PIC X(01).
  1795         88  CO-CORPORATION                   VALUE 'C'.
  1796         88  CO-PARTNERSHIP                   VALUE 'P'.
  1797         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1798         88  CO-TRUST                         VALUE 'T'.
  1799         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1800
  1801     12  CO-FAXNO.
  1802         16  CO-FAX-AREA-CODE                  PIC XXX.
  1803         16  CO-FAX-PREFIX                     PIC XXX.
  1804         16  CO-FAX-PHONE                      PIC X(4).
  1805
  1806     12  CO-BANK-INFORMATION.
  1807         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1808         16  CO-BANK-TRANSIT-NON REDEFINES
  1809             CO-BANK-TRANSIT-NO                PIC 9(8).
  1810
  1811         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1812     12  CO-MISC-DEDUCT-INFO REDEFINES
  1813                  CO-BANK-INFORMATION.
  1814         16  CO-MD-GL-ACCT                     PIC X(10).
  1815         16  CO-MD-DIV                         PIC XX.
  1816         16  CO-MD-CENTER                      PIC X(4).
  1817         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1818         16  CO-CREATE-AP-CHECK                PIC X.
  1819         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1820         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  34
* EL050.cbl
  1821     12  CO-ACH-STATUS                         PIC X.
  1822         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1823         88  CO-ACH-PENDING                        VALUE 'P'.
  1824
  1825     12  CO-BILL-SW                            PIC X.
  1826     12  CO-CONTROL-NAME                       PIC X(30).
  1827     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1828     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1829     12  CO-CLP-STATE                          PIC XX.
  1830     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1831     12  CO-SPP-REFUND-EDIT                    PIC X.
  1832
  1833******************************************************************
  1834
  1835*    COPY ERCAGTC.
  1836******************************************************************
  1837*                                                                *
  1838*                                                                *
  1839*                            ERCAGTC                             *
  1840*                            VMOD=2.001                          *
  1841*                                                                *
  1842*   ONLINE CREDIT SYSTEM                                         *
  1843*                                                                *
  1844*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1845*                                                                *
  1846*   FILE TYPE = VSAM,KSDS                                        *
  1847*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1848*                                                                *
  1849*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1850*       ALTERNATE PATH = NONE                                    *
  1851*                                                                *
  1852*   LOG = NO                                                     *
  1853*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1854*                                                                *
  1855******************************************************************
  1856*                   C H A N G E   L O G
  1857*
  1858* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1859*-----------------------------------------------------------------
  1860*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1861* EFFECTIVE    NUMBER
  1862*-----------------------------------------------------------------
  1863* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1864* 111004                         NEW FILE AND COPYBOOK
  1865* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1866******************************************************************
  1867 01  AGENT-COMMISSIONS.
  1868     12  AG-RECORD-ID                          PIC XX.
  1869         88  VALID-CO-ID                          VALUE 'AG'.
  1870     12  AG-CONTROL-PRIMARY.
  1871         16  AG-COMPANY-CD                     PIC X.
  1872         16  AG-CONTROL.
  1873             20  AG-CTL-1.
  1874                 24  AG-CARR-GROUP.
  1875                     28  AG-CARRIER            PIC X.
  1876                     28  AG-GROUPING           PIC X(6).
  1877                 24  AG-BANK                   PIC X(10).
  1878             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  35
* EL050.cbl
  1879                 24  AG-EXP-DT                 PIC XX.
  1880         16  AG-TYPE                           PIC X.
  1881             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1882             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1883     12  AG-MAINT-INFORMATION.
  1884         16  AG-LAST-MAINT-DT                  PIC XX.
  1885         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1886         16  AG-LAST-MAINT-USER                PIC X(4).
  1887         16  FILLER                            PIC X(10).
  1888     12  AG-EFF-DT                             PIC XX.
  1889     12  AG-COMM-STRUCTURE.
  1890         16  AG-AGT-COMMS OCCURS 10.
  1891             20  AG-AGT                PIC X(10).
  1892             20  AG-COM-TYP            PIC X.
  1893             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1894             20  AG-RECALC-LV-INDIC    PIC X.
  1895             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1896             20  AG-LRCALC-LV-INDIC    PIC X.
  1897             20  FILLER                PIC X(05).
  1898     12  FILLER                  PIC X(145).
  1899******************************************************************
  1900*    COPY ERCRESS.
  1901******************************************************************
  1902*                                                                *
  1903*                            ERCRESS                             *
  1904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1905*                            VMOD=2.002                          *
  1906*                                                                *
  1907*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1908*                                                                *
  1909*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1910*   VSAM RESIDENT STATE TAX MASTER                              *
  1911*                                                                *
  1912*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1913*                                                                *
  1914*   FILE TYPE = VSAM,KSDS                                        *
  1915*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1916*                                                                *
  1917*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1918*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1919*                                                                *
  1920*   LOG = NO                                                     *
  1921*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1922*                                                                *
  1923*                                                                *
  1924******************************************************************
  1925
  1926 01  RESIDENT-STATE-TAX-MASTER.
  1927
  1928     10  ERRESS-PRIMARY-KEY.
  1929         15  RES-COMPANY-CD        PIC X.
  1930         15  RES-RESIDENT-STATE    PIC XX.
  1931         15  RES-COVERAGE-CATEGORY PIC X.
  1932         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1933*                                      YYYYMMDD
  1934*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1935
  1936     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  36
* EL050.cbl
  1937
  1938         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1939         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1940         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1941         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1942
  1943     10 RES-RECALC-SW              PIC   X.
  1944         88 RECALC                VALUE 'Y'.
  1945         88 NO-RECALC             VALUE 'N'.
  1946     10  RES-MAINT-BY              PIC X(4).
  1947     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1948     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1949*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  37
* EL050.cbl
  1951*    COPY ERCRESC.
  1952******************************************************************
  1953*                                                                *
  1954*                            ERCRESC                             *
  1955*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1956*                            VMOD=2.003                          *
  1957*                                                                *
  1958*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1959*                                                                *
  1960*   FILE TYPE = VSAM,KSDS                                        *
  1961*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1962*                                                                *
  1963*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1964*       ALTERNATE PATH1 = NONE                                   *
  1965*                                                                *
  1966*   LOG = NO                                                     *
  1967*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1968*                                                                *
  1969******************************************************************
  1970
  1971 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1972
  1973     10  ERRESC-RECORD-KEY.
  1974         15  RESC-COMPANY-CD           PIC   X.
  1975         15  RESC-CARRIER              PIC   X.
  1976         15  RESC-GROUP                PIC   X(6).
  1977         15  RESC-STATE                PIC   XX.
  1978         15  RESC-ACCOUNT              PIC   X(10).
  1979         15  RESC-AGENT                PIC   X(10).
  1980         15  RESC-RESIDENT-STATE       PIC   XX.
  1981         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1982*                                           YYYYMMDD
  1983     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1984
  1985     10  RESC-COMM-RECORD-DATA.
  1986         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1987             20 RESC-COVERAGE-CAT      PIC    X.
  1988             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1989             20 RESC-COMMISSION-TAB REDEFINES
  1990                RESC-COMMISSION-PER    PIC  XXX.
  1991
  1992     10  RESC-MAINT-BY                 PIC X(4).
  1993     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1994     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1995*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  38
* EL050.cbl
  1997*    COPY ERCPLAN.
  1998******************************************************************
  1999*                                                                *
  2000*                                                                *
  2001*                            ERCPLAN                             *
  2002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2003*                            VMOD=2.003                          *
  2004*                                                                *
  2005*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2006*                                                                *
  2007*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2008*   PLAN MASTER                                                  *
  2009*                                                                *
  2010*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2011*                                                                *
  2012*   FILE TYPE = VSAM,KSDS                                        *
  2013*   RECORD SIZE = 420   RECFORM = FIX                            *
  2014*                                                                *
  2015*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2016*       ALTERNATE PATH1 = N/A                                    *
  2017*                                                                *
  2018*   LOG = NO                                                     *
  2019*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2020*                                                                *
  2021*                                                                *
  2022******************************************************************
  2023
  2024 01  PLAN-MASTER.
  2025     12  PL-RECORD-ID                      PIC XX.
  2026         88  VALID-PL-ID                      VALUE 'PL'.
  2027
  2028     12  PL-CONTROL-PRIMARY.
  2029         16  PL-COMPANY-CD                 PIC X.
  2030         16  PL-MSTR-CNTRL.
  2031             20  PL-CONTROL-A.
  2032                 24  PL-CARRIER            PIC X.
  2033                 24  PL-GROUPING           PIC X(6).
  2034                 24  PL-STATE              PIC XX.
  2035                 24  PL-ACCOUNT            PIC X(10).
  2036             20  PL-BENEFIT-TYPE           PIC X.
  2037             20  PL-BENEFIT-CODE           PIC XX.
  2038             20  PL-REVISION-NO            PIC X(3).
  2039
  2040     12  PL-CONTROL-BY-VAR-GRP.
  2041         16  PL-COMPANY-CD-A1              PIC X.
  2042         16  PL-VG-CARRIER                 PIC X.
  2043         16  PL-VG-GROUPING                PIC X(6).
  2044         16  PL-VG-STATE                   PIC XX.
  2045         16  PL-VG-ACCOUNT                 PIC X(10).
  2046         16  PL-BENEFIT-TYPE-A1            PIC X.
  2047         16  PL-BENEFIT-CODE-A1            PIC XX.
  2048         16  PL-REVISION-NO-A1             PIC 999.
  2049
  2050     12  PL-MAINT-INFORMATION.
  2051         16  PL-LAST-MAINT-DT              PIC XX.
  2052         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2053         16  PL-LAST-MAINT-USER            PIC X(4).
  2054         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  39
* EL050.cbl
  2055
  2056     12  PL-LIABILITY-LIMITS.
  2057         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2058         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2059             20  PL-LM-AGE                 PIC S99        COMP-3.
  2060             20  PL-LM-DUR                 PIC S999       COMP-3.
  2061             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2062             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2063
  2064     12  FILLER                            PIC X(30).
  2065
  2066     12  PL-GL-ACCOUNT-NOS.
  2067         16  PL-PREMIUM-GL                 PIC X(8).
  2068         16  PL-COMM-GL                    PIC X(8).
  2069         16  PL-CLAIM-GL                   PIC X(8).
  2070     12  FILLER                            PIC X(24).
  2071     12  PL-TOLERANCES.
  2072         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2073         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2074         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2075         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2076         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2077         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2078     12  PL-OVER-SHORT.
  2079         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2080         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2081     12  FILLER                            PIC X(24).
  2082     12  PLAN-MISC.
  2083         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2084         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2085         16  PL-IG                         PIC X.
  2086         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2087         16  PL-POLICY-FORM                PIC X(12).
  2088         16  PL-EDIT-FOR-FORM              PIC X(01).
  2089         16  PL-DEV-CODE                   PIC XXX.
  2090         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2091         16  PL-CALC-METHOD                PIC X.
  2092         16  PL-BENEFIT-GROUP              PIC X(05).
  2093         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2094
  2095         16  FILLER                        PIC X(99).
  2096******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  40
* EL050.cbl
  2098*    COPY ELCCERT.
  2099******************************************************************
  2100*                                                                *
  2101*                            ELCCERT.                            *
  2102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2103*                            VMOD=2.013                          *
  2104*                                                                *
  2105*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2106*                                                                *
  2107*   FILE TYPE = VSAM,KSDS                                        *
  2108*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2109*                                                                *
  2110*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2111*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2112*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2113*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2114*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2115*                                                                *
  2116*   LOG = YES                                                    *
  2117*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2118******************************************************************
  2119*                   C H A N G E   L O G
  2120*
  2121* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2122*-----------------------------------------------------------------
  2123*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2124* EFFECTIVE    NUMBER
  2125*-----------------------------------------------------------------
  2126* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2127* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2128* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2129* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2130* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2131* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2132* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2133* 032612  CR2011110200001  PEMA  AHL CHANGES
  2134* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2135******************************************************************
  2136
  2137 01  CERTIFICATE-MASTER.
  2138     12  CM-RECORD-ID                      PIC XX.
  2139         88  VALID-CM-ID                      VALUE 'CM'.
  2140
  2141     12  CM-CONTROL-PRIMARY.
  2142         16  CM-COMPANY-CD                 PIC X.
  2143         16  CM-CARRIER                    PIC X.
  2144         16  CM-GROUPING.
  2145             20  CM-GROUPING-PREFIX        PIC X(3).
  2146             20  CM-GROUPING-PRIME         PIC X(3).
  2147         16  CM-STATE                      PIC XX.
  2148         16  CM-ACCOUNT.
  2149             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2150             20  CM-ACCOUNT-PRIME          PIC X(6).
  2151         16  CM-CERT-EFF-DT                PIC XX.
  2152         16  CM-CERT-NO.
  2153             20  CM-CERT-PRIME             PIC X(10).
  2154             20  CM-CERT-SFX               PIC X.
  2155
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  41
* EL050.cbl
  2156     12  CM-CONTROL-BY-NAME.
  2157         16  CM-COMPANY-CD-A1              PIC X.
  2158         16  CM-INSURED-LAST-NAME          PIC X(15).
  2159         16  CM-INSURED-INITIALS.
  2160             20  CM-INSURED-INITIAL1       PIC X.
  2161             20  CM-INSURED-INITIAL2       PIC X.
  2162
  2163     12  CM-CONTROL-BY-SSN.
  2164         16  CM-COMPANY-CD-A2              PIC X.
  2165         16  CM-SOC-SEC-NO.
  2166             20  CM-SSN-STATE              PIC XX.
  2167             20  CM-SSN-ACCOUNT            PIC X(6).
  2168             20  CM-SSN-LN3.
  2169                 25  CM-INSURED-INITIALS-A2.
  2170                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2171                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2172                 25 CM-PART-LAST-NAME-A2         PIC X.
  2173
  2174     12  CM-CONTROL-BY-CERT-NO.
  2175         16  CM-COMPANY-CD-A4              PIC X.
  2176         16  CM-CERT-NO-A4                 PIC X(11).
  2177
  2178     12  CM-CONTROL-BY-MEMB.
  2179         16  CM-COMPANY-CD-A5              PIC X.
  2180         16  CM-MEMBER-NO.
  2181             20  CM-MEMB-STATE             PIC XX.
  2182             20  CM-MEMB-ACCOUNT           PIC X(6).
  2183             20  CM-MEMB-LN4.
  2184                 25  CM-INSURED-INITIALS-A5.
  2185                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2186                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2187                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2188
  2189     12  CM-INSURED-PROFILE-DATA.
  2190         16  CM-INSURED-FIRST-NAME.
  2191             20  CM-INSURED-1ST-INIT       PIC X.
  2192             20  FILLER                    PIC X(9).
  2193         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2194         16  CM-INSURED-SEX                PIC X.
  2195             88  CM-SEX-MALE                  VALUE 'M'.
  2196             88  CM-SEX-FEMAL                 VALUE 'F'.
  2197         16  CM-INSURED-JOINT-AGE          PIC 99.
  2198         16  CM-JOINT-INSURED-NAME.
  2199             20  CM-JT-LAST-NAME           PIC X(15).
  2200             20  CM-JT-FIRST-NAME.
  2201                 24  CM-JT-1ST-INIT        PIC X.
  2202                 24  FILLER                PIC X(9).
  2203             20  CM-JT-INITIAL             PIC X.
  2204
  2205     12  CM-LIFE-DATA.
  2206         16  CM-LF-BENEFIT-CD              PIC XX.
  2207         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2208         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2209         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2210         16  CM-LF-DEV-CODE                PIC XXX.
  2211         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2212         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2213         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  42
* EL050.cbl
  2214         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2215         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2216         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2217         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2218         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2219         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2220         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2221         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2222         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2223         16  cm-temp-epiq                  pic xx.
  2224             88  EPIQ-CLASS                  value 'EQ'.
  2225*        16  FILLER                        PIC XX.
  2226
  2227     12  CM-AH-DATA.
  2228         16  CM-AH-BENEFIT-CD              PIC XX.
  2229         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2230         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2231         16  CM-AH-DEV-CODE                PIC XXX.
  2232         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2233         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2234         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2235         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2236         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2237         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2238         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2239         16  CM-AH-PAID-THRU-DT            PIC XX.
  2240             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2241         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2242         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2243         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2244         16  FILLER                        PIC X.
  2245
  2246     12  CM-LOAN-INFORMATION.
  2247         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2248         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2249                                           PIC S9(5)V99  COMP-3.
  2250         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2251         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2252         16  CM-PAY-FREQUENCY              PIC S99.
  2253         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2254         16  CM-RATE-CLASS                 PIC XX.
  2255         16  CM-BENEFICIARY                PIC X(25).
  2256         16  CM-POLICY-FORM-NO             PIC X(12).
  2257         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2258         16  CM-LAST-ADD-ON-DT             PIC XX.
  2259         16  CM-DEDUCTIBLE-AMOUNTS.
  2260             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2261             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2262         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2263             20  CM-RESIDENT-STATE         PIC XX.
  2264             20  CM-RATE-CODE              PIC X(4).
  2265             20  FILLER                    PIC XX.
  2266         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2267             20  CM-LOAN-OFFICER           PIC X(5).
  2268             20  FILLER                    PIC XXX.
  2269         16  CM-CSR-CODE                   PIC XXX.
  2270         16  CM-UNDERWRITING-CODE          PIC X.
  2271             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  43
* EL050.cbl
  2272         16  CM-POST-CARD-IND              PIC X.
  2273         16  CM-NH-INTERFACE-SW            PIC X.
  2274         16  CM-PREMIUM-TYPE               PIC X.
  2275             88  CM-SING-PRM                  VALUE '1'.
  2276             88  CM-O-B-COVERAGE              VALUE '2'.
  2277             88  CM-OPEN-END                  VALUE '3'.
  2278         16  CM-IND-GRP-TYPE               PIC X.
  2279             88  CM-INDIVIDUAL                VALUE 'I'.
  2280             88  CM-GROUP                     VALUE 'G'.
  2281         16  CM-SKIP-CODE                  PIC X.
  2282             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2283             88  SKIP-JULY                    VALUE '1'.
  2284             88  SKIP-AUGUST                  VALUE '2'.
  2285             88  SKIP-SEPTEMBER               VALUE '3'.
  2286             88  SKIP-JULY-AUG                VALUE '4'.
  2287             88  SKIP-AUG-SEPT                VALUE '5'.
  2288             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2289             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2290             88  SKIP-JUNE                    VALUE '8'.
  2291             88  SKIP-JUNE-JULY               VALUE '9'.
  2292             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2293             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2294         16  CM-PAYMENT-MODE               PIC X.
  2295             88  PAY-MONTHLY                  VALUE SPACE.
  2296             88  PAY-WEEKLY                   VALUE '1'.
  2297             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2298             88  PAY-BI-WEEKLY                VALUE '3'.
  2299             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2300         16  CM-LOAN-NUMBER                PIC X(8).
  2301         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2302         16  CM-OLD-LOF                    PIC XXX.
  2303*        16  CM-LOAN-OFFICER               PIC XXX.
  2304         16  CM-REIN-TABLE                 PIC XXX.
  2305         16  CM-SPECIAL-REIN-CODE          PIC X.
  2306         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2307         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2308         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2309
  2310     12  CM-STATUS-DATA.
  2311         16  CM-ENTRY-STATUS               PIC X.
  2312         16  CM-ENTRY-DT                   PIC XX.
  2313
  2314         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2315         16  CM-LF-CANCEL-DT               PIC XX.
  2316         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2317
  2318         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2319         16  CM-LF-DEATH-DT                PIC XX.
  2320         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2321
  2322         16  CM-LF-CURRENT-STATUS          PIC X.
  2323             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2324                                                'M' '4' '5' '9'.
  2325             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2326             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2327             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2328             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2329             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  44
* EL050.cbl
  2330             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2331             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2332             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2333             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2334             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2335             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2336             88  CM-LF-DECLINED               VALUE 'D'.
  2337             88  CM-LF-VOIDED                 VALUE 'V'.
  2338
  2339         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2340         16  CM-AH-CANCEL-DT               PIC XX.
  2341         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2342
  2343         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2344         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2345         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2346
  2347         16  CM-AH-CURRENT-STATUS          PIC X.
  2348             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2349                                                'M' '4' '5' '9'.
  2350             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2351             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2352             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2353             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2354             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2355             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2356             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2357             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2358             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2359             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2360             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2361             88  CM-AH-DECLINED               VALUE 'D'.
  2362             88  CM-AH-VOIDED                 VALUE 'V'.
  2363
  2364         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2365             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2366             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2367             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2368         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2369
  2370         16  CM-ENTRY-BATCH                PIC X(6).
  2371         16  CM-LF-EXIT-BATCH              PIC X(6).
  2372         16  CM-AH-EXIT-BATCH              PIC X(6).
  2373         16  CM-LAST-MONTH-END             PIC XX.
  2374
  2375     12  CM-NOTE-SW                        PIC X.
  2376         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2377         88  CERT-NOTES-PRESENT               VALUE '1'.
  2378         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2379         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2380         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2381         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2382         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2383         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2384     12  CM-COMP-EXCP-SW                   PIC X.
  2385         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2386         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2387     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  45
* EL050.cbl
  2388         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2389         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2390
  2391*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2392     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2393     12  FILLER                            PIC X.
  2394
  2395*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2396     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2397     12  FILLER                            PIC X.
  2398*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2399     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2400
  2401     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2402         88  CERT-ADDED-BATCH                 VALUE ' '.
  2403         88  CERT-ADDED-ONLINE                VALUE '1'.
  2404         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2405         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2406         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2407     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2408         88  CERT-AS-LOADED                   VALUE ' '.
  2409         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2410         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2411         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2412         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2413         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2414         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2415         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2416
  2417     12  CM-ACCOUNT-COMM-PCTS.
  2418         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2419         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2420
  2421     12  CM-USER-FIELD                     PIC X.
  2422     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2423     12  CM-CLP-STATE                      PIC XX.
  2424     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2425     12  CM-USER-RESERVED                  PIC XXX.
  2426     12  FILLER REDEFINES CM-USER-RESERVED.
  2427         16  CM-AH-CLASS-CD                PIC XX.
  2428         16  F                             PIC X.
  2429******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  46
* EL050.cbl
  2431*    COPY ERCMAIL.
  2432******************************************************************
  2433*                                                                *
  2434*                                                                *
  2435*                            ERCMAIL                             *
  2436*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2437*                            VMOD=2.003                          *
  2438*                                                                *
  2439*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2440*                                                                *
  2441*   FILE TYPE = VSAM,KSDS                                        *
  2442*   RECORD SIZE = 374   RECFORM = FIX                            *
  2443*                                                                *
  2444*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2445*   ALTERNATE PATH    = NOT USED                                 *
  2446*                                                                *
  2447*   LOG = YES                                                    *
  2448*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2449******************************************************************
  2450*                   C H A N G E   L O G
  2451*
  2452* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2453*-----------------------------------------------------------------
  2454*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2455* EFFECTIVE    NUMBER
  2456*-----------------------------------------------------------------
  2457* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2458* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2459* 111108                   PEMA  ADD CRED BENE ADDR2
  2460******************************************************************
  2461
  2462 01  MAILING-DATA.
  2463     12  MA-RECORD-ID                      PIC XX.
  2464         88  VALID-MA-ID                       VALUE 'MA'.
  2465
  2466     12  MA-CONTROL-PRIMARY.
  2467         16  MA-COMPANY-CD                 PIC X.
  2468         16  MA-CARRIER                    PIC X.
  2469         16  MA-GROUPING.
  2470             20  MA-GROUPING-PREFIX        PIC XXX.
  2471             20  MA-GROUPING-PRIME         PIC XXX.
  2472         16  MA-STATE                      PIC XX.
  2473         16  MA-ACCOUNT.
  2474             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2475             20  MA-ACCOUNT-PRIME          PIC X(6).
  2476         16  MA-CERT-EFF-DT                PIC XX.
  2477         16  MA-CERT-NO.
  2478             20  MA-CERT-PRIME             PIC X(10).
  2479             20  MA-CERT-SFX               PIC X.
  2480
  2481     12  FILLER                            PIC XX.
  2482
  2483     12  MA-ACCESS-CONTROL.
  2484         16  MA-SOURCE-SYSTEM              PIC XX.
  2485             88  MA-FROM-CREDIT                VALUE 'CR'.
  2486             88  MA-FROM-VSI                   VALUE 'VS'.
  2487             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2488             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  47
* EL050.cbl
  2489         16  MA-RECORD-ADD-DT              PIC XX.
  2490         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2491         16  MA-LAST-MAINT-DT              PIC XX.
  2492         16  MA-LAST-MAINT-BY              PIC XXXX.
  2493         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2494
  2495     12  MA-PROFILE-INFO.
  2496         16  MA-QUALIFY-CODE-1             PIC XX.
  2497         16  MA-QUALIFY-CODE-2             PIC XX.
  2498         16  MA-QUALIFY-CODE-3             PIC XX.
  2499         16  MA-QUALIFY-CODE-4             PIC XX.
  2500         16  MA-QUALIFY-CODE-5             PIC XX.
  2501
  2502         16  MA-INSURED-LAST-NAME          PIC X(15).
  2503         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2504         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2505         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2506         16  MA-INSURED-BIRTH-DT           PIC XX.
  2507         16  MA-INSURED-SEX                PIC X.
  2508             88  MA-SEX-MALE                   VALUE 'M'.
  2509             88  MA-SEX-FEMALE                 VALUE 'F'.
  2510         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2511
  2512         16  MA-ADDRESS-CORRECTED          PIC X.
  2513         16  MA-JOINT-BIRTH-DT             PIC XX.
  2514*        16  FILLER                        PIC X(12).
  2515
  2516         16  MA-ADDRESS-LINE-1             PIC X(30).
  2517         16  MA-ADDRESS-LINE-2             PIC X(30).
  2518         16  MA-CITY-STATE.
  2519             20  MA-CITY                   PIC X(28).
  2520             20  MA-ADDR-STATE             PIC XX.
  2521         16  MA-ZIP.
  2522             20  MA-ZIP-CODE.
  2523                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2524                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2525                 24  FILLER                PIC X(4).
  2526             20  MA-ZIP-PLUS4              PIC X(4).
  2527         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2528             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2529             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2530             20  FILLER                    PIC X(3).
  2531
  2532         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2533
  2534         16  FILLER                        PIC XXX.
  2535*        16  FILLER                        PIC X(10).
  2536
  2537     12  MA-CRED-BENE-INFO.
  2538         16  MA-CRED-BENE-NAME                 PIC X(25).
  2539         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2540         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2541         16  MA-CRED-BENE-CTYST.
  2542             20  MA-CRED-BENE-CITY             PIC X(28).
  2543             20  MA-CRED-BENE-STATE            PIC XX.
  2544         16  MA-CRED-BENE-ZIP.
  2545             20  MA-CB-ZIP-CODE.
  2546                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  48
* EL050.cbl
  2547                     88  MA-CB-CANADIAN-POST-CODE
  2548                                           VALUE 'A' THRU 'Z'.
  2549                 24  FILLER                    PIC X(4).
  2550             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2551         16  MA-CB-CANADIAN-POSTAL-CODE
  2552                            REDEFINES MA-CRED-BENE-ZIP.
  2553             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2554             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2555             20  FILLER                        PIC X(3).
  2556     12  MA-POST-CARD-MAIL-DATA.
  2557         16  MA-MAIL-DATA OCCURS 7.
  2558             20  MA-MAIL-TYPE              PIC X.
  2559                 88  MA-12MO-MAILING           VALUE '1'.
  2560                 88  MA-EXP-MAILING            VALUE '2'.
  2561             20  MA-MAIL-STATUS            PIC X.
  2562                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2563                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2564                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2565             20  MA-MAIL-DATE              PIC XX.
  2566     12  FILLER                            PIC XX.
  2567     12  FILLER                            PIC XX.
  2568*    12  FILLER                            PIC X(30).
  2569******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  49
* EL050.cbl
  2571*    COPY ERCPNDM.
  2572******************************************************************
  2573*                                                                *
  2574*                                                                *
  2575*                            ERCPNDM                             *
  2576*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2577*                            VMOD=2.003                          *
  2578*                                                                *
  2579*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2580*                                                                *
  2581*   FILE TYPE = VSAM,KSDS                                        *
  2582*   RECORD SIZE = 374   RECFORM = FIX                            *
  2583*                                                                *
  2584*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2585*   ALTERNATE PATH    = NOT USED                                 *
  2586*                                                                *
  2587*   LOG = YES                                                    *
  2588*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2589******************************************************************
  2590*                   C H A N G E   L O G
  2591*
  2592* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2593*-----------------------------------------------------------------
  2594*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2595* EFFECTIVE    NUMBER
  2596*-----------------------------------------------------------------
  2597* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2598* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2599* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2600******************************************************************
  2601
  2602 01  PENDING-MAILING-DATA.
  2603     12  PM-RECORD-ID                      PIC XX.
  2604         88  VALID-MA-ID                       VALUE 'PM'.
  2605
  2606     12  PM-CONTROL-PRIMARY.
  2607         16  PM-COMPANY-CD                 PIC X.
  2608         16  PM-ENTRY-BATCH                PIC X(6).
  2609         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2610         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2611
  2612     12  FILLER                            PIC X(14).
  2613
  2614     12  PM-ACCESS-CONTROL.
  2615         16  PM-SOURCE-SYSTEM              PIC XX.
  2616             88  PM-FROM-CREDIT                VALUE 'CR'.
  2617             88  PM-FROM-VSI                   VALUE 'VS'.
  2618             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2619             88  PM-FROM-OTHER                 VALUE 'OT'.
  2620         16  PM-RECORD-ADD-DT              PIC XX.
  2621         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2622         16  PM-LAST-MAINT-DT              PIC XX.
  2623         16  PM-LAST-MAINT-BY              PIC XXXX.
  2624         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2625
  2626     12  PM-PROFILE-INFO.
  2627         16  PM-QUALIFY-CODE-1             PIC XX.
  2628         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  50
* EL050.cbl
  2629         16  PM-QUALIFY-CODE-3             PIC XX.
  2630         16  PM-QUALIFY-CODE-4             PIC XX.
  2631         16  PM-QUALIFY-CODE-5             PIC XX.
  2632
  2633         16  PM-INSURED-LAST-NAME          PIC X(15).
  2634         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2635         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2636         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2637         16  PM-INSURED-BIRTH-DT           PIC XX.
  2638         16  PM-INSURED-SEX                PIC X.
  2639             88  PM-SEX-MALE                   VALUE 'M'.
  2640             88  PM-SEX-FEMALE                 VALUE 'F'.
  2641         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2642
  2643         16  PM-ADDRESS-CORRECTED          PIC X.
  2644         16  PM-JOINT-BIRTH-DT             PIC XX.
  2645*        16  FILLER                        PIC X(12).
  2646
  2647         16  PM-ADDRESS-LINE-1             PIC X(30).
  2648         16  PM-ADDRESS-LINE-2             PIC X(30).
  2649         16  PM-CITY-STATE.
  2650             20  PM-CITY                   PIC X(28).
  2651             20  PM-STATE                  PIC XX.
  2652         16  PM-ZIP.
  2653             20  PM-ZIP-CODE.
  2654                 24  PM-ZIP-1              PIC X.
  2655                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2656                 24  FILLER                PIC X(4).
  2657             20  PM-ZIP-PLUS4              PIC X(4).
  2658         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2659             20  PM-CAN-POST1              PIC XXX.
  2660             20  PM-CAN-POST2              PIC XXX.
  2661             20  FILLER                    PIC XXX.
  2662
  2663         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2664
  2665         16  FILLER                        PIC X(03).
  2666
  2667     12  PM-CRED-BENE-INFO.
  2668         16  PM-CRED-BENE-NAME             PIC X(25).
  2669         16  PM-CRED-BENE-ADDR             PIC X(30).
  2670         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2671         16  PM-CRED-BENE-CTYST.
  2672             20  PM-CRED-BENE-CITY         PIC X(28).
  2673             20  PM-CRED-BENE-STATE        PIC XX.
  2674         16  PM-CRED-BENE-ZIP.
  2675             20  PM-CB-ZIP-CODE.
  2676                 24  PM-CB-ZIP-1           PIC X.
  2677                     88  PM-CB-CANADIAN-POST-CODE
  2678                                  VALUE 'A' THRU 'Z'.
  2679                 24  FILLER                PIC X(4).
  2680             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2681         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2682             20  PM-CB-CAN-POST1           PIC XXX.
  2683             20  PM-CB-CAN-POST2           PIC XXX.
  2684             20  FILLER                    PIC XXX.
  2685     12  PM-POST-CARD-MAIL-DATA.
  2686         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  51
* EL050.cbl
  2687             20  PM-MAIL-TYPE              PIC X.
  2688                 88  PM-12MO-MAILING           VALUE '1'.
  2689                 88  PM-EXP-MAILING            VALUE '2'.
  2690             20  PM-MAIL-STATUS            PIC X.
  2691                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2692                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2693                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2694             20  PM-MAIL-DATE              PIC XX.
  2695     12  FILLER                            PIC XX.
  2696     12  FILLER                            PIC X(12).
  2697*    12  FILLER                            PIC X(30).
  2698
  2699******************************************************************
  2700*                                COPY ERCLOFC.
  2701******************************************************************
  2702*                                                                *
  2703*                                                                *
  2704*                            ERCLOFC                             *
  2705*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2706*                            VMOD=2.003                          *
  2707*                                                                *
  2708*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2709*                                                                *
  2710*   FILE TYPE = VSAM,KSDS                                        *
  2711*   RECORD SIZE = 670   RECFORM = FIX                            *
  2712*                                                                *
  2713*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2714*                                                                *
  2715*   LOG = YES                                                    *
  2716*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2717*                                                                *
  2718******************************************************************
  2719
  2720 01  LOAN-OFFICER-MASTER.
  2721     12  LO-RECORD-ID                PIC XX.
  2722         88  VALID-LO-ID                VALUE 'LO'.
  2723
  2724     12  LO-CONTROL-PRIMARY.
  2725         16  LO-COMPANY-CD           PIC X.
  2726         16  LO-CARRIER              PIC X.
  2727         16  LO-GROUPING.
  2728             20  LO-GROUPING-PREFIX  PIC XXX.
  2729             20  LO-GROUPING-PRIME   PIC XXX.
  2730         16  LO-STATE                PIC XX.
  2731         16  LO-ACCOUNT.
  2732             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2733             20  LO-ACCOUNT-PRIME    PIC X(6).
  2734         16  LO-OFFICER-CODE         PIC X(5).
  2735
  2736     12  LO-OFFICER-NAME             PIC X(30).
  2737
  2738     12  LO-LAST-MAINT-DT            PIC XX.
  2739     12  LO-LAST-USER                PIC X(4).
  2740     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2741
  2742     12  LO-COMP-CONTROL             PIC X.
  2743             88  LO-SHOW-COMP           VALUE 'Y'.
  2744             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  52
* EL050.cbl
  2745     12  LO-DETAIL-CONTROL           PIC X.
  2746             88  LO-PRINT-DETAIL        VALUE 'D'.
  2747             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2748
  2749     12  LO-SV-CARRIER               PIC X.
  2750     12  LO-SV-GROUPING              PIC X(6).
  2751     12  LO-SV-STATE                 PIC XX.
  2752
  2753     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2754     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2755
  2756     12  LO-OFFICER-INFO.
  2757         16  FILLER OCCURS 12 TIMES.
  2758             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2759             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2760             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2761             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2762             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2763             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2764             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2765             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2766     12  FILLER                      PIC X(198).
  2767******************************************************************
  2768*                                COPY ERCPDEF.
  2769******************************************************************
  2770*                                                                *
  2771*                                                                *
  2772*                            ERCPDEF.                            *
  2773*                                                                *
  2774*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2775*                                                                *
  2776*    FILE TYPE = VSAM,KSDS                                       *
  2777*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2778*                                                                *
  2779*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2780*                                                                *
  2781*    LOG = YES                                                   *
  2782*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2783******************************************************************
  2784*                   C H A N G E   L O G
  2785*
  2786* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2787*-----------------------------------------------------------------
  2788*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2789* EFFECTIVE    NUMBER
  2790*-----------------------------------------------------------------
  2791* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2792* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2793* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2794******************************************************************
  2795 01  PRODUCT-MASTER.
  2796    12  PD-RECORD-ID                 PIC X(02).
  2797        88  VALID-PD-ID                  VALUE 'PD'.
  2798    12  PD-CONTROL-PRIMARY.
  2799        16  PD-COMPANY-CD            PIC X.
  2800        16  PD-STATE                 PIC XX.
  2801        16  PD-PRODUCT-CD            PIC XXX.
  2802        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  53
* EL050.cbl
  2803        16  PD-BEN-TYPE              PIC X.
  2804        16  PD-BEN-CODE              PIC XX.
  2805        16  PD-PROD-EXP-DT           PIC XX.
  2806    12  FILLER                       PIC X(50).
  2807    12  PD-PRODUCT-DATA OCCURS 8.
  2808        16  PD-PROD-CODE             PIC X.
  2809            88  PD-PROD-LIFE           VALUE 'L'.
  2810            88  PD-PROD-PROP           VALUE 'P'.
  2811            88  PD-PROD-AH             VALUE 'A'.
  2812            88  PD-PROD-IU             VALUE 'I'.
  2813            88  PD-PROD-GAP            VALUE 'G'.
  2814            88  PD-PROD-FAML           VALUE 'F'.
  2815        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2816        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2817        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2818        16  PD-MAX-TERM              PIC S999        COMP-3.
  2819        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2820        16  FILLER                   PIC X.
  2821        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2822        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2823        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2824        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2825        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2826        16  PD-REC-CRIT-PERIOD       PIC 99.
  2827        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2828            20  PD-RECURRING-YN      PIC X.
  2829            20  FILLER               PIC X.
  2830        16  PD-RTW-MOS               PIC 99.
  2831        16  PD-MAX-EXTENSION         PIC 99.
  2832        16  pd-ben-pct               pic sv999 comp-3.
  2833*       16  FILLER                   PIC XX.
  2834    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2835    12  PD-TERM-LIMITS OCCURS 15.
  2836        16  PD-LOW-TERM              PIC S999        COMP-3.
  2837        16  PD-HI-TERM               PIC S999        COMP-3.
  2838*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2839    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2840        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2841        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2842    12  PD-EARN-FACTORS.
  2843        16  FILLER OCCURS 15.
  2844            20  FILLER OCCURS 15.
  2845                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2846    12  PD-PRODUCT-DESC              PIC X(80).
  2847    12  PD-TRUNCATED                 PIC X.
  2848    12  FILLER                       PIC X(59).
  2849    12  PD-MAINT-INFORMATION.
  2850        16  PD-LAST-MAINT-DT         PIC X(02).
  2851        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2852        16  PD-LAST-MAINT-BY         PIC X(04).
  2853*                                COPY ELCSTATE.
  2854******************************************************************
  2855*                                                                *
  2856*                                                                *
  2857*                            ELCSTATE.                           *
  2858*                                                                *
  2859*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2860*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  54
* EL050.cbl
  2861*   FILE TYPE = VSAM,KSDS                                        *
  2862*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2863*                                                                *
  2864*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2865*       ALTERNATE INDEX = NONE                                   *
  2866*                                                                *
  2867*   LOG = YES                                                    *
  2868*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2869******************************************************************
  2870*                   C H A N G E   L O G
  2871*
  2872* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2873*-----------------------------------------------------------------
  2874*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2875* EFFECTIVE    NUMBER
  2876*-----------------------------------------------------------------
  2877* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2878******************************************************************
  2879*
  2880 01  STATE-FILE.
  2881     12  SF-RECORD-ID                       PIC XX.
  2882         88  VALID-CF-ID                        VALUE 'SF'.
  2883     12  SF-CONTROL-PRIMARY.
  2884         16  SF-COMPANY-ID                  PIC XXX.
  2885         16  SF-CARRIER-CODE                PIC X.
  2886         16  SF-GROUPING                    PIC X(6).
  2887         16  SF-STATE-CODE                  PIC XX.
  2888         16  SF-EXPIRE-DATE                 PIC 9(8).
  2889****************************************************************
  2890*             STATE CONTROLS
  2891****************************************************************
  2892     12  SF-LAST-MAINT-DT                   PIC XX.
  2893     12  SF-LAST-MAINT-BY                   PIC X(4).
  2894     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2895     12  SF-STATE-RT-CONTROLS.
  2896         16  SF-ST-RT-CALC                  PIC X.
  2897     12  SF-ST-TAX-CONTROLS.
  2898         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2899         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2900         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2901     12  SF-ST-REFUND-OPTIONS.
  2902         16  SF-ST-RF-LR-CALC               PIC X.
  2903         16  SF-ST-RF-LL-CALC               PIC X.
  2904         16  SF-ST-RF-LN-CALC               PIC X.
  2905         16  SF-ST-RF-AH-CALC               PIC X.
  2906         16  SF-ST-RF-CP-CALC               PIC X.
  2907     12  SF-ST-UNEARN-PREM-OPTIONS.
  2908         16  SF-ST-LUEP-R78                 PIC X.
  2909         16  SF-ST-LUEP-PRO                 PIC X.
  2910         16  SF-ST-LUEP-ST                  PIC X.
  2911         16  SF-ST-LUEP-DOM                 PIC X.
  2912         16  SF-ST-AUEP-R78                 PIC X.
  2913         16  SF-ST-AUEP-PRO                 PIC X.
  2914         16  SF-ST-AUEP-ST                  PIC X.
  2915         16  SF-ST-AUEP-DOM                 PIC X.
  2916         16  SF-ST-CUEP-R78                 PIC X.
  2917         16  SF-ST-CUEP-PRO                 PIC X.
  2918         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  55
* EL050.cbl
  2919         16  SF-ST-CUEP-DOM                 PIC X.
  2920     12  SF-ST-EARN-PREM-OPTIONS.
  2921         16  SF-ST-LEP-R78                  PIC X.
  2922         16  SF-ST-LEP-PRO                  PIC X.
  2923         16  SF-ST-LEP-ST                   PIC X.
  2924         16  SF-ST-LEP-DOM                  PIC X.
  2925         16  SF-ST-AEP-R78                  PIC X.
  2926         16  SF-ST-AEP-PRO                  PIC X.
  2927         16  SF-ST-AEP-ST                   PIC X.
  2928         16  SF-ST-AEP-DOM                  PIC X.
  2929         16  SF-ST-CEP-R78                  PIC X.
  2930         16  SF-ST-CEP-PRO                  PIC X.
  2931         16  SF-ST-CEP-ST                   PIC X.
  2932         16  SF-ST-CEP-DOM                  PIC X.
  2933     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  56
* EL050.cbl
  2935*    COPY ELCCRTT.
  2936******************************************************************
  2937*                                                                *
  2938*                            ELCCRTT.                            *
  2939*                                                                *
  2940*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2941*                                                                *
  2942*   FILE TYPE = VSAM,KSDS                                        *
  2943*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2944*                                                                *
  2945*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2946*                                                                *
  2947*   LOG = YES                                                    *
  2948*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2949******************************************************************
  2950*                   C H A N G E   L O G
  2951*
  2952* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2953*-----------------------------------------------------------------
  2954*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2955* EFFECTIVE    NUMBER
  2956*-----------------------------------------------------------------
  2957* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2958* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2959* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2960* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2961* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2962* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2963* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2964* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2965******************************************************************
  2966
  2967 01  CERTIFICATE-TRAILERS.
  2968     12  CS-RECORD-ID                      PIC XX.
  2969         88  VALID-CS-ID                      VALUE 'CS'.
  2970
  2971     12  CS-CONTROL-PRIMARY.
  2972         16  CS-COMPANY-CD                 PIC X.
  2973         16  CS-CARRIER                    PIC X.
  2974         16  CS-GROUPING                   PIC X(6).
  2975         16  CS-STATE                      PIC XX.
  2976         16  CS-ACCOUNT                    PIC X(10).
  2977         16  CS-CERT-EFF-DT                PIC XX.
  2978         16  CS-CERT-NO.
  2979             20  CS-CERT-PRIME             PIC X(10).
  2980             20  CS-CERT-SFX               PIC X.
  2981         16  CS-TRAILER-TYPE               PIC X.
  2982             88  COMM-TRLR           VALUE 'A'.
  2983             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2984             88  CERT-DATA-TRLR      VALUE 'C'.
  2985
  2986     12  CS-DATA-AREA                      PIC X(516).
  2987
  2988     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2989         16  CS-BANK-COMMISSION-AREA.
  2990             20  CS-BANK-COMMS       OCCURS 10.
  2991                 24  CS-AGT                PIC X(10).
  2992                 24  CS-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  57
* EL050.cbl
  2993                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2994                 24  CS-RECALC-LV-INDIC    PIC X.
  2995                 24  FILLER                PIC X(10).
  2996         16  FILLER                        PIC X(256).
  2997
  2998     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  2999****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3000         16  CS-MB-CLAIM-DATA OCCURS 24.
  3001             20  CS-CLAIM-NO               PIC X(7).
  3002             20  CS-CLAIM-TYPE             PIC X.
  3003                 88  CS-AH-CLM               VALUE 'A'.
  3004                 88  CS-IU-CLM               VALUE 'I'.
  3005                 88  CS-GP-CLM               VALUE 'G'.
  3006                 88  CS-LF-CLM               VALUE 'L'.
  3007                 88  CS-PR-CLM               VALUE 'P'.
  3008                 88  CS-FL-CLM               VALUE 'F'.
  3009             20  CS-INSURED-TYPE           PIC X.
  3010                 88  CS-PRIM-INSURED          VALUE 'P'.
  3011                 88  CS-CO-BORROWER           VALUE 'C'.
  3012             20  CS-BENEFIT-PERIOD         PIC 99.
  3013             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3014             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3015             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3016         16  FILLER                        PIC X(12).
  3017     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3018         16  CS-VIN-NUMBER                 PIC X(17).
  3019         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3020         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3021         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3022         16  cs-agent-name.
  3023             20  cs-agent-fname            pic x(20).
  3024             20  cs-agent-mi               pic x.
  3025             20  cs-agent-lname            pic x(25).
  3026         16  cs-license-no                 pic x(15).
  3027         16  cs-npn-number                 pic x(10).
  3028         16  cs-agent-edit-status          pic x.
  3029             88  cs-ae-refer-to-manager      value 'M'.
  3030             88  cs-ae-cover-sheet           value 'C'.
  3031             88  cs-ae-sig-form              value 'S'.
  3032             88  cs-ae-verified              value 'V'.
  3033             88  cs-unidentified-signature   value 'U'.
  3034             88  cs-cert-returned            value 'R'.
  3035             88  cs-accept-no-commission     value 'N'.
  3036         16  FILLER                        PIC X(424).
  3037*        16  FILLER                        PIC X(496).
  3038*    COPY ELCCRTO.
  3039******************************************************************
  3040*                                                                *
  3041*                            ELCCRTO.                            *
  3042*                                                                *
  3043*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3044*                                                                *
  3045*   FILE TYPE = VSAM,KSDS                                        *
  3046*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3047*                                                                *
  3048*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3049*                                                                *
  3050*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  58
* EL050.cbl
  3051*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3052******************************************************************
  3053*                   C H A N G E   L O G
  3054*
  3055* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3056*-----------------------------------------------------------------
  3057*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3058* EFFECTIVE    NUMBER
  3059*-----------------------------------------------------------------
  3060* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3061* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3062* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3063* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3064* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3065******************************************************************
  3066 01  ORIGINAL-CERTIFICATE.
  3067     12  OC-RECORD-ID                      PIC XX.
  3068         88  VALID-OC-ID                      VALUE 'OC'.
  3069     12  OC-CONTROL-PRIMARY.
  3070         16  OC-COMPANY-CD                 PIC X.
  3071         16  OC-CARRIER                    PIC X.
  3072         16  OC-GROUPING                   PIC X(6).
  3073         16  OC-STATE                      PIC XX.
  3074         16  OC-ACCOUNT                    PIC X(10).
  3075         16  OC-CERT-EFF-DT                PIC XX.
  3076         16  OC-CERT-NO.
  3077             20  OC-CERT-PRIME             PIC X(10).
  3078             20  OC-CERT-SFX               PIC X.
  3079         16  OC-RECORD-TYPE                PIC X.
  3080         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3081     12  OC-LAST-MAINT-DT                  PIC XX.
  3082     12  OC-LAST-MAINT-BY                  PIC X(4).
  3083     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3084     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3085     12  FILLER                            PIC X(49).
  3086     12  OC-ORIG-REC.
  3087         16  OC-INS-LAST-NAME              PIC X(15).
  3088         16  OC-INS-FIRST-NAME             PIC X(10).
  3089         16  OC-INS-MIDDLE-INIT            PIC X.
  3090         16  OC-INS-AGE                    PIC S999     COMP-3.
  3091         16  OC-JNT-LAST-NAME              PIC X(15).
  3092         16  OC-JNT-FIRST-NAME             PIC X(10).
  3093         16  OC-JNT-MIDDLE-INIT            PIC X.
  3094         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3095         16  OC-LF-BENCD                   PIC XX.
  3096         16  OC-LF-TERM                    PIC S999      COMP-3.
  3097         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3098         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3099         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3100         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3101         16  OC-LF-EXP-DT                  PIC XX.
  3102         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3103         16  OC-LF-CANCEL-DT               PIC XX.
  3104         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3105         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3106         16  OC-AH-BENCD                   PIC XX.
  3107         16  OC-AH-TERM                    PIC S999      COMP-3.
  3108         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  59
* EL050.cbl
  3109         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3110         16  OC-AH-EXP-DT                  PIC XX.
  3111         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3112         16  OC-AH-CP                      PIC 99.
  3113         16  OC-AH-CANCEL-DT               PIC XX.
  3114         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3115         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3116         16  OC-CRED-BENE-NAME             PIC X(25).
  3117         16  OC-1ST-PMT-DT                 PIC XX.
  3118         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3119         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3120         16  OC-ISSUE-TRAN-IND             PIC X.
  3121         16  OC-CANCEL-TRAN-IND            PIC X.
  3122         16  FILLER                        PIC X(211).
  3123
  3124     12  FILLER                            PIC X(50).
  3125******************************************************************
  3126
  3127*    COPY ELCDATE.
  3128******************************************************************
  3129*                                                                *
  3130*                                                                *
  3131*                            ELCDATE.                            *
  3132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3133*                            VMOD=2.003
  3134*                                                                *
  3135*                                                                *
  3136*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3137*                 LENGTH = 200                                   *
  3138******************************************************************
  3139
  3140 01  DATE-CONVERSION-DATA.
  3141     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3142     12  DC-OPTION-CODE                PIC X.
  3143         88  BIN-TO-GREG                VALUE ' '.
  3144         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3145         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3146         88  YMD-GREG-TO-BIN            VALUE '3'.
  3147         88  MDY-GREG-TO-BIN            VALUE '4'.
  3148         88  JULIAN-TO-BIN              VALUE '5'.
  3149         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3150         88  FIND-CENTURY               VALUE '7'.
  3151         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3152         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3153         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3154         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3155         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3156         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3157         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3158         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3159         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3160         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3161         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3162         88  BIN-3-TO-GREG              VALUE 'I'.
  3163         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3164         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3165         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3166         88  MDCY-GREG-TO-BIN           VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  60
* EL050.cbl
  3167         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3168         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3169         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3170         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3171         88  THREE-CHARACTER-BIN
  3172                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3173         88  GREGORIAN-TO-BIN
  3174                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3175         88  BIN-TO-GREGORIAN
  3176                  VALUES ' ' '1' 'I' '8' 'G'.
  3177         88  JULIAN-TO-BINARY
  3178                  VALUES '5' 'C' 'E' 'F'.
  3179     12  DC-ERROR-CODE                 PIC X.
  3180         88  NO-CONVERSION-ERROR        VALUE ' '.
  3181         88  DATE-CONVERSION-ERROR
  3182                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3183         88  DATE-IS-ZERO               VALUE '1'.
  3184         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3185         88  DATE-IS-INVALID            VALUE '3'.
  3186         88  DATE1-GREATER-DATE2        VALUE '4'.
  3187         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3188         88  DATE-INVALID-OPTION        VALUE '9'.
  3189         88  INVALID-CENTURY            VALUE 'A'.
  3190         88  ONLY-CENTURY               VALUE 'B'.
  3191         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3192         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3193     12  DC-END-OF-MONTH               PIC X.
  3194         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3195     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3196         88  USE-NORMAL-PROCESS         VALUE ' '.
  3197         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3198         88  ADJUST-UP-100-YRS          VALUE '2'.
  3199     12  FILLER                        PIC X.
  3200     12  DC-CONVERSION-DATES.
  3201         16  DC-BIN-DATE-1             PIC XX.
  3202         16  DC-BIN-DATE-2             PIC XX.
  3203         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3204         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3205                       DC-GREG-DATE-1-EDIT.
  3206             20  DC-EDIT1-MONTH        PIC 99.
  3207             20  SLASH1-1              PIC X.
  3208             20  DC-EDIT1-DAY          PIC 99.
  3209             20  SLASH1-2              PIC X.
  3210             20  DC-EDIT1-YEAR         PIC 99.
  3211         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3212         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3213                     DC-GREG-DATE-2-EDIT.
  3214             20  DC-EDIT2-MONTH        PIC 99.
  3215             20  SLASH2-1              PIC X.
  3216             20  DC-EDIT2-DAY          PIC 99.
  3217             20  SLASH2-2              PIC X.
  3218             20  DC-EDIT2-YEAR         PIC 99.
  3219         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3220         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3221                     DC-GREG-DATE-1-YMD.
  3222             20  DC-YMD-YEAR           PIC 99.
  3223             20  DC-YMD-MONTH          PIC 99.
  3224             20  DC-YMD-DAY            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  61
* EL050.cbl
  3225         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3226         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3227                      DC-GREG-DATE-1-MDY.
  3228             20  DC-MDY-MONTH          PIC 99.
  3229             20  DC-MDY-DAY            PIC 99.
  3230             20  DC-MDY-YEAR           PIC 99.
  3231         16  DC-GREG-DATE-1-ALPHA.
  3232             20  DC-ALPHA-MONTH        PIC X(10).
  3233             20  DC-ALPHA-DAY          PIC 99.
  3234             20  FILLER                PIC XX.
  3235             20  DC-ALPHA-CENTURY.
  3236                 24 DC-ALPHA-CEN-N     PIC 99.
  3237             20  DC-ALPHA-YEAR         PIC 99.
  3238         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3239         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3240         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3241         16  DC-JULIAN-DATE            PIC 9(05).
  3242         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3243                                       PIC 9(05).
  3244         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3245             20  DC-JULIAN-YEAR        PIC 99.
  3246             20  DC-JULIAN-DAYS        PIC 999.
  3247         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3248         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3249         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3250     12  DATE-CONVERSION-VARIBLES.
  3251         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3252         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3253             20  FILLER                PIC 9(3).
  3254             20  HOLD-CEN-1-CCYY.
  3255                 24  HOLD-CEN-1-CC     PIC 99.
  3256                 24  HOLD-CEN-1-YY     PIC 99.
  3257             20  HOLD-CEN-1-MO         PIC 99.
  3258             20  HOLD-CEN-1-DA         PIC 99.
  3259         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3260             20  HOLD-CEN-1-R-MO       PIC 99.
  3261             20  HOLD-CEN-1-R-DA       PIC 99.
  3262             20  HOLD-CEN-1-R-CCYY.
  3263                 24  HOLD-CEN-1-R-CC   PIC 99.
  3264                 24  HOLD-CEN-1-R-YY   PIC 99.
  3265             20  FILLER                PIC 9(3).
  3266         16  HOLD-CENTURY-1-X.
  3267             20  FILLER                PIC X(3)  VALUE SPACES.
  3268             20  HOLD-CEN-1-X-CCYY.
  3269                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3270                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3271             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3272             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3273         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3274             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3275             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3276             20  HOLD-CEN-1-R-X-CCYY.
  3277                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3278                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3279             20  FILLER                PIC XXX.
  3280         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3281         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3282         16  DC-JULIAN-DATE-1          PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  62
* EL050.cbl
  3283         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3284             20  DC-JULIAN-1-CCYY.
  3285                 24  DC-JULIAN-1-CC    PIC 99.
  3286                 24  DC-JULIAN-1-YR    PIC 99.
  3287             20  DC-JULIAN-DA-1        PIC 999.
  3288         16  DC-JULIAN-DATE-2          PIC 9(07).
  3289         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3290             20  DC-JULIAN-2-CCYY.
  3291                 24  DC-JULIAN-2-CC    PIC 99.
  3292                 24  DC-JULIAN-2-YR    PIC 99.
  3293             20  DC-JULIAN-DA-2        PIC 999.
  3294         16  DC-GREG-DATE-A-EDIT.
  3295             20  DC-EDITA-MONTH        PIC 99.
  3296             20  SLASHA-1              PIC X VALUE '/'.
  3297             20  DC-EDITA-DAY          PIC 99.
  3298             20  SLASHA-2              PIC X VALUE '/'.
  3299             20  DC-EDITA-CCYY.
  3300                 24  DC-EDITA-CENT     PIC 99.
  3301                 24  DC-EDITA-YEAR     PIC 99.
  3302         16  DC-GREG-DATE-B-EDIT.
  3303             20  DC-EDITB-MONTH        PIC 99.
  3304             20  SLASHB-1              PIC X VALUE '/'.
  3305             20  DC-EDITB-DAY          PIC 99.
  3306             20  SLASHB-2              PIC X VALUE '/'.
  3307             20  DC-EDITB-CCYY.
  3308                 24  DC-EDITB-CENT     PIC 99.
  3309                 24  DC-EDITB-YEAR     PIC 99.
  3310         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3311         16  DC-GREG-DATE-CYMD-R REDEFINES
  3312                              DC-GREG-DATE-CYMD.
  3313             20  DC-CYMD-CEN           PIC 99.
  3314             20  DC-CYMD-YEAR          PIC 99.
  3315             20  DC-CYMD-MONTH         PIC 99.
  3316             20  DC-CYMD-DAY           PIC 99.
  3317         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3318         16  DC-GREG-DATE-MDCY-R REDEFINES
  3319                              DC-GREG-DATE-MDCY.
  3320             20  DC-MDCY-MONTH         PIC 99.
  3321             20  DC-MDCY-DAY           PIC 99.
  3322             20  DC-MDCY-CEN           PIC 99.
  3323             20  DC-MDCY-YEAR          PIC 99.
  3324    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3325        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3326    12  DC-EL310-DATE                  PIC X(21).
  3327    12  FILLER                         PIC X(28).
  3328
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  63
* EL050.cbl
  3330*    COPY ELCCALC.
  3331******************************************************************
  3332*                                                                *
  3333*                           ELCCALC.                            *
  3334*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3335*                            VMOD=2.025                          *
  3336*                                                                *
  3337*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3338*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3339*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3340*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3341*                                                                *
  3342*  PASSED TO ELRTRM                                              *
  3343*  -----------------                                             *
  3344*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3345*  ORIGINAL TERM                                                 *
  3346*  BEGINNING DATE                                                *
  3347*  ENDING DATE                                                   *
  3348*  COMPANY I.D.                                                  *
  3349*  ACCOUNT MASTER USER FIELD                                     *
  3350*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3351*  FREE LOOK DAYS                                                *
  3352*                                                                *
  3353*  RETURNED FROM ELRTRM                                          *
  3354*  ---------------------                                         *
  3355*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3356*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3357*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3358*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3359*----------------------------------------------------------------*
  3360*  PASSED TO ELRAMT                                              *
  3361*  ----------------                                              *
  3362*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3363*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3364*  ORIGINAL AMOUNT                                               *
  3365*  ALTERNATE BENEFIT (BALLON)                                    *
  3366*  A.P.R. - NET PAY ONLY                                         *
  3367*  METHOD
  3368*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3369*  COMPANY I.D.                                                  *
  3370*  BENEFIT TYPE                                                  *
  3371*                                                                *
  3372*  RETURNED FROM ELRAMT                                          *
  3373*  --------------------                                          *
  3374*  REMAINING AMOUNT 1 - CURRENT                                  *
  3375*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3376*  REMAINING AMOUNT FACTOR
  3377*----------------------------------------------------------------*
  3378*  PASSED TO ELRESV                                              *
  3379*  -----------------                                             *
  3380*  CERTIFICATE EFFECTIVE DATE                                    *
  3381*  VALUATION DATE                                                *
  3382*  PAID THRU DATE                                                *
  3383*  BENEFIT                                                       *
  3384*  INCURRED DATE                                                 *
  3385*  REPORTED DATE                                                 *
  3386*  ISSUE AGE                                                     *
  3387*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  64
* EL050.cbl
  3388*  CDT PERCENT                                                   *
  3389*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3390* *CLAIM TYPE (LIFE, A/H)                                        *
  3391* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3392* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3393*                                                                *
  3394*  RETURNED FROM ELRESV                                          *
  3395*  --------------------                                          *
  3396*  CDT TABLE USED                                                *
  3397*  CDT FACTOR USED                                               *
  3398*  PAY TO CURRENT RESERVE                                        *
  3399*  I.B.N.R. - A/H ONLY                                           *
  3400*  FUTURE (ACCRUED) AH ONLY                                      *
  3401*----------------------------------------------------------------*
  3402*  PASSED TO ELRATE                                              *
  3403*  ----------------                                              *
  3404*  CERT ISSUE DATE                                               *
  3405*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3406*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3407*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3408*  STATE CODE (CLIENT DEFINED)                                   *
  3409*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3410*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3411*  DEVIATION CODE                                                *
  3412*  ISSUE AGE                                                     *
  3413*  ORIGINAL BENEFIT AMOUNT                                       *
  3414*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3415*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3416*  BENEFIT KIND (LIFE OR A/H)                                    *
  3417*  A.P.R.                                                        *
  3418*  METHOD
  3419*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3420*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3421*  COMPANY I.D. (3 CHARACTER)                                    *
  3422*  BENEFIT CODE                                                  *
  3423*  BENEFIT OVERRIDE CODE                                         *
  3424*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3425*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3426*  JOINT INDICATOR (CSL ONLY)                                    *
  3427*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3428*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3429*                                                                *
  3430*  RETURNED FROM ELRATE                                          *
  3431*  --------------------                                          *
  3432*  CALCULATED PREMIUM                                            *
  3433*  PREMIUM RATE                                                  *
  3434*  MORTALITY CODE                                                *
  3435*  MAX ATTAINED AGE                                              *
  3436*  MAX AGE                                                       *
  3437*  MAX TERM                                                      *
  3438*  MAX MONTHLY BENEFIT                                           *
  3439*  MAX TOTAL BENIFIT                                             *
  3440*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3441*----------------------------------------------------------------*
  3442*  PASSED TO ELRFND                                              *
  3443*  ----------------                                              *
  3444*  CERT ISSUE DATE                                               *
  3445*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  65
* EL050.cbl
  3446*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3447*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3448*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3449*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3450*  STATE CODE (CLIENT DEFINED)                                   *
  3451*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3452*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3453*  DEVIATION CODE                                                *
  3454*  ISSUE AGE                                                     *
  3455*  ORIGINAL BENEFIT AMOUNT                                       *
  3456*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3457*  PROCESS TYPE (CANCEL)                                         *
  3458*  BENEFIT KIND (LIFE OR A/H)                                    *
  3459*  A.P.R.                                                        *
  3460*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3461*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3462*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3463*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3464*  COMPANY I.D. (3 CHARACTER)                                    *
  3465*  BENEFIT CODE                                                  *
  3466*  BENEFIT OVERRIDE CODE                                         *
  3467*                                                                *
  3468*  RETURNED FROM ELRFND                                          *
  3469*  --------------------                                          *
  3470*  CALCULATED REFUND                                             *
  3471*----------------------------------------------------------------*
  3472*  PASSED TO ELEARN                                              *
  3473*  ----------------                                              *
  3474*  CERT ISSUE DATE                                               *
  3475*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3476*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3477*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3478*  STATE CODE (CLIENT DEFINED)                                   *
  3479*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3480*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3481*  DEVIATION CODE                                                *
  3482*  ISSUE AGE                                                     *
  3483*  ORIGINAL BENEFIT AMOUNT                                       *
  3484*  BENEFIT KIND (LIFE OR A/H)                                    *
  3485*  A.P.R.                                                        *
  3486*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3487*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3488*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3489*  COMPANY I.D. (3 CHARACTER)                                    *
  3490*  BENEFIT CODE                                                  *
  3491*  BENEFIT OVERRIDE CODE                                         *
  3492*                                                                *
  3493*  RETURNED FROM ELEARN                                          *
  3494*  --------------------                                          *
  3495*  INDICATED  EARNINGS                                           *
  3496*----------------------------------------------------------------*
  3497*                 LENGTH = 450                                   *
  3498*                                                                *
  3499******************************************************************
  3500******************************************************************
  3501*                   C H A N G E   L O G
  3502*
  3503* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  66
* EL050.cbl
  3504*-----------------------------------------------------------------
  3505*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3506* EFFECTIVE    NUMBER
  3507*-----------------------------------------------------------------
  3508* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3509* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3510* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3511* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3512* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3513* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3514* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3515* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3516* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3517* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3518******************************************************************
  3519
  3520 01  CALCULATION-PASS-AREA.
  3521     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3522                                     COMP.
  3523
  3524     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3525       88  NO-CP-ERROR                             VALUE ZERO.
  3526       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3527                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3528       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3529       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3530       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3531       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3532       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3533       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3534       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3535       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3536       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3537       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3538       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3539       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3540       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3541       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3542       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3543       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3544       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3545
  3546     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3547       88  NO-CP-ERROR-2                           VALUE ZERO.
  3548***********************  INPUT AREAS ****************************
  3549
  3550     12  CP-CALCULATION-AREA.
  3551         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3552         16  CP-CERT-EFF-DT        PIC XX.
  3553         16  CP-VALUATION-DT       PIC XX.
  3554         16  CP-PAID-THRU-DT       PIC XX.
  3555         16  CP-BENEFIT-TYPE       PIC X.
  3556           88  CP-AH                               VALUE 'A' 'D'
  3557                                                   'I' 'U'.
  3558           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3559           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3560         16  CP-INCURRED-DT        PIC XX.
  3561         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  67
* EL050.cbl
  3562         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3563         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3564         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3565                                     COMP-3.
  3566         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-CDT-METHOD         PIC X.
  3569           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3570           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3571           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3572         16  CP-CLAIM-TYPE         PIC X.
  3573           88  CP-AH-CLAIM                         VALUE 'A'.
  3574           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3575         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3576                                     COMP-3.
  3577         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3578                                     COMP-3.
  3579         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3580                                     COMP-3.
  3581         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3582                                     COMP-3.
  3583         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3586                                     COMP-3.
  3587         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3588                                     COMP-3.
  3589         16  CP-REM-TERM-METHOD    PIC X.
  3590           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3591           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3592           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3593           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3594           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3595           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3596           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3597         16  CP-EARNING-METHOD     PIC X.
  3598           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3599           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3600           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3601           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3602           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3603           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3604           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3605           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3606           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3607           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3608           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3609           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3610           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3611           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3612         16  CP-PROCESS-TYPE       PIC X.
  3613           88  CP-CLAIM                            VALUE '1'.
  3614           88  CP-CANCEL                           VALUE '2'.
  3615           88  CP-ISSUE                            VALUE '3'.
  3616         16  CP-SPECIAL-CALC-CD    PIC X.
  3617           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3618           88  CP-1-MTH-INTEREST               VALUE ' '.
  3619           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  68
* EL050.cbl
  3620           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3621           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3622           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3623           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3624           88  CP-FARM-PLAN                    VALUE 'F'.
  3625           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3626           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3627           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3628           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3629           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3630           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3631           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3632           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3633           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3634           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3635                                                     'W' 'X'.
  3636           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3637           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3638           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3639           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3640           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3641           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3642           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3643           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3644           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3645           88  CP-CSL-METH-1                   VALUE '5'.
  3646           88  CP-CSL-METH-2                   VALUE '6'.
  3647           88  CP-CSL-METH-3                   VALUE '7'.
  3648           88  CP-CSL-METH-4                   VALUE '8'.
  3649
  3650         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3651                                     COMP-3.
  3652         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3653         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3654         16  CP-STATE              PIC XX          VALUE SPACE.
  3655         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3656         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3657           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3658               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3659         16  CP-R78-OPTION         PIC X.
  3660           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3661           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3662
  3663         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3664         16  CP-IBNR-RESERVE-SW    PIC X.
  3665         16  CP-CLAIM-STATUS       PIC X.
  3666         16  CP-RATE-FILE          PIC X.
  3667         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3668                                     COMP-3.
  3669
  3670         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3671         16  CP-AH-OVERRIDE-CODE   PIC X.
  3672
  3673         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3674                                     COMP-3.
  3675         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3676                                   PIC S9(5)V99 COMP-3.
  3677         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  69
* EL050.cbl
  3678                                     COMP-3.
  3679         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3680                                     COMP-3.
  3681         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3682                                     COMP-3.
  3683         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3684                                  PIC S9(7)V99 COMP-3.
  3685
  3686         16  CP-PAID-FROM-DATE     PIC X(02).
  3687         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3688         16  CP-EXT-DAYS-CALC      PIC X.
  3689           88  CP-EXT-NO-CHG                   VALUE ' '.
  3690           88  CP-EXT-CHG-LF                   VALUE '1'.
  3691           88  CP-EXT-CHG-AH                   VALUE '2'.
  3692           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3693         16  CP-DOMICILE-STATE     PIC XX.
  3694         16  CP-CARRIER            PIC X.
  3695         16  CP-REIN-FLAG          PIC X.
  3696         16  CP-REM-TRM-CALC-OPTION PIC X.
  3697           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3698                      '2' '3' '4' '5'.
  3699           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3700           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3701           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3702           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3703           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3704           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3705           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3706           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3707         16  CP-SIG-SWITCH         PIC X.
  3708         16  CP-RATING-METHOD      PIC X.
  3709           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3710           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3711           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3712           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3713           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3714           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3715           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3716           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3717           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3718         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3719                                     COMP-3.
  3720         16  CP-BEN-CATEGORY       PIC X.
  3721         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3722         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3723                                   PIC S99V9(5) COMP-3.
  3724         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3725         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3726                                   PIC S99V9(5) COMP-3.
  3727         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3728         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3729         16  CP-EXPIRE-DT          PIC XX.
  3730         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3731         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3732         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3733         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3734         16  CP-DDF-SPEC-CALC      PIC X.
  3735             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  70
* EL050.cbl
  3736             88  CP-CALC-CLP              VALUE 'C'.
  3737         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3738         16  CP-CANCEL-REASON      PIC X.
  3739         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3740         16  CP-PMT-MODE           PIC X.
  3741         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3742         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3743         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3744         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3745         16  FILLER                PIC X.
  3746
  3747***************    OUTPUT FROM ELRESV   ************************
  3748
  3749         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3750
  3751         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3752                                     COMP-3.
  3753         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3754                                     COMP-3.
  3755         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3756                                     COMP-3.
  3757         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3758                                     COMP-3.
  3759         16  FILLER                PIC X(09).
  3760***************    OUTPUT FROM ELRTRM   *************************
  3761
  3762         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3763                                     COMP-3.
  3764         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3765                                     COMP-3.
  3766         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3767                                     COMP-3.
  3768         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3769                                     COMP-3.
  3770         16  FILLER                PIC X(12).
  3771
  3772***************    OUTPUT FROM ELRAMT   *************************
  3773
  3774         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3775                                     COMP-3.
  3776         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3777                                     COMP-3.
  3778         16  FILLER                PIC X(12).
  3779
  3780***************    OUTPUT FROM ELRATE   *************************
  3781
  3782         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3783                                     COMP-3.
  3784         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3785                                     COMP-3.
  3786         16  CP-MORTALITY-CODE     PIC X(4).
  3787         16  CP-RATE-EDIT-FLAG     PIC X.
  3788             88  CP-RATES-NEED-APR                  VALUE '1'.
  3789         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3790                                     COMP-3.
  3791         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3792         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3793         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  71
* EL050.cbl
  3794                                   PIC S9(7)V99 COMP-3.
  3795         16  FILLER                PIC X(07).
  3796
  3797***************    OUTPUT FROM ELRFND   *************************
  3798
  3799         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3800                                     COMP-3.
  3801         16  CP-REFUND-TYPE-USED   PIC X.
  3802           88  CP-R-AS-R78                         VALUE '1'.
  3803           88  CP-R-AS-PRORATA                     VALUE '2'.
  3804           88  CP-R-AS-CALIF                       VALUE '3'.
  3805           88  CP-R-AS-TEXAS                       VALUE '4'.
  3806           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3807           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3808           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3809           88  CP-R-AS-MEAN                        VALUE '8'.
  3810           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3811           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3812           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3813           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3814           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3815           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3816         16  FILLER                PIC X(12).
  3817
  3818***************    OUTPUT FROM ELEARN   *************************
  3819
  3820         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3821                                     COMP-3.
  3822         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-EARNING-TYPE-USED  PIC X.
  3833           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3834           88  CP-E-AS-R78                         VALUE '1'.
  3835           88  CP-E-AS-PRORATA                     VALUE '2'.
  3836           88  CP-E-AS-TEXAS                       VALUE '4'.
  3837           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3838           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3839           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3840           88  CP-E-AS-MEAN                        VALUE '8'.
  3841           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3842         16  FILLER                PIC X(12).
  3843
  3844***************    OUTPUT FROM ELPMNT   *************************
  3845
  3846         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3847                                     COMP-3.
  3848         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3849                                     COMP-3.
  3850         16  FILLER                PIC X(12).
  3851
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  72
* EL050.cbl
  3852***************   MISC WORK AREAS    *****************************
  3853         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3854                                     COMP-3.
  3855         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3856                                     COMP-3.
  3857         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3858                                     COMP-3.
  3859         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3860                                     COMP-3.
  3861         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3862                                     COMP-3.
  3863         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3864                                     COMP-3.
  3865         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3866             88  OPEN-RATE-FILE                   VALUE 'O'.
  3867             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3868             88  IO-ERROR                         VALUE 'E'.
  3869
  3870         16  CP-FIRST-PAY-DATE     PIC XX.
  3871
  3872         16  CP-JOINT-INDICATOR    PIC X.
  3873
  3874         16  CP-RESERVE-REMAINING-TERM
  3875                                   PIC S9(4)V9    VALUE ZERO
  3876                                     COMP-3.
  3877
  3878         16  CP-INSURED-BIRTH-DT   PIC XX.
  3879
  3880         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3881                                     COMP-3.
  3882
  3883         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3884                                     COMP-3.
  3885
  3886         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3887                                     COMP-3.
  3888
  3889         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3890                                     COMP-3.
  3891
  3892         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3893                                     COMP-3.
  3894
  3895         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3896                                     COMP-3.
  3897
  3898         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3899                                     COMP-3.
  3900
  3901         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3902             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3903
  3904         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3905                                     COMP-3.
  3906         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3907                                     COMP-3.
  3908         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3909         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  73
* EL050.cbl
  3910         16  cp-net-only-state     pic x value spaces.
  3911         16  FILLER                PIC X(13).
  3912******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  74
* EL050.cbl
  3914******************************************************************
  3915*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3916*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3917*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3918*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3919*** MODIFICATION.                                              ***
  3920*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3921*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3922******************************************************************
  3923*    COPY ERCPNDB.
  3924******************************************************************
  3925*                                                                *
  3926*                                                                *
  3927*                            ERCPNDB.                            *
  3928*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3929*                            VMOD=2.025                          *
  3930*                                                                *
  3931*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3932*                                                                *
  3933******************************************************************
  3934*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3935*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3936******************************************************************
  3937*                                                                *
  3938*                                                                *
  3939*   FILE TYPE = VSAM,KSDS                                        *
  3940*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3941*                                                                *
  3942*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3943*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3944*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3945*                                                 RKP=13,LEN=36  *
  3946*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3947*                                      AND CHG-SEQ.)             *
  3948*                                                RKP=49,LEN=11   *
  3949*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3950*                                      AND CHG-SEQ.)             *
  3951*                                                RKP=60,LEN=15   *
  3952*                                                                *
  3953*   LOG = NO                                                     *
  3954*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3955******************************************************************
  3956******************************************************************
  3957*                   C H A N G E   L O G
  3958*
  3959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3960*-----------------------------------------------------------------
  3961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3962* EFFECTIVE    NUMBER
  3963*-----------------------------------------------------------------
  3964* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3965* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3966* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3967* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3968* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3969* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3970* 032306                   PEMA  ADD BOW LOAN NUMBER
  3971* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  75
* EL050.cbl
  3972* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3973* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3974* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3975* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3976* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3977* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3978* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3979* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3980******************************************************************
  3981
  3982 01  PENDING-BUSINESS.
  3983     12  PB-RECORD-ID                     PIC XX.
  3984         88  VALID-PB-ID                        VALUE 'PB'.
  3985
  3986     12  PB-CONTROL-PRIMARY.
  3987         16  PB-COMPANY-CD                PIC X.
  3988         16  PB-ENTRY-BATCH               PIC X(6).
  3989         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3990         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3991
  3992     12  PB-CONTROL-BY-ACCOUNT.
  3993         16  PB-COMPANY-CD-A1             PIC X.
  3994         16  PB-CARRIER                   PIC X.
  3995         16  PB-GROUPING.
  3996             20  PB-GROUPING-PREFIX       PIC XXX.
  3997             20  PB-GROUPING-PRIME        PIC XXX.
  3998         16  PB-STATE                     PIC XX.
  3999         16  PB-ACCOUNT.
  4000             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4001             20  PB-ACCOUNT-PRIME         PIC X(6).
  4002         16  PB-CERT-EFF-DT               PIC XX.
  4003         16  PB-CERT-NO.
  4004             20  PB-CERT-PRIME            PIC X(10).
  4005             20  PB-CERT-SFX              PIC X.
  4006         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4007
  4008         16  PB-RECORD-TYPE               PIC X.
  4009             88  PB-MAILING-DATA                VALUE '0'.
  4010             88  PB-ISSUE                       VALUE '1'.
  4011             88  PB-CANCELLATION                VALUE '2'.
  4012             88  PB-BATCH-TRAILER               VALUE '9'.
  4013
  4014     12  PB-CONTROL-BY-ORIG-BATCH.
  4015         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4016         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4017         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4018         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4019
  4020     12  PB-CONTROL-BY-CSR.
  4021         16  PB-CSR-COMPANY-CD            PIC X.
  4022         16  PB-CSR-ID                    PIC X(4).
  4023         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4024         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4025         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4026******************************************************************
  4027*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4028******************************************************************
  4029
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  76
* EL050.cbl
  4030     12  PB-LAST-MAINT-DT                 PIC XX.
  4031     12  PB-LAST-MAINT-BY                 PIC X(4).
  4032     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4033
  4034     12  PB-RECORD-BODY                   PIC X(375).
  4035
  4036     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4037         16  PB-CERT-ORIGIN               PIC X.
  4038             88  CLASIC-CREATED-CERT         VALUE '1'.
  4039         16  PB-I-NAME.
  4040             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4041             20  PB-I-INSURED-FIRST-NAME.
  4042                 24  PB-I-INSURED-1ST-INIT PIC X.
  4043                 24  FILLER                PIC X(9).
  4044             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4045         16  PB-I-AGE                     PIC S99   COMP-3.
  4046         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4047         16  PB-I-BIRTHDAY                PIC XX.
  4048         16  PB-I-INSURED-SEX             PIC X.
  4049             88  PB-SEX-MALE     VALUE 'M'.
  4050             88  PB-SEX-FEMALE   VALUE 'F'.
  4051
  4052         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4053         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4054         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4055         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4056         16  PB-I-SKIP-CODE               PIC X.
  4057             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4058             88  PB-SKIP-JULY              VALUE '1'.
  4059             88  PB-SKIP-AUGUST            VALUE '2'.
  4060             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4061             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4062             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4063             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4064             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4065             88  PB-SKIP-JUNE              VALUE '8'.
  4066             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4067             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4068             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4069         16  PB-I-TERM-TYPE               PIC X.
  4070             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4071             88  PB-PAID-WEEKLY            VALUE 'W'.
  4072             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4073             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4074             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4075         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4076         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4077         16  PB-I-DATA-ENTRY-SW           PIC X.
  4078             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4079             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4080             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4081             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4082         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4083         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4084*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4085         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4086         16  FILLER                       PIC X.
  4087
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  77
* EL050.cbl
  4088         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4089             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4090             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4091                                                   '90' THRU '99'.
  4092         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4093                                          PIC XX.
  4094         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4095         16  PB-I-AMOUNT-FINANCED REDEFINES
  4096                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4097         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4098         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4099                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4100         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4101         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4102         16  PB-I-CLP-AMOUNT REDEFINES
  4103                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4104         16  PB-I-LF-CALC-FLAG            PIC X.
  4105             88 PB-COMP-LF-PREM               VALUE '?'.
  4106         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4107         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4108         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4109         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4110         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4111         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4112         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4113         16  PB-I-LF-ABBR                 PIC XXX.
  4114         16  PB-I-LF-INPUT-CD             PIC XX.
  4115
  4116         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4117             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4118             88  PB-INVALID-AH               VALUE '  ' '00'
  4119                                                   '90' THRU '99'.
  4120         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4121         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4122         16  PB-I-AH-CALC-FLAG            PIC X.
  4123             88 PB-COMP-AH-PREM                  VALUE '?'.
  4124         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4125         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4126         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4127         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4128         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4129         16  PB-I-AH-ABBR                 PIC XXX.
  4130         16  PB-I-AH-INPUT-CD             PIC XXX.
  4131
  4132         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4133         16  PB-I-REIN-TABLE              PIC XXX.
  4134         16  PB-I-BUSINESS-TYPE           PIC 99.
  4135         16  PB-I-INDV-GRP-CD             PIC X.
  4136         16  PB-I-MORT-CODE.
  4137             20  PB-I-TABLE               PIC X.
  4138             20  PB-I-INTEREST            PIC XX.
  4139             20  PB-I-MORT-TYP            PIC X.
  4140         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4141         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4142         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4143         16  PB-I-INDV-GRP-OVRD           PIC X.
  4144         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4145         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  78
* EL050.cbl
  4146             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4147         16  PB-I-RATE-CLASS              PIC XX.
  4148         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4149         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4150         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4151         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4152         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4153         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4154         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4155         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4156         16  PB-I-OB-FLAG                 PIC X.
  4157             88  PB-I-OB                      VALUE 'B'.
  4158             88  PB-I-SUMMARY                 VALUE 'Z'.
  4159         16  PB-I-ENTRY-STATUS            PIC X.
  4160             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4161                                              'M' '5' '9' '2'.
  4162             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4163             88  PB-I-POLICY-PENDING          VALUE '2'.
  4164             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4165             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4166             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4167             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4168             88  PB-I-REIN-ONLY               VALUE '9'.
  4169             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4170             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4171             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4172             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4173         16  PB-I-INT-CODE                PIC X.
  4174             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4175             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4176         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4177         16  PB-I-SOC-SEC-NO              PIC X(11).
  4178         16  PB-I-MEMBER-NO               PIC X(12).
  4179         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4180*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4181         16  PB-I-OLD-LOF                 PIC XXX.
  4182         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4183         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4184         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4185         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4186         16  PB-I-LIFE-INDICATOR          PIC X.
  4187             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4188         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4189         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4190                                          PIC S9(5)V99    COMP-3.
  4191         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4192             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4193             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4194         16  PB-I-1ST-PMT-DT              PIC XX.
  4195         16  PB-I-JOINT-INSURED.
  4196             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4197             20 PB-I-JOINT-FIRST-NAME.
  4198                24  PB-I-JOINT-FIRST-INIT PIC X.
  4199                24  FILLER                PIC X(9).
  4200             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4201*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4202         16  PB-I-BENEFICIARY-NAME.
  4203             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  79
* EL050.cbl
  4204             20  FILLER                   PIC X(15).
  4205         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4206         16  PB-I-REFERENCE               PIC X(12).
  4207         16  FILLER REDEFINES PB-I-REFERENCE.
  4208             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4209             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4210             20  PB-I-CLP-STATE           PIC XX.
  4211         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4212             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4213             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4214             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4215         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4216         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4217         16  PB-I-RESIDENT-STATE          PIC XX.
  4218         16  PB-I-RATE-CODE               PIC X(4).
  4219         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4220         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4221         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4222         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4223         16  PB-I-BANK-NOCHRGB            PIC 99.
  4224         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4225         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4226
  4227     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4228         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4229             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4230         16  PB-C-CANCEL-ORIGIN           PIC X.
  4231             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4232         16  PB-C-LF-CANCEL-DT            PIC XX.
  4233         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4234         16  PB-C-LF-CALC-REQ             PIC X.
  4235             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4236         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4237         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4238         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4239             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4240         16  PB-C-AH-CANCEL-DT            PIC XX.
  4241         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4242         16  PB-C-AH-CALC-REQ             PIC X.
  4243             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4244         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4245         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4246         16  PB-C-LAST-NAME               PIC X(15).
  4247         16  PB-C-REFUND-SW               PIC X.
  4248             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4249             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4250         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4251         16  PB-C-PAYEE-CODE              PIC X(6).
  4252         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4253         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4254         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4255         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4256         16  PB-C-REFERENCE               PIC X(12).
  4257         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4258         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4259         16  PB-C-POST-CARD-IND           PIC X.
  4260         16  PB-C-CANCEL-REASON           PIC X.
  4261         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  80
* EL050.cbl
  4262         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4263         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4264         16  FILLER                       PIC X(01).
  4265*        16  FILLER                       PIC X(18).
  4266         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4267*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4268         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4269         16  PB-CANCELED-CERT-DATA.
  4270             20  PB-CI-INSURED-NAME.
  4271                 24  PB-CI-LAST-NAME      PIC X(15).
  4272                 24  PB-CI-INITIALS       PIC XX.
  4273             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4274             20  PB-CI-INSURED-SEX        PIC X.
  4275             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4276             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4277             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4278             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4279             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4280             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4281             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4282             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4283             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4284             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4285             20  PB-CI-RATE-CLASS         PIC XX.
  4286             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4287             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4288             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4289             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4290             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4291             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4292             20  PB-CI-LF-ABBR            PIC X(3).
  4293             20  PB-CI-AH-ABBR            PIC X(3).
  4294             20  PB-CI-OB-FLAG            PIC X.
  4295                 88  PB-CI-OB                VALUE 'B'.
  4296             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4297                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4298                                           'M' '4' '5' '9' '2'.
  4299                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4300                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4301                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4302                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4303                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4304                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4305                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4306                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4307                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4308                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4309                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4310                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4311                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4312             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4313                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4314                                           'M' '4' '5' '9' '2'.
  4315                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4316                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4317                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4318                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4319                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  81
* EL050.cbl
  4320                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4321                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4322                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4323                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4324                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4325                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4326                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4327                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4328             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4329             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4330             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4331             20  PB-CI-MEMBER-NO          PIC X(12).
  4332             20  PB-CI-INT-CODE           PIC X.
  4333                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4334                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4335             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4336             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4337             20  PB-CI-COMP-EXCP-SW       PIC X.
  4338                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4339                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4340             20  PB-CI-ENTRY-STATUS       PIC X.
  4341             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4342             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4343             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4344             20  PB-CI-DEATH-DT           PIC XX.
  4345             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4346             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4347             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4348             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4349             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4350             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4351             20  PB-CI-ENTRY-DT              PIC XX.
  4352             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4353             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4354             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4355             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4356             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4357             20  PB-CI-OLD-LOF               PIC XXX.
  4358*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4359             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4360             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4361             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4362             20  PB-CI-INDV-GRP-CD           PIC X.
  4363             20  PB-CI-BENEFICIARY-NAME.
  4364                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4365                 24  FILLER                  PIC X(15).
  4366             20  PB-CI-NOTE-SW               PIC X.
  4367             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4368             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4369             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4370             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4371             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4372             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4373             20  PB-CI-FIRST-NAME            PIC X(10).
  4374             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4375
  4376         16  FILLER                       PIC X(13).
  4377*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  82
* EL050.cbl
  4378*        16  FILLER                       PIC X(46).
  4379
  4380     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4381         16  FILLER                       PIC X(10).
  4382         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4383         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4384         16  PB-M-INSURED-MID-INIT        PIC X.
  4385         16  PB-M-INSURED-AGE             PIC 99.
  4386         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4387         16  PB-M-INSURED-SEX             PIC X.
  4388         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4389         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4390         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4391         16  PB-M-INSURED-CITY-STATE.
  4392             20  PB-M-INSURED-CITY        PIC X(28).
  4393             20  PB-M-INSURED-STATE       PIC XX.
  4394         16  PB-M-INSURED-ZIP-CODE.
  4395             20  PB-M-INSURED-ZIP-PRIME.
  4396                 24  PB-M-INSURED-ZIP-1   PIC X.
  4397                     88  PB-M-CANADIAN-POST-CODE
  4398                                             VALUE 'A' THRU 'Z'.
  4399                 24  FILLER               PIC X(4).
  4400             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4401         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4402                                        PB-M-INSURED-ZIP-CODE.
  4403             20  PM-M-INS-CAN-POST1       PIC XXX.
  4404             20  PM-M-INS-CAN-POST2       PIC XXX.
  4405             20  FILLER                   PIC XXX.
  4406         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4407         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4408         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4409         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4410         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4411         16  PB-M-CRED-BENE-CITYST.
  4412             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4413             20  PB-M-CRED-BENE-STATE     PIC XX.
  4414         16  FILLER                       PIC X(92).
  4415
  4416     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4417         16  FILLER                       PIC X(10).
  4418         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4419         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4420         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4421         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4422         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4423         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4424         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4425         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4426         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4427         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4428         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4429         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4430         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4431         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4432         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4433         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4434         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4435         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  83
* EL050.cbl
  4436         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4437         16  PB-REFERENCE                 PIC X(12).
  4438         16  PB-B-RECEIVED-DT             PIC XX.
  4439         16  FILLER                       PIC X(234).
  4440
  4441     12  PB-RECORD-STATUS.
  4442         16  PB-CREDIT-SELECT-DT          PIC XX.
  4443         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4444         16  PB-BILLED-DT                 PIC XX.
  4445         16  PB-BILLING-STATUS            PIC X.
  4446             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4447             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4448             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4449         16  PB-RECORD-BILL               PIC X.
  4450             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4451             88  PB-RECORD-RETURNED           VALUE 'R'.
  4452             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4453             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4454             88  PB-OVERRIDE-AH               VALUE 'A'.
  4455             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4456         16  PB-BATCH-ENTRY               PIC X.
  4457             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4458             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4459             88  PB-REISSUED-CERT             VALUE 'E'.
  4460             88  PB-CASH-CERT                 VALUE 'C'.
  4461             88  PB-MONTHLY-CERT              VALUE 'M'.
  4462             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4463             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4464             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4465         16  PB-FORCE-CODE                PIC X.
  4466             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4467             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4468             88  PB-CANCEL-FORCE              VALUE '8'.
  4469             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4470             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4471             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4472             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4473             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4474             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4475             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4476         16  PB-FATAL-FLAG                PIC X.
  4477             88  PB-FATAL-ERRORS              VALUE 'X'.
  4478         16  PB-FORCE-ER-CD               PIC X.
  4479             88  PB-FORCE-ERRORS              VALUE 'F'.
  4480             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4481         16  PB-WARN-ER-CD                PIC X.
  4482             88  PB-WARNING-ERRORS            VALUE 'W'.
  4483         16  FILLER                       PIC X.
  4484         16  PB-OUT-BAL-CD                PIC X.
  4485             88  PB-OUT-OF-BAL                VALUE 'O'.
  4486         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4487         16  PB-AH-OVERRIDE-L1            PIC X.
  4488         16  PB-INPUT-DT                  PIC XX.
  4489         16  PB-INPUT-BY                  PIC X(4).
  4490         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4491         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4492         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4493         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  84
* EL050.cbl
  4494         16  PB-AH-EARNING-METHOD         PIC X.
  4495         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4496         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4497         16  PB-REIN-CD                   PIC XXX.
  4498         16  PB-LF-REFUND-TYPE            PIC X.
  4499         16  PB-AH-REFUND-TYPE            PIC X.
  4500         16  PB-ACCT-EFF-DT               PIC XX.
  4501         16  PB-ACCT-EXP-DT               PIC XX.
  4502         16  PB-COMPANY-ID                PIC X(3).
  4503         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4504         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4505         16  PB-SV-CARRIER                PIC X.
  4506         16  PB-SV-GROUPING               PIC X(6).
  4507         16  PB-SV-STATE                  PIC XX.
  4508         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4509         16  PB-GA-BILLING-INFO.
  4510             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4511                                          PIC XX.
  4512         16  PB-SV-REMIT-TO  REDEFINES
  4513             PB-GA-BILLING-INFO           PIC X(10).
  4514         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4515         16  PB-I-LOAN-OFFICER            PIC X(5).
  4516         16  PB-I-VIN                     PIC X(17).
  4517
  4518         16  FILLER                       PIC X(04).
  4519         16  IMNET-BYPASS-SW              PIC X.
  4520
  4521******************************************************************
  4522*                COMMON EDIT ERRORS                              *
  4523******************************************************************
  4524
  4525     12  PB-COMMON-ERRORS.
  4526         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4527                                           PIC S9(4)     COMP.
  4528
  4529******************************************************************
  4530
  4531* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4532*    COPY ELC50W1.
  4533******************************************************************
  4534*                                                                *
  4535*                                                                *
  4536*                             ELC50W1                            *
  4537*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4538*                            VMOD=2.004                          *
  4539*                                                                *
  4540*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4541*                                                                *
  4542*                                                                *
  4543******************************************************************
  4544
  4545     12  WK-WORK-AREA.
  4546         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4547         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4548         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4549         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4550         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4551         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  85
* EL050.cbl
  4552         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4553         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4554         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4555         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4556         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4557         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4558         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4559         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4560         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4561         16  WK-CREDIT-EDIT-CONTROLS.
  4562             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4563             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4564             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4565             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4566             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4567             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4568         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4569         16  WK-SAVE-REIN-DATA.
  4570             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4571             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4572             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4573         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4574             88  ENTRY-FROM-EL6311       VALUE '6'.
  4575         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4576         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4577     12  WK-RECORD-ADDRESSES.
  4578         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4579         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4580         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4581         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4582         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4583         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4584         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4585         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4586     12  WK-OVER-SHORT-AREA.
  4587         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4588         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4589         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4590             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4591         16  FILLER                   PIC X(5) VALUE SPACES.
  4592
  4593*    COPY ELCEDITC.
  4594******************************************************************
  4595*                                                                *
  4596*                                                                *
  4597*                            ELCEDITC                            *
  4598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4599*                            VMOD=2.012                          *
  4600*                                                                *
  4601*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4602*                     EL6313, EL050 AND EL517.                   *
  4603*                                                                *
  4604******************************************************************
  4605******************************************************************
  4606*                   C H A N G E   L O G
  4607*
  4608* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4609*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  86
* EL050.cbl
  4610*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4611* EFFECTIVE    NUMBER
  4612*-----------------------------------------------------------------
  4613* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4614******************************************************************
  4615
  4616     12  EDIT-CRITERIA-DATA.
  4617         16  EC-CO-MONTH-END-DT       PIC XX.
  4618         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4619         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4620         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4621         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4622         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4623         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4624         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4625         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4626         16  EC-CO-REM-TERM-CALC      PIC X.
  4627               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4628               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4629               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4630               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4631
  4632         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4633               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4634               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4635               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4636               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4637               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4638               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4639               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4640               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4641               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4642               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4643
  4644         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4645               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4646               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4647               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4648               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4649               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4650               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4651               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4652               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4653
  4654         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4655                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4656                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4657
  4658         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4659                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4660                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4661                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4662                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4663                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4664                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4665                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4666                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4667
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  87
* EL050.cbl
  4668         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4669               88  EC-BR-REDUCING                   VALUE 'R'.
  4670               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4671
  4672         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4673         16  EC-BR-LF-DESC             PIC X(10).
  4674         16  EC-BR-AH-DESC             PIC X(10).
  4675         16  EC-BR-LF-COMMENT          PIC X(10).
  4676         16  EC-BR-AH-COMMENT          PIC X(10).
  4677
  4678         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4679               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4680               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4681               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4682               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4683
  4684         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4685               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4686               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4687               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4688               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4689
  4690         16  EC-BR-LF-REFUND-CALC      PIC X.
  4691                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4692                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4693                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4694                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4695                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4696                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4697                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4698
  4699         16  EC-BR-AH-REFUND-CALC      PIC X.
  4700                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4701                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4702                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4703                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4704                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4705                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4706                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4707                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4708
  4709         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4710                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4711                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4712                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4713
  4714         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4715                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4716                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4717                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4718
  4719         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4720         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4721         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4722         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4723
  4724         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4725         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  88
* EL050.cbl
  4726                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4727                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4728                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4729                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4730
  4731         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4732               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4733               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4734               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4735               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4736               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4737
  4738         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4739               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4740               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4741               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4742               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4743               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4744
  4745         16  EC-ST-LF-REFUND-CALC      PIC X.
  4746                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4747                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4748                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4749                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4750                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4751                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4752                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4753                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4754
  4755         16  EC-ST-AH-REFUND-CALC      PIC X.
  4756                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4757                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4758                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4759                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4760                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4761                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4762                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4763                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4764
  4765         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4766         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4767         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4768         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4769         16  EC-AM-EXPIRATION-DT       PIC XX.
  4770         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4771         16  EC-AM-CLASS-CD            PIC XX.
  4772         16  EC-AM-LF-DEVIATION        PIC XXX.
  4773         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4774         16  EC-AM-AH-DEVIATION        PIC XXX.
  4775         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4776         16  EC-AM-PHONE-NO            PIC X(10).
  4777
  4778         16  EC-AM-LF-REFUND-CALC      PIC X.
  4779                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4780                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4781                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4782                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4783                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  89
* EL050.cbl
  4784                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4785                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4786
  4787         16  EC-AM-AH-REFUND-CALC      PIC X.
  4788                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4789                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4790                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4791                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4792                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4793                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4794                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4795
  4796         16  EC-AM-BEN-I-G-CD          PIC X.
  4797                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4798                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4799                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4800
  4801         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4802         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4803         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4804         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4805         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4806         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4807         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4808         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4809         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4810
  4811         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4812         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4813         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4814         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4815         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4816         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4817         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4818         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4819         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4820         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4821         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4822         16  EC-RT-LF-NSP-ST           PIC XX.
  4823         16  EC-RT-AH-NSP-ST           PIC XX.
  4824         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4825         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4826
  4827         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4828             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4829                                             'M' '5' '9' '2'.
  4830             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4831             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4832             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4833             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4834             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4835             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4836             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4837             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4838             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4839             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4840
  4841         16  EC-CM-AH-PRIOR-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  90
* EL050.cbl
  4842             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4843                                             'M' '5' '9' '2'.
  4844             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4845             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4846             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4847             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4848             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4849             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4850             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4851             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4852             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4853             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4854
  4855         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4856         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4857         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4858         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4859         16  EC-CM-DEATH-DT            PIC XX.
  4860
  4861*DMD CUSTOM CODING FIELDS BELOW
  4862*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4863         16  EC-BR-DMD-RATING-SW       PIC X.
  4864                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4865                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4866                 88  NO-DMD-RATING               VALUE 'N'.
  4867
  4868         16  EC-NEW-CERT               PIC X(11).
  4869         16  EC-NEW-STATE              PIC XX.
  4870         16  FILLER                    PIC X.
  4871*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4872         16  OVER-SHORT-EDIT-FIELDS.
  4873             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4874             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4875             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4876             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4877             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4878             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4879             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4880             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4881             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4882         16  FILLER                    PIC X(71).
  4883******************************************************************
  4884
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  91
* EL050.cbl
  4886*    COPY ELCDIFRD.
  4887******************************************************************
  4888*                                                                *
  4889*                                                                *
  4890*                            ELCDIFRD.                           *
  4891*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4892*                            VMOD=2.004                          *
  4893*                                                                *
  4894*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4895*                                                                *
  4896******************************************************************
  4897*
  4898  01  WS-DIFFERENCE-CALCULATION.
  4899        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4900        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4901        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4902        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4903        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4904        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4905        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4906        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4907        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4908        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4909        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4910
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  92
* EL050.cbl
  4912****************************************************************
  4913*
  4914* Copyright (c) 2007 by Clerity Solutions, Inc.
  4915* All rights reserved.
  4916*
  4917****************************************************************
  4918 01  DFHEIV.
  4919   02  DFHEIV0               PIC X(35).
  4920   02  DFHEIV1               PIC X(08).
  4921   02  DFHEIV2               PIC X(08).
  4922   02  DFHEIV3               PIC X(08).
  4923   02  DFHEIV4               PIC X(06).
  4924   02  DFHEIV5               PIC X(04).
  4925   02  DFHEIV6               PIC X(04).
  4926   02  DFHEIV7               PIC X(02).
  4927   02  DFHEIV8               PIC X(02).
  4928   02  DFHEIV9               PIC X(01).
  4929   02  DFHEIV10              PIC S9(7) COMP-3.
  4930   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4931   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4932   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4933   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4934   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4935   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4936   02  DFHEIV17              PIC X(04).
  4937   02  DFHEIV18              PIC X(04).
  4938   02  DFHEIV19              PIC X(04).
  4939   02  DFHEIV20              USAGE IS POINTER.
  4940   02  DFHEIV21              USAGE IS POINTER.
  4941   02  DFHEIV22              USAGE IS POINTER.
  4942   02  DFHEIV23              USAGE IS POINTER.
  4943   02  DFHEIV24              USAGE IS POINTER.
  4944   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4945   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4946   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4947   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4948   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4949   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4950   02  FILLER                PIC X(02).
  4951   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4952   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4953   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4954   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4955   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4956 LINKAGE  SECTION.
  4957*****************************************************************
  4958*                                                               *
  4959* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4960* All rights reserved.                                          *
  4961*                                                               *
  4962*****************************************************************
  4963 01  dfheiblk.
  4964     02  eibtime          pic s9(7) comp-3.
  4965     02  eibdate          pic s9(7) comp-3.
  4966     02  eibtrnid         pic x(4).
  4967     02  eibtaskn         pic s9(7) comp-3.
  4968     02  eibtrmid         pic x(4).
  4969     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  93
* EL050.cbl
  4970     02  eibcposn         pic s9(4) comp.
  4971     02  eibcalen         pic s9(4) comp.
  4972     02  eibaid           pic x(1).
  4973     02  eibfiller1       pic x(1).
  4974     02  eibfn            pic x(2).
  4975     02  eibfiller2       pic x(2).
  4976     02  eibrcode         pic x(6).
  4977     02  eibfiller3       pic x(2).
  4978     02  eibds            pic x(8).
  4979     02  eibreqid         pic x(8).
  4980     02  eibrsrce         pic x(8).
  4981     02  eibsync          pic x(1).
  4982     02  eibfree          pic x(1).
  4983     02  eibrecv          pic x(1).
  4984     02  eibsend          pic x(1).
  4985     02  eibatt           pic x(1).
  4986     02  eibeoc           pic x(1).
  4987     02  eibfmh           pic x(1).
  4988     02  eibcompl         pic x(1).
  4989     02  eibsig           pic x(1).
  4990     02  eibconf          pic x(1).
  4991     02  eiberr           pic x(1).
  4992     02  eibrldbk         pic x(1).
  4993     02  eiberrcd         pic x(4).
  4994     02  eibsynrb         pic x(1).
  4995     02  eibnodat         pic x(1).
  4996     02  eibfiller5       pic x(2).
  4997     02  eibresp          pic 9(09) comp.
  4998     02  eibresp2         pic 9(09) comp.
  4999     02  dfheigdj         pic s9(4) comp.
  5000     02  dfheigdk         pic s9(4) comp.
  5001
  5002 01  DFHCOMMAREA                   PIC X(1036).
  5003
  5004*01 PARMLIST .
  5005*    02  FILLER                    PIC S9(8)   COMP.
  5006*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5007*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5008*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5009*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5010*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5011*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5012*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5013
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  94
* EL050.cbl
  5015*    COPY ELCCNTL.
  5016******************************************************************
  5017*                                                                *
  5018*                                                                *
  5019*                            ELCCNTL.                            *
  5020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5021*                            VMOD=2.059                          *
  5022*                                                                *
  5023*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5024*                                                                *
  5025*   FILE TYPE = VSAM,KSDS                                        *
  5026*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5027*                                                                *
  5028*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5029*       ALTERNATE INDEX = NONE                                   *
  5030*                                                                *
  5031*   LOG = YES                                                    *
  5032*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5033******************************************************************
  5034*                   C H A N G E   L O G
  5035*
  5036* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5037*-----------------------------------------------------------------
  5038*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5039* EFFECTIVE    NUMBER
  5040*-----------------------------------------------------------------
  5041* 082503                   PEMA  ADD BENEFIT GROUP
  5042* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5043* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5044* 092705    2005050300006  PEMA  ADD SPP LEASES
  5045* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5046* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5047* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5048* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5049* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5050* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5051* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5052* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5053* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5054* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5055******************************************************************
  5056*
  5057 01  CONTROL-FILE.
  5058     12  CF-RECORD-ID                       PIC XX.
  5059         88  VALID-CF-ID                        VALUE 'CF'.
  5060
  5061     12  CF-CONTROL-PRIMARY.
  5062         16  CF-COMPANY-ID                  PIC XXX.
  5063         16  CF-RECORD-TYPE                 PIC X.
  5064             88  CF-COMPANY-MASTER              VALUE '1'.
  5065             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5066             88  CF-STATE-MASTER                VALUE '3'.
  5067             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5068             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5069             88  CF-CARRIER-MASTER              VALUE '6'.
  5070             88  CF-MORTALITY-MASTER            VALUE '7'.
  5071             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5072             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  95
* EL050.cbl
  5073             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5074             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5075             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5076             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5077             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5078             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5079             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5080             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5081             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5082         16  CF-ACCESS-CD-GENL              PIC X(4).
  5083         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5084             20  CF-PROCESSOR               PIC X(4).
  5085         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5086             20  CF-STATE-CODE              PIC XX.
  5087             20  FILLER                     PIC XX.
  5088         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5089             20  FILLER                     PIC XX.
  5090             20  CF-HI-BEN-IN-REC           PIC XX.
  5091         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5092             20  FILLER                     PIC XXX.
  5093             20  CF-CARRIER-CNTL            PIC X.
  5094         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5095             20  FILLER                     PIC XX.
  5096             20  CF-HI-TYPE-IN-REC          PIC 99.
  5097         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5098             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5099                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5100             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5101             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5102         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5103             20  FILLER                     PIC X.
  5104             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5105         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5106             20  FILLER                     PIC XX.
  5107             20  CF-MORTGAGE-PLAN           PIC XX.
  5108         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5109
  5110     12  CF-LAST-MAINT-DT                   PIC XX.
  5111     12  CF-LAST-MAINT-BY                   PIC X(4).
  5112     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5113
  5114     12  CF-RECORD-BODY                     PIC X(728).
  5115
  5116
  5117****************************************************************
  5118*             COMPANY MASTER RECORD                            *
  5119****************************************************************
  5120
  5121     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5122         16  CF-COMPANY-ADDRESS.
  5123             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5124             20  CF-CL-IN-CARE-OF           PIC X(30).
  5125             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5126             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5127             20  CF-CL-CITY-STATE           PIC X(30).
  5128             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5129             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5130         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  96
* EL050.cbl
  5131         16  CF-COMPANY-PASSWORD            PIC X(8).
  5132         16  CF-SECURITY-OPTION             PIC X.
  5133             88  ALL-SECURITY                   VALUE '1'.
  5134             88  COMPANY-VERIFY                 VALUE '2'.
  5135             88  PROCESSOR-VERIFY               VALUE '3'.
  5136             88  NO-SECURITY                    VALUE '4'.
  5137             88  ALL-BUT-TERM                   VALUE '5'.
  5138         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5139             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5140         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5141             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5142         16  CF-INFORCE-LOCATION            PIC X.
  5143             88  CERTS-ARE-ONLINE               VALUE '1'.
  5144             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5145             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5146         16  CF-LOWER-CASE-LETTERS          PIC X.
  5147         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5148             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5149             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5150             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5151             88  CF-ACCNT-CNTL                  VALUE '3'.
  5152             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5153
  5154         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5155         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5156
  5157         16  CF-LGX-CREDIT-USER             PIC X.
  5158             88  CO-IS-NOT-USER                 VALUE 'N'.
  5159             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5160
  5161         16 CF-CREDIT-CALC-CODES.
  5162             20  CF-CR-REM-TERM-CALC PIC X.
  5163               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5164               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5165               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5166               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5167               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5168               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5169               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5170             20  CF-CR-R78-METHOD           PIC X.
  5171               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5172               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5173
  5174         16  CF-CLAIM-CONTROL-COUNTS.
  5175             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5176                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5177
  5178             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5179                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5180
  5181             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5182                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5183
  5184             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5185                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5186
  5187         16  CF-CURRENT-MONTH-END           PIC XX.
  5188
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  97
* EL050.cbl
  5189         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5190             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5191             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5192             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5193             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5194                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5195                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5196             20  CF-CO-PREM-REJECT-SW       PIC X.
  5197                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5198                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5199             20  CF-CO-REF-REJECT-SW        PIC X.
  5200                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5201                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5202
  5203         16  CF-CO-REPORTING-DT             PIC XX.
  5204         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5205         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5206           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5207           88  CF-CO-MONTH-END                  VALUE '1'.
  5208
  5209         16  CF-LGX-CLAIM-USER              PIC X.
  5210             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5211             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5212
  5213         16  CF-CREDIT-EDIT-CONTROLS.
  5214             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5215             20  CF-MIN-AGE                 PIC 99.
  5216             20  CF-DEFAULT-AGE             PIC 99.
  5217             20  CF-MIN-TERM                PIC S999      COMP-3.
  5218             20  CF-MAX-TERM                PIC S999      COMP-3.
  5219             20  CF-DEFAULT-SEX             PIC X.
  5220             20  CF-JOINT-AGE-INPUT         PIC X.
  5221                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5222             20  CF-BIRTH-DATE-INPUT        PIC X.
  5223                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5224             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5225                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5226                 88  CF-ZERO-CARRIER            VALUE '1'.
  5227                 88  CF-ZERO-GROUPING           VALUE '2'.
  5228                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5229             20  CF-EDIT-SW                 PIC X.
  5230                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5231             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5232             20  CF-CR-PR-METHOD            PIC X.
  5233               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5234               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5235             20  FILLER                     PIC X.
  5236
  5237         16  CF-CREDIT-MISC-CONTROLS.
  5238             20  CF-REIN-TABLE-SW           PIC X.
  5239                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5240             20  CF-COMP-TABLE-SW           PIC X.
  5241                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5242             20  CF-EXPERIENCE-RETENTION-AGE
  5243                                            PIC S9        COMP-3.
  5244             20  CF-CONVERSION-DT           PIC XX.
  5245             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5246             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  98
* EL050.cbl
  5247                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5248                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5249
  5250             20  CF-CR-CHECK-NO-CONTROL.
  5251                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5252                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5253                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5254                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5255                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5256                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5257
  5258                 24  CF-CR-CHECK-COUNT       REDEFINES
  5259                     CF-CR-CHECK-COUNTER      PIC X(4).
  5260
  5261                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5262                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5263
  5264                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5265                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5266                 24  CF-MAIL-PROCESSING       PIC X.
  5267                     88  MAIL-PROCESSING          VALUE 'Y'.
  5268
  5269         16  CF-MISC-SYSTEM-CONTROL.
  5270             20  CF-SYSTEM-C                 PIC X.
  5271                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5272             20  CF-SYSTEM-D                 PIC X.
  5273                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5274             20  CF-SOC-SEC-NO-SW            PIC X.
  5275                 88  SOC-SEC-NO-USED             VALUE '1'.
  5276             20  CF-MEMBER-NO-SW             PIC X.
  5277                 88  MEMBER-NO-USED              VALUE '1'.
  5278             20  CF-TAX-ID-NUMBER            PIC X(11).
  5279             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5280             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5281                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5282                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5283                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5284                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5285             20  CF-SYSTEM-E                 PIC X.
  5286                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5287
  5288         16  CF-LGX-LIFE-USER               PIC X.
  5289             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5290             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5291
  5292         16  CF-CR-MONTH-END-DT             PIC XX.
  5293
  5294         16  CF-FILE-MAINT-DATES.
  5295             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5296                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5297             20  CF-LAST-BATCH       REDEFINES
  5298                 CF-LAST-BATCH-NO               PIC X(4).
  5299             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5300             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5301             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5302             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5303             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5304             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page  99
* EL050.cbl
  5305             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5306             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5307             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5308             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5309
  5310         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5311         16  FILLER                         PIC X.
  5312
  5313         16  CF-ALT-MORT-CODE               PIC X(4).
  5314         16  CF-MEMBER-CAPTION              PIC X(10).
  5315
  5316         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5317             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5318             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5319             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5320             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5321             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5322
  5323         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5324
  5325         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5326         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5327         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5328         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5329
  5330         16  CF-AH-OVERRIDE-L1              PIC X.
  5331         16  CF-AH-OVERRIDE-L2              PIC XX.
  5332         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5333         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5334
  5335         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5336         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5337
  5338         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5339         16  CF-AR-LAST-EL860-DT            PIC XX.
  5340         16  CF-MP-MONTH-END-DT             PIC XX.
  5341
  5342         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5343         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5344             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5345
  5346         16  CF-AR-MONTH-END-DT             PIC XX.
  5347
  5348         16  CF-CRDTCRD-USER                PIC X.
  5349             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5350             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5351
  5352         16  CF-CC-MONTH-END-DT             PIC XX.
  5353
  5354         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5355
  5356         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5357             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5358             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5359             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5360         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5361         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5362         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 100
* EL050.cbl
  5363         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5364             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5365             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5366         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5367         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5368         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5369             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5370         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5371
  5372         16  CF-CL-ZIP-CODE.
  5373             20  CF-CL-ZIP-PRIME.
  5374                 24  CF-CL-ZIP-1ST          PIC X.
  5375                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5376                 24  FILLER                 PIC X(4).
  5377             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5378         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5379             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5380             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5381             20  FILLER                     PIC XXX.
  5382
  5383         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5384         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5385         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5386         16  CF-CO-OPTION-START-DATE        PIC XX.
  5387         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5388           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5389                                                      '3' '4'.
  5390           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5391           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5392           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5393           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5394           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5395           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5396
  5397         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5398
  5399         16  CF-PAYMENT-APPROVAL-LEVELS.
  5400             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5401             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5402             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5403             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5404             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5405             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5406
  5407         16  CF-END-USER-REPORTING-USER     PIC X.
  5408             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5409             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5410
  5411         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5412             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5413             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5414
  5415         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5416
  5417         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5418         16  FILLER                         PIC X.
  5419
  5420         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 101
* EL050.cbl
  5421             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5422             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5423             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5424
  5425         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5426
  5427         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5428             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5429             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5430
  5431         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5432             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5433             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5434
  5435         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5436
  5437         16  CF-CO-ACH-ID-CODE              PIC  X.
  5438             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5439             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5440             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5441         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5442         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5443         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5444         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5445         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5446         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5447         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5448         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5449         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5450                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5451         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5452                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5453
  5454         16  CF-CO-OVER-SHORT.
  5455             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5456             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5457
  5458*         16  FILLER                         PIC X(102).
  5459         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5460             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5461             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5462
  5463         16  CF-AH-APPROVAL-DAYS.
  5464             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5465             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5466             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5467             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5468
  5469         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5470
  5471         16  CF-APPROV-LEV-5.
  5472             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5473             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5474             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5475
  5476         16  FILLER                         PIC X(68).
  5477****************************************************************
  5478*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 102
* EL050.cbl
  5479****************************************************************
  5480
  5481     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5482         16  CF-PROCESSOR-NAME              PIC X(30).
  5483         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5484         16  CF-PROCESSOR-TITLE             PIC X(26).
  5485         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5486                 88  MESSAGE-YES                VALUE 'Y'.
  5487                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5488
  5489*****************************************************
  5490****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5491****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5492****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5493****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5494*****************************************************
  5495
  5496         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5497             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5498             20  CF-APPLICATION-FORCE       PIC X.
  5499             20  CF-INDIVIDUAL-APP.
  5500                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5501                     28  CF-BROWSE-APP      PIC X.
  5502                     28  CF-UPDATE-APP      PIC X.
  5503
  5504         16  CF-CURRENT-TERM-ON             PIC X(4).
  5505         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5506             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5507             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5508             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5509             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5510             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5511             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5512             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5513         16  CF-PROCESSOR-CARRIER           PIC X.
  5514             88  NO-CARRIER-SECURITY            VALUE ' '.
  5515         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5516             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5517         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5518             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5519         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5520             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5521
  5522         16  CF-PROC-SYS-ACCESS-SW.
  5523             20  CF-PROC-CREDIT-CLAIMS-SW.
  5524                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5525                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5526                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5527                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5528             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5529                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5530                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5531             20  CF-PROC-LIFE-GNRLDGR-SW.
  5532                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5533                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5534                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5535                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5536             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 103
* EL050.cbl
  5537                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5538                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5539         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5540             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5541             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5542         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5543
  5544         16  CF-APPROVAL-LEVEL                  PIC X.
  5545             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5546             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5547             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5548             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5549             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5550
  5551         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5552
  5553         16  CF-LANGUAGE-TYPE                   PIC X.
  5554             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5555             88  CF-LANG-IS-FR                      VALUE 'F'.
  5556
  5557         16  CF-CSR-IND                         PIC X.
  5558         16  FILLER                             PIC X(239).
  5559
  5560****************************************************************
  5561*             PROCESSOR/REMINDERS RECORD                       *
  5562****************************************************************
  5563
  5564     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5565         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5566             20  CF-START-REMIND-DT         PIC XX.
  5567             20  CF-END-REMIND-DT           PIC XX.
  5568             20  CF-REMINDER-TEXT           PIC X(50).
  5569         16  FILLER                         PIC X(296).
  5570
  5571
  5572****************************************************************
  5573*             STATE MASTER RECORD                              *
  5574****************************************************************
  5575
  5576     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5577         16  CF-STATE-ABBREVIATION          PIC XX.
  5578         16  CF-STATE-NAME                  PIC X(25).
  5579         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5580         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5581             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5582             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5583             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5584             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5585                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5586                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5587             20  CF-ST-PREM-REJECT-SW       PIC X.
  5588                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5589                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5590             20  CF-ST-REF-REJECT-SW        PIC X.
  5591                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5592                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5593         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5594         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 104
* EL050.cbl
  5595         16  CF-ST-REFUND-RULES.
  5596             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5597             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5598             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5599         16  CF-ST-FST-PMT-EXTENSION.
  5600             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5601             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5602                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5603                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5604                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5605                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5606         16  CF-ST-STATE-CALL.
  5607             20  CF-ST-CALL-UNEARNED        PIC X.
  5608             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5609             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5610         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5611             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5612             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5613         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5614         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5615         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5616         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5617         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5618         16  FILLER                         PIC X.
  5619         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5620             20  CF-ST-BENEFIT-CD           PIC XX.
  5621             20  CF-ST-BENEFIT-KIND         PIC X.
  5622                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5623                 88  CF-ST-AH-KIND              VALUE 'A'.
  5624             20  CF-ST-REM-TERM-CALC        PIC X.
  5625                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5626                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5627                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5628                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5629                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5630                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5631                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5632                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5633
  5634             20  CF-ST-REFUND-CALC          PIC X.
  5635                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5636                 88  ST-REFD-BY-R78             VALUE '1'.
  5637                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5638                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5639                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5640                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5641                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5642                 88  ST-REFD-UTAH               VALUE '7'.
  5643                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5644                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5645                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5646
  5647             20  CF-ST-EARNING-CALC         PIC X.
  5648                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5649                 88  ST-EARN-BY-R78             VALUE '1'.
  5650                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5651                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5652                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 105
* EL050.cbl
  5653                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5654                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5655                 88  ST-EARN-MEAN               VALUE '8'.
  5656                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5657
  5658             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5659                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5660                 88  ST-OVRD-BY-R78             VALUE '1'.
  5661                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5662                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5663                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5664                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5665                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5666                 88  ST-OVRD-MEAN               VALUE '8'.
  5667                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5668             20  cf-st-extra-periods        pic 9.
  5669*            20  FILLER                     PIC X.
  5670
  5671         16  CF-ST-COMMISSION-CAPS.
  5672             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5673             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5674             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5675             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5676         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5677                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5678
  5679         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5680
  5681         16  CF-ST-STATUTORY-INTEREST.
  5682             20  CF-ST-STAT-DATE-FROM       PIC X.
  5683                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5684                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5685             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5686             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5687             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5688             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5689             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5690
  5691         16  CF-ST-OVER-SHORT.
  5692             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5693             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5694
  5695         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5696
  5697         16  CF-ST-RT-CALC                  PIC X.
  5698
  5699         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5700         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5701         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5702         16  CF-ST-RF-LR-CALC               PIC X.
  5703         16  CF-ST-RF-LL-CALC               PIC X.
  5704         16  CF-ST-RF-LN-CALC               PIC X.
  5705         16  CF-ST-RF-AH-CALC               PIC X.
  5706         16  CF-ST-RF-CP-CALC               PIC X.
  5707*        16  FILLER                         PIC X(206).
  5708*CIDMOD         16  FILLER                         PIC X(192).
  5709         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5710             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 106
* EL050.cbl
  5711         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5712         16  CF-ST-VFY-2ND-BENE             PIC X.
  5713         16  CF-ST-CAUSAL-STATE             PIC X.
  5714         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5715         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5716         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5717             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5718         16  CF-ST-NET-ONLY-STATE           PIC X.
  5719             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5720         16  FILLER                         PIC X(181).
  5721
  5722****************************************************************
  5723*             BENEFIT MASTER RECORD                            *
  5724****************************************************************
  5725
  5726     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5727         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5728             20  CF-BENEFIT-CODE            PIC XX.
  5729             20  CF-BENEFIT-NUMERIC  REDEFINES
  5730                 CF-BENEFIT-CODE            PIC XX.
  5731             20  CF-BENEFIT-ALPHA           PIC XXX.
  5732             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5733             20  CF-BENEFIT-COMMENT         PIC X(10).
  5734
  5735             20  CF-LF-COVERAGE-TYPE        PIC X.
  5736                 88  CF-REDUCING                VALUE 'R'.
  5737                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5738
  5739             20  CF-SPECIAL-CALC-CD         PIC X.
  5740                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5741                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5742                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5743                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5744                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5745                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5746                 88  CF-FARM-PLAN               VALUE 'F'.
  5747                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5748                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5749                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5750                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5751                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5752                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5753                 88  CF-PRUDENTIAL              VALUE 'P'.
  5754                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5755                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5756                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5757                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5758                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5759                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5760
  5761             20  CF-JOINT-INDICATOR         PIC X.
  5762                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5763
  5764*            20  FILLER                     PIC X(12).
  5765             20  cf-maximum-benefits        pic s999 comp-3.
  5766             20  FILLER                     PIC X(09).
  5767             20  CF-BENEFIT-CATEGORY        PIC X.
  5768             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 107
* EL050.cbl
  5769
  5770             20  CF-CO-REM-TERM-CALC        PIC X.
  5771                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5772                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5773                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5774                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5775                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5776
  5777             20  CF-CO-EARNINGS-CALC        PIC X.
  5778                 88  CO-EARN-BY-R78             VALUE '1'.
  5779                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5780                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5781                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5782                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5783                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5784                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5785                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5786
  5787             20  CF-CO-REFUND-CALC          PIC X.
  5788                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5789                 88  CO-REFD-BY-R78             VALUE '1'.
  5790                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5791                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5792                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5793                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5794                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5795                 88  CO-REFD-MEAN               VALUE '8'.
  5796                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5797                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5798                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5799
  5800             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5801                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5802                 88  CO-OVRD-BY-R78             VALUE '1'.
  5803                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5804                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5805                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5806                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5807                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5808                 88  CO-OVRD-MEAN               VALUE '8'.
  5809                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5810
  5811             20  CF-CO-BEN-I-G-CD           PIC X.
  5812                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5813                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5814                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5815
  5816         16  FILLER                         PIC X(304).
  5817
  5818
  5819****************************************************************
  5820*             CARRIER MASTER RECORD                            *
  5821****************************************************************
  5822
  5823     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5824         16  CF-ADDRESS-DATA.
  5825             20  CF-MAIL-TO-NAME            PIC X(30).
  5826             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 108
* EL050.cbl
  5827             20  CF-ADDRESS-LINE-1          PIC X(30).
  5828             20  CF-ADDRESS-LINE-2          PIC X(30).
  5829             20  CF-CITY-STATE              PIC X(30).
  5830             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5831             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5832
  5833         16  CF-CLAIM-NO-CONTROL.
  5834             20  CF-CLAIM-NO-METHOD         PIC X.
  5835                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5836                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5837                 88  CLAIM-NO-SEQ               VALUE '3'.
  5838                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5839             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5840                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5841                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5842                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5843
  5844         16  CF-CHECK-NO-CONTROL.
  5845             20  CF-CHECK-NO-METHOD         PIC X.
  5846                 88  CHECK-NO-MANUAL            VALUE '1'.
  5847                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5848                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5849                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5850             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5851                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5852
  5853         16  CF-DOMICILE-STATE              PIC XX.
  5854
  5855         16  CF-EXPENSE-CONTROLS.
  5856             20  CF-EXPENSE-METHOD          PIC X.
  5857                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5858                 88  DOLLARS-PER-PMT            VALUE '2'.
  5859                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5860                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5861             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5862             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5863
  5864         16  CF-CORRESPONDENCE-CONTROL.
  5865             20  CF-LETTER-RESEND-OPT       PIC X.
  5866                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5867                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5868             20  FILLER                     PIC X(4).
  5869
  5870         16  CF-RESERVE-CONTROLS.
  5871             20  CF-MANUAL-SW               PIC X.
  5872                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5873             20  CF-FUTURE-SW               PIC X.
  5874                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5875             20  CF-PTC-SW                  PIC X.
  5876                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5877             20  CF-IBNR-SW                 PIC X.
  5878                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5879             20  CF-PTC-LF-SW               PIC X.
  5880                 88  CF-LF-PTC-USED             VALUE '1'.
  5881             20  CF-CDT-ACCESS-METHOD       PIC X.
  5882                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5883                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5884                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 109
* EL050.cbl
  5885             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5886
  5887         16  CF-CLAIM-CALC-METHOD           PIC X.
  5888             88  360-PLUS-MONTHS                VALUE '1'.
  5889             88  365-PLUS-MONTHS                VALUE '2'.
  5890             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5891             88  360-DAILY                      VALUE '4'.
  5892             88  365-DAILY                      VALUE '5'.
  5893
  5894         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5895         16  FILLER                         PIC X(11).
  5896
  5897         16  CF-LIMIT-AMOUNTS.
  5898             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5899             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5900             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5901             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5902             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5903             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5904             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5905             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5906             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5907             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5908
  5909         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5910         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5911         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5912
  5913         16  CF-ZIP-CODE.
  5914             20  CF-ZIP-PRIME.
  5915                 24  CF-ZIP-1ST             PIC X.
  5916                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5917                 24  FILLER                 PIC X(4).
  5918             20  CF-ZIP-PLUS4               PIC X(4).
  5919         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5920             20  CF-CAN-POSTAL-1            PIC XXX.
  5921             20  CF-CAN-POSTAL-2            PIC XXX.
  5922             20  FILLER                     PIC XXX.
  5923
  5924         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5925         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5926         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5927
  5928         16  CF-RATING-SWITCH               PIC X.
  5929             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5930             88  CF-NO-RATING                   VALUE 'N'.
  5931
  5932         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5933
  5934         16  CF-CARRIER-OVER-SHORT.
  5935             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5936             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5937
  5938         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5939         16  CF-SECPAY-SWITCH               PIC X.
  5940             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5941             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5942         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 110
* EL050.cbl
  5943         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5944         16  FILLER                         PIC X(444).
  5945*        16  FILLER                         PIC X(452).
  5946
  5947
  5948****************************************************************
  5949*             MORTALITY MASTER RECORD                          *
  5950****************************************************************
  5951
  5952     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5953         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5954                                INDEXED BY CF-MORT-NDX.
  5955             20  CF-MORT-TABLE              PIC X(5).
  5956             20  CF-MORT-TABLE-TYPE         PIC X.
  5957                 88  CF-MORT-JOINT              VALUE 'J'.
  5958                 88  CF-MORT-SINGLE             VALUE 'S'.
  5959                 88  CF-MORT-COMBINED           VALUE 'C'.
  5960                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5961                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5962             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5963             20  CF-MORT-AGE-METHOD         PIC XX.
  5964                 88  CF-AGE-LAST                VALUE 'AL'.
  5965                 88  CF-AGE-NEAR                VALUE 'AN'.
  5966             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5967             20  CF-MORT-ADJUSTMENT-DIRECTION
  5968                                            PIC X.
  5969                 88  CF-MINUS                   VALUE '-'.
  5970                 88  CF-PLUS                    VALUE '+'.
  5971             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5972             20  CF-MORT-JOINT-CODE         PIC X.
  5973                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5974             20  CF-MORT-PC-Q               PIC X.
  5975                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5976             20  CF-MORT-TABLE-CODE         PIC X(4).
  5977             20  CF-MORT-COMMENTS           PIC X(15).
  5978             20  FILLER                     PIC X(14).
  5979
  5980         16  FILLER                         PIC X(251).
  5981
  5982
  5983****************************************************************
  5984*             BUSSINESS TYPE MASTER RECORD                     *
  5985****************************************************************
  5986
  5987     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5988* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5989* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5990* AND RECORD 05 IS TYPES 81-99
  5991         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5992             20  CF-BUSINESS-TITLE          PIC  X(19).
  5993             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5994                                            PIC S9V9(4) COMP-3.
  5995             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5996             20  FILLER                     PIC  X.
  5997         16  FILLER                         PIC  X(248).
  5998
  5999
  6000****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 111
* EL050.cbl
  6001*             TERMINAL MASTER RECORD                           *
  6002****************************************************************
  6003
  6004     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6005
  6006         16  CF-COMPANY-TERMINALS.
  6007             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6008                                  PIC X(4).
  6009         16  FILLER               PIC X(248).
  6010
  6011
  6012****************************************************************
  6013*             LIFE EDIT MASTER RECORD                          *
  6014****************************************************************
  6015
  6016     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6017         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6018             20  CF-LIFE-CODE-IN            PIC XX.
  6019             20  CF-LIFE-CODE-OUT           PIC XX.
  6020         16  FILLER                         PIC X(248).
  6021
  6022
  6023****************************************************************
  6024*             AH EDIT MASTER RECORD                            *
  6025****************************************************************
  6026
  6027     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6028         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6029             20  CF-AH-CODE-IN              PIC XXX.
  6030             20  CF-AH-CODE-OUT             PIC XX.
  6031         16  FILLER                         PIC X(248).
  6032
  6033
  6034****************************************************************
  6035*             CREDIBILITY TABLES                               *
  6036****************************************************************
  6037
  6038     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6039         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6040                             INDEXED BY CF-CRDB-NDX.
  6041             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6042             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6043             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6044         16  FILLER                         PIC  X(332).
  6045
  6046
  6047****************************************************************
  6048*             REPORT CUSTOMIZATION RECORD                      *
  6049****************************************************************
  6050
  6051     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6052         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6053             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6054             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6055             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6056**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6057****       A T-TRANSFER.                                   ****
  6058             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 112
* EL050.cbl
  6059
  6060         16  FILLER                         PIC XX.
  6061
  6062         16  CF-CARRIER-CNTL-OPT.
  6063             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6064                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6065                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6066             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6067                                            PIC X.
  6068         16  CF-GROUP-CNTL-OPT.
  6069             20  CF-GROUP-OPT-SEQ           PIC 9.
  6070                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6071                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6072             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6073                                            PIC X(6).
  6074         16  CF-STATE-CNTL-OPT.
  6075             20  CF-STATE-OPT-SEQ           PIC 9.
  6076                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6077                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6078             20  CF-STATE-SELECT OCCURS 3 TIMES
  6079                                            PIC XX.
  6080         16  CF-ACCOUNT-CNTL-OPT.
  6081             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6082                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6083                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6084             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6085                                            PIC X(10).
  6086         16  CF-BUS-TYP-CNTL-OPT.
  6087             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6088                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6089                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6090             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6091                                            PIC XX.
  6092         16  CF-LF-TYP-CNTL-OPT.
  6093             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6094                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6095                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6096             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6097                                            PIC XX.
  6098         16  CF-AH-TYP-CNTL-OPT.
  6099             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6100                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6101                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6102             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6103                                            PIC XX.
  6104         16  CF-REPTCD1-CNTL-OPT.
  6105             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6106                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6107                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6108             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6109                                            PIC X(10).
  6110         16  CF-REPTCD2-CNTL-OPT.
  6111             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6112                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6113                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6114             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6115                                            PIC X(10).
  6116         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 113
* EL050.cbl
  6117             20  CF-USER1-OPT-SEQ           PIC 9.
  6118                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6119                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6120             20  CF-USER1-SELECT OCCURS 3 TIMES
  6121                                            PIC X(10).
  6122         16  CF-USER2-CNTL-OPT.
  6123             20  CF-USER2-OPT-SEQ           PIC 9.
  6124                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6125                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6126             20  CF-USER2-SELECT OCCURS 3 TIMES
  6127                                            PIC X(10).
  6128         16  CF-USER3-CNTL-OPT.
  6129             20  CF-USER3-OPT-SEQ           PIC 9.
  6130                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6131                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6132             20  CF-USER3-SELECT OCCURS 3 TIMES
  6133                                            PIC X(10).
  6134         16  CF-USER4-CNTL-OPT.
  6135             20  CF-USER4-OPT-SEQ           PIC 9.
  6136                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6137                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6138             20  CF-USER4-SELECT OCCURS 3 TIMES
  6139                                            PIC X(10).
  6140         16  CF-USER5-CNTL-OPT.
  6141             20  CF-USER5-OPT-SEQ           PIC 9.
  6142                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6143                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6144             20  CF-USER5-SELECT OCCURS 3 TIMES
  6145                                            PIC X(10).
  6146         16  CF-REINS-CNTL-OPT.
  6147             20  CF-REINS-OPT-SEQ           PIC 9.
  6148                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6149                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6150             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6151                 24  CF-REINS-PRIME         PIC XXX.
  6152                 24  CF-REINS-SUB           PIC XXX.
  6153
  6154         16  CF-AGENT-CNTL-OPT.
  6155             20  CF-AGENT-OPT-SEQ           PIC 9.
  6156                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6157                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6158             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6159                                            PIC X(10).
  6160
  6161         16  FILLER                         PIC X(43).
  6162
  6163         16  CF-LOSS-RATIO-SELECT.
  6164             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6165             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6166         16  CF-ENTRY-DATE-SELECT.
  6167             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6168             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6169         16  CF-EFFECTIVE-DATE-SELECT.
  6170             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6171             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6172
  6173         16  CF-EXCEPTION-LIST-IND          PIC X.
  6174             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 114
* EL050.cbl
  6175
  6176         16  FILLER                         PIC X(318).
  6177
  6178****************************************************************
  6179*                  EXCEPTION REPORTING RECORD                  *
  6180****************************************************************
  6181
  6182     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6183         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6184             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6185
  6186         16  CF-COMBINED-LIFE-AH-OPT.
  6187             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6188             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6189             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6190             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6191
  6192         16  CF-LIFE-OPT.
  6193             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6194             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6195             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6196             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6197             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6198             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6199             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6200             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6201             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6202             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6203
  6204         16  CF-AH-OPT.
  6205             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6206             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6207             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6208             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6209             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6210             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6211             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6212             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6213             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6214             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6215
  6216         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6217             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6218             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6219             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6220
  6221         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6222
  6223         16  FILLER                         PIC X(673).
  6224
  6225
  6226****************************************************************
  6227*             MORTGAGE SYSTEM PLAN RECORD                      *
  6228****************************************************************
  6229
  6230     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6231         16  CF-PLAN-TYPE                   PIC X.
  6232             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 115
* EL050.cbl
  6233             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6234             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6235         16  CF-PLAN-ABBREV                 PIC XXX.
  6236         16  CF-PLAN-DESCRIPT               PIC X(10).
  6237         16  CF-PLAN-NOTES                  PIC X(20).
  6238         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6239         16  CF-PLAN-UNDERWRITING.
  6240             20  CF-PLAN-TERM-DATA.
  6241                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6242                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6243             20  CF-PLAN-AGE-DATA.
  6244                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6245                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6246                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6247             20  CF-PLAN-BENEFIT-DATA.
  6248                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6249                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6250                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6251                                            PIC S9(7)V99  COMP-3.
  6252         16  CF-PLAN-POLICY-FORMS.
  6253             20  CF-POLICY-FORM             PIC X(12).
  6254             20  CF-MASTER-APPLICATION      PIC X(12).
  6255             20  CF-MASTER-POLICY           PIC X(12).
  6256         16  CF-PLAN-RATING.
  6257             20  CF-RATE-CODE               PIC X(5).
  6258             20  CF-SEX-RATING              PIC X.
  6259                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6260                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6261             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6262             20  CF-SUB-STD-TYPE            PIC X.
  6263                 88  CF-PCT-OF-PREM            VALUE '1'.
  6264                 88  CF-PCT-OF-BENE            VALUE '2'.
  6265         16  CF-PLAN-PREM-TOLERANCES.
  6266             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6267             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6268         16  CF-PLAN-PYMT-TOLERANCES.
  6269             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6270             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6271         16  CF-PLAN-MISC-DATA.
  6272             20  FILLER                     PIC X.
  6273             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6274             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6275         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6276         16  CF-PLAN-IND-GRP                PIC X.
  6277             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6278                                                     '1'.
  6279             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6280                                                     '2'.
  6281         16  CF-MIB-SEARCH-SW               PIC X.
  6282             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6283             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6284             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6285             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6286         16  CF-ALPHA-SEARCH-SW             PIC X.
  6287             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6288             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6289             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6290             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 116
* EL050.cbl
  6291             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6292             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6293             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6294             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6295             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6296             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6297                                                     'A' 'B' 'C'
  6298                                                     'X' 'Y' 'Z'.
  6299         16  CF-EFF-DT-RULE-SW              PIC X.
  6300             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6301             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6302             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6303             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6304             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6305         16  FILLER                         PIC X(4).
  6306         16  CF-HEALTH-QUESTIONS            PIC X.
  6307             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6308         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6309         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6310         16  CF-PLAN-SNGL-JNT               PIC X.
  6311             88  CF-COMBINED-PLAN              VALUE 'C'.
  6312             88  CF-JNT-PLAN                   VALUE 'J'.
  6313             88  CF-SNGL-PLAN                  VALUE 'S'.
  6314         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6315         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6316         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6317         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6318         16  CF-RERATE-CNTL                 PIC  X.
  6319             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6320             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6321             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6322             88  CF-AUTO-RECALC                 VALUE '4'.
  6323         16  CF-BENEFIT-TYPE                PIC  X.
  6324             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6325             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6326         16  CF-POLICY-FEE                  PIC S999V99
  6327                                                    COMP-3.
  6328         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6329         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6330         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6331         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6332         16  FILLER                         PIC  X(32).
  6333         16  CF-TERMINATION-FORM            PIC  X(04).
  6334         16  FILLER                         PIC  X(08).
  6335         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6336                                                       COMP-3.
  6337         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6338         16  CF-ISSUE-LETTER                PIC  X(4).
  6339         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6340         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6341             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6342             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6343         16  CF-MP-REFUND-CALC              PIC X.
  6344             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6345             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6346             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6347             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6348             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 117
* EL050.cbl
  6349             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6350             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6351             88  CF-MP-REFD-MEAN                VALUE '8'.
  6352         16  CF-ALT-RATE-CODE               PIC  X(5).
  6353
  6354
  6355         16  FILLER                         PIC X(498).
  6356****************************************************************
  6357*             MORTGAGE COMPANY MASTER RECORD                   *
  6358****************************************************************
  6359
  6360     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6361         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6362         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6363             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6364             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6365             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6366             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6367             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6368
  6369         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6370         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6371         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6372         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6373         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6374
  6375         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6376             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6377         16  CF-MP-RECON-USE-IND            PIC X(1).
  6378             88  CF-MP-USE-RECON             VALUE 'Y'.
  6379         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6380             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6381         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6382             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6383             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6384         16  FILLER                         PIC X(1).
  6385         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6386             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6387         16  CF-MORTG-MIB-VERSION           PIC X.
  6388             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6389             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6390             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6391         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6392             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6393                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6394             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6395                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6396             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6397                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6398             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6399                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6400             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6401                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6402             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6403                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6404         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6405         16  FILLER                         PIC X(7).
  6406         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 118
* EL050.cbl
  6407             20  CF-MORTG-MIB-COMM          PIC X(5).
  6408             20  CF-MORTG-MIB-TERM          PIC X(5).
  6409         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6410             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6411         16  FILLER                         PIC X(03).
  6412         16  CF-MP-CHECK-NO-CONTROL.
  6413             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6414                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6415                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6416                                                ' ' LOW-VALUES.
  6417                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6418                                               VALUE '3'.
  6419         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6420         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6421         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6422             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6423                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6424             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6425                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6426             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6427                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6428             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6429                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6430             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6431                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6432             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6433                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6434         16  CF-MORTG-BILLING-AREA.
  6435             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6436                                            PIC X.
  6437         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6438         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6439         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6440         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6441             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6442             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6443         16  FILLER                         PIC X.
  6444         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6445             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6446             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6447         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6448         16  FILLER                         PIC X(8).
  6449         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6450         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6451         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6452         16  CF-ACH-COMPANY-ID.
  6453             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6454                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6455                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6456                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6457             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6458         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6459             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6460         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6461             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6462             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6463         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6464         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 119
* EL050.cbl
  6465         16  FILLER                         PIC X(536).
  6466
  6467****************************************************************
  6468*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6469****************************************************************
  6470
  6471     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6472         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6473             20  CF-FEMALE-HEIGHT.
  6474                 24  CF-FEMALE-FT           PIC 99.
  6475                 24  CF-FEMALE-IN           PIC 99.
  6476             20  CF-FEMALE-MIN-WT           PIC 999.
  6477             20  CF-FEMALE-MAX-WT           PIC 999.
  6478         16  FILLER                         PIC X(428).
  6479
  6480     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6481         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6482             20  CF-MALE-HEIGHT.
  6483                 24  CF-MALE-FT             PIC 99.
  6484                 24  CF-MALE-IN             PIC 99.
  6485             20  CF-MALE-MIN-WT             PIC 999.
  6486             20  CF-MALE-MAX-WT             PIC 999.
  6487         16  FILLER                         PIC X(428).
  6488******************************************************************
  6489*             AUTOMATIC ACTIVITY RECORD                          *
  6490******************************************************************
  6491     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6492         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6493             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6494             20  CF-SYS-LETTER-ID           PIC X(04).
  6495             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6496             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6497             20  CF-SYS-RESET-SW            PIC X(01).
  6498             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6499             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6500
  6501         16  FILLER                         PIC X(50).
  6502
  6503         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6504             20  CF-USER-ACTIVE-SW          PIC X(01).
  6505             20  CF-USER-LETTER-ID          PIC X(04).
  6506             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6507             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6508             20  CF-USER-RESET-SW           PIC X(01).
  6509             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6510             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6511             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6512
  6513         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 120
* EL050.cbl
  6515*    COPY ERCACCT.
  6516******************************************************************
  6517*                                                                *
  6518*                                                                *
  6519*                            ERCACCT                             *
  6520*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6521*                            VMOD=2.031                          *
  6522*                                                                *
  6523*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6524*                                                                *
  6525*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6526*   VSAM ACCOUNT MASTER FILES.                                   *
  6527*                                                                *
  6528*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6529*                                                                *
  6530*   FILE TYPE = VSAM,KSDS                                        *
  6531*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6532*                                                                *
  6533*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6534*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6535*                                                                *
  6536*   LOG = NO                                                     *
  6537*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6538*                                                                *
  6539*                                                                *
  6540******************************************************************
  6541*                   C H A N G E   L O G
  6542*
  6543* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6544*-----------------------------------------------------------------
  6545*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6546* EFFECTIVE    NUMBER
  6547*-----------------------------------------------------------------
  6548* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6549* 092705    2005050300006  PEMA  ADD SPP LEASES
  6550* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6551* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6552* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6553* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6554* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6555******************************************************************
  6556
  6557 01  ACCOUNT-MASTER.
  6558     12  AM-RECORD-ID                      PIC XX.
  6559         88  VALID-AM-ID                      VALUE 'AM'.
  6560
  6561     12  AM-CONTROL-PRIMARY.
  6562         16  AM-COMPANY-CD                 PIC X.
  6563         16  AM-MSTR-CNTRL.
  6564             20  AM-CONTROL-A.
  6565                 24  AM-CARRIER            PIC X.
  6566                 24  AM-GROUPING.
  6567                     28 AM-GROUPING-PREFIX PIC XXX.
  6568                     28 AM-GROUPING-PRIME  PIC XXX.
  6569                 24  AM-STATE              PIC XX.
  6570                 24  AM-ACCOUNT.
  6571                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6572                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 121
* EL050.cbl
  6573             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6574                                           PIC X(19).
  6575             20  AM-CNTRL-B.
  6576                 24  AM-EXPIRATION-DT      PIC XX.
  6577                 24  FILLER                PIC X(4).
  6578             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6579                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6580
  6581     12  AM-CONTROL-BY-VAR-GRP.
  6582         16  AM-COMPANY-CD-A1              PIC X.
  6583         16  AM-VG-CARRIER                 PIC X.
  6584         16  AM-VG-GROUPING                PIC X(6).
  6585         16  AM-VG-STATE                   PIC XX.
  6586         16  AM-VG-ACCOUNT                 PIC X(10).
  6587         16  AM-VG-DATE.
  6588             20  AM-VG-EXPIRATION-DT       PIC XX.
  6589             20  FILLER                    PIC X(4).
  6590         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6591                                           PIC 9(11)      COMP-3.
  6592     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6593         16  FILLER                        PIC X(10).
  6594         16  AM-VG-KEY3.
  6595             20  AM-VG3-ACCOUNT            PIC X(10).
  6596             20  AM-VG3-EXP-DT             PIC XX.
  6597         16  FILLER                        PIC X(4).
  6598     12  AM-MAINT-INFORMATION.
  6599         16  AM-LAST-MAINT-DT              PIC XX.
  6600         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6601         16  AM-LAST-MAINT-USER            PIC X(4).
  6602         16  FILLER                        PIC XX.
  6603
  6604     12  AM-EFFECTIVE-DT                   PIC XX.
  6605     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6606
  6607     12  AM-PREV-DATES  COMP-3.
  6608         16  AM-PREV-EXP-DT                PIC 9(11).
  6609         16  AM-PREV-EFF-DT                PIC 9(11).
  6610
  6611     12  AM-REPORT-CODE-1                  PIC X(10).
  6612     12  AM-REPORT-CODE-2                  PIC X(10).
  6613
  6614     12  AM-CITY-CODE                      PIC X(4).
  6615     12  AM-COUNTY-PARISH                  PIC X(6).
  6616
  6617     12  AM-NAME                           PIC X(30).
  6618     12  AM-PERSON                         PIC X(30).
  6619     12  AM-ADDRS                          PIC X(30).
  6620     12  AM-CITY.
  6621         16  AM-ADDR-CITY                  PIC X(28).
  6622         16  AM-ADDR-STATE                 PIC XX.
  6623     12  AM-ZIP.
  6624         16  AM-ZIP-PRIME.
  6625             20  AM-ZIP-PRI-1ST            PIC X.
  6626                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6627             20  FILLER                    PIC X(4).
  6628         16  AM-ZIP-PLUS4                  PIC X(4).
  6629     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6630         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 122
* EL050.cbl
  6631         16  AM-CAN-POSTAL-2               PIC XXX.
  6632         16  FILLER                        PIC XXX.
  6633     12  AM-TEL-NO.
  6634         16  AM-AREA-CODE                  PIC 999.
  6635         16  AM-TEL-PRE                    PIC 999.
  6636         16  AM-TEL-NBR                    PIC 9(4).
  6637     12  AM-TEL-LOC                        PIC X.
  6638         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6639         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6640
  6641     12  AM-COMM-STRUCTURE.
  6642         16  AM-DEFN-1.
  6643             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6644                 24  AM-AGT.
  6645                     28  AM-AGT-PREFIX     PIC X(4).
  6646                     28  AM-AGT-PRIME      PIC X(6).
  6647                 24  AM-COM-TYP            PIC X.
  6648                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6649                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6650                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6651                 24  AM-RECALC-LV-INDIC    PIC X.
  6652                 24  AM-RETRO-LV-INDIC     PIC X.
  6653                 24  AM-GL-CODES           PIC X.
  6654                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6655                 24  FILLER                PIC X(01).
  6656         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6657             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6658                 24  FILLER                PIC X(11).
  6659                 24  AM-L-COMA             PIC XXX.
  6660                 24  AM-J-COMA             PIC XXX.
  6661                 24  AM-A-COMA             PIC XXX.
  6662                 24  FILLER                PIC X(6).
  6663
  6664     12  AM-COMM-CHANGE-STATUS             PIC X.
  6665         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6666
  6667     12  AM-CSR-CODE                       PIC X(4).
  6668
  6669     12  AM-BILLING-STATUS                 PIC X.
  6670         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6671         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6672     12  AM-AUTO-REFUND-SW                 PIC X.
  6673         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6674         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6675     12  AM-GPCD                           PIC 99.
  6676     12  AM-IG                             PIC X.
  6677         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6678         88  AM-HAS-GROUP                     VALUE '2'.
  6679     12  AM-STATUS                         PIC X.
  6680         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6681         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6682         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6683         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6684         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6685         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6686     12  AM-REMIT-TO                       PIC 99.
  6687     12  AM-ID-NO                          PIC X(11).
  6688
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 123
* EL050.cbl
  6689     12  AM-CAL-TABLE                      PIC XX.
  6690     12  AM-LF-DEVIATION                   PIC XXX.
  6691     12  AM-AH-DEVIATION                   PIC XXX.
  6692     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6693     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6694     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6695     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6696     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6697     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6698
  6699     12  AM-USER-FIELDS.
  6700         16  AM-FLD-1                      PIC XX.
  6701         16  AM-FLD-2                      PIC XX.
  6702         16  AM-FLD-3                      PIC XX.
  6703         16  AM-FLD-4                      PIC XX.
  6704         16  AM-FLD-5                      PIC XX.
  6705
  6706     12  AM-1ST-PROD-DATE.
  6707         16  AM-1ST-PROD-YR                PIC XX.
  6708         16  AM-1ST-PROD-MO                PIC XX.
  6709         16  AM-1ST-PROD-DA                PIC XX.
  6710     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6711     12  AM-CERTS-PURGED-DATE.
  6712         16  AM-PUR-YR                     PIC XX.
  6713         16  AM-PUR-MO                     PIC XX.
  6714         16  AM-PUR-DA                     PIC XX.
  6715     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6716     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6717     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6718     12  AM-INACTIVE-DATE.
  6719         16  AM-INA-MO                     PIC 99.
  6720         16  AM-INA-DA                     PIC 99.
  6721         16  AM-INA-YR                     PIC 99.
  6722     12  AM-AR-HI-CERT-DATE                PIC XX.
  6723
  6724     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6725     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6726
  6727     12  AM-OB-PAYMENT-MODE                PIC X.
  6728         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6729         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6730         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6731         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6732
  6733     12  AM-AH-ONLY-INDICATOR              PIC X.
  6734         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6735         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6736
  6737     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6738
  6739     12  AM-OVER-SHORT.
  6740         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6741         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6742
  6743     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6744     12  AM-DCC-CLP-STATE                  PIC XX.
  6745
  6746     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 124
* EL050.cbl
  6747     12  AM-RECALC-REIN                    PIC X.
  6748
  6749     12  AM-REI-TABLE                      PIC XXX.
  6750     12  AM-REI-ET-LF                      PIC X.
  6751     12  AM-REI-ET-AH                      PIC X.
  6752     12  AM-REI-PE-LF                      PIC X.
  6753     12  AM-REI-PE-AH                      PIC X.
  6754     12  AM-REI-PRT-ST                     PIC X.
  6755     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6756     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6757     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6758     12  AM-REI-GROUP-A                    PIC X(6).
  6759     12  AM-REI-MORT                       PIC X(4).
  6760     12  AM-REI-PRT-OW                     PIC X.
  6761     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6762     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6763     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6764     12  AM-REI-GROUP-B                    PIC X(6).
  6765
  6766     12  AM-TRUST-TYPE                     PIC X(2).
  6767
  6768     12  AM-EMPLOYER-STMT-USED             PIC X.
  6769     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6770
  6771     12  AM-STD-AH-TYPE                    PIC XX.
  6772     12  AM-EARN-METHODS.
  6773         16  AM-EARN-METHOD-R              PIC X.
  6774             88 AM-REF-RL-R78                 VALUE 'R'.
  6775             88 AM-REF-RL-PR                  VALUE 'P'.
  6776             88 AM-REF-RL-MEAN                VALUE 'M'.
  6777             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6778         16  AM-EARN-METHOD-L              PIC X.
  6779             88 AM-REF-LL-R78                 VALUE 'R'.
  6780             88 AM-REF-LL-PR                  VALUE 'P'.
  6781             88 AM-REF-LL-MEAN                VALUE 'M'.
  6782             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6783         16  AM-EARN-METHOD-A              PIC X.
  6784             88 AM-REF-AH-R78                 VALUE 'R'.
  6785             88 AM-REF-AH-PR                  VALUE 'P'.
  6786             88 AM-REF-AH-MEAN                VALUE 'M'.
  6787             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6788             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6789             88 AM-REF-AH-NET                 VALUE 'N'.
  6790
  6791     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6792     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6793     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6794
  6795     12  AM-RET-Y-N                        PIC X.
  6796     12  AM-RET-P-E                        PIC X.
  6797     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6798     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6799     12  AM-RET-GRP                        PIC X(6).
  6800     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6801         16  AM-POOL-PRIME                 PIC XXX.
  6802         16  AM-POOL-SUB                   PIC XXX.
  6803     12  AM-RETRO-EARNINGS.
  6804         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 125
* EL050.cbl
  6805         16  AM-RET-EARN-L                 PIC X.
  6806         16  AM-RET-EARN-A                 PIC X.
  6807     12  AM-RET-ST-TAX-USE                 PIC X.
  6808         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6809         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6810     12  AM-RETRO-BEG-EARNINGS.
  6811         16  AM-RET-BEG-EARN-R             PIC X.
  6812         16  AM-RET-BEG-EARN-L             PIC X.
  6813         16  AM-RET-BEG-EARN-A             PIC X.
  6814     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6815     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6816
  6817     12  AM-USER-SELECT-OPTIONS.
  6818         16  AM-USER-SELECT-1              PIC X(10).
  6819         16  AM-USER-SELECT-2              PIC X(10).
  6820         16  AM-USER-SELECT-3              PIC X(10).
  6821         16  AM-USER-SELECT-4              PIC X(10).
  6822         16  AM-USER-SELECT-5              PIC X(10).
  6823
  6824     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6825
  6826     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6827
  6828     12  AM-RPT045A-SWITCH                 PIC X.
  6829         88  RPT045A-OFF                   VALUE 'N'.
  6830
  6831     12  AM-INSURANCE-LIMITS.
  6832         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6833         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6834
  6835     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6836         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6837
  6838     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6839         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6840         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6841
  6842     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6843
  6844     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6845     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6846     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6847     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6848     12  AM-DCC-UEF-STATE                  PIC XX.
  6849     12  FILLER                            PIC XXX.
  6850     12  AM-REPORT-CODE-3                  PIC X(10).
  6851*    12  FILLER                            PIC X(22).
  6852
  6853     12  AM-RESERVE-DATE.
  6854         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6855         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6856         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6857
  6858     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6859     12  AM-NOTIFICATION-TYPES.
  6860         16  AM-NOTIF-OF-LETTERS           PIC X.
  6861         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6862         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 126
* EL050.cbl
  6863         16  AM-NOTIF-OF-STATUS            PIC X.
  6864
  6865     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6866         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6867         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6868         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6869         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6870
  6871     12  AM-BENEFIT-CONTROLS.
  6872         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6873             20  AM-BENEFIT-CODE           PIC XX.
  6874             20  AM-BENEFIT-TYPE           PIC X.
  6875             20  AM-BENEFIT-REVISION       PIC XXX.
  6876             20  AM-BENEFIT-REM-TERM       PIC X.
  6877             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6878             20  FILLER                    PIC XX.
  6879         16  FILLER                        PIC X(80).
  6880
  6881     12  AM-TRANSFER-DATA.
  6882         16  AM-TRANSFERRED-FROM.
  6883             20  AM-TRNFROM-CARRIER        PIC X.
  6884             20  AM-TRNFROM-GROUPING.
  6885                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6886                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6887             20  AM-TRNFROM-STATE          PIC XX.
  6888             20  AM-TRNFROM-ACCOUNT.
  6889                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6890                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6891             20  AM-TRNFROM-DTE            PIC XX.
  6892         16  AM-TRANSFERRED-TO.
  6893             20  AM-TRNTO-CARRIER          PIC X.
  6894             20  AM-TRNTO-GROUPING.
  6895                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6896                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6897             20  AM-TRNTO-STATE            PIC XX.
  6898             20  AM-TRNTO-ACCOUNT.
  6899                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6900                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6901             20  AM-TRNTO-DTE              PIC XX.
  6902         16  FILLER                        PIC X(10).
  6903
  6904     12  AM-SAVED-REMIT-TO                 PIC 99.
  6905
  6906     12  AM-COMM-STRUCTURE-SAVED.
  6907         16  AM-DEFN-1-SAVED.
  6908             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6909                 24  AM-AGT-SV             PIC X(10).
  6910                 24  AM-COM-TYP-SV         PIC X.
  6911                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6912                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6913                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6914                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6915                 24  FILLER                PIC X.
  6916                 24  AM-GL-CODES-SV        PIC X.
  6917                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6918                 24  FILLER                PIC X.
  6919         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6920             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 127
* EL050.cbl
  6921                 24  FILLER                PIC X(11).
  6922                 24  AM-L-COMA-SV          PIC XXX.
  6923                 24  AM-J-COMA-SV          PIC XXX.
  6924                 24  AM-A-COMA-SV          PIC XXX.
  6925                 24  FILLER                PIC X(6).
  6926
  6927     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6928         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6929            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6930            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6931            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6932
  6933     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6934     12  FILLER                            PIC X(120).
  6935
  6936     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6937         16  AM-CONTROL-NAME               PIC X(30).
  6938         16  AM-EXECUTIVE-ONE.
  6939             20  AM-EXEC1-NAME             PIC X(15).
  6940             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6941                                                          COMP-3.
  6942             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6943                                                          COMP-3.
  6944         16  AM-EXECUTIVE-TWO.
  6945             20  AM-EXEC2-NAME             PIC X(15).
  6946             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6947                                                          COMP-3.
  6948             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6949                                                          COMP-3.
  6950
  6951     12  AM-RETRO-ADDITIONAL-DATA.
  6952         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6953         16  AM-RETRO-PREM-P-E             PIC X.
  6954         16  AM-RETRO-CLMS-P-I             PIC X.
  6955         16  AM-RETRO-RET-BRACKET-LF.
  6956             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6957                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6958                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6959             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6960                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6961                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6962             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6963                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6964                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6965         16  AM-RETRO-RET-BRACKET-AH.
  6966             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6967                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6968                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6969                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6970             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6971                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6972                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6973             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6974                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6975                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6976
  6977     12  AM-COMMENTS.
  6978         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 128
* EL050.cbl
  6979
  6980     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6981         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6982         16  AM-FLI-BILLING-CODE           PIC X.
  6983         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6984         16  AM-FLI-UNITED-IDENT           PIC X.
  6985         16  AM-FLI-INTEREST-LOST-DATA.
  6986             20  AM-FLI-BANK-NO            PIC X(5).
  6987             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6988             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6989             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6990         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6991             20  AM-FLI-AGT                PIC X(9).
  6992             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6993             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6994         16  FILLER                        PIC X(102).
  6995
  6996     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6997         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6998             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6999             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7000             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7001             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7002             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7003         16  FILLER                          PIC X(10).
  7004******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 129
* EL050.cbl
  7006*    COPY ERCREIN.
  7007******************************************************************
  7008*                                                                *
  7009*                            ERCREIN                             *
  7010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7011*                            VMOD=2.010                          *
  7012*                                                                *
  7013*   ONLINE CREDIT SYSTEM                                         *
  7014*                                                                *
  7015*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7016*                                                                *
  7017*   FILE TYPE = VSAM,KSDS                                        *
  7018*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7019*                                                                *
  7020*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7021*       ALTERNATE PATH = NONE                                    *
  7022*                                                                *
  7023*   LOG = NO                                                     *
  7024*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7025*                                                                *
  7026******************************************************************
  7027*                   C H A N G E   L O G
  7028*
  7029* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7030*-----------------------------------------------------------------
  7031*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7032* EFFECTIVE    NUMBER
  7033*-----------------------------------------------------------------
  7034* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7035* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7036******************************************************************
  7037 01  REINSURANCE-RECORD.
  7038     12  RE-RECORD-ID                      PIC XX.
  7039         88  VALID-RE-ID                      VALUE 'RE'.
  7040
  7041     12  RE-CONTROL-PRIMARY.
  7042         16  RE-COMPANY-CD                 PIC X.
  7043         16  RE-KEY.
  7044             20  RE-CODE                   PIC X.
  7045                 88  RE-TABLE-RECORD          VALUE 'A'.
  7046                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7047             20  RE-TABLE                  PIC XXX.
  7048             20  FILLER                    PIC XXX.
  7049         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7050             20  FILLER                    PIC X.
  7051             20  RE-COMPANY.
  7052                 24  RE-COMP-PRIME         PIC XXX.
  7053                 24  RE-COMP-SUB           PIC XXX.
  7054
  7055     12  RE-MAINT-INFORMATION.
  7056         16  RE-LAST-MAINT-DT              PIC XX.
  7057         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7058         16  RE-LAST-MAINT-USER            PIC X(4).
  7059         16  FILLER                        PIC X(10).
  7060
  7061     12  RE-TABLE-DATA.
  7062         16  RE-100-COMP                   PIC 99.
  7063
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 130
* EL050.cbl
  7064         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7065             20  RE-REI-COMP-NO.
  7066                 24  RE-REI-COMP           PIC XXX.
  7067                 24  RE-REI-COMP-SUB       PIC XXX.
  7068             20  RE-LF-QC                  PIC X.
  7069             20  RE-AH-QC                  PIC X.
  7070             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7071             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7072             20  RE-LFAGE-LO               PIC 99.
  7073             20  RE-LFAGE-HI               PIC 99.
  7074             20  RE-AHAGE-LO               PIC 99.
  7075             20  RE-AHAGE-HI               PIC 99.
  7076             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7077             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7078             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7079             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7080             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7081             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7082             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7083             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7084             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7085             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7086             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7087             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7088             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7089             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7090             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7091             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7092             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7093             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7094             20  RE-LF-BEN-CODE            PIC X.
  7095             20  RE-AH-BEN-CODE            PIC X.
  7096             20  RE-INTERACTIVE            PIC X.
  7097             20  RE-REMAINING              PIC X.
  7098             20  RE-LF-RUNOFF-SW           PIC X.
  7099             20  RE-AH-RUNOFF-SW           PIC X.
  7100             20  FILLER                    PIC X(19).
  7101
  7102         16  RE-COMP-INFO-END              PIC X(6).
  7103         16  RE-NSP-ST-CD-LF               PIC XX.
  7104         16  RE-NSP-ST-CD-AH               PIC XX.
  7105         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7106             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7107
  7108         16  FILLER                        PIC X(27).
  7109
  7110     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7111         16  RE-NAME                       PIC X(30).
  7112         16  RE-LF-PE                      PIC X.
  7113         16  RE-AH-PE                      PIC X.
  7114         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7115         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7116         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7117         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7118         16  RE-PRT-ST                     PIC X.
  7119         16  RE-PRT-OW                     PIC X.
  7120         16  RE-MORT-CODE                  PIC X(4).
  7121         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 131
* EL050.cbl
  7122         16  RE-ZERO-LF-FEE                PIC X.
  7123         16  RE-ZERO-AH-FEE                PIC X.
  7124         16  RE-CEDE-NAME                  PIC X(30).
  7125         16  RE-LF-COMM                    PIC X.
  7126         16  RE-AH-COMM                    PIC X.
  7127         16  RE-LF-TAX                     PIC X.
  7128         16  RE-AH-TAX                     PIC X.
  7129         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7130         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7131         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7132
  7133         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7134             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7135
  7136         16  RE-LF-CEDING-FEE-BRACKETS.
  7137             20  RE-LF-FEE-METHOD          PIC X.
  7138                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7139                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7140                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7141                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7142             20  RE-LF-FEE-BASIS           PIC X.
  7143                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7144                 88  RE-LF-NET-CEDED               VALUE '2'.
  7145                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7146                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7147                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7148                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7149                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7150                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7151             20  FILLER                    PIC XXX.
  7152             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7153                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7154                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7155
  7156         16  RE-AH-CEDING-FEE-BRACKETS.
  7157             20  RE-AH-FEE-METHOD          PIC X.
  7158                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7159                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7160                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7161                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7162             20  RE-AH-FEE-BASIS           PIC X.
  7163                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7164                 88  RE-AH-NET-CEDED               VALUE '2'.
  7165                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7166                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7167                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7168                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7169                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7170                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7171             20  FILLER                    PIC XXX.
  7172             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7173                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7174                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7175
  7176         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7177
  7178         16  RE-OLD-CEDING-STMT            PIC X.
  7179
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 132
* EL050.cbl
  7180         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7181         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7182         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7183         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7184         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7185         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7186         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7187         16  RE-MORT-SW                    PIC X.
  7188         16  RE-CEDING-TYPE-FLAG           PIC X.
  7189             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7190             88  RE-CEDED                          VALUE 'C'.
  7191             88  RE-ASSUMED                        VALUE 'A'.
  7192             88  RE-PHANTOM                        VALUE 'P'.
  7193
  7194         16  RE-CEDING-STMT-OPT-A          PIC X.
  7195             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7196         16  RE-CEDING-STMT-OPT-B          PIC X.
  7197             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7198         16  RE-CEDING-STMT-OPT-C          PIC X.
  7199             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7200         16  RE-CEDING-STMT-OPT-D          PIC X.
  7201             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7202         16  RE-CEDING-STMT-OPT-E          PIC X.
  7203             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7204
  7205         16  RE-PRT-CRSV                   PIC X.
  7206
  7207         16  RE-GL-CENTER                  PIC X(4).
  7208
  7209         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7210
  7211         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7212
  7213         16  RE-EARN-STOP-CODE             PIC X.
  7214             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7215             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7216
  7217         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7218             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7219
  7220         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7221         16  FILLER                        PIC X(2281).
  7222
  7223         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7224
  7225******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 133
* EL050.cbl
  7227*    COPY ERCCTBL.
  7228******************************************************************
  7229*                                                                *
  7230*                                                                *
  7231*                            ERCCTBL                             *
  7232*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7233*                            VMOD=2.003
  7234*                                                                *
  7235*   ONLINE CREDIT SYSTEM                                         *
  7236*                                                                *
  7237*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7238*                                                                *
  7239*   FILE TYPE = VSAM,KSDS                                        *
  7240*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7241*                                                                *
  7242*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7243*       ALTERNATE PATH = NONE                                    *
  7244*                                                                *
  7245*   LOG = NO                                                     *
  7246*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7247*                                                                *
  7248*                                                                *
  7249******************************************************************
  7250
  7251 01  COMM-TABLE-RECORD.
  7252     12  CT-RECORD-ID                      PIC XX.
  7253         88  VALID-CT-ID                      VALUE 'CT'.
  7254
  7255     12  CT-CONTROL-PRIMARY.
  7256         16  CT-COMPANY-CD                 PIC X.
  7257         16  CT-TABLE                      PIC XXX.
  7258         16  CT-CNTRL-2.
  7259             20  CT-BEN-TYPE               PIC X.
  7260             20  CT-BEN-CODE               PIC XX.
  7261
  7262     12  CT-MAINT-INFORMATION.
  7263         16  CT-LAST-MAINT-DT              PIC XX.
  7264         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7265         16  CT-LAST-MAINT-USER            PIC X(4).
  7266         16  FILLER                        PIC X(31).
  7267
  7268     12  CT-LIMITS.
  7269         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7270
  7271         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7272
  7273         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7274
  7275     12  CT-RATES.
  7276         16  CT-RTX          OCCURS 27 TIMES.
  7277             20  CT-RT                     PIC SV9(5)     COMP-3.
  7278             20  CT-RT-R   REDEFINES
  7279                 CT-RT                     PIC XXX.
  7280
  7281     12  FILLER                            PIC  X(42).
  7282
  7283******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 134
* EL050.cbl
  7285*    COPY ERCFORM.
  7286******************************************************************
  7287*                                                                *
  7288*                                                                *
  7289*                            ERCFORM.                            *
  7290*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7291*                            VMOD=2.003                          *
  7292*                                                                *
  7293*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7294*                                                                *
  7295*    FILE TYPE = VSAM,KSDS                                       *
  7296*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7297*                                                                *
  7298*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7299*                                                                *
  7300*    LOG = YES                                                   *
  7301*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7302******************************************************************
  7303 01  FORM-MASTER.
  7304    12  FO-RECORD-ID                 PIC X(02).
  7305        88  VALID-FO-ID                  VALUE 'FO'.
  7306
  7307    12  FO-CONTROL-PRIMARY.
  7308        16  FO-COMPANY-CD            PIC X(01).
  7309        16  FO-STATE                 PIC X(02).
  7310        16  FO-FORM-ID               PIC X(12).
  7311        16  FO-FORM-EXP-DT           PIC X(02).
  7312
  7313    12  FO-POLICY-FORM-DATA.
  7314        16  FO-IND-GRP-CD            PIC X(01).
  7315        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7316        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7317        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7318        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7319        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7320        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7321        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7322        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7323        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7324        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7325        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7326        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7327        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7328        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7329        16  FO-APP-CERT-USE-CD       PIC X(01).
  7330
  7331    12  FILLER                       PIC X(29).
  7332
  7333    12  FO-FORM-PLAN-TABLE.
  7334        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7335            20  FO-PLAN-TYPE         PIC X(01).
  7336            20  FO-PLAN-ID           PIC X(02).
  7337            20  FO-PLAN-TERM         PIC 9(03).
  7338            20  FO-PLAN-REFUND-METHOD
  7339                                     PIC X.
  7340
  7341    12  FILLER                       PIC X(30).
  7342
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 135
* EL050.cbl
  7343    12  FO-COMMENTS-AREA.
  7344        16  FO-COMMENT-LINE-1        PIC X(78).
  7345
  7346    12  FILLER                       PIC X(20).
  7347
  7348    12  FO-MAINT-INFORMATION.
  7349        16  FO-LAST-MAINT-DT         PIC X(02).
  7350        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7351        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 136
* EL050.cbl
  7353*    COPY ELCMSTR.
  7354******************************************************************
  7355*                                                                *
  7356*                            ELCMSTR.                            *
  7357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7358*                            VMOD=2.012                          *
  7359*                                                                *
  7360*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7361*                                                                *
  7362*   FILE TYPE = VSAM,KSDS                                        *
  7363*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7364*                                                                *
  7365*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7366*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7367*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7368*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7369*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7370*                                                 RKP=75,LEN=21  *
  7371*                                                                *
  7372*   **** NOTE ****                                               *
  7373*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7374*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7375*                                                                *
  7376*   LOG = YES                                                    *
  7377*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7378******************************************************************
  7379*                   C H A N G E   L O G
  7380*
  7381* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7382*-----------------------------------------------------------------
  7383*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7384* EFFECTIVE    NUMBER
  7385*-----------------------------------------------------------------
  7386* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7387* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7388* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7389* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7390* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7391******************************************************************
  7392 01  CLAIM-MASTER.
  7393     12  CL-RECORD-ID                PIC XX.
  7394         88  VALID-CL-ID         VALUE 'CL'.
  7395
  7396     12  CL-CONTROL-PRIMARY.
  7397         16  CL-COMPANY-CD           PIC X.
  7398         16  CL-CARRIER              PIC X.
  7399         16  CL-CLAIM-NO             PIC X(7).
  7400         16  CL-CERT-NO.
  7401             20  CL-CERT-PRIME       PIC X(10).
  7402             20  CL-CERT-SFX         PIC X.
  7403
  7404     12  CL-CONTROL-BY-NAME.
  7405         16  CL-COMPANY-CD-A1        PIC X.
  7406         16  CL-INSURED-LAST-NAME    PIC X(15).
  7407         16  CL-INSURED-NAME.
  7408             20  CL-INSURED-1ST-NAME PIC X(12).
  7409             20  CL-INSURED-MID-INIT PIC X.
  7410
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 137
* EL050.cbl
  7411     12  CL-CONTROL-BY-SSN.
  7412         16  CL-COMPANY-CD-A2        PIC X.
  7413         16  CL-SOC-SEC-NO.
  7414             20  CL-SSN-STATE        PIC XX.
  7415             20  CL-SSN-ACCOUNT      PIC X(6).
  7416             20  CL-SSN-LN3          PIC X(3).
  7417
  7418     12  CL-CONTROL-BY-CERT-NO.
  7419         16  CL-COMPANY-CD-A4        PIC X.
  7420         16  CL-CERT-NO-A4.
  7421             20  CL-CERT-A4-PRIME    PIC X(10).
  7422             20  CL-CERT-A4-SFX      PIC X.
  7423
  7424     12  CL-CONTROL-BY-CCN.
  7425         16  CL-COMPANY-CD-A5        PIC X.
  7426         16  CL-CCN-A5.
  7427             20  CL-CCN.
  7428                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7429                 24  CL-CCN-PRIME-A5 PIC X(12).
  7430             20  CL-CCN-FILLER-A5    PIC X(4).
  7431
  7432     12  CL-INSURED-PROFILE-DATA.
  7433         16  CL-INSURED-BIRTH-DT     PIC XX.
  7434         16  CL-INSURED-SEX-CD       PIC X.
  7435             88  INSURED-IS-MALE        VALUE 'M'.
  7436             88  INSURED-IS-FEMALE      VALUE 'F'.
  7437             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7438         16  CL-INSURED-OCC-CD       PIC X(6).
  7439         16  FILLER                  PIC X(5).
  7440
  7441     12  CL-PROCESSING-INFO.
  7442         16  CL-PROCESSOR-ID         PIC X(4).
  7443         16  CL-CLAIM-STATUS         PIC X.
  7444             88  CLAIM-IS-OPEN          VALUE 'O'.
  7445             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7446         16  CL-CLAIM-TYPE           PIC X.
  7447*            88  AH-CLAIM               VALUE 'A'.
  7448*            88  LIFE-CLAIM             VALUE 'L'.
  7449*            88  PROPERTY-CLAIM         VALUE 'P'.
  7450*            88  IUI-CLAIM              VALUE 'I'.
  7451*            88  GAP-CLAIM              VALUE 'G'.
  7452*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7453         16  CL-CLAIM-PREM-TYPE      PIC X.
  7454             88  SINGLE-PREMIUM         VALUE '1'.
  7455             88  O-B-COVERAGE           VALUE '2'.
  7456             88  OPEN-END-COVERAGE      VALUE '3'.
  7457         16  CL-INCURRED-DT          PIC XX.
  7458         16  CL-REPORTED-DT          PIC XX.
  7459         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7460         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7461         16  CL-LAST-PMT-DT          PIC XX.
  7462         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7463         16  CL-PAID-THRU-DT         PIC XX.
  7464         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7465         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7466         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7467         16  CL-PMT-CALC-METHOD      PIC X.
  7468             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 138
* EL050.cbl
  7469             88  CL-365-DAY-YR          VALUE '2'.
  7470             88  CL-FULL-MONTHS         VALUE '3'.
  7471         16  CL-CAUSE-CD             PIC X(6).
  7472
  7473         16  CL-PRIME-CERT-NO.
  7474             20  CL-PRIME-CERT-PRIME PIC X(10).
  7475             20  CL-PRIME-CERT-SFX   PIC X.
  7476
  7477         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7478             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7479             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7480
  7481         16  CL-MICROFILM-NO         PIC X(10).
  7482         16  FILLER REDEFINES CL-MICROFILM-NO.
  7483             20  CL-BENEFIT-PERIOD   PIC 99.
  7484             20  FILLER              PIC X(8).
  7485         16  CL-PROG-FORM-TYPE       PIC X.
  7486         16  CL-LAST-ADD-ON-DT       PIC XX.
  7487
  7488         16  CL-LAST-REOPEN-DT       PIC XX.
  7489         16  CL-LAST-CLOSE-DT        PIC XX.
  7490         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7491             88  FINAL-PAID             VALUE '1'.
  7492             88  CLAIM-DENIED           VALUE '2'.
  7493             88  AUTO-CLOSE             VALUE '3'.
  7494             88  MANUAL-CLOSE           VALUE '4'.
  7495             88  BENEFITS-CHANGED       VALUE 'C'.
  7496             88  SETUP-ERRORS           VALUE 'E'.
  7497         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7498         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7499         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7500             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7501         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7502         16  FILLER                  PIC X.
  7503
  7504     12  CL-CERTIFICATE-DATA.
  7505         16  CL-CERT-ORIGIN          PIC X.
  7506             88  CERT-WAS-ONLINE        VALUE '1'.
  7507             88  CERT-WAS-CREATED       VALUE '2'.
  7508             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7509         16  CL-CERT-KEY-DATA.
  7510             20  CL-CERT-CARRIER     PIC X.
  7511             20  CL-CERT-GROUPING    PIC X(6).
  7512             20  CL-CERT-STATE       PIC XX.
  7513             20  CL-CERT-ACCOUNT.
  7514                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7515                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7516             20  CL-CERT-EFF-DT      PIC XX.
  7517
  7518     12  CL-STATUS-CONTROLS.
  7519         16  CL-PRIORITY-CD          PIC X.
  7520             88  CONFIDENTIAL-DATA      VALUE '8'.
  7521             88  HIGHEST-PRIORITY       VALUE '9'.
  7522         16  CL-SUPV-ATTN-CD         PIC X.
  7523             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7524             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7525         16  CL-PURGED-DT            PIC XX.
  7526         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 139
* EL050.cbl
  7527         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7528         16  CL-NEXT-RESEND-DT       PIC XX.
  7529         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7530         16  CL-CRITICAL-PERIOD      PIC 99.
  7531*        16  FILLER                  PIC XX.
  7532         16  CL-LAST-MAINT-DT        PIC XX.
  7533         16  CL-LAST-MAINT-USER      PIC X(4).
  7534         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7535         16  CL-LAST-MAINT-TYPE      PIC X.
  7536             88  CLAIM-SET-UP           VALUE ' '.
  7537             88  PAYMENT-MADE           VALUE '1'.
  7538             88  LETTER-SENT            VALUE '2'.
  7539             88  MASTER-WAS-ALTERED     VALUE '3'.
  7540             88  MASTER-WAS-RESTORED    VALUE '4'.
  7541             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7542             88  FILE-CONVERTED         VALUE '6'.
  7543             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7544             88  ERROR-CORRECTION       VALUE 'E'.
  7545         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7546         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7547         16  CL-BENEFICIARY          PIC X(10).
  7548         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7549         16  CL-DENIAL-TYPE          PIC X.
  7550             88  CL-TYPE-DENIAL          VALUE '1'.
  7551             88  CL-TYPE-RESCISSION      VALUE '2'.
  7552             88  CL-TYPE-REFORMATION     VALUE '3'.
  7553             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7554             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7555         16  filler                  pic x(5).
  7556*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7557*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7558*        16  CL-RTW-DT               PIC XX.
  7559
  7560     12  CL-TRAILER-CONTROLS.
  7561         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7562             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7563             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7564             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7565         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7566         16  FILLER                  PIC XX.
  7567         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7568         16  CL-ADDRESS-TRAILER-CNT.
  7569             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7570                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7571             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7572                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7573             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7574                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7575             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7576                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7577             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7578                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7579             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7580                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7581             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7582                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7583
  7584     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 140
* EL050.cbl
  7585         16  CL-CV-REFNO-PRIME       PIC X(18).
  7586         16  CL-CV-REFNO-SFX         PIC XX.
  7587
  7588     12  CL-FILE-LOCATION            PIC X(4).
  7589
  7590     12  CL-PROCESS-ERRORS.
  7591         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7592             88  NO-FATAL-ERRORS        VALUE ZERO.
  7593         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7594             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7595
  7596     12  CL-PRODUCT-CD               PIC X.
  7597
  7598     12  CL-CURRENT-KEY-DATA.
  7599         16  CL-CURRENT-CARRIER      PIC X.
  7600         16  CL-CURRENT-GROUPING     PIC X(6).
  7601         16  CL-CURRENT-STATE        PIC XX.
  7602         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7603
  7604     12  CL-ASSOCIATES               PIC X.
  7605         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7606         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7607         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7608         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7609
  7610     12  CL-ACTIVITY-CODE            PIC 99.
  7611     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7612     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7613
  7614     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7615     12  CL-LAG-REPORT-CODE          PIC 9.
  7616     12  CL-LOAN-TYPE                PIC XX.
  7617     12  CL-LEGAL-STATE              PIC XX.
  7618
  7619     12  CL-YESNOSW                  PIC X.
  7620     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7621         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7622         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7623         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7624     12  cl-insured-type             pic x.
  7625         88  cl-claim-on-primary         value 'P'.
  7626         88  cl-claim-on-co-borrower     value 'C'.
  7627     12  cl-benefit-expiration-dt    PIC XX.
  7628
  7629 01  PLAN-RECORDS.
  7630     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7631     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7632
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 141
* EL050.cbl
  7634 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7635                          ACCOUNT-MASTER REINSURANCE-RECORD
  7636                          COMM-TABLE-RECORD FORM-MASTER
  7637                          CLAIM-MASTER PLAN-RECORDS.
  7638 0000-DFHEXIT SECTION.
  7639     MOVE '9#                    $   ' TO DFHEIV0.
  7640     MOVE 'EL050' TO DFHEIV1.
  7641     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7642
  7643     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7644
  7645
  7646* EXEC CICS  HANDLE CONDITION
  7647*           ERROR    (9300-ABEND)
  7648*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7649*    END-EXEC.
  7650*    MOVE '"$.J                  ! " #00007641' TO DFHEIV0
  7651     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7652     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7653     MOVE X'2220233030303037363431' TO DFHEIV0(25:11)
  7654     CALL 'kxdfhei1' USING DFHEIV0
  7655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7656
  7657
  7658 0000-COPY-PROCEDURE-DIV.
  7659*                          COPY ELC50PD.
  7660******************************************************************
  7661*                                                                *
  7662*                            ELC50PD                             *
  7663*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7664*                            VMOD=2.188                          *
  7665*                                                                *
  7666******************************************************************
  7667*                   C H A N G E   L O G
  7668*
  7669* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7670*-----------------------------------------------------------------
  7671*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7672* EFFECTIVE    NUMBER
  7673*-----------------------------------------------------------------
  7674* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7675* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7676* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7677*                             2709 AND 2718
  7678* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7679* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7680* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7681* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7682* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7683*                                IS OPEN OR CNC DT < PD THRU
  7684* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7685* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7686* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7687* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7688* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7689* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7690* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7691* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 142
* EL050.cbl
  7692* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7693* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7694* 020906                   PEMA  EXPAND LOAN OFFICER
  7695* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7696* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7697* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7698* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7699* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7700* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7701* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7702* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7703* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7704* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7705* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7706* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7707* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7708* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7709* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7710* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7711* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7712* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7713* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7714* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7715* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7716* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7717* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7718* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7719* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7720*                                UPDATE VIN ON CERT TRAILER
  7721* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7722* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7723* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7724* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7725* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7726* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7727* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7728* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7729* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7730* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7731* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7732* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7733* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7734* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7735* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7736* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7737* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7738* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7739* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7740* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7741* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7742* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7743* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7744* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7745* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7746* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7747* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7748* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7749* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 143
* EL050.cbl
  7750* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7751* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7752* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7753* 032912  CR2011110200001  PEMA  AHL CHANGES
  7754* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7755* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7756* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7757* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7758* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7759* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7760* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7761* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7762* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7763* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7764* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7765* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7766* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7767* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7768* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7769* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7770* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7771* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7772* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7773* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7774* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7775* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7776* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7777* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7778* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7779* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7780* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7781*                                CERT #, ADD 2898 FORCIBLE ERROR
  7782* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7783* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7784* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7785******************************************************************
  7786************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7787******************************************************************
  7788
  7789     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7790
  7791     MOVE SPACES                 TO PB-FATAL-FLAG
  7792                                    PB-FORCE-ER-CD
  7793                                    PB-WARN-ER-CD
  7794                                    PB-OUT-BAL-CD.
  7795
  7796     MOVE SPACE                  TO WS-IG-OVRD-AH
  7797                                    WS-IG-OVRD-LF
  7798                                    WS-IG-OVRD-AM
  7799                                    WS-IG-OVRD
  7800                                    WS-IG-OVRD-AH-PL
  7801                                    WS-IG-OVRD-LF-PL
  7802                                    WS-IG-OVRD-AH-BEN
  7803                                    WS-IG-OVRD-LF-BEN.
  7804
  7805******************************************************************
  7806*************       INITIALIZE COMMON ERRORS       ***************
  7807******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 144
* EL050.cbl
  7808
  7809     MOVE +0                     TO PB-NO-OF-ERRORS.
  7810     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7811
  7812******************************************************************
  7813
  7814     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7815     SET JULIAN-TO-BIN           TO TRUE.
  7816*    MOVE 5                      TO DC-OPTION-CODE.
  7817     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7818     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7819
  7820     MOVE ZERO                   TO  SUB4.
  7821
  7822 0040-INITIALIZE-GA-BILL-DT.
  7823
  7824     ADD +1                      TO  SUB4.
  7825
  7826     IF  SUB4 GREATER THAN +5
  7827         GO TO 0050-CHECK-CNTL-FOUND.
  7828
  7829     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7830         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7831
  7832     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7833
  7834 0050-CHECK-CNTL-FOUND.
  7835
  7836     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7837        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7838                                         WS-AH-REM-TERM-CALC
  7839                                         EC-CO-REM-TERM-CALC
  7840        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7841        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7842        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7843                                         WS-TOL-AH-CLAIM
  7844        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7845                                         WS-TOL-AH-PREM
  7846                                         EC-CO-TOL-PREM
  7847        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7848                                         WS-TOL-AH-REFUND
  7849                                         EC-CO-TOL-REFUND
  7850        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7851                                         WS-AH-REFUND-OVS-AMT
  7852                                         EC-CO-OVR-SHT-AMT
  7853        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7854                                         WS-TOL-AH-PREM-PCT
  7855                                         EC-CO-TOL-PREM-PCT
  7856        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7857                                         WS-TOL-AH-REFUND-PCT
  7858                                         EC-CO-TOL-REFUND-PCT
  7859        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7860                                         WS-AH-REFUND-OVS-PCT
  7861                                         EC-CO-OVR-SHT-PCT
  7862        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
  7863        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7864        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7865        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 145
* EL050.cbl
  7866        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7867        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7868        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7869        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7870        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7871        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7872        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7873        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7874                                         EC-CO-MONTH-END-DT
  7875        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7876          GO TO 0100-READ-ACCT.
  7877
  7878     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7879     MOVE SPACES                 TO CNTL-ACCESS.
  7880     MOVE '1'                    TO CNTL-REC-TYPE.
  7881     MOVE +0                     TO CNTL-SEQ-NO.
  7882
  7883     MOVE '1' TO RC-SW-1.
  7884     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7885     IF NOT CF-COMPANY-MASTER
  7886         MOVE ZEROS             TO WK-CO-TOL-PREM
  7887                                   WK-CO-TOL-CLAIM
  7888                                   WK-CO-TOL-REFUND
  7889                                   WK-REFUND-OVS-AMT
  7890                                   WK-REFUND-OVS-PCT
  7891                                   WK-CO-TOL-PREM-PCT
  7892                                   WK-CO-TOL-REFUND-PCT
  7893                                   WK-DEFAULT-APR
  7894                                   WK-CO-MAX-CAP
  7895        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7896                                   WK-CR-R78-METHOD
  7897                                   WK-CO-REF-REJECT-SW
  7898                                   WK-CO-PREM-REJECT-SW
  7899                                   WK-REM-TRM-CALC-OPTION
  7900                                   WK-BIRTH-DATE-INPUT
  7901                                   WK-JOINT-AGE-INPUT
  7902        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7903        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7904        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7905        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7906          GO TO 0099-COMPANY-NOT-FOUND.
  7907
  7908     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7909        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7910     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7911        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7912     IF CF-CO-TOL-CAP NOT NUMERIC
  7913        MOVE +0                    TO CF-CO-TOL-CAP.
  7914     IF CF-DEFAULT-APR NOT NUMERIC
  7915        MOVE +0                    TO CF-DEFAULT-APR.
  7916
  7917     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7918     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7919     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7920     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
  7921     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7922     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7923     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 146
* EL050.cbl
  7924     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7925     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7926     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7927     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7928     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7929
  7930     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7931          CF-CO-OVR-SHT-AMT > +0
  7932        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7933
  7934     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7935          CF-CO-OVR-SHT-PCT > +0
  7936        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7937
  7938     IF CF-VALID-REM-TRM-OPTION
  7939         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7940     ELSE
  7941         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7942
  7943     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7944     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7945     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7946     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7947
  7948     GO TO 0050-CHECK-CNTL-FOUND.
  7949
  7950 0099-COMPANY-NOT-FOUND.
  7951
  7952     MOVE ER-2616                TO WS-ERROR.
  7953     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7954
  7955 0100-READ-ACCT.
  7956
  7957     MOVE SPACES                 TO DATE-RANGE-SW.
  7958
  7959     IF WK-ACCT-ADDR = ZEROS
  7960        GO TO 0102-ACCT-GETMAIN.
  7961
  7962     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7963     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7964     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7965
  7966     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7967        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7968        GO TO 0105-READ-ACCT
  7969     END-IF
  7970
  7971     IF PB-CARRIER NOT = SPACES
  7972        IF PB-CARRIER NOT = AM-VG-CARRIER
  7973           GO TO 0105-READ-ACCT.
  7974
  7975     IF PB-STATE NOT = SPACES
  7976        IF PB-STATE NOT = AM-VG-STATE
  7977           GO TO 0105-READ-ACCT.
  7978
  7979     IF PB-GROUPING NOT = SPACES
  7980        IF PB-GROUPING NOT = AM-VG-GROUPING
  7981           GO TO 0105-READ-ACCT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 147
* EL050.cbl
  7982
  7983     MOVE 'X'                 TO DATE-RANGE-SW.
  7984
  7985     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7986        MOVE 'X'                 TO DATE-RANGE-SW
  7987        GO TO 0105-READ-ACCT.
  7988
  7989     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7990        GO TO 0105-READ-ACCT.
  7991
  7992     GO TO 0180-ACCOUNT-FOUND.
  7993
  7994 0102-ACCT-GETMAIN.
  7995     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  7996     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  7997
  7998 0105-READ-ACCT.
  7999     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8000     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8001     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8002     MOVE PB-STATE               TO ACCT-STATE.
  8003     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8004     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8005
  8006     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8007
  8008     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8009
  8010 0110-FIND-ACCT-TOLERANCES-LOOP.
  8011     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8012
  8013     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8014        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8015        GO TO 0199-ACCT-NOT-FOUND
  8016     END-IF
  8017     IF PB-CARRIER NOT = SPACES
  8018        IF PB-CARRIER NOT = AM-VG-CARRIER
  8019           GO TO 0199-ACCT-NOT-FOUND.
  8020
  8021     IF PB-STATE NOT = SPACES
  8022        IF PB-STATE NOT = AM-VG-STATE
  8023           GO TO 0199-ACCT-NOT-FOUND.
  8024
  8025     IF PB-GROUPING NOT = SPACES
  8026        IF PB-GROUPING NOT = AM-VG-GROUPING
  8027           GO TO 0199-ACCT-NOT-FOUND.
  8028
  8029     MOVE 'X'                    TO DATE-RANGE-SW.
  8030
  8031     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8032        MOVE 'X'                 TO DATE-RANGE-SW
  8033        GO TO 0199-ACCT-NOT-FOUND.
  8034
  8035     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8036        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
  8037
  8038 0180-ACCOUNT-FOUND.
  8039     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 148
* EL050.cbl
  8040     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8041     MOVE AM-STATE               TO PB-SV-STATE.
  8042     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8043
  8044     IF AM-CANCEL-FEE  NOT NUMERIC
  8045        MOVE ZEROS TO AM-CANCEL-FEE.
  8046
  8047     IF AM-MAX-MON-BEN NOT NUMERIC
  8048        MOVE ZEROS TO AM-MAX-MON-BEN.
  8049
  8050     IF AM-MAX-TOT-BEN NOT NUMERIC
  8051        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8052
  8053     IF AM-CLP-TOL-PCT NOT NUMERIC
  8054        MOVE +0                  TO AM-CLP-TOL-PCT
  8055     END-IF
  8056     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8057        MOVE +0                  TO AM-SPP-LEASE-COMM
  8058     END-IF
  8059     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8060        MOVE ER-2611             TO   WS-ERROR
  8061        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8062
  8063     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8064        MOVE ER-2621             TO   WS-ERROR
  8065        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8066
  8067     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8068        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8069        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8070        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8071         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8072
  8073     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8074     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8075     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8076     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8077     IF AM-CLP-TOL-PCT NOT = ZEROS
  8078        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8079     END-IF
  8080     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8081        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8082     END-IF
  8083*    IF PB-COMPANY-ID = 'DCC'
  8084*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8085*                                   WS-ADMIN-FEES
  8086*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8087*          (SUB5 > +10)
  8088*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8089*             AND (AM-A-COM (SUB5) NUMERIC)
  8090*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8091*                + (AM-A-COM (SUB5) * 1000)
  8092*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8093*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8094*                + (AM-A-COM (SUB5) * 1000)
  8095*             END-IF
  8096*             IF AM-COM-TYP (SUB5) = 'N'
  8097*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 149
* EL050.cbl
  8098*                + (AM-A-COM (SUB5) * 1000)
  8099*             END-IF
  8100*          END-IF
  8101*       END-PERFORM
  8102*    END-IF
  8103     IF (PB-COMPANY-ID = 'DCC')
  8104        AND (PB-ISSUE)
  8105        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8106                                    ws-cred-union-fees
  8107        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8108           (SUB5 > +10)
  8109           MOVE +0 TO WS-WK-RATE
  8110           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8111                                   'O' OR 'S')
  8112              IF (AM-A-COM (SUB5) NUMERIC)
  8113                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8114                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8115              ELSE
  8116                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8117                 IF PB-ISSUE
  8118                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8119                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8120                 ELSE
  8121                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8122                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8123                 END-IF
  8124                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8125                 MOVE ZEROS             TO WS-SUB1
  8126                                           WS-COMMISSION
  8127                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8128                 MOVE '0530'               TO CTBL-SW
  8129                 MOVE ' '                  TO WS-CTBL-READ-SW
  8130                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8131                 IF FIRST-TIME-THROUGH
  8132                    MOVE 'AA'              TO CTBL-BEN-CODE
  8133                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8134                 END-IF
  8135                 IF CTBL-TABLE-FOUND
  8136                    IF PB-ISSUE
  8137                       COMPUTE WS-COMM-CK-AMT =
  8138                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8139                    ELSE
  8140                       COMPUTE WS-COMM-CK-AMT =
  8141                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8142                    END-IF
  8143                    PERFORM 8800-GET-COMP-RATE
  8144                              THRU 8800-EXIT
  8145                 END-IF
  8146              END-IF
  8147              if am-com-typ (sub5) = 'O' or 'S'
  8148                 compute ws-cred-union-fees rounded =
  8149                    ws-cred-union-fees +
  8150                    (pb-i-ah-premium-amt * ws-wk-rate)
  8151              else
  8152                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8153                + (WS-WK-RATE * 1000)
  8154              end-if
  8155           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 150
* EL050.cbl
  8156        END-PERFORM
  8157     END-IF
  8158     IF PB-COMPANY-ID EQUAL 'CRI'
  8159         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8160
  8161     IF PB-COMPANY-ID EQUAL 'NCL'
  8162         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8163     END-IF
  8164
  8165     GO TO 0200-READ-CERT.
  8166
  8167 0199-ACCT-NOT-FOUND.
  8168
  8169     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8170
  8171     IF DATE-RANGE-SW NOT = SPACES
  8172        MOVE ER-2601             TO WS-ERROR
  8173        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8174     ELSE
  8175        MOVE ER-2619             TO WS-ERROR
  8176        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8177
  8178     GO TO 9990-RETURN.
  8179
  8180 0200-READ-CERT.
  8181
  8182     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8183     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8184     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8185     MOVE PB-SV-STATE            TO CERT-STATE.
  8186     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8187     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8188     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8189
  8190     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8191
  8192     IF CERT-WAS-NOT-FOUND
  8193        GO TO 0299-CERT-NOT-FOUND.
  8194
  8195     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8196        MOVE ER-2759             TO WS-ERROR
  8197        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8198        GO TO 0298-UNLOCK-RETURN.
  8199
  8200     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8201         MOVE ER-2758            TO WS-ERROR
  8202         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8203         GO TO 0298-UNLOCK-RETURN.
  8204
  8205     IF PB-ISSUE
  8206        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8207           IF CERT-WAS-CREATED-FOR-CLAIM
  8208              NEXT SENTENCE
  8209            ELSE
  8210              MOVE ER-2626       TO WS-ERROR
  8211              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8212              GO TO 0298-UNLOCK-RETURN.
  8213
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 151
* EL050.cbl
  8214     IF NOT PB-CANCELLATION
  8215        GO TO 0300-CONTINUE-EDIT.
  8216
  8217     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8218     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8219     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8220     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8221     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8222     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8223
  8224     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8225     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8226     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8227     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8228     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8229     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8230     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8231     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8232     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8233
  8234     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8235     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8236     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8237     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8238     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8239     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8240     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8241
  8242     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8243     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8244
  8245     MOVE CM-CREDIT-INTERFACE-SW-1
  8246                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8247     MOVE CM-CREDIT-INTERFACE-SW-2
  8248                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8249
  8250     IF CM-O-B-COVERAGE
  8251         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8252
  8253     IF CM-LIVES NOT NUMERIC
  8254         MOVE ZERO                TO CM-LIVES.
  8255
  8256     IF CM-BILLED NOT NUMERIC
  8257         MOVE ZERO                TO CM-BILLED.
  8258
  8259     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8260         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8261         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8262         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8263         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8264         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8265         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8266         MOVE CM-LIVES             TO PB-CI-LIVES
  8267*The next line causes a problem with my change  I dont think it is
  8268*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
  8269
  8270     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8271     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 152
* EL050.cbl
  8272     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8273     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8274     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8275     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8276
  8277     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8278     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8279     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8280     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8281
  8282     IF CM-LIFE-COMM-PCT NUMERIC
  8283         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8284     ELSE
  8285         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8286
  8287     IF CM-AH-COMM-PCT NUMERIC
  8288         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8289     ELSE
  8290         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8291
  8292     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8293
  8294     IF CM-LOAN-APR       NOT NUMERIC
  8295           MOVE ZERO               TO CM-LOAN-APR.
  8296
  8297     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8298           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8299
  8300     IF CM-LOAN-TERM      NOT NUMERIC
  8301           MOVE ZERO               TO CM-LOAN-TERM.
  8302
  8303     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8304           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8305
  8306     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8307           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8308
  8309     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8310     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8311     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8312     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8313     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8314     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8315     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8316     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8317     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8318     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8319     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8320     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8321
  8322     IF CM-STATE = CM-SSN-STATE
  8323         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8324
  8325     IF CM-STATE NOT = CM-MEMB-STATE
  8326         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
  8327
  8328     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8329
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 153
* EL050.cbl
  8330     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8331        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8332        IF CM-ADDL-CLP NOT NUMERIC
  8333           MOVE +0               TO CM-ADDL-CLP
  8334        END-IF
  8335        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8336        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8337           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8338        END-IF
  8339     END-IF
  8340     IF PB-COMPANY-ID = 'DCC'
  8341        MOVE +0                  TO WS-ADMIN-FEES
  8342                                    WS-CSO-ADMIN-FEE
  8343                                    WS-COMM-AND-MFEE
  8344                                    WS-1ST-YR-ALLOW
  8345        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8346           (SUB5 > +10)
  8347           MOVE +0 TO WS-WK-RATE
  8348           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8349              IF (AM-A-COM (SUB5) NUMERIC)
  8350                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8351                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8352              ELSE
  8353                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8354                 IF PB-ISSUE
  8355                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8356                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8357                 ELSE
  8358                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8359                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8360                 END-IF
  8361                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8362                 MOVE ZEROS             TO WS-SUB1
  8363                                           WS-COMMISSION
  8364                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8365                 MOVE '0530'               TO CTBL-SW
  8366                 MOVE ' '                  TO WS-CTBL-READ-SW
  8367                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8368                 IF FIRST-TIME-THROUGH
  8369                    MOVE 'AA'              TO CTBL-BEN-CODE
  8370                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8371                 END-IF
  8372                 IF CTBL-TABLE-FOUND
  8373                    IF PB-ISSUE
  8374                       COMPUTE WS-COMM-CK-AMT =
  8375                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8376                    ELSE
  8377                       COMPUTE WS-COMM-CK-AMT =
  8378                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8379                    END-IF
  8380                    PERFORM 8800-GET-COMP-RATE
  8381                              THRU 8800-EXIT
  8382                 END-IF
  8383              END-IF
  8384              IF AM-COM-TYP (SUB5) = 'I'
  8385                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8386                   + (WS-WK-RATE * 1000)
  8387              END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 154
* EL050.cbl
  8388              IF AM-COM-TYP (SUB5) = 'N'
  8389                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8390                   + (WS-WK-RATE * 1000)
  8391              END-IF
  8392              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8393                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8394                   + (WS-WK-RATE * 1000)
  8395              END-IF
  8396              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8397                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8398                   + (WS-WK-RATE * 1000)
  8399              END-IF
  8400           END-IF
  8401        END-PERFORM
  8402     END-IF
  8403     GO TO 0300-CONTINUE-EDIT.
  8404
  8405 0298-UNLOCK-RETURN.
  8406      PERFORM 9250-UNLOCK-RETURN
  8407      GO TO 9990-RETURN.
  8408
  8409 0299-CERT-NOT-FOUND.
  8410
  8411     MOVE '1'                     TO CERT-STATUS-SW.
  8412
  8413     IF PB-COMPANY-ID = 'UCL'
  8414         IF WS-ERROR = ER-2799
  8415             GO TO 3000-CONTINUE-EDIT.
  8416
  8417     IF NOT PB-CANCELLATION
  8418         GO TO 0300-CONTINUE-EDIT.
  8419
  8420     MOVE ER-2726                  TO  WS-ERROR.
  8421     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8422     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8423     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8424                                    PB-CI-LF-TERM
  8425                                    PB-C-LF-REM-TERM
  8426                                    PB-CI-AH-TERM
  8427                                    PB-C-AH-REM-TERM
  8428                                    PB-CI-LF-BENEFIT-CD
  8429                                    PB-CI-LF-BENEFIT-AMT
  8430                                    PB-CI-LF-ALT-BENEFIT-AMT
  8431                                    PB-CI-LF-PREMIUM-AMT
  8432                                    PB-CI-LF-ALT-PREMIUM-AMT
  8433                                    PB-CI-AH-BENEFIT-CD
  8434                                    PB-CI-AH-BENEFIT-AMT
  8435                                    PB-CI-AH-PREMIUM-AMT
  8436                                    PB-CI-PAY-FREQUENCY
  8437                                    PB-CI-LOAN-APR
  8438                                    PB-CI-LOAN-TERM
  8439                                    PB-CI-LIFE-COMMISSION
  8440                                    PB-CI-AH-COMMISSION
  8441                                    PB-CI-CURR-SEQ
  8442                                    PB-CI-AH-CANCEL-AMT
  8443                                    PB-CI-LF-CANCEL-AMT
  8444                                    PB-CI-RATE-DEV-PCT-LF
  8445                                    PB-CI-RATE-DEV-PCT-AH
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 155
* EL050.cbl
  8446                                    PB-CI-EXTENTION-DAYS
  8447                                    PB-CI-TERM-IN-DAYS
  8448                                    PB-CI-LIVES
  8449                                    PB-CI-LF-CRIT-PER
  8450                                    PB-CI-AH-CRIT-PER
  8451                                    PB-CI-ADDL-CLP
  8452                                    PB-CI-DDF-IU-RATE-UP.
  8453
  8454     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8455                                    PB-CI-AH-SETTLEMENT-DT
  8456                                    PB-CI-DEATH-DT
  8457                                    PB-CI-LF-PRIOR-CANCEL-DT
  8458                                    PB-CI-AH-PRIOR-CANCEL-DT
  8459                                    PB-CI-ENTRY-DT
  8460                                    PB-CI-LF-EXPIRE-DT
  8461                                    PB-CI-AH-EXPIRE-DT
  8462                                    PB-CI-LOAN-1ST-PMT-DT.
  8463
  8464     IF ACCOUNT-MAST-FOUND
  8465        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8466        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8467
  8468
  8469 0300-CONTINUE-EDIT.
  8470
  8471     IF PB-ISSUE
  8472        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8473            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8474
  8475     IF PB-ISSUE
  8476        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8477            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8478
  8479     IF PB-ISSUE
  8480       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8481          (AM-NO-AH-ONLY)
  8482           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8483               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8484                   MOVE ER-2679 TO WS-ERROR
  8485                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8486
  8487     IF PB-ISSUE
  8488        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8489        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8490        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8491     ELSE
  8492        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8493        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8494        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8495
  8496     MOVE 'N'                    TO PLAN-MASTER-SW
  8497                                    PLAN-MASTER-LIFE-SW
  8498                                    FORM-MASTER-SW
  8499                                    WS-APP-CERT-SW.
  8500
  8501     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8502                                    WS-PL-TOL-LF-REFUND
  8503                                    WS-PL-REF-OVS-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 156
* EL050.cbl
  8504                                    WS-PL-TOL-LF-PREM-PCT
  8505                                    WS-PL-TOL-LF-REFUND-PCT
  8506                                    WS-PL-REF-OVS-PCT
  8507                                    WS-PL-TOL-LF-CLAIM.
  8508
  8509     IF PB-COMPANY-ID = 'NCL'
  8510       IF PB-ISSUE
  8511         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8512             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8513             IF FORM-MASTER-FOUND
  8514                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8515
  8516     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8517        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8518
  8519********************** MON CODE **********************
  8520     IF PB-COMPANY-ID = 'MON'
  8521     IF PB-ISSUE
  8522     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8523        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8524             PB-I-LOAN-APR = ZERO)
  8525               MOVE 14.0         TO PB-I-LOAN-APR.
  8526******************************************************
  8527
  8528     IF PB-COMPANY-ID = 'NCL'
  8529       IF PB-ISSUE
  8530           IF FORM-MASTER-FOUND
  8531             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8532                AM-DISMBR-COVERAGE
  8533                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8534                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8535                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8536                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8537                                           PB-I-LIFE-BENEFIT-CD.
  8538
  8539     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8540
  8541     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8542         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8543         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8544         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8545         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8546         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8547           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8548             GO TO 0301-LIFE-BENEFIT-SEARCH
  8549         ELSE
  8550             NEXT SENTENCE
  8551     ELSE
  8552         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8553
  8554     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8555     MOVE '4'                    TO CNTL-REC-TYPE.
  8556     MOVE +0                     TO CNTL-SEQ-NO.
  8557     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8558
  8559     MOVE '1' TO RC-SW-2.
  8560     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8561
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 157
* EL050.cbl
  8562     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8563        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8564         GO TO 0305-BENEFIT-NOT-FOUND.
  8565
  8566     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8567
  8568 0301-LIFE-BENEFIT-SEARCH.
  8569
  8570     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8571
  8572     IF NO-BENEFIT-FOUND
  8573        GO TO 0305-BENEFIT-NOT-FOUND.
  8574
  8575     IF WS-BEN-CD = '99'
  8576        GO TO 0305-BENEFIT-NOT-FOUND.
  8577
  8578     IF PB-COMPANY-ID = 'NCL'
  8579         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8580             GO TO 0304-LIFE-BENEFIT-FOUND.
  8581
  8582     MOVE +1                     TO SUB5.
  8583     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8584
  8585* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8586* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8587     IF PB-COMPANY-ID = 'DMD'
  8588         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8589
  8590 0302-EDIT-ACCT-LF-BENEFITS.
  8591
  8592     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8593        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8594           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8595                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8596           GO TO 03XX-GET-LIFE-ERPLAN.
  8597
  8598     IF SUB5 LESS THAN +20
  8599        ADD +1                   TO SUB5
  8600        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8601
  8602     MOVE +1                     TO SUB5.
  8603
  8604     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8605        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8606
  8607 0303-EDIT-DMD-EXTRA-BENEFITS.
  8608
  8609     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8610        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8611           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8612                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8613           GO TO 03XX-GET-LIFE-ERPLAN.
  8614
  8615     IF SUB5 LESS THAN +30
  8616        ADD +1                   TO SUB5
  8617        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8618
  8619     MOVE +1                     TO SUB5.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 158
* EL050.cbl
  8620
  8621 03XX-EDIT-FOR-NINETY-LF.
  8622
  8623***************************************************************
  8624*                                                             *
  8625*    NINETY BENEFIT PLAN TYPES:                               *
  8626*                                                             *
  8627*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8628*      92 = ALL GROUP REDUCING BENEFITS                       *
  8629*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8630*      94 = ALL GROUP LEVEL BENEFITS                          *
  8631*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8632*           BENEFIT CONTROLS.                                 *
  8633*      99 = ALL BENEFITS                                      *
  8634*                                                             *
  8635***************************************************************
  8636
  8637     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8638                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8639
  8640     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8641       AND
  8642        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8643        GO TO 03XX-GET-LIFE-ERPLAN.
  8644
  8645     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8646       AND
  8647        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8648        IF CF-REDUCING (SUB3)
  8649           IF (PB-I-INDV-GRP-OVRD = 'I')
  8650              OR
  8651           ((AM-IG = '1') AND
  8652           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8653              OR
  8654           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8655           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8656           (AM-IG NOT = '2'))
  8657              GO TO 03XX-GET-LIFE-ERPLAN.
  8658
  8659     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8660       AND
  8661        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8662        IF CF-REDUCING (SUB3)
  8663           IF (PB-I-INDV-GRP-OVRD = 'G')
  8664              OR
  8665           ((AM-IG = '2') AND
  8666           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8667              OR
  8668           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8669           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8670           (AM-IG NOT = '1'))
  8671              GO TO 03XX-GET-LIFE-ERPLAN.
  8672
  8673     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8674       AND
  8675        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8676        IF CF-LEVEL    (SUB3)
  8677           IF (PB-I-INDV-GRP-OVRD = 'I')
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 159
* EL050.cbl
  8678              OR
  8679           ((AM-IG = '1') AND
  8680           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8681              OR
  8682           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8683           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8684            (AM-IG NOT = '2'))
  8685              GO TO 03XX-GET-LIFE-ERPLAN.
  8686
  8687     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8688       AND
  8689        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8690        IF CF-LEVEL    (SUB3)
  8691           IF (PB-I-INDV-GRP-OVRD = 'G')
  8692              OR
  8693           ((AM-IG = '2') AND
  8694           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8695              OR
  8696           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8697           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8698           (AM-IG NOT = '1'))
  8699              GO TO 03XX-GET-LIFE-ERPLAN.
  8700
  8701     IF SUB5 LESS THAN +20
  8702        ADD +1                   TO SUB5
  8703        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8704
  8705     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8706
  8707     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8708        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8709
  8710     MOVE +1                     TO SUB5.
  8711
  8712 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8713
  8714     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8715                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8716
  8717     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8718       AND
  8719        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8720        GO TO 03XX-GET-LIFE-ERPLAN.
  8721
  8722     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8723       AND
  8724        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8725        IF CF-REDUCING (SUB3)
  8726           IF (PB-I-INDV-GRP-OVRD = 'I')
  8727              OR
  8728           ((AM-IG = '1') AND
  8729           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8730              OR
  8731           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8732           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8733           (AM-IG NOT = '2'))
  8734              GO TO 03XX-GET-LIFE-ERPLAN.
  8735
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 160
* EL050.cbl
  8736     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8737       AND
  8738        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8739        IF CF-REDUCING (SUB3)
  8740           IF (PB-I-INDV-GRP-OVRD = 'G')
  8741              OR
  8742           ((AM-IG = '2') AND
  8743           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8744              OR
  8745           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8746           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8747           (AM-IG NOT = '1'))
  8748              GO TO 03XX-GET-LIFE-ERPLAN.
  8749
  8750     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8751       AND
  8752        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8753        IF CF-LEVEL    (SUB3)
  8754           IF (PB-I-INDV-GRP-OVRD = 'I')
  8755              OR
  8756           ((AM-IG = '1') AND
  8757           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8758              OR
  8759           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8760           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8761            (AM-IG NOT = '2'))
  8762              GO TO 03XX-GET-LIFE-ERPLAN.
  8763
  8764     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8765       AND
  8766        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8767        IF CF-LEVEL    (SUB3)
  8768           IF (PB-I-INDV-GRP-OVRD = 'G')
  8769              OR
  8770           ((AM-IG = '2') AND
  8771           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8772              OR
  8773           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8774           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8775           (AM-IG NOT = '1'))
  8776              GO TO 03XX-GET-LIFE-ERPLAN.
  8777
  8778     IF SUB5 LESS THAN +30
  8779        ADD +1                   TO SUB5
  8780        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8781
  8782     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8783
  8784 03XX-EDIT-FOR-NINETY-LF-CONT.
  8785
  8786     MOVE +99                    TO SUB5.
  8787
  8788     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8789        IF PB-ISSUE
  8790           MOVE ER-1924          TO  WS-ERROR
  8791           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8792
  8793     GO TO 0304-LIFE-BENEFIT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 161
* EL050.cbl
  8794
  8795 03XX-GET-LIFE-ERPLAN.
  8796
  8797     IF WK-PLAN-ADDR EQUAL +0
  8798        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8799
  8800     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8801     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8802     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8803     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8804     MOVE 'Y'                    TO PLAN-MASTER-SW
  8805                                    PLAN-MASTER-LIFE-SW.
  8806     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8807
  8808 03XX-ERPLAN-LIFE-GETMAIN.
  8809
  8810     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8811     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8812
  8813 03XX-ERPLAN-LIFE-READ.
  8814
  8815     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8816     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8817     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8818     MOVE PB-SV-STATE            TO PLAN-STATE.
  8819     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8820     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8821     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8822     MOVE WS-SAVE-BENEFIT-REVISION
  8823                                 TO PLAN-REVISION-NO.
  8824
  8825     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8826     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8827
  8828     IF PB-COMPANY-ID = 'NCL'
  8829       IF NOT LF-PLAN-MASTER-FOUND
  8830         IF NOT PB-POLICY-IS-DECLINED  AND
  8831            NOT PB-POLICY-IS-VOIDED
  8832             MOVE  ER-1921         TO  WS-ERROR
  8833             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8834             GO TO 0304-LIFE-BENEFIT-FOUND.
  8835
  8836     IF NOT LF-PLAN-MASTER-FOUND
  8837        GO TO 0304-LIFE-BENEFIT-FOUND.
  8838
  8839 XXXX-CHECK-LF-PLAN-KEY.
  8840
  8841     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8842        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8843        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8844        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8845        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8846        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8847        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8848        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  8849        MOVE 'N'                 TO PLAN-MASTER-SW
  8850          GO TO 03XX-ERPLAN-LIFE-READ.
  8851
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 162
* EL050.cbl
  8852     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8853
  8854     IF  PB-CANCELLATION
  8855         GO TO  0303-LF-ACCT-BEN-FOUND.
  8856
  8857     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8858        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8859           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8860           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8861              MOVE ER-2644             TO WS-ERROR
  8862              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8863           ELSE
  8864              NEXT SENTENCE
  8865        ELSE
  8866           IF PB-COMPANY-ID NOT = 'NCL'
  8867              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8868                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8869
  8870 0303-LF-ACCT-BEN-FOUND.
  8871
  8872     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8873
  8874     IF PL-DEV-CODE NOT = SPACES
  8875        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8876
  8877     IF PL-DEV-PCT NUMERIC AND
  8878        PL-DEV-PCT NOT = ZEROS
  8879        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8880
  8881     IF PL-TOL-PREM-AMT GREATER THAN +0
  8882        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8883
  8884     IF PL-TOL-REF-AMT GREATER THAN +0
  8885        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8886
  8887     IF PL-TOL-PREM-PCT GREATER THAN +0
  8888        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8889
  8890     IF PL-TOL-REF-PCT GREATER THAN +0
  8891        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8892
  8893     IF PL-TOL-CLM-AMT GREATER THAN +0
  8894        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8895
  8896     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8897                          PL-OVER-SHORT-AMT > +0
  8898        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8899
  8900     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8901                          PL-OVER-SHORT-PCT > +0
  8902        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8903
  8904     IF PL-SALES-TAX NUMERIC AND
  8905                          PL-SALES-TAX > +0
  8906         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
  8907
  8908     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8909        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 163
* EL050.cbl
  8910                                    WS-IG-OVRD-AM.
  8911
  8912 0304-LIFE-BENEFIT-FOUND.
  8913
  8914     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8915
  8916     IF PB-ISSUE
  8917        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8918     ELSE
  8919        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8920
  8921     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8922     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8923     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8924     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8925     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8926                                         WS-LF-REFUND-CALC.
  8927     if (ws-lf-earnings-calc = '5')
  8928        and (pb-i-loan-apr = zeros)
  8929        and (benefit-code-chg)
  8930        move +99.9999 to pb-i-loan-apr
  8931     end-if
  8932
  8933     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8934        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8935
  8936     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8937        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8938     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8939
  8940     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8941     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8942     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8943     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8944     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8945     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8946
  8947     IF PB-COMPANY-ID = 'NCL'  AND
  8948        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8949         NEXT SENTENCE
  8950     ELSE
  8951         IF SUB5 NOT GREATER THAN +20
  8952            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8953               MOVE WS-SAVE-BENEFIT-REM-TERM
  8954                                      TO WS-AM-LF-BENE-REM-TERM
  8955                                         EC-BR-LF-REM-TERM-CALC.
  8956
  8957     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8958     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8959
  8960     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8961
  8962 0305-BENEFIT-NOT-FOUND.
  8963
  8964     MOVE '1'                    TO LF-BENEFIT-ERROR.
  8965     MOVE ER-2604                TO WS-ERROR.
  8966     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8967
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 164
* EL050.cbl
  8969
  8970 0310-FIND-AH-BENEFIT-RECORD.
  8971
  8972     MOVE 'N'                    TO PLAN-MASTER-SW
  8973                                    PLAN-MASTER-AH-SW.
  8974
  8975     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8976                                    WS-PL-TOL-AH-REFUND
  8977                                    WS-AH-PL-REF-OVS-AMT
  8978                                    WS-PL-TOL-AH-PREM-PCT
  8979                                    WS-PL-TOL-AH-REFUND-PCT
  8980                                    WS-AH-PL-REF-OVS-PCT
  8981                                    WS-PL-TOL-AH-CLAIM.
  8982     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8983
  8984
  8985     if pb-issue
  8986        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8987           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8988        end-if
  8989        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8990           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8991           GO TO 0399-BENEFIT-NOT-FOUND
  8992        end-if
  8993     end-if
  8994
  8995     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  8996        GO TO 0400-FIND-CARRIER.
  8997
  8998     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  8999
  9000     IF WK-AH-BEN-ADDR NOT = ZEROS
  9001         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9002         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9003         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9004         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9005           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9006             GO TO 0311-AH-BENEFIT-SEARCH
  9007         ELSE
  9008             NEXT SENTENCE
  9009     ELSE
  9010         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9011
  9012     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9013     MOVE '5'                    TO CNTL-REC-TYPE.
  9014     MOVE +0                     TO CNTL-SEQ-NO.
  9015     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9016
  9017     MOVE '2' TO RC-SW-2.
  9018     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9019
  9020     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9021        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9022          GO TO 0399-BENEFIT-NOT-FOUND.
  9023
  9024     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9025
  9026 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 165
* EL050.cbl
  9027
  9028     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9029
  9030     IF NO-BENEFIT-FOUND
  9031         GO TO 0399-BENEFIT-NOT-FOUND.
  9032
  9033     IF WS-BEN-CD = '99'
  9034        GO TO 0399-BENEFIT-NOT-FOUND.
  9035
  9036     IF PB-COMPANY-ID  =  'NCL'
  9037         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9038             GO TO 0314-A-H-BENEFIT-FOUND.
  9039
  9040     MOVE +1                     TO SUB5.
  9041     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9042
  9043* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9044* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9045     IF PB-COMPANY-ID = 'DMD'
  9046         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9047
  9048 0312-EDIT-ACCT-AH-BENEFITS.
  9049
  9050     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9051        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9052           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9053                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9054           GO TO 03XX-GET-AH-ERPLAN.
  9055
  9056     IF SUB5 LESS THAN +20
  9057        ADD +1                   TO SUB5
  9058        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9059
  9060     MOVE +1                     TO SUB5.
  9061
  9062     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9063        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9064
  9065 0313-EDIT-DMD-EXTRA-BENEFITS.
  9066
  9067     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9068        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9069           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9070                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9071           GO TO 03XX-GET-AH-ERPLAN.
  9072
  9073     IF SUB5 LESS THAN +30
  9074        ADD +1                   TO SUB5
  9075        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9076
  9077     MOVE +1                     TO SUB5.
  9078
  9079 03XX-EDIT-FOR-NINETY-AH.
  9080
  9081***************************************************************
  9082*                                                             *
  9083*    NINETY BENEFIT PLAN TYPES:                               *
  9084*                                                             *
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 166
* EL050.cbl
  9085*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9086*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9087*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9088*           BENEFIT CONTROLS.                                 *
  9089*      99 = ALL BENEFITS.                                     *
  9090*                                                             *
  9091***************************************************************
  9092
  9093     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9094                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9095
  9096     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9097       AND
  9098        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9099        GO TO 03XX-GET-AH-ERPLAN.
  9100
  9101     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9102       AND
  9103        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9104           IF (PB-I-INDV-GRP-OVRD = 'I')
  9105              OR
  9106           ((AM-IG = '1') AND
  9107           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9108              OR
  9109           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9110           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9111           (AM-IG NOT = '2'))
  9112              GO TO 03XX-GET-AH-ERPLAN.
  9113
  9114     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9115       AND
  9116        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9117           IF (PB-I-INDV-GRP-OVRD = 'G')
  9118              OR
  9119           ((AM-IG = '2') AND
  9120           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9121              OR
  9122           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9123           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9124           (AM-IG NOT = '1'))
  9125              GO TO 03XX-GET-AH-ERPLAN.
  9126
  9127     IF SUB5 LESS THAN +20
  9128        ADD +1                   TO SUB5
  9129        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9130
  9131     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9132        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9133
  9134     MOVE +1                    TO SUB5.
  9135
  9136 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9137
  9138     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9139                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9140
  9141     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9142       AND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 167
* EL050.cbl
  9143        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9144        GO TO 03XX-GET-AH-ERPLAN.
  9145
  9146     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9147       AND
  9148        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9149           IF (PB-I-INDV-GRP-OVRD = 'I')
  9150              OR
  9151           ((AM-IG = '1') AND
  9152           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9153              OR
  9154           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9155           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9156           (AM-IG NOT = '2'))
  9157              GO TO 03XX-GET-AH-ERPLAN.
  9158
  9159     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9160       AND
  9161        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9162           IF (PB-I-INDV-GRP-OVRD = 'G')
  9163              OR
  9164           ((AM-IG = '2') AND
  9165           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9166              OR
  9167           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9168           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9169           (AM-IG NOT = '1'))
  9170              GO TO 03XX-GET-AH-ERPLAN.
  9171
  9172     IF SUB5 LESS THAN +30
  9173        ADD +1                   TO SUB5
  9174        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9175
  9176 03XX-EDIT-FOR-NINETY-AH-CONT.
  9177
  9178     MOVE +99                    TO SUB5.
  9179
  9180     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9181
  9182     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9183        IF PB-ISSUE
  9184           MOVE ER-1925          TO  WS-ERROR
  9185           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9186
  9187     GO TO 0314-A-H-BENEFIT-FOUND.
  9188
  9189 03XX-GET-AH-ERPLAN.
  9190
  9191     IF WK-PLAN-ADDR EQUAL +0
  9192         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9193
  9194     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9195     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9196     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9197     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9198     MOVE 'Y'                    TO PLAN-MASTER-SW
  9199                                    PLAN-MASTER-AH-SW.
  9200*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 168
* EL050.cbl
  9201     GO TO 03XX-ERPLAN-AH-READ.
  9202
  9203 03XX-ERPLAN-AH-GETMAIN.
  9204
  9205     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9206     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9207
  9208 03XX-ERPLAN-AH-READ.
  9209
  9210     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9211     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9212     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9213     MOVE PB-SV-STATE            TO PLAN-STATE.
  9214     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9215     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9216     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9217     MOVE WS-SAVE-BENEFIT-REVISION
  9218                                 TO PLAN-REVISION-NO.
  9219
  9220     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9221     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9222
  9223     IF PB-COMPANY-ID = 'NCL'
  9224       IF NOT AH-PLAN-MASTER-FOUND
  9225         IF NOT PB-POLICY-IS-DECLINED  AND
  9226            NOT PB-POLICY-IS-VOIDED
  9227             MOVE  ER-1922         TO  WS-ERROR
  9228             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9229             GO TO 0314-A-H-BENEFIT-FOUND.
  9230
  9231     IF NOT AH-PLAN-MASTER-FOUND
  9232        GO TO 0314-A-H-BENEFIT-FOUND.
  9233
  9234 XXXX-CHECK-AH-PLAN-KEY.
  9235
  9236     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9237        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9238        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9239        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9240        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9241        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9242        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9243        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9244        MOVE 'N'                 TO PLAN-MASTER-SW
  9245          GO TO 03XX-ERPLAN-AH-READ.
  9246
  9247     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9248
  9249     IF  PB-CANCELLATION
  9250         GO TO  0313-AH-ACCT-BEN-FOUND.
  9251
  9252     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9253       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9254          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9255          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9256             MOVE ER-2644             TO WS-ERROR
  9257             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9258          ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 169
* EL050.cbl
  9259             NEXT SENTENCE
  9260       ELSE
  9261          IF PB-COMPANY-ID NOT = 'NCL'
  9262             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9263                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9264
  9265 0313-AH-ACCT-BEN-FOUND.
  9266
  9267     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9268
  9269     IF PL-DEV-CODE NOT = SPACES
  9270        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9271
  9272     IF PL-DEV-PCT NUMERIC AND
  9273        PL-DEV-PCT NOT = ZEROS
  9274        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9275
  9276     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9277        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9278
  9279     IF PL-TOL-REF-AMT NOT EQUAL +0
  9280        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9281
  9282     IF PL-TOL-PREM-PCT GREATER THAN +0
  9283        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9284
  9285     IF PL-TOL-REF-PCT GREATER THAN +0
  9286        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9287
  9288     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9289        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9290
  9291     IF PL-OVER-SHORT-AMT NUMERIC AND
  9292                          PL-OVER-SHORT-AMT > +0
  9293        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9294
  9295     IF PL-OVER-SHORT-PCT NUMERIC AND
  9296                          PL-OVER-SHORT-PCT > +0
  9297        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9298
  9299     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9300        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9301        IF WS-IG-OVRD-AM EQUAL SPACES
  9302            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9303
  9304 0314-A-H-BENEFIT-FOUND.
  9305
  9306     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9307
  9308     IF PB-ISSUE
  9309        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9310       ELSE
  9311        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9312
  9313     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9314     if cf-maximum-benefits (sub3) numeric
  9315        move cf-maximum-benefits (sub3)
  9316                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 170
* EL050.cbl
  9317     else
  9318        move zeros               to ws-ah-max-bens
  9319     end-if
  9320     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9321     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9322     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9323                                         WS-AH-REFUND-CALC.
  9324
  9325     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9326        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9327
  9328     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9329        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9330     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9331
  9332     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9333     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9334     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9335     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9336     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9337     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9338
  9339     IF PB-COMPANY-ID = 'NCL'  AND
  9340        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9341         NEXT SENTENCE
  9342     ELSE
  9343         IF SUB5 NOT GREATER THAN +20
  9344            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9345                MOVE WS-SAVE-BENEFIT-REM-TERM
  9346                                      TO WS-AM-AH-BENE-REM-TERM
  9347                                         EC-BR-AH-REM-TERM-CALC.
  9348
  9349     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9350     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9351
  9352     GO TO 0400-FIND-CARRIER.
  9353
  9354 0399-BENEFIT-NOT-FOUND.
  9355
  9356     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9357     MOVE ER-2605                TO WS-ERROR.
  9358     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9359
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 171
* EL050.cbl
  9361
  9362 0400-FIND-CARRIER.
  9363
  9364     MOVE PB-SV-CARRIER          TO WS-CARR.
  9365
  9366     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9367     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9368     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9369     MOVE '6'                    TO CNTL-REC-TYPE.
  9370
  9371*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9372     MOVE SPACE                  TO WS-DMD-RATING-SW
  9373                                    EC-BR-DMD-RATING-SW.
  9374
  9375     MOVE '2'                    TO RC-SW-1.
  9376     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9377
  9378     IF NOT CF-CARRIER-MASTER
  9379        GO TO 0400-CARRIER-NOT-FOUND.
  9380
  9381 0400-BUILD-CARR-TOL.
  9382
  9383     IF CF-CR-TOL-PREM NUMERIC AND
  9384        CF-CR-TOL-PREM GREATER THAN +0
  9385        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9386                                    WS-TOL-AH-PREM.
  9387
  9388     IF CF-CR-TOL-REFUND NUMERIC AND
  9389        CF-CR-TOL-REFUND GREATER THAN +0
  9390        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9391                                    WS-TOL-AH-REFUND.
  9392
  9393     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9394        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9395        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9396                                    WS-AH-REFUND-OVS-AMT.
  9397
  9398     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9399        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9400        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9401                                    WS-AH-REFUND-OVS-PCT.
  9402
  9403     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9404        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9405        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9406                                    WS-TOL-AH-PREM-PCT.
  9407
  9408     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9409        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9410        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9411                                     WS-TOL-AH-REFUND-PCT.
  9412
  9413     IF CF-COMPANY-ID EQUAL 'DMD'
  9414         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9415                                    EC-BR-DMD-RATING-SW.
  9416
  9417     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9418     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 172
* EL050.cbl
  9419        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9420     END-IF
  9421     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9422        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9423     END-IF
  9424     IF WS-TOL-CLP-PCT = ZEROS
  9425        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9426     END-IF
  9427
  9428     IF WS-SPP-LEASE-COMM = ZEROS
  9429        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9430     END-IF
  9431     GO TO 0400-FIND-ERPDEF.
  9432
  9433 0400-CARRIER-NOT-FOUND.
  9434
  9435     MOVE ER-2602                TO WS-ERROR.
  9436     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9437
  9438 0400-FIND-ERPDEF.
  9439     IF PB-COMPANY-ID = 'DCC'
  9440        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9441        CONTINUE
  9442     ELSE
  9443        GO TO 0400-FIND-ERCOMP
  9444     END-IF
  9445     MOVE ' '                    TO PDEF-MASTER-SW
  9446     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9447     MOVE PB-STATE               TO ERPDEF-STATE
  9448     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9449     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9450     IF PB-ISSUE
  9451        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9452     ELSE
  9453        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9454     END-IF
  9455     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9456     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9457     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9458     IF PDEF-MASTER-FOUND
  9459        MOVE 'N'                 TO PDEF-MASTER-SW
  9460        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9461        IF PDEF-MASTER-FOUND
  9462           IF (ERPDEF-KEY-SAVE (1:16) =
  9463                        PD-CONTROL-PRIMARY (1:16))
  9464              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9465              CONTINUE
  9466           ELSE
  9467              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9468              IF (ERPDEF-KEY-SAVE (1:16) =
  9469                        PD-CONTROL-PRIMARY (1:16))
  9470                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9471                 CONTINUE
  9472              ELSE
  9473                 MOVE 'N'        TO PDEF-MASTER-SW
  9474              END-IF
  9475           END-IF
  9476        END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 173
* EL050.cbl
  9477        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9478     END-IF
  9479     IF PDEF-MASTER-FOUND
  9480        IF PD-TRUNCATED = 'Y'
  9481           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9482        END-IF
  9483     END-IF
  9484     .
  9485 0400-FIND-ERCOMP.
  9486     IF PB-COMPANY-ID = 'DCC'
  9487        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9488           (WS-SUB1 > +10)
  9489           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9490                 OR 'A' OR 'N'
  9491              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9492              MOVE PB-CARRIER    TO COMP-CARRIER
  9493              MOVE PB-GROUPING   TO COMP-GROUPING
  9494              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9495              MOVE AM-AGT (WS-SUB1)
  9496                                 TO COMP-FIN-RESP
  9497              MOVE 'G'           TO COMP-TYPE
  9498              PERFORM 8582-READ-COMPENSATION-MASTER
  9499                                 THRU 8582-EXIT
  9500              IF COMP-MASTER-FOUND
  9501                 IF CO-GA-INACTIVE
  9502                    MOVE ER-2763 TO WS-ERROR
  9503                    PERFORM 9900-ERROR-FORMAT
  9504                                 THRU 9900-EXIT
  9505                    MOVE +11     TO WS-SUB1
  9506                 END-IF
  9507                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9508                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9509                    MOVE ER-2788 TO WS-ERROR
  9510                    PERFORM 9900-ERROR-FORMAT
  9511                                 THRU 9900-EXIT
  9512                    MOVE +11     TO WS-SUB1
  9513                 END-IF
  9514              END-IF
  9515           END-IF
  9516        END-PERFORM
  9517     END-IF
  9518     IF PB-COMPANY-ID = 'DCC'
  9519        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9520           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9521                                    WS-CLP-STATE
  9522        ELSE
  9523           MOVE SPACES           TO PB-I-CLP-STATE
  9524                                    WS-CLP-STATE
  9525        END-IF
  9526     END-IF
  9527
  9528     IF (PB-COMPANY-ID = 'DCC')
  9529        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9530        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9531        CONTINUE
  9532     ELSE
  9533        GO TO 0400-FIND-STATE-RECORD
  9534     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 174
* EL050.cbl
  9535     MOVE SPACES                 TO WS-CLP-STATE
  9536     MOVE +0                     TO WS-BANK-FEE
  9537                                    WS-BANK-LFEE
  9538                                    WS-BANK-NOCHRGB
  9539
  9540     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9541     IF (PB-ISSUE)
  9542        AND (PB-I-BANK-NUMBER NOT =
  9543            SPACES AND ZEROS AND LOW-VALUES)
  9544        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9545     ELSE
  9546        IF (PB-CANCELLATION)
  9547           AND (PB-CI-BANK-NUMBER NOT =
  9548                SPACES AND ZEROS AND LOW-VALUES)
  9549           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9550        END-IF
  9551     END-IF
  9552     IF COMP-FIN-RESP NOT = LOW-VALUES
  9553        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9554        MOVE PB-CARRIER          TO COMP-CARRIER
  9555        MOVE PB-GROUPING         TO COMP-GROUPING
  9556        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9557        MOVE 'B'                 TO COMP-TYPE
  9558        PERFORM 8582-READ-COMPENSATION-MASTER
  9559                                 THRU 8582-EXIT
  9560        IF COMP-MASTER-FOUND
  9561           IF CO-MAX-BANK-FEE NOT NUMERIC
  9562              MOVE +0            TO CO-MAX-BANK-FEE
  9563           END-IF
  9564           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9565              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9566           END-IF
  9567           IF CO-GA-INACTIVE
  9568              MOVE ER-2763       TO WS-ERROR
  9569              PERFORM 9900-ERROR-FORMAT
  9570                                 THRU 9900-EXIT
  9571           END-IF
  9572           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9573              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9574              MOVE ER-2788 TO WS-ERROR
  9575              PERFORM 9900-ERROR-FORMAT
  9576                                 THRU 9900-EXIT
  9577              MOVE +11     TO WS-SUB1
  9578           END-IF
  9579           IF WS-AH-BEN-CATEGORY = 'G'
  9580              MOVE CO-MAX-BANK-FEE
  9581                                 TO WS-BANK-FEE
  9582                                    PB-I-BANK-FEE
  9583           ELSE
  9584              MOVE CO-MAX-BANK-FEE-LEASE
  9585                                 TO WS-BANK-LFEE
  9586                                    PB-I-BANK-FEE
  9587           END-IF
  9588           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9589              AND (WS-AH-REFUND-CALC = 'G'))
  9590                        OR
  9591              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9592              AND (WS-AH-REFUND-CALC NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 175
* EL050.cbl
  9593              CONTINUE
  9594           ELSE
  9595              MOVE ER-2789 TO WS-ERROR
  9596              PERFORM 9900-ERROR-FORMAT
  9597                                 THRU 9900-EXIT
  9598           END-IF
  9599           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9600                                    PB-I-CLP-STATE
  9601           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9602           MOVE CO-CARRIER       TO BXRF-CARRIER
  9603           MOVE CO-GROUPING      TO BXRF-GROUPING
  9604           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9605           MOVE BXRF-MAX-REC-LENGTH
  9606                                 TO BXRF-REC-LENGTH
  9607           PERFORM 8584-READ-BANK-CROSS-REF
  9608                                 THRU 8584-EXIT
  9609           IF BXRF-MASTER-FOUND
  9610              MOVE ' '           TO BANK-ACCT-SW
  9611              MOVE BK-BANK-POINTER-CNT
  9612                                 TO BK-BANK-POINTER-CNT
  9613              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9614                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9615                 OR (BANK-ACCT-FOUND)
  9616                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9617                    AND (BK-AM-EXP-DT (WS-SUB1)
  9618                                 > PB-CERT-EFF-DT)
  9619                    AND (BK-AM-EFF-DT (WS-SUB1)
  9620                                 NOT > PB-CERT-EFF-DT)
  9621                    SET BANK-ACCT-FOUND TO TRUE
  9622                 END-IF
  9623              END-PERFORM
  9624              IF NOT BANK-ACCT-FOUND
  9625                 MOVE ZEROS      TO WS-BANK-FEE
  9626                                    WS-BANK-LFEE
  9627                 MOVE ER-2869    TO WS-ERROR
  9628                 PERFORM 9900-ERROR-FORMAT
  9629                                 THRU 9900-EXIT
  9630              ELSE
  9631                 PERFORM 5000-PROCESS-REPS
  9632                                 THRU 5000-EXIT
  9633                 IF AGENT-MASTER-FOUND
  9634                    MOVE +0      TO WS-BANK-FEE
  9635                                    WS-BANK-LFEE
  9636*                   MOVE AG-SPP-FEES (1)
  9637*                                TO PB-I-BANK-FEE
  9638*                                   WS-BANK-FEE
  9639                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9640                       (WS-SUB1 > +10)
  9641                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9642                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9643                       END-IF
  9644                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9645                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9646                       END-IF
  9647                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
  9648                          AG-SPP-FEES (WS-SUB1)
  9649                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9650                          AG-SPP-LFEES (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 176
* EL050.cbl
  9651                    END-PERFORM
  9652                    IF WS-AH-BEN-CATEGORY = 'G'
  9653                       MOVE WS-BANK-FEE
  9654                                 TO PB-I-BANK-FEE
  9655                    ELSE
  9656                       MOVE WS-BANK-LFEE
  9657                                 TO PB-I-BANK-FEE
  9658                    END-IF
  9659                 END-IF
  9660              END-IF
  9661           END-IF
  9662        ELSE
  9663           MOVE ER-2879          TO WS-ERROR
  9664           PERFORM 9900-ERROR-FORMAT
  9665                                 THRU 9900-EXIT
  9666        END-IF
  9667     ELSE
  9668        MOVE ER-2879             TO WS-ERROR
  9669        PERFORM 9900-ERROR-FORMAT
  9670                                 THRU 9900-EXIT
  9671     END-IF
  9672     IF WS-AH-BEN-CATEGORY = 'G'
  9673        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9674        + WS-BANK-FEE
  9675     ELSE
  9676        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9677        + WS-BANK-LFEE
  9678     END-IF
  9679     .
  9680 0400-FIND-STATE-RECORD.
  9681
  9682     IF WK-STATE-ADDR NOT = ZEROS
  9683         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9684         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9685         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9686         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9687         IF PB-SV-STATE = CF-STATE-CODE
  9688             GO TO 0405-CONTINUE-EDIT
  9689         ELSE
  9690             NEXT SENTENCE
  9691     ELSE
  9692         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9693
  9694     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9695     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9696     MOVE '3'                    TO CNTL-REC-TYPE.
  9697     MOVE +0                     TO CNTL-SEQ-NO.
  9698
  9699     MOVE '3'                    TO RC-SW-2.
  9700     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9701
  9702     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9703        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9704        PB-SV-STATE   NOT = CF-STATE-CODE)
  9705        MOVE ZEROS               TO WS-TOL-LF-CLAIM
  9706                                    WS-TOL-AH-CLAIM
  9707                                    WS-MINIMUM-REFUND
  9708                                    WS-TOL-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 177
* EL050.cbl
  9709                                    WS-TOL-AH-PREM
  9710                                    WS-TOL-LF-REFUND
  9711                                    WS-TOL-AH-REFUND
  9712                                    EC-ST-TOL-PREM-PCT
  9713                                    WS-TOL-LF-PREM-PCT
  9714                                    WS-TOL-AH-PREM-PCT
  9715                                    EC-ST-TOL-REFUND-PCT
  9716                                    WS-TOL-LF-REFUND-PCT
  9717                                    WS-TOL-AH-REFUND-PCT
  9718                                    EC-ST-TOL-PREM
  9719                                    EC-ST-TOL-REFUND
  9720                                    EC-ST-FST-PMT-DAYS-MAX
  9721                                    WS-FREE-LOOK-PERIOD
  9722                                    WS-ST-LF-PREM-TAX
  9723                                    WS-ST-AH-PREM-TAX-I
  9724                                    WS-ST-AH-PREM-TAX-G
  9725                                    WS-BANK-FEE
  9726                                    WS-BANK-LFEE
  9727                                    WS-TOL-CLP-PCT
  9728                                    WS-SPP-LEASE-COMM
  9729                                    WS-INT-PERIODS
  9730                                    WS-EXTRA-PMTS
  9731        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9732                                    EC-ST-FST-PMT-DAYS-CHG
  9733                                    WS-LF-REM-TERM-CALC
  9734                                    WS-LF-REFUND-CALC
  9735                                    EC-ST-LF-REM-TERM-CALC
  9736                                    EC-ST-LF-REFUND-CALC
  9737                                    WS-AH-REM-TERM-CALC
  9738                                    WS-AH-REFUND-CALC
  9739                                    WS-LF-BEN-CATEGORY
  9740                                    WS-AH-BEN-CATEGORY
  9741                                    WS-CLP-STATE
  9742                                    WS-ST-REFUND-CLAIM-FLAG
  9743                                    WS-ST-CAUSAL-STATE
  9744                                    ws-st-agent-sig-edit
  9745                                    EC-ST-AH-REM-TERM-CALC
  9746                                    EC-ST-AH-REFUND-CALC
  9747          GO TO 0499-STATE-NOT-FOUND.
  9748
  9749     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9750
  9751 0405-CONTINUE-EDIT.
  9752
  9753     if pb-company-id = 'AHL'
  9754        continue
  9755     else
  9756        IF PB-CERT-PRIME NOT NUMERIC
  9757           MOVE ER-2722          TO WS-ERROR
  9758           PERFORM 9900-ERROR-FORMAT
  9759                                 THRU 9900-EXIT
  9760        end-if
  9761     END-IF
  9762*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9763*       MOVE +0                  TO SUB3
  9764*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9765*       IF SUB3 > +0
  9766*          MOVE ER-2722          TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 178
* EL050.cbl
  9767*          PERFORM 9900-ERROR-FORMAT
  9768*                                THRU 9900-EXIT
  9769*       END-IF
  9770*    END-IF
  9771*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9772*       IF PB-CERT-PRIME NOT NUMERIC
  9773*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9774*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9775*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9776*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9777*
  9778*          MOVE ER-2722          TO WS-ERROR
  9779*          PERFORM 9900-ERROR-FORMAT
  9780*                                THRU 9900-EXIT
  9781*       END-IF
  9782*    END-IF
  9783
  9784     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9785
  9786     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9787        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9788                                    WS-TOL-AH-CLAIM.
  9789
  9790     IF CF-ST-REFUND-MIN NOT NUMERIC
  9791        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9792
  9793     IF CF-ST-REFUND-MIN NOT = ZEROS
  9794        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9795
  9796     IF CF-ST-TOL-PREM  NOT = ZEROS
  9797        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9798                                    WS-TOL-AH-PREM
  9799        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9800
  9801     IF CF-ST-TOL-REFUND NOT = ZEROS
  9802        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9803                                    WS-TOL-AH-REFUND
  9804        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9805
  9806     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9807        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9808        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9809                                    WS-AH-REFUND-OVS-AMT
  9810                                    EC-ST-OVR-SHT-AMT.
  9811
  9812     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9813        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9814        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9815                                    WS-TOL-LF-PREM-PCT
  9816                                    WS-TOL-AH-PREM-PCT.
  9817
  9818     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9819        CF-ST-TOL-REF-PCT GREATER THAN +0
  9820        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9821                                    WS-TOL-LF-REFUND-PCT
  9822                                    WS-TOL-AH-REFUND-PCT.
  9823
  9824     IF CF-ST-OVR-SHT-PCT NUMERIC AND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 179
* EL050.cbl
  9825        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9826        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9827                                    WS-AH-REFUND-OVS-PCT
  9828                                    EC-ST-OVR-SHT-PCT.
  9829
  9830     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9831     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9832
  9833     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9834          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9835
  9836     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9837     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9838     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9839
  9840     IF CF-ST-LF-PREM-TAX NUMERIC
  9841        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9842     END-IF
  9843     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9844        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9845     END-IF
  9846     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9847        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9848     END-IF
  9849
  9850     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9851         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9852     END-IF.
  9853
  9854     IF CF-ST-CAUSAL-STATE > SPACES
  9855         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9856     END-IF.
  9857     if cf-st-extra-interest-periods not numeric
  9858        move zeros               to cf-st-extra-interest-periods
  9859     end-if
  9860     if cf-st-extra-payments not numeric
  9861        move zeros               to cf-st-extra-payments
  9862     end-if
  9863
  9864     move cf-st-extra-interest-periods
  9865                                 to ws-int-periods
  9866     move cf-st-extra-payments   to ws-extra-pmts
  9867     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9868     move cf-st-net-only-state   to ws-net-only-state
  9869     IF WS-LF-BENEFIT-CD = ZEROS
  9870        GO TO 0410-CHECK-AH.
  9871
  9872     IF CF-ST-RT-CALC NOT = SPACES
  9873        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9874                                    EC-ST-LF-REM-TERM-CALC
  9875     END-IF
  9876
  9877     IF WS-LF-COVERAGE-TYPE = 'R'
  9878        IF WS-LF-EARNINGS-CALC = '5'
  9879           IF CF-ST-RF-LN-CALC > '0'
  9880              MOVE CF-ST-RF-LN-CALC
  9881                                 TO WS-LF-REFUND-CALC
  9882                                    EC-ST-LF-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 180
* EL050.cbl
  9883           END-IF
  9884        ELSE
  9885           IF CF-ST-RF-LR-CALC > '0'
  9886              MOVE CF-ST-RF-LR-CALC
  9887                                 TO WS-LF-REFUND-CALC
  9888                                    EC-ST-LF-REFUND-CALC
  9889           END-IF
  9890        END-IF
  9891     ELSE
  9892        IF CF-ST-RF-LL-CALC > '0'
  9893           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9894                                    EC-ST-LF-REFUND-CALC
  9895        END-IF
  9896     END-IF
  9897
  9898     IF CF-ST-RT-CALC NOT = SPACES
  9899        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9900                                    EC-ST-LF-REM-TERM-CALC
  9901     END-IF
  9902
  9903     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9904     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9905
  9906     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9907
  9908     IF NO-BENEFIT-FOUND
  9909        GO TO 0410-CHECK-AH.
  9910
  9911     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9912        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9913                                 TO EC-ST-LF-REM-TERM-CALC
  9914                                    WS-LF-REM-TERM-CALC
  9915     END-IF
  9916
  9917     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9918        MOVE CF-ST-REFUND-CALC (SUB3)
  9919                                 TO WS-LF-REFUND-CALC
  9920                                    EC-ST-LF-REFUND-CALC
  9921     END-IF
  9922*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9923     if cf-st-extra-periods (sub3) not numeric
  9924        move zeros               to cf-st-extra-periods (sub3)
  9925     end-if
  9926     if cf-st-extra-periods (sub3) > zeros
  9927        if ws-lf-ben-category = 'P'
  9928           move cf-st-extra-periods (sub3)
  9929                                 to ws-extra-pmts
  9930        else
  9931           if ws-lf-ben-category = 'I'
  9932              move cf-st-extra-periods (sub3)
  9933                                 to ws-int-periods
  9934           end-if
  9935        end-if
  9936     end-if
  9937     .
  9938 0410-CHECK-AH.
  9939
  9940     IF WS-AH-BENEFIT-CD = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 181
* EL050.cbl
  9941        GO TO 0500-SET-ACCOUNT.
  9942
  9943     IF CF-ST-RT-CALC NOT = SPACES
  9944        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9945                                    EC-ST-AH-REM-TERM-CALC
  9946     END-IF
  9947
  9948     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9949        IF CF-ST-RF-CP-CALC > '0'
  9950           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9951                                    EC-ST-AH-REFUND-CALC
  9952        END-IF
  9953     ELSE
  9954        IF CF-ST-RF-AH-CALC > '0'
  9955           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9956                                    EC-ST-AH-REFUND-CALC
  9957        END-IF
  9958     END-IF
  9959     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9960     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9961
  9962     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9963
  9964     IF NO-BENEFIT-FOUND
  9965        GO TO 0500-SET-ACCOUNT.
  9966
  9967     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9968        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9969                                 TO WS-AH-REM-TERM-CALC
  9970                                    EC-ST-AH-REM-TERM-CALC
  9971     END-IF
  9972
  9973     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9974        MOVE CF-ST-REFUND-CALC (SUB3)
  9975                                 TO WS-AH-REFUND-CALC
  9976                                    EC-ST-AH-REFUND-CALC
  9977     END-IF
  9978
  9979*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9980
  9981     GO TO 0500-SET-ACCOUNT.
  9982
  9983 0499-STATE-NOT-FOUND.
  9984
  9985     MOVE ER-2603                TO WS-ERROR.
  9986     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9987
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 182
* EL050.cbl
  9989
  9990 0500-SET-ACCOUNT.
  9991*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
  9992     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
  9993        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
  9994        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
  9995        MOVE WS-CLP-STATE        TO CNTL-ACCESS
  9996        MOVE '3'                 TO CNTL-REC-TYPE
  9997        MOVE +0                  TO CNTL-SEQ-NO
  9998
  9999        MOVE '3'                 TO RC-SW-2
 10000        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10001
 10002        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10003           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10004           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10005           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10006                                    WS-ST-AH-PREM-TAX-I
 10007                                    WS-ST-AH-PREM-TAX-G
 10008        ELSE
 10009           IF CF-ST-LF-PREM-TAX NUMERIC
 10010              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10011           END-IF
 10012           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10013              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10014           END-IF
 10015           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10016              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10017           END-IF
 10018        END-IF
 10019        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10020     END-IF
 10021*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10022*  FOR DCC ONLY
 10023     IF PB-COMPANY-ID = 'DCC'
 10024
 10025     MOVE ' '                    TO STAT-MASTER-SW
 10026     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 10027     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 10028     MOVE PB-GROUPING            TO ELSTAT-GROUP
 10029     MOVE PB-STATE               TO ELSTAT-STATE
 10030     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10031        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 10032     END-IF
 10033
 10034     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 10035     SET BIN-TO-GREG             TO TRUE
 10036     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 10037     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 10038     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 10039
 10040     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 10041     IF STAT-MASTER-FOUND
 10042        MOVE 'N'                 TO STAT-MASTER-SW
 10043        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10044        IF STAT-MASTER-FOUND
 10045           IF (ELSTAT-KEY-SAVE (1:12) =
 10046                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 183
* EL050.cbl
 10047              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10048                 MOVE 'F'        TO STAT-MASTER-SW
 10049              ELSE
 10050                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10051                 IF (STAT-MASTER-FOUND)
 10052                    AND (ELSTAT-KEY-SAVE (1:12) =
 10053                        SF-CONTROL-PRIMARY (1:12))
 10054                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10055                    MOVE 'F'     TO STAT-MASTER-SW
 10056                 END-IF
 10057              END-IF
 10058           END-IF
 10059        END-IF
 10060     END-IF
 10061
 10062     IF STAT-MASTER-SW = 'F'
 10063        IF SF-ST-LF-PREM-TAX NUMERIC
 10064           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10065        END-IF
 10066        IF SF-ST-AH-PREM-TAX-I NUMERIC
 10067           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10068        END-IF
 10069        IF SF-ST-AH-PREM-TAX-G NUMERIC
 10070           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10071        END-IF
 10072     END-IF
 10073
 10074     END-IF
 10075     IF (PB-COMPANY-ID = 'DCC')
 10076        AND (PB-ISSUE)
 10077        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10078        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10079        AND (AM-GPCD = 06)
 10080        MOVE 'Y'                 TO WS-GOOD-HIN
 10081        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10082           MOVE PB-I-VIN         TO WS-WORK-VIN
 10083           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10084              (V1 > 16)
 10085              IF WS-WORK-VIN (V1:1) NUMERIC
 10086                 MOVE WS-WORK-VIN-N (V1)
 10087                                 TO WS-ROW-B-VAL (V1)
 10088              ELSE
 10089                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10090                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10091                    OR (V2 > 26)
 10092                 END-PERFORM
 10093                 IF V2 < 27
 10094                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10095                 ELSE
 10096                    MOVE 'N'     TO WS-GOOD-HIN
 10097                 END-IF
 10098              END-IF
 10099              COMPUTE WS-ROW-D-VAL (V1) =
 10100                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10101              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10102                 WS-ROW-D-VAL (V1)
 10103           END-PERFORM
 10104           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 184
* EL050.cbl
 10105           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10106             REMAINDER WS-VIN-REMAINDER
 10107           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10108              CONTINUE
 10109           ELSE
 10110              MOVE 'N'           TO WS-GOOD-HIN
 10111           END-IF
 10112        ELSE
 10113           MOVE 'N'              TO WS-GOOD-HIN
 10114        END-IF
 10115        IF WS-GOOD-HIN NOT = 'Y'
 10116           MOVE ER-3826           TO WS-ERROR
 10117           PERFORM 9900-ERROR-FORMAT
 10118                                 THRU 9900-EXIT
 10119        END-IF
 10120     END-IF
 10121     IF (PB-COMPANY-ID = 'DCC')
 10122        AND (PB-ISSUE)
 10123        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10124        AND (AM-GPCD NOT = 06)
 10125        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10126           perform 3400-edit-vin thru 3400-exit
 10127        ELSE
 10128          MOVE ER-3826           TO WS-ERROR
 10129          PERFORM 9900-ERROR-FORMAT
 10130                                 THRU 9900-EXIT
 10131        END-IF
 10132     END-IF
 10133     if (pb-company-id = 'CID')
 10134        and (pb-issue)
 10135        and (pb-i-vin not = spaces and low-values and zeros)
 10136        perform 3400-edit-vin    thru 3400-exit
 10137     end-if
 10138******************************************************************
 10139******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10140******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10141******* METHODS.
 10142******************************************************************
 10143     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10144        IF PB-CANCELLATION
 10145           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10146              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10147                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10148                IF FORM-MASTER-FOUND
 10149                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10150******************************************************************
 10151
 10152     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10153     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10154
 10155     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10156     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10157     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10158     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10159
 10160
 10161     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10162     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 185
* EL050.cbl
 10163     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10164
 10165     IF AM-LF-OB-RATE NOT NUMERIC
 10166         MOVE ZERO               TO AM-LF-OB-RATE.
 10167
 10168     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10169         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10170
 10171     IF AM-AH-OB-RATE NOT NUMERIC
 10172         MOVE ZERO               TO AM-AH-OB-RATE.
 10173
 10174     IF WS-LF-JOINT-INDICATOR = 'J'
 10175         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10176     ELSE
 10177         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10178
 10179     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10180
 10181     IF WS-IG-OVRD-AM  EQUAL SPACE
 10182         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10183
 10184     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10185         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10186                                       WS-IG-OVRD
 10187     ELSE
 10188         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10189             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10190                                       WS-IG-OVRD
 10191         ELSE
 10192             MOVE AM-IG             TO WS-IG-OVRD-AH
 10193                                       WS-IG-OVRD.
 10194
 10195     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10196         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10197                                       WS-IG-OVRD
 10198     ELSE
 10199         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10200             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10201                                       WS-IG-OVRD
 10202         ELSE
 10203             MOVE AM-IG             TO WS-IG-OVRD-LF
 10204                                       WS-IG-OVRD.
 10205
 10206     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10207     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10208     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10209     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10210     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10211
 10212     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10213     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10214     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10215     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10216
 10217     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10218     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10219     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10220     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 186
* EL050.cbl
 10221     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10222     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10223     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10224
 10225     IF WS-ACCT-AH-DEV-PCT > +0
 10226        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10227     ELSE
 10228        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10229
 10230     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10231        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10232     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10233        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10234
 10235        IF AM-EARN-METHOD-L = 'S'
 10236            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10237                                        WS-LF-REFUND-CALC.
 10238
 10239        IF AM-EARN-METHOD-R = 'S'
 10240            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10241                                        WS-LF-REFUND-CALC.
 10242
 10243     IF WS-LF-COVERAGE-TYPE = 'R'
 10244         IF AM-EARN-METHOD-R = 'R'
 10245            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10246                                    WS-LF-REFUND-CALC.
 10247     IF WS-LF-COVERAGE-TYPE = 'R'
 10248         IF AM-EARN-METHOD-R = 'P'
 10249            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10250                                    WS-LF-REFUND-CALC.
 10251     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10252         IF AM-EARN-METHOD-L = 'R'
 10253            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10254                                    WS-LF-REFUND-CALC.
 10255     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10256         IF AM-EARN-METHOD-L = 'P'
 10257            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10258                                    WS-LF-REFUND-CALC.
 10259     IF WS-LF-COVERAGE-TYPE = 'R'
 10260         IF AM-EARN-METHOD-R = 'A'
 10261            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10262                                    WS-LF-REFUND-CALC.
 10263     IF WS-LF-COVERAGE-TYPE = 'R'
 10264         IF AM-EARN-METHOD-R = 'M'
 10265            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10266                                    WS-LF-REFUND-CALC.
 10267     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10268         IF AM-EARN-METHOD-L = 'A'
 10269            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10270                                    WS-LF-REFUND-CALC.
 10271     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10272         IF AM-EARN-METHOD-L = 'M'
 10273            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10274                                    WS-LF-REFUND-CALC.
 10275
 10276     IF AM-EARN-METHOD-A = 'R'
 10277        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10278                                    WS-AH-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 187
* EL050.cbl
 10279     IF AM-EARN-METHOD-A = 'P'
 10280        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10281                                    WS-AH-REFUND-CALC.
 10282     IF AM-EARN-METHOD-A = 'C'
 10283        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10284                                    WS-AH-REFUND-CALC.
 10285     IF AM-EARN-METHOD-A = 'A'
 10286        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10287                                    WS-AH-REFUND-CALC.
 10288     IF AM-EARN-METHOD-A = 'M'
 10289        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10290                                    WS-AH-REFUND-CALC.
 10291     IF AM-EARN-METHOD-A = 'N'
 10292        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10293                                    WS-AH-REFUND-CALC.
 10294     IF AM-EARN-METHOD-A = 'S'
 10295        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10296                                    WS-AH-REFUND-CALC.
 10297
 10298     IF AM-TOL-PREM NOT = ZEROS
 10299        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10300                                    WS-TOL-AH-PREM.
 10301
 10302     IF AM-OVR-SHT-AMT NUMERIC AND
 10303                  AM-OVR-SHT-AMT > 0
 10304        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10305                                    EC-AM-LF-OVR-SHT-AMT
 10306                                    WS-AH-REFUND-OVS-AMT
 10307                                    EC-AM-AH-OVR-SHT-AMT.
 10308
 10309     IF AM-OVR-SHT-PCT NUMERIC AND
 10310                    AM-OVR-SHT-PCT > 0
 10311        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10312                                    EC-AM-LF-OVR-SHT-PCT
 10313                                    WS-AH-REFUND-OVS-PCT
 10314                                    EC-AM-AH-OVR-SHT-PCT.
 10315
 10316     IF AM-TOL-REF-PCT NUMERIC AND
 10317                  AM-TOL-REF-PCT > 0
 10318        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10319                                    WS-TOL-AH-REFUND-PCT.
 10320
 10321     IF AM-TOL-REF  NOT = ZEROS  AND
 10322                  AM-TOL-REF NUMERIC
 10323        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10324                                    EC-AM-LF-TOL-REFUND
 10325                                    WS-TOL-AH-REFUND
 10326                                    EC-AM-AH-TOL-REFUND.
 10327
 10328     IF AM-TOL-CLM  NOT = ZEROS
 10329        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10330                                    WS-TOL-AH-CLAIM.
 10331
 10332     IF AM-CLP-TOL-PCT NOT NUMERIC
 10333        MOVE +0                  TO AM-CLP-TOL-PCT
 10334     END-IF
 10335
 10336     IF AM-SPP-LEASE-COMM NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 188
* EL050.cbl
 10337        MOVE +0                  TO AM-SPP-LEASE-COMM
 10338     END-IF
 10339     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10340        MOVE WS-PL-TOL-LF-PREM-PCT
 10341                                 TO WS-TOL-LF-PREM-PCT.
 10342
 10343     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10344        MOVE WS-PL-TOL-AH-PREM-PCT
 10345                                 TO WS-TOL-AH-PREM-PCT.
 10346
 10347     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10348        MOVE WS-PL-TOL-LF-REFUND-PCT
 10349                                 TO WS-TOL-LF-REFUND-PCT.
 10350
 10351     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10352        MOVE WS-PL-TOL-AH-REFUND-PCT
 10353                                 TO WS-TOL-AH-REFUND-PCT.
 10354
 10355     IF WS-PL-REF-OVS-AMT > +0
 10356        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10357
 10358     IF WS-PL-REF-OVS-PCT > +0
 10359        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10360
 10361     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10362        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10363     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10364        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10365     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10366        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10367     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10368        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10369     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10370        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10371     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10372        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10373
 10374     IF WS-AH-PL-REF-OVS-AMT > +0
 10375        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10376
 10377     IF WS-AH-PL-REF-OVS-PCT > +0
 10378        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10379
 10380     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10381     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10382
 10383     IF PB-CANCELLATION
 10384        GO TO 3000-CONTINUE-EDIT.
 10385
 10386     MOVE +1 TO SUB1.
 10387     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10388     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10389
 10390     IF CF-COMPANY-ID = 'DMD'
 10391       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10392         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10393        ELSE
 10394         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 189
* EL050.cbl
 10395
 10396  0525-FIND-ACCT-COMM.
 10397     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10398        NEXT SENTENCE
 10399      ELSE
 10400         ADD +1 TO SUB1
 10401         IF SUB1 LESS +11
 10402            GO TO 0525-FIND-ACCT-COMM
 10403          ELSE
 10404             GO TO 0560-EDIT-CONTINUE.
 10405
 10406     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10407     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10408                                    PB-I-LIFE-COMMISSION.
 10409***  IF PB-COMPANY-ID = 'CRI'
 10410     IF PB-PREM-ACCTNG-ONLY
 10411         GO TO 0560-EDIT-CONTINUE.
 10412
 10413     MOVE '0530' TO CTBL-SW.
 10414     MOVE ' '    TO WS-CTBL-READ-SW.
 10415
 10416
 10417 0530-GET-AH-COMP.
 10418     IF NO-AH-COVERAGE  OR
 10419        NO-AH-BENEFIT-MATCH
 10420           GO TO 0540-NEXT-READ-STEP.
 10421
 10422     IF AM-A-COM (SUB1) NUMERIC
 10423        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10424         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10425         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10426         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10427         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10428     ELSE
 10429          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10430          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10431          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10432          MOVE ZEROS             TO WS-SUB1
 10433                                    WS-COMMISSION
 10434          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10435          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10436          IF WS-COMMISSION > ZEROS
 10437             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10438             GO TO 0540-NEXT-READ-STEP
 10439          END-IF
 10440          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10441          IF CTBL-TABLE-FOUND
 10442             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10443                                        PB-I-AH-TERM
 10444             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10445             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10446             GO TO 0540-NEXT-READ-STEP
 10447          ELSE
 10448             IF FIRST-TIME-THROUGH
 10449                 GO TO 0530-GET-AH-COMP
 10450             ELSE
 10451                 MOVE ER-2609                TO WS-ERROR
 10452                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 190
* EL050.cbl
 10453
 10454 0540-NEXT-READ-STEP.
 10455     MOVE '0540' TO CTBL-SW.
 10456     MOVE ' '    TO WS-CTBL-READ-SW.
 10457
 10458 0540-GET-LF-COMP.
 10459     IF NO-LIFE-COVERAGE  OR
 10460        NO-LF-BENEFIT-MATCH
 10461           GO TO 0560-EDIT-CONTINUE.
 10462
 10463     IF WS-LF-JOINT-INDICATOR = 'J'
 10464        IF AM-J-COM (SUB1) NUMERIC
 10465           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10466           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10467           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10468           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10469           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10470        ELSE
 10471           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10472           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10473           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10474           MOVE ZEROS                TO WS-SUB1
 10475                                        WS-COMMISSION
 10476           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10477           IF WS-COMMISSION > ZEROS
 10478              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10479              GO TO 0560-EDIT-CONTINUE
 10480           END-IF
 10481           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10482           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10483           IF CTBL-TABLE-FOUND
 10484              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10485              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10486              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10487              GO TO 0560-EDIT-CONTINUE
 10488           ELSE
 10489              IF FIRST-TIME-THROUGH
 10490                  GO TO 0540-GET-LF-COMP
 10491              ELSE
 10492                  MOVE ER-2609                TO WS-ERROR
 10493                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10494                  GO TO 0560-EDIT-CONTINUE.
 10495
 10496     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10497        IF AM-L-COM (SUB1) NUMERIC
 10498           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10499           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10500           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10501           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10502           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10503        ELSE
 10504           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10505           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10506           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10507           MOVE ZEROS                TO WS-SUB1
 10508                                        WS-COMMISSION
 10509           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10510           IF WS-COMMISSION IS GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 191
* EL050.cbl
 10511              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10512              GO TO 0560-EDIT-CONTINUE
 10513           END-IF
 10514           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10515           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10516           IF CTBL-TABLE-FOUND
 10517              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10518              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10519              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10520              GO TO 0560-EDIT-CONTINUE
 10521           ELSE
 10522              IF FIRST-TIME-THROUGH
 10523                  GO TO 0540-GET-LF-COMP
 10524              ELSE
 10525                  MOVE ER-2609                TO WS-ERROR
 10526                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10527
 10528*    GO TO 0560-EDIT-CONTINUE.
 10529
 10530 0560-EDIT-CONTINUE.
 10531     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10532                                    WS-AH-PMF-COMM
 10533*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10534*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10535     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10536        (SUB1 > +10)
 10537        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10538           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10539           MOVE '0530'           TO CTBL-SW
 10540           MOVE ' '              TO WS-CTBL-READ-SW
 10541           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10542           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10543           MOVE '0540'           TO CTBL-SW
 10544           MOVE ' '              TO WS-CTBL-READ-SW
 10545           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10546        END-IF
 10547     END-PERFORM
 10548     GO TO 0564-EDIT-CONTINUE
 10549     .
 10550 0561-CHECK-AH.
 10551     IF (NO-AH-COVERAGE)
 10552        OR (NO-AH-BENEFIT-MATCH)
 10553        CONTINUE
 10554     ELSE
 10555        IF (AM-A-COM (SUB1) NUMERIC)
 10556           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10557           IF (AM-COM-TYP (SUB1) = 'A')
 10558              AND (WS-AH-PMF-COMM = ZEROS)
 10559              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10560           END-IF
 10561           CONTINUE
 10562        ELSE
 10563           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10564           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10565           MOVE PB-AH-OVERRIDE-L1
 10566                                 TO CTBL-BEN-TYPE
 10567           MOVE ZEROS            TO WS-SUB1
 10568                                    WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 192
* EL050.cbl
 10569           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10570           PERFORM 8300-READ-CTBL-TABLE
 10571                                 THRU 8300-EXIT
 10572           IF CTBL-TABLE-FOUND
 10573              IF (AM-COM-TYP (SUB1) = 'A')
 10574                 AND (WS-AH-PMF-COMM = ZEROS)
 10575                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10576                                        PB-I-AH-TERM
 10577                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10578                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10579              END-IF
 10580              CONTINUE
 10581           ELSE
 10582              IF FIRST-TIME-THROUGH
 10583                 GO TO 0561-CHECK-AH
 10584              ELSE
 10585                 MOVE ER-2609    TO WS-ERROR
 10586                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10587              END-IF
 10588           END-IF
 10589        END-IF
 10590     END-IF
 10591     .
 10592 0561-EXIT.
 10593     EXIT.
 10594 0563-CHECK-LF.
 10595     IF (NO-LIFE-COVERAGE)
 10596        OR (NO-LF-BENEFIT-MATCH)
 10597        CONTINUE
 10598     ELSE
 10599        IF WS-LF-JOINT-INDICATOR = 'J'
 10600           IF AM-J-COM (SUB1) NUMERIC
 10601              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10602              IF (AM-COM-TYP (SUB1) = 'A')
 10603                 AND (WS-LF-PMF-COMM = ZEROS)
 10604                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10605              END-IF
 10606              CONTINUE
 10607           ELSE
 10608              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10609              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10610              MOVE PB-LIFE-OVERRIDE-L1
 10611                                 TO CTBL-BEN-TYPE
 10612              MOVE ZEROS         TO WS-SUB1
 10613                                    WS-COMMISSION
 10614              MOVE AM-J-COMA (SUB1)
 10615                                 TO CTBL-TABLE
 10616              PERFORM 8300-READ-CTBL-TABLE
 10617                                 THRU 8300-EXIT
 10618              IF CTBL-TABLE-FOUND
 10619                 IF (AM-COM-TYP (SUB1) = 'A')
 10620                    AND (WS-LF-PMF-COMM = ZEROS)
 10621                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10622                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10623                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10624                 END-IF
 10625                 CONTINUE
 10626              ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 193
* EL050.cbl
 10627                 IF FIRST-TIME-THROUGH
 10628                    GO TO 0563-CHECK-LF
 10629                 ELSE
 10630                    MOVE ER-2609 TO WS-ERROR
 10631                    PERFORM 9900-ERROR-FORMAT
 10632                                 THRU 9900-EXIT
 10633*                   GO TO 0560-EDIT-CONTINUE
 10634                 END-IF
 10635              END-IF
 10636           END-IF
 10637        ELSE
 10638           IF AM-L-COM (SUB1) NUMERIC
 10639              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10640              IF (AM-COM-TYP (SUB1) = 'A')
 10641                 AND (WS-LF-PMF-COMM = ZEROS)
 10642                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10643              END-IF
 10644              CONTINUE
 10645           ELSE
 10646              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10647              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10648              MOVE PB-LIFE-OVERRIDE-L1
 10649                                 TO CTBL-BEN-TYPE
 10650              MOVE ZEROS         TO WS-SUB1
 10651                                    WS-COMMISSION
 10652              MOVE AM-L-COMA (SUB1)
 10653                                 TO CTBL-TABLE
 10654              PERFORM 8300-READ-CTBL-TABLE
 10655                                 THRU 8300-EXIT
 10656              IF CTBL-TABLE-FOUND
 10657                 CONTINUE
 10658              ELSE
 10659                 IF FIRST-TIME-THROUGH
 10660                    GO TO 0563-CHECK-LF
 10661                 ELSE
 10662                    MOVE ER-2609 TO WS-ERROR
 10663                    PERFORM 9900-ERROR-FORMAT
 10664                                 THRU 9900-EXIT
 10665                 END-IF
 10666              END-IF
 10667           END-IF
 10668        END-IF
 10669     END-IF
 10670     .
 10671 0563-EXIT.
 10672     EXIT.
 10673 0564-EDIT-CONTINUE.
 10674
 10675     IF  PB-COMPANY-ID EQUAL 'DMD'
 10676         IF PB-I-NUM-BILLED EQUAL ZEROS
 10677            MOVE ER-8148       TO WS-ERROR
 10678            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10679
 10680*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10681*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10682*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10683*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10684*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 194
* EL050.cbl
 10685*         IF NO-CONVERSION-ERROR
 10686*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10687*         ELSE
 10688*             IF PB-COMPANY-ID EQUAL 'HAN'
 10689*                 MOVE ZEROS     TO PB-I-AGE.
 10690     IF PB-I-BIRTHDAY > LOW-VALUES
 10691        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10692        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10693        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10694        PERFORM 8500-DATE-CONVERT
 10695                                 THRU 8500-EXIT
 10696        IF NO-CONVERSION-ERROR
 10697           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10698           IF PB-I-AGE > ZEROS
 10699              IF WS-WORK-AGE NOT = PB-I-AGE
 10700                 MOVE ER-9501    TO WS-ERROR
 10701                 PERFORM 9900-ERROR-FORMAT
 10702                                 THRU 9900-EXIT
 10703              END-IF
 10704           ELSE
 10705              MOVE WS-WORK-AGE   TO PB-I-AGE
 10706           END-IF
 10707        END-IF
 10708     END-IF
 10709     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10710                                   WS-INS-AGE-SET
 10711     IF PB-I-AGE = ZEROS
 10712        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10713           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10714                                   WS-INS-AGE-SET
 10715           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10716
 10717     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10718                                   WS-AH-EDIT-AGE.
 10719
 10720     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10721        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10722        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10723        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10724        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10725        IF NO-CONVERSION-ERROR
 10726           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10727           IF PB-I-JOINT-AGE > 0
 10728              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10729                 MOVE ER-9503    TO WS-ERROR
 10730                 PERFORM 9900-ERROR-FORMAT
 10731                                 THRU 9900-EXIT
 10732              END-IF
 10733           ELSE
 10734              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10735           END-IF
 10736        ELSE
 10737           MOVE ZEROS            TO PB-I-JOINT-AGE
 10738        END-IF
 10739     END-IF
 10740     IF PB-I-JOINT-AGE NOT NUMERIC
 10741        MOVE ZERO               TO PB-I-JOINT-AGE.
 10742
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 195
* EL050.cbl
 10743     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10744                                   WS-JNT-AGE-SET
 10745     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10746        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10747           (WS-AH-JOINT-INDICATOR = 'J')
 10748           IF PB-I-JOINT-AGE = ZEROS
 10749               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10750                                          WS-JNT-AGE-SET
 10751               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10752           END-IF
 10753        END-IF
 10754     END-IF
 10755
 10756     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10757     IF WS-LF-JOINT-INDICATOR = 'J'
 10758        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10759        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10760            IF  PB-I-JOINT-AGE = ZERO
 10761                MOVE ER-2686       TO WS-ERROR
 10762                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10763            ELSE
 10764                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10765                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10766                    IF PB-COMPANY-ID NOT = 'LBL'
 10767                        MOVE ER-2685    TO WS-ERROR
 10768                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10769
 10770     IF WS-AH-JOINT-INDICATOR = 'J'
 10771        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10772            IF  PB-I-JOINT-AGE = ZERO
 10773                MOVE ER-2686       TO WS-ERROR
 10774                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10775            ELSE
 10776                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10777                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10778                                           WS-EDIT-AGE
 10779                    IF PB-COMPANY-ID NOT = 'LBL'
 10780                        MOVE ER-2685    TO WS-ERROR
 10781                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10782
 10783******************************************************************
 10784*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10785******************************************************************
 10786
 10787     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10788        (WS-AH-SPECIAL-CALC-CD = 'O')
 10789        NEXT SENTENCE
 10790     ELSE
 10791        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10792          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10793           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10794            WS-AH-JOINT-INDICATOR = 'J')  AND
 10795           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10796            MOVE ER-2627             TO WS-ERROR
 10797            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10798
 10799     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10800        (WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 196
* EL050.cbl
 10801         NEXT SENTENCE
 10802     ELSE
 10803         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10804            WS-AH-JOINT-INDICATOR = 'J'
 10805             IF PB-I-JOINT-INSURED = SPACES
 10806                 IF PB-COMPANY-ID NOT = 'JAL'
 10807                     MOVE ER-2696    TO WS-ERROR
 10808                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10809
 10810     IF PB-COMPANY-ID NOT = 'BOA'
 10811        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10812           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10813           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10814               PB-I-JOINT-INSURED NOT = SPACES)
 10815                MOVE ER-2691         TO WS-ERROR
 10816                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10817
 10818     IF PB-COMPANY-ID = 'BOA'
 10819        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10820           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10821            IF PB-I-JOINT-AGE NOT = ZEROS
 10822                MOVE ER-2691         TO WS-ERROR
 10823                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10824
 10825     IF PB-COMPANY-ID = 'CRI'
 10826        IF PB-I-SIG-SW = 'J'
 10827           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10828              WS-AH-JOINT-INDICATOR NOT = 'J'
 10829              MOVE ER-2675       TO WS-ERROR
 10830              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10831
 10832     IF PB-COMPANY-ID = 'CRI'
 10833        IF PB-I-SIG-SW = 'S'
 10834           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10835              WS-AH-JOINT-INDICATOR = 'J'
 10836              MOVE ER-2676       TO WS-ERROR
 10837              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10838
 10839     IF PB-COMPANY-ID = 'CVL'
 10840         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10841            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10842              MOVE ER-2783           TO WS-ERROR
 10843              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10844     IF (WS-LF-JOINT-INDICATOR = 'J')
 10845        AND (WS-AH-JOINT-INDICATOR = 'J')
 10846        AND (PB-I-LF-TERM > 120)
 10847        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10848        MOVE ER-2783             TO WS-ERROR
 10849        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10850     END-IF
 10851     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10852
 10853     IF PB-I-INDV-GRP-OVRD = 'I'
 10854        MOVE ER-2666             TO WS-ERROR
 10855        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10856        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10857
 10858     IF PB-I-INDV-GRP-OVRD = 'G'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 197
* EL050.cbl
 10859        MOVE ER-2666             TO WS-ERROR
 10860        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10861        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10862
 10863     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10864        NEXT SENTENCE
 10865     ELSE
 10866        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10867
 10868     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10869        IF WS-ERROR = ER-2666
 10870           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10871           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10872
 10873     IF PB-COMPANY-ID = 'CID'
 10874        IF PB-STATE = 'UT' OR 'MO'
 10875           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10876                 OR '76' OR '77')
 10877                      OR
 10878               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10879                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10880                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10881                   OR '2K' OR '2L'))
 10882              AND PB-I-INDV-GRP-CD = 'I'
 10883              MOVE ER-2721             TO WS-ERROR
 10884              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10885           END-IF
 10886        END-IF
 10887     END-IF
 10888
 10889     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10890     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10891        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10892     ELSE
 10893        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10894     END-IF
 10895
 10896*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10897*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10898     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10899                                    ACCOUNT-AH-CK-SW.
 10900
 10901     IF PB-REISSUED-CERT       OR
 10902        PB-REIN-ONLY-CERT      OR
 10903        PB-POLICY-IS-DECLINED  OR
 10904        PB-POLICY-IS-VOIDED
 10905*       OR PB-MONTHLY-CERT
 10906         GO TO 3000-CONTINUE-EDIT.
 10907
 10908     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10909        IF WS-EDIT-AGE           > +65
 10910           MOVE ER-2709          TO WS-ERROR
 10911           PERFORM 9900-ERROR-FORMAT
 10912                                 THRU 9900-EXIT
 10913        ELSE
 10914           IF WS-EDIT-AGE        > +55
 10915              MOVE ER-2718       TO WS-ERROR
 10916              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 198
* EL050.cbl
 10917                                 THRU 9900-EXIT
 10918           END-IF
 10919        END-IF
 10920     IF PB-COMPANY-ID = 'DCC'
 10921        IF WS-EDIT-AGE           > +65
 10922           MOVE ER-2709          TO WS-ERROR
 10923           PERFORM 9900-ERROR-FORMAT
 10924                                 THRU 9900-EXIT
 10925        END-IF
 10926     END-IF
 10927     .
 10928
 10929 0565-LIFE-PLAN-LIMIT-EDITS.
 10930
 10931     IF NOT LF-PLAN-MASTER-FOUND
 10932        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10933                                    EC-AM-LF-MAX-TOT-BEN
 10934        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10935
 10936     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10937
 10938     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10939         IF PL-LM-AGE (1) = ZEROS
 10940             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10941
 10942     IF NO-LF-BENEFIT-MATCH          OR
 10943        WS-LF-BENEFIT-CD = ZEROS     OR
 10944        WS-LF-SPECIAL-CALC-CD = 'M'
 10945        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10946
 10947     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10948     MOVE +1                     TO SUB2.
 10949
 10950     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10951        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10952           MOVE +5   TO SUB2
 10953           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10954              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10955              (PL-LM-AGE (SUB2) EQUAL +0)
 10956              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10957              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10958
 10959     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10960
 10961     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10962                               + PB-I-LF-ALT-BENEFIT-AMT.
 10963
 10964 0568-CHECK-LIFE-ATT-AGE.
 10965
 10966     IF PL-ATT-AGE NUMERIC AND
 10967        PL-ATT-AGE > +0
 10968        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10969     END-IF
 10970*    IF PL-ATT-AGE NUMERIC AND
 10971*       PL-ATT-AGE > +0
 10972*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10973*       IF PB-I-BIRTHDAY > LOW-VALUES
 10974*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 199
* EL050.cbl
 10975*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10976*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10977*          SET BIN-PLUS-ELAPSED  TO TRUE
 10978*          PERFORM 8500-DATE-CONVERT
 10979*                                THRU 8500-EXIT
 10980*          IF NO-CONVERSION-ERROR
 10981*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10982*             MOVE ER-2669       TO WS-ERROR
 10983*             PERFORM 9900-ERROR-FORMAT
 10984*                                THRU 9900-EXIT
 10985*          END-IF
 10986*       ELSE
 10987*          IF WS-ATT-AGE >= PL-ATT-AGE
 10988*             MOVE ER-2669       TO WS-ERROR
 10989*             PERFORM 9900-ERROR-FORMAT
 10990*                                THRU 9900-EXIT
 10991*          END-IF
 10992*       END-IF
 10993*    END-IF
 10994     .
 10995 0570-CHECK-LIFE-LIMITS.
 10996
 10997     IF PB-COMPANY-ID EQUAL 'CRI'
 10998        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 10999           IF SUB2 GREATER THAN +4
 11000              MOVE ER-2637 TO WS-ERROR
 11001              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11002              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11003
 11004     IF PB-COMPANY-ID  =  'NCL'
 11005        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11006            SUB2 GREATER THAN +8
 11007             MOVE 'U'         TO PB-BATCH-ENTRY
 11008             MOVE ER-2637     TO WS-ERROR
 11009             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11010             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11011
 11012     IF SUB2 > +8
 11013        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11014           AND (PB-I-SIG-SW = 'Y')
 11015           CONTINUE
 11016        ELSE
 11017           MOVE ER-2637          TO WS-ERROR
 11018           PERFORM 9900-ERROR-FORMAT
 11019                                 THRU 9900-EXIT
 11020        END-IF
 11021        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11022     END-IF
 11023     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11024     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11025     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11026
 11027     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11028        ADD +1  TO SUB2
 11029        GO TO 0570-CHECK-LIFE-LIMITS.
 11030
 11031     IF PB-COMPANY-ID = 'NCL'
 11032         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 200
* EL050.cbl
 11033
 11034     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11035        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11036        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11037           AND (PB-I-SIG-SW = 'Y')
 11038           CONTINUE
 11039        ELSE
 11040           MOVE ER-2637          TO WS-ERROR
 11041           PERFORM 9900-ERROR-FORMAT
 11042                                 THRU 9900-EXIT
 11043        END-IF
 11044     END-IF
 11045     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11046
 11047
 11048 0570-CHECK-NCL-LIFE-LIMITS.
 11049
 11050     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11051        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11052         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11053
 11054     IF APP-CERT-USED
 11055         IF SUB2  LESS THAN  +5
 11056             MOVE +5          TO SUB2
 11057             GO TO 0570-CHECK-LIFE-LIMITS.
 11058
 11059     MOVE ER-2637             TO WS-ERROR.
 11060     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11061
 11062     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11063
 11064 0575-CHECK-NCL-SIG-SWITCH.
 11065
 11066     IF NOT APP-CERT-USED
 11067         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11068
 11069     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11070        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11071        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11072        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11073         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11074
 11075     IF SUB2 GREATER THAN +4
 11076         IF PL-LM-AGE (5) = ZEROS  AND
 11077            PL-LM-AGE (6) = ZEROS  AND
 11078            PL-LM-AGE (7) = ZEROS  AND
 11079            PL-LM-AGE (8) = ZEROS
 11080             MOVE  ER-1927        TO WS-ERROR
 11081             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11082             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11083         ELSE
 11084             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11085                 MOVE  ER-1920    TO WS-ERROR
 11086                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11087
 11088     IF PB-I-SIG-SW  = 'Y'
 11089       IF NOT PB-I-POLICY-ACCEPTED  AND
 11090          NOT PB-I-POLICY-DECLINED
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 201
* EL050.cbl
 11091           MOVE 'U'               TO PB-BATCH-ENTRY
 11092           MOVE  ER-1926          TO WS-ERROR
 11093           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11094
 11095
 11096 0580-AH-PLAN-LIMIT-EDITS.
 11097
 11098     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11099        IF PB-I-AH-BENEFIT-AMT > +1250
 11100           MOVE ER-2702          TO WS-ERROR
 11101           PERFORM 9900-ERROR-FORMAT
 11102                                 THRU 9900-EXIT
 11103        END-IF
 11104     END-IF
 11105
 11106     IF (PB-COMPANY-ID = 'DCC')
 11107        AND (PB-MONTHLY-CERT)
 11108        IF PB-I-AH-BENEFIT-AMT > +3000
 11109           MOVE ER-2881          TO WS-ERROR
 11110           PERFORM 9900-ERROR-FORMAT
 11111                                 THRU 9900-EXIT
 11112        END-IF
 11113     END-IF
 11114     IF NOT AH-PLAN-MASTER-FOUND
 11115        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11116        GO TO 3000-CONTINUE-EDIT.
 11117
 11118     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11119
 11120     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11121         IF PL-LM-AGE (1) = ZEROS
 11122             GO TO 3000-CONTINUE-EDIT.
 11123
 11124     IF NO-AH-BENEFIT-MATCH          OR
 11125        WS-AH-BENEFIT-CD = ZEROS     OR
 11126        WS-AH-SPECIAL-CALC-CD = 'M'
 11127        GO TO 3000-CONTINUE-EDIT.
 11128
 11129     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11130     MOVE +1                     TO SUB2.
 11131
 11132     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11133        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11134           MOVE +5 TO SUB2
 11135           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11136              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11137              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11138              (PL-LM-AGE (SUB2) EQUAL +0)
 11139              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11140              GO TO 3000-CONTINUE-EDIT.
 11141
 11142     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11143
 11144 0590-CHECK-AH-ATT-AGE.
 11145
 11146     IF PL-ATT-AGE NUMERIC AND
 11147        PL-ATT-AGE GREATER THAN +0
 11148        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 202
* EL050.cbl
 11149     END-IF
 11150*       IF WS-ATT-AGE >= PL-ATT-AGE
 11151*          MOVE ER-3054          TO WS-ERROR
 11152*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11153     .
 11154 0597-CHECK-AH-LIMITS.
 11155
 11156     IF PB-COMPANY-ID EQUAL 'CRI'
 11157        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11158           IF SUB2 GREATER THAN +4
 11159              MOVE ER-2638       TO WS-ERROR
 11160              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11161              GO TO 3000-CONTINUE-EDIT.
 11162
 11163     IF PB-COMPANY-ID  =  'NCL'
 11164        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11165            SUB2 GREATER THAN +8
 11166             MOVE 'U'            TO PB-BATCH-ENTRY
 11167             MOVE ER-2638        TO WS-ERROR
 11168             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11169             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11170
 11171     IF SUB2 > +8
 11172        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11173           AND (PB-I-SIG-SW = 'Y')
 11174           CONTINUE
 11175        ELSE
 11176           MOVE ER-2638          TO WS-ERROR
 11177           PERFORM 9900-ERROR-FORMAT
 11178                                 THRU 9900-EXIT
 11179        END-IF
 11180        GO TO 3000-CONTINUE-EDIT
 11181     END-IF
 11182
 11183     IF PB-COMPANY-ID = 'CRI'
 11184        IF WS-ERROR = ER-2638
 11185           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11186
 11187     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11188     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11189     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11190     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11191
 11192     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11193        ADD +1                   TO SUB2
 11194        GO TO 0597-CHECK-AH-LIMITS.
 11195
 11196     IF PB-COMPANY-ID = 'NCL'
 11197         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11198
 11199     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11200        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11201        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11202                                 > PL-LM-AMT (SUB2))
 11203        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11204           AND (PB-I-SIG-SW = 'Y')
 11205           CONTINUE
 11206        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 203
* EL050.cbl
 11207           MOVE ER-2638          TO WS-ERROR
 11208           PERFORM 9900-ERROR-FORMAT
 11209                                 THRU 9900-EXIT
 11210        END-IF
 11211     END-IF
 11212
 11213     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11214         IF  WS-ERROR    EQUAL    ER-2638
 11215             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11216                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11217                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11218                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11219                MOVE  ER-1910    TO  WS-ERROR
 11220                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11221
 11222     IF PB-COMPANY-ID = 'CRI'
 11223        IF WS-ERROR = ER-2638
 11224            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11225            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11226            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11227
 11228     GO TO 3000-CONTINUE-EDIT.
 11229
 11230 0597-CHECK-NCL-AH-LIMITS.
 11231
 11232     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11233        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11234        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11235                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11236         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11237
 11238     IF APP-CERT-USED
 11239         IF SUB2  LESS THAN  +5
 11240             MOVE +5             TO SUB2
 11241             GO TO 0597-CHECK-AH-LIMITS.
 11242
 11243     MOVE ER-2638                TO WS-ERROR.
 11244     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11245
 11246     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11247
 11248 0599-CHECK-NCL-SIG-SWITCH.
 11249
 11250     IF NOT APP-CERT-USED
 11251         GO TO 3000-CONTINUE-EDIT.
 11252
 11253     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11254        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11255        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11256        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11257         GO TO 3000-CONTINUE-EDIT.
 11258
 11259     IF SUB2 GREATER THAN +4
 11260         IF PL-LM-AGE (5) = ZEROS  AND
 11261            PL-LM-AGE (6) = ZEROS  AND
 11262            PL-LM-AGE (7) = ZEROS  AND
 11263            PL-LM-AGE (8) = ZEROS
 11264             MOVE  ER-1927        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 204
* EL050.cbl
 11265             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11266             GO TO 3000-CONTINUE-EDIT
 11267         ELSE
 11268             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11269                 MOVE  ER-1920    TO WS-ERROR
 11270                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11271
 11272     IF PB-I-SIG-SW  = 'Y'
 11273       IF NOT PB-I-POLICY-ACCEPTED  AND
 11274          NOT PB-I-POLICY-DECLINED
 11275           MOVE 'U'               TO PB-BATCH-ENTRY
 11276           MOVE  ER-1926          TO WS-ERROR
 11277           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11278
 11279******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 205
* EL050.cbl
 11281
 11282 3000-CONTINUE-EDIT.
 11283
 11284     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11285     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11286     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11287     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11288     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11289
 11290     IF BROWSE-STARTED
 11291        PERFORM 9990-RETURN THRU 9990-EXIT
 11292        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11293
 11294     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11295        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11296        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11297        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11298*       MOVE 1                   TO DC-OPTION-CODE
 11299        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11300        IF DATE-CONVERSION-ERROR
 11301           MOVE ER-2622          TO WS-ERROR
 11302           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11303        ELSE
 11304           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11305              MOVE ER-2623       TO WS-ERROR
 11306              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11307           ELSE
 11308              MOVE ER-2622       TO WS-ERROR
 11309              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11310
 11311     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11312     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11313     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11314*    MOVE 1                      TO DC-OPTION-CODE.
 11315     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11316     IF DATE-CONVERSION-ERROR
 11317        GO TO 3005-EDIT-CONTINUE
 11318     ELSE
 11319        IF DC-ELAPSED-DAYS GREATER +180
 11320           MOVE ER-2613          TO WS-ERROR
 11321           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11322        ELSE
 11323           IF DC-ELAPSED-DAYS GREATER +90
 11324              MOVE ER-2612       TO WS-ERROR
 11325              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11326           ELSE
 11327             IF DC-ELAPSED-DAYS GREATER +60
 11328                MOVE ER-2614     TO WS-ERROR
 11329                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11330
 11331 3005-EDIT-CONTINUE.
 11332
 11333     IF PB-CANCELLATION
 11334         GO TO 3700-EDIT-CANCEL.
 11335
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 206
* EL050.cbl
 11337******************************************************************
 11338*                  E D I T   I S S U E                           *
 11339******************************************************************
 11340
 11341 3020-EDIT-ISSUE.
 11342
 11343      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11344      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11345      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11346      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11347      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11348
 11349     IF PB-ISSUE-FORCE
 11350        OR PB-ISSUE-DATE-FORCED
 11351        OR PB-FORCE-OFF
 11352        OR PB-OVERCHARGE-FORCE
 11353        CONTINUE
 11354     ELSE
 11355        MOVE ER-2670             TO WS-ERROR
 11356        PERFORM 9900-ERROR-FORMAT
 11357                                 THRU 9900-EXIT
 11358     END-IF
 11359     .
 11360 3022-SET-POLICY-STATUS.
 11361
 11362     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11363
 11364     IF (PB-REISSUED-CERT)
 11365             OR
 11366        ((PB-COMPANY-ID NOT = 'DCC')
 11367         AND (PB-MONTHLY-CERT))
 11368         MOVE '5'                TO PB-I-ENTRY-STATUS
 11369         MOVE 'E'                TO PB-BATCH-ENTRY
 11370     END-IF
 11371
 11372     IF PB-COMPANY-ID = 'DCC'
 11373        IF PB-MONTHLY-CERT
 11374           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11375        END-IF
 11376        IF PB-CASH-CERT
 11377           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11378        END-IF
 11379     END-IF
 11380     IF PB-POLICY-IS-DECLINED
 11381         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11382     IF PB-POLICY-IS-VOIDED
 11383         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11384     IF PB-NEEDS-UNDERWRITING
 11385         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11386     IF PB-REIN-ONLY-CERT
 11387         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11388     IF PB-PREM-ACCTNG-ONLY
 11389         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11390
 11391     MOVE SPACE                  TO PB-I-OB-FLAG.
 11392
 11393     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11394         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 207
* EL050.cbl
 11395         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11396         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11397
 11398     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11399        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11400           MOVE 'Z'             TO PB-I-OB-FLAG.
 11401
 11402     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11403        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11404           MOVE 'Z'             TO PB-I-OB-FLAG.
 11405
 11406     IF ACCOUNT-MAST-FOUND
 11407         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11408         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11409         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11410         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11411         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11412         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11413         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11414     END-IF
 11415
 11416     IF ACCOUNT-MAST-FOUND
 11417        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11418         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11419
 11420     IF (ACCOUNT-MAST-FOUND)
 11421        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11422        IF PB-REISSUED-CERT
 11423           CONTINUE
 11424        ELSE
 11425           MOVE ER-2608          TO WS-ERROR
 11426           PERFORM 9900-ERROR-FORMAT
 11427                                 THRU 9900-EXIT
 11428         END-IF
 11429     END-IF
 11430
 11431     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11432        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11433        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11434
 11435**********   DMD CUSTOM CODE FOLLOWS  **********
 11436 3024-EDIT-DMD-FIELDS.
 11437     IF PB-COMPANY-ID NOT = 'DMD'
 11438        GO TO 3025-EDIT-REINSURANCE.
 11439
 11440*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11441*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11442*** ERROR IF THEY ARE NOT EQUAL.
 11443
 11444     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11445     SET BIN-TO-GREG               TO TRUE.
 11446     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11447     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11448**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11449
 11450     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11451     SET BIN-TO-GREG               TO TRUE.
 11452     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 208
* EL050.cbl
 11453     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11454**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11455
 11456     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11457        MOVE ER-8116               TO WS-ERROR
 11458        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11459
 11460     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11461
 11462     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11463                                      WK-FULL-CERT-NO.
 11464     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11465
 11466     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11467
 11468     IF PB-VALID-LIFE
 11469        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11470     ELSE
 11471        IF PB-VALID-AH
 11472          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11473
 11474
 11475     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11476     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11477     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11478                                      DCUA-UNDRWRTR-CODE
 11479                                      DCUA-UNDRWRTR-GROUP-CODE
 11480                                      DCUA-RETURN-CODE.
 11481
 11482****************************************************************
 11483*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11484***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11485***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11486***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11487***   TO THIS RECORD.                                        ***
 11488****************************************************************
 11489     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11490     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11491     IF DCUA-SUCCESSFUL-PROCESS
 11492        GO TO 3024-EDIT-DL7-CONT.
 11493
 11494     IF DCUA-RETURN-CODE EQUAL '01'
 11495        MOVE ER-8110               TO WS-ERROR
 11496        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11497        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11498        GO TO 3024-EDIT-DL7-CONT.
 11499
 11500     IF DCUA-RETURN-CODE EQUAL '02'
 11501        MOVE ER-8111               TO WS-ERROR
 11502        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11504        GO TO 3024-EDIT-DL7-CONT.
 11505
 11506     IF DCUA-RETURN-CODE EQUAL '03'
 11507        MOVE ER-8074               TO WS-ERROR
 11508        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11509        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11510        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 209
* EL050.cbl
 11511
 11512     IF DCUA-RETURN-CODE EQUAL '04'
 11513        MOVE ER-8075               TO WS-ERROR
 11514        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11515        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11516        GO TO 3024-EDIT-DL7-CONT.
 11517
 11518     IF DCUA-RETURN-CODE EQUAL '05'
 11519        MOVE ER-8076               TO WS-ERROR
 11520        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11521        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11522        GO TO 3024-EDIT-DL7-CONT.
 11523
 11524     IF DCUA-RETURN-CODE EQUAL '06'
 11525        MOVE ER-8077               TO WS-ERROR
 11526        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11527        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11528        GO TO 3024-EDIT-DL7-CONT.
 11529
 11530     IF DCUA-RETURN-CODE EQUAL '07'
 11531        MOVE ER-8078               TO WS-ERROR
 11532        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11533        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11534        GO TO 3024-EDIT-DL7-CONT.
 11535
 11536     IF DCUA-RETURN-CODE EQUAL 'E1'
 11537        MOVE ER-8079               TO WS-ERROR
 11538        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11539        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11540        GO TO 3024-EDIT-DL7-CONT.
 11541
 11542     IF DCUA-RETURN-CODE EQUAL 'E2'
 11543        MOVE ER-8080               TO WS-ERROR
 11544        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11545        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11546        GO TO 3024-EDIT-DL7-CONT.
 11547
 11548     IF DCUA-RETURN-CODE EQUAL 'E3'
 11549        MOVE ER-8098               TO WS-ERROR
 11550        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11551        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11552        GO TO 3024-EDIT-DL7-CONT.
 11553
 11554     IF DCUA-RETURN-CODE EQUAL 'C1'
 11555        MOVE ER-8099               TO WS-ERROR
 11556        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11557        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11558        GO TO 3024-EDIT-DL7-CONT.
 11559
 11560     IF DCUA-RETURN-CODE EQUAL 'U1'
 11561        MOVE ER-8109               TO WS-ERROR
 11562        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11563        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11564        GO TO 3024-EDIT-DL7-CONT.
 11565
 11566     IF DCUA-RETURN-CODE EQUAL 'N1'
 11567        MOVE ER-8112               TO WS-ERROR
 11568        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 210
* EL050.cbl
 11569        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11570        GO TO 3024-EDIT-DL7-CONT.
 11571
 11572     IF DCUA-RETURN-CODE EQUAL 'N2'
 11573        MOVE ER-8113               TO WS-ERROR
 11574        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11575        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11576        GO TO 3024-EDIT-DL7-CONT.
 11577
 11578     IF DCUA-RETURN-CODE EQUAL 'N3'
 11579        MOVE ER-8114               TO WS-ERROR
 11580        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11581        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11582        GO TO 3024-EDIT-DL7-CONT.
 11583
 11584     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11585     MOVE ER-8097                  TO WS-ERROR.
 11586     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11587     GO TO 3024-EDIT-DL7-CONT.
 11588
 11589 3024-EDIT-DL7-CONT.
 11590
 11591     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11592     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11593     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11594        NEXT SENTENCE
 11595     ELSE
 11596        MOVE ER-9263               TO WS-ERROR
 11597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11598
 11599******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11600******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11601     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11602        NEXT SENTENCE
 11603     ELSE
 11604        MOVE ER-8039               TO WS-ERROR
 11605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11606
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 211
* EL050.cbl
 11608****************************************************************
 11609*** VALIDATE STATE  : DLO022                                 ***
 11610****************************************************************
 11611     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11612     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11613
 11614     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11615     IF DVSC-SUCCESSFUL-EDIT
 11616        GO TO 3024-EDIT-DL22-CONT.
 11617
 11618     IF DVSC-RETURN-CODE EQUAL '01'
 11619        MOVE ER-8300               TO WS-ERROR
 11620        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11621        GO TO 3024-EDIT-DL22-CONT.
 11622
 11623     IF DVSC-RETURN-CODE EQUAL '02'
 11624        MOVE ER-8301               TO WS-ERROR
 11625        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11626        GO TO 3024-EDIT-DL22-CONT.
 11627
 11628     IF DVSC-RETURN-CODE EQUAL '03'
 11629        MOVE ER-8302               TO WS-ERROR
 11630        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11631        GO TO 3024-EDIT-DL22-CONT.
 11632
 11633     IF DVSC-RETURN-CODE EQUAL 'N1'
 11634        MOVE ER-8304               TO WS-ERROR
 11635        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11636        GO TO 3024-EDIT-DL22-CONT.
 11637
 11638     MOVE ER-8303                  TO WS-ERROR
 11639     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11640
 11641 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 212
* EL050.cbl
 11643****************************************************************
 11644*** VALIDATE LOAN OFFICER : DLO021                           ***
 11645****************************************************************
 11646
 11647     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11648     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11649     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11650     IF DVLO-SUCCESSFUL-EDIT
 11651        GO TO 3024-EDIT-DL21-CONT.
 11652
 11653     IF DVLO-RETURN-CODE EQUAL '01'
 11654        MOVE ER-8081               TO WS-ERROR
 11655        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11656        GO TO 3024-EDIT-DL21-CONT.
 11657
 11658     IF DVLO-RETURN-CODE EQUAL '02'
 11659        MOVE ER-8082               TO WS-ERROR
 11660        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11661        GO TO 3024-EDIT-DL21-CONT.
 11662
 11663     IF DVLO-RETURN-CODE EQUAL '03'
 11664        MOVE ER-8083               TO WS-ERROR
 11665        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11666        GO TO 3024-EDIT-DL21-CONT.
 11667
 11668     IF DVLO-RETURN-CODE EQUAL '04'
 11669        MOVE ER-8084               TO WS-ERROR
 11670        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11671        GO TO 3024-EDIT-DL21-CONT.
 11672
 11673     IF DVLO-RETURN-CODE EQUAL '05'
 11674        MOVE ER-8085               TO WS-ERROR
 11675        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11676        GO TO 3024-EDIT-DL21-CONT.
 11677
 11678     MOVE ER-7825                  TO WS-ERROR
 11679     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11680     GO TO 3024-EDIT-DL21-CONT.
 11681
 11682 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 213
* EL050.cbl
 11684
 11685****************************************************************
 11686*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11687****************************************************************
 11688
 11689     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11690     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11691     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11692     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11693     IF DIPF-SUCCESSFUL-EDIT
 11694        GO TO 3024-EDIT-DL02-CONT.
 11695
 11696     IF DIPF-RETURN-CODE EQUAL '01'
 11697        MOVE ER-8086               TO WS-ERROR
 11698        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11699        GO TO 3024-EDIT-DL02-CONT.
 11700
 11701     IF DIPF-RETURN-CODE EQUAL '02'
 11702        MOVE ER-8087               TO WS-ERROR
 11703        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11704        GO TO 3024-EDIT-DL02-CONT.
 11705
 11706     IF DIPF-RETURN-CODE EQUAL '03'
 11707        MOVE ER-8088               TO WS-ERROR
 11708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11709        GO TO 3024-EDIT-DL02-CONT.
 11710
 11711     MOVE ER-8095                  TO WS-ERROR
 11712     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11713     GO TO 3024-EDIT-DL02-CONT.
 11714
 11715 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 214
* EL050.cbl
 11717
 11718****************************************************************
 11719*** VALIDATE BANK ID : DLO003                                ***
 11720****************************************************************
 11721
 11722     MOVE WK-GREG-CENT           TO WCG-CENT.
 11723     MOVE WK-GREG-YYMM           TO WCG-REST.
 11724     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11725        MOVE ER-8040               TO WS-ERROR
 11726        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11727
 11728     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11729     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11730     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11731     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11732     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11733     IF DVBI-SUCCESSFUL-EDIT
 11734        GO TO 3024-EDIT-DL03-CONT.
 11735
 11736     IF DVBI-RETURN-CODE EQUAL '01'
 11737        MOVE ER-8089               TO WS-ERROR
 11738        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11739        GO TO 3024-EDIT-DL03-CONT.
 11740
 11741     IF DVBI-RETURN-CODE EQUAL '02'
 11742        MOVE ER-8090               TO WS-ERROR
 11743        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11744        GO TO 3024-EDIT-DL03-CONT.
 11745
 11746     IF DVBI-RETURN-CODE EQUAL '03'
 11747        MOVE ER-8091               TO WS-ERROR
 11748        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11749        GO TO 3024-EDIT-DL03-CONT.
 11750
 11751     IF DVBI-RETURN-CODE EQUAL '04'
 11752        MOVE ER-8092               TO WS-ERROR
 11753        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11754        GO TO 3024-EDIT-DL03-CONT.
 11755
 11756     IF DVBI-RETURN-CODE EQUAL '05'
 11757        MOVE ER-8093               TO WS-ERROR
 11758        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11759        GO TO 3024-EDIT-DL03-CONT.
 11760
 11761     IF DVBI-RETURN-CODE EQUAL '06'
 11762        MOVE ER-8094               TO WS-ERROR
 11763        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11764        GO TO 3024-EDIT-DL03-CONT.
 11765
 11766     MOVE ER-8096                  TO WS-ERROR
 11767     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11768     GO TO 3024-EDIT-DL03-CONT.
 11769
 11770 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 215
* EL050.cbl
 11772
 11773     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11774        NEXT SENTENCE
 11775     ELSE
 11776        MOVE ER-8042               TO WS-ERROR
 11777        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11778
 11779     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11780     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11781     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11782
 11783     IF DMPF-RETURN-CODE = '01'
 11784        MOVE ER-8067               TO WS-ERROR
 11785        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11786        GO TO 3024-EDIT-DL01-CONT.
 11787
 11788     IF DMPF-RETURN-CODE = '02'
 11789        MOVE ER-8068               TO WS-ERROR
 11790        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11791        GO TO 3024-EDIT-DL01-CONT.
 11792
 11793     IF DMPF-RETURN-CODE = '03'
 11794        MOVE ER-8069               TO WS-ERROR
 11795        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11796        GO TO 3024-EDIT-DL01-CONT.
 11797
 11798     IF DMPF-RETURN-CODE = 'E1'
 11799        MOVE ER-8070               TO WS-ERROR
 11800        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11801        GO TO 3024-EDIT-DL01-CONT.
 11802
 11803     IF DMPF-RETURN-CODE = 'N1'
 11804        MOVE ER-8071               TO WS-ERROR
 11805        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11806        GO TO 3024-EDIT-DL01-CONT.
 11807
 11808     IF DMPF-RETURN-CODE NOT = 'OK'
 11809        MOVE ER-8072               TO WS-ERROR
 11810        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11811
 11812 3024-EDIT-DL01-CONT.
 11813******************************************************************
 11814***  VALIDATES RATE CODES : DLO017                             ***
 11815******************************************************************
 11816
 11817      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11818      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11819      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11820      IF DVRC-SUCCESSFUL-EDIT
 11821        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11822        GO TO 3024-CHECK-VALID-RATE.
 11823
 11824      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11825
 11826      IF DVRC-RETURN-CODE EQUAL '01'
 11827         MOVE ER-7817                   TO WS-ERROR
 11828         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11829         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 216
* EL050.cbl
 11830
 11831      IF DVRC-RETURN-CODE EQUAL '02'
 11832         MOVE ER-7818                   TO WS-ERROR
 11833         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11834         GO TO 3025-EDIT-REINSURANCE.
 11835
 11836      IF DVRC-RETURN-CODE EQUAL '03'
 11837         MOVE ER-7819                   TO WS-ERROR
 11838         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11839         GO TO 3025-EDIT-REINSURANCE.
 11840
 11841       MOVE ER-7820                     TO WS-ERROR.
 11842       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11843       GO TO 3025-EDIT-REINSURANCE.
 11844
 11845******************************************************************
 11846***  GET PREMIUM RATES : DLO011                                ***
 11847******************************************************************
 11848
 11849 3024-CHECK-VALID-RATE.
 11850
 11851     IF VALID-RATE-CODE
 11852        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11853        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11854        MOVE SPACES                TO DPRB-RETURN-CODE
 11855        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11856     ELSE
 11857         GO TO 3025-EDIT-REINSURANCE.
 11858
 11859      IF DPRB-SUCCESSFUL-PROCESS
 11860         IF PB-VALID-LIFE
 11861             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11862             GO TO 3025-EDIT-REINSURANCE
 11863         ELSE
 11864             IF PB-VALID-AH
 11865                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11866                 GO TO 3025-EDIT-REINSURANCE.
 11867
 11868      IF DPRB-RETURN-CODE EQUAL '01'
 11869         MOVE ER-7812                   TO WS-ERROR
 11870         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11871         GO TO 3025-EDIT-REINSURANCE.
 11872
 11873      IF DPRB-RETURN-CODE EQUAL '02'
 11874         MOVE ER-7813                   TO WS-ERROR
 11875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11876         GO TO 3025-EDIT-REINSURANCE.
 11877
 11878      IF DPRB-RETURN-CODE EQUAL '03'
 11879         MOVE ER-7814                   TO WS-ERROR
 11880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11881         GO TO 3025-EDIT-REINSURANCE.
 11882
 11883      IF DPRB-RETURN-CODE EQUAL '04'
 11884         IF NOT DPRB-1ST-TIME
 11885            MOVE ER-7815                   TO WS-ERROR
 11886            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11887            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 217
* EL050.cbl
 11888          ELSE
 11889         IF PB-VALID-LIFE
 11890            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11891          ELSE
 11892            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11893         END-IF
 11894         MOVE SPACES                TO DOCC-RETURN-CODE
 11895         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11896         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11897         IF DOCC-RETURN-CODE = 'OK'
 11898             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11899             GO TO 3024-CHECK-VALID-RATE
 11900           ELSE
 11901             MOVE ER-7823               TO WS-ERROR
 11902             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11903             GO TO 3025-EDIT-REINSURANCE.
 11904
 11905       MOVE ER-7816                     TO WS-ERROR.
 11906       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11907       GO TO 3025-EDIT-REINSURANCE.
 11908
 11909**********   DMD CUSTOM CODE ABOVE    **********
 11910
 11911 3025-EDIT-REINSURANCE.
 11912     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11913         GO TO 3027-EDIT-CONTINUE.
 11914
 11915     MOVE LOW-VALUES               TO ERREIN-KEY.
 11916     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11917     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11918                                      REIN-CODE-2
 11919                                      REIN-CODE-3.
 11920     MOVE 'A'                      TO REIN-TYPE.
 11921
 11922     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11923
 11924     MOVE '3026' TO REIN-SW.
 11925     MOVE ' '                   TO WS-REIN-READ-SW.
 11926
 11927     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11928     IF REIN-TABLE-NOT-FOUND
 11929         GO TO 3026-NO-SPEC-TABLE.
 11930
 11931     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11932     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11933                                   WS-NSP-ST-CD-LF.
 11934     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11935                                   WS-NSP-ST-CD-AH.
 11936
 11937     GO TO 3040-EDIT-CONTINUE.
 11938
 11939 3026-NO-SPEC-TABLE.
 11940
 11941     MOVE ER-2664                TO WS-ERROR.
 11942     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11943     GO TO 3040-EDIT-CONTINUE.
 11944
 11945 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 218
* EL050.cbl
 11946
 11947     IF PB-I-REIN-TABLE = SPACES
 11948       GO TO 3040-EDIT-CONTINUE.
 11949
 11950     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11951          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11952          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11953           GO TO 3040-EDIT-CONTINUE.
 11954
 11955     MOVE LOW-VALUES            TO ERREIN-KEY.
 11956     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11957     MOVE 'A'                   TO REIN-TYPE.
 11958     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11959
 11960     MOVE '3028'                TO REIN-SW.
 11961     MOVE ' '                   TO WS-REIN-READ-SW.
 11962
 11963     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11964     IF REIN-TABLE-NOT-FOUND
 11965         GO TO 3028-NO-REIN-TABLE.
 11966
 11967     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11968     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11969                                   WS-NSP-ST-CD-LF.
 11970     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11971                                   WS-NSP-ST-CD-AH.
 11972
 11973     GO TO 3040-EDIT-CONTINUE.
 11974
 11975 3028-NO-REIN-TABLE.
 11976
 11977     MOVE ER-2615                TO WS-ERROR.
 11978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11979     GO TO 3040-EDIT-CONTINUE.
 11980
 11981 3040-EDIT-CONTINUE.
 11982
 11983     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11984         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11985
 11986     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11987         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11988
 11989     IF (NOT PB-REISSUED-CERT)
 11990        AND (NOT PB-MONTHLY-CERT)
 11991        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 11992            MOVE '001'           TO PB-I-LF-TERM
 11993            MOVE 'M'             TO PB-I-INSURED-SEX.
 11994
 11995     IF (NOT PB-REISSUED-CERT)
 11996        AND (NOT PB-MONTHLY-CERT)
 11997        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 11998            MOVE '001'           TO PB-I-AH-TERM
 11999            MOVE 'M'             TO PB-I-INSURED-SEX.
 12000
 12001 3040-EDIT-1ST-PMT-DT.
 12002     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12003     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 219
* EL050.cbl
 12004         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12005
 12006******************************************************************
 12007*                                                                *
 12008*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12009*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12010*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12011*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12012*                                                                *
 12013******************************************************************
 12014
 12015     IF PB-EFF-DT-PROCESSING
 12016        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12017                                    PB-I-LF-EXPIRE-DT
 12018                                    PB-I-AH-EXPIRE-DT
 12019        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12020        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12021        MOVE ZERO                TO DC-ELAPSED-DAYS
 12022        MOVE +1                  TO DC-ELAPSED-MONTHS
 12023        SET BIN-PLUS-ELAPSED     TO TRUE
 12024*       MOVE 6                   TO DC-OPTION-CODE
 12025        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12026        IF NO-CONVERSION-ERROR
 12027           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12028
 12029******************************************************************
 12030*                                                                *
 12031*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12032*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12033*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12034*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12035*                                                                *
 12036******************************************************************
 12037
 12038     IF PB-EXT-DAYS-PROCESSING
 12039          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12040                                         PB-I-LF-EXPIRE-DT
 12041                                         PB-I-AH-EXPIRE-DT
 12042          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12043          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12044          MOVE +1                     TO DC-ELAPSED-MONTHS
 12045          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12046          SET BIN-PLUS-ELAPSED        TO TRUE
 12047*         MOVE 6                      TO DC-OPTION-CODE
 12048          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12049          IF NO-CONVERSION-ERROR
 12050             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12051
 12052******************************************************************
 12053*                                                                *
 12054*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12055*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12056*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12057*        (EXPIRE DATE - (TERM -1))  *  -1.
 12058*                                                                *
 12059******************************************************************
 12060
 12061     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 220
* EL050.cbl
 12062        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12063           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12064              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12065              MOVE PB-I-AH-TERM      TO WS-TERM
 12066           ELSE
 12067              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12068              MOVE PB-I-LF-TERM      TO WS-TERM
 12069        ELSE
 12070           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12071              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12072              MOVE PB-I-LF-TERM      TO WS-TERM
 12073           ELSE
 12074              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12075              MOVE PB-I-AH-TERM      TO WS-TERM.
 12076
 12077     IF PB-EXPIRE-DT-PROCESSING
 12078        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12079        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12080        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12081        MOVE ZERO                TO DC-ELAPSED-DAYS
 12082                                    DC-ODD-DAYS-OVER
 12083          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12084          SET BIN-PLUS-ELAPSED    TO TRUE
 12085*         MOVE 6                  TO DC-OPTION-CODE
 12086          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12087          IF NO-CONVERSION-ERROR
 12088             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12089
 12090******************************************************************
 12091*                                                                *
 12092*            1ST PAYMENT DATE PROCESSING                         *
 12093*                                                                *
 12094******************************************************************
 12095
 12096     IF PB-1ST-PMT-DT-PROCESSING
 12097        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12098                                    PB-I-AH-EXPIRE-DT
 12099        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12100
 12101     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12102         NEXT SENTENCE
 12103     ELSE
 12104         MOVE ER-2680                 TO WS-ERROR
 12105         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12106         GO TO 3060-ORIG-TERM-CHECK.
 12107
 12108     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12109     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12110     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12111*    MOVE 1                      TO DC-OPTION-CODE.
 12112     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12113                                    DC-ELAPSED-DAYS
 12114                                    DC-ODD-DAYS-OVER.
 12115
 12116     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12117
 12118     IF DATE-CONVERSION-ERROR
 12119        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 221
* EL050.cbl
 12120
 12121     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12122     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12123        AND (WS-LF-COVERAGE-TYPE = 'L')
 12124        IF (DC-ELAPSED-MONTHS > 1)
 12125                      OR
 12126           ((DC-ELAPSED-MONTHS = 1)
 12127           AND (DC-ODD-DAYS-OVER > 0))
 12128           MOVE ER-2882          TO WS-ERROR
 12129           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12130        END-IF
 12131     END-IF
 12132     if dc-elapsed-months > 0
 12133        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12134        + dc-odd-days-over
 12135     end-if
 12136     IF PB-EXT-DAYS-PROCESSING
 12137        CONTINUE
 12138     ELSE
 12139        IF DC-ELAPSED-MONTHS = +0
 12140           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12141        ELSE
 12142           IF (WS-LF-EARNINGS-CALC = '4')
 12143              AND (DC-ELAPSED-MONTHS > ZERO)
 12144              AND (DC-ELAPSED-DAYS > ZERO)
 12145              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12146           ELSE
 12147              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12148                                 THRU 6499-EXIT
 12149              MOVE WS-ODD-DAYS-OVER
 12150                                 TO PB-I-EXTENTION-DAYS
 12151           END-IF
 12152        END-IF
 12153     END-IF
 12154******************************************************************
 12155*                                                                *
 12156*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12157*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12158*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12159*            AND ANY ODD DAYS.                                   *
 12160*                                                                *
 12161******************************************************************
 12162
 12163     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12164                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12165     IF WS-LF-EARNINGS-CALC NOT = '4'
 12166        IF DC-ELAPSED-DAYS > ZEROS
 12167           MOVE ER-2681          TO WS-ERROR
 12168           PERFORM 9900-ERROR-FORMAT
 12169                                 THRU 9900-EXIT
 12170        END-IF
 12171     END-IF
 12172
 12173     IF WS-LF-EARNINGS-CALC NOT = '4'
 12174        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12175           MOVE ER-2681          TO WS-ERROR
 12176           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12177
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 222
* EL050.cbl
 12178     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12179        (PB-I-LF-TERM NOT = ZERO) AND
 12180         NOT NO-LIFE-COVERAGE
 12181          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12182          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12183          IF WS-LF-EARNINGS-CALC = '4'
 12184             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12185             PB-I-PAY-FREQUENCY
 12186          END-IF
 12187          MOVE ZERO              TO DC-ELAPSED-DAYS
 12188                                    DC-ODD-DAYS-OVER
 12189          MOVE 1                 TO DC-END-OF-MONTH
 12190          SET BIN-PLUS-ELAPSED        TO TRUE
 12191*         MOVE 6                 TO DC-OPTION-CODE
 12192          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12193          IF NO-CONVERSION-ERROR
 12194             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12195             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12196                (WS-LF-SPECIAL-CALC-CD = 'L')
 12197                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12198                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12199                  MOVE +1             TO DC-ELAPSED-MONTHS
 12200                  SET BIN-PLUS-ELAPSED  TO TRUE
 12201*                 MOVE 6              TO DC-OPTION-CODE
 12202                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12203                  IF NO-CONVERSION-ERROR
 12204                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12205
 12206* okay, i had to move the new att age edit down here because the
 12207* expiration date could get recalculated and i need the exp date
 12208     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12209        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12210        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12211        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12212           AND ZEROS
 12213           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12214           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12215           SET ELAPSED-BETWEEN-BIN TO TRUE
 12216           PERFORM 8500-DATE-CONVERT
 12217                                 THRU 8500-EXIT
 12218           IF NO-CONVERSION-ERROR
 12219              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12220                 MOVE ER-2669       TO WS-ERROR
 12221*                PERFORM 9900-ERROR-FORMAT
 12222*                                THRU 9900-EXIT
 12223              END-IF
 12224           END-IF
 12225        ELSE
 12226           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12227           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12228              MOVE ER-2669       TO WS-ERROR
 12229*             PERFORM 9900-ERROR-FORMAT
 12230*                                THRU 9900-EXIT
 12231           ELSE
 12232              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12233                 MOVE ER-1570    TO WS-ERROR
 12234                 PERFORM 9900-ERROR-FORMAT
 12235                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 223
* EL050.cbl
 12236              END-IF
 12237           END-IF
 12238        END-IF
 12239        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12240           AND ZEROS
 12241           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12242           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12243           SET ELAPSED-BETWEEN-BIN TO TRUE
 12244           PERFORM 8500-DATE-CONVERT
 12245                                 THRU 8500-EXIT
 12246           IF NO-CONVERSION-ERROR
 12247              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12248                 MOVE ER-2669       TO WS-ERROR
 12249*                PERFORM 9900-ERROR-FORMAT
 12250*                                THRU 9900-EXIT
 12251              END-IF
 12252           END-IF
 12253        ELSE
 12254           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12255             (PB-I-LF-TERM / 12)
 12256           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12257              MOVE ER-2669       TO WS-ERROR
 12258*             PERFORM 9900-ERROR-FORMAT
 12259*                                THRU 9900-EXIT
 12260           ELSE
 12261              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12262                 MOVE ER-1571    TO WS-ERROR
 12263                 PERFORM 9900-ERROR-FORMAT
 12264                                 THRU 9900-EXIT
 12265              END-IF
 12266           END-IF
 12267        END-IF
 12268        IF WS-ERROR = ER-2669
 12269           PERFORM 9900-ERROR-FORMAT
 12270                                 THRU 9900-EXIT
 12271        END-IF
 12272     END-IF
 12273     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12274        (PB-I-AH-TERM NOT = ZERO) AND
 12275         NOT NO-AH-COVERAGE
 12276          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12277             AND (PB-COMPANY-ID = 'DCC')
 12278             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12279             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12280          ELSE
 12281             IF WS-LF-EARNINGS-CALC = '4'
 12282                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12283                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12284                PB-I-PAY-FREQUENCY
 12285             ELSE
 12286                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12287                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12288             END-IF
 12289          END-IF
 12290          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12291                                         DC-ODD-DAYS-OVER
 12292          MOVE 1                      TO DC-END-OF-MONTH
 12293          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 224
* EL050.cbl
 12294*         MOVE 6                      TO DC-OPTION-CODE
 12295          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12296          IF NO-CONVERSION-ERROR
 12297             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12298     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12299        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12300        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12301        IF PB-I-BIRTHDAY > LOW-VALUES
 12302           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12303           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12304           SET ELAPSED-BETWEEN-BIN TO TRUE
 12305           PERFORM 8500-DATE-CONVERT
 12306                                 THRU 8500-EXIT
 12307           IF NO-CONVERSION-ERROR
 12308              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12309                 MOVE ER-3054       TO WS-ERROR
 12310*                PERFORM 9900-ERROR-FORMAT
 12311*                                THRU 9900-EXIT
 12312              END-IF
 12313           END-IF
 12314        ELSE
 12315           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12316           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12317              MOVE ER-3054       TO WS-ERROR
 12318*             PERFORM 9900-ERROR-FORMAT
 12319*                                THRU 9900-EXIT
 12320           END-IF
 12321        END-IF
 12322        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12323           AND ZEROS
 12324           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12325           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12326           SET ELAPSED-BETWEEN-BIN TO TRUE
 12327           PERFORM 8500-DATE-CONVERT
 12328                                 THRU 8500-EXIT
 12329           IF NO-CONVERSION-ERROR
 12330              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12331                 MOVE ER-3054       TO WS-ERROR
 12332*                PERFORM 9900-ERROR-FORMAT
 12333*                                THRU 9900-EXIT
 12334              END-IF
 12335           END-IF
 12336        ELSE
 12337           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12338             (PB-I-AH-TERM / 12)
 12339           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12340              MOVE ER-3054       TO WS-ERROR
 12341*             PERFORM 9900-ERROR-FORMAT
 12342*                                THRU 9900-EXIT
 12343           END-IF
 12344        END-IF
 12345        IF WS-ERROR = ER-3054
 12346           PERFORM 9900-ERROR-FORMAT
 12347                                 THRU 9900-EXIT
 12348        END-IF
 12349     END-IF
 12350     MOVE SPACE                       TO DC-END-OF-MONTH.
 12351
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 225
* EL050.cbl
 12352     IF PB-COMPANY-ID = 'NCB'
 12353        GO TO 3040-EDIT-EXTENSION-DAYS.
 12354
 12355     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12356       AND
 12357        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12358        NEXT SENTENCE
 12359     ELSE
 12360        GO TO 3040-EDIT-EXTENSION-DAYS.
 12361
 12362     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12363        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12364        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12365     ELSE
 12366        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12367        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12368
 12369     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12370*    MOVE '1'      TO DC-OPTION-CODE
 12371     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12372     IF (NO-CONVERSION-ERROR)
 12373        AND (DC-ELAPSED-MONTHS > +1)
 12374        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12375        MOVE ER-2668   TO WS-ERROR
 12376        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12377
 12378 3040-EDIT-EXTENSION-DAYS.
 12379
 12380     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12381        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12382         GO TO 3050-EDIT-TERM-IN-DAYS
 12383     ELSE
 12384         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12385
 12386     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12387         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12388     ELSE
 12389        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12390           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12391           MOVE ER-2681         TO WS-ERROR
 12392           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12393
 12394     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12395        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12396        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12397         GO TO 3060-ORIG-TERM-CHECK.
 12398
 12399     GO TO 3060-ORIG-TERM-CHECK.
 12400
 12401 3050-EDIT-TERM-IN-DAYS.
 12402
 12403     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12404
 12405     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12406         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12407     ELSE
 12408         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12409            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 226
* EL050.cbl
 12410            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12411
 12412     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12413                                       REMAINDER WS-WORK-TERM.
 12414     IF WS-WORK-TERM GREATER THAN ZERO
 12415         ADD +1 TO PB-I-LF-TERM.
 12416
 12417     IF NOT NO-AH-COVERAGE
 12418         MOVE ER-2684            TO WS-ERROR
 12419         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12420
 12421
 12422 3060-ORIG-TERM-CHECK.
 12423
 12424******************************************************************
 12425*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12426******************************************************************
 12427
 12428     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12429        NEXT SENTENCE
 12430     ELSE
 12431        IF NOT NO-LIFE-COVERAGE
 12432           IF PB-I-LF-TERM NUMERIC
 12433              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12434              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12435              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12436                  NEXT SENTENCE
 12437           ELSE
 12438              MOVE ER-2647       TO WS-ERROR
 12439              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12440
 12441     IF NOT NO-AH-COVERAGE
 12442         IF PB-I-AH-TERM NUMERIC
 12443            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12444            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12445            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12446             NEXT SENTENCE
 12447          ELSE
 12448              MOVE ER-2658       TO WS-ERROR
 12449              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12450
 12451     IF PB-COMPANY-ID = 'NCB'
 12452        GO TO 3070-LOAN-TERM-CHECK.
 12453
 12454     IF POLICY-HAS-AH
 12455       AND
 12456        POLICY-HAS-LIFE
 12457       AND
 12458        PB-I-LF-TERM NUMERIC
 12459       AND
 12460        PB-I-AH-TERM NUMERIC
 12461        NEXT SENTENCE
 12462     ELSE
 12463        GO TO 3070-LOAN-TERM-CHECK.
 12464
 12465     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12466     IF WS-TEX-FACT-2 LESS THAN +0
 12467        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 227
* EL050.cbl
 12468
 12469     IF WS-TEX-FACT-2 GREATER THAN +1
 12470        MOVE ER-2668             TO WS-ERROR
 12471        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12472
 12473 3070-LOAN-TERM-CHECK.
 12474
 12475     IF (WS-LF-BENEFIT-CD = ZERO)
 12476         OR (NO-LF-BENEFIT-MATCH)
 12477            GO TO 3125-EDIT-PMT-FREQ.
 12478*    IF PB-COMPANY-ID NOT = 'DCC'
 12479*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12480*          AND 'V' AND 'W' AND 'X'
 12481*          GO TO 3125-EDIT-PMT-FREQ
 12482*       END-IF
 12483*    ELSE
 12484*       IF WS-AH-DCC-TRUNC = 'T'
 12485*          CONTINUE
 12486*       ELSE
 12487*          GO TO 3125-EDIT-PMT-FREQ
 12488*       END-IF
 12489*    END-IF
 12490     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12491                    OR
 12492        ((PB-COMPANY-ID = 'DCC')
 12493        AND (WS-AH-DCC-TRUNC = 'T'))
 12494        CONTINUE
 12495     ELSE
 12496        GO TO 3125-EDIT-PMT-FREQ
 12497     END-IF
 12498     IF PB-I-LOAN-TERM NOT NUMERIC
 12499         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12500
 12501     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12502        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12503*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12504        PB-I-LOAN-TERM NOT GREATER THAN +360
 12505         NEXT SENTENCE
 12506     ELSE
 12507         MOVE ER-2648            TO WS-ERROR
 12508         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12509
 12510     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12511        MOVE ER-3058             TO WS-ERROR
 12512        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12513     end-if
 12514
 12515     IF WS-STATE-ABBREVIATION = 'NC'
 12516        IF PB-I-LOAN-TERM > +59
 12517           CONTINUE
 12518        ELSE
 12519           MOVE ER-2792          TO WS-ERROR
 12520           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12521        END-IF
 12522     END-IF
 12523
 12524     .
 12525 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 228
* EL050.cbl
 12526     IF (WS-LF-BENEFIT-CD = ZERO)
 12527         OR (NO-LF-BENEFIT-MATCH)
 12528            GO TO 3127-EDIT-LOAN-OFFICER.
 12529     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12530                    OR
 12531        ((PB-COMPANY-ID = 'DCC')
 12532        AND (WS-AH-DCC-TRUNC = 'T'))
 12533                    OR
 12534         (PB-COMPANY-ID = 'AHL')
 12535        CONTINUE
 12536     ELSE
 12537        IF (PB-I-LOAN-TERM > ZEROS)
 12538           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12539           MOVE ER-1575          TO WS-ERROR
 12540           PERFORM 9900-ERROR-FORMAT
 12541                                 THRU 9900-EXIT
 12542        END-IF
 12543     END-IF
 12544     IF WS-LF-EARNINGS-CALC NOT = '4'
 12545         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12546            MOVE ER-2653         TO WS-ERROR
 12547            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12548            GO TO 3127-EDIT-LOAN-OFFICER
 12549         ELSE
 12550            GO TO 3127-EDIT-LOAN-OFFICER.
 12551
 12552     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12553         MOVE ER-2655            TO WS-ERROR
 12554         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12555         GO TO 3127-EDIT-LOAN-OFFICER.
 12556
 12557     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12558         MOVE ER-2654            TO WS-ERROR
 12559         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12560         GO TO 3127-EDIT-LOAN-OFFICER.
 12561
 12562     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12563         GIVING WS-TEX-FACT-2
 12564             REMAINDER WS-TEX-FACT-3.
 12565
 12566*    IF WS-TEX-FACT-3 NOT = ZERO
 12567*       MOVE ER-2654             TO WS-ERROR
 12568*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12569
 12570
 12571 3127-EDIT-LOAN-OFFICER.
 12572
 12573     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12574        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12575           MOVE ER-2690          TO WS-ERROR
 12576           PERFORM 9900-ERROR-FORMAT
 12577                                 THRU 9900-EXIT
 12578        ELSE
 12579           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12580           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12581           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12582           MOVE PB-SV-STATE      TO LOFC-STATE
 12583           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 229
* EL050.cbl
 12584           MOVE PB-I-LOAN-OFFICER
 12585                                 TO LOFC-CODE
 12586           PERFORM 8586-READ-LOAN-OFFICER
 12587                                 THRU 8586-EXIT
 12588           IF (NOT LOFC-MASTER-FOUND)
 12589              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12590              MOVE ER-3006       TO WS-ERROR
 12591              PERFORM 9900-ERROR-FORMAT
 12592                                 THRU 9900-EXIT
 12593           END-IF
 12594        END-IF
 12595     END-IF
 12596     .
 12597 3129-EDIT-APR.
 12598
 12599     IF (WS-LF-BENEFIT-CD = ZERO)
 12600        OR (NO-LF-BENEFIT-MATCH)
 12601        IF PB-COMPANY-ID NOT = 'DCC'
 12602           GO TO 3130-EDIT-AGE
 12603*       ELSE
 12604*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12605*             GO TO 3130-EDIT-AGE
 12606*          END-IF
 12607        END-IF
 12608     END-IF
 12609
 12610     IF (WS-STATE-ABBREVIATION = 'OH')
 12611         AND (PB-I-RATE-CLASS NOT = 'L ')
 12612         AND (PB-I-LF-TERM GREATER THAN 60)
 12613         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12614         GO TO 3129-APR-CONT.
 12615
 12616     IF (WS-STATE-ABBREVIATION = 'RI')
 12617         AND (PB-I-LF-TERM GREATER THAN 60)
 12618         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12619         GO TO 3129-APR-CONT.
 12620
 12621     IF (WS-STATE-ABBREVIATION = 'UT')
 12622         AND (PB-I-LF-TERM GREATER THAN 62)
 12623         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12624         AND (PB-CERT-EFF-DT LESS WS-830901)
 12625         GO TO 3129-APR-CONT.
 12626
 12627     IF PB-COMPANY-ID = 'LAP'
 12628        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12629           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12630              MOVE ER-2656         TO WS-ERROR
 12631              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12632              GO TO 3130-EDIT-AGE.
 12633
 12634     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12635        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12636        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12637        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12638        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12639        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12640         GO TO 3130-EDIT-AGE.
 12641
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 230
* EL050.cbl
 12642 3129-APR-CONT.
 12643     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12644         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12645         GO TO 3130-EDIT-AGE.
 12646
 12647     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12648         WS-AH-BENEFIT-CD (1:1) = 'S')
 12649        AND (PB-COMPANY-ID = 'DCC')
 12650        AND (PB-I-LOAN-APR = ZERO)
 12651        MOVE ER-2657             TO WS-ERROR
 12652        PERFORM 9900-ERROR-FORMAT
 12653                                 THRU 9900-EXIT
 12654        GO TO 3130-EDIT-AGE
 12655     END-IF
 12656*    IF PB-I-LOAN-APR = ZERO
 12657*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12658*    END-IF
 12659
 12660     if pb-i-loan-apr = +99.9999
 12661        move er-2656             to ws-error
 12662        PERFORM 9900-ERROR-FORMAT
 12663                                 THRU 9900-EXIT
 12664        GO TO 3130-EDIT-AGE
 12665     end-if
 12666*    IF PB-I-LOAN-APR = ZERO
 12667*       MOVE ER-2656             TO WS-ERROR
 12668*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12669*       GO TO 3130-EDIT-AGE.
 12670
 12671*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12672     if pb-i-loan-apr not = +99.9999
 12673        IF PB-I-LOAN-APR > +30.000
 12674           MOVE ER-2657          TO WS-ERROR
 12675           PERFORM 9900-ERROR-FORMAT
 12676                                 THRU 9900-EXIT
 12677        end-if
 12678     end-if
 12679     .
 12680 3130-EDIT-AGE.
 12681
 12682******************************************************************
 12683*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12684******************************************************************
 12685
 12686     IF NOT NO-LIFE-COVERAGE
 12687        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12688           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12689               MOVE ER-2628             TO WS-ERROR
 12690               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12691
 12692     IF NOT NO-AH-COVERAGE
 12693        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12694           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12695               MOVE ER-2628         TO WS-ERROR
 12696               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12697
 12698 3133-SEX-CODE.
 12699     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 231
* EL050.cbl
 12700         IF WS-DEFAULT-SEX = 'M'
 12701             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12702          ELSE
 12703             IF WS-DEFAULT-SEX = 'F'
 12704             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12705
 12706     IF PB-I-INSURED-SEX = '1'
 12707         MOVE 'M' TO PB-I-INSURED-SEX.
 12708
 12709     IF PB-I-INSURED-SEX = '2'
 12710         MOVE 'F' TO PB-I-INSURED-SEX.
 12711
 12712 3134-SIG-SW-EDIT.
 12713     IF PB-I-SIG-SW = SPACE
 12714         MOVE 'N'                TO  PB-I-SIG-SW.
 12715
 12716     IF PB-COMPANY-ID = 'NCL'
 12717         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12718             NEXT SENTENCE
 12719         ELSE
 12720             MOVE ER-1923        TO  WS-ERROR
 12721             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12722     ELSE
 12723     IF PB-COMPANY-ID = 'CRI'
 12724         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12725             NEXT SENTENCE
 12726         ELSE
 12727             MOVE ER-2606        TO  WS-ERROR
 12728             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12729     ELSE
 12730     IF PB-COMPANY-ID = 'TMS'
 12731         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12732             NEXT SENTENCE
 12733         ELSE
 12734             MOVE ER-2689        TO  WS-ERROR
 12735             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12736     ELSE
 12737         IF PB-I-SIG-SW = 'Y' OR 'N'
 12738             NEXT SENTENCE
 12739         ELSE
 12740             MOVE ER-2651        TO  WS-ERROR
 12741             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12742
 12743     IF PB-COMPANY-ID = 'FLA'
 12744         IF (WS-EDIT-AGE GREATER 54  OR
 12745             WS-AH-EDIT-AGE GREATER 54)  AND
 12746            PB-I-SIG-SW = 'N'
 12747            MOVE ER-2651         TO  WS-ERROR
 12748            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12749
 12750 3135-NAME-EDIT.
 12751
 12752     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12753        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12754        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12755           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12756                                 TO PB-I-JOINT-FIRST-NAME
 12757        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 232
* EL050.cbl
 12758     END-IF
 12759     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12760        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12761        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12762           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12763                                 TO PB-I-JOINT-LAST-NAME
 12764        END-PERFORM
 12765     END-IF
 12766     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12767        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12768        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12769           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12770                                 TO PB-I-INSURED-FIRST-NAME
 12771        END-PERFORM
 12772     END-IF
 12773     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12774        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12775        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12776           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12777                                 TO PB-I-INSURED-LAST-NAME
 12778        END-PERFORM
 12779     END-IF
 12780     IF PB-I-INSURED-LAST-NAME = SPACES
 12781       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12782       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12783           MOVE ER-2660    TO WS-ERROR
 12784           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12785
 12786 3136-EDIT-SEX.
 12787
 12788******************************************************************
 12789*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12790******************************************************************
 12791
 12792     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12793        (WS-AH-SPECIAL-CALC-CD = 'O')
 12794        NEXT SENTENCE
 12795     ELSE
 12796        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12797           NEXT SENTENCE
 12798        ELSE
 12799           MOVE ER-2629            TO WS-ERROR
 12800           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12801
 12802 3137-EDIT-EFF-DATE.
 12803
 12804     IF PB-REISSUED-CERT       OR
 12805        PB-POLICY-IS-DECLINED  OR
 12806        PB-POLICY-IS-VOIDED
 12807         GO TO 3139-EDIT-COVERAGE-CODES.
 12808
 12809     MOVE SPACE                  TO WS-2671-SW
 12810                                    WS-2672-SW.
 12811
 12812     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12813         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12814             MOVE ER-2703        TO WS-ERROR
 12815             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 233
* EL050.cbl
 12816             GO TO 3139-EDIT-COVERAGE-CODES.
 12817
 12818     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12819         GO TO 3139-EDIT-COVERAGE-CODES.
 12820
 12821     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12822     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12823*    MOVE '1'                    TO DC-OPTION-CODE.
 12824     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12825     MOVE +0                     TO DC-ELAPSED-MONTHS
 12826                                    DC-ELAPSED-DAYS.
 12827     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12828
 12829     IF DATE-CONVERSION-ERROR
 12830         GO TO 3139-EDIT-COVERAGE-CODES.
 12831
 12832     IF DC-ELAPSED-DAYS GREATER +180
 12833         MOVE ER-2672            TO WS-ERROR
 12834         MOVE 'Y'                TO WS-2672-SW
 12835         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12836     END-IF
 12837
 12838     IF WS-ERROR = ER-2671  AND
 12839        PB-COMPANY-ID  = 'LBL'
 12840        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12841        MOVE SPACE               TO WS-2671-SW
 12842        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12843
 12844     IF PB-ISSUE-DATE-FORCED  AND
 12845      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12846         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12847         MOVE ER-2673            TO WS-ERROR
 12848         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12849         MOVE SPACE              TO WS-2671-SW
 12850                                    WS-2672-SW.
 12851
 12852     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12853         IF PB-ISSUE-DATE-FORCED
 12854             MOVE ER-2600          TO  WS-ERROR
 12855             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12856         ELSE
 12857             MOVE ER-2692          TO  WS-ERROR
 12858             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12859
 12860
 12861 3139-EDIT-COVERAGE-CODES.
 12862
 12863     if pb-company-id not = 'AHL'
 12864        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12865           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12866           MOVE ER-2787          TO WS-ERROR
 12867           PERFORM 9900-ERROR-FORMAT
 12868                                 THRU 9900-EXIT
 12869        END-IF
 12870     end-if
 12871     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12872        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12873                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 234
* EL050.cbl
 12874           MOVE ER-2719          TO WS-ERROR
 12875           PERFORM 9900-ERROR-FORMAT
 12876                                 THRU 9900-EXIT
 12877        END-IF
 12878     END-IF
 12879
 12880     IF PB-POLICY-IS-DECLINED  OR
 12881        PB-POLICY-IS-VOIDED
 12882         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12883
 12884     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12885        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12886         MOVE ER-2630                TO WS-ERROR
 12887         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12888
 12889     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12890        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12891        PB-I-LF-PREMIUM-AMT = ZERO
 12892         GO TO 3140-CHECK-AH-FOR-ZERO.
 12893
 12894     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12895        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12896        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12897         GO TO 3140-CHECK-AH-FOR-ZERO.
 12898
 12899     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12900        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12901        MOVE ER-2631             TO WS-ERROR
 12902        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12903     END-IF
 12904
 12905
 12906******************************************************************
 12907*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12908******************************************************************
 12909
 12910     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12911        NEXT SENTENCE
 12912     ELSE
 12913        IF PB-I-LF-BENEFIT-AMT = ZERO
 12914           MOVE ER-2632             TO WS-ERROR
 12915           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12916
 12917
 12918******************************************************************
 12919*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12920******************************************************************
 12921
 12922     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12923        CONTINUE
 12924     ELSE
 12925        IF PB-I-LF-PREMIUM-AMT = ZERO
 12926           IF (NOT PB-COMP-LF-PREM)
 12927              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12928              and (ws-lf-ben-category not = 'C')
 12929              MOVE ER-2633       TO WS-ERROR
 12930              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12931           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 235
* EL050.cbl
 12932        END-IF
 12933     END-IF
 12934     .
 12935 3140-CHECK-AH-FOR-ZERO.
 12936
 12937     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12938        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12939        PB-I-AH-PREMIUM-AMT = ZERO
 12940         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12941
 12942     IF PB-COMPANY-ID = 'CSL'  AND
 12943        PB-I-AH-BENEFIT-CD = ZERO  AND
 12944        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12945        PB-I-AH-PREMIUM-AMT = ZERO
 12946         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12947
 12948     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12949        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12950        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12951         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12952
 12953     IF PB-I-AH-BENEFIT-CD = ZERO
 12954         MOVE ER-2634            TO WS-ERROR
 12955         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12956
 12957******************************************************************
 12958*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12959******************************************************************
 12960
 12961     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12962        NEXT SENTENCE
 12963     ELSE
 12964        IF PB-I-AH-BENEFIT-AMT = ZERO
 12965           MOVE ER-2635             TO WS-ERROR
 12966           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12967
 12968******************************************************************
 12969*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12970******************************************************************
 12971
 12972     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12973        NEXT SENTENCE
 12974     ELSE
 12975        IF PB-I-AH-PREMIUM-AMT = ZERO
 12976            IF NOT PB-COMP-AH-PREM
 12977                MOVE ER-2636    TO WS-ERROR
 12978                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12979
 12980
 12981 3140-EDIT-MAX-AMT-SIZES.
 12982* CUSTOM CODE FOR CLIENT    'DMD'
 12983     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12984                                     WS-RES-MUNI-TAX
 12985                                     PB-I-STATE-TAX
 12986                                     PB-I-MUNI-TAX.
 12987
 12988     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12989
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 236
* EL050.cbl
 12990     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12991        GO TO 3150-RATE-OUTSTAND-BAL.
 12992
 12993     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 12994        GO TO 3150-RATE-OUTSTAND-BAL.
 12995
 12996     IF WS-LF-EARNINGS-CALC EQUAL '5'
 12997        GO TO 3150-RATE-OUTSTAND-BAL.
 12998
 12999     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13000                             OR 'RIC')
 13001        GO TO 3150-RATE-OUTSTAND-BAL.
 13002
 13003     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13004        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13005            GO TO 3150-RATE-OUTSTAND-BAL
 13006        ELSE
 13007           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13008               GO TO 3150-RATE-OUTSTAND-BAL.
 13009
 13010     IF NOT PB-NO-MONTHS-SKIPPED
 13011        GO TO 3150-RATE-OUTSTAND-BAL.
 13012
 13013     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13014        GO TO 3150-RATE-OUTSTAND-BAL.
 13015
 13016     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13017        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13018           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13019             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13020           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13021           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13022              MOVE ER-2693     TO WS-ERROR
 13023              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13024              GO TO 3150-RATE-OUTSTAND-BAL
 13025           ELSE
 13026              GO TO 3150-RATE-OUTSTAND-BAL.
 13027
 13028 3150-RATE-OUTSTAND-BAL.
 13029
 13030* DMD RATING TEST
 13031     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13032         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13033         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13034         MOVE ER-2687                 TO WS-ERROR
 13035         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13036         MOVE 'B'                     TO PB-I-OB-FLAG
 13037         GO TO 3260-EDIT-CONTINUE.
 13038
 13039     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13040         IF  WS-ERROR    EQUAL    ER-2693
 13041             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13042                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13043                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13044                 MOVE  +0            TO  WS-ERROR.
 13045
 13046     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13047         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 237
* EL050.cbl
 13048             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13049                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13050                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13051                 MOVE  +0            TO  WS-ERROR.
 13052
 13053     IF PLAN-MASTER-AH-SW = 'Y'
 13054        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13055            IF  WS-ERROR    EQUAL    ER-2693
 13056              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13057                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13058                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13059                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13060                 MOVE  ER-1910           TO  WS-ERROR
 13061                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13062
 13063     IF PLAN-MASTER-AH-SW = 'Y'
 13064        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13065            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13066               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13067               MOVE  ER-1910           TO  WS-ERROR
 13068               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13069
 13070     IF PLAN-MASTER-AH-SW = 'Y'
 13071        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13072            IF  WS-ERROR    EQUAL    ER-2693
 13073                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13074                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13075                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13076                 MOVE  +0       TO  WS-ERROR.
 13077
 13078     IF WS-ERROR = ER-2693
 13079        IF PB-COMPANY-ID = 'JAL' AND
 13080           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13081           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13082           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13083
 13084     IF WS-ERROR = ER-2693
 13085        IF PB-COMPANY-ID = 'NCL'  AND
 13086           PB-I-AH-BENEFIT-CD = 'OA'
 13087           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13088           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13089
 13090     IF WS-ERROR = ER-2693
 13091        IF PB-COMPANY-ID = 'CNL' AND
 13092           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13093           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13094           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13095
 13096     IF WS-ERROR = ER-2693
 13097        IF PB-COMPANY-ID = 'HER'
 13098           IF WS-LEVEL
 13099              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13100              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13101
 13102     IF ((LF-BENEFIT-FOUND) AND
 13103         (NOT NO-LIFE-COVERAGE)  AND
 13104         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13105       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 238
* EL050.cbl
 13106             (NOT NO-AH-COVERAGE)    AND
 13107             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13108         NEXT SENTENCE
 13109     ELSE
 13110         GO TO 3215-EDIT-RATES.
 13111
 13112     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13113        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13114           MOVE ER-2674          TO WS-ERROR
 13115           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13116           GO TO 3215-EDIT-RATES.
 13117
 13118     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13119        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13120           MOVE ER-2674          TO WS-ERROR
 13121           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13122           GO TO 3215-EDIT-RATES.
 13123
 13124     MOVE 'B'                    TO PB-I-OB-FLAG.
 13125
 13126     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13127         NEXT SENTENCE
 13128     ELSE
 13129         IF NOT NO-LIFE-COVERAGE
 13130             IF WS-ACCT-LF-OB-RT = ZERO
 13131                MOVE ER-2641    TO WS-ERROR
 13132                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13133
 13134     IF PB-COMPANY-ID = 'CRI'
 13135       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13136         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13137         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13138         IF WS-ERROR = ER-2675
 13139            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13140            MOVE ER-2687              TO WS-ERROR
 13141            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13142         ELSE
 13143            MOVE ER-2687              TO WS-ERROR
 13144            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13145
 13146
 13147     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13148         NEXT SENTENCE
 13149     ELSE
 13150       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13151            NEXT SENTENCE
 13152       ELSE
 13153         IF NOT NO-AH-COVERAGE
 13154             IF WS-ACCT-AH-OB-RT = ZERO
 13155                MOVE ER-2642    TO WS-ERROR
 13156                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13157
 13158     IF PB-COMPANY-ID = 'CRI'
 13159       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13160         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13161         IF WS-ERROR = ER-2676
 13162            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13163            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 239
* EL050.cbl
 13164            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13165         ELSE
 13166            MOVE ER-2687              TO WS-ERROR
 13167            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13168
 13169     IF PB-COMPANY-ID NOT = 'GIC'
 13170         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13171            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13172     ELSE
 13173         IF PB-I-LF-PREM-CALC = ZEROS
 13174             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13175                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13176
 13177     IF PB-COMPANY-ID NOT = 'GIC'
 13178         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13179            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13180     ELSE
 13181         IF PB-I-AH-PREM-CALC = ZEROS
 13182             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13183                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13184
 13185     MOVE ZEROS TO PB-I-MORT-CODE.
 13186
 13187     GO TO 3260-EDIT-CONTINUE.
 13188
 13189
 13190 3215-EDIT-RATES.
 13191     IF ACCOUNT-MAST-FOUND
 13192         NEXT SENTENCE
 13193     ELSE
 13194         GO TO 3999-END-EDIT.
 13195
 13196 3220-CHECK-LF-RATES.
 13197
 13198     IF PB-COMPANY-ID = 'DCC'
 13199        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13200        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13201        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13202           AND (NOT WS-LF-CASH))
 13203                           OR
 13204           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13205           AND (NOT WS-AH-CASH)))
 13206                       AND
 13207           (PB-I-ENTRY-STATUS NOT = '5')
 13208           MOVE 'M'              TO PB-BATCH-ENTRY
 13209                                    PB-I-ENTRY-STATUS
 13210        END-IF
 13211     END-IF
 13212     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13213                                    PB-I-AH-PREM-CALC
 13214                                    PB-I-LF-ALT-PREM-CALC
 13215                                    PB-I-LF-ALT-RATE
 13216                                    PB-I-LF-REI-RATE
 13217                                    PB-I-LF-ALT-REI-RATE
 13218                                    PB-I-AH-REI-RATE
 13219                                    PB-I-TOT-FEES-CALC.
 13220
 13221     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 240
* EL050.cbl
 13222        NEXT SENTENCE
 13223     ELSE
 13224        MOVE ZEROS               TO PB-I-LF-RATE
 13225                                    PB-I-AH-RATE.
 13226
 13227     IF PB-I-TOT-FEES NOT NUMERIC
 13228        MOVE ZEROS               TO PB-I-TOT-FEES
 13229     END-IF
 13230     IF PB-I-LIVES NOT NUMERIC
 13231         MOVE ZERO               TO PB-I-LIVES.
 13232
 13233     IF PB-I-NUM-BILLED NOT NUMERIC
 13234         MOVE ZERO               TO PB-I-NUM-BILLED.
 13235
 13236     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13237        MOVE +0                  TO PB-I-LF-PREM-TAX
 13238     END-IF
 13239
 13240     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13241        MOVE +0                  TO PB-I-AH-PREM-TAX
 13242     END-IF
 13243
 13244     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13245        PB-I-PAY-FREQUENCY = ZEROS
 13246            MOVE 12 TO CP-PAY-FREQUENCY
 13247     ELSE
 13248            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13249
 13250     IF PB-I-STATE-TAX NOT NUMERIC
 13251         MOVE ZEROS               TO PB-I-STATE-TAX.
 13252
 13253     IF PB-I-MUNI-TAX NOT NUMERIC
 13254         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13255
 13256     MOVE SPACES                 TO CP-BEN-CATEGORY
 13257     IF PB-COMPANY-ID  = 'CSL'  AND
 13258        PB-I-LF-TERM NOT = ZERO
 13259        COMPUTE WS-PAYMENT-AMT =
 13260             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13261        COMPUTE WS-CSL-AMT1 =
 13262             PB-I-LF-TERM * AM-MAX-MON-BEN
 13263        COMPUTE WS-CSL-AMT2 =
 13264             WS-PAYMENT-AMT * PB-I-LF-TERM
 13265        IF CP-PAY-FREQUENCY NOT = 12
 13266           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13267           MOVE '8' TO WS-CSL-CALC-CD
 13268        ELSE
 13269           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13270              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13271               AM-MAX-TOT-BEN
 13272               MOVE '6' TO WS-CSL-CALC-CD
 13273           ELSE
 13274              IF (WS-CSL-AMT1  GREATER THAN
 13275                 AM-MAX-TOT-BEN) AND
 13276                 (WS-CSL-AMT2  GREATER THAN
 13277                 AM-MAX-TOT-BEN)
 13278                 MOVE '7' TO WS-CSL-CALC-CD
 13279              ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 241
* EL050.cbl
 13280                 MOVE '5' TO WS-CSL-CALC-CD.
 13281
 13282     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13283         NEXT SENTENCE
 13284     ELSE
 13285         GO TO 3300-CHECK-AH-RATES.
 13286
 13287*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13288
 13289     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13290        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13291              OR
 13292           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13293           MOVE ER-2618          TO WS-ERROR
 13294           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13295           GO TO 3300-CHECK-AH-RATES.
 13296
 13297     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13298           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13299                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13300
 13301     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13302         MOVE ER-2687             TO WS-ERROR
 13303         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13304         MOVE 'Z000'              TO PB-I-MORT-CODE
 13305         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13306         GO TO 3300-CHECK-AH-RATES.
 13307
 13308     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13309        IF PB-I-LIVES = ZERO
 13310           MOVE ER-2688          TO WS-ERROR
 13311           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13312
 13313     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13314
 13315     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13316     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13317     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13318     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13319     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13320     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13321     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13322     MOVE '3'                    TO CP-PROCESS-TYPE.
 13323     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13324     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13325
 13326******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13327     IF PB-COMPANY-ID EQUAL 'CDL'
 13328         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13329            CP-EARN-AS-NET-PAY)
 13330             IF PB-CERT-EFF-DT GREATER  WS-931231
 13331                 MOVE '1'        TO CP-EARNING-METHOD.
 13332*******
 13333
 13334     MOVE PB-SV-STATE            TO CP-STATE.
 13335     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13336     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13337     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 242
* EL050.cbl
 13338     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13339     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13340                                    CP-RATING-BENEFIT-AMT.
 13341     IF CP-STATE-STD-ABBRV = 'OR'
 13342         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13343                                         PB-I-LF-ALT-BENEFIT-AMT.
 13344     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13345     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13346     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13347     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13348     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13349     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13350     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13351     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13352     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13353                                    CP-REMAINING-TERM
 13354                                    CP-LOAN-TERM.
 13355
 13356     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13357         NEXT SENTENCE
 13358     ELSE
 13359         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13360             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13361                                           PB-I-LF-PREMIUM-AMT.
 13362
 13363     IF PB-COMPANY-ID EQUAL 'CSL'
 13364        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13365           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13366                                         PB-I-LF-PREMIUM-AMT.
 13367
 13368     IF PB-COMPANY-ID EQUAL 'NCB'
 13369         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13370            CP-EARN-AS-NET-PAY
 13371             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13372                 PB-I-LF-PREMIUM-AMT.
 13373
 13374     IF (CP-TRUNCATED-LIFE)
 13375        or ((pb-company-id = 'AHL')
 13376           and (pb-i-loan-term > pb-i-lf-term))
 13377        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13378
 13379     IF PB-COMPANY-ID EQUAL 'CRI'
 13380        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13381
 13382     IF CP-TERM-IS-DAYS
 13383         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13384     ELSE
 13385         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13386     IF PB-COMPANY-ID = 'DCC'
 13387        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13388        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13389        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13390        IF WS-LF-BEN-CATEGORY = 'D'
 13391           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13392           MOVE PB-I-LIFE-COMMISSION
 13393                                 TO CP-DCC-ACT-COMM
 13394           MOVE WS-LF-BEN-CATEGORY
 13395                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 243
* EL050.cbl
 13396        END-IF
 13397        IF (CP-BENEFIT-CD (1:1) = 'P')
 13398           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13399           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13400           add pb-i-ah-premium-amt to cp-original-premium
 13401        END-IF
 13402     END-IF
 13403     IF PB-COMPANY-ID = 'CSL'
 13404         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13405         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13406         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13407
 13408     IF PB-COMPANY-ID = 'CSL'
 13409        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13410
 13411     IF (CP-SPECIAL-CALC-CD = 'H')
 13412        OR (PB-COMPANY-ID = 'DCC')
 13413         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13414                                    TO CP-ALTERNATE-BENEFIT
 13415         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13416     if (pb-company-id = 'CID')
 13417        and (ws-lf-earnings-calc = '4')
 13418        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13419        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13420        move pb-i-term-type      to cp-pmt-mode
 13421        move pb-i-no-of-payments to cp-no-of-pmts
 13422     end-if
 13423     move ws-net-only-state      to cp-net-only-state
 13424     IF (PB-COMPANY-ID = 'CID')
 13425        AND (WS-LF-EARNINGS-CALC = 'B')
 13426        AND (CP-STATE-STD-ABBRV = 'MN')
 13427        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13428                                 TO CP-ALTERNATE-BENEFIT
 13429        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13430     END-IF
 13431     IF (PB-COMPANY-ID = 'CID')
 13432        AND (WS-LF-EARNINGS-CALC = 'B')
 13433        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13434                                 TO CP-ALTERNATE-BENEFIT
 13435        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13436        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13437*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13438*         pb-i-lf-alt-premium-amt
 13439        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13440        IF WS-LF-BEN-CATEGORY = 'P'
 13441           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13442        ELSE
 13443           IF WS-LF-BEN-CATEGORY = 'I'
 13444              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13445           END-IF
 13446        END-IF
 13447     END-IF
 13448     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13449     MOVE 'R'                   TO CP-RATE-FILE.
 13450     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13451
 13452     IF CP-ERROR-RATE-NOT-FOUND
 13453        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 244
* EL050.cbl
 13454        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13455        GO TO 3300-CHECK-AH-RATES.
 13456
 13457     IF PB-COMPANY-ID EQUAL 'CRI'
 13458        IF CP-ERROR-NO-LIMITS-CRI
 13459           IF NOT ACCOUNT-LIFE-CHECKED
 13460              MOVE ER-2607      TO WS-ERROR
 13461              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13462
 13463******************************************************************
 13464*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13465*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13466******************************************************************
 13467
 13468* CALC LIFE AGE AT EXPIRATION.
 13469
 13470     COMPUTE WS-AGE-AT-EXPIRE =
 13471          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13472
 13473*    IF PB-STATE = 'CO' OR 'UT'
 13474*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13475*        MOVE 'F'            TO PB-FATAL-FLAG
 13476*        MOVE ER-2709        TO WS-ERROR
 13477*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13478*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13479
 13480*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13481*        MOVE 'X'            TO PB-FATAL-FLAG
 13482*        MOVE ER-2718        TO WS-ERROR
 13483*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13484*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13485
 13486* CALC A & H AGE AT EXPIRATION.
 13487
 13488     COMPUTE WS-AGE-AT-EXPIRE =
 13489          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13490
 13491*    IF PB-STATE = 'CO' OR 'UT'
 13492*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13493*        MOVE 'F'            TO PB-FATAL-FLAG
 13494*        MOVE ER-2709        TO WS-ERROR
 13495*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13496*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13497
 13498*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13499*        MOVE 'X'            TO PB-FATAL-FLAG
 13500*        MOVE ER-2718        TO WS-ERROR
 13501*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13502*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13503
 13504     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13505        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13506
 13507     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13508        and (not pb-monthly-cert)
 13509        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13510     end-if
 13511
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 245
* EL050.cbl
 13512     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13513        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13514
 13515     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13516         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13517         MOVE ER-2639        TO WS-ERROR
 13518         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13519
 13520
 13521******************************************************************
 13522*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13523******************************************************************
 13524
 13525 PREMIUM-EDITING-IS-BYPASSED.
 13526     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13527        AND (CP-R-MAX-ATT-AGE > +0)
 13528        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13529        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13530           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13531           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13532           MOVE '1'              TO DC-OPTION-CODE
 13533           PERFORM 8500-DATE-CONVERT
 13534                                 THRU 8500-EXIT
 13535           IF NO-CONVERSION-ERROR
 13536              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13537                 MOVE ER-2661       TO WS-ERROR
 13538*                PERFORM 9900-ERROR-FORMAT
 13539*                                THRU 9900-EXIT
 13540              END-IF
 13541           END-IF
 13542        ELSE
 13543           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13544           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13545              MOVE ER-2661       TO WS-ERROR
 13546*             PERFORM 9900-ERROR-FORMAT
 13547*                                THRU 9900-EXIT
 13548           ELSE
 13549              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13550                 MOVE ER-1570    TO WS-ERROR
 13551                 PERFORM 9900-ERROR-FORMAT
 13552                                 THRU 9900-EXIT
 13553              END-IF
 13554           END-IF
 13555        END-IF
 13556        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13557           MOVE PB-I-JOINT-BIRTHDAY
 13558                                 TO DC-BIN-DATE-1
 13559           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13560           MOVE '1'              TO DC-OPTION-CODE
 13561           PERFORM 8500-DATE-CONVERT
 13562                                 THRU 8500-EXIT
 13563           IF NO-CONVERSION-ERROR
 13564              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13565                 MOVE ER-2661       TO WS-ERROR
 13566*                PERFORM 9900-ERROR-FORMAT
 13567*                                THRU 9900-EXIT
 13568              END-IF
 13569           ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 246
* EL050.cbl
 13570              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13571           END-IF
 13572        ELSE
 13573           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13574             (PB-I-LF-TERM / 12)
 13575           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13576              MOVE ER-2661       TO WS-ERROR
 13577*             PERFORM 9900-ERROR-FORMAT
 13578*                                THRU 9900-EXIT
 13579           ELSE
 13580              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13581                 MOVE ER-1571    TO WS-ERROR
 13582                 PERFORM 9900-ERROR-FORMAT
 13583                                 THRU 9900-EXIT
 13584              END-IF
 13585           END-IF
 13586        END-IF
 13587        IF WS-ERROR = ER-2661
 13588           PERFORM 9900-ERROR-FORMAT
 13589                                 THRU 9900-EXIT
 13590        END-IF
 13591     END-IF
 13592*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13593*       MOVE ER-2661             TO WS-ERROR
 13594*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13595
 13596     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13597        MOVE ER-2662             TO WS-ERROR
 13598        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13599
 13600     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13601        MOVE ER-2677             TO WS-ERROR
 13602        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13603
 13604     IF CP-ERROR-LOAN-TERM
 13605        MOVE ER-2648             TO WS-ERROR
 13606        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13607
 13608 3221-CHECK-ERROR-RATE-OPEN.
 13609
 13610     IF CP-ERROR-RATE-FILE-NOTOPEN
 13611         GO TO 3990-FILES-NOT-OPEN.
 13612
 13613     IF PB-COMPANY-ID NOT = 'DMD'
 13614        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13615     END-IF
 13616     .
 13617 3221-CONTINUE.
 13618     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13619                                    WS-DCC-AH-RATE
 13620     IF PB-COMPANY-ID = 'DCC'
 13621        IF WS-LF-BEN-CATEGORY = 'D'
 13622           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13623              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13624        END-IF
 13625     END-IF
 13626     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13627*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 247
* EL050.cbl
 13628     IF (PB-COMPANY-ID = 'CID')
 13629        AND (WS-LF-EARNINGS-CALC = 'B')
 13630        AND (CP-STATE-STD-ABBRV = 'MN')
 13631        AND (PB-CERT-EFF-DT > X'A4FF')
 13632        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13633     END-IF
 13634     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13635
 13636     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13637     IF (PB-COMPANY-ID = 'DCC')
 13638        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13639        AND (PB-I-POLICY-IS-MONTHLY)
 13640        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13641        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13642     END-IF
 13643     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13644     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13645     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13646     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13647     IF (PB-COMPANY-ID = 'DCC')
 13648        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13649        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13650        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13651        MOVE ER-2786             TO WS-ERROR
 13652        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13653     END-IF
 13654
 13655     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13656
 13657******************************************************************
 13658*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13659******************************************************************
 13660     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13661        and ((not pb-monthly-cert)
 13662        or (ws-lf-ben-category = 'C'))
 13663        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13664
 13665     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13666        GO TO 3225-CHECK-ALT-LIFE-RATE
 13667     ELSE
 13668       IF PB-I-LF-RATE = ZERO
 13669          MOVE ER-2641          TO WS-ERROR
 13670          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13671
 13672 3225-CHECK-ALT-LIFE-RATE.
 13673
 13674     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13675        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13676        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13677         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13678
 13679     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13680         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13681             AND PB-COMPANY-ID NOT = 'DCC')
 13682                   OR
 13683              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13684              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13685              AND PB-COMPANY-ID NOT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 248
* EL050.cbl
 13686             MOVE ER-2720        TO  WS-ERROR
 13687             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13688             GO TO 3225-RATING-CONT
 13689         ELSE
 13690             GO TO 3225-RATING-CONT.
 13691     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13692        AND (AM-GPCD = 01 OR 06 OR 15)
 13693        MOVE ER-2798             TO WS-ERROR
 13694        PERFORM 9900-ERROR-FORMAT
 13695                                 THRU 9900-EXIT
 13696*       GO TO 3225-RATING-CONT
 13697     END-IF
 13698     if (pb-company-id = 'CID')
 13699        and (ws-lf-earnings-calc = 'B')
 13700        and (ws-lf-ben-category = 'P' or 'I')
 13701        and (ws-net-only-state = 'Y')
 13702        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13703        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13704        go to 3225-rating-cont
 13705     end-if
 13706     IF (PB-COMPANY-ID = 'CID')
 13707        AND (WS-LF-EARNINGS-CALC = 'B')
 13708        AND (CP-STATE-STD-ABBRV = 'MN')
 13709        AND (PB-CERT-EFF-DT > X'A4FF')
 13710        GO TO 3225-RATING-CONT
 13711     END-IF
 13712     IF PB-COMPANY-ID = 'DCC'
 13713        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13714           AND (PB-I-POLICY-IS-MONTHLY)
 13715           GO TO 3225-RATING-CONT
 13716        END-IF
 13717     END-IF
 13718
 13719     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13720        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13721        CP-EARN-AS-REG-BALLOON
 13722        NEXT SENTENCE
 13723     ELSE
 13724        MOVE '2'                 TO CP-EARNING-METHOD.
 13725
 13726 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13727
 13728     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13729
 13730     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13731        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13732        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13733         NEXT SENTENCE
 13734     ELSE
 13735         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13736
 13737     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13738     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13739     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13740                                     CP-RATING-BENEFIT-AMT.
 13741     IF CP-STATE-STD-ABBRV = 'OR'
 13742         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13743                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 249
* EL050.cbl
 13744     IF PB-COMPANY-ID = 'DCC'
 13745        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13746     END-IF
 13747     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13748     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13749     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13750                                    CP-REMAINING-TERM
 13751                                    CP-LOAN-TERM.
 13752     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13753        ADD +1                   TO CP-ORIGINAL-TERM
 13754                                    CP-REMAINING-TERM
 13755                                    CP-LOAN-TERM.
 13756
 13757     MOVE 'R'                   TO CP-RATE-FILE.
 13758     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13759
 13760     IF CP-ERROR-RATE-NOT-FOUND
 13761         MOVE ER-2641            TO WS-ERROR
 13762         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13763         GO TO 3300-CHECK-AH-RATES.
 13764
 13765     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13766     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13767
 13768     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13769         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13770
 13771     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13772                               + PB-I-LF-ALT-BENEFIT-AMT.
 13773
 13774     IF ACCOUNT-LIFE-CHECKED  OR
 13775        PB-POLICY-IS-VOIDED   OR
 13776        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13777        and (not pb-monthly-cert))
 13778        GO TO 3225-CONTINUE.
 13779
 13780     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13781        GO TO 3225-CONTINUE.
 13782
 13783     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13784                             EC-RT-LF-MAX-TOT-BEN
 13785        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13786        MOVE ER-2639       TO WS-ERROR
 13787        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13788
 13789 3225-CONTINUE.
 13790     IF PB-I-LF-ALT-RATE = ZERO
 13791         MOVE ER-2659            TO WS-ERROR
 13792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13793
 13794     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13795        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13796        MOVE ER-2698             TO WS-ERROR
 13797        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13798
 13799 3225-RATING-CONT.
 13800
 13801     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 250
* EL050.cbl
 13802        and (not pb-monthly-cert)
 13803         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13804         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13805         IF (PB-COMPANY-ID = 'DCC')
 13806            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13807            CONTINUE
 13808         ELSE
 13809            MOVE ER-2687         TO WS-ERROR
 13810            PERFORM 9900-ERROR-FORMAT
 13811                                 THRU 9900-EXIT
 13812         END-IF
 13813         GO TO 3290-EDIT-LF-REIN-RATE
 13814     END-IF
 13815
 13816* DMD RATING TEST
 13817     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13818         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13819         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13820         MOVE ER-2687                 TO WS-ERROR
 13821         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13822         GO TO 3290-EDIT-LF-REIN-RATE.
 13823
 13824 3230-CLIENT-MORT-CD-SPECIALS.
 13825
 13826     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13827     SET BIN-TO-GREG          TO TRUE.
 13828*    MOVE ' '                 TO DC-OPTION-CODE.
 13829     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13830     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13831
 13832 C-POS-3230-MORT-CD.
 13833     IF PB-COMPANY-ID = 'POS' AND
 13834        PB-SV-CARRIER = '2'
 13835         NEXT SENTENCE
 13836     ELSE
 13837         GO TO C-POS-3240-MORT-CD.
 13838
 13839     IF PB-SV-GROUPING = '030'
 13840        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13841         MOVE '2350' TO PB-I-MORT-CODE
 13842      ELSE
 13843         MOVE '3300' TO PB-I-MORT-CODE.
 13844
 13845
 13846 C-POS-3240-MORT-CD.
 13847     IF PB-COMPANY-ID = 'POS' AND
 13848        PB-SV-CARRIER = '1'
 13849         NEXT SENTENCE
 13850     ELSE
 13851         GO TO 3230-CONTINUE.
 13852
 13853     IF PB-SV-STATE = '45' OR '47'
 13854        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13855         MOVE '5200' TO PB-I-MORT-CODE
 13856     ELSE
 13857         MOVE '8300' TO PB-I-MORT-CODE.
 13858
 13859 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 251
* EL050.cbl
 13860
 13861     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13862        GO TO 3240-CONTINUE
 13863     END-IF
 13864
 13865     IF PB-CERT-EFF-DT > WS-971231
 13866        GO TO 3240-CONTINUE
 13867     END-IF
 13868
 13869     IF LF-BENEFIT-FOUND AND
 13870        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13871         MOVE 'F250'       TO PB-I-MORT-CODE
 13872     ELSE
 13873         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13874             MOVE '7250'   TO PB-I-MORT-CODE
 13875         ELSE
 13876             MOVE '4251'   TO PB-I-MORT-CODE
 13877         END-IF
 13878     END-IF
 13879
 13880     .
 13881 3240-CONTINUE.
 13882
 13883     IF PB-COMPANY-ID NOT = 'GNL'
 13884         GO TO 3256-CONTINUE.
 13885
 13886     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13887         MOVE 'A300' TO PB-I-MORT-CODE
 13888     ELSE
 13889         MOVE '8350' TO PB-I-MORT-CODE.
 13890
 13891 3256-CONTINUE.
 13892     IF PB-COMPANY-ID NOT = 'ABL'
 13893         GO TO 3260-EDIT-CONTINUE.
 13894
 13895     IF PB-I-LF-TERM GREATER THAN 59
 13896         MOVE 'F550' TO PB-I-MORT-CODE
 13897     ELSE
 13898         MOVE 'E550' TO PB-I-MORT-CODE.
 13899
 13900 3260-EDIT-CONTINUE.
 13901     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13902
 13903 3290-EDIT-LF-REIN-RATE.
 13904     IF LF-REIN-NSP-NOT-USED
 13905         GO TO 3290-RATING-CONT.
 13906
 13907     IF PB-COMPANY-ID = 'DCC'
 13908        GO TO 3290-RATING-CONT.
 13909     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13910     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13911     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13912     MOVE '3'                   TO CP-PROCESS-TYPE.
 13913     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13914
 13915******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13916     IF PB-COMPANY-ID EQUAL 'CDL'
 13917         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 252
* EL050.cbl
 13918            CP-EARN-AS-NET-PAY)
 13919             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13920*            MOVE SPACE          TO DC-OPTION-CODE
 13921             SET BIN-TO-GREG     TO TRUE
 13922             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13923***  Y2K PROJ 7744
 13924             IF DC-GREG-DATE-CYMD GREATER 19931231
 13925                 MOVE '1'        TO CP-EARNING-METHOD.
 13926***  Y2K PROJ 7744
 13927*******
 13928
 13929     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13930     MOVE PB-SV-STATE           TO CP-STATE.
 13931     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13932     MOVE ZERO                  TO CP-DEVIATION-CODE
 13933                                   CP-RATE-DEV-PCT.
 13934     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13935     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13936                                   CP-RATING-BENEFIT-AMT.
 13937
 13938************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13939     IF PB-COMPANY-ID EQUAL 'NCB'
 13940         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13941            CP-EARN-AS-NET-PAY
 13942             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13943                 PB-I-LF-PREMIUM-AMT.
 13944************
 13945
 13946     IF CP-STATE-STD-ABBRV = 'OR'
 13947         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13948                                         PB-I-LF-ALT-BENEFIT-AMT.
 13949     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13950     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13951     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13952     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13953     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13954     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13955     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13956     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13957                                   CP-REMAINING-TERM
 13958                                   CP-LOAN-TERM.
 13959     IF CP-TRUNCATED-LIFE
 13960        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13961
 13962     IF CP-TERM-IS-DAYS
 13963         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13964     ELSE
 13965         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13966
 13967     IF PB-COMPANY-ID = 'DCC'
 13968        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13969     END-IF
 13970     IF PB-COMPANY-ID NOT = 'TIC'
 13971          MOVE ZERO          TO CP-CLASS-CODE.
 13972
 13973     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13974
 13975     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 253
* EL050.cbl
 13976     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13977
 13978     IF CP-ERROR-RATE-NOT-FOUND
 13979        IF PB-I-OB
 13980           MOVE ER-2625      TO WS-ERROR
 13981           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13982           GO TO 3299-EDIT-CONTINUE
 13983        ELSE
 13984           MOVE ER-2643      TO WS-ERROR
 13985           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13986           GO TO 3299-EDIT-CONTINUE.
 13987
 13988     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13989
 13990     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13991     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 13992
 13993     IF PB-I-LF-REI-RATE = ZERO
 13994         MOVE ER-2643        TO WS-ERROR
 13995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13996
 13997 3290-CHECK-ALT-REIN-RATE.
 13998
 13999     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14000        GO TO 3290-RATING-CONT.
 14001
 14002     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14003     MOVE '2'                    TO CP-EARNING-METHOD.
 14004     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14005     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14006     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14007     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14008                                     CP-RATING-BENEFIT-AMT.
 14009     IF CP-STATE-STD-ABBRV = 'OR'
 14010         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14011                                         PB-I-LF-ALT-BENEFIT-AMT.
 14012     IF PB-COMPANY-ID = 'DCC'
 14013        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14014     END-IF
 14015     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14016     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14017     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14018                                    CP-REMAINING-TERM
 14019                                    CP-LOAN-TERM.
 14020     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14021        ADD +1                   TO CP-ORIGINAL-TERM
 14022                                    CP-REMAINING-TERM
 14023                                    CP-LOAN-TERM.
 14024
 14025     MOVE 'R'                   TO CP-RATE-FILE.
 14026     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14027
 14028     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14029
 14030     IF PB-I-LF-ALT-REI-RATE = ZERO
 14031         MOVE ER-2643            TO WS-ERROR
 14032         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14033
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 254
* EL050.cbl
 14034 3290-RATING-CONT.
 14035
 14036     IF PB-I-OB
 14037*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14038        GO TO 3300-CHECK-AH-RATES.
 14039
 14040 3299-EDIT-CONTINUE.
 14041
 14042     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14043         NEXT SENTENCE
 14044     ELSE
 14045         MOVE ER-2620           TO WS-ERROR
 14046         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14047
 14048 3300-CHECK-AH-RATES.
 14049     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14050         NEXT SENTENCE
 14051     ELSE
 14052         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14053
 14054     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14055        and (not pb-monthly-cert))
 14056                  or
 14057        ((CF-COMPANY-ID = 'DMD') AND
 14058                (NO-DMD-RATING))
 14059         IF (PB-COMPANY-ID = 'DCC')
 14060            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14061            CONTINUE
 14062         ELSE
 14063            MOVE ER-2687         TO WS-ERROR
 14064            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14065         END-IF
 14066         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14067         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14068     END-IF
 14069
 14070     IF PB-I-OB
 14071        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14072
 14073     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14074         MOVE ER-2687             TO WS-ERROR
 14075         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14076         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14077         GO TO 3999-END-EDIT.
 14078
 14079*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14080     if pb-company-id = 'AHL'
 14081        go to 3300-skip-crit-per
 14082     end-if
 14083     if (pb-i-ah-crit-per not = zeros)
 14084        and (ws-ah-special-calc-cd not = 'C')
 14085        MOVE ER-1572             TO WS-ERROR
 14086        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14087        go to 3300-skip-crit-per
 14088     END-IF
 14089     if (pb-company-id = 'DCC')
 14090        and (am-dcc-product-code not = spaces)
 14091        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 255
* EL050.cbl
 14092     end-if
 14093     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14094        IF PB-I-AH-CRIT-PER = ZERO
 14095           move ws-ah-max-bens   to pb-i-ah-crit-per
 14096*          MOVE ER-2618       TO WS-ERROR
 14097*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14098*          GO TO 3999-END-EDIT
 14099        END-IF
 14100     END-IF
 14101     if (ws-ah-special-calc-cd = 'C')
 14102        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14103        MOVE ER-1576             TO WS-ERROR
 14104        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14105     end-if
 14106
 14107     .
 14108 3300-skip-crit-per.
 14109     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14110     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14111     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14112     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14113     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14114     MOVE PB-SV-STATE            TO CP-STATE.
 14115     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14116     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14117     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14118*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14119     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14120     MOVE '3'                    TO CP-PROCESS-TYPE.
 14121     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14122     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14123                                    CP-RATING-BENEFIT-AMT.
 14124     IF PB-COMPANY-ID = 'CID'
 14125               OR
 14126        CP-STATE-STD-ABBRV = 'OR'
 14127         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14128                                         PB-I-AH-TERM.
 14129     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14130        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14131           AND (PB-I-POLICY-IS-MONTHLY)
 14132           MOVE PB-I-LF-BENEFIT-AMT
 14133                                 TO CP-NET-BENEFIT-AMT
 14134           move pb-i-ah-premium-amt to cp-original-premium
 14135           add pb-i-lf-premium-amt to cp-original-premium
 14136        END-IF
 14137     END-IF
 14138     MOVE SPACES                 TO CP-BEN-CATEGORY
 14139     IF PB-COMPANY-ID = 'DCC'
 14140        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14141        EVALUATE TRUE
 14142           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14143              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14144              MOVE PB-I-LF-BENEFIT-AMT
 14145                                 TO CP-RATING-BENEFIT-AMT
 14146              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14147           WHEN WS-AH-BEN-CATEGORY = 'G'
 14148              MOVE PB-I-UNPAID-CASH-PRICE
 14149                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 256
* EL050.cbl
 14150           WHEN WS-AH-BEN-CATEGORY = 'D'
 14151              MOVE WS-AH-PMF-COMM
 14152                                 TO CP-DCC-PMF-COMM
 14153              MOVE PB-I-AH-COMMISSION
 14154                                 TO CP-DCC-ACT-COMM
 14155        END-EVALUATE
 14156     END-IF
 14157     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14158     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14159     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14160     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14161     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14162     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14163     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14164                                    CP-REMAINING-TERM
 14165                                    WS-WORK-TERM.
 14166     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14167
 14168     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14169     SET BIN-TO-GREG             TO TRUE.
 14170*    MOVE ' '                    TO DC-OPTION-CODE.
 14171     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14172     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14173
 14174     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14175     IF NOT VALID-SKIP-CODE
 14176         MOVE ER-2683            TO WS-ERROR
 14177         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14178         GO TO 3320-RATE-CONTINUE.
 14179
 14180     IF PB-NO-MONTHS-SKIPPED
 14181         GO TO 3320-RATE-CONTINUE.
 14182
 14183     MOVE SPACE TO NUMBER-OF-MONTHS.
 14184
 14185     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14186         MOVE 'S'                TO SK-MO (6).
 14187     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14188         MOVE 'S'                TO SK-MO (7).
 14189     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14190         MOVE 'S'                TO SK-MO (8).
 14191     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14192         MOVE 'S'                TO SK-MO (9).
 14193     IF PB-I-SKIP-CODE = 'A'
 14194         MOVE 'S'                TO SK-MO (10).
 14195
 14196     MOVE 1                      TO SUB2.
 14197     MOVE PB-I-AH-TERM           TO SUB3.
 14198     MOVE WS-MONTH               TO SUB1.
 14199     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14200     GO TO 3320-RATE-CONTINUE.
 14201
 14202 3310-GET-SKIP-MO.
 14203     IF SUB1 = 13
 14204         MOVE 1                  TO SUB1.
 14205
 14206     IF SK-MO (SUB1) = 'S'
 14207         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 257
* EL050.cbl
 14208
 14209     ADD 1 TO SUB2
 14210              SUB1.
 14211
 14212 3320-RATE-CONTINUE.
 14213
 14214     IF WS-WORK-TERM = ZERO
 14215         MOVE 1                  TO WS-WORK-TERM.
 14216
 14217     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14218                                    CP-LOAN-TERM.
 14219
 14220     IF PB-COMPANY-ID EQUAL 'DMD'
 14221         NEXT SENTENCE
 14222     ELSE
 14223         MOVE ZERO               TO PB-I-AH-RATE
 14224                                    PB-I-AH-REI-RATE.
 14225
 14226
 14227     IF PB-COMPANY-ID EQUAL 'CRI'
 14228        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14229
 14230     IF PB-COMPANY-ID = 'CSL'
 14231         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14232         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14233         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14234         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14235
 14236     IF PB-COMPANY-ID = 'DCC'
 14237        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14238           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14239              PB-I-RATE-DEV-PCT-LF
 14240        END-IF
 14241        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14242                                 TO CP-ALTERNATE-BENEFIT
 14243        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14244        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14245        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14246     END-IF
 14247     IF (PB-COMPANY-ID = 'CID')
 14248        AND (WS-LF-EARNINGS-CALC = 'B')
 14249        AND (CP-STATE-STD-ABBRV = 'MN')
 14250        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14251     ELSE
 14252        MOVE ' '                 TO CP-AH-BALLOON-SW
 14253     END-IF
 14254     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14255     MOVE 'R'                   TO CP-RATE-FILE.
 14256     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14257
 14258     IF (CP-ERROR-RATE-NOT-FOUND)
 14259        and (not pb-monthly-cert)
 14260        IF PB-I-OB
 14261           MOVE ER-2624          TO WS-ERROR
 14262           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14263           GO TO 3340-CALCULATE-PREMIUM-AMT
 14264        ELSE
 14265          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 258
* EL050.cbl
 14266              NEXT SENTENCE
 14267          ELSE
 14268           MOVE ER-2642          TO WS-ERROR
 14269           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14270           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14271
 14272     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14273        CP-ERROR-DIV-BY-ZERO
 14274           MOVE ER-3782          TO WS-ERROR
 14275           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14276
 14277     IF PB-COMPANY-ID EQUAL 'CRI'
 14278        IF CP-ERROR-NO-LIMITS-CRI
 14279           IF NOT ACCOUNT-AH-CHECKED
 14280              MOVE ER-2607          TO WS-ERROR
 14281              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14282
 14283     IF ACCOUNT-AH-CHECKED
 14284        NEXT SENTENCE
 14285     ELSE
 14286       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14287          MOVE ER-2640           TO WS-ERROR
 14288          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14289
 14290     IF PB-COMPANY-ID = 'CRI'
 14291         IF WS-ERROR = ER-2640
 14292             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14293     IF ACCOUNT-AH-CHECKED
 14294        CONTINUE
 14295     ELSE
 14296        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14297           AND (CP-R-MAX-ATT-AGE > +0)
 14298           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14299           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14300              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14301              MOVE PB-I-AH-EXPIRE-DT
 14302                                 TO DC-BIN-DATE-2
 14303              MOVE '1'           TO DC-OPTION-CODE
 14304              PERFORM 8500-DATE-CONVERT
 14305                                 THRU 8500-EXIT
 14306              IF NO-CONVERSION-ERROR
 14307                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14308                    MOVE ER-2661       TO WS-ERROR
 14309*                   PERFORM 9900-ERROR-FORMAT
 14310*                                THRU 9900-EXIT
 14311                 END-IF
 14312              END-IF
 14313           ELSE
 14314              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14315              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14316                 MOVE ER-2661    TO WS-ERROR
 14317*                PERFORM 9900-ERROR-FORMAT
 14318*                                THRU 9900-EXIT
 14319              ELSE
 14320                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14321                    MOVE ER-1570 TO WS-ERROR
 14322                    PERFORM 9900-ERROR-FORMAT
 14323                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 259
* EL050.cbl
 14324                 END-IF
 14325              END-IF
 14326           END-IF
 14327           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14328              MOVE PB-I-JOINT-BIRTHDAY
 14329                                    TO DC-BIN-DATE-1
 14330              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14331              MOVE '1'              TO DC-OPTION-CODE
 14332              PERFORM 8500-DATE-CONVERT
 14333                                    THRU 8500-EXIT
 14334              IF NO-CONVERSION-ERROR
 14335                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14336                    MOVE ER-2661       TO WS-ERROR
 14337*                   PERFORM 9900-ERROR-FORMAT
 14338*                                   THRU 9900-EXIT
 14339                 END-IF
 14340              END-IF
 14341           ELSE
 14342              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14343                (PB-I-AH-TERM / 12)
 14344              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14345                 MOVE ER-2661       TO WS-ERROR
 14346*                PERFORM 9900-ERROR-FORMAT
 14347*                                   THRU 9900-EXIT
 14348              ELSE
 14349                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14350                    MOVE ER-1571 TO WS-ERROR
 14351                    PERFORM 9900-ERROR-FORMAT
 14352                                 THRU 9900-EXIT
 14353                 END-IF
 14354              END-IF
 14355           END-IF
 14356           IF WS-ERROR = ER-2661
 14357              PERFORM 9900-ERROR-FORMAT
 14358                                    THRU 9900-EXIT
 14359           END-IF
 14360        END-IF
 14361     END-IF
 14362*    IF ACCOUNT-AH-CHECKED
 14363*       NEXT SENTENCE
 14364*    ELSE
 14365*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14366*          MOVE ER-2661          TO WS-ERROR
 14367*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14368
 14369     IF ACCOUNT-AH-CHECKED
 14370        NEXT SENTENCE
 14371     ELSE
 14372        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14373           MOVE ER-2663          TO WS-ERROR
 14374           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14375
 14376     IF ACCOUNT-AH-CHECKED OR
 14377        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14378         PB-POLICY-IS-VOIDED
 14379        NEXT SENTENCE
 14380     ELSE
 14381        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 260
* EL050.cbl
 14382           MOVE ER-2667            TO WS-ERROR
 14383           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14384
 14385     IF PB-COMPANY-ID = 'CRI'
 14386         IF WS-ERROR = ER-2667
 14387             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14388
 14389     IF ACCOUNT-AH-CHECKED
 14390        NEXT SENTENCE
 14391     ELSE
 14392        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14393           MOVE ER-2678            TO WS-ERROR
 14394           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14395
 14396     IF CP-ERROR-RATE-FILE-NOTOPEN
 14397         GO TO 3990-FILES-NOT-OPEN.
 14398
 14399 3321-CONTINUE.
 14400     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14401     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14402     IF (PB-COMPANY-ID = 'DCC')
 14403        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14404        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14405                                    PB-I-LF-ALT-PREM-CALC
 14406        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14407        IF WS-AH-BEN-CATEGORY = 'G'
 14408           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14409           + PB-I-ADDL-CLP)
 14410           * (1 + WS-TOL-CLP-PCT)
 14411*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14412        ELSE
 14413           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14414           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14415*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14416        END-IF
 14417        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14418                                 TO PB-I-AH-PREM-CALC
 14419        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14420           MOVE ER-8152          TO WS-ERROR
 14421           PERFORM 9900-ERROR-FORMAT
 14422                                 THRU 9900-EXIT
 14423        ELSE
 14424           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14425                 PB-I-ADDL-CLP)
 14426              MOVE ER-8148       TO WS-ERROR
 14427              PERFORM 9900-ERROR-FORMAT
 14428                                 THRU 9900-EXIT
 14429           END-IF
 14430        END-IF
 14431     END-IF
 14432     IF (PB-COMPANY-ID = 'DCC')
 14433        AND (PB-I-POLICY-IS-MONTHLY)
 14434        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14435        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14436        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14437           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14438        END-IF
 14439     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 261
* EL050.cbl
 14440     IF (PB-COMPANY-ID = 'DCC')
 14441        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14442        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14443        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14444        MOVE ER-2786             TO WS-ERROR
 14445        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14446     END-IF
 14447     MOVE +0                     TO PB-I-AH-CLP
 14448     IF PB-COMPANY-ID = 'DCC'
 14449        evaluate true
 14450           when WS-AH-BEN-CATEGORY = 'D'
 14451              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14452                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14453           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14454              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14455           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14456              compute ws-cred-union-fees rounded =
 14457                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14458                    pb-i-ah-commission)
 14459              COMPUTE PB-I-AH-CLP =
 14460                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14461        end-evaluate
 14462     END-IF
 14463     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14464
 14465     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14466         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14467
 14468     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14469         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14470
 14471     if (ws-ah-special-calc-cd = 'E')
 14472        and (pb-monthly-cert)
 14473        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14474     end-if
 14475     IF PB-COMPANY-ID = 'CRI'
 14476         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14477            PB-I-PAYMENT-AMOUNT = ZERO
 14478             NEXT SENTENCE
 14479         ELSE
 14480             COMPUTE PB-I-AH-PREM-CALC =
 14481                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14482                 (CP-PREMIUM-RATE / 100)
 14483             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14484                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14485                                             PB-I-RATE-DEV-PCT-AH.
 14486
 14487     IF (PB-I-AH-RATE  = ZERO)
 14488        and (not pb-monthly-cert)
 14489       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14490           NEXT SENTENCE
 14491       ELSE
 14492         MOVE ER-2642            TO WS-ERROR
 14493         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14494
 14495     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14496     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14497     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 262
* EL050.cbl
 14498     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14499     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14500     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14501
 14502     IF (PB-COMPANY-ID = 'DCC')
 14503        AND (WS-AH-BEN-CATEGORY = 'G')
 14504        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14505        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14506        IF CP-DEVIATION-CODE NOT = '000'
 14507           MOVE '000'            TO CP-DEVIATION-CODE
 14508           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14509           IF NO-CP-ERROR
 14510              COMPUTE PB-I-DDF-IU-RATE-UP =
 14511              PB-I-AH-CLP - CP-CALC-PREMIUM
 14512           ELSE
 14513              MOVE ER-3057        TO WS-ERROR
 14514              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14515           END-IF
 14516        END-IF
 14517     END-IF
 14518     .
 14519 3335-EDIT-AH-REIN-NSP-RATE.
 14520     IF PB-COMPANY-ID = 'DCC'
 14521        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14522              compute ws-cred-union-fees rounded =
 14523                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14524                    pb-i-ah-commission)
 14525              COMPUTE PB-I-AH-CLP =
 14526                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14527        end-if
 14528     END-IF
 14529     IF AH-REIN-NSP-NOT-USED
 14530         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14531
 14532     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14533     IF PB-COMPANY-ID = 'DCC'
 14534         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14535     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14536     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14537     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14538     MOVE PB-SV-STATE            TO CP-STATE.
 14539     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14540     MOVE ZERO                   TO CP-DEVIATION-CODE
 14541                                    CP-RATE-DEV-PCT.
 14542*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14543     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14544     MOVE '3'                    TO CP-PROCESS-TYPE.
 14545     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14546     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14547                                    CP-RATING-BENEFIT-AMT.
 14548     IF CP-STATE-STD-ABBRV = 'OR'
 14549         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14550                                         PB-I-AH-TERM.
 14551     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14552     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14553     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14554     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14555     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 263
* EL050.cbl
 14556     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14557                                    CP-REMAINING-TERM
 14558                                    WS-WORK-TERM.
 14559     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14560     IF PB-COMPANY-ID = 'DCC'
 14561        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14562     END-IF
 14563     IF  PB-COMPANY-ID = 'TIC'
 14564         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14565            MOVE ZERO TO CP-CLASS-CODE.
 14566
 14567     IF PB-COMPANY-ID NOT = 'TIC'
 14568          MOVE ZERO          TO CP-CLASS-CODE.
 14569
 14570     MOVE ZERO               TO CP-DEVIATION-CODE.
 14571
 14572     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14573
 14574     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14575
 14576     MOVE 'R'                   TO CP-RATE-FILE.
 14577     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14578
 14579     IF CP-ERROR-RATE-NOT-FOUND
 14580         MOVE ER-2645        TO WS-ERROR
 14581         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14582         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14583
 14584     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14585
 14586     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14587     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14588
 14589     IF PB-I-AH-REI-RATE = ZERO
 14590         MOVE ER-2645        TO WS-ERROR
 14591         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14592
 14593
 14594 3340-CALCULATE-PREMIUM-AMT.
 14595
 14596     IF PB-COMPANY-ID = 'NCL'
 14597         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14598             WS-AH-SPECIAL-CALC-CD = 'O')
 14599             GO TO 3999-END-EDIT.
 14600
 14601     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14602                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14603                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14604                         OR 'AHL'
 14605         NEXT SENTENCE
 14606     ELSE
 14607         IF WS-STATE-ABBREVIATION = 'CT'
 14608             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14609                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14610                 COMPUTE PB-I-LF-PREM-CALC =
 14611                                     PB-I-LF-PREM-CALC * .90
 14612                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14613                                     PB-I-LF-ALT-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 264
* EL050.cbl
 14614                 COMPUTE PB-I-AH-PREM-CALC =
 14615                                     PB-I-AH-PREM-CALC * .90.
 14616
 14617     IF PB-COMP-LF-PREM
 14618        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14619        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14620
 14621     IF PB-COMP-AH-PREM
 14622        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14623
 14624 3340-CHECK-DCC-TOT-FEES.
 14625     IF (PB-COMPANY-ID = 'DCC')
 14626        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14627        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14628        AND (PB-I-POLICY-IS-MONTHLY)
 14629        CONTINUE
 14630     ELSE
 14631        GO TO 3340-EDIT-LF-AH-TOL
 14632     END-IF
 14633     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14634     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14635     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14636        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14637           PB-I-RATE-DEV-PCT-LF
 14638     END-IF
 14639     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14640        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14641           PB-I-RATE-DEV-PCT-AH
 14642     END-IF
 14643     MOVE 'N'                    TO CP-BEN-CATEGORY
 14644     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14645
 14646     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14647     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14648     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14649     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14650     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14651     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14652     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14653     MOVE '3'                    TO CP-PROCESS-TYPE.
 14654     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14655     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14656
 14657     MOVE PB-SV-STATE            TO CP-STATE.
 14658     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14659     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14660     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14661     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14662     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14663                                    CP-RATING-BENEFIT-AMT.
 14664     IF CP-STATE-STD-ABBRV = 'OR'
 14665         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14666                                         PB-I-LF-ALT-BENEFIT-AMT.
 14667     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14668     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14669     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14670     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14671     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 265
* EL050.cbl
 14672     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14673     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14674     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14675     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14676                                    CP-REMAINING-TERM
 14677                                    CP-LOAN-TERM.
 14678     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14679        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14680           PB-I-LF-PREMIUM-AMT
 14681     end-if
 14682
 14683     IF CP-TRUNCATED-LIFE
 14684        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14685
 14686     IF CP-TERM-IS-DAYS
 14687         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14688     ELSE
 14689         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14690
 14691     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14692     IF CP-SPECIAL-CALC-CD = 'H'
 14693         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14694                                    TO CP-ALTERNATE-BENEFIT
 14695         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14696     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14697     MOVE 'R'                    TO CP-RATE-FILE
 14698     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14699     IF NOT CP-ERROR-RATE-NOT-FOUND
 14700        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14701        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14702           AND (CP-BENEFIT-CD (1:1) = 'S')
 14703           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14704                                    PB-I-LF-PREMIUM-AMT
 14705        END-IF
 14706     ELSE
 14707        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14708     END-IF
 14709     .
 14710 3340-EDIT-LF-AH-TOL.
 14711
 14712***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14713***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14714***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14715***
 14716     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14717         PB-I-AH-PREMIUM-AMT
 14718          GIVING WS-CALC-WORK.
 14719
 14720     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14721        AND WS-CALC-WORK NOT = ZERO
 14722         MOVE ER-2649            TO WS-ERROR
 14723         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14724
 14725     SUBTRACT PB-I-LF-PREM-CALC
 14726             FROM PB-I-LF-PREMIUM-AMT
 14727                 GIVING WS-UNSIGN-WRK1.
 14728
 14729     SUBTRACT PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 266
* EL050.cbl
 14730             FROM PB-I-LF-ALT-PREMIUM-AMT
 14731                 GIVING WS-UNSIGN-WRK4.
 14732
 14733     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14734                                + WS-UNSIGN-WRK4.
 14735
 14736     SUBTRACT PB-I-AH-PREM-CALC
 14737             FROM PB-I-AH-PREMIUM-AMT
 14738                 GIVING WS-UNSIGN-WRK2.
 14739
 14740******************************************************************
 14741*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14742******************************************************************
 14743
 14744     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14745         MOVE ZERO TO WS-UNSIGN-WRK1.
 14746
 14747     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14748         MOVE ZERO TO WS-UNSIGN-WRK2.
 14749
 14750     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14751             GIVING WS-UNSIGN-WRK3.
 14752
 14753 3342-CONTINUE.
 14754
 14755     IF (PB-I-LF-RATE = ZERO  AND
 14756         PB-I-AH-RATE = ZERO)
 14757         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14758            WS-AH-SPECIAL-CALC-CD = 'O'
 14759              NEXT SENTENCE
 14760         ELSE
 14761             GO TO 3345-EDIT-CONTINUE.
 14762
 14763     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14764         NEXT SENTENCE
 14765     ELSE
 14766     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14767        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14768           IF (PB-REISSUED-CERT         OR
 14769               PB-POLICY-IS-DECLINED    OR
 14770               PB-POLICY-IS-VOIDED)
 14771              NEXT SENTENCE
 14772           ELSE
 14773              IF WS-PREM-REJECT-SW = SPACE
 14774                 MOVE ER-2652    TO WS-ERROR
 14775                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14776                 GO TO 3344-CHECK-AH
 14777              ELSE
 14778                 MOVE ER-2650    TO WS-ERROR
 14779                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14780                 GO TO 3344-CHECK-AH.
 14781
 14782***
 14783***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14784***
 14785
 14786     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14787         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 267
* EL050.cbl
 14788            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14789             (1 + WS-TOL-LF-PREM-PCT)
 14790         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14791            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14792             (1 - WS-TOL-LF-PREM-PCT)
 14793     ELSE
 14794         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14795         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14796
 14797***
 14798***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14799***
 14800
 14801     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14802         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14803          WS-TOL-LF-PREM.
 14804
 14805     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14806         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14807          WS-TOL-LF-PREM.
 14808
 14809     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14810        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14811
 14812     IF PB-REISSUED-CERT
 14813        or PB-POLICY-IS-DECLINED
 14814        or PB-POLICY-IS-VOIDED
 14815        continue
 14816     ELSE
 14817        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14818              > WS-TOL-LF-HIGH-PREM-AMT)
 14819           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14820              < WS-TOL-LF-LOW-PREM-AMT))
 14821                      or
 14822           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14823              > WS-TOL-LF-HIGH-PREM-PCT)
 14824           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14825              < WS-TOL-LF-LOW-PREM-PCT))
 14826           IF WS-PREM-REJECT-SW = SPACE
 14827              MOVE ER-2652       TO WS-ERROR
 14828              PERFORM 9900-ERROR-FORMAT
 14829                                 THRU 9900-EXIT
 14830           ELSE
 14831              MOVE ER-2650       TO WS-ERROR
 14832              PERFORM 9900-ERROR-FORMAT
 14833                                 THRU 9900-EXIT
 14834           end-if
 14835        end-if
 14836     end-if
 14837
 14838*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14839*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14840*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14841*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14842
 14843     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14844        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14845                      OR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 268
* EL050.cbl
 14846           ((PB-COMPANY-ID = 'DCC')
 14847           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14848           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14849           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14850        END-IF
 14851     END-IF
 14852
 14853     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14854        IF WS-COMP-MAX-CAP GREATER THAN +0
 14855           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14856              IF (PB-REISSUED-CERT         OR
 14857                  PB-POLICY-IS-DECLINED    OR
 14858                  PB-POLICY-IS-VOIDED)
 14859                 NEXT SENTENCE
 14860              ELSE
 14861                  MOVE ER-2646   TO  WS-ERROR
 14862                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14863
 14864 3344-CVL-TOLERANCE-CHECK.
 14865
 14866      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14867          GO TO 3344-CHECK-AH.
 14868
 14869      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14870          GO TO 3344-CHECK-AH.
 14871
 14872      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14873                                     WS-UNSIGN-WRK6.
 14874
 14875      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14876          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14877                                 + PB-I-LF-PREMIUM-AMT
 14878                                 - PB-I-LF-PREM-CALC.
 14879
 14880      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14881          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14882                                 + PB-I-LF-ALT-PREMIUM-AMT
 14883                                 - PB-I-LF-ALT-PREM-CALC.
 14884
 14885      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14886          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14887              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14888                 MOVE ER-2652    TO  WS-ERROR
 14889                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14890              ELSE
 14891                 MOVE ER-2650    TO  WS-ERROR
 14892                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14893
 14894      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14895          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14896              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14897                 MOVE ER-2652    TO  WS-ERROR
 14898                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14899              ELSE
 14900                 MOVE ER-2650    TO  WS-ERROR
 14901                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14902
 14903 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 269
* EL050.cbl
 14904
 14905****************************************************************
 14906***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14907***
 14908
 14909     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14910         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14911             (1 + WS-TOL-AH-PREM-PCT)
 14912         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14913             (1 - WS-TOL-AH-PREM-PCT)
 14914     ELSE
 14915         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14916         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14917
 14918***
 14919***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14920***
 14921
 14922     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14923         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14924
 14925     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14926         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14927
 14928     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14929        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14930
 14931     IF (PB-REISSUED-CERT)
 14932        OR (PB-POLICY-IS-DECLINED)
 14933        OR (PB-POLICY-IS-VOIDED)
 14934        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14935        CONTINUE
 14936     ELSE
 14937        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14938              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14939                          or
 14940           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14941              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14942           IF WS-PREM-REJECT-SW = SPACE
 14943              MOVE ER-3052       TO WS-ERROR
 14944              PERFORM 9900-ERROR-FORMAT
 14945                                 THRU 9900-EXIT
 14946           ELSE
 14947              MOVE ER-3050       TO WS-ERROR
 14948              PERFORM 9900-ERROR-FORMAT
 14949                                 THRU 9900-EXIT
 14950           END-IF
 14951        END-IF
 14952     END-IF
 14953     if (pb-company-id = 'DCC')
 14954        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14955        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14956        and (pb-i-policy-is-monthly)
 14957        compute ws-tol-ah-high-prem-amt =
 14958           pb-i-tot-fees-calc + ws-tol-ah-prem
 14959        compute ws-tol-ah-low-prem-amt =
 14960           pb-i-tot-fees-calc - ws-tol-ah-prem
 14961        if ws-tol-ah-prem-pct > zeros
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 270
* EL050.cbl
 14962           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14963              (1 + ws-tol-ah-prem-pct)
 14964           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14965              (1 - ws-tol-ah-prem-pct)
 14966        else
 14967           move +9999999.99      to ws-tol-ah-high-prem-pct
 14968           move +0               to ws-tol-ah-low-prem-pct
 14969        end-if
 14970        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14971            or
 14972           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14973                          or
 14974           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14975           or
 14976           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14977            move er-3049         to ws-error
 14978           perform 9900-error-format
 14979                                 thru 9900-exit
 14980
 14981        end-if
 14982     end-if
 14983     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14984         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14985             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14986             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14987
 14988     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14989        IF WS-COMP-MAX-CAP GREATER THAN +0
 14990           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14991              IF (PB-REISSUED-CERT         OR
 14992                  PB-POLICY-IS-DECLINED    OR
 14993                  PB-POLICY-IS-VOIDED)
 14994                 NEXT SENTENCE
 14995              ELSE
 14996                  MOVE ER-2646   TO  WS-ERROR
 14997                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14998
 14999     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15000        (WS-COMP-MAX-CAP EQUAL +0)
 15001           GO TO 3345-EDIT-CONTINUE.
 15002
 15003     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15004        GREATER THAN WS-COMP-MAX-CAP
 15005           MOVE ER-2646          TO  WS-ERROR
 15006           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15007
 15008 3345-EDIT-CONTINUE.
 15009
 15010*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15011*       IF PB-ENTRY-BATCH   NUMERIC
 15012*          IF PB-ISSUE
 15013*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15014*          ELSE
 15015*              IF PB-CANCELLATION
 15016*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15017
 15018*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15019*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 271
* EL050.cbl
 15020*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15021*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15022*        ELSE
 15023*            MOVE  ER-1909            TO  WS-ERROR
 15024*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15025
 15026     IF PB-I-POLICY-ACCEPTED
 15027        IF PB-POLICY-IS-DECLINED  OR
 15028           PB-REISSUED-CERT  OR
 15029           PB-REIN-ONLY-CERT  OR
 15030           PB-POLICY-IS-VOIDED
 15031            MOVE  ER-1891         TO  WS-ERROR
 15032            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15033        ELSE
 15034            MOVE SPACE            TO  PB-BATCH-ENTRY
 15035            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15036
 15037     IF PB-I-POLICY-DECLINED
 15038        IF PB-REISSUED-CERT  OR
 15039           PB-REIN-ONLY-CERT  OR
 15040           PB-POLICY-IS-VOIDED
 15041            MOVE  ER-1906         TO  WS-ERROR
 15042            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15043        ELSE
 15044            MOVE  'D'             TO  PB-BATCH-ENTRY
 15045                                      PB-I-ENTRY-STATUS.
 15046
 15047     IF PB-I-NEEDS-UNDERWRITING
 15048        IF PB-POLICY-IS-DECLINED OR
 15049           PB-REISSUED-CERT  OR
 15050           PB-REIN-ONLY-CERT  OR
 15051           PB-POLICY-IS-VOIDED
 15052            MOVE  ER-1907         TO  WS-ERROR
 15053            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15054        ELSE
 15055            MOVE 'U'              TO  PB-BATCH-ENTRY
 15056                                      PB-I-ENTRY-STATUS.
 15057
 15058     IF PB-NEEDS-UNDERWRITING
 15059        MOVE  ER-1901             TO  WS-ERROR
 15060        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15061     IF PB-COMPANY-ID = 'DCC'
 15062        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15063        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15064        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15065           AND (NOT WS-LF-CASH))
 15066                           OR
 15067           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15068           AND (NOT WS-AH-CASH)))
 15069                       AND
 15070           (PB-I-ENTRY-STATUS NOT = '5')
 15071           MOVE 'M'              TO PB-BATCH-ENTRY
 15072                                    PB-I-ENTRY-STATUS
 15073        END-IF
 15074     END-IF
 15075     move pending-business       to ws-passed-erpndb
 15076     move ' '                    to ws-exceed-limit-yn
 15077     perform 7780-call-agg       thru 7780-exit
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 272
* EL050.cbl
 15078     display ' el050 exceed ' ws-exceed-limit-yn
 15079     if ws-exceed-limit-yn = 'Y'
 15080        MOVE  ER-9813            TO WS-ERROR
 15081        PERFORM  9900-ERROR-FORMAT
 15082                                 THRU 9900-EXIT
 15083     end-if
 15084     IF  PB-COMPANY-ID NOT = 'NCL'
 15085         GO TO 3999-END-EDIT.
 15086
 15087     IF PB-REISSUED-CERT  OR
 15088        PB-POLICY-IS-DECLINED  OR
 15089        PB-POLICY-IS-VOIDED  OR
 15090        PB-I-OB
 15091         GO TO 3999-END-EDIT.
 15092
 15093     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15094         MOVE  ER-2644            TO  WS-ERROR
 15095         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15096         GO TO 3999-END-EDIT.
 15097
 15098     MOVE 'N'                     TO  FORM-MASTER-SW.
 15099     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15100
 15101     IF NOT FORM-MASTER-FOUND
 15102         GO TO 3999-END-EDIT.
 15103
 15104     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15105                                      FORM-MASTER-AH-SW.
 15106
 15107     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15108         MOVE  +1                 TO SUB6
 15109         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15110
 15111     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15112         MOVE  +1                 TO SUB6
 15113         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15114
 15115     IF LF-FORM-MASTER-FOUND  OR
 15116        AH-FORM-MASTER-FOUND
 15117         GO TO 3360-CHECK-FORM-LIMITS
 15118     ELSE
 15119         GO TO 3999-END-EDIT.
 15120
 15121******************************************************************
 15122*                  3350-GET-ERFORM                               *
 15123*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15124*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15125******************************************************************
 15126
 15127 3350-GET-ERFORM.
 15128
 15129     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15130         GO TO  3350-ERFORM-GETMAIN.
 15131
 15132     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15133     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15134     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15135     MOVE 'Y'                     TO FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 273
* EL050.cbl
 15136
 15137     IF PB-CANCELLATION
 15138         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15139            PB-SV-STATE          EQUAL   FO-STATE       AND
 15140            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15141              GO TO 3350-EXIT
 15142         ELSE
 15143             NEXT SENTENCE
 15144     ELSE
 15145         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15146            PB-SV-STATE          EQUAL   FO-STATE       AND
 15147            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15148              GO TO 3350-EXIT.
 15149
 15150 3350-ERFORM-GETMAIN.
 15151
 15152     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15153     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15154
 15155 3350-ERFORM-READ.
 15156
 15157     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15158     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15159     IF PB-CANCELLATION
 15160         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15161     ELSE
 15162         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15163     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15164
 15165     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15166
 15167     IF FORM-MASTER-FOUND
 15168       IF PB-CANCELLATION
 15169          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15170             PB-SV-STATE          EQUAL   FO-STATE       AND
 15171             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15172              GO  TO 3350-EXIT
 15173          ELSE
 15174              NEXT SENTENCE
 15175       ELSE
 15176          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15177             PB-SV-STATE          EQUAL   FO-STATE       AND
 15178             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15179              GO  TO 3350-EXIT.
 15180
 15181     MOVE  'N'                    TO  FORM-MASTER-SW.
 15182     MOVE  ER-1895                TO  WS-ERROR.
 15183     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15184
 15185 3350-EXIT.
 15186      EXIT.
 15187
 15188******************************************************************
 15189*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15190*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15191*   VALID FOR THE POLICY FORM USED.                              *
 15192******************************************************************
 15193
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 274
* EL050.cbl
 15194 3355-EDIT-FORM-LF-BENEFITS.
 15195
 15196     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15197        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15198         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15199         GO TO   3355-EXIT.
 15200
 15201     IF  SUB6    LESS THAN   +40
 15202         ADD  +1      TO  SUB6
 15203         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15204
 15205     MOVE  ER-1896         TO  WS-ERROR.
 15206     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15207
 15208 3355-EXIT.
 15209      EXIT.
 15210
 15211******************************************************************
 15212*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15213*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15214*   VALID FOR THE POLICY FORM USED.                              *
 15215******************************************************************
 15216
 15217 3356-EDIT-FORM-AH-BENEFITS.
 15218
 15219     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15220        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15221         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15222         GO TO  3356-EXIT.
 15223
 15224      IF  SUB6    LESS THAN     +40
 15225          ADD  +1      TO  SUB6
 15226          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15227
 15228     MOVE  ER-1897         TO  WS-ERROR.
 15229     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15230
 15231 3356-EXIT.
 15232      EXIT.
 15233
 15234******************************************************************
 15235*                  3357-BENEFIT-SEARCH                           *
 15236*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15237*   CANCELLATIONS ONLY.                                          *
 15238******************************************************************
 15239 3357-BENEFIT-SEARCH.
 15240     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15241         MOVE +1                          TO SUB6
 15242         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15243
 15244     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15245         MOVE +1                          TO SUB6
 15246         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15247
 15248 3357-EXIT.
 15249     EXIT.
 15250
 15251******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 275
* EL050.cbl
 15252*                  3358-BENEFIT-LIFE-SEARCH                      *
 15253*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15254*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15255*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15256******************************************************************
 15257 3358-BENEFIT-LIFE-SEARCH.
 15258     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15259       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15260         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15261           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15262              IF FO-PLAN-REFUND-METHOD (SUB6)
 15263                     IS GREATER THAN SPACES
 15264                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15265                                          WS-LF-REFUND-CALC
 15266                 GO TO 3358-EXIT.
 15267
 15268     IF SUB6 LESS THAN +40
 15269         ADD +1                 TO SUB6
 15270         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15271
 15272 3358-EXIT.
 15273     EXIT.
 15274******************************************************************
 15275*                  3359-BENEFIT-AH-SEARCH                        *
 15276*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15277*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15278*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15279******************************************************************
 15280 3359-BENEFIT-AH-SEARCH.
 15281     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15282       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15283         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15284           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15285              IF FO-PLAN-REFUND-METHOD (SUB6)
 15286                      IS GREATER THAN SPACES
 15287                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15288                                          WS-AH-REFUND-CALC
 15289                 GO TO 3359-EXIT.
 15290
 15291     IF SUB6 LESS THAN +40
 15292         ADD +1                 TO SUB6
 15293         GO TO 3359-BENEFIT-AH-SEARCH.
 15294
 15295 3359-EXIT.
 15296     EXIT.
 15297
 15298******************************************************************
 15299*                  3360-CHECK-FORM-LIMITS                        *
 15300*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15301*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15302******************************************************************
 15303
 15304 3360-CHECK-FORM-LIMITS.
 15305
 15306     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15307         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15308
 15309     IF NOT LF-FORM-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 276
* EL050.cbl
 15310         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15311
 15312 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15313
 15314     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15315       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15316        WS-LF-JOINT-INDICATOR = 'J'  AND
 15317        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15318         IF PB-COMPANY-ID = 'NCL'
 15319            MOVE  ER-1911          TO  WS-ERROR
 15320            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15321         ELSE
 15322            MOVE  ER-1892          TO  WS-ERROR
 15323            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15324
 15325 3360-CHECK-FORM-LF-ATT-AGE.
 15326
 15327     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15328
 15329     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15330         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15331         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15332            IF PB-COMPANY-ID = 'NCL'
 15333                MOVE  ER-1913      TO  WS-ERROR
 15334                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15335            ELSE
 15336                MOVE  ER-1894      TO  WS-ERROR
 15337                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15338
 15339 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15340
 15341     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15342         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15343         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15344            IF PB-COMPANY-ID = 'NCL'
 15345                MOVE  ER-1914      TO  WS-ERROR
 15346                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15347            ELSE
 15348                MOVE  ER-1899      TO  WS-ERROR
 15349                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15350
 15351 3360-CHECK-FORM-LF-TERM-BAMT.
 15352
 15353     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15354         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15355         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15356           IF  PB-COMPANY-ID = 'NCL'
 15357               MOVE  ER-1916       TO  WS-ERROR
 15358               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15359           ELSE
 15360               MOVE  ER-1902       TO  WS-ERROR
 15361               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15362
 15363     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15364                                    PB-I-LF-ALT-BENEFIT-AMT.
 15365
 15366     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15367         FO-MAX-LF-AMT   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 277
* EL050.cbl
 15368         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15369             IF  PB-COMPANY-ID = 'NCL'
 15370                 MOVE  ER-1918     TO  WS-ERROR
 15371                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15372             ELSE
 15373                 MOVE  ER-1904     TO  WS-ERROR
 15374                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15375
 15376******************************************************************
 15377*                  3360-CHECK-FORM-AH-LIMITS                     *
 15378*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15379*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15380******************************************************************
 15381
 15382 3360-CHECK-FORM-AH-LIMITS.
 15383
 15384     IF NOT AH-FORM-MASTER-FOUND
 15385         GO TO 3999-END-EDIT.
 15386
 15387 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15388
 15389     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15390       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15391        WS-AH-JOINT-INDICATOR = 'J'  AND
 15392        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15393         IF PB-COMPANY-ID = 'NCL'
 15394            MOVE  ER-1912          TO  WS-ERROR
 15395            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15396         ELSE
 15397            MOVE  ER-1893          TO  WS-ERROR
 15398            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15399
 15400 3360-CHECK-FORM-AH-ATT-AGE.
 15401
 15402     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15403
 15404     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15405         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15406         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15407            IF PB-COMPANY-ID = 'NCL'
 15408                MOVE  ER-1913      TO  WS-ERROR
 15409                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15410            ELSE
 15411                MOVE  ER-1894      TO  WS-ERROR
 15412                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15413
 15414 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15415
 15416     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15417         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15418         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15419            IF PB-COMPANY-ID = 'NCL'
 15420                MOVE  ER-1915      TO  WS-ERROR
 15421                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15422            ELSE
 15423                MOVE  ER-1900      TO  WS-ERROR
 15424                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15425
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 278
* EL050.cbl
 15426 3360-CHECK-FORM-AH-TERM-BAMT.
 15427
 15428     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15429         FO-AH-MAX-TERM    GREATER THAN  +0
 15430         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15431             IF  PB-COMPANY-ID = 'NCL'
 15432                 MOVE  ER-1917     TO  WS-ERROR
 15433                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15434             ELSE
 15435                  MOVE  ER-1903    TO  WS-ERROR
 15436                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15437
 15438     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15439         FO-MAX-AH-AMT    GREATER THAN  +0
 15440         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15441             IF  PB-COMPANY-ID = 'NCL'
 15442                 MOVE  ER-1919     TO  WS-ERROR
 15443                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15444             ELSE
 15445                 MOVE  ER-1905     TO  WS-ERROR
 15446                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15447
 15448     GO TO 3999-END-EDIT.
 15449
 15450******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 279
* EL050.cbl
 15452 3400-edit-vin.
 15453
 15454     MOVE PB-I-VIN               TO WS-WORK-VIN
 15455     MOVE +8                     TO V2
 15456     MOVE ZEROS                  TO WS-VIN-TOTAL
 15457     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15458      (V1 > 17)
 15459        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15460           MOVE ER-3825          TO WS-ERROR
 15461           PERFORM 9900-ERROR-FORMAT
 15462                                 THRU 9900-EXIT
 15463        ELSE
 15464           IF V1 = 8
 15465              MOVE 10            TO V2
 15466           END-IF
 15467           IF V1 = 9
 15468              MOVE 0             TO V2
 15469           END-IF
 15470           IF V1 = 10
 15471              MOVE 9             TO V2
 15472           END-IF
 15473           IF WS-WORK-VIN (V1:1) NUMERIC
 15474              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15475               + (WS-WORK-VIN-N (V1) * V2)
 15476           ELSE
 15477              MOVE WS-WORK-VIN (V1:1)
 15478                            TO WS-HEX-BYTE
 15479              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15480              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15481               + (WS-NUM (V3) * V2)
 15482           END-IF
 15483           COMPUTE V2 = V2 - 1
 15484        END-IF
 15485     END-PERFORM
 15486     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15487     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15488        REMAINDER WS-VIN-REMAINDER
 15489     IF ((WS-WORK-VIN (9:1) = 'X')
 15490        AND (WS-VIN-REMAINDER = 10))
 15491                OR
 15492        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15493        CONTINUE
 15494     ELSE
 15495        MOVE ER-3826             TO WS-ERROR
 15496        PERFORM 9900-ERROR-FORMAT
 15497                                 THRU 9900-EXIT
 15498     END-IF
 15499
 15500     .
 15501 3400-exit.
 15502     exit.
 15503******************************************************************
 15504*                  E D I T   C A N C E L                         *
 15505******************************************************************
 15506
 15507 3700-EDIT-CANCEL.
 15508     IF PB-COMPANY-ID = 'DMD'
 15509         MOVE ZEROS                   TO WS-RES-STATE-TAX
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 280
* EL050.cbl
 15510                                         WS-RES-MUNI-TAX
 15511                                         PB-CI-STATE-TAX
 15512                                         PB-CI-MUNI-TAX
 15513         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15514
 15515*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15516*       IF PB-ENTRY-BATCH  NUMERIC
 15517*          IF PB-CANCELLATION
 15518*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15519*          ELSE
 15520*             IF PB-ISSUE
 15521*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15522
 15523     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15524        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15525     END-IF
 15526*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15527*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15528
 15529     IF CM-ENTRY-STATUS = 'V'
 15530        MOVE ER-2780             TO WS-ERROR
 15531        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15532        GO TO 3999-END-EDIT.
 15533
 15534     IF CM-ENTRY-STATUS = 'D'
 15535        MOVE ER-2781             TO WS-ERROR
 15536        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15537        GO TO 3999-END-EDIT.
 15538
 15539     IF CM-ENTRY-STATUS = 'U'
 15540        MOVE ER-2782             TO WS-ERROR
 15541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15542
 15543***************************************************************
 15544*                                                             *
 15545*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15546*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15547*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15548*   OF ANOTHER COVERAGE.                                      *
 15549*                                                             *
 15550***************************************************************
 15551
 15552     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15553                                    PB-C-AH-CANCEL-VOID-SW.
 15554
 15555     IF PB-C-LF-CANCEL-AMT = ZERO
 15556        NEXT SENTENCE
 15557     ELSE
 15558        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15559           AND
 15560           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15561               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
 15562               MOVE ER-2745           TO WS-ERROR
 15563               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15564
 15565     IF PB-C-AH-CANCEL-AMT = ZERO
 15566        NEXT SENTENCE
 15567     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 281
* EL050.cbl
 15568        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15569           AND
 15570           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15571               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15572               MOVE ER-2745           TO WS-ERROR
 15573               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15574
 15575     IF WS-LF-EARNINGS-CALC = '4'
 15576        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15577
 15578     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15579     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15580     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15581     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15582     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15583     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15584
 15585     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15586                                      PB-C-AH-REF-CALC.
 15587     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15588
 15589******************************************************************
 15590*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15591*             TO VALIDATE COVERAGE.                              *
 15592******************************************************************
 15593
 15594     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15595        PB-C-LF-CANCEL-AMT = ZEROS
 15596          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15597      ELSE
 15598          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15599
 15600     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15601        PB-C-AH-CANCEL-AMT = ZEROS
 15602          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15603      ELSE
 15604          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15605
 15606     EVALUATE TRUE
 15607         WHEN PB-CANCEL-FORCE             OR
 15608              PB-CANCEL-DATE-FORCED       OR
 15609              PB-FORCE-OFF
 15610                  IF PB-COMPANY-ID = 'ACE'
 15611                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15612                  END-IF
 15613         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15614               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15615              (PB-COMPANY-ID = 'ACE' )
 15616                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15617         WHEN OTHER
 15618              IF PB-COMPANY-ID = 'ACE'
 15619                 MOVE ER-2794              TO WS-ERROR
 15620              ELSE
 15621                 MOVE ER-2749              TO WS-ERROR
 15622              END-IF
 15623              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15624     END-EVALUATE.
 15625
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 282
* EL050.cbl
 15626
 15627*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15628*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15629*            MOVE  ER-1909            TO  WS-ERROR
 15630*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15631*        ELSE
 15632*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15633
 15634     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15635     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15636        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15637     ELSE
 15638        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15639     END-IF
 15640     .
 15641 3705-EDIT-CANCEL-DT.
 15642
 15643     IF LF-COVERAGE-CANCELLED
 15644        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15645         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15646         MOVE WS-CURRENT-MONTH-END
 15647                                 TO DC-BIN-DATE-2
 15648         SET ELAPSED-BETWEEN-BIN TO TRUE
 15649*        MOVE 1                  TO DC-OPTION-CODE
 15650         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15651         IF DATE-CONVERSION-ERROR
 15652            NEXT SENTENCE
 15653          ELSE
 15654             IF DC-ELAPSED-DAYS GREATER +180
 15655                IF PB-CANCEL-DATE-FORCED  OR
 15656                   PB-CANCEL-DATE-FORCED-NO-FEE
 15657                      MOVE ER-2751  TO WS-ERROR
 15658                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15659                 ELSE
 15660                   MOVE ER-2752  TO WS-ERROR
 15661                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15662
 15663     IF AH-COVERAGE-CANCELLED
 15664        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15665         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15666         MOVE WS-CURRENT-MONTH-END
 15667                                 TO DC-BIN-DATE-2
 15668         SET ELAPSED-BETWEEN-BIN TO TRUE
 15669*        MOVE 1                  TO DC-OPTION-CODE
 15670         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15671         IF DATE-CONVERSION-ERROR
 15672            NEXT SENTENCE
 15673          ELSE
 15674             IF DC-ELAPSED-DAYS GREATER +180
 15675                IF PB-CANCEL-DATE-FORCED OR
 15676                   PB-CANCEL-DATE-FORCED-NO-FEE
 15677                      MOVE ER-2751  TO WS-ERROR
 15678                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15679                 ELSE
 15680                   MOVE ER-2752  TO WS-ERROR
 15681                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15682
 15683     IF WS-ERROR = ER-2752
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 283
* EL050.cbl
 15684        AND (PB-COMPANY-ID = 'ABL'
 15685         OR  PB-COMPANY-ID = 'FGL'
 15686         OR  PB-COMPANY-ID = 'IST'
 15687         OR  PB-COMPANY-ID = 'JHL'
 15688         OR  PB-COMPANY-ID = 'LAP'
 15689         OR  PB-COMPANY-ID = 'LBL'
 15690         OR  PB-COMPANY-ID = 'NCB'
 15691         OR  PB-COMPANY-ID = 'NLI'
 15692         OR  PB-COMPANY-ID = 'OFI'
 15693         OR  PB-COMPANY-ID = 'PLI'
 15694         OR  PB-COMPANY-ID = 'TAO'
 15695         OR  PB-COMPANY-ID = 'TIC'
 15696         OR  PB-COMPANY-ID = 'HER'
 15697         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15698         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15699            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15700            MOVE ER-2762     TO WS-ERROR
 15701            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15702
 15703     IF LF-COVERAGE-CANCELLED
 15704        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15705        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15706             MOVE ER-2733         TO WS-ERROR
 15707             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15708
 15709     IF AH-COVERAGE-CANCELLED
 15710        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15711        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15712              MOVE ER-2733        TO WS-ERROR
 15713              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15714
 15715     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15716        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15717        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15718           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15719            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15720              IF PB-COMPANY-ID NOT = 'LAP'
 15721               MOVE ER-2704            TO WS-ERROR
 15722               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15723
 15724     IF CERT-WAS-NOT-FOUND
 15725         GO TO 3999-END-EDIT.
 15726
 15727     IF PB-COMPANY-ID EQUAL 'CDC'
 15728        IF LF-COVERAGE-CANCELLED
 15729           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15730            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15731            MOVE PB-C-LF-CANCEL-DT
 15732                                 TO DC-BIN-DATE-2
 15733            SET ELAPSED-BETWEEN-BIN TO TRUE
 15734*           MOVE 1               TO DC-OPTION-CODE
 15735            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15736            IF DATE-CONVERSION-ERROR
 15737               NEXT SENTENCE
 15738             ELSE
 15739                IF DC-ELAPSED-DAYS GREATER +60
 15740                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15741
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 284
* EL050.cbl
 15742     IF PB-COMPANY-ID EQUAL 'CDC'
 15743        IF AH-COVERAGE-CANCELLED
 15744           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15745            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15746            MOVE PB-C-AH-CANCEL-DT
 15747                                 TO DC-BIN-DATE-2
 15748            MOVE +0              TO DC-ELAPSED-DAYS
 15749                                    DC-ELAPSED-MONTHS
 15750            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15751*           MOVE 1               TO DC-OPTION-CODE
 15752            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15753            IF DATE-CONVERSION-ERROR
 15754               NEXT SENTENCE
 15755             ELSE
 15756                IF DC-ELAPSED-DAYS GREATER +60
 15757                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15758
 15759     MOVE +0                     TO DC-ELAPSED-DAYS
 15760                                    DC-ELAPSED-MONTHS.
 15761
 15762     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15763        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15764          MOVE 'Z'                TO PB-CI-OB-FLAG
 15765          MOVE ER-2767            TO WS-ERROR
 15766          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15767          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15768          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15769          GO TO 3775-OVER-REF-CHK
 15770        ELSE
 15771          MOVE ZEROS              TO PB-CI-LIVES
 15772                                     PB-C-LIVES
 15773          IF PB-CI-OB-FLAG NOT = 'B'
 15774             MOVE SPACE           TO PB-CI-OB-FLAG.
 15775
 15776     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15777         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15778     ELSE
 15779         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15780
 15781     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15782        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15783            MOVE ER-2760         TO WS-ERROR
 15784            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15785
 15786     IF LF-COVERAGE-CANCELLED
 15787        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15788         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15789            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15790               MOVE ER-2774       TO WS-ERROR
 15791               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15792
 15793     IF AH-COVERAGE-CANCELLED
 15794        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15795         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15796            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15797               MOVE ER-2775       TO WS-ERROR
 15798               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15799
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 285
* EL050.cbl
 15800     IF LF-COVERAGE-CANCELLED
 15801        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15802         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15803            MOVE ER-2776         TO WS-ERROR
 15804            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15805
 15806     IF AH-COVERAGE-CANCELLED
 15807        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15808         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15809            MOVE ER-2777         TO WS-ERROR
 15810            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15811
 15812     IF LF-COVERAGE-CANCELLED
 15813        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15814        if pb-ci-lf-expire-dt = low-values or spaces
 15815           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15816           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15817           MOVE PB-CI-EXTENTION-DAYS
 15818                                 TO DC-ELAPSED-DAYS
 15819           SET BIN-PLUS-ELAPSED  TO TRUE
 15820           PERFORM 8500-DATE-CONVERT
 15821                                 THRU 8500-EXIT
 15822           IF DATE-CONVERSION-ERROR
 15823              move low-values    to dc-bin-date-2
 15824           end-if
 15825        else
 15826           move pb-ci-lf-expire-dt
 15827                                 to dc-bin-date-2
 15828        end-if
 15829        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15830           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15831                             OR  'FIA'
 15832              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15833           ELSE
 15834              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15835              MOVE ER-2731       TO WS-ERROR
 15836              PERFORM 9900-ERROR-FORMAT
 15837                                 THRU 9900-EXIT
 15838           end-if
 15839        end-if
 15840     end-if
 15841*    IF LF-COVERAGE-CANCELLED
 15842*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15843*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15844*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15845*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15846*        SET BIN-PLUS-ELAPSED      TO TRUE
 15847*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15848*        IF DATE-CONVERSION-ERROR
 15849*           NEXT SENTENCE
 15850*         ELSE
 15851*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15852*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15853*                            OR  'FIA'
 15854*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15855*              ELSE
 15856*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15857*               MOVE ER-2731       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 286
* EL050.cbl
 15858*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15859     .
 15860 3705-EDIT-AH-CANCEL-DT.
 15861     IF AH-COVERAGE-CANCELLED
 15862        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15863        if pb-ci-AH-expire-dt = low-values or spaces
 15864           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15865           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15866           MOVE PB-CI-EXTENTION-DAYS
 15867                                 TO DC-ELAPSED-DAYS
 15868           SET BIN-PLUS-ELAPSED  TO TRUE
 15869           PERFORM 8500-DATE-CONVERT
 15870                                 THRU 8500-EXIT
 15871           IF DATE-CONVERSION-ERROR
 15872              move low-values    to dc-bin-date-2
 15873           end-if
 15874        else
 15875           move pb-ci-ah-expire-dt
 15876                                 to dc-bin-date-2
 15877        end-if
 15878        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15879           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15880                             OR  'FIA'
 15881              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15882           ELSE
 15883              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15884              MOVE ER-2771       TO WS-ERROR
 15885              PERFORM 9900-ERROR-FORMAT
 15886                                 THRU 9900-EXIT
 15887           end-if
 15888        end-if
 15889     end-if
 15890*    IF AH-COVERAGE-CANCELLED
 15891*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15892*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15893*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15894*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15895**       MOVE 6                    TO DC-OPTION-CODE
 15896*        SET BIN-PLUS-ELAPSED      TO TRUE
 15897*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15898*        IF DATE-CONVERSION-ERROR
 15899*           NEXT SENTENCE
 15900*         ELSE
 15901*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15902*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15903*                             OR 'FIA'
 15904*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15905*             ELSE
 15906*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15907*              MOVE ER-2771       TO WS-ERROR
 15908*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15909     .
 15910 3705-EDIT-CONTINUED.
 15911
 15912*    IF LF-COVERAGE-CANCELLED
 15913*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15914*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15915*            MOVE ER-2727         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 287
* EL050.cbl
 15916*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15917*
 15918*    IF AH-COVERAGE-CANCELLED
 15919*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15920*        IF PB-COMPANY-ID = 'ACE'
 15921*           MOVE ER-2727        TO WS-ERROR
 15922*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15923*        ELSE
 15924*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15925*              MOVE ER-2727     TO WS-ERROR
 15926*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15927
 15928     IF PB-COMPANY-ID = 'ACE'
 15929       IF AH-COVERAGE-CANCELLED
 15930         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15931           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15932              MOVE ER-2732      TO WS-ERROR
 15933              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15934
 15935     IF PB-COMPANY-ID      EQUAL   'HER'
 15936        IF WS-ERROR        EQUAL   ER-2727
 15937            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15938            MOVE  ER-2725          TO  WS-ERROR
 15939            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15940
 15941     IF PB-C-CLAIM-CREATED-CANCEL
 15942            MOVE ER-2748         TO WS-ERROR
 15943            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15944
 15945     IF PB-C-LAST-NAME NOT = SPACES
 15946         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15947            MOVE ER-2747         TO WS-ERROR
 15948            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15949
 15950 3710-EDIT-LUMP-SUM-PRIOR.
 15951
 15952     IF AH-COVERAGE-CANCELLED
 15953         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15954             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15955                MOVE ER-2735    TO WS-ERROR
 15956                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15957
 15958     IF LF-COVERAGE-CANCELLED
 15959         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15960             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15961                MOVE ER-2735    TO WS-ERROR
 15962                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15963
 15964 3710-EDIT-PRIOR-DEATH.
 15965
 15966*    IF LF-COVERAGE-CANCELLED
 15967*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15968*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15969*           (NOT PB-CI-OB)
 15970*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15971*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15972*                   MOVE ER-2732  TO WS-ERROR
 15973*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 288
* EL050.cbl
 15974*
 15975*    IF AH-COVERAGE-CANCELLED
 15976*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15977*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15978*           (NOT PB-CI-OB)
 15979*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15980*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15981*                   MOVE ER-2732  TO WS-ERROR
 15982*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15983
 15984     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15985         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 15986            (NOT PB-COMP-LF-CANCEL)
 15987             NEXT SENTENCE
 15988         ELSE
 15989           IF PB-C-LF-CANCEL-VOIDED
 15990              NEXT SENTENCE
 15991           ELSE
 15992              MOVE ER-2753      TO WS-ERROR
 15993              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15994
 15995     IF CANCEL-FUTURE-DT
 15996         GO TO 3999-END-EDIT.
 15997
 15998 3715-GET-REMAIN-TERM-LF.
 15999
 16000     IF NO-LF-BENEFIT-MATCH  OR
 16001        WS-LF-BENEFIT-CD = ZEROS
 16002        GO TO 3730-GET-AH-REMAIN-TERM.
 16003
 16004     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16005     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16006     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16007     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16008     MOVE PB-SV-STATE            TO CP-STATE.
 16009     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16010     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16011     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16012     MOVE '2'                    TO CP-PROCESS-TYPE.
 16013     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16014     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16015     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16016     IF (PB-COMPANY-ID = 'CID')
 16017        AND (CP-STATE-STD-ABBRV = 'WI')
 16018        MOVE '7'                 TO CP-REM-TERM-METHOD
 16019        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16020     ELSE
 16021        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16022        MOVE WS-REM-TRM-CALC-OPTION
 16023                                 TO CP-REM-TRM-CALC-OPTION
 16024     END-IF
 16025**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
 16026     IF (PB-COMPANY-ID = 'CID')
 16027        AND (CP-STATE-STD-ABBRV = 'MO')
 16028        AND (PB-CERT-EFF-DT >= X'9B41')
 16029        AND (PB-CERT-EFF-DT <= X'A2FB')
 16030        MOVE '7'                 TO CP-REM-TERM-METHOD
 16031        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 289
* EL050.cbl
 16032     END-IF
 16033     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16034                                    CP-LOAN-TERM.
 16035     IF CP-TRUNCATED-LIFE
 16036        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16037
 16038     IF CP-TERM-IS-DAYS
 16039         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16040     ELSE
 16041         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16042
 16043     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16044
 16045     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16046
 16047     IF LF-COVERAGE-CANCELLED
 16048        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16049        NEXT SENTENCE
 16050      ELSE
 16051          GO TO 3730-GET-AH-REMAIN-TERM.
 16052
 16053 3720-GET-LF-REFUND.
 16054
 16055     IF PB-C-LF-CANCEL-VOIDED
 16056        GO TO 3730-GET-AH-REMAIN-TERM
 16057     end-if
 16058
 16059     IF PB-COMPANY-ID EQUAL 'BOA'
 16060         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16061         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16062         GO TO 3730-GET-AH-REMAIN-TERM.
 16063
 16064     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16065        (WS-AH-SPECIAL-CALC-CD = 'M')
 16066         MOVE ER-2767            TO WS-ERROR
 16067         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16068         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16069         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16070         GO TO 3780-UPDATE-CANCEL-CERT.
 16071
 16072*    if (ws-lf-earnings-calc = '6')
 16073*       or (pb-c-lf-refund-override = '6')
 16074*       move cp-remaining-term-1 to cp-remaining-term-2
 16075*    end-if
 16076     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16077
 16078     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16079     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16080     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16081     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16082     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16083     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
 16084     IF (PB-COMPANY-ID = 'DCC')
 16085        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16086        IF PDEF-MASTER-FOUND
 16087           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16088              (V1 > +8)
 16089              OR (PD-PROD-CODE (V1) = 'L')
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 290
* EL050.cbl
 16090           END-PERFORM
 16091           IF V1 < +9
 16092              MOVE PD-MAX-AMT (V1)
 16093                           TO CP-R-MAX-TOT-BEN
 16094                              EC-AM-LF-MAX-TOT-BEN
 16095           END-IF
 16096        ELSE
 16097        MOVE ' '                 TO PDEF-MASTER-SW
 16098        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16099        MOVE PB-STATE            TO ERPDEF-STATE
 16100        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16101        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16102        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16103        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16104        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16105        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16106        IF PDEF-MASTER-FOUND
 16107           MOVE 'N'              TO PDEF-MASTER-SW
 16108           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16109           IF PDEF-MASTER-FOUND
 16110              IF (ERPDEF-KEY-SAVE (1:16) =
 16111                           PD-CONTROL-PRIMARY (1:16))
 16112                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16113                 CONTINUE
 16114              ELSE
 16115                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16116                 IF (ERPDEF-KEY-SAVE (1:16) =
 16117                           PD-CONTROL-PRIMARY (1:16))
 16118                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16119                    CONTINUE
 16120                 ELSE
 16121                    MOVE 'N'     TO PDEF-MASTER-SW
 16122                 END-IF
 16123              END-IF
 16124
 16125              IF PDEF-MASTER-FOUND
 16126                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16127                    (V1 > +8)
 16128                    OR (PD-PROD-CODE (V1) = 'L')
 16129                 END-PERFORM
 16130                 IF V1 < +9
 16131                    MOVE PD-MAX-AMT (V1)
 16132                                 TO CP-R-MAX-TOT-BEN
 16133                                    EC-AM-LF-MAX-TOT-BEN
 16134                 END-IF
 16135              END-IF
 16136           END-IF
 16137           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16138        END-IF
 16139        END-IF
 16140     END-IF
 16141     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16142
 16143     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16144
 16145     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16146                                    PB-C-LF-REM-TERM.
 16147
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 291
* EL050.cbl
 16148     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16149     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16150
 16151     IF PB-COMPANY-ID EQUAL 'FLC'
 16152        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16153           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16154           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16155                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16156                    - CM-LF-ITD-DEATH-AMT
 16157           IF PB-C-LF-REF-CALC LESS THAN +0
 16158              MOVE +0            TO PB-C-LF-REF-CALC
 16159              GO TO 3730-GET-AH-REMAIN-TERM
 16160           ELSE
 16161              GO TO 3730-GET-AH-REMAIN-TERM.
 16162
 16163     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16164                            OR '4' OR '5' OR '6' OR '8'
 16165                            OR '9' OR 'G'
 16166        MOVE PB-C-LF-REFUND-OVERRIDE
 16167                                 TO CP-EARNING-METHOD.
 16168
 16169     if pb-company-id = 'AHL'
 16170        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16171        if cp-class-code = spaces
 16172           move zeros            to cp-class-code
 16173        end-if
 16174     ELSE
 16175        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16176     END-IF
 16177*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16178     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16179     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16180                                    CP-RATING-BENEFIT-AMT.
 16181     IF CP-STATE-STD-ABBRV = 'OR'
 16182         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16183                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16184     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16185     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16186     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16187     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16188     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16189     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16190     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16191     IF WS-DEFAULT-APR NOT NUMERIC
 16192         MOVE ZEROS TO WS-DEFAULT-APR.
 16193****   N O T E   ****
 16194*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16195*      THE OH HARD CODING IN ELCRFNDP
 16196
 16197     IF PB-COMPANY-ID = 'CID'
 16198        IF CP-STATE-STD-ABBRV = 'OH'
 16199           MOVE WS-LF-EARNINGS-CALC
 16200                                 TO CP-EARNING-METHOD
 16201        END-IF
 16202     END-IF
 16203
 16204****   N O T E   ****
 16205
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 292
* EL050.cbl
 16206     IF CP-EARN-AS-NET-PAY
 16207         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16208            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16209                MOVE WS-DEFAULT-APR
 16210                                 TO  CP-LOAN-APR
 16211                MOVE ER-3780     TO  WS-ERROR
 16212                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16213            ELSE
 16214                MOVE ER-3781     TO  WS-ERROR
 16215                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16216*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16217     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16218
 16219     IF CP-REFUND-TYPE-USED NOT = SPACE
 16220         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16221
 16222     IF CP-ERROR-RATE-IS-ZERO OR
 16223        CP-ERROR-RATE-NOT-FOUND
 16224        MOVE ER-2740             TO WS-ERROR
 16225        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16226
 16227     IF CP-ERROR-RATE-FILE-NOTOPEN
 16228        MOVE ER-2617             TO WS-ERROR
 16229        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16230
 16231     IF PB-COMPANY-ID = 'DCC'
 16232        AND PB-CI-ENTRY-STATUS = 'M'
 16233        MOVE +0                  TO PB-C-LF-REF-CALC
 16234     ELSE
 16235        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16236     END-IF
 16237
 16238     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16239         GO TO 3730-GET-AH-REMAIN-TERM.
 16240
 16241*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16242*       ADD +1                   TO PB-C-LF-REM-TERM
 16243*                                   CP-REMAINING-TERM
 16244*                                   CP-ORIGINAL-TERM.
 16245
 16246     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16247     MOVE '2'                    TO CP-EARNING-METHOD
 16248                                    CP-RATING-METHOD.
 16249     IF PB-COMPANY-ID = 'CID'
 16250        IF (CP-STATE-STD-ABBRV = 'MN')
 16251           AND (PB-CERT-EFF-DT > X'A4FF')
 16252           AND (WS-LF-EARNINGS-CALC = 'B')
 16253           MOVE '5'              TO CP-EARNING-METHOD
 16254           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
 16255        END-IF
 16256     END-IF
 16257     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16258                                        CP-REMAINING-BENEFIT
 16259                                        CP-RATING-BENEFIT-AMT.
 16260     IF CP-STATE-STD-ABBRV = 'OR'
 16261         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16262                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16263     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 293
* EL050.cbl
 16264     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16265
 16266     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16267
 16268     IF CP-ERROR-RATE-IS-ZERO OR
 16269        CP-ERROR-RATE-NOT-FOUND
 16270        MOVE ER-2740             TO WS-ERROR
 16271        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16272
 16273     IF CP-ERROR-RATE-FILE-NOTOPEN
 16274        MOVE ER-2617             TO WS-ERROR
 16275        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16276
 16277     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16278
 16279******************************************************************
 16280
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 294
* EL050.cbl
 16282 3730-GET-AH-REMAIN-TERM.
 16283     IF NO-AH-BENEFIT-MATCH  OR
 16284        WS-AH-BENEFIT-CD = ZEROS
 16285         GO TO 3770-CHECK-REFUNDS.
 16286
 16287     IF PB-CI-AH-LUMP-SUM-DISAB
 16288         IF  PB-C-AH-CANCEL-AMT = ZERO
 16289            IF NOT PB-COMP-AH-CANCEL
 16290             GO TO 3770-CHECK-REFUNDS.
 16291
 16292     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16293     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16294     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16295     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16296     MOVE PB-SV-STATE            TO CP-STATE.
 16297     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16298     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16299     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16300     MOVE '2'                    TO CP-PROCESS-TYPE.
 16301     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16302     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16303     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16304     IF (PB-COMPANY-ID = 'CID')
 16305        AND (CP-STATE-STD-ABBRV = 'WI')
 16306        MOVE '7'                 TO CP-REM-TERM-METHOD
 16307        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16308     ELSE
 16309        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16310        MOVE WS-REM-TRM-CALC-OPTION
 16311                                 TO CP-REM-TRM-CALC-OPTION
 16312     END-IF
 16313     IF (PB-COMPANY-ID = 'CID')
 16314        AND (CP-STATE-STD-ABBRV = 'MO')
 16315        AND (PB-CERT-EFF-DT >= X'9B41')
 16316        AND (PB-CERT-EFF-DT <= X'A2FB')
 16317        MOVE '7'                 TO CP-REM-TERM-METHOD
 16318        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16319     END-IF
 16320     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16321                                    CP-LOAN-TERM.
 16322     IF NOT CP-TERM-IS-DAYS
 16323         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16324
 16325     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16326
 16327     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16328
 16329     IF AH-COVERAGE-CANCELLED
 16330        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16331        NEXT SENTENCE
 16332      ELSE
 16333         GO TO 3770-CHECK-REFUNDS.
 16334
 16335 3740-GET-AH-REFUND.
 16336
 16337     IF PB-C-AH-CANCEL-VOIDED
 16338        GO TO 3780-UPDATE-CANCEL-CERT
 16339     END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 295
* EL050.cbl
 16340
 16341     IF PB-COMPANY-ID = 'BOA'
 16342         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16343         GO TO 3770-CHECK-REFUNDS.
 16344
 16345     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16346*    MOVE ' '                    TO DC-OPTION-CODE
 16347     SET BIN-TO-GREG             TO TRUE
 16348     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16349     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16350                                    PB-C-AH-REM-TERM.
 16351     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16352     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16353
 16354     IF PB-COMPANY-ID EQUAL 'FLC'
 16355        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16356           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16357           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16358                    - CM-AH-ITD-AH-PMT)
 16359           IF PB-C-AH-REF-CALC LESS THAN +0
 16360              MOVE +0            TO PB-C-AH-REF-CALC
 16361              GO TO 3770-CHECK-REFUNDS
 16362           ELSE
 16363              GO TO 3770-CHECK-REFUNDS.
 16364
 16365     IF PB-COMPANY-ID = 'DCC'
 16366        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16367            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16368           MOVE 'S'              TO CP-EARNING-METHOD
 16369        END-IF
 16370     END-IF
 16371     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16372                            OR '4' OR '5' OR '6' OR '8'
 16373                            OR '9' OR 'G' OR 'S'
 16374        MOVE PB-C-AH-REFUND-OVERRIDE
 16375                                 TO CP-EARNING-METHOD.
 16376
 16377     if pb-company-id = 'AHL'
 16378        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16379        if cp-class-code = spaces
 16380           move zeros            to cp-class-code
 16381        end-if
 16382     ELSE
 16383        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16384     END-IF
 16385*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16386     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16387     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16388                                    CP-RATING-BENEFIT-AMT.
 16389     IF CP-STATE-STD-ABBRV = 'OR'
 16390         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16391                                         PB-CI-AH-TERM.
 16392     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16393     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16394     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16395     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16396     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16397     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 296
* EL050.cbl
 16398
 16399     IF CP-STATE-STD-ABBRV = 'OH'
 16400        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16401                                AND 'CID' AND 'DCC' AND 'AHL')
 16402           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16403              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16404              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16405              MOVE '6' TO CP-EARNING-METHOD
 16406           END-IF
 16407        END-IF
 16408        IF PB-COMPANY-ID = 'CID'
 16409           IF NO-LIFE-COVERAGE
 16410              IF CP-CRITICAL-PERIOD
 16411                 MOVE '2'       TO CP-EARNING-METHOD
 16412              ELSE
 16413                 MOVE '6'       TO CP-EARNING-METHOD
 16414              END-IF
 16415           ELSE
 16416              IF WS-LF-COVERAGE-TYPE = 'L'
 16417                 MOVE '2'       TO CP-EARNING-METHOD
 16418              ELSE
 16419                 IF (PB-CI-LF-TERM > +60) OR
 16420                    (WS-LF-EARNINGS-CALC = '5')
 16421                    IF CP-CRITICAL-PERIOD
 16422                       MOVE '2'  TO CP-EARNING-METHOD
 16423                    ELSE
 16424                       MOVE '6'  TO CP-EARNING-METHOD
 16425                    END-IF
 16426                 ELSE
 16427                    MOVE '1'     TO CP-EARNING-METHOD
 16428                 END-IF
 16429              END-IF
 16430           END-IF
 16431        END-IF
 16432     END-IF
 16433
 16434*    IF CP-STATE-STD-ABBRV = 'VA'
 16435*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16436*          IF CP-ORIGINAL-TERM GREATER 61
 16437*             MOVE '6' TO CP-EARNING-METHOD
 16438*          ELSE
 16439*             MOVE '1' TO CP-EARNING-METHOD.
 16440
 16441     IF WS-DEFAULT-APR NOT NUMERIC
 16442         MOVE ZEROS TO WS-DEFAULT-APR.
 16443     IF CP-EARN-AS-NET-PAY
 16444         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16445            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16446                MOVE WS-DEFAULT-APR
 16447                                 TO  CP-LOAN-APR
 16448                MOVE ER-3780     TO  WS-ERROR
 16449                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16450            ELSE
 16451                MOVE ER-3781     TO  WS-ERROR
 16452                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16453     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16454     IF PB-COMPANY-ID = 'DCC'
 16455        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 297
* EL050.cbl
 16456        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16457        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16458     END-IF
 16459     IF PB-COMPANY-ID = 'DCC'
 16460        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16461        AND (CP-EARNING-METHOD = 'D')
 16462        AND (CP-CANCEL-REASON NOT = 'R')
 16463        CONTINUE
 16464     ELSE
 16465        GO TO 3750-CONTINUE
 16466     END-IF
 16467     MOVE ' '                    TO DD-IU-SW
 16468     IF NOT PDEF-MASTER-FOUND
 16469        MOVE ' '                 TO PDEF-MASTER-SW
 16470        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16471        MOVE PB-STATE            TO ERPDEF-STATE
 16472        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16473        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16474        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16475        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16476        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16477        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16478        IF PDEF-MASTER-FOUND
 16479           MOVE 'N'              TO PDEF-MASTER-SW
 16480           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16481           IF PDEF-MASTER-FOUND
 16482              IF (ERPDEF-KEY-SAVE (1:16) =
 16483                           PD-CONTROL-PRIMARY (1:16))
 16484                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16485                 CONTINUE
 16486              ELSE
 16487                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16488                 IF (ERPDEF-KEY-SAVE (1:16) =
 16489                           PD-CONTROL-PRIMARY (1:16))
 16490                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16491                    CONTINUE
 16492                 ELSE
 16493                    MOVE ER-2740 TO WS-ERROR
 16494                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16495                    GO TO 3770-CHECK-REFUNDS
 16496                 END-IF
 16497              END-IF
 16498           END-IF
 16499           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16500        END-IF
 16501     END-IF
 16502     IF PDEF-MASTER-FOUND
 16503        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16504           (V1 > +8)
 16505           OR (PD-PROD-CODE (V1) = 'I')
 16506        END-PERFORM
 16507        IF V1 < +9
 16508           SET DD-IU-PRESENT        TO TRUE
 16509        END-IF
 16510        IF WS-AH-DCC-TRUNC = 'T'
 16511           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16512        ELSE
 16513           MOVE CP-ORIGINAL-TERM    TO WS-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 298
* EL050.cbl
 16514        END-IF
 16515        EVALUATE TRUE
 16516           WHEN WS-TERM > +168
 16517              MOVE 15               TO V1
 16518           WHEN WS-TERM > +156
 16519              MOVE 14               TO V1
 16520           WHEN WS-TERM > +144
 16521              MOVE 13               TO V1
 16522           WHEN WS-TERM > +132
 16523              MOVE 12               TO V1
 16524           WHEN WS-TERM > +120
 16525              MOVE 11               TO V1
 16526           WHEN WS-TERM > +108
 16527              MOVE 10               TO V1
 16528           WHEN WS-TERM > +96
 16529              MOVE 9                TO V1
 16530           WHEN WS-TERM > +84
 16531              MOVE 8                TO V1
 16532           WHEN WS-TERM > +72
 16533              MOVE 7                TO V1
 16534           WHEN WS-TERM > +60
 16535              MOVE 6                TO V1
 16536           WHEN WS-TERM > +48
 16537              MOVE 5                TO V1
 16538           WHEN WS-TERM > +36
 16539              MOVE 4                TO V1
 16540           WHEN WS-TERM > +24
 16541              MOVE 3                TO V1
 16542           WHEN WS-TERM > +12
 16543              MOVE 2                TO V1
 16544           WHEN OTHER
 16545              MOVE 1                TO V1
 16546        END-EVALUATE
 16547
 16548        EVALUATE TRUE
 16549*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16550*             < +13)
 16551*             AND (DD-IU-PRESENT)
 16552*             MOVE 2                TO V2
 16553*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16554*             MOVE 1                TO V2
 16555           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16556              MOVE 2                TO V2
 16557           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16558              MOVE 3                TO V2
 16559           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16560              MOVE 4                TO V2
 16561           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16562              MOVE 5                TO V2
 16563           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16564              MOVE 6                TO V2
 16565           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16566              MOVE 7                TO V2
 16567           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16568              MOVE 8                TO V2
 16569           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16570              MOVE 9                TO V2
 16571           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 299
* EL050.cbl
 16572              MOVE 10               TO V2
 16573           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16574              MOVE 11               TO V2
 16575           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16576              MOVE 12               TO V2
 16577           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16578              MOVE 13               TO V2
 16579           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16580              MOVE 14               TO V2
 16581           WHEN OTHER
 16582              MOVE 15               TO V2
 16583        END-EVALUATE
 16584
 16585        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16586                                 TO CP-DDF-LO-FACT
 16587        MOVE PD-UEP-FACTOR (V1 V2)
 16588                                 TO CP-DDF-HI-FACT
 16589
 16590        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16591        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16592        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16593           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16594        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16595        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16596        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16597           + PD-1ST-YR-ADMIN-ALLOW
 16598
 16599        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16600*       IF PI-CLP-YN = 'Y'
 16601*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16602*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16603*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16604*       END-IF
 16605
 16606        IF DD-IU-PRESENT
 16607           MOVE 'I'              TO CP-EARNING-METHOD
 16608        END-IF
 16609        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16610                                     CP-CLP-RATE-UP
 16611        IF CP-IU-RATE-UP NOT = ZEROS
 16612           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16613              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16614           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16615              / (1 - WS-WORK-FACT)
 16616        END-IF
 16617     END-IF
 16618     .
 16619 3750-CONTINUE.
 16620     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16621
 16622     IF CP-REFUND-TYPE-USED NOT = SPACE
 16623         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16624
 16625     IF CP-ERROR-RATE-IS-ZERO OR
 16626        CP-ERROR-RATE-NOT-FOUND
 16627        MOVE ER-2740             TO WS-ERROR
 16628        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16629
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 300
* EL050.cbl
 16630     IF CP-ERROR-RATE-FILE-NOTOPEN
 16631        MOVE ER-2617             TO WS-ERROR
 16632        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16633     IF PB-COMPANY-ID = 'DCC'
 16634        AND PB-CI-ENTRY-STATUS = 'M'
 16635        MOVE +0                  TO PB-C-AH-REF-CALC
 16636     ELSE
 16637        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16638     END-IF
 16639     IF PB-COMPANY-ID = 'DCC'
 16640        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16641        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16642        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16643        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16644        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16645        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16646        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16647        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16648*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16649     END-IF
 16650     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 301
* EL050.cbl
 16652
 16653 3770-CHECK-REFUNDS.
 16654
 16655     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16656        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16657           MOVE ER-2766          TO WS-ERROR
 16658           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16659           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16660           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16661              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16662
 16663     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16664        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16665           MOVE ER-2766          TO WS-ERROR
 16666           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16667           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16668           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16669              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16670
 16671     IF PB-COMP-LF-CANCEL
 16672        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16673        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16674           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16675              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16676
 16677     IF PB-COMP-AH-CANCEL
 16678        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16679        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16680           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16681              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16682
 16683     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16684             GIVING WS-UNSIGN-WRK1
 16685     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16686             GIVING WS-UNSIGN-WRK2.
 16687
 16688     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16689         MOVE ZERO TO WS-UNSIGN-WRK1.
 16690
 16691     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16692         MOVE ZERO TO WS-UNSIGN-WRK2.
 16693
 16694     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16695
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 302
* EL050.cbl
 16697
 16698 3772-CONTINUE.
 16699
 16700**********************************
 16701*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16702*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16703*** DOUBLES THE TOLERANCE AMOUNT.
 16704***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16705**********************************
 16706     IF PB-COMPANY-ID = 'MON'
 16707     IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-REFUND
 16708         IF WS-REF-REJECT-SW = SPACE
 16709             MOVE ER-2754        TO WS-ERROR
 16710             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16711           ELSE
 16712             MOVE ER-2736        TO WS-ERROR
 16713             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16714**********************************
 16715
 16716 3773-CONTINUE.
 16717
 16718     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16719        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16720           MOVE ER-2723          TO WS-ERROR
 16721           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16722
 16723     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16724        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16725           MOVE ER-2724          TO WS-ERROR
 16726           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16727
 16728     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16729         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16730             (1 + WS-LF-REFUND-OVS-PCT)
 16731     ELSE
 16732         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16733
 16734     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16735         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16736             (1 - WS-TOL-LF-REFUND-PCT)
 16737     ELSE
 16738         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16739
 16740     IF (PB-COMPANY-ID = 'DCC')
 16741        AND (PB-CI-ENTRY-STATUS = 'M')
 16742        AND (PB-C-LF-CANCEL-AMT > +0)
 16743        MOVE ER-3843             TO WS-ERROR
 16744        PERFORM 9900-ERROR-FORMAT
 16745                                 THRU 9900-EXIT
 16746     END-IF
 16747     EVALUATE TRUE
 16748        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16749           CONTINUE
 16750        WHEN PB-C-LF-CANCEL-AMT = +0
 16751                 AND PB-C-LF-REF-CALC > +0
 16752           CONTINUE
 16753        WHEN WS-LF-REFUND-OVS-AMT = 0
 16754                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 303
* EL050.cbl
 16755           CONTINUE
 16756        WHEN OTHER
 16757           IF WS-TOL-LF-REFUND  = +0
 16758              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16759           END-IF
 16760           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16761                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16762                          (PB-C-LF-CANCEL-AMT))
 16763              CONTINUE
 16764           ELSE
 16765              IF WS-LF-REFUND-OVS-AMT = +0
 16766                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16767              END-IF
 16768              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16769                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16770                                       PB-C-LF-CANCEL-AMT)
 16771                 CONTINUE
 16772              ELSE
 16773                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16774                   MOVE ER-2754   TO  WS-ERROR
 16775                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16776                 ELSE
 16777                    MOVE ER-2736   TO  WS-ERROR
 16778                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16779                 END-IF
 16780              END-IF
 16781           END-IF
 16782     END-EVALUATE.
 16783
 16784     EVALUATE TRUE
 16785        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16786           CONTINUE
 16787        WHEN PB-C-LF-CANCEL-AMT = +0
 16788                 AND PB-C-LF-REF-CALC > +0
 16789           CONTINUE
 16790        WHEN OTHER
 16791           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16792               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16793              CONTINUE
 16794           ELSE
 16795              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16796               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16797                CONTINUE
 16798              ELSE
 16799                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16800                     MOVE ER-2754   TO  WS-ERROR
 16801                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16802                 ELSE
 16803                     MOVE ER-2736   TO  WS-ERROR
 16804                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16805                 END-IF
 16806              END-IF
 16807           END-IF
 16808     END-EVALUATE.
 16809
 16810     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16811         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16812             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 304
* EL050.cbl
 16813     ELSE
 16814         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16815
 16816     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16817         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16818             (1 - WS-TOL-AH-REFUND-PCT)
 16819     ELSE
 16820         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16821
 16822     IF (PB-COMPANY-ID = 'DCC')
 16823        AND (PB-CI-ENTRY-STATUS = 'M')
 16824        AND (PB-C-AH-CANCEL-AMT > +0)
 16825        MOVE ER-3843             TO WS-ERROR
 16826        PERFORM 9900-ERROR-FORMAT
 16827                                 THRU 9900-EXIT
 16828     END-IF
 16829     EVALUATE TRUE
 16830        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16831           CONTINUE
 16832*       WHEN PB-C-AH-REF-CALC = +0 AND
 16833*                  PB-C-AH-CANCEL-AMT > +0
 16834        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16835                   PB-C-AH-REF-CALC > +0
 16836           CONTINUE
 16837        WHEN WS-AH-REFUND-OVS-AMT = +0
 16838                AND WS-TOL-AH-REFUND = +0
 16839           CONTINUE
 16840        WHEN OTHER
 16841           IF WS-TOL-AH-REFUND = +0
 16842              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16843           END-IF
 16844           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16845               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16846                                         PB-C-AH-CANCEL-AMT)
 16847              CONTINUE
 16848           ELSE
 16849              IF WS-AH-REFUND-OVS-AMT = +0
 16850                 MOVE +9999999.99 TO
 16851                         WS-AH-REFUND-OVS-AMT
 16852              END-IF
 16853              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16854                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16855                                         PB-C-AH-CANCEL-AMT)
 16856                 CONTINUE
 16857              ELSE
 16858                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16859                    MOVE ER-2754   TO  WS-ERROR
 16860                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16861                 ELSE
 16862                    MOVE ER-2736   TO  WS-ERROR
 16863                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16864                 END-IF
 16865              END-IF
 16866           END-IF
 16867     END-EVALUATE.
 16868
 16869     EVALUATE TRUE
 16870        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 305
* EL050.cbl
 16871           CONTINUE
 16872*       WHEN PB-C-AH-REF-CALC > +0 AND
 16873*                  PB-C-AH-CANCEL-AMT = +0
 16874        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16875                   PB-C-AH-REF-CALC = +0
 16876           CONTINUE
 16877        WHEN OTHER
 16878           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16879               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16880              CONTINUE
 16881           ELSE
 16882              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16883                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16884                 CONTINUE
 16885              ELSE
 16886                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16887                     MOVE ER-2754   TO  WS-ERROR
 16888                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16889                 ELSE
 16890                     MOVE ER-2736   TO  WS-ERROR
 16891                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16892                 END-IF
 16893              END-IF
 16894           END-IF
 16895     END-EVALUATE.
 16896
 16897     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16898        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16899        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16900           AND  PB-C-LF-REF-CALC < +1.00
 16901           AND  PB-C-AH-REF-CALC < +1.00
 16902           CONTINUE
 16903        ELSE
 16904           IF (PB-COMPANY-ID = 'DCC')
 16905              AND (PB-CI-ENTRY-STATUS = 'M')
 16906              CONTINUE
 16907           ELSE
 16908              MOVE ER-2741       TO WS-ERROR
 16909              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16910           END-IF
 16911        END-IF
 16912     END-IF
 16913
 16914     IF (PB-C-LF-CANCEL-AMT = ZERO
 16915        AND WS-LF-BENEFIT-CD NOT = ZERO
 16916        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16917        AND PB-C-LF-REF-CALC NOT = ZERO)
 16918        OR
 16919        (PB-C-LF-CANCEL-AMT = ZERO
 16920        AND WS-LF-BENEFIT-CD NOT = ZERO
 16921        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16922             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16923                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16924                NEXT SENTENCE
 16925             ELSE
 16926                MOVE ER-2739        TO WS-ERROR
 16927                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16928
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 306
* EL050.cbl
 16929     IF (PB-C-AH-CANCEL-AMT = ZERO
 16930        AND WS-AH-BENEFIT-CD NOT = ZERO
 16931        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16932        AND PB-C-AH-REF-CALC NOT = ZERO)
 16933        OR
 16934        (PB-C-AH-CANCEL-AMT = ZERO
 16935        AND WS-AH-BENEFIT-CD NOT = ZERO
 16936        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16937             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16938                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16939                NEXT SENTENCE
 16940             ELSE
 16941                MOVE ER-2738        TO WS-ERROR
 16942                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16943
 16944 3775-OVER-REF-CHK.
 16945
 16946     IF PB-CI-ENTRY-STATUS = '5'
 16947        GO TO 3780-UPDATE-CANCEL-CERT.
 16948
 16949     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16950                              PB-CI-LF-ALT-PREMIUM-AMT.
 16951
 16952     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16953        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16954                                 PB-C-LF-REF-CALC
 16955      ELSE
 16956        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16957                                 PB-C-LF-CANCEL-AMT.
 16958
 16959     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16960        MOVE ER-2755             TO WS-ERROR
 16961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16962
 16963     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16964
 16965     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16966        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16967                                 PB-C-AH-REF-CALC
 16968      ELSE
 16969        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16970                                 PB-C-AH-CANCEL-AMT.
 16971
 16972     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16973        MOVE ER-2778             TO WS-ERROR
 16974        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16975
 16976     IF PB-CI-OB-FLAG NOT = 'Z'
 16977        NEXT SENTENCE
 16978       ELSE
 16979         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 16980            MOVE ER-2757           TO WS-ERROR
 16981            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16982
 16983 3780-UPDATE-CANCEL-CERT.
 16984
 16985     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 16986        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 307
* EL050.cbl
 16987        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16988
 16989     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 16990         MOVE ER-2729              TO WS-ERROR
 16991         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16992
 16993     IF PB-CI-LF-BENEFIT-CD = ZERO
 16994         GO TO 3780-UPDATE-CONT-1.
 16995
 16996     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 16997         GO TO 3780-UPDATE-CONT-1.
 16998
 16999     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17000       AND
 17001        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17002       AND
 17003        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17004       AND
 17005        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17006            NEXT SENTENCE
 17007       ELSE
 17008        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17009          AND
 17010***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17011***       AND
 17012           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17013            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17014               MOVE ER-2730      TO WS-ERROR
 17015               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17016               GO TO 3999-END-EDIT
 17017            ELSE
 17018               GO TO 3999-END-EDIT
 17019        ELSE
 17020            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17021               MOVE ER-2765           TO WS-ERROR
 17022               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17023               GO TO 3785-CHECK-NH.
 17024*              GO TO 3999-END-EDIT.
 17025
 17026 3780-UPDATE-CONT-1.
 17027     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17028
 17029     IF PB-CI-AH-BENEFIT-CD = ZERO
 17030         GO TO 3780-UPDATE-CONT-2.
 17031
 17032     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17033         GO TO 3780-UPDATE-CONT-2.
 17034
 17035     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17036
 17037     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17038       AND
 17039        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17040       AND
 17041        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17042       AND
 17043        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17044            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 308
* EL050.cbl
 17045       ELSE
 17046        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17047          AND
 17048***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17049***       AND
 17050           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17051           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17052            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17053               MOVE ER-2773      TO WS-ERROR
 17054               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17055               GO TO 3999-END-EDIT
 17056            ELSE
 17057               GO TO 3999-END-EDIT
 17058            END-IF
 17059           ELSE
 17060             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17061                IF MSTR-CERT-NO = W-CL-CERT-NO
 17062                   MOVE ER-2890 TO WS-ERROR
 17063                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17064                   GO TO 3999-END-EDIT
 17065                ELSE
 17066                   MOVE ER-2898 TO WS-ERROR
 17067                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17068                   GO TO 3999-END-EDIT
 17069                END-IF
 17070             ELSE
 17071                GO TO 3785-CHECK-NH
 17072             END-IF
 17073           END-IF
 17074          ELSE
 17075            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17076              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17077                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17078                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17079                      MOVE ER-2890 TO WS-ERROR
 17080                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17081                      GO TO 3999-END-EDIT
 17082                   ELSE
 17083                      MOVE ER-2898 TO WS-ERROR
 17084                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17085                      GO TO 3999-END-EDIT
 17086                   END-IF
 17087                ELSE
 17088                   MOVE ER-2765 TO WS-ERROR
 17089                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17090                   GO TO 3785-CHECK-NH
 17091                END-IF
 17092              ELSE
 17093               MOVE ER-2765      TO WS-ERROR
 17094               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17095               GO TO 3785-CHECK-NH.
 17096*              GO TO 3999-END-EDIT.
 17097
 17098 3780-UPDATE-CONT-2.
 17099
 17100     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17101        AND WS-LF-BENEFIT-CD = ZERO
 17102           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 309
* EL050.cbl
 17103           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17104
 17105     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17106        AND WS-AH-BENEFIT-CD = ZERO
 17107           MOVE ER-2744           TO WS-ERROR
 17108           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17109
 17110     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17111        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17112        AND
 17113        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17114         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17115           MOVE ER-2746           TO WS-ERROR
 17116           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17117
 17118     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17119       AND
 17120        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17121             MOVE ER-2737        TO WS-ERROR
 17122             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17123
 17124     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17125       AND
 17126        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17127             MOVE ER-2737        TO WS-ERROR
 17128             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17129
 17130     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17131         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17132             OR 'CID' OR 'DCC' OR 'AHL'
 17133             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17134         ELSE
 17135             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17136                 MOVE ER-2768    TO WS-ERROR
 17137                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17138             ELSE
 17139                 MOVE ER-2756    TO WS-ERROR
 17140                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17141
 17142     IF CERT-PEND-ISSUE-RETURNED
 17143        MOVE ER-2772             TO WS-ERROR
 17144        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17145 3785-CHECK-NH.
 17146     IF PB-STATE NOT = 'NH'
 17147        GO TO 3999-END-EDIT
 17148     END-IF
 17149
 17150     MOVE ER-2796                TO WS-ERROR
 17151     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17152     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17153        OR (CM-NH-INTERFACE-SW = 'Y')
 17154        MOVE ER-2793             TO WS-ERROR
 17155        PERFORM 9900-ERROR-FORMAT
 17156                                 THRU 9900-EXIT
 17157     END-IF
 17158     MOVE +0                     TO WS-PAYMENT-AMT
 17159     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 17160        GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 310
* EL050.cbl
 17161     END-IF
 17162     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17163        GO TO 3999-END-EDIT
 17164     END-IF
 17165     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17166     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17167     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17168        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17169     END-IF
 17170     MOVE '1'                    TO DC-OPTION-CODE
 17171     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17172     IF NO-CONVERSION-ERROR
 17173        IF DC-ELAPSED-DAYS < +16
 17174           GO TO 3999-END-EDIT
 17175        END-IF
 17176     END-IF
 17177     MOVE +0                     TO DC-ELAPSED-DAYS
 17178     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17179     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17180     MOVE '1'                    TO DC-OPTION-CODE
 17181     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17182     IF NO-CONVERSION-ERROR
 17183        IF DC-ELAPSED-DAYS > +30
 17184           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17185        ELSE
 17186           GO TO 3999-END-EDIT
 17187        END-IF
 17188     ELSE
 17189        GO TO 3999-END-EDIT
 17190     END-IF
 17191     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17192        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17193           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 17194     IF WS-PAYMENT-AMT < 600.00
 17195        GO TO 3999-END-EDIT
 17196     END-IF
 17197     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17198
 17199     IF (ERMAIL-FOUND = ' ')
 17200         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17201         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17202        GO TO 3999-END-EDIT
 17203     END-IF
 17204     MOVE ER-2795                TO WS-ERROR
 17205     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17206
 17207     GO TO 3999-END-EDIT.
 17208******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 311
* EL050.cbl
 17210 3990-FILES-NOT-OPEN.
 17211
 17212     MOVE ER-2617                TO WS-ERROR.
 17213     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17214     GO TO 9990-RETURN.
 17215
 17216 3999-END-EDIT.
 17217
 17218     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17219
 17220     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17221         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17222         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17223             PERFORM 9250-UNLOCK-RETURN
 17224             GO TO 9990-RETURN
 17225          ELSE
 17226             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17227             GO TO 9990-RETURN.
 17228
 17229     IF PB-CANCELLATION
 17230          GO TO 9990-RETURN.
 17231
 17232     IF CERT-WAS-NOT-FOUND
 17233        MOVE SPACES              TO CERTIFICATE-MASTER.
 17234
 17235     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17236
 17237     IF CERT-WAS-FOUND
 17238         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17239             PERFORM 9250-UNLOCK-RETURN
 17240          ELSE
 17241            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17242      ELSE
 17243         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17244
 17245     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17246        IF ((PB-COMPANY-ID = 'DCC')
 17247           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17248                         or
 17249            (pb-company-id = 'CID')
 17250            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17251        END-IF
 17252     END-IF.
 17253
 17254     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17255         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17256     END-IF.
 17257     move ' '                    to ws-ins-age-defaulted
 17258     perform 8150-read-elcrtt    thru 8150-exit
 17259     if ws-ins-age-defaulted = 'Y'
 17260        move er-1573             to ws-error
 17261        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17262     end-if
 17263
 17264     if ws-jnt-age-defaulted = 'Y'
 17265        move er-1574             to ws-error
 17266        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17267     end-if
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 312
* EL050.cbl
 17268***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17269***                                                           ****
 17270***  Set an error if the state requires verification of agent ****
 17271***  and agent hasn't verified yet and the status is not =    ****
 17272***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17273***  and the entry date > 09/01/2015.                         ****
 17274***                                                           ****
 17275***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17276     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17277        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17278        and (pb-account (9:2) not = 'OB')
 17279        if (ws-st-agent-sig-edit = 'Y')
 17280           and (am-report-code-1 not = 'CONLEY')
 17281           evaluate true
 17282              when cs-agent-edit-status = 'C'
 17283                 move er-1743    to ws-error
 17284                 perform 9900-error-format
 17285                                 thru 9900-exit
 17286              when cs-agent-edit-status = 'S'
 17287                 move er-1744    to ws-error
 17288                 perform 9900-error-format
 17289                                 thru 9900-exit
 17290              when cs-agent-edit-status = 'M'
 17291                 move er-1745    to ws-error
 17292                 perform 9900-error-format
 17293                                 thru 9900-exit
 17294              when cs-agent-edit-status = 'R'
 17295                 move er-1747    to ws-error
 17296                 perform 9900-error-format
 17297                                 thru 9900-exit
 17298              when cs-agent-edit-status = 'N'
 17299                 move er-1748    to ws-error
 17300                 perform 9900-error-format
 17301                                 thru 9900-exit
 17302              when cs-agent-edit-status <> 'V' and 'U' and
 17303                                           'R' and 'N'
 17304                 move er-1746    to ws-error
 17305                 perform 9900-error-format
 17306                                 thru 9900-exit
 17307           end-evaluate
 17308        end-if
 17309     end-if
 17310     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17311     IF ((PB-COMPANY-ID = 'DCC')
 17312        AND (WS-NO-SECURE-PAY))
 17313                  OR
 17314        (WS-LF-SPECIAL-CALC-CD = 'O'
 17315        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17316        SET SKIP-ADDR-EDIT       TO TRUE
 17317     END-IF
 17318     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17319        AND (NOT SKIP-ADDR-EDIT)
 17320        MOVE ER-2963             TO WS-ERROR
 17321        PERFORM 9900-ERROR-FORMAT
 17322                                 THRU 9900-EXIT
 17323        GO TO 9990-RETURN
 17324     END-IF
 17325     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 313
* EL050.cbl
 17326     IF ERPNDM-FOUND NOT = 'X'
 17327        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17328           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17329           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17330           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17331           AND (NOT SKIP-ADDR-EDIT)
 17332           MOVE ER-2694          TO WS-ERROR
 17333           PERFORM 9900-ERROR-FORMAT
 17334                                 THRU 9900-EXIT
 17335        END-IF
 17336        MOVE ' '                 TO STATE-RECORD-ERROR
 17337        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17338        MOVE PM-STATE            TO CNTL-ACCESS
 17339        MOVE '3'                 TO CNTL-REC-TYPE
 17340        MOVE +0                  TO CNTL-SEQ-NO
 17341        MOVE '0'                 TO RC-SW-2
 17342        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17343        IF (NO-STATE-RECORD)
 17344           OR (CF-RECORD-TYPE NOT = '3')
 17345           OR (PM-STATE NOT = CF-STATE-CODE)
 17346           IF (PM-STATE = SPACES)
 17347              AND (SKIP-ADDR-EDIT)
 17348              CONTINUE
 17349           ELSE
 17350              MOVE ER-2963       TO WS-ERROR
 17351              PERFORM 9900-ERROR-FORMAT
 17352                                 THRU 9900-EXIT
 17353           END-IF
 17354        END-IF
 17355        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17356           MOVE ER-2883          TO WS-ERROR
 17357           PERFORM 9900-ERROR-FORMAT
 17358                                 THRU 9900-EXIT
 17359        END-IF
 17360        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17361           MOVE ' '                 TO STATE-RECORD-ERROR
 17362           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17363           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17364           MOVE '3'                 TO CNTL-REC-TYPE
 17365           MOVE +0                  TO CNTL-SEQ-NO
 17366           MOVE '0'                 TO RC-SW-2
 17367           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17368           IF NO-STATE-RECORD
 17369              OR (CF-RECORD-TYPE NOT = '3')
 17370              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17371              MOVE ER-2964          TO WS-ERROR
 17372              PERFORM 9900-ERROR-FORMAT
 17373                                    THRU 9900-EXIT
 17374           END-IF
 17375        END-IF
 17376     ELSE
 17377        IF NOT SKIP-ADDR-EDIT
 17378           MOVE ER-2393          TO WS-ERROR
 17379           PERFORM 9900-ERROR-FORMAT
 17380                                 THRU 9900-EXIT
 17381        END-IF
 17382     END-IF
 17383
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 314
* EL050.cbl
 17384     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17385
 17386     IF (ERMAIL-FOUND = ' ' AND
 17387        ERPNDM-FOUND = ' ')
 17388        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17389           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17390           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17391          OR
 17392           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17393          OR
 17394           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17395           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17396           GO TO 3999-UNLOCK-ERMAIL.
 17397
 17398     IF ERPNDM-FOUND = 'X'
 17399        GO TO 3999-UNLOCK-ERMAIL.
 17400
 17401     IF PM-INSURED-LAST-NAME      = SPACES
 17402        AND PM-INSURED-FIRST-NAME = SPACES
 17403        AND PM-ADDRESS-LINE-1     = SPACES
 17404        AND PM-ADDRESS-LINE-2     = SPACES
 17405        AND PM-CITY-STATE         = SPACES
 17406        AND PM-CRED-BENE-NAME     = SPACES
 17407        AND PM-CRED-BENE-ADDR     = SPACES
 17408        AND PM-CRED-BENE-CTYST    = SPACES
 17409        GO TO 3999-UNLOCK-ERMAIL
 17410     END-IF
 17411
 17412     MOVE SPACES                 TO MAILING-DATA.
 17413
 17414     MOVE 'MA'                   TO MA-RECORD-ID.
 17415     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17416     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17417     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17418     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17419     MOVE PB-SV-STATE            TO MA-STATE.
 17420     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17421     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17422
 17423     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17424     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17425
 17426     IF ERMAIL-FOUND = ' '
 17427        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17428     ELSE
 17429        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17430        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17431        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17432
 17433     GO TO 9990-RETURN.
 17434
 17435 3999-UNLOCK-ERMAIL.
 17436     IF ERMAIL-FOUND = ' '
 17437        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17438
 17439     GO TO 9990-RETURN.
 17440******************************************************************
 17441
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 315
* EL050.cbl
 17443 4000-UPDATE-CANCELLED-CERT.
 17444     IF CERT-WAS-NOT-FOUND
 17445        GO TO 4299-EXIT.
 17446
 17447*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17448     IF PB-C-NH-INT-ON-REFS > ZEROS
 17449        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17450     END-IF
 17451     IF PB-C-REF-INTERFACE-SW = 'Y'
 17452        MOVE PB-C-REF-INTERFACE-SW
 17453                                 TO CM-NH-INTERFACE-SW
 17454     END-IF
 17455     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17456     IF ERMAIL-FOUND = 'X'
 17457        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17458        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17459        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17460        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17461           MOVE ER-2694          TO WS-ERROR
 17462           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17463     END-IF
 17464
 17465     IF PB-C-POST-CARD-IND = 'Y'
 17466        MOVE +8                  TO SUB
 17467*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17468        IF ERMAIL-FOUND = ' '
 17469           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17470              (SUB > +7)
 17471              OR (MA-MAIL-STATUS (SUB) = '1')
 17472           END-PERFORM
 17473        END-IF
 17474        IF (SUB > +7)
 17475           OR (ERMAIL-FOUND = 'X')
 17476           MOVE ER-3789          TO WS-ERROR
 17477           PERFORM 9900-ERROR-FORMAT
 17478                                 THRU 9900-EXIT
 17479        END-IF
 17480     ELSE
 17481        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17482     END-IF
 17483
 17484     IF ERMAIL-FOUND = ' '
 17485        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17486     END-IF.
 17487
 17488     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17489
 17490     IF PB-CI-OB-FLAG = 'Z'
 17491        GO TO 4150-SUMMARY-CERT-CANCEL.
 17492
 17493     IF PB-C-LF-CANCEL-VOIDED
 17494         PERFORM 4200-REVERSE-LF-CANCEL.
 17495     IF PB-C-AH-CANCEL-VOIDED
 17496         PERFORM 4200-REVERSE-AH-CANCEL.
 17497
 17498 4100-APPLY-LF-CANCEL.
 17499
 17500     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 316
* EL050.cbl
 17501
 17502 4100-CHECK-LF-ERRORS.
 17503
 17504     ADD +1                       TO WS-SUB.
 17505
 17506     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17507        IF LF-COVERAGE-CANCELLED
 17508           GO TO 4100-LF-CANCEL-CONT
 17509        ELSE
 17510           GO TO 4100-UPDATE-LF-COVERAGE.
 17511
 17512     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17513                                   ER-2729 OR
 17514                                   ER-2730 OR
 17515                                   ER-2731 OR
 17516                                   ER-2732 OR
 17517                                   ER-2737 OR
 17518                                   ER-2740 OR
 17519                                   ER-2743 OR
 17520                                   ER-2749 OR
 17521                                   ER-2750 OR
 17522                                   ER-2755 OR
 17523                                   ER-2757 OR
 17524                                   ER-2760 OR
 17525                                   ER-2772 OR
 17526                                   ER-2774 OR
 17527                                   ER-2776 OR
 17528                                   ER-2794
 17529        GO TO 4100-UPDATE-LF-COVERAGE.
 17530
 17531     GO TO 4100-CHECK-LF-ERRORS.
 17532
 17533 4100-UPDATE-LF-COVERAGE.
 17534
 17535     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17536     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17537     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17538        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17539     END-IF
 17540     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17541                                      TO CM-CREDIT-INTERFACE-SW-2.
 17542     IF CM-LF-CANCEL-DT = LOW-VALUE
 17543         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17544
 17545     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17546         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17547                                         CM-LF-STATUS-AT-CANCEL.
 17548
 17549     GO TO 4100-APPLY-AH-CANCEL.
 17550
 17551 4100-LF-CANCEL-CONT.
 17552     IF PB-C-LF-CANCEL-VOIDED
 17553         GO TO 4100-APPLY-AH-CANCEL.
 17554
 17555     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17556         GO TO 4100-APPLY-AH-CANCEL.
 17557
 17558     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 317
* EL050.cbl
 17559        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17560           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17561        ELSE
 17562           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17563
 17564     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17565     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17566
 17567     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17568         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17569
 17570     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17571        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17572         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17573         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17574
 17575     IF PB-RECORD-RETURNED
 17576        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17577      ELSE
 17578        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17579
 17580 4100-APPLY-AH-CANCEL.
 17581
 17582     MOVE +0                      TO WS-SUB.
 17583
 17584 4100-CHECK-AH-ERRORS.
 17585
 17586     ADD +1                       TO WS-SUB.
 17587
 17588     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17589        IF AH-COVERAGE-CANCELLED
 17590           GO TO 4100-AH-CANCEL-CONT
 17591        ELSE
 17592           GO TO 4100-UPDATE-AH-COVERAGE.
 17593
 17594     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17595                                   ER-2729 OR
 17596                                   ER-2732 OR
 17597                                   ER-2737 OR
 17598                                   ER-2740 OR
 17599                                   ER-2744 OR
 17600                                   ER-2749 OR
 17601                                   ER-2750 OR
 17602                                   ER-2755 OR
 17603                                   ER-2757 OR
 17604                                   ER-2760 OR
 17605                                   ER-2771 OR
 17606                                   ER-2772 OR
 17607                                   ER-2773 OR
 17608                                   ER-2775 OR
 17609                                   ER-2777 OR
 17610                                   ER-2778 OR
 17611                                   ER-2794
 17612        GO TO 4100-UPDATE-AH-COVERAGE.
 17613
 17614     GO TO 4100-CHECK-AH-ERRORS.
 17615
 17616 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 318
* EL050.cbl
 17617
 17618     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17619     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17620     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17621     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17622                                      TO CM-CREDIT-INTERFACE-SW-2.
 17623     IF CM-AH-CANCEL-DT = LOW-VALUE
 17624         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17625
 17626     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17627         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17628                                         CM-AH-STATUS-AT-CANCEL.
 17629
 17630     IF LF-COVERAGE-CANCELLED
 17631         IF PB-RECORD-RETURNED
 17632              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17633          ELSE
 17634              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17635
 17636     GO TO 4299-EXIT.
 17637
 17638 4100-AH-CANCEL-CONT.
 17639     IF PB-C-AH-CANCEL-VOIDED
 17640         GO TO 4299-EXIT.
 17641
 17642     if cm-credit-interface-sw-2 = ' '
 17643        if pb-fatal-errors or pb-unforced-errors
 17644           move '4'              to cm-credit-interface-sw-2
 17645        else
 17646           move '1'              to cm-credit-interface-sw-2
 17647        end-if
 17648     end-if
 17649     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17650         GO TO 4299-EXIT.
 17651
 17652     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17653        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17654           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17655        ELSE
 17656           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17657
 17658     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17659     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17660
 17661     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17662         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17663
 17664     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17665         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17666         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17667
 17668     IF PB-RECORD-RETURNED
 17669        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17670      ELSE
 17671        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17672
 17673     GO TO 4299-EXIT.
 17674
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 319
* EL050.cbl
 17675 4150-SUMMARY-CERT-CANCEL.
 17676     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17677
 17678     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17679        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17680                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17681     ELSE
 17682        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17683                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17684
 17685     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17686        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17687                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17688     ELSE
 17689        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17690                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17691
 17692     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17693        NEXT SENTENCE
 17694     ELSE
 17695        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17696
 17697     GO TO 4299-EXIT.
 17698
 17699 4200-REVERSE-LF-CANCEL.
 17700     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17701
 17702     IF CM-LF-CANCEL-APPLIED
 17703        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17704        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17705        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17706
 17707     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17708
 17709     IF PB-RECORD-RETURNED
 17710        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17711       ELSE
 17712        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17713
 17714 4200-REVERSE-LF-EXIT.
 17715       EXIT.
 17716
 17717 4200-REVERSE-AH-CANCEL.
 17718     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17719
 17720     IF CM-AH-CANCEL-APPLIED
 17721        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17722        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17723        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17724
 17725     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17726
 17727     IF PB-RECORD-RETURNED
 17728        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17729       ELSE
 17730        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17731
 17732 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 320
* EL050.cbl
 17733       EXIT.
 17734
 17735 4299-EXIT.
 17736       EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 321
* EL050.cbl
 17738
 17739 4500-UPDATE-NEW-CERT.
 17740     IF CERT-WAS-FOUND
 17741         NEXT SENTENCE
 17742       ELSE
 17743         GO TO 4520-BUILD-NEW-KEY.
 17744
 17745     IF  CLASIC-CREATED-CERT
 17746         GO TO 4999-EXIT.
 17747
 17748     IF  CERT-WAS-CREATED-FOR-CLAIM
 17749         GO TO 4520-BUILD-NEW-KEY.
 17750
 17751     IF CERT-ADDED-BATCH
 17752        IF CM-RECORD-ID = 'CM'
 17753            GO TO 4999-EXIT.
 17754
 17755 4520-BUILD-NEW-KEY.
 17756* BUILD CONTROL PRIMARY
 17757
 17758     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17759                                       CM-COMPANY-CD-A1
 17760                                       CM-COMPANY-CD-A2
 17761                                       CM-COMPANY-CD-A4
 17762                                       CM-COMPANY-CD-A5.
 17763
 17764     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17765     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17766     MOVE PB-SV-STATE               TO CM-STATE.
 17767     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17768     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17769     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17770     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17771
 17772     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17773
 17774     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17775     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17776     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17777     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17778
 17779     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17780        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17781
 17782     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17783         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17784         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17785         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17786         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17787     ELSE
 17788         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17789
 17790     IF PB-COMPANY-ID   EQUAL  'CRI'
 17791         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17792         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17793         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17794         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17795         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 322
* EL050.cbl
 17796
 17797     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17798        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17799         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17800
 17801     IF PB-COMPANY-ID  = 'LBL'
 17802        IF PB-I-JOINT-COVERAGE
 17803            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17804                                           PB-I-MEMBER-NO
 17805            GO TO 4550-CONT-CERT-PROCESS.
 17806
 17807     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17808        NEXT SENTENCE
 17809     ELSE
 17810        GO TO 4540-BUILD-MEMBER-NO.
 17811
 17812******************************************************************
 17813*                                                                *
 17814*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17815*    FOR 'MON'.                                                  *
 17816*                                                                *
 17817******************************************************************
 17818
 17819     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17820     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17821     MOVE +1                     TO WS-SUB1
 17822                                    WS-SUB2.
 17823
 17824 4530-EDIT-MEMB-NAME.
 17825
 17826     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17827        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17828        ADD +1                       TO WS-SUB2.
 17829
 17830     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17831        ADD +1                       TO WS-SUB1
 17832        GO TO 4530-EDIT-MEMB-NAME.
 17833
 17834     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17835     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17836     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17837*    MOVE SPACE                      TO DC-OPTION-CODE.
 17838     SET  BIN-TO-GREG                TO TRUE.
 17839     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17840     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17841
 17842     GO TO 4550-CONT-CERT-PROCESS.
 17843
 17844******************************************************************
 17845*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17846******************************************************************
 17847
 17848 4540-BUILD-MEMBER-NO.
 17849
 17850     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17851         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17852         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17853         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 323
* EL050.cbl
 17854         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17855     ELSE
 17856         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17857
 17858     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17859        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17860         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17861
 17862 4550-CONT-CERT-PROCESS.
 17863
 17864*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17865*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17866*    ELSE
 17867*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17868
 17869     IF CERT-WAS-CREATED-FOR-CLAIM
 17870        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17871        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17872
 17873     IF CERT-AND-CLAIM-ONLINE
 17874        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17875        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17876
 17877     MOVE 'CM'                     TO CM-RECORD-ID.
 17878     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17879
 17880     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17881        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17882        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17883     ELSE
 17884        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17885        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17886
 17887     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17888     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17889     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17890     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17891     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17892     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17893     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17894                                      CM-LF-ITD-CANCEL-AMT
 17895                                      CM-LF-ITD-DEATH-AMT
 17896                                      CM-AH-ITD-AH-PMT
 17897                                      CM-AH-ITD-LUMP-PMT
 17898                                      CM-AH-ITD-CANCEL-AMT
 17899                                      CM-LF-NSP-PREMIUM-AMT
 17900                                      CM-AH-NSP-PREMIUM-AMT.
 17901*                                     CM-CLAIM-DEDUCT-WITHHELD
 17902*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17903     if pb-i-loan-apr = +99.9999
 17904        move zeros                 to cm-loan-apr
 17905     else
 17906        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17907     end-if
 17908     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17909     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17910     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17911     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 324
* EL050.cbl
 17912     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17913     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17914     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17915     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17916     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17917     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17918     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17919
 17920     IF PB-I-LIVES NOT NUMERIC
 17921         MOVE ZERO                 TO PB-I-LIVES.
 17922
 17923     IF PB-I-NUM-BILLED NOT NUMERIC
 17924         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17925
 17926     MOVE PB-I-LIVES               TO CM-LIVES.
 17927     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17928
 17929     IF PB-COMPANY-ID EQUAL  'DMD'
 17930         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17931         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17932
 17933     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17934     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17935     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17936     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17937     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17938     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17939
 17940     IF PB-I-LF-POLICY-FEE NUMERIC
 17941        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17942     ELSE
 17943        MOVE +0                    TO CM-LF-POLICY-FEE.
 17944
 17945     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17946        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17947        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17948     ELSE
 17949        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17950
 17951     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17952     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17953     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17954     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17955     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17956     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17957     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17958     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17959     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17960
 17961     IF PB-I-AH-POLICY-FEE NUMERIC
 17962        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17963     ELSE
 17964        MOVE +0                    TO CM-AH-POLICY-FEE.
 17965
 17966     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17967        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17968     ELSE
 17969        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 325
* EL050.cbl
 17970
 17971     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17972     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17973
 17974     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17975                                      CM-LF-DEATH-EXIT-DT
 17976                                      CM-AH-SETTLEMENT-EXIT-DT.
 17977
 17978*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17979*                       'TIH' OR 'OFL' OR 'FLA' OR
 17980*                       'TII' OR 'TMS' OR 'CRI' OR
 17981*                       'NCL'
 17982     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 17983
 17984     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 17985         IF WS-LF-SPECIAL-CALC-CD = 'O'
 17986            MOVE '2'                TO CM-PREMIUM-TYPE.
 17987
 17988     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 17989         IF WS-AH-SPECIAL-CALC-CD = 'O'
 17990            MOVE '2'                TO CM-PREMIUM-TYPE.
 17991
 17992     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 17993         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 17994     ELSE
 17995         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 17996         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 17997
 17998     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 17999     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18000     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18001     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18002     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18003     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18004     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18005     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18006
 18007     IF PB-NO-MONTHS-SKIPPED
 18008         MOVE SPACE                 TO CM-SKIP-CODE
 18009     ELSE
 18010         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18011
 18012     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18013     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18014                                       CM-LF-STATUS-AT-CANCEL.
 18015
 18016     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18017     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18018                                       CM-AH-STATUS-AT-CANCEL.
 18019
 18020     MOVE '1'                       TO CM-ENTRY-STATUS.
 18021
 18022     IF PB-REISSUED-CERT
 18023        MOVE '5'                    TO CM-ENTRY-STATUS.
 18024
 18025     IF PB-MONTHLY-CERT
 18026        MOVE 'M'                    TO CM-ENTRY-STATUS.
 18027
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 326
* EL050.cbl
 18028     IF PB-CASH-CERT
 18029        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18030
 18031     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18032     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18033     IF PB-POLICY-IS-DECLINED
 18034        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18035
 18036     IF PB-POLICY-IS-VOIDED
 18037        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18038
 18039     IF PB-NEEDS-UNDERWRITING
 18040        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18041
 18042     IF PB-REIN-ONLY-CERT
 18043        MOVE '9'                    TO CM-ENTRY-STATUS.
 18044
 18045     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18046         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18047     ELSE
 18048         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18049
 18050     IF PB-RECORD-RETURNED
 18051        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18052      ELSE
 18053        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18054
 18055     IF PB-I-MAIL-ADDRS-PRESENT
 18056        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18057
 18058     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18059                                       CM-ENTRY-DT.
 18060
 18061 4999-EXIT.
 18062     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 327
* EL050.cbl
 18064
 18065 5000-PROCESS-REPS.
 18066     MOVE ' '                    TO AGTC-MASTER-SW
 18067     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18068     MOVE CO-TYPE                TO AGTC-TYPE
 18069     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18070     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18071     IF (AGTC-MASTER-SW NOT = 'N')
 18072        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18073        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18074        PERFORM 8583-READ-ERAGTC-NEXT
 18075                                 THRU 8583-EXIT
 18076     END-IF
 18077     IF AGTC-MASTER-SW = 'N'
 18078        CONTINUE
 18079     ELSE
 18080        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18081           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18082              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18083              MOVE 'Y'           TO AGTC-MASTER-SW
 18084           END-IF
 18085        END-IF
 18086     END-IF
 18087     .
 18088 5000-EXIT.
 18089     EXIT.
 18090 6370-EDIT-INPUT-LF-CODE.
 18091     move ' ' to ws-benefit-cd-chg-sw
 18092     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18093        MOVE +1                  TO SUB
 18094        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18095        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18096        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18097        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18098        GO TO 6370-SEARCH-LOOP.
 18099
 18100     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18101
 18102     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18103     MOVE SPACES                 TO CNTL-ACCESS.
 18104*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18105     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18106     MOVE +0                     TO CNTL-SEQ-NO.
 18107     MOVE '4' TO RC-SW-2.
 18108     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18109
 18110     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18111        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18112        GO TO 6370-NO-LF-FOUND.
 18113
 18114     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18115     MOVE +1                     TO SUB.
 18116
 18117 6370-SEARCH-LOOP.
 18118     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18119         GO TO 6370-NO-LF-FOUND.
 18120
 18121     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 328
* EL050.cbl
 18122        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18123           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18124           set benefit-code-chg to true
 18125        end-if
 18126        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18127        GO TO 6370-HER-NET-PAY-CHECK.
 18128
 18129     ADD 1   TO SUB.
 18130*    IF SUB GREATER 120
 18131     IF SUB GREATER 200
 18132         GO TO 6370-NO-LF-FOUND.
 18133
 18134     GO TO 6370-SEARCH-LOOP.
 18135
 18136 6370-NO-LF-FOUND.
 18137
 18138     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18139        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18140        set benefit-code-chg to true
 18141     end-if
 18142     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18143
 18144 6370-HER-NET-PAY-CHECK.
 18145
 18146     IF PB-COMPANY-ID = 'CID'
 18147        IF PB-SV-STATE = 'CA' OR 'MN'
 18148           IF PB-I-LF-BENEFIT-CD = '02'
 18149              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18150           ELSE
 18151              IF PB-I-LF-BENEFIT-CD = '04'
 18152                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18153              END-IF
 18154           END-IF
 18155        END-IF
 18156     END-IF
 18157
 18158     IF PB-COMPANY-ID NOT = 'HER'
 18159         GO TO 6370-EXIT.
 18160
 18161     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18162         GO TO 6370-EXIT.
 18163
 18164     IF PB-I-LF-TERM NOT NUMERIC
 18165         MOVE ZEROS              TO PB-I-LF-TERM.
 18166
 18167     IF PB-I-LOAN-TERM NOT NUMERIC
 18168         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18169
 18170     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18171         GO TO 6370-EXIT.
 18172
 18173     IF PB-I-LF-BENEFIT-CD = '33'
 18174         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18175
 18176     IF PB-I-LF-BENEFIT-CD = '34'
 18177         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18178
 18179 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 329
* EL050.cbl
 18180     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 330
* EL050.cbl
 18182
 18183 6380-EDIT-INPUT-AH-CODE.
 18184     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18185        MOVE +1                  TO SUB
 18186        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18187        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18188        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18189        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18190        GO TO 6380-SEARCH-LOOP.
 18191
 18192     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18193
 18194     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18195     MOVE SPACES                 TO CNTL-ACCESS.
 18196     MOVE 'A'                    TO CNTL-REC-TYPE.
 18197*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18198     MOVE +0                     TO CNTL-SEQ-NO.
 18199     MOVE '5' TO RC-SW-2.
 18200     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18201
 18202     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18203        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18204        GO TO 6380-NO-AH-FOUND.
 18205
 18206     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18207     MOVE +1 TO SUB.
 18208
 18209 6380-SEARCH-LOOP.
 18210     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18211         GO TO 6380-NO-AH-FOUND.
 18212
 18213     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18214         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18215         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18216
 18217     ADD 1   TO SUB.
 18218     IF SUB GREATER THAN 96
 18219*    IF SUB GREATER THAN 300
 18220         GO TO 6380-NO-AH-FOUND.
 18221
 18222     GO TO 6380-SEARCH-LOOP.
 18223
 18224 6380-NO-AH-FOUND.
 18225
 18226     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18227
 18228     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18229         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18230     ELSE
 18231         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18232
 18233 6380-CSO-AH-ONLY-CHECKS.
 18234
 18235     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18236        NEXT SENTENCE
 18237      ELSE
 18238        GO TO 6380-EXIT.
 18239
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 331
* EL050.cbl
 18240     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18241         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18242
 18243
 18244     GO TO 6380-EXIT
 18245     .
 18246 6380-CSO-LIFE-WITH-AH-CHECKS.
 18247
 18248
 18249     .
 18250 6380-EXIT.
 18251     EXIT.
 18252
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 332
* EL050.cbl
 18254
 18255 6400-COMPUTE-EXTENSION-DAYS.
 18256
 18257******************************************************************
 18258*                                                                *
 18259*                   COMPUTE EXTENSION DAYS                       *
 18260*                                                                *
 18261*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18262*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18263*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18264*    THE EXTENSION DAYS.                                         *
 18265*                                                                *
 18266******************************************************************
 18267
 18268     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18269     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18270
 18271******************************************************************
 18272*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18273*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18274******************************************************************
 18275
 18276     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18277        COMPUTE WS-ODD-DAYS-OVER =
 18278               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18279     ELSE
 18280        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18281
 18282     IF WS-ODD-DAYS-OVER = ZEROS
 18283           GO TO 6499-EXIT
 18284     ELSE
 18285        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18286           IF WS-WDF-MONTH = 02
 18287              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18288              ADD 2       TO  WS-ODD-DAYS-OVER
 18289              GO TO 6499-EXIT
 18290           ELSE
 18291              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18292                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18293                 GO TO 6499-EXIT
 18294               ELSE
 18295                 GO TO 6499-EXIT
 18296        ELSE
 18297           GO TO 6499-EXIT.
 18298
 18299 6412-CHECK-TO-DAY.
 18300
 18301        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18302           IF WS-WDT-DAY = 28
 18303              ADD 2              TO WS-ODD-DAYS-OVER
 18304           ELSE
 18305              IF WS-WDT-DAY = 29
 18306                 ADD 1           TO WS-ODD-DAYS-OVER
 18307              ELSE
 18308                 NEXT SENTENCE
 18309        ELSE
 18310           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18311              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 333
* EL050.cbl
 18312
 18313     GO TO 6499-EXIT.
 18314
 18315
 18316 6415-CHECK-LEAP-YEAR.
 18317
 18318     IF DC-DAYS-IN-MONTH = 29
 18319        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18320
 18321 6415-EXIT.
 18322     EXIT.
 18323
 18324 6499-EXIT.
 18325      EXIT.
 18326
 18327 6500-END.
 18328     EXIT.
 18329
 18330
 18331******************************************************************
 18332************* PROCEDURE DIVISION FOR EL050 ***********************
 18333********************** ELC50PD END *******************************
 18334
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 334
* EL050.cbl
 18336
 18337**START***********************************************************
 18338*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18339*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18340******************************************************************
 18341*
 18342 6600-GET-STATE-MUNICIPAL-TAX.
 18343
 18344     IF PB-COMPANY-ID NOT = 'DMD'
 18345         GO TO 6640-EXIT.
 18346
 18347     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18348     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18349     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18350*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18351*
 18352***  Y2K PROJ 7744
 18353     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18354     SET BIN-TO-GREG          TO TRUE.
 18355     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18356
 18357     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18358
 18359     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18360     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18361
 18362
 18363* EXEC CICS HANDLE CONDITION
 18364*        INVREQ    (6610-START-BROWSE)
 18365*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18366*        NOTFND    (6630-END-OF-FILE)
 18367*    END-EXEC.
 18368*    MOVE '"$8JI                 ! # #00018350' TO DFHEIV0
 18369     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18371     MOVE X'2320233030303138333530' TO DFHEIV0(25:11)
 18372     CALL 'kxdfhei1' USING DFHEIV0
 18373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18374
 18375
 18376 6610-START-BROWSE.
 18377
 18378
 18379* EXEC CICS HANDLE CONDITION
 18380*        NOTFND    (6630-END-OF-FILE)
 18381*        DISABLED  (6630-ERRESS-PROBLEM)
 18382*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18383*        ENDFILE   (6630-END-OF-FILE)
 18384*    END-EXEC.
 18385*    MOVE '"$IcJ''                ! $ #00018358' TO DFHEIV0
 18386     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18388     MOVE X'2420233030303138333538' TO DFHEIV0(25:11)
 18389     CALL 'kxdfhei1' USING DFHEIV0
 18390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18391
 18392
 18393
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 335
* EL050.cbl
 18394* EXEC CICS STARTBR
 18395*        DATASET (FILE-ID-ERRESS)
 18396*        RIDFLD  (WS-ERRESS-KEY)
 18397*        GTEQ
 18398*    END-EXEC.
 18399     MOVE 0
 18400       TO DFHEIV11
 18401*    MOVE '&,         G          &   #00018365' TO DFHEIV0
 18402     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18403     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18404     MOVE X'2020233030303138333635' TO DFHEIV0(25:11)
 18405     CALL 'kxdfhei1' USING DFHEIV0,
 18406           FILE-ID-ERRESS,
 18407           WS-ERRESS-KEY,
 18408           DFHEIV99,
 18409           DFHEIV11,
 18410           DFHEIV99
 18411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18412
 18413
 18414 6620-READ-NEXT-ERRESS-MASTER.
 18415
 18416
 18417* EXEC CICS HANDLE CONDITION
 18418*        NOTFND    (6630-END-OF-FILE)
 18419*        ENDFILE   (6630-END-OF-FILE)
 18420*        DISABLED  (6630-ERRESS-PROBLEM)
 18421*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18422*    END-EXEC.
 18423*    MOVE '"$I''cJ                ! % #00018373' TO DFHEIV0
 18424     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18426     MOVE X'2520233030303138333733' TO DFHEIV0(25:11)
 18427     CALL 'kxdfhei1' USING DFHEIV0
 18428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18429
 18430
 18431
 18432* EXEC CICS READNEXT
 18433*        DATASET (FILE-ID-ERRESS)
 18434*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18435*        RIDFLD  (WS-ERRESS-KEY)
 18436*    END-EXEC.
 18437     MOVE LENGTH OF
 18438      RESIDENT-STATE-TAX-MASTER
 18439       TO DFHEIV12
 18440     MOVE 0
 18441       TO DFHEIV11
 18442*    MOVE '&.IL                  )   #00018380' TO DFHEIV0
 18443     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18444     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18445     MOVE X'2020233030303138333830' TO DFHEIV0(25:11)
 18446     CALL 'kxdfhei1' USING DFHEIV0,
 18447           FILE-ID-ERRESS,
 18448           RESIDENT-STATE-TAX-MASTER,
 18449           DFHEIV12,
 18450           WS-ERRESS-KEY,
 18451           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 336
* EL050.cbl
 18452           DFHEIV11,
 18453           DFHEIV99,
 18454           DFHEIV99
 18455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18456
 18457
 18458     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18459
 18460* EXEC CICS ENDBR
 18461*            DATASET (FILE-ID-ERRESS)
 18462*       END-EXEC
 18463     MOVE 0
 18464       TO DFHEIV11
 18465*    MOVE '&2                    $   #00018387' TO DFHEIV0
 18466     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18467     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18468     MOVE X'2020233030303138333837' TO DFHEIV0(25:11)
 18469     CALL 'kxdfhei1' USING DFHEIV0,
 18470           FILE-ID-ERRESS,
 18471           DFHEIV11,
 18472           DFHEIV99
 18473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18474        GO TO 6630-END-OF-FILE.
 18475
 18476     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18477        NEXT SENTENCE
 18478      ELSE
 18479        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18480
 18481*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18482*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18483*
 18484     MOVE +2                     TO WS-SUB1.
 18485
 18486     IF PB-ISSUE
 18487     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18488        MOVE +1                  TO WS-SUB1.
 18489
 18490     IF PB-CANCELLATION
 18491     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18492        MOVE +1                  TO WS-SUB1.
 18493*
 18494*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18495*
 18496***  Y2K PROJ 7744
 18497     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18498***  Y2K PROJ 7744
 18499
 18500*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18501* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18502* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18503
 18504     ADD 1                    TO WS-YEAR-YY.
 18505
 18506     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18507         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18508                              TO WS-RES-STATE-TAX
 18509         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 337
* EL050.cbl
 18510                              TO WS-RES-MUNI-TAX
 18511     ELSE
 18512         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18513                              TO WS-RES-STATE-TAX
 18514         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18515                              TO WS-RES-MUNI-TAX.
 18516
 18517*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18518
 18519     IF PB-CANCELLATION
 18520         GO TO 6640-CANCEL-TAX.
 18521
 18522     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18523         COMPUTE PB-I-STATE-TAX ROUNDED =
 18524                                   PB-I-LF-PREMIUM-AMT
 18525                                 * WS-RES-STATE-TAX
 18526         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18527                                   PB-I-LF-PREMIUM-AMT
 18528                                 * WS-RES-MUNI-TAX
 18529     ELSE
 18530     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18531         COMPUTE PB-I-STATE-TAX ROUNDED =
 18532                                   PB-I-AH-PREMIUM-AMT
 18533                                 * WS-RES-STATE-TAX
 18534         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18535                                   PB-I-AH-PREMIUM-AMT
 18536                                 * WS-RES-MUNI-TAX.
 18537
 18538
 18539* EXEC CICS ENDBR
 18540*         DATASET (FILE-ID-ERRESS)
 18541*    END-EXEC.
 18542     MOVE 0
 18543       TO DFHEIV11
 18544*    MOVE '&2                    $   #00018454' TO DFHEIV0
 18545     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18546     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18547     MOVE X'2020233030303138343534' TO DFHEIV0(25:11)
 18548     CALL 'kxdfhei1' USING DFHEIV0,
 18549           FILE-ID-ERRESS,
 18550           DFHEIV11,
 18551           DFHEIV99
 18552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18553
 18554
 18555     GO TO 6640-EXIT.
 18556
 18557 6640-CANCEL-TAX.
 18558     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18559
 18560     IF PB-C-LF-CANCEL-AMT > ZEROS
 18561         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18562                                   PB-C-LF-CANCEL-AMT
 18563                                 * WS-RES-STATE-TAX
 18564         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18565                                   PB-C-LF-CANCEL-AMT
 18566                                *  WS-RES-MUNI-TAX
 18567     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 338
* EL050.cbl
 18568     IF PB-C-AH-CANCEL-AMT > ZEROS
 18569         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18570                                   PB-C-AH-CANCEL-AMT
 18571                                 * WS-RES-STATE-TAX
 18572         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18573                                   PB-C-AH-CANCEL-AMT
 18574                                *  WS-RES-MUNI-TAX.
 18575
 18576
 18577* EXEC CICS ENDBR
 18578*         DATASET (FILE-ID-ERRESS)
 18579*    END-EXEC.
 18580     MOVE 0
 18581       TO DFHEIV11
 18582*    MOVE '&2                    $   #00018479' TO DFHEIV0
 18583     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18584     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18585     MOVE X'2020233030303138343739' TO DFHEIV0(25:11)
 18586     CALL 'kxdfhei1' USING DFHEIV0,
 18587           FILE-ID-ERRESS,
 18588           DFHEIV11,
 18589           DFHEIV99
 18590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18591
 18592
 18593     GO TO 6640-EXIT.
 18594
 18595 6630-END-OF-FILE.
 18596     MOVE ER-8002              TO WS-ERROR.
 18597     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18598
 18599     GO TO 6640-EXIT.
 18600
 18601 6630-ERRESS-PROBLEM.
 18602     MOVE ER-8044              TO WS-ERROR.
 18603     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18604
 18605 6640-EXIT.
 18606     EXIT.
 18607
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 339
* EL050.cbl
 18609 6650-GET-RES-STATE-COMM.
 18610
 18611     IF PB-COMPANY-ID NOT = 'DMD'
 18612         GO TO 6700-COMM-EXIT.
 18613
 18614     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18615     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18616     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18617     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18618     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18619     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18620     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18621
 18622*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18623*
 18624***  Y2K PROJ 7744
 18625     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18626     SET BIN-TO-GREG          TO TRUE.
 18627     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18628
 18629     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18630***  Y2K PROJ 7744
 18631
 18632     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18633
 18634
 18635* EXEC CICS HANDLE CONDITION
 18636*        INVREQ    (6660-START-BROWSE)
 18637*        DISABLED  (6690-ERRESC-PROBLEM)
 18638*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18639*        NOTFND    (6690-END-OF-FILE)
 18640*    END-EXEC.
 18641*    MOVE '"$8cJI                ! & #00018524' TO DFHEIV0
 18642     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18643     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18644     MOVE X'2620233030303138353234' TO DFHEIV0(25:11)
 18645     CALL 'kxdfhei1' USING DFHEIV0
 18646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18647
 18648
 18649
 18650* EXEC CICS RESETBR
 18651*        DATASET (FILE-ID-ERRESC)
 18652*        RIDFLD  (WS-ERRESC-KEY)
 18653*    END-EXEC.
 18654     MOVE 0
 18655       TO DFHEIV11
 18656*    MOVE '&4         G          &   #00018531' TO DFHEIV0
 18657     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18658     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18659     MOVE X'2020233030303138353331' TO DFHEIV0(25:11)
 18660     CALL 'kxdfhei1' USING DFHEIV0,
 18661           FILE-ID-ERRESC,
 18662           WS-ERRESC-KEY,
 18663           DFHEIV99,
 18664           DFHEIV11,
 18665           DFHEIV99
 18666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 340
* EL050.cbl
 18667
 18668
 18669 6660-START-BROWSE.
 18670
 18671
 18672* EXEC CICS HANDLE CONDITION
 18673*        NOTFND    (6690-END-OF-FILE)
 18674*        DISABLED  (6690-ERRESC-PROBLEM)
 18675*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18676*        ENDFILE   (6690-END-OF-FILE)
 18677*    END-EXEC.
 18678*    MOVE '"$IcJ''                ! '' #00018538' TO DFHEIV0
 18679     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18680     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18681     MOVE X'2720233030303138353338' TO DFHEIV0(25:11)
 18682     CALL 'kxdfhei1' USING DFHEIV0
 18683     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18684
 18685
 18686
 18687* EXEC CICS STARTBR
 18688*        DATASET (FILE-ID-ERRESC)
 18689*        RIDFLD  (WS-ERRESC-KEY)
 18690*        GTEQ
 18691*    END-EXEC.
 18692     MOVE 0
 18693       TO DFHEIV11
 18694*    MOVE '&,         G          &   #00018545' TO DFHEIV0
 18695     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18696     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18697     MOVE X'2020233030303138353435' TO DFHEIV0(25:11)
 18698     CALL 'kxdfhei1' USING DFHEIV0,
 18699           FILE-ID-ERRESC,
 18700           WS-ERRESC-KEY,
 18701           DFHEIV99,
 18702           DFHEIV11,
 18703           DFHEIV99
 18704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18705
 18706
 18707     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18708
 18709 6670-READ-NEXT-ERRESC-MASTER.
 18710
 18711
 18712* EXEC CICS HANDLE CONDITION
 18713*        NOTFND    (6690-END-OF-FILE)
 18714*        DISABLED  (6690-ERRESC-PROBLEM)
 18715*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18716*        ENDFILE   (6690-END-OF-FILE)
 18717*    END-EXEC.
 18718*    MOVE '"$IcJ''                ! ( #00018555' TO DFHEIV0
 18719     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18720     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18721     MOVE X'2820233030303138353535' TO DFHEIV0(25:11)
 18722     CALL 'kxdfhei1' USING DFHEIV0
 18723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18724
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 341
* EL050.cbl
 18725
 18726
 18727* EXEC CICS READNEXT
 18728*        DATASET (FILE-ID-ERRESC)
 18729*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18730*        RIDFLD  (ERRESC-RECORD-KEY)
 18731*    END-EXEC.
 18732     MOVE LENGTH OF
 18733      ACCOUNT-RESIDENT-ST-COMMISSION
 18734       TO DFHEIV12
 18735     MOVE 0
 18736       TO DFHEIV11
 18737*    MOVE '&.IL                  )   #00018562' TO DFHEIV0
 18738     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18739     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18740     MOVE X'2020233030303138353632' TO DFHEIV0(25:11)
 18741     CALL 'kxdfhei1' USING DFHEIV0,
 18742           FILE-ID-ERRESC,
 18743           ACCOUNT-RESIDENT-ST-COMMISSION,
 18744           DFHEIV12,
 18745           ERRESC-RECORD-KEY,
 18746           DFHEIV99,
 18747           DFHEIV11,
 18748           DFHEIV99,
 18749           DFHEIV99
 18750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18751
 18752
 18753     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18754        NEXT SENTENCE
 18755     ELSE
 18756
 18757* EXEC CICS ENDBR
 18758*            DATASET (FILE-ID-ERRESC)
 18759*       END-EXEC
 18760     MOVE 0
 18761       TO DFHEIV11
 18762*    MOVE '&2                    $   #00018571' TO DFHEIV0
 18763     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18764     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18765     MOVE X'2020233030303138353731' TO DFHEIV0(25:11)
 18766     CALL 'kxdfhei1' USING DFHEIV0,
 18767           FILE-ID-ERRESC,
 18768           DFHEIV11,
 18769           DFHEIV99
 18770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18771        GO TO 6690-END-OF-FILE.
 18772
 18773     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18774
 18775* EXEC CICS ENDBR
 18776*            DATASET (FILE-ID-ERRESC)
 18777*       END-EXEC
 18778     MOVE 0
 18779       TO DFHEIV11
 18780*    MOVE '&2                    $   #00018577' TO DFHEIV0
 18781     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18782     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 342
* EL050.cbl
 18783     MOVE X'2020233030303138353737' TO DFHEIV0(25:11)
 18784     CALL 'kxdfhei1' USING DFHEIV0,
 18785           FILE-ID-ERRESC,
 18786           DFHEIV11,
 18787           DFHEIV99
 18788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18789        GO TO 6690-END-OF-FILE.
 18790
 18791     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18792        NEXT SENTENCE
 18793      ELSE
 18794        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18795
 18796* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18797*
 18798     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18799
 18800     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18801
 18802     IF WS-SUB1 > ZERO
 18803         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18804             PERFORM 6680-SET-COMMISSION
 18805         ELSE
 18806             PERFORM 6680-SET-TABLE-CODE.
 18807
 18808
 18809* EXEC CICS ENDBR
 18810*         DATASET (FILE-ID-ERRESC)
 18811*    END-EXEC.
 18812     MOVE 0
 18813       TO DFHEIV11
 18814*    MOVE '&2                    $   #00018599' TO DFHEIV0
 18815     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18816     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18817     MOVE X'2020233030303138353939' TO DFHEIV0(25:11)
 18818     CALL 'kxdfhei1' USING DFHEIV0,
 18819           FILE-ID-ERRESC,
 18820           DFHEIV11,
 18821           DFHEIV99
 18822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18823
 18824
 18825     GO TO 6700-COMM-EXIT.
 18826
 18827 6680-SET-TABLE-CODE.
 18828     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18829        MOVE ZEROS             TO WS-SUB1
 18830     ELSE
 18831* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18832* TO COMPUTE AH COMMISSION.
 18833        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18834        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18835        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18836        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18837        PERFORM 6680-READ-CTBL-TABLE
 18838        IF WS-CTBL-READ-SW NOT = 'Y'
 18839           MOVE ZEROS          TO WS-SUB1.
 18840
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 343
* EL050.cbl
 18841 6680-READ-CTBL-TABLE.
 18842*
 18843* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18844* TO COMPUTE LIFE COMMISSION
 18845
 18846     IF CTBL-SW = '0540'
 18847        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18848        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18849        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18850
 18851     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18852
 18853     IF CTBL-TABLE-FOUND
 18854        IF CTBL-SW = '0530'
 18855             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18856                                    * PB-I-AH-TERM
 18857             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18858             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18859        ELSE
 18860             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18861             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18862             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18863     ELSE
 18864        IF FIRST-TIME-THROUGH
 18865            GO TO 6680-READ-CTBL-TABLE
 18866        ELSE
 18867            MOVE ZEROS         TO WS-SUB1.
 18868
 18869 6680-SET-COMMISSION.
 18870     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18871           MOVE ZEROS          TO WS-SUB1
 18872       ELSE
 18873           MOVE RESC-COMMISSION-PER (WS-SUB)
 18874                               TO WS-COMMISSION
 18875           IF CTBL-SW = '0530'
 18876               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18877           ELSE
 18878               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18879
 18880 6680-SEARCH-CATEGORY.
 18881     ADD +1                   TO WS-SUB.
 18882     IF WS-SUB > +12
 18883         GO TO 6680-EXIT.
 18884
 18885     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18886          MOVE WS-SUB         TO WS-SUB1
 18887          GO TO 6680-EXIT.
 18888
 18889     GO TO 6680-SEARCH-CATEGORY.
 18890
 18891 6680-EXIT.
 18892     EXIT.
 18893
 18894 6690-END-OF-FILE.
 18895     GO TO 6700-COMM-EXIT.
 18896
 18897 6690-ERRESC-PROBLEM.
 18898      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 344
* EL050.cbl
 18899      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18900
 18901      GO TO 6700-COMM-EXIT.
 18902
 18903 6700-COMM-EXIT.
 18904     EXIT.
 18905
 18906 7000-GET-RATE.
 18907
 18908* EXEC CICS LINK
 18909*        PROGRAM    ('ELRATE')
 18910*        COMMAREA   (CALCULATION-PASS-AREA)
 18911*        LENGTH     (CP-COMM-LENGTH)
 18912*    END-EXEC.
 18913     MOVE 'ELRATE' TO DFHEIV1
 18914*    MOVE '."C                   (   #00018685' TO DFHEIV0
 18915     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18916     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18917     MOVE X'2020233030303138363835' TO DFHEIV0(25:11)
 18918     CALL 'kxdfhei1' USING DFHEIV0,
 18919           DFHEIV1,
 18920           CALCULATION-PASS-AREA,
 18921           CP-COMM-LENGTH,
 18922           DFHEIV99,
 18923           DFHEIV99,
 18924           DFHEIV99,
 18925           DFHEIV99
 18926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18927
 18928
 18929 7000-EXIT.
 18930     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 345
* EL050.cbl
 18932 7100-FIND-BENEFIT-IN-STATE.
 18933     MOVE 'N'                    TO BEN-SEARCH-SW.
 18934
 18935     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18936         VARYING SUB3 FROM 1 BY 1 UNTIL
 18937            ((SUB3 GREATER 50) OR
 18938              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18939               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18940
 18941     IF SUB3 NOT = 51
 18942         MOVE 'Y'                TO BEN-SEARCH-SW.
 18943
 18944     GO TO 7199-EXIT.
 18945
 18946 7100-BENEFIT-DUMMY.
 18947
 18948 7100-DUMMY-EXIT.
 18949     EXIT.
 18950
 18951 7199-EXIT.
 18952     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 346
* EL050.cbl
 18954 7200-FIND-BENEFIT.
 18955     MOVE 'N'                    TO BEN-SEARCH-SW.
 18956
 18957     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18958         VARYING SUB3 FROM 1 BY 1 UNTIL
 18959            ((SUB3 GREATER 8) OR
 18960            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18961
 18962     IF SUB3 NOT = 9
 18963         MOVE 'Y'                TO BEN-SEARCH-SW.
 18964
 18965     GO TO 7200-EXIT.
 18966
 18967 7200-BENEFIT-DUMMY.
 18968
 18969 7200-DUMMY-EXIT.
 18970     EXIT.
 18971
 18972 7200-EXIT.
 18973     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 347
* EL050.cbl
 18975 7250-LOOK-FOR-RESCINDED-CLAIM.
 18976     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18977                                    W-CL-COMP-CD.
 18978     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18979                                    W-CL-CERT-NO.
 18980
 18981
 18982* EXEC CICS HANDLE CONDITION
 18983*        NOTFND  (7250-CONTINUE)
 18984*        ENDFILE (7250-CONTINUE)
 18985*    END-EXEC.
 18986*    MOVE '"$I''                  ! ) #00018743' TO DFHEIV0
 18987     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18988     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18989     MOVE X'2920233030303138373433' TO DFHEIV0(25:11)
 18990     CALL 'kxdfhei1' USING DFHEIV0
 18991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18992
 18993
 18994
 18995* EXEC CICS IGNORE CONDITION
 18996*        DUPKEY
 18997*    END-EXEC.
 18998*    MOVE '"*$                   !   #00018748' TO DFHEIV0
 18999     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19001     MOVE X'2020233030303138373438' TO DFHEIV0(25:11)
 19002     CALL 'kxdfhei1' USING DFHEIV0
 19003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19004
 19005
 19006
 19007* EXEC CICS STARTBR
 19008*        DATASET   (CLMS-ID)
 19009*        RIDFLD    (ELMSTR-KEY)
 19010*        GENERIC   EQUAL
 19011*        KEYLENGTH (ELMSTR-LENGTH)
 19012*    END-EXEC.
 19013     MOVE 0
 19014       TO DFHEIV11
 19015*    MOVE '&,   KG    E          &   #00018752' TO DFHEIV0
 19016     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19017     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19018     MOVE X'2020233030303138373532' TO DFHEIV0(25:11)
 19019     CALL 'kxdfhei1' USING DFHEIV0,
 19020           CLMS-ID,
 19021           ELMSTR-KEY,
 19022           ELMSTR-LENGTH,
 19023           DFHEIV11,
 19024           DFHEIV99
 19025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19026
 19027
 19028     MOVE 'Y'                    TO W-BROWSE-SW.
 19029
 19030 7250-NEXT-CLAIM.
 19031
 19032
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 348
* EL050.cbl
 19033* EXEC CICS READNEXT
 19034*        DATASET   (CLMS-ID)
 19035*        RIDFLD    (ELMSTR-KEY)
 19036*        SET       (ADDRESS OF CLAIM-MASTER)
 19037*    END-EXEC.
 19038     MOVE 0
 19039       TO DFHEIV11
 19040*    MOVE '&.S                   )   #00018763' TO DFHEIV0
 19041     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19042     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19043     MOVE X'2020233030303138373633' TO DFHEIV0(25:11)
 19044     CALL 'kxdfhei1' USING DFHEIV0,
 19045           CLMS-ID,
 19046           DFHEIV20,
 19047           DFHEIV99,
 19048           ELMSTR-KEY,
 19049           DFHEIV99,
 19050           DFHEIV11,
 19051           DFHEIV99,
 19052           DFHEIV99
 19053     SET ADDRESS OF CLAIM-MASTER TO
 19054         DFHEIV20
 19055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19056
 19057
 19058     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19059        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19060         GO TO 7250-CONTINUE
 19061     END-IF.
 19062
 19063     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19064        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19065        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19066        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19067        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19068         GO TO 7250-NEXT-CLAIM
 19069     END-IF.
 19070
 19071     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19072        OR (CL-CLAIM-TYPE = 'I')
 19073        OR (CL-CLAIM-TYPE = 'G')
 19074        OR (CL-CLAIM-TYPE = 'F')
 19075          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19076              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19077              GO TO 7250-CONTINUE
 19078          END-IF
 19079     END-IF.
 19080
 19081     GO TO 7250-NEXT-CLAIM.
 19082
 19083 7250-CONTINUE.
 19084
 19085     IF W-BROWSE-SW = 'Y'
 19086
 19087* EXEC CICS ENDBR
 19088*            DATASET   (CLMS-ID)
 19089*        END-EXEC
 19090     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 349
* EL050.cbl
 19091       TO DFHEIV11
 19092*    MOVE '&2                    $   #00018797' TO DFHEIV0
 19093     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19094     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19095     MOVE X'2020233030303138373937' TO DFHEIV0(25:11)
 19096     CALL 'kxdfhei1' USING DFHEIV0,
 19097           CLMS-ID,
 19098           DFHEIV11,
 19099           DFHEIV99
 19100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19101         MOVE 'N' TO W-BROWSE-SW
 19102     END-IF.
 19103
 19104 7250-EXIT.
 19105     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 350
* EL050.cbl
 19107 7300-CHECK-FOR-OPEN-CLMS.
 19108
 19109*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19110*    MOVE SPACES                 TO CNTL-ACCESS.
 19111*    MOVE '1'                    TO CNTL-REC-TYPE.
 19112*    MOVE +0                     TO CNTL-SEQ-NO.
 19113
 19114*    MOVE '3'                    TO RC-SW-1.
 19115*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19116
 19117*    IF NOT CF-COMPANY-MASTER
 19118*         PERFORM 0099-COMPANY-NOT-FOUND
 19119*         GO TO 7300-EXIT.
 19120
 19121     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19122                                    W-CL-COMP-CD.
 19123     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19124                                    W-CL-CERT-NO.
 19125
 19126
 19127* EXEC CICS HANDLE CONDITION
 19128*        NOTFND  (7300-CONTINUE)
 19129*        ENDFILE (7300-CONTINUE)
 19130*    END-EXEC.
 19131*    MOVE '"$I''                  ! * #00018825' TO DFHEIV0
 19132     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19134     MOVE X'2A20233030303138383235' TO DFHEIV0(25:11)
 19135     CALL 'kxdfhei1' USING DFHEIV0
 19136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19137
 19138
 19139
 19140* EXEC CICS IGNORE CONDITION
 19141*        DUPKEY
 19142*    END-EXEC.
 19143*    MOVE '"*$                   !   #00018830' TO DFHEIV0
 19144     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19145     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19146     MOVE X'2020233030303138383330' TO DFHEIV0(25:11)
 19147     CALL 'kxdfhei1' USING DFHEIV0
 19148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19149
 19150
 19151
 19152* EXEC CICS STARTBR
 19153*        DATASET   (CLMS-ID)
 19154*        RIDFLD    (ELMSTR-KEY)
 19155*        GENERIC   EQUAL
 19156*        KEYLENGTH (ELMSTR-LENGTH)
 19157*    END-EXEC.
 19158     MOVE 0
 19159       TO DFHEIV11
 19160*    MOVE '&,   KG    E          &   #00018834' TO DFHEIV0
 19161     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19162     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19163     MOVE X'2020233030303138383334' TO DFHEIV0(25:11)
 19164     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 351
* EL050.cbl
 19165           CLMS-ID,
 19166           ELMSTR-KEY,
 19167           ELMSTR-LENGTH,
 19168           DFHEIV11,
 19169           DFHEIV99
 19170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19171
 19172
 19173     MOVE 'Y'                    TO W-BROWSE-SW.
 19174
 19175 7300-NEXT-CLAIM.
 19176
 19177
 19178* EXEC CICS READNEXT
 19179*        DATASET   (CLMS-ID)
 19180*        RIDFLD    (ELMSTR-KEY)
 19181*        SET       (ADDRESS OF CLAIM-MASTER)
 19182*    END-EXEC.
 19183     MOVE 0
 19184       TO DFHEIV11
 19185*    MOVE '&.S                   )   #00018845' TO DFHEIV0
 19186     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19187     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19188     MOVE X'2020233030303138383435' TO DFHEIV0(25:11)
 19189     CALL 'kxdfhei1' USING DFHEIV0,
 19190           CLMS-ID,
 19191           DFHEIV20,
 19192           DFHEIV99,
 19193           ELMSTR-KEY,
 19194           DFHEIV99,
 19195           DFHEIV11,
 19196           DFHEIV99,
 19197           DFHEIV99
 19198     SET ADDRESS OF CLAIM-MASTER TO
 19199         DFHEIV20
 19200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19201
 19202
 19203     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19204        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19205         GO TO 7300-CONTINUE.
 19206
 19207     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19208        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19209        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19210        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19211        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19212         GO TO 7300-NEXT-CLAIM.
 19213
 19214*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19215     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19216        OR (CL-CLAIM-TYPE = 'I')
 19217        OR (CL-CLAIM-TYPE = 'G')
 19218        OR (CL-CLAIM-TYPE = 'F')
 19219        IF CLAIM-IS-OPEN
 19220           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19221             AND PB-C-AH-CANCEL-DT > SPACES
 19222              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 352
* EL050.cbl
 19223              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19224           END-IF
 19225           EVALUATE TRUE
 19226             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19227                 MOVE ER-2884      TO WS-ERROR
 19228             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19229                 MOVE ER-2887      TO WS-ERROR
 19230             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19231                 MOVE ER-2886      TO WS-ERROR
 19232             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19233                 MOVE ER-2888      TO WS-ERROR
 19234             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19235                 MOVE ER-2885      TO WS-ERROR
 19236             WHEN OTHER
 19237                 MOVE ER-2768      TO WS-ERROR
 19238           END-EVALUATE
 19239           IF PB-C-AH-CANCEL-VOIDED OR
 19240              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19241                NOT AH-COVERAGE-CANCELLED)
 19242               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19243               MOVE ER-2768      TO WS-ERROR
 19244           END-IF
 19245           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19246           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19247              PB-FORCE-CODE NOT EQUAL '8'
 19248               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19249           END-IF
 19250           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19251           GO TO 7300-NEXT-CLAIM
 19252        ELSE
 19253           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19254*****THIS IS A RESCISSION OR REFORMATION
 19255              IF AH-COVERAGE-CANCELLED
 19256                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19257                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19258                    MOVE 1                   TO DC-ELAPSED-DAYS
 19259                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19260                    SET BIN-PLUS-ELAPSED     TO TRUE
 19261                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19262                    IF NO-CONVERSION-ERROR
 19263                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19264                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19265                          MOVE ER-2897 TO WS-ERROR
 19266                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19267                          GO TO 7300-NEXT-CLAIM
 19268                       END-IF
 19269                    END-IF
 19270                 ELSE
 19271                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19272                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19273                         MOVE ER-2890 TO WS-ERROR
 19274                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19275                         GO TO 7300-NEXT-CLAIM
 19276                      ELSE
 19277                         MOVE ER-2898 TO WS-ERROR
 19278                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19279                         GO TO 7300-NEXT-CLAIM
 19280                      END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 353
* EL050.cbl
 19281                   END-IF
 19282                 END-IF
 19283              END-IF
 19284           ELSE
 19285              IF CL-DENIAL-TYPE = '1'  AND
 19286                 CL-TOTAL-PAID-AMT = 0
 19287                    GO TO 7300-NEXT-CLAIM
 19288              END-IF
 19289              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19290               AND PB-C-AH-CANCEL-DT > SPACES
 19291                 MOVE ER-2756        TO WS-ERROR
 19292                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19293                 GO TO 7300-NEXT-CLAIM
 19294              END-IF
 19295           END-IF
 19296        END-IF
 19297     ELSE
 19298*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19299        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19300           IF (CLAIM-IS-OPEN)
 19301              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19302                 <> zeros
 19303              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19304                 <> zeros)
 19305              MOVE ER-2889      TO WS-ERROR
 19306              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19307              GO TO 7300-NEXT-CLAIM
 19308           ELSE
 19309              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19310*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19311                 IF (LF-COVERAGE-CANCELLED AND
 19312                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19313                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19314                         MOVE ER-2890 TO WS-ERROR
 19315                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19316                         GO TO 7300-NEXT-CLAIM
 19317                      ELSE
 19318                         MOVE ER-2898 TO WS-ERROR
 19319                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19320                         GO TO 7300-NEXT-CLAIM
 19321                      END-IF
 19322                 END-IF
 19323              ELSE
 19324                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19325                    and (CL-TOTAL-PAID-AMT = 0)
 19326                    GO TO 7300-NEXT-CLAIM
 19327                 END-IF
 19328                 IF (
 19329                      (AH-COVERAGE-CANCELLED)
 19330                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19331                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19332                      and (pb-ci-ah-cancel-amt +
 19333                         pb-c-ah-cancel-amt) <> zeros
 19334                    )
 19335                               OR
 19336                    (
 19337                      (LF-COVERAGE-CANCELLED)
 19338                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 354
* EL050.cbl
 19339                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19340                      and (pb-ci-lf-cancel-amt +
 19341                         pb-c-lf-cancel-amt) <> zeros
 19342                    )
 19343                       MOVE ER-2965 TO WS-ERROR
 19344                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19345                       GO TO 7300-NEXT-CLAIM
 19346                 END-IF
 19347                 IF LF-COVERAGE-CANCELLED
 19348                  IF CL-TOTAL-PAID-AMT > 0
 19349                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19350                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19351                        MOVE ER-2891 TO WS-ERROR
 19352                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19353                        GO TO 7300-NEXT-CLAIM
 19354                      END-IF
 19355                    ELSE
 19356****only show this error if cert num matches exactly
 19357                      IF PB-CERT-NO = CL-CERT-NO
 19358                         MOVE ER-2892 TO WS-ERROR
 19359                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19360                         GO TO 7300-NEXT-CLAIM
 19361                      END-IF
 19362                    END-IF
 19363                  END-IF
 19364                 END-IF
 19365              END-IF
 19366           END-IF
 19367        END-IF
 19368     END-IF
 19369
 19370     GO TO 7300-NEXT-CLAIM.
 19371
 19372 7300-CONTINUE.
 19373
 19374     IF W-BROWSE-SW = 'Y'
 19375
 19376* EXEC CICS ENDBR
 19377*            DATASET   (CLMS-ID)
 19378*        END-EXEC.
 19379     MOVE 0
 19380       TO DFHEIV11
 19381*    MOVE '&2                    $   #00019023' TO DFHEIV0
 19382     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19383     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19384     MOVE X'2020233030303139303233' TO DFHEIV0(25:11)
 19385     CALL 'kxdfhei1' USING DFHEIV0,
 19386           CLMS-ID,
 19387           DFHEIV11,
 19388           DFHEIV99
 19389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19390
 19391
 19392 7300-EXIT.
 19393     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 355
* EL050.cbl
 19395
 19396 7400-GET-REMAIN-TERM.
 19397
 19398* EXEC CICS LINK
 19399*        PROGRAM    ('ELRTRM')
 19400*        COMMAREA   (CALCULATION-PASS-AREA)
 19401*        LENGTH     (CP-COMM-LENGTH)
 19402*    END-EXEC.
 19403     MOVE 'ELRTRM' TO DFHEIV1
 19404*    MOVE '."C                   (   #00019032' TO DFHEIV0
 19405     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19406     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19407     MOVE X'2020233030303139303332' TO DFHEIV0(25:11)
 19408     CALL 'kxdfhei1' USING DFHEIV0,
 19409           DFHEIV1,
 19410           CALCULATION-PASS-AREA,
 19411           CP-COMM-LENGTH,
 19412           DFHEIV99,
 19413           DFHEIV99,
 19414           DFHEIV99,
 19415           DFHEIV99
 19416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19417
 19418
 19419 7400-EXIT.
 19420     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 356
* EL050.cbl
 19422
 19423 7500-GET-REMAIN-AMOUNT.
 19424
 19425* EXEC CICS LINK
 19426*        PROGRAM    ('ELRAMT')
 19427*        COMMAREA   (CALCULATION-PASS-AREA)
 19428*        LENGTH     (CP-COMM-LENGTH)
 19429*    END-EXEC.
 19430     MOVE 'ELRAMT' TO DFHEIV1
 19431*    MOVE '."C                   (   #00019043' TO DFHEIV0
 19432     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19433     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19434     MOVE X'2020233030303139303433' TO DFHEIV0(25:11)
 19435     CALL 'kxdfhei1' USING DFHEIV0,
 19436           DFHEIV1,
 19437           CALCULATION-PASS-AREA,
 19438           CP-COMM-LENGTH,
 19439           DFHEIV99,
 19440           DFHEIV99,
 19441           DFHEIV99,
 19442           DFHEIV99
 19443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19444
 19445
 19446 7500-EXIT.
 19447     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 357
* EL050.cbl
 19449
 19450 7600-GET-REFUND.
 19451
 19452* EXEC CICS LINK
 19453*        PROGRAM    ('ELRFND')
 19454*        COMMAREA   (CALCULATION-PASS-AREA)
 19455*        LENGTH     (CP-COMM-LENGTH)
 19456*    END-EXEC.
 19457     MOVE 'ELRFND' TO DFHEIV1
 19458*    MOVE '."C                   (   #00019054' TO DFHEIV0
 19459     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19460     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19461     MOVE X'2020233030303139303534' TO DFHEIV0(25:11)
 19462     CALL 'kxdfhei1' USING DFHEIV0,
 19463           DFHEIV1,
 19464           CALCULATION-PASS-AREA,
 19465           CP-COMM-LENGTH,
 19466           DFHEIV99,
 19467           DFHEIV99,
 19468           DFHEIV99,
 19469           DFHEIV99
 19470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19471
 19472
 19473 7600-EXIT.
 19474     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 358
* EL050.cbl
 19476 7700-CALL-DL1.
 19477
 19478* EXEC CICS LINK
 19479*        PROGRAM    ('DLO001')
 19480*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19481*        LENGTH     (DLO001-COMM-LENGTH)
 19482*    END-EXEC.
 19483     MOVE 'DLO001' TO DFHEIV1
 19484*    MOVE '."C                   (   #00019064' TO DFHEIV0
 19485     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19487     MOVE X'2020233030303139303634' TO DFHEIV0(25:11)
 19488     CALL 'kxdfhei1' USING DFHEIV0,
 19489           DFHEIV1,
 19490           WS-DLO-MASTER-POLICY-FORM,
 19491           DLO001-COMM-LENGTH,
 19492           DFHEIV99,
 19493           DFHEIV99,
 19494           DFHEIV99,
 19495           DFHEIV99
 19496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19497
 19498
 19499 7700-EXIT.
 19500     EXIT.
 19501
 19502 7710-CALL-DL2.
 19503
 19504* EXEC CICS LINK
 19505*        PROGRAM    ('DLO002')
 19506*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19507*        LENGTH     (DLO002-COMM-LENGTH)
 19508*    END-EXEC.
 19509     MOVE 'DLO002' TO DFHEIV1
 19510*    MOVE '."C                   (   #00019074' TO DFHEIV0
 19511     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19512     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19513     MOVE X'2020233030303139303734' TO DFHEIV0(25:11)
 19514     CALL 'kxdfhei1' USING DFHEIV0,
 19515           DFHEIV1,
 19516           WS-DLO-INTERNAL-POLICY-FORM,
 19517           DLO002-COMM-LENGTH,
 19518           DFHEIV99,
 19519           DFHEIV99,
 19520           DFHEIV99,
 19521           DFHEIV99
 19522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19523
 19524
 19525 7710-EXIT.
 19526     EXIT.
 19527
 19528 7720-CALL-DL3.
 19529
 19530* EXEC CICS LINK
 19531*        PROGRAM    ('DLO003')
 19532*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19533*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 359
* EL050.cbl
 19534*    END-EXEC.
 19535     MOVE 'DLO003' TO DFHEIV1
 19536*    MOVE '."C                   (   #00019084' TO DFHEIV0
 19537     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19538     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19539     MOVE X'2020233030303139303834' TO DFHEIV0(25:11)
 19540     CALL 'kxdfhei1' USING DFHEIV0,
 19541           DFHEIV1,
 19542           WS-DLO-VALID-BANK-ID,
 19543           DLO003-COMM-LENGTH,
 19544           DFHEIV99,
 19545           DFHEIV99,
 19546           DFHEIV99,
 19547           DFHEIV99
 19548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19549
 19550
 19551 7720-EXIT.
 19552     EXIT.
 19553
 19554 7730-CALL-DL7.
 19555
 19556* EXEC CICS LINK
 19557*        PROGRAM    ('DLO007')
 19558*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19559*        LENGTH     (DLO007-COMM-LENGTH)
 19560*    END-EXEC.
 19561     MOVE 'DLO007' TO DFHEIV1
 19562*    MOVE '."C                   (   #00019094' TO DFHEIV0
 19563     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19564     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19565     MOVE X'2020233030303139303934' TO DFHEIV0(25:11)
 19566     CALL 'kxdfhei1' USING DFHEIV0,
 19567           DFHEIV1,
 19568           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19569           DLO007-COMM-LENGTH,
 19570           DFHEIV99,
 19571           DFHEIV99,
 19572           DFHEIV99,
 19573           DFHEIV99
 19574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19575
 19576
 19577 7730-EXIT.
 19578     EXIT.
 19579
 19580 7740-CALL-DL11.
 19581
 19582* EXEC CICS LINK
 19583*        PROGRAM    ('DLO011')
 19584*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19585*        LENGTH     (DLO011-COMM-LENGTH)
 19586*    END-EXEC.
 19587     MOVE 'DLO011' TO DFHEIV1
 19588*    MOVE '."C                   (   #00019104' TO DFHEIV0
 19589     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19591     MOVE X'2020233030303139313034' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 360
* EL050.cbl
 19592     CALL 'kxdfhei1' USING DFHEIV0,
 19593           DFHEIV1,
 19594           WS-DLO-PREM-RATES-BEN-TYPE,
 19595           DLO011-COMM-LENGTH,
 19596           DFHEIV99,
 19597           DFHEIV99,
 19598           DFHEIV99,
 19599           DFHEIV99
 19600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19601
 19602
 19603 7740-EXIT.
 19604     EXIT.
 19605
 19606 7750-CALL-DL17.
 19607
 19608* EXEC CICS LINK
 19609*        PROGRAM    ('DLO017')
 19610*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19611*        LENGTH     (DLO017-COMM-LENGTH)
 19612*    END-EXEC.
 19613     MOVE 'DLO017' TO DFHEIV1
 19614*    MOVE '."C                   (   #00019114' TO DFHEIV0
 19615     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19616     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19617     MOVE X'2020233030303139313134' TO DFHEIV0(25:11)
 19618     CALL 'kxdfhei1' USING DFHEIV0,
 19619           DFHEIV1,
 19620           WS-DLO-VALID-RATE-CODE,
 19621           DLO017-COMM-LENGTH,
 19622           DFHEIV99,
 19623           DFHEIV99,
 19624           DFHEIV99,
 19625           DFHEIV99
 19626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19627
 19628
 19629 7750-EXIT.
 19630     EXIT.
 19631
 19632 7755-CALL-DL19.
 19633
 19634* EXEC CICS LINK
 19635*        PROGRAM    ('DLO019')
 19636*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19637*        LENGTH     (DLO019-COMM-LENGTH)
 19638*    END-EXEC.
 19639     MOVE 'DLO019' TO DFHEIV1
 19640*    MOVE '."C                   (   #00019124' TO DFHEIV0
 19641     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19642     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19643     MOVE X'2020233030303139313234' TO DFHEIV0(25:11)
 19644     CALL 'kxdfhei1' USING DFHEIV0,
 19645           DFHEIV1,
 19646           WS-DLO-ORIG-COV-CAT,
 19647           DLO019-COMM-LENGTH,
 19648           DFHEIV99,
 19649           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 361
* EL050.cbl
 19650           DFHEIV99,
 19651           DFHEIV99
 19652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19653
 19654
 19655 7755-EXIT.
 19656     EXIT.
 19657
 19658 7760-CALL-DL21.
 19659
 19660* EXEC CICS LINK
 19661*        PROGRAM    ('DLO021')
 19662*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19663*        LENGTH     (DLO021-COMM-LENGTH)
 19664*    END-EXEC.
 19665     MOVE 'DLO021' TO DFHEIV1
 19666*    MOVE '."C                   (   #00019134' TO DFHEIV0
 19667     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19668     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19669     MOVE X'2020233030303139313334' TO DFHEIV0(25:11)
 19670     CALL 'kxdfhei1' USING DFHEIV0,
 19671           DFHEIV1,
 19672           WS-DLO-VALID-LOAN-OFFICER,
 19673           DLO021-COMM-LENGTH,
 19674           DFHEIV99,
 19675           DFHEIV99,
 19676           DFHEIV99,
 19677           DFHEIV99
 19678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19679
 19680
 19681 7760-EXIT.
 19682     EXIT.
 19683
 19684 7770-CALL-DL22.
 19685
 19686* EXEC CICS LINK
 19687*        PROGRAM    ('DLO022')
 19688*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19689*        LENGTH     (DLO022-COMM-LENGTH)
 19690*    END-EXEC.
 19691     MOVE 'DLO022' TO DFHEIV1
 19692*    MOVE '."C                   (   #00019144' TO DFHEIV0
 19693     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19694     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19695     MOVE X'2020233030303139313434' TO DFHEIV0(25:11)
 19696     CALL 'kxdfhei1' USING DFHEIV0,
 19697           DFHEIV1,
 19698           WS-DLO-VALID-STATE-CODE,
 19699           DLO022-COMM-LENGTH,
 19700           DFHEIV99,
 19701           DFHEIV99,
 19702           DFHEIV99,
 19703           DFHEIV99
 19704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19705
 19706
 19707 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 362
* EL050.cbl
 19708     EXIT.
 19709
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 363
* EL050.cbl
 19711
 19712 7780-CALL-AGG.
 19713
 19714* EXEC CICS LINK
 19715*        PROGRAM    ('ELAGGO')
 19716*        COMMAREA   (WS-PASS-to-pemaggo)
 19717*        LENGTH     (ws-passed-key-LENGTH)
 19718*    END-EXEC.
 19719     MOVE 'ELAGGO' TO DFHEIV1
 19720*    MOVE '."C                   (   #00019156' TO DFHEIV0
 19721     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19722     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19723     MOVE X'2020233030303139313536' TO DFHEIV0(25:11)
 19724     CALL 'kxdfhei1' USING DFHEIV0,
 19725           DFHEIV1,
 19726           WS-PASS-to-pemaggo,
 19727           ws-passed-key-LENGTH,
 19728           DFHEIV99,
 19729           DFHEIV99,
 19730           DFHEIV99,
 19731           DFHEIV99
 19732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19733
 19734 7780-EXIT.
 19735     EXIT.
 19736 7800-REWRITE-CERT.
 19737******************************************************************
 19738*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19739*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19740******************************************************************
 19741
 19742     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19743        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19744        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19745        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19746
 19747* EXEC CICS REWRITE
 19748*                  DATASET (CERT-ID)
 19749*                  FROM    (CERTIFICATE-MASTER)
 19750*              END-EXEC
 19751     MOVE LENGTH OF
 19752      CERTIFICATE-MASTER
 19753       TO DFHEIV11
 19754*    MOVE '&& L                  %   #00019173' TO DFHEIV0
 19755     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19756     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19757     MOVE X'2020233030303139313733' TO DFHEIV0(25:11)
 19758     CALL 'kxdfhei1' USING DFHEIV0,
 19759           CERT-ID,
 19760           CERTIFICATE-MASTER,
 19761           DFHEIV11,
 19762           DFHEIV99
 19763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19764        GO TO 7800-EXIT.
 19765
 19766       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19767       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19768
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 364
* EL050.cbl
 19769 7800-EXIT.
 19770      EXIT.
 19771
 19772 7900-DELETE-CERT.
 19773
 19774* EXEC CICS DELETE
 19775*        DATASET (CERT-ID)
 19776*    END-EXEC.
 19777*    MOVE '&(                    &   #00019186' TO DFHEIV0
 19778     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19779     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19780     MOVE X'2020233030303139313836' TO DFHEIV0(25:11)
 19781     CALL 'kxdfhei1' USING DFHEIV0,
 19782           CERT-ID,
 19783           DFHEIV99,
 19784           DFHEIV99,
 19785           DFHEIV99,
 19786           DFHEIV99
 19787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19788
 19789
 19790 7900-EXIT.
 19791     EXIT.
 19792
 19793 8000-WRITE-CERT.
 19794
 19795* EXEC CICS HANDLE CONDITION
 19796*        DUPKEY    (8000-FREE-MAIN)
 19797*    END-EXEC.
 19798*    MOVE '"$$                   ! + #00019194' TO DFHEIV0
 19799     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19800     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19801     MOVE X'2B20233030303139313934' TO DFHEIV0(25:11)
 19802     CALL 'kxdfhei1' USING DFHEIV0
 19803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19804
 19805
 19806
 19807* EXEC CICS WRITE
 19808*        DATASET     (CERT-ID)
 19809*        FROM        (CERTIFICATE-MASTER)
 19810*        RIDFLD      (ELCERT-KEY)
 19811*    END-EXEC.
 19812     MOVE LENGTH OF
 19813      CERTIFICATE-MASTER
 19814       TO DFHEIV11
 19815*    MOVE '&$ L                  ''   #00019198' TO DFHEIV0
 19816     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19817     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19818     MOVE X'2020233030303139313938' TO DFHEIV0(25:11)
 19819     CALL 'kxdfhei1' USING DFHEIV0,
 19820           CERT-ID,
 19821           CERTIFICATE-MASTER,
 19822           DFHEIV11,
 19823           ELCERT-KEY,
 19824           DFHEIV99,
 19825           DFHEIV99
 19826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 365
* EL050.cbl
 19827
 19828
 19829 8000-FREE-MAIN.
 19830
 19831 8000-EXIT.
 19832      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 366
* EL050.cbl
 19834
 19835 8100-READ-ERPNDM.
 19836
 19837* EXEC CICS HANDLE CONDITION
 19838*         NOTFND     (8100-NOTFND)
 19839*         ENDFILE    (8100-NOTFND)
 19840*    END-EXEC.
 19841*    MOVE '"$I''                  ! , #00019211' TO DFHEIV0
 19842     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19844     MOVE X'2C20233030303139323131' TO DFHEIV0(25:11)
 19845     CALL 'kxdfhei1' USING DFHEIV0
 19846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19847
 19848
 19849     MOVE SPACES                 TO ERPNDM-FOUND.
 19850     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19851
 19852
 19853* EXEC CICS READ
 19854*         DATASET   (FILE-ERPNDM)
 19855*         RIDFLD    (PM-CONTROL-PRIMARY)
 19856*         INTO      (PENDING-MAILING-DATA)
 19857*    END-EXEC.
 19858     MOVE LENGTH OF
 19859      PENDING-MAILING-DATA
 19860       TO DFHEIV11
 19861*    MOVE '&"IL       E          (   #00019219' TO DFHEIV0
 19862     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19863     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19864     MOVE X'2020233030303139323139' TO DFHEIV0(25:11)
 19865     CALL 'kxdfhei1' USING DFHEIV0,
 19866           FILE-ERPNDM,
 19867           PENDING-MAILING-DATA,
 19868           DFHEIV11,
 19869           PM-CONTROL-PRIMARY,
 19870           DFHEIV99,
 19871           DFHEIV99,
 19872           DFHEIV99
 19873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19874
 19875
 19876     GO TO 8100-EXIT.
 19877
 19878 8100-NOTFND.
 19879
 19880     MOVE 'X'                    TO ERPNDM-FOUND.
 19881     MOVE ER-2694                TO WS-ERROR.
 19882     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19883     MOVE ER-2883                TO WS-ERROR
 19884     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19885     .
 19886 8100-EXIT.
 19887     EXIT.
 19888
 19889 8110-READ-ERMAIL.
 19890
 19891* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 367
* EL050.cbl
 19892*         NOTFND     (8110-NOTFND)
 19893*         ENDFILE    (8110-NOTFND)
 19894*    END-EXEC.
 19895*    MOVE '"$I''                  ! - #00019239' TO DFHEIV0
 19896     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19897     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19898     MOVE X'2D20233030303139323339' TO DFHEIV0(25:11)
 19899     CALL 'kxdfhei1' USING DFHEIV0
 19900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19901
 19902
 19903     MOVE SPACES                 TO ERMAIL-FOUND.
 19904     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19905     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19906     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19907     MOVE PB-SV-STATE            TO MA-STATE.
 19908
 19909
 19910* EXEC CICS READ
 19911*         UPDATE
 19912*         DATASET   (FILE-ERMAIL)
 19913*         RIDFLD    (MA-CONTROL-PRIMARY)
 19914*         INTO      (MAILING-DATA)
 19915*    END-EXEC.
 19916     MOVE LENGTH OF
 19917      MAILING-DATA
 19918       TO DFHEIV11
 19919*    MOVE '&"IL       EU         (   #00019250' TO DFHEIV0
 19920     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19921     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19922     MOVE X'2020233030303139323530' TO DFHEIV0(25:11)
 19923     CALL 'kxdfhei1' USING DFHEIV0,
 19924           FILE-ERMAIL,
 19925           MAILING-DATA,
 19926           DFHEIV11,
 19927           MA-CONTROL-PRIMARY,
 19928           DFHEIV99,
 19929           DFHEIV99,
 19930           DFHEIV99
 19931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19932
 19933
 19934     GO TO 8110-EXIT.
 19935
 19936 8110-NOTFND.
 19937     MOVE 'X'                    TO ERMAIL-FOUND.
 19938
 19939 8110-EXIT.
 19940     EXIT.
 19941
 19942 8120-REWRITE-ERMAIL.
 19943
 19944* EXEC CICS REWRITE
 19945*         DATASET    (FILE-ERMAIL)
 19946*         FROM       (MAILING-DATA)
 19947*    END-EXEC.
 19948     MOVE LENGTH OF
 19949      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 368
* EL050.cbl
 19950       TO DFHEIV11
 19951*    MOVE '&& L                  %   #00019266' TO DFHEIV0
 19952     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19953     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19954     MOVE X'2020233030303139323636' TO DFHEIV0(25:11)
 19955     CALL 'kxdfhei1' USING DFHEIV0,
 19956           FILE-ERMAIL,
 19957           MAILING-DATA,
 19958           DFHEIV11,
 19959           DFHEIV99
 19960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19961
 19962
 19963 8120-EXIT.
 19964     EXIT.
 19965
 19966 8130-WRITE-ERMAIL.
 19967
 19968* EXEC CICS HANDLE CONDITION
 19969*         DUPKEY   (8130-EXIT)
 19970*    END-EXEC.
 19971*    MOVE '"$$                   ! . #00019275' TO DFHEIV0
 19972     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19974     MOVE X'2E20233030303139323735' TO DFHEIV0(25:11)
 19975     CALL 'kxdfhei1' USING DFHEIV0
 19976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19977
 19978
 19979
 19980* EXEC CICS WRITE
 19981*         DATASET     (FILE-ERMAIL)
 19982*         RIDFLD      (MA-CONTROL-PRIMARY)
 19983*         FROM        (MAILING-DATA)
 19984*    END-EXEC.
 19985     MOVE LENGTH OF
 19986      MAILING-DATA
 19987       TO DFHEIV11
 19988*    MOVE '&$ L                  ''   #00019279' TO DFHEIV0
 19989     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19990     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19991     MOVE X'2020233030303139323739' TO DFHEIV0(25:11)
 19992     CALL 'kxdfhei1' USING DFHEIV0,
 19993           FILE-ERMAIL,
 19994           MAILING-DATA,
 19995           DFHEIV11,
 19996           MA-CONTROL-PRIMARY,
 19997           DFHEIV99,
 19998           DFHEIV99
 19999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20000
 20001
 20002 8130-EXIT.
 20003     EXIT.
 20004
 20005 8140-UNLOCK-ERMAIL.
 20006
 20007* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 369
* EL050.cbl
 20008*         DATASET   (FILE-ERMAIL)
 20009*    END-EXEC.
 20010*    MOVE '&*                    #   #00019289' TO DFHEIV0
 20011     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20012     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20013     MOVE X'2020233030303139323839' TO DFHEIV0(25:11)
 20014     CALL 'kxdfhei1' USING DFHEIV0,
 20015           FILE-ERMAIL,
 20016           DFHEIV99
 20017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20018
 20019
 20020 8140-EXIT.
 20021     EXIT.
 20022
 20023 8150-read-elcrtt.
 20024
 20025
 20026* EXEC CICS HANDLE CONDITION
 20027*        NOTFND   (8150-exit)
 20028*    END-EXEC
 20029*    MOVE '"$I                   ! / #00019298' TO DFHEIV0
 20030     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20031     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20032     MOVE X'2F20233030303139323938' TO DFHEIV0(25:11)
 20033     CALL 'kxdfhei1' USING DFHEIV0
 20034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20035
 20036     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20037     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20038
 20039
 20040* EXEC CICS READ
 20041*        DATASET  (CRTT-ID)
 20042*        RIDFLD   (WS-ELCRTT-KEY)
 20043*        INTO     (CERTIFICATE-TRAILERS)
 20044*    END-EXEC
 20045     MOVE LENGTH OF
 20046      CERTIFICATE-TRAILERS
 20047       TO DFHEIV11
 20048*    MOVE '&"IL       E          (   #00019305' TO DFHEIV0
 20049     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20050     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20051     MOVE X'2020233030303139333035' TO DFHEIV0(25:11)
 20052     CALL 'kxdfhei1' USING DFHEIV0,
 20053           CRTT-ID,
 20054           CERTIFICATE-TRAILERS,
 20055           DFHEIV11,
 20056           WS-ELCRTT-KEY,
 20057           DFHEIV99,
 20058           DFHEIV99,
 20059           DFHEIV99
 20060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20061
 20062     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20063     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20064
 20065     .
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 370
* EL050.cbl
 20066 8150-exit.
 20067     exit.
 20068 8180-UPDATE-VIN-NUMBER.
 20069
 20070* EXEC CICS HANDLE CONDITION
 20071*        NOTFND   (8180-NOTFND)
 20072*    END-EXEC.
 20073*    MOVE '"$I                   ! 0 #00019318' TO DFHEIV0
 20074     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20075     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20076     MOVE X'3020233030303139333138' TO DFHEIV0(25:11)
 20077     CALL 'kxdfhei1' USING DFHEIV0
 20078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20079
 20080
 20081     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20082     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20083
 20084
 20085* EXEC CICS READ
 20086*        UPDATE
 20087*        DATASET  (CRTT-ID)
 20088*        RIDFLD   (WS-ELCRTT-KEY)
 20089*        INTO     (CERTIFICATE-TRAILERS)
 20090*    END-EXEC.
 20091     MOVE LENGTH OF
 20092      CERTIFICATE-TRAILERS
 20093       TO DFHEIV11
 20094*    MOVE '&"IL       EU         (   #00019325' TO DFHEIV0
 20095     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20096     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20097     MOVE X'2020233030303139333235' TO DFHEIV0(25:11)
 20098     CALL 'kxdfhei1' USING DFHEIV0,
 20099           CRTT-ID,
 20100           CERTIFICATE-TRAILERS,
 20101           DFHEIV11,
 20102           WS-ELCRTT-KEY,
 20103           DFHEIV99,
 20104           DFHEIV99,
 20105           DFHEIV99
 20106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20107
 20108
 20109     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20110         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20111
 20112* EXEC CICS REWRITE
 20113*           DATASET  (CRTT-ID)
 20114*           FROM     (CERTIFICATE-TRAILERS)
 20115*        END-EXEC
 20116     MOVE LENGTH OF
 20117      CERTIFICATE-TRAILERS
 20118       TO DFHEIV11
 20119*    MOVE '&& L                  %   #00019334' TO DFHEIV0
 20120     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20121     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20122     MOVE X'2020233030303139333334' TO DFHEIV0(25:11)
 20123     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 371
* EL050.cbl
 20124           CRTT-ID,
 20125           CERTIFICATE-TRAILERS,
 20126           DFHEIV11,
 20127           DFHEIV99
 20128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20129     ELSE
 20130
 20131* EXEC CICS UNLOCK
 20132*          DATASET  (CRTT-ID)
 20133*       END-EXEC
 20134*    MOVE '&*                    #   #00019339' TO DFHEIV0
 20135     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20136     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20137     MOVE X'2020233030303139333339' TO DFHEIV0(25:11)
 20138     CALL 'kxdfhei1' USING DFHEIV0,
 20139           CRTT-ID,
 20140           DFHEIV99
 20141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20142     END-IF.
 20143
 20144     GO TO 8180-EXIT.
 20145
 20146 8180-NOTFND.
 20147
 20148     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20149     MOVE 'CS'         TO CS-RECORD-ID.
 20150     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20151     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20152     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20153     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20154
 20155* EXEC CICS WRITE
 20156*       DATASET  (CRTT-ID)
 20157*       RIDFLD   (WS-ELCRTT-KEY)
 20158*       FROM     (CERTIFICATE-TRAILERS)
 20159*    END-EXEC.
 20160     MOVE LENGTH OF
 20161      CERTIFICATE-TRAILERS
 20162       TO DFHEIV11
 20163*    MOVE '&$ L                  ''   #00019354' TO DFHEIV0
 20164     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20165     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20166     MOVE X'2020233030303139333534' TO DFHEIV0(25:11)
 20167     CALL 'kxdfhei1' USING DFHEIV0,
 20168           CRTT-ID,
 20169           CERTIFICATE-TRAILERS,
 20170           DFHEIV11,
 20171           WS-ELCRTT-KEY,
 20172           DFHEIV99,
 20173           DFHEIV99
 20174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20175
 20176
 20177 8180-EXIT.
 20178     EXIT.
 20179
 20180 8190-UPDATE-REFUND-CLAIM-FLAG.
 20181
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 372
* EL050.cbl
 20182* EXEC CICS HANDLE CONDITION
 20183*        NOTFND   (8190-NOTFND)
 20184*    END-EXEC.
 20185*    MOVE '"$I                   ! 1 #00019364' TO DFHEIV0
 20186     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20187     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20188     MOVE X'3120233030303139333634' TO DFHEIV0(25:11)
 20189     CALL 'kxdfhei1' USING DFHEIV0
 20190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20191
 20192
 20193     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20194     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20195
 20196
 20197* EXEC CICS READ
 20198*        UPDATE
 20199*        DATASET  (CRTT-ID)
 20200*        RIDFLD   (WS-ELCRTT-KEY)
 20201*        INTO     (CERTIFICATE-TRAILERS)
 20202*    END-EXEC.
 20203     MOVE LENGTH OF
 20204      CERTIFICATE-TRAILERS
 20205       TO DFHEIV11
 20206*    MOVE '&"IL       EU         (   #00019371' TO DFHEIV0
 20207     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20208     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20209     MOVE X'2020233030303139333731' TO DFHEIV0(25:11)
 20210     CALL 'kxdfhei1' USING DFHEIV0,
 20211           CRTT-ID,
 20212           CERTIFICATE-TRAILERS,
 20213           DFHEIV11,
 20214           WS-ELCRTT-KEY,
 20215           DFHEIV99,
 20216           DFHEIV99,
 20217           DFHEIV99
 20218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20219
 20220
 20221     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20222
 20223* EXEC CICS REWRITE
 20224*       DATASET  (CRTT-ID)
 20225*       FROM     (CERTIFICATE-TRAILERS)
 20226*    END-EXEC.
 20227     MOVE LENGTH OF
 20228      CERTIFICATE-TRAILERS
 20229       TO DFHEIV11
 20230*    MOVE '&& L                  %   #00019379' TO DFHEIV0
 20231     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20232     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20233     MOVE X'2020233030303139333739' TO DFHEIV0(25:11)
 20234     CALL 'kxdfhei1' USING DFHEIV0,
 20235           CRTT-ID,
 20236           CERTIFICATE-TRAILERS,
 20237           DFHEIV11,
 20238           DFHEIV99
 20239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 373
* EL050.cbl
 20240
 20241
 20242     GO TO 8190-EXIT.
 20243
 20244 8190-NOTFND.
 20245
 20246     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20247     MOVE 'CS'         TO CS-RECORD-ID.
 20248     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20249     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20250     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20251     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20252
 20253* EXEC CICS WRITE
 20254*       DATASET  (CRTT-ID)
 20255*       RIDFLD   (WS-ELCRTT-KEY)
 20256*       FROM     (CERTIFICATE-TRAILERS)
 20257*    END-EXEC.
 20258     MOVE LENGTH OF
 20259      CERTIFICATE-TRAILERS
 20260       TO DFHEIV11
 20261*    MOVE '&$ L                  ''   #00019394' TO DFHEIV0
 20262     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20263     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20264     MOVE X'2020233030303139333934' TO DFHEIV0(25:11)
 20265     CALL 'kxdfhei1' USING DFHEIV0,
 20266           CRTT-ID,
 20267           CERTIFICATE-TRAILERS,
 20268           DFHEIV11,
 20269           WS-ELCRTT-KEY,
 20270           DFHEIV99,
 20271           DFHEIV99
 20272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20273
 20274
 20275 8190-EXIT.
 20276     EXIT.
 20277
 20278 8195-UPDATE-AGE-FLAGS.
 20279
 20280* EXEC CICS HANDLE CONDITION
 20281*        NOTFND   (8195-NOTFND)
 20282*    END-EXEC.
 20283*    MOVE '"$I                   ! 2 #00019404' TO DFHEIV0
 20284     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20285     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20286     MOVE X'3220233030303139343034' TO DFHEIV0(25:11)
 20287     CALL 'kxdfhei1' USING DFHEIV0
 20288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20289
 20290
 20291     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20292     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20293
 20294
 20295* EXEC CICS READ
 20296*        UPDATE
 20297*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 374
* EL050.cbl
 20298*        RIDFLD   (WS-ELCRTT-KEY)
 20299*        INTO     (CERTIFICATE-TRAILERS)
 20300*    END-EXEC.
 20301     MOVE LENGTH OF
 20302      CERTIFICATE-TRAILERS
 20303       TO DFHEIV11
 20304*    MOVE '&"IL       EU         (   #00019411' TO DFHEIV0
 20305     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20306     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20307     MOVE X'2020233030303139343131' TO DFHEIV0(25:11)
 20308     CALL 'kxdfhei1' USING DFHEIV0,
 20309           CRTT-ID,
 20310           CERTIFICATE-TRAILERS,
 20311           DFHEIV11,
 20312           WS-ELCRTT-KEY,
 20313           DFHEIV99,
 20314           DFHEIV99,
 20315           DFHEIV99
 20316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20317
 20318
 20319     IF WS-INS-AGE-SET = 'Y'
 20320        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20321     END-IF
 20322     IF WS-JNT-AGE-SET = 'Y'
 20323        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20324     END-IF
 20325
 20326
 20327* EXEC CICS REWRITE
 20328*       DATASET  (CRTT-ID)
 20329*       FROM     (CERTIFICATE-TRAILERS)
 20330*    END-EXEC.
 20331     MOVE LENGTH OF
 20332      CERTIFICATE-TRAILERS
 20333       TO DFHEIV11
 20334*    MOVE '&& L                  %   #00019425' TO DFHEIV0
 20335     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20336     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20337     MOVE X'2020233030303139343235' TO DFHEIV0(25:11)
 20338     CALL 'kxdfhei1' USING DFHEIV0,
 20339           CRTT-ID,
 20340           CERTIFICATE-TRAILERS,
 20341           DFHEIV11,
 20342           DFHEIV99
 20343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20344
 20345
 20346     GO TO 8195-EXIT.
 20347
 20348 8195-NOTFND.
 20349
 20350     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20351     MOVE 'CS'         TO CS-RECORD-ID.
 20352     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20353     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20354     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20355     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 375
* EL050.cbl
 20356     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20357
 20358* EXEC CICS WRITE
 20359*       DATASET  (CRTT-ID)
 20360*       RIDFLD   (WS-ELCRTT-KEY)
 20361*       FROM     (CERTIFICATE-TRAILERS)
 20362*    END-EXEC.
 20363     MOVE LENGTH OF
 20364      CERTIFICATE-TRAILERS
 20365       TO DFHEIV11
 20366*    MOVE '&$ L                  ''   #00019441' TO DFHEIV0
 20367     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20368     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20369     MOVE X'2020233030303139343431' TO DFHEIV0(25:11)
 20370     CALL 'kxdfhei1' USING DFHEIV0,
 20371           CRTT-ID,
 20372           CERTIFICATE-TRAILERS,
 20373           DFHEIV11,
 20374           WS-ELCRTT-KEY,
 20375           DFHEIV99,
 20376           DFHEIV99
 20377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20378
 20379
 20380 8195-EXIT.
 20381     EXIT.
 20382
 20383 8200-READ-REIN-TABLE.
 20384
 20385* EXEC CICS HANDLE CONDITION
 20386*         NOTFND   (8200-NOTFND)
 20387*    END-EXEC.
 20388*    MOVE '"$I                   ! 3 #00019451' TO DFHEIV0
 20389     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20391     MOVE X'3320233030303139343531' TO DFHEIV0(25:11)
 20392     CALL 'kxdfhei1' USING DFHEIV0
 20393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20394
 20395
 20396
 20397* EXEC CICS READ
 20398*        DATASET     (REIN-ID)
 20399*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20400*        RIDFLD      (ERREIN-KEY)
 20401*    END-EXEC.
 20402*    MOVE '&"S        E          (   #00019455' TO DFHEIV0
 20403     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20405     MOVE X'2020233030303139343535' TO DFHEIV0(25:11)
 20406     CALL 'kxdfhei1' USING DFHEIV0,
 20407           REIN-ID,
 20408           DFHEIV20,
 20409           DFHEIV99,
 20410           ERREIN-KEY,
 20411           DFHEIV99,
 20412           DFHEIV99,
 20413           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 376
* EL050.cbl
 20414     SET ADDRESS OF REINSURANCE-RECORD TO
 20415         DFHEIV20
 20416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20417
 20418
 20419     GO TO 8200-EXIT.
 20420
 20421 8200-NOTFND.
 20422     MOVE 'N'             TO WS-REIN-READ-SW.
 20423
 20424 8200-EXIT.
 20425      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 377
* EL050.cbl
 20427
 20428 8300-READ-CTBL-TABLE.
 20429
 20430* EXEC CICS HANDLE CONDITION
 20431*        NOTFND    (8300-NOTFND)
 20432*        DISABLED  (8300-ERRESS-PROBLEM)
 20433*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20434*        ENDFILE   (8300-NOTFND)
 20435*    END-EXEC.
 20436*    MOVE '"$IcJ''                ! 4 #00019471' TO DFHEIV0
 20437     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20438     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20439     MOVE X'3420233030303139343731' TO DFHEIV0(25:11)
 20440     CALL 'kxdfhei1' USING DFHEIV0
 20441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20442
 20443
 20444
 20445* EXEC CICS READ
 20446*        DATASET     (CTBL-ID)
 20447*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20448*        RIDFLD      (ERCTBL-KEY)
 20449*    END-EXEC.
 20450*    MOVE '&"S        E          (   #00019478' TO DFHEIV0
 20451     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20452     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20453     MOVE X'2020233030303139343738' TO DFHEIV0(25:11)
 20454     CALL 'kxdfhei1' USING DFHEIV0,
 20455           CTBL-ID,
 20456           DFHEIV20,
 20457           DFHEIV99,
 20458           ERCTBL-KEY,
 20459           DFHEIV99,
 20460           DFHEIV99,
 20461           DFHEIV99
 20462     SET ADDRESS OF COMM-TABLE-RECORD TO
 20463         DFHEIV20
 20464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20465
 20466
 20467     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20468
 20469     GO TO 8300-EXIT.
 20470
 20471 8300-NOTFND.
 20472
 20473     IF CTBL-SW = '0530'
 20474         MOVE 'AA'                     TO WS-AH-COMP-CD
 20475         MOVE '0550'                   TO CTBL-SW
 20476         MOVE '1'                      TO WS-CTBL-READ-SW
 20477         GO TO 8300-EXIT.
 20478
 20479     IF CTBL-SW = '0540'
 20480         MOVE 'AA'                     TO WS-LF-COMP-CD
 20481         MOVE '0550'                   TO CTBL-SW
 20482         MOVE '1'                      TO WS-CTBL-READ-SW
 20483         GO TO 8300-EXIT.
 20484
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 378
* EL050.cbl
 20485     IF CTBL-SW = '0550'
 20486         MOVE '2'                      TO WS-CTBL-READ-SW
 20487         GO TO 8300-EXIT.
 20488
 20489     GO TO 8300-EXIT.
 20490
 20491 8300-ERRESS-PROBLEM.
 20492
 20493      MOVE ER-8050              TO WS-ERROR.
 20494      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20495
 20496     GO TO 8300-EXIT.
 20497
 20498 8300-EXIT.
 20499      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 379
* EL050.cbl
 20501
 20502
 20503 8400-GETMAIN-ERFORM.
 20504
 20505
 20506* EXEC CICS   GETMAIN
 20507*        LENGTH  (500)
 20508*        SET     (ADDRESS OF FORM-MASTER)
 20509*    END-EXEC.
 20510     MOVE 500
 20511       TO DFHEIV11
 20512*    MOVE '," L                  $   #00019522' TO DFHEIV0
 20513     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20514     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20515     MOVE X'2020233030303139353232' TO DFHEIV0(25:11)
 20516     CALL 'kxdfhei1' USING DFHEIV0,
 20517           DFHEIV20,
 20518           DFHEIV11,
 20519           DFHEIV99
 20520     SET ADDRESS OF FORM-MASTER TO
 20521         DFHEIV20
 20522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20523
 20524
 20525     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20526
 20527 8400-EXIT.
 20528      EXIT.
 20529
 20530 8450-READ-FORM-MASTER.
 20531
 20532
 20533* EXEC CICS  HANDLE CONDITION
 20534*        NOTFND   (8450-FORM-NOT-FOUND)
 20535*        ENDFILE  (8450-FORM-NOT-FOUND)
 20536*    END-EXEC.
 20537*    MOVE '"$I''                  ! 5 #00019534' TO DFHEIV0
 20538     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20539     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20540     MOVE X'3520233030303139353334' TO DFHEIV0(25:11)
 20541     CALL 'kxdfhei1' USING DFHEIV0
 20542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20543
 20544
 20545
 20546* EXEC CICS   READ
 20547*        DATASET   (FORM-ID)
 20548*        RIDFLD    (ERFORM-KEY)
 20549*        INTO      (FORM-MASTER)
 20550*        GTEQ
 20551*    END-EXEC.
 20552     MOVE LENGTH OF
 20553      FORM-MASTER
 20554       TO DFHEIV11
 20555*    MOVE '&"IL       G          (   #00019539' TO DFHEIV0
 20556     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20557     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20558     MOVE X'2020233030303139353339' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 380
* EL050.cbl
 20559     CALL 'kxdfhei1' USING DFHEIV0,
 20560           FORM-ID,
 20561           FORM-MASTER,
 20562           DFHEIV11,
 20563           ERFORM-KEY,
 20564           DFHEIV99,
 20565           DFHEIV99,
 20566           DFHEIV99
 20567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20568
 20569
 20570     MOVE  'Y'           TO  FORM-MASTER-SW.
 20571
 20572     GO TO  8450-EXIT.
 20573
 20574 8450-FORM-NOT-FOUND.
 20575
 20576     MOVE  'N'           TO  FORM-MASTER-SW.
 20577
 20578 8450-EXIT.
 20579      EXIT.
 20580
 20581 8500-DATE-CONVERT.
 20582
 20583* EXEC CICS LINK
 20584*        PROGRAM    ('ELDATCV')
 20585*        COMMAREA   (DATE-CONVERSION-DATA)
 20586*        LENGTH     (DC-COMM-LENGTH)
 20587*    END-EXEC.
 20588     MOVE 'ELDATCV' TO DFHEIV1
 20589*    MOVE '."C                   (   #00019558' TO DFHEIV0
 20590     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20591     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20592     MOVE X'2020233030303139353538' TO DFHEIV0(25:11)
 20593     CALL 'kxdfhei1' USING DFHEIV0,
 20594           DFHEIV1,
 20595           DATE-CONVERSION-DATA,
 20596           DC-COMM-LENGTH,
 20597           DFHEIV99,
 20598           DFHEIV99,
 20599           DFHEIV99,
 20600           DFHEIV99
 20601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20602
 20603
 20604 8500-EXIT.
 20605     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 381
* EL050.cbl
 20607
 20608 8555-RELOAD-CONTROL-FILE.
 20609     CONTINUE.
 20610
 20611 8555-EXIT.
 20612     EXIT.
 20613
 20614 8557-GETMAIN-ERPLAN.
 20615
 20616
 20617* EXEC CICS GETMAIN
 20618*        LENGTH    (840)
 20619*        SET       (ADDRESS OF PLAN-RECORDS)
 20620*    END-EXEC.
 20621     MOVE 840
 20622       TO DFHEIV11
 20623*    MOVE '," L                  $   #00019576' TO DFHEIV0
 20624     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20625     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20626     MOVE X'2020233030303139353736' TO DFHEIV0(25:11)
 20627     CALL 'kxdfhei1' USING DFHEIV0,
 20628           DFHEIV20,
 20629           DFHEIV11,
 20630           DFHEIV99
 20631     SET ADDRESS OF PLAN-RECORDS TO
 20632         DFHEIV20
 20633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20634
 20635
 20636     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20637
 20638 8557-EXIT.
 20639     EXIT.
 20640
 20641 8560-GETMAIN.
 20642
 20643* EXEC CICS GETMAIN
 20644*        LENGTH    (2000)
 20645*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20646*    END-EXEC.
 20647     MOVE 2000
 20648       TO DFHEIV11
 20649*    MOVE '," L                  $   #00019587' TO DFHEIV0
 20650     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20651     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20652     MOVE X'2020233030303139353837' TO DFHEIV0(25:11)
 20653     CALL 'kxdfhei1' USING DFHEIV0,
 20654           DFHEIV20,
 20655           DFHEIV11,
 20656           DFHEIV99
 20657     SET ADDRESS OF ACCOUNT-MASTER TO
 20658         DFHEIV20
 20659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20660
 20661
 20662     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20663
 20664 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 382
* EL050.cbl
 20665     EXIT.
 20666
 20667 8570-START-ACCOUNT-MASTER.
 20668
 20669* EXEC CICS HANDLE CONDITION
 20670*        NOTFND    (0199-ACCT-NOT-FOUND)
 20671*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20672*    END-EXEC.
 20673*    MOVE '"$I''                  ! 6 #00019598' TO DFHEIV0
 20674     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20675     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20676     MOVE X'3620233030303139353938' TO DFHEIV0(25:11)
 20677     CALL 'kxdfhei1' USING DFHEIV0
 20678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20679
 20680
 20681
 20682* EXEC CICS STARTBR
 20683*        DATASET    (ACCT-ID)
 20684*        RIDFLD     (ERACCT-KEY)
 20685*        GTEQ
 20686*    END-EXEC.
 20687     MOVE 0
 20688       TO DFHEIV11
 20689*    MOVE '&,         G          &   #00019603' TO DFHEIV0
 20690     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20691     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20692     MOVE X'2020233030303139363033' TO DFHEIV0(25:11)
 20693     CALL 'kxdfhei1' USING DFHEIV0,
 20694           ACCT-ID,
 20695           ERACCT-KEY,
 20696           DFHEIV99,
 20697           DFHEIV11,
 20698           DFHEIV99
 20699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20700
 20701
 20702 8570-EXIT.
 20703     EXIT.
 20704
 20705 8580-READ-ACCOUNT-MASTER.
 20706
 20707* EXEC CICS HANDLE CONDITION
 20708*        NOTFND    (0199-ACCT-NOT-FOUND)
 20709*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20710*    END-EXEC.
 20711*    MOVE '"$I''                  ! 7 #00019613' TO DFHEIV0
 20712     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20714     MOVE X'3720233030303139363133' TO DFHEIV0(25:11)
 20715     CALL 'kxdfhei1' USING DFHEIV0
 20716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20717
 20718
 20719
 20720* EXEC CICS READNEXT
 20721*        DATASET     (ACCT-ID)
 20722*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 383
* EL050.cbl
 20723*        RIDFLD      (ERACCT-KEY)
 20724*    END-EXEC.
 20725     MOVE LENGTH OF
 20726      ACCOUNT-MASTER
 20727       TO DFHEIV12
 20728     MOVE 0
 20729       TO DFHEIV11
 20730*    MOVE '&.IL                  )   #00019618' TO DFHEIV0
 20731     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20732     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20733     MOVE X'2020233030303139363138' TO DFHEIV0(25:11)
 20734     CALL 'kxdfhei1' USING DFHEIV0,
 20735           ACCT-ID,
 20736           ACCOUNT-MASTER,
 20737           DFHEIV12,
 20738           ERACCT-KEY,
 20739           DFHEIV99,
 20740           DFHEIV11,
 20741           DFHEIV99,
 20742           DFHEIV99
 20743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20744
 20745
 20746 8580-EXIT.
 20747     EXIT.
 20748
 20749 8582-READ-COMPENSATION-MASTER.
 20750
 20751* EXEC CICS HANDLE CONDITION
 20752*        NOTFND    (8582-COMP-NOT-FOUND)
 20753*        ENDFILE   (8582-COMP-NOT-FOUND)
 20754*    END-EXEC.
 20755*    MOVE '"$I''                  ! 8 #00019628' TO DFHEIV0
 20756     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20758     MOVE X'3820233030303139363238' TO DFHEIV0(25:11)
 20759     CALL 'kxdfhei1' USING DFHEIV0
 20760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20761
 20762
 20763
 20764* EXEC CICS READ
 20765*        DATASET     (COMP-ID)
 20766*        INTO        (COMPENSATION-MASTER)
 20767*        RIDFLD      (ERCOMP-KEY)
 20768*    END-EXEC.
 20769     MOVE LENGTH OF
 20770      COMPENSATION-MASTER
 20771       TO DFHEIV11
 20772*    MOVE '&"IL       E          (   #00019633' TO DFHEIV0
 20773     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20774     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20775     MOVE X'2020233030303139363333' TO DFHEIV0(25:11)
 20776     CALL 'kxdfhei1' USING DFHEIV0,
 20777           COMP-ID,
 20778           COMPENSATION-MASTER,
 20779           DFHEIV11,
 20780           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 384
* EL050.cbl
 20781           DFHEIV99,
 20782           DFHEIV99,
 20783           DFHEIV99
 20784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20785
 20786
 20787     MOVE 'Y'                    TO COMP-MASTER-SW
 20788
 20789     GO TO 8582-EXIT
 20790     .
 20791 8582-COMP-NOT-FOUND.
 20792
 20793     MOVE 'N'                    TO COMP-MASTER-SW.
 20794
 20795 8582-EXIT.
 20796     EXIT.
 20797
 20798 8583-READ-ERAGTC.
 20799
 20800* EXEC CICS HANDLE CONDITION
 20801*        NOTFND    (8583-AGTC-NOT-FOUND)
 20802*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20803*    END-EXEC.
 20804*    MOVE '"$I''                  ! 9 #00019651' TO DFHEIV0
 20805     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20806     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20807     MOVE X'3920233030303139363531' TO DFHEIV0(25:11)
 20808     CALL 'kxdfhei1' USING DFHEIV0
 20809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20810
 20811
 20812
 20813* EXEC CICS STARTBR
 20814*        DATASET    (AGTC-ID)
 20815*        RIDFLD     (ERAGTC-KEY)
 20816*        GTEQ
 20817*    END-EXEC.
 20818     MOVE 0
 20819       TO DFHEIV11
 20820*    MOVE '&,         G          &   #00019656' TO DFHEIV0
 20821     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20822     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20823     MOVE X'2020233030303139363536' TO DFHEIV0(25:11)
 20824     CALL 'kxdfhei1' USING DFHEIV0,
 20825           AGTC-ID,
 20826           ERAGTC-KEY,
 20827           DFHEIV99,
 20828           DFHEIV11,
 20829           DFHEIV99
 20830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20831
 20832
 20833 8583-READ-ERAGTC-NEXT.
 20834
 20835* EXEC CICS READNEXT
 20836*        DATASET     (AGTC-ID)
 20837*        INTO        (AGENT-COMMISSIONS)
 20838*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 385
* EL050.cbl
 20839*    END-EXEC.
 20840     MOVE LENGTH OF
 20841      AGENT-COMMISSIONS
 20842       TO DFHEIV12
 20843     MOVE 0
 20844       TO DFHEIV11
 20845*    MOVE '&.IL                  )   #00019663' TO DFHEIV0
 20846     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20847     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20848     MOVE X'2020233030303139363633' TO DFHEIV0(25:11)
 20849     CALL 'kxdfhei1' USING DFHEIV0,
 20850           AGTC-ID,
 20851           AGENT-COMMISSIONS,
 20852           DFHEIV12,
 20853           ERAGTC-KEY,
 20854           DFHEIV99,
 20855           DFHEIV11,
 20856           DFHEIV99,
 20857           DFHEIV99
 20858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20859
 20860
 20861*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20862
 20863     GO TO 8583-EXIT
 20864     .
 20865 8583-AGTC-NOT-FOUND.
 20866
 20867     MOVE 'N'                    TO AGTC-MASTER-SW.
 20868
 20869 8583-EXIT.
 20870     EXIT.
 20871
 20872 8584-READ-BANK-CROSS-REF.
 20873
 20874* EXEC CICS HANDLE CONDITION
 20875*        NOTFND    (8584-BXRF-NOT-FOUND)
 20876*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20877*    END-EXEC.
 20878*    MOVE '"$I''                  ! : #00019681' TO DFHEIV0
 20879     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20881     MOVE X'3A20233030303139363831' TO DFHEIV0(25:11)
 20882     CALL 'kxdfhei1' USING DFHEIV0
 20883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20884
 20885
 20886
 20887* EXEC CICS READ
 20888*        DATASET     (BXRF-ID)
 20889*        INTO        (BANK-CROSS-REFERENCE)
 20890*        RIDFLD      (ERBXRF-KEY)
 20891*        LENGTH      (BXRF-REC-LENGTH)
 20892*    END-EXEC.
 20893*    MOVE '&"IL       E          (   #00019686' TO DFHEIV0
 20894     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20895     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20896     MOVE X'2020233030303139363836' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 386
* EL050.cbl
 20897     CALL 'kxdfhei1' USING DFHEIV0,
 20898           BXRF-ID,
 20899           BANK-CROSS-REFERENCE,
 20900           BXRF-REC-LENGTH,
 20901           ERBXRF-KEY,
 20902           DFHEIV99,
 20903           DFHEIV99,
 20904           DFHEIV99
 20905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20906
 20907
 20908     MOVE 'Y'                    TO BXRF-MASTER-SW
 20909
 20910     GO TO 8584-EXIT
 20911     .
 20912 8584-BXRF-NOT-FOUND.
 20913
 20914     MOVE 'N'                    TO BXRF-MASTER-SW.
 20915
 20916 8584-EXIT.
 20917     EXIT.
 20918
 20919 8585-READ-PLAN-MASTER.
 20920
 20921
 20922* EXEC CICS HANDLE CONDITION
 20923*        NOTFND    (8585-PLAN-NOT-FOUND)
 20924*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20925*    END-EXEC.
 20926*    MOVE '"$I''                  ! ; #00019706' TO DFHEIV0
 20927     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20929     MOVE X'3B20233030303139373036' TO DFHEIV0(25:11)
 20930     CALL 'kxdfhei1' USING DFHEIV0
 20931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20932
 20933
 20934
 20935* EXEC CICS READ
 20936*        DATASET     (PLAN-ID)
 20937*        INTO        (PLAN-MASTER)
 20938*        RIDFLD      (ERPLAN-KEY)
 20939*    END-EXEC.
 20940     MOVE LENGTH OF
 20941      PLAN-MASTER
 20942       TO DFHEIV11
 20943*    MOVE '&"IL       E          (   #00019711' TO DFHEIV0
 20944     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20945     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20946     MOVE X'2020233030303139373131' TO DFHEIV0(25:11)
 20947     CALL 'kxdfhei1' USING DFHEIV0,
 20948           PLAN-ID,
 20949           PLAN-MASTER,
 20950           DFHEIV11,
 20951           ERPLAN-KEY,
 20952           DFHEIV99,
 20953           DFHEIV99,
 20954           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 387
* EL050.cbl
 20955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20956
 20957
 20958     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20959
 20960     GO TO 8585-EXIT.
 20961
 20962 8585-PLAN-NOT-FOUND.
 20963
 20964     MOVE 'N'                    TO PLAN-MASTER-SW.
 20965
 20966 8585-EXIT.
 20967     EXIT.
 20968
 20969 8586-READ-LOAN-OFFICER.
 20970
 20971* EXEC CICS READ
 20972*        DATASET     (LOFC-ID)
 20973*        INTO        (LOAN-OFFICER-MASTER)
 20974*        RIDFLD      (ERLOFC-KEY)
 20975*        RESP        (WS-RESPONSE)
 20976*    END-EXEC
 20977     MOVE LENGTH OF
 20978      LOAN-OFFICER-MASTER
 20979       TO DFHEIV11
 20980*    MOVE '&"IL       E          (  N#00019729' TO DFHEIV0
 20981     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20982     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20983     MOVE X'204E233030303139373239' TO DFHEIV0(25:11)
 20984     CALL 'kxdfhei1' USING DFHEIV0,
 20985           LOFC-ID,
 20986           LOAN-OFFICER-MASTER,
 20987           DFHEIV11,
 20988           ERLOFC-KEY,
 20989           DFHEIV99,
 20990           DFHEIV99,
 20991           DFHEIV99
 20992     MOVE EIBRESP  TO WS-RESPONSE
 20993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20994
 20995     IF WS-RESP-NORMAL
 20996        MOVE 'Y'                 TO LOFC-MASTER-SW
 20997     ELSE
 20998        MOVE 'N'                 TO LOFC-MASTER-SW
 20999     END-IF
 21000     .
 21001 8586-EXIT.
 21002     EXIT.
 21003 8587-START-ERPDEF.
 21004
 21005* EXEC CICS STARTBR
 21006*       DATASET   (PDEF-ID)
 21007*       RIDFLD    (ERPDEF-KEY)
 21008*       GTEQ
 21009*       RESP      (WS-RESPONSE)
 21010*    END-EXEC
 21011     MOVE 0
 21012       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 388
* EL050.cbl
 21013*    MOVE '&,         G          &  N#00019745' TO DFHEIV0
 21014     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21015     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21016     MOVE X'204E233030303139373435' TO DFHEIV0(25:11)
 21017     CALL 'kxdfhei1' USING DFHEIV0,
 21018           PDEF-ID,
 21019           ERPDEF-KEY,
 21020           DFHEIV99,
 21021           DFHEIV11,
 21022           DFHEIV99
 21023     MOVE EIBRESP  TO WS-RESPONSE
 21024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21025     IF WS-RESP-NORMAL
 21026        MOVE 'Y'                 TO PDEF-MASTER-SW
 21027     ELSE
 21028        MOVE 'N'                 TO PDEF-MASTER-SW
 21029     END-IF
 21030     .
 21031 8587-EXIT.
 21032     EXIT.
 21033 8588-READ-ERPDEF.
 21034
 21035* EXEC CICS READNEXT
 21036*       DATASET   (PDEF-ID)
 21037*       RIDFLD    (ERPDEF-KEY)
 21038*       INTO      (PRODUCT-MASTER)
 21039*       RESP      (WS-RESPONSE)
 21040*    END-EXEC
 21041     MOVE LENGTH OF
 21042      PRODUCT-MASTER
 21043       TO DFHEIV12
 21044     MOVE 0
 21045       TO DFHEIV11
 21046*    MOVE '&.IL                  )  N#00019760' TO DFHEIV0
 21047     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21048     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21049     MOVE X'204E233030303139373630' TO DFHEIV0(25:11)
 21050     CALL 'kxdfhei1' USING DFHEIV0,
 21051           PDEF-ID,
 21052           PRODUCT-MASTER,
 21053           DFHEIV12,
 21054           ERPDEF-KEY,
 21055           DFHEIV99,
 21056           DFHEIV11,
 21057           DFHEIV99,
 21058           DFHEIV99
 21059     MOVE EIBRESP  TO WS-RESPONSE
 21060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21061     IF WS-RESP-NORMAL
 21062        MOVE 'Y'                 TO PDEF-MASTER-SW
 21063     ELSE
 21064        MOVE 'N'                 TO PDEF-MASTER-SW
 21065     END-IF
 21066     .
 21067 8588-EXIT.
 21068     EXIT.
 21069 8589-ENDBR-ERPDEF.
 21070
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 389
* EL050.cbl
 21071* EXEC CICS ENDBR
 21072*       DATASET   (PDEF-ID)
 21073*    END-EXEC
 21074     MOVE 0
 21075       TO DFHEIV11
 21076*    MOVE '&2                    $   #00019775' TO DFHEIV0
 21077     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21078     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21079     MOVE X'2020233030303139373735' TO DFHEIV0(25:11)
 21080     CALL 'kxdfhei1' USING DFHEIV0,
 21081           PDEF-ID,
 21082           DFHEIV11,
 21083           DFHEIV99
 21084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21085     .
 21086 8589-EXIT.
 21087     EXIT.
 21088 8590-READ-CERT-MASTER.
 21089     IF PB-COMPANY-ID = 'UCL'
 21090         GO TO 8690-READ-CERT-MASTER-UCL.
 21091
 21092
 21093* EXEC CICS HANDLE CONDITION
 21094*         NOTFND    (0299-CERT-NOT-FOUND)
 21095*    END-EXEC.
 21096*    MOVE '"$I                   ! < #00019785' TO DFHEIV0
 21097     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21099     MOVE X'3C20233030303139373835' TO DFHEIV0(25:11)
 21100     CALL 'kxdfhei1' USING DFHEIV0
 21101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21102
 21103
 21104
 21105* EXEC CICS READ
 21106*        DATASET     (CERT-ID)
 21107*        INTO        (CERTIFICATE-MASTER)
 21108*        RIDFLD      (ELCERT-KEY)
 21109*        UPDATE
 21110*    END-EXEC.
 21111     MOVE LENGTH OF
 21112      CERTIFICATE-MASTER
 21113       TO DFHEIV11
 21114*    MOVE '&"IL       EU         (   #00019789' TO DFHEIV0
 21115     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21117     MOVE X'2020233030303139373839' TO DFHEIV0(25:11)
 21118     CALL 'kxdfhei1' USING DFHEIV0,
 21119           CERT-ID,
 21120           CERTIFICATE-MASTER,
 21121           DFHEIV11,
 21122           ELCERT-KEY,
 21123           DFHEIV99,
 21124           DFHEIV99,
 21125           DFHEIV99
 21126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21127
 21128
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 390
* EL050.cbl
 21129 8590-EXIT.
 21130     EXIT.
 21131
 21132 8690-READ-CERT-MASTER-UCL.
 21133
 21134* EXEC CICS HANDLE CONDITION
 21135*         NOTFND    (8700-READ-CERT-MASTER)
 21136*    END-EXEC.
 21137*    MOVE '"$I                   ! = #00019800' TO DFHEIV0
 21138     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21140     MOVE X'3D20233030303139383030' TO DFHEIV0(25:11)
 21141     CALL 'kxdfhei1' USING DFHEIV0
 21142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21143
 21144
 21145 8690-READ-CERT-CONT.
 21146
 21147* EXEC CICS READ
 21148*        DATASET     (CERT-ID)
 21149*        INTO        (CERTIFICATE-MASTER)
 21150*        RIDFLD      (ELCERT-KEY)
 21151*        UPDATE
 21152*    END-EXEC.
 21153     MOVE LENGTH OF
 21154      CERTIFICATE-MASTER
 21155       TO DFHEIV11
 21156*    MOVE '&"IL       EU         (   #00019805' TO DFHEIV0
 21157     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21158     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21159     MOVE X'2020233030303139383035' TO DFHEIV0(25:11)
 21160     CALL 'kxdfhei1' USING DFHEIV0,
 21161           CERT-ID,
 21162           CERTIFICATE-MASTER,
 21163           DFHEIV11,
 21164           ELCERT-KEY,
 21165           DFHEIV99,
 21166           DFHEIV99,
 21167           DFHEIV99
 21168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21169
 21170
 21171     GO TO 8590-EXIT.
 21172
 21173 8700-READ-CERT-MASTER.
 21174     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21175     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21176
 21177* EXEC CICS HANDLE CONDITION
 21178*         DUPKEY    (8720-COMP-ACCOUNTS)
 21179*         ENDFILE   (8730-END-BROWSE)
 21180*         NOTFND    (8740-NOT-FOUND)
 21181*    END-EXEC.
 21182*    MOVE '"$$''I                 ! > #00019817' TO DFHEIV0
 21183     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21184     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21185     MOVE X'3E20233030303139383137' TO DFHEIV0(25:11)
 21186     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 391
* EL050.cbl
 21187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21188
 21189
 21190
 21191* EXEC CICS STARTBR
 21192*        DATASET     ('ELCERT5')
 21193*        RIDFLD      (ELCERT2-KEY)
 21194*        EQUAL
 21195*    END-EXEC.
 21196     MOVE 'ELCERT5' TO DFHEIV1
 21197     MOVE 0
 21198       TO DFHEIV11
 21199*    MOVE '&,         E          &   #00019823' TO DFHEIV0
 21200     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21201     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21202     MOVE X'2020233030303139383233' TO DFHEIV0(25:11)
 21203     CALL 'kxdfhei1' USING DFHEIV0,
 21204           DFHEIV1,
 21205           ELCERT2-KEY,
 21206           DFHEIV99,
 21207           DFHEIV11,
 21208           DFHEIV99
 21209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21210
 21211
 21212 8710-READ-NEXT.
 21213
 21214* EXEC CICS READNEXT
 21215*        DATASET     ('ELCERT5')
 21216*        INTO        (CERTIFICATE-MASTER)
 21217*        RIDFLD      (ELCERT2-KEY)
 21218*    END-EXEC.
 21219     MOVE LENGTH OF
 21220      CERTIFICATE-MASTER
 21221       TO DFHEIV12
 21222     MOVE 'ELCERT5' TO DFHEIV1
 21223     MOVE 0
 21224       TO DFHEIV11
 21225*    MOVE '&.IL                  )   #00019830' TO DFHEIV0
 21226     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21227     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21228     MOVE X'2020233030303139383330' TO DFHEIV0(25:11)
 21229     CALL 'kxdfhei1' USING DFHEIV0,
 21230           DFHEIV1,
 21231           CERTIFICATE-MASTER,
 21232           DFHEIV12,
 21233           ELCERT2-KEY,
 21234           DFHEIV99,
 21235           DFHEIV11,
 21236           DFHEIV99,
 21237           DFHEIV99
 21238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21239
 21240
 21241 8720-COMP-ACCOUNTS.
 21242
 21243* EXEC CICS ENTER
 21244*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 392
* EL050.cbl
 21245*         FROM (PB-C-LAST-NAME)
 21246*    END-EXEC.
 21247     MOVE 001
 21248       TO DFHEIV11
 21249*    MOVE ':$F                   %   #00019837' TO DFHEIV0
 21250     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21251     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21252     MOVE X'2020233030303139383337' TO DFHEIV0(25:11)
 21253     CALL 'kxdfhei1' USING DFHEIV0,
 21254           DFHEIV11,
 21255           PB-C-LAST-NAME,
 21256           DFHEIV99,
 21257           DFHEIV99
 21258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21259
 21260
 21261
 21262* EXEC CICS ENTER
 21263*         TRACEID (002)
 21264*         FROM (CM-INSURED-LAST-NAME)
 21265*    END-EXEC.
 21266     MOVE 002
 21267       TO DFHEIV11
 21268*    MOVE ':$F                   %   #00019842' TO DFHEIV0
 21269     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21270     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21271     MOVE X'2020233030303139383432' TO DFHEIV0(25:11)
 21272     CALL 'kxdfhei1' USING DFHEIV0,
 21273           DFHEIV11,
 21274           CM-INSURED-LAST-NAME,
 21275           DFHEIV99,
 21276           DFHEIV99
 21277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21278
 21279
 21280     IF PB-CERT-NO NOT = CM-CERT-NO
 21281         GO TO 8730-END-BROWSE.
 21282
 21283     IF PB-ACCOUNT = CM-ACCOUNT
 21284         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21285             MOVE ER-2799        TO WS-ERROR
 21286             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21287             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21288             GO TO 8730-END-BROWSE.
 21289
 21290     GO TO 8710-READ-NEXT.
 21291
 21292 8730-END-BROWSE.
 21293
 21294* EXEC CICS ENDBR
 21295*         DATASET    ('ELCERT5')
 21296*    END-EXEC.
 21297     MOVE 'ELCERT5' TO DFHEIV1
 21298     MOVE 0
 21299       TO DFHEIV11
 21300*    MOVE '&2                    $   #00019860' TO DFHEIV0
 21301     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21302     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 393
* EL050.cbl
 21303     MOVE X'2020233030303139383630' TO DFHEIV0(25:11)
 21304     CALL 'kxdfhei1' USING DFHEIV0,
 21305           DFHEIV1,
 21306           DFHEIV11,
 21307           DFHEIV99
 21308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21309
 21310
 21311 8740-NOT-FOUND.
 21312     GO TO 0299-CERT-NOT-FOUND.
 21313
 21314 8750-START-ELSTAT.
 21315
 21316* EXEC CICS STARTBR
 21317*       DATASET   (STAT-ID)
 21318*       RIDFLD    (ELSTAT-KEY)
 21319*       GTEQ
 21320*       RESP      (WS-RESPONSE)
 21321*    END-EXEC
 21322     MOVE 0
 21323       TO DFHEIV11
 21324*    MOVE '&,         G          &  N#00019868' TO DFHEIV0
 21325     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21326     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21327     MOVE X'204E233030303139383638' TO DFHEIV0(25:11)
 21328     CALL 'kxdfhei1' USING DFHEIV0,
 21329           STAT-ID,
 21330           ELSTAT-KEY,
 21331           DFHEIV99,
 21332           DFHEIV11,
 21333           DFHEIV99
 21334     MOVE EIBRESP  TO WS-RESPONSE
 21335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21336     IF WS-RESP-NORMAL
 21337        MOVE 'Y'                 TO STAT-MASTER-SW
 21338     ELSE
 21339        MOVE 'N'                 TO STAT-MASTER-SW
 21340     END-IF
 21341     .
 21342 8750-EXIT.
 21343     EXIT.
 21344 8752-READ-ELSTAT.
 21345
 21346* EXEC CICS READNEXT
 21347*       DATASET   (STAT-ID)
 21348*       RIDFLD    (ELSTAT-KEY)
 21349*       INTO      (STATE-FILE)
 21350*       RESP      (WS-RESPONSE)
 21351*    END-EXEC
 21352     MOVE LENGTH OF
 21353      STATE-FILE
 21354       TO DFHEIV12
 21355     MOVE 0
 21356       TO DFHEIV11
 21357*    MOVE '&.IL                  )  N#00019883' TO DFHEIV0
 21358     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21359     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21360     MOVE X'204E233030303139383833' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 394
* EL050.cbl
 21361     CALL 'kxdfhei1' USING DFHEIV0,
 21362           STAT-ID,
 21363           STATE-FILE,
 21364           DFHEIV12,
 21365           ELSTAT-KEY,
 21366           DFHEIV99,
 21367           DFHEIV11,
 21368           DFHEIV99,
 21369           DFHEIV99
 21370     MOVE EIBRESP  TO WS-RESPONSE
 21371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21372     IF WS-RESP-NORMAL
 21373        MOVE 'Y'                 TO STAT-MASTER-SW
 21374     ELSE
 21375        MOVE 'N'                 TO STAT-MASTER-SW
 21376     END-IF
 21377     .
 21378 8752-EXIT.
 21379     EXIT.
 21380 8800-GET-COMP-RATE.
 21381     MOVE +1 TO IB.
 21382     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21383         ADD +9 TO IB
 21384         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21385             ADD +9 TO IB
 21386             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21387                MOVE ZEROS       TO WS-WK-RATE
 21388                GO TO 8800-EXIT.
 21389
 21390     IF PB-I-AGE GREATER CT-AGE (1)
 21391         ADD +3 TO IB
 21392         IF PB-I-AGE GREATER CT-AGE (2)
 21393             ADD +3 TO IB
 21394             IF PB-I-AGE GREATER CT-AGE (3)
 21395                MOVE ZEROS       TO WS-WK-RATE
 21396                GO TO 8800-EXIT.
 21397
 21398     IF WS-WORK-TERM GREATER CT-TRM (1)
 21399         ADD +1 TO IB
 21400         IF WS-WORK-TERM GREATER CT-TRM (2)
 21401             ADD +1 TO IB
 21402             IF WS-WORK-TERM GREATER CT-TRM (3)
 21403                MOVE ZEROS       TO WS-WK-RATE
 21404                GO TO 8800-EXIT.
 21405
 21406     IF CT-RT (IB) NOT NUMERIC
 21407         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21408         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21409         GO TO 8800-GET-COMP-RATE.
 21410
 21411     MOVE CT-RT (IB) TO WS-WK-RATE.
 21412
 21413 8800-EXIT.
 21414     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 395
* EL050.cbl
 21416 8900-ADDRESS-FILE.
 21417     IF ERACCT-FILE-ADDRESSED
 21418         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21419         GO TO 8900-ADDRESS-EXIT.
 21420
 21421     IF ELCNTL-FILE-ADDRESSED
 21422         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21423         GO TO 8900-ADDRESS-EXIT.
 21424
 21425     IF ERPLAN-FILE-ADDRESSED
 21426         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21427         GO TO 8900-ADDRESS-EXIT.
 21428
 21429     IF ERFORM-FILE-ADDRESSED
 21430         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21431         GO TO 8900-ADDRESS-EXIT.
 21432
 21433 8900-ADDRESS-EXIT.
 21434     EXIT.
 21435
 21436 9000-READ-CONTROL.
 21437
 21438* EXEC CICS HANDLE CONDITION
 21439*        NOTFND    (9000-NOTFND)
 21440*    END-EXEC.
 21441*    MOVE '"$I                   ! ? #00019954' TO DFHEIV0
 21442     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21443     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21444     MOVE X'3F20233030303139393534' TO DFHEIV0(25:11)
 21445     CALL 'kxdfhei1' USING DFHEIV0
 21446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21447
 21448
 21449
 21450* EXEC CICS READ
 21451*        DATASET     (CNTL-ID)
 21452*        SET         (ADDRESS OF CONTROL-FILE)
 21453*        RIDFLD      (ELCNTL-KEY)
 21454*        GTEQ
 21455*    END-EXEC.
 21456*    MOVE '&"S        G          (   #00019958' TO DFHEIV0
 21457     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21458     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21459     MOVE X'2020233030303139393538' TO DFHEIV0(25:11)
 21460     CALL 'kxdfhei1' USING DFHEIV0,
 21461           CNTL-ID,
 21462           DFHEIV20,
 21463           DFHEIV99,
 21464           ELCNTL-KEY,
 21465           DFHEIV99,
 21466           DFHEIV99,
 21467           DFHEIV99
 21468     SET ADDRESS OF CONTROL-FILE TO
 21469         DFHEIV20
 21470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21471
 21472
 21473     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 396
* EL050.cbl
 21474
 21475 9000-NOTFND.
 21476     IF RC-SW-1 = '1'
 21477        MOVE ER-2616              TO WS-ERROR
 21478        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21479        GO TO 9000-EXIT.
 21480
 21481     IF RC-SW-1 = '2'
 21482        MOVE ER-2602              TO WS-ERROR
 21483        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21484
 21485 9000-EXIT.
 21486      EXIT.
 21487
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 397
* EL050.cbl
 21489 9100-READ-CONTROL.
 21490
 21491* EXEC CICS HANDLE CONDITION
 21492*        NOTFND  (9100-NOTFND)
 21493*        ENDFILE (9100-NOTFND)
 21494*    END-EXEC.
 21495*    MOVE '"$I''                  ! @ #00019982' TO DFHEIV0
 21496     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21498     MOVE X'4020233030303139393832' TO DFHEIV0(25:11)
 21499     CALL 'kxdfhei1' USING DFHEIV0
 21500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21501
 21502
 21503
 21504* EXEC CICS READ
 21505*        DATASET     (CNTL-ID)
 21506*        INTO        (CONTROL-FILE)
 21507*        RIDFLD      (ELCNTL-KEY)
 21508*        GTEQ
 21509*    END-EXEC.
 21510     MOVE LENGTH OF
 21511      CONTROL-FILE
 21512       TO DFHEIV11
 21513*    MOVE '&"IL       G          (   #00019987' TO DFHEIV0
 21514     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21516     MOVE X'2020233030303139393837' TO DFHEIV0(25:11)
 21517     CALL 'kxdfhei1' USING DFHEIV0,
 21518           CNTL-ID,
 21519           CONTROL-FILE,
 21520           DFHEIV11,
 21521           ELCNTL-KEY,
 21522           DFHEIV99,
 21523           DFHEIV99,
 21524           DFHEIV99
 21525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21526
 21527
 21528     GO TO 9100-EXIT.
 21529
 21530 9100-NOTFND.
 21531     IF RC-SW-2 = '0'
 21532        MOVE '1'                  TO STATE-RECORD-ERROR
 21533        GO TO 9100-EXIT
 21534     END-IF
 21535     IF RC-SW-2 = '1'
 21536        MOVE '1'                  TO LF-BENEFIT-ERROR
 21537        MOVE ER-2604              TO WS-ERROR
 21538        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21539        GO TO 9100-EXIT.
 21540
 21541     IF RC-SW-2 = '2'
 21542        MOVE '1'                  TO AH-BENEFIT-ERROR
 21543        MOVE ER-2605              TO WS-ERROR
 21544        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21545        GO TO 9100-EXIT.
 21546
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 398
* EL050.cbl
 21547     IF RC-SW-2 = '3'
 21548         MOVE ER-2603           TO WS-ERROR
 21549         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21550         GO TO 9100-EXIT.
 21551
 21552     IF RC-SW-2 = '4'
 21553         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21554         GO TO 9100-EXIT.
 21555
 21556     IF RC-SW-2 = '5'
 21557         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21558         IF WS-AH-INPUT-CD-1 = SPACE
 21559             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21560         ELSE
 21561             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21562
 21563 9100-EXIT.
 21564      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 399
* EL050.cbl
 21566 9200-CONTROL-GETMAIN.
 21567
 21568* EXEC CICS GETMAIN
 21569*         LENGTH   (750)
 21570*         SET      (ADDRESS OF CONTROL-FILE)
 21571*    END-EXEC.
 21572     MOVE 750
 21573       TO DFHEIV11
 21574*    MOVE '," L                  $   #00020033' TO DFHEIV0
 21575     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21576     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21577     MOVE X'2020233030303230303333' TO DFHEIV0(25:11)
 21578     CALL 'kxdfhei1' USING DFHEIV0,
 21579           DFHEIV20,
 21580           DFHEIV11,
 21581           DFHEIV99
 21582     SET ADDRESS OF CONTROL-FILE TO
 21583         DFHEIV20
 21584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21585
 21586
 21587     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21588
 21589 9200-EXIT.
 21590     EXIT.
 21591
 21592 9250-UNLOCK-RETURN.
 21593
 21594* EXEC CICS UNLOCK
 21595*        DATASET   (CERT-ID)
 21596*    END-EXEC.
 21597*    MOVE '&*                    #   #00020044' TO DFHEIV0
 21598     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21599     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21600     MOVE X'2020233030303230303434' TO DFHEIV0(25:11)
 21601     CALL 'kxdfhei1' USING DFHEIV0,
 21602           CERT-ID,
 21603           DFHEIV99
 21604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21605
 21606
 21607 9300-ABEND.
 21608     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21609
 21610
 21611* EXEC CICS LINK
 21612*        PROGRAM   ('EL004')
 21613*        COMMAREA  (WS-ERROR-LINE)
 21614*        LENGTH    (72)
 21615*    END-EXEC.
 21616     MOVE 'EL004' TO DFHEIV1
 21617     MOVE 72
 21618       TO DFHEIV11
 21619*    MOVE '."C                   (   #00020051' TO DFHEIV0
 21620     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21621     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21622     MOVE X'2020233030303230303531' TO DFHEIV0(25:11)
 21623     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 400
* EL050.cbl
 21624           DFHEIV1,
 21625           WS-ERROR-LINE,
 21626           DFHEIV11,
 21627           DFHEIV99,
 21628           DFHEIV99,
 21629           DFHEIV99,
 21630           DFHEIV99
 21631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21632
 21633
 21634     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21635
 21636
 21637* EXEC CICS ABEND
 21638*        ABCODE ('EL50')
 21639*    END-EXEC.
 21640     MOVE 'EL50' TO DFHEIV5
 21641*    MOVE '.,A                   "   #00020059' TO DFHEIV0
 21642     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21643     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21644     MOVE X'2020233030303230303539' TO DFHEIV0(25:11)
 21645     CALL 'kxdfhei1' USING DFHEIV0,
 21646           DFHEIV5
 21647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21648
 21649
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 401
* EL050.cbl
 21651
 21652******************************************************************
 21653*                                                                *
 21654*            E R R O R   F O R M A T   R O U T I N E             *
 21655*                                                                *
 21656******************************************************************
 21657
 21658 9900-ERROR-FORMAT.
 21659
 21660     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21661                    PB-COMMON-ERROR (2) OR
 21662                    PB-COMMON-ERROR (3) OR
 21663                    PB-COMMON-ERROR (4) OR
 21664                    PB-COMMON-ERROR (5) OR
 21665                    PB-COMMON-ERROR (6) OR
 21666                    PB-COMMON-ERROR (7) OR
 21667                    PB-COMMON-ERROR (8) OR
 21668                    PB-COMMON-ERROR (9) OR
 21669                    PB-COMMON-ERROR (10)
 21670        GO TO 9900-EXIT.
 21671
 21672     IF PB-NO-OF-ERRORS = +10
 21673        GO TO 9900-EXIT.
 21674
 21675     ADD +1  TO PB-NO-OF-ERRORS.
 21676     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21677                                       (PB-NO-OF-ERRORS).
 21678 9900-EXIT.
 21679     EXIT.
 21680
 21681 9990-RETURN.
 21682     IF BROWSE-STARTED
 21683
 21684* EXEC CICS ENDBR
 21685*            DATASET  (ACCT-ID)
 21686*       END-EXEC.
 21687     MOVE 0
 21688       TO DFHEIV11
 21689*    MOVE '&2                    $   #00020096' TO DFHEIV0
 21690     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21691     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21692     MOVE X'2020233030303230303936' TO DFHEIV0(25:11)
 21693     CALL 'kxdfhei1' USING DFHEIV0,
 21694           ACCT-ID,
 21695           DFHEIV11,
 21696           DFHEIV99
 21697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21698
 21699
 21700 9990-EXIT.
 21701     EXIT.
 21702
 21703
 21704****Check for CRTO record, add one if not found.
 21705 9991-CHECK-FOR-ELCRTO.
 21706
 21707* EXEC CICS HANDLE CONDITION
 21708*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 402
* EL050.cbl
 21709*         ENDFILE (9991-CRTO-NOT-FOUND)
 21710*     END-EXEC.
 21711*    MOVE '"$I''                  ! A #00020106' TO DFHEIV0
 21712     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21713     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21714     MOVE X'4120233030303230313036' TO DFHEIV0(25:11)
 21715     CALL 'kxdfhei1' USING DFHEIV0
 21716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21717
 21718     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21719     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21720     MOVE +0                     TO ELCRTO-SEQ-NO
 21721
 21722
 21723* EXEC CICS READ
 21724*       DATASET   ('ELCRTO')
 21725*       INTO      (ORIGINAL-CERTIFICATE)
 21726*       RIDFLD    (ELCRTO-KEY)
 21727*       GTEQ
 21728*       RESP      (WS-RESPONSE)
 21729*    END-EXEC
 21730     MOVE LENGTH OF
 21731      ORIGINAL-CERTIFICATE
 21732       TO DFHEIV11
 21733     MOVE 'ELCRTO' TO DFHEIV1
 21734*    MOVE '&"IL       G          (  N#00020114' TO DFHEIV0
 21735     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21737     MOVE X'204E233030303230313134' TO DFHEIV0(25:11)
 21738     CALL 'kxdfhei1' USING DFHEIV0,
 21739           DFHEIV1,
 21740           ORIGINAL-CERTIFICATE,
 21741           DFHEIV11,
 21742           ELCRTO-KEY,
 21743           DFHEIV99,
 21744           DFHEIV99,
 21745           DFHEIV99
 21746     MOVE EIBRESP  TO WS-RESPONSE
 21747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21748
 21749     IF WS-RESP-NORMAL
 21750        AND (OC-CONTROL-PRIMARY (1:33) =
 21751                 PB-CONTROL-BY-ACCOUNT (1:33))
 21752        AND (OC-RECORD-TYPE =  'I')
 21753           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21754               GO TO 9991-CHECK-INDICATORS
 21755           ELSE
 21756               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21757               GO TO 9991-CRTO-ADD-REC
 21758           END-IF
 21759     END-IF.
 21760
 21761 9991-CRTO-NOT-FOUND.
 21762
 21763     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21764     MOVE 'OC'                TO OC-RECORD-ID
 21765     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21766                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 403
* EL050.cbl
 21767     MOVE +4096               TO OC-KEY-SEQ-NO.
 21768
 21769 9991-CRTO-ADD-REC.
 21770
 21771     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21772     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21773     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21774     MOVE 'I'                 TO OC-RECORD-TYPE
 21775     IF PB-ISSUE
 21776         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21777         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21778         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21779         MOVE PB-I-AGE               TO OC-INS-AGE
 21780         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21781         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21782         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21783         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21784         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21785         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21786         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21787         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21788         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21789         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21790         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21791         IF PB-I-JOINT-COMMISSION > +0
 21792             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21793         ELSE
 21794             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21795         END-IF
 21796         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21797         MOVE +0                     TO OC-LF-CANCEL-AMT
 21798                                        OC-LF-ITD-CANCEL-AMT
 21799         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21800         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21801         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21802         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21803         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21804         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21805         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21806         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21807         MOVE +0                     TO OC-AH-CANCEL-AMT
 21808                                        OC-AH-ITD-CANCEL-AMT
 21809         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21810         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21811         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21812     ELSE
 21813         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21814         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21815         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21816         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21817         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21818         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21819         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21820         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21821         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21822          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21823             MOVE SPACES             TO OC-LF-BENCD
 21824             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 404
* EL050.cbl
 21825                                        OC-LF-BEN-AMT
 21826                                        OC-LF-PRM-AMT
 21827                                        OC-LF-ALT-BEN-AMT
 21828                                        OC-LF-ALT-PRM-AMT
 21829                                        OC-LF-COMM-PCT
 21830                                        OC-LF-CANCEL-AMT
 21831             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21832             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21833         ELSE
 21834             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21835             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21836             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21837             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21838             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21839             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21840             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21841             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21842             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21843             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21844         END-IF
 21845         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21846         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21847          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21848             MOVE SPACES             TO OC-AH-BENCD
 21849             MOVE ZEROS              TO OC-AH-TERM
 21850                                        OC-AH-BEN-AMT
 21851                                        OC-AH-PRM-AMT
 21852                                        OC-AH-COMM-PCT
 21853                                        OC-AH-CANCEL-AMT
 21854                                        OC-AH-CP
 21855             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21856             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21857         ELSE
 21858             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21859             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21860             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21861             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21862             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21863             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21864             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21865             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21866             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21867         END-IF
 21868         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21869         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21870         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21871         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21872     END-IF
 21873     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21874
 21875     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21876
 21877
 21878* EXEC CICS READ
 21879*         DATASET   (FILE-ERMAIL)
 21880*         RIDFLD    (MA-CONTROL-PRIMARY)
 21881*         INTO      (MAILING-DATA)
 21882*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 405
* EL050.cbl
 21883*    END-EXEC
 21884     MOVE LENGTH OF
 21885      MAILING-DATA
 21886       TO DFHEIV11
 21887*    MOVE '&"IL       E          (  N#00020250' TO DFHEIV0
 21888     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21889     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21890     MOVE X'204E233030303230323530' TO DFHEIV0(25:11)
 21891     CALL 'kxdfhei1' USING DFHEIV0,
 21892           FILE-ERMAIL,
 21893           MAILING-DATA,
 21894           DFHEIV11,
 21895           MA-CONTROL-PRIMARY,
 21896           DFHEIV99,
 21897           DFHEIV99,
 21898           DFHEIV99
 21899     MOVE EIBRESP  TO WS-RESPONSE
 21900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21901
 21902     IF WS-RESP-NORMAL
 21903         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21904     END-IF.
 21905
 21906     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21907     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21908
 21909
 21910* EXEC CICS READ
 21911*         DATASET  (CRTT-ID)
 21912*         RIDFLD   (WS-ELCRTT-KEY)
 21913*         INTO     (CERTIFICATE-TRAILERS)
 21914*         RESP     (WS-RESPONSE)
 21915*    END-EXEC
 21916     MOVE LENGTH OF
 21917      CERTIFICATE-TRAILERS
 21918       TO DFHEIV11
 21919*    MOVE '&"IL       E          (  N#00020264' TO DFHEIV0
 21920     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21921     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21922     MOVE X'204E233030303230323634' TO DFHEIV0(25:11)
 21923     CALL 'kxdfhei1' USING DFHEIV0,
 21924           CRTT-ID,
 21925           CERTIFICATE-TRAILERS,
 21926           DFHEIV11,
 21927           WS-ELCRTT-KEY,
 21928           DFHEIV99,
 21929           DFHEIV99,
 21930           DFHEIV99
 21931     MOVE EIBRESP  TO WS-RESPONSE
 21932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21933
 21934     IF WS-RESP-NORMAL
 21935         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21936         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21937     END-IF.
 21938
 21939
 21940* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 406
* EL050.cbl
 21941*       DATASET   ('ELCRTO')
 21942*       FROM      (ORIGINAL-CERTIFICATE)
 21943*       RIDFLD    (OC-CONTROL-PRIMARY)
 21944*       RESP      (WS-RESPONSE)
 21945*    END-EXEC.
 21946     MOVE LENGTH OF
 21947      ORIGINAL-CERTIFICATE
 21948       TO DFHEIV11
 21949     MOVE 'ELCRTO' TO DFHEIV1
 21950*    MOVE '&$ L                  ''  N#00020276' TO DFHEIV0
 21951     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21952     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21953     MOVE X'204E233030303230323736' TO DFHEIV0(25:11)
 21954     CALL 'kxdfhei1' USING DFHEIV0,
 21955           DFHEIV1,
 21956           ORIGINAL-CERTIFICATE,
 21957           DFHEIV11,
 21958           OC-CONTROL-PRIMARY,
 21959           DFHEIV99,
 21960           DFHEIV99
 21961     MOVE EIBRESP  TO WS-RESPONSE
 21962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21963
 21964
 21965     GO TO 9991-EXIT.
 21966
 21967 9991-CHECK-INDICATORS.
 21968
 21969     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21970         GO TO 9991-EXIT
 21971     END-IF.
 21972
 21973     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21974         GO TO 9991-EXIT
 21975     END-IF.
 21976
 21977
 21978* EXEC CICS READ
 21979*       DATASET   ('ELCRTO')
 21980*       INTO      (ORIGINAL-CERTIFICATE)
 21981*       RIDFLD    (OC-CONTROL-PRIMARY)
 21982*       UPDATE
 21983*       RESP      (WS-RESPONSE)
 21984*    END-EXEC
 21985     MOVE LENGTH OF
 21986      ORIGINAL-CERTIFICATE
 21987       TO DFHEIV11
 21988     MOVE 'ELCRTO' TO DFHEIV1
 21989*    MOVE '&"IL       EU         (  N#00020295' TO DFHEIV0
 21990     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21991     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21992     MOVE X'204E233030303230323935' TO DFHEIV0(25:11)
 21993     CALL 'kxdfhei1' USING DFHEIV0,
 21994           DFHEIV1,
 21995           ORIGINAL-CERTIFICATE,
 21996           DFHEIV11,
 21997           OC-CONTROL-PRIMARY,
 21998           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 407
* EL050.cbl
 21999           DFHEIV99,
 22000           DFHEIV99
 22001     MOVE EIBRESP  TO WS-RESPONSE
 22002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22003     IF WS-RESP-NORMAL
 22004        IF PB-ISSUE
 22005          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22006          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22007          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22008          MOVE PB-I-AGE               TO OC-INS-AGE
 22009          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22010          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22011          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22012          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22013          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22014          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22015          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22016          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22017          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22018          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22019          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22020          IF PB-I-JOINT-COMMISSION > +0
 22021              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22022          ELSE
 22023              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22024          END-IF
 22025          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22026          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22027          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22028          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22029          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22030          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22031          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22032          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22033          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22034
 22035          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22036
 22037* EXEC CICS READ
 22038*             DATASET   (FILE-ERMAIL)
 22039*             RIDFLD    (MA-CONTROL-PRIMARY)
 22040*             INTO      (MAILING-DATA)
 22041*             RESP      (WS-RESPONSE)
 22042*         END-EXEC
 22043     MOVE LENGTH OF
 22044      MAILING-DATA
 22045       TO DFHEIV11
 22046*    MOVE '&"IL       E          (  N#00020335' TO DFHEIV0
 22047     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22048     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22049     MOVE X'204E233030303230333335' TO DFHEIV0(25:11)
 22050     CALL 'kxdfhei1' USING DFHEIV0,
 22051           FILE-ERMAIL,
 22052           MAILING-DATA,
 22053           DFHEIV11,
 22054           MA-CONTROL-PRIMARY,
 22055           DFHEIV99,
 22056           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 408
* EL050.cbl
 22057           DFHEIV99
 22058     MOVE EIBRESP  TO WS-RESPONSE
 22059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22060          IF WS-RESP-NORMAL
 22061             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22062          END-IF
 22063
 22064          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22065          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22066
 22067* EXEC CICS READ
 22068*             DATASET  (CRTT-ID)
 22069*             RIDFLD   (WS-ELCRTT-KEY)
 22070*             INTO     (CERTIFICATE-TRAILERS)
 22071*             RESP     (WS-RESPONSE)
 22072*         END-EXEC
 22073     MOVE LENGTH OF
 22074      CERTIFICATE-TRAILERS
 22075       TO DFHEIV11
 22076*    MOVE '&"IL       E          (  N#00020347' TO DFHEIV0
 22077     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22078     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22079     MOVE X'204E233030303230333437' TO DFHEIV0(25:11)
 22080     CALL 'kxdfhei1' USING DFHEIV0,
 22081           CRTT-ID,
 22082           CERTIFICATE-TRAILERS,
 22083           DFHEIV11,
 22084           WS-ELCRTT-KEY,
 22085           DFHEIV99,
 22086           DFHEIV99,
 22087           DFHEIV99
 22088     MOVE EIBRESP  TO WS-RESPONSE
 22089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22090          IF WS-RESP-NORMAL
 22091             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22092                               OC-INS-AGE-DEFAULT-FLAG
 22093             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22094                               OC-JNT-AGE-DEFAULT-FLAG
 22095          END-IF
 22096
 22097        ELSE
 22098          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22099             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22100             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22101             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22102          END-IF
 22103          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22104             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22105             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22106             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22107          END-IF
 22108          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22109        END-IF
 22110
 22111* EXEC CICS REWRITE
 22112*          DATASET   ('ELCRTO')
 22113*          FROM      (ORIGINAL-CERTIFICATE)
 22114*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 409
* EL050.cbl
 22115*       END-EXEC
 22116     MOVE LENGTH OF
 22117      ORIGINAL-CERTIFICATE
 22118       TO DFHEIV11
 22119     MOVE 'ELCRTO' TO DFHEIV1
 22120*    MOVE '&& L                  %  N#00020373' TO DFHEIV0
 22121     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22122     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22123     MOVE X'204E233030303230333733' TO DFHEIV0(25:11)
 22124     CALL 'kxdfhei1' USING DFHEIV0,
 22125           DFHEIV1,
 22126           ORIGINAL-CERTIFICATE,
 22127           DFHEIV11,
 22128           DFHEIV99
 22129     MOVE EIBRESP  TO WS-RESPONSE
 22130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22131     END-IF.
 22132
 22133 9991-EXIT.
 22134     EXIT.
 22135
 22136
 22137 9999-RETURN.
 22138     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22139
 22140
 22141* EXEC CICS RETURN
 22142*    END-EXEC.
 22143*    MOVE '.(                    ''   #00020387' TO DFHEIV0
 22144     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22145     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22146     MOVE X'2020233030303230333837' TO DFHEIV0(25:11)
 22147     CALL 'kxdfhei1' USING DFHEIV0,
 22148           DFHEIV99,
 22149           DFHEIV99,
 22150           DFHEIV99,
 22151           DFHEIV99,
 22152           DFHEIV99,
 22153           DFHEIV99
 22154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22155
 22156
 22157
 22158* GOBACK.
 22159     MOVE '9%                    "   ' TO DFHEIV0
 22160     MOVE 'EL050' TO DFHEIV1
 22161     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22162     GOBACK.
 22163
 22164 9999-DFHBACK SECTION.
 22165     MOVE '9%                    "   ' TO DFHEIV0
 22166     MOVE 'EL050' TO DFHEIV1
 22167     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22168     GOBACK.
 22169 9999-DFHEXIT.
 22170     IF DFHEIGDJ EQUAL 0001
 22171         NEXT SENTENCE
 22172     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 410
* EL050.cbl
 22173         GO TO 9300-ABEND,
 22174               3990-FILES-NOT-OPEN
 22175         DEPENDING ON DFHEIGDI
 22176     ELSE IF DFHEIGDJ EQUAL 3
 22177         GO TO 6610-START-BROWSE,
 22178               6630-ERRESS-PROBLEM,
 22179               6630-END-OF-FILE
 22180         DEPENDING ON DFHEIGDI
 22181     ELSE IF DFHEIGDJ EQUAL 4
 22182         GO TO 6630-END-OF-FILE,
 22183               6630-ERRESS-PROBLEM,
 22184               6630-ERRESS-PROBLEM,
 22185               6630-END-OF-FILE
 22186         DEPENDING ON DFHEIGDI
 22187     ELSE IF DFHEIGDJ EQUAL 5
 22188         GO TO 6630-END-OF-FILE,
 22189               6630-END-OF-FILE,
 22190               6630-ERRESS-PROBLEM,
 22191               6630-ERRESS-PROBLEM
 22192         DEPENDING ON DFHEIGDI
 22193     ELSE IF DFHEIGDJ EQUAL 6
 22194         GO TO 6660-START-BROWSE,
 22195               6690-ERRESC-PROBLEM,
 22196               6690-ERRESC-PROBLEM,
 22197               6690-END-OF-FILE
 22198         DEPENDING ON DFHEIGDI
 22199     ELSE IF DFHEIGDJ EQUAL 7
 22200         GO TO 6690-END-OF-FILE,
 22201               6690-ERRESC-PROBLEM,
 22202               6690-ERRESC-PROBLEM,
 22203               6690-END-OF-FILE
 22204         DEPENDING ON DFHEIGDI
 22205     ELSE IF DFHEIGDJ EQUAL 8
 22206         GO TO 6690-END-OF-FILE,
 22207               6690-ERRESC-PROBLEM,
 22208               6690-ERRESC-PROBLEM,
 22209               6690-END-OF-FILE
 22210         DEPENDING ON DFHEIGDI
 22211     ELSE IF DFHEIGDJ EQUAL 9
 22212         GO TO 7250-CONTINUE,
 22213               7250-CONTINUE
 22214         DEPENDING ON DFHEIGDI
 22215     ELSE IF DFHEIGDJ EQUAL 10
 22216         GO TO 7300-CONTINUE,
 22217               7300-CONTINUE
 22218         DEPENDING ON DFHEIGDI
 22219     ELSE IF DFHEIGDJ EQUAL 11
 22220         GO TO 8000-FREE-MAIN
 22221         DEPENDING ON DFHEIGDI
 22222     ELSE IF DFHEIGDJ EQUAL 12
 22223         GO TO 8100-NOTFND,
 22224               8100-NOTFND
 22225         DEPENDING ON DFHEIGDI
 22226     ELSE IF DFHEIGDJ EQUAL 13
 22227         GO TO 8110-NOTFND,
 22228               8110-NOTFND
 22229         DEPENDING ON DFHEIGDI
 22230     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 411
* EL050.cbl
 22231         GO TO 8130-EXIT
 22232         DEPENDING ON DFHEIGDI
 22233     ELSE IF DFHEIGDJ EQUAL 15
 22234         GO TO 8150-exit
 22235         DEPENDING ON DFHEIGDI
 22236     ELSE IF DFHEIGDJ EQUAL 16
 22237         GO TO 8180-NOTFND
 22238         DEPENDING ON DFHEIGDI
 22239     ELSE IF DFHEIGDJ EQUAL 17
 22240         GO TO 8190-NOTFND
 22241         DEPENDING ON DFHEIGDI
 22242     ELSE IF DFHEIGDJ EQUAL 18
 22243         GO TO 8195-NOTFND
 22244         DEPENDING ON DFHEIGDI
 22245     ELSE IF DFHEIGDJ EQUAL 19
 22246         GO TO 8200-NOTFND
 22247         DEPENDING ON DFHEIGDI
 22248     ELSE IF DFHEIGDJ EQUAL 20
 22249         GO TO 8300-NOTFND,
 22250               8300-ERRESS-PROBLEM,
 22251               8300-ERRESS-PROBLEM,
 22252               8300-NOTFND
 22253         DEPENDING ON DFHEIGDI
 22254     ELSE IF DFHEIGDJ EQUAL 21
 22255         GO TO 8450-FORM-NOT-FOUND,
 22256               8450-FORM-NOT-FOUND
 22257         DEPENDING ON DFHEIGDI
 22258     ELSE IF DFHEIGDJ EQUAL 22
 22259         GO TO 0199-ACCT-NOT-FOUND,
 22260               0199-ACCT-NOT-FOUND
 22261         DEPENDING ON DFHEIGDI
 22262     ELSE IF DFHEIGDJ EQUAL 23
 22263         GO TO 0199-ACCT-NOT-FOUND,
 22264               0199-ACCT-NOT-FOUND
 22265         DEPENDING ON DFHEIGDI
 22266     ELSE IF DFHEIGDJ EQUAL 24
 22267         GO TO 8582-COMP-NOT-FOUND,
 22268               8582-COMP-NOT-FOUND
 22269         DEPENDING ON DFHEIGDI
 22270     ELSE IF DFHEIGDJ EQUAL 25
 22271         GO TO 8583-AGTC-NOT-FOUND,
 22272               8583-AGTC-NOT-FOUND
 22273         DEPENDING ON DFHEIGDI
 22274     ELSE IF DFHEIGDJ EQUAL 26
 22275         GO TO 8584-BXRF-NOT-FOUND,
 22276               8584-BXRF-NOT-FOUND
 22277         DEPENDING ON DFHEIGDI
 22278     ELSE IF DFHEIGDJ EQUAL 27
 22279         GO TO 8585-PLAN-NOT-FOUND,
 22280               8585-PLAN-NOT-FOUND
 22281         DEPENDING ON DFHEIGDI
 22282     ELSE IF DFHEIGDJ EQUAL 28
 22283         GO TO 0299-CERT-NOT-FOUND
 22284         DEPENDING ON DFHEIGDI
 22285     ELSE IF DFHEIGDJ EQUAL 29
 22286         GO TO 8700-READ-CERT-MASTER
 22287         DEPENDING ON DFHEIGDI
 22288     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 26-Oct-15 14:10 Page 412
* EL050.cbl
 22289         GO TO 8720-COMP-ACCOUNTS,
 22290               8730-END-BROWSE,
 22291               8740-NOT-FOUND
 22292         DEPENDING ON DFHEIGDI
 22293     ELSE IF DFHEIGDJ EQUAL 31
 22294         GO TO 9000-NOTFND
 22295         DEPENDING ON DFHEIGDI
 22296     ELSE IF DFHEIGDJ EQUAL 32
 22297         GO TO 9100-NOTFND,
 22298               9100-NOTFND
 22299         DEPENDING ON DFHEIGDI
 22300     ELSE IF DFHEIGDJ EQUAL 33
 22301         GO TO 9991-CRTO-NOT-FOUND,
 22302               9991-CRTO-NOT-FOUND
 22303         DEPENDING ON DFHEIGDI.
 22304     MOVE '9%                    "   ' TO DFHEIV0
 22305     MOVE 'EL050' TO DFHEIV1
 22306     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22307     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40680     Code:       90146
