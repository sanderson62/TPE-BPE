* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page   1
* ELRATE.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"ELRATE.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRATE.lst" LISTPATH
*          "" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRATE.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 03/05/96 16:20:51.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.012
     9
    10*AUTHOR.     LOGIC, INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page   2
* ELRATE.cbl
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25******************************************************************
    26*  REMARKS   *                                                   *
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    28*            *    OPTION SPECIFIED, COMPUTE PREMIUM AMOUNTS      *
    29*            *    AND RATES.                                     *
    30******************************************************************
    31
    32
    33******************************************************************
    34*                                                                *
    35*              INPUT FIELDS USED                                 *
    36*                                                                *
    37******************************************************************
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM    (RATING TERM)          *
    39*  CLASS CODE       - CP-CLASS-CODE                              *
    40*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    41*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    42*  RATING BENEFIT   - CP-RATING-BENEFIT-AMT (TOT BEN ON BALLOON) *
    43*  BENEFIT TYPE     - CP-BENEFIT-TYPE                            *
    44*  STATE CODE (NUM) - CP-STATE                                   *
    45*  STATE CODE       - CP-STATE-STD-ABBV                          *
    46*  COMPANY I.D.     - CP-COMPANY-ID                              *
    47*  COMPANY CD (NUM) - CP-COMPANY-CD                              *
    48*  INSURED AGE      - CP-ISSUE-AGE                               *
    49*  RATING METHOD    - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  A.P.R.           - CP-LOAN-APR                                *
    52*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    53*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    54*  TERM OR EXT DAYS - CP-TERM-OR-EXT-DAYS                        *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page   3
* ELRATE.cbl
    60 WORKING-STORAGE SECTION.
    61 01  DFH-START PIC X(04).
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRATE  WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '***********VMOD 2.012 **********'.
    65
    66***  Y2K PROJ 7744
    67 01  WS-HOLD-RATE-EXP.
    68     05  WS-HOLD-RATE-EXP-AL PIC X(11).
    69     05  WS-HOLD-RATE-EXP-DT REDEFINES
    70         WS-HOLD-RATE-EXP-AL PIC 9(11).
    71***  Y2K PROJ 7744
    72
    73*                            COPY ELCRATWS.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCRATWS.                           *
    78*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    79*                            VMOD=2.010                          *
    80*                                                                *
    81******************************************************************
    82
    83 01  STANDARD-AREAS.
    84     12  ER-STATUS               PIC XX.
    85     12  WS-BROWSE-SW            PIC X       VALUE SPACE.
    86         88 WS-BROWSE-STARTED                VALUE 'Y'.
    87     12  WS-PREMIUM-RATE         PIC S99V9(5) COMP-3 VALUE ZERO.
    88     12  WS-FARM-TERM            PIC S9(3)    COMP-3 VALUE ZERO.
    89     12  OERATE-FILE-ID          PIC X(8)    VALUE 'OERATE'.
    90     12  ERRATE-FILE-ID          PIC X(8)    VALUE 'ERRATE'.
    91     12  ERRATE-KEY.
    92         16  RATE-COMPANY-CD     PIC X        VALUE SPACE.
    93         16  RATE-STATE-CODE.
    94             20  RATE-ST-CODE    PIC  XX      VALUE SPACES.
    95             20  RATE-ST-CLASS   PIC  XX      VALUE SPACES.
    96             20  RATE-ST-DEV     PIC  XXX     VALUE SPACES.
    97         16  RATE-L-AH-CODE.
    98             20  RATE-L-AH       PIC  X       VALUE SPACE.
    99             20  RATE-LAH-NUM    PIC  XX      VALUE ZEROS.
   100         16  RATE-LIMITS.
   101             20  RATE-HIGH-AGE   PIC  99      VALUE ZEROS.
   102             20  RATE-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   103             20  RATE-FUTURE     PIC  XX      VALUE SPACES.
   104             20  RATE-SEX        PIC  X       VALUE '9'.
   105         16  RATE-EXPIRY-DATE    PIC 9(11)    COMP-3.
   106
   107     12  SAVE-ERRATE-KEY.
   108         16  SVRT-COMPANY-CD     PIC X        VALUE SPACE.
   109         16  SVRT-STATE-CODE.
   110             20  SVRT-ST-CODE    PIC  XX      VALUE SPACES.
   111             20  SVRT-ST-CLASS   PIC  XX      VALUE SPACES.
   112             20  SVRT-ST-DEV     PIC  XXX     VALUE SPACES.
   113         16  SVRT-L-AH-CODE.
   114             20  SVRT-L-AH       PIC  X       VALUE SPACE.
   115             20  SVRT-LAH-NUM    PIC  XX      VALUE ZEROS.
   116         16  SVRT-LIMITS.
   117             20  SVRT-HIGH-AGE   PIC  99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page   4
* ELRATE.cbl
   118             20  SVRT-HIGH-AMT   PIC  9(6)    VALUE ZEROS.
   119             20  SVRT-FUTURE     PIC  XX      VALUE SPACES.
   120             20  SVRT-SEX        PIC  X       VALUE '9'.
   121         16  SVRT-EXPIRY-DATE    PIC  9(11)   COMP-3.
   122
   123     12  WS-SIN-PREM-RATE        PIC S99V9(07) VALUE +0.
   124     12  WS-TERM-MINUS-ONE       PIC S9(5)    COMP-3 VALUE +0.
   125
   126 01  CSL-WORK-AREAS          COMP-3.
   127     12  WK-C                PIC S9(3)V9(9)     VALUE ZEROS.
   128     12  WK-D                PIC S9(4)V9(9)     VALUE ZEROS.
   129     12  WK-J                PIC S999           VALUE ZEROS.
   130     12  WK-K                PIC S999           VALUE ZEROS.
   131     12  WK-L                PIC S99V9(9)       VALUE ZEROS.
   132     12  WK-S                PIC S999V9(4)      VALUE ZEROS.
   133     12  WK-T                PIC S999           VALUE ZEROS.
   134     12  WK-T1               PIC S999           VALUE ZEROS.
   135     12  WK-U                PIC S99V9(9)       VALUE ZEROS.
   136     12  WK-PREM             PIC S9(6)V999      VALUE ZEROS.
   137     12  WK-PAY-AMT          PIC S9(7)V99       VALUE ZEROS.
   138     12  WK-LEV-RATE         PIC S99V9(7)       VALUE ZEROS.
   139     12  WK-RED-RATE         PIC S99V9(7)       VALUE ZEROS.
   140     12  WK-DAILY-RATE       PIC S99V9(7)       VALUE ZEROS.
   141     12  WK-MONTHLY-RATE     PIC S99V9(7)       VALUE ZEROS.
   142     12  WK-MONTHLY-RATE-T   PIC S99V9(7)       VALUE ZEROS.
   143     12  WK-MONTHLY-RATE-J   PIC S99V9(7)       VALUE ZEROS.
   144     12  WS-MAX-TOT-BEN      PIC S9(7)V99       VALUE ZEROS.
   145     12  WS-MAX-MON-BEN      PIC S9(7)V99       VALUE ZEROS.
   146     12  WS-NUM-PAYMTS       PIC S9(5)          VALUE ZEROS.
   147     12  WS-PAY-SCH          PIC S99            VALUE ZEROS.
   148
   149 01  TEXAS-REG-WORK-AREAS.
   150     12  TEX-FACT-1          PIC S9(7)V99    COMP-3.
   151     12  TEX-FACT-2          PIC S9(3)       COMP-3.
   152     12  TEX-FACT-3          PIC S9(3)       COMP-3.
   153     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   154     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   155     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   156     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   157     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   158     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   159
   160 01  NET-PAY-INTERFACE.
   161     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   162     12  N-P-ORIG            PIC S9(3)       COMP-3.
   163     12  N-P-REM             PIC S9(3)       COMP-3.
   164     12  N-P-OPT             PIC X.
   165     12  N-P-LOAN            PIC S9(3)       COMP-3.
   166     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   167
   168
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page   5
* ELRATE.cbl
   170*                            COPY ERCNETWS.
   171*****************************************************************
   172*                                                               *
   173*                                                               *
   174*                            ERCNETWS                           *
   175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   176*                            VMOD=2.014                         *
   177*                                                               *
   178*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS *
   179*                                                               *
   180*****************************************************************.
   181*                   C H A N G E   L O G
   182*
   183* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   184*-----------------------------------------------------------------
   185*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   186* EFFECTIVE    NUMBER
   187*-----------------------------------------------------------------
   188* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   189* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   190* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   191* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   192******************************************************************
   193
   194 01  NET-PAY-WORK-AREA.
   195     12  OPTION-SW               PIC X   VALUE 'X'.
   196        88  NPO-STD         VALUE SPACE.
   197        88  NPO-ALT         VALUE 'A'.
   198        88  NPO-SIMPLE      VALUE 'S'.
   199        88  NPO-2MO         VALUE 'I'.
   200        88  NPO-3MO         VALUE 'J'.
   201        88  NPO-4MO         VALUE 'K'.
   202        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.
   203        88  NPO-TRUNC-0     VALUE 'T'.
   204        88  NPO-TRUNC-1     VALUE 'U'.
   205        88  NPO-TRUNC-2     VALUE 'V'.
   206        88  NPO-TRUNC-3     VALUE 'W'.
   207        88  NPO-TRUNC-4     VALUE 'X'.
   208        88  NPO-REFUND      VALUE 'R'.
   209        88  NPO-PRUDENTIAL  VALUE 'P'.
   210
   211     12  TYPE-SW             PIC X   VALUE 'N'.
   212        88  NET-STD             VALUE 'N'.
   213        88  NET-SMP             VALUE 'S'.
   214
   215     12  NP-PROCESS-SW       PIC X   VALUE '1'.
   216        88  NP-RATING           VALUE '1'.
   217        88  NP-REFUND           VALUE '2'.
   218        88  NP-REMAIN-AMT       VALUE '3'.
   219
   220     12  COMP-3-WORK-AREA         COMP-3.
   221         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.
   222         16  V               PIC SV9(13)       VALUE +.0.
   223         16  J               PIC SV9(9)        VALUE +0.
   224         16  K               PIC SV9(9)        VALUE +0.
   225         16  I               PIC SV9(10)       VALUE +.0.
   226         16  D               PIC S9(5)         VALUE +.0.
   227         16  APR100          PIC SV9(9)        VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page   6
* ELRATE.cbl
   228         16  RA              PIC S9(6)V9(9)    VALUE +.0.
   229         16  WK1             PIC S9(4)V9(13)   VALUE +.0.
   230         16  WK2             PIC S9(4)V9(13)   VALUE +.0.
   231         16  WK3             PIC S9(7)V9(10)   VALUE +.0.
   232         16  WK4             PIC S9(7)V9(8)    VALUE +.0.
   233         16  WK5             PIC S9(5)V9(13)   VALUE +.0.
   234         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.
   235         16  WK6             PIC S9(7)V9(10)   VALUE +.0.
   236         16  WK7             PIC S9(7)V9(10)   VALUE +.0.
   237         16  WK8             PIC S9(3)V9(10)   VALUE +.0.
   238         16  WK9             PIC S9(3)V9(10)   VALUE +.0.
   239         16  GR              PIC S9(7)V9(10)   VALUE +.0.
   240         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.
   241         16  ODF             PIC S9(3)V9(10)   VALUE +.0.
   242         16  OD              PIC S9(3)V9(10)   VALUE +.0.
   243         16  FM              PIC S9(3)V9(10)   VALUE +.0.
   244         16  FN              PIC S9(3)V9(10)   VALUE +.0.
   245         16  FNM             PIC S9(3)V9(10)   VALUE +.0.
   246         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.
   247         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.
   248         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.
   249         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.
   250         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.
   251         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.
   252         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.
   253         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.
   254         16  K1              PIC S999          VALUE +1.
   255         16  K12             PIC S999          VALUE +12.
   256         16  K100            PIC S999          VALUE +100.
   257         16  K1000           PIC S9(7)         VALUE +1000.
   258         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.
   259         16  Y REDEFINES NC-LR
   260                             PIC S99V9(5).
   261         16  TI              PIC S999V9(5)     VALUE +0.
   262         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.
   263         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.
   264         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.
   265         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.
   266         16  NC-BIG-D        PIC S9(3)         VALUE +030.
   267         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.
   268         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.
   269         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.
   270
   271         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.
   272         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.
   273         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.
   274         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.
   275         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.
   276         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.
   277         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.
   278         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.
   279         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.
   280         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.
   281         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.
   282         16  GTL-IA-SGN      PIC S9            VALUE +.0.
   283         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.
   284
   285         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page   7
* ELRATE.cbl
   286
   287         16  ORIGINAL-TERM   PIC S999.
   288         16  M              REDEFINES ORIGINAL-TERM
   289                             PIC S999.
   290
   291         16  REMAINING-TERM  PIC S999.
   292         16  R              REDEFINES REMAINING-TERM
   293                             PIC S999.
   294
   295         16  LOAN-TERM       PIC S999.
   296         16  N              REDEFINES LOAN-TERM
   297                             PIC S999.
   298
   299         16  EXPIRED-TERM    PIC S999.
   300         16  E              REDEFINES EXPIRED-TERM
   301                             PIC S999.
   302
   303         16  PRUDENTIAL-WORK-AMT
   304                             PIC S9(7)V9(8).
   305         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT
   306                             PIC S9(7)V9(8).
   307
   308         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.
   309         16  VX              PIC S9V9(13)      VALUE +0.0.
   310         16  SV              PIC S9V9(13)      VALUE +0.0.
   311         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.
   312         16  SX              PIC S9V9(13)      VALUE +0.0.
   313         16  SE              PIC S9V9(10)      VALUE +0.0.
   314         16  N2              PIC S9(7)         VALUE +0.
   315         16  N3              PIC S9(7)         VALUE +0.
   316         16  K-I             PIC S9V9(8)       VALUE +0.0.
   317
   318     12  BINARY-WORK-AREA        COMP.
   319         16  X1              PIC S999        VALUE +0.
   320         16  X2              PIC S999        VALUE +0.
   321         16  MAX-X           PIC S9(5)       VALUE +0.
   322         16  B1              PIC S9(5)       VALUE +1.
   323         16  LINDX           PIC S999        VALUE ZEROS.
   324         16  AHNDX           PIC S999        VALUE ZEROS.
   325
   326     12  CSO-RATE-WORK-AREAS.
   327         16  C-PMTS-PER-YEAR     PIC S999 COMP-3 VALUE ZEROS.
   328         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   329         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   330     12  WS-WORK-MISC.
   331         16  NET-BEN             PIC S9(9)V9999   COMP-3.
   332         16  WS-RATE-TERM        PIC S9(3)        COMP-3.
   333*        16  WS-AGE              PIC 99           VALUE ZEROS.
   334         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   335         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.
   336         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.
   337         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.
   338         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.
   339         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.
   340         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.
   341         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   342         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0.
   343         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page   8
* ELRATE.cbl
   344         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0.
   345         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0.
   346******************************************************************
   347
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page   9
* ELRATE.cbl
   349*                            COPY ELCDATE.
   350******************************************************************
   351*                                                                *
   352*                                                                *
   353*                            ELCDATE.                            *
   354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   355*                            VMOD=2.003
   356*                                                                *
   357*                                                                *
   358*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   359*                 LENGTH = 200                                   *
   360******************************************************************
   361
   362 01  DATE-CONVERSION-DATA.
   363     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   364     12  DC-OPTION-CODE                PIC X.
   365         88  BIN-TO-GREG                VALUE ' '.
   366         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   367         88  EDIT-GREG-TO-BIN           VALUE '2'.
   368         88  YMD-GREG-TO-BIN            VALUE '3'.
   369         88  MDY-GREG-TO-BIN            VALUE '4'.
   370         88  JULIAN-TO-BIN              VALUE '5'.
   371         88  BIN-PLUS-ELAPSED           VALUE '6'.
   372         88  FIND-CENTURY               VALUE '7'.
   373         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   374         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   375         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   376         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   377         88  JULIAN-TO-BIN-3            VALUE 'C'.
   378         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   379         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   380         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   381         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   382         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   383         88  CHECK-LEAP-YEAR            VALUE 'H'.
   384         88  BIN-3-TO-GREG              VALUE 'I'.
   385         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   386         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   387         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   388         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   389         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   390         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   391         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   392         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   393         88  THREE-CHARACTER-BIN
   394                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   395         88  GREGORIAN-TO-BIN
   396                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   397         88  BIN-TO-GREGORIAN
   398                  VALUES ' ' '1' 'I' '8' 'G'.
   399         88  JULIAN-TO-BINARY
   400                  VALUES '5' 'C' 'E' 'F'.
   401     12  DC-ERROR-CODE                 PIC X.
   402         88  NO-CONVERSION-ERROR        VALUE ' '.
   403         88  DATE-CONVERSION-ERROR
   404                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   405         88  DATE-IS-ZERO               VALUE '1'.
   406         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  10
* ELRATE.cbl
   407         88  DATE-IS-INVALID            VALUE '3'.
   408         88  DATE1-GREATER-DATE2        VALUE '4'.
   409         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   410         88  DATE-INVALID-OPTION        VALUE '9'.
   411         88  INVALID-CENTURY            VALUE 'A'.
   412         88  ONLY-CENTURY               VALUE 'B'.
   413         88  ONLY-LEAP-YEAR             VALUE 'C'.
   414         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   415     12  DC-END-OF-MONTH               PIC X.
   416         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   417     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   418         88  USE-NORMAL-PROCESS         VALUE ' '.
   419         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   420         88  ADJUST-UP-100-YRS          VALUE '2'.
   421     12  FILLER                        PIC X.
   422     12  DC-CONVERSION-DATES.
   423         16  DC-BIN-DATE-1             PIC XX.
   424         16  DC-BIN-DATE-2             PIC XX.
   425         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   426         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   427                       DC-GREG-DATE-1-EDIT.
   428             20  DC-EDIT1-MONTH        PIC 99.
   429             20  SLASH1-1              PIC X.
   430             20  DC-EDIT1-DAY          PIC 99.
   431             20  SLASH1-2              PIC X.
   432             20  DC-EDIT1-YEAR         PIC 99.
   433         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   434         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   435                     DC-GREG-DATE-2-EDIT.
   436             20  DC-EDIT2-MONTH        PIC 99.
   437             20  SLASH2-1              PIC X.
   438             20  DC-EDIT2-DAY          PIC 99.
   439             20  SLASH2-2              PIC X.
   440             20  DC-EDIT2-YEAR         PIC 99.
   441         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   442         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   443                     DC-GREG-DATE-1-YMD.
   444             20  DC-YMD-YEAR           PIC 99.
   445             20  DC-YMD-MONTH          PIC 99.
   446             20  DC-YMD-DAY            PIC 99.
   447         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   448         16  DC-GREG-DATE-1-MDY-R REDEFINES
   449                      DC-GREG-DATE-1-MDY.
   450             20  DC-MDY-MONTH          PIC 99.
   451             20  DC-MDY-DAY            PIC 99.
   452             20  DC-MDY-YEAR           PIC 99.
   453         16  DC-GREG-DATE-1-ALPHA.
   454             20  DC-ALPHA-MONTH        PIC X(10).
   455             20  DC-ALPHA-DAY          PIC 99.
   456             20  FILLER                PIC XX.
   457             20  DC-ALPHA-CENTURY.
   458                 24 DC-ALPHA-CEN-N     PIC 99.
   459             20  DC-ALPHA-YEAR         PIC 99.
   460         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   461         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   462         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   463         16  DC-JULIAN-DATE            PIC 9(05).
   464         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  11
* ELRATE.cbl
   465                                       PIC 9(05).
   466         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   467             20  DC-JULIAN-YEAR        PIC 99.
   468             20  DC-JULIAN-DAYS        PIC 999.
   469         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   470         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   471         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   472     12  DATE-CONVERSION-VARIBLES.
   473         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   474         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   475             20  FILLER                PIC 9(3).
   476             20  HOLD-CEN-1-CCYY.
   477                 24  HOLD-CEN-1-CC     PIC 99.
   478                 24  HOLD-CEN-1-YY     PIC 99.
   479             20  HOLD-CEN-1-MO         PIC 99.
   480             20  HOLD-CEN-1-DA         PIC 99.
   481         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   482             20  HOLD-CEN-1-R-MO       PIC 99.
   483             20  HOLD-CEN-1-R-DA       PIC 99.
   484             20  HOLD-CEN-1-R-CCYY.
   485                 24  HOLD-CEN-1-R-CC   PIC 99.
   486                 24  HOLD-CEN-1-R-YY   PIC 99.
   487             20  FILLER                PIC 9(3).
   488         16  HOLD-CENTURY-1-X.
   489             20  FILLER                PIC X(3)  VALUE SPACES.
   490             20  HOLD-CEN-1-X-CCYY.
   491                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   492                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   493             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   494             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   495         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   496             20  HOLD-CEN-1-R-X-MO     PIC XX.
   497             20  HOLD-CEN-1-R-X-DA     PIC XX.
   498             20  HOLD-CEN-1-R-X-CCYY.
   499                 24  HOLD-CEN-1-R-X-CC PIC XX.
   500                 24  HOLD-CEN-1-R-X-YY PIC XX.
   501             20  FILLER                PIC XXX.
   502         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   503         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   504         16  DC-JULIAN-DATE-1          PIC 9(07).
   505         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   506             20  DC-JULIAN-1-CCYY.
   507                 24  DC-JULIAN-1-CC    PIC 99.
   508                 24  DC-JULIAN-1-YR    PIC 99.
   509             20  DC-JULIAN-DA-1        PIC 999.
   510         16  DC-JULIAN-DATE-2          PIC 9(07).
   511         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   512             20  DC-JULIAN-2-CCYY.
   513                 24  DC-JULIAN-2-CC    PIC 99.
   514                 24  DC-JULIAN-2-YR    PIC 99.
   515             20  DC-JULIAN-DA-2        PIC 999.
   516         16  DC-GREG-DATE-A-EDIT.
   517             20  DC-EDITA-MONTH        PIC 99.
   518             20  SLASHA-1              PIC X VALUE '/'.
   519             20  DC-EDITA-DAY          PIC 99.
   520             20  SLASHA-2              PIC X VALUE '/'.
   521             20  DC-EDITA-CCYY.
   522                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  12
* ELRATE.cbl
   523                 24  DC-EDITA-YEAR     PIC 99.
   524         16  DC-GREG-DATE-B-EDIT.
   525             20  DC-EDITB-MONTH        PIC 99.
   526             20  SLASHB-1              PIC X VALUE '/'.
   527             20  DC-EDITB-DAY          PIC 99.
   528             20  SLASHB-2              PIC X VALUE '/'.
   529             20  DC-EDITB-CCYY.
   530                 24  DC-EDITB-CENT     PIC 99.
   531                 24  DC-EDITB-YEAR     PIC 99.
   532         16  DC-GREG-DATE-CYMD         PIC 9(08).
   533         16  DC-GREG-DATE-CYMD-R REDEFINES
   534                              DC-GREG-DATE-CYMD.
   535             20  DC-CYMD-CEN           PIC 99.
   536             20  DC-CYMD-YEAR          PIC 99.
   537             20  DC-CYMD-MONTH         PIC 99.
   538             20  DC-CYMD-DAY           PIC 99.
   539         16  DC-GREG-DATE-MDCY         PIC 9(08).
   540         16  DC-GREG-DATE-MDCY-R REDEFINES
   541                              DC-GREG-DATE-MDCY.
   542             20  DC-MDCY-MONTH         PIC 99.
   543             20  DC-MDCY-DAY           PIC 99.
   544             20  DC-MDCY-CEN           PIC 99.
   545             20  DC-MDCY-YEAR          PIC 99.
   546    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   547        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   548    12  DC-EL310-DATE                  PIC X(21).
   549    12  FILLER                         PIC X(28).
   550
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  13
* ELRATE.cbl
   552*                            COPY ELCCALC.
   553******************************************************************
   554*                                                                *
   555*                           ELCCALC.                            *
   556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   557*                            VMOD=2.025                          *
   558*                                                                *
   559*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   560*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   561*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   562*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   563*                                                                *
   564*  PASSED TO ELRTRM                                              *
   565*  -----------------                                             *
   566*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   567*  ORIGINAL TERM                                                 *
   568*  BEGINNING DATE                                                *
   569*  ENDING DATE                                                   *
   570*  COMPANY I.D.                                                  *
   571*  ACCOUNT MASTER USER FIELD                                     *
   572*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   573*  FREE LOOK DAYS                                                *
   574*                                                                *
   575*  RETURNED FROM ELRTRM                                          *
   576*  ---------------------                                         *
   577*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   578*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   579*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   580*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   581*----------------------------------------------------------------*
   582*  PASSED TO ELRAMT                                              *
   583*  ----------------                                              *
   584*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   585*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   586*  ORIGINAL AMOUNT                                               *
   587*  ALTERNATE BENEFIT (BALLON)                                    *
   588*  A.P.R. - NET PAY ONLY                                         *
   589*  METHOD
   590*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   591*  COMPANY I.D.                                                  *
   592*  BENEFIT TYPE                                                  *
   593*                                                                *
   594*  RETURNED FROM ELRAMT                                          *
   595*  --------------------                                          *
   596*  REMAINING AMOUNT 1 - CURRENT                                  *
   597*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   598*  REMAINING AMOUNT FACTOR
   599*----------------------------------------------------------------*
   600*  PASSED TO ELRESV                                              *
   601*  -----------------                                             *
   602*  CERTIFICATE EFFECTIVE DATE                                    *
   603*  VALUATION DATE                                                *
   604*  PAID THRU DATE                                                *
   605*  BENEFIT                                                       *
   606*  INCURRED DATE                                                 *
   607*  REPORTED DATE                                                 *
   608*  ISSUE AGE                                                     *
   609*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  14
* ELRATE.cbl
   610*  CDT PERCENT                                                   *
   611*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   612* *CLAIM TYPE (LIFE, A/H)                                        *
   613* *REMAINING BENEFIT (FROM ELRAMT)                               *
   614* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
   615*                                                                *
   616*  RETURNED FROM ELRESV                                          *
   617*  --------------------                                          *
   618*  CDT TABLE USED                                                *
   619*  CDT FACTOR USED                                               *
   620*  PAY TO CURRENT RESERVE                                        *
   621*  I.B.N.R. - A/H ONLY                                           *
   622*  FUTURE (ACCRUED) AH ONLY                                      *
   623*----------------------------------------------------------------*
   624*  PASSED TO ELRATE                                              *
   625*  ----------------                                              *
   626*  CERT ISSUE DATE                                               *
   627*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   628*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   629*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
   630*  STATE CODE (CLIENT DEFINED)                                   *
   631*  STATE CODE (STANDARD P.O. ABBRV)                              *
   632*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   633*  DEVIATION CODE                                                *
   634*  ISSUE AGE                                                     *
   635*  ORIGINAL BENEFIT AMOUNT                                       *
   636*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   637*  PROCESS TYPE (ISSUE OR CANCEL)                                *
   638*  BENEFIT KIND (LIFE OR A/H)                                    *
   639*  A.P.R.                                                        *
   640*  METHOD
   641*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   642*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   643*  COMPANY I.D. (3 CHARACTER)                                    *
   644*  BENEFIT CODE                                                  *
   645*  BENEFIT OVERRIDE CODE                                         *
   646*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
   647*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
   648*  JOINT INDICATOR (CSL ONLY)                                    *
   649*  FIRST PAYMENT DATE (CSL ONLY)                                 *
   650*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
   651*                                                                *
   652*  RETURNED FROM ELRATE                                          *
   653*  --------------------                                          *
   654*  CALCULATED PREMIUM                                            *
   655*  PREMIUM RATE                                                  *
   656*  MORTALITY CODE                                                *
   657*  MAX ATTAINED AGE                                              *
   658*  MAX AGE                                                       *
   659*  MAX TERM                                                      *
   660*  MAX MONTHLY BENEFIT                                           *
   661*  MAX TOTAL BENIFIT                                             *
   662*  COMPOSITE RATE (OPEN-END ONLY)                                *
   663*----------------------------------------------------------------*
   664*  PASSED TO ELRFND                                              *
   665*  ----------------                                              *
   666*  CERT ISSUE DATE                                               *
   667*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  15
* ELRATE.cbl
   668*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   669*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   670*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
   671*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   672*  STATE CODE (CLIENT DEFINED)                                   *
   673*  STATE CODE (STANDARD P.O. ABBRV)                              *
   674*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   675*  DEVIATION CODE                                                *
   676*  ISSUE AGE                                                     *
   677*  ORIGINAL BENEFIT AMOUNT                                       *
   678*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
   679*  PROCESS TYPE (CANCEL)                                         *
   680*  BENEFIT KIND (LIFE OR A/H)                                    *
   681*  A.P.R.                                                        *
   682*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
   683*  RATING METHOD -  (CODE FROM BENEFIT)                          *
   684*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   685*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   686*  COMPANY I.D. (3 CHARACTER)                                    *
   687*  BENEFIT CODE                                                  *
   688*  BENEFIT OVERRIDE CODE                                         *
   689*                                                                *
   690*  RETURNED FROM ELRFND                                          *
   691*  --------------------                                          *
   692*  CALCULATED REFUND                                             *
   693*----------------------------------------------------------------*
   694*  PASSED TO ELEARN                                              *
   695*  ----------------                                              *
   696*  CERT ISSUE DATE                                               *
   697*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   698*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
   699*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
   700*  STATE CODE (CLIENT DEFINED)                                   *
   701*  STATE CODE (STANDARD P.O. ABBRV)                              *
   702*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
   703*  DEVIATION CODE                                                *
   704*  ISSUE AGE                                                     *
   705*  ORIGINAL BENEFIT AMOUNT                                       *
   706*  BENEFIT KIND (LIFE OR A/H)                                    *
   707*  A.P.R.                                                        *
   708*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
   709*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
   710*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
   711*  COMPANY I.D. (3 CHARACTER)                                    *
   712*  BENEFIT CODE                                                  *
   713*  BENEFIT OVERRIDE CODE                                         *
   714*                                                                *
   715*  RETURNED FROM ELEARN                                          *
   716*  --------------------                                          *
   717*  INDICATED  EARNINGS                                           *
   718*----------------------------------------------------------------*
   719*                 LENGTH = 450                                   *
   720*                                                                *
   721******************************************************************
   722******************************************************************
   723*                   C H A N G E   L O G
   724*
   725* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  16
* ELRATE.cbl
   726*-----------------------------------------------------------------
   727*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   728* EFFECTIVE    NUMBER
   729*-----------------------------------------------------------------
   730* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   731* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   732* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   733* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   734* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   735* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   736* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   737* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   738* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   739******************************************************************
   740
   741 01  CALCULATION-PASS-AREA.
   742     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
   743                                     COMP.
   744
   745     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
   746       88  NO-CP-ERROR                             VALUE ZERO.
   747       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
   748                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
   749       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
   750       88  CP-ERROR-IN-DATES                       VALUE '2'.
   751       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
   752       88  CP-ERROR-IN-TERMS                       VALUE '4'.
   753       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
   754       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
   755       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
   756       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
   757       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
   758       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
   759       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
   760       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
   761       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
   762       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
   763       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
   764       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
   765       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
   766
   767     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
   768       88  NO-CP-ERROR-2                           VALUE ZERO.
   769***********************  INPUT AREAS ****************************
   770
   771     12  CP-CALCULATION-AREA.
   772         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
   773         16  CP-CERT-EFF-DT        PIC XX.
   774         16  CP-VALUATION-DT       PIC XX.
   775         16  CP-PAID-THRU-DT       PIC XX.
   776         16  CP-BENEFIT-TYPE       PIC X.
   777           88  CP-AH                               VALUE 'A' 'D'
   778                                                   'I' 'U'.
   779           88  CP-REDUCING-LIFE                    VALUE 'R'.
   780           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
   781         16  CP-INCURRED-DT        PIC XX.
   782         16  CP-REPORTED-DT        PIC XX.
   783         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  17
* ELRATE.cbl
   784         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
   785         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
   786                                     COMP-3.
   787         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
   788                                     COMP-3.
   789         16  CP-CDT-METHOD         PIC X.
   790           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
   791           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
   792           88  CP-CDT-INTERPOLATED                 VALUE '3'.
   793         16  CP-CLAIM-TYPE         PIC X.
   794           88  CP-AH-CLAIM                         VALUE 'A'.
   795           88  CP-LIFE-CLAIM                       VALUE 'L'.
   796         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
   797                                     COMP-3.
   798         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
   799                                     COMP-3.
   800         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
   801                                     COMP-3.
   802         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
   803                                     COMP-3.
   804         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
   805                                     COMP-3.
   806         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
   807                                     COMP-3.
   808         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
   809                                     COMP-3.
   810         16  CP-REM-TERM-METHOD    PIC X.
   811           88  CP-EARN-AFTER-15TH                  VALUE '1'.
   812           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
   813           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
   814           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
   815           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
   816           88  CP-EARN-AFTER-14TH                  VALUE '6'.
   817           88  CP-EARN-AFTER-16TH                  VALUE '7'.
   818         16  CP-EARNING-METHOD     PIC X.
   819           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
   820           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
   821           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
   822           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
   823           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
   824           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
   825           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
   826           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
   827           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
   828           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
   829           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   830           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   831           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   832           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   833         16  CP-PROCESS-TYPE       PIC X.
   834           88  CP-CLAIM                            VALUE '1'.
   835           88  CP-CANCEL                           VALUE '2'.
   836           88  CP-ISSUE                            VALUE '3'.
   837         16  CP-SPECIAL-CALC-CD    PIC X.
   838           88  CP-OUTSTANDING-BAL              VALUE 'O'.
   839           88  CP-1-MTH-INTEREST               VALUE ' '.
   840           88  CP-0-MTH-INTEREST               VALUE 'A'.
   841           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  18
* ELRATE.cbl
   842           88  CP-CRITICAL-PERIOD              VALUE 'C'.
   843           88  CP-TERM-IS-DAYS                 VALUE 'D'.
   844           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
   845           88  CP-FARM-PLAN                    VALUE 'F'.
   846           88  CP-RATE-AS-STANDARD             VALUE 'G'.
   847           88  CP-2-MTH-INTEREST               VALUE 'I'.
   848           88  CP-3-MTH-INTEREST               VALUE 'J'.
   849           88  CP-4-MTH-INTEREST               VALUE 'K'.
   850           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
   851           88  CP-MORTGAGE-REC                 VALUE 'M'.
   852           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
   853           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
   854           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
   855           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
   856                                                     'W' 'X'.
   857           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
   858           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
   859           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
   860           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
   861           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
   862           88  CP-SUMMARY-REC                  VALUE 'Z'.
   863           88  CP-PROPERTY-BENEFIT             VALUE '2'.
   864           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
   865           88  CP-AD-D-BENEFIT                 VALUE '4'.
   866           88  CP-CSL-METH-1                   VALUE '5'.
   867           88  CP-CSL-METH-2                   VALUE '6'.
   868           88  CP-CSL-METH-3                   VALUE '7'.
   869           88  CP-CSL-METH-4                   VALUE '8'.
   870
   871         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
   872                                     COMP-3.
   873         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
   874         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
   875         16  CP-STATE              PIC XX          VALUE SPACE.
   876         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
   877         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
   878           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
   879               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
   880         16  CP-R78-OPTION         PIC X.
   881           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
   882           88  CP-TERM-TIMES-TERM                  VALUE '1'.
   883
   884         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
   885         16  CP-IBNR-RESERVE-SW    PIC X.
   886         16  CP-CLAIM-STATUS       PIC X.
   887         16  CP-RATE-FILE          PIC X.
   888         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
   889                                     COMP-3.
   890
   891         16  CP-LIFE-OVERRIDE-CODE PIC X.
   892         16  CP-AH-OVERRIDE-CODE   PIC X.
   893
   894         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
   895                                     COMP-3.
   896         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   897                                   PIC S9(5)V99 COMP-3.
   898         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
   899                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  19
* ELRATE.cbl
   900         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
   901                                     COMP-3.
   902         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
   903                                     COMP-3.
   904         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   905                                  PIC S9(7)V99 COMP-3.
   906
   907         16  CP-PAID-FROM-DATE     PIC X(02).
   908         16  CP-CLAIM-CALC-METHOD  PIC X(01).
   909         16  CP-EXT-DAYS-CALC      PIC X.
   910           88  CP-EXT-NO-CHG                   VALUE ' '.
   911           88  CP-EXT-CHG-LF                   VALUE '1'.
   912           88  CP-EXT-CHG-AH                   VALUE '2'.
   913           88  CP-EXT-CHG-LF-AH                VALUE '3'.
   914         16  CP-DOMICILE-STATE     PIC XX.
   915         16  CP-CARRIER            PIC X.
   916         16  CP-REIN-FLAG          PIC X.
   917         16  CP-REM-TRM-CALC-OPTION PIC X.
   918           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
   919                      '2' '3' '4' '5'.
   920           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
   921           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
   922           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
   923           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
   924           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
   925           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
   926           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
   927           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   928         16  CP-SIG-SWITCH         PIC X.
   929         16  CP-RATING-METHOD      PIC X.
   930           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
   931           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
   932           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
   933           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
   934           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
   935           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
   936           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
   937           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
   938           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
   939         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
   940                                     COMP-3.
   941         16  CP-BEN-CATEGORY       PIC X.
   942         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   943         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   944                                   PIC S99V9(5) COMP-3.
   945         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   946         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   947                                   PIC S99V9(5) COMP-3.
   948         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   949         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   950         16  CP-EXPIRE-DT          PIC XX.
   951         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   952         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   953         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   954         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   955         16  CP-DDF-SPEC-CALC      PIC X.
   956             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   957             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  20
* ELRATE.cbl
   958         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   959         16  CP-CANCEL-REASON      PIC X.
   960         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   961         16  CP-PMT-MODE           PIC X.
   962         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   963         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   964         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   965         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   966         16  FILLER                PIC X.
   967
   968***************    OUTPUT FROM ELRESV   ************************
   969
   970         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
   971
   972         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
   973                                     COMP-3.
   974         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
   975                                     COMP-3.
   976         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
   977                                     COMP-3.
   978         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
   979                                     COMP-3.
   980         16  FILLER                PIC X(09).
   981***************    OUTPUT FROM ELRTRM   *************************
   982
   983         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
   984                                     COMP-3.
   985         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
   986                                     COMP-3.
   987         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
   988                                     COMP-3.
   989         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
   990                                     COMP-3.
   991         16  FILLER                PIC X(12).
   992
   993***************    OUTPUT FROM ELRAMT   *************************
   994
   995         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
   996                                     COMP-3.
   997         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
   998                                     COMP-3.
   999         16  FILLER                PIC X(12).
  1000
  1001***************    OUTPUT FROM ELRATE   *************************
  1002
  1003         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1004                                     COMP-3.
  1005         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1006                                     COMP-3.
  1007         16  CP-MORTALITY-CODE     PIC X(4).
  1008         16  CP-RATE-EDIT-FLAG     PIC X.
  1009             88  CP-RATES-NEED-APR                  VALUE '1'.
  1010         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1011                                     COMP-3.
  1012         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1013         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1014         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1015                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  21
* ELRATE.cbl
  1016         16  FILLER                PIC X(07).
  1017
  1018***************    OUTPUT FROM ELRFND   *************************
  1019
  1020         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1021                                     COMP-3.
  1022         16  CP-REFUND-TYPE-USED   PIC X.
  1023           88  CP-R-AS-R78                         VALUE '1'.
  1024           88  CP-R-AS-PRORATA                     VALUE '2'.
  1025           88  CP-R-AS-CALIF                       VALUE '3'.
  1026           88  CP-R-AS-TEXAS                       VALUE '4'.
  1027           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1028           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1029           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1030           88  CP-R-AS-MEAN                        VALUE '8'.
  1031           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1032           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1033           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1034           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1035           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1036           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1037         16  FILLER                PIC X(12).
  1038
  1039***************    OUTPUT FROM ELEARN   *************************
  1040
  1041         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1042                                     COMP-3.
  1043         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1044                                     COMP-3.
  1045         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1046                                     COMP-3.
  1047         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1048                                     COMP-3.
  1049         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1050                                     COMP-3.
  1051         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1052                                     COMP-3.
  1053         16  CP-EARNING-TYPE-USED  PIC X.
  1054           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1055           88  CP-E-AS-R78                         VALUE '1'.
  1056           88  CP-E-AS-PRORATA                     VALUE '2'.
  1057           88  CP-E-AS-TEXAS                       VALUE '4'.
  1058           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1059           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1060           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1061           88  CP-E-AS-MEAN                        VALUE '8'.
  1062           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1063         16  FILLER                PIC X(12).
  1064
  1065***************    OUTPUT FROM ELPMNT   *************************
  1066
  1067         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1068                                     COMP-3.
  1069         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1070                                     COMP-3.
  1071         16  FILLER                PIC X(12).
  1072
  1073***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  22
* ELRATE.cbl
  1074         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1075                                     COMP-3.
  1076         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1077                                     COMP-3.
  1078         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1079                                     COMP-3.
  1080         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1081                                     COMP-3.
  1082         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1083                                     COMP-3.
  1084         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1085                                     COMP-3.
  1086         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1087             88  OPEN-RATE-FILE                   VALUE 'O'.
  1088             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1089             88  IO-ERROR                         VALUE 'E'.
  1090
  1091         16  CP-FIRST-PAY-DATE     PIC XX.
  1092
  1093         16  CP-JOINT-INDICATOR    PIC X.
  1094
  1095         16  CP-RESERVE-REMAINING-TERM
  1096                                   PIC S9(4)V9    VALUE ZERO
  1097                                     COMP-3.
  1098
  1099         16  CP-INSURED-BIRTH-DT   PIC XX.
  1100
  1101         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1102                                     COMP-3.
  1103
  1104         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1105                                     COMP-3.
  1106
  1107         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1108                                     COMP-3.
  1109
  1110         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1111                                     COMP-3.
  1112
  1113         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1114                                     COMP-3.
  1115
  1116         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1117                                     COMP-3.
  1118
  1119         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1120                                     COMP-3.
  1121
  1122         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1123             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1124
  1125         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1126                                     COMP-3.
  1127         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1128                                     COMP-3.
  1129         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1130         16  FILLER                PIC X(15).
  1131******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  23
* ELRATE.cbl
  1132
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  24
* ELRATE.cbl
  1134****************************************************************
  1135*
  1136* Copyright (c) 2007 by Clerity Solutions, Inc.
  1137* All rights reserved.
  1138*
  1139****************************************************************
  1140 01  DFHEIV.
  1141   02  DFHEIV0               PIC X(35).
  1142   02  DFHEIV1               PIC X(08).
  1143   02  DFHEIV2               PIC X(08).
  1144   02  DFHEIV3               PIC X(08).
  1145   02  DFHEIV4               PIC X(06).
  1146   02  DFHEIV5               PIC X(04).
  1147   02  DFHEIV6               PIC X(04).
  1148   02  DFHEIV7               PIC X(02).
  1149   02  DFHEIV8               PIC X(02).
  1150   02  DFHEIV9               PIC X(01).
  1151   02  DFHEIV10              PIC S9(7) COMP-3.
  1152   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1153   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1154   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1155   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1156   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1157   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1158   02  DFHEIV17              PIC X(04).
  1159   02  DFHEIV18              PIC X(04).
  1160   02  DFHEIV19              PIC X(04).
  1161   02  DFHEIV20              USAGE IS POINTER.
  1162   02  DFHEIV21              USAGE IS POINTER.
  1163   02  DFHEIV22              USAGE IS POINTER.
  1164   02  DFHEIV23              USAGE IS POINTER.
  1165   02  DFHEIV24              USAGE IS POINTER.
  1166   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1167   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1168   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1169   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1170   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1171   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1172   02  FILLER                PIC X(02).
  1173   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1174   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1175   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1176   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1177   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1178 LINKAGE  SECTION.
  1179*****************************************************************
  1180*                                                               *
  1181* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1182* All rights reserved.                                          *
  1183*                                                               *
  1184*****************************************************************
  1185 01  dfheiblk.
  1186     02  eibtime          pic s9(7) comp-3.
  1187     02  eibdate          pic s9(7) comp-3.
  1188     02  eibtrnid         pic x(4).
  1189     02  eibtaskn         pic s9(7) comp-3.
  1190     02  eibtrmid         pic x(4).
  1191     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  25
* ELRATE.cbl
  1192     02  eibcposn         pic s9(4) comp.
  1193     02  eibcalen         pic s9(4) comp.
  1194     02  eibaid           pic x(1).
  1195     02  eibfiller1       pic x(1).
  1196     02  eibfn            pic x(2).
  1197     02  eibfiller2       pic x(2).
  1198     02  eibrcode         pic x(6).
  1199     02  eibfiller3       pic x(2).
  1200     02  eibds            pic x(8).
  1201     02  eibreqid         pic x(8).
  1202     02  eibrsrce         pic x(8).
  1203     02  eibsync          pic x(1).
  1204     02  eibfree          pic x(1).
  1205     02  eibrecv          pic x(1).
  1206     02  eibsend          pic x(1).
  1207     02  eibatt           pic x(1).
  1208     02  eibeoc           pic x(1).
  1209     02  eibfmh           pic x(1).
  1210     02  eibcompl         pic x(1).
  1211     02  eibsig           pic x(1).
  1212     02  eibconf          pic x(1).
  1213     02  eiberr           pic x(1).
  1214     02  eibrldbk         pic x(1).
  1215     02  eiberrcd         pic x(4).
  1216     02  eibsynrb         pic x(1).
  1217     02  eibnodat         pic x(1).
  1218     02  eibfiller5       pic x(2).
  1219     02  eibresp          pic 9(09) comp.
  1220     02  eibresp2         pic 9(09) comp.
  1221     02  dfheigdj         pic s9(4) comp.
  1222     02  dfheigdk         pic s9(4) comp.
  1223 01  DFHCOMMAREA             PIC X(450).
  1224
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  26
* ELRATE.cbl
  1226*01 PARMLIST              COMP.
  1227*    02  FILLER              PIC S9(8).
  1228*    02  ERRATE-POINTER      PIC S9(8).
  1229
  1230*                                COPY ERCRATE.
  1231******************************************************************
  1232*                                                                *
  1233*                                                                *
  1234*                            ERCRATE                             *
  1235*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1236*                            VMOD=2.008                          *
  1237*                                                                *
  1238*   ONLINE CREDIT SYSTEM                                         *
  1239*                                                                *
  1240*   FILE DESCRIPTION = RATES MASTER FILE                         *
  1241*                                                                *
  1242*   FILE TYPE = VSAM,KSDS                                        *
  1243*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  1244*                                                                *
  1245*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  1246*       ALTERNATE PATH = NONE                                    *
  1247*                                                                *
  1248*   LOG = NO                                                     *
  1249*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1250*                                                                *
  1251******************************************************************
  1252
  1253 01  RATE-RECORD.
  1254     12  RT-RECORD-ID                      PIC XX.
  1255         88  VALID-RT-ID                      VALUE 'RT'.
  1256
  1257     12  RT-CONTROL-PRIMARY.
  1258         16  RT-COMPANY-CD                 PIC X.
  1259         16  RT-STATE-CODE.
  1260             20  RT-ST-CODE                PIC XX.
  1261             20  RT-ST-CLASS               PIC XX.
  1262             20  RT-ST-DEV                 PIC XXX.
  1263         16  RT-L-AH-CODE.
  1264             20  RT-L-AH                   PIC X.
  1265             20  RT-LAH-NUM                PIC XX.
  1266         16  RT-LIMITS.
  1267             20  RT-HIGH-AGE               PIC 99.
  1268             20  RT-HIGH-AMT               PIC 9(6).
  1269             20  RT-FUTURE                 PIC XX.
  1270             20  RT-SEX                    PIC X.
  1271         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  1272
  1273     12  RT-MAINT-INFORMATION.
  1274         16  RT-LAST-MAINT-DT              PIC XX.
  1275         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1276         16  RT-LAST-MAINT-USER            PIC X(4).
  1277         16  FILLER                        PIC X(10).
  1278
  1279     12  RT-STRUCTURE-COMMENT              PIC X(50).
  1280     12  RT-RATE-COMMENT                   PIC X(50).
  1281
  1282     12  CSL-RESERVED                      PIC X(10).
  1283     12  FILLER                            PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  27
* ELRATE.cbl
  1284
  1285     12  RT-MAX-AGE                        PIC 99.
  1286
  1287     12  RT-LIFE-LIMS-FLDS.
  1288         16  RT-LIFE-MORT-CODE             PIC X(4).
  1289         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  1290             20  RT-L-EX-AGE               PIC 99.
  1291             20  RT-L-EX-TERM              PIC S999       COMP-3.
  1292             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  1293         16  FILLER                        PIC X(20).
  1294
  1295     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  1296         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  1297             20  RT-AH-AGE                 PIC 99.
  1298             20  RT-AH-TERM                PIC S999       COMP-3.
  1299             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  1300             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  1301
  1302     12  RT-LIFE-RATES.
  1303         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  1304
  1305     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  1306         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  1307
  1308     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  1309
  1310     12  RT-DISCOUNT-OPTION                PIC X.
  1311         88  RT-DO-NOT-USE                     VALUE ' '.
  1312         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  1313         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  1314
  1315     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  1316     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  1317
  1318     12  RT-COMPOSITE-OPTION               PIC X.
  1319         88  RT-NO-COMPOSITE                   VALUE ' '.
  1320         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  1321
  1322     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  1323
  1324     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.
  1325     12  FILLER                            PIC X(13).
  1326
  1327     12  RT-TYPE-RATE                      PIC X.
  1328         88  RT-IS-STND                        VALUE ' ' 'S'.
  1329         88  RT-IS-OB                          VALUE 'O'.
  1330
  1331     12  RT-SRT-ALPHA                      PIC X.
  1332
  1333     12  RT-CONTROL-2.
  1334         16  RTC-1                         PIC X(7).
  1335         16  RTC-3                         PIC X(11).
  1336         16  RTC-4                         PIC 9(11) COMP-3.
  1337         16  RTC-2                         PIC X(3).
  1338******************************************************************
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  28
* ELRATE.cbl
  1340 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA RATE-RECORD.
  1341 0000-DFHEXIT SECTION.
  1342     MOVE '9#                    $   ' TO DFHEIV0.
  1343     MOVE 'ELRATE' TO DFHEIV1.
  1344     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1345
  1346     MOVE DFHCOMMAREA            TO  CALCULATION-PASS-AREA.
  1347
  1348 000-START-PREMIUM-CALC.
  1349     MOVE ZERO                   TO CP-RETURN-CODE
  1350                                    CP-CALC-PREMIUM
  1351                                    CP-PREMIUM-RATE
  1352                                    CP-POLICY-FEE.
  1353
  1354     MOVE SPACES                 TO CP-MORTALITY-CODE.
  1355     MOVE ALL '9'                TO ERRATE-KEY.
  1356
  1357*    IF CP-RATE-FILE = 'O'
  1358*        MOVE OERATE-FILE-ID     TO ERRATE-FILE-ID.
  1359
  1360     MOVE CP-COMPANY-CD          TO RATE-COMPANY-CD.
  1361     MOVE CP-STATE               TO RATE-ST-CODE.
  1362     MOVE CP-CLASS-CODE          TO RATE-ST-CLASS.
  1363     MOVE CP-DEVIATION-CODE      TO RATE-ST-DEV.
  1364     MOVE CP-ISSUE-AGE           TO RATE-HIGH-AGE.
  1365
  1366     IF CP-RATING-BENEFIT-AMT NOT NUMERIC  OR
  1367        CP-RATING-BENEFIT-AMT = ZEROS
  1368         MOVE CP-ORIGINAL-BENEFIT    TO RATE-HIGH-AMT
  1369     ELSE
  1370         MOVE CP-RATING-BENEFIT-AMT  TO RATE-HIGH-AMT.
  1371
  1372     IF CP-AH
  1373         MOVE CP-AH-OVERRIDE-CODE     TO RATE-L-AH
  1374     ELSE
  1375         MOVE CP-LIFE-OVERRIDE-CODE   TO RATE-L-AH.
  1376
  1377     MOVE CP-BENEFIT-CD          TO RATE-LAH-NUM.
  1378     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1379     MOVE SPACE                  TO DC-OPTION-CODE.
  1380
  1381     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1382
  1383*** Y2K, PROJ 7744
  1384     IF NO-CONVERSION-ERROR
  1385         MOVE ZEROS                 TO RATE-EXPIRY-DATE
  1386                                       WS-HOLD-RATE-EXP-DT
  1387         MOVE DC-GREG-DATE-CYMD     TO WS-HOLD-RATE-EXP-AL(4:8)
  1388         MOVE WS-HOLD-RATE-EXP-DT   TO RATE-EXPIRY-DATE
  1389         MOVE ERRATE-KEY            TO SAVE-ERRATE-KEY
  1390     ELSE
  1391         MOVE '2'                   TO CP-RETURN-CODE
  1392         GO TO 9999-CALC-RATE-PREM-X
  1393     END-IF.
  1394*** Y2K, PROJ 7744
  1395
  1396
  1397* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  29
* ELRATE.cbl
  1398*        NOTFND   (9999-RATE-NOTFND)
  1399*        NOTOPEN  (9999-RATE-NOTOPEN)
  1400*        ENDFILE  (9999-RATE-NOTFND)
  1401*    END-EXEC.
  1402*    MOVE '"$IJ''                 ! " #00001392' TO DFHEIV0
  1403     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  1404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1405     MOVE X'2220233030303031333932' TO DFHEIV0(25:11)
  1406     CALL 'kxdfhei1' USING DFHEIV0
  1407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1408
  1409
  1410 0050-RATE-START-BROWSE.
  1411
  1412* EXEC CICS STARTBR
  1413*        DATASET  (ERRATE-FILE-ID)
  1414*        RIDFLD   (ERRATE-KEY)
  1415*        GTEQ
  1416*    END-EXEC.
  1417     MOVE 0
  1418       TO DFHEIV11
  1419*    MOVE '&,         G          &   #00001399' TO DFHEIV0
  1420     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1422     MOVE X'2020233030303031333939' TO DFHEIV0(25:11)
  1423     CALL 'kxdfhei1' USING DFHEIV0,
  1424           ERRATE-FILE-ID,
  1425           ERRATE-KEY,
  1426           DFHEIV99,
  1427           DFHEIV11,
  1428           DFHEIV99
  1429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1430
  1431
  1432     MOVE 'Y'                  TO WS-BROWSE-SW.
  1433
  1434 0100-READ-RATE-LOOP.
  1435
  1436* EXEC CICS READNEXT
  1437*        DATASET  (ERRATE-FILE-ID)
  1438*        SET      (ADDRESS OF RATE-RECORD)
  1439*        RIDFLD   (ERRATE-KEY)
  1440*    END-EXEC.
  1441     MOVE 0
  1442       TO DFHEIV11
  1443*    MOVE '&.S                   )   #00001408' TO DFHEIV0
  1444     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1445     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1446     MOVE X'2020233030303031343038' TO DFHEIV0(25:11)
  1447     CALL 'kxdfhei1' USING DFHEIV0,
  1448           ERRATE-FILE-ID,
  1449           DFHEIV20,
  1450           DFHEIV99,
  1451           ERRATE-KEY,
  1452           DFHEIV99,
  1453           DFHEIV11,
  1454           DFHEIV99,
  1455           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  30
* ELRATE.cbl
  1456     SET ADDRESS OF RATE-RECORD TO
  1457         DFHEIV20
  1458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1459
  1460
  1461 0110-CHECK-KEYS.
  1462*                            COPY ELCRATPD.
  1463******************************************************************
  1464*                                                                *
  1465*                                                                *
  1466*                            ELCRATPD                            *
  1467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1468*                            VMOD=2.061                          *
  1469*                                                                *
  1470******************************************************************
  1471******************************************************************
  1472*                   C H A N G E   L O G
  1473*
  1474* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1475*-----------------------------------------------------------------
  1476*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1477* EFFECTIVE    NUMBER
  1478*-----------------------------------------------------------------
  1479* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  1480* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  1481* 032603                   PEMA  ADD SPECIAL AZ CALC
  1482* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  1483* 120403                   PEMA  ADD SPECIAL TX CALC
  1484* 092205                   PEMA  FIX CRIT PER FOR DCC
  1485* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  1486* 021207                   PEMA  ADD PA NP
  1487* 022107                   PEMA  ADD NH NP AND NP TRUNC
  1488* 032807                   PEMA  ADD VT NP PLUS 2
  1489* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  1490* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  1491* 060909    2008042300002  PEMA  ADD NEW FARM PLAN CALC
  1492* 010410    2008021200005  PEMA  ADD MN NET PAY BALLOON
  1493* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1494* 040610  CR2010010400006  PEMA  ADD IN TO VT CODE
  1495* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1496* 071211    2010012700001  PEMA  ADD SPPDD
  1497* 071511    2011021500001  PEMA  ADD CODE FOR DCC 10C
  1498* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  1499* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1500******************************************************************
  1501
  1502 0110-CHECK-KEY.
  1503     IF SVRT-COMPANY-CD = RT-COMPANY-CD  AND
  1504        SVRT-ST-CODE    = RT-ST-CODE     AND
  1505        SVRT-ST-CLASS   = RT-ST-CLASS    AND
  1506        SVRT-ST-DEV     = RT-ST-DEV      AND
  1507        SVRT-L-AH       = RT-L-AH        AND
  1508        SVRT-LAH-NUM    = RT-LAH-NUM
  1509         NEXT SENTENCE
  1510     ELSE
  1511         GO TO 9999-RATE-NOTFND.
  1512
  1513     IF  SVRT-HIGH-AGE GREATER RT-HIGH-AGE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  31
* ELRATE.cbl
  1514         GO TO 9999-RATE-NOTFND.
  1515
  1516     IF SVRT-HIGH-AMT NOT LESS THAN RT-HIGH-AMT
  1517        GO TO 0100-READ-RATE-LOOP.
  1518
  1519     IF SVRT-EXPIRY-DATE GREATER RT-EXPIRY-DATE
  1520         GO TO 0100-READ-RATE-LOOP.
  1521
  1522     IF SVRT-EXPIRY-DATE = RT-EXPIRY-DATE
  1523         GO TO 0100-READ-RATE-LOOP.
  1524
  1525     IF RT-MAX-AGE = ZEROS
  1526         NEXT SENTENCE
  1527     ELSE
  1528         COMPUTE WS-AGE =
  1529             (CP-ISSUE-AGE + (CP-ORIGINAL-TERM / 12))
  1530         IF WS-AGE >= RT-MAX-AGE
  1531             MOVE 'B'               TO CP-RETURN-CODE.
  1532
  1533     IF CP-LOAN-TERM NOT NUMERIC
  1534         MOVE +0                    TO CP-LOAN-TERM.
  1535
  1536     IF CP-LOAN-TERM = ZERO
  1537         MOVE CP-ORIGINAL-TERM      TO CP-LOAN-TERM.
  1538
  1539     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1540         MOVE +0                    TO CP-TERM-OR-EXT-DAYS.
  1541
  1542     MOVE CP-R-MAX-MON-BEN          TO WS-MAX-MON-BEN.
  1543     MOVE CP-R-MAX-TOT-BEN          TO WS-MAX-TOT-BEN.
  1544
  1545     IF CP-AH
  1546         GO TO 2000-TYPE-IS-AH.
  1547
  1548     IF ((RT-IS-OB)
  1549        AND (CP-COMPANY-ID NOT EQUAL 'CID'))
  1550                      OR
  1551        ((CP-COMPANY-ID = 'DCC')
  1552        AND (CP-BENEFIT-CD (1:1) = 'P'))
  1553        MOVE CP-LOAN-TERM        TO WS-RATE-TERM
  1554     ELSE
  1555        MOVE CP-ORIGINAL-TERM TO WS-RATE-TERM
  1556     END-IF
  1557
  1558     MOVE CP-CERT-EFF-DT            TO DC-BIN-DATE-1.
  1559     MOVE SPACE                     TO DC-OPTION-CODE.
  1560
  1561     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1562
  1563 1000-TYPE-IS-LIFE.
  1564     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  1565
  1566     MOVE ZERO                      TO CP-R-MAX-AGE
  1567                                       CP-R-MAX-TERM
  1568                                       CP-R-MAX-MON-BEN
  1569                                       CP-R-MAX-TOT-BEN.
  1570
  1571     MOVE RT-LIFE-MORT-CODE         TO CP-MORTALITY-CODE.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  32
* ELRATE.cbl
  1572
  1573     IF RT-POLICY-FEE NUMERIC
  1574        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  1575
  1576     MOVE RT-DISCOUNT-OPTION     TO WS-DISCOUNT-OPTION.
  1577
  1578     IF (RT-DISCOUNT-OPTION EQUAL
  1579                     '1' OR '2' OR '3' OR '4' OR '5') AND
  1580        (RT-DISCOUNT-OB-RATE NUMERIC)         AND
  1581        (RT-DISCOUNT-OB-RATE GREATER THAN +0)
  1582         NEXT SENTENCE
  1583     ELSE
  1584         IF (RT-DISCOUNT-OPTION EQUAL '6') AND
  1585            (CP-STATE-STD-ABBRV EQUAL 'CA')
  1586             IF RT-DISCOUNT-RATE GREATER THAN ZERO
  1587                 COMPUTE CA-DISCOUNT = RT-DISCOUNT-RATE / 100
  1588                 GO TO 1050-REGULAR-RATES
  1589             ELSE
  1590                 GO TO 1050-REGULAR-RATES
  1591         ELSE
  1592             GO TO 1050-REGULAR-RATES.
  1593
  1594*    display ' discount option ' rt-discount-option
  1595     IF RT-DISCOUNT-RATE NOT NUMERIC
  1596        MOVE +0                  TO RT-DISCOUNT-RATE.
  1597
  1598     IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1599        NEXT SENTENCE
  1600     ELSE
  1601        MOVE +0                  TO CP-PREMIUM-RATE
  1602                                    CP-COMPOSITE-RATE
  1603                                    CP-CALC-PREMIUM
  1604         MOVE '4'                TO CP-RETURN-CODE
  1605         GO TO 9999-CALC-RATE-PREM-X.
  1606
  1607     IF RT-DISCOUNT-OPTION = '1' OR '3' OR '5'
  1608        MOVE RT-DISCOUNT-RATE TO WS-WORK-DIS-RATE
  1609     ELSE
  1610        MOVE CP-LOAN-APR TO WS-WORK-DIS-RATE.
  1611
  1612*    IF RT-DISCOUNT-OPTION EQUAL '4'
  1613*       MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1614*       GO TO 1075-BYPASS-REGULAR-RATE.
  1615
  1616     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  1617        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1618        COMPUTE WS-WORK-DIS-RATE EQUAL
  1619                WS-WORK-DIS-RATE / +100
  1620        GO TO 1075-BYPASS-REGULAR-RATE.
  1621
  1622     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  1623        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  1624        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1625        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1626        GO TO 1075-BYPASS-REGULAR-RATE.
  1627
  1628     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1629        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  33
* ELRATE.cbl
  1630        (CP-TRUNCATED-LIFE)
  1631        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1632        GO TO 1075-BYPASS-REGULAR-RATE.
  1633
  1634     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1635        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  1636        (CP-EARN-AS-NET-PAY)
  1637*       (CP-TRUNCATED-LIFE)
  1638        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1639        GO TO 1075-BYPASS-REGULAR-RATE.
  1640
  1641     IF ((CP-COMPANY-ID EQUAL 'GTL') AND
  1642        (CP-STATE-STD-ABBRV EQUAL 'RI'))
  1643                   AND
  1644        ((CP-EARN-AS-NET-PAY)
  1645               OR
  1646        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  1647        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1648        GO TO 1075-BYPASS-REGULAR-RATE.
  1649
  1650     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  1651        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  1652        (CP-EARN-AS-NET-PAY) AND
  1653        (CP-SPECIAL-CALC-CD EQUAL 'H')
  1654        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1655        GO TO 1075-BYPASS-REGULAR-RATE.
  1656
  1657     IF (CP-COMPANY-ID = 'CID')
  1658        AND (CP-STATE-STD-ABBRV = 'MN')
  1659        AND (RT-DISCOUNT-OPTION = '1')
  1660        AND ((CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  1661                     OR
  1662            (CP-LEVEL-LIFE)
  1663            AND (CP-CERT-EFF-DT > X'A4FF'))
  1664        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1665        GO TO 1075-BYPASS-REGULAR-RATE
  1666     END-IF
  1667     IF (CP-COMPANY-ID EQUAL 'CID')
  1668        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  1669                      OR
  1670            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  1671        AND (CP-EARN-AS-NET-PAY)
  1672        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1673        GO TO 1075-BYPASS-REGULAR-RATE
  1674     END-IF
  1675     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  1676        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1677        (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  1678         MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1679         GO TO 1075-BYPASS-REGULAR-RATE.
  1680
  1681     IF CP-COMPANY-ID = 'CID'
  1682        CONTINUE
  1683     ELSE
  1684        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  1685           (CP-EARN-AS-NET-PAY ) AND
  1686           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  1687            GO TO 1075-BYPASS-REGULAR-RATE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  34
* ELRATE.cbl
  1688        END-IF
  1689     END-IF
  1690     IF (CP-COMPANY-ID = 'CID') AND
  1691        (CP-EARN-AS-NET-PAY) AND
  1692        (CP-LEVEL-LIFE) AND
  1693        (CP-STATE-STD-ABBRV = 'CA') AND
  1694        (CP-STATE-STD-ABBRV = CP-STATE)
  1695        COMPUTE WS-WORK-DIS-RATE =
  1696             RT-DISCOUNT-RATE / +100
  1697        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1698        GO TO 1075-BYPASS-REGULAR-RATE
  1699     END-IF
  1700
  1701     IF (CP-COMPANY-ID = 'CID')
  1702        AND (CP-EARN-AS-NET-PAY)
  1703        AND (CP-STATE-STD-ABBRV = 'ME')
  1704        COMPUTE WS-WORK-DIS-RATE =
  1705             RT-DISCOUNT-RATE / +100
  1706        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1707        GO TO 1075-BYPASS-REGULAR-RATE
  1708     END-IF
  1709     IF (CP-COMPANY-ID = 'CID')
  1710        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  1711           OR 'IN' OR 'AZ')
  1712        AND (CP-FARM-PLAN)
  1713        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1714        GO TO 1075-BYPASS-REGULAR-RATE
  1715     END-IF
  1716     IF (CP-COMPANY-ID = 'DCC')
  1717        AND (CP-BEN-CATEGORY = 'D')
  1718        AND (CP-EARN-AS-NET-PAY)
  1719        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1720        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  1721           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  1722*       DISPLAY ' ACT COMM ' CP-DCC-ACT-COMM
  1723*       DISPLAY ' PMF COMM ' CP-DCC-PMF-COMM
  1724*       DISPLAY ' OB RATE  ' RT-DISCOUNT-OB-RATE
  1725*       DISPLAY ' NEW RATE ' CP-PREMIUM-RATE
  1726        GO TO 1075-BYPASS-REGULAR-RATE
  1727     END-IF
  1728     IF (CP-COMPANY-ID = 'CID') AND
  1729        (CP-EARN-AS-NET-PAY) AND
  1730        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  1731                            OR 'VT')
  1732                   OR
  1733        ((CP-STATE-STD-ABBRV = 'IN') AND
  1734        (CP-CERT-EFF-DT > X'9A7F'))
  1735                   OR
  1736        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  1737        (CP-CERT-EFF-DT > X'9ADF'))) AND
  1738        (CP-STATE-STD-ABBRV = CP-STATE)
  1739        COMPUTE WS-WORK-DIS-RATE =
  1740             RT-DISCOUNT-RATE / +100
  1741        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1742        GO TO 1075-BYPASS-REGULAR-RATE
  1743     END-IF
  1744
  1745     IF (CP-COMPANY-ID = 'CID') AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  35
* ELRATE.cbl
  1746        (CP-EARN-AS-NET-PAY) AND
  1747        (CP-STATE-STD-ABBRV = 'TX') AND
  1748        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1749        (WS-DISCOUNT-OPTION NOT = ' ')
  1750        COMPUTE WS-WORK-DIS-RATE =
  1751             RT-DISCOUNT-RATE / +100
  1752        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1753        GO TO 1075-BYPASS-REGULAR-RATE
  1754     END-IF
  1755
  1756     IF (CP-COMPANY-ID = 'CID') AND
  1757        (CP-EARN-AS-NET-PAY) AND
  1758        (CP-TRUNCATED-LIFE) AND
  1759        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  1760        (CP-STATE-STD-ABBRV = CP-STATE) AND
  1761        (WS-DISCOUNT-OPTION NOT = ' ')
  1762        COMPUTE WS-WORK-DIS-RATE =
  1763             RT-DISCOUNT-RATE / +100
  1764        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1765        GO TO 1075-BYPASS-REGULAR-RATE
  1766     END-IF
  1767
  1768     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1769        IF WS-WORK-DIS-RATE NOT EQUAL +0
  1770           COMPUTE WS-WORK-DIS-RATE EQUAL
  1771                   WS-WORK-DIS-RATE / +100.
  1772
  1773     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1774        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1775           IF CP-MONTHLY-PAYMENT EQUAL +0
  1776            IF CP-LOAN-APR GREATER THAN +2
  1777              COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1778              CP-ORIGINAL-BENEFIT /
  1779               ((1 - (1 + (CP-LOAN-APR / +1200)) **
  1780               (WS-RATE-TERM * -1)) / (CP-LOAN-APR / +1200))
  1781            ELSE
  1782             COMPUTE CP-MONTHLY-PAYMENT EQUAL
  1783               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  1784
  1785     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1786        IF CP-STATE-STD-ABBRV EQUAL 'NY'
  1787          IF WS-WORK-DIS-RATE GREATER THAN +0
  1788           COMPUTE WK1 ROUNDED EQUAL
  1789           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1790                              (WS-RATE-TERM - +1)) /
  1791                        (WS-WORK-DIS-RATE / +12)
  1792           COMPUTE WK2 ROUNDED EQUAL
  1793           (1 - 1 / (1 + WS-WORK-DIS-RATE / +12) **
  1794                              (WS-RATE-TERM)) /
  1795                        (WS-WORK-DIS-RATE / +12)
  1796           COMPUTE WK3 EQUAL
  1797                RT-DISCOUNT-OB-RATE *
  1798                (1 + WS-WORK-DIS-RATE / +12)
  1799                MOVE WK3 TO CP-PREMIUM-RATE
  1800                COMPUTE WK5 EQUAL WK3 / +1000
  1801           GO TO 1075-BYPASS-REGULAR-RATE.
  1802*               (RT-DISCOUNT-OB-RATE / +1000) *
  1803*               (1 + WS-WORK-DIS-RATE / +12)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  36
* ELRATE.cbl
  1804*          GO TO 1075-BYPASS-REGULAR-RATE.
  1805
  1806     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1807        IF RT-DISCOUNT-OB-RATE GREATER THAN +0
  1808           COMPUTE WK3 EQUAL
  1809           RT-DISCOUNT-OB-RATE *
  1810           (24 / (24 + WS-WORK-DIS-RATE * WS-RATE-TERM))
  1811           MOVE WK3 TO CP-PREMIUM-RATE
  1812           COMPUTE WK5 EQUAL WK3 / +1000
  1813           GO TO 1075-BYPASS-REGULAR-RATE.
  1814
  1815     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  1816        (CP-STATE-STD-ABBRV EQUAL 'VT' OR 'MA')
  1817        MOVE RT-DISCOUNT-OB-RATE TO CP-PREMIUM-RATE
  1818        GO TO 1075-BYPASS-REGULAR-RATE.
  1819
  1820     COMPUTE WS-SIN-PREM-RATE =
  1821             (RT-DISCOUNT-OB-RATE / +1000) *
  1822             ((WS-RATE-TERM + +1) / +2).
  1823
  1824     COMPUTE CP-PREMIUM-RATE =
  1825             WS-SIN-PREM-RATE /
  1826             (+1 + (((WS-WORK-DIS-RATE / +100) *
  1827             WS-RATE-TERM) / +24)).
  1828
  1829     IF CP-PREMIUM-RATE NOT = +0
  1830        MULTIPLY +100 BY CP-PREMIUM-RATE
  1831        MOVE CP-PREMIUM-RATE TO WS-PREMIUM-RATE
  1832        GO TO 1075-BYPASS-REGULAR-RATE.
  1833
  1834 1050-REGULAR-RATES.
  1835
  1836     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  1837        COMPUTE WK5 EQUAL
  1838        ((WS-RATE-TERM * RT-L-RATE (+12)) / +100) /
  1839        (6 * (WS-RATE-TERM + 1))
  1840        MOVE WK5 TO CP-PREMIUM-RATE
  1841        GO TO 1075-BYPASS-REGULAR-RATE.
  1842
  1843     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  1844        (CP-CSL-VALID-NP-BENEFIT-CD)
  1845        IF CP-JOINT-INDICATOR EQUAL 'J'
  1846           MOVE RT-L-RATE (3) TO CP-PREMIUM-RATE
  1847           GO TO 1075-BYPASS-REGULAR-RATE
  1848        ELSE
  1849           MOVE RT-L-RATE (1) TO CP-PREMIUM-RATE
  1850           GO TO 1075-BYPASS-REGULAR-RATE.
  1851
  1852     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  1853        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  1854        (CP-EARN-AS-NET-PAY )
  1855        MOVE RT-L-RATE (12)      TO CP-PREMIUM-RATE
  1856        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  1857        MOVE CP-FIRST-PAY-DATE   TO DC-BIN-DATE-2
  1858        MOVE '1'                 TO DC-OPTION-CODE
  1859        PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  1860        IF DATE-CONVERSION-ERROR
  1861            MOVE '2'                TO CP-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  37
* ELRATE.cbl
  1862            GO TO 9999-CALC-RATE-PREM-X
  1863        ELSE
  1864            COMPUTE CP-ODD-DAYS-TO-PMT = DC-ELAPSED-MONTHS * 30 +
  1865                                         DC-ODD-DAYS-OVER
  1866            GO TO 1075-BYPASS-REGULAR-RATE.
  1867
  1868     IF RT-COMPOSITE-RATE NOT NUMERIC
  1869         MOVE ZEROS                        TO RT-COMPOSITE-RATE.
  1870
  1871*    IF CP-ORIGINAL-TERM GREATER ZERO AND LESS 361
  1872     IF WS-RATE-TERM GREATER ZERO AND LESS 361
  1873         MOVE RT-L-RATE (WS-RATE-TERM)     TO CP-PREMIUM-RATE
  1874                                              WS-PREMIUM-RATE
  1875         MOVE RT-COMPOSITE-RATE            TO CP-COMPOSITE-RATE
  1876     ELSE
  1877         MOVE +0                           TO CP-PREMIUM-RATE
  1878                                              CP-COMPOSITE-RATE
  1879                                              CP-CALC-PREMIUM
  1880         GO TO 9999-CALC-RATE-PREM-X.
  1881
  1882     IF (CP-COMPANY-ID EQUAL 'CID')
  1883        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  1884        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  1885        AND (CP-EARN-AS-NET-PAY)
  1886        GO TO 1075-BYPASS-REGULAR-RATE
  1887     END-IF
  1888******************************************************
  1889*    IF CP-COMPANY-ID NOT = 'LBL'
  1890     IF CP-COMPANY-ID NOT = 'LBL' AND 'CID'
  1891         GO TO 1075-BYPASS-REGULAR-RATE.
  1892
  1893     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1.
  1894     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2.
  1895     MOVE '1'                    TO DC-OPTION-CODE.
  1896     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1897     IF DATE-CONVERSION-ERROR
  1898         MOVE '2'                TO CP-RETURN-CODE
  1899         GO TO 9999-CALC-RATE-PREM-X
  1900       ELSE
  1901         MOVE DC-ELAPSED-MONTHS  TO CP-MNTHS-TO-FIRST-PMT
  1902         MOVE DC-ODD-DAYS-OVER   TO CP-ODD-DAYS-TO-PMT.
  1903
  1904     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN 1
  1905        COMPUTE CP-ODD-DAYS-TO-PMT EQUAL CP-ODD-DAYS-TO-PMT +
  1906        ((CP-MNTHS-TO-FIRST-PMT - 1) * +30).
  1907
  1908     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH)
  1909        IF (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1910           NEXT SENTENCE
  1911         ELSE
  1912           GO TO 1075-BYPASS-REGULAR-RATE
  1913       ELSE
  1914        IF (CP-MNTHS-TO-FIRST-PMT = ZERO) AND
  1915           (CP-ODD-DAYS-TO-PMT NOT = ZEROS)
  1916           NEXT SENTENCE
  1917         ELSE
  1918           GO TO 1075-BYPASS-REGULAR-RATE.
  1919
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  38
* ELRATE.cbl
  1920     IF CP-MNTHS-TO-FIRST-PMT GREATER ZERO
  1921        COMPUTE CP-PREMIUM-RATE =
  1922        ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1923         * (CP-ORIGINAL-TERM + 1)) - CP-PREMIUM-RATE)
  1924         * (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  1925
  1926     IF CP-MNTHS-TO-FIRST-PMT = ZEROS
  1927        COMPUTE CP-PREMIUM-RATE =
  1928        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  1929        CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - 1))) *
  1930        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  1931        (CP-PREMIUM-RATE / CP-ORIGINAL-TERM
  1932         * (CP-ORIGINAL-TERM - 1)).
  1933******************************************************
  1934
  1935 1075-BYPASS-REGULAR-RATE.
  1936
  1937     MOVE CP-LOAN-TERM              TO WS-RATE-TERM.
  1938
  1939     MOVE +1 TO LINDX.
  1940
  1941     IF CP-COMPANY-ID EQUAL 'CRI'
  1942        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  1943           MOVE +5               TO LINDX
  1944           IF RT-L-EX-AGE (LINDX) EQUAL ZERO
  1945              MOVE 'F'           TO CP-RETURN-CODE
  1946              GO TO 1200-CALCULATE-PREMIUMS.
  1947
  1948     IF RT-L-EX-AGE (LINDX) = ZERO
  1949          GO TO 1200-CALCULATE-PREMIUMS.
  1950
  1951 1100-SEARCH-LIFE-LIMITS.
  1952
  1953     IF CP-COMPANY-ID EQUAL 'CRI'
  1954        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  1955           IF LINDX GREATER THAN +4
  1956              MOVE 'A'           TO CP-RETURN-CODE
  1957              GO TO 1200-CALCULATE-PREMIUMS.
  1958
  1959     IF LINDX GREATER +8
  1960         MOVE 'A'                TO CP-RETURN-CODE
  1961         GO TO 1200-CALCULATE-PREMIUMS.
  1962
  1963     IF CP-ISSUE-AGE GREATER RT-L-EX-AGE (LINDX)
  1964         IF RT-L-EX-AGE (LINDX) = ZEROS
  1965             ADD +1              TO LINDX
  1966             GO TO 1100-SEARCH-LIFE-LIMITS
  1967         ELSE
  1968             MOVE RT-L-EX-AGE (LINDX)
  1969                                 TO CP-R-MAX-AGE
  1970             MOVE RT-L-EX-TERM (LINDX)
  1971                                 TO CP-R-MAX-TERM
  1972             MOVE RT-L-EX-FACE (LINDX)
  1973                                 TO CP-R-MAX-TOT-BEN
  1974             ADD +1              TO LINDX
  1975             GO TO 1100-SEARCH-LIFE-LIMITS
  1976     ELSE
  1977         MOVE RT-L-EX-AGE (LINDX)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  39
* ELRATE.cbl
  1978                                 TO CP-R-MAX-AGE
  1979         MOVE RT-L-EX-TERM (LINDX)
  1980                                 TO CP-R-MAX-TERM
  1981         MOVE RT-L-EX-FACE (LINDX)
  1982                                 TO CP-R-MAX-TOT-BEN.
  1983
  1984     IF CP-ORIGINAL-TERM GREATER RT-L-EX-TERM (LINDX)
  1985         MOVE '9'                TO CP-RETURN-CODE.
  1986
  1987     IF CP-ORIGINAL-BENEFIT GREATER RT-L-EX-FACE (LINDX)
  1988         MOVE '8'                TO CP-RETURN-CODE.
  1989
  1990 1200-CALCULATE-PREMIUMS.
  1991
  1992     IF CP-COMPANY-ID = 'CSL'
  1993        IF CP-CSL-VALID-NP-BENEFIT-CD
  1994           GO TO 1240-NET-PAY-CONT
  1995        ELSE
  1996           GO TO 1250-CSL-CALC.
  1997
  1998     IF CP-COMPANY-ID = 'WDS'
  1999        IF CP-STATE-STD-ABBRV = 'MN' OR 'NC'
  2000           IF CP-EARN-AS-REG-BALLOON
  2001              GO TO 1240-NET-PAY-CONT.
  2002
  2003     IF (CP-COMPANY-ID = 'CID')
  2004        AND (CP-STATE-STD-ABBRV = 'MN')
  2005        AND (CP-EARN-AS-REG-BALLOON)
  2006        AND (CP-CERT-EFF-DT > X'A4FF')
  2007        GO TO 1240-NET-PAY-CONT
  2008     END-IF
  2009     IF (CP-COMPANY-ID = 'CID')
  2010        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2011           OR 'IN' OR 'AZ')
  2012        AND (CP-FARM-PLAN)
  2013***  OK, I DID THIS SO ERCNETP WOULDN'T ERROR OUT
  2014***  THE APR ISN'T EVEN USED IN THE ROUTINE, SO SUE ME :)
  2015        MOVE +1.0                TO CP-LOAN-APR
  2016        GO TO 1240-NET-PAY-CONT
  2017     END-IF
  2018     IF CP-RATE-AS-STANDARD
  2019         GO TO 1210-REGULAR-RATE.
  2020
  2021     IF CP-CRITICAL-PERIOD
  2022         GO TO 1220-CRITICAL-PERIOD-LF-CONT.
  2023
  2024     IF CP-EARN-AS-TEXAS
  2025         GO TO 1230-TEXAS-CONT.
  2026
  2027     IF CP-EARN-AS-NET-PAY
  2028        IF CP-STATE-STD-ABBRV = 'MD'
  2029          IF CP-COMPANY-ID = 'MON'
  2030            IF CP-BENEFIT-CD = '11' OR '12' OR '13' OR
  2031                               '14' OR '26' OR '47'
  2032              GO TO 1210-REGULAR-RATE.
  2033
  2034     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2035        IF CP-MONTHLY-PAYMENT EQUAL +0
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  40
* ELRATE.cbl
  2036           COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2037                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2038
  2039     IF CP-COMPANY-ID EQUAL 'GTL'
  2040        NEXT SENTENCE
  2041     ELSE
  2042     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2043        IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2044           COMPUTE WK3 ROUNDED EQUAL
  2045           CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2046           CP-MONTHLY-PAYMENT
  2047           COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2048           COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2049           CP-ALTERNATE-BENEFIT)
  2050           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2051           WK3 * WK5
  2052           GO TO 9999-CALC-RATE-PREM-X
  2053        ELSE
  2054           COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2055           (CP-ORIGINAL-TERM - 1 - WK1)) /
  2056           (WS-WORK-DIS-RATE / +12)
  2057           COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2058           COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2059                               WK5
  2060           GO TO 9999-CALC-RATE-PREM-X.
  2061
  2062     IF CP-COMPANY-ID EQUAL 'GTL' AND
  2063        CP-STATE-STD-ABBRV EQUAL 'RI' AND
  2064        CP-SPECIAL-CALC-CD EQUAL 'H' AND
  2065        CP-ORIGINAL-TERM LESS THAN +61
  2066        COMPUTE CP-CALC-PREMIUM EQUAL
  2067                        (CP-ORIGINAL-BENEFIT *
  2068           (CP-ORIGINAL-TERM + 1) * CP-PREMIUM-RATE) /
  2069           (20 * (1 + .0019 * CP-ORIGINAL-TERM) * 100)
  2070        COMPUTE CP-CALC-PREMIUM EQUAL
  2071                CP-CALC-PREMIUM +
  2072              (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE *
  2073        (CP-ORIGINAL-TERM + 1)) /
  2074        (10 * (1 + .0027 * (CP-ORIGINAL-TERM + 1)) * 100)
  2075        GO TO 9999-CALC-RATE-PREM-X.
  2076
  2077     IF CP-COMPANY-ID = 'GTL'     AND
  2078        CP-STATE-STD-ABBRV = 'PA' AND
  2079        CP-SPECIAL-CALC-CD = 'H'
  2080         GO TO 1260-GTL-PA-LEASE.
  2081
  2082     IF (CP-EARN-AS-NET-PAY)
  2083        AND (CP-LOAN-APR > ZEROS)
  2084        GO TO 1240-NET-PAY-CONT
  2085     END-IF
  2086
  2087     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  2088         GO TO 1210-REGULAR-RATE.
  2089
  2090**** CHECK TO SEE IF THE LEVEL PORTION OF A BALLOON IS BEING
  2091**** RATED AND BYPASS NET-PAY CHECK IF NO APR HAS BEEN ENTERED.
  2092****
  2093     IF CP-DEVIATION-CODE = 'LEV' AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  41
* ELRATE.cbl
  2094        CP-LOAN-APR = ZEROS
  2095         GO TO 1210-REGULAR-RATE.
  2096
  2097     IF (CP-STATE-STD-ABBRV = 'OH')
  2098        AND (CP-CLASS-CODE NOT = 'L ')
  2099        AND (CP-ORIGINAL-TERM > 60)
  2100        AND (DC-GREG-DATE-CYMD > 19831031)
  2101        AND (CP-LOAN-APR > ZEROS)
  2102        GO TO 1240-NET-PAY-CONT
  2103     END-IF
  2104
  2105     IF (CP-STATE-STD-ABBRV = 'UT')
  2106        AND (CP-ORIGINAL-TERM > 62)
  2107        AND (DC-GREG-DATE-CYMD > 19810831)
  2108        AND (DC-GREG-DATE-CYMD < 19830901)
  2109        AND (CP-LOAN-APR > ZEROS)
  2110        GO TO 1240-NET-PAY-CONT
  2111     END-IF
  2112
  2113     IF (CP-STATE-STD-ABBRV = 'RI')
  2114        AND (CP-ORIGINAL-TERM > 60)
  2115        AND (DC-GREG-DATE-CYMD > 19831231)
  2116        AND (CP-LOAN-APR > ZEROS)
  2117        GO TO 1240-NET-PAY-CONT
  2118     END-IF
  2119     .
  2120 1210-REGULAR-RATE.
  2121
  2122     IF (CP-COMPANY-ID = 'CID')
  2123        AND (CP-EARN-AS-NET-PAY)
  2124        AND (CP-LOAN-APR = 0)
  2125        IF RT-L-RATE (WS-RATE-TERM) = 0
  2126           COMPUTE WS-SIN-PREM-RATE =
  2127              (RT-DISCOUNT-OB-RATE / +1000) *
  2128              ((WS-RATE-TERM + +1) / +2)
  2129           COMPUTE CP-PREMIUM-RATE =
  2130              WS-SIN-PREM-RATE /
  2131              (+1 + (((WS-WORK-DIS-RATE / +100) *
  2132              WS-RATE-TERM) / +24))
  2133        ELSE
  2134           MOVE RT-L-RATE (WS-RATE-TERM) TO CP-PREMIUM-RATE
  2135        END-IF
  2136     END-IF
  2137*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2138*       IF CP-MONTHLY-PAYMENT EQUAL +0
  2139*          COMPUTE CP-MONTHLY-PAYMENT EQUAL
  2140*               CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM.
  2141*
  2142*    IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2143*       IF CP-STATE-STD-ABBRV NOT EQUAL 'NY'
  2144*          COMPUTE WK3 ROUNDED EQUAL
  2145*          CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM - +1) *
  2146*          CP-MONTHLY-PAYMENT
  2147*          COMPUTE WK3 ROUNDED EQUAL WK3 / 2
  2148*          COMPUTE WK3 ROUNDED EQUAL WK3 + (CP-ORIGINAL-TERM *
  2149*          CP-ALTERNATE-BENEFIT)
  2150*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2151*          WK3 * WK5
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  42
* ELRATE.cbl
  2152*          GO TO 9999-CALC-RATE-PREM-X
  2153*       ELSE
  2154*          COMPUTE WK3 ROUNDED EQUAL (CP-MONTHLY-PAYMENT *
  2155*          (CP-ORIGINAL-TERM - 1 - WK1)) /
  2156*          (WS-WORK-DIS-RATE / +12)
  2157*          COMPUTE WK3 EQUAL WK3 + (CP-ALTERNATE-BENEFIT * WK2)
  2158*          COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL WK3 *
  2159*                              WK5
  2160*          GO TO 9999-CALC-RATE-PREM-X.
  2161
  2162     IF CP-TERM-IS-DAYS
  2163         COMPUTE CP-PREMIUM-RATE ROUNDED =
  2164             ((CP-PREMIUM-RATE / CP-ORIGINAL-TERM) * 12) / +365
  2165         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2166             ((CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE)
  2167                          * CP-TERM-OR-EXT-DAYS
  2168           GO TO 9999-CALC-RATE-PREM-X.
  2169
  2170     IF NOT CP-TRUNCATED-LIFE
  2171         GO TO 1212-GROSS-NOT-TRUNCATED.
  2172
  2173****  GROSS TRUNCATED CALCULATION
  2174
  2175     IF CP-LOAN-TERM NOT GREATER THAN CP-ORIGINAL-TERM
  2176         MOVE 'H'                TO  CP-RETURN-CODE
  2177         GO TO 9999-CALC-RATE-PREM-X.
  2178
  2179     IF CP-COMPANY-ID = 'NCL'
  2180         COMPUTE WK-MONTHLY-RATE =
  2181               ((((CP-LOAN-TERM * (CP-LOAN-TERM + 1) -
  2182                  (CP-LOAN-TERM - CP-ORIGINAL-TERM) *
  2183                  (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1))
  2184                                 /
  2185                  (CP-LOAN-TERM * (CP-LOAN-TERM + 1))))
  2186                                 *
  2187                  ((RT-L-RATE (12) * CP-LOAN-TERM / 12)))
  2188         COMPUTE CP-CALC-PREMIUM =
  2189                 WK-MONTHLY-RATE * CP-ORIGINAL-BENEFIT / 100
  2190     ELSE
  2191         COMPUTE CP-R-MAX-TERM = CP-LOAN-TERM -
  2192                                 CP-ORIGINAL-TERM
  2193         COMPUTE CP-CALC-PREMIUM = CP-ORIGINAL-BENEFIT *
  2194                     ((RT-L-RATE (CP-LOAN-TERM)  -
  2195                     (1 - (CP-ORIGINAL-TERM / CP-LOAN-TERM)) *
  2196                     RT-L-RATE (CP-R-MAX-TERM)) / 100)
  2197     END-IF
  2198     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2199        COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2200           (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2201           CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS)
  2202     END-IF
  2203     GO TO 9999-CALC-RATE-PREM-X
  2204     .
  2205 1212-GROSS-NOT-TRUNCATED.
  2206*    DISPLAY ' ELCRATPD '
  2207*    DISPLAY ' MADE IT TO 1212-GROSS-NOT '
  2208*    display ' premium rate ' cp-premium-rate
  2209
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  43
* ELRATE.cbl
  2210     IF (CP-COMPANY-ID = 'CID')
  2211        AND (CP-STATE-STD-ABBRV = 'VT' OR 'MA'
  2212           OR 'IN')
  2213        AND (CP-BENEFIT-CD = '55' OR '56')
  2214        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2215          (CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM)) *
  2216          (CP-ORIGINAL-TERM) *
  2217          ((CP-ORIGINAL-TERM) / 12) *
  2218          ((6.5 * RT-DISCOUNT-OB-RATE) / 1000)
  2219          GO TO 9999-CALC-RATE-PREM-X
  2220     END-IF
  2221     IF (CP-COMPANY-ID = 'CID')
  2222        AND (CP-STATE-STD-ABBRV = 'GA')
  2223        AND (CP-BENEFIT-CD = '55' OR '56' OR '2M' OR '2N')
  2224        COMPUTE WK3 ROUNDED =
  2225          CP-ORIGINAL-BENEFIT *
  2226          ((CP-ORIGINAL-TERM + 1) / 2) *
  2227          (RT-DISCOUNT-OB-RATE / 1000)
  2228          MOVE WK3 TO CP-CALC-PREMIUM
  2229          GO TO 9999-CALC-RATE-PREM-X
  2230     END-IF
  2231     IF (CP-COMPANY-ID EQUAL 'CID')
  2232        AND (CP-STATE-STD-ABBRV = 'MN')
  2233        AND (CP-LEVEL-LIFE)
  2234        AND (CP-CERT-EFF-DT > X'A4FF')
  2235        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  2236        MOVE CP-EXPIRE-DT        TO DC-BIN-DATE-2
  2237        MOVE '1'                 TO DC-OPTION-CODE
  2238        PERFORM 9100-CONVERT-DATE
  2239                                 THRU 9100-EXIT
  2240        IF DATE-CONVERSION-ERROR
  2241           MOVE '2'              TO CP-RETURN-CODE
  2242           MOVE ZEROS            TO FACTOR
  2243                                 CP-CALC-PREMIUM
  2244           GO TO 9999-CALC-RATE-PREM-X
  2245        END-IF
  2246        MOVE DC-ELAPSED-DAYS     TO D
  2247        COMPUTE CP-MONTHLY-PAYMENT = CP-ORIGINAL-BENEFIT /
  2248           (1 / (1 + (CP-LOAN-APR / 100) * D / 360) -
  2249           (CP-PREMIUM-RATE * 12 / 365 * D / 1000))
  2250        COMPUTE CP-CALC-PREMIUM = CP-MONTHLY-PAYMENT *
  2251           CP-PREMIUM-RATE * 12 / 365 * D / 1000
  2252        GO TO 9999-CALC-RATE-PREM-X
  2253     END-IF
  2254     IF (CP-COMPANY-ID = 'CID')
  2255        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2256        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2257           (CP-ORIGINAL-BENEFIT / 1000) * CP-PREMIUM-RATE
  2258     ELSE
  2259        COMPUTE CP-CALC-PREMIUM ROUNDED =
  2260                 (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE
  2261     END-IF
  2262*    display ' calc premium ' cp-calc-premium
  2263
  2264*    IF CP-COMPANY-ID = 'LBL'
  2265     IF (CP-COMPANY-ID = 'LBL' OR 'CID')
  2266        AND (NOT CP-EARN-AS-NET-PAY)
  2267        GO TO 9999-CALC-RATE-PREM-X
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  44
* ELRATE.cbl
  2268     END-IF
  2269
  2270*    display ' fell through to ext days '
  2271     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2272         GO TO 9999-CALC-RATE-PREM-X.
  2273
  2274     IF CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH
  2275         COMPUTE CP-CALC-PREMIUM ROUNDED = CP-CALC-PREMIUM +
  2276            (((CP-ORIGINAL-BENEFIT / 100) * ((CP-PREMIUM-RATE /
  2277               CP-ORIGINAL-TERM) / 30)) * CP-TERM-OR-EXT-DAYS).
  2278
  2279     GO TO 9999-CALC-RATE-PREM-X.
  2280
  2281 1220-CRITICAL-PERIOD-LF-CONT.
  2282     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2283               (CP-ORIGINAL-BENEFIT / +100) * CP-PREMIUM-RATE.
  2284
  2285     GO TO 9999-CALC-RATE-PREM-X.
  2286
  2287 1230-TEXAS-CONT.
  2288     IF CP-FARM-PLAN
  2289         GO TO 1235-TEXAS-FARM-CONT.
  2290
  2291     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2292               (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2293
  2294     COMPUTE TEX-FACT-9 =
  2295                 (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY) /
  2296                 (CP-ORIGINAL-TERM + 1).
  2297
  2298     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2299                 CP-CALC-PREMIUM * TEX-FACT-9.
  2300
  2301     GO TO 9999-CALC-RATE-PREM-X.
  2302
  2303 1235-TEXAS-FARM-CONT.
  2304     COMPUTE WS-FARM-TERM =
  2305               (CP-ORIGINAL-TERM + CP-PAY-FREQUENCY).
  2306
  2307     COMPUTE WS-PREMIUM-RATE = RT-L-RATE (WS-FARM-TERM) / 2.
  2308     MOVE WS-PREMIUM-RATE         TO CP-PREMIUM-RATE.
  2309
  2310
  2311     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2312              (CP-ORIGINAL-BENEFIT / 100) * CP-PREMIUM-RATE.
  2313
  2314     GO TO 9999-CALC-RATE-PREM-X.
  2315
  2316 1240-NET-PAY-CONT.
  2317
  2318     MOVE CP-LOAN-APR             TO N-P-APR.
  2319     MOVE CP-ORIGINAL-TERM        TO N-P-ORIG
  2320                                     N-P-REM
  2321                                     N-P-LOAN.
  2322
  2323     MOVE CP-SPECIAL-CALC-CD      TO N-P-OPT.
  2324
  2325     IF CP-TRUNCATED-LIFE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  45
* ELRATE.cbl
  2326         MOVE CP-LOAN-TERM        TO N-P-LOAN.
  2327
  2328     IF CP-COMPANY-ID EQUAL 'NCL'
  2329        NEXT SENTENCE
  2330     ELSE
  2331        GO TO 1241-NET-PAY-CONT.
  2332
  2333     MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  2334     MOVE CP-FIRST-PAY-DATE      TO DC-BIN-DATE-2
  2335     MOVE '1'                    TO DC-OPTION-CODE
  2336     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2337     IF DATE-CONVERSION-ERROR
  2338         MOVE '2'                TO CP-RETURN-CODE
  2339         GO TO 9999-CALC-RATE-PREM-X
  2340     ELSE
  2341        MOVE DC-ELAPSED-MONTHS   TO CP-MNTHS-TO-FIRST-PMT
  2342        MOVE DC-ODD-DAYS-OVER    TO CP-ODD-DAYS-TO-PMT.
  2343
  2344     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2345        (CP-ODD-DAYS-TO-PMT NOT EQUAL ZEROS)
  2346        NEXT SENTENCE
  2347     ELSE
  2348        MOVE +1                  TO ODF
  2349        GO TO 1241-NET-PAY-CONT.
  2350
  2351     IF CP-MNTHS-TO-FIRST-PMT GREATER THAN ZERO
  2352        COMPUTE CP-PREMIUM-RATE EQUAL
  2353        ((CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN + 1)) -
  2354        CP-PREMIUM-RATE) *
  2355        (CP-ODD-DAYS-TO-PMT * 12 / 365) + CP-PREMIUM-RATE.
  2356
  2357     IF CP-MNTHS-TO-FIRST-PMT EQUAL ZEROS
  2358        COMPUTE CP-PREMIUM-RATE EQUAL
  2359        (CP-PREMIUM-RATE - (CP-PREMIUM-RATE /
  2360        N-P-LOAN * (N-P-LOAN - 1))) *
  2361        (CP-ODD-DAYS-TO-PMT * 12 / 365) +
  2362        (CP-PREMIUM-RATE / N-P-LOAN * (N-P-LOAN - 1)).
  2363
  2364     COMPUTE ODF EQUAL
  2365     ((1 + (N-P-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  2366     ((1 + (CP-ODD-DAYS-TO-PMT * 12 / 36500))).
  2367
  2368 1241-NET-PAY-CONT.
  2369
  2370     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2371
  2372*    IF CP-RETURN-CODE EQUAL '0' OR '8'
  2373     IF CP-RETURN-CODE EQUAL '0' OR '8' OR '9' OR 'B'
  2374        NEXT SENTENCE
  2375     ELSE
  2376        GO TO 9999-CALC-RATE-PREM-X.
  2377
  2378     IF RT-DISCOUNT-OPTION EQUAL '6'
  2379         GO TO 9999-CALC-RATE-PREM-X.
  2380
  2381     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2382        (CP-STATE-STD-ABBRV EQUAL 'IA')
  2383        GO TO 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  46
* ELRATE.cbl
  2384
  2385     MOVE N-P-FACTOR              TO CP-CDT-FACTOR.
  2386
  2387     IF RT-DISCOUNT-OPTION EQUAL '3' OR '4' OR '5'
  2388        GO TO 9999-CALC-RATE-PREM-X.
  2389
  2390     IF (CP-COMPANY-ID EQUAL 'MON') AND
  2391        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  2392        (CP-TRUNCATED-LIFE)
  2393        GO TO 9999-CALC-RATE-PREM-X.
  2394
  2395     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  2396        (CP-CSL-VALID-NP-BENEFIT-CD)
  2397        GO TO 9999-CALC-RATE-PREM-X.
  2398
  2399     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  2400        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  2401        (CP-EARN-AS-NET-PAY)
  2402        GO TO 9999-CALC-RATE-PREM-X.
  2403
  2404*    IF (CP-COMPANY-ID EQUAL 'CID') AND
  2405*       (CP-STATE-STD-ABBRV EQUAL 'NV') AND
  2406*       (CP-EARN-AS-NET-PAY OR CP-TRUNCATED-LIFE)
  2407*       GO TO 9999-CALC-RATE-PREM-X.
  2408
  2409     IF (CP-COMPANY-ID EQUAL 'NCB') AND
  2410        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2411        (CP-EARN-AS-NET-PAY)
  2412        GO TO 9999-CALC-RATE-PREM-X.
  2413
  2414     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  2415        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'NC') AND
  2416        (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2417        GO TO 9999-CALC-RATE-PREM-X.
  2418
  2419     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  2420        (CP-EARN-AS-NET-PAY)
  2421        GO TO 9999-CALC-RATE-PREM-X.
  2422
  2423     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2424        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  2425        (CP-TRUNCATED-LIFE)
  2426        GO TO 9999-CALC-RATE-PREM-X.
  2427
  2428     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2429        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  2430        (CP-EARN-AS-NET-PAY)
  2431*       (CP-TRUNCATED-LIFE)
  2432        GO TO 9999-CALC-RATE-PREM-X.
  2433
  2434     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2435        (CP-STATE-STD-ABBRV EQUAL 'RI')
  2436                   AND
  2437        ((CP-EARN-AS-NET-PAY)
  2438               OR
  2439        (CP-SPECIAL-CALC-CD EQUAL 'H'))
  2440        GO TO 9999-CALC-RATE-PREM-X.
  2441
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  47
* ELRATE.cbl
  2442     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2443        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  2444        (CP-EARN-AS-NET-PAY) AND
  2445        (CP-SPECIAL-CALC-CD EQUAL 'H')
  2446        GO TO 9999-CALC-RATE-PREM-X.
  2447
  2448     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  2449        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  2450        (CP-EARN-AS-NET-PAY)
  2451        GO TO 9999-CALC-RATE-PREM-X.
  2452
  2453     IF CP-COMPANY-ID = 'CID'
  2454        CONTINUE
  2455     ELSE
  2456        IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  2457           (CP-EARN-AS-NET-PAY) AND
  2458           (DC-GREG-DATE-CYMD GREATER THAN 19931231)
  2459           GO TO 9999-CALC-RATE-PREM-X
  2460        END-IF
  2461     END-IF
  2462
  2463     IF (CP-COMPANY-ID = 'CID')
  2464        AND (CP-EARN-AS-NET-PAY)
  2465        AND (CP-STATE-STD-ABBRV = 'ME')
  2466        GO TO 9999-CALC-RATE-PREM-X
  2467     END-IF
  2468     IF (CP-COMPANY-ID = 'DCC')
  2469        AND (CP-BEN-CATEGORY = 'D')
  2470        AND (CP-EARN-AS-NET-PAY)
  2471        GO TO 9999-CALC-RATE-PREM-X
  2472     END-IF
  2473     IF (CP-COMPANY-ID = 'CID')
  2474        AND (CP-STATE-STD-ABBRV = 'ND' OR 'MT' OR 'NJ'
  2475           OR 'IN' OR 'AZ')
  2476        AND (CP-FARM-PLAN)
  2477        GO TO 9999-CALC-RATE-PREM-X
  2478     END-IF
  2479     IF (CP-COMPANY-ID = 'CID') AND
  2480        (CP-EARN-AS-NET-PAY) AND
  2481        (CP-LEVEL-LIFE) AND
  2482        (CP-STATE-STD-ABBRV = 'CA' OR 'MN') AND
  2483        (CP-STATE-STD-ABBRV = CP-STATE)
  2484        GO TO 9999-CALC-RATE-PREM-X
  2485     END-IF
  2486
  2487     IF (CP-COMPANY-ID = 'CID') AND
  2488        (CP-EARN-AS-NET-PAY) AND
  2489        ((CP-STATE-STD-ABBRV = 'MT' OR 'NJ' OR 'PA'
  2490                            OR 'VT')
  2491                   OR
  2492        ((CP-STATE-STD-ABBRV = 'IN') AND
  2493        (CP-CERT-EFF-DT > X'9A7F'))
  2494                   OR
  2495        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  2496        (CP-CERT-EFF-DT > X'9ADF'))) AND
  2497        (CP-STATE-STD-ABBRV = CP-STATE)
  2498        GO TO 9999-CALC-RATE-PREM-X
  2499     END-IF
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  48
* ELRATE.cbl
  2500
  2501     IF (CP-COMPANY-ID = 'CID') AND
  2502        (CP-EARN-AS-NET-PAY) AND
  2503        (CP-STATE-STD-ABBRV = 'TX') AND
  2504        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2505        (WS-DISCOUNT-OPTION NOT = ' ')
  2506        GO TO 9999-CALC-RATE-PREM-X
  2507     END-IF
  2508
  2509     IF (CP-COMPANY-ID = 'CID')
  2510        AND (CP-STATE-STD-ABBRV = 'MN')
  2511        AND (RT-DISCOUNT-OPTION = '1')
  2512        AND (CP-EARN-AS-NET-PAY OR CP-EARN-AS-REG-BALLOON)
  2513        GO TO 9999-CALC-RATE-PREM-X
  2514     END-IF
  2515     IF (CP-COMPANY-ID = 'CID')
  2516        AND (CP-EARN-AS-NET-PAY)
  2517        AND ((CP-STATE-STD-ABBRV = 'NH' OR 'NV' OR 'WA' OR 'AK')
  2518                      OR
  2519            (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54'))
  2520        GO TO 9999-CALC-RATE-PREM-X
  2521     END-IF
  2522     IF (CP-COMPANY-ID = 'CID')
  2523        AND (CP-EARN-AS-NET-PAY)
  2524        AND (CP-STATE-STD-ABBRV = 'SC')
  2525        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2526        GO TO 9999-CALC-RATE-PREM-X
  2527     END-IF
  2528     IF (CP-COMPANY-ID = 'CID') AND
  2529        (CP-EARN-AS-NET-PAY) AND
  2530        (CP-TRUNCATED-LIFE) AND
  2531        (CP-STATE-STD-ABBRV = 'CA' OR 'VA') AND
  2532        (CP-STATE-STD-ABBRV = CP-STATE) AND
  2533        (WS-DISCOUNT-OPTION NOT = ' ')
  2534        GO TO 9999-CALC-RATE-PREM-X
  2535     END-IF
  2536
  2537     IF (CP-COMPANY-ID EQUAL 'DCC') AND
  2538        (CP-EARN-AS-NET-PAY)
  2539        MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE
  2540        GO TO 9999-CALC-RATE-PREM-X
  2541     END-IF
  2542
  2543     IF (CP-COMPANY-ID EQUAL 'CID')
  2544        AND (CP-EARN-AS-NET-PAY)
  2545        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'N' OR 'H')
  2546        GO TO 9999-CALC-RATE-PREM-X
  2547     END-IF
  2548
  2549     IF (RT-IS-OB) AND
  2550        (CP-COMPANY-ID NOT EQUAL 'CID')
  2551        COMPUTE CP-PREMIUM-RATE ROUNDED =
  2552               (CP-PREMIUM-RATE * 12) / CP-LOAN-TERM
  2553      ELSE
  2554         IF (CP-COMPANY-ID = 'DCC')
  2555            AND (CP-RATE-DEV-PCT NOT = ZEROS)
  2556            COMPUTE CP-CALC-PREMIUM ROUNDED =
  2557*           COMPUTE CP-PREMIUM-RATE ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  49
* ELRATE.cbl
  2558             (CP-PREMIUM-RATE * CP-RATE-DEV-PCT * 12) /
  2559               CP-ORIGINAL-TERM
  2560             MOVE CP-CALC-PREMIUM TO CP-PREMIUM-RATE
  2561             MOVE ZEROS          TO CP-RATE-DEV-PCT
  2562        ELSE
  2563           COMPUTE CP-PREMIUM-RATE ROUNDED =
  2564               (CP-PREMIUM-RATE * 12) / CP-ORIGINAL-TERM
  2565        END-IF
  2566     END-IF
  2567
  2568     IF CP-ROA-PREM-AT-REFUND
  2569         COMPUTE NET-BEN ROUNDED =
  2570             (CP-REMAINING-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000
  2571     ELSE
  2572         COMPUTE NET-BEN ROUNDED =
  2573              (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) / 1000.
  2574
  2575     IF (CP-EXT-CHG-LF OR CP-EXT-CHG-LF-AH) AND
  2576        (CP-TERM-OR-EXT-DAYS NOT = ZERO)
  2577          COMPUTE NET-BEN ROUNDED =
  2578              NET-BEN * (1 + (CP-LOAN-APR / 1200) *
  2579                         (CP-TERM-OR-EXT-DAYS / 30)).
  2580
  2581     IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'CID' OR 'MON' OR 'HAN'
  2582*       OR 'DCC'
  2583*    IF CP-COMPANY-ID = 'CDC' OR 'GTL' OR 'MON' OR 'HAN'
  2584     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2585       (N-P-FACTOR * CP-PREMIUM-RATE * CP-ORIGINAL-TERM / 1200) /
  2586       (1 - (N-P-FACTOR * CP-PREMIUM-RATE
  2587                        * CP-ORIGINAL-TERM / 1200))
  2588     ELSE
  2589     COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2590       (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200) /
  2591       (1 - (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200)).
  2592
  2593****** THE BELOW VERSION OF THE NET PAY FORMULA IS USED WHEN NO
  2594****** INTEREST IS CHARGED ON PREMIUM.
  2595
  2596*    IF CP-STATE-STD-ABBRV = 'MI'
  2597*         COMPUTE CP-CALC-PREMIUM ROUNDED = NET-BEN * 1000 *
  2598*          (N-P-FACTOR * CP-PREMIUM-RATE * WS-RATE-TERM / 1200).
  2599
  2600     MOVE WS-PREMIUM-RATE  TO CP-PREMIUM-RATE.
  2601
  2602     GO TO 9999-CALC-RATE-PREM-X.
  2603
  2604******
  2605****** BELOW ARE PREMIUM CALCULATIONS FOR CSL
  2606******
  2607
  2608 1250-CSL-CALC.
  2609     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  2610     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  2611     MOVE '1' TO DC-OPTION-CODE.
  2612     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  2613
  2614     IF DATE-CONVERSION-ERROR
  2615         MOVE '2' TO CP-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  50
* ELRATE.cbl
  2616         GO TO 9999-CALC-RATE-PREM-X.
  2617
  2618     IF CP-JOINT-INDICATOR = 'J'
  2619         MOVE RT-L-RATE (3) TO WK-RED-RATE
  2620     ELSE
  2621         MOVE RT-L-RATE (1) TO WK-RED-RATE.
  2622
  2623     MOVE WK-RED-RATE TO CP-PREMIUM-RATE.
  2624     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  2625
  2626     IF CP-PAY-FREQUENCY = 12
  2627         MOVE 01               TO WS-PAY-SCH.
  2628     IF CP-PAY-FREQUENCY = 04
  2629         MOVE 03               TO WS-PAY-SCH.
  2630     IF CP-PAY-FREQUENCY = 02
  2631         MOVE 06               TO WS-PAY-SCH.
  2632     IF CP-PAY-FREQUENCY = 01
  2633         MOVE 12               TO WS-PAY-SCH.
  2634
  2635     COMPUTE WS-NUM-PAYMTS = CP-ORIGINAL-TERM / WS-PAY-SCH.
  2636     IF CP-PAY-FREQUENCY NOT = 12
  2637         COMPUTE WK-PAY-AMT = CP-REMAINING-BENEFIT /
  2638                                WS-NUM-PAYMTS.
  2639
  2640     IF CP-STATE = 'SC'  AND
  2641       (CP-BENEFIT-CD = '07'  OR  '08')
  2642         GO TO 1250-CSL-CALC-LIFE-6.
  2643
  2644     IF CP-CSL-METH-1
  2645         GO TO 1250-CSL-CALC-LIFE-1.
  2646
  2647     IF CP-CSL-METH-2
  2648         IF (WK-PAY-AMT * CP-LOAN-TERM) GREATER THAN
  2649                          WS-MAX-TOT-BEN
  2650             GO TO 1250-CSL-CALC-LIFE-2
  2651         ELSE
  2652             GO TO 1250-CSL-CALC-LIFE-1.
  2653
  2654     IF CP-CSL-METH-3
  2655         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  2656             GO TO 1250-CSL-CALC-LIFE-2
  2657         ELSE
  2658             GO TO 1250-CSL-CALC-LIFE-3.
  2659
  2660     IF CP-CSL-METH-4
  2661         IF (WK-PAY-AMT * WS-NUM-PAYMTS) GREATER THAN
  2662                          WS-MAX-TOT-BEN
  2663             GO TO 1250-CSL-CALC-LIFE-5
  2664         ELSE
  2665             GO TO 1250-CSL-CALC-LIFE-4.
  2666
  2667 1250-CSL-CALC-LIFE-1.
  2668     IF CP-JOINT-INDICATOR = 'J'
  2669         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2670     ELSE
  2671         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2672
  2673     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY) /
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  51
* ELRATE.cbl
  2674                    365) - 1) * 365 / 12.
  2675     COMPUTE WK-S ROUNDED = ((144 * WK-D * WK-LEV-RATE) +
  2676                    (365 * WS-NUM-PAYMTS * WK-RED-RATE)) /
  2677                    4380.
  2678     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PAY-AMT *
  2679                    WS-NUM-PAYMTS * WK-S.
  2680
  2681     GO TO 9999-CALC-RATE-PREM-X.
  2682
  2683 1250-CSL-CALC-LIFE-2.
  2684     IF CP-JOINT-INDICATOR = 'J'
  2685         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2686     ELSE
  2687         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2688
  2689     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2690     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2691     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2692                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2693                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2694     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2695                    WK-S) + WK-D.
  2696
  2697     GO TO 9999-CALC-RATE-PREM-X.
  2698
  2699 1250-CSL-CALC-LIFE-3.
  2700     IF CP-JOINT-INDICATOR = 'J'
  2701         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2702     ELSE
  2703         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2704
  2705     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2706     COMPUTE WK-S ROUNDED = (WK-K * WK-RED-RATE) / 12.
  2707     COMPUTE WK-D = (((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2708                    - 1) + WS-NUM-PAYMTS - WK-K) *
  2709                    (WK-LEV-RATE * WS-MAX-TOT-BEN).
  2710     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * WK-K *
  2711                    WK-S) + WK-D.
  2712
  2713     GO TO 9999-CALC-RATE-PREM-X.
  2714
  2715 1250-CSL-CALC-LIFE-4.
  2716     IF CP-JOINT-INDICATOR = 'J'
  2717         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2718     ELSE
  2719         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2720
  2721     COMPUTE WK-D = DC-ELAPSED-DAYS * 12 / 365.
  2722     COMPUTE WK-S ROUNDED =
  2723                    (((6 * (WS-NUM-PAYMTS - 1)) + (WK-D *
  2724                    CP-PAY-FREQUENCY)) * WK-LEV-RATE) /
  2725                    CP-PAY-FREQUENCY.
  2726     COMPUTE CP-CALC-PREMIUM ROUNDED =  WK-PAY-AMT *
  2727                    WS-NUM-PAYMTS * WK-S.
  2728
  2729     GO TO 9999-CALC-RATE-PREM-X.
  2730
  2731 1250-CSL-CALC-LIFE-5.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  52
* ELRATE.cbl
  2732     IF CP-JOINT-INDICATOR = 'J'
  2733         MOVE RT-L-RATE (4) TO WK-LEV-RATE
  2734     ELSE
  2735         MOVE RT-L-RATE (2) TO WK-LEV-RATE.
  2736
  2737     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  2738     COMPUTE WK-S ROUNDED = (6 * (WK-K + 1) * WK-LEV-RATE) /
  2739                    CP-PAY-FREQUENCY.
  2740     COMPUTE WK-U = ((((DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  2741                    - 1) + WS-NUM-PAYMTS) * 12) /
  2742                    CP-PAY-FREQUENCY.
  2743     COMPUTE WK-L = WK-U - (12 * WK-K / CP-PAY-FREQUENCY).
  2744     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-L * WK-LEV-RATE *
  2745                    WS-MAX-TOT-BEN) + (WK-K * WK-PAY-AMT * WK-S).
  2746
  2747     GO TO 9999-CALC-RATE-PREM-X.
  2748
  2749 1250-CSL-CALC-LIFE-6.
  2750
  2751     COMPUTE CP-PREMIUM-RATE ROUNDED =
  2752                (CP-PREMIUM-RATE * CP-ORIGINAL-TERM) / 12.
  2753
  2754     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2755                    CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE.
  2756
  2757     GO TO 9999-CALC-RATE-PREM-X.
  2758
  2759******
  2760****** END OF PREMIUM CALCULATIONS FOR CSL
  2761******
  2762
  2763 1260-GTL-PA-LEASE.
  2764
  2765     IF CP-REDUCING-LIFE
  2766         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2767                                 TO  CP-PREMIUM-RATE
  2768         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2769                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / +100
  2770     ELSE
  2771         MOVE RT-L-RATE (CP-ORIGINAL-TERM)
  2772                                 TO  CP-PREMIUM-RATE
  2773         COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2774                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE *
  2775                 (+1 + CP-SALES-TAX) / +100.
  2776
  2777     GO TO 9999-CALC-RATE-PREM-X.
  2778
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  53
* ELRATE.cbl
  2780******************************************************************
  2781 2000-TYPE-IS-AH.
  2782     MOVE RT-MAX-AGE                TO CP-R-MAX-ATT-AGE.
  2783
  2784     MOVE ZERO                      TO CP-R-MAX-AGE
  2785                                       CP-R-MAX-TERM
  2786                                       CP-R-MAX-MON-BEN
  2787                                       CP-R-MAX-TOT-BEN.
  2788
  2789     IF RT-POLICY-FEE NUMERIC
  2790        MOVE RT-POLICY-FEE          TO CP-POLICY-FEE.
  2791
  2792     IF RT-COMPOSITE-RATE NOT NUMERIC
  2793        MOVE ZEROS                          TO RT-COMPOSITE-RATE.
  2794
  2795     IF CP-ORIGINAL-TERM > ZERO AND < 361
  2796        MOVE RT-AH-RATE (CP-ORIGINAL-TERM)
  2797                                 TO CP-PREMIUM-RATE
  2798                                    WS-PREMIUM-RATE
  2799        MOVE RT-COMPOSITE-RATE   TO CP-COMPOSITE-RATE
  2800     ELSE
  2801         MOVE +0                 TO CP-PREMIUM-RATE
  2802                                    CP-CALC-PREMIUM
  2803         GO TO 9999-CALC-RATE-PREM-X
  2804     END-IF
  2805
  2806     IF (CP-COMPANY-ID = 'DCC')
  2807        AND ((CP-BENEFIT-CD (1:1) = 'P')
  2808        OR (CP-DDF-SPEC-CALC = 'T'))
  2809        AND (CP-LOAN-TERM > ZERO AND < 361)
  2810        MOVE RT-AH-RATE (CP-LOAN-TERM)
  2811                                 TO CP-PREMIUM-RATE
  2812                                    WS-PREMIUM-RATE
  2813     END-IF
  2814     MOVE +1 TO AHNDX.
  2815
  2816     IF CP-COMPANY-ID EQUAL 'CRI'
  2817        IF CP-SIG-SWITCH EQUAL 'S' OR 'J'
  2818           MOVE +5               TO AHNDX
  2819           IF RT-AH-AGE (AHNDX) EQUAL ZERO
  2820              MOVE 'F'           TO CP-RETURN-CODE
  2821              GO TO 2200-CALCULATE-PREMIUMS.
  2822
  2823     IF RT-AH-AGE (AHNDX) = ZERO
  2824          GO TO 2200-CALCULATE-PREMIUMS.
  2825
  2826 2100-SEARCH-AH-LIMITS.
  2827
  2828     IF CP-COMPANY-ID EQUAL 'CRI'
  2829        IF CP-SIG-SWITCH NOT EQUAL 'S' AND 'J'
  2830           IF AHNDX GREATER THAN +4
  2831              MOVE 'A'             TO CP-RETURN-CODE
  2832              GO TO 2200-CALCULATE-PREMIUMS.
  2833
  2834     IF AHNDX GREATER +8
  2835         MOVE 'A'                TO CP-RETURN-CODE
  2836         GO TO 2200-CALCULATE-PREMIUMS.
  2837
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  54
* ELRATE.cbl
  2838     IF CP-ISSUE-AGE GREATER RT-AH-AGE (AHNDX)
  2839         IF RT-AH-AGE (AHNDX) = ZEROS
  2840             ADD +1               TO AHNDX
  2841             GO TO 2100-SEARCH-AH-LIMITS
  2842         ELSE
  2843             MOVE RT-AH-AGE (AHNDX)
  2844                                 TO CP-R-MAX-AGE
  2845             MOVE RT-AH-TERM (AHNDX)
  2846                                 TO CP-R-MAX-TERM
  2847             MOVE RT-AH-BEN-M (AHNDX)
  2848                                 TO CP-R-MAX-MON-BEN
  2849             ADD +1               TO AHNDX
  2850             GO TO 2100-SEARCH-AH-LIMITS
  2851     ELSE
  2852         MOVE RT-AH-AGE  (AHNDX) TO CP-R-MAX-AGE
  2853         MOVE RT-AH-TERM (AHNDX) TO CP-R-MAX-TERM
  2854         MOVE RT-AH-BEN-M (AHNDX)
  2855                                 TO CP-R-MAX-MON-BEN.
  2856
  2857     IF CP-ORIGINAL-TERM GREATER RT-AH-TERM (AHNDX)
  2858         MOVE '9'                 TO CP-RETURN-CODE.
  2859
  2860     IF CP-ORIGINAL-BENEFIT GREATER RT-AH-BEN-M (AHNDX)
  2861         MOVE '8'                 TO CP-RETURN-CODE.
  2862
  2863     MULTIPLY CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  2864         GIVING WS-AH-FACE-BENEFIT.
  2865
  2866     IF WS-AH-FACE-BENEFIT GREATER RT-AH-BEN-F (AHNDX)
  2867         MOVE 'C'                 TO CP-RETURN-CODE.
  2868
  2869 2200-CALCULATE-PREMIUMS.
  2870
  2871     IF CP-COMPANY-ID = 'CSL'
  2872         GO TO 2250-CSL-CALC.
  2873
  2874*    IF CP-CRITICAL-PERIOD
  2875*       GO TO 2200-CRITICAL-PERIOD-AH-CONT.
  2876
  2877     IF CP-CRITICAL-PERIOD
  2878        IF (CP-COMPANY-ID = 'DCC')
  2879           AND ((CP-BENEFIT-CD (1:1) = 'N' OR 'M' OR 'H'
  2880               OR 'S' OR 'P')
  2881                          OR
  2882                (CP-BEN-CATEGORY = 'G' OR 'L'))
  2883           CONTINUE
  2884        ELSE
  2885           GO TO 2200-CRITICAL-PERIOD-AH-CONT
  2886        END-IF
  2887     END-IF
  2888
  2889     IF (CP-COMPANY-ID = 'DCC')
  2890        AND (CP-BEN-CATEGORY = 'D')
  2891        COMPUTE CP-PREMIUM-RATE ROUNDED = CP-PREMIUM-RATE *
  2892           (1 + CP-DCC-PMF-COMM) / (1 - CP-DCC-ACT-COMM)
  2893     END-IF
  2894     IF CP-SPECIAL-CALC-CD EQUAL 'H'
  2895        COMPUTE WS-TERM-MINUS-ONE EQUAL CP-ORIGINAL-TERM - +1
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  55
* ELRATE.cbl
  2896        MOVE RT-AH-RATE (WS-TERM-MINUS-ONE) TO
  2897                                     CP-PREMIUM-RATE
  2898        COMPUTE CP-CALC-PREMIUM ROUNDED EQUAL
  2899        (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM - +1) *
  2900        CP-PREMIUM-RATE) / +100
  2901     ELSE
  2902        IF (CP-COMPANY-ID = 'DCC')
  2903           AND (CP-BEN-CATEGORY NOT = 'G' AND 'L')
  2904           MOVE CP-PREMIUM-RATE  TO WK-S
  2905*          MOVE CP-PREMIUM-RATE  TO CP-CALC-PREMIUM
  2906           IF CP-RATE-DEV-PCT NOT = ZEROS
  2907              COMPUTE WK-S ROUNDED =
  2908                 (CP-PREMIUM-RATE * CP-RATE-DEV-PCT)
  2909           END-IF
  2910           IF CP-BENEFIT-CD (1:1) = 'M'
  2911              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2912              CP-ORIGINAL-BENEFIT * WK-S / 100
  2913           ELSE
  2914              IF CP-BENEFIT-CD (1:1) = 'H'
  2915                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2916                    (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2917                    WK-S) / 1000
  2918              ELSE
  2919                 IF CP-BENEFIT-CD (1:1) = 'N' OR 'S'
  2920                    GO TO 2300-CALC-DCC-MOB-NET-AH
  2921                 ELSE
  2922                    IF CP-BEN-CATEGORY = 'D'
  2923                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2924                        CP-ORIGINAL-BENEFIT *
  2925                        CP-ORIGINAL-TERM * WK-S / 100
  2926                    ELSE
  2927                      IF CP-BENEFIT-CD (1:1) = 'P'
  2928                         GO TO 2300-CALC-DCC-BEN-P-AH
  2929                      ELSE
  2930                       COMPUTE CP-CALC-PREMIUM ROUNDED =
  2931                        (CP-ORIGINAL-BENEFIT * CP-LOAN-TERM *
  2932                        WK-S) / 100
  2933                      END-IF
  2934                    END-IF
  2935                 END-IF
  2936              END-IF
  2937           END-IF
  2938           MOVE ZEROS            TO CP-RATE-DEV-PCT
  2939        ELSE
  2940           IF CP-BENEFIT-CD (1:1) = 'M'
  2941              COMPUTE CP-CALC-PREMIUM ROUNDED =
  2942                 CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 100
  2943           ELSE
  2944              IF CP-BENEFIT-CD (1:1) = 'N' OR 'H'
  2945                 COMPUTE CP-CALC-PREMIUM ROUNDED =
  2946                    (CP-NET-BENEFIT-AMT *
  2947                    CP-PREMIUM-RATE) / 1000
  2948              ELSE
  2949                 IF CP-AH-BALLOON-SW = 'Y'
  2950                    COMPUTE CP-CALC-PREMIUM ROUNDED =
  2951                      (CP-ORIGINAL-BENEFIT * (CP-LOAN-TERM) *
  2952                      CP-PREMIUM-RATE) / 100
  2953                 ELSE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  56
* ELRATE.cbl
  2954                   COMPUTE CP-CALC-PREMIUM ROUNDED =
  2955                    (CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM *
  2956                    CP-PREMIUM-RATE) / 100
  2957                 END-IF
  2958              END-IF
  2959           END-IF
  2960        END-IF
  2961     END-IF
  2962
  2963     IF (CP-COMPANY-ID = 'DCC')
  2964        AND (CP-BEN-CATEGORY = 'G' OR 'L')
  2965        COMPUTE CP-CALC-PREMIUM = CP-PREMIUM-RATE * +1000
  2966     END-IF
  2967     IF CP-TERM-OR-EXT-DAYS = ZEROS
  2968         GO TO 9999-CALC-RATE-PREM-X.
  2969
  2970     IF CP-EXT-CHG-AH OR CP-EXT-CHG-LF-AH
  2971         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2972             CP-CALC-PREMIUM +
  2973                 (((CP-CALC-PREMIUM / CP-ORIGINAL-TERM) / 30)
  2974                                       * CP-TERM-OR-EXT-DAYS).
  2975
  2976     GO TO 9999-CALC-RATE-PREM-X.
  2977
  2978 2200-CRITICAL-PERIOD-AH-CONT.
  2979
  2980     IF CP-COMPANY-ID = 'WDS'
  2981         IF CP-ORIGINAL-TERM GREATER THAN 60
  2982             MOVE 60              TO CP-LOAN-TERM.
  2983
  2984     IF CP-COMPANY-ID EQUAL 'CVL'
  2985         COMPUTE CP-CALC-PREMIUM ROUNDED =
  2986           ((CP-ORIGINAL-BENEFIT * CP-CRITICAL-MONTHS) / +100)
  2987                                       * CP-PREMIUM-RATE
  2988         GO TO 9999-CALC-RATE-PREM-X.
  2989
  2990     COMPUTE CP-CALC-PREMIUM ROUNDED =
  2991           ((CP-ORIGINAL-BENEFIT * CP-ORIGINAL-TERM) / +100)
  2992                                       * CP-PREMIUM-RATE.
  2993
  2994     GO TO 9999-CALC-RATE-PREM-X.
  2995
  2996 2250-CSL-CALC.
  2997
  2998     IF RT-DAILY-RATE NOT NUMERIC OR
  2999        RT-DAILY-RATE = ZEROS
  3000            MOVE ZEROS TO CP-CALC-PREMIUM
  3001            MOVE '7' TO CP-RETURN-CODE
  3002            GO TO 9999-CALC-RATE-PREM-X.
  3003
  3004     COMPUTE WK-DAILY-RATE = RT-DAILY-RATE / 100.
  3005     COMPUTE WK-MONTHLY-RATE =
  3006          RT-AH-RATE (CP-ORIGINAL-TERM) / 100.
  3007
  3008     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3009     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-2.
  3010     MOVE '1' TO DC-OPTION-CODE.
  3011     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  57
* ELRATE.cbl
  3012     IF DATE-CONVERSION-ERROR
  3013         MOVE '2' TO CP-RETURN-CODE
  3014         GO TO 9999-CALC-RATE-PREM-X.
  3015
  3016     MOVE CP-REMAINING-BENEFIT TO WK-PAY-AMT.
  3017     IF CP-CSL-METH-1
  3018         GO TO 2250-CSL-CALC-AH-1.
  3019     IF CP-CSL-METH-2
  3020         GO TO 2250-CSL-CALC-AH-2.
  3021     IF CP-CSL-METH-3
  3022         IF WK-PAY-AMT GREATER THAN WS-MAX-MON-BEN
  3023             GO TO 2250-CSL-CALC-AH-4
  3024         ELSE
  3025             GO TO 2250-CSL-CALC-AH-3.
  3026
  3027 2250-CSL-CALC-AH-1.
  3028
  3029     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3030     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3031                    + WK-MONTHLY-RATE.
  3032     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-MONTHLY-PAYMENT *
  3033                    CP-ORIGINAL-TERM * WK-D.
  3034
  3035     GO TO 9999-CALC-RATE-PREM-X.
  3036
  3037
  3038 2250-CSL-CALC-AH-2.
  3039     COMPUTE WK-D = DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365.
  3040     COMPUTE WK-D = (((WK-D - 1) * (365 / 12)) * WK-DAILY-RATE)
  3041                    + WK-MONTHLY-RATE.
  3042     COMPUTE CP-CALC-PREMIUM ROUNDED = WS-MAX-MON-BEN *
  3043                    CP-ORIGINAL-TERM * WK-D.
  3044
  3045     GO TO 9999-CALC-RATE-PREM-X.
  3046
  3047 2250-CSL-CALC-AH-3.
  3048
  3049     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3050     COMPUTE WK-T = WK-K + 1.
  3051     COMPUTE WK-MONTHLY-RATE-T =
  3052          RT-AH-RATE (WK-T) / 100.
  3053     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3054
  3055     COMPUTE WK-T1 = WK-K * (CP-ORIGINAL-TERM - WK-T).
  3056     IF WK-T1 EQUAL ZEROS
  3057         MOVE ZEROS TO CP-CALC-PREMIUM
  3058         MOVE 'G' TO CP-RETURN-CODE
  3059         GO TO 9999-CALC-RATE-PREM-X.
  3060
  3061     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3062                    WK-MONTHLY-RATE)) / (WK-K * (CP-ORIGINAL-TERM
  3063                    - WK-T)).
  3064     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3065     COMPUTE WK-PREM = ((CP-ORIGINAL-TERM -
  3066                       (WK-K + 1) + (WK-D - 1))) * (WK-C *
  3067                       WS-MAX-TOT-BEN).
  3068     COMPUTE CP-CALC-PREMIUM ROUNDED = (WK-PAY-AMT * (WK-K + 1) *
  3069                    WK-MONTHLY-RATE-T) + WK-PREM.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  58
* ELRATE.cbl
  3070
  3071     GO TO 9999-CALC-RATE-PREM-X.
  3072
  3073 2250-CSL-CALC-AH-4.
  3074     COMPUTE WK-K = WS-MAX-TOT-BEN / WK-PAY-AMT.
  3075     COMPUTE WK-J = WS-MAX-TOT-BEN / WS-MAX-MON-BEN.
  3076     COMPUTE WK-MONTHLY-RATE-J =
  3077          RT-AH-RATE (WK-J) / 100.
  3078     COMPUTE WK-T = WK-J + 1.
  3079     COMPUTE WK-MONTHLY-RATE-T =
  3080          RT-AH-RATE (WK-T) / 100.
  3081     COMPUTE WK-C = (CP-ORIGINAL-TERM - (WK-T * 2) + 1).
  3082     COMPUTE WK-C = ((WK-C * WK-MONTHLY-RATE-T) + ((WK-T - 1) *
  3083                    WK-MONTHLY-RATE)) / ((WK-T - 1) *
  3084                    (CP-ORIGINAL-TERM - WK-T)).
  3085     COMPUTE WK-D = (DC-ELAPSED-DAYS * CP-PAY-FREQUENCY / 365)
  3086     COMPUTE WK-PREM = (CP-ORIGINAL-TERM -
  3087                       (WK-J + 1) + (WK-D - 1)) * (WK-C *
  3088                       WS-MAX-TOT-BEN).
  3089     COMPUTE CP-CALC-PREMIUM ROUNDED = WK-PREM + ((WK-J + 1) *
  3090                   (WS-MAX-MON-BEN * WK-MONTHLY-RATE-T)).
  3091
  3092     GO TO 9999-CALC-RATE-PREM-X.
  3093
  3094 2300-CALC-DCC-BEN-P-AH.
  3095     IF CP-NO-OF-PMTS NOT NUMERIC
  3096        MOVE +0                  TO CP-NO-OF-PMTS
  3097     END-IF
  3098     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  3099        AND ' ' AND 'M'
  3100        MOVE ' '                 TO CP-PMT-MODE
  3101     END-IF
  3102     EVALUATE CP-PMT-MODE
  3103        WHEN 'W'
  3104           MOVE +7               TO C-DAYS-IN-PMT-PER
  3105           MOVE +52              TO C-PMTS-PER-YEAR
  3106           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3107        WHEN 'B'
  3108           MOVE +14              TO C-DAYS-IN-PMT-PER
  3109           MOVE +26              TO C-PMTS-PER-YEAR
  3110           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3111        WHEN OTHER
  3112           MOVE +30              TO C-DAYS-IN-PMT-PER
  3113           MOVE +12              TO C-PMTS-PER-YEAR
  3114           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  3115     END-EVALUATE
  3116     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3117     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3118        C-DAYS-IN-PMT-PER)) / (1 + I)
  3119     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  3120     COMPUTE ANGLEN-1 = ANGLEN / Y
  3121     COMPUTE WK3 = CP-NET-BENEFIT-AMT / ANGLEN-1
  3122     if cp-net-benefit-amt = zeros
  3123        compute wk3 = cp-original-benefit - cp-original-premium
  3124     end-if
  3125     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * WK-S
  3126     GO TO 9999-CALC-RATE-PREM-X
  3127     .
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  59
* ELRATE.cbl
  3128 2300-CALC-DCC-MOB-NET-AH.
  3129     IF CP-ALTERNATE-BENEFIT = ZEROS
  3130        CONTINUE
  3131     ELSE
  3132        GO TO 2300-CALC-DCC-MOB-BAL-AH
  3133     END-IF
  3134     MOVE CP-ORIGINAL-TERM       TO M
  3135     MOVE CP-LOAN-TERM           TO N
  3136     IF N = ZEROS
  3137        MOVE M                   TO N
  3138     END-IF
  3139     COMPUTE I = CP-LOAN-APR / +1200
  3140     IF CP-BENEFIT-CD (1:1) = 'S'
  3141        COMPUTE OD = CP-DAYS-TO-1ST-PMT - 30
  3142        COMPUTE WK3 = CP-ORIGINAL-BENEFIT *
  3143        ((M * (M + 1) / 2) + (M * OD / 30)) *
  3144          (WK-S / 1000)
  3145          * 1
  3146        MOVE WK3                 TO CP-CALC-PREMIUM
  3147        GO TO 9999-CALC-RATE-PREM-X
  3148     END-IF
  3149     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3150        / (1 + I)
  3151     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3152          ** ((N - M) * -1))) / I)
  3153     COMPUTE ANGLEN-M = ANGLEN-M / OD
  3154     COMPUTE J = I + (WK-S / +1000)
  3155     COMPUTE WK2 = (1 + J) ** (M * -1)
  3156     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3157     COMPUTE ANGLEM = ((1 - ((1 + J)
  3158          ** (M * -1))) / J) / OD
  3159     IF CP-NET-BENEFIT-AMT = ZEROS
  3160        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3161           * ANGLEM
  3162     END-IF
  3163     COMPUTE RA = CP-NET-BENEFIT-AMT / (ANGLEM + ANGLEN-M)
  3164     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3165          ** ((N - M) * -1))) / I)
  3166     MOVE +0                     TO WK3
  3167     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3168        (WS-COUNTER > M)
  3169        COMPUTE ANGLEM = (1 - ((1 + J)
  3170          ** ((M - WS-COUNTER + 1) * -1))) / J
  3171        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  3172        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  3173        COMPUTE WK3 = WK3 + (WK5-CSL * WK-S / +1000)
  3174     END-PERFORM
  3175     MOVE WK3                    TO CP-CALC-PREMIUM
  3176     GO TO 9999-CALC-RATE-PREM-X
  3177     .
  3178 2300-CALC-DCC-MOB-BAL-AH.
  3179     IF CP-BENEFIT-CD (1:1) = 'S'
  3180        GO TO 2300-CALC-DCC-MOB-BAL-AHSUM
  3181     END-IF
  3182     MOVE CP-ORIGINAL-TERM       TO M
  3183     MOVE CP-LOAN-TERM           TO N
  3184     IF N = ZEROS
  3185        MOVE M                   TO N
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  60
* ELRATE.cbl
  3186     END-IF
  3187     COMPUTE I = CP-LOAN-APR / +1200
  3188     COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  3189        / (1 + I)
  3190     COMPUTE ANGLEN-M = (WK5 / I) / OD
  3191     COMPUTE J = I + (WK-S / +1000)
  3192     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  3193     MOVE I TO K
  3194     COMPUTE WK2 = (1 + J) ** (M * -1)
  3195     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  3196     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  3197          ** ((M - 1) * -1))) / J)
  3198     COMPUTE ANGLEM = ((1 - ((1 + J)
  3199          ** (M * -1))) / J) / OD
  3200     IF CP-NET-BENEFIT-AMT = ZEROS
  3201        COMPUTE CP-NET-BENEFIT-AMT = CP-ORIGINAL-BENEFIT
  3202           * ANGLEM
  3203     END-IF
  3204     COMPUTE RA = (CP-NET-BENEFIT-AMT * OD -
  3205        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  3206        / ANGLEM-1
  3207     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  3208          ** ((N - M) * -1))) / I)
  3209     MOVE +0                     TO WK3
  3210     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  3211        (WS-COUNTER > M)
  3212        COMPUTE ANGLEM = (1 - ((1 + J)
  3213          ** ((M - WS-COUNTER) * -1))) / J
  3214        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  3215        COMPUTE WK5-CSL = (RA * ANGLEM)
  3216        + (CP-ALTERNATE-BENEFIT * WK2)
  3217        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  3218          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  3219          (WK-S / 1000)
  3220     END-PERFORM
  3221     MOVE WK3                    TO CP-CALC-PREMIUM
  3222     GO TO 9999-CALC-RATE-PREM-X
  3223     .
  3224 2300-CALC-DCC-MOB-BAL-AHSUM.
  3225     MOVE CP-ORIGINAL-TERM       TO M
  3226     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3227        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  3228        * WK-S / 1000
  3229*    COMPUTE WK3 = CP-ORIGINAL-BENEFIT * ((M - 1) * M / 2
  3230*       + (M - 1) * ((CP-TERM-OR-EXT-DAYS + 30) - 30) / 30)
  3231*       * WK-S / 1000
  3232     MOVE WK3                    TO CP-CALC-PREMIUM
  3233     GO TO 9999-CALC-RATE-PREM-X
  3234     .
  3235 9999-RATE-NOTFND.
  3236     MOVE '6'                    TO CP-RETURN-CODE.
  3237     GO TO 9999-CALC-RATE-PREM-X.
  3238
  3239 9999-RATE-NOTOPEN.
  3240     MOVE 'D'                    TO CP-RETURN-CODE.
  3241     GO TO 9999-CALC-RATE-PREM-X.
  3242
  3243 9999-CALC-RATE-PREM-X.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  61
* ELRATE.cbl
  3244     IF (CP-COMPANY-ID = 'DCC')
  3245        AND (CP-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
  3246        CONTINUE
  3247     ELSE
  3248        IF CP-RATE-DEV-PCT NOT = ZERO
  3249           COMPUTE CP-CALC-PREMIUM =
  3250              CP-CALC-PREMIUM * CP-RATE-DEV-PCT.
  3251
  3252
  3253     MOVE CALCULATION-PASS-AREA  TO  DFHCOMMAREA.
  3254
  3255     IF WS-BROWSE-STARTED
  3256
  3257* EXEC CICS ENDBR
  3258*            DATASET  (ERRATE-FILE-ID)
  3259*       END-EXEC.
  3260     MOVE 0
  3261       TO DFHEIV11
  3262*    MOVE '&2                    $   #00003209' TO DFHEIV0
  3263     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3264     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3265     MOVE X'2020233030303033323039' TO DFHEIV0(25:11)
  3266     CALL 'kxdfhei1' USING DFHEIV0,
  3267           ERRATE-FILE-ID,
  3268           DFHEIV11,
  3269           DFHEIV99
  3270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3271
  3272
  3273
  3274* EXEC CICS RETURN
  3275*    END-EXEC.
  3276*    MOVE '.(                    &   #00003213' TO DFHEIV0
  3277     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3278     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3279     MOVE X'2020233030303033323133' TO DFHEIV0(25:11)
  3280     CALL 'kxdfhei1' USING DFHEIV0,
  3281           DFHEIV99,
  3282           DFHEIV99,
  3283           DFHEIV99,
  3284           DFHEIV99,
  3285           DFHEIV99
  3286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3287
  3288
  3289 9100-CONVERT-DATE.
  3290
  3291* EXEC CICS LINK
  3292*        PROGRAM  ('ELDATCV')
  3293*        COMMAREA (DATE-CONVERSION-DATA)
  3294*        LENGTH   (DC-COMM-LENGTH)
  3295*    END-EXEC.
  3296     MOVE 'ELDATCV' TO DFHEIV1
  3297*    MOVE '."C                   ''   #00003217' TO DFHEIV0
  3298     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3299     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3300     MOVE X'2020233030303033323137' TO DFHEIV0(25:11)
  3301     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  62
* ELRATE.cbl
  3302           DFHEIV1,
  3303           DATE-CONVERSION-DATA,
  3304           DC-COMM-LENGTH,
  3305           DFHEIV99,
  3306           DFHEIV99,
  3307           DFHEIV99
  3308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3309
  3310
  3311 9100-EXIT.
  3312     EXIT.
  3313
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  63
* ELRATE.cbl
  3315 10000-NET-TERM SECTION.
  3316*                         COPY ERCNETP.
  3317*****************************************************************
  3318*                                                               *
  3319*                            ERCNETP                            *
  3320*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3321*                            VMOD=2.029                         *
  3322*                                                               *
  3323*****************************************************************.
  3324*
  3325*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS
  3326*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)
  3327*                                   ORIGINAL TERM (S999)
  3328*                                   REMAINING TERM (S999)
  3329*                                   NET PAY OPTION (X)
  3330*                                   LOAN TERM (S999)
  3331*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))
  3332*
  3333*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING
  3334*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,
  3335*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT
  3336*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE
  3337*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE
  3338*    CHARGED.
  3339*
  3340*    OPTIONS - S = NET SIMPLE
  3341*          SPACE = NET PAY  (1 MO. INTEREST)
  3342*              A = NET PAY  (0 MO. INTEREST)
  3343*              I = NET PAY  (2 MO. INTEREST)
  3344*              J = NET PAY  (3 MO. INTEREST)
  3345*              K = NET PAY  (4 MO. INTEREST)
  3346*              T = TRUNCATED  (0 MO. INTEREST)
  3347*              U = TRUNCATED  (1 MO. INTEREST)
  3348*              V = TRUNCATED  (2 MO. INTEREST)
  3349*              W = TRUNCATED  (3 MO. INTEREST)
  3350*              X = TRUNCATED  (4 MO. INTEREST)
  3351*              R = REFUNDS (REGULAR OR TRUNCATED)
  3352******************************************************************
  3353*                   C H A N G E   L O G
  3354*
  3355* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3356*-----------------------------------------------------------------
  3357*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3358* EFFECTIVE    NUMBER
  3359*-----------------------------------------------------------------
  3360* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  3361* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  3362* 120403                   PEMA  ADD SPECIAL TX CALC
  3363* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3364* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3365* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  3366* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  3367* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  3368* 021207                   PEMA  ADD PA NP
  3369* 022107                   PEMA  ADD NH NP AND NP TRUNC
  3370* 032807                   PEMA  ADD VT NP PLUS 2
  3371* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  3372* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  64
* ELRATE.cbl
  3373* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  3374* 110207      TO 'AL' NET PAY CALC
  3375* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  3376* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  3377* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  3378* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  3379* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  3380* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  3381* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  3382* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3383* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  3384* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3385* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  3386******************************************************************
  3387
  3388     MOVE N-P-APR     TO ANNUAL-INT-RATE.
  3389     MOVE N-P-ORIG    TO ORIGINAL-TERM.
  3390     MOVE N-P-LOAN    TO LOAN-TERM.
  3391     MOVE N-P-REM     TO REMAINING-TERM.
  3392     MOVE N-P-OPT     TO OPTION-SW.
  3393
  3394     MOVE +0 TO FACTOR.
  3395
  3396     IF ANNUAL-INT-RATE = ZERO
  3397         GO TO 99000-ERROR.
  3398     IF ORIGINAL-TERM = ZERO
  3399         GO TO 99999-RETURN.
  3400     IF REMAINING-TERM = ZERO
  3401         GO TO 99999-RETURN.
  3402     IF REMAINING-TERM GREATER ORIGINAL-TERM
  3403         GO TO 99000-ERROR.
  3404     IF LOAN-TERM = ZERO
  3405         GO TO 99999-RETURN.
  3406     IF LOAN-TERM LESS ORIGINAL-TERM
  3407         GO TO 99000-ERROR.
  3408
  3409*    IF ANNUAL-INT-RATE LESS +2
  3410*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3411*    IF ANNUAL-INT-RATE LESS +2
  3412*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3413*    IF ANNUAL-INT-RATE LESS +2
  3414*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.
  3415
  3416     IF NPO-REFUND
  3417         MOVE '2' TO NP-PROCESS-SW
  3418       ELSE
  3419         IF ORIGINAL-TERM = REMAINING-TERM
  3420            MOVE '1'   TO NP-PROCESS-SW
  3421           ELSE
  3422            MOVE '3'   TO NP-PROCESS-SW.
  3423
  3424     IF NPO-SIMPLE
  3425         MOVE 'S' TO TYPE-SW
  3426     ELSE
  3427         MOVE 'N' TO TYPE-SW.
  3428
  3429     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.
  3430
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  65
* ELRATE.cbl
  3431     COMPUTE V ROUNDED = K1 / (K1 + I).
  3432
  3433     MOVE V     TO VX
  3434                   SV.
  3435
  3436     MOVE +1    TO X1
  3437                   SX.
  3438
  3439     MOVE LOAN-TERM TO MAX-X.
  3440
  3441     COMPUTE X2 = MAX-X - ORIGINAL-TERM.
  3442
  3443     IF MAX-X = +1
  3444        GO TO 10700-COMPUTE-REMAINING-FACTOR.
  3445
  3446     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.
  3447
  3448     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  3449         OR 'DCC'        OR 'NCL') AND
  3450        (NOT NP-REFUND)
  3451        NEXT SENTENCE
  3452     ELSE
  3453     IF LOAN-TERM NOT = ORIGINAL-TERM
  3454        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.
  3455
  3456     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.
  3457
  3458 10500-VX-LOOP.
  3459
  3460***  VX = AMORT. LOAN TERM.
  3461***  SV = AMORT. INSURANCE TERM.
  3462***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.
  3463***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED.
  3464***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)
  3465
  3466     IF X2 = 1
  3467        MOVE V         TO SX
  3468     END-IF
  3469     COMPUTE VX ROUNDED = VX * V.
  3470
  3471     ADD B1 TO X1.
  3472
  3473     IF X1 = REMAINING-TERM
  3474          MOVE VX    TO SV.
  3475
  3476     IF X1 EQUAL SV-MINUS-ONE
  3477        MOVE VX      TO SV-MINUS-ONE.
  3478
  3479     IF X1 = X2
  3480          MOVE VX    TO SX.
  3481
  3482     IF X1 NOT = MAX-X
  3483          GO TO 10500-VX-LOOP.
  3484
  3485 10700-COMPUTE-REMAINING-FACTOR.
  3486*****  WK1 = LOAN TERM AMORT
  3487     COMPUTE WK1 = K1 - VX.
  3488*****  WK2 = INS TERM AMORT
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  66
* ELRATE.cbl
  3489     COMPUTE WK2 = K1 - SV.
  3490*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  3491     COMPUTE WK5 = K1 - SX.
  3492*****  WK6 = INS TERM - 1
  3493     COMPUTE WK6 = K1 - SV-MINUS-ONE.
  3494
  3495     IF NP-RATING
  3496         GO TO 12000-PREMIUM-RATE.
  3497
  3498     IF NP-REFUND
  3499         GO TO 11000-REFUND-CALC.
  3500
  3501     IF NET-STD
  3502         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.
  3503
  3504     IF NET-SMP
  3505         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)
  3506         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)
  3507         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)
  3508         COMPUTE WK3 ROUNDED = WK3 * 1000.
  3509
  3510     IF REMAINING-TERM LESS THAN X2
  3511         MOVE +0 TO WK3.
  3512
  3513     MOVE WK3 TO FACTOR.
  3514
  3515     GO TO 99999-RETURN.
  3516
  3517 11000-REFUND-CALC.
  3518     IF REMAINING-TERM NOT LESS MAX-X
  3519        MOVE +1 TO FACTOR
  3520        GO TO 99999-RETURN.
  3521
  3522     IF REMAINING-TERM LESS +1
  3523        MOVE 0 TO FACTOR
  3524        GO TO 99999-RETURN.
  3525
  3526     COMPUTE WK2 ROUNDED = WK2 / I.
  3527     COMPUTE WK5 ROUNDED = WK5 / I.
  3528     COMPUTE WK1 ROUNDED = WK1 / I.
  3529
  3530     IF (CP-COMPANY-ID EQUAL 'CID')
  3531        AND (CP-STATE-STD-ABBRV = 'MN')
  3532        AND (CP-CERT-EFF-DT > X'A4FF')
  3533        AND (CP-RATE-AS-REG-BALLOON)
  3534        AND (CP-EARN-AS-NET-PAY)
  3535        AND (CP-DEVIATION-CODE NOT = 'LEV')
  3536        CONTINUE
  3537     ELSE
  3538        GO TO 11000-CHECK-MN-LEV-BALLOON
  3539     END-IF
  3540
  3541     COMPUTE R = M - E
  3542     COMPUTE FACTOR = (R - WK2 + WK5) /
  3543        (M - WK1 + WK5)
  3544
  3545     GO TO 99999-RETURN
  3546
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  67
* ELRATE.cbl
  3547      .
  3548 11000-CHECK-MN-LEV-BALLOON.
  3549
  3550     IF (CP-COMPANY-ID EQUAL 'CID')
  3551        AND (CP-STATE-STD-ABBRV = 'MN')
  3552        AND (CP-CERT-EFF-DT > X'A4FF')
  3553        AND (CP-RATE-AS-REG-BALLOON)
  3554        AND (CP-EARN-AS-NET-PAY)
  3555        AND (CP-DEVIATION-CODE = 'LEV')
  3556        CONTINUE
  3557     ELSE
  3558        GO TO 11000-CONTINUE-REFUND
  3559     END-IF
  3560
  3561     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3562     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  3563        ** (M - E)) / I
  3564
  3565     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  3566
  3567     GO TO 99999-RETURN
  3568
  3569     .
  3570 11000-CONTINUE-REFUND.
  3571*    IF CP-GAP-ACTUARIAL
  3572*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  3573*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3574*       COMPUTE WK3 = WK2 / ANGLEN
  3575*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  3576     IF CP-GAP-ACTUARIAL
  3577        COMPUTE ANGLEN = WK1 / ((1 + I) **
  3578           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  3579        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  3580     ELSE
  3581        COMPUTE WK3 ROUNDED =
  3582          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  3583     END-IF
  3584
  3585     MOVE WK3  TO FACTOR.
  3586
  3587     GO TO 99999-RETURN.
  3588
  3589 12000-PREMIUM-RATE.
  3590*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST
  3591*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I
  3592*      OPTION - A OR T           = 0 MO,  SO K-I = 1
  3593*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I
  3594*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I
  3595*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I
  3596
  3597     COMPUTE K-I = K1 + I.
  3598     MOVE K-I TO ONE-PLUS-I.
  3599
  3600     IF NPO-ALT OR NPO-TRUNC-0
  3601         MOVE K1 TO K-I.
  3602
  3603     IF NPO-2MO OR NPO-TRUNC-2
  3604         COMPUTE K-I = K1 + (2 * I).
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  68
* ELRATE.cbl
  3605
  3606     IF NPO-3MO OR NPO-TRUNC-3
  3607         COMPUTE K-I = K1 + (3 * I).
  3608
  3609     IF NPO-4MO OR NPO-TRUNC-4
  3610         COMPUTE K-I = K1 + (4 * I).
  3611
  3612     COMPUTE RA ROUNDED = 1 -
  3613             ((X2 * (X2 + 1)) /
  3614              (N *  (N  + 1))).
  3615
  3616     IF (CP-COMPANY-ID EQUAL 'CSL') AND
  3617        (CP-CSL-VALID-NP-BENEFIT-CD)
  3618        NEXT SENTENCE
  3619     ELSE
  3620        GO TO XXXX-CHECK-DISCOUNT-5.
  3621
  3622     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  3623     MOVE ' ' TO DC-OPTION-CODE.
  3624     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3625
  3626     IF DATE-CONVERSION-ERROR
  3627        MOVE '2'                 TO CP-RETURN-CODE
  3628        MOVE ZEROS               TO FACTOR
  3629                                    CP-CALC-PREMIUM
  3630         GO TO 99999-RETURN.
  3631
  3632     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE
  3633     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1
  3634     MOVE ' ' TO DC-OPTION-CODE
  3635     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  3636
  3637     IF DATE-CONVERSION-ERROR
  3638        MOVE '2'                 TO CP-RETURN-CODE
  3639        MOVE ZEROS               TO FACTOR
  3640                                    CP-CALC-PREMIUM
  3641         GO TO 99999-RETURN.
  3642
  3643     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.
  3644
  3645     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).
  3646
  3647     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30
  3648        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *
  3649        CP-PAY-FREQUENCY / 365) * I
  3650     ELSE
  3651        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *
  3652        CP-PAY-FREQUENCY / 365) * I.
  3653
  3654     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /
  3655     13).
  3656
  3657     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *
  3658     (N - ( ANGLEN-1 / WK3)).
  3659
  3660     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.
  3661
  3662     COMPUTE WS-CALC-FREQ-RATE EQUAL
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  69
* ELRATE.cbl
  3663       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.
  3664
  3665     COMPUTE WS-Y-X-FACTOR EQUAL
  3666       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /
  3667       WS-CALC-FREQ-RATE).
  3668
  3669     COMPUTE WS-ODD-DAY-UNITS EQUAL
  3670       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.
  3671
  3672     COMPUTE WS-X-Y-FACTOR EQUAL
  3673       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).
  3674
  3675     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *
  3676       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *
  3677       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).
  3678
  3679     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.
  3680
  3681     GO TO 99999-RETURN.
  3682
  3683 XXXX-CHECK-DISCOUNT-5.
  3684
  3685     IF WS-DISCOUNT-OPTION EQUAL '5'
  3686        NEXT SENTENCE
  3687     ELSE
  3688        GO TO 12000-CHECK-CLIENT.
  3689
  3690      COMPUTE ANGLEN EQUAL WK1 / I.
  3691
  3692      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3693
  3694      COMPUTE WK3 EQUAL
  3695        (12 *
  3696        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -
  3697        CP-ORIGINAL-BENEFIT)) /
  3698        APR100.
  3699
  3700     COMPUTE WK3 EQUAL
  3701        (WK3 * CP-PREMIUM-RATE) / +1000.
  3702
  3703     COMPUTE WK3 EQUAL
  3704        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).
  3705
  3706      MOVE WK3 TO CP-CALC-PREMIUM.
  3707
  3708     GO TO 99999-RETURN.
  3709
  3710 12000-CHECK-CLIENT.
  3711
  3712     IF (CP-COMPANY-ID EQUAL 'MON') AND
  3713        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3714        (CP-TRUNCATED-LIFE)
  3715        NEXT SENTENCE
  3716     ELSE
  3717        GO TO 12000-CHECK-NEXT.
  3718
  3719     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3720
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  70
* ELRATE.cbl
  3721     COMPUTE ANGLEN EQUAL WK1 / I.
  3722     COMPUTE ANGLEM EQUAL WK2 / I.
  3723
  3724     COMPUTE FM EQUAL
  3725                    (((ONE-PLUS-I ** M) * I * M) /
  3726                    ((ONE-PLUS-I ** M) - 1))
  3727                    - 1.
  3728
  3729     COMPUTE FN EQUAL
  3730                    (((ONE-PLUS-I ** N) * I * N) /
  3731                    ((ONE-PLUS-I ** N) - 1))
  3732                    - 1.
  3733
  3734     COMPUTE FNM EQUAL
  3735                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /
  3736                    ((ONE-PLUS-I ** (N - M)) - 1))
  3737                    - 1.
  3738
  3739     COMPUTE GR EQUAL
  3740                    (WS-WORK-RATE * ANGLEM * I) /
  3741                    (M - ANGLEM).
  3742
  3743     COMPUTE ODF EQUAL
  3744                     (1 +
  3745                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /
  3746                     360)) /
  3747                     ONE-PLUS-I.
  3748
  3749     COMPUTE OD EQUAL
  3750                    (1 + (ODF * (FN / I - 1))) +
  3751                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).
  3752
  3753     COMPUTE WK3 EQUAL
  3754*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /
  3755                    ((1 + FN) * ODF *
  3756                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /
  3757                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *
  3758                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).
  3759
  3760     COMPUTE TRUNC-PMT EQUAL WK3 / N.
  3761     COMPUTE WK3 EQUAL TRUNC-PMT * N.
  3762
  3763     COMPUTE WK3 EQUAL
  3764                    (WK3 / (ODF * (1 + FN))) -
  3765*                   CP-ORIGINAL-BENEFIT.
  3766                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).
  3767
  3768      MOVE WK3 TO CP-CALC-PREMIUM.
  3769
  3770     GO TO 99999-RETURN.
  3771
  3772 12000-CHECK-NEXT.
  3773
  3774     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'
  3775        NEXT SENTENCE
  3776     ELSE
  3777        GO TO 12000-CHECK-PA-TRUNC.
  3778
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  71
* ELRATE.cbl
  3779      IF WS-WORK-DIS-RATE EQUAL +0
  3780         MOVE '7'                TO CP-RETURN-CODE
  3781         MOVE ZEROS              TO FACTOR
  3782                                    CP-CALC-PREMIUM
  3783         GO TO 99999-RETURN.
  3784
  3785      COMPUTE ANGLEN EQUAL WK1 / I.
  3786
  3787      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.
  3788
  3789      IF WS-WORK-DIS-RATE EQUAL APR100
  3790         ADD .00001 TO APR100.
  3791
  3792      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).
  3793      COMPUTE WK9 EQUAL 12 / (12 + APR100).
  3794
  3795     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3796        / (1 + I)
  3797     COMPUTE ANGLEN-1 = ANGLEN / Y
  3798      IF CP-COMPANY-ID EQUAL 'CDL'
  3799         COMPUTE WK3 EQUAL
  3800
  3801          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *
  3802          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *
  3803
  3804          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3805
  3806          ((WK8 ** N) /
  3807          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3808
  3809          ((WK9 ** N) /
  3810          (APR100 * (APR100 - WS-WORK-DIS-RATE))))
  3811
  3812      ELSE
  3813         COMPUTE WK3 EQUAL
  3814
  3815          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  3816          (12 + WS-WORK-DIS-RATE) * 12) *
  3817
  3818          ((1 / (WS-WORK-DIS-RATE * APR100)) -
  3819
  3820          ((WK8 ** N) /
  3821          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +
  3822
  3823          ((WK9 ** N) /
  3824          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).
  3825
  3826      COMPUTE WK3 EQUAL
  3827          (WK3 * CP-PREMIUM-RATE) / +1000.
  3828
  3829      MOVE WK3 TO CP-CALC-PREMIUM.
  3830
  3831     GO TO 99999-RETURN.
  3832
  3833 12000-CHECK-PA-TRUNC.
  3834
  3835     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3836        (CP-STATE-STD-ABBRV EQUAL 'PA') AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  72
* ELRATE.cbl
  3837        (CP-EARN-AS-NET-PAY) AND
  3838        (CP-TRUNCATED-LIFE)
  3839        NEXT SENTENCE
  3840     ELSE
  3841        GO TO 12000-CHECK-MD-TRUNC.
  3842
  3843     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3844
  3845     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3846     COMPUTE ANGLEN EQUAL WK1 / I.
  3847
  3848     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3849
  3850     COMPUTE WK3 EQUAL
  3851        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *
  3852        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).
  3853
  3854     MOVE WK3 TO CP-CALC-PREMIUM.
  3855
  3856     GO TO 99999-RETURN.
  3857
  3858 12000-CHECK-MD-TRUNC.
  3859
  3860     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3861        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3862        (CP-EARN-AS-NET-PAY) AND
  3863        (CP-TRUNCATED-LIFE)
  3864        NEXT SENTENCE
  3865     ELSE
  3866        GO TO 12000-CHECK-MD.
  3867
  3868     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
  3869
  3870     COMPUTE ANGLEN-M EQUAL WK5 / I.
  3871     COMPUTE ANGLEM EQUAL WK2 / I.
  3872     COMPUTE ANGLEN EQUAL WK1 / I.
  3873
  3874     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  3875
  3876     COMPUTE WK3 EQUAL
  3877        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  3878        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /
  3879        (ANGLEN-1 * (M - ANGLEM))).
  3880
  3881     MOVE WK3 TO CP-CALC-PREMIUM.
  3882
  3883     GO TO 99999-RETURN.
  3884
  3885 12000-CHECK-MD.
  3886
  3887     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  3888        (CP-STATE-STD-ABBRV EQUAL 'MD') AND
  3889        (CP-EARN-AS-NET-PAY)
  3890        NEXT SENTENCE
  3891     ELSE
  3892        GO TO 12000-CHECK-ME-TRUNC.
  3893
  3894     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  73
* ELRATE.cbl
  3895
  3896     COMPUTE WK3 EQUAL
  3897        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.
  3898
  3899     MOVE WK3 TO CP-CALC-PREMIUM.
  3900
  3901     GO TO 99999-RETURN.
  3902
  3903 12000-CHECK-ME-TRUNC.
  3904
  3905     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3906        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3907        AND (CP-EARN-AS-NET-PAY)
  3908        AND (CP-TRUNCATED-LIFE)
  3909        CONTINUE
  3910     ELSE
  3911        GO TO 12000-CHECK-CID-FARMPLAN
  3912     END-IF
  3913
  3914     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3915     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3916     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3917     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3918     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3919     COMPUTE ANGLEN-1 = ANGLEN / Y
  3920     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3921     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3922     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3923     COMPUTE WK3
  3924        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3925        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3926            * (1 / (1.0635 ** (M / 12))))
  3927*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).
  3928*    COMPUTE WK9 EQUAL
  3929*       1 / (1 + (.045 * (N - M) / 24))
  3930*    COMPUTE WK7 EQUAL
  3931*       WS-WORK-RATE * 20 / (M + 1).
  3932*    COMPUTE WK3 EQUAL
  3933*       ((( N - ANGLEN) * WK7 * WK8) /
  3934*       (10 * ANGLEN-1 * I)) -
  3935*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /
  3936*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).
  3937*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  3938*
  3939     MOVE WK3 TO CP-CALC-PREMIUM.
  3940
  3941     GO TO 99999-RETURN.
  3942 12000-CHECK-CID-FARMPLAN.
  3943     IF (CP-COMPANY-ID EQUAL 'CID')
  3944        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3945           OR 'IN' OR 'AZ')
  3946        AND (CP-FARM-PLAN)
  3947        CONTINUE
  3948     ELSE
  3949        GO TO 12000-CHECK-SC-CID
  3950     END-IF
  3951     COMPUTE N = M / CP-PAY-FREQUENCY
  3952     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  74
* ELRATE.cbl
  3953     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3954        ** CP-PAY-FREQUENCY) - 1
  3955     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3956     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3957        ** TI) / WS-WORK-DIS-RATE
  3958     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3959     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3960     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3961        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3962     COMPUTE WK2 = WK2 * (1 + J)
  3963     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3964     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3965     COMPUTE WK3 = WK3 * (1 + J)
  3966     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3967        ** (N - 1))) / J
  3968     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3969        ((N * WK2) - WK5)) + (N * WK1)) *
  3970        (CP-PREMIUM-RATE / 1000)
  3971     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3972     COMPUTE WK6 = (WK7 * GR)
  3973     MOVE WK6 TO CP-CALC-PREMIUM
  3974     GO TO 99999-RETURN
  3975     .
  3976 12000-CHECK-SC-CID.
  3977     IF (CP-COMPANY-ID EQUAL 'CID')
  3978        AND (CP-STATE-STD-ABBRV EQUAL 'SC')
  3979        AND (CP-EARN-AS-NET-PAY)
  3980        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3981        CONTINUE
  3982     ELSE
  3983        GO TO 12000-CHECK-AL-CID
  3984     END-IF
  3985     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3986     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3987     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3988     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3989     COMPUTE ANGLEN-1 = ANGLEN / Y
  3990     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3991        / 12)) / ((M + 1) / 2)
  3992     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3993     COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3994        + 6 * M) * (WK2 / 100) * (1 + I)
  3995     MOVE WK3 TO CP-CALC-PREMIUM
  3996     GO TO 99999-RETURN
  3997     .
  3998 12000-CHECK-AL-CID.
  3999     IF (CP-COMPANY-ID EQUAL 'CID')
  4000        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  4001        AND (CP-EARN-AS-NET-PAY)
  4002        CONTINUE
  4003     ELSE
  4004        GO TO 12000-CHECK-NH-CID
  4005     END-IF
  4006     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4007     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4008     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4009     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4010                   / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  75
* ELRATE.cbl
  4011     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4012     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4013     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  4014        (CP-PREMIUM-RATE / 1000)
  4015     MOVE WK3 TO CP-CALC-PREMIUM
  4016     GO TO 99999-RETURN
  4017     .
  4018 12000-CHECK-NH-CID.
  4019     IF (CP-COMPANY-ID EQUAL 'CID')
  4020        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  4021        AND (CP-EARN-AS-NET-PAY)
  4022        CONTINUE
  4023     ELSE
  4024        GO TO 12000-CHECK-PA-CID
  4025     END-IF
  4026     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4027     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4028     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  4029                   / (1 + I)
  4030     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4031     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4032     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4033        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  4034     MOVE WK3 TO CP-CALC-PREMIUM
  4035     GO TO 99999-RETURN
  4036     .
  4037 12000-CHECK-PA-CID.
  4038     IF (CP-COMPANY-ID EQUAL 'CID')
  4039        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  4040        AND (CP-EARN-AS-NET-PAY)
  4041        CONTINUE
  4042     ELSE
  4043        GO TO 12000-CHECK-ME-CID
  4044     END-IF
  4045
  4046     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4047     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4048     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4049     COMPUTE ANGLEN-1 = ANGLEN / Y
  4050     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  4051     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4052     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  4053     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4054        * WK5
  4055     MOVE WK3 TO CP-CALC-PREMIUM
  4056     GO TO 99999-RETURN
  4057     .
  4058 12000-CHECK-ME-CID.
  4059     IF (CP-COMPANY-ID EQUAL 'CID')
  4060        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  4061        AND (CP-EARN-AS-NET-PAY)
  4062        CONTINUE
  4063     ELSE
  4064        GO TO 12000-CHECK-VT-TRUNC
  4065     END-IF
  4066     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  4067     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4068     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  76
* ELRATE.cbl
  4069     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4070     COMPUTE ANGLEN-1 = ANGLEN / Y
  4071     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4072     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  4073     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  4074        * WK5
  4075     MOVE WK3 TO CP-CALC-PREMIUM
  4076     GO TO 99999-RETURN
  4077     .
  4078 12000-CHECK-VT-TRUNC.
  4079
  4080     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4081        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4082        (CP-EARN-AS-NET-PAY) AND
  4083        (CP-TRUNCATED-LIFE)
  4084        NEXT SENTENCE
  4085     ELSE
  4086        GO TO 12000-CHECK-VT.
  4087
  4088      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4089
  4090      COMPUTE ANGLEN EQUAL WK1 / I.
  4091
  4092      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4093
  4094      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.
  4095      COMPUTE WK9 EQUAL
  4096        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /
  4097        ((.0054 - I) / (1 + I)).
  4098      COMPUTE WK7 EQUAL
  4099        (1 - (1 / 1.0054) ** (M - 1)) / .0054.
  4100      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *
  4101        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).
  4102
  4103      MOVE WK3 TO CP-CALC-PREMIUM.
  4104
  4105     GO TO 99999-RETURN.
  4106
  4107 12000-CHECK-VT.
  4108
  4109     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4110        (CP-STATE-STD-ABBRV EQUAL 'VT') AND
  4111        (CP-EARN-AS-NET-PAY)
  4112        NEXT SENTENCE
  4113     ELSE
  4114        GO TO 12000-CHECK-MINN-WDS.
  4115
  4116      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.
  4117
  4118      COMPUTE ANGLEN EQUAL WK1 / I.
  4119
  4120      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4121
  4122      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /
  4123                        (ANGLEN-1 * I)) *
  4124
  4125                        (((1.0054 ** N - 1) /
  4126                        (1.0054 ** (N - 1) * .0054)) -
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  77
* ELRATE.cbl
  4127
  4128                        ((V * (1 - 1.0054 ** N * VX)) /
  4129                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))).
  4130
  4131      MOVE WK3 TO CP-CALC-PREMIUM.
  4132
  4133     GO TO 99999-RETURN.
  4134
  4135 12000-CHECK-MINN-WDS.
  4136
  4137     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4138        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4139        (CP-EARN-AS-NET-PAY)
  4140        NEXT SENTENCE
  4141     ELSE
  4142        GO TO 12000-CHECK-MINN-BALL-LEV.
  4143
  4144     COMPUTE ANGLEN EQUAL WK1 / I.
  4145     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *
  4146              (N / +12) * (2 / (N + 1)).
  4147     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *
  4148         WK3 * ((N - ANGLEN) / I).
  4149
  4150      MOVE WK3 TO CP-CALC-PREMIUM.
  4151
  4152     GO TO 99999-RETURN.
  4153
  4154 12000-CHECK-MINN-BALL-LEV.
  4155
  4156     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4157        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4158        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4159        (CP-EARN-AS-REG-BALLOON)
  4160        NEXT SENTENCE
  4161     ELSE
  4162        GO TO 12000-CHECK-MINN-BALL.
  4163
  4164     COMPUTE ANGLEN EQUAL WK1 / I.
  4165
  4166     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.
  4167
  4168     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4169        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).
  4170
  4171     MOVE WK3 TO CP-CALC-PREMIUM.
  4172
  4173     GO TO 99999-RETURN.
  4174
  4175 12000-CHECK-MINN-BALL.
  4176
  4177     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4178        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4179        (CP-EARN-AS-REG-BALLOON)
  4180        NEXT SENTENCE
  4181     ELSE
  4182        GO TO 12000-CHECK-CID-MN-BALL.
  4183
  4184     COMPUTE ANGLEN EQUAL WK1 / I.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  78
* ELRATE.cbl
  4185     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4186
  4187     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4188     / +100 * (N - 1) / 12 * 2 / N *
  4189     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).
  4190
  4191      MOVE WK3 TO CP-CALC-PREMIUM.
  4192
  4193     GO TO 99999-RETURN.
  4194
  4195 12000-CHECK-CID-MN-BALL.
  4196     IF (CP-COMPANY-ID EQUAL 'CID')
  4197        AND (CP-STATE-STD-ABBRV = 'MN')
  4198        AND (CP-CERT-EFF-DT > X'A4FF')
  4199        AND (CP-EARN-AS-REG-BALLOON)
  4200        CONTINUE
  4201     ELSE
  4202        GO TO 12000-CHECK-NC-WDS
  4203     END-IF
  4204     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4205     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  4206     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  4207     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  4208     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  4209     COMPUTE V = 1 / (1 + I)
  4210     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4211     COMPUTE Y = (1 + (D * I) / +30)
  4212        / (1 + I)
  4213     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  4214        * CP-PREMIUM-RATE / 1000
  4215*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  4216*       MOVE CP-MONTHLY-PAYMENT  TO GR
  4217*    ELSE
  4218*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  4219*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  4220*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  4221*       DISPLAY ' BALLOON TOP ' WK6
  4222*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  4223*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  4224*          / 100
  4225*       DISPLAY ' BALLOON BOTTOM ' WK7
  4226*       COMPUTE GR = WK6 / WK7
  4227*       DISPLAY ' BALLOON PAYMENT ' GR
  4228*    END-IF
  4229     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  4230     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  4231        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  4232     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  4233     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  4234        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  4235           (CP-ALTERNATE-BENEFIT * (M + 1)))
  4236           * CP-PREMIUM-RATE / 1000
  4237     MOVE WK3                    TO CP-CALC-PREMIUM
  4238     GO TO 99999-RETURN.
  4239     .
  4240 12000-CHECK-NC-WDS.
  4241
  4242     IF (CP-COMPANY-ID EQUAL 'WDS') AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  79
* ELRATE.cbl
  4243        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4244        (CP-EARN-AS-NET-PAY)
  4245        NEXT SENTENCE
  4246     ELSE
  4247        GO TO 12000-CHECK-NC-BALL-LEV.
  4248
  4249     COMPUTE WK4 EQUAL N * (1 + I * 2).
  4250     COMPUTE ANGLEN EQUAL WK1 / I.
  4251     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4252              CP-PREMIUM-RATE / +100 *
  4253              N / +12 * 2 / (N + 1) *
  4254              (WK4 - ANGLEN) / (I * ANGLEN).
  4255
  4256      MOVE WK3 TO CP-CALC-PREMIUM.
  4257
  4258     GO TO 99999-RETURN.
  4259
  4260 12000-CHECK-NC-BALL-LEV.
  4261
  4262     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4263        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4264        (CP-DEVIATION-CODE EQUAL 'LEV') AND
  4265        (CP-EARN-AS-REG-BALLOON)
  4266        NEXT SENTENCE
  4267     ELSE
  4268        GO TO 12000-CHECK-NC-BALL.
  4269
  4270     COMPUTE ANGLEN EQUAL WK1 / I.
  4271
  4272**** VX = 1 / (1 + I)**N.
  4273
  4274     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /
  4275        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).
  4276
  4277     MOVE WK3 TO CP-CALC-PREMIUM.
  4278
  4279     GO TO 99999-RETURN.
  4280
  4281 12000-CHECK-NC-BALL.
  4282
  4283     IF (CP-COMPANY-ID EQUAL 'WDS') AND
  4284        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4285        (CP-EARN-AS-REG-BALLOON)
  4286        NEXT SENTENCE
  4287     ELSE
  4288        GO TO 12000-CHECK-MINN-TRUNC.
  4289
  4290     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).
  4291     COMPUTE ANGLEN EQUAL WK1 / I.
  4292     COMPUTE ANGLEN-1 EQUAL WK6 / I.
  4293**** VX = 1 / (1 + I)**N.
  4294
  4295     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE
  4296     / +100 * (N - 1) / 12 * 2 / N *
  4297     (WK4 - ANGLEN-1) / (I * ANGLEN-1).
  4298
  4299      MOVE WK3 TO CP-CALC-PREMIUM.
  4300
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  80
* ELRATE.cbl
  4301     GO TO 99999-RETURN.
  4302
  4303 12000-CHECK-MINN-TRUNC.
  4304
  4305     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4306        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4307        (M GREATER THAN +63) AND
  4308        (CP-EARN-AS-NET-PAY) AND
  4309        (CP-TRUNCATED-LIFE)
  4310        NEXT SENTENCE
  4311     ELSE
  4312        GO TO 12000-CHECK-MINN.
  4313
  4314      COMPUTE ANGLEN EQUAL WK1 / I.
  4315      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4316
  4317      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4318
  4319      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4320       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4321       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).
  4322
  4323      MOVE WK3 TO CP-CALC-PREMIUM.
  4324
  4325     GO TO 99999-RETURN.
  4326
  4327 12000-CHECK-MINN.
  4328
  4329     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4330        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4331        (M GREATER THAN +63) AND
  4332        (CP-EARN-AS-NET-PAY)
  4333        NEXT SENTENCE
  4334     ELSE
  4335        GO TO 12000-CHECK-MONTANA-TRUNC.
  4336
  4337      COMPUTE ANGLEN EQUAL WK1 / I.
  4338
  4339      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4340
  4341      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4342       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4343       (((N - ANGLEN) / I) + (2 * N)).
  4344
  4345      MOVE WK3 TO CP-CALC-PREMIUM.
  4346
  4347     GO TO 99999-RETURN.
  4348
  4349 12000-CHECK-MONTANA-TRUNC.
  4350
  4351     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4352        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4353        (M GREATER THAN +63) AND
  4354        (CP-EARN-AS-NET-PAY) AND
  4355        (CP-TRUNCATED-LIFE)
  4356        NEXT SENTENCE
  4357     ELSE
  4358        GO TO 12000-CHECK-MONTANA.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  81
* ELRATE.cbl
  4359
  4360      COMPUTE ANGLEN EQUAL WK1 / I.
  4361      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4362
  4363      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4364
  4365      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *
  4366      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4367       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).
  4368
  4369      MOVE WK3 TO CP-CALC-PREMIUM.
  4370
  4371     GO TO 99999-RETURN.
  4372
  4373 12000-CHECK-MONTANA.
  4374
  4375     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4376        (CP-STATE-STD-ABBRV EQUAL 'MT') AND
  4377        (M GREATER THAN +63) AND
  4378        (CP-EARN-AS-NET-PAY)
  4379        NEXT SENTENCE
  4380     ELSE
  4381        GO TO 12001-CONTINUE-NCL-TRUNC.
  4382
  4383      COMPUTE ANGLEN EQUAL WK1 / I.
  4384
  4385      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4386
  4387      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4388       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4389       (((N - ANGLEN) / I) + (4 * N)).
  4390
  4391      MOVE WK3 TO CP-CALC-PREMIUM.
  4392
  4393     GO TO 99999-RETURN.
  4394
  4395 12001-CONTINUE-NCL-TRUNC.
  4396
  4397     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4398        (CP-EARN-AS-NET-PAY) AND
  4399        (CP-TRUNCATED-LIFE)
  4400        NEXT SENTENCE
  4401     ELSE
  4402        GO TO 12001-CONTINUE-NCL.
  4403
  4404      COMPUTE ANGLEN EQUAL WK1 / I.
  4405      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4406
  4407      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4408
  4409      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *
  4410      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /
  4411      (ANGLEN-1 * (N + 1) * I).
  4412
  4413      MOVE WK3 TO CP-CALC-PREMIUM.
  4414
  4415     GO TO 99999-RETURN.
  4416
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  82
* ELRATE.cbl
  4417 12001-CONTINUE-NCL.
  4418
  4419     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4420        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4421        (CP-EARN-AS-NET-PAY)
  4422        GO TO 12001-CHECK-NC-NET-PLUS3.
  4423
  4424     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4425        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4426        (CP-EARN-AS-NET-PAY)
  4427        GO TO 12001-CHECK-CA.
  4428
  4429     IF (CP-COMPANY-ID EQUAL 'NCL') AND
  4430        (CP-EARN-AS-NET-PAY)
  4431        NEXT SENTENCE
  4432     ELSE
  4433        GO TO 12000-CONTINUE-NET.
  4434
  4435      COMPUTE ANGLEN EQUAL WK1 / I.
  4436      MOVE ANGLEN                TO ANGLEN-1.
  4437
  4438      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.
  4439
  4440      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *
  4441       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *
  4442       ((N - ANGLEN) / I).
  4443
  4444      MOVE WK3 TO CP-CALC-PREMIUM.
  4445
  4446     GO TO 99999-RETURN.
  4447
  4448 12000-CONTINUE-NET.
  4449
  4450     IF (CP-COMPANY-ID EQUAL 'TMS') AND
  4451        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND
  4452        (CP-EARN-AS-NET-PAY)
  4453        NEXT SENTENCE
  4454     ELSE
  4455        GO TO 12001-CONTINUE-MINN.
  4456
  4457      COMPUTE ANGLEN EQUAL WK6 / I.
  4458      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).
  4459
  4460      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).
  4461      COMPUTE WK3 EQUAL (M  * WK7) - 1.
  4462      COMPUTE WK3 EQUAL (WK3 / I) *
  4463       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).
  4464
  4465      IF CP-R-MAX-TOT-BEN NOT NUMERIC
  4466         MOVE +0 TO CP-R-MAX-TOT-BEN.
  4467
  4468      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)
  4469
  4470      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND
  4471         (CP-R-MAX-TOT-BEN NOT EQUAL +0)
  4472         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).
  4473
  4474      MOVE WK3 TO CP-CALC-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  83
* ELRATE.cbl
  4475
  4476     GO TO 99999-RETURN.
  4477
  4478 12001-CONTINUE-MINN.
  4479
  4480     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4481        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND
  4482        (CP-TRUNCATED-LIFE)
  4483        NEXT SENTENCE
  4484     ELSE
  4485        GO TO 12001-CHECK-RI-GTL.
  4486
  4487      COMPUTE ANGLEN EQUAL WK1 / I.
  4488      COMPUTE ANGLEM EQUAL WK2 / I.
  4489
  4490      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /
  4491       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE
  4492       * M / 2400) * 1000 + .5) / 1000000.
  4493
  4494      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT
  4495       - CP-ORIGINAL-PREMIUM) / (1 - WK3).
  4496
  4497     GO TO 99999-RETURN.
  4498
  4499 12001-CHECK-RI-GTL.
  4500
  4501     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4502        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4503        (CP-EARN-AS-NET-PAY)
  4504        NEXT SENTENCE
  4505     ELSE
  4506        GO TO 12001-CHECK-RI-LEASE-GTL.
  4507
  4508      COMPUTE ANGLEN EQUAL WK1 / I.
  4509*     COMPUTE ANGLEM EQUAL WK2 / I.
  4510
  4511      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *
  4512               (1 + WS-WORK-DIS-RATE * N).
  4513      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *
  4514         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.
  4515
  4516
  4517     GO TO 99999-RETURN.
  4518
  4519 12001-CHECK-RI-LEASE-GTL.
  4520
  4521     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4522        (CP-STATE-STD-ABBRV EQUAL 'RI') AND
  4523        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4524        NEXT SENTENCE
  4525     ELSE
  4526        GO TO 12001-CHECK-OR-GTL.
  4527
  4528     COMPUTE ANGLEN EQUAL WK1 / I.
  4529
  4530     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *
  4531        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))
  4532                        /
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  84
* ELRATE.cbl
  4533        (1000 * I * (1 + .0021 * N)).
  4534     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +
  4535       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))
  4536                            /
  4537       (1000 * (1 + .0027 * (N + 1))).
  4538
  4539     GO TO 99999-RETURN.
  4540
  4541 12001-CHECK-OR-GTL.
  4542
  4543     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND
  4544        (CP-STATE-STD-ABBRV EQUAL 'OR') AND
  4545        (CP-EARN-AS-NET-PAY)
  4546        NEXT SENTENCE
  4547     ELSE
  4548        GO TO 12001-CHECK-GA-GTL.
  4549
  4550     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4551     COMPUTE ANGLEN EQUAL WK1 / I.
  4552
  4553     IF M LESS THAN +64
  4554        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4555         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))
  4556                   /
  4557         (I * ANGLEN * (N - (N - M) + 1) * 600)
  4558        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT
  4559     ELSE
  4560        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *
  4561        CP-PREMIUM-RATE * (1 + I))
  4562                  /
  4563        (+1000 * I * ANGLEN)
  4564        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.
  4565*    MOVE WK3 TO CP-CALC-PREMIUM.
  4566     GO TO 99999-RETURN.
  4567
  4568 12001-CHECK-GA-GTL.
  4569
  4570     IF (CP-COMPANY-ID EQUAL 'GTL') AND
  4571        (CP-STATE-STD-ABBRV EQUAL 'GA') AND
  4572        (CP-EARN-AS-NET-PAY)
  4573*       (CP-TRUNCATED-LIFE)
  4574        NEXT SENTENCE
  4575     ELSE
  4576        GO TO 12001-CHECK-MA-GTL.
  4577
  4578     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4579     COMPUTE ANGLEN EQUAL WK1 / I.
  4580
  4581     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.
  4582     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *
  4583      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).
  4584     MOVE WK3 TO CP-CALC-PREMIUM.
  4585
  4586     GO TO 99999-RETURN.
  4587
  4588 12001-CHECK-MA-GTL.
  4589
  4590     IF (CP-COMPANY-ID EQUAL 'GTL') AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  85
* ELRATE.cbl
  4591        (CP-STATE-STD-ABBRV EQUAL 'MA') AND
  4592        (CP-EARN-AS-NET-PAY) AND
  4593        (CP-SPECIAL-CALC-CD EQUAL 'H')
  4594        NEXT SENTENCE
  4595     ELSE
  4596        GO TO 12001-CHECK-NV-NET.
  4597
  4598     COMPUTE ANGLEN EQUAL WK1 / I.
  4599
  4600     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *
  4601      CP-ALTERNATE-BENEFIT * N.
  4602
  4603     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /
  4604     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).
  4605
  4606     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *
  4607     WK7 * (N - ANGLEN) / I.
  4608     MOVE WK3 TO CP-CALC-PREMIUM.
  4609
  4610     GO TO 99999-RETURN.
  4611
  4612 12001-CHECK-NV-NET.
  4613     IF (CP-COMPANY-ID EQUAL 'CID')
  4614        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4615        AND (CP-EARN-AS-NET-PAY)
  4616        CONTINUE
  4617     ELSE
  4618        GO TO 12001-CHECK-MN-NET
  4619     END-IF
  4620     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4621     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4622     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4623                   / (1 + I)
  4624     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4625     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4626     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4627        (CP-PREMIUM-RATE * K-I / 1000)
  4628     MOVE WK3                    TO CP-CALC-PREMIUM
  4629     GO TO 99999-RETURN
  4630      .
  4631 12001-CHECK-MN-NET.
  4632     IF (CP-COMPANY-ID EQUAL 'CID')
  4633        AND (CP-STATE-STD-ABBRV = 'MN')
  4634        AND (CP-EARN-AS-NET-PAY)
  4635        AND (NOT CP-LEVEL-LIFE)
  4636        AND (WS-DISCOUNT-OPTION = '1')
  4637        CONTINUE
  4638     ELSE
  4639        GO TO 12001-CHECK-NC-NET
  4640     END-IF
  4641     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4642     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4643     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4644                   / (1 + I)
  4645     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4646     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4647     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4648        (CP-PREMIUM-RATE / 1000) * (1 + I)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  86
* ELRATE.cbl
  4649     MOVE WK3                    TO CP-CALC-PREMIUM
  4650     GO TO 99999-RETURN
  4651      .
  4652 12001-CHECK-NC-NET.
  4653
  4654     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND
  4655        (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4656        (CP-EARN-AS-NET-PAY)
  4657        NEXT SENTENCE
  4658     ELSE
  4659        GO TO 12001-CHECK-NC-NET-PLUS3.
  4660
  4661      COMPUTE ANGLEN EQUAL WK1 / I.
  4662      COMPUTE ANGLEN-M EQUAL WK5 / I.
  4663
  4664      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /
  4665          (ANGLEN - (CP-PREMIUM-RATE / 1000) *
  4666          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -
  4667          N * (CP-PREMIUM-RATE / 1000)).
  4668
  4669      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *
  4670          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).
  4671
  4672      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *
  4673          ((N - ANGLEN) / I + 3) / ANGLEN) /
  4674          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /
  4675          (ANGLEN * 2))
  4676
  4677      COMPUTE WK7 ROUNDED = WK7 * N - 3.
  4678
  4679      IF ANGLEN IS NOT LESS THAN WK7
  4680          COMPUTE CP-PREMIUM-RATE ROUNDED =
  4681              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)
  4682          COMPUTE WK3 ROUNDED =
  4683              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).
  4684
  4685     MOVE WK3 TO CP-CALC-PREMIUM.
  4686
  4687     GO TO 99999-RETURN.
  4688
  4689 12001-CHECK-NC-NET-PLUS3.
  4690
  4691     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4692        (CP-EARN-AS-NET-PAY) AND
  4693        (CP-COMPANY-ID NOT = 'CID' AND 'DCC')
  4694        NEXT SENTENCE
  4695     ELSE
  4696        GO TO 12001-CHECK-CA.
  4697
  4698     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.
  4699     MOVE ' ' TO DC-OPTION-CODE.
  4700     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  4701
  4702     IF DATE-CONVERSION-ERROR
  4703        MOVE '2'                 TO CP-RETURN-CODE
  4704        MOVE ZEROS               TO FACTOR
  4705                                    CP-CALC-PREMIUM
  4706         GO TO 99999-RETURN.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  87
* ELRATE.cbl
  4707
  4708     IF DC-GREG-DATE-CYMD GREATER THAN 19931231
  4709        NEXT SENTENCE
  4710     ELSE
  4711        GO TO 12001-CONTINUE-NET.
  4712
  4713     COMPUTE ANGLEN EQUAL WK1 / I.
  4714     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4715
  4716     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).
  4717
  4718     COMPUTE NC-R = 20 *
  4719                    ((NC-LR * ORIGINAL-TERM) / 12)
  4720                          / (ORIGINAL-TERM + 1).
  4721
  4722     COMPUTE NC-OB = NC-R / 1000.
  4723
  4724     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +
  4725                    (NC-OB * ORIGINAL-TERM * 3).
  4726
  4727     IF CP-EXT-CHG-LF
  4728         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30
  4729     ELSE
  4730         MOVE 30                 TO  NC-BIG-D.
  4731
  4732     COMPUTE NC-LITTLE-D = (1 + I) /
  4733             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).
  4734
  4735     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /
  4736             (ANGLEN * NC-LITTLE-D ).
  4737
  4738     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.
  4739
  4740     GO TO 99999-RETURN.
  4741
  4742 12001-CHECK-CA.
  4743
  4744     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4745        (WS-DISCOUNT-OPTION = '6')
  4746        NEXT SENTENCE
  4747     ELSE
  4748        GO TO 12001-CHECK-GTL-IA.
  4749
  4750     COMPUTE CA-J = CA-DISCOUNT / 12.
  4751     COMPUTE ANGLEN EQUAL WK1 / I.
  4752     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.
  4753     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.
  4754     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.
  4755     COMPUTE CA-VI = (1 + I)** -1.
  4756     COMPUTE CP-CALC-PREMIUM =
  4757         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *
  4758         ((1 + CA-J) / I) *
  4759         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *
  4760         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /
  4761         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).
  4762
  4763     GO TO 99999-RETURN.
  4764
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  88
* ELRATE.cbl
  4765 12001-CHECK-GTL-IA.
  4766
  4767     IF (CP-COMPANY-ID EQUAL 'GTL')     AND
  4768        (CP-STATE-STD-ABBRV EQUAL 'IA') AND
  4769        (CP-EARN-AS-NET-PAY)
  4770        NEXT SENTENCE
  4771     ELSE
  4772        GO TO 12001-CHECK-CID-TRN-VA.
  4773
  4774***************************************************************
  4775
  4776     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.
  4777
  4778     IF GTL-IA-ODD-DAYS = ZEROS
  4779         MOVE ZERO               TO  GTL-IA-SGN
  4780     ELSE
  4781         IF GTL-IA-ODD-DAYS GREATER THAN ZERO
  4782             MOVE +1             TO  GTL-IA-SGN
  4783         ELSE
  4784             MOVE -1             TO  GTL-IA-SGN.
  4785
  4786     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.
  4787     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.
  4788
  4789     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **
  4790                          GTL-IA-SGN.
  4791
  4792     COMPUTE ANGLEN EQUAL WK1 / I.
  4793     COMPUTE ANGLEN-M EQUAL WK5 / I.
  4794
  4795     IF GTL-IA-ODF NOT = ZERO
  4796         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF
  4797         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.
  4798
  4799     COMPUTE GTL-IA-DIVIDEND =
  4800           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -
  4801                             (ANGLEN - ANGLEN-M))) *
  4802           ((K1 + I) * CP-PREMIUM-RATE *
  4803                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).
  4804
  4805     COMPUTE GTL-IA-DIVISOR =
  4806      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.
  4807
  4808     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.
  4809
  4810     COMPUTE CP-CALC-PREMIUM =
  4811                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.
  4812     GO TO 99999-RETURN.
  4813
  4814
  4815 12001-CHECK-CID-TRN-VA.
  4816
  4817     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4818        (CP-STATE-STD-ABBRV EQUAL 'VA') AND
  4819        (CP-EARN-AS-NET-PAY) AND
  4820        (CP-TRUNCATED-LIFE) AND
  4821        (CP-STATE-STD-ABBRV = CP-STATE)
  4822        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  89
* ELRATE.cbl
  4823     ELSE
  4824        GO TO 12001-CHECK-CID-TX
  4825     END-IF
  4826
  4827     COMPUTE ANGLEN EQUAL WK1 / I
  4828     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4829     IF WS-WORK-DIS-RATE = ZEROS
  4830        CONTINUE
  4831     ELSE
  4832        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4833        COMPUTE WK7 = (1 / I) *
  4834              (((WK4 ** M - 1) / (WK4 - 1)) -
  4835              ((WK4 ** M * SX - VX) /
  4836              (WK4 * (1 + I) - 1))) *
  4837              (CP-PREMIUM-RATE / 1000)
  4838        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4839        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4840        COMPUTE CP-CALC-PREMIUM =
  4841           WK8 *  ((WK4 * ANGLEN) / 100)
  4842     END-IF
  4843
  4844     GO TO 99999-RETURN
  4845
  4846     .
  4847
  4848 12001-CHECK-CID-TX.
  4849     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4850        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4851        (CP-EARN-AS-NET-PAY) AND
  4852        (WS-WORK-DIS-RATE > ZEROS) AND
  4853        (CP-STATE-STD-ABBRV = CP-STATE)
  4854        CONTINUE
  4855     ELSE
  4856        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4857     END-IF
  4858* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4859     COMPUTE K-I = 1 + (1 * I)
  4860     COMPUTE ANGLEN EQUAL WK1 / I
  4861     COMPUTE ANGLEM EQUAL WK2 / I
  4862     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4863     IF WS-WORK-DIS-RATE = ZEROS
  4864        CONTINUE
  4865     ELSE
  4866        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4867        COMPUTE WK7 = (K-I / I) *
  4868              (((WK4 ** M - 1) / (WK4 - 1)) -
  4869*             ((WK4 ** M * SX - VX) /
  4870              ((WK4 ** M * SX) - VX) /
  4871*             (WK4 * (1 + I) - 1))) *
  4872              (WK4 * (1 + I) - 1)) *
  4873              (CP-PREMIUM-RATE / 1000)
  4874        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4875        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  4876        COMPUTE CP-CALC-PREMIUM =
  4877           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  4878     END-IF
  4879
  4880     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  90
* ELRATE.cbl
  4881     .
  4882 12001-CHECK-CID-LEV-MN-NEW.
  4883*    IF (CP-COMPANY-ID EQUAL 'CID')
  4884*       AND (CP-STATE-STD-ABBRV = 'MN')
  4885*       AND (CP-EARN-AS-NET-PAY)
  4886*       AND (CP-LEVEL-LIFE)
  4887*       AND (CP-CERT-EFF-DT > X'A4FF')
  4888*       CONTINUE
  4889*    ELSE
  4890*       GO TO 12001-CHECK-CID-LEV-MN
  4891*    END-IF
  4892*
  4893*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4894*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4895*    MOVE '1'                    TO DC-OPTION-CODE
  4896*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4897*
  4898*    IF DATE-CONVERSION-ERROR
  4899*       MOVE '2'                 TO CP-RETURN-CODE
  4900*       MOVE ZEROS               TO FACTOR
  4901*                                   CP-CALC-PREMIUM
  4902*       GO TO 99999-RETURN
  4903*    END-IF
  4904*
  4905*    COMPUTE I = CP-LOAN-APR / 100
  4906*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4907*
  4908*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4909*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4910*      * 12 / 360 * D)
  4911*
  4912*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4913*       * 12 / 360 * D
  4914*
  4915*    GO TO 99999-RETURN
  4916      .
  4917 12001-CHECK-CID-LEV-MN.
  4918
  4919     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4920        (CP-STATE-STD-ABBRV EQUAL 'MN') AND
  4921        (CP-EARN-AS-NET-PAY) AND
  4922        (CP-LEVEL-LIFE) AND
  4923        (CP-STATE-STD-ABBRV = CP-STATE)
  4924        CONTINUE
  4925     ELSE
  4926        GO TO 12001-CHECK-CID-LEV-CA
  4927     END-IF
  4928
  4929     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4930         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4931         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4932
  4933     GO TO 99999-RETURN
  4934
  4935      .
  4936 12001-CHECK-CID-LEV-CA.
  4937
  4938     IF (CP-COMPANY-ID EQUAL 'CID')     AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  91
* ELRATE.cbl
  4939        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4940        (CP-EARN-AS-NET-PAY) AND
  4941        (CP-LEVEL-LIFE) AND
  4942        (CP-STATE-STD-ABBRV = CP-STATE)
  4943        CONTINUE
  4944     ELSE
  4945        GO TO 12001-CHECK-CID-TRN-CA
  4946     END-IF
  4947
  4948     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4949     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4950     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4951     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4952     COMPUTE CP-CALC-PREMIUM =
  4953          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4954          (CP-PREMIUM-RATE / 1000)) /
  4955          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4956
  4957     GO TO 99999-RETURN
  4958
  4959      .
  4960 12001-CHECK-CID-TRN-CA.
  4961
  4962     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4963        (CP-STATE-STD-ABBRV EQUAL 'CA') AND
  4964        (CP-EARN-AS-NET-PAY) AND
  4965        (CP-TRUNCATED-LIFE) AND
  4966        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4967        (WS-DISCOUNT-OPTION NOT = ' ')
  4968        CONTINUE
  4969     ELSE
  4970        GO TO 12001-CHECK-CID-TRN-MT
  4971     END-IF
  4972
  4973     COMPUTE ANGLEN EQUAL WK1 / I
  4974     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4975     IF WS-WORK-DIS-RATE = ZEROS
  4976        CONTINUE
  4977     ELSE
  4978        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4979        COMPUTE WK7 = (1 / I) *
  4980              (((WK4 ** M - 1) / (WK4 - 1)) -
  4981              ((WK4 ** M * SX - VX) /
  4982              (WK4 * (1 + I) - 1))) *
  4983              (CP-PREMIUM-RATE / 1000)
  4984        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4985        COMPUTE CP-CALC-PREMIUM =
  4986           WK4 *  WK7
  4987     END-IF
  4988
  4989     GO TO 99999-RETURN
  4990
  4991      .
  4992 12001-CHECK-CID-TRN-MT.
  4993
  4994     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4995        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4996                   OR
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  92
* ELRATE.cbl
  4997        ((CP-STATE-STD-ABBRV = 'IN') AND
  4998        (CP-CERT-EFF-DT > X'9A7F'))
  4999                   OR
  5000        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  5001        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5002        (CP-EARN-AS-NET-PAY) AND
  5003        (CP-TRUNCATED-LIFE) AND
  5004        (CP-STATE-STD-ABBRV = CP-STATE)
  5005        CONTINUE
  5006     ELSE
  5007        GO TO 12001-CHECK-CID-MT
  5008     END-IF
  5009
  5010* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5011     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5012        MOVE 0                   TO K-I
  5013     ELSE
  5014        MOVE 2                   TO K-I
  5015     END-IF
  5016     COMPUTE CP-TERM-OR-EXT-DAYS =
  5017           CP-TERM-OR-EXT-DAYS + 30
  5018
  5019     COMPUTE ANGLEN EQUAL WK1 / I
  5020     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5021     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5022                   / (1 + I)
  5023     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5024     IF WS-WORK-DIS-RATE = ZEROS
  5025        CONTINUE
  5026     ELSE
  5027        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5028*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5029        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5030              (((WK4 ** M - 1) / (WK4 - 1)) -
  5031              ((WK4 ** M * SX - VX) /
  5032              (WK4 * (1 + I) - 1))) *
  5033              (CP-PREMIUM-RATE / 1000)
  5034        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5035*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5036        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5037        COMPUTE CP-CALC-PREMIUM =
  5038           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5039*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5040     END-IF
  5041
  5042     GO TO 99999-RETURN
  5043
  5044     .
  5045 12001-CHECK-CID-MT.
  5046
  5047     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  5048        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  5049                                OR 'VT')
  5050                   OR
  5051        ((CP-STATE-STD-ABBRV = 'IN') AND
  5052        (CP-CERT-EFF-DT > X'9A7F'))
  5053                   OR
  5054        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  93
* ELRATE.cbl
  5055        (CP-CERT-EFF-DT > X'9ADF'))) AND
  5056        (CP-EARN-AS-NET-PAY) AND
  5057        (CP-STATE-STD-ABBRV = CP-STATE)
  5058        CONTINUE
  5059     ELSE
  5060        GO TO 12001-CHECK-DCC-DD
  5061     END-IF
  5062
  5063     COMPUTE CP-TERM-OR-EXT-DAYS =
  5064           CP-TERM-OR-EXT-DAYS + 30
  5065
  5066* K-I WILL BE USED FOR EXTRA INT. PERIODS
  5067     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  5068        MOVE 0                   TO K-I
  5069     ELSE
  5070        IF CP-STATE-STD-ABBRV = 'NJ'
  5071           MOVE 1                TO K-I
  5072        ELSE
  5073           MOVE 2                TO K-I
  5074        END-IF
  5075     END-IF
  5076     COMPUTE ANGLEN EQUAL WK1 / I
  5077     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  5078     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  5079                   / (1 + I)
  5080     COMPUTE ANGLEN-1 = ANGLEN / WK8
  5081     IF WS-WORK-DIS-RATE = ZEROS
  5082        CONTINUE
  5083     ELSE
  5084        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  5085*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  5086        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  5087              (((WK4 ** N - 1) / (WK4 - 1)) -
  5088              ((WK4 ** N - SV) /
  5089              (WK4 * (1 + I) - 1))) *
  5090              (CP-PREMIUM-RATE / 1000)
  5091        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5092*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  5093        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  5094        COMPUTE CP-CALC-PREMIUM =
  5095           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  5096*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  5097     END-IF
  5098
  5099     GO TO 99999-RETURN
  5100
  5101     .
  5102 12001-CHECK-DCC-DD.
  5103     IF (CP-COMPANY-ID EQUAL 'DCC')
  5104        AND (CP-EARN-AS-NET-PAY)
  5105        AND (CP-BEN-CATEGORY = 'D')
  5106        CONTINUE
  5107     ELSE
  5108        GO TO 12001-CHECK-DCC-NET
  5109     END-IF
  5110
  5111     COMPUTE CP-TERM-OR-EXT-DAYS =
  5112           CP-TERM-OR-EXT-DAYS + 30
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  94
* ELRATE.cbl
  5113
  5114     COMPUTE ANGLEN EQUAL WK1 / I.
  5115     COMPUTE ANGLEM EQUAL WK2 / I.
  5116     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5117
  5118     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5119           / (1 + I)
  5120     COMPUTE GR     = ANGLEN / ODF
  5121*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  5122*      CP-RATE-DEV-PCT
  5123     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5124     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5125       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  5126     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5127     MOVE WK3                    TO CP-CALC-PREMIUM
  5128
  5129     GO TO 99999-RETURN
  5130
  5131     .
  5132 12001-CHECK-DCC-NET.
  5133
  5134     IF (CP-COMPANY-ID EQUAL 'DCC')
  5135        AND (CP-EARN-AS-NET-PAY)
  5136        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  5137             AND 'H' AND 'S' AND 'P')
  5138        CONTINUE
  5139     ELSE
  5140        GO TO 12001-CHECK-DCC-PNET
  5141     END-IF
  5142
  5143     COMPUTE CP-TERM-OR-EXT-DAYS =
  5144           CP-TERM-OR-EXT-DAYS + 30
  5145
  5146     COMPUTE ANGLEN EQUAL WK1 / I.
  5147     COMPUTE ANGLEM EQUAL WK2 / I.
  5148     COMPUTE ANGLEN-M EQUAL WK5 / I.
  5149
  5150     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  5151           / (1 + I)
  5152     COMPUTE GR     = ANGLEN / ODF
  5153     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  5154     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  5155       CP-RATE-DEV-PCT
  5156     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  5157*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  5158
  5159     COMPUTE WK8 = CP-PREMIUM-RATE *
  5160        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  5161     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  5162     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  5163     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  5164       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  5165     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  5166     MOVE WK3                    TO CP-CALC-PREMIUM
  5167
  5168     GO TO 99999-RETURN
  5169
  5170     .
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  95
* ELRATE.cbl
  5171 12001-CHECK-DCC-PNET.
  5172     IF (CP-COMPANY-ID EQUAL 'DCC')
  5173        AND (CP-EARN-AS-NET-PAY)
  5174        AND (CP-BENEFIT-CD (1:1) = 'P')
  5175        CONTINUE
  5176     ELSE
  5177        GO TO 12001-CHECK-DCC-MNET
  5178     END-IF
  5179     IF CP-NO-OF-PMTS NOT NUMERIC
  5180        MOVE +0                  TO CP-NO-OF-PMTS
  5181     END-IF
  5182     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  5183        AND ' ' AND 'M'
  5184        MOVE ' '                 TO CP-PMT-MODE
  5185     END-IF
  5186     EVALUATE CP-PMT-MODE
  5187        WHEN 'W'
  5188           MOVE +7               TO C-DAYS-IN-PMT-PER
  5189           MOVE +52              TO C-PMTS-PER-YEAR
  5190           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  5191        WHEN 'B'
  5192           MOVE +14              TO C-DAYS-IN-PMT-PER
  5193           MOVE +26              TO C-PMTS-PER-YEAR
  5194           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  5195        WHEN OTHER
  5196           MOVE +30              TO C-DAYS-IN-PMT-PER
  5197           MOVE +12              TO C-PMTS-PER-YEAR
  5198           MOVE CP-LOAN-TERM     TO C-TOT-PMTS
  5199     END-EVALUATE
  5200     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  5201     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  5202        C-DAYS-IN-PMT-PER)) / (1 + I)
  5203     COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  5204     COMPUTE ANGLEN-1 = ANGLEN / Y
  5205     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  5206     IF CP-RATE-DEV-PCT NOT = ZEROS
  5207        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5208           CP-PREMIUM-RATE
  5209     END-IF
  5210     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  5211     GO TO 99999-RETURN
  5212     .
  5213 12001-CHECK-DCC-MNET.
  5214
  5215     IF (CP-COMPANY-ID EQUAL 'DCC')
  5216        AND (CP-EARN-AS-NET-PAY)
  5217        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  5218        CONTINUE
  5219     ELSE
  5220        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  5221     END-IF
  5222
  5223*    COMPUTE ANGLEN EQUAL WK1 / I.
  5224*    COMPUTE ANGLEM EQUAL WK2 / I.
  5225*    COMPUTE ANGLEN-M EQUAL WK5 / I.
  5226
  5227     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  5228     MOVE WK3                    TO CP-CALC-PREMIUM
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  96
* ELRATE.cbl
  5229
  5230     GO TO 99999-RETURN
  5231
  5232     .
  5233 12001-CHECK-DCC-MNET-LF-BAL.
  5234
  5235     IF (CP-COMPANY-ID EQUAL 'DCC')
  5236        AND (CP-EARN-AS-NET-PAY)
  5237        AND (CP-BENEFIT-CD (1:1) = 'N')
  5238        AND (CP-BEN-CATEGORY NOT = 'N')
  5239        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5240        CONTINUE
  5241     ELSE
  5242        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  5243     END-IF
  5244
  5245     IF CP-RATE-DEV-PCT NOT = ZEROS
  5246        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5247           CP-PREMIUM-RATE
  5248     END-IF
  5249*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5250     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5251        / (1 + I)
  5252     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5253     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5254     COMPUTE WK2 = (1 + J) ** (M * -1)
  5255     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5256     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5257          ** ((M - 1) * -1))) / J)
  5258     COMPUTE ANGLEM = ((1 - ((1 + J)
  5259          ** (M * -1))) / J) / OD
  5260     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5261        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  5262        / ANGLEM-1
  5263     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5264          ** ((N - M) * -1))) / I)
  5265     MOVE +0                     TO WK3
  5266     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5267        (WS-COUNTER > M)
  5268        COMPUTE ANGLEM = (1 - ((1 + J)
  5269          ** ((M - WS-COUNTER) * -1))) / J
  5270        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5271        COMPUTE WK5-CSL = (RA * ANGLEM)
  5272        + (CP-ALTERNATE-BENEFIT * WK2)
  5273        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5274     END-PERFORM
  5275     MOVE WK3                    TO CP-CALC-PREMIUM
  5276
  5277     GO TO 99999-RETURN
  5278
  5279     .
  5280 12001-CHECK-DCC-MNET-LFSUM-BAL.
  5281
  5282     IF (CP-COMPANY-ID EQUAL 'DCC')
  5283        AND (CP-EARN-AS-NET-PAY)
  5284        AND (CP-BENEFIT-CD (1:1) = 'S')
  5285        AND (CP-BEN-CATEGORY NOT = 'N')
  5286        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  97
* ELRATE.cbl
  5287        CONTINUE
  5288     ELSE
  5289        GO TO 12001-CHECK-DCC-MNET-LF
  5290     END-IF
  5291
  5292     IF CP-RATE-DEV-PCT NOT = ZEROS
  5293        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5294           CP-PREMIUM-RATE
  5295     END-IF
  5296     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5297     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5298          ** ((M - 1) * -1))) / K)
  5299     COMPUTE ANGLEM = ((1 - ((1 + K)
  5300          ** (M * -1))) / K)
  5301     MOVE CP-MONTHLY-PAYMENT     TO RA
  5302     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5303        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  5304        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5305        CP-PREMIUM-RATE / 1000
  5306     MOVE WK3                    TO CP-CALC-PREMIUM
  5307
  5308     GO TO 99999-RETURN
  5309
  5310     .
  5311 12001-CHECK-DCC-MNET-LF.
  5312
  5313     IF (CP-COMPANY-ID EQUAL 'DCC')
  5314        AND (CP-EARN-AS-NET-PAY)
  5315        AND (CP-BENEFIT-CD (1:1) = 'N')
  5316        AND (CP-BEN-CATEGORY NOT = 'N')
  5317        CONTINUE
  5318     ELSE
  5319        GO TO 12001-CHECK-DCC-MNET-SUMLF
  5320     END-IF
  5321
  5322     IF CP-RATE-DEV-PCT NOT = ZEROS
  5323        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5324           CP-PREMIUM-RATE
  5325     END-IF
  5326*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5327     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5328        / (1 + I)
  5329     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5330     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  5331     COMPUTE WK2 = (1 + J) ** (M * -1)
  5332     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5333     COMPUTE ANGLEM = ((1 - ((1 + J)
  5334          ** (M * -1))) / J) / OD
  5335     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5336     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5337          ** ((N - M) * -1))) / I)
  5338     MOVE +0                     TO WK3
  5339     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5340        (WS-COUNTER > M)
  5341        COMPUTE ANGLEM = (1 - ((1 + J)
  5342          ** ((M - WS-COUNTER + 1) * -1))) / J
  5343        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5344        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  98
* ELRATE.cbl
  5345        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  5346     END-PERFORM
  5347     MOVE WK3                    TO CP-CALC-PREMIUM
  5348
  5349     GO TO 99999-RETURN
  5350
  5351     .
  5352 12001-CHECK-DCC-MNET-SUMLF.
  5353
  5354     IF (CP-COMPANY-ID EQUAL 'DCC')
  5355        AND (CP-EARN-AS-NET-PAY)
  5356        AND (CP-BENEFIT-CD (1:1) = 'S')
  5357        AND (CP-BEN-CATEGORY NOT = 'N')
  5358        CONTINUE
  5359     ELSE
  5360        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  5361     END-IF
  5362
  5363     IF CP-RATE-DEV-PCT NOT = ZEROS
  5364        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  5365           CP-PREMIUM-RATE
  5366     END-IF
  5367     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  5368     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5369        / (1 + K)
  5370     COMPUTE ANGLEN-M = (WK5 / I)
  5371     COMPUTE WK2 = (1 + K) ** (M * -1)
  5372     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5373     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5374     COMPUTE ANGLEM = ((1 - ((1 + K)
  5375          ** (M * -1))) / K) / Y
  5376     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5377     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  5378        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5379        - 1)) / K) * RA
  5380     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5381        + (CP-DAYS-TO-1ST-PMT - +30)
  5382        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5383        +0 / 1000 * 12 / 12)
  5384     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  5385        * (12 / 12)
  5386     MOVE WK3                    TO CP-CALC-PREMIUM
  5387
  5388     GO TO 99999-RETURN
  5389
  5390     .
  5391 12001-CHECK-DCC-MNET-TOT-BAL-N.
  5392
  5393     IF (CP-COMPANY-ID EQUAL 'DCC')
  5394        AND (CP-EARN-AS-NET-PAY)
  5395        AND (CP-BENEFIT-CD (1:1) = 'N')
  5396        AND (CP-BEN-CATEGORY = 'N')
  5397        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5398        CONTINUE
  5399     ELSE
  5400        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5401     END-IF
  5402
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page  99
* ELRATE.cbl
  5403*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5404     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5405        / (1 + I)
  5406     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5407     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5408     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5409     COMPUTE WK2 = (1 + J) ** (M * -1)
  5410     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5411     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5412          ** ((M - 1) * -1))) / J)
  5413     COMPUTE ANGLEM = ((1 - ((1 + J)
  5414          ** (M * -1))) / J) / OD
  5415     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5416        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5417        / ANGLEM-1
  5418     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5419          ** ((N - M) * -1))) / I)
  5420     MOVE +0                     TO WK3
  5421     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5422        (WS-COUNTER > M)
  5423        COMPUTE ANGLEM = (1 - ((1 + J)
  5424          ** ((M - WS-COUNTER) * -1))) / J
  5425        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5426        COMPUTE WK5-CSL = (RA * ANGLEM)
  5427        + (CP-ALTERNATE-BENEFIT * WK2)
  5428        COMPUTE WK3 = WK3 +
  5429         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5430        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5431          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5432          (CP-DCC-AH-RATE / 1000)
  5433     END-PERFORM
  5434     MOVE WK3                    TO CP-CALC-PREMIUM
  5435
  5436     GO TO 99999-RETURN
  5437
  5438     .
  5439 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5440
  5441     IF (CP-COMPANY-ID EQUAL 'DCC')
  5442        AND (CP-EARN-AS-NET-PAY)
  5443        AND (CP-BENEFIT-CD (1:1) = 'S')
  5444        AND (CP-BEN-CATEGORY = 'N')
  5445        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5446        CONTINUE
  5447     ELSE
  5448        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5449     END-IF
  5450
  5451     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5452     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5453          ** ((M - 1) * -1))) / K)
  5454     COMPUTE ANGLEM = ((1 - ((1 + K)
  5455          ** (M * -1))) / K)
  5456     MOVE CP-MONTHLY-PAYMENT     TO RA
  5457     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5458        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5459        * CP-DCC-AH-RATE / 1000))
  5460        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page 100
* ELRATE.cbl
  5461        CP-DCC-LF-RATE / 1000
  5462     MOVE WK3                    TO CP-LF-PREM
  5463     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5464        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5465        * CP-DCC-AH-RATE / 1000
  5466     COMPUTE WK3 = WK3 + WK5-CSL
  5467     MOVE WK3                    TO CP-CALC-PREMIUM
  5468
  5469     GO TO 99999-RETURN
  5470      .
  5471 12001-CHECK-DCC-MNET-TOT-N.
  5472
  5473     IF (CP-COMPANY-ID EQUAL 'DCC')
  5474        AND (CP-EARN-AS-NET-PAY)
  5475        AND (CP-BENEFIT-CD (1:1) = 'N')
  5476        AND (CP-BEN-CATEGORY = 'N')
  5477        CONTINUE
  5478     ELSE
  5479        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5480     END-IF
  5481
  5482*    I = APR/1200
  5483*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5484*    RA = PAYMENT AMOUNT
  5485*    WK5-CSL = THE BALANCE (PAY OFF )
  5486*    WK3 = THE ACCUMULATED PREMIUM
  5487*    WK2 = (1 + I) ^ (m * -1)
  5488*    OD  = GAMMA
  5489*
  5490*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5491     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5492        / (1 + I)
  5493     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5494     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5495        (CP-DCC-AH-RATE / +1000)
  5496     COMPUTE WK2 = (1 + J) ** (M * -1)
  5497     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5498     COMPUTE ANGLEM = ((1 - ((1 + J)
  5499          ** (M * -1))) / J) / OD
  5500     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5501     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5502          ** ((N - M) * -1))) / I)
  5503     MOVE +0                     TO WK3
  5504     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5505        (WS-COUNTER > M)
  5506        COMPUTE ANGLEM = (1 - ((1 + J)
  5507          ** ((M - WS-COUNTER + 1) * -1))) / J
  5508        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5509        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5510        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5511           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5512     END-PERFORM
  5513     MOVE WK3                    TO CP-CALC-PREMIUM
  5514
  5515     GO TO 99999-RETURN
  5516
  5517     .
  5518 12001-CHECK-DCC-MNET-TOT-S.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page 101
* ELRATE.cbl
  5519
  5520     IF (CP-COMPANY-ID EQUAL 'DCC')
  5521        AND (CP-EARN-AS-NET-PAY)
  5522        AND (CP-BENEFIT-CD (1:1) = 'S')
  5523        AND (CP-BEN-CATEGORY = 'N')
  5524        CONTINUE
  5525     ELSE
  5526        GO TO 12001-CONTINUE-NET
  5527     END-IF
  5528
  5529*    I = APR/1200
  5530*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5531*    RA = PAYMENT AMOUNT
  5532*    WK5-CSL = THE BALANCE (PAY OFF )
  5533*    WK3 = THE ACCUMULATED PREMIUM
  5534*    WK2 = (1 + I) ^ (m * -1)
  5535*    OD  = GAMMA
  5536*
  5537     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5538     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5539        / (1 + J)
  5540     COMPUTE ANGLEM = ((1 - ((1 + J)
  5541          ** (M * -1))) / J) / OD
  5542     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5543          ** ((N - M) * -1))) / I)
  5544          * (1 + J) ** (-1 * M)
  5545     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5546     MOVE CP-MONTHLY-PAYMENT     TO RA
  5547     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5548        / +30)
  5549     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5550        ** (WK1) - 1)) / J) * RA
  5551     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5552        + (CP-DAYS-TO-1ST-PMT - +30)
  5553        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5554        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5555     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5556        (12 / 12)
  5557     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5558        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5559        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5560     COMPUTE WK3 = WK3 + WK5-CSL
  5561     MOVE WK3                    TO CP-CALC-PREMIUM
  5562     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5563     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5564        / (1 + K)
  5565     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5566          ** ((N - M) * -1))) / I)
  5567     COMPUTE WK2 = (1 + K) ** (M * -1)
  5568     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5569     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5570     COMPUTE ANGLEM = ((1 - ((1 + K)
  5571          ** (M * -1))) / K) / Y
  5572*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5573     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5574        ((1 + K) ** (M + 1 / Y
  5575        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5576        - 1)) / K) * RA
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page 102
* ELRATE.cbl
  5577     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5578        + (CP-DAYS-TO-1ST-PMT - +30)
  5579        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5580        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5581     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5582        * (12 / 12)
  5583     MOVE WK3                    TO CP-LF-PREM
  5584
  5585     GO TO 99999-RETURN
  5586
  5587     .
  5588 12001-CONTINUE-NET.
  5589
  5590     IF NET-STD
  5591        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'
  5592*          OR 'DCC'
  5593         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5594         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5595         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5596         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5597                               * ((1 + N) / (1 + M))
  5598        ELSE
  5599         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5600         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5601         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  5602         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.
  5603
  5604     IF NET-SMP
  5605         COMPUTE N2 = N * N
  5606         COMPUTE N3 = N2 * N
  5607         COMPUTE WK3 ROUNDED = 2 * N2 * WK1
  5608         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)
  5609         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)
  5610         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10
  5611         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).
  5612
  5613     IF NPO-PRUDENTIAL
  5614       PERFORM 12100-PRU-CALC THRU 12199-EXIT
  5615           VARYING WS-COUNTER FROM 1 BY 1
  5616               UNTIL WS-COUNTER = N
  5617       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1
  5618       COMPUTE WK3 ROUNDED = WK3 / (I * 12).
  5619
  5620     MOVE WK3 TO FACTOR.
  5621
  5622     GO TO 99999-RETURN.
  5623
  5624 12100-PRU-CALC.
  5625     IF WS-COUNTER = 1
  5626         COMPUTE PWK = (I + 1)
  5627     ELSE
  5628         COMPUTE PWK = PWK * (I + 1).
  5629
  5630 12199-EXIT.
  5631      EXIT.
  5632
  5633 99000-ERROR.
  5634     MOVE +9999.999999999 TO N-P-FACTOR.
* Micro Focus Server Express         V5.1 revision 000 30-Nov-11 11:21 Page 103
* ELRATE.cbl
  5635     MOVE '4'             TO CP-RETURN-CODE.
  5636
  5637     GO TO 99999-EXIT.
  5638
  5639 99999-RETURN.
  5640     MOVE FACTOR          TO N-P-FACTOR.
  5641
  5642 99999-EXIT.
  5643      EXIT.
  5644 99999-DUMMY-STOP-RUN.
  5645
  5646* GOBACK.
  5647     MOVE '9%                    "   ' TO DFHEIV0
  5648     MOVE 'ELRATE' TO DFHEIV1
  5649     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5650     GOBACK.
  5651
  5652
  5653 9999-DFHBACK SECTION.
  5654     MOVE '9%                    "   ' TO DFHEIV0
  5655     MOVE 'ELRATE' TO DFHEIV1
  5656     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5657     GOBACK.
  5658 9999-DFHEXIT.
  5659     IF DFHEIGDJ EQUAL 0001
  5660         NEXT SENTENCE
  5661     ELSE IF DFHEIGDJ EQUAL 2
  5662         GO TO 9999-RATE-NOTFND,
  5663               9999-RATE-NOTOPEN,
  5664               9999-RATE-NOTFND
  5665         DEPENDING ON DFHEIGDI.
  5666     MOVE '9%                    "   ' TO DFHEIV0
  5667     MOVE 'ELRATE' TO DFHEIV1
  5668     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5669     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:        2556     Code:       48996
