* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   1
* EL6316.cbl
* Options: int("EL6316.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6316.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6316.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6316.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6316.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   2
* EL6316.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 110410   2007070900001  PEMA  ADD REFORMATIONS AND RESCISSIONS
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 072312   2011022800001  AJRA  NAPERSOFT MISC
    28* 091812 IR2012091400003  AJRA  CHANGE MSG 9999
    29* 101512   2011022800001  AJRA  FIX CLM RESC DEFAULT
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    35* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    36* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    37* 121713   2013090300001  AJRA  ADD ENCLOSURE CODE TO SCREEN
    38* 122313   2013090300001  AJRA  DO ENDORSEMENT FROM CERT SCREEN
    39*-----------------------------------------------------------------
    40*REMARKS.
    41*        TRANSACTION - EXBC - CANCEL CHANGES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   3
* EL6316.cbl
    43 ENVIRONMENT DIVISION.
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*    EL6316 WORKING STORAGE    *'.
    49 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    50 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    51 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    52 77  W-ARCH-NUMBER               PIC 9(8) BINARY  VALUE ZEROS.
    53 77  w-prtsw                     pic x  value spaces.
    54 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    55 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    56     88  ACCT-FOUND                 VALUE 'Y'.
    57 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    58 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    59 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    60 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    61 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    62 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    63 77  s1                          pic s999 comp-3 value +0.
    64 77  s2                          pic s999 comp-3 value +0.
    65 77  WS-REASON-SW                PIC X  VALUE ' '.
    66     88  REASONS-FOUND                  VALUE 'Y'.
    67     88  REASONS-NOT-FOUND              VALUE 'N'.
    68 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    69     88  NO-CERT-RW                 VALUE 'N'.
    70     88  CERT-RW                    VALUE 'Y'.
    71 77  WS-COMM-LENGTH              PIC 9(4) BINARY.
    72 01  P pointer.
    73 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    74 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    75 01  var-ptr pointer.
    76 01  env-var-len                 pic 9(4)  binary.
    77 01  rc                          pic 9(9)  binary.
    78 01  WS-KIXHOST                  PIC X(10).
    79 01  WS-KIXSYS.
    80     05  WS-KIX-FIL1             PIC X(10).
    81     05  WS-KIX-APPS             PIC X(10).
    82     05  WS-KIX-ENV              PIC X(10).
    83     05  WS-KIX-MYENV            PIC X(10).
    84     05  WS-KIX-SYS              PIC X(10).
    85*    COPY ELCSCTM.
    86******************************************************************
    87*                                                                *
    88*                                                                *
    89*                            ELCSCTM                             *
    90*                            VMOD=2.001                          *
    91*                                                                *
    92*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    93*                                                                *
    94******************************************************************
    95 01  SECURITY-MESSAGE.
    96     12  FILLER                          PIC X(30)
    97            VALUE '** LOGIC SECURITY VIOLATION -'.
    98     12  SM-READ                         PIC X(6).
    99     12  FILLER                          PIC X(5)
   100            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   4
* EL6316.cbl
   101     12  SM-PGM                          PIC X(6).
   102     12  FILLER                          PIC X(5)
   103            VALUE ' OPR='.
   104     12  SM-PROCESSOR-ID                 PIC X(4).
   105     12  FILLER                          PIC X(6)
   106            VALUE ' TERM='.
   107     12  SM-TERMID                       PIC X(4).
   108     12  FILLER                          PIC XX   VALUE SPACE.
   109     12  SM-JUL-DATE                     PIC 9(5).
   110     12  FILLER                          PIC X    VALUE SPACE.
   111     12  SM-TIME                         PIC 99.99.
   112
   113*    COPY ELCSCRTY.
   114******************************************************************
   115*                                                                *
   116*                                                                *
   117*                            ELCSCRTY                            *
   118*                            VMOD=2.001                          *
   119*                                                                *
   120*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   121*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   122*        SAVED IN PI-SECURITY-ADDRESS.                           *
   123*                                                                *
   124******************************************************************
   125 01  SECURITY-CONTROL.
   126     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   127     12  FILLER                       PIC XX    VALUE 'SC'.
   128     12  SC-CREDIT-CODES.
   129         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   130             20  SC-CREDIT-DISPLAY    PIC X.
   131             20  SC-CREDIT-UPDATE     PIC X.
   132     12  SC-CLAIMS-CODES.
   133         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   134             20  SC-CLAIMS-DISPLAY    PIC X.
   135             20  SC-CLAIMS-UPDATE     PIC X.
   136 01 srch-commarea.
   137*                                copy ELCADLTRSPI.
   138******************************************************************
   139*                   C H A N G E   L O G
   140*
   141* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   142*-----------------------------------------------------------------
   143*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   144* EFFECTIVE    NUMBER
   145*-----------------------------------------------------------------
   146* 060611    2011022800001  PEMA  NEW COPYBOOK
   147* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   148* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   149******************************************************************
   150****************************************
   151*  commarea for NaperSoft On Demand Admin services letters
   152*  (business logic input & output)
   153****************************************
   154     03  BL-INPUT.
   155         05  BL-DATA-SRCE        PIC X.
   156         05  BL-LETTER-ID        PIC XXXX.
   157         05  BL-CARRIER          PIC X.
   158         05  BL-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   5
* EL6316.cbl
   159         05  BL-STATE            PIC XX.
   160         05  BL-ACCOUNT          PIC X(10).
   161         05  BL-EFF-DT           PIC X(10).
   162         05  BL-CERT-NO          PIC X(11).
   163         05  BL-BATCH-NO         PIC X(6).
   164         05  BL-BATCH-SEQ        PIC 9(8).
   165         05  BL-RESP-NO          PIC X(10).
   166         05  BL-NO-OF-COPIES     PIC 99.
   167         05  BL-PROC-ID          PIC XXXX.
   168         05  BL-COMP-ID          PIC XXX.
   169         05  BL-PRINT-NOW-SW     PIC X.
   170         05  BL-ENC-CD           PIC XXX.
   171         05  BL-RESEND-DT        PIC X(10).
   172         05  BL-FOLLOW-UP-DT     PIC X(10).
   173         05  BL-ARCHIVE-NO       PIC 9(8).
   174         05  BL-FUNC             PIC X(8).
   175         05  BL-COMMENTS         PIC X(100).
   176         05  FILLER REDEFINES BL-COMMENTS.
   177             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   178             10  BL-LETTER-TO-ACCT PIC X.
   179             10  BL-LETTER-TO-BENE PIC X.
   180             10  BL-WRITE-ERARCH   PIC X.
   181                 88  ERARCH-QWS      VALUE 'Q'.
   182                 88  ERARCH-BATCH    VALUE 'B'.
   183                 88  ERARCH-TEMP     VALUE 'T'.
   184             10  BL-PROCESS-TYPE PIC X(07).
   185             10  BL-CERT-FORM-ID PIC X(05).
   186             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   187             10  BL-SOURCE-SCREEN PIC X(8).
   188             10  FILLER          PIC X(25).
   189     03  BL-OUTPUT.
   190         05  BL-STATUS                   PIC X.
   191             88  BL-OK                      VALUE "P".
   192             88  BL-FAIL                  VALUE "F".
   193         05  BL-MESSAGE          PIC X(50).
   194     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   195     03  FILLER                  PIC X(31).
   196
   197*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   198*                                COPY ELCZREC.
   199******************************************************************
   200*                                                                *
   201*                                                                *
   202*                            ELCZREC.                            *
   203*                                                                *
   204*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   205*                                                                *
   206******************************************************************
   207*-----------------------------------------------------------------
   208*                   C H A N G E   L O G
   209*
   210* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   211*-----------------------------------------------------------------
   212*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   213* EFFECTIVE    NUMBER
   214*-----------------------------------------------------------------
   215* 122011    2011022800001  AJRA  NEW FILE
   216* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   6
* EL6316.cbl
   217* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   218* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   219* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   220*-----------------------------------------------------------------
   221 01  W-Z-CONTROL-DATA.
   222     05  W-NUMBER-OF-COPIES      PIC  9.
   223     05  FILLER                  PIC  X.
   224     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   225     05  FILLER                  PIC  X.
   226     05  W-DAYS-TO-RESEND        PIC  999.
   227     05  FILLER                  PIC  X.
   228     05  W-FORM-TO-RESEND        PIC  X(4).
   229     05  W-ADD-BAR-CODE          PIC  X.
   230     05  W-PROMPT-LETTER         PIC  X.
   231     05  W-HAS-RETURN-ENV        PIC  X.
   232     05  W-ENCLOSURE-CD          PIC  XXX.
   233     05  W-SIG-FLAG-DEFAULT      PIC  X.
   234     05  W-AUTO-CLOSE-IND        PIC  X.
   235     05  FILLER                  PIC  X.
   236     05  W-LETTER-TO-BENE        PIC  X.
   237     05  FILLER                  PIC  X.
   238     05  W-LETTER-TO-ACCT        PIC  X.
   239     05  FILLER                  PIC  X.
   240     05  W-LETTER-TYPE           PIC  X.
   241     05  FILLER                  PIC  X.
   242     05  W-PRINT-CERTIFICATE     PIC  X.
   243     05  FILLER                  PIC  X.
   244     05  W-REFUND-REQUIRED       PIC  X.
   245     05  FILLER                  PIC  X.
   246     05  W-ONBASE-CODE           PIC  XX.
   247     05  FILLER                  PIC  X.
   248     05  W-ACCT-SUMM             PIC  X.
   249     05  FILLER                  PIC  X.
   250     05  W-CSO-SUMM              PIC  X.
   251     05  FILLER                  PIC  X.
   252     05  W-REASONS-REQUIRED      PIC  X.
   253     05  FILLER                  PIC  X(29).
   254 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   255 01  STANDARD-AREAS.
   256     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   257     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   258                                 PIC  X(08).
   259     12  QID.
   260         16  QID-TERM        PIC X(4)    VALUE SPACES.
   261         16  FILLER          PIC X(4)    VALUE '631I'.
   262     12  TIME-MT                 PIC S9(7).
   263     12  TIME-MT-R  REDEFINES TIME-MT.
   264         16  FILLER              PIC X.
   265         16  TIME-LMT            PIC 99V99.
   266         16  FILLER              PIC X(2).
   267     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   268     12  MAP-LENGTH              PIC 9(4)   VALUE 359 BINARY.
   269     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   270     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   271     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   272     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   273     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   274     12  ELENCC-LENGTH           PIC S9(04) VALUE +400 COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   7
* EL6316.cbl
   275     12  WS-ELCERT-KEY.
   276         16  W-CERT-COMPANY-CD   PIC X.
   277         16  W-CERT-CARRIER      PIC X.
   278         16  W-CERT-GROUPING     PIC X(6).
   279         16  W-CERT-STATE        PIC XX.
   280         16  W-CERT-ACCOUNT      PIC X(10).
   281         16  W-CERT-CERT-EFF-DT  PIC XX.
   282         16  W-CERT-CERT-PRIME   PIC X(10).
   283         16  W-CERT-CERT-SFX     PIC X.
   284     12  WS-ELEOBC-KEY.
   285         16  WS-EOBC-COMPANY-CD  PIC X.
   286         16  WS-EOBC-REC-TYPE    PIC X.
   287         16  WS-EOBC-CODE        PIC X(4).
   288         16  FILLER              PIC X(9).
   289     12  WS-ERNOTE-KEY.
   290         16  W-NOTE-COMPANY-CD   PIC X.
   291         16  W-NOTE-CARRIER      PIC X.
   292         16  W-NOTE-GROUPING     PIC X(6).
   293         16  W-NOTE-STATE        PIC XX.
   294         16  W-NOTE-ACCOUNT      PIC X(10).
   295         16  W-NOTE-CERT-EFF-DT  PIC XX.
   296         16  W-NOTE-CERT-PRIME   PIC X(10).
   297         16  W-NOTE-CERT-SFX     PIC X.
   298     12  ELLETR-KEY.
   299         16  LETR-PART-KEY.
   300             20  LETR-COMPANY-CD PIC X.
   301             20  LETR-LETTER-ID  PIC X(4).
   302         16  LETR-FILLER         PIC X(8).
   303         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   304     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   305     12  ERPNDB2-KEY.
   306         16  PNDB2-COMPANY-CD    PIC X.
   307         16  PNDB2-CARRIER       PIC X.
   308         16  PNDB2-GROUPING      PIC X(6).
   309         16  PNDB2-STATE         PIC XX.
   310         16  PNDB2-ACCOUNT       PIC X(10).
   311         16  PNDB2-CERT-EFF-DT   PIC XX.
   312         16  PNDB2-CERT-PRIME    PIC X(10).
   313         16  PNDB2-CERT-SFX      PIC X.
   314         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   315         16  PNDB2-RECORD-TYPE   PIC X.
   316     12  ERENDT-KEY.
   317         16  ENDT-COMPANY-CD       PIC X.
   318         16  ENDT-CARRIER          PIC X.
   319         16  ENDT-GROUPING         PIC X(6).
   320         16  ENDT-STATE            PIC XX.
   321         16  ENDT-ACCOUNT          PIC X(10).
   322         16  ENDT-CERT-EFF-DT      PIC XX.
   323         16  ENDT-CERT-PRIME       PIC X(10).
   324         16  ENDT-CERT-SFX         PIC X.
   325         16  ENDT-RECORD-TYPE      PIC X.
   326         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   327     12  ELCRTO-KEY.
   328         16  CRTO-COMPANY-CD     PIC X.
   329         16  CRTO-CARRIER        PIC X.
   330         16  CRTO-GROUPING       PIC X(6).
   331         16  CRTO-STATE          PIC XX.
   332         16  CRTO-ACCOUNT        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   8
* EL6316.cbl
   333         16  CRTO-CERT-EFF-DT    PIC XX.
   334         16  CRTO-CERT-PRIME     PIC X(10).
   335         16  CRTO-CERT-SFX       PIC X.
   336         16  CRTO-RECORD-TYPE    PIC X.
   337         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   338     12  WS-ERMAIL-KEY.
   339         16  MAIL-COMPANY-CD     PIC X.
   340         16  MAIL-CARRIER        PIC X.
   341         16  MAIL-GROUPING       PIC X(6).
   342         16  MAIL-STATE          PIC XX.
   343         16  MAIL-ACCOUNT        PIC X(10).
   344         16  MAIL-CERT-EFF-DT    PIC XX.
   345         16  MAIL-CERT-PRIME     PIC X(10).
   346         16  MAIL-CERT-SFX       PIC X.
   347     12  WS-ELCRTT-KEY.
   348         16  WS-ELCRTT-PRIMARY       PIC X(33).
   349         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   350
   351     12  WS-ELENCC-KEY.
   352         16  WS-ENCC-COMPANY-CD  PIC X.
   353         16  WS-ENCC-REC-TYPE    PIC X.
   354         16  WS-ENCC-ENC-CODE    PIC X(5).
   355         16  FILLER              PIC X(09).
   356
   357     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   358     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   359     12  WS-CURRENT-DT.
   360         16  FILLER              PIC X(6)    VALUE SPACES.
   361         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   362     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   363     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   364         88  CANCEL-REC            VALUE 'C'.
   365         88  ISSUE-REC             VALUE 'I'.
   366     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   367     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   368     12  ELCNTL-KEY.
   369         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   370         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   371         16  CNTL-ACCESS.
   372             20  CNTL-STATE      PIC XX    VALUE SPACES.
   373             20  FILLER          PIC X     VALUE SPACES.
   374             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   375         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   376     12  WS-ERACCT-KEY.
   377         16  ACCT-COMPANY-CD     PIC X.
   378         16  ACCT-CARRIER        PIC X.
   379         16  ACCT-GROUPING       PIC X(6).
   380         16  ACCT-STATE          PIC XX.
   381         16  ACCT-ACCOUNT        PIC X(10).
   382         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   383         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   384     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   385     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   386     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   387     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   388     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   389     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   390     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page   9
* EL6316.cbl
   391     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   392     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   393     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   394     12  WS-ELENCC-FILE-ID       PIC X(8) VALUE 'ELENCC'.
   395     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   396     12  WS-ERMAIL-FILE-ID       PIC X(8) VALUE 'ERMAIL'.
   397     12  WS-RESPONSE             PIC S9(8)   COMP.
   398         88  RESP-NORMAL                  VALUE +00.
   399         88  RESP-NOTFND                  VALUE +13.
   400         88  RESP-DUPREC                  VALUE +14.
   401         88  RESP-DUPKEY                  VALUE +15.
   402         88  RESP-NOTOPEN                 VALUE +19.
   403         88  RESP-ENDFILE                 VALUE +20.
   404     12  MAP-NAME            PIC X(8)    VALUE 'EL631I'.
   405     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6316S'.
   406     12  SCREEN-NUMBER       PIC X(4)    VALUE '631I'.
   407     12  TRANS-ID            PIC X(4)    VALUE 'EXBC'.
   408     12  THIS-PGM            PIC X(8)    VALUE 'EL6316'.
   409     12  PGM-NAME            PIC X(8).
   410     12  TIME-IN             PIC S9(7).
   411     12  TIME-OUT-R  REDEFINES TIME-IN.
   412         16  FILLER          PIC X.
   413         16  TIME-OUT        PIC 99V99.
   414         16  FILLER          PIC X(2).
   415     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   416     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   417     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   418     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   419     12  XCTL-6317           PIC X(8)    VALUE 'EL6317'.
   420     12  XCTL-6318           PIC X(8)    VALUE 'EL6318'.
   421     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   422     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   423     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   424     12  WS-PHONE.
   425         16  WS-PH1              PIC XXX.
   426         16  WS-PH2              PIC XXX.
   427         16  WS-PH3              PIC XXXX.
   428     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   429     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   430
   431     12  WS-BILLING-NOTE.
   432         16  WS-BN-NOTE          PIC X(25).
   433         16  WS-BN-LTRID         PIC X(4).
   434         16  FILLER              PIC X(3).
   435         16  WS-BN-DATE          PIC X(8).
   436         16  FILLER              PIC X(3).
   437         16  WS-BN-USERID        PIC X(4).
   438         16  FILLER              PIC X(30).
   439     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   440         16  WS-MAN-BN-NOTE      PIC X(63).
   441         16  FILLER              PIC X(14).
   442     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   443     12  WS-TMPDATE.
   444         16  FILLER              PIC X(2).
   445         16  WS-TMPDT            PIC X(6).
   446     12  WS-AMTX                 PIC X(10).
   447     12  WS-AMTN  REDEFINES WS-AMTX PIC 9(10).
   448     12  WS-AMTV2 REDEFINES WS-AMTN PIC 9(8)V99.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  10
* EL6316.cbl
   449     12  NEW-ORIG-REC.
   450         16  NEW-INS-LAST-NAME             PIC X(15).
   451         16  NEW-INS-FIRST-NAME            PIC X(10).
   452         16  NEW-INS-MIDDLE-INIT           PIC X.
   453         16  NEW-INS-AGE                   PIC S999     COMP-3.
   454         16  NEW-JNT-LAST-NAME             PIC X(15).
   455         16  NEW-JNT-FIRST-NAME            PIC X(10).
   456         16  NEW-JNT-MIDDLE-INIT           PIC X.
   457         16  NEW-JNT-AGE                   PIC S999     COMP-3.
   458         16  NEW-LF-BENCD                  PIC XX.
   459         16  NEW-LF-TERM                   PIC S999      COMP-3.
   460         16  NEW-LF-BEN-AMT                PIC S9(9)V99  COMP-3.
   461         16  NEW-LF-PRM-AMT                PIC S9(7)V99  COMP-3.
   462         16  NEW-LF-ALT-BEN-AMT            PIC S9(9)V99  COMP-3.
   463         16  NEW-LF-ALT-PRM-AMT            PIC S9(7)V99  COMP-3.
   464         16  NEW-LF-EXP-DT                 PIC XX.
   465         16  NEW-LF-COMM-PCT               PIC SV9(5)    COMP-3.
   466         16  NEW-LF-CANCEL-DT              PIC XX.
   467         16  NEW-LF-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   468         16  NEW-LF-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   469         16  NEW-AH-BENCD                  PIC XX.
   470         16  NEW-AH-TERM                   PIC S999      COMP-3.
   471         16  NEW-AH-BEN-AMT                PIC S9(9)V99  COMP-3.
   472         16  NEW-AH-PRM-AMT                PIC S9(7)V99  COMP-3.
   473         16  NEW-AH-EXP-DT                 PIC XX.
   474         16  NEW-AH-COMM-PCT               PIC SV9(5)    COMP-3.
   475         16  NEW-AH-CP                     PIC 99.
   476         16  NEW-AH-CANCEL-DT              PIC XX.
   477         16  NEW-AH-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   478         16  NEW-AH-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   479         16  NEW-CRED-BENE-NAME            PIC X(25).
   480         16  NEW-1ST-PMT-DT                PIC XX.
   481         16  NEW-INS-AGE-DEFAULT-FLAG      PIC X.
   482         16  NEW-JNT-AGE-DEFAULT-FLAG      PIC X.
   483         16  NEW-ISSUE-TRAN-IND            PIC X.
   484         16  NEW-CANCEL-TRAN-IND           PIC X.
   485         16  FILLER                        PIC X(235).
   486
   487 01  CERT-NOTE-ENTRIES.
   488     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   489         16  CERT-NT-TEXT                PIC X(63).
   490         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   491         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   492         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   493
   494 01  ERCNOT-AREA.
   495     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   496     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   497     12  ERCNOT-KEY.
   498         16  ERCNOT-PARTIAL-KEY.
   499             20 ERCNOT-COMPANY-CD    PIC X.
   500             20 ERCNOT-CARRIER       PIC X.
   501             20 ERCNOT-GROUPING      PIC X(06).
   502             20 ERCNOT-STATE         PIC XX.
   503             20 ERCNOT-ACCOUNT       PIC X(10).
   504             20 ERCNOT-EFF-DT        PIC XX.
   505             20 ERCNOT-CERT-NO.
   506                25 ERCNOT-CERT-PRIME PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  11
* EL6316.cbl
   507                25 ERCNOT-CERT-SFX   PIC X.
   508             20 ERCNOT-REC-TYP       PIC X.
   509         16 ERCNOT-SEQ           PIC S9(4) COMP.
   510     12  SV-PARTIAL-KEY.
   511         20 SV-COMPANY-CD            PIC X.
   512         20 SV-CARRIER               PIC X.
   513         20 SV-GROUPING              PIC X(06).
   514         20 SV-STATE                 PIC XX.
   515         20 SV-ACCOUNT               PIC X(10).
   516         20 SV-EFF-DT                PIC XX.
   517         20 SV-CERT-NO.
   518            25 SV-CERT-PRIME         PIC X(10).
   519            25 SV-CERT-SFX           PIC X(1).
   520         20 SV-REC-TYP               PIC X.
   521 01  ERROR-MESSAGES.
   522     12  ER-0000                 PIC X(4)  VALUE '0000'.
   523     12  ER-0004                 PIC X(4)  VALUE '0004'.
   524     12  ER-0008                 PIC X(4)  VALUE '0008'.
   525     12  ER-0023                 PIC X(4)  VALUE '0023'.
   526     12  ER-0029                 PIC X(4)  VALUE '0029'.
   527     12  ER-0068                 PIC X(4)  VALUE '0068'.
   528     12  ER-0132                 PIC X(4)  VALUE '0132'.
   529     12  ER-0142                 PIC X(4)  VALUE '0142'.
   530     12  ER-0148                 PIC X(4)  VALUE '0148'.
   531     12  ER-0215                 PIC X(4)  VALUE '0215'.
   532     12  ER-0280                 PIC X(4)  VALUE '0280'.
   533     12  ER-0348                 PIC X(4)  VALUE '0348'.
   534     12  ER-0419                 PIC X(4)  VALUE '0419'.
   535     12  ER-0894                 PIC X(4)  VALUE '0894'.
   536     12  ER-1101                 PIC X(4)  VALUE '1101'.
   537     12  ER-1236                 PIC X(4)  VALUE '1236'.
   538     12  ER-1560                 PIC X(4)  VALUE '1560'.
   539     12  ER-1818                 PIC X(4)  VALUE '1818'.
   540     12  ER-1820                 PIC X(4)  VALUE '1820'.
   541     12  ER-2056                 PIC X(4)  VALUE '2056'.
   542     12  ER-2079                 PIC X(4)  VALUE '2079'.
   543     12  ER-2208                 PIC X(4)  VALUE '2208'.
   544     12  ER-2209                 PIC X(4)  VALUE '2209'.
   545     12  ER-2237                 PIC X(4)  VALUE '2237'.
   546     12  ER-2238                 PIC X(4)  VALUE '2238'.
   547     12  ER-2253                 PIC X(4)  VALUE '2253'.
   548     12  ER-2619                 PIC X(4)  VALUE '2619'.
   549     12  ER-2651                 PIC X(4)  VALUE '2651'.
   550     12  ER-2784                 PIC X(4)  VALUE '2784'.
   551     12  ER-2785                 PIC X(4)  VALUE '2785'.
   552     12  ER-2786                 PIC X(4)  VALUE '2786'.
   553     12  ER-2791                 PIC X(4)  VALUE '2791'.
   554     12  ER-2845                 PIC X(4)  VALUE '2845'.
   555     12  ER-2848                 PIC X(4)  VALUE '2848'.
   556     12  ER-2851                 PIC X(4)  VALUE '2851'.
   557     12  ER-3829                 PIC X(4)  VALUE '3829'.
   558     12  ER-3830                 PIC X(4)  VALUE '3830'.
   559     12  ER-3833                 PIC X(4)  VALUE '3833'.
   560     12  ER-7638                 PIC X(4)  VALUE '7638'.
   561     12  ER-8888                 PIC X(4)  VALUE '8888'.
   562     12  ER-9999                 PIC X(4)  VALUE '9999'.
   563*    COPY ELCDATE.
   564******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  12
* EL6316.cbl
   565*                                                                *
   566*                                                                *
   567*                            ELCDATE.                            *
   568*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   569*                            VMOD=2.003
   570*                                                                *
   571*                                                                *
   572*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   573*                 LENGTH = 200                                   *
   574******************************************************************
   575
   576 01  DATE-CONVERSION-DATA.
   577     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   578     12  DC-OPTION-CODE                PIC X.
   579         88  BIN-TO-GREG                VALUE ' '.
   580         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   581         88  EDIT-GREG-TO-BIN           VALUE '2'.
   582         88  YMD-GREG-TO-BIN            VALUE '3'.
   583         88  MDY-GREG-TO-BIN            VALUE '4'.
   584         88  JULIAN-TO-BIN              VALUE '5'.
   585         88  BIN-PLUS-ELAPSED           VALUE '6'.
   586         88  FIND-CENTURY               VALUE '7'.
   587         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   588         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   589         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   590         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   591         88  JULIAN-TO-BIN-3            VALUE 'C'.
   592         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   593         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   594         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   595         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   596         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   597         88  CHECK-LEAP-YEAR            VALUE 'H'.
   598         88  BIN-3-TO-GREG              VALUE 'I'.
   599         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   600         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   601         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   602         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   603         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   604         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   605         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   606         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   607         88  THREE-CHARACTER-BIN
   608                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   609         88  GREGORIAN-TO-BIN
   610                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   611         88  BIN-TO-GREGORIAN
   612                  VALUES ' ' '1' 'I' '8' 'G'.
   613         88  JULIAN-TO-BINARY
   614                  VALUES '5' 'C' 'E' 'F'.
   615     12  DC-ERROR-CODE                 PIC X.
   616         88  NO-CONVERSION-ERROR        VALUE ' '.
   617         88  DATE-CONVERSION-ERROR
   618                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   619         88  DATE-IS-ZERO               VALUE '1'.
   620         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   621         88  DATE-IS-INVALID            VALUE '3'.
   622         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  13
* EL6316.cbl
   623         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   624         88  DATE-INVALID-OPTION        VALUE '9'.
   625         88  INVALID-CENTURY            VALUE 'A'.
   626         88  ONLY-CENTURY               VALUE 'B'.
   627         88  ONLY-LEAP-YEAR             VALUE 'C'.
   628         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   629     12  DC-END-OF-MONTH               PIC X.
   630         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   631     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   632         88  USE-NORMAL-PROCESS         VALUE ' '.
   633         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   634         88  ADJUST-UP-100-YRS          VALUE '2'.
   635     12  FILLER                        PIC X.
   636     12  DC-CONVERSION-DATES.
   637         16  DC-BIN-DATE-1             PIC XX.
   638         16  DC-BIN-DATE-2             PIC XX.
   639         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   640         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   641                       DC-GREG-DATE-1-EDIT.
   642             20  DC-EDIT1-MONTH        PIC 99.
   643             20  SLASH1-1              PIC X.
   644             20  DC-EDIT1-DAY          PIC 99.
   645             20  SLASH1-2              PIC X.
   646             20  DC-EDIT1-YEAR         PIC 99.
   647         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   648         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   649                     DC-GREG-DATE-2-EDIT.
   650             20  DC-EDIT2-MONTH        PIC 99.
   651             20  SLASH2-1              PIC X.
   652             20  DC-EDIT2-DAY          PIC 99.
   653             20  SLASH2-2              PIC X.
   654             20  DC-EDIT2-YEAR         PIC 99.
   655         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   656         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   657                     DC-GREG-DATE-1-YMD.
   658             20  DC-YMD-YEAR           PIC 99.
   659             20  DC-YMD-MONTH          PIC 99.
   660             20  DC-YMD-DAY            PIC 99.
   661         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   662         16  DC-GREG-DATE-1-MDY-R REDEFINES
   663                      DC-GREG-DATE-1-MDY.
   664             20  DC-MDY-MONTH          PIC 99.
   665             20  DC-MDY-DAY            PIC 99.
   666             20  DC-MDY-YEAR           PIC 99.
   667         16  DC-GREG-DATE-1-ALPHA.
   668             20  DC-ALPHA-MONTH        PIC X(10).
   669             20  DC-ALPHA-DAY          PIC 99.
   670             20  FILLER                PIC XX.
   671             20  DC-ALPHA-CENTURY.
   672                 24 DC-ALPHA-CEN-N     PIC 99.
   673             20  DC-ALPHA-YEAR         PIC 99.
   674         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   675         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   676         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   677         16  DC-JULIAN-DATE            PIC 9(05).
   678         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   679                                       PIC 9(05).
   680         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  14
* EL6316.cbl
   681             20  DC-JULIAN-YEAR        PIC 99.
   682             20  DC-JULIAN-DAYS        PIC 999.
   683         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   684         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   685         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   686     12  DATE-CONVERSION-VARIBLES.
   687         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   688         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   689             20  FILLER                PIC 9(3).
   690             20  HOLD-CEN-1-CCYY.
   691                 24  HOLD-CEN-1-CC     PIC 99.
   692                 24  HOLD-CEN-1-YY     PIC 99.
   693             20  HOLD-CEN-1-MO         PIC 99.
   694             20  HOLD-CEN-1-DA         PIC 99.
   695         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   696             20  HOLD-CEN-1-R-MO       PIC 99.
   697             20  HOLD-CEN-1-R-DA       PIC 99.
   698             20  HOLD-CEN-1-R-CCYY.
   699                 24  HOLD-CEN-1-R-CC   PIC 99.
   700                 24  HOLD-CEN-1-R-YY   PIC 99.
   701             20  FILLER                PIC 9(3).
   702         16  HOLD-CENTURY-1-X.
   703             20  FILLER                PIC X(3)  VALUE SPACES.
   704             20  HOLD-CEN-1-X-CCYY.
   705                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   706                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   707             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   708             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   709         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   710             20  HOLD-CEN-1-R-X-MO     PIC XX.
   711             20  HOLD-CEN-1-R-X-DA     PIC XX.
   712             20  HOLD-CEN-1-R-X-CCYY.
   713                 24  HOLD-CEN-1-R-X-CC PIC XX.
   714                 24  HOLD-CEN-1-R-X-YY PIC XX.
   715             20  FILLER                PIC XXX.
   716         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   717         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   718         16  DC-JULIAN-DATE-1          PIC 9(07).
   719         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   720             20  DC-JULIAN-1-CCYY.
   721                 24  DC-JULIAN-1-CC    PIC 99.
   722                 24  DC-JULIAN-1-YR    PIC 99.
   723             20  DC-JULIAN-DA-1        PIC 999.
   724         16  DC-JULIAN-DATE-2          PIC 9(07).
   725         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   726             20  DC-JULIAN-2-CCYY.
   727                 24  DC-JULIAN-2-CC    PIC 99.
   728                 24  DC-JULIAN-2-YR    PIC 99.
   729             20  DC-JULIAN-DA-2        PIC 999.
   730         16  DC-GREG-DATE-A-EDIT.
   731             20  DC-EDITA-MONTH        PIC 99.
   732             20  SLASHA-1              PIC X VALUE '/'.
   733             20  DC-EDITA-DAY          PIC 99.
   734             20  SLASHA-2              PIC X VALUE '/'.
   735             20  DC-EDITA-CCYY.
   736                 24  DC-EDITA-CENT     PIC 99.
   737                 24  DC-EDITA-YEAR     PIC 99.
   738         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  15
* EL6316.cbl
   739             20  DC-EDITB-MONTH        PIC 99.
   740             20  SLASHB-1              PIC X VALUE '/'.
   741             20  DC-EDITB-DAY          PIC 99.
   742             20  SLASHB-2              PIC X VALUE '/'.
   743             20  DC-EDITB-CCYY.
   744                 24  DC-EDITB-CENT     PIC 99.
   745                 24  DC-EDITB-YEAR     PIC 99.
   746         16  DC-GREG-DATE-CYMD         PIC 9(08).
   747         16  DC-GREG-DATE-CYMD-R REDEFINES
   748                              DC-GREG-DATE-CYMD.
   749             20  DC-CYMD-CEN           PIC 99.
   750             20  DC-CYMD-YEAR          PIC 99.
   751             20  DC-CYMD-MONTH         PIC 99.
   752             20  DC-CYMD-DAY           PIC 99.
   753         16  DC-GREG-DATE-MDCY         PIC 9(08).
   754         16  DC-GREG-DATE-MDCY-R REDEFINES
   755                              DC-GREG-DATE-MDCY.
   756             20  DC-MDCY-MONTH         PIC 99.
   757             20  DC-MDCY-DAY           PIC 99.
   758             20  DC-MDCY-CEN           PIC 99.
   759             20  DC-MDCY-YEAR          PIC 99.
   760    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   761        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   762    12  DC-EL310-DATE                  PIC X(21).
   763    12  FILLER                         PIC X(28).
   764*    COPY ELCLOGOF.
   765******************************************************************
   766*                                                                *
   767*                                                                *
   768*                            ELCLOGOF.                           *
   769*                            VMOD=2.001                          *
   770*                                                                *
   771*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   772*                                                                *
   773******************************************************************
   774 01  CLASIC-LOGOFF.
   775     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   776     12  LOGOFF-TEXT.
   777         16  FILLER          PIC X(5)    VALUE SPACES.
   778         16  LOGOFF-MSG.
   779             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   780             20  FILLER      PIC X       VALUE SPACES.
   781             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   782         16  FILLER          PIC X(80)
   783           VALUE '* YOU ARE NOW LOGGED OFF'.
   784         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   785         16  FILLER          PIC X       VALUE QUOTE.
   786         16  LOGOFF-SYS-MSG  PIC X(17)
   787           VALUE 'S CLAS-IC SYSTEM '.
   788     12  TEXT-MESSAGES.
   789         16  UNACCESS-MSG    PIC X(29)
   790             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   791         16  PGMIDERR-MSG    PIC X(17)
   792             VALUE 'PROGRAM NOT FOUND'.
   793*    COPY ELCATTR.
   794******************************************************************
   795*                                                                *
   796*                            ELCATTR.                            *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  16
* EL6316.cbl
   797*                            VMOD=2.001                          *
   798*                                                                *
   799*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   800*                                                                *
   801*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   802*                                                                *
   803*                   POS 1   P=PROTECTED                          *
   804*                           U=UNPROTECTED                        *
   805*                           S=ASKIP                              *
   806*                   POS 2   A=ALPHA/NUMERIC                      *
   807*                           N=NUMERIC                            *
   808*                   POS 3   N=NORMAL                             *
   809*                           B=BRIGHT                             *
   810*                           D=DARK                               *
   811*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   812*                           OF=MODIFIED DATA TAG OFF             *
   813*                                                                *
   814*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   815******************************************************************
   816 01  ATTRIBUTE-LIST.
   817     12  AL-PABOF            PIC X       VALUE 'Y'.
   818     12  AL-PABON            PIC X       VALUE 'Z'.
   819     12  AL-PADOF            PIC X       VALUE '%'.
   820     12  AL-PADON            PIC X       VALUE '_'.
   821     12  AL-PANOF            PIC X       VALUE '-'.
   822     12  AL-PANON            PIC X       VALUE '/'.
   823     12  AL-SABOF            PIC X       VALUE '8'.
   824     12  AL-SABON            PIC X       VALUE '9'.
   825     12  AL-SADOF            PIC X       VALUE '@'.
   826     12  AL-SADON            PIC X       VALUE QUOTE.
   827     12  AL-SANOF            PIC X       VALUE '0'.
   828     12  AL-SANON            PIC X       VALUE '1'.
   829     12  AL-UABOF            PIC X       VALUE 'H'.
   830     12  AL-UABON            PIC X       VALUE 'I'.
   831     12  AL-UADOF            PIC X       VALUE '<'.
   832     12  AL-UADON            PIC X       VALUE '('.
   833     12  AL-UANOF            PIC X       VALUE ' '.
   834     12  AL-UANON            PIC X       VALUE 'A'.
   835     12  AL-UNBOF            PIC X       VALUE 'Q'.
   836     12  AL-UNBON            PIC X       VALUE 'R'.
   837     12  AL-UNDOF            PIC X       VALUE '*'.
   838     12  AL-UNDON            PIC X       VALUE ')'.
   839     12  AL-UNNOF            PIC X       VALUE '&'.
   840     12  AL-UNNON            PIC X       VALUE 'J'.
   841*    COPY ELCEMIB.
   842******************************************************************
   843*                                                                *
   844*                                                                *
   845*                            ELCEMIB.                            *
   846*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   847*                            VMOD=2.005                          *
   848*                                                                *
   849*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   850*                                                                *
   851******************************************************************
   852 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   853     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   854     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  17
* EL6316.cbl
   855     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   856     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   857     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   858     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   859     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   860     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   861     12  EMI-SWITCH1             PIC X        VALUE '1'.
   862         88  EMI-NO-ERRORS                    VALUE '1'.
   863         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   864         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   865     12  EMI-SWITCH2             PIC X        VALUE '1'.
   866         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   867     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   868         88  EMI-AREA1-EMPTY                  VALUE '1'.
   869         88  EMI-AREA1-FULL                   VALUE '2'.
   870     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   871         88  EMI-AREA2-EMPTY                  VALUE '1'.
   872         88  EMI-AREA2-FULL                   VALUE '2'.
   873     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   874         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   875         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   876         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   877         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   878         88  EMI-BYPASS-FATALS                VALUE 'X'.
   879     12  EMI-ERROR-LINES.
   880         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   881         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   882         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   883         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   884             20  EMI-ERR-CODES OCCURS 10 TIMES.
   885                 24  EMI-ERR-NUM         PIC X(4).
   886                 24  EMI-FILLER          PIC X.
   887                 24  EMI-SEV             PIC X.
   888                 24  FILLER              PIC X.
   889             20  FILLER                  PIC X(02).
   890     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   891         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   892             20  EMI-ERROR-NUMBER    PIC X(4).
   893             20  EMI-FILL            PIC X.
   894             20  EMI-SEVERITY        PIC X.
   895             20  FILLER              PIC X.
   896             20  EMI-ERROR-TEXT.
   897                 24  EMI-TEXT-VARIABLE   PIC X(10).
   898                 24  FILLER          PIC X(55).
   899     12  EMI-SEVERITY-SAVE           PIC X.
   900         88  EMI-NOTE                    VALUE 'N'.
   901         88  EMI-WARNING                 VALUE 'W'.
   902         88  EMI-FORCABLE                VALUE 'F'.
   903         88  EMI-FATAL                   VALUE 'X'.
   904     12  EMI-MESSAGE-FLAG            PIC X.
   905         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   906         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   907     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   908     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   909         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   910         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   911         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   912     12  emi-claim-no                pic x(7).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  18
* EL6316.cbl
   913     12  emi-claim-type              pic x(6).
   914     12  FILLER                      PIC X(124)  VALUE SPACES.
   915     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   916     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   917     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   918     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   919*    COPY ELCTEXT.
   920******************************************************************
   921*                                                                *
   922*                                                                *
   923*                            ELCTEXT.                            *
   924*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   925*                            VMOD=2.008                          *
   926*                                                                *
   927*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   928*                                     FORM LETTERS,              *
   929*                                     CERT FORM DISPLAY.
   930*                                                                *
   931*   FILE TYPE = VSAM,KSDS                                        *
   932*   RECORD SIZE = 100   RECFORM = FIXED                          *
   933*                                                                *
   934*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   935*       ALTERNATE INDEX = NONE                                   *
   936*                                                                *
   937*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   938*       ALTERNATE INDEX = NONE                                   *
   939*                                                                *
   940*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   941*       ALTERNATE INDEX = NONE                                   *
   942*                                                                *
   943*   LOG = NO                                                     *
   944*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   945******************************************************************
   946 01  TEXT-FILES.
   947     12  TEXT-FILE-ID                PIC XX.
   948         88  FORMS-FILE-TEXT            VALUE 'TF'.
   949         88  LETTER-FILE-TEXT           VALUE 'TL'.
   950         88  HELP-FILE-TEXT             VALUE 'TH'.
   951
   952     12  TX-CONTROL-PRIMARY.
   953         16  TX-COMPANY-CD           PIC X.
   954             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   955         16  TX-ACCESS-CD-GENL       PIC X(12).
   956
   957         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   958             20  TX-LETTER-NO        PIC X(4).
   959             20  FILLER              PIC X(8).
   960
   961         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   962             20  TX-FORM-NO          PIC X(12).
   963
   964         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   965             20  TX-HELP-TYPE        PIC X.
   966                 88  HELP-FOR-GENERAL   VALUE ' '.
   967                 88  HELP-BY-SCREEN     VALUE 'S'.
   968                 88  HELP-BY-ERROR      VALUE 'E'.
   969             20  TX-SCREEN-OR-ERROR  PIC X(4).
   970                 88  GENERAL-INFO-HELP  VALUE '0000'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  19
* EL6316.cbl
   971             20  TX-HELP-FOR-COMPANY  PIC XXX.
   972                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   973             20  FILLER              PIC X(4).
   974
   975         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   976
   977     12  TX-PROCESS-CONTROL          PIC XX.
   978         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   979
   980     12  TX-TEXT-LINE                PIC X(70).
   981
   982     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   983         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   984         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   985         88  TX-VALID-FORM-SQUEEZE-VALUE
   986                                        VALUE 'Y' ' '.
   987
   988     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   989         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   990         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   991         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   992         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   993         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   994         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   995         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   996                                              'K' 'N' ' '
   997                                              'Z'.
   998
   999     12  TX-ARCHIVE-SW               PIC X.
  1000         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1001         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1002         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1003
  1004     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1005     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1006
  1007     12  TX-BSR-CODE                 PIC X.
  1008         88  TX-BSR-LETTER              VALUE 'B'.
  1009         88  TX-NON-BSR-LETTER          VALUE ' '.
  1010
  1011     12  FILLER                      PIC X.
  1012*****************************************************************
  1013*    COPY ELCINTF.
  1014******************************************************************
  1015*                                                                *
  1016*                                                                *
  1017*                            ELCINTF.                            *
  1018*                            VMOD=2.017                          *
  1019*                                                                *
  1020*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1021*                                                                *
  1022*       LENGTH = 1024                                            *
  1023*                                                                *
  1024******************************************************************
  1025*                   C H A N G E   L O G
  1026*
  1027* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1028*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  20
* EL6316.cbl
  1029*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1030* EFFECTIVE    NUMBER
  1031*-----------------------------------------------------------------
  1032* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1033******************************************************************
  1034 01  PROGRAM-INTERFACE-BLOCK.
  1035     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1036     12  PI-CALLING-PROGRAM              PIC X(8).
  1037     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1038     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1039     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1040     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1041     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1042     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1043     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1044     12  PI-COMPANY-ID                   PIC XXX.
  1045     12  PI-COMPANY-CD                   PIC X.
  1046
  1047     12  PI-COMPANY-PASSWORD             PIC X(8).
  1048
  1049     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1050
  1051     12  PI-CONTROL-IN-PROGRESS.
  1052         16  PI-CARRIER                  PIC X.
  1053         16  PI-GROUPING                 PIC X(6).
  1054         16  PI-STATE                    PIC XX.
  1055         16  PI-ACCOUNT                  PIC X(10).
  1056         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1057                                         PIC X(10).
  1058         16  PI-CLAIM-CERT-GRP.
  1059             20  PI-CLAIM-NO             PIC X(7).
  1060             20  PI-CERT-NO.
  1061                 25  PI-CERT-PRIME       PIC X(10).
  1062                 25  PI-CERT-SFX         PIC X.
  1063             20  PI-CERT-EFF-DT          PIC XX.
  1064         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1065             20  PI-PLAN-CODE            PIC X(2).
  1066             20  PI-REVISION-NUMBER      PIC X(3).
  1067             20  PI-PLAN-EFF-DT          PIC X(2).
  1068             20  PI-PLAN-EXP-DT          PIC X(2).
  1069             20  FILLER                  PIC X(11).
  1070         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1071             20  PI-OE-REFERENCE-1.
  1072                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1073                 25  PI-OE-REF-1-SUFF    PIC XX.
  1074
  1075     12  PI-SESSION-IN-PROGRESS          PIC X.
  1076         88  CLAIM-SESSION                   VALUE '1'.
  1077         88  CREDIT-SESSION                  VALUE '2'.
  1078         88  WARRANTY-SESSION                VALUE '3'.
  1079         88  MORTGAGE-SESSION                VALUE '4'.
  1080         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1081
  1082
  1083*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1084
  1085     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1086     12  PI-ORIGINAL-COMPANY-CD          PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  21
* EL6316.cbl
  1087
  1088     12  PI-CREDIT-USER                  PIC X.
  1089         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1090         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1091
  1092     12  PI-CLAIM-USER                   PIC X.
  1093         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1094         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1095
  1096     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1097         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1098         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1099         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1100         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1101         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1102
  1103     12  PI-PROCESSOR-ID                 PIC X(4).
  1104
  1105     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1106
  1107     12  PI-MEMBER-CAPTION               PIC X(10).
  1108
  1109     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1110         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1111
  1112     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1113     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1114     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1115     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1116
  1117     12  PI-AH-OVERRIDE-L1               PIC X.
  1118     12  PI-AH-OVERRIDE-L2               PIC XX.
  1119     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1120     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1121
  1122     12  PI-NEW-SYSTEM                   PIC X(2).
  1123
  1124     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1125     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1126         88  PI-USES-PAID-TO                 VALUE '1'.
  1127     12  PI-CRDTCRD-SYSTEM.
  1128         16  PI-CRDTCRD-USER             PIC X.
  1129             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1130             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1131         16  PI-CC-MONTH-END-DT          PIC XX.
  1132     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1133
  1134     12  PI-OE-REFERENCE-2.
  1135         16  PI-OE-REF-2-PRIME           PIC X(10).
  1136         16  PI-OE-REF-2-SUFF            PIC X.
  1137
  1138     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1139
  1140     12  PI-LANGUAGE-TYPE                PIC X.
  1141             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1142             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1143             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1144
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  22
* EL6316.cbl
  1145     12  PI-POLICY-LINKAGE-IND           PIC X.
  1146         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1147         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1148                                                   LOW-VALUES.
  1149
  1150     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1151     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1152         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1153         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1154
  1155     12  PI-PROCESSOR-CSR-IND            PIC X.
  1156         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1157         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1158
  1159     12  FILLER                          PIC X(3).
  1160
  1161     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1162
  1163     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1164         PI-SYSTEM-LEVEL.
  1165
  1166         16  PI-ENTRY-CODES.
  1167             20  PI-ENTRY-CD-1           PIC X.
  1168             20  PI-ENTRY-CD-2           PIC X.
  1169
  1170         16  PI-RETURN-CODES.
  1171             20  PI-RETURN-CD-1          PIC X.
  1172             20  PI-RETURN-CD-2          PIC X.
  1173
  1174         16  PI-UPDATE-STATUS-SAVE.
  1175             20  PI-UPDATE-BY            PIC X(4).
  1176             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1177
  1178         16  PI-LOWER-CASE-LETTERS       PIC X.
  1179             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1180
  1181*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1182*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1183*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1184
  1185         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1186             88  ST-ACCNT-CNTL               VALUE ' '.
  1187             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1188             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1189             88  ACCNT-CNTL                  VALUE '3'.
  1190             88  CARR-ACCNT-CNTL             VALUE '4'.
  1191
  1192         16  PI-PROCESSOR-CAP-LIST.
  1193             20  PI-SYSTEM-CONTROLS.
  1194                24 PI-SYSTEM-DISPLAY     PIC X.
  1195                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1196                24 PI-SYSTEM-MODIFY      PIC X.
  1197                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1198             20  FILLER                  PIC XX.
  1199             20  PI-DISPLAY-CAP          PIC X.
  1200                 88  DISPLAY-CAP             VALUE 'Y'.
  1201             20  PI-MODIFY-CAP           PIC X.
  1202                 88  MODIFY-CAP              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  23
* EL6316.cbl
  1203             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1204                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1205             20  PI-FORCE-CAP            PIC X.
  1206                 88  FORCE-CAP               VALUE 'Y'.
  1207
  1208         16  PI-PROGRAM-CONTROLS.
  1209             20  PI-PGM-PRINT-OPT        PIC X.
  1210             20  PI-PGM-FORMAT-OPT       PIC X.
  1211             20  PI-PGM-PROCESS-OPT      PIC X.
  1212             20  PI-PGM-TOTALS-OPT       PIC X.
  1213
  1214         16  PI-HELP-INTERFACE.
  1215             20  PI-LAST-ERROR-NO        PIC X(4).
  1216             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1217
  1218         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1219             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1220
  1221         16  PI-CR-CONTROL-IN-PROGRESS.
  1222             20  PI-CR-CARRIER           PIC X.
  1223             20  PI-CR-GROUPING          PIC X(6).
  1224             20  PI-CR-STATE             PIC XX.
  1225             20  PI-CR-ACCOUNT           PIC X(10).
  1226             20  PI-CR-FIN-RESP          PIC X(10).
  1227             20  PI-CR-TYPE              PIC X.
  1228
  1229         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1230
  1231         16  PI-CR-MONTH-END-DT          PIC XX.
  1232
  1233         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1234             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1235             88  PI-ZERO-CARRIER             VALUE '1'.
  1236             88  PI-ZERO-GROUPING            VALUE '2'.
  1237             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1238
  1239         16  PI-CARRIER-SECURITY         PIC X.
  1240             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1241
  1242         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1243             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1244             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1245
  1246         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1247             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1248                                         INDEXED BY PI-ACCESS-NDX
  1249                                         PIC X.
  1250
  1251         16  PI-GA-BILLING-CONTROL       PIC X.
  1252             88  PI-GA-BILLING               VALUE '1'.
  1253
  1254         16  PI-MAIL-PROCESSING          PIC X.
  1255             88  PI-MAIL-YES                 VALUE 'Y'.
  1256
  1257         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1258
  1259         16  PI-AR-SYSTEM.
  1260             20  PI-AR-PROCESSING-CNTL   PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  24
* EL6316.cbl
  1261                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1262             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1263             20  PI-AR-MONTH-END-DT      PIC XX.
  1264
  1265         16  PI-MP-SYSTEM.
  1266             20  PI-MORTGAGE-USER            PIC X.
  1267                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1268                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1269             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1270                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1271                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1272                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1273                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1274                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1275             20  PI-MP-MONTH-END-DT          PIC XX.
  1276             20  PI-MP-REFERENCE-NO.
  1277                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1278                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1279
  1280         16  PI-LABEL-CONTROL            PIC X(01).
  1281             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1282             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1283
  1284         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1285             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1286
  1287         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1288             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1289             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1290
  1291         16  FILLER                      PIC X(14).
  1292
  1293     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1294******************************************************************
  1295     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1296        16  PI-ISS-CAN-SW           PIC X.
  1297        16  PI-ERENDT-KEY.
  1298            20  PI-ENDT-COMPANY-CD  PIC X.
  1299            20  PI-ENDT-CARRIER     PIC X.
  1300            20  PI-ENDT-GROUPING    PIC X(6).
  1301            20  PI-ENDT-STATE       PIC XX.
  1302            20  PI-ENDT-ACCOUNT     PIC X(10).
  1303            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1304            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1305            20  PI-ENDT-CERT-SFX    PIC X.
  1306            20  PI-ENDT-RECORD-TYPE PIC X.
  1307            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1308        16  PI-ELCRTO-KEY.
  1309            20  PI-CRTO-COMPANY-CD  PIC X.
  1310            20  PI-CRTO-CARRIER     PIC X.
  1311            20  PI-CRTO-GROUPING    PIC X(6).
  1312            20  PI-CRTO-STATE       PIC XX.
  1313            20  PI-CRTO-ACCOUNT     PIC X(10).
  1314            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1315            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1316            20  PI-CRTO-CERT-SFX    PIC X.
  1317            20  PI-CRTO-RECORD-TYPE PIC X.
  1318            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  25
* EL6316.cbl
  1319        16  PI-ERPNDB-KEY           PIC X(11).
  1320        16  PI-DOCUMENT-PROCESSED   PIC X.
  1321            88  PI-VERI-PROCESSED      VALUE 'V'.
  1322            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1323        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1324        16  PI-RES-REF-CLM-TYPE     PIC X.
  1325        16  PI-CLM-RESC-IND         PIC X.
  1326            88  PI-CLM-RESCISSION      VALUE 'Y'.
  1327        16  PI-CLEAR-ERROR-SW       PIC X.
  1328            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1329        16  PI-PRTSW-ENTERED        PIC X.
  1330        16  PI-LTRID-ENTERED        PIC X(4).
  1331        16  PI-REASONS-ENTERED      PIC X(84).
  1332        16  PI-CERTNT1-ENTERED      PIC X(63).
  1333        16  PI-CERTNT2-ENTERED      PIC X(63).
  1334        16  FILLER                  PIC X(20).
  1335        16  PI-FINALIZED-IND        PIC X.
  1336        16  PI-BILLNT1-ENTERED      PIC X(63).
  1337        16  PI-ENCCODE              PIC X(3).
  1338        16  PI-FROM-CERT            PIC X.
  1339        16  PI-ENDORSE-RECORD       PIC X.
  1340        16  FILLER                  PIC X(212).
  1341    12  FILLER                      PIC X(276).
  1342*    COPY ELCAID.
  1343******************************************************************
  1344*                                                                *
  1345*                            ELCAID.                             *
  1346*                            VMOD=2.001                          *
  1347*                                                                *
  1348*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1349*                                                                *
  1350*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1351*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1352******************************************************************
  1353
  1354 01  DFHAID.
  1355   02  DFHNULL   PIC  X  VALUE  ' '.
  1356   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1357   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1358   02  DFHPEN    PIC  X  VALUE  '='.
  1359   02  DFHOPID   PIC  X  VALUE  'W'.
  1360   02  DFHPA1    PIC  X  VALUE  '%'.
  1361   02  DFHPA2    PIC  X  VALUE  '>'.
  1362   02  DFHPA3    PIC  X  VALUE  ','.
  1363   02  DFHPF1    PIC  X  VALUE  '1'.
  1364   02  DFHPF2    PIC  X  VALUE  '2'.
  1365   02  DFHPF3    PIC  X  VALUE  '3'.
  1366   02  DFHPF4    PIC  X  VALUE  '4'.
  1367   02  DFHPF5    PIC  X  VALUE  '5'.
  1368   02  DFHPF6    PIC  X  VALUE  '6'.
  1369   02  DFHPF7    PIC  X  VALUE  '7'.
  1370   02  DFHPF8    PIC  X  VALUE  '8'.
  1371   02  DFHPF9    PIC  X  VALUE  '9'.
  1372   02  DFHPF10   PIC  X  VALUE  ':'.
  1373   02  DFHPF11   PIC  X  VALUE  '#'.
  1374   02  DFHPF12   PIC  X  VALUE  '@'.
  1375   02  DFHPF13   PIC  X  VALUE  'A'.
  1376   02  DFHPF14   PIC  X  VALUE  'B'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  26
* EL6316.cbl
  1377   02  DFHPF15   PIC  X  VALUE  'C'.
  1378   02  DFHPF16   PIC  X  VALUE  'D'.
  1379   02  DFHPF17   PIC  X  VALUE  'E'.
  1380   02  DFHPF18   PIC  X  VALUE  'F'.
  1381   02  DFHPF19   PIC  X  VALUE  'G'.
  1382   02  DFHPF20   PIC  X  VALUE  'H'.
  1383   02  DFHPF21   PIC  X  VALUE  'I'.
  1384*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1385   02  DFHPF22   PIC  X  VALUE  '['.
  1386   02  DFHPF23   PIC  X  VALUE  '.'.
  1387   02  DFHPF24   PIC  X  VALUE  '<'.
  1388   02  DFHMSRE   PIC  X  VALUE  'X'.
  1389   02  DFHSTRF   PIC  X  VALUE  'h'.
  1390   02  DFHTRIG   PIC  X  VALUE  '"'.
  1391 01  FILLER    REDEFINES DFHAID.
  1392     12  FILLER              PIC X(8).
  1393     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1394*   COPY EL6316S.
  1395 01  EL631II.
  1396     05  FILLER            PIC  X(0012).
  1397*    -------------------------------
  1398     05  DATEL PIC S9(0004) COMP.
  1399     05  DATEF PIC  X(0001).
  1400     05  FILLER REDEFINES DATEF.
  1401         10  DATEA PIC  X(0001).
  1402     05  DATEI PIC  X(0008).
  1403*    -------------------------------
  1404     05  TIMEL PIC S9(0004) COMP.
  1405     05  TIMEF PIC  X(0001).
  1406     05  FILLER REDEFINES TIMEF.
  1407         10  TIMEA PIC  X(0001).
  1408     05  TIMEI PIC  X(0005).
  1409*    -------------------------------
  1410     05  PROCIDL PIC S9(0004) COMP.
  1411     05  PROCIDF PIC  X(0001).
  1412     05  FILLER REDEFINES PROCIDF.
  1413         10  PROCIDA PIC  X(0001).
  1414     05  PROCIDI PIC  X(0004).
  1415*    -------------------------------
  1416     05  HOSTL PIC S9(0004) COMP.
  1417     05  HOSTF PIC  X(0001).
  1418     05  FILLER REDEFINES HOSTF.
  1419         10  HOSTA PIC  X(0001).
  1420     05  HOSTI PIC  X(0009).
  1421*    -------------------------------
  1422     05  SYSL PIC S9(0004) COMP.
  1423     05  SYSF PIC  X(0001).
  1424     05  FILLER REDEFINES SYSF.
  1425         10  SYSA PIC  X(0001).
  1426     05  SYSI PIC  X(0005).
  1427*    -------------------------------
  1428     05  COMPANYL PIC S9(0004) COMP.
  1429     05  COMPANYF PIC  X(0001).
  1430     05  FILLER REDEFINES COMPANYF.
  1431         10  COMPANYA PIC  X(0001).
  1432     05  COMPANYI PIC  X(0003).
  1433*    -------------------------------
  1434     05  DATASORL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  27
* EL6316.cbl
  1435     05  DATASORF PIC  X(0001).
  1436     05  FILLER REDEFINES DATASORF.
  1437         10  DATASORA PIC  X(0001).
  1438     05  DATASORI PIC  X(0001).
  1439*    -------------------------------
  1440     05  BATCHNOL PIC S9(0004) COMP.
  1441     05  BATCHNOF PIC  X(0001).
  1442     05  FILLER REDEFINES BATCHNOF.
  1443         10  BATCHNOA PIC  X(0001).
  1444     05  BATCHNOI PIC  X(0006).
  1445*    -------------------------------
  1446     05  BSEQNOL PIC S9(0004) COMP.
  1447     05  BSEQNOF PIC  X(0001).
  1448     05  FILLER REDEFINES BSEQNOF.
  1449         10  BSEQNOA PIC  X(0001).
  1450     05  BSEQNOI PIC  X(0008).
  1451*    -------------------------------
  1452     05  ARCHNOL PIC S9(0004) COMP.
  1453     05  ARCHNOF PIC  X(0001).
  1454     05  FILLER REDEFINES ARCHNOF.
  1455         10  ARCHNOA PIC  X(0001).
  1456     05  ARCHNOI PIC  X(0008).
  1457*    -------------------------------
  1458     05  PRTSWL PIC S9(0004) COMP.
  1459     05  PRTSWF PIC  X(0001).
  1460     05  FILLER REDEFINES PRTSWF.
  1461         10  PRTSWA PIC  X(0001).
  1462     05  PRTSWI PIC  X(0001).
  1463*    -------------------------------
  1464     05  CARRL PIC S9(0004) COMP.
  1465     05  CARRF PIC  X(0001).
  1466     05  FILLER REDEFINES CARRF.
  1467         10  CARRA PIC  X(0001).
  1468     05  CARRI PIC  X(0001).
  1469*    -------------------------------
  1470     05  GROUPL PIC S9(0004) COMP.
  1471     05  GROUPF PIC  X(0001).
  1472     05  FILLER REDEFINES GROUPF.
  1473         10  GROUPA PIC  X(0001).
  1474     05  GROUPI PIC  X(0006).
  1475*    -------------------------------
  1476     05  STATEL PIC S9(0004) COMP.
  1477     05  STATEF PIC  X(0001).
  1478     05  FILLER REDEFINES STATEF.
  1479         10  STATEA PIC  X(0001).
  1480     05  STATEI PIC  X(0002).
  1481*    -------------------------------
  1482     05  ACCTL PIC S9(0004) COMP.
  1483     05  ACCTF PIC  X(0001).
  1484     05  FILLER REDEFINES ACCTF.
  1485         10  ACCTA PIC  X(0001).
  1486     05  ACCTI PIC  X(0010).
  1487*    -------------------------------
  1488     05  EFFDTL PIC S9(0004) COMP.
  1489     05  EFFDTF PIC  X(0001).
  1490     05  FILLER REDEFINES EFFDTF.
  1491         10  EFFDTA PIC  X(0001).
  1492     05  EFFDTI PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  28
* EL6316.cbl
  1493*    -------------------------------
  1494     05  CERTNOL PIC S9(0004) COMP.
  1495     05  CERTNOF PIC  X(0001).
  1496     05  FILLER REDEFINES CERTNOF.
  1497         10  CERTNOA PIC  X(0001).
  1498     05  CERTNOI PIC  X(0010).
  1499*    -------------------------------
  1500     05  CRTSFXL PIC S9(0004) COMP.
  1501     05  CRTSFXF PIC  X(0001).
  1502     05  FILLER REDEFINES CRTSFXF.
  1503         10  CRTSFXA PIC  X(0001).
  1504     05  CRTSFXI PIC  X(0001).
  1505*    -------------------------------
  1506     05  LTRIDL PIC S9(0004) COMP.
  1507     05  LTRIDF PIC  X(0001).
  1508     05  FILLER REDEFINES LTRIDF.
  1509         10  LTRIDA PIC  X(0001).
  1510     05  LTRIDI PIC  X(0004).
  1511*    -------------------------------
  1512     05  SEQNOL PIC S9(0004) COMP.
  1513     05  SEQNOF PIC  X(0001).
  1514     05  FILLER REDEFINES SEQNOF.
  1515         10  SEQNOA PIC  X(0001).
  1516     05  SEQNOI PIC  X(0006).
  1517*    -------------------------------
  1518     05  FNAMEL PIC S9(0004) COMP.
  1519     05  FNAMEF PIC  X(0001).
  1520     05  FILLER REDEFINES FNAMEF.
  1521         10  FNAMEA PIC  X(0001).
  1522     05  FNAMEI PIC  X(0010).
  1523*    -------------------------------
  1524     05  MINITL PIC S9(0004) COMP.
  1525     05  MINITF PIC  X(0001).
  1526     05  FILLER REDEFINES MINITF.
  1527         10  MINITA PIC  X(0001).
  1528     05  MINITI PIC  X(0001).
  1529*    -------------------------------
  1530     05  LNAMEL PIC S9(0004) COMP.
  1531     05  LNAMEF PIC  X(0001).
  1532     05  FILLER REDEFINES LNAMEF.
  1533         10  LNAMEA PIC  X(0001).
  1534     05  LNAMEI PIC  X(0015).
  1535*    -------------------------------
  1536     05  ENCCODEL PIC S9(0004) COMP.
  1537     05  ENCCODEF PIC  X(0001).
  1538     05  FILLER REDEFINES ENCCODEF.
  1539         10  ENCCODEA PIC  X(0001).
  1540     05  ENCCODEI PIC  X(0003).
  1541*    -------------------------------
  1542     05  OLFDTL PIC S9(0004) COMP.
  1543     05  OLFDTF PIC  X(0001).
  1544     05  FILLER REDEFINES OLFDTF.
  1545         10  OLFDTA PIC  X(0001).
  1546     05  OLFDTI PIC  X(0008).
  1547*    -------------------------------
  1548     05  OLFAMTL PIC S9(0004) COMP.
  1549     05  OLFAMTF PIC  X(0001).
  1550     05  FILLER REDEFINES OLFAMTF.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  29
* EL6316.cbl
  1551         10  OLFAMTA PIC  X(0001).
  1552     05  OLFAMTI PIC  X(0010).
  1553*    -------------------------------
  1554     05  OAHDTL PIC S9(0004) COMP.
  1555     05  OAHDTF PIC  X(0001).
  1556     05  FILLER REDEFINES OAHDTF.
  1557         10  OAHDTA PIC  X(0001).
  1558     05  OAHDTI PIC  X(0008).
  1559*    -------------------------------
  1560     05  OAHAMTL PIC S9(0004) COMP.
  1561     05  OAHAMTF PIC  X(0001).
  1562     05  FILLER REDEFINES OAHAMTF.
  1563         10  OAHAMTA PIC  X(0001).
  1564     05  OAHAMTI PIC  X(0010).
  1565*    -------------------------------
  1566     05  NLFDTL PIC S9(0004) COMP.
  1567     05  NLFDTF PIC  X(0001).
  1568     05  FILLER REDEFINES NLFDTF.
  1569         10  NLFDTA PIC  X(0001).
  1570     05  NLFDTI PIC  X(0008).
  1571*    -------------------------------
  1572     05  NLFAMTL PIC S9(0004) COMP.
  1573     05  NLFAMTF PIC  X(0001).
  1574     05  FILLER REDEFINES NLFAMTF.
  1575         10  NLFAMTA PIC  X(0001).
  1576     05  NLFAMTI PIC  X(0010).
  1577*    -------------------------------
  1578     05  NAHDTL PIC S9(0004) COMP.
  1579     05  NAHDTF PIC  X(0001).
  1580     05  FILLER REDEFINES NAHDTF.
  1581         10  NAHDTA PIC  X(0001).
  1582     05  NAHDTI PIC  X(0008).
  1583*    -------------------------------
  1584     05  NAHAMTL PIC S9(0004) COMP.
  1585     05  NAHAMTF PIC  X(0001).
  1586     05  FILLER REDEFINES NAHAMTF.
  1587         10  NAHAMTA PIC  X(0001).
  1588     05  NAHAMTI PIC  X(0010).
  1589*    -------------------------------
  1590     05  INPDTL PIC S9(0004) COMP.
  1591     05  INPDTF PIC  X(0001).
  1592     05  FILLER REDEFINES INPDTF.
  1593         10  INPDTA PIC  X(0001).
  1594     05  INPDTI PIC  X(0008).
  1595*    -------------------------------
  1596     05  PROCDTL PIC S9(0004) COMP.
  1597     05  PROCDTF PIC  X(0001).
  1598     05  FILLER REDEFINES PROCDTF.
  1599         10  PROCDTA PIC  X(0001).
  1600     05  PROCDTI PIC  X(0008).
  1601*    -------------------------------
  1602     05  LFCOMML PIC S9(0004) COMP.
  1603     05  LFCOMMF PIC  X(0001).
  1604     05  FILLER REDEFINES LFCOMMF.
  1605         10  LFCOMMA PIC  X(0001).
  1606     05  LFCOMMI PIC  X(0006).
  1607*    -------------------------------
  1608     05  AHCOMML PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  30
* EL6316.cbl
  1609     05  AHCOMMF PIC  X(0001).
  1610     05  FILLER REDEFINES AHCOMMF.
  1611         10  AHCOMMA PIC  X(0001).
  1612     05  AHCOMMI PIC  X(0006).
  1613*    -------------------------------
  1614     05  RCD01L PIC S9(0004) COMP.
  1615     05  RCD01F PIC  X(0001).
  1616     05  FILLER REDEFINES RCD01F.
  1617         10  RCD01A PIC  X(0001).
  1618     05  RCD01I PIC  X(0004).
  1619*    -------------------------------
  1620     05  RCD02L PIC S9(0004) COMP.
  1621     05  RCD02F PIC  X(0001).
  1622     05  FILLER REDEFINES RCD02F.
  1623         10  RCD02A PIC  X(0001).
  1624     05  RCD02I PIC  X(0004).
  1625*    -------------------------------
  1626     05  RCD03L PIC S9(0004) COMP.
  1627     05  RCD03F PIC  X(0001).
  1628     05  FILLER REDEFINES RCD03F.
  1629         10  RCD03A PIC  X(0001).
  1630     05  RCD03I PIC  X(0004).
  1631*    -------------------------------
  1632     05  RCD04L PIC S9(0004) COMP.
  1633     05  RCD04F PIC  X(0001).
  1634     05  FILLER REDEFINES RCD04F.
  1635         10  RCD04A PIC  X(0001).
  1636     05  RCD04I PIC  X(0004).
  1637*    -------------------------------
  1638     05  RCD05L PIC S9(0004) COMP.
  1639     05  RCD05F PIC  X(0001).
  1640     05  FILLER REDEFINES RCD05F.
  1641         10  RCD05A PIC  X(0001).
  1642     05  RCD05I PIC  X(0004).
  1643*    -------------------------------
  1644     05  RCD06L PIC S9(0004) COMP.
  1645     05  RCD06F PIC  X(0001).
  1646     05  FILLER REDEFINES RCD06F.
  1647         10  RCD06A PIC  X(0001).
  1648     05  RCD06I PIC  X(0004).
  1649*    -------------------------------
  1650     05  RCD07L PIC S9(0004) COMP.
  1651     05  RCD07F PIC  X(0001).
  1652     05  FILLER REDEFINES RCD07F.
  1653         10  RCD07A PIC  X(0001).
  1654     05  RCD07I PIC  X(0004).
  1655*    -------------------------------
  1656     05  RCD08L PIC S9(0004) COMP.
  1657     05  RCD08F PIC  X(0001).
  1658     05  FILLER REDEFINES RCD08F.
  1659         10  RCD08A PIC  X(0001).
  1660     05  RCD08I PIC  X(0004).
  1661*    -------------------------------
  1662     05  RCD09L PIC S9(0004) COMP.
  1663     05  RCD09F PIC  X(0001).
  1664     05  FILLER REDEFINES RCD09F.
  1665         10  RCD09A PIC  X(0001).
  1666     05  RCD09I PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  31
* EL6316.cbl
  1667*    -------------------------------
  1668     05  RCD10L PIC S9(0004) COMP.
  1669     05  RCD10F PIC  X(0001).
  1670     05  FILLER REDEFINES RCD10F.
  1671         10  RCD10A PIC  X(0001).
  1672     05  RCD10I PIC  X(0004).
  1673*    -------------------------------
  1674     05  RCD11L PIC S9(0004) COMP.
  1675     05  RCD11F PIC  X(0001).
  1676     05  FILLER REDEFINES RCD11F.
  1677         10  RCD11A PIC  X(0001).
  1678     05  RCD11I PIC  X(0004).
  1679*    -------------------------------
  1680     05  RCD12L PIC S9(0004) COMP.
  1681     05  RCD12F PIC  X(0001).
  1682     05  FILLER REDEFINES RCD12F.
  1683         10  RCD12A PIC  X(0001).
  1684     05  RCD12I PIC  X(0004).
  1685*    -------------------------------
  1686     05  CRTNT1L PIC S9(0004) COMP.
  1687     05  CRTNT1F PIC  X(0001).
  1688     05  FILLER REDEFINES CRTNT1F.
  1689         10  CRTNT1A PIC  X(0001).
  1690     05  CRTNT1I PIC  X(0063).
  1691*    -------------------------------
  1692     05  CRTNT2L PIC S9(0004) COMP.
  1693     05  CRTNT2F PIC  X(0001).
  1694     05  FILLER REDEFINES CRTNT2F.
  1695         10  CRTNT2A PIC  X(0001).
  1696     05  CRTNT2I PIC  X(0063).
  1697*    -------------------------------
  1698     05  BILNT1L PIC S9(0004) COMP.
  1699     05  BILNT1F PIC  X(0001).
  1700     05  FILLER REDEFINES BILNT1F.
  1701         10  BILNT1A PIC  X(0001).
  1702     05  BILNT1I PIC  X(0063).
  1703*    -------------------------------
  1704     05  ERRMSGL PIC S9(0004) COMP.
  1705     05  ERRMSGF PIC  X(0001).
  1706     05  FILLER REDEFINES ERRMSGF.
  1707         10  ERRMSGA PIC  X(0001).
  1708     05  ERRMSGI PIC  X(0075).
  1709*    -------------------------------
  1710     05  PFENTRL PIC S9(0004) COMP.
  1711     05  PFENTRF PIC  X(0001).
  1712     05  FILLER REDEFINES PFENTRF.
  1713         10  PFENTRA PIC  X(0001).
  1714     05  PFENTRI PIC  9(2).
  1715*    -------------------------------
  1716     05  PF3L PIC S9(0004) COMP.
  1717     05  PF3F PIC  X(0001).
  1718     05  FILLER REDEFINES PF3F.
  1719         10  PF3A PIC  X(0001).
  1720     05  PF3I PIC  X(0019).
  1721*    -------------------------------
  1722     05  PF4L PIC S9(0004) COMP.
  1723     05  PF4F PIC  X(0001).
  1724     05  FILLER REDEFINES PF4F.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  32
* EL6316.cbl
  1725         10  PF4A PIC  X(0001).
  1726     05  PF4I PIC  X(0019).
  1727 01  EL631IO REDEFINES EL631II.
  1728     05  FILLER            PIC  X(0012).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  DATEO PIC  X(0008).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  TIMEO PIC  99.99.
  1735*    -------------------------------
  1736     05  FILLER            PIC  X(0003).
  1737     05  PROCIDO PIC  X(0004).
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  HOSTO PIC  X(0009).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  SYSO PIC  X(0005).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  COMPANYO PIC  X(0003).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  DATASORO PIC  X(0001).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  BATCHNOO PIC  X(0006).
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  BSEQNOO PIC  X(0008).
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  ARCHNOO PIC  X(0008).
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  PRTSWO PIC  X(0001).
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  CARRO PIC  X(0001).
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  GROUPO PIC  X(0006).
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  STATEO PIC  X(0002).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  ACCTO PIC  X(0010).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  EFFDTO PIC  X(0008).
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  CERTNOO PIC  X(0010).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  CRTSFXO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  33
* EL6316.cbl
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  LTRIDO PIC  X(0004).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  SEQNOO PIC  999999.
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  FNAMEO PIC  X(0010).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  MINITO PIC  X(0001).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  LNAMEO PIC  X(0015).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  ENCCODEO PIC  X(0003).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  OLFDTO PIC  X(0008).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  OLFAMTO PIC  ZZZZ999.99.
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  OAHDTO PIC  X(0008).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  OAHAMTO PIC  ZZZZ999.99.
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  NLFDTO PIC  X(0008).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  NLFAMTO PIC  ZZZZ999.99.
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  NAHDTO PIC  X(0008).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  NAHAMTO PIC  ZZZZ999.99.
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  INPDTO PIC  X(0008).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  PROCDTO PIC  X(0008).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  LFCOMMO PIC  .99999.
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  AHCOMMO PIC  .99999.
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  RCD01O PIC  X(0004).
  1840*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  34
* EL6316.cbl
  1841     05  FILLER            PIC  X(0003).
  1842     05  RCD02O PIC  X(0004).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  RCD03O PIC  X(0004).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  RCD04O PIC  X(0004).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  RCD05O PIC  X(0004).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  RCD06O PIC  X(0004).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  RCD07O PIC  X(0004).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  RCD08O PIC  X(0004).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  RCD09O PIC  X(0004).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  RCD10O PIC  X(0004).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  RCD11O PIC  X(0004).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  RCD12O PIC  X(0004).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  CRTNT1O PIC  X(0063).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  CRTNT2O PIC  X(0063).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  BILNT1O PIC  X(0063).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  ERRMSGO PIC  X(0075).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  PFENTRO PIC  X(0002).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  PF3O PIC  X(0019).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  PF4O PIC  X(0019).
  1894*    -------------------------------
  1895 01  FILLER REDEFINES EL631II.
  1896     12  FILLER                   PIC X(355).
  1897     12  REASONCDS.
  1898         16  FILLER OCCURS 12.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  35
* EL6316.cbl
  1899             20  REACDL       PIC S9(4) COMP.
  1900             20  REACDA       PIC X.
  1901             20  REACD-IN     PIC X(4).
  1902     12  FILLER               PIC X(215).
  1903****************************************************************
  1904*
  1905* Copyright (c) 2007 by Clerity Solutions, Inc.
  1906* All rights reserved.
  1907*
  1908****************************************************************
  1909 01  DFHEIV.
  1910   02  DFHEIV0               PIC X(35).
  1911   02  DFHEIV1               PIC X(08).
  1912   02  DFHEIV2               PIC X(08).
  1913   02  DFHEIV3               PIC X(08).
  1914   02  DFHEIV4               PIC X(06).
  1915   02  DFHEIV5               PIC X(04).
  1916   02  DFHEIV6               PIC X(04).
  1917   02  DFHEIV7               PIC X(02).
  1918   02  DFHEIV8               PIC X(02).
  1919   02  DFHEIV9               PIC X(01).
  1920   02  DFHEIV10              PIC S9(7) COMP-3.
  1921   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1922   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1923   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1924   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1925   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1926   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1927   02  DFHEIV17              PIC X(04).
  1928   02  DFHEIV18              PIC X(04).
  1929   02  DFHEIV19              PIC X(04).
  1930   02  DFHEIV20              USAGE IS POINTER.
  1931   02  DFHEIV21              USAGE IS POINTER.
  1932   02  DFHEIV22              USAGE IS POINTER.
  1933   02  DFHEIV23              USAGE IS POINTER.
  1934   02  DFHEIV24              USAGE IS POINTER.
  1935   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1936   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1937   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1938   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1939   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1940   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1941   02  FILLER                PIC X(02).
  1942   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1943   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1944   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1945   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1946   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1947 LINKAGE  SECTION.
  1948*****************************************************************
  1949*                                                               *
  1950* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1951* All rights reserved.                                          *
  1952*                                                               *
  1953*****************************************************************
  1954 01  dfheiblk.
  1955     02  eibtime          pic s9(7) comp-3.
  1956     02  eibdate          pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  36
* EL6316.cbl
  1957     02  eibtrnid         pic x(4).
  1958     02  eibtaskn         pic s9(7) comp-3.
  1959     02  eibtrmid         pic x(4).
  1960     02  dfheigdi         pic s9(4) comp.
  1961     02  eibcposn         pic s9(4) comp.
  1962     02  eibcalen         pic s9(4) comp.
  1963     02  eibaid           pic x(1).
  1964     02  eibfiller1       pic x(1).
  1965     02  eibfn            pic x(2).
  1966     02  eibfiller2       pic x(2).
  1967     02  eibrcode         pic x(6).
  1968     02  eibfiller3       pic x(2).
  1969     02  eibds            pic x(8).
  1970     02  eibreqid         pic x(8).
  1971     02  eibrsrce         pic x(8).
  1972     02  eibsync          pic x(1).
  1973     02  eibfree          pic x(1).
  1974     02  eibrecv          pic x(1).
  1975     02  eibsend          pic x(1).
  1976     02  eibatt           pic x(1).
  1977     02  eibeoc           pic x(1).
  1978     02  eibfmh           pic x(1).
  1979     02  eibcompl         pic x(1).
  1980     02  eibsig           pic x(1).
  1981     02  eibconf          pic x(1).
  1982     02  eiberr           pic x(1).
  1983     02  eibrldbk         pic x(1).
  1984     02  eiberrcd         pic x(4).
  1985     02  eibsynrb         pic x(1).
  1986     02  eibnodat         pic x(1).
  1987     02  eibfiller5       pic x(2).
  1988     02  eibresp          pic 9(09) comp.
  1989     02  eibresp2         pic 9(09) comp.
  1990     02  dfheigdj         pic s9(4) comp.
  1991     02  dfheigdk         pic s9(4) comp.
  1992 01  DFHCOMMAREA                 PIC X(1300).
  1993 01  var  pic x(30).
  1994*                                COPY ERCACCT.
  1995******************************************************************
  1996*                                                                *
  1997*                                                                *
  1998*                            ERCACCT                             *
  1999*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2000*                            VMOD=2.031                          *
  2001*                                                                *
  2002*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2003*                                                                *
  2004*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2005*   VSAM ACCOUNT MASTER FILES.                                   *
  2006*                                                                *
  2007*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2008*                                                                *
  2009*   FILE TYPE = VSAM,KSDS                                        *
  2010*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2011*                                                                *
  2012*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2013*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2014*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  37
* EL6316.cbl
  2015*   LOG = NO                                                     *
  2016*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2017*                                                                *
  2018*                                                                *
  2019******************************************************************
  2020*                   C H A N G E   L O G
  2021*
  2022* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2023*-----------------------------------------------------------------
  2024*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2025* EFFECTIVE    NUMBER
  2026*-----------------------------------------------------------------
  2027* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2028* 092705    2005050300006  PEMA  ADD SPP LEASES
  2029* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2030* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2031* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2032* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2033* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2034******************************************************************
  2035
  2036 01  ACCOUNT-MASTER.
  2037     12  AM-RECORD-ID                      PIC XX.
  2038         88  VALID-AM-ID                      VALUE 'AM'.
  2039
  2040     12  AM-CONTROL-PRIMARY.
  2041         16  AM-COMPANY-CD                 PIC X.
  2042         16  AM-MSTR-CNTRL.
  2043             20  AM-CONTROL-A.
  2044                 24  AM-CARRIER            PIC X.
  2045                 24  AM-GROUPING.
  2046                     28 AM-GROUPING-PREFIX PIC XXX.
  2047                     28 AM-GROUPING-PRIME  PIC XXX.
  2048                 24  AM-STATE              PIC XX.
  2049                 24  AM-ACCOUNT.
  2050                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2051                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2052             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2053                                           PIC X(19).
  2054             20  AM-CNTRL-B.
  2055                 24  AM-EXPIRATION-DT      PIC XX.
  2056                 24  FILLER                PIC X(4).
  2057             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2058                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2059
  2060     12  AM-CONTROL-BY-VAR-GRP.
  2061         16  AM-COMPANY-CD-A1              PIC X.
  2062         16  AM-VG-CARRIER                 PIC X.
  2063         16  AM-VG-GROUPING                PIC X(6).
  2064         16  AM-VG-STATE                   PIC XX.
  2065         16  AM-VG-ACCOUNT                 PIC X(10).
  2066         16  AM-VG-DATE.
  2067             20  AM-VG-EXPIRATION-DT       PIC XX.
  2068             20  FILLER                    PIC X(4).
  2069         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2070                                           PIC 9(11)      COMP-3.
  2071     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2072         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  38
* EL6316.cbl
  2073         16  AM-VG-KEY3.
  2074             20  AM-VG3-ACCOUNT            PIC X(10).
  2075             20  AM-VG3-EXP-DT             PIC XX.
  2076         16  FILLER                        PIC X(4).
  2077     12  AM-MAINT-INFORMATION.
  2078         16  AM-LAST-MAINT-DT              PIC XX.
  2079         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2080         16  AM-LAST-MAINT-USER            PIC X(4).
  2081         16  FILLER                        PIC XX.
  2082
  2083     12  AM-EFFECTIVE-DT                   PIC XX.
  2084     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2085
  2086     12  AM-PREV-DATES  COMP-3.
  2087         16  AM-PREV-EXP-DT                PIC 9(11).
  2088         16  AM-PREV-EFF-DT                PIC 9(11).
  2089
  2090     12  AM-REPORT-CODE-1                  PIC X(10).
  2091     12  AM-REPORT-CODE-2                  PIC X(10).
  2092
  2093     12  AM-CITY-CODE                      PIC X(4).
  2094     12  AM-COUNTY-PARISH                  PIC X(6).
  2095
  2096     12  AM-NAME                           PIC X(30).
  2097     12  AM-PERSON                         PIC X(30).
  2098     12  AM-ADDRS                          PIC X(30).
  2099     12  AM-CITY.
  2100         16  AM-ADDR-CITY                  PIC X(28).
  2101         16  AM-ADDR-STATE                 PIC XX.
  2102     12  AM-ZIP.
  2103         16  AM-ZIP-PRIME.
  2104             20  AM-ZIP-PRI-1ST            PIC X.
  2105                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2106             20  FILLER                    PIC X(4).
  2107         16  AM-ZIP-PLUS4                  PIC X(4).
  2108     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2109         16  AM-CAN-POSTAL-1               PIC XXX.
  2110         16  AM-CAN-POSTAL-2               PIC XXX.
  2111         16  FILLER                        PIC XXX.
  2112     12  AM-TEL-NO.
  2113         16  AM-AREA-CODE                  PIC 999.
  2114         16  AM-TEL-PRE                    PIC 999.
  2115         16  AM-TEL-NBR                    PIC 9(4).
  2116     12  AM-TEL-LOC                        PIC X.
  2117         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2118         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2119
  2120     12  AM-COMM-STRUCTURE.
  2121         16  AM-DEFN-1.
  2122             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2123                 24  AM-AGT.
  2124                     28  AM-AGT-PREFIX     PIC X(4).
  2125                     28  AM-AGT-PRIME      PIC X(6).
  2126                 24  AM-COM-TYP            PIC X.
  2127                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2128                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2129                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2130                 24  AM-RECALC-LV-INDIC    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  39
* EL6316.cbl
  2131                 24  AM-RETRO-LV-INDIC     PIC X.
  2132                 24  AM-GL-CODES           PIC X.
  2133                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2134                 24  FILLER                PIC X(01).
  2135         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2136             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2137                 24  FILLER                PIC X(11).
  2138                 24  AM-L-COMA             PIC XXX.
  2139                 24  AM-J-COMA             PIC XXX.
  2140                 24  AM-A-COMA             PIC XXX.
  2141                 24  FILLER                PIC X(6).
  2142
  2143     12  AM-COMM-CHANGE-STATUS             PIC X.
  2144         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2145
  2146     12  AM-CSR-CODE                       PIC X(4).
  2147
  2148     12  AM-BILLING-STATUS                 PIC X.
  2149         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2150         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2151     12  AM-AUTO-REFUND-SW                 PIC X.
  2152         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2153         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2154     12  AM-GPCD                           PIC 99.
  2155     12  AM-IG                             PIC X.
  2156         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2157         88  AM-HAS-GROUP                     VALUE '2'.
  2158     12  AM-STATUS                         PIC X.
  2159         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2160         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2161         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2162         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2163         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2164         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2165     12  AM-REMIT-TO                       PIC 99.
  2166     12  AM-ID-NO                          PIC X(11).
  2167
  2168     12  AM-CAL-TABLE                      PIC XX.
  2169     12  AM-LF-DEVIATION                   PIC XXX.
  2170     12  AM-AH-DEVIATION                   PIC XXX.
  2171     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2172     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2173     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2174     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2175     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2176     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2177
  2178     12  AM-USER-FIELDS.
  2179         16  AM-FLD-1                      PIC XX.
  2180         16  AM-FLD-2                      PIC XX.
  2181         16  AM-FLD-3                      PIC XX.
  2182         16  AM-FLD-4                      PIC XX.
  2183         16  AM-FLD-5                      PIC XX.
  2184
  2185     12  AM-1ST-PROD-DATE.
  2186         16  AM-1ST-PROD-YR                PIC XX.
  2187         16  AM-1ST-PROD-MO                PIC XX.
  2188         16  AM-1ST-PROD-DA                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  40
* EL6316.cbl
  2189     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2190     12  AM-CERTS-PURGED-DATE.
  2191         16  AM-PUR-YR                     PIC XX.
  2192         16  AM-PUR-MO                     PIC XX.
  2193         16  AM-PUR-DA                     PIC XX.
  2194     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2195     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2196     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2197     12  AM-INACTIVE-DATE.
  2198         16  AM-INA-MO                     PIC 99.
  2199         16  AM-INA-DA                     PIC 99.
  2200         16  AM-INA-YR                     PIC 99.
  2201     12  AM-AR-HI-CERT-DATE                PIC XX.
  2202
  2203     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2204     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2205
  2206     12  AM-OB-PAYMENT-MODE                PIC X.
  2207         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2208         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2209         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2210         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2211
  2212     12  AM-AH-ONLY-INDICATOR              PIC X.
  2213         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2214         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2215
  2216     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2217
  2218     12  AM-OVER-SHORT.
  2219         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2220         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2221
  2222     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2223     12  AM-DCC-CLP-STATE                  PIC XX.
  2224
  2225     12  AM-RECALC-COMM                    PIC X.
  2226     12  AM-RECALC-REIN                    PIC X.
  2227
  2228     12  AM-REI-TABLE                      PIC XXX.
  2229     12  AM-REI-ET-LF                      PIC X.
  2230     12  AM-REI-ET-AH                      PIC X.
  2231     12  AM-REI-PE-LF                      PIC X.
  2232     12  AM-REI-PE-AH                      PIC X.
  2233     12  AM-REI-PRT-ST                     PIC X.
  2234     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2235     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2236     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2237     12  AM-REI-GROUP-A                    PIC X(6).
  2238     12  AM-REI-MORT                       PIC X(4).
  2239     12  AM-REI-PRT-OW                     PIC X.
  2240     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2241     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2242     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2243     12  AM-REI-GROUP-B                    PIC X(6).
  2244
  2245     12  AM-TRUST-TYPE                     PIC X(2).
  2246
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  41
* EL6316.cbl
  2247     12  AM-EMPLOYER-STMT-USED             PIC X.
  2248     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2249
  2250     12  AM-STD-AH-TYPE                    PIC XX.
  2251     12  AM-EARN-METHODS.
  2252         16  AM-EARN-METHOD-R              PIC X.
  2253             88 AM-REF-RL-R78                 VALUE 'R'.
  2254             88 AM-REF-RL-PR                  VALUE 'P'.
  2255             88 AM-REF-RL-MEAN                VALUE 'M'.
  2256             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2257         16  AM-EARN-METHOD-L              PIC X.
  2258             88 AM-REF-LL-R78                 VALUE 'R'.
  2259             88 AM-REF-LL-PR                  VALUE 'P'.
  2260             88 AM-REF-LL-MEAN                VALUE 'M'.
  2261             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2262         16  AM-EARN-METHOD-A              PIC X.
  2263             88 AM-REF-AH-R78                 VALUE 'R'.
  2264             88 AM-REF-AH-PR                  VALUE 'P'.
  2265             88 AM-REF-AH-MEAN                VALUE 'M'.
  2266             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2267             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2268             88 AM-REF-AH-NET                 VALUE 'N'.
  2269
  2270     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2271     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2272     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2273
  2274     12  AM-RET-Y-N                        PIC X.
  2275     12  AM-RET-P-E                        PIC X.
  2276     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2277     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2278     12  AM-RET-GRP                        PIC X(6).
  2279     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2280         16  AM-POOL-PRIME                 PIC XXX.
  2281         16  AM-POOL-SUB                   PIC XXX.
  2282     12  AM-RETRO-EARNINGS.
  2283         16  AM-RET-EARN-R                 PIC X.
  2284         16  AM-RET-EARN-L                 PIC X.
  2285         16  AM-RET-EARN-A                 PIC X.
  2286     12  AM-RET-ST-TAX-USE                 PIC X.
  2287         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2288         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2289     12  AM-RETRO-BEG-EARNINGS.
  2290         16  AM-RET-BEG-EARN-R             PIC X.
  2291         16  AM-RET-BEG-EARN-L             PIC X.
  2292         16  AM-RET-BEG-EARN-A             PIC X.
  2293     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2294     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2295
  2296     12  AM-USER-SELECT-OPTIONS.
  2297         16  AM-USER-SELECT-1              PIC X(10).
  2298         16  AM-USER-SELECT-2              PIC X(10).
  2299         16  AM-USER-SELECT-3              PIC X(10).
  2300         16  AM-USER-SELECT-4              PIC X(10).
  2301         16  AM-USER-SELECT-5              PIC X(10).
  2302
  2303     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2304
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  42
* EL6316.cbl
  2305     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2306
  2307     12  AM-RPT045A-SWITCH                 PIC X.
  2308         88  RPT045A-OFF                   VALUE 'N'.
  2309
  2310     12  AM-INSURANCE-LIMITS.
  2311         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2312         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2313
  2314     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2315         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2316
  2317     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2318         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2319         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2320
  2321     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2322
  2323     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2324     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2325     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2326     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2327     12  AM-DCC-UEF-STATE                  PIC XX.
  2328     12  FILLER                            PIC XXX.
  2329     12  AM-REPORT-CODE-3                  PIC X(10).
  2330*    12  FILLER                            PIC X(22).
  2331
  2332     12  AM-RESERVE-DATE.
  2333         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2334         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2335         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2336
  2337     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2338     12  AM-NOTIFICATION-TYPES.
  2339         16  AM-NOTIF-OF-LETTERS           PIC X.
  2340         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2341         16  AM-NOTIF-OF-REPORTS           PIC X.
  2342         16  AM-NOTIF-OF-STATUS            PIC X.
  2343
  2344     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2345         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2346         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2347         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2348         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2349
  2350     12  AM-BENEFIT-CONTROLS.
  2351         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2352             20  AM-BENEFIT-CODE           PIC XX.
  2353             20  AM-BENEFIT-TYPE           PIC X.
  2354             20  AM-BENEFIT-REVISION       PIC XXX.
  2355             20  AM-BENEFIT-REM-TERM       PIC X.
  2356             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2357             20  FILLER                    PIC XX.
  2358         16  FILLER                        PIC X(80).
  2359
  2360     12  AM-TRANSFER-DATA.
  2361         16  AM-TRANSFERRED-FROM.
  2362             20  AM-TRNFROM-CARRIER        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  43
* EL6316.cbl
  2363             20  AM-TRNFROM-GROUPING.
  2364                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2365                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2366             20  AM-TRNFROM-STATE          PIC XX.
  2367             20  AM-TRNFROM-ACCOUNT.
  2368                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2369                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2370             20  AM-TRNFROM-DTE            PIC XX.
  2371         16  AM-TRANSFERRED-TO.
  2372             20  AM-TRNTO-CARRIER          PIC X.
  2373             20  AM-TRNTO-GROUPING.
  2374                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2375                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2376             20  AM-TRNTO-STATE            PIC XX.
  2377             20  AM-TRNTO-ACCOUNT.
  2378                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2379                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2380             20  AM-TRNTO-DTE              PIC XX.
  2381         16  FILLER                        PIC X(10).
  2382
  2383     12  AM-SAVED-REMIT-TO                 PIC 99.
  2384
  2385     12  AM-COMM-STRUCTURE-SAVED.
  2386         16  AM-DEFN-1-SAVED.
  2387             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2388                 24  AM-AGT-SV             PIC X(10).
  2389                 24  AM-COM-TYP-SV         PIC X.
  2390                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2391                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2392                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2393                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2394                 24  FILLER                PIC X.
  2395                 24  AM-GL-CODES-SV        PIC X.
  2396                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2397                 24  FILLER                PIC X.
  2398         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2399             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2400                 24  FILLER                PIC X(11).
  2401                 24  AM-L-COMA-SV          PIC XXX.
  2402                 24  AM-J-COMA-SV          PIC XXX.
  2403                 24  AM-A-COMA-SV          PIC XXX.
  2404                 24  FILLER                PIC X(6).
  2405
  2406     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2407         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2408            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2409            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2410            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2411
  2412     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2413     12  FILLER                            PIC X(120).
  2414
  2415     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2416         16  AM-CONTROL-NAME               PIC X(30).
  2417         16  AM-EXECUTIVE-ONE.
  2418             20  AM-EXEC1-NAME             PIC X(15).
  2419             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2420                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  44
* EL6316.cbl
  2421             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2422                                                          COMP-3.
  2423         16  AM-EXECUTIVE-TWO.
  2424             20  AM-EXEC2-NAME             PIC X(15).
  2425             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2426                                                          COMP-3.
  2427             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2428                                                          COMP-3.
  2429
  2430     12  AM-RETRO-ADDITIONAL-DATA.
  2431         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2432         16  AM-RETRO-PREM-P-E             PIC X.
  2433         16  AM-RETRO-CLMS-P-I             PIC X.
  2434         16  AM-RETRO-RET-BRACKET-LF.
  2435             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2436                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2437                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2438             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2439                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2440                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2441             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2442                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2443                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2444         16  AM-RETRO-RET-BRACKET-AH.
  2445             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2446                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2447                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2448                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2449             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2450                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2451                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2452             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2453                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2454                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2455
  2456     12  AM-COMMENTS.
  2457         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2458
  2459     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2460         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2461         16  AM-FLI-BILLING-CODE           PIC X.
  2462         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2463         16  AM-FLI-UNITED-IDENT           PIC X.
  2464         16  AM-FLI-INTEREST-LOST-DATA.
  2465             20  AM-FLI-BANK-NO            PIC X(5).
  2466             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2467             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2468             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2469         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2470             20  AM-FLI-AGT                PIC X(9).
  2471             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2472             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2473         16  FILLER                        PIC X(102).
  2474
  2475     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2476         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2477             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2478             20  AM-BENEFIT-DMD-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  45
* EL6316.cbl
  2479             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2480             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2481             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2482         16  FILLER                          PIC X(10).
  2483******************************************************************
  2484*                                COPY ELCCNTL.
  2485******************************************************************
  2486*                                                                *
  2487*                                                                *
  2488*                            ELCCNTL.                            *
  2489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2490*                            VMOD=2.059                          *
  2491*                                                                *
  2492*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2493*                                                                *
  2494*   FILE TYPE = VSAM,KSDS                                        *
  2495*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2496*                                                                *
  2497*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2498*       ALTERNATE INDEX = NONE                                   *
  2499*                                                                *
  2500*   LOG = YES                                                    *
  2501*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2502******************************************************************
  2503*                   C H A N G E   L O G
  2504*
  2505* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2506*-----------------------------------------------------------------
  2507*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2508* EFFECTIVE    NUMBER
  2509*-----------------------------------------------------------------
  2510* 082503                   PEMA  ADD BENEFIT GROUP
  2511* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2512* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2513* 092705    2005050300006  PEMA  ADD SPP LEASES
  2514* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2515* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2516* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2517* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2518* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2519* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2520* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2521* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2522* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2523******************************************************************
  2524*
  2525 01  CONTROL-FILE.
  2526     12  CF-RECORD-ID                       PIC XX.
  2527         88  VALID-CF-ID                        VALUE 'CF'.
  2528
  2529     12  CF-CONTROL-PRIMARY.
  2530         16  CF-COMPANY-ID                  PIC XXX.
  2531         16  CF-RECORD-TYPE                 PIC X.
  2532             88  CF-COMPANY-MASTER              VALUE '1'.
  2533             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2534             88  CF-STATE-MASTER                VALUE '3'.
  2535             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2536             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  46
* EL6316.cbl
  2537             88  CF-CARRIER-MASTER              VALUE '6'.
  2538             88  CF-MORTALITY-MASTER            VALUE '7'.
  2539             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2540             88  CF-TERMINAL-MASTER             VALUE '9'.
  2541             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2542             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2543             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2544             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2545             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2546             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2547             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2548             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2549             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2550         16  CF-ACCESS-CD-GENL              PIC X(4).
  2551         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2552             20  CF-PROCESSOR               PIC X(4).
  2553         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2554             20  CF-STATE-CODE              PIC XX.
  2555             20  FILLER                     PIC XX.
  2556         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2557             20  FILLER                     PIC XX.
  2558             20  CF-HI-BEN-IN-REC           PIC XX.
  2559         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2560             20  FILLER                     PIC XXX.
  2561             20  CF-CARRIER-CNTL            PIC X.
  2562         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2563             20  FILLER                     PIC XX.
  2564             20  CF-HI-TYPE-IN-REC          PIC 99.
  2565         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2566             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2567                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2568             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2569             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2570         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2571             20  FILLER                     PIC X.
  2572             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2573         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2574             20  FILLER                     PIC XX.
  2575             20  CF-MORTGAGE-PLAN           PIC XX.
  2576         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2577
  2578     12  CF-LAST-MAINT-DT                   PIC XX.
  2579     12  CF-LAST-MAINT-BY                   PIC X(4).
  2580     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2581
  2582     12  CF-RECORD-BODY                     PIC X(728).
  2583
  2584
  2585****************************************************************
  2586*             COMPANY MASTER RECORD                            *
  2587****************************************************************
  2588
  2589     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2590         16  CF-COMPANY-ADDRESS.
  2591             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2592             20  CF-CL-IN-CARE-OF           PIC X(30).
  2593             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2594             20  CF-CL-ADDR-LINE-2          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  47
* EL6316.cbl
  2595             20  CF-CL-CITY-STATE           PIC X(30).
  2596             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2597             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2598         16  CF-COMPANY-CD                  PIC X.
  2599         16  CF-COMPANY-PASSWORD            PIC X(8).
  2600         16  CF-SECURITY-OPTION             PIC X.
  2601             88  ALL-SECURITY                   VALUE '1'.
  2602             88  COMPANY-VERIFY                 VALUE '2'.
  2603             88  PROCESSOR-VERIFY               VALUE '3'.
  2604             88  NO-SECURITY                    VALUE '4'.
  2605             88  ALL-BUT-TERM                   VALUE '5'.
  2606         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2607             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2608         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2609             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2610         16  CF-INFORCE-LOCATION            PIC X.
  2611             88  CERTS-ARE-ONLINE               VALUE '1'.
  2612             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2613             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2614         16  CF-LOWER-CASE-LETTERS          PIC X.
  2615         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2616             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2617             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2618             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2619             88  CF-ACCNT-CNTL                  VALUE '3'.
  2620             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2621
  2622         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2623         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2624
  2625         16  CF-LGX-CREDIT-USER             PIC X.
  2626             88  CO-IS-NOT-USER                 VALUE 'N'.
  2627             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2628
  2629         16 CF-CREDIT-CALC-CODES.
  2630             20  CF-CR-REM-TERM-CALC PIC X.
  2631               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2632               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2633               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2634               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2635               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2636               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2637               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2638             20  CF-CR-R78-METHOD           PIC X.
  2639               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2640               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2641
  2642         16  CF-CLAIM-CONTROL-COUNTS.
  2643             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2644                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2645
  2646             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2647                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2648
  2649             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2650                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2651
  2652             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  48
* EL6316.cbl
  2653                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2654
  2655         16  CF-CURRENT-MONTH-END           PIC XX.
  2656
  2657         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2658             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2659             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2660             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2661             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2662                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2663                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2664             20  CF-CO-PREM-REJECT-SW       PIC X.
  2665                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2666                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2667             20  CF-CO-REF-REJECT-SW        PIC X.
  2668                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2669                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2670
  2671         16  CF-CO-REPORTING-DT             PIC XX.
  2672         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2673         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2674           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2675           88  CF-CO-MONTH-END                  VALUE '1'.
  2676
  2677         16  CF-LGX-CLAIM-USER              PIC X.
  2678             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2679             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2680
  2681         16  CF-CREDIT-EDIT-CONTROLS.
  2682             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2683             20  CF-MIN-AGE                 PIC 99.
  2684             20  CF-DEFAULT-AGE             PIC 99.
  2685             20  CF-MIN-TERM                PIC S999      COMP-3.
  2686             20  CF-MAX-TERM                PIC S999      COMP-3.
  2687             20  CF-DEFAULT-SEX             PIC X.
  2688             20  CF-JOINT-AGE-INPUT         PIC X.
  2689                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2690             20  CF-BIRTH-DATE-INPUT        PIC X.
  2691                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2692             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2693                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2694                 88  CF-ZERO-CARRIER            VALUE '1'.
  2695                 88  CF-ZERO-GROUPING           VALUE '2'.
  2696                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2697             20  CF-EDIT-SW                 PIC X.
  2698                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2699             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2700             20  CF-CR-PR-METHOD            PIC X.
  2701               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2702               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2703             20  FILLER                     PIC X.
  2704
  2705         16  CF-CREDIT-MISC-CONTROLS.
  2706             20  CF-REIN-TABLE-SW           PIC X.
  2707                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2708             20  CF-COMP-TABLE-SW           PIC X.
  2709                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2710             20  CF-EXPERIENCE-RETENTION-AGE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  49
* EL6316.cbl
  2711                                            PIC S9        COMP-3.
  2712             20  CF-CONVERSION-DT           PIC XX.
  2713             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2714             20  CF-RUN-FREQUENCY-SW        PIC X.
  2715                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2716                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2717
  2718             20  CF-CR-CHECK-NO-CONTROL.
  2719                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2720                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2721                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2722                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2723                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2724                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2725
  2726                 24  CF-CR-CHECK-COUNT       REDEFINES
  2727                     CF-CR-CHECK-COUNTER      PIC X(4).
  2728
  2729                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2730                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2731
  2732                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2733                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2734                 24  CF-MAIL-PROCESSING       PIC X.
  2735                     88  MAIL-PROCESSING          VALUE 'Y'.
  2736
  2737         16  CF-MISC-SYSTEM-CONTROL.
  2738             20  CF-SYSTEM-C                 PIC X.
  2739                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2740             20  CF-SYSTEM-D                 PIC X.
  2741                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2742             20  CF-SOC-SEC-NO-SW            PIC X.
  2743                 88  SOC-SEC-NO-USED             VALUE '1'.
  2744             20  CF-MEMBER-NO-SW             PIC X.
  2745                 88  MEMBER-NO-USED              VALUE '1'.
  2746             20  CF-TAX-ID-NUMBER            PIC X(11).
  2747             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2748             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2749                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2750                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2751                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2752                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2753             20  CF-SYSTEM-E                 PIC X.
  2754                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2755
  2756         16  CF-LGX-LIFE-USER               PIC X.
  2757             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2758             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2759
  2760         16  CF-CR-MONTH-END-DT             PIC XX.
  2761
  2762         16  CF-FILE-MAINT-DATES.
  2763             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2764                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2765             20  CF-LAST-BATCH       REDEFINES
  2766                 CF-LAST-BATCH-NO               PIC X(4).
  2767             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2768             20  CF-RATES-FILE-CREATE-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  50
* EL6316.cbl
  2769             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2770             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2771             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2772             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2773             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2774             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2775             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2776             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2777
  2778         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2779         16  FILLER                         PIC X.
  2780
  2781         16  CF-ALT-MORT-CODE               PIC X(4).
  2782         16  CF-MEMBER-CAPTION              PIC X(10).
  2783
  2784         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2785             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2786             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2787             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2788             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2789             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2790
  2791         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2792
  2793         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2794         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2795         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2796         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2797
  2798         16  CF-AH-OVERRIDE-L1              PIC X.
  2799         16  CF-AH-OVERRIDE-L2              PIC XX.
  2800         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2801         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2802
  2803         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2804         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2805
  2806         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2807         16  CF-AR-LAST-EL860-DT            PIC XX.
  2808         16  CF-MP-MONTH-END-DT             PIC XX.
  2809
  2810         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2811         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2812             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2813
  2814         16  CF-AR-MONTH-END-DT             PIC XX.
  2815
  2816         16  CF-CRDTCRD-USER                PIC X.
  2817             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2818             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2819
  2820         16  CF-CC-MONTH-END-DT             PIC XX.
  2821
  2822         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2823
  2824         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2825             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2826             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  51
* EL6316.cbl
  2827             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2828         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2829         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2830         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2831         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2832             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2833             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2834         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2835         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2836         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2837             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2838         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2839
  2840         16  CF-CL-ZIP-CODE.
  2841             20  CF-CL-ZIP-PRIME.
  2842                 24  CF-CL-ZIP-1ST          PIC X.
  2843                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2844                 24  FILLER                 PIC X(4).
  2845             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2846         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2847             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2848             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2849             20  FILLER                     PIC XXX.
  2850
  2851         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2852         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2853         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2854         16  CF-CO-OPTION-START-DATE        PIC XX.
  2855         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2856           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2857                                                      '3' '4'.
  2858           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2859           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2860           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2861           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2862           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2863           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2864
  2865         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2866
  2867         16  CF-PAYMENT-APPROVAL-LEVELS.
  2868             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2869             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2870             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2871             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2872             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2873             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2874
  2875         16  CF-END-USER-REPORTING-USER     PIC X.
  2876             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2877             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2878
  2879         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2880             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2881             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2882
  2883         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2884
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  52
* EL6316.cbl
  2885         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2886         16  FILLER                         PIC X.
  2887
  2888         16  CF-CREDIT-ARCHIVE-CNTL.
  2889             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2890             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2891             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2892
  2893         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2894
  2895         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2896             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2897             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2898
  2899         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2900             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2901             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2902
  2903         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2904
  2905         16  CF-CO-ACH-ID-CODE              PIC  X.
  2906             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2907             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2908             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2909         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2910         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2911         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2912         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2913         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2914         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2915         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2916         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2917         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2918                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2919         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2920                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2921
  2922         16  CF-CO-OVER-SHORT.
  2923             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2924             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2925
  2926*         16  FILLER                         PIC X(102).
  2927         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2928             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2929             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2930
  2931         16  CF-AH-APPROVAL-DAYS.
  2932             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2933             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2934             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2935             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2936
  2937         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2938
  2939         16  CF-APPROV-LEV-5.
  2940             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2941             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2942             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  53
* EL6316.cbl
  2943
  2944         16  FILLER                         PIC X(68).
  2945****************************************************************
  2946*             PROCESSOR/USER RECORD                            *
  2947****************************************************************
  2948
  2949     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2950         16  CF-PROCESSOR-NAME              PIC X(30).
  2951         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2952         16  CF-PROCESSOR-TITLE             PIC X(26).
  2953         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2954                 88  MESSAGE-YES                VALUE 'Y'.
  2955                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2956
  2957*****************************************************
  2958****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2959****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2960****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2961****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2962*****************************************************
  2963
  2964         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2965             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2966             20  CF-APPLICATION-FORCE       PIC X.
  2967             20  CF-INDIVIDUAL-APP.
  2968                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2969                     28  CF-BROWSE-APP      PIC X.
  2970                     28  CF-UPDATE-APP      PIC X.
  2971
  2972         16  CF-CURRENT-TERM-ON             PIC X(4).
  2973         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2974             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2975             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2976             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2977             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2978             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2979             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2980             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2981         16  CF-PROCESSOR-CARRIER           PIC X.
  2982             88  NO-CARRIER-SECURITY            VALUE ' '.
  2983         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2984             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2985         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2986             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2987         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2988             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2989
  2990         16  CF-PROC-SYS-ACCESS-SW.
  2991             20  CF-PROC-CREDIT-CLAIMS-SW.
  2992                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2993                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2994                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2995                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2996             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2997                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2998                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2999             20  CF-PROC-LIFE-GNRLDGR-SW.
  3000                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  54
* EL6316.cbl
  3001                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3002                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3003                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3004             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3005                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3006                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3007         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3008             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3009             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3010         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3011
  3012         16  CF-APPROVAL-LEVEL                  PIC X.
  3013             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3014             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3015             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3016             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3017             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3018
  3019         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3020
  3021         16  CF-LANGUAGE-TYPE                   PIC X.
  3022             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3023             88  CF-LANG-IS-FR                      VALUE 'F'.
  3024
  3025         16  CF-CSR-IND                         PIC X.
  3026         16  FILLER                             PIC X(239).
  3027
  3028****************************************************************
  3029*             PROCESSOR/REMINDERS RECORD                       *
  3030****************************************************************
  3031
  3032     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3033         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3034             20  CF-START-REMIND-DT         PIC XX.
  3035             20  CF-END-REMIND-DT           PIC XX.
  3036             20  CF-REMINDER-TEXT           PIC X(50).
  3037         16  FILLER                         PIC X(296).
  3038
  3039
  3040****************************************************************
  3041*             STATE MASTER RECORD                              *
  3042****************************************************************
  3043
  3044     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3045         16  CF-STATE-ABBREVIATION          PIC XX.
  3046         16  CF-STATE-NAME                  PIC X(25).
  3047         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3048         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3049             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3050             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3051             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3052             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3053                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3054                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3055             20  CF-ST-PREM-REJECT-SW       PIC X.
  3056                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3057                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3058             20  CF-ST-REF-REJECT-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  55
* EL6316.cbl
  3059                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3060                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3061         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3062         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3063         16  CF-ST-REFUND-RULES.
  3064             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3065             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3066             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3067         16  CF-ST-FST-PMT-EXTENSION.
  3068             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3069             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3070                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3071                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3072                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3073                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3074         16  CF-ST-STATE-CALL.
  3075             20  CF-ST-CALL-UNEARNED        PIC X.
  3076             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3077             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3078         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3079             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3080             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3081         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3082         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3083         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3084         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3085         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3086         16  FILLER                         PIC X.
  3087         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3088             20  CF-ST-BENEFIT-CD           PIC XX.
  3089             20  CF-ST-BENEFIT-KIND         PIC X.
  3090                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3091                 88  CF-ST-AH-KIND              VALUE 'A'.
  3092             20  CF-ST-REM-TERM-CALC        PIC X.
  3093                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3094                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3095                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3096                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3097                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3098                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3099                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3100                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3101
  3102             20  CF-ST-REFUND-CALC          PIC X.
  3103                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3104                 88  ST-REFD-BY-R78             VALUE '1'.
  3105                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3106                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3107                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3108                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3109                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3110                 88  ST-REFD-UTAH               VALUE '7'.
  3111                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3112                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3113                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3114
  3115             20  CF-ST-EARNING-CALC         PIC X.
  3116                 88  ST-EARNING-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  56
* EL6316.cbl
  3117                 88  ST-EARN-BY-R78             VALUE '1'.
  3118                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3119                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3120                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3121                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3122                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3123                 88  ST-EARN-MEAN               VALUE '8'.
  3124                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3125
  3126             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3127                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3128                 88  ST-OVRD-BY-R78             VALUE '1'.
  3129                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3130                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3131                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3132                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3133                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3134                 88  ST-OVRD-MEAN               VALUE '8'.
  3135                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3136             20  FILLER                     PIC X.
  3137
  3138         16  CF-ST-COMMISSION-CAPS.
  3139             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3140             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3141             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3142             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3143         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3144                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3145
  3146         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3147
  3148         16  CF-ST-STATUTORY-INTEREST.
  3149             20  CF-ST-STAT-DATE-FROM       PIC X.
  3150                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3151                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3152             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3153             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3154             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3155             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3156             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3157
  3158         16  CF-ST-OVER-SHORT.
  3159             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3160             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3161
  3162         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3163
  3164         16  CF-ST-RT-CALC                  PIC X.
  3165
  3166         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3167         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3168         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3169         16  CF-ST-RF-LR-CALC               PIC X.
  3170         16  CF-ST-RF-LL-CALC               PIC X.
  3171         16  CF-ST-RF-LN-CALC               PIC X.
  3172         16  CF-ST-RF-AH-CALC               PIC X.
  3173         16  CF-ST-RF-CP-CALC               PIC X.
  3174*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  57
* EL6316.cbl
  3175*CIDMOD         16  FILLER                         PIC X(192).
  3176         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3177             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3178         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3179         16  CF-ST-VFY-2ND-BENE             PIC X.
  3180         16  CF-ST-CAUSAL-STATE             PIC X.
  3181         16  FILLER                         PIC X(185).
  3182
  3183****************************************************************
  3184*             BENEFIT MASTER RECORD                            *
  3185****************************************************************
  3186
  3187     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3188         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3189             20  CF-BENEFIT-CODE            PIC XX.
  3190             20  CF-BENEFIT-NUMERIC  REDEFINES
  3191                 CF-BENEFIT-CODE            PIC XX.
  3192             20  CF-BENEFIT-ALPHA           PIC XXX.
  3193             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3194             20  CF-BENEFIT-COMMENT         PIC X(10).
  3195
  3196             20  CF-LF-COVERAGE-TYPE        PIC X.
  3197                 88  CF-REDUCING                VALUE 'R'.
  3198                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3199
  3200             20  CF-SPECIAL-CALC-CD         PIC X.
  3201                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3202                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3203                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3204                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3205                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3206                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3207                 88  CF-FARM-PLAN               VALUE 'F'.
  3208                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3209                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3210                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3211                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3212                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3213                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3214                 88  CF-PRUDENTIAL              VALUE 'P'.
  3215                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3216                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3217                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3218                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3219                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3220                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3221
  3222             20  CF-JOINT-INDICATOR         PIC X.
  3223                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3224
  3225*            20  FILLER                     PIC X(12).
  3226             20  FILLER                     PIC X(11).
  3227             20  CF-BENEFIT-CATEGORY        PIC X.
  3228             20  CF-LOAN-TYPE               PIC X(8).
  3229
  3230             20  CF-CO-REM-TERM-CALC        PIC X.
  3231                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3232                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  58
* EL6316.cbl
  3233                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3234                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3235                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3236
  3237             20  CF-CO-EARNINGS-CALC        PIC X.
  3238                 88  CO-EARN-BY-R78             VALUE '1'.
  3239                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3240                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3241                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3242                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3243                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3244                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3245                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3246
  3247             20  CF-CO-REFUND-CALC          PIC X.
  3248                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3249                 88  CO-REFD-BY-R78             VALUE '1'.
  3250                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3251                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3252                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3253                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3254                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3255                 88  CO-REFD-MEAN               VALUE '8'.
  3256                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3257                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3258                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3259
  3260             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3261                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3262                 88  CO-OVRD-BY-R78             VALUE '1'.
  3263                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3264                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3265                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3266                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3267                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3268                 88  CO-OVRD-MEAN               VALUE '8'.
  3269                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3270
  3271             20  CF-CO-BEN-I-G-CD           PIC X.
  3272                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3273                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3274                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3275
  3276         16  FILLER                         PIC X(304).
  3277
  3278
  3279****************************************************************
  3280*             CARRIER MASTER RECORD                            *
  3281****************************************************************
  3282
  3283     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3284         16  CF-ADDRESS-DATA.
  3285             20  CF-MAIL-TO-NAME            PIC X(30).
  3286             20  CF-IN-CARE-OF              PIC X(30).
  3287             20  CF-ADDRESS-LINE-1          PIC X(30).
  3288             20  CF-ADDRESS-LINE-2          PIC X(30).
  3289             20  CF-CITY-STATE              PIC X(30).
  3290             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  59
* EL6316.cbl
  3291             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3292
  3293         16  CF-CLAIM-NO-CONTROL.
  3294             20  CF-CLAIM-NO-METHOD         PIC X.
  3295                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3296                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3297                 88  CLAIM-NO-SEQ               VALUE '3'.
  3298                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3299             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3300                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3301                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3302                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3303
  3304         16  CF-CHECK-NO-CONTROL.
  3305             20  CF-CHECK-NO-METHOD         PIC X.
  3306                 88  CHECK-NO-MANUAL            VALUE '1'.
  3307                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3308                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3309                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3310             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3311                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3312
  3313         16  CF-DOMICILE-STATE              PIC XX.
  3314
  3315         16  CF-EXPENSE-CONTROLS.
  3316             20  CF-EXPENSE-METHOD          PIC X.
  3317                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3318                 88  DOLLARS-PER-PMT            VALUE '2'.
  3319                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3320                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3321             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3322             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3323
  3324         16  CF-CORRESPONDENCE-CONTROL.
  3325             20  CF-LETTER-RESEND-OPT       PIC X.
  3326                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3327                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3328             20  FILLER                     PIC X(4).
  3329
  3330         16  CF-RESERVE-CONTROLS.
  3331             20  CF-MANUAL-SW               PIC X.
  3332                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3333             20  CF-FUTURE-SW               PIC X.
  3334                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3335             20  CF-PTC-SW                  PIC X.
  3336                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3337             20  CF-IBNR-SW                 PIC X.
  3338                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3339             20  CF-PTC-LF-SW               PIC X.
  3340                 88  CF-LF-PTC-USED             VALUE '1'.
  3341             20  CF-CDT-ACCESS-METHOD       PIC X.
  3342                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3343                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3344                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3345             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3346
  3347         16  CF-CLAIM-CALC-METHOD           PIC X.
  3348             88  360-PLUS-MONTHS                VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  60
* EL6316.cbl
  3349             88  365-PLUS-MONTHS                VALUE '2'.
  3350             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3351             88  360-DAILY                      VALUE '4'.
  3352             88  365-DAILY                      VALUE '5'.
  3353
  3354         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3355         16  FILLER                         PIC X(11).
  3356
  3357         16  CF-LIMIT-AMOUNTS.
  3358             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3359             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3360             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3361             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3362             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3363             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3364             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3365             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3366             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3367             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3368
  3369         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3370         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3371         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3372
  3373         16  CF-ZIP-CODE.
  3374             20  CF-ZIP-PRIME.
  3375                 24  CF-ZIP-1ST             PIC X.
  3376                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3377                 24  FILLER                 PIC X(4).
  3378             20  CF-ZIP-PLUS4               PIC X(4).
  3379         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3380             20  CF-CAN-POSTAL-1            PIC XXX.
  3381             20  CF-CAN-POSTAL-2            PIC XXX.
  3382             20  FILLER                     PIC XXX.
  3383
  3384         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3385         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3386         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3387
  3388         16  CF-RATING-SWITCH               PIC X.
  3389             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3390             88  CF-NO-RATING                   VALUE 'N'.
  3391
  3392         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3393
  3394         16  CF-CARRIER-OVER-SHORT.
  3395             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3396             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3397
  3398         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3399         16  CF-SECPAY-SWITCH               PIC X.
  3400             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3401             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3402         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3403         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3404         16  FILLER                         PIC X(444).
  3405*        16  FILLER                         PIC X(452).
  3406
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  61
* EL6316.cbl
  3407
  3408****************************************************************
  3409*             MORTALITY MASTER RECORD                          *
  3410****************************************************************
  3411
  3412     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3413         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3414                                INDEXED BY CF-MORT-NDX.
  3415             20  CF-MORT-TABLE              PIC X(5).
  3416             20  CF-MORT-TABLE-TYPE         PIC X.
  3417                 88  CF-MORT-JOINT              VALUE 'J'.
  3418                 88  CF-MORT-SINGLE             VALUE 'S'.
  3419                 88  CF-MORT-COMBINED           VALUE 'C'.
  3420                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3421                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3422             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3423             20  CF-MORT-AGE-METHOD         PIC XX.
  3424                 88  CF-AGE-LAST                VALUE 'AL'.
  3425                 88  CF-AGE-NEAR                VALUE 'AN'.
  3426             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3427             20  CF-MORT-ADJUSTMENT-DIRECTION
  3428                                            PIC X.
  3429                 88  CF-MINUS                   VALUE '-'.
  3430                 88  CF-PLUS                    VALUE '+'.
  3431             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3432             20  CF-MORT-JOINT-CODE         PIC X.
  3433                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3434             20  CF-MORT-PC-Q               PIC X.
  3435                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3436             20  CF-MORT-TABLE-CODE         PIC X(4).
  3437             20  CF-MORT-COMMENTS           PIC X(15).
  3438             20  FILLER                     PIC X(14).
  3439
  3440         16  FILLER                         PIC X(251).
  3441
  3442
  3443****************************************************************
  3444*             BUSSINESS TYPE MASTER RECORD                     *
  3445****************************************************************
  3446
  3447     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3448* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3449* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3450* AND RECORD 05 IS TYPES 81-99
  3451         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3452             20  CF-BUSINESS-TITLE          PIC  X(19).
  3453             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3454                                            PIC S9V9(4) COMP-3.
  3455             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3456             20  FILLER                     PIC  X.
  3457         16  FILLER                         PIC  X(248).
  3458
  3459
  3460****************************************************************
  3461*             TERMINAL MASTER RECORD                           *
  3462****************************************************************
  3463
  3464     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  62
* EL6316.cbl
  3465
  3466         16  CF-COMPANY-TERMINALS.
  3467             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3468                                  PIC X(4).
  3469         16  FILLER               PIC X(248).
  3470
  3471
  3472****************************************************************
  3473*             LIFE EDIT MASTER RECORD                          *
  3474****************************************************************
  3475
  3476     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3477         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3478             20  CF-LIFE-CODE-IN            PIC XX.
  3479             20  CF-LIFE-CODE-OUT           PIC XX.
  3480         16  FILLER                         PIC X(248).
  3481
  3482
  3483****************************************************************
  3484*             AH EDIT MASTER RECORD                            *
  3485****************************************************************
  3486
  3487     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3488         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3489             20  CF-AH-CODE-IN              PIC XXX.
  3490             20  CF-AH-CODE-OUT             PIC XX.
  3491         16  FILLER                         PIC X(248).
  3492
  3493
  3494****************************************************************
  3495*             CREDIBILITY TABLES                               *
  3496****************************************************************
  3497
  3498     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3499         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3500                             INDEXED BY CF-CRDB-NDX.
  3501             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3502             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3503             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3504         16  FILLER                         PIC  X(332).
  3505
  3506
  3507****************************************************************
  3508*             REPORT CUSTOMIZATION RECORD                      *
  3509****************************************************************
  3510
  3511     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3512         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3513             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3514             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3515             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3516**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3517****       A T-TRANSFER.                                   ****
  3518             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3519
  3520         16  FILLER                         PIC XX.
  3521
  3522         16  CF-CARRIER-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  63
* EL6316.cbl
  3523             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3524                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3525                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3526             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3527                                            PIC X.
  3528         16  CF-GROUP-CNTL-OPT.
  3529             20  CF-GROUP-OPT-SEQ           PIC 9.
  3530                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3531                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3532             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3533                                            PIC X(6).
  3534         16  CF-STATE-CNTL-OPT.
  3535             20  CF-STATE-OPT-SEQ           PIC 9.
  3536                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3537                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3538             20  CF-STATE-SELECT OCCURS 3 TIMES
  3539                                            PIC XX.
  3540         16  CF-ACCOUNT-CNTL-OPT.
  3541             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3542                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3543                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3544             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3545                                            PIC X(10).
  3546         16  CF-BUS-TYP-CNTL-OPT.
  3547             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3548                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3549                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3550             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3551                                            PIC XX.
  3552         16  CF-LF-TYP-CNTL-OPT.
  3553             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3554                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3555                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3556             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3557                                            PIC XX.
  3558         16  CF-AH-TYP-CNTL-OPT.
  3559             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3560                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3561                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3562             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3563                                            PIC XX.
  3564         16  CF-REPTCD1-CNTL-OPT.
  3565             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3566                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3567                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3568             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3569                                            PIC X(10).
  3570         16  CF-REPTCD2-CNTL-OPT.
  3571             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3572                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3573                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3574             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3575                                            PIC X(10).
  3576         16  CF-USER1-CNTL-OPT.
  3577             20  CF-USER1-OPT-SEQ           PIC 9.
  3578                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3579                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3580             20  CF-USER1-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  64
* EL6316.cbl
  3581                                            PIC X(10).
  3582         16  CF-USER2-CNTL-OPT.
  3583             20  CF-USER2-OPT-SEQ           PIC 9.
  3584                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3585                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3586             20  CF-USER2-SELECT OCCURS 3 TIMES
  3587                                            PIC X(10).
  3588         16  CF-USER3-CNTL-OPT.
  3589             20  CF-USER3-OPT-SEQ           PIC 9.
  3590                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3591                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3592             20  CF-USER3-SELECT OCCURS 3 TIMES
  3593                                            PIC X(10).
  3594         16  CF-USER4-CNTL-OPT.
  3595             20  CF-USER4-OPT-SEQ           PIC 9.
  3596                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3597                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3598             20  CF-USER4-SELECT OCCURS 3 TIMES
  3599                                            PIC X(10).
  3600         16  CF-USER5-CNTL-OPT.
  3601             20  CF-USER5-OPT-SEQ           PIC 9.
  3602                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3603                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3604             20  CF-USER5-SELECT OCCURS 3 TIMES
  3605                                            PIC X(10).
  3606         16  CF-REINS-CNTL-OPT.
  3607             20  CF-REINS-OPT-SEQ           PIC 9.
  3608                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3609                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3610             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3611                 24  CF-REINS-PRIME         PIC XXX.
  3612                 24  CF-REINS-SUB           PIC XXX.
  3613
  3614         16  CF-AGENT-CNTL-OPT.
  3615             20  CF-AGENT-OPT-SEQ           PIC 9.
  3616                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3617                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3618             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3619                                            PIC X(10).
  3620
  3621         16  FILLER                         PIC X(43).
  3622
  3623         16  CF-LOSS-RATIO-SELECT.
  3624             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3625             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3626         16  CF-ENTRY-DATE-SELECT.
  3627             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3628             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3629         16  CF-EFFECTIVE-DATE-SELECT.
  3630             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3631             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3632
  3633         16  CF-EXCEPTION-LIST-IND          PIC X.
  3634             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3635
  3636         16  FILLER                         PIC X(318).
  3637
  3638****************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  65
* EL6316.cbl
  3639*                  EXCEPTION REPORTING RECORD                  *
  3640****************************************************************
  3641
  3642     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3643         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3644             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3645
  3646         16  CF-COMBINED-LIFE-AH-OPT.
  3647             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3648             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3649             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3650             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3651
  3652         16  CF-LIFE-OPT.
  3653             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3654             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3655             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3656             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3657             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3658             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3659             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3660             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3661             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3662             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3663
  3664         16  CF-AH-OPT.
  3665             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3666             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3667             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3668             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3669             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3670             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3671             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3672             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3673             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3674             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3675
  3676         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3677             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3678             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3679             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3680
  3681         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3682
  3683         16  FILLER                         PIC X(673).
  3684
  3685
  3686****************************************************************
  3687*             MORTGAGE SYSTEM PLAN RECORD                      *
  3688****************************************************************
  3689
  3690     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3691         16  CF-PLAN-TYPE                   PIC X.
  3692             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3693             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3694             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3695         16  CF-PLAN-ABBREV                 PIC XXX.
  3696         16  CF-PLAN-DESCRIPT               PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  66
* EL6316.cbl
  3697         16  CF-PLAN-NOTES                  PIC X(20).
  3698         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3699         16  CF-PLAN-UNDERWRITING.
  3700             20  CF-PLAN-TERM-DATA.
  3701                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3702                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3703             20  CF-PLAN-AGE-DATA.
  3704                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3705                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3706                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3707             20  CF-PLAN-BENEFIT-DATA.
  3708                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3709                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3710                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3711                                            PIC S9(7)V99  COMP-3.
  3712         16  CF-PLAN-POLICY-FORMS.
  3713             20  CF-POLICY-FORM             PIC X(12).
  3714             20  CF-MASTER-APPLICATION      PIC X(12).
  3715             20  CF-MASTER-POLICY           PIC X(12).
  3716         16  CF-PLAN-RATING.
  3717             20  CF-RATE-CODE               PIC X(5).
  3718             20  CF-SEX-RATING              PIC X.
  3719                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3720                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3721             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3722             20  CF-SUB-STD-TYPE            PIC X.
  3723                 88  CF-PCT-OF-PREM            VALUE '1'.
  3724                 88  CF-PCT-OF-BENE            VALUE '2'.
  3725         16  CF-PLAN-PREM-TOLERANCES.
  3726             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3727             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3728         16  CF-PLAN-PYMT-TOLERANCES.
  3729             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3730             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3731         16  CF-PLAN-MISC-DATA.
  3732             20  FILLER                     PIC X.
  3733             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3734             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3735         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3736         16  CF-PLAN-IND-GRP                PIC X.
  3737             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3738                                                     '1'.
  3739             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3740                                                     '2'.
  3741         16  CF-MIB-SEARCH-SW               PIC X.
  3742             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3743             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3744             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3745             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3746         16  CF-ALPHA-SEARCH-SW             PIC X.
  3747             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3748             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3749             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3750             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3751             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3752             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3753             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3754             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  67
* EL6316.cbl
  3755             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3756             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3757                                                     'A' 'B' 'C'
  3758                                                     'X' 'Y' 'Z'.
  3759         16  CF-EFF-DT-RULE-SW              PIC X.
  3760             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3761             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3762             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3763             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3764             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3765         16  FILLER                         PIC X(4).
  3766         16  CF-HEALTH-QUESTIONS            PIC X.
  3767             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3768         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3769         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3770         16  CF-PLAN-SNGL-JNT               PIC X.
  3771             88  CF-COMBINED-PLAN              VALUE 'C'.
  3772             88  CF-JNT-PLAN                   VALUE 'J'.
  3773             88  CF-SNGL-PLAN                  VALUE 'S'.
  3774         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3775         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3776         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3777         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3778         16  CF-RERATE-CNTL                 PIC  X.
  3779             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3780             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3781             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3782             88  CF-AUTO-RECALC                 VALUE '4'.
  3783         16  CF-BENEFIT-TYPE                PIC  X.
  3784             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3785             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3786         16  CF-POLICY-FEE                  PIC S999V99
  3787                                                    COMP-3.
  3788         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3789         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3790         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3791         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3792         16  FILLER                         PIC  X(32).
  3793         16  CF-TERMINATION-FORM            PIC  X(04).
  3794         16  FILLER                         PIC  X(08).
  3795         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3796                                                       COMP-3.
  3797         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3798         16  CF-ISSUE-LETTER                PIC  X(4).
  3799         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3800         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3801             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3802             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3803         16  CF-MP-REFUND-CALC              PIC X.
  3804             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3805             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3806             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3807             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3808             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3809             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3810             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3811             88  CF-MP-REFD-MEAN                VALUE '8'.
  3812         16  CF-ALT-RATE-CODE               PIC  X(5).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  68
* EL6316.cbl
  3813
  3814
  3815         16  FILLER                         PIC X(498).
  3816****************************************************************
  3817*             MORTGAGE COMPANY MASTER RECORD                   *
  3818****************************************************************
  3819
  3820     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3821         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3822         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3823             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3824             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3825             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3826             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3827             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3828
  3829         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3830         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3831         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3832         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3833         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3834
  3835         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3836             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3837         16  CF-MP-RECON-USE-IND            PIC X(1).
  3838             88  CF-MP-USE-RECON             VALUE 'Y'.
  3839         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3840             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3841         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3842             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3843             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3844         16  FILLER                         PIC X(1).
  3845         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3846             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3847         16  CF-MORTG-MIB-VERSION           PIC X.
  3848             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3849             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3850             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3851         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3852             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3853                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3854             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3855                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3856             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3857                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3858             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3859                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3860             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3861                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3862             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3863                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3864         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3865         16  FILLER                         PIC X(7).
  3866         16  CF-MORTG-DESTINATION-SYMBOL.
  3867             20  CF-MORTG-MIB-COMM          PIC X(5).
  3868             20  CF-MORTG-MIB-TERM          PIC X(5).
  3869         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3870             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  69
* EL6316.cbl
  3871         16  FILLER                         PIC X(03).
  3872         16  CF-MP-CHECK-NO-CONTROL.
  3873             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3874                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3875                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3876                                                ' ' LOW-VALUES.
  3877                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3878                                               VALUE '3'.
  3879         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3880         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3881         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3882             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3883                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3884             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3885                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3886             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3887                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3888             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3889                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3890             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3891                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3892             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3893                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3894         16  CF-MORTG-BILLING-AREA.
  3895             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3896                                            PIC X.
  3897         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3898         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3899         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3900         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3901             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3902             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3903         16  FILLER                         PIC X.
  3904         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3905             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3906             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3907         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3908         16  FILLER                         PIC X(8).
  3909         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3910         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3911         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3912         16  CF-ACH-COMPANY-ID.
  3913             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3914                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3915                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3916                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3917             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3918         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3919             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3920         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3921             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3922             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3923         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3924         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3925         16  FILLER                         PIC X(536).
  3926
  3927****************************************************************
  3928*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  70
* EL6316.cbl
  3929****************************************************************
  3930
  3931     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3932         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3933             20  CF-FEMALE-HEIGHT.
  3934                 24  CF-FEMALE-FT           PIC 99.
  3935                 24  CF-FEMALE-IN           PIC 99.
  3936             20  CF-FEMALE-MIN-WT           PIC 999.
  3937             20  CF-FEMALE-MAX-WT           PIC 999.
  3938         16  FILLER                         PIC X(428).
  3939
  3940     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3941         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3942             20  CF-MALE-HEIGHT.
  3943                 24  CF-MALE-FT             PIC 99.
  3944                 24  CF-MALE-IN             PIC 99.
  3945             20  CF-MALE-MIN-WT             PIC 999.
  3946             20  CF-MALE-MAX-WT             PIC 999.
  3947         16  FILLER                         PIC X(428).
  3948******************************************************************
  3949*             AUTOMATIC ACTIVITY RECORD                          *
  3950******************************************************************
  3951     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3952         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3953             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3954             20  CF-SYS-LETTER-ID           PIC X(04).
  3955             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3956             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3957             20  CF-SYS-RESET-SW            PIC X(01).
  3958             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3959             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3960
  3961         16  FILLER                         PIC X(50).
  3962
  3963         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3964             20  CF-USER-ACTIVE-SW          PIC X(01).
  3965             20  CF-USER-LETTER-ID          PIC X(04).
  3966             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3967             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3968             20  CF-USER-RESET-SW           PIC X(01).
  3969             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3970             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3971             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3972
  3973         16  FILLER                         PIC X(246).
  3974*                                COPY ERCPNDB.
  3975******************************************************************
  3976*                                                                *
  3977*                                                                *
  3978*                            ERCPNDB.                            *
  3979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3980*                            VMOD=2.025                          *
  3981*                                                                *
  3982*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3983*                                                                *
  3984******************************************************************
  3985*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3986*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  71
* EL6316.cbl
  3987******************************************************************
  3988*                                                                *
  3989*                                                                *
  3990*   FILE TYPE = VSAM,KSDS                                        *
  3991*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3992*                                                                *
  3993*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3994*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3995*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3996*                                                 RKP=13,LEN=36  *
  3997*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3998*                                      AND CHG-SEQ.)             *
  3999*                                                RKP=49,LEN=11   *
  4000*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4001*                                      AND CHG-SEQ.)             *
  4002*                                                RKP=60,LEN=15   *
  4003*                                                                *
  4004*   LOG = NO                                                     *
  4005*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4006******************************************************************
  4007******************************************************************
  4008*                   C H A N G E   L O G
  4009*
  4010* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4011*-----------------------------------------------------------------
  4012*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4013* EFFECTIVE    NUMBER
  4014*-----------------------------------------------------------------
  4015* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4016* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4017* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4018* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4019* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4020* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4021* 032306                   PEMA  ADD BOW LOAN NUMBER
  4022* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4023* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4024* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4025* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4026* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4027* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4028* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4029* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4030******************************************************************
  4031
  4032 01  PENDING-BUSINESS.
  4033     12  PB-RECORD-ID                     PIC XX.
  4034         88  VALID-PB-ID                        VALUE 'PB'.
  4035
  4036     12  PB-CONTROL-PRIMARY.
  4037         16  PB-COMPANY-CD                PIC X.
  4038         16  PB-ENTRY-BATCH               PIC X(6).
  4039         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4040         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4041
  4042     12  PB-CONTROL-BY-ACCOUNT.
  4043         16  PB-COMPANY-CD-A1             PIC X.
  4044         16  PB-CARRIER                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  72
* EL6316.cbl
  4045         16  PB-GROUPING.
  4046             20  PB-GROUPING-PREFIX       PIC XXX.
  4047             20  PB-GROUPING-PRIME        PIC XXX.
  4048         16  PB-STATE                     PIC XX.
  4049         16  PB-ACCOUNT.
  4050             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4051             20  PB-ACCOUNT-PRIME         PIC X(6).
  4052         16  PB-CERT-EFF-DT               PIC XX.
  4053         16  PB-CERT-NO.
  4054             20  PB-CERT-PRIME            PIC X(10).
  4055             20  PB-CERT-SFX              PIC X.
  4056         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4057
  4058         16  PB-RECORD-TYPE               PIC X.
  4059             88  PB-MAILING-DATA                VALUE '0'.
  4060             88  PB-ISSUE                       VALUE '1'.
  4061             88  PB-CANCELLATION                VALUE '2'.
  4062             88  PB-BATCH-TRAILER               VALUE '9'.
  4063
  4064     12  PB-CONTROL-BY-ORIG-BATCH.
  4065         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4066         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4067         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4068         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4069
  4070     12  PB-CONTROL-BY-CSR.
  4071         16  PB-CSR-COMPANY-CD            PIC X.
  4072         16  PB-CSR-ID                    PIC X(4).
  4073         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4074         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4075         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4076******************************************************************
  4077*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4078******************************************************************
  4079
  4080     12  PB-LAST-MAINT-DT                 PIC XX.
  4081     12  PB-LAST-MAINT-BY                 PIC X(4).
  4082     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4083
  4084     12  PB-RECORD-BODY                   PIC X(375).
  4085
  4086     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4087         16  PB-CERT-ORIGIN               PIC X.
  4088             88  CLASIC-CREATED-CERT         VALUE '1'.
  4089         16  PB-I-NAME.
  4090             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4091             20  PB-I-INSURED-FIRST-NAME.
  4092                 24  PB-I-INSURED-1ST-INIT PIC X.
  4093                 24  FILLER                PIC X(9).
  4094             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4095         16  PB-I-AGE                     PIC S99   COMP-3.
  4096         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4097         16  PB-I-BIRTHDAY                PIC XX.
  4098         16  PB-I-INSURED-SEX             PIC X.
  4099             88  PB-SEX-MALE     VALUE 'M'.
  4100             88  PB-SEX-FEMALE   VALUE 'F'.
  4101
  4102         16  PB-I-LF-TERM                 PIC S999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  73
* EL6316.cbl
  4103         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4104         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4105         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4106         16  PB-I-SKIP-CODE               PIC X.
  4107             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4108             88  PB-SKIP-JULY              VALUE '1'.
  4109             88  PB-SKIP-AUGUST            VALUE '2'.
  4110             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4111             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4112             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4113             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4114             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4115             88  PB-SKIP-JUNE              VALUE '8'.
  4116             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4117             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4118             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4119         16  PB-I-TERM-TYPE               PIC X.
  4120             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4121             88  PB-PAID-WEEKLY            VALUE 'W'.
  4122             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4123             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4124             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4125         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4126         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4127         16  PB-I-DATA-ENTRY-SW           PIC X.
  4128             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4129             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4130             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4131             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4132         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4133         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4134*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4135         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4136         16  FILLER                       PIC X.
  4137
  4138         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4139             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4140             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4141                                                   '90' THRU '99'.
  4142         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4143                                          PIC XX.
  4144         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4145         16  PB-I-AMOUNT-FINANCED REDEFINES
  4146                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4147         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4148         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4149                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4150         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4151         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4152         16  PB-I-CLP-AMOUNT REDEFINES
  4153                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4154         16  PB-I-LF-CALC-FLAG            PIC X.
  4155             88 PB-COMP-LF-PREM               VALUE '?'.
  4156         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4157         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4158         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4159         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4160         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  74
* EL6316.cbl
  4161         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4162         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4163         16  PB-I-LF-ABBR                 PIC XXX.
  4164         16  PB-I-LF-INPUT-CD             PIC XX.
  4165
  4166         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4167             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4168             88  PB-INVALID-AH               VALUE '  ' '00'
  4169                                                   '90' THRU '99'.
  4170         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4171         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4172         16  PB-I-AH-CALC-FLAG            PIC X.
  4173             88 PB-COMP-AH-PREM                  VALUE '?'.
  4174         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4175         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4176         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4177         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4178         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4179         16  PB-I-AH-ABBR                 PIC XXX.
  4180         16  PB-I-AH-INPUT-CD             PIC XXX.
  4181
  4182         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4183         16  PB-I-REIN-TABLE              PIC XXX.
  4184         16  PB-I-BUSINESS-TYPE           PIC 99.
  4185         16  PB-I-INDV-GRP-CD             PIC X.
  4186         16  PB-I-MORT-CODE.
  4187             20  PB-I-TABLE               PIC X.
  4188             20  PB-I-INTEREST            PIC XX.
  4189             20  PB-I-MORT-TYP            PIC X.
  4190         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4191         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4192         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4193         16  PB-I-INDV-GRP-OVRD           PIC X.
  4194         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4195         16  PB-I-SIG-SW                  PIC X.
  4196             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4197         16  PB-I-RATE-CLASS              PIC XX.
  4198         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4199         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4200         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4201         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4202         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4203         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4204         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4205         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4206         16  PB-I-OB-FLAG                 PIC X.
  4207             88  PB-I-OB                      VALUE 'B'.
  4208             88  PB-I-SUMMARY                 VALUE 'Z'.
  4209         16  PB-I-ENTRY-STATUS            PIC X.
  4210             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4211                                              'M' '5' '9' '2'.
  4212             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4213             88  PB-I-POLICY-PENDING          VALUE '2'.
  4214             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4215             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4216             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4217             88  PB-I-REIN-ONLY               VALUE '9'.
  4218             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  75
* EL6316.cbl
  4219             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4220             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4221             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4222         16  PB-I-INT-CODE                PIC X.
  4223             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4224             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4225         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4226         16  PB-I-SOC-SEC-NO              PIC X(11).
  4227         16  PB-I-MEMBER-NO               PIC X(12).
  4228         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4229*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4230         16  PB-I-OLD-LOF                 PIC XXX.
  4231         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4232         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4233         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4234         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4235         16  PB-I-LIFE-INDICATOR          PIC X.
  4236             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4237         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4238         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4239                                          PIC S9(5)V99    COMP-3.
  4240         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4241             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4242             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4243         16  PB-I-1ST-PMT-DT              PIC XX.
  4244         16  PB-I-JOINT-INSURED.
  4245             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4246             20 PB-I-JOINT-FIRST-NAME.
  4247                24  PB-I-JOINT-FIRST-INIT PIC X.
  4248                24  FILLER                PIC X(9).
  4249             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4250*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4251         16  PB-I-BENEFICIARY-NAME.
  4252             20  PB-I-BANK-NUMBER         PIC X(10).
  4253             20  FILLER                   PIC X(15).
  4254         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4255         16  PB-I-REFERENCE               PIC X(12).
  4256         16  FILLER REDEFINES PB-I-REFERENCE.
  4257             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4258             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4259             20  PB-I-CLP-STATE           PIC XX.
  4260         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4261             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4262             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4263             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4264         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4265         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4266         16  PB-I-RESIDENT-STATE          PIC XX.
  4267         16  PB-I-RATE-CODE               PIC X(4).
  4268         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4269         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4270         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4271         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4272         16  PB-I-BANK-NOCHRGB            PIC 99.
  4273         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4274         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4275
  4276     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  76
* EL6316.cbl
  4277         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4278             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4279         16  PB-C-CANCEL-ORIGIN           PIC X.
  4280             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4281         16  PB-C-LF-CANCEL-DT            PIC XX.
  4282         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4283         16  PB-C-LF-CALC-REQ             PIC X.
  4284             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4285         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4286         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4287         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4288             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4289         16  PB-C-AH-CANCEL-DT            PIC XX.
  4290         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4291         16  PB-C-AH-CALC-REQ             PIC X.
  4292             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4293         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4294         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4295         16  PB-C-LAST-NAME               PIC X(15).
  4296         16  PB-C-REFUND-SW               PIC X.
  4297             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4298             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4299         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4300         16  PB-C-PAYEE-CODE              PIC X(6).
  4301         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4302         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4303         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4304         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4305         16  PB-C-REFERENCE               PIC X(12).
  4306         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4307         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4308         16  PB-C-POST-CARD-IND           PIC X.
  4309         16  PB-C-CANCEL-REASON           PIC X.
  4310         16  PB-C-REF-INTERFACE-SW        PIC X.
  4311         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4312         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4313         16  FILLER                       PIC X(01).
  4314*        16  FILLER                       PIC X(18).
  4315         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4316*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4317         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4318         16  PB-CANCELED-CERT-DATA.
  4319             20  PB-CI-INSURED-NAME.
  4320                 24  PB-CI-LAST-NAME      PIC X(15).
  4321                 24  PB-CI-INITIALS       PIC XX.
  4322             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4323             20  PB-CI-INSURED-SEX        PIC X.
  4324             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4325             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4326             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4327             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4328             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4329             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4330             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4331             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4332             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4333             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4334             20  PB-CI-RATE-CLASS         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  77
* EL6316.cbl
  4335             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4336             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4337             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4338             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4339             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4340             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4341             20  PB-CI-LF-ABBR            PIC X(3).
  4342             20  PB-CI-AH-ABBR            PIC X(3).
  4343             20  PB-CI-OB-FLAG            PIC X.
  4344                 88  PB-CI-OB                VALUE 'B'.
  4345             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4346                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4347                                           'M' '4' '5' '9' '2'.
  4348                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4349                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4350                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4351                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4352                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4353                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4354                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4355                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4356                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4357                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4358                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4359                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4360             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4361                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4362                                           'M' '4' '5' '9' '2'.
  4363                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4364                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4365                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4366                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4367                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4368                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4369                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4370                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4371                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4372                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4373                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4374                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4375             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4376             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4377             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4378             20  PB-CI-MEMBER-NO          PIC X(12).
  4379             20  PB-CI-INT-CODE           PIC X.
  4380                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4381                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4382             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4383             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4384             20  PB-CI-COMP-EXCP-SW       PIC X.
  4385                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4386                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4387             20  PB-CI-ENTRY-STATUS       PIC X.
  4388             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4389             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4390             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4391             20  PB-CI-DEATH-DT           PIC XX.
  4392             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  78
* EL6316.cbl
  4393             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4394             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4395             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4396             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4397             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4398             20  PB-CI-ENTRY-DT              PIC XX.
  4399             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4400             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4401             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4402             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4403             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4404             20  PB-CI-OLD-LOF               PIC XXX.
  4405*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4406             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4407             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4408             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4409             20  PB-CI-INDV-GRP-CD           PIC X.
  4410             20  PB-CI-BENEFICIARY-NAME.
  4411                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4412                 24  FILLER                  PIC X(15).
  4413             20  PB-CI-NOTE-SW               PIC X.
  4414             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4415             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4416             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4417             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4418             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4419             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4420             20  PB-CI-FIRST-NAME            PIC X(10).
  4421             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4422
  4423         16  FILLER                       PIC X(13).
  4424*032306  16  FILLER                       PIC X(27).
  4425*        16  FILLER                       PIC X(46).
  4426
  4427     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4428         16  FILLER                       PIC X(10).
  4429         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4430         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4431         16  PB-M-INSURED-MID-INIT        PIC X.
  4432         16  PB-M-INSURED-AGE             PIC 99.
  4433         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4434         16  PB-M-INSURED-SEX             PIC X.
  4435         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4436         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4437         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4438         16  PB-M-INSURED-CITY-STATE.
  4439             20  PB-M-INSURED-CITY        PIC X(28).
  4440             20  PB-M-INSURED-STATE       PIC XX.
  4441         16  PB-M-INSURED-ZIP-CODE.
  4442             20  PB-M-INSURED-ZIP-PRIME.
  4443                 24  PB-M-INSURED-ZIP-1   PIC X.
  4444                     88  PB-M-CANADIAN-POST-CODE
  4445                                             VALUE 'A' THRU 'Z'.
  4446                 24  FILLER               PIC X(4).
  4447             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4448         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4449                                        PB-M-INSURED-ZIP-CODE.
  4450             20  PM-M-INS-CAN-POST1       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  79
* EL6316.cbl
  4451             20  PM-M-INS-CAN-POST2       PIC XXX.
  4452             20  FILLER                   PIC XXX.
  4453         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4454         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4455         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4456         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4457         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4458         16  PB-M-CRED-BENE-CITYST.
  4459             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4460             20  PB-M-CRED-BENE-STATE     PIC XX.
  4461         16  FILLER                       PIC X(92).
  4462
  4463     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4464         16  FILLER                       PIC X(10).
  4465         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4466         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4467         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4468         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4469         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4470         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4471         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4472         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4473         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4474         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4475         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4476         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4477         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4478         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4479         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4480         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4481         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4482         16  PB-ACCOUNT-NAME              PIC X(30).
  4483         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4484         16  PB-REFERENCE                 PIC X(12).
  4485         16  PB-B-RECEIVED-DT             PIC XX.
  4486         16  FILLER                       PIC X(234).
  4487
  4488     12  PB-RECORD-STATUS.
  4489         16  PB-CREDIT-SELECT-DT          PIC XX.
  4490         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4491         16  PB-BILLED-DT                 PIC XX.
  4492         16  PB-BILLING-STATUS            PIC X.
  4493             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4494             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4495             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4496         16  PB-RECORD-BILL               PIC X.
  4497             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4498             88  PB-RECORD-RETURNED           VALUE 'R'.
  4499             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4500             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4501             88  PB-OVERRIDE-AH               VALUE 'A'.
  4502             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4503         16  PB-BATCH-ENTRY               PIC X.
  4504             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4505             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4506             88  PB-REISSUED-CERT             VALUE 'E'.
  4507             88  PB-MONTHLY-CERT              VALUE 'M'.
  4508             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  80
* EL6316.cbl
  4509             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4510             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4511         16  PB-FORCE-CODE                PIC X.
  4512             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4513             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4514             88  PB-CANCEL-FORCE              VALUE '8'.
  4515             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4516             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4517             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4518             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4519             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4520             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4521             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4522         16  PB-FATAL-FLAG                PIC X.
  4523             88  PB-FATAL-ERRORS              VALUE 'X'.
  4524         16  PB-FORCE-ER-CD               PIC X.
  4525             88  PB-FORCE-ERRORS              VALUE 'F'.
  4526             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4527         16  PB-WARN-ER-CD                PIC X.
  4528             88  PB-WARNING-ERRORS            VALUE 'W'.
  4529         16  FILLER                       PIC X.
  4530         16  PB-OUT-BAL-CD                PIC X.
  4531             88  PB-OUT-OF-BAL                VALUE 'O'.
  4532         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4533         16  PB-AH-OVERRIDE-L1            PIC X.
  4534         16  PB-INPUT-DT                  PIC XX.
  4535         16  PB-INPUT-BY                  PIC X(4).
  4536         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4537         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4538         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4539         16  PB-LF-EARNING-METHOD         PIC X.
  4540         16  PB-AH-EARNING-METHOD         PIC X.
  4541         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4542         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4543         16  PB-REIN-CD                   PIC XXX.
  4544         16  PB-LF-REFUND-TYPE            PIC X.
  4545         16  PB-AH-REFUND-TYPE            PIC X.
  4546         16  PB-ACCT-EFF-DT               PIC XX.
  4547         16  PB-ACCT-EXP-DT               PIC XX.
  4548         16  PB-COMPANY-ID                PIC X(3).
  4549         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4550         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4551         16  PB-SV-CARRIER                PIC X.
  4552         16  PB-SV-GROUPING               PIC X(6).
  4553         16  PB-SV-STATE                  PIC XX.
  4554         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4555         16  PB-GA-BILLING-INFO.
  4556             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4557                                          PIC XX.
  4558         16  PB-SV-REMIT-TO  REDEFINES
  4559             PB-GA-BILLING-INFO           PIC X(10).
  4560         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4561         16  PB-I-LOAN-OFFICER            PIC X(5).
  4562         16  PB-I-VIN                     PIC X(17).
  4563
  4564         16  FILLER                       PIC X(04).
  4565         16  IMNET-BYPASS-SW              PIC X.
  4566
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  81
* EL6316.cbl
  4567******************************************************************
  4568*                COMMON EDIT ERRORS                              *
  4569******************************************************************
  4570
  4571     12  PB-COMMON-ERRORS.
  4572         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4573                                           PIC S9(4)     COMP.
  4574
  4575******************************************************************
  4576*                                COPY ELCCERT.
  4577******************************************************************
  4578*                                                                *
  4579*                            ELCCERT.                            *
  4580*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4581*                            VMOD=2.013                          *
  4582*                                                                *
  4583*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4584*                                                                *
  4585*   FILE TYPE = VSAM,KSDS                                        *
  4586*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4587*                                                                *
  4588*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4589*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4590*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4591*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4592*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4593*                                                                *
  4594*   LOG = YES                                                    *
  4595*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4596******************************************************************
  4597*                   C H A N G E   L O G
  4598*
  4599* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4600*-----------------------------------------------------------------
  4601*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4602* EFFECTIVE    NUMBER
  4603*-----------------------------------------------------------------
  4604* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4605* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4606* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4607* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4608* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4609* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4610* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4611* 032612  CR2011110200001  PEMA  AHL CHANGES
  4612******************************************************************
  4613
  4614 01  CERTIFICATE-MASTER.
  4615     12  CM-RECORD-ID                      PIC XX.
  4616         88  VALID-CM-ID                      VALUE 'CM'.
  4617
  4618     12  CM-CONTROL-PRIMARY.
  4619         16  CM-COMPANY-CD                 PIC X.
  4620         16  CM-CARRIER                    PIC X.
  4621         16  CM-GROUPING.
  4622             20  CM-GROUPING-PREFIX        PIC X(3).
  4623             20  CM-GROUPING-PRIME         PIC X(3).
  4624         16  CM-STATE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  82
* EL6316.cbl
  4625         16  CM-ACCOUNT.
  4626             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4627             20  CM-ACCOUNT-PRIME          PIC X(6).
  4628         16  CM-CERT-EFF-DT                PIC XX.
  4629         16  CM-CERT-NO.
  4630             20  CM-CERT-PRIME             PIC X(10).
  4631             20  CM-CERT-SFX               PIC X.
  4632
  4633     12  CM-CONTROL-BY-NAME.
  4634         16  CM-COMPANY-CD-A1              PIC X.
  4635         16  CM-INSURED-LAST-NAME          PIC X(15).
  4636         16  CM-INSURED-INITIALS.
  4637             20  CM-INSURED-INITIAL1       PIC X.
  4638             20  CM-INSURED-INITIAL2       PIC X.
  4639
  4640     12  CM-CONTROL-BY-SSN.
  4641         16  CM-COMPANY-CD-A2              PIC X.
  4642         16  CM-SOC-SEC-NO.
  4643             20  CM-SSN-STATE              PIC XX.
  4644             20  CM-SSN-ACCOUNT            PIC X(6).
  4645             20  CM-SSN-LN3.
  4646                 25  CM-INSURED-INITIALS-A2.
  4647                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4648                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4649                 25 CM-PART-LAST-NAME-A2         PIC X.
  4650
  4651     12  CM-CONTROL-BY-CERT-NO.
  4652         16  CM-COMPANY-CD-A4              PIC X.
  4653         16  CM-CERT-NO-A4                 PIC X(11).
  4654
  4655     12  CM-CONTROL-BY-MEMB.
  4656         16  CM-COMPANY-CD-A5              PIC X.
  4657         16  CM-MEMBER-NO.
  4658             20  CM-MEMB-STATE             PIC XX.
  4659             20  CM-MEMB-ACCOUNT           PIC X(6).
  4660             20  CM-MEMB-LN4.
  4661                 25  CM-INSURED-INITIALS-A5.
  4662                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4663                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4664                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4665
  4666     12  CM-INSURED-PROFILE-DATA.
  4667         16  CM-INSURED-FIRST-NAME.
  4668             20  CM-INSURED-1ST-INIT       PIC X.
  4669             20  FILLER                    PIC X(9).
  4670         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4671         16  CM-INSURED-SEX                PIC X.
  4672             88  CM-SEX-MALE                  VALUE 'M'.
  4673             88  CM-SEX-FEMAL                 VALUE 'F'.
  4674         16  CM-INSURED-JOINT-AGE          PIC 99.
  4675         16  CM-JOINT-INSURED-NAME.
  4676             20  CM-JT-LAST-NAME           PIC X(15).
  4677             20  CM-JT-FIRST-NAME.
  4678                 24  CM-JT-1ST-INIT        PIC X.
  4679                 24  FILLER                PIC X(9).
  4680             20  CM-JT-INITIAL             PIC X.
  4681
  4682     12  CM-LIFE-DATA.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  83
* EL6316.cbl
  4683         16  CM-LF-BENEFIT-CD              PIC XX.
  4684         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4685         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4686         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4687         16  CM-LF-DEV-CODE                PIC XXX.
  4688         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4689         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4690         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4691         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4692         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4693         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4694         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4695         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4696         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4697         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4698         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4699         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4700         16  FILLER                        PIC XX.
  4701
  4702     12  CM-AH-DATA.
  4703         16  CM-AH-BENEFIT-CD              PIC XX.
  4704         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4705         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4706         16  CM-AH-DEV-CODE                PIC XXX.
  4707         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4708         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4709         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4710         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4711         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4712         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4713         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4714         16  CM-AH-PAID-THRU-DT            PIC XX.
  4715             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4716         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4717         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4718         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4719         16  FILLER                        PIC X.
  4720
  4721     12  CM-LOAN-INFORMATION.
  4722         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4723         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4724                                           PIC S9(5)V99  COMP-3.
  4725         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4726         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4727         16  CM-PAY-FREQUENCY              PIC S99.
  4728         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4729         16  CM-RATE-CLASS                 PIC XX.
  4730         16  CM-BENEFICIARY                PIC X(25).
  4731         16  CM-POLICY-FORM-NO             PIC X(12).
  4732         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4733         16  CM-LAST-ADD-ON-DT             PIC XX.
  4734         16  CM-DEDUCTIBLE-AMOUNTS.
  4735             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4736             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4737         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4738             20  CM-RESIDENT-STATE         PIC XX.
  4739             20  CM-RATE-CODE              PIC X(4).
  4740             20  FILLER                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  84
* EL6316.cbl
  4741         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4742             20  CM-LOAN-OFFICER           PIC X(5).
  4743             20  FILLER                    PIC XXX.
  4744         16  CM-CSR-CODE                   PIC XXX.
  4745         16  CM-UNDERWRITING-CODE          PIC X.
  4746             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4747         16  CM-POST-CARD-IND              PIC X.
  4748         16  CM-NH-INTERFACE-SW            PIC X.
  4749         16  CM-PREMIUM-TYPE               PIC X.
  4750             88  CM-SING-PRM                  VALUE '1'.
  4751             88  CM-O-B-COVERAGE              VALUE '2'.
  4752             88  CM-OPEN-END                  VALUE '3'.
  4753         16  CM-IND-GRP-TYPE               PIC X.
  4754             88  CM-INDIVIDUAL                VALUE 'I'.
  4755             88  CM-GROUP                     VALUE 'G'.
  4756         16  CM-SKIP-CODE                  PIC X.
  4757             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4758             88  SKIP-JULY                    VALUE '1'.
  4759             88  SKIP-AUGUST                  VALUE '2'.
  4760             88  SKIP-SEPTEMBER               VALUE '3'.
  4761             88  SKIP-JULY-AUG                VALUE '4'.
  4762             88  SKIP-AUG-SEPT                VALUE '5'.
  4763             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4764             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4765             88  SKIP-JUNE                    VALUE '8'.
  4766             88  SKIP-JUNE-JULY               VALUE '9'.
  4767             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4768             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4769         16  CM-PAYMENT-MODE               PIC X.
  4770             88  PAY-MONTHLY                  VALUE SPACE.
  4771             88  PAY-WEEKLY                   VALUE '1'.
  4772             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4773             88  PAY-BI-WEEKLY                VALUE '3'.
  4774             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4775         16  CM-LOAN-NUMBER                PIC X(8).
  4776         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4777         16  CM-OLD-LOF                    PIC XXX.
  4778*        16  CM-LOAN-OFFICER               PIC XXX.
  4779         16  CM-REIN-TABLE                 PIC XXX.
  4780         16  CM-SPECIAL-REIN-CODE          PIC X.
  4781         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4782         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4783         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4784
  4785     12  CM-STATUS-DATA.
  4786         16  CM-ENTRY-STATUS               PIC X.
  4787         16  CM-ENTRY-DT                   PIC XX.
  4788
  4789         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4790         16  CM-LF-CANCEL-DT               PIC XX.
  4791         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4792
  4793         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4794         16  CM-LF-DEATH-DT                PIC XX.
  4795         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4796
  4797         16  CM-LF-CURRENT-STATUS          PIC X.
  4798             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  85
* EL6316.cbl
  4799                                                'M' '4' '5' '9'.
  4800             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4801             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4802             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4803             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4804             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4805             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4806             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4807             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4808             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4809             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4810             88  CM-LF-DECLINED               VALUE 'D'.
  4811             88  CM-LF-VOIDED                 VALUE 'V'.
  4812
  4813         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4814         16  CM-AH-CANCEL-DT               PIC XX.
  4815         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4816
  4817         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4818         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4819         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4820
  4821         16  CM-AH-CURRENT-STATUS          PIC X.
  4822             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4823                                                'M' '4' '5' '9'.
  4824             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4825             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4826             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4827             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4828             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4829             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4830             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4831             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4832             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4833             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4834             88  CM-AH-DECLINED               VALUE 'D'.
  4835             88  CM-AH-VOIDED                 VALUE 'V'.
  4836
  4837         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4838             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4839             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4840             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4841         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4842
  4843         16  CM-ENTRY-BATCH                PIC X(6).
  4844         16  CM-LF-EXIT-BATCH              PIC X(6).
  4845         16  CM-AH-EXIT-BATCH              PIC X(6).
  4846         16  CM-LAST-MONTH-END             PIC XX.
  4847
  4848     12  CM-NOTE-SW                        PIC X.
  4849         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4850         88  CERT-NOTES-PRESENT               VALUE '1'.
  4851         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4852         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4853         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4854         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4855         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4856         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  86
* EL6316.cbl
  4857     12  CM-COMP-EXCP-SW                   PIC X.
  4858         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4859         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4860     12  CM-INSURED-ADDRESS-SW             PIC X.
  4861         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4862         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4863
  4864*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4865     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4866     12  FILLER                            PIC X.
  4867
  4868*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4869     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4870     12  FILLER                            PIC X.
  4871*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4872     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4873
  4874     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4875         88  CERT-ADDED-BATCH                 VALUE ' '.
  4876         88  CERT-ADDED-ONLINE                VALUE '1'.
  4877         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4878         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4879         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4880     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4881         88  CERT-AS-LOADED                   VALUE ' '.
  4882         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4883         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4884         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4885         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4886         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4887         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4888         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4889
  4890     12  CM-ACCOUNT-COMM-PCTS.
  4891         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4892         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4893
  4894     12  CM-USER-FIELD                     PIC X.
  4895     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4896     12  CM-CLP-STATE                      PIC XX.
  4897     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4898     12  CM-USER-RESERVED                  PIC XXX.
  4899     12  FILLER REDEFINES CM-USER-RESERVED.
  4900         16  CM-AH-CLASS-CD                PIC XX.
  4901         16  F                             PIC X.
  4902******************************************************************
  4903*                                COPY ELCCRTO.
  4904******************************************************************
  4905*                                                                *
  4906*                            ELCCRTO.                            *
  4907*                                                                *
  4908*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4909*                                                                *
  4910*   FILE TYPE = VSAM,KSDS                                        *
  4911*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4912*                                                                *
  4913*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4914*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  87
* EL6316.cbl
  4915*   LOG = YES                                                    *
  4916*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4917******************************************************************
  4918*                   C H A N G E   L O G
  4919*
  4920* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4921*-----------------------------------------------------------------
  4922*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4923* EFFECTIVE    NUMBER
  4924*-----------------------------------------------------------------
  4925* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4926* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4927* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4928* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4929* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4930******************************************************************
  4931 01  ORIGINAL-CERTIFICATE.
  4932     12  OC-RECORD-ID                      PIC XX.
  4933         88  VALID-OC-ID                      VALUE 'OC'.
  4934     12  OC-CONTROL-PRIMARY.
  4935         16  OC-COMPANY-CD                 PIC X.
  4936         16  OC-CARRIER                    PIC X.
  4937         16  OC-GROUPING                   PIC X(6).
  4938         16  OC-STATE                      PIC XX.
  4939         16  OC-ACCOUNT                    PIC X(10).
  4940         16  OC-CERT-EFF-DT                PIC XX.
  4941         16  OC-CERT-NO.
  4942             20  OC-CERT-PRIME             PIC X(10).
  4943             20  OC-CERT-SFX               PIC X.
  4944         16  OC-RECORD-TYPE                PIC X.
  4945         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4946     12  OC-LAST-MAINT-DT                  PIC XX.
  4947     12  OC-LAST-MAINT-BY                  PIC X(4).
  4948     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4949     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4950     12  FILLER                            PIC X(49).
  4951     12  OC-ORIG-REC.
  4952         16  OC-INS-LAST-NAME              PIC X(15).
  4953         16  OC-INS-FIRST-NAME             PIC X(10).
  4954         16  OC-INS-MIDDLE-INIT            PIC X.
  4955         16  OC-INS-AGE                    PIC S999     COMP-3.
  4956         16  OC-JNT-LAST-NAME              PIC X(15).
  4957         16  OC-JNT-FIRST-NAME             PIC X(10).
  4958         16  OC-JNT-MIDDLE-INIT            PIC X.
  4959         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4960         16  OC-LF-BENCD                   PIC XX.
  4961         16  OC-LF-TERM                    PIC S999      COMP-3.
  4962         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4963         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4964         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4965         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4966         16  OC-LF-EXP-DT                  PIC XX.
  4967         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4968         16  OC-LF-CANCEL-DT               PIC XX.
  4969         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4970         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4971         16  OC-AH-BENCD                   PIC XX.
  4972         16  OC-AH-TERM                    PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  88
* EL6316.cbl
  4973         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4974         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4975         16  OC-AH-EXP-DT                  PIC XX.
  4976         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4977         16  OC-AH-CP                      PIC 99.
  4978         16  OC-AH-CANCEL-DT               PIC XX.
  4979         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4980         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4981         16  OC-CRED-BENE-NAME             PIC X(25).
  4982         16  OC-1ST-PMT-DT                 PIC XX.
  4983         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4984         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4985         16  OC-ISSUE-TRAN-IND             PIC X.
  4986         16  OC-CANCEL-TRAN-IND            PIC X.
  4987         16  FILLER                        PIC X(211).
  4988
  4989     12  FILLER                            PIC X(50).
  4990******************************************************************
  4991*                                COPY ERCENDT.
  4992******************************************************************
  4993*                                                                *
  4994*                                                                *
  4995*                            ERCENDT.                            *
  4996*                            VMOD=2.001                          *
  4997*                                                                *
  4998*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4999*                                                                *
  5000*   FILE TYPE = VSAM,KSDS                                        *
  5001*   RECORD SIZE = 579  RECFORM = FIXED                           *
  5002*                                                                *
  5003*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  5004*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  5005*                                                                *
  5006*   LOG = NO                                                     *
  5007*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5008******************************************************************
  5009*-----------------------------------------------------------------
  5010*                   C H A N G E   L O G
  5011*
  5012* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5013*-----------------------------------------------------------------
  5014*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5015* EFFECTIVE    NUMBER
  5016*-----------------------------------------------------------------
  5017* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  5018*                                WITH OPEN CLAIMS
  5019* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  5020* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5021* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5022*-----------------------------------------------------------------
  5023 01  ENDORSEMENT-RECORD.
  5024     12  EN-RECORD-ID                PIC XX.
  5025         88  VALID-EN-ID                VALUE 'EN'.
  5026     12  EN-CONTROL-PRIMARY.
  5027         16  EN-COMPANY-CD           PIC X.
  5028         16  EN-CARRIER              PIC X.
  5029         16  EN-GROUPING             PIC X(6).
  5030         16  EN-STATE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  89
* EL6316.cbl
  5031         16  EN-ACCOUNT              PIC X(10).
  5032         16  EN-CERT-EFF-DT          PIC XX.
  5033         16  EN-CERT-NO.
  5034             20  EN-CERT-PRIME       PIC X(10).
  5035             20  EN-CERT-SFX         PIC X.
  5036         16  EN-REC-TYPE             PIC X.
  5037             88  EN-ISSUE               VALUE 'I'.
  5038             88  EN-CANCELLATION        VALUE 'C'.
  5039         16  EN-SEQ-NO               PIC 9(04) BINARY.
  5040     12  EN-CONTROL-BY-ARCH-NO.
  5041         16  EN-COMPANY-CD-A1              PIC X.
  5042         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  5043     12  EN-LAST-MAINT-DT            PIC XX.
  5044     12  EN-LAST-MAINT-BY            PIC X(4).
  5045     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  5046     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  5047     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5048         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  5049         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  5050         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  5051         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  5052         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  5053         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  5054         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  5055         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  5056         16  EN-LF-ORIG-BENCD        PIC XX.
  5057         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  5058         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5059         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5060         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  5061         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  5062         16  EN-LF-ORIG-EXP-DT       PIC XX.
  5063*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  5064         16  EN-ORIG-CRED-BENE       PIC X(25).
  5065         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5066         16  FILLER                  PIC X.
  5067         16  EN-AH-ORIG-BENCD        PIC XX.
  5068         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  5069         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5070         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5071         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5072*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5073*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  5074         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5075         16  F                       PIC X(09).
  5076         16  EN-AH-ORIG-CP           PIC 99.
  5077         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5078         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5079         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5080         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5081         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5082         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5083         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5084         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5085         16  EN-LF-NEW-BENCD         PIC XX.
  5086         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5087         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5088         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  90
* EL6316.cbl
  5089         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5090         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5091         16  EN-LF-NEW-EXP-DT        PIC XX.
  5092         16  EN-NEW-CRED-BENE        PIC X(25).
  5093         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5094         16  FILLER                  PIC X.
  5095         16  EN-AH-NEW-BENCD         PIC XX.
  5096         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5097         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5098         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5099         16  EN-AH-NEW-EXP-DT        PIC XX.
  5100*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5101*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5102*        16  F                       PIC X(12).
  5103         16  EN-AH-NEW-CP            PIC 99.
  5104         16  EN-SIG-SW               PIC X.
  5105         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5106         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5107         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5108         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5109         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5110         16  FILLER                  PIC X(33).
  5111     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5112         16  EN-LF-ORIG-REF-DT       PIC XX.
  5113         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5114         16  EN-AH-ORIG-REF-DT       PIC XX.
  5115         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5116         16  EN-LF-NEW-REF-DT        PIC XX.
  5117         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5118         16  EN-AH-NEW-REF-DT        PIC XX.
  5119         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5120         16  EN-FLAG-CERT            PIC X.
  5121         16  EN-INS-LAST-NAME        PIC X(15).
  5122         16  EN-INS-FIRST-NAME       PIC X(10).
  5123         16  EN-INS-MIDDLE-INIT      PIC X.
  5124         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5125         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5126         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5127         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5128         16  FILLER                  PIC X(262).
  5129     12  EN-MONEY-SW             PIC X.
  5130     12  EN-HEALTH-APP           PIC X.
  5131     12  EN-VOUCHER-SW           PIC X.
  5132     12  EN-PAYEE                PIC X(14).
  5133     12  EN-INPUT-DT             PIC XX.
  5134     12  EN-PROCESS-DT           PIC XX.
  5135     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5136     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5137     12  EN-REASON-CODES.
  5138         16  F OCCURS 12.
  5139             20  EN-REASON-CODE  PIC X(4).
  5140     12  EN-TEMPLATE-USED        PIC X(8).
  5141     12  EN-DOCU-TYPE            PIC X.
  5142         88  EN-VERI-DOCU          VALUE 'V'.
  5143         88  EN-GCE-DOCU           VALUE 'G'.
  5144         88  EN-CANC-DOCU          VALUE 'C'.
  5145     12  EN-COMMENTS1            PIC X(13).
  5146     12  EN-COMMENTS2            PIC X(70).
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  91
* EL6316.cbl
  5147     12  EN-COMM-CHGBK           PIC X.
  5148         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5149         88  EN-CHG-ACCT           VALUE 'Y'.
  5150     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5151     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5152     12  EN-BATCH-NUMBER         PIC X(6).
  5153     12  EN-ACCT-SUMM            PIC X.
  5154     12  EN-CSO-SUMM             PIC X.
  5155     12  FILLER                  PIC X(13).
  5156******************************************************************
  5157*                                COPY ERCNOTE.
  5158******************************************************************
  5159*                                                                *
  5160*                                                                *
  5161*                            ERCNOTE                             *
  5162*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5163*                            VMOD=2.003                          *
  5164*                                                                *
  5165*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5166*                                                                *
  5167*        FILE TYPE= VSAM,KSDS                                    *
  5168*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5169*                                                                *
  5170*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  5171*                                                                *
  5172*        LOG = YES                                               *
  5173*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5174*                                                                *
  5175******************************************************************
  5176*                   C H A N G E   L O G
  5177*
  5178* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5179*-----------------------------------------------------------------
  5180*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5181* EFFECTIVE    NUMBER
  5182*-----------------------------------------------------------------
  5183* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5184*                                FILE WILL CONTAIN BILLING NOTES O
  5185******************************************************************
  5186
  5187 01  CERTIFICATE-NOTE.
  5188     12  CN-RECORD-ID                PIC  XX.
  5189         88  VALID-CN-ID                  VALUE 'CN'.
  5190
  5191     12  CN-CONTROL-PRIMARY.
  5192         16  CN-COMPANY-CD           PIC X.
  5193         16  CN-CARRIER              PIC X.
  5194         16  CN-GROUPING.
  5195             20 CN-GROUPING-PREFIX   PIC XXX.
  5196             20 CN-GROUPING-PRIME    PIC XXX.
  5197         16  CN-STATE                PIC XX.
  5198         16  CN-ACCOUNT.
  5199             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5200             20 CN-ACCOUNT-PRIME     PIC X(6).
  5201         16  CN-CERT-EFF-DT          PIC XX.
  5202         16  CN-CERT-NO.
  5203             20  CN-CERT-PRIME       PIC X(10).
  5204             20  CN-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  92
* EL6316.cbl
  5205
  5206     12  CN-BILLING-START-LINE-NO    PIC 99.
  5207     12  CN-BILLING-END-LINE-NO      PIC 99.
  5208
  5209     12  CN-LINES.
  5210         16  CN-LINE OCCURS 10       PIC X(77).
  5211
  5212     12  CN-LAST-MAINT-DT            PIC XX.
  5213     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5214     12  CN-LAST-MAINT-USER          PIC X(4).
  5215     12  FILLER                      PIC X(6).
  5216******************************************************************
  5217*                                COPY ERCMAIL.
  5218******************************************************************
  5219*                                                                *
  5220*                                                                *
  5221*                            ERCMAIL                             *
  5222*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5223*                            VMOD=2.003                          *
  5224*                                                                *
  5225*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5226*                                                                *
  5227*   FILE TYPE = VSAM,KSDS                                        *
  5228*   RECORD SIZE = 374   RECFORM = FIX                            *
  5229*                                                                *
  5230*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5231*   ALTERNATE PATH    = NOT USED                                 *
  5232*                                                                *
  5233*   LOG = YES                                                    *
  5234*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5235******************************************************************
  5236*                   C H A N G E   L O G
  5237*
  5238* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5239*-----------------------------------------------------------------
  5240*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5241* EFFECTIVE    NUMBER
  5242*-----------------------------------------------------------------
  5243* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5244* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5245* 111108                   PEMA  ADD CRED BENE ADDR2
  5246******************************************************************
  5247
  5248 01  MAILING-DATA.
  5249     12  MA-RECORD-ID                      PIC XX.
  5250         88  VALID-MA-ID                       VALUE 'MA'.
  5251
  5252     12  MA-CONTROL-PRIMARY.
  5253         16  MA-COMPANY-CD                 PIC X.
  5254         16  MA-CARRIER                    PIC X.
  5255         16  MA-GROUPING.
  5256             20  MA-GROUPING-PREFIX        PIC XXX.
  5257             20  MA-GROUPING-PRIME         PIC XXX.
  5258         16  MA-STATE                      PIC XX.
  5259         16  MA-ACCOUNT.
  5260             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5261             20  MA-ACCOUNT-PRIME          PIC X(6).
  5262         16  MA-CERT-EFF-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  93
* EL6316.cbl
  5263         16  MA-CERT-NO.
  5264             20  MA-CERT-PRIME             PIC X(10).
  5265             20  MA-CERT-SFX               PIC X.
  5266
  5267     12  FILLER                            PIC XX.
  5268
  5269     12  MA-ACCESS-CONTROL.
  5270         16  MA-SOURCE-SYSTEM              PIC XX.
  5271             88  MA-FROM-CREDIT                VALUE 'CR'.
  5272             88  MA-FROM-VSI                   VALUE 'VS'.
  5273             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5274             88  MA-FROM-OTHER                 VALUE 'OT'.
  5275         16  MA-RECORD-ADD-DT              PIC XX.
  5276         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5277         16  MA-LAST-MAINT-DT              PIC XX.
  5278         16  MA-LAST-MAINT-BY              PIC XXXX.
  5279         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5280
  5281     12  MA-PROFILE-INFO.
  5282         16  MA-QUALIFY-CODE-1             PIC XX.
  5283         16  MA-QUALIFY-CODE-2             PIC XX.
  5284         16  MA-QUALIFY-CODE-3             PIC XX.
  5285         16  MA-QUALIFY-CODE-4             PIC XX.
  5286         16  MA-QUALIFY-CODE-5             PIC XX.
  5287
  5288         16  MA-INSURED-LAST-NAME          PIC X(15).
  5289         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5290         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5291         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5292         16  MA-INSURED-BIRTH-DT           PIC XX.
  5293         16  MA-INSURED-SEX                PIC X.
  5294             88  MA-SEX-MALE                   VALUE 'M'.
  5295             88  MA-SEX-FEMALE                 VALUE 'F'.
  5296         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5297
  5298         16  MA-ADDRESS-CORRECTED          PIC X.
  5299         16  MA-JOINT-BIRTH-DT             PIC XX.
  5300*        16  FILLER                        PIC X(12).
  5301
  5302         16  MA-ADDRESS-LINE-1             PIC X(30).
  5303         16  MA-ADDRESS-LINE-2             PIC X(30).
  5304         16  MA-CITY-STATE.
  5305             20  MA-CITY                   PIC X(28).
  5306             20  MA-ADDR-STATE             PIC XX.
  5307         16  MA-ZIP.
  5308             20  MA-ZIP-CODE.
  5309                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5310                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5311                 24  FILLER                PIC X(4).
  5312             20  MA-ZIP-PLUS4              PIC X(4).
  5313         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5314             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5315             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5316             20  FILLER                    PIC X(3).
  5317
  5318         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5319
  5320         16  FILLER                        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  94
* EL6316.cbl
  5321*        16  FILLER                        PIC X(10).
  5322
  5323     12  MA-CRED-BENE-INFO.
  5324         16  MA-CRED-BENE-NAME                 PIC X(25).
  5325         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5326         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5327         16  MA-CRED-BENE-CTYST.
  5328             20  MA-CRED-BENE-CITY             PIC X(28).
  5329             20  MA-CRED-BENE-STATE            PIC XX.
  5330         16  MA-CRED-BENE-ZIP.
  5331             20  MA-CB-ZIP-CODE.
  5332                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5333                     88  MA-CB-CANADIAN-POST-CODE
  5334                                           VALUE 'A' THRU 'Z'.
  5335                 24  FILLER                    PIC X(4).
  5336             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5337         16  MA-CB-CANADIAN-POSTAL-CODE
  5338                            REDEFINES MA-CRED-BENE-ZIP.
  5339             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5340             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5341             20  FILLER                        PIC X(3).
  5342     12  MA-POST-CARD-MAIL-DATA.
  5343         16  MA-MAIL-DATA OCCURS 7.
  5344             20  MA-MAIL-TYPE              PIC X.
  5345                 88  MA-12MO-MAILING           VALUE '1'.
  5346                 88  MA-EXP-MAILING            VALUE '2'.
  5347             20  MA-MAIL-STATUS            PIC X.
  5348                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5349                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5350                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5351             20  MA-MAIL-DATE              PIC XX.
  5352     12  FILLER                            PIC XX.
  5353     12  FILLER                            PIC XX.
  5354*    12  FILLER                            PIC X(30).
  5355******************************************************************
  5356*                                COPY ERCCNOT.
  5357******************************************************************
  5358*                                                                *
  5359*                            ERCCNOT                             *
  5360*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5361*                            VMOD=2.003                          *
  5362*                                                                *
  5363*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5364*                                                                *
  5365*        FILE TYPE= VSAM,KSDS                                    *
  5366*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5367*                                                                *
  5368*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5369*                                                                *
  5370*        LOG = YES                                               *
  5371*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5372*                                                                *
  5373******************************************************************
  5374*                   C H A N G E   L O G
  5375*
  5376* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5377*-----------------------------------------------------------------
  5378*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  95
* EL6316.cbl
  5379* EFFECTIVE    NUMBER
  5380*-----------------------------------------------------------------
  5381* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5382******************************************************************
  5383
  5384 01  CERT-NOTE-FILE.
  5385     12  CZ-RECORD-ID                PIC  XX.
  5386         88  VALID-CZ-ID                  VALUE 'CZ'.
  5387
  5388     12  CZ-CONTROL-PRIMARY.
  5389         16  CZ-COMPANY-CD           PIC X.
  5390         16  CZ-CARRIER              PIC X.
  5391         16  CZ-GROUPING.
  5392             20 CZ-GROUPING-PREFIX   PIC XXX.
  5393             20 CZ-GROUPING-PRIME    PIC XXX.
  5394         16  CZ-STATE                PIC XX.
  5395         16  CZ-ACCOUNT.
  5396             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5397             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5398         16  CZ-CERT-EFF-DT          PIC XX.
  5399         16  CZ-CERT-NO.
  5400             20  CZ-CERT-PRIME       PIC X(10).
  5401             20  CZ-CERT-SFX         PIC X.
  5402         16  CZ-RECORD-TYPE          PIC X.
  5403             88  CERT-NOTE           VALUE '1'.
  5404             88  CLAIM-CERT-NOTE     VALUE '2'.
  5405         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5406
  5407     12  CZ-LAST-MAINT-DT            PIC XX.
  5408     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5409     12  CZ-LAST-MAINT-USER          PIC X(4).
  5410
  5411     12  CZ-NOTE-INFORMATION.
  5412         16  CZ-NOTE                 PIC X(63).
  5413         16  FILLER                  PIC X(39).
  5414******************************************************************
  5415*                                COPY ELCEOBC.
  5416******************************************************************
  5417*                                                                *
  5418*                                                                *
  5419*                            ELCEOBC                             *
  5420*                            VMOD=2.001                          *
  5421*                                                                *
  5422*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5423*                                                                *
  5424*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5425*   VSAM EOB CODE TABLE                                          *
  5426*                                                                *
  5427*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5428*                                                                *
  5429*   FILE TYPE = VSAM,KSDS                                        *
  5430*   RECORD SIZE = 350   RECFORM = FIX                            *
  5431*                                                                *
  5432*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5433*                                                                *
  5434*   LOG = NO                                                     *
  5435*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5436*                                                                *
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  96
* EL6316.cbl
  5437*                                                                *
  5438******************************************************************
  5439*                   C H A N G E   L O G
  5440*
  5441* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5442*-----------------------------------------------------------------
  5443*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5444* EFFECTIVE    NUMBER
  5445*-----------------------------------------------------------------
  5446* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5447* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5448* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5449******************************************************************
  5450 01  EOB-CODES.
  5451     12  EO-RECORD-ID                      PIC XX.
  5452         88  VALID-DN-ID                      VALUE 'EO'.
  5453     12  EO-CONTROL-PRIMARY.
  5454         16  EO-COMPANY-CD                 PIC X.
  5455         16  EO-RECORD-TYPE                PIC X.
  5456             88  EO-EOB-RECS                  VALUE '1'.
  5457             88  EO-VERIF-RECS                VALUE '2'.
  5458             88  EO-GCE-RECS                  VALUE '3'.
  5459             88  EO-CANC-RECS                 VALUE '4'.
  5460             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5461         16  EO-EOB-CODE                   PIC X(4).
  5462         16  FILLER                        PIC X(9).
  5463     12  EO-MAINT-INFORMATION.
  5464         16  EO-LAST-MAINT-DT              PIC XX.
  5465         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5466         16  EO-LAST-MAINT-USER            PIC X(4).
  5467         16  FILLER                        PIC XX.
  5468     12  EO-DESCRIPTION                    PIC X(275).
  5469     12  FILLER                            PIC X(46).
  5470******************************************************************
  5471*                                COPY ELCENCC.
  5472******************************************************************
  5473*                                                                *
  5474*                                                                *
  5475*                            ELCENCC                             *
  5476*                            VMOD=2.001                          *
  5477*                                                                *
  5478*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5479*                                                                *
  5480*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5481*   A NAPERSOFT DOCUMENT                                         *
  5482*                                                                *
  5483*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5484*                                                                *
  5485*   FILE TYPE = VSAM,KSDS                                        *
  5486*   RECORD SIZE = 400   RECFORM = FIX                            *
  5487*                                                                *
  5488*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5489*                                                                *
  5490*   LOG = NO                                                     *
  5491*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5492*                                                                *
  5493*                                                                *
  5494******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  97
* EL6316.cbl
  5495*                   C H A N G E   L O G
  5496*
  5497* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5498*-----------------------------------------------------------------
  5499*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5500* EFFECTIVE    NUMBER
  5501*-----------------------------------------------------------------
  5502* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5503******************************************************************
  5504 01  ENCLOSURE-CODES.
  5505     12  NC-RECORD-ID                      PIC XX.
  5506         88  VALID-NC-ID                      VALUE 'NC'.
  5507     12  NC-CONTROL-PRIMARY.
  5508         16  NC-COMPANY-CD                 PIC X.
  5509         16  NC-REC-TYPE                   PIC X.
  5510             88  NC-CLAIMS                   VALUE '1'.
  5511             88  NC-ADMIN                    VALUE '2'.
  5512         16  NC-ENC-CODE                   PIC X(5).
  5513         16  FILLER                        PIC X(09).
  5514     12  NC-MAINT-INFORMATION.
  5515         16  NC-LAST-MAINT-DT              PIC XX.
  5516         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5517         16  NC-LAST-MAINT-USER            PIC X(4).
  5518         16  FILLER                        PIC XX.
  5519     12  NC-OUTPUT-STACK                   PIC XXX.
  5520     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5521     12  NC-ATTACHMENTS                    PIC X(100).
  5522     12  NC-FUTURE                         PIC X(50).
  5523     12  FILLER                            PIC X(117).
  5524******************************************************************
  5525*                                COPY ELCCRTT.
  5526******************************************************************
  5527*                                                                *
  5528*                            ELCCRTT.                            *
  5529*                                                                *
  5530*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5531*                                                                *
  5532*   FILE TYPE = VSAM,KSDS                                        *
  5533*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5534*                                                                *
  5535*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5536*                                                                *
  5537*   LOG = YES                                                    *
  5538*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5539******************************************************************
  5540*                   C H A N G E   L O G
  5541*
  5542* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5543*-----------------------------------------------------------------
  5544*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5545* EFFECTIVE    NUMBER
  5546*-----------------------------------------------------------------
  5547* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5548* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5549* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5550* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5551* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5552******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  98
* EL6316.cbl
  5553
  5554 01  CERTIFICATE-TRAILERS.
  5555     12  CS-RECORD-ID                      PIC XX.
  5556         88  VALID-CS-ID                      VALUE 'CS'.
  5557
  5558     12  CS-CONTROL-PRIMARY.
  5559         16  CS-COMPANY-CD                 PIC X.
  5560         16  CS-CARRIER                    PIC X.
  5561         16  CS-GROUPING                   PIC X(6).
  5562         16  CS-STATE                      PIC XX.
  5563         16  CS-ACCOUNT                    PIC X(10).
  5564         16  CS-CERT-EFF-DT                PIC XX.
  5565         16  CS-CERT-NO.
  5566             20  CS-CERT-PRIME             PIC X(10).
  5567             20  CS-CERT-SFX               PIC X.
  5568         16  CS-TRAILER-TYPE               PIC X.
  5569             88  COMM-TRLR           VALUE 'A'.
  5570             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5571             88  CERT-DATA-TRLR      VALUE 'C'.
  5572
  5573     12  CS-DATA-AREA                      PIC X(516).
  5574
  5575     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5576         16  CS-BANK-COMMISSION-AREA.
  5577             20  CS-BANK-COMMS       OCCURS 10.
  5578                 24  CS-AGT                PIC X(10).
  5579                 24  CS-COM-TYP            PIC X.
  5580                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5581                 24  CS-RECALC-LV-INDIC    PIC X.
  5582                 24  FILLER                PIC X(10).
  5583         16  FILLER                        PIC X(256).
  5584
  5585     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5586****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5587****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  5588         16  CS-MB-CLAIM-DATA OCCURS 2.
  5589             20  FILLER OCCURS 10.
  5590                 24  CS-CLAIM-TYPE         PIC X.
  5591                     88  CS-AH-CLM           VALUE 'A'.
  5592                     88  CS-IU-CLM           VALUE 'I'.
  5593                     88  CS-GP-CLM           VALUE 'G'.
  5594                     88  CS-LF-CLM           VALUE 'L'.
  5595                     88  CS-PR-CLM           VALUE 'P'.
  5596                 24  CS-BANK               PIC S999 COMP-3.
  5597                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  5598                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  5599                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  5600         16  FILLER                        PIC X(216).
  5601     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5602         16  CS-VIN-NUMBER                 PIC X(17).
  5603         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5604         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5605         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5606         16  FILLER                        PIC X(496).
  5607******************************************************************
  5608 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5609                          ACCOUNT-MASTER CONTROL-FILE
  5610                          PENDING-BUSINESS CERTIFICATE-MASTER
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page  99
* EL6316.cbl
  5611                          ORIGINAL-CERTIFICATE
  5612                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5613                          MAILING-DATA CERT-NOTE-FILE EOB-CODES
  5614                          ENCLOSURE-CODES CERTIFICATE-TRAILERS.
  5615 0000-DFHEXIT SECTION.
  5616     MOVE '9#                    $   ' TO DFHEIV0.
  5617     MOVE 'EL6316' TO DFHEIV1.
  5618     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5619     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5620     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5621     MOVE '5'                    TO DC-OPTION-CODE
  5622     PERFORM 9700-DATE-LINK
  5623     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT
  5624     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT
  5625     MOVE EIBTRMID               TO QID-TERM
  5626     IF EIBCALEN = 0
  5627        GO TO 8800-UNAUTHORIZED-ACCESS
  5628     END-IF
  5629     DISPLAY ' ENDORSE LENGTH  '
  5630                FUNCTION LENGTH(ENDORSEMENT-RECORD)
  5631     move function length(EL631II) TO MAP-LENGTH
  5632     DISPLAY ' MAP LENGTH      ' MAP-LENGTH
  5633     IF PI-CALLING-PROGRAM = 'EL6314'
  5634         MOVE 'Y'                    TO PI-FROM-CERT
  5635         MOVE THIS-PGM               TO PI-CALLING-PROGRAM
  5636         MOVE LOW-VALUES             TO EL631II
  5637         MOVE 'Y'                    TO PI-CLEAR-ERROR-SW
  5638         GO TO 0350-DISPLAY-COMMON-DATA
  5639     END-IF
  5640
  5641     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5642        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5643           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5644           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5645           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5646           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5647           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5648           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5649           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5650           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5651           MOVE LOW-VALUES             TO EL631II
  5652           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5653           GO TO 0350-DISPLAY-COMMON-DATA
  5654        END-IF
  5655     END-IF
  5656     IF PI-CALLING-PROGRAM = 'EL614'
  5657        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5658                                 TO WS-PASSED-REASON-CODES
  5659        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5660        IF WS-PASSED-REASON-CODES NOT = SPACES
  5661           MOVE 'Y'                TO WS-SET-CODES-MDT
  5662        ELSE
  5663           MOVE 'N'                TO WS-SET-CODES-MDT
  5664        END-IF
  5665        PERFORM 0610-RECOVER-TEMP-STORAGE
  5666                                 THRU 0610-EXIT
  5667        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5668        GO TO 0350-DISPLAY-COMMON-DATA
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 100
* EL6316.cbl
  5669     END-IF
  5670     IF EIBAID = DFHCLEAR
  5671        IF PI-CLEAR-ERROR
  5672           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5673           MOVE ER-3833           TO EMI-ERROR
  5674           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5675           GO TO 0350-DISPLAY-COMMON-DATA
  5676        ELSE
  5677           GO TO 9400-CLEAR
  5678        END-IF
  5679     END-IF
  5680     .
  5681 0200-RECEIVE.
  5682     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5683        MOVE ER-0008             TO EMI-ERROR
  5684        PERFORM 9900-ERROR-FORMAT
  5685                                 THRU 9900-EXIT
  5686        MOVE -1                  TO PFENTRL
  5687        GO TO 8100-SEND-INITIAL-MAP
  5688     END-IF
  5689
  5690* EXEC CICS RECEIVE
  5691*        MAP      (MAP-NAME)
  5692*        MAPSET   (MAPSET-NAME)
  5693*        INTO     (EL631II)
  5694*    END-EXEC
  5695     MOVE LENGTH OF
  5696      EL631II
  5697       TO DFHEIV11
  5698*    MOVE '8"T I  L              ''   #00005685' TO DFHEIV0
  5699     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5700     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5701     MOVE X'2020233030303035363835' TO DFHEIV0(25:11)
  5702     CALL 'kxdfhei1' USING DFHEIV0,
  5703           MAP-NAME,
  5704           EL631II,
  5705           DFHEIV11,
  5706           MAPSET-NAME,
  5707           DFHEIV99,
  5708           DFHEIV99
  5709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5710     IF PFENTRL = 0
  5711         GO TO 0300-CHECK-PFKEYS
  5712     END-IF
  5713     IF EIBAID NOT = DFHENTER
  5714         MOVE ER-0004            TO EMI-ERROR
  5715         GO TO 0320-INPUT-ERROR
  5716     END-IF
  5717     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5718        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5719     ELSE
  5720        MOVE ER-0029            TO EMI-ERROR
  5721        GO TO 0320-INPUT-ERROR
  5722     END-IF
  5723     .
  5724 0300-CHECK-PFKEYS.
  5725     IF EIBAID = DFHPF1
  5726        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 101
* EL6316.cbl
  5727        PERFORM 0520-ERENDT-STARTBR
  5728                                 THRU 0520-EXIT
  5729        PERFORM 0510-ERENDT-READNEXT
  5730                                 THRU 0510-EXIT
  5731        IF ERENDT-KEY = PI-PREV-ERENDT-KEY
  5732            PERFORM 0510-ERENDT-READNEXT
  5733                                 THRU 0510-EXIT
  5734        END-IF
  5735        IF (RESP-NORMAL) AND
  5736         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5737           PERFORM 0390-BUILD-FROM-ERENDT
  5738                                 THRU 0390-EXIT
  5739           MOVE 'Y'              TO PI-ENDORSE-RECORD
  5740           MOVE ER-0000          TO EMI-ERROR
  5741           PERFORM 9900-ERROR-FORMAT
  5742                                 THRU 9900-EXIT
  5743           GO TO 8100-SEND-INITIAL-MAP
  5744        ELSE
  5745           MOVE ER-2237          TO EMI-ERROR
  5746           MOVE -1               TO CARRL
  5747           PERFORM 9900-ERROR-FORMAT
  5748                                 THRU 9900-EXIT
  5749           GO TO 8200-SEND-DATAONLY
  5750        END-IF
  5751     END-IF
  5752     IF EIBAID = DFHPF2
  5753        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5754        PERFORM 0520-ERENDT-STARTBR
  5755                                 THRU 0520-EXIT
  5756        PERFORM 0510-ERENDT-READNEXT
  5757                                 THRU 0510-EXIT
  5758        PERFORM 0530-ERENDT-READPREV
  5759                                 THRU 0530-EXIT
  5760        PERFORM 0530-ERENDT-READPREV
  5761                                 THRU 0530-EXIT
  5762        IF (RESP-NORMAL) AND
  5763         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5764           PERFORM 0390-BUILD-FROM-ERENDT
  5765                                 THRU 0390-EXIT
  5766           MOVE 'Y'              TO PI-ENDORSE-RECORD
  5767           MOVE ER-0000          TO EMI-ERROR
  5768           PERFORM 9900-ERROR-FORMAT
  5769                                 THRU 9900-EXIT
  5770           GO TO 8100-SEND-INITIAL-MAP
  5771        ELSE
  5772           MOVE 'N'              TO PI-ENDORSE-RECORD
  5773           MOVE LOW-VALUES       TO  EL631II
  5774           GO TO 0350-DISPLAY-COMMON-DATA
  5775           MOVE ER-2238          TO EMI-ERROR
  5776           PERFORM 9900-ERROR-FORMAT
  5777                                 THRU 9900-EXIT
  5778           MOVE -1               TO CARRL
  5779           GO TO 8200-SEND-DATAONLY
  5780        END-IF
  5781     END-IF
  5782
  5783     IF (EIBAID = DFHPF3 OR DFHPF4 OR DFHPF8) AND
  5784        PI-FROM-CERT = 'Y' AND
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 102
* EL6316.cbl
  5785        NOT PI-PROCESSOR-IS-CSR-SUPER
  5786           GO TO 0300-CONTINUE
  5787     END-IF
  5788
  5789     IF (EIBAID = DFHPF3 OR DFHPF4 OR DFHPF8) AND
  5790        PI-ENDORSE-RECORD = 'Y'
  5791           GO TO 0300-CONTINUE
  5792     END-IF
  5793     IF EIBAID = DFHPF3
  5794        IF PI-FROM-CERT = 'Y'
  5795         AND PI-PROCESSOR-IS-CSR-SUPER
  5796            MOVE PI-ELCRTO-KEY      TO ELCRTO-KEY
  5797            PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  5798            PERFORM 0785-CHG-CRTO-REC THRU 0785-EXIT
  5799        END-IF
  5800
  5801        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5802        PERFORM 0600-CREATE-TEMP-STORAGE
  5803                                 THRU 0600-EXIT
  5804        MOVE 'EL614'             TO PGM-NAME
  5805        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5806        MOVE +1                  TO S2
  5807        PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5808           IF REACD-IN (S1) NOT = SPACES AND LOW-VALUES
  5809              MOVE REACD-IN (S1) TO PI-PROGRAM-WORK-AREA (S2:4)
  5810              ADD +5 TO S2
  5811           END-IF
  5812        END-PERFORM
  5813        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5814        GO TO 9300-XCTL
  5815     END-IF
  5816     IF EIBAID = DFHPF4 OR DFHPF8
  5817        GO TO 1000-FINALIZE
  5818     END-IF
  5819
  5820      .
  5821 0300-CONTINUE.
  5822     IF EIBAID = DFHPF23
  5823        IF PI-CLEAR-ERROR
  5824           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5825           MOVE ER-3833           TO EMI-ERROR
  5826           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5827           GO TO 0350-DISPLAY-COMMON-DATA
  5828        ELSE
  5829           GO TO 8810-PF23
  5830        END-IF
  5831     END-IF
  5832     IF EIBAID = DFHPF24
  5833        IF PI-CLEAR-ERROR
  5834           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5835           MOVE ER-3833           TO EMI-ERROR
  5836           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5837           GO TO 0350-DISPLAY-COMMON-DATA
  5838        ELSE
  5839           GO TO 9200-RETURN-MAIN-MENU
  5840        END-IF
  5841     END-IF
  5842     IF EIBAID = DFHPF12
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 103
* EL6316.cbl
  5843        GO TO 9500-PF12
  5844     END-IF
  5845
  5846     IF EIBAID = DFHENTER
  5847      AND PI-FROM-CERT = 'Y'
  5848      AND PI-PROCESSOR-IS-CSR-SUPER
  5849      AND PI-ENDORSE-RECORD NOT EQUAL 'Y'
  5850         MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  5851         PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  5852         PERFORM 0785-CHG-CRTO-REC THRU 0785-EXIT
  5853         PERFORM 0755-READ-CERT THRU 0755-EXIT
  5854         PERFORM 0770-MOVE-CERT-TO-SCREEN THRU 0770-EXIT
  5855*         MOVE ER-0000          TO EMI-ERROR
  5856*         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5857*         GO TO 8100-SEND-INITIAL-MAP
  5858     END-IF
  5859     IF EIBAID = DFHENTER
  5860        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5861        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5862        IF EMI-NO-ERRORS
  5863           GO TO 0350-DISPLAY-COMMON-DATA
  5864        ELSE
  5865           GO TO 8200-SEND-DATAONLY
  5866        END-IF
  5867     END-IF
  5868     MOVE ER-0029                TO EMI-ERROR
  5869     .
  5870 0320-INPUT-ERROR.
  5871     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5872     MOVE AL-UNBON               TO PFENTRA
  5873     MOVE -1                     TO PFENTRL
  5874     GO TO 8200-SEND-DATAONLY
  5875     .
  5876 0325-EDIT-SCREEN.
  5877     IF PRTSWL > ZEROS
  5878        IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5879*          move prtswi to w-prtsw
  5880*          MOVE AL-UANON         TO PRTSWA
  5881*          IF PRTSWI = ' '
  5882              MOVE 'P'         TO PRTSWI
  5883*          END-IF
  5884*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5885        END-IF
  5886     END-IF
  5887     IF LTRIDL > ZEROS
  5888        AND LTRIDI > SPACES
  5889        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5890        MOVE LTRIDI              TO LETR-LETTER-ID
  5891                                    PI-LTRID-ENTERED
  5892        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5893        MOVE SPACES              TO LETR-FILLER
  5894        MOVE 0                   TO LETR-SEQ-NO
  5895        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5896     ELSE
  5897        MOVE ER-1236          TO EMI-ERROR
  5898        MOVE -1               TO LTRIDL
  5899        MOVE AL-UABON         TO LTRIDA
  5900        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 104
* EL6316.cbl
  5901                                 THRU 9900-EXIT
  5902     END-IF
  5903
  5904     IF W-PROMPT-LETTER EQUAL 'Y'
  5905         MOVE ER-0894            TO EMI-ERROR
  5906         MOVE -1                 TO LTRIDL
  5907         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5908     END-IF
  5909
  5910     IF ENCCODEL > ZEROS
  5911        MOVE FUNCTION UPPER-CASE(ENCCODEI) TO ENCCODEI
  5912                                              PI-ENCCODE
  5913        MOVE SPACES             TO WS-ELENCC-KEY
  5914        MOVE PI-COMPANY-CD      TO WS-ENCC-COMPANY-CD
  5915        MOVE '2'                TO WS-ENCC-REC-TYPE
  5916        MOVE ENCCODEI           TO WS-ENCC-ENC-CODE
  5917
  5918
  5919* EXEC CICS READ
  5920*           DATASET    (WS-ELENCC-FILE-ID)
  5921*           SET        (ADDRESS OF ENCLOSURE-CODES)
  5922*           RIDFLD     (WS-ELENCC-KEY)
  5923*           RESP       (WS-RESPONSE)
  5924*       END-EXEC
  5925*    MOVE '&"S        E          (  N#00005898' TO DFHEIV0
  5926     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5927     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5928     MOVE X'204E233030303035383938' TO DFHEIV0(25:11)
  5929     CALL 'kxdfhei1' USING DFHEIV0,
  5930           WS-ELENCC-FILE-ID,
  5931           DFHEIV20,
  5932           DFHEIV99,
  5933           WS-ELENCC-KEY,
  5934           DFHEIV99,
  5935           DFHEIV99,
  5936           DFHEIV99
  5937     SET ADDRESS OF ENCLOSURE-CODES TO
  5938         DFHEIV20
  5939     MOVE EIBRESP  TO WS-RESPONSE
  5940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5941
  5942        IF RESP-NORMAL
  5943           MOVE ENCCODEI         TO PI-ENCCODE
  5944                                    W-ENCLOSURE-CD
  5945           MOVE AL-UANON         TO ENCCODEA
  5946        ELSE
  5947           MOVE ER-1560          TO EMI-ERROR
  5948           MOVE -1               TO ENCCODEL
  5949           MOVE AL-UABON         TO ENCCODEA
  5950           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5951        END-IF
  5952     END-IF
  5953
  5954     SET REASONS-NOT-FOUND TO TRUE
  5955     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5956        IF REACDL (S1) = +4 OR
  5957          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  5958              MOVE AL-SANON     TO REACDA (S1)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 105
* EL6316.cbl
  5959              SET REASONS-FOUND TO TRUE
  5960        END-IF
  5961     END-PERFORM
  5962
  5963     IF REASONS-NOT-FOUND
  5964        MOVE ER-1820             TO EMI-ERROR
  5965        MOVE -1                  TO PFENTRL
  5966        PERFORM 9900-ERROR-FORMAT
  5967                                 THRU 9900-EXIT
  5968     ELSE
  5969        MOVE REASONCDS           TO PI-REASONS-ENTERED
  5970     END-IF
  5971
  5972     IF CRTNT1L > ZEROS
  5973        IF CRTNT1I > SPACES
  5974           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  5975        END-IF
  5976     END-IF
  5977
  5978     IF CRTNT2L > ZEROS
  5979        IF CRTNT2I > SPACES
  5980           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  5981        END-IF
  5982     END-IF
  5983
  5984     IF BILNT1L > ZEROS
  5985        IF BILNT1I > SPACES
  5986           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  5987        END-IF
  5988     END-IF
  5989
  5990     .
  5991 0325-EXIT.
  5992     EXIT.
  5993
  5994 0326-GET-Z-RECORD.
  5995
  5996     MOVE SPACES  TO W-Z-CONTROL-DATA
  5997
  5998
  5999* EXEC CICS STARTBR
  6000*         DATASET    ('ELLETR')
  6001*         RIDFLD     (ELLETR-KEY)
  6002*         GTEQ
  6003*         RESP      (WS-RESPONSE)
  6004*    END-EXEC.
  6005     MOVE 'ELLETR' TO DFHEIV1
  6006     MOVE 0
  6007       TO DFHEIV11
  6008*    MOVE '&,         G          &  N#00005961' TO DFHEIV0
  6009     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6010     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6011     MOVE X'204E233030303035393631' TO DFHEIV0(25:11)
  6012     CALL 'kxdfhei1' USING DFHEIV0,
  6013           DFHEIV1,
  6014           ELLETR-KEY,
  6015           DFHEIV99,
  6016           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 106
* EL6316.cbl
  6017           DFHEIV99
  6018     MOVE EIBRESP  TO WS-RESPONSE
  6019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6020
  6021     IF NOT RESP-NORMAL
  6022         MOVE ER-1236          TO EMI-ERROR
  6023         MOVE -1               TO LTRIDL
  6024         MOVE AL-UABON         TO LTRIDA
  6025         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6026         GO TO 0326-ENDBR
  6027     END-IF.
  6028
  6029 0326-READNEXT.
  6030
  6031
  6032* EXEC CICS READNEXT
  6033*        DATASET   ('ELLETR')
  6034*        INTO      (TEXT-FILES)
  6035*        RIDFLD    (ELLETR-KEY)
  6036*        RESP      (WS-RESPONSE)
  6037*    END-EXEC
  6038     MOVE LENGTH OF
  6039      TEXT-FILES
  6040       TO DFHEIV12
  6041     MOVE 'ELLETR' TO DFHEIV1
  6042     MOVE 0
  6043       TO DFHEIV11
  6044*    MOVE '&.IL                  )  N#00005977' TO DFHEIV0
  6045     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6046     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6047     MOVE X'204E233030303035393737' TO DFHEIV0(25:11)
  6048     CALL 'kxdfhei1' USING DFHEIV0,
  6049           DFHEIV1,
  6050           TEXT-FILES,
  6051           DFHEIV12,
  6052           ELLETR-KEY,
  6053           DFHEIV99,
  6054           DFHEIV11,
  6055           DFHEIV99,
  6056           DFHEIV99
  6057     MOVE EIBRESP  TO WS-RESPONSE
  6058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6059     IF RESP-NORMAL
  6060        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6061           MOVE ER-1236          TO EMI-ERROR
  6062           MOVE -1               TO LTRIDL
  6063           MOVE AL-UABON         TO LTRIDA
  6064           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6065           GO TO 0326-ENDBR
  6066        END-IF
  6067
  6068        MOVE AL-UANON         TO LTRIDA
  6069        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6070           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6071        ELSE
  6072           GO TO 0326-READNEXT
  6073        END-IF
  6074     ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 107
* EL6316.cbl
  6075        MOVE ER-1236          TO EMI-ERROR
  6076        MOVE -1               TO LTRIDL
  6077        MOVE AL-UABON         TO LTRIDA
  6078        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6079        GO TO 0326-ENDBR
  6080     END-IF.
  6081
  6082     IF PI-ENCCODE NOT GREATER THAN SPACES
  6083         MOVE W-ENCLOSURE-CD            TO PI-ENCCODE
  6084                                           ENCCODEO
  6085         MOVE AL-UANON                  TO ENCCODEA
  6086         MOVE +3                        TO ENCCODEL
  6087     END-IF.
  6088
  6089 0326-ENDBR.
  6090
  6091
  6092* EXEC CICS ENDBR
  6093*        DATASET     ('ELLETR')
  6094*    END-EXEC.
  6095     MOVE 'ELLETR' TO DFHEIV1
  6096     MOVE 0
  6097       TO DFHEIV11
  6098*    MOVE '&2                    $   #00006015' TO DFHEIV0
  6099     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6100     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6101     MOVE X'2020233030303036303135' TO DFHEIV0(25:11)
  6102     CALL 'kxdfhei1' USING DFHEIV0,
  6103           DFHEIV1,
  6104           DFHEIV11,
  6105           DFHEIV99
  6106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6107
  6108
  6109 0326-EXIT.
  6110      EXIT.
  6111 0350-DISPLAY-COMMON-DATA.
  6112     display ' made it to 0350 '
  6113
  6114     IF PI-FROM-CERT = 'Y'
  6115         PERFORM 0700-LOAD-FROM-CERT THRU 0700-EXIT
  6116     ELSE
  6117         PERFORM 0360-CHECK-PENDING THRU 0360-EXIT
  6118     END-IF
  6119     IF PI-LTRID-ENTERED > SPACES
  6120        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6121        MOVE AL-UANON            TO LTRIDA
  6122        MOVE +4                  TO LTRIDL
  6123     ELSE
  6124        IF PI-CLM-RESCISSION
  6125            MOVE 'CLRC'          TO LTRIDI
  6126                                    PI-LTRID-ENTERED
  6127            MOVE +4              TO LTRIDL
  6128            MOVE AL-UANON        TO LTRIDA
  6129        END-IF
  6130     END-IF
  6131
  6132     IF PI-ENCCODE > SPACES
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 108
* EL6316.cbl
  6133        MOVE PI-ENCCODE          TO ENCCODEI
  6134        MOVE AL-UANON            TO ENCCODEA
  6135        MOVE +3                  TO ENCCODEL
  6136     END-IF
  6137
  6138     SET REASONS-NOT-FOUND TO TRUE
  6139     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6140     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6141        IF REACDL (S1) = +4 OR
  6142          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6143              MOVE AL-SANON      TO REACDA (S1)
  6144              MOVE +4            TO REACDL (S1)
  6145              SET REASONS-FOUND  TO TRUE
  6146        END-IF
  6147     END-PERFORM
  6148
  6149     IF REASONS-NOT-FOUND
  6150         IF PI-CLM-RESCISSION
  6151            MOVE 'CRNA'          TO REACD-IN (1)
  6152            MOVE AL-SANON        TO REACDA (1)
  6153            MOVE +4              TO REACDL (1)
  6154            SET REASONS-FOUND    TO TRUE
  6155        END-IF
  6156     END-IF
  6157
  6158     IF PI-CERTNT1-ENTERED > SPACES
  6159        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6160        MOVE AL-UANON            TO CRTNT1A
  6161        MOVE +63                 TO CRTNT1L
  6162     END-IF
  6163
  6164     IF PI-CERTNT2-ENTERED > SPACES
  6165        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6166        MOVE AL-UANON            TO CRTNT2A
  6167        MOVE +63                 TO CRTNT2L
  6168     END-IF
  6169
  6170     IF PI-BILLNT1-ENTERED > SPACES
  6171        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6172        MOVE AL-UANON            TO BILNT1A
  6173        MOVE +63                 TO BILNT1L
  6174     END-IF
  6175     GO TO 8100-SEND-INITIAL-MAP
  6176     .
  6177 0350-EXIT.
  6178     EXIT.
  6179 0360-CHECK-PENDING.
  6180     display ' made it to 0360 '
  6181     MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  6182     MOVE PI-CARRIER             TO CRTO-CARRIER
  6183     MOVE PI-GROUPING            TO CRTO-GROUPING
  6184     MOVE PI-STATE               TO CRTO-STATE
  6185     MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  6186     MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  6187     MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  6188     MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  6189     MOVE 'I'                    TO CRTO-RECORD-TYPE
  6190     MOVE ZEROS                  TO CRTO-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 109
* EL6316.cbl
  6191     MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  6192     MOVE ELCRTO-KEY (1:33)      TO PI-ERENDT-KEY (1:33)
  6193     MOVE 'C'                    TO PI-ENDT-RECORD-TYPE
  6194     MOVE ZEROS                  TO PI-ENDT-SEQ-NO
  6195     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  6196     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6197      display 'response ' ws-response
  6198      display 'pi-elcrto-key ' pi-elcrto-key
  6199      display 'oc key ' oc-control-primary
  6200     IF RESP-NORMAL
  6201       IF (PI-ELCRTO-KEY (1:33) =
  6202              OC-CONTROL-PRIMARY (1:33))
  6203          DISPLAY 'CRTO RESP NORMAL '
  6204          MOVE OC-CONTROL-PRIMARY  TO PI-ELCRTO-KEY
  6205          PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  6206          PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  6207          IF RESP-NORMAL
  6208             MOVE PB-CONTROL-PRIMARY TO PI-ERPNDB-KEY
  6209             PERFORM 0380-BUILD-FROM-ERPNDB THRU 0380-EXIT
  6210          END-IF
  6211       ELSE
  6212          MOVE ER-3829           TO EMI-ERROR
  6213          PERFORM 9900-ERROR-FORMAT
  6214                                 THRU 9900-EXIT
  6215          MOVE -1                TO CARRL
  6216          GO TO 8100-SEND-INITIAL-MAP
  6217       END-IF
  6218     ELSE
  6219        MOVE ER-3829             TO EMI-ERROR
  6220        PERFORM 9900-ERROR-FORMAT
  6221                                 THRU 9900-EXIT
  6222        MOVE -1                  TO CARRL
  6223        GO TO 8100-SEND-INITIAL-MAP
  6224     END-IF
  6225     .
  6226 0360-EXIT.
  6227     EXIT.
  6228 0361-MOVE-CRTO-TO-SCREEN.
  6229     display ' made it to 0361 '
  6230     MOVE OC-LF-CANCEL-DT          TO DC-BIN-DATE-1
  6231     MOVE ' '                      TO DC-OPTION-CODE
  6232     PERFORM 9700-DATE-LINK
  6233     IF NO-CONVERSION-ERROR
  6234        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  6235     END-IF
  6236     MOVE OC-AH-CANCEL-DT          TO DC-BIN-DATE-1
  6237     MOVE ' '                      TO DC-OPTION-CODE
  6238     PERFORM 9700-DATE-LINK
  6239     IF NO-CONVERSION-ERROR
  6240        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  6241     END-IF
  6242     IF OC-LF-CANCEL-AMT NUMERIC
  6243        MOVE OC-LF-CANCEL-AMT      TO OLFAMTO
  6244     ELSE
  6245        MOVE ZEROS                 TO OLFAMTO
  6246     END-IF
  6247     IF OC-AH-CANCEL-AMT NUMERIC
  6248        MOVE OC-AH-CANCEL-AMT      TO OAHAMTO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 110
* EL6316.cbl
  6249     ELSE
  6250        MOVE ZEROS                 TO OAHAMTO
  6251     END-IF
  6252     .
  6253 0361-EXIT.
  6254     EXIT.
  6255 0362-READ-ELCRTO.
  6256     display ' made it to 0362 '
  6257
  6258* EXEC CICS READ
  6259*        DATASET   (WS-ELCRTO-FILE-ID)
  6260*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6261*        RIDFLD    (ELCRTO-KEY)
  6262*        GTEQ
  6263*        RESP      (WS-RESPONSE)
  6264*    END-EXEC
  6265*    MOVE '&"S        G          (  N#00006167' TO DFHEIV0
  6266     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6267     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6268     MOVE X'204E233030303036313637' TO DFHEIV0(25:11)
  6269     CALL 'kxdfhei1' USING DFHEIV0,
  6270           WS-ELCRTO-FILE-ID,
  6271           DFHEIV20,
  6272           DFHEIV99,
  6273           ELCRTO-KEY,
  6274           DFHEIV99,
  6275           DFHEIV99,
  6276           DFHEIV99
  6277     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6278         DFHEIV20
  6279     MOVE EIBRESP  TO WS-RESPONSE
  6280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6281     .
  6282 0362-EXIT.
  6283     EXIT.
  6284 0363-READ-ELCRTO-UPD.
  6285     display ' made it to 0363 '
  6286
  6287* EXEC CICS READ
  6288*        DATASET   (WS-ELCRTO-FILE-ID)
  6289*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6290*        RIDFLD    (ELCRTO-KEY)
  6291*        UPDATE
  6292*        RESP      (WS-RESPONSE)
  6293*    END-EXEC
  6294*    MOVE '&"S        EU         (  N#00006179' TO DFHEIV0
  6295     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6296     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6297     MOVE X'204E233030303036313739' TO DFHEIV0(25:11)
  6298     CALL 'kxdfhei1' USING DFHEIV0,
  6299           WS-ELCRTO-FILE-ID,
  6300           DFHEIV20,
  6301           DFHEIV99,
  6302           ELCRTO-KEY,
  6303           DFHEIV99,
  6304           DFHEIV99,
  6305           DFHEIV99
  6306     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 111
* EL6316.cbl
  6307         DFHEIV20
  6308     MOVE EIBRESP  TO WS-RESPONSE
  6309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6310     .
  6311 0363-EXIT.
  6312     EXIT.
  6313
  6314 0364-MOVE-ZERO-TO-SCREEN.
  6315
  6316     MOVE ZEROS    TO OLFDTO
  6317                      OAHDTO
  6318                      OLFAMTO
  6319                      OAHAMTO.
  6320
  6321 0364-EXIT.
  6322     EXIT.
  6323
  6324 0365-READ-ERENDT.
  6325
  6326* EXEC CICS READ
  6327*        DATASET   (WS-ERENDT-FILE-ID)
  6328*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6329*        RIDFLD    (ERENDT-KEY)
  6330*        RESP      (WS-RESPONSE)
  6331*    END-EXEC
  6332*    MOVE '&"S        E          (  N#00006201' TO DFHEIV0
  6333     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6334     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6335     MOVE X'204E233030303036323031' TO DFHEIV0(25:11)
  6336     CALL 'kxdfhei1' USING DFHEIV0,
  6337           WS-ERENDT-FILE-ID,
  6338           DFHEIV20,
  6339           DFHEIV99,
  6340           ERENDT-KEY,
  6341           DFHEIV99,
  6342           DFHEIV99,
  6343           DFHEIV99
  6344     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6345         DFHEIV20
  6346     MOVE EIBRESP  TO WS-RESPONSE
  6347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6348     .
  6349 0365-EXIT.
  6350     EXIT.
  6351 0370-READ-ERPNDB.
  6352     display ' made it to 0370 '
  6353     MOVE PI-COMPANY-CD          TO PNDB2-COMPANY-CD
  6354     MOVE PI-CRTO-CARRIER        TO PNDB2-CARRIER
  6355     MOVE PI-CRTO-GROUPING       TO PNDB2-GROUPING
  6356     MOVE PI-CRTO-STATE          TO PNDB2-STATE
  6357     MOVE PI-CRTO-ACCOUNT        TO PNDB2-ACCOUNT
  6358     MOVE PI-CRTO-CERT-PRIME     TO PNDB2-CERT-PRIME
  6359     MOVE PI-CRTO-CERT-SFX       TO PNDB2-CERT-SFX
  6360     MOVE PI-CRTO-CERT-EFF-DT    TO PNDB2-CERT-EFF-DT
  6361     MOVE +0                     TO PNDB2-CHG-SEQ-NO
  6362     MOVE '2'                    TO PNDB2-RECORD-TYPE
  6363
  6364* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 112
* EL6316.cbl
  6365*        DATASET   (WS-ERPNDB2-FILE-ID)
  6366*        SET       (ADDRESS OF PENDING-BUSINESS)
  6367*        RIDFLD    (ERPNDB2-KEY)
  6368*        RESP      (WS-RESPONSE)
  6369*    END-EXEC
  6370*    MOVE '&"S        E          (  N#00006222' TO DFHEIV0
  6371     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6372     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6373     MOVE X'204E233030303036323232' TO DFHEIV0(25:11)
  6374     CALL 'kxdfhei1' USING DFHEIV0,
  6375           WS-ERPNDB2-FILE-ID,
  6376           DFHEIV20,
  6377           DFHEIV99,
  6378           ERPNDB2-KEY,
  6379           DFHEIV99,
  6380           DFHEIV99,
  6381           DFHEIV99
  6382     SET ADDRESS OF PENDING-BUSINESS TO
  6383         DFHEIV20
  6384     MOVE EIBRESP  TO WS-RESPONSE
  6385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6386     .
  6387 0370-EXIT.
  6388     EXIT.
  6389 0380-BUILD-FROM-ERPNDB.
  6390     display ' made it to 0380 '
  6391     MOVE PB-CARRIER             TO CARRO
  6392     MOVE PB-GROUPING            TO GROUPO
  6393     MOVE PB-STATE               TO STATEO
  6394     MOVE PB-ACCOUNT             TO ACCTO
  6395     MOVE PB-CERT-PRIME          TO CERTNOO
  6396     MOVE PB-CERT-SFX            TO CRTSFXO
  6397     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  6398     MOVE ' '                    TO DC-OPTION-CODE
  6399     PERFORM 9700-DATE-LINK
  6400     IF NO-CONVERSION-ERROR
  6401        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6402     END-IF
  6403     MOVE PB-CI-LAST-NAME        TO LNAMEO
  6404     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6405     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6406     MOVE PB-C-LF-CANCEL-DT        TO DC-BIN-DATE-1
  6407     MOVE ' '                      TO DC-OPTION-CODE
  6408     PERFORM 9700-DATE-LINK
  6409     IF NO-CONVERSION-ERROR
  6410        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6411     END-IF
  6412     MOVE PB-C-AH-CANCEL-DT        TO DC-BIN-DATE-1
  6413     MOVE ' '                      TO DC-OPTION-CODE
  6414     PERFORM 9700-DATE-LINK
  6415     IF NO-CONVERSION-ERROR
  6416        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6417     END-IF
  6418     MOVE PB-C-LF-CANCEL-AMT       TO NLFAMTO
  6419     MOVE PB-C-AH-CANCEL-AMT       TO NAHAMTO
  6420     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6421        MOVE PB-CI-LIFE-COMMISSION
  6422                              TO LFCOMMO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 113
* EL6316.cbl
  6423*       MOVE AL-UNNON         TO LFCOMMA
  6424     END-IF
  6425     IF PB-CI-AH-COMMISSION NOT = ZEROS
  6426        MOVE PB-CI-AH-COMMISSION
  6427                              TO AHCOMMO
  6428*       MOVE AL-UNNON         TO AHCOMMA
  6429     END-IF
  6430     MOVE ER-2785                TO EMI-ERROR
  6431     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  6432     .
  6433 0380-EXIT.
  6434     EXIT.
  6435 0390-BUILD-FROM-ERENDT.
  6436     MOVE LOW-VALUES             TO EL631II
  6437*    move PI-PRTSW-ENTERED       to prtswo
  6438     IF PI-CERTNT1-ENTERED > SPACES
  6439        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6440        MOVE AL-UANON            TO CRTNT1A
  6441        MOVE +63                 TO CRTNT1L
  6442     END-IF
  6443
  6444     IF PI-CERTNT2-ENTERED > SPACES
  6445        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6446        MOVE AL-UANON            TO CRTNT2A
  6447        MOVE +63                 TO CRTNT2L
  6448     END-IF
  6449
  6450     IF PI-BILLNT1-ENTERED > SPACES
  6451        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6452        MOVE AL-UANON            TO BILNT1A
  6453        MOVE +63                 TO BILNT1L
  6454     END-IF
  6455
  6456     IF PI-ENCCODE > SPACES
  6457         MOVE PI-ENCCODE         TO ENCCODEO
  6458         MOVE AL-UANON           TO ENCCODEA
  6459         MOVE +3                 TO ENCCODEL
  6460     END-IF.
  6461
  6462     MOVE PI-COMPANY-CD          TO PI-ENDT-COMPANY-CD
  6463     MOVE EN-CARRIER             TO PI-ENDT-CARRIER
  6464     MOVE EN-GROUPING            TO PI-ENDT-GROUPING
  6465     MOVE EN-STATE               TO PI-ENDT-STATE
  6466     MOVE EN-ACCOUNT             TO PI-ENDT-ACCOUNT
  6467     MOVE EN-CERT-PRIME          TO PI-ENDT-CERT-PRIME
  6468     MOVE EN-CERT-SFX            TO PI-ENDT-CERT-SFX
  6469     MOVE EN-CERT-EFF-DT         TO PI-ENDT-CERT-EFF-DT
  6470     MOVE EN-REC-TYPE            TO PI-ENDT-RECORD-TYPE
  6471     MOVE EN-SEQ-NO              TO PI-ENDT-SEQ-NO
  6472     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  6473     MOVE EN-CARRIER             TO CARRO
  6474     MOVE EN-GROUPING            TO GROUPO
  6475     MOVE EN-STATE               TO STATEO
  6476     MOVE EN-ACCOUNT             TO ACCTO
  6477     MOVE EN-CERT-PRIME          TO CERTNOO
  6478     MOVE EN-CERT-SFX            TO CRTSFXO
  6479     MOVE EN-SEQ-NO              TO SEQNOO
  6480     MOVE EN-TEMPLATE-USED       TO LTRIDO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 114
* EL6316.cbl
  6481
  6482     IF PI-FROM-CERT = 'Y'
  6483         PERFORM 0755-READ-CERT THRU 0755-EXIT
  6484         MOVE CM-INSURED-LAST-NAME TO LNAMEO
  6485         MOVE CM-INSURED-FIRST-NAME TO FNAMEO
  6486         MOVE CM-INSURED-INITIAL2  TO MINITO
  6487         IF CM-LIFE-COMM-PCT NOT = ZEROS
  6488             MOVE CM-LIFE-COMM-PCT TO LFCOMMO
  6489         END-IF
  6490         IF CM-AH-COMM-PCT NOT = ZEROS
  6491             MOVE CM-AH-COMM-PCT   TO AHCOMMO
  6492         END-IF
  6493     ELSE
  6494        PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  6495        MOVE PB-CI-LAST-NAME        TO LNAMEO
  6496        MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6497        MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6498        IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6499           MOVE PB-CI-LIFE-COMMISSION TO LFCOMMO
  6500        END-IF
  6501        IF PB-CI-AH-COMMISSION NOT = ZEROS
  6502           MOVE PB-CI-AH-COMMISSION TO AHCOMMO
  6503        END-IF
  6504     END-IF
  6505     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6506        IF EN-REASON-CODE (S1) NOT = SPACES
  6507           MOVE EN-REASON-CODE (S1) TO REACD-IN (S1)
  6508           MOVE AL-SANON         TO REACDA (S1)
  6509           MOVE +4               TO REACDL (S1)
  6510        END-IF
  6511     END-PERFORM
  6512     MOVE EN-CERT-EFF-DT         TO DC-BIN-DATE-1
  6513     MOVE ' '                    TO DC-OPTION-CODE
  6514     PERFORM 9700-DATE-LINK
  6515     IF NO-CONVERSION-ERROR
  6516        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6517     END-IF
  6518     IF EN-PROCESS-DT NOT = SPACES AND LOW-VALUES
  6519        MOVE EN-PROCESS-DT       TO DC-BIN-DATE-1
  6520        MOVE ' '                 TO DC-OPTION-CODE
  6521        PERFORM 9700-DATE-LINK
  6522        IF NO-CONVERSION-ERROR
  6523           MOVE DC-GREG-DATE-1-EDIT
  6524                                 TO PROCDTO
  6525        END-IF
  6526     END-IF
  6527     IF EN-INPUT-DT NOT = SPACES AND LOW-VALUES
  6528        MOVE EN-INPUT-DT         TO DC-BIN-DATE-1
  6529        MOVE ' '                 TO DC-OPTION-CODE
  6530        PERFORM 9700-DATE-LINK
  6531        IF NO-CONVERSION-ERROR
  6532           MOVE DC-GREG-DATE-1-EDIT
  6533                                 TO INPDTO
  6534        END-IF
  6535     END-IF
  6536     MOVE EN-LF-ORIG-REF-DT        TO DC-BIN-DATE-1
  6537     MOVE ' '                      TO DC-OPTION-CODE
  6538     PERFORM 9700-DATE-LINK
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 115
* EL6316.cbl
  6539     IF NO-CONVERSION-ERROR
  6540        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  6541     END-IF
  6542     MOVE EN-LF-ORIG-REF-AMT       TO OLFAMTO
  6543     MOVE EN-AH-ORIG-REF-DT        TO DC-BIN-DATE-1
  6544     MOVE ' '                      TO DC-OPTION-CODE
  6545     PERFORM 9700-DATE-LINK
  6546     IF NO-CONVERSION-ERROR
  6547        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  6548     END-IF
  6549     MOVE EN-AH-ORIG-REF-AMT       TO OAHAMTO
  6550     MOVE EN-LF-NEW-REF-DT         TO DC-BIN-DATE-1
  6551     MOVE ' '                      TO DC-OPTION-CODE
  6552     PERFORM 9700-DATE-LINK
  6553     IF NO-CONVERSION-ERROR
  6554        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6555     END-IF
  6556     MOVE EN-LF-NEW-REF-AMT        TO NLFAMTO
  6557     MOVE EN-AH-NEW-REF-DT         TO DC-BIN-DATE-1
  6558     MOVE ' '                      TO DC-OPTION-CODE
  6559     PERFORM 9700-DATE-LINK
  6560     IF NO-CONVERSION-ERROR
  6561        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6562     END-IF
  6563     MOVE EN-AH-NEW-REF-AMT        TO NAHAMTO
  6564     MOVE EN-ARCHIVE-NO            TO ARCHNOO
  6565     .
  6566 0390-EXIT.
  6567     EXIT.
  6568 0400-ADD-ERENDT.
  6569     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6570
  6571* EXEC CICS GETMAIN
  6572*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6573*         LENGTH   (ERENDT-LENGTH)
  6574*         INITIMG  (GETMAIN-SPACE)
  6575*    END-EXEC
  6576*    MOVE ',"IL                  $   #00006412' TO DFHEIV0
  6577     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6578     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6579     MOVE X'2020233030303036343132' TO DFHEIV0(25:11)
  6580     CALL 'kxdfhei1' USING DFHEIV0,
  6581           DFHEIV20,
  6582           ERENDT-LENGTH,
  6583           GETMAIN-SPACE
  6584     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6585         DFHEIV20
  6586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6587     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6588     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6589     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6590     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6591                                    EN-INPUT-DT
  6592     MOVE OC-LF-CANCEL-DT        TO EN-LF-ORIG-REF-DT
  6593     MOVE OC-AH-CANCEL-DT        TO EN-AH-ORIG-REF-DT
  6594     MOVE OC-LF-CANCEL-AMT       TO EN-LF-ORIG-REF-AMT
  6595     MOVE OC-AH-CANCEL-AMT       TO EN-AH-ORIG-REF-AMT
  6596
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 116
* EL6316.cbl
  6597     MOVE OC-LF-ITD-CANCEL-AMT   TO NEW-LF-ITD-CANCEL-AMT
  6598     MOVE OC-AH-ITD-CANCEL-AMT   TO NEW-AH-ITD-CANCEL-AMT
  6599
  6600     MOVE OC-INS-LAST-NAME       TO EN-INS-LAST-NAME
  6601     MOVE OC-INS-FIRST-NAME      TO EN-INS-FIRST-NAME
  6602     MOVE OC-INS-MIDDLE-INIT     TO EN-INS-MIDDLE-INIT
  6603
  6604     MOVE OC-LF-COMM-PCT         TO EN-LF-ORIG-REF-COMM-PCT
  6605     MOVE OC-AH-COMM-PCT         TO EN-AH-ORIG-REF-COMM-PCT
  6606
  6607     IF PI-FROM-CERT = 'Y'
  6608         DISPLAY 'USING CERT FOR NEW'
  6609
  6610         MOVE PI-COMPANY-CD       TO  W-CERT-COMPANY-CD
  6611         MOVE PI-CRTO-CARRIER     TO  W-CERT-CARRIER
  6612         MOVE PI-CRTO-GROUPING    TO  W-CERT-GROUPING
  6613         MOVE PI-CRTO-STATE       TO  W-CERT-STATE
  6614         MOVE PI-CRTO-ACCOUNT     TO  W-CERT-ACCOUNT
  6615         MOVE PI-CRTO-CERT-EFF-DT TO  W-CERT-CERT-EFF-DT
  6616         MOVE PI-CRTO-CERT-PRIME  TO  W-CERT-CERT-PRIME
  6617         MOVE PI-CRTO-CERT-SFX    TO  W-CERT-CERT-SFX
  6618
  6619
  6620* EXEC CICS READ
  6621*            DATASET  (WS-ELCERT-FILE-ID)
  6622*            RIDFLD   (WS-ELCERT-KEY)
  6623*            SET      (ADDRESS OF CERTIFICATE-MASTER)
  6624*            RESP     (WS-RESPONSE)
  6625*        END-EXEC
  6626*    MOVE '&"S        E          (  N#00006449' TO DFHEIV0
  6627     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6628     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6629     MOVE X'204E233030303036343439' TO DFHEIV0(25:11)
  6630     CALL 'kxdfhei1' USING DFHEIV0,
  6631           WS-ELCERT-FILE-ID,
  6632           DFHEIV20,
  6633           DFHEIV99,
  6634           WS-ELCERT-KEY,
  6635           DFHEIV99,
  6636           DFHEIV99,
  6637           DFHEIV99
  6638     SET ADDRESS OF CERTIFICATE-MASTER TO
  6639         DFHEIV20
  6640     MOVE EIBRESP  TO WS-RESPONSE
  6641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6642         IF NOT RESP-NORMAL
  6643            GO TO 0400-EXIT
  6644         END-IF
  6645
  6646         MOVE CM-LF-CANCEL-DT    TO EN-LF-NEW-REF-DT
  6647                                    NEW-LF-CANCEL-DT
  6648         MOVE CM-AH-CANCEL-DT    TO EN-AH-NEW-REF-DT
  6649                                    NEW-AH-CANCEL-DT
  6650
  6651         MOVE CM-LF-ITD-CANCEL-AMT TO EN-LF-NEW-REF-AMT
  6652                                      NEW-LF-CANCEL-AMT
  6653         MOVE CM-AH-ITD-CANCEL-AMT TO EN-AH-NEW-REF-AMT
  6654                                      NEW-AH-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 117
* EL6316.cbl
  6655
  6656         MOVE CM-LIFE-COMM-PCT   TO EN-LF-NEW-COMM-PCT
  6657                                    EN-LF-NEW-REF-COMM-PCT
  6658                                    NEW-LF-COMM-PCT
  6659
  6660         MOVE CM-AH-COMM-PCT     TO EN-AH-NEW-COMM-PCT
  6661                                    EN-AH-NEW-REF-COMM-PCT
  6662                                    NEW-AH-COMM-PCT
  6663
  6664
  6665         GO TO 0400-CONTINUE
  6666     END-IF.
  6667
  6668
  6669* EXEC CICS READ
  6670*        DATASET   (WS-ERPNDB-FILE-ID)
  6671*        SET       (ADDRESS OF PENDING-BUSINESS)
  6672*        RIDFLD    (PI-ERPNDB-KEY)
  6673*        RESP      (WS-RESPONSE)
  6674*    END-EXEC
  6675*    MOVE '&"S        E          (  N#00006481' TO DFHEIV0
  6676     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6677     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6678     MOVE X'204E233030303036343831' TO DFHEIV0(25:11)
  6679     CALL 'kxdfhei1' USING DFHEIV0,
  6680           WS-ERPNDB-FILE-ID,
  6681           DFHEIV20,
  6682           DFHEIV99,
  6683           PI-ERPNDB-KEY,
  6684           DFHEIV99,
  6685           DFHEIV99,
  6686           DFHEIV99
  6687     SET ADDRESS OF PENDING-BUSINESS TO
  6688         DFHEIV20
  6689     MOVE EIBRESP  TO WS-RESPONSE
  6690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6691     IF NOT RESP-NORMAL
  6692        GO TO 0400-EXIT
  6693     END-IF
  6694     MOVE PB-C-LF-CANCEL-DT      TO EN-LF-NEW-REF-DT
  6695                                    NEW-LF-CANCEL-DT
  6696     MOVE PB-C-AH-CANCEL-DT      TO EN-AH-NEW-REF-DT
  6697                                    NEW-AH-CANCEL-DT
  6698     MOVE PB-C-LF-CANCEL-AMT     TO EN-LF-NEW-REF-AMT
  6699                                    NEW-LF-CANCEL-AMT
  6700     MOVE PB-C-AH-CANCEL-AMT     TO EN-AH-NEW-REF-AMT
  6701                                    NEW-AH-CANCEL-AMT
  6702     MOVE PB-CI-LIFE-COMMISSION  TO EN-LF-COMMISSION
  6703                                    EN-LF-NEW-REF-COMM-PCT
  6704                                    NEW-LF-COMM-PCT
  6705     MOVE PB-CI-AH-COMMISSION    TO EN-AH-COMMISSION
  6706                                    EN-AH-NEW-REF-COMM-PCT
  6707                                    NEW-AH-COMM-PCT.
  6708     MOVE PB-ENTRY-BATCH         TO EN-BATCH-NUMBER.
  6709
  6710 0400-CONTINUE.
  6711
  6712     MOVE LTRIDI                 TO EN-TEMPLATE-USED
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 118
* EL6316.cbl
  6713     MOVE 'C'                    TO EN-DOCU-TYPE
  6714     MOVE 'Y'                    TO EN-MONEY-SW
  6715     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6716     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6717     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6718        IF REACD-IN (S1) NOT = LOW-VALUES
  6719           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6720        END-IF
  6721     END-PERFORM
  6722     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6723
  6724     IF ACCT-FOUND
  6725        IF PI-FROM-CERT = 'Y'
  6726            MOVE CM-CERT-EFF-DT  TO DC-BIN-DATE-1
  6727            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-2
  6728            IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  6729                MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  6730            END-IF
  6731        ELSE
  6732            MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  6733            MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
  6734            IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  6735               MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-2
  6736            END-IF
  6737        END-IF
  6738        MOVE '1'                 TO DC-OPTION-CODE
  6739        PERFORM 9700-DATE-LINK
  6740        IF NO-CONVERSION-ERROR
  6741           MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  6742           IF DC-ODD-DAYS-OVER > +1
  6743              ADD +1          TO WS-DIFF
  6744           END-IF
  6745        ELSE
  6746            MOVE +0           TO WS-DIFF
  6747        END-IF
  6748     ELSE
  6749        MOVE +0           TO WS-DIFF
  6750     END-IF
  6751
  6752     COMPUTE WS-DUE-BORROWER = (EN-LF-NEW-REF-AMT
  6753         + EN-AH-NEW-REF-AMT)
  6754
  6755     IF (WS-CHGBACK = 99)
  6756         OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  6757          MOVE WS-DUE-BORROWER TO EN-CSO-PORTION
  6758          MOVE ZEROS           TO EN-ACCT-PORTION
  6759          MOVE 'N'             TO EN-COMM-CHGBK
  6760     ELSE
  6761         COMPUTE EN-ACCT-PORTION = (EN-LF-NEW-REF-AMT
  6762                 * EN-LF-COMMISSION) +
  6763                (EN-AH-NEW-REF-AMT * EN-AH-COMMISSION)
  6764         COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER
  6765                 - EN-ACCT-PORTION
  6766         MOVE 'Y'                TO EN-COMM-CHGBK
  6767     END-IF
  6768     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6769     .
  6770 0400-EXIT.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 119
* EL6316.cbl
  6771     EXIT.
  6772 0410-INIT-ERENDT.
  6773     MOVE OC-CONTROL-PRIMARY (1:33) TO ERENDT-KEY (1:33)
  6774     MOVE 'C'                    TO ENDT-RECORD-TYPE
  6775     MOVE ZEROS                  TO ENDT-SEQ-NO
  6776
  6777* EXEC CICS READ
  6778*        DATASET    (WS-ERENDT-FILE-ID)
  6779*        RIDFLD     (ERENDT-KEY)
  6780*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  6781*        RESP       (WS-RESPONSE)
  6782*        GTEQ
  6783*    END-EXEC
  6784*    MOVE '&"S        G          (  N#00006572' TO DFHEIV0
  6785     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6787     MOVE X'204E233030303036353732' TO DFHEIV0(25:11)
  6788     CALL 'kxdfhei1' USING DFHEIV0,
  6789           WS-ERENDT-FILE-ID,
  6790           DFHEIV20,
  6791           DFHEIV99,
  6792           ERENDT-KEY,
  6793           DFHEIV99,
  6794           DFHEIV99,
  6795           DFHEIV99
  6796     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6797         DFHEIV20
  6798     MOVE EIBRESP  TO WS-RESPONSE
  6799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6800     IF RESP-NORMAL
  6801        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
  6802        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6803     ELSE
  6804        MOVE +4096               TO WS-SEQ-NO
  6805     END-IF
  6806     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6807     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6808     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6809     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6810     MOVE WS-CURRENT-BIN-DT      TO EN-PROCESS-DT
  6811     MOVE 'C'                    TO EN-REC-TYPE
  6812     INITIALIZE EN-CANCEL-RECORD
  6813     MOVE ZEROS TO EN-CSO-PORTION EN-ACCT-PORTION
  6814     MOVE LOW-VALUES             TO EN-LF-ORIG-REF-DT
  6815                                    EN-AH-ORIG-REF-DT
  6816                                    EN-LF-NEW-REF-DT
  6817                                    EN-AH-NEW-REF-DT
  6818     .
  6819 0410-EXIT.
  6820     EXIT.
  6821 0420-UPDATE-ELCRTO.
  6822     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6823     IF RESP-NORMAL
  6824        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6825                                    OC-LAST-MAINT-DT
  6826        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6827        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6828
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 120
* EL6316.cbl
  6829* EXEC CICS REWRITE
  6830*          FROM     (ORIGINAL-CERTIFICATE)
  6831*          DATASET  ('ELCRTO')
  6832*       END-EXEC
  6833     MOVE LENGTH OF
  6834      ORIGINAL-CERTIFICATE
  6835       TO DFHEIV11
  6836     MOVE 'ELCRTO' TO DFHEIV1
  6837*    MOVE '&& L                  %   #00006607' TO DFHEIV0
  6838     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6839     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6840     MOVE X'2020233030303036363037' TO DFHEIV0(25:11)
  6841     CALL 'kxdfhei1' USING DFHEIV0,
  6842           DFHEIV1,
  6843           ORIGINAL-CERTIFICATE,
  6844           DFHEIV11,
  6845           DFHEIV99
  6846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6847     END-IF
  6848     .
  6849 0420-EXIT.
  6850     EXIT.
  6851
  6852 0425-ADD-NEW-ELCRTO.
  6853     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6854     MOVE 'OC'                   TO OC-RECORD-ID
  6855     MOVE PI-ELCRTO-KEY          TO OC-CONTROL-PRIMARY
  6856     SUBTRACT +1                 FROM OC-KEY-SEQ-NO
  6857     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6858     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6859     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6860     MOVE NEW-INS-FIRST-NAME     TO OC-INS-FIRST-NAME
  6861     MOVE NEW-INS-MIDDLE-INIT    TO OC-INS-MIDDLE-INIT
  6862     MOVE NEW-INS-LAST-NAME      TO OC-INS-LAST-NAME
  6863     MOVE NEW-INS-AGE            TO OC-INS-AGE
  6864     MOVE NEW-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6865     MOVE NEW-JNT-FIRST-NAME     TO OC-JNT-FIRST-NAME
  6866     MOVE NEW-JNT-MIDDLE-INIT    TO OC-JNT-MIDDLE-INIT
  6867     MOVE NEW-JNT-LAST-NAME      TO OC-JNT-LAST-NAME
  6868     MOVE NEW-JNT-AGE            TO OC-JNT-AGE
  6869     MOVE NEW-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6870     MOVE NEW-LF-BENCD           TO OC-LF-BENCD
  6871     MOVE NEW-LF-BEN-AMT         TO OC-LF-BEN-AMT
  6872     MOVE NEW-LF-PRM-AMT         TO OC-LF-PRM-AMT
  6873     MOVE NEW-LF-ALT-BEN-AMT     TO OC-LF-ALT-BEN-AMT
  6874     MOVE NEW-LF-ALT-PRM-AMT     TO OC-LF-ALT-PRM-AMT
  6875     MOVE NEW-LF-TERM            TO OC-LF-TERM
  6876     MOVE NEW-LF-EXP-DT          TO OC-LF-EXP-DT
  6877     MOVE NEW-LF-COMM-PCT        TO OC-LF-COMM-PCT
  6878     MOVE NEW-LF-CANCEL-DT       TO OC-LF-CANCEL-DT
  6879     MOVE NEW-LF-CANCEL-AMT      TO OC-LF-CANCEL-AMT
  6880     MOVE NEW-AH-BENCD           TO OC-AH-BENCD
  6881     MOVE NEW-AH-BEN-AMT         TO OC-AH-BEN-AMT
  6882     MOVE NEW-AH-PRM-AMT         TO OC-AH-PRM-AMT
  6883     MOVE NEW-AH-TERM            TO OC-AH-TERM
  6884     MOVE NEW-AH-EXP-DT          TO OC-AH-EXP-DT
  6885     MOVE NEW-AH-CP              TO OC-AH-CP
  6886     MOVE NEW-AH-COMM-PCT        TO OC-AH-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 121
* EL6316.cbl
  6887     MOVE NEW-AH-CANCEL-DT       TO OC-AH-CANCEL-DT
  6888     MOVE NEW-AH-CANCEL-AMT      TO OC-AH-CANCEL-AMT
  6889     MOVE NEW-CRED-BENE-NAME     TO OC-CRED-BENE-NAME
  6890     MOVE NEW-1ST-PMT-DT         TO OC-1ST-PMT-DT
  6891     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
  6892     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  6893     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6894     .
  6895 0425-WRITE-ELCRTO.
  6896
  6897
  6898* EXEC CICS WRITE
  6899*       DATASET   ('ELCRTO')
  6900*       FROM      (ORIGINAL-CERTIFICATE)
  6901*       RIDFLD    (OC-CONTROL-PRIMARY)
  6902*       RESP      (WS-RESPONSE)
  6903*    END-EXEC
  6904     MOVE LENGTH OF
  6905      ORIGINAL-CERTIFICATE
  6906       TO DFHEIV11
  6907     MOVE 'ELCRTO' TO DFHEIV1
  6908*    MOVE '&$ L                  ''  N#00006661' TO DFHEIV0
  6909     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6910     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6911     MOVE X'204E233030303036363631' TO DFHEIV0(25:11)
  6912     CALL 'kxdfhei1' USING DFHEIV0,
  6913           DFHEIV1,
  6914           ORIGINAL-CERTIFICATE,
  6915           DFHEIV11,
  6916           OC-CONTROL-PRIMARY,
  6917           DFHEIV99,
  6918           DFHEIV99
  6919     MOVE EIBRESP  TO WS-RESPONSE
  6920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6921
  6922     display ' just wrote new crto ' ws-response
  6923     IF RESP-DUPKEY
  6924        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6925        GO TO 0425-WRITE-ELCRTO
  6926     ELSE
  6927        IF NOT RESP-NORMAL
  6928           MOVE -1               TO LTRIDL
  6929           MOVE ER-3830          TO EMI-ERROR
  6930           PERFORM 9900-ERROR-FORMAT
  6931                                 THRU 9900-EXIT
  6932        ELSE
  6933           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6934        END-IF
  6935     END-IF
  6936
  6937     .
  6938 0425-EXIT.
  6939     EXIT.
  6940
  6941 0426-ADD-CERT-NOTES.
  6942
  6943     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6944     SET TB-INDX TO 1
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 122
* EL6316.cbl
  6945
  6946     IF PI-CERTNT1-ENTERED > SPACES
  6947         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6948         MOVE PI-PROCESSOR-ID    TO
  6949                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6950         MOVE EIBTIME            TO
  6951                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6952         MOVE WS-CURRENT-BIN-DT  TO
  6953                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6954         SET TB-INDX UP BY +1
  6955     END-IF
  6956
  6957     IF PI-CERTNT2-ENTERED > SPACES
  6958         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6959         MOVE PI-PROCESSOR-ID    TO
  6960                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6961         MOVE EIBTIME            TO
  6962                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6963         MOVE WS-CURRENT-BIN-DT  TO
  6964                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6965         SET TB-INDX UP BY +1
  6966     END-IF
  6967
  6968     IF CERT-NOTE-ENTRIES > SPACES
  6969         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6970         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6971     END-IF
  6972
  6973     IF PI-BILLNT1-ENTERED > SPACES
  6974         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6975         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6976         MOVE +63 TO WS-LEN
  6977         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  6978     END-IF
  6979
  6980     .
  6981 0426-EXIT.
  6982     EXIT.
  6983
  6984 0427-LOAD-CURRENT-CERT-NOTES.
  6985
  6986     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  6987     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  6988     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  6989     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  6990     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  6991     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  6992     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  6993     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  6994     MOVE '1'                 TO ERCNOT-REC-TYP
  6995     MOVE +0                  TO ERCNOT-SEQ
  6996     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  6997
  6998
  6999* EXEC CICS STARTBR
  7000*         DATASET(WS-ERCNOT-FILE-ID)
  7001*         RIDFLD(ERCNOT-KEY)
  7002*         KEYLENGTH(ERCNOT-START-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 123
* EL6316.cbl
  7003*         RESP      (WS-RESPONSE)
  7004*         GENERIC
  7005*         GTEQ
  7006*    END-EXEC.
  7007     MOVE 0
  7008       TO DFHEIV11
  7009*    MOVE '&,   KG    G          &  N#00006744' TO DFHEIV0
  7010     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  7011     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7012     MOVE X'204E233030303036373434' TO DFHEIV0(25:11)
  7013     CALL 'kxdfhei1' USING DFHEIV0,
  7014           WS-ERCNOT-FILE-ID,
  7015           ERCNOT-KEY,
  7016           ERCNOT-START-LENGTH,
  7017           DFHEIV11,
  7018           DFHEIV99
  7019     MOVE EIBRESP  TO WS-RESPONSE
  7020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7021
  7022
  7023     IF NOT RESP-NORMAL
  7024        GO TO 0427-ENDBR
  7025     END-IF.
  7026
  7027 0427-LOOP.
  7028
  7029* EXEC CICS READNEXT
  7030*         SET(ADDRESS OF CERT-NOTE-FILE)
  7031*         DATASET(WS-ERCNOT-FILE-ID)
  7032*         RIDFLD(ERCNOT-KEY)
  7033*    END-EXEC.
  7034     MOVE 0
  7035       TO DFHEIV11
  7036*    MOVE '&.S                   )   #00006758' TO DFHEIV0
  7037     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7038     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7039     MOVE X'2020233030303036373538' TO DFHEIV0(25:11)
  7040     CALL 'kxdfhei1' USING DFHEIV0,
  7041           WS-ERCNOT-FILE-ID,
  7042           DFHEIV20,
  7043           DFHEIV99,
  7044           ERCNOT-KEY,
  7045           DFHEIV99,
  7046           DFHEIV11,
  7047           DFHEIV99,
  7048           DFHEIV99
  7049     SET ADDRESS OF CERT-NOTE-FILE TO
  7050         DFHEIV20
  7051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7052
  7053
  7054     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  7055         GO TO 0427-ENDBR
  7056     END-IF.
  7057
  7058     IF (CZ-CARRIER = SV-CARRIER)
  7059        AND (CZ-GROUPING = SV-GROUPING)
  7060        AND (CZ-STATE = SV-STATE)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 124
* EL6316.cbl
  7061        AND (CZ-ACCOUNT = SV-ACCOUNT)
  7062        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  7063        AND (CZ-CERT-NO = SV-CERT-NO)
  7064        AND (CZ-RECORD-TYPE = '1')
  7065          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  7066          MOVE CZ-LAST-MAINT-USER TO
  7067                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7068          MOVE CZ-LAST-MAINT-DT TO
  7069                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7070          MOVE CZ-LAST-MAINT-HHMMSS TO
  7071                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7072          SET TB-INDX UP BY 1
  7073          GO TO 0427-LOOP
  7074     END-IF.
  7075
  7076 0427-ENDBR.
  7077
  7078
  7079* EXEC CICS ENDBR
  7080*         DATASET(WS-ERCNOT-FILE-ID)
  7081*    END-EXEC.
  7082     MOVE 0
  7083       TO DFHEIV11
  7084*    MOVE '&2                    $   #00006788' TO DFHEIV0
  7085     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7086     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7087     MOVE X'2020233030303036373838' TO DFHEIV0(25:11)
  7088     CALL 'kxdfhei1' USING DFHEIV0,
  7089           WS-ERCNOT-FILE-ID,
  7090           DFHEIV11,
  7091           DFHEIV99
  7092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7093
  7094
  7095     .
  7096 0427-EXIT.
  7097     EXIT.
  7098
  7099 0430-WRITE-ERENDT.
  7100     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  7101     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7102     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7103
  7104* EXEC CICS WRITE
  7105*         DATASET   (WS-ERENDT-FILE-ID)
  7106*         FROM      (ENDORSEMENT-RECORD)
  7107*         RIDFLD    (EN-CONTROL-PRIMARY)
  7108*         RESP      (WS-RESPONSE)
  7109*    END-EXEC
  7110     MOVE LENGTH OF
  7111      ENDORSEMENT-RECORD
  7112       TO DFHEIV11
  7113*    MOVE '&$ L                  ''  N#00006800' TO DFHEIV0
  7114     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7115     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7116     MOVE X'204E233030303036383030' TO DFHEIV0(25:11)
  7117     CALL 'kxdfhei1' USING DFHEIV0,
  7118           WS-ERENDT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 125
* EL6316.cbl
  7119           ENDORSEMENT-RECORD,
  7120           DFHEIV11,
  7121           EN-CONTROL-PRIMARY,
  7122           DFHEIV99,
  7123           DFHEIV99
  7124     MOVE EIBRESP  TO WS-RESPONSE
  7125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7126     IF RESP-NORMAL
  7127        MOVE 'C'                 TO PI-DOCUMENT-PROCESSED
  7128        display ' good write erendt '
  7129        IF EIBAID = DFHPF4
  7130           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7131           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7132           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7133           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7134        END-IF
  7135     ELSE
  7136        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7137        MOVE -1                  TO LTRIDL
  7138        MOVE ER-0132             TO EMI-ERROR
  7139        MOVE AL-UABON            TO LTRIDA
  7140        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7141     END-IF
  7142     .
  7143 0430-EXIT.
  7144     EXIT.
  7145 0440-ADD-BILLING-NOTE.
  7146
  7147* EXEC CICS GETMAIN
  7148*         SET      (ADDRESS OF EOB-CODES)
  7149*         LENGTH   (ELEOBC-LENGTH)
  7150*         INITIMG  (GETMAIN-SPACE)
  7151*    END-EXEC
  7152*    MOVE ',"IL                  $   #00006826' TO DFHEIV0
  7153     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7154     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7155     MOVE X'2020233030303036383236' TO DFHEIV0(25:11)
  7156     CALL 'kxdfhei1' USING DFHEIV0,
  7157           DFHEIV20,
  7158           ELEOBC-LENGTH,
  7159           GETMAIN-SPACE
  7160     SET ADDRESS OF EOB-CODES TO
  7161         DFHEIV20
  7162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7163
  7164     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7165     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7166     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7167
  7168
  7169* EXEC CICS STARTBR
  7170*        DATASET   ('ELEOBC')
  7171*        RIDFLD    (WS-ELEOBC-KEY)
  7172*        GTEQ
  7173*        RESP      (WS-RESPONSE)
  7174*    END-EXEC
  7175     MOVE 'ELEOBC' TO DFHEIV1
  7176     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 126
* EL6316.cbl
  7177       TO DFHEIV11
  7178*    MOVE '&,         G          &  N#00006836' TO DFHEIV0
  7179     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7180     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7181     MOVE X'204E233030303036383336' TO DFHEIV0(25:11)
  7182     CALL 'kxdfhei1' USING DFHEIV0,
  7183           DFHEIV1,
  7184           WS-ELEOBC-KEY,
  7185           DFHEIV99,
  7186           DFHEIV11,
  7187           DFHEIV99
  7188     MOVE EIBRESP  TO WS-RESPONSE
  7189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7190
  7191     IF NOT RESP-NORMAL
  7192        GO TO 0440-EXIT
  7193     END-IF
  7194      .
  7195 0440-READNEXT-ELEOBC.
  7196
  7197
  7198* EXEC CICS READNEXT
  7199*       INTO    (EOB-CODES)
  7200*       DATASET ('ELEOBC')
  7201*       RIDFLD  (WS-ELEOBC-KEY)
  7202*       RESP    (WS-RESPONSE)
  7203*    END-EXEC
  7204     MOVE LENGTH OF
  7205      EOB-CODES
  7206       TO DFHEIV12
  7207     MOVE 'ELEOBC' TO DFHEIV1
  7208     MOVE 0
  7209       TO DFHEIV11
  7210*    MOVE '&.IL                  )  N#00006849' TO DFHEIV0
  7211     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7212     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7213     MOVE X'204E233030303036383439' TO DFHEIV0(25:11)
  7214     CALL 'kxdfhei1' USING DFHEIV0,
  7215           DFHEIV1,
  7216           EOB-CODES,
  7217           DFHEIV12,
  7218           WS-ELEOBC-KEY,
  7219           DFHEIV99,
  7220           DFHEIV11,
  7221           DFHEIV99,
  7222           DFHEIV99
  7223     MOVE EIBRESP  TO WS-RESPONSE
  7224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7225
  7226     IF RESP-NORMAL
  7227         IF EO-RECORD-TYPE NOT = '5'
  7228             GO TO 0440-EXIT
  7229         END-IF
  7230     ELSE
  7231         GO TO 0440-EXIT
  7232     END-IF
  7233
  7234     IF EO-RECORD-TYPE = '5' AND
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 127
* EL6316.cbl
  7235        EO-EOB-CODE = PI-LTRID-ENTERED
  7236           CONTINUE
  7237     ELSE
  7238         GO TO 0440-READNEXT-ELEOBC
  7239     END-IF
  7240
  7241     MOVE SPACES TO WS-BILLING-NOTE
  7242     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7243     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7244     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7245     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7246     MOVE +25 TO WS-LEN
  7247
  7248     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7249     .
  7250 0440-EXIT.
  7251     EXIT.
  7252
  7253 0441-UPDATE-BILLING-NOTE.
  7254
  7255* EXEC CICS GETMAIN
  7256*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7257*         LENGTH   (ERNOTE-LENGTH)
  7258*         INITIMG  (GETMAIN-SPACE)
  7259*    END-EXEC
  7260*    MOVE ',"IL                  $   #00006884' TO DFHEIV0
  7261     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7262     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7263     MOVE X'2020233030303036383834' TO DFHEIV0(25:11)
  7264     CALL 'kxdfhei1' USING DFHEIV0,
  7265           DFHEIV20,
  7266           ERNOTE-LENGTH,
  7267           GETMAIN-SPACE
  7268     SET ADDRESS OF CERTIFICATE-NOTE TO
  7269         DFHEIV20
  7270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7271
  7272     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7273
  7274
  7275* EXEC CICS READ
  7276*       DATASET    (WS-ERNOTE-FILE-ID)
  7277*       RIDFLD     (WS-ERNOTE-KEY)
  7278*       INTO       (CERTIFICATE-NOTE)
  7279*       RESP       (WS-RESPONSE)
  7280*       UPDATE
  7281*    END-EXEC
  7282     MOVE LENGTH OF
  7283      CERTIFICATE-NOTE
  7284       TO DFHEIV11
  7285*    MOVE '&"IL       EU         (  N#00006892' TO DFHEIV0
  7286     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7287     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7288     MOVE X'204E233030303036383932' TO DFHEIV0(25:11)
  7289     CALL 'kxdfhei1' USING DFHEIV0,
  7290           WS-ERNOTE-FILE-ID,
  7291           CERTIFICATE-NOTE,
  7292           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 128
* EL6316.cbl
  7293           WS-ERNOTE-KEY,
  7294           DFHEIV99,
  7295           DFHEIV99,
  7296           DFHEIV99
  7297     MOVE EIBRESP  TO WS-RESPONSE
  7298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7299
  7300     IF RESP-NORMAL
  7301       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7302          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7303       END-IF
  7304       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7305          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7306       END-IF
  7307       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7308           (NOTE-SUB > +10) OR
  7309           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7310                             WS-BILLING-NOTE (1:WS-LEN))
  7311       END-PERFORM
  7312       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7313                              WS-BILLING-NOTE (1:WS-LEN)
  7314
  7315* EXEC CICS UNLOCK
  7316*           DATASET    (WS-ERNOTE-FILE-ID)
  7317*        END-EXEC
  7318*    MOVE '&*                    #   #00006914' TO DFHEIV0
  7319     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7320     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7321     MOVE X'2020233030303036393134' TO DFHEIV0(25:11)
  7322     CALL 'kxdfhei1' USING DFHEIV0,
  7323           WS-ERNOTE-FILE-ID,
  7324           DFHEIV99
  7325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7326       ELSE
  7327         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7328           (NOTE-SUB > +10) OR
  7329           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7330         END-PERFORM
  7331         IF (NOTE-SUB < +11)
  7332           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7333              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7334                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7335           ELSE
  7336             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7337              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7338                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7339                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7340             ELSE
  7341               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7342                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7343                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7344                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7345               ELSE
  7346                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7347                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7348                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7349                                       CN-BILLING-START-LINE-NO
  7350                 ELSE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 129
* EL6316.cbl
  7351                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7352                 END-IF
  7353               END-IF
  7354             END-IF
  7355           END-IF
  7356           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7357           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7358           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7359
  7360* EXEC CICS REWRITE
  7361*             DATASET    (WS-ERNOTE-FILE-ID)
  7362*             FROM       (CERTIFICATE-NOTE)
  7363*             RESP       (WS-RESPONSE)
  7364*          END-EXEC
  7365     MOVE LENGTH OF
  7366      CERTIFICATE-NOTE
  7367       TO DFHEIV11
  7368*    MOVE '&& L                  %  N#00006950' TO DFHEIV0
  7369     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7370     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7371     MOVE X'204E233030303036393530' TO DFHEIV0(25:11)
  7372     CALL 'kxdfhei1' USING DFHEIV0,
  7373           WS-ERNOTE-FILE-ID,
  7374           CERTIFICATE-NOTE,
  7375           DFHEIV11,
  7376           DFHEIV99
  7377     MOVE EIBRESP  TO WS-RESPONSE
  7378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7379           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7380         END-IF
  7381       END-IF
  7382     ELSE
  7383        MOVE SPACES              TO CERTIFICATE-NOTE
  7384        MOVE 'CN'                TO CN-RECORD-ID
  7385        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7386                                     WS-ERNOTE-KEY
  7387        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7388                                    CN-BILLING-END-LINE-NO
  7389        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7390        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7391        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7392        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7393
  7394* EXEC CICS WRITE
  7395*          DATASET    (WS-ERNOTE-FILE-ID)
  7396*          FROM       (CERTIFICATE-NOTE)
  7397*          RIDFLD     (WS-ERNOTE-KEY)
  7398*          RESP       (WS-RESPONSE)
  7399*       END-EXEC
  7400     MOVE LENGTH OF
  7401      CERTIFICATE-NOTE
  7402       TO DFHEIV11
  7403*    MOVE '&$ L                  ''  N#00006969' TO DFHEIV0
  7404     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7405     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7406     MOVE X'204E233030303036393639' TO DFHEIV0(25:11)
  7407     CALL 'kxdfhei1' USING DFHEIV0,
  7408           WS-ERNOTE-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 130
* EL6316.cbl
  7409           CERTIFICATE-NOTE,
  7410           DFHEIV11,
  7411           WS-ERNOTE-KEY,
  7412           DFHEIV99,
  7413           DFHEIV99
  7414     MOVE EIBRESP  TO WS-RESPONSE
  7415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7416
  7417        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7418     END-IF
  7419
  7420     .
  7421 0441-EXIT.
  7422     EXIT.
  7423
  7424
  7425 0442-SQUEEZE-IT-IN.
  7426
  7427     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7428        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7429           NOTE-SUB = +10
  7430           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7431           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7432             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7433             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7434             MOVE +9 TO NOTE-SUB
  7435           END-IF
  7436        END-PERFORM
  7437     ELSE
  7438        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7439           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7440             UNTIL NOTE-SUB = +1
  7441             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7442             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7443                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7444                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7445                MOVE +2          TO NOTE-SUB
  7446             END-IF
  7447           END-PERFORM
  7448        END-IF
  7449     END-IF
  7450
  7451     .
  7452 0442-EXIT.
  7453     EXIT.
  7454
  7455 0445-CERTIFICATE-UPDATE.
  7456    display 'billing note written, updating cert'
  7457     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7458     IF RESP-NORMAL
  7459        EVALUATE CM-NOTE-SW
  7460           WHEN '2'
  7461           WHEN '3'
  7462           WHEN '6'
  7463           WHEN '7'
  7464              SET NO-CERT-RW     TO TRUE
  7465           WHEN ' '
  7466              MOVE '2'           TO CM-NOTE-SW
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 131
* EL6316.cbl
  7467           WHEN '1'
  7468              MOVE '3'           TO CM-NOTE-SW
  7469           WHEN '4'
  7470              MOVE '6'           TO CM-NOTE-SW
  7471           WHEN '5'
  7472              MOVE '7'           TO CM-NOTE-SW
  7473        END-EVALUATE
  7474     END-IF
  7475     IF NOT NO-CERT-RW
  7476        PERFORM 1810-REWRITE-ELCERT
  7477                                 THRU 1810-EXIT
  7478     ELSE
  7479
  7480* EXEC CICS UNLOCK
  7481*          DATASET    (WS-ELCERT-FILE-ID)
  7482*       END-EXEC
  7483*    MOVE '&*                    #   #00007038' TO DFHEIV0
  7484     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7485     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7486     MOVE X'2020233030303037303338' TO DFHEIV0(25:11)
  7487     CALL 'kxdfhei1' USING DFHEIV0,
  7488           WS-ELCERT-FILE-ID,
  7489           DFHEIV99
  7490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7491     END-IF
  7492
  7493     .
  7494 0445-EXIT.
  7495     EXIT.
  7496
  7497 0450-GET-ERACCT.
  7498     DISPLAY ' MADE IT TO 0450 '
  7499     MOVE ' '                    TO WS-ERACCT-SW
  7500     MOVE ZEROS                  TO WS-CHGBACK
  7501                                    WS-CSO-PORTION
  7502                                    WS-ACCT-PORTION
  7503                                    WS-DIFF
  7504     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7505     IF RESP-NORMAL
  7506        DISPLAY ' GOOD STARTBR '
  7507        PERFORM 0470-READNEXT-ERACCT
  7508                                 THRU 0470-EXIT
  7509     END-IF
  7510     IF RESP-NORMAL
  7511        DISPLAY ' GOOD READNEXT '
  7512        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7513           IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7514              AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7515              DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7516              SET ACCT-FOUND TO TRUE
  7517           ELSE
  7518              PERFORM 0470-READNEXT-ERACCT
  7519                                 THRU 0470-EXIT
  7520              IF RESP-NORMAL
  7521                 IF AM-CONTROL-PRIMARY (1:20)
  7522                    = EN-CONTROL-PRIMARY (1:20)
  7523                    IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7524                       AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 132
* EL6316.cbl
  7525                       DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7526                       SET ACCT-FOUND TO TRUE
  7527                    END-IF
  7528                 END-IF
  7529              END-IF
  7530           END-IF
  7531        END-IF
  7532     END-IF
  7533     IF ACCT-FOUND
  7534        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7535           (AM-COM-TYP (S1) = 'C' OR 'D')
  7536           OR (S1 > +10)
  7537        END-PERFORM
  7538        IF S1 < +11
  7539           MOVE AM-COMM-CHARGEBACK (S1)
  7540                                 TO WS-CHGBACK
  7541        END-IF
  7542     END-IF
  7543
  7544* EXEC CICS ENDBR
  7545*        DATASET     ('ERACCT')
  7546*    END-EXEC.
  7547     MOVE 'ERACCT' TO DFHEIV1
  7548     MOVE 0
  7549       TO DFHEIV11
  7550*    MOVE '&2                    $   #00007093' TO DFHEIV0
  7551     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7552     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7553     MOVE X'2020233030303037303933' TO DFHEIV0(25:11)
  7554     CALL 'kxdfhei1' USING DFHEIV0,
  7555           DFHEIV1,
  7556           DFHEIV11,
  7557           DFHEIV99
  7558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7559
  7560    .
  7561 0450-EXIT.
  7562     EXIT.
  7563 0460-STARTBR-ERACCT.
  7564     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7565     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7566     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7567
  7568* EXEC CICS STARTBR
  7569*        DATASET   ('ERACCT')
  7570*        RIDFLD    (WS-ERACCT-KEY)
  7571*        GTEQ
  7572*        RESP      (WS-RESPONSE)
  7573*    END-EXEC
  7574     MOVE 'ERACCT' TO DFHEIV1
  7575     MOVE 0
  7576       TO DFHEIV11
  7577*    MOVE '&,         G          &  N#00007103' TO DFHEIV0
  7578     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7579     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7580     MOVE X'204E233030303037313033' TO DFHEIV0(25:11)
  7581     CALL 'kxdfhei1' USING DFHEIV0,
  7582           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 133
* EL6316.cbl
  7583           WS-ERACCT-KEY,
  7584           DFHEIV99,
  7585           DFHEIV11,
  7586           DFHEIV99
  7587     MOVE EIBRESP  TO WS-RESPONSE
  7588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7589     .
  7590 0460-EXIT.
  7591     EXIT.
  7592 0470-READNEXT-ERACCT.
  7593
  7594* EXEC CICS READNEXT
  7595*       SET      (ADDRESS OF ACCOUNT-MASTER)
  7596*       DATASET ('ERACCT')
  7597*       RIDFLD  (WS-ERACCT-KEY)
  7598*       RESP    (WS-RESPONSE)
  7599*    END-EXEC
  7600     MOVE 'ERACCT' TO DFHEIV1
  7601     MOVE 0
  7602       TO DFHEIV11
  7603*    MOVE '&.S                   )  N#00007113' TO DFHEIV0
  7604     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7605     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7606     MOVE X'204E233030303037313133' TO DFHEIV0(25:11)
  7607     CALL 'kxdfhei1' USING DFHEIV0,
  7608           DFHEIV1,
  7609           DFHEIV20,
  7610           DFHEIV99,
  7611           WS-ERACCT-KEY,
  7612           DFHEIV99,
  7613           DFHEIV11,
  7614           DFHEIV99,
  7615           DFHEIV99
  7616     SET ADDRESS OF ACCOUNT-MASTER TO
  7617         DFHEIV20
  7618     MOVE EIBRESP  TO WS-RESPONSE
  7619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7620     .
  7621 0470-EXIT.
  7622     EXIT.
  7623 0491-ERNOTE-READ-UPDATE.
  7624
  7625* EXEC CICS READ
  7626*       UPDATE
  7627*       DATASET    (WS-ERNOTE-FILE-ID)
  7628*       RIDFLD     (WS-ERNOTE-KEY)
  7629*       SET        (ADDRESS OF CERTIFICATE-NOTE)
  7630*       RESP       (WS-RESPONSE)
  7631*    END-EXEC
  7632*    MOVE '&"S        EU         (  N#00007123' TO DFHEIV0
  7633     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7634     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7635     MOVE X'204E233030303037313233' TO DFHEIV0(25:11)
  7636     CALL 'kxdfhei1' USING DFHEIV0,
  7637           WS-ERNOTE-FILE-ID,
  7638           DFHEIV20,
  7639           DFHEIV99,
  7640           WS-ERNOTE-KEY,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 134
* EL6316.cbl
  7641           DFHEIV99,
  7642           DFHEIV99,
  7643           DFHEIV99
  7644     SET ADDRESS OF CERTIFICATE-NOTE TO
  7645         DFHEIV20
  7646     MOVE EIBRESP  TO WS-RESPONSE
  7647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7648     .
  7649 0491-EXIT.
  7650     EXIT.
  7651 0492-REWRITE-ERNOTE.
  7652     MOVE 'E631'              TO CN-LAST-MAINT-USER
  7653     MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7654     MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7655
  7656* EXEC CICS REWRITE
  7657*       DATASET    (WS-ERNOTE-FILE-ID)
  7658*       FROM       (CERTIFICATE-NOTE)
  7659*       RESP       (WS-RESPONSE)
  7660*    END-EXEC
  7661     MOVE LENGTH OF
  7662      CERTIFICATE-NOTE
  7663       TO DFHEIV11
  7664*    MOVE '&& L                  %  N#00007137' TO DFHEIV0
  7665     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7666     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7667     MOVE X'204E233030303037313337' TO DFHEIV0(25:11)
  7668     CALL 'kxdfhei1' USING DFHEIV0,
  7669           WS-ERNOTE-FILE-ID,
  7670           CERTIFICATE-NOTE,
  7671           DFHEIV11,
  7672           DFHEIV99
  7673     MOVE EIBRESP  TO WS-RESPONSE
  7674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7675     .
  7676 0492-EXIT.
  7677     EXIT.
  7678 0493-SQUEEZE-ERNOTE.
  7679     IF CN-BILLING-START-LINE-NO > 0
  7680         MOVE CN-BILLING-START-LINE-NO TO NOTE-SUB
  7681     ELSE
  7682         MOVE +1                 TO NOTE-SUB
  7683     END-IF.
  7684
  7685     PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7686        (NOTE-SUB > +9)
  7687        IF CN-LINE (NOTE-SUB) = SPACES
  7688           MOVE CN-LINE (NOTE-SUB + +1)
  7689                                 TO CN-LINE (NOTE-SUB)
  7690           MOVE SPACES           TO CN-LINE (NOTE-SUB + +1)
  7691        END-IF
  7692     END-PERFORM
  7693     .
  7694 0493-EXIT.
  7695     EXIT.
  7696 0500-ERENDT-READ-GTEQ.
  7697
  7698* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 135
* EL6316.cbl
  7699*        DATASET    (WS-ERENDT-FILE-ID)
  7700*        RIDFLD     (ERENDT-KEY)
  7701*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7702*        RESP       (WS-RESPONSE)
  7703*        GTEQ
  7704*    END-EXEC
  7705*    MOVE '&"S        G          (  N#00007164' TO DFHEIV0
  7706     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7707     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7708     MOVE X'204E233030303037313634' TO DFHEIV0(25:11)
  7709     CALL 'kxdfhei1' USING DFHEIV0,
  7710           WS-ERENDT-FILE-ID,
  7711           DFHEIV20,
  7712           DFHEIV99,
  7713           ERENDT-KEY,
  7714           DFHEIV99,
  7715           DFHEIV99,
  7716           DFHEIV99
  7717     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7718         DFHEIV20
  7719     MOVE EIBRESP  TO WS-RESPONSE
  7720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7721     IF NOT RESP-NORMAL
  7722        MOVE ER-2237             TO EMI-ERROR
  7723        PERFORM 9900-ERROR-FORMAT
  7724                                 THRU 9900-EXIT
  7725        MOVE -1                  TO CARRL
  7726        GO TO 8200-SEND-DATAONLY
  7727     END-IF
  7728     .
  7729 0500-EXIT.
  7730     EXIT.
  7731 0510-ERENDT-READNEXT.
  7732
  7733* EXEC CICS READNEXT
  7734*       DATASET    (WS-ERENDT-FILE-ID)
  7735*       RIDFLD     (ERENDT-KEY)
  7736*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7737*       RESP       (WS-RESPONSE)
  7738*    END-EXEC
  7739     MOVE 0
  7740       TO DFHEIV11
  7741*    MOVE '&.S                   )  N#00007182' TO DFHEIV0
  7742     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7743     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7744     MOVE X'204E233030303037313832' TO DFHEIV0(25:11)
  7745     CALL 'kxdfhei1' USING DFHEIV0,
  7746           WS-ERENDT-FILE-ID,
  7747           DFHEIV20,
  7748           DFHEIV99,
  7749           ERENDT-KEY,
  7750           DFHEIV99,
  7751           DFHEIV11,
  7752           DFHEIV99,
  7753           DFHEIV99
  7754     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7755         DFHEIV20
  7756     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 136
* EL6316.cbl
  7757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7758     IF NOT RESP-NORMAL
  7759        MOVE ER-2237             TO EMI-ERROR
  7760        PERFORM 9900-ERROR-FORMAT
  7761                                 THRU 9900-EXIT
  7762        MOVE -1                  TO CARRL
  7763        GO TO 8200-SEND-DATAONLY
  7764     END-IF
  7765     .
  7766 0510-EXIT.
  7767     EXIT.
  7768 0520-ERENDT-STARTBR.
  7769
  7770* EXEC CICS STARTBR
  7771*       DATASET    (WS-ERENDT-FILE-ID)
  7772*       RIDFLD     (ERENDT-KEY)
  7773*       RESP       (WS-RESPONSE)
  7774*    END-EXEC
  7775     MOVE 0
  7776       TO DFHEIV11
  7777*    MOVE '&,         G          &  N#00007199' TO DFHEIV0
  7778     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7779     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7780     MOVE X'204E233030303037313939' TO DFHEIV0(25:11)
  7781     CALL 'kxdfhei1' USING DFHEIV0,
  7782           WS-ERENDT-FILE-ID,
  7783           ERENDT-KEY,
  7784           DFHEIV99,
  7785           DFHEIV11,
  7786           DFHEIV99
  7787     MOVE EIBRESP  TO WS-RESPONSE
  7788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7789     IF NOT RESP-NORMAL
  7790        MOVE ER-2237             TO EMI-ERROR
  7791        PERFORM 9900-ERROR-FORMAT
  7792                                 THRU 9900-EXIT
  7793        MOVE -1                  TO CARRL
  7794        GO TO 8200-SEND-DATAONLY
  7795     END-IF
  7796     .
  7797 0520-EXIT.
  7798     EXIT.
  7799 0530-ERENDT-READPREV.
  7800
  7801* EXEC CICS READPREV
  7802*       DATASET    (WS-ERENDT-FILE-ID)
  7803*       RIDFLD     (ERENDT-KEY)
  7804*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7805*       RESP       (WS-RESPONSE)
  7806*    END-EXEC
  7807     MOVE 0
  7808       TO DFHEIV11
  7809*    MOVE '&0S                   )  N#00007215' TO DFHEIV0
  7810     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7811     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7812     MOVE X'204E233030303037323135' TO DFHEIV0(25:11)
  7813     CALL 'kxdfhei1' USING DFHEIV0,
  7814           WS-ERENDT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 137
* EL6316.cbl
  7815           DFHEIV20,
  7816           DFHEIV99,
  7817           ERENDT-KEY,
  7818           DFHEIV99,
  7819           DFHEIV11,
  7820           DFHEIV99,
  7821           DFHEIV99
  7822     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7823         DFHEIV20
  7824     MOVE EIBRESP  TO WS-RESPONSE
  7825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7826     IF NOT RESP-NORMAL
  7827        MOVE ER-2238             TO EMI-ERROR
  7828        PERFORM 9900-ERROR-FORMAT
  7829                                 THRU 9900-EXIT
  7830        MOVE -1                  TO CARRL
  7831        MOVE 'N'                 TO PI-ENDORSE-RECORD
  7832        MOVE LOW-VALUES          TO  EL631II
  7833        GO TO 0350-DISPLAY-COMMON-DATA
  7834     END-IF
  7835     .
  7836 0530-EXIT.
  7837     EXIT.
  7838 0600-CREATE-TEMP-STORAGE.
  7839
  7840* EXEC CICS WRITEQ TS
  7841*        QUEUE (QID)
  7842*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7843*        LENGTH(PI-COMM-LENGTH)
  7844*    END-EXEC
  7845*    MOVE '*"                    ''   #00007234' TO DFHEIV0
  7846     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7847     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7848     MOVE X'2020233030303037323334' TO DFHEIV0(25:11)
  7849     CALL 'kxdfhei1' USING DFHEIV0,
  7850           QID,
  7851           PROGRAM-INTERFACE-BLOCK,
  7852           PI-COMM-LENGTH,
  7853           DFHEIV99,
  7854           DFHEIV99,
  7855           DFHEIV99
  7856     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7857     display ' about to write map ' el631ii
  7858
  7859* EXEC CICS WRITEQ TS
  7860*        QUEUE (QID)
  7861*        FROM  (EL631II)
  7862*        LENGTH(MAP-LENGTH)
  7863*    END-EXEC.
  7864*    MOVE '*"                    ''   #00007240' TO DFHEIV0
  7865     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7866     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7867     MOVE X'2020233030303037323430' TO DFHEIV0(25:11)
  7868     CALL 'kxdfhei1' USING DFHEIV0,
  7869           QID,
  7870           EL631II,
  7871           MAP-LENGTH,
  7872           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 138
* EL6316.cbl
  7873           DFHEIV99,
  7874           DFHEIV99
  7875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7876
  7877 0600-EXIT.
  7878      EXIT.
  7879 0610-RECOVER-TEMP-STORAGE.
  7880
  7881* EXEC CICS READQ TS
  7882*        QUEUE (QID)
  7883*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7884*        LENGTH(PI-COMM-LENGTH)
  7885*    END-EXEC
  7886*    MOVE '*$I    L              ''   #00007248' TO DFHEIV0
  7887     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7888     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7889     MOVE X'2020233030303037323438' TO DFHEIV0(25:11)
  7890     CALL 'kxdfhei1' USING DFHEIV0,
  7891           QID,
  7892           PROGRAM-INTERFACE-BLOCK,
  7893           PI-COMM-LENGTH,
  7894           DFHEIV99,
  7895           DFHEIV99,
  7896           DFHEIV99
  7897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7898
  7899* EXEC CICS READQ TS
  7900*        QUEUE (QID)
  7901*        INTO  (EL631II)
  7902*        LENGTH(MAP-LENGTH)
  7903*    END-EXEC
  7904*    MOVE '*$I    L              ''   #00007253' TO DFHEIV0
  7905     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7906     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7907     MOVE X'2020233030303037323533' TO DFHEIV0(25:11)
  7908     CALL 'kxdfhei1' USING DFHEIV0,
  7909           QID,
  7910           EL631II,
  7911           MAP-LENGTH,
  7912           DFHEIV99,
  7913           DFHEIV99,
  7914           DFHEIV99
  7915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7916     display ' map ' EL631II
  7917     PERFORM 0620-DELETE-TS THRU 0620-EXIT
  7918     MOVE AL-UANON            TO LTRIDA
  7919     IF PI-FROM-CERT = 'Y' AND
  7920        PI-PROCESSOR-IS-CSR-SUPER
  7921            MOVE AL-UNNON        TO OLFDTA
  7922                                    OAHDTA
  7923                                    OLFAMTA
  7924                                    OAHAMTA
  7925     END-IF
  7926     IF WS-SET-CODES-MDT = 'Y'
  7927        move +1                  to s2
  7928        perform varying s1 from +1 by +5 until s1 > +60
  7929           MOVE WS-PASSED-REASON-CODES (s1:4)
  7930                                 TO reacd-in (s2)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 139
* EL6316.cbl
  7931           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7932               MOVE AL-SANON     TO REACDA (S2)
  7933               MOVE +4           TO REACDL (S2)
  7934           END-IF
  7935           add +1                to s2
  7936        end-perform
  7937        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7938     END-IF
  7939
  7940     IF ENCCODEI > SPACES
  7941         MOVE AL-UANON       TO ENCCODEA
  7942     END-IF
  7943
  7944     IF CRTNT1I > SPACES
  7945         MOVE AL-UANON       TO CRTNT1A
  7946     END-IF
  7947
  7948     IF CRTNT2I > SPACES
  7949         MOVE AL-UANON       TO CRTNT2A
  7950     END-IF
  7951
  7952     IF BILNT1I > SPACES
  7953         MOVE AL-UANON       TO BILNT1A
  7954     END-IF
  7955     .
  7956 0610-EXIT.
  7957      EXIT.
  7958 0620-DELETE-TS.
  7959
  7960* EXEC CICS DELETEQ TS
  7961*        QUEUE(QID)
  7962*    END-EXEC
  7963*    MOVE '*&                    #   #00007301' TO DFHEIV0
  7964     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7965     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7966     MOVE X'2020233030303037333031' TO DFHEIV0(25:11)
  7967     CALL 'kxdfhei1' USING DFHEIV0,
  7968           QID,
  7969           DFHEIV99
  7970     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7971     .
  7972 0620-EXIT.
  7973      EXIT.
  7974
  7975 0700-LOAD-FROM-CERT.
  7976     PERFORM 0755-READ-CERT THRU 0755-EXIT
  7977     PERFORM 0760-CHECK-OLD-ORIG THRU 0760-EXIT
  7978     PERFORM 0770-MOVE-CERT-TO-SCREEN THRU 0770-EXIT
  7979     MOVE ER-2784                TO EMI-ERROR
  7980     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  7981     GO TO 8100-SEND-INITIAL-MAP
  7982     .
  7983 0700-EXIT.
  7984      EXIT.
  7985
  7986
  7987 0755-READ-CERT.
  7988*     display 'made it to 0755'
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 140
* EL6316.cbl
  7989     MOVE PI-COMPANY-CD          TO W-CERT-COMPANY-CD
  7990     MOVE PI-CARRIER             TO W-CERT-CARRIER
  7991     MOVE PI-GROUPING            TO W-CERT-GROUPING
  7992     MOVE PI-STATE               TO W-CERT-STATE
  7993     MOVE PI-ACCOUNT             TO W-CERT-ACCOUNT
  7994     MOVE PI-CERT-PRIME          TO W-CERT-CERT-PRIME
  7995     MOVE PI-CERT-SFX            TO W-CERT-CERT-SFX
  7996     MOVE PI-CERT-EFF-DT         TO W-CERT-CERT-EFF-DT
  7997
  7998
  7999* EXEC CICS READ
  8000*        DATASET   (WS-ELCERT-FILE-ID)
  8001*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  8002*        RIDFLD    (WS-ELCERT-KEY)
  8003*        RESP      (WS-RESPONSE)
  8004*    END-EXEC
  8005*    MOVE '&"S        E          (  N#00007331' TO DFHEIV0
  8006     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8007     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8008     MOVE X'204E233030303037333331' TO DFHEIV0(25:11)
  8009     CALL 'kxdfhei1' USING DFHEIV0,
  8010           WS-ELCERT-FILE-ID,
  8011           DFHEIV20,
  8012           DFHEIV99,
  8013           WS-ELCERT-KEY,
  8014           DFHEIV99,
  8015           DFHEIV99,
  8016           DFHEIV99
  8017     SET ADDRESS OF CERTIFICATE-MASTER TO
  8018         DFHEIV20
  8019     MOVE EIBRESP  TO WS-RESPONSE
  8020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8021
  8022     IF RESP-NORMAL
  8023        CONTINUE
  8024     ELSE
  8025        IF RESP-NOTFND
  8026           MOVE LOW-VALUES       TO EL631II
  8027           MOVE ER-2253          TO EMI-ERROR
  8028           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8029           MOVE -1               TO CARRL
  8030           GO TO 8100-SEND-INITIAL-MAP
  8031        END-IF
  8032     END-IF
  8033
  8034     .
  8035 0755-EXIT.
  8036     EXIT.
  8037
  8038
  8039 0760-CHECK-OLD-ORIG.
  8040
  8041     display ' made it to 0760 '
  8042
  8043     MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  8044     MOVE PI-CARRIER             TO CRTO-CARRIER
  8045     MOVE PI-GROUPING            TO CRTO-GROUPING
  8046     MOVE PI-STATE               TO CRTO-STATE
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 141
* EL6316.cbl
  8047     MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  8048     MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  8049     MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  8050     MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  8051     MOVE 'I'                    TO CRTO-RECORD-TYPE
  8052     MOVE ZEROS                  TO CRTO-SEQ-NO
  8053     MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  8054     MOVE ELCRTO-KEY (1:33)      TO PI-ERENDT-KEY (1:33)
  8055     MOVE 'C'                    TO PI-ENDT-RECORD-TYPE
  8056     MOVE ZEROS                  TO PI-ENDT-SEQ-NO
  8057     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  8058
  8059     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  8060      display 'response ' ws-response
  8061      display 'pi-elcrto-key ' pi-elcrto-key
  8062      display 'oc key ' oc-control-primary
  8063     IF RESP-NORMAL
  8064       AND (PI-ELCRTO-KEY (1:33) =
  8065              OC-CONTROL-PRIMARY (1:33))
  8066          DISPLAY 'CRTO RESP NORMAL AND = '
  8067          IF OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES
  8068             MOVE OC-CONTROL-PRIMARY  TO PI-ELCRTO-KEY
  8069          ELSE
  8070             SUBTRACT +1 FROM OC-KEY-SEQ-NO
  8071             PERFORM 0780-ADD-CRTO-REC THRU 0780-EXIT
  8072          END-IF
  8073     ELSE
  8074          MOVE SPACES              TO ORIGINAL-CERTIFICATE
  8075          MOVE 'OC'                TO OC-RECORD-ID
  8076          MOVE ELCRTO-KEY (1:33)   TO OC-CONTROL-PRIMARY (1:33)
  8077          MOVE +4096               TO OC-KEY-SEQ-NO
  8078          PERFORM 0780-ADD-CRTO-REC THRU 0780-EXIT
  8079     END-IF
  8080
  8081     PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  8082
  8083     .
  8084 0760-EXIT.
  8085     EXIT.
  8086
  8087 0770-MOVE-CERT-TO-SCREEN.
  8088
  8089     display ' made it to 0770 '
  8090
  8091     MOVE CM-CARRIER             TO CARRO
  8092     MOVE CM-GROUPING            TO GROUPO
  8093     MOVE CM-STATE               TO STATEO
  8094     MOVE CM-ACCOUNT             TO ACCTO
  8095     MOVE CM-CERT-PRIME          TO CERTNOO
  8096     MOVE CM-CERT-SFX            TO CRTSFXO
  8097
  8098     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  8099     MOVE ' '                    TO DC-OPTION-CODE
  8100     PERFORM 9700-DATE-LINK
  8101     IF NO-CONVERSION-ERROR
  8102        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  8103     END-IF
  8104
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 142
* EL6316.cbl
  8105     MOVE CM-INSURED-LAST-NAME   TO LNAMEO
  8106     MOVE CM-INSURED-FIRST-NAME  TO FNAMEO
  8107     MOVE CM-INSURED-INITIAL2    TO MINITO
  8108
  8109     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  8110     MOVE ' '                    TO DC-OPTION-CODE
  8111     PERFORM 9700-DATE-LINK
  8112     IF NO-CONVERSION-ERROR
  8113        MOVE DC-GREG-DATE-1-EDIT TO NLFDTO
  8114     END-IF
  8115     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  8116     MOVE ' '                    TO DC-OPTION-CODE
  8117     PERFORM 9700-DATE-LINK
  8118     IF NO-CONVERSION-ERROR
  8119        MOVE DC-GREG-DATE-1-EDIT TO NAHDTO
  8120     END-IF
  8121
  8122     MOVE CM-LF-ITD-CANCEL-AMT   TO NLFAMTO
  8123     MOVE CM-AH-ITD-CANCEL-AMT   TO NAHAMTO
  8124
  8125     IF CM-LIFE-COMM-PCT NOT = ZEROS
  8126        MOVE CM-LIFE-COMM-PCT TO LFCOMMO
  8127     END-IF
  8128     IF CM-AH-COMM-PCT NOT = ZEROS
  8129        MOVE CM-AH-COMM-PCT   TO AHCOMMO
  8130     END-IF
  8131
  8132
  8133     .
  8134 0770-EXIT.
  8135     EXIT.
  8136
  8137
  8138 0780-ADD-CRTO-REC.
  8139      display 'made it to 0780'
  8140     PERFORM 0783-LOAD-CERT-TO-CRTO-REC THRU 0783-EXIT
  8141
  8142
  8143* EXEC CICS WRITE
  8144*       DATASET   ('ELCRTO')
  8145*       FROM      (ORIGINAL-CERTIFICATE)
  8146*       RIDFLD    (OC-CONTROL-PRIMARY)
  8147*       RESP      (WS-RESPONSE)
  8148*    END-EXEC.
  8149     MOVE LENGTH OF
  8150      ORIGINAL-CERTIFICATE
  8151       TO DFHEIV11
  8152     MOVE 'ELCRTO' TO DFHEIV1
  8153*    MOVE '&$ L                  ''  N#00007458' TO DFHEIV0
  8154     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8155     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8156     MOVE X'204E233030303037343538' TO DFHEIV0(25:11)
  8157     CALL 'kxdfhei1' USING DFHEIV0,
  8158           DFHEIV1,
  8159           ORIGINAL-CERTIFICATE,
  8160           DFHEIV11,
  8161           OC-CONTROL-PRIMARY,
  8162           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 143
* EL6316.cbl
  8163           DFHEIV99
  8164     MOVE EIBRESP  TO WS-RESPONSE
  8165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8166
  8167
  8168     IF NOT RESP-NORMAL
  8169         DISPLAY 'ERROR IN 0780 WRITING ELCRTO ' WS-RESPONSE
  8170         MOVE ER-9999      TO EMI-ERROR
  8171         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8172         GO TO 8200-SEND-DATAONLY
  8173     END-IF
  8174
  8175     .
  8176 0780-EXIT.
  8177     EXIT.
  8178
  8179
  8180 0783-LOAD-CERT-TO-CRTO-REC.
  8181
  8182      display 'made it to 0783'
  8183
  8184     MOVE '6316'                 TO OC-LAST-MAINT-BY
  8185     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  8186     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  8187     MOVE 'I'                    TO OC-RECORD-TYPE
  8188     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
  8189     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  8190     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  8191     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  8192     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  8193     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  8194     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  8195     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  8196     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  8197     IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  8198         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  8199         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  8200         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  8201         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  8202         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  8203         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  8204         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  8205         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  8206         MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-CANCEL-AMT
  8207                                      OC-LF-ITD-CANCEL-AMT
  8208     END-IF
  8209     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
  8210     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8211         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  8212         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  8213         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  8214         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  8215         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  8216         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  8217         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  8218         MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-CANCEL-AMT
  8219                                      OC-AH-ITD-CANCEL-AMT
  8220     END-IF
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 144
* EL6316.cbl
  8221     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  8222     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
  8223     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  8224
  8225     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  8226
  8227     MOVE ELCRTO-KEY (1:33) TO WS-ERMAIL-KEY
  8228
  8229
  8230* EXEC CICS READ
  8231*         DATASET   (WS-ERMAIL-FILE-ID)
  8232*         RIDFLD    (WS-ERMAIL-KEY)
  8233*         SET       (ADDRESS OF MAILING-DATA)
  8234*         RESP      (WS-RESPONSE)
  8235*    END-EXEC
  8236*    MOVE '&"S        E          (  N#00007526' TO DFHEIV0
  8237     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8239     MOVE X'204E233030303037353236' TO DFHEIV0(25:11)
  8240     CALL 'kxdfhei1' USING DFHEIV0,
  8241           WS-ERMAIL-FILE-ID,
  8242           DFHEIV20,
  8243           DFHEIV99,
  8244           WS-ERMAIL-KEY,
  8245           DFHEIV99,
  8246           DFHEIV99,
  8247           DFHEIV99
  8248     SET ADDRESS OF MAILING-DATA TO
  8249         DFHEIV20
  8250     MOVE EIBRESP  TO WS-RESPONSE
  8251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8252
  8253     IF RESP-NORMAL
  8254         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
  8255     END-IF.
  8256
  8257     MOVE ELCRTO-KEY (1:33)     TO WS-ELCRTT-PRIMARY
  8258     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  8259
  8260
  8261* EXEC CICS READ
  8262*         DATASET  (WS-ELCRTT-FILE-ID)
  8263*         RIDFLD   (WS-ELCRTT-KEY)
  8264*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  8265*         RESP     (WS-RESPONSE)
  8266*    END-EXEC
  8267*    MOVE '&"S        E          (  N#00007540' TO DFHEIV0
  8268     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8269     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8270     MOVE X'204E233030303037353430' TO DFHEIV0(25:11)
  8271     CALL 'kxdfhei1' USING DFHEIV0,
  8272           WS-ELCRTT-FILE-ID,
  8273           DFHEIV20,
  8274           DFHEIV99,
  8275           WS-ELCRTT-KEY,
  8276           DFHEIV99,
  8277           DFHEIV99,
  8278           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 145
* EL6316.cbl
  8279     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8280         DFHEIV20
  8281     MOVE EIBRESP  TO WS-RESPONSE
  8282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8283
  8284     IF RESP-NORMAL
  8285         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  8286         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  8287     END-IF.
  8288
  8289
  8290     .
  8291 0783-EXIT.
  8292     EXIT.
  8293
  8294 0785-CHG-CRTO-REC.
  8295
  8296     display 'made it to 0785'
  8297
  8298     MOVE '6316'                 TO OC-LAST-MAINT-BY
  8299     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  8300     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  8301
  8302     MOVE OLFDTO                 TO WS-TMPDATE
  8303
  8304* EXEC CICS BIF DEEDIT
  8305*         FIELD   (WS-TMPDATE)
  8306*         LENGTH  (8)
  8307*    END-EXEC
  8308     MOVE 8
  8309       TO DFHEIV11
  8310*    MOVE '@"L                   #   #00007566' TO DFHEIV0
  8311     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8312     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8313     MOVE X'2020233030303037353636' TO DFHEIV0(25:11)
  8314     CALL 'kxdfhei1' USING DFHEIV0,
  8315           WS-TMPDATE,
  8316           DFHEIV11
  8317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8318     MOVE WS-TMPDT               TO DC-GREG-DATE-1-MDY
  8319     MOVE '4'                    TO DC-OPTION-CODE
  8320     PERFORM 9700-DATE-LINK
  8321     IF NOT DATE-CONVERSION-ERROR
  8322        MOVE DC-BIN-DATE-1       TO OC-LF-CANCEL-DT
  8323     END-IF
  8324
  8325     display 'lf amt ' olfamto
  8326     MOVE OLFAMTO                TO WS-AMTX
  8327
  8328* EXEC CICS BIF DEEDIT
  8329*         FIELD   (WS-AMTX)
  8330*         LENGTH  (10)
  8331*    END-EXEC
  8332     MOVE 10
  8333       TO DFHEIV11
  8334*    MOVE '@"L                   #   #00007579' TO DFHEIV0
  8335     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8336     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 146
* EL6316.cbl
  8337     MOVE X'2020233030303037353739' TO DFHEIV0(25:11)
  8338     CALL 'kxdfhei1' USING DFHEIV0,
  8339           WS-AMTX,
  8340           DFHEIV11
  8341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8342     MOVE WS-AMTV2               TO OC-LF-CANCEL-AMT
  8343
  8344     MOVE OAHDTO                 TO WS-TMPDATE
  8345
  8346* EXEC CICS BIF DEEDIT
  8347*         FIELD   (WS-TMPDATE)
  8348*         LENGTH  (8)
  8349*    END-EXEC
  8350     MOVE 8
  8351       TO DFHEIV11
  8352*    MOVE '@"L                   #   #00007586' TO DFHEIV0
  8353     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8354     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8355     MOVE X'2020233030303037353836' TO DFHEIV0(25:11)
  8356     CALL 'kxdfhei1' USING DFHEIV0,
  8357           WS-TMPDATE,
  8358           DFHEIV11
  8359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8360     MOVE WS-TMPDT               TO DC-GREG-DATE-1-MDY
  8361     MOVE '4'                    TO DC-OPTION-CODE
  8362     PERFORM 9700-DATE-LINK
  8363     IF NOT DATE-CONVERSION-ERROR
  8364        MOVE DC-BIN-DATE-1       TO OC-AH-CANCEL-DT
  8365     END-IF
  8366
  8367     display 'ah amt ' oahamto
  8368     MOVE OAHAMTO                TO WS-AMTX
  8369
  8370* EXEC CICS BIF DEEDIT
  8371*         FIELD   (WS-AMTX)
  8372*         LENGTH  (10)
  8373*    END-EXEC
  8374     MOVE 10
  8375       TO DFHEIV11
  8376*    MOVE '@"L                   #   #00007599' TO DFHEIV0
  8377     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8378     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8379     MOVE X'2020233030303037353939' TO DFHEIV0(25:11)
  8380     CALL 'kxdfhei1' USING DFHEIV0,
  8381           WS-AMTX,
  8382           DFHEIV11
  8383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8384     MOVE WS-AMTV2               TO OC-AH-CANCEL-AMT
  8385
  8386
  8387* EXEC CICS REWRITE
  8388*       DATASET   ('ELCRTO')
  8389*       FROM      (ORIGINAL-CERTIFICATE)
  8390*       RESP      (WS-RESPONSE)
  8391*    END-EXEC
  8392     MOVE LENGTH OF
  8393      ORIGINAL-CERTIFICATE
  8394       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 147
* EL6316.cbl
  8395     MOVE 'ELCRTO' TO DFHEIV1
  8396*    MOVE '&& L                  %  N#00007605' TO DFHEIV0
  8397     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8398     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8399     MOVE X'204E233030303037363035' TO DFHEIV0(25:11)
  8400     CALL 'kxdfhei1' USING DFHEIV0,
  8401           DFHEIV1,
  8402           ORIGINAL-CERTIFICATE,
  8403           DFHEIV11,
  8404           DFHEIV99
  8405     MOVE EIBRESP  TO WS-RESPONSE
  8406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8407
  8408     IF NOT RESP-NORMAL
  8409         DISPLAY 'ERROR IN 0385 REWRITING ELCRTO ' WS-RESPONSE
  8410         MOVE ER-9999      TO EMI-ERROR
  8411         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8412         GO TO 8200-SEND-DATAONLY
  8413     END-IF
  8414
  8415     PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  8416
  8417     .
  8418 0785-EXIT.
  8419     EXIT.
  8420
  8421 1000-FINALIZE.
  8422     PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  8423     IF NOT EMI-NO-ERRORS
  8424      AND EIBAID = DFHPF4
  8425        GO TO 8200-SEND-DATAONLY
  8426     END-IF
  8427     display ' made it to 1000 '
  8428     set P to address of KIXSYS
  8429     CALL "getenv" using by value P returning var-ptr
  8430     if var-ptr = null then
  8431        display ' kixsys not set '
  8432     else
  8433        set address of var to var-ptr
  8434        move 0 to env-var-len
  8435        inspect var tallying env-var-len
  8436          for characters before X'00'
  8437*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8438        unstring var (1:env-var-len) delimited by '/'
  8439           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8440              WS-KIX-SYS
  8441        end-unstring
  8442*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8443*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8444     end-if
  8445     set P to address of KIXHOST
  8446     CALL "getenv" using by value P returning var-ptr
  8447     if var-ptr = null then
  8448        display ' kixhost not set '
  8449     else
  8450        set address of var to var-ptr
  8451        move 0 to env-var-len
  8452        inspect var tallying env-var-len
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 148
* EL6316.cbl
  8453          for characters before X'00'
  8454*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8455        MOVE var(1:env-var-len)  to ws-kixhost
  8456        DISPLAY ' WS KIX HOST ' WS-KIXhost
  8457     end-if
  8458     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  8459     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  8460     IF RESP-NORMAL
  8461        AND (PI-ELCRTO-KEY (1:33) =
  8462              OC-CONTROL-PRIMARY (1:33))
  8463           DISPLAY ' RESP NORMAL AND = '
  8464           MOVE OC-ORIG-REC         TO NEW-ORIG-REC
  8465           PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  8466           PERFORM 1100-CALL-NS-BUS-LOGIC
  8467                                    THRU 1100-EXIT
  8468           IF BL-OK
  8469              CONTINUE
  8470           ELSE
  8471              MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  8472              MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  8473              MOVE -1               TO CARRL
  8474           END-IF
  8475     ELSE
  8476        MOVE ER-3829             TO EMI-ERROR
  8477        PERFORM 9900-ERROR-FORMAT
  8478                                 THRU 9900-EXIT
  8479        MOVE -1                  TO CARRL
  8480        GO TO 8100-SEND-INITIAL-MAP
  8481     END-IF
  8482     PERFORM 0390-BUILD-FROM-ERENDT THRU 0390-EXIT
  8483     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  8484                                 TO SYSO
  8485     MOVE WS-KIXHOST             TO HOSTO
  8486     MOVE PI-COMPANY-ID          TO COMPANYO
  8487     MOVE PI-PROCESSOR-ID        TO PROCIDO
  8488     IF PI-FROM-CERT = 'Y'
  8489         MOVE '2'                TO DATASORO
  8490     ELSE
  8491         MOVE '4'                TO DATASORO
  8492     END-IF
  8493     MOVE BL-BATCH-NO            TO BATCHNOO
  8494     MOVE BL-BATCH-SEQ           TO BSEQNOO
  8495     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  8496*    MOVE -1                     TO PRTSWL
  8497*    MOVE AL-UANON               TO PRTSWA
  8498     IF EIBAID = DFHPF4
  8499        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  8500        MOVE ER-0280             TO EMI-ERROR
  8501        PERFORM 9900-ERROR-FORMAT
  8502                                 THRU 9900-EXIT
  8503        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  8504        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  8505        MOVE 'Y'                 TO PI-FINALIZED-IND
  8506        GO TO 9400-CLEAR
  8507     ELSE
  8508        MOVE ER-1818             TO EMI-ERROR
  8509        PERFORM 9900-ERROR-FORMAT
  8510                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 149
* EL6316.cbl
  8511     END-IF
  8512     GO TO 8100-SEND-INITIAL-MAP
  8513     .
  8514 1000-EXIT.
  8515     EXIT.
  8516 1100-CALL-NS-BUS-LOGIC.
  8517     DISPLAY ' MADE IT TO 1100 ' w-arch-number
  8518     MOVE SPACES                 TO BL-INPUT
  8519     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  8520     IF PI-FROM-CERT = 'Y'
  8521         MOVE '2'                TO BL-DATA-SRCE
  8522         MOVE SPACES             TO BL-BATCH-NO
  8523         MOVE ZEROS              TO BL-BATCH-SEQ
  8524     ELSE
  8525         MOVE '4'                TO BL-DATA-SRCE
  8526         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  8527         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  8528     END-IF
  8529     MOVE PI-CARRIER             TO BL-CARRIER
  8530     MOVE PI-GROUPING            TO BL-GROUP
  8531     MOVE PI-STATE               TO BL-STATE
  8532     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  8533     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  8534        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  8535        MOVE ' '                 TO DC-OPTION-CODE
  8536        PERFORM 9700-date-link
  8537        IF NO-CONVERSION-ERROR
  8538           MOVE DC-GREG-DATE-B-EDIT
  8539                                 TO BL-EFF-DT
  8540        END-IF
  8541     END-IF
  8542     MOVE PI-CERT-NO             TO BL-CERT-NO
  8543     MOVE SPACES                 TO BL-RESP-NO
  8544     MOVE LTRIDI                 TO BL-LETTER-ID
  8545     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  8546     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  8547*    MOVE 'ALWA'                 TO BL-PROC-ID
  8548     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  8549     MOVE PI-ENCCODE             TO BL-ENC-CD
  8550     IF EIBAID = DFHPF4
  8551        MOVE 'B'                 TO BL-WRITE-ERARCH
  8552     ELSE
  8553        MOVE 'T'                 TO BL-WRITE-ERARCH
  8554     END-IF
  8555     MOVE SPACES                 TO BL-CERT-FORM-ID
  8556     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  8557     MOVE 'CAN ENDT'             TO BL-SOURCE-SCREEN
  8558     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  8559        IF REACD-IN (S1) NOT = LOW-VALUES
  8560           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  8561        END-IF
  8562     END-PERFORM
  8563    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  8564     DISPLAY ' BL INPUT ' BL-INPUT
  8565*****************************************
  8566* Invoke the LETTER business logic
  8567*****************************************
  8568     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 150
* EL6316.cbl
  8569     display ' srch commarea ' srch-commarea
  8570     display ' length ' ws-comm-length
  8571
  8572* exec cics link
  8573*       program('NSRASBL')
  8574*       commarea(srch-commarea)
  8575*       LENGTH  (WS-COMM-LENGTH)
  8576*    end-exec.
  8577     MOVE 'NSRASBL' TO DFHEIV1
  8578*    MOVE '."C                   (   #00007774' TO DFHEIV0
  8579     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8580     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8581     MOVE X'2020233030303037373734' TO DFHEIV0(25:11)
  8582     CALL 'kxdfhei1' USING DFHEIV0,
  8583           DFHEIV1,
  8584           srch-commarea,
  8585           WS-COMM-LENGTH,
  8586           DFHEIV99,
  8587           DFHEIV99,
  8588           DFHEIV99,
  8589           DFHEIV99
  8590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8591
  8592     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  8593        BL-MESSAGE
  8594     .
  8595 1100-EXIT.
  8596     EXIT.
  8597 1500-GET-ARCH-NO.
  8598     display ' made it to 1500 '
  8599     MOVE SPACES                 TO ELCNTL-KEY
  8600     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8601     MOVE '1'                    TO CNTL-REC-TYPE
  8602     MOVE ZEROS                  TO CNTL-SEQ
  8603
  8604* EXEC CICS READ
  8605*         DATASET    (WS-ELCNTL-FILE-ID)
  8606*         SET        (ADDRESS OF CONTROL-FILE)
  8607*         RIDFLD     (ELCNTL-KEY)
  8608*         UPDATE
  8609*         RESP       (WS-RESPONSE)
  8610*    END-EXEC
  8611*    MOVE '&"S        EU         (  N#00007790' TO DFHEIV0
  8612     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8613     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8614     MOVE X'204E233030303037373930' TO DFHEIV0(25:11)
  8615     CALL 'kxdfhei1' USING DFHEIV0,
  8616           WS-ELCNTL-FILE-ID,
  8617           DFHEIV20,
  8618           DFHEIV99,
  8619           ELCNTL-KEY,
  8620           DFHEIV99,
  8621           DFHEIV99,
  8622           DFHEIV99
  8623     SET ADDRESS OF CONTROL-FILE TO
  8624         DFHEIV20
  8625     MOVE EIBRESP  TO WS-RESPONSE
  8626     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 151
* EL6316.cbl
  8627     IF RESP-NORMAL
  8628        display ' good read elcntl '
  8629        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  8630           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8631        END-IF
  8632        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8633        MOVE CF-CREDIT-LAST-ARCH-NUM
  8634                                 TO W-ARCH-NUMBER
  8635        display ' new arch number ' w-arch-number
  8636
  8637* EXEC CICS REWRITE
  8638*          FROM      (CONTROL-FILE)
  8639*          DATASET   (WS-ELCNTL-FILE-ID)
  8640*       END-EXEC
  8641     MOVE LENGTH OF
  8642      CONTROL-FILE
  8643       TO DFHEIV11
  8644*    MOVE '&& L                  %   #00007806' TO DFHEIV0
  8645     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8646     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8647     MOVE X'2020233030303037383036' TO DFHEIV0(25:11)
  8648     CALL 'kxdfhei1' USING DFHEIV0,
  8649           WS-ELCNTL-FILE-ID,
  8650           CONTROL-FILE,
  8651           DFHEIV11,
  8652           DFHEIV99
  8653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8654     END-IF
  8655     .
  8656 1500-EXIT.
  8657     EXIT.
  8658
  8659
  8660 1700-WRITE-CERT-NOTE      SECTION.
  8661
  8662     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  8663     MOVE ZERO           TO ERCNOT-SEQ.
  8664     SET TB-INDX         DOWN BY 1.
  8665     SET TB-INDX1        TO TB-INDX.
  8666
  8667****DELETE CURRENT CERT NOTES
  8668 1700-LOOP.
  8669
  8670* EXEC CICS READ
  8671*        DATASET (WS-ERCNOT-FILE-ID)
  8672*        RIDFLD  (ERCNOT-KEY)
  8673*        SET     (ADDRESS OF CERT-NOTE-FILE)
  8674*        RESP    (WS-RESPONSE)
  8675*        GTEQ
  8676*    END-EXEC.
  8677*    MOVE '&"S        G          (  N#00007825' TO DFHEIV0
  8678     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8679     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8680     MOVE X'204E233030303037383235' TO DFHEIV0(25:11)
  8681     CALL 'kxdfhei1' USING DFHEIV0,
  8682           WS-ERCNOT-FILE-ID,
  8683           DFHEIV20,
  8684           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 152
* EL6316.cbl
  8685           ERCNOT-KEY,
  8686           DFHEIV99,
  8687           DFHEIV99,
  8688           DFHEIV99
  8689     SET ADDRESS OF CERT-NOTE-FILE TO
  8690         DFHEIV20
  8691     MOVE EIBRESP  TO WS-RESPONSE
  8692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8693
  8694
  8695     IF NOT RESP-NORMAL
  8696        GO TO 1700-ENDDEL
  8697     END-IF
  8698
  8699     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  8700
  8701     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  8702         GO TO 1700-ENDDEL
  8703     END-IF.
  8704
  8705
  8706* EXEC CICS DELETE
  8707*        DATASET (WS-ERCNOT-FILE-ID)
  8708*        RIDFLD  (ERCNOT-KEY)
  8709*    END-EXEC.
  8710*    MOVE '&(  R                 &   #00007843' TO DFHEIV0
  8711     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8712     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8713     MOVE X'2020233030303037383433' TO DFHEIV0(25:11)
  8714     CALL 'kxdfhei1' USING DFHEIV0,
  8715           WS-ERCNOT-FILE-ID,
  8716           ERCNOT-KEY,
  8717           DFHEIV99,
  8718           DFHEIV99,
  8719           DFHEIV99
  8720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8721
  8722
  8723     GO TO 1700-LOOP.
  8724
  8725 1700-ENDDEL.
  8726
  8727
  8728* EXEC CICS GETMAIN
  8729*         LENGTH(ERCNOT-LENGTH)
  8730*         SET(ADDRESS OF CERT-NOTE-FILE)
  8731*         INITIMG(GETMAIN-SPACE)
  8732*    END-EXEC.
  8733*    MOVE ',"IL                  $   #00007852' TO DFHEIV0
  8734     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8735     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8736     MOVE X'2020233030303037383532' TO DFHEIV0(25:11)
  8737     CALL 'kxdfhei1' USING DFHEIV0,
  8738           DFHEIV20,
  8739           ERCNOT-LENGTH,
  8740           GETMAIN-SPACE
  8741     SET ADDRESS OF CERT-NOTE-FILE TO
  8742         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 153
* EL6316.cbl
  8743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8744
  8745
  8746     SET TB-INDX TO 1.
  8747     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8748     MOVE +0             TO ERCNOT-SEQ
  8749
  8750     PERFORM VARYING TB-INDX FROM 1 BY 1
  8751             UNTIL TB-INDX > TB-INDX1
  8752        MOVE SPACES                 TO  CERT-NOTE-FILE
  8753        ADD 1                       TO  ERCNOT-SEQ
  8754        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8755        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8756        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8757        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8758                                    TO  CZ-LAST-MAINT-USER
  8759        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8760                                    TO  CZ-LAST-MAINT-HHMMSS
  8761        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8762                                    TO  CZ-LAST-MAINT-DT
  8763
  8764
  8765* EXEC CICS WRITE
  8766*            DATASET(WS-ERCNOT-FILE-ID)
  8767*            FROM(CERT-NOTE-FILE)
  8768*            RIDFLD(ERCNOT-KEY)
  8769*       END-EXEC
  8770     MOVE LENGTH OF
  8771      CERT-NOTE-FILE
  8772       TO DFHEIV11
  8773*    MOVE '&$ L                  ''   #00007876' TO DFHEIV0
  8774     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8775     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8776     MOVE X'2020233030303037383736' TO DFHEIV0(25:11)
  8777     CALL 'kxdfhei1' USING DFHEIV0,
  8778           WS-ERCNOT-FILE-ID,
  8779           CERT-NOTE-FILE,
  8780           DFHEIV11,
  8781           ERCNOT-KEY,
  8782           DFHEIV99,
  8783           DFHEIV99
  8784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8785     END-PERFORM
  8786
  8787     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8788     IF RESP-NORMAL
  8789        EVALUATE CM-NOTE-SW
  8790           WHEN '1'
  8791           WHEN '3'
  8792           WHEN '5'
  8793           WHEN '7'
  8794              SET NO-CERT-RW     TO TRUE
  8795           WHEN ' '
  8796              MOVE '1'           TO CM-NOTE-SW
  8797           WHEN '2'
  8798              MOVE '3'           TO CM-NOTE-SW
  8799           WHEN '4'
  8800              MOVE '5'           TO CM-NOTE-SW
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 154
* EL6316.cbl
  8801           WHEN '6'
  8802              MOVE '7'           TO CM-NOTE-SW
  8803        END-EVALUATE
  8804     END-IF
  8805     IF NOT NO-CERT-RW
  8806        PERFORM 1810-REWRITE-ELCERT
  8807                                 THRU 1810-EXIT
  8808     ELSE
  8809
  8810* EXEC CICS UNLOCK
  8811*          DATASET    (WS-ELCERT-FILE-ID)
  8812*       END-EXEC
  8813*    MOVE '&*                    #   #00007905' TO DFHEIV0
  8814     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8815     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8816     MOVE X'2020233030303037393035' TO DFHEIV0(25:11)
  8817     CALL 'kxdfhei1' USING DFHEIV0,
  8818           WS-ELCERT-FILE-ID,
  8819           DFHEIV99
  8820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8821     END-IF
  8822
  8823     .
  8824 1799-EXIT.
  8825     EXIT.
  8826
  8827 1800-READ-ELCERT-UPDATE.
  8828
  8829     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8830     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8831     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8832     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8833     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8834     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8835     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8836     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8837
  8838
  8839* EXEC CICS READ
  8840*        UPDATE
  8841*        DATASET  (WS-ELCERT-FILE-ID)
  8842*        RIDFLD   (WS-ELCERT-KEY)
  8843*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8844*        RESP     (WS-RESPONSE)
  8845*    END-EXEC
  8846*    MOVE '&"S        EU         (  N#00007925' TO DFHEIV0
  8847     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8848     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8849     MOVE X'204E233030303037393235' TO DFHEIV0(25:11)
  8850     CALL 'kxdfhei1' USING DFHEIV0,
  8851           WS-ELCERT-FILE-ID,
  8852           DFHEIV20,
  8853           DFHEIV99,
  8854           WS-ELCERT-KEY,
  8855           DFHEIV99,
  8856           DFHEIV99,
  8857           DFHEIV99
  8858     SET ADDRESS OF CERTIFICATE-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 155
* EL6316.cbl
  8859         DFHEIV20
  8860     MOVE EIBRESP  TO WS-RESPONSE
  8861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8862
  8863     .
  8864 1800-EXIT.
  8865     EXIT.
  8866
  8867 1810-REWRITE-ELCERT.
  8868
  8869
  8870* EXEC CICS REWRITE
  8871*        FROM     (CERTIFICATE-MASTER)
  8872*        DATASET  (WS-ELCERT-FILE-ID)
  8873*        RESP     (WS-RESPONSE)
  8874*    END-EXEC.
  8875     MOVE LENGTH OF
  8876      CERTIFICATE-MASTER
  8877       TO DFHEIV11
  8878*    MOVE '&& L                  %  N#00007939' TO DFHEIV0
  8879     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8880     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8881     MOVE X'204E233030303037393339' TO DFHEIV0(25:11)
  8882     CALL 'kxdfhei1' USING DFHEIV0,
  8883           WS-ELCERT-FILE-ID,
  8884           CERTIFICATE-MASTER,
  8885           DFHEIV11,
  8886           DFHEIV99
  8887     MOVE EIBRESP  TO WS-RESPONSE
  8888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8889
  8890
  8891     .
  8892 1810-EXIT.
  8893     EXIT.
  8894
  8895 8100-SEND-INITIAL-MAP.
  8896     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8897     MOVE '5'                    TO DC-OPTION-CODE.
  8898     PERFORM 9700-DATE-LINK.
  8899     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8900     MOVE EIBTIME                TO TIME-IN.
  8901     MOVE TIME-OUT               TO TIMEO.
  8902     MOVE -1                     TO LTRIDL
  8903*    MOVE AL-UANON               TO PRTSWA
  8904     IF PI-PROCESSOR-IS-CSR-SUPER
  8905      AND PI-ENDORSE-RECORD NOT EQUAL 'Y'
  8906        perform varying s1 from +1 by +1 until
  8907           s1 > +12
  8908           MOVE AL-UANON            TO reacda (s1)
  8909        end-perform
  8910     END-IF
  8911
  8912     IF PI-FROM-CERT = 'Y' AND
  8913        PI-PROCESSOR-IS-CSR-SUPER AND
  8914        PI-ENDORSE-RECORD NOT EQUAL 'Y'
  8915            MOVE AL-UNNON        TO OLFDTA
  8916                                    OAHDTA
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 156
* EL6316.cbl
  8917                                    OLFAMTA
  8918                                    OAHAMTA
  8919     END-IF
  8920
  8921     IF PI-FROM-CERT = 'Y' AND
  8922        NOT PI-PROCESSOR-IS-CSR-SUPER
  8923            MOVE AL-SANOF        TO LTRIDA
  8924                                    ENCCODEA
  8925                                    CRTNT1A
  8926                                    CRTNT2A
  8927                                    BILNT1A
  8928            MOVE AL-SADOF        TO PF3A
  8929                                    PF4A
  8930     END-IF
  8931
  8932     IF PI-ENDORSE-RECORD = 'Y'
  8933            MOVE AL-SANOF        TO LTRIDA
  8934                                    ENCCODEA
  8935                                    CRTNT1A
  8936                                    CRTNT2A
  8937                                    BILNT1A
  8938            MOVE AL-SADOF        TO PF3A
  8939                                    PF4A
  8940     END-IF
  8941     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  8942
  8943* EXEC CICS SEND
  8944*        MAP      (MAP-NAME)
  8945*        MAPSET   (MAPSET-NAME)
  8946*        FROM     (EL631IO)
  8947*        ERASE
  8948*        CURSOR
  8949*    END-EXEC.
  8950     MOVE LENGTH OF
  8951      EL631IO
  8952       TO DFHEIV12
  8953     MOVE -1
  8954       TO DFHEIV11
  8955*    MOVE '8$     CT  E    H L F ,   #00007996' TO DFHEIV0
  8956     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8957     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8958     MOVE X'2020233030303037393936' TO DFHEIV0(25:11)
  8959     CALL 'kxdfhei1' USING DFHEIV0,
  8960           MAP-NAME,
  8961           EL631IO,
  8962           DFHEIV12,
  8963           MAPSET-NAME,
  8964           DFHEIV99,
  8965           DFHEIV99,
  8966           DFHEIV99,
  8967           DFHEIV11,
  8968           DFHEIV99,
  8969           DFHEIV99,
  8970           DFHEIV99
  8971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8972
  8973     GO TO 9100-RETURN-TRAN.
  8974 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 157
* EL6316.cbl
  8975     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8976     MOVE '5'                    TO DC-OPTION-CODE.
  8977     PERFORM 9700-DATE-LINK.
  8978     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8979     MOVE EIBTIME                TO TIME-IN.
  8980     MOVE TIME-OUT               TO TIMEO.
  8981     MOVE -1                     TO PFENTRL
  8982     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
  8983
  8984* EXEC CICS SEND
  8985*        MAP      (MAP-NAME)
  8986*        MAPSET   (MAPSET-NAME)
  8987*        FROM     (EL631IO)
  8988*        DATAONLY
  8989*        ERASEAUP
  8990*        CURSOR
  8991*    END-EXEC.
  8992     MOVE LENGTH OF
  8993      EL631IO
  8994       TO DFHEIV12
  8995     MOVE -1
  8996       TO DFHEIV11
  8997*    MOVE '8$D    CT  A    H L F ,   #00008013' TO DFHEIV0
  8998     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8999     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9000     MOVE X'2020233030303038303133' TO DFHEIV0(25:11)
  9001     CALL 'kxdfhei1' USING DFHEIV0,
  9002           MAP-NAME,
  9003           EL631IO,
  9004           DFHEIV12,
  9005           MAPSET-NAME,
  9006           DFHEIV99,
  9007           DFHEIV99,
  9008           DFHEIV99,
  9009           DFHEIV11,
  9010           DFHEIV99,
  9011           DFHEIV99,
  9012           DFHEIV99
  9013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9014
  9015     GO TO 9100-RETURN-TRAN.
  9016 8300-SEND-TEXT.
  9017
  9018* EXEC CICS SEND TEXT
  9019*        FROM     (LOGOFF-TEXT)
  9020*        LENGTH   (LOGOFF-LENGTH)
  9021*        ERASE
  9022*        FREEKB
  9023*    END-EXEC.
  9024*    MOVE '8&      T  E F  H   F -   #00008023' TO DFHEIV0
  9025     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9026     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9027     MOVE X'2020233030303038303233' TO DFHEIV0(25:11)
  9028     CALL 'kxdfhei1' USING DFHEIV0,
  9029           LOGOFF-TEXT,
  9030           LOGOFF-LENGTH,
  9031           DFHEIV99,
  9032           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 158
* EL6316.cbl
  9033           DFHEIV99,
  9034           DFHEIV99,
  9035           DFHEIV99,
  9036           DFHEIV99,
  9037           DFHEIV99,
  9038           DFHEIV99,
  9039           DFHEIV99,
  9040           DFHEIV99
  9041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9042
  9043
  9044* EXEC CICS RETURN
  9045*    END-EXEC.
  9046*    MOVE '.(                    ''   #00008029' TO DFHEIV0
  9047     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9048     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9049     MOVE X'2020233030303038303239' TO DFHEIV0(25:11)
  9050     CALL 'kxdfhei1' USING DFHEIV0,
  9051           DFHEIV99,
  9052           DFHEIV99,
  9053           DFHEIV99,
  9054           DFHEIV99,
  9055           DFHEIV99,
  9056           DFHEIV99
  9057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9058
  9059 8800-UNAUTHORIZED-ACCESS.
  9060     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  9061     GO TO 8300-SEND-TEXT.
  9062 8810-PF23.
  9063     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  9064     MOVE XCTL-005               TO PGM-NAME.
  9065     GO TO 9300-XCTL.
  9066 9000-RETURN-CICS.
  9067
  9068* EXEC CICS RETURN
  9069*    END-EXEC.
  9070*    MOVE '.(                    ''   #00008039' TO DFHEIV0
  9071     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9072     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9073     MOVE X'2020233030303038303339' TO DFHEIV0(25:11)
  9074     CALL 'kxdfhei1' USING DFHEIV0,
  9075           DFHEIV99,
  9076           DFHEIV99,
  9077           DFHEIV99,
  9078           DFHEIV99,
  9079           DFHEIV99,
  9080           DFHEIV99
  9081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9082
  9083 9100-RETURN-TRAN.
  9084     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  9085     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  9086
  9087* EXEC CICS RETURN
  9088*        TRANSID    (TRANS-ID)
  9089*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9090*        LENGTH     (1300)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 159
* EL6316.cbl
  9091*    END-EXEC.
  9092     MOVE 1300
  9093       TO DFHEIV11
  9094*    MOVE '.(CT                  ''   #00008044' TO DFHEIV0
  9095     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9096     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9097     MOVE X'2020233030303038303434' TO DFHEIV0(25:11)
  9098     CALL 'kxdfhei1' USING DFHEIV0,
  9099           TRANS-ID,
  9100           PROGRAM-INTERFACE-BLOCK,
  9101           DFHEIV11,
  9102           DFHEIV99,
  9103           DFHEIV99,
  9104           DFHEIV99
  9105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9106
  9107 9200-RETURN-MAIN-MENU.
  9108     MOVE XCTL-626               TO PGM-NAME.
  9109     GO TO 9300-XCTL.
  9110 9300-XCTL.
  9111
  9112* EXEC CICS XCTL
  9113*        PROGRAM    (PGM-NAME)
  9114*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9115*        LENGTH     (1300)
  9116*    END-EXEC.
  9117     MOVE 1300
  9118       TO DFHEIV11
  9119*    MOVE '.$C                   %   #00008053' TO DFHEIV0
  9120     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9121     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9122     MOVE X'2020233030303038303533' TO DFHEIV0(25:11)
  9123     CALL 'kxdfhei1' USING DFHEIV0,
  9124           PGM-NAME,
  9125           PROGRAM-INTERFACE-BLOCK,
  9126           DFHEIV11,
  9127           DFHEIV99
  9128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9129
  9130 9400-CLEAR.
  9131     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  9132
  9133* EXEC CICS XCTL
  9134*        PROGRAM    (PGM-NAME)
  9135*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9136*        LENGTH     (1300)
  9137*    END-EXEC.
  9138     MOVE 1300
  9139       TO DFHEIV11
  9140*    MOVE '.$C                   %   #00008060' TO DFHEIV0
  9141     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9142     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9143     MOVE X'2020233030303038303630' TO DFHEIV0(25:11)
  9144     CALL 'kxdfhei1' USING DFHEIV0,
  9145           PGM-NAME,
  9146           PROGRAM-INTERFACE-BLOCK,
  9147           DFHEIV11,
  9148           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 160
* EL6316.cbl
  9149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9150
  9151 9500-PF12.
  9152     MOVE XCTL-010               TO PGM-NAME.
  9153     GO TO 9300-XCTL.
  9154 9600-PGMID-ERROR.
  9155
  9156* EXEC CICS HANDLE CONDITION
  9157*        PGMIDERR    (8300-SEND-TEXT)
  9158*    END-EXEC.
  9159*    MOVE '"$L                   ! " #00008069' TO DFHEIV0
  9160     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9161     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9162     MOVE X'2220233030303038303639' TO DFHEIV0(25:11)
  9163     CALL 'kxdfhei1' USING DFHEIV0
  9164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9165
  9166     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  9167     MOVE ' '                    TO PI-ENTRY-CD-1.
  9168     MOVE XCTL-005               TO PGM-NAME.
  9169     MOVE PGM-NAME               TO LOGOFF-PGM.
  9170     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  9171     GO TO 9300-XCTL.
  9172 9700-DATE-LINK.
  9173     MOVE LINK-ELDATCV           TO PGM-NAME.
  9174
  9175* EXEC CICS LINK
  9176*        PROGRAM    (PGM-NAME)
  9177*        COMMAREA   (DATE-CONVERSION-DATA)
  9178*        LENGTH     (DC-COMM-LENGTH)
  9179*    END-EXEC.
  9180*    MOVE '."C                   (   #00008080' TO DFHEIV0
  9181     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9182     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9183     MOVE X'2020233030303038303830' TO DFHEIV0(25:11)
  9184     CALL 'kxdfhei1' USING DFHEIV0,
  9185           PGM-NAME,
  9186           DATE-CONVERSION-DATA,
  9187           DC-COMM-LENGTH,
  9188           DFHEIV99,
  9189           DFHEIV99,
  9190           DFHEIV99,
  9191           DFHEIV99
  9192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9193
  9194 9900-ERROR-FORMAT.
  9195     IF NOT EMI-ERRORS-COMPLETE
  9196        MOVE LINK-001            TO PGM-NAME
  9197
  9198* EXEC CICS LINK
  9199*           PROGRAM    (PGM-NAME)
  9200*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  9201*           LENGTH     (EMI-COMM-LENGTH)
  9202*       END-EXEC
  9203*    MOVE '."C                   (   #00008088' TO DFHEIV0
  9204     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9206     MOVE X'2020233030303038303838' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 161
* EL6316.cbl
  9207     CALL 'kxdfhei1' USING DFHEIV0,
  9208           PGM-NAME,
  9209           ERROR-MESSAGE-INTERFACE-BLOCK,
  9210           EMI-COMM-LENGTH,
  9211           DFHEIV99,
  9212           DFHEIV99,
  9213           DFHEIV99,
  9214           DFHEIV99
  9215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9216     END-IF
  9217     .
  9218 9900-EXIT.
  9219     EXIT.
  9220 9990-ABEND.
  9221     MOVE LINK-004               TO PGM-NAME.
  9222     MOVE DFHEIBLK               TO EMI-LINE1.
  9223
  9224* EXEC CICS LINK
  9225*        PROGRAM   (PGM-NAME)
  9226*        COMMAREA  (EMI-LINE1)
  9227*        LENGTH    (72)
  9228*    END-EXEC.
  9229     MOVE 72
  9230       TO DFHEIV11
  9231*    MOVE '."C                   (   #00008100' TO DFHEIV0
  9232     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9234     MOVE X'2020233030303038313030' TO DFHEIV0(25:11)
  9235     CALL 'kxdfhei1' USING DFHEIV0,
  9236           PGM-NAME,
  9237           EMI-LINE1,
  9238           DFHEIV11,
  9239           DFHEIV99,
  9240           DFHEIV99,
  9241           DFHEIV99,
  9242           DFHEIV99
  9243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9244
  9245     GO TO 8200-SEND-DATAONLY.
  9246
  9247* GOBACK.
  9248     MOVE '9%                    "   ' TO DFHEIV0
  9249     MOVE 'EL6316' TO DFHEIV1
  9250     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9251     GOBACK.
  9252 9995-SECURITY-VIOLATION.
  9253*                            COPY ELCSCTP.
  9254******************************************************************
  9255*                                                                *
  9256*                            ELCSCTP                             *
  9257*                            VMOD=2.001                          *
  9258*                                                                *
  9259*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9260******************************************************************
  9261
  9262
  9263     MOVE EIBDATE          TO SM-JUL-DATE.
  9264     MOVE EIBTRMID         TO SM-TERMID.
* Micro Focus Server Express         V5.1 revision 000 10-Feb-14 09:53 Page 162
* EL6316.cbl
  9265     MOVE THIS-PGM         TO SM-PGM.
  9266     MOVE EIBTIME          TO TIME-IN.
  9267     MOVE TIME-OUT         TO SM-TIME.
  9268     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9269
  9270
  9271* EXEC CICS LINK
  9272*         PROGRAM  ('EL003')
  9273*         COMMAREA (SECURITY-MESSAGE)
  9274*         LENGTH   (80)
  9275*    END-EXEC.
  9276     MOVE 'EL003' TO DFHEIV1
  9277     MOVE 80
  9278       TO DFHEIV11
  9279*    MOVE '."C                   (   #00008125' TO DFHEIV0
  9280     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9281     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9282     MOVE X'2020233030303038313235' TO DFHEIV0(25:11)
  9283     CALL 'kxdfhei1' USING DFHEIV0,
  9284           DFHEIV1,
  9285           SECURITY-MESSAGE,
  9286           DFHEIV11,
  9287           DFHEIV99,
  9288           DFHEIV99,
  9289           DFHEIV99,
  9290           DFHEIV99
  9291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9292
  9293
  9294******************************************************************
  9295
  9296 9995-EXIT.
  9297     EXIT.
  9298
  9299 9999-DFHBACK SECTION.
  9300     MOVE '9%                    "   ' TO DFHEIV0
  9301     MOVE 'EL6316' TO DFHEIV1
  9302     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9303     GOBACK.
  9304 9999-DFHEXIT.
  9305     IF DFHEIGDJ EQUAL 0001
  9306         NEXT SENTENCE
  9307     ELSE IF DFHEIGDJ EQUAL 2
  9308         GO TO 8300-SEND-TEXT
  9309         DEPENDING ON DFHEIGDI.
  9310     MOVE '9%                    "   ' TO DFHEIV0
  9311     MOVE 'EL6316' TO DFHEIV1
  9312     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9313     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34680     Code:       23632
