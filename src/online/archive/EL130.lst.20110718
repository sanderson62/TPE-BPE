* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   1
* EL130.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL130.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   2
* EL130.cbl
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32******************************************************************
    33
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   3
* EL130.cbl
    35 ENVIRONMENT DIVISION.
    36 DATA DIVISION.
    37 WORKING-STORAGE SECTION.
    38 01  DFH-START PIC X(04).
    39 77  FILLER  PIC X(32)  VALUE '********************************'.
    40 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    41 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    42
    43*    COPY ELCSCTM.
    44******************************************************************
    45*                                                                *
    46*                                                                *
    47*                            ELCSCTM                             *
    48*                            VMOD=2.001                          *
    49*                                                                *
    50*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    51*                                                                *
    52******************************************************************
    53 01  SECURITY-MESSAGE.
    54     12  FILLER                          PIC X(30)
    55            VALUE '** LOGIC SECURITY VIOLATION -'.
    56     12  SM-READ                         PIC X(6).
    57     12  FILLER                          PIC X(5)
    58            VALUE ' PGM='.
    59     12  SM-PGM                          PIC X(6).
    60     12  FILLER                          PIC X(5)
    61            VALUE ' OPR='.
    62     12  SM-PROCESSOR-ID                 PIC X(4).
    63     12  FILLER                          PIC X(6)
    64            VALUE ' TERM='.
    65     12  SM-TERMID                       PIC X(4).
    66     12  FILLER                          PIC XX   VALUE SPACE.
    67     12  SM-JUL-DATE                     PIC 9(5).
    68     12  FILLER                          PIC X    VALUE SPACE.
    69     12  SM-TIME                         PIC 99.99.
    70
    71
    72*    COPY ELCSCRTY.
    73******************************************************************
    74*                                                                *
    75*                                                                *
    76*                            ELCSCRTY                            *
    77*                            VMOD=2.001                          *
    78*                                                                *
    79*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    80*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    81*        SAVED IN PI-SECURITY-ADDRESS.                           *
    82*                                                                *
    83******************************************************************
    84 01  SECURITY-CONTROL.
    85     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    86     12  FILLER                       PIC XX    VALUE 'SC'.
    87     12  SC-CREDIT-CODES.
    88         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    89             20  SC-CREDIT-DISPLAY    PIC X.
    90             20  SC-CREDIT-UPDATE     PIC X.
    91     12  SC-CLAIMS-CODES.
    92         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   4
* EL130.cbl
    93             20  SC-CLAIMS-DISPLAY    PIC X.
    94             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   5
* EL130.cbl
    96 01  WS-DATE-AREA.
    97     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    98     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    99     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   100
   101 01  WS-CRI-SSN-WORK-AREA.
   102     05  WS-CRI-SOC-SEC-NO.
   103         10  WS-SS-REPT-CD       PIC X(5).
   104         10  WS-SS-LAST-NAME     PIC X(5).
   105         10  WS-SS-INITIAL       PIC X.
   106
   107     05  WS-CRI-REPORT-CODE.
   108         10  FILLER              PIC X(5).
   109         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   110
   111     05  WS-CRI-LAST-NAME.
   112         10  WS-CRI-NAME-MOVE    PIC X(5).
   113         10  FILLER              PIC X(10).
   114
   115 01  STANDARD-AREAS.
   116     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   117     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   118     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   119     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   120     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   121     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   122     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   123     12  PGM-NAME            PIC X(8).
   124     12  TIME-IN             PIC S9(7).
   125     12  TIME-OUT-R  REDEFINES TIME-IN.
   126         16  FILLER          PIC X.
   127         16  TIME-OUT        PIC 99V99.
   128         16  FILLER          PIC X(2).
   129     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   130     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   131     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   132     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   133     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   134     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   135     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   136     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   137     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   138     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   139     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   140     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   141     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   142     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   143     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   144     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   145     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   146     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   147     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   148     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   149     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   150     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
   151     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   152     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   153     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   6
* EL130.cbl
   154     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   155     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   156     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   157     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   158     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   159     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   160     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   161     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   162     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   163     12  FILE-ID             PIC X(8).
   164     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   165     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   166     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   167     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   168     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   169     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   170     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   171     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   172     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +550.
   173
   174 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   175     12  M                   PIC S9(7)V99           VALUE ZEROS.
   176     12  L                   PIC S9(7)V99           VALUE ZEROS.
   177     12  N                   PIC S9(3)              VALUE ZEROS.
   178     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   179     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   180     12  I                   PIC S99V9(5)           VALUE ZEROS.
   181     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   182     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   183     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   184     12  R                   PIC S9(3)              VALUE ZEROS.
   185     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   186     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   187     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   188     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   189     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   190     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   191     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   192     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   193     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   194
   195 01  TERM-CALC-WORK-AREA.
   196     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   197     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   198     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   199     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   200     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   201     12  V-EXPONENTS.
   202        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   203     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   204
   205 01  MISC-WORK-AREAS.
   206     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   207     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   208     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
   209     12  QID.
   210         16  QID-TERM        PIC X(4).
   211         16  FILLER          PIC X(4)    VALUE '130A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   7
* EL130.cbl
   212     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   213     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   214     12  WS-GROUP-NO.
   215         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   216         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   217
   218     12  WS-RESPONSE         PIC S9(8)   COMP.
   219         88  WS-RESP-NORMAL              VALUE +00.
   220         88  WS-RESP-ERROR               VALUE +01.
   221         88  WS-RESP-NOTFND              VALUE +13.
   222
   223***************************************************************
   224*                                                             *
   225*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   226*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   227*    CHANGES WITH IN MAP EL130A.                              *
   228*                                                             *
   229***************************************************************
   230
   231     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   232     12  WS-SAVE-CLAIM-MASTER.
   233         16  FILLER                    PIC XX.
   234         16  WS-SAVE-CLAIM-KEY.
   235             20  WS-SAVE-COMPANY-CD    PIC X.
   236             20  WS-SAVE-CARRIER       PIC X.
   237             20  WS-SAVE-CLAIM-NO      PIC X(7).
   238             20  WS-SAVE-CERT-NO       PIC X(11).
   239         16  FILLER                    PIC X(328).
   240     12  SAVE-CURRENT-DATE         PIC XX.
   241     12  SAVE-CONTROL              PIC X(39).
   242     12  SAVE-ERACCT-KEY           PIC X(26).
   243     12  SAVE-COUNTER              PIC S9(8)   COMP.
   244     12  SAVE-METHOD               PIC X.
   245     12  SAVE-COMPANY-ID           PIC XXX.
   246     12  SAVE-COMPANY-CD           PIC X.
   247     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   248     12  SAVE-CREDIT-USER          PIC X.
   249     12  SAVE-CLAIM-USER           PIC X.
   250     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   251     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   252     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   253     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   254     12  SAVE-AH-OVERRIDE-L1       PIC X.
   255     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   256     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   257     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   258     12  FILLER                    PIC X.
   259*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   260     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   261     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   262     12  SAVE-EL127-TO-EL130-CNTRL.
   263         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
   264         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   265         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   266             20  SAVE-EL127-CARRIER  PIC X.
   267             20  SAVE-EL127-GROUPING PIC X(6).
   268             20  SAVE-EL127-STATE    PIC X(2).
   269             20  SAVE-EL127-ACCOUNT  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   8
* EL130.cbl
   270             20  SAVE-EL127-CERT-NO  PIC X(11).
   271             20  SAVE-EL127-EFF-DT   PIC XX.
   272     12  SAVE-EL659-TO-EL130-CNTRL.
   273         16  SAVE-EL659-CARRIER    PIC X.
   274         16  SAVE-EL659-GROUPING   PIC X(6).
   275         16  SAVE-EL659-STATE      PIC XX.
   276         16  SAVE-EL659-ACCOUNT    PIC X(10).
   277     12  DIVIDE-QUOT               PIC 999.
   278     12  DIVIDE-REM                PIC 999.
   279     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   280     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   281     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   282     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   283     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   284     12  WS-RESERVE-CONTROLS       PIC X(9).
   285     12  WS-EXPENSE-CONTROLS       PIC X(7).
   286     12  WS-REIN-TABLE.
   287         16  WS-REIN-1             PIC X            VALUE SPACE.
   288         16  WS-REIN-2             PIC X            VALUE SPACE.
   289         16  WS-REIN-3             PIC X            VALUE SPACE.
   290     12  WS-BENE-CALC-METHOD       PIC X.
   291     12  WS-EARNINGS-CALC          PIC X.
   292     12  WS-LF-EARNINGS-CALC       PIC X.
   293         88 TEX-REG                VALUE '4'.
   294         88 NET-PAY                VALUE '5'.
   295     12  WS-AH-EARNINGS-CALC       PIC X.
   296     12  WS-SPECIAL-CALC-CD        PIC X(01).
   297     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   298     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   299     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   300     12  WS-CLAIM-NUMBER.
   301         16  WS-CN-PREFIX.
   302             20  WS-CN-PRF-A PIC X.
   303             20  WS-CN-PRF-B PIC X.
   304         16  WS-CN-NUMBER    PIC 9(5).
   305     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   306     12  WS-CLAIM-SEQU.
   307         16  FILLER          PIC X    VALUE '('.
   308         16  WS-CURRENT-SEQU PIC Z9.
   309         16  FILLER          PIC X(4) VALUE ' OF '.
   310         16  WS-OF-SEQU      PIC Z9.
   311         16  FILLER          PIC X    VALUE ')'.
   312     12  DATE-WORK.
   313       14  FILLER                PIC XX.
   314       14  DATE-MM               PIC XX.
   315       14  DATE-DD               PIC XX.
   316       14  DATE-YY               PIC XX.
   317     12  CURR-DATE REDEFINES DATE-WORK.
   318         16  CURR-MM.
   319           18  CURR-M1           PIC 9.
   320           18  CURR-M2           PIC 9.
   321         16  FILLER              PIC X(5).
   322         16  CURR-YEAR           PIC 9.
   323     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   324     12  SUB                     PIC 99.
   325     12  MY-DATE.
   326         16  MY-MM               PIC XX.
   327         16  FILLER              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page   9
* EL130.cbl
   328         16  MY-YY               PIC XX.
   329
   330     12  WS-EDIT-BEN-CODE        PIC XX.
   331         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   332                                          '90' THRU '99'.
   333
   334     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   335     12  WS-BEN-HOLD             PIC XX.
   336     12  WS-BEN-ALPHA-HOLD.
   337         15  WS-BEN-ALPHA-2      PIC XX.
   338         15  WS-BEN-ALPHA-1      PIC X.
   339     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   340     12  WS-REC-TYPE             PIC X.
   341     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   342     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   343     12  ARCH-NUMBER             PIC S9(8)   COMP.
   344     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   345         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   346         88  REIN-REC-FOUND                  VALUE 'Y'.
   347
   348     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   349     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   350
   351
   352 01  CSO-WORK-FIELDS.
   353     12  WS-BLANK            PIC X       VALUE ' '.
   354
   355     12  WS-MA-CONTROL-PRIMARY.
   356         16  WS-MA-COMPANY-CD        PIC  X.
   357         16  WS-MA-CARRIER           PIC  X.
   358         16  WS-MA-GROUPING          PIC  X(6).
   359         16  WS-MA-STATE             PIC  XX.
   360         16  WS-MA-ACCOUNT           PIC  X(10).
   361         16  WS-MA-CERT-EFF-DT       PIC  XX.
   362         16  WS-MA-CERT-NO.
   363             20  WS-MA-CERT-PRIME    PIC  X(10).
   364             20  WS-MA-CERT-SFX      PIC  X.
   365
   366     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   367     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   368     12  WS-SOC-SEC-NUMBER.
   369         16  WS-SOC-SEC-NO       PIC 9(9).
   370         16  WS-SOC-SEC-BLANK    PIC X(2).
   371     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   372         16  WS-SSN-1-3          PIC 9(3).
   373         16  WS-SSN-DASH1        PIC X(1).
   374         16  WS-SSN-4-5          PIC 9(2).
   375         16  WS-SSN-DASH2        PIC X(1).
   376         16  WS-SSN-6-9          PIC 9(4).
   377
   378     12  WS-DIAG-VIN-MSG.
   379         16  FILLER          PIC X(11)
   380             VALUE 'VIN NUMBER '.
   381         16  WS-DIAG-VIN     PIC X(17).
   382
   383 01  MAP-DATE-AREAS.
   384     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   385     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  10
* EL130.cbl
   386     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   387     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   388     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   389     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   390     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   391     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   392     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   393     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   394     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   395     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   396     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   397     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   398     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   399     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   400     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   401     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   402     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   403         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   404     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   405     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   406     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   407     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   408
   409 01  ACCESS-KEYS.
   410     12  ELACTQ-KEY.
   411         16  ELACTQ-COMPANY-CD       PIC X.
   412         16  ELACTQ-CARRIER          PIC X.
   413         16  ELACTQ-CLAIM-NO         PIC X(7).
   414         16  ELACTQ-CERT-NO          PIC X(11).
   415     12  ELMSTR-KEY.
   416         16  MSTR-COMP-CD            PIC X.
   417         16  MSTR-CARRIER            PIC X.
   418         16  MSTR-CLAIM-NO           PIC X(7).
   419         16  MSTR-CERT-NO.
   420             20  MSTR-CERT-NO-PRIME  PIC X(10).
   421             20  MSTR-CERT-NO-SUFX   PIC X.
   422     12  SAVE-ELMSTR-KEY.
   423         16  SAVE-COMP-CD            PIC X.
   424         16  SAVE-CARRIER            PIC X.
   425         16  SAVE-CLAIM-NO           PIC X(7).
   426         16  SAVE-CERT-NO.
   427             20  SAVE-CERT-NO-PRIME  PIC X(10).
   428             20  SAVE-CERT-NO-SUFX   PIC X.
   429     12  ELMSTR5-KEY.
   430         16  MSTR5-COMP-CD           PIC X.
   431         16  MSTR5-CERT-NO.
   432             20  MSTR5-CERT-NO-PRIME PIC X(10).
   433             20  MSTR5-CERT-NO-SUFX  PIC X.
   434     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   435         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   436         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   437         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   438     12  ELCNTL-KEY.
   439         16  CNTL-COMP-ID    PIC X(3).
   440         16  CNTL-REC-TYPE   PIC X.
   441         16  CNTL-ACCESS.
   442             20  FILLER      PIC XX.
   443             20  CNTL-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  11
* EL130.cbl
   444                 24  FILLER  PIC X.
   445                 24  CNTL-CARRIER PIC X.
   446         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   447     12  ELCERT-KEY.
   448         16  CERT-COMP-CD    PIC X.
   449         16  CERT-CARRIER    PIC X.
   450         16  CERT-GROUPING   PIC X(6).
   451         16  CERT-STATE      PIC X(2).
   452         16  CERT-ACCOUNT.
   453             20  CERT-ACCOUNT-PREFIX PIC X(4).
   454             20  CERT-ACCOUNT-PRIME  PIC X(6).
   455         16  CERT-EFF-DT     PIC XX.
   456         16  CERT-CERT-NO.
   457             20  CERT-CERT-NO-PRIME  PIC X(10).
   458             20  CERT-CERT-NO-SUFX   PIC X.
   459     12  ELCERT-KEY-5.
   460         16  CERT-COMP-CD-5      PIC X.
   461         16  CERT-CERT-5.
   462             20  CERT-CERT-5-PRIME   PIC X(10).
   463             20  CERT-CERT-5-SUFX    PIC X.
   464     12  ERACCT-KEY.
   465         16  ACCT-COMP-CD    PIC X.
   466         16  ACCT-CARRIER    PIC X.
   467         16  ACCT-GROUPING   PIC X(6).
   468         16  ACCT-STATE      PIC X(2).
   469         16  ACCT-ACCOUNT    PIC X(10).
   470         16  ACCT-EXP-DT     PIC XX.
   471     12  ELTRLR-KEY.
   472         16  TRLR-COMP-CD    PIC X.
   473         16  TRLR-CARRIER    PIC X.
   474         16  TRLR-CLAIM-NO   PIC X(7).
   475         16  TRLR-CERT-NO.
   476             20  TRLR-CERT-NO-PRIME  PIC X(10).
   477             20  TRLR-CERT-NO-SUFX   PIC X.
   478         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   479         16  TRLR-TYPE       PIC X.
   480     12  ELBENE-KEY.
   481         16  BENE-COMP-CD    PIC X.
   482         16  BENE-RCD-TYPE   PIC X.
   483         16  BENE-CODE       PIC X(10).
   484     12  ERREIN-KEY.
   485         16  REIN-COMP-CD        PIC X(01).
   486         16  REIN-TYPE           PIC X(01).
   487         16  REIN-TABLE-CO.
   488             20  REIN-CODE-1     PIC X(01).
   489             20  REIN-CODE-2     PIC X(01).
   490             20  REIN-CODE-3     PIC X(01).
   491         16  FILLER              PIC X(03).
   492     12  ELCRTT-KEY.
   493         16  CTRLR-COMP-CD       PIC X.
   494         16  CTRLR-CARRIER       PIC X.
   495         16  CTRLR-GROUPING      PIC X(6).
   496         16  CTRLR-STATE         PIC X(2).
   497         16  CTRLR-ACCOUNT       PIC X(10).
   498         16  CTRLR-EFF-DT        PIC XX.
   499         16  CTRLR-CERT-NO       PIC X(11).
   500         16  CTRLR-REC-TYPE      PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  12
* EL130.cbl
   502 01  ERROR-MESSAGES.
   503     12  ER-0000                 PIC X(4)  VALUE '0000'.
   504     12  ER-0004                 PIC X(4)  VALUE '0004'.
   505     12  ER-0019                 PIC X(4)  VALUE '0019'.
   506     12  ER-0023                 PIC X(4)  VALUE '0023'.
   507     12  ER-0029                 PIC X(4)  VALUE '0029'.
   508     12  ER-0033                 PIC X(4)  VALUE '0033'.
   509     12  ER-0068                 PIC X(4)  VALUE '0068'.
   510     12  ER-0070                 PIC X(4)  VALUE '0070'.
   511     12  ER-0194                 PIC X(4)  VALUE '0194'.
   512     12  ER-0202                 PIC X(4)  VALUE '0202'.
   513     12  ER-0203                 PIC X(4)  VALUE '0203'.
   514     12  ER-0204                 PIC X(4)  VALUE '0204'.
   515     12  ER-0205                 PIC X(4)  VALUE '0205'.
   516     12  ER-0206                 PIC X(4)  VALUE '0206'.
   517     12  ER-0207                 PIC X(4)  VALUE '0207'.
   518     12  ER-0213                 PIC X(4)  VALUE '0213'.
   519     12  ER-0214                 PIC X(4)  VALUE '0214'.
   520     12  ER-0217                 PIC X(4)  VALUE '0217'.
   521     12  ER-0219                 PIC X(4)  VALUE '0219'.
   522     12  ER-0220                 PIC X(4)  VALUE '0220'.
   523     12  ER-0221                 PIC X(4)  VALUE '0221'.
   524     12  ER-0222                 PIC X(4)  VALUE '0222'.
   525     12  ER-0223                 PIC X(4)  VALUE '0223'.
   526     12  ER-0224                 PIC X(4)  VALUE '0224'.
   527     12  ER-0225                 PIC X(4)  VALUE '0225'.
   528     12  ER-0226                 PIC X(4)  VALUE '0226'.
   529     12  ER-0227                 PIC X(4)  VALUE '0227'.
   530     12  ER-0229                 PIC X(4)  VALUE '0229'.
   531     12  ER-0230                 PIC X(4)  VALUE '0230'.
   532     12  ER-0231                 PIC X(4)  VALUE '0231'.
   533     12  ER-0232                 PIC X(4)  VALUE '0232'.
   534     12  ER-0233                 PIC X(4)  VALUE '0233'.
   535     12  ER-0234                 PIC X(4)  VALUE '0234'.
   536     12  ER-0235                 PIC X(4)  VALUE '0235'.
   537     12  ER-0236                 PIC X(4)  VALUE '0236'.
   538     12  ER-0237                 PIC X(4)  VALUE '0237'.
   539     12  ER-0238                 PIC X(4)  VALUE '0238'.
   540     12  ER-0239                 PIC X(4)  VALUE '0239'.
   541     12  ER-0240                 PIC X(4)  VALUE '0240'.
   542     12  ER-0241                 PIC X(4)  VALUE '0241'.
   543     12  ER-0243                 PIC X(4)  VALUE '0243'.
   544     12  ER-0244                 PIC X(4)  VALUE '0244'.
   545     12  ER-0245                 PIC X(4)  VALUE '0245'.
   546     12  ER-0246                 PIC X(4)  VALUE '0246'.
   547     12  ER-0247                 PIC X(4)  VALUE '0247'.
   548     12  ER-0248                 PIC X(4)  VALUE '0248'.
   549     12  ER-0250                 PIC X(4)  VALUE '0250'.
   550     12  ER-0251                 PIC X(4)  VALUE '0251'.
   551     12  ER-0252                 PIC X(4)  VALUE '0252'.
   552     12  ER-0253                 PIC X(4)  VALUE '0253'.
   553     12  ER-0254                 PIC X(4)  VALUE '0254'.
   554     12  ER-0257                 PIC X(4)  VALUE '0257'.
   555     12  ER-0258                 PIC X(4)  VALUE '0258'.
   556     12  ER-0260                 PIC X(4)  VALUE '0260'.
   557     12  ER-0261                 PIC X(4)  VALUE '0261'.
   558     12  ER-0263                 PIC X(4)  VALUE '0263'.
   559     12  ER-0264                 PIC X(4)  VALUE '0264'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  13
* EL130.cbl
   560     12  ER-0265                 PIC X(4)  VALUE '0265'.
   561     12  ER-0266                 PIC X(4)  VALUE '0266'.
   562     12  ER-0267                 PIC X(4)  VALUE '0267'.
   563     12  ER-0334                 PIC X(4)  VALUE '0334'.
   564     12  ER-0337                 PIC X(4)  VALUE '0337'.
   565     12  ER-0412                 PIC X(4)  VALUE '0412'.
   566     12  ER-0413                 PIC X(4)  VALUE '0413'.
   567     12  ER-0428                 PIC X(4)  VALUE '0428'.
   568     12  ER-0429                 PIC X(4)  VALUE '0429'.
   569     12  ER-0430                 PIC X(4)  VALUE '0430'.
   570     12  ER-0433                 PIC X(4)  VALUE '0433'.
   571     12  ER-0434                 PIC X(4)  VALUE '0434'.
   572     12  ER-0458                 PIC X(4)  VALUE '0458'.
   573     12  ER-0489                 PIC X(4)  VALUE '0489'.
   574     12  ER-0509                 PIC X(4)  VALUE '0509'.
   575     12  ER-0510                 PIC X(4)  VALUE '0510'.
   576     12  ER-0511                 PIC X(4)  VALUE '0511'.
   577     12  ER-0512                 PIC X(4)  VALUE '0512'.
   578     12  ER-0516                 PIC X(4)  VALUE '0516'.
   579     12  ER-0517                 PIC X(4)  VALUE '0517'.
   580     12  ER-0518                 PIC X(4)  VALUE '0518'.
   581     12  ER-0519                 PIC X(4)  VALUE '0519'.
   582     12  ER-0520                 PIC X(4)  VALUE '0520'.
   583     12  ER-0521                 PIC X(4)  VALUE '0521'.
   584     12  ER-0522                 PIC X(4)  VALUE '0522'.
   585     12  ER-0523                 PIC X(4)  VALUE '0523'.
   586     12  ER-0544                 PIC X(4)  VALUE '0544'.
   587     12  ER-0546                 PIC X(4)  VALUE '0546'.
   588     12  ER-0558                 PIC X(4)  VALUE '0558'.
   589     12  ER-0560                 PIC X(4)  VALUE '0560'.
   590     12  ER-0562                 PIC X(4)  VALUE '0562'.
   591     12  ER-0565                 PIC X(4)  VALUE '0565'.
   592     12  ER-0569                 PIC X(4)  VALUE '0569'.
   593     12  ER-0693                 PIC X(4)  VALUE '0693'.
   594     12  ER-0715                 PIC X(4)  VALUE '0715'.
   595     12  ER-0840                 PIC X(4)  VALUE '0840'.
   596     12  ER-0841                 PIC X(4)  VALUE '0841'.
   597     12  ER-0842                 PIC X(4)  VALUE '0842'.
   598     12  ER-0843                 PIC X(4)  VALUE '0843'.
   599     12  ER-0878                 PIC X(4)  VALUE '0878'.
   600     12  ER-0887                 PIC X(4)  VALUE '0887'.
   601     12  ER-2280                 PIC X(4)  VALUE '2280'.
   602     12  ER-2370                 PIC X(4)  VALUE '2370'.
   603     12  ER-2371                 PIC X(4)  VALUE '2371'.
   604     12  ER-2378                 PIC X(4)  VALUE '2378'.
   605     12  ER-2380                 PIC X(4)  VALUE '2380'.
   606     12  ER-2566                 PIC X(4)  VALUE '2566'.
   607     12  ER-2848                 PIC X(4)  VALUE '2848'.
   608     12  ER-3548                 PIC X(4)  VALUE '3548'.
   609     12  ER-7008                 PIC X(4)  VALUE '7008'.
   610     12  ER-7319                 PIC X(4)  VALUE '7319'.
   611     12  ER-7321                 PIC X(4)  VALUE '7321'.
   612     12  ER-7352                 PIC X(4)  VALUE '7352'.
   613     12  ER-7353                 PIC X(4)  VALUE '7353'.
   614     12  ER-7634                 PIC X(4)  VALUE '7634'.
   615     12  ER-7635                 PIC X(4)  VALUE '7635'.
   616     12  ER-7636                 PIC X(4)  VALUE '7636'.
   617     12  ER-7637                 PIC X(4)  VALUE '7637'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  14
* EL130.cbl
   618     12  ER-7638                 PIC X(4)  VALUE '7638'.
   619     12  ER-7639                 PIC X(4)  VALUE '7639'.
   620     12  ER-7640                 PIC X(4)  VALUE '7640'.
   621     12  ER-7641                 PIC X(4)  VALUE '7641'.
   622     12  ER-7642                 PIC X(4)  VALUE '7642'.
   623     12  ER-7643                 PIC X(4)  VALUE '7643'.
   624     12  ER-7646                 PIC X(4)  VALUE '7646'.
   625     12  ER-7647                 PIC X(4)  VALUE '7647'.
   626     12  ER-7648                 PIC X(4)  VALUE '7648'.
   627     12  ER-7649                 PIC X(4)  VALUE '7649'.
   628     12  ER-7651                 PIC X(4)  VALUE '7651'.
   629     12  ER-7670                 PIC X(4)  VALUE '7670'.
   630     12  ER-7671                 PIC X(4)  VALUE '7671'.
   631     12  ER-7686                 PIC X(4)  VALUE '7686'.
   632     12  ER-7688                 PIC X(4)  VALUE '7688'.
   633     12  ER-7689                 PIC X(4)  VALUE '7689'.
   634     12  ER-7691                 PIC X(4)  VALUE '7691'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  15
* EL130.cbl
   636*    COPY ELCLNKLT.
   637******************************************************************
   638*                                                                *
   639*                                                                *
   640*                           ELCLNKLT                             *
   641*                            VMOD=2.003                          *
   642*                                                                *
   643*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   644*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   645*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   646*                                                                *
   647*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   648*   COMPLETING THE REQUIRED FIELDS.                              *
   649*                                                                *
   650*   THE CALLING PROGRAM SHOULD CHECK:                            *
   651*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   652*                              9999 INDICATES AN UNKNOWN ABEND   *
   653*                                   WAS DETECTED.                *
   654*                              ALL OTHER VALUES ARE NORMAL ERROR *
   655*                              CODES FOUND IN THE ERROR FILE.    *
   656******************************************************************
   657 01  W-1523-LINKDATA.
   658     12  W-1523-COMMON-PI-DATA.
   659         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   660         16  FILLER              PIC  X(67).
   661         16  W-1523-COMPANY-CD   PIC  X(01).
   662         16  FILLER              PIC  X(10).
   663         16  W-1523-CONTROL-IN-PROGRESS.
   664             20  W-1523-CARRIER  PIC  X(01).
   665             20  W-1523-GROUPING PIC  X(06).
   666             20  W-1523-STATE    PIC  X(02).
   667             20  W-1523-ACCOUNT  PIC  X(10).
   668             20  W-1523-CLAIM-CERT-GRP.
   669                 24  W-1523-CLAIM-NO
   670                                 PIC  X(07).
   671                 24  W-1523-CERT-NO.
   672                     28  W-1523-CERT-PRIME
   673                                 PIC  X(10).
   674                     28  W-1523-CERT-SFX
   675                                 PIC  X(01).
   676                 24  W-1523-CERT-EFF-DT
   677                                 PIC  X(02).
   678         16  FILLER              PIC X(265).
   679
   680     12  W-1523-WORK-AREA.
   681         16  W-1523-FORM-NUMBER  PIC  X(04).
   682         16  W-1523-NUMBER-COPIES
   683                                 PIC  9(01).
   684         16  W-1523-ADDR-TYPE    PIC  X(02).
   685         16  W-1523-FOLLOW-UP-DATE
   686                                 PIC  X(02).
   687         16  W-1523-RESEND-DATE  PIC  X(02).
   688         16  W-1523-ERROR-CODE   PIC  9(04).
   689             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   690             88  W-1523-FATAL-ERROR
   691                                    VALUES  0006 0013 0042
   692                                            0154 0168 0169
   693                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  16
* EL130.cbl
   694                                            0179 0186 0281
   695                                            0332 2055 3697
   696                                            3698 3699 3770
   697                                            3771 3772 7675
   698                                            9106 9808 9883
   699                                            9887.
   700             88  W-1523-STOP-ERRORS
   701                                    VALUES  0013 0042 0154
   702                                            0168 0169 0172
   703                                            0281 0332 2055
   704                                            3698 3699 7675
   705                                            9106 9808 9883
   706                                            9999.
   707         16  W-1523-REASON       PIC  X(70).
   708         16  W-1523-ARCHIVE-NUMBER
   709                                 PIC  9(08).
   710     12  W-1523-POINTER-AREA.
   711         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   712         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   713         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   714         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   715         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  17
* EL130.cbl
   717*    COPY ELCINTF.
   718******************************************************************
   719*                                                                *
   720*                                                                *
   721*                            ELCINTF.                            *
   722*                            VMOD=2.017                          *
   723*                                                                *
   724*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   725*                                                                *
   726*       LENGTH = 1024                                            *
   727*                                                                *
   728******************************************************************
   729 01  PROGRAM-INTERFACE-BLOCK.
   730     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   731     12  PI-CALLING-PROGRAM              PIC X(8).
   732     12  PI-SAVED-PROGRAM-1              PIC X(8).
   733     12  PI-SAVED-PROGRAM-2              PIC X(8).
   734     12  PI-SAVED-PROGRAM-3              PIC X(8).
   735     12  PI-SAVED-PROGRAM-4              PIC X(8).
   736     12  PI-SAVED-PROGRAM-5              PIC X(8).
   737     12  PI-SAVED-PROGRAM-6              PIC X(8).
   738     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   739     12  PI-COMPANY-ID                   PIC XXX.
   740     12  PI-COMPANY-CD                   PIC X.
   741
   742     12  PI-COMPANY-PASSWORD             PIC X(8).
   743
   744     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   745
   746     12  PI-CONTROL-IN-PROGRESS.
   747         16  PI-CARRIER                  PIC X.
   748         16  PI-GROUPING                 PIC X(6).
   749         16  PI-STATE                    PIC XX.
   750         16  PI-ACCOUNT                  PIC X(10).
   751         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   752                                         PIC X(10).
   753         16  PI-CLAIM-CERT-GRP.
   754             20  PI-CLAIM-NO             PIC X(7).
   755             20  PI-CERT-NO.
   756                 25  PI-CERT-PRIME       PIC X(10).
   757                 25  PI-CERT-SFX         PIC X.
   758             20  PI-CERT-EFF-DT          PIC XX.
   759         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   760             20  PI-PLAN-CODE            PIC X(2).
   761             20  PI-REVISION-NUMBER      PIC X(3).
   762             20  PI-PLAN-EFF-DT          PIC X(2).
   763             20  PI-PLAN-EXP-DT          PIC X(2).
   764             20  FILLER                  PIC X(11).
   765         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   766             20  PI-OE-REFERENCE-1.
   767                 25  PI-OE-REF-1-PRIME   PIC X(18).
   768                 25  PI-OE-REF-1-SUFF    PIC XX.
   769
   770     12  PI-SESSION-IN-PROGRESS          PIC X.
   771         88  CLAIM-SESSION                   VALUE '1'.
   772         88  CREDIT-SESSION                  VALUE '2'.
   773         88  WARRANTY-SESSION                VALUE '3'.
   774         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  18
* EL130.cbl
   775         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   776
   777
   778*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   779
   780     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   781     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   782
   783     12  PI-CREDIT-USER                  PIC X.
   784         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   785         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   786
   787     12  PI-CLAIM-USER                   PIC X.
   788         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   789         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   790
   791     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   792         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   793         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   794         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   795         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   796         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   797
   798     12  PI-PROCESSOR-ID                 PIC X(4).
   799
   800     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   801
   802     12  PI-MEMBER-CAPTION               PIC X(10).
   803
   804     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   805         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   806
   807     12  PI-LIFE-OVERRIDE-L1             PIC X.
   808     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   809     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   810     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   811
   812     12  PI-AH-OVERRIDE-L1               PIC X.
   813     12  PI-AH-OVERRIDE-L2               PIC XX.
   814     12  PI-AH-OVERRIDE-L6               PIC X(6).
   815     12  PI-AH-OVERRIDE-L12              PIC X(12).
   816
   817     12  PI-NEW-SYSTEM                   PIC X(2).
   818
   819     12  PI-PRIMARY-CERT-NO              PIC X(11).
   820     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   821         88  PI-USES-PAID-TO                 VALUE '1'.
   822     12  PI-CRDTCRD-SYSTEM.
   823         16  PI-CRDTCRD-USER             PIC X.
   824             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   825             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   826         16  PI-CC-MONTH-END-DT          PIC XX.
   827     12  PI-PROCESSOR-PRINTER            PIC X(4).
   828
   829     12  PI-OE-REFERENCE-2.
   830         16  PI-OE-REF-2-PRIME           PIC X(10).
   831         16  PI-OE-REF-2-SUFF            PIC X.
   832
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  19
* EL130.cbl
   833     12  PI-REM-TRM-CALC-OPTION          PIC X.
   834
   835     12  PI-LANGUAGE-TYPE                PIC X.
   836             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   837             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   838             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   839
   840     12  PI-POLICY-LINKAGE-IND           PIC X.
   841         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   842         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   843                                                   LOW-VALUES.
   844
   845     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   846     12  PI-CLAIM-PW-SESSION             PIC X(1).
   847         88  PI-CLAIM-CREDIT                 VALUE '1'.
   848         88  PI-CLAIM-CONVEN                 VALUE '2'.
   849     12  FILLER                          PIC X(4).
   850
   851     12  PI-SYSTEM-LEVEL                 PIC X(145).
   852
   853     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   854         PI-SYSTEM-LEVEL.
   855
   856         16  PI-ENTRY-CODES.
   857             20  PI-ENTRY-CD-1           PIC X.
   858             20  PI-ENTRY-CD-2           PIC X.
   859
   860         16  PI-RETURN-CODES.
   861             20  PI-RETURN-CD-1          PIC X.
   862             20  PI-RETURN-CD-2          PIC X.
   863
   864         16  PI-UPDATE-STATUS-SAVE.
   865             20  PI-UPDATE-BY            PIC X(4).
   866             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   867
   868         16  PI-LOWER-CASE-LETTERS       PIC X.
   869             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   870
   871*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   872*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   873*            88  CARRIER-CLM-CNTL            VALUE '2'.
   874
   875         16  PI-CERT-ACCESS-CONTROL      PIC X.
   876             88  ST-ACCNT-CNTL               VALUE ' '.
   877             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   878             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   879             88  ACCNT-CNTL                  VALUE '3'.
   880             88  CARR-ACCNT-CNTL             VALUE '4'.
   881
   882         16  PI-PROCESSOR-CAP-LIST.
   883             20  PI-SYSTEM-CONTROLS.
   884                24 PI-SYSTEM-DISPLAY     PIC X.
   885                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   886                24 PI-SYSTEM-MODIFY      PIC X.
   887                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   888             20  FILLER                  PIC XX.
   889             20  PI-DISPLAY-CAP          PIC X.
   890                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  20
* EL130.cbl
   891             20  PI-MODIFY-CAP           PIC X.
   892                 88  MODIFY-CAP              VALUE 'Y'.
   893             20  PI-MSG-AT-LOGON-CAP     PIC X.
   894                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   895             20  PI-FORCE-CAP            PIC X.
   896                 88  FORCE-CAP               VALUE 'Y'.
   897
   898         16  PI-PROGRAM-CONTROLS.
   899             20  PI-PGM-PRINT-OPT        PIC X.
   900             20  PI-PGM-FORMAT-OPT       PIC X.
   901             20  PI-PGM-PROCESS-OPT      PIC X.
   902             20  PI-PGM-TOTALS-OPT       PIC X.
   903
   904         16  PI-HELP-INTERFACE.
   905             20  PI-LAST-ERROR-NO        PIC X(4).
   906             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   907
   908         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   909             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   910
   911         16  PI-CR-CONTROL-IN-PROGRESS.
   912             20  PI-CR-CARRIER           PIC X.
   913             20  PI-CR-GROUPING          PIC X(6).
   914             20  PI-CR-STATE             PIC XX.
   915             20  PI-CR-ACCOUNT           PIC X(10).
   916             20  PI-CR-FIN-RESP          PIC X(10).
   917             20  PI-CR-TYPE              PIC X.
   918
   919         16  PI-CR-BATCH-NUMBER          PIC X(6).
   920
   921         16  PI-CR-MONTH-END-DT          PIC XX.
   922
   923         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   924             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   925             88  PI-ZERO-CARRIER             VALUE '1'.
   926             88  PI-ZERO-GROUPING            VALUE '2'.
   927             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   928
   929         16  PI-CARRIER-SECURITY         PIC X.
   930             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   931
   932         16  PI-ACCOUNT-SECURITY         PIC X(10).
   933             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   934             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   935
   936         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   937             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   938                                         INDEXED BY PI-ACCESS-NDX
   939                                         PIC X.
   940
   941         16  PI-GA-BILLING-CONTROL       PIC X.
   942             88  PI-GA-BILLING               VALUE '1'.
   943
   944         16  PI-MAIL-PROCESSING          PIC X.
   945             88  PI-MAIL-YES                 VALUE 'Y'.
   946
   947         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   948
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  21
* EL130.cbl
   949         16  PI-AR-SYSTEM.
   950             20  PI-AR-PROCESSING-CNTL   PIC X.
   951                 88  PI-AR-PROCESSING        VALUE 'Y'.
   952             20  PI-AR-SUMMARY-CODE      PIC X(6).
   953             20  PI-AR-MONTH-END-DT      PIC XX.
   954
   955         16  PI-MP-SYSTEM.
   956             20  PI-MORTGAGE-USER            PIC X.
   957                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   958                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   959             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   960                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   961                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   962                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   963                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   964                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   965             20  PI-MP-MONTH-END-DT          PIC XX.
   966             20  PI-MP-REFERENCE-NO.
   967                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   968                 24  PI-MP-REFERENCE-SFX     PIC XX.
   969
   970         16  PI-LABEL-CONTROL            PIC X(01).
   971             88  PI-CREATE-LABELS                    VALUE 'Y'.
   972             88  PI-BYPASS-LABELS                    VALUE 'N'.
   973
   974         16  PI-BILL-GROUPING-CODE       PIC X(01).
   975             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   976
   977         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   978             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   979             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   980
   981         16  FILLER                      PIC X(14).
   982
   983     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   984******************************************************************
   985     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
   986         16  PI-MSTR-DT               PIC XX.
   987         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
   988         16  PI-TRLR-DT               PIC XX.
   989         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
   990         16  PI-LAST-CLAIM            PIC X(7).
   991         16  PI-LAST-CARR             PIC X.
   992         16  PI-LAST-CERT.
   993             20  PI-LAST-CERT-PRIME   PIC X(10).
   994             20  PI-LAST-CERT-SUFX    PIC X.
   995         16  PI-LAST-CLAIM-TYPE       PIC X.
   996         16  PI-CURSOR                PIC S9(4)   COMP.
   997         16  PI-SAVE-CERT.
   998             20  PI-SAVE-CERT-PRIME   PIC X(10).
   999             20  PI-SAVE-CERT-SUFX    PIC X.
  1000         16  PI-SAVE-EFFDT            PIC X(2).
  1001         16  PI-SAVE-ACCOUNT          PIC X(10).
  1002         16  PI-INCURR-SW             PIC X.
  1003         16  PI-PRT-OPT               PIC X.
  1004         16  PI-ALT-PRT               PIC X(4).
  1005         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1006             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  22
* EL130.cbl
  1007         16  FILLER                   PIC X(272).
  1008         16  PI-EL127-TO-EL130-CNTRL.
  1009             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1010             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1011             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1012                 24  PI-EL127-CARRIER        PIC X.
  1013                 24  PI-EL127-GROUPING       PIC X(6).
  1014                 24  PI-EL127-STATE          PIC X(2).
  1015                 24  PI-EL127-ACCOUNT        PIC X(10).
  1016                 24  PI-EL127-CERT-NO.
  1017                     28  PI-EL127-CERT-PRIME PIC X(10).
  1018                     28  PI-EL127-CERT-SUFX  PIC X.
  1019                 24  PI-EL127-EFF-DT         PIC XX.
  1020*        16  FILLER                          PIC X(50).
  1021         16  FILLER                          PIC X(31).
  1022         16  PI-EL659-TO-EL130-CNTRL.
  1023             20  PI-EL659-CARRIER            PIC X.
  1024             20  PI-EL659-GROUPING           PIC X(6).
  1025             20  PI-EL659-STATE              PIC XX.
  1026             20  PI-EL659-ACCOUNT            PIC X(10).
  1027
  1028         16  FILLER                          PIC X(19).
  1029
  1030         16  PI-SAVE-INCUR-DT                PIC X(02).
  1031         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1032         16  FILLER                          PIC X(65).
  1033
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  23
* EL130.cbl
  1035*    COPY EL130S.
  1036 01  EL130AI.
  1037     05  FILLER            PIC  X(0012).
  1038*    -------------------------------
  1039     05  RUNDTEL PIC S9(0004) COMP.
  1040     05  RUNDTEF PIC  X(0001).
  1041     05  FILLER REDEFINES RUNDTEF.
  1042         10  RUNDTEA PIC  X(0001).
  1043     05  RUNDTEI PIC  X(0008).
  1044*    -------------------------------
  1045     05  RUNTIMEL PIC S9(0004) COMP.
  1046     05  RUNTIMEF PIC  X(0001).
  1047     05  FILLER REDEFINES RUNTIMEF.
  1048         10  RUNTIMEA PIC  X(0001).
  1049     05  RUNTIMEI PIC  X(0005).
  1050*    -------------------------------
  1051     05  COMPL PIC S9(0004) COMP.
  1052     05  COMPF PIC  X(0001).
  1053     05  FILLER REDEFINES COMPF.
  1054         10  COMPA PIC  X(0001).
  1055     05  COMPI PIC  X(0003).
  1056*    -------------------------------
  1057     05  SEQUL PIC S9(0004) COMP.
  1058     05  SEQUF PIC  X(0001).
  1059     05  FILLER REDEFINES SEQUF.
  1060         10  SEQUA PIC  X(0001).
  1061     05  SEQUI PIC  X(0010).
  1062*    -------------------------------
  1063     05  MAINTL PIC S9(0004) COMP.
  1064     05  MAINTF PIC  X(0001).
  1065     05  FILLER REDEFINES MAINTF.
  1066         10  MAINTA PIC  X(0001).
  1067     05  MAINTI PIC  X(0001).
  1068*    -------------------------------
  1069     05  CLMNOL PIC S9(0004) COMP.
  1070     05  CLMNOF PIC  X(0001).
  1071     05  FILLER REDEFINES CLMNOF.
  1072         10  CLMNOA PIC  X(0001).
  1073     05  CLMNOI PIC  X(0007).
  1074*    -------------------------------
  1075     05  CLMCARRL PIC S9(0004) COMP.
  1076     05  CLMCARRF PIC  X(0001).
  1077     05  FILLER REDEFINES CLMCARRF.
  1078         10  CLMCARRA PIC  X(0001).
  1079     05  CLMCARRI PIC  X(0001).
  1080*    -------------------------------
  1081     05  CLMTYPEL PIC S9(0004) COMP.
  1082     05  CLMTYPEF PIC  X(0001).
  1083     05  FILLER REDEFINES CLMTYPEF.
  1084         10  CLMTYPEA PIC  X(0001).
  1085     05  CLMTYPEI PIC  X(0001).
  1086*    -------------------------------
  1087     05  CERTNOL PIC S9(0004) COMP.
  1088     05  CERTNOF PIC  X(0001).
  1089     05  FILLER REDEFINES CERTNOF.
  1090         10  CERTNOA PIC  X(0001).
  1091     05  CERTNOI PIC  X(0010).
  1092*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  24
* EL130.cbl
  1093     05  SUFXL PIC S9(0004) COMP.
  1094     05  SUFXF PIC  X(0001).
  1095     05  FILLER REDEFINES SUFXF.
  1096         10  SUFXA PIC  X(0001).
  1097     05  SUFXI PIC  X(0001).
  1098*    -------------------------------
  1099     05  PCERTNOL PIC S9(0004) COMP.
  1100     05  PCERTNOF PIC  X(0001).
  1101     05  FILLER REDEFINES PCERTNOF.
  1102         10  PCERTNOA PIC  X(0001).
  1103     05  PCERTNOI PIC  X(0010).
  1104*    -------------------------------
  1105     05  PSUFXL PIC S9(0004) COMP.
  1106     05  PSUFXF PIC  X(0001).
  1107     05  FILLER REDEFINES PSUFXF.
  1108         10  PSUFXA PIC  X(0001).
  1109     05  PSUFXI PIC  X(0001).
  1110*    -------------------------------
  1111     05  INCURL PIC S9(0004) COMP.
  1112     05  INCURF PIC  X(0001).
  1113     05  FILLER REDEFINES INCURF.
  1114         10  INCURA PIC  X(0001).
  1115     05  INCURI PIC  X(0008).
  1116*    -------------------------------
  1117     05  REPORTL PIC S9(0004) COMP.
  1118     05  REPORTF PIC  X(0001).
  1119     05  FILLER REDEFINES REPORTF.
  1120         10  REPORTA PIC  X(0001).
  1121     05  REPORTI PIC  X(0008).
  1122*    -------------------------------
  1123     05  CAUSEL PIC S9(0004) COMP.
  1124     05  CAUSEF PIC  X(0001).
  1125     05  FILLER REDEFINES CAUSEF.
  1126         10  CAUSEA PIC  X(0001).
  1127     05  CAUSEI PIC  X(0006).
  1128*    -------------------------------
  1129     05  ESTENDL PIC S9(0004) COMP.
  1130     05  ESTENDF PIC  X(0001).
  1131     05  FILLER REDEFINES ESTENDF.
  1132         10  ESTENDA PIC  X(0001).
  1133     05  ESTENDI PIC  X(0008).
  1134*    -------------------------------
  1135     05  DIAGL PIC S9(0004) COMP.
  1136     05  DIAGF PIC  X(0001).
  1137     05  FILLER REDEFINES DIAGF.
  1138         10  DIAGA PIC  X(0001).
  1139     05  DIAGI PIC  X(0060).
  1140*    -------------------------------
  1141     05  BENECDL PIC S9(0004) COMP.
  1142     05  BENECDF PIC  X(0001).
  1143     05  FILLER REDEFINES BENECDF.
  1144         10  BENECDA PIC  X(0001).
  1145     05  BENECDI PIC  X(0010).
  1146*    -------------------------------
  1147     05  BIRTHDTL PIC S9(0004) COMP.
  1148     05  BIRTHDTF PIC  X(0001).
  1149     05  FILLER REDEFINES BIRTHDTF.
  1150         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  25
* EL130.cbl
  1151     05  BIRTHDTI PIC  X(0008).
  1152*    -------------------------------
  1153     05  SSNL PIC S9(0004) COMP.
  1154     05  SSNF PIC  X(0001).
  1155     05  FILLER REDEFINES SSNF.
  1156         10  SSNA PIC  X(0001).
  1157     05  SSNI PIC  X(0011).
  1158*    -------------------------------
  1159     05  SEXL PIC S9(0004) COMP.
  1160     05  SEXF PIC  X(0001).
  1161     05  FILLER REDEFINES SEXF.
  1162         10  SEXA PIC  X(0001).
  1163     05  SEXI PIC  X(0001).
  1164*    -------------------------------
  1165     05  OCCCDL PIC S9(0004) COMP.
  1166     05  OCCCDF PIC  X(0001).
  1167     05  FILLER REDEFINES OCCCDF.
  1168         10  OCCCDA PIC  X(0001).
  1169     05  OCCCDI PIC  X(0006).
  1170*    -------------------------------
  1171     05  LSTNMEL PIC S9(0004) COMP.
  1172     05  LSTNMEF PIC  X(0001).
  1173     05  FILLER REDEFINES LSTNMEF.
  1174         10  LSTNMEA PIC  X(0001).
  1175     05  LSTNMEI PIC  X(0015).
  1176*    -------------------------------
  1177     05  FSTNMEL PIC S9(0004) COMP.
  1178     05  FSTNMEF PIC  X(0001).
  1179     05  FILLER REDEFINES FSTNMEF.
  1180         10  FSTNMEA PIC  X(0001).
  1181     05  FSTNMEI PIC  X(0012).
  1182*    -------------------------------
  1183     05  INITL PIC S9(0004) COMP.
  1184     05  INITF PIC  X(0001).
  1185     05  FILLER REDEFINES INITF.
  1186         10  INITA PIC  X(0001).
  1187     05  INITI PIC  X(0001).
  1188*    -------------------------------
  1189     05  LOANNOL PIC S9(0004) COMP.
  1190     05  LOANNOF PIC  X(0001).
  1191     05  FILLER REDEFINES LOANNOF.
  1192         10  LOANNOA PIC  X(0001).
  1193     05  LOANNOI PIC  X(0008).
  1194*    -------------------------------
  1195     05  CRTLNMEL PIC S9(0004) COMP.
  1196     05  CRTLNMEF PIC  X(0001).
  1197     05  FILLER REDEFINES CRTLNMEF.
  1198         10  CRTLNMEA PIC  X(0001).
  1199     05  CRTLNMEI PIC  X(0015).
  1200*    -------------------------------
  1201     05  CRTFNMEL PIC S9(0004) COMP.
  1202     05  CRTFNMEF PIC  X(0001).
  1203     05  FILLER REDEFINES CRTFNMEF.
  1204         10  CRTFNMEA PIC  X(0001).
  1205     05  CRTFNMEI PIC  X(0012).
  1206*    -------------------------------
  1207     05  CRTINITL PIC S9(0004) COMP.
  1208     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  26
* EL130.cbl
  1209     05  FILLER REDEFINES CRTINITF.
  1210         10  CRTINITA PIC  X(0001).
  1211     05  CRTINITI PIC  X(0001).
  1212*    -------------------------------
  1213     05  LOANBALL PIC S9(0004) COMP.
  1214     05  LOANBALF PIC  X(0001).
  1215     05  FILLER REDEFINES LOANBALF.
  1216         10  LOANBALA PIC  X(0001).
  1217     05  LOANBALI PIC  9(7)V99.
  1218*    -------------------------------
  1219     05  MANRSVL PIC S9(0004) COMP.
  1220     05  MANRSVF PIC  X(0001).
  1221     05  FILLER REDEFINES MANRSVF.
  1222         10  MANRSVA PIC  X(0001).
  1223     05  MANRSVI PIC  9(7)V99.
  1224*    -------------------------------
  1225     05  SUPVL PIC S9(0004) COMP.
  1226     05  SUPVF PIC  X(0001).
  1227     05  FILLER REDEFINES SUPVF.
  1228         10  SUPVA PIC  X(0001).
  1229     05  SUPVI PIC  X(0001).
  1230*    -------------------------------
  1231     05  PRICDL PIC S9(0004) COMP.
  1232     05  PRICDF PIC  X(0001).
  1233     05  FILLER REDEFINES PRICDF.
  1234         10  PRICDA PIC  X(0001).
  1235     05  PRICDI PIC  X(0001).
  1236*    -------------------------------
  1237     05  PRODL PIC S9(0004) COMP.
  1238     05  PRODF PIC  X(0001).
  1239     05  FILLER REDEFINES PRODF.
  1240         10  PRODA PIC  X(0001).
  1241     05  PRODI PIC  X(0008).
  1242*    -------------------------------
  1243     05  PRODCDL PIC S9(0004) COMP.
  1244     05  PRODCDF PIC  X(0001).
  1245     05  FILLER REDEFINES PRODCDF.
  1246         10  PRODCDA PIC  X(0001).
  1247     05  PRODCDI PIC  X(0001).
  1248*    -------------------------------
  1249     05  FILETOL PIC S9(0004) COMP.
  1250     05  FILETOF PIC  X(0001).
  1251     05  FILLER REDEFINES FILETOF.
  1252         10  FILETOA PIC  X(0001).
  1253     05  FILETOI PIC  X(0004).
  1254*    -------------------------------
  1255     05  PROCCDL PIC S9(0004) COMP.
  1256     05  PROCCDF PIC  X(0001).
  1257     05  FILLER REDEFINES PROCCDF.
  1258         10  PROCCDA PIC  X(0001).
  1259     05  PROCCDI PIC  X(0004).
  1260*    -------------------------------
  1261     05  RELCLML PIC S9(0004) COMP.
  1262     05  RELCLMF PIC  X(0001).
  1263     05  FILLER REDEFINES RELCLMF.
  1264         10  RELCLMA PIC  X(0001).
  1265     05  RELCLMI PIC  X(0007).
  1266*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  27
* EL130.cbl
  1267     05  PRTOPTL PIC S9(0004) COMP.
  1268     05  PRTOPTF PIC  X(0001).
  1269     05  FILLER REDEFINES PRTOPTF.
  1270         10  PRTOPTA PIC  X(0001).
  1271     05  PRTOPTI PIC  X(0001).
  1272*    -------------------------------
  1273     05  ALTPRTL PIC S9(0004) COMP.
  1274     05  ALTPRTF PIC  X(0001).
  1275     05  FILLER REDEFINES ALTPRTF.
  1276         10  ALTPRTA PIC  X(0001).
  1277     05  ALTPRTI PIC  X(0004).
  1278*    -------------------------------
  1279     05  CERTMTL PIC S9(0004) COMP.
  1280     05  CERTMTF PIC  X(0001).
  1281     05  FILLER REDEFINES CERTMTF.
  1282         10  CERTMTA PIC  X(0001).
  1283     05  CERTMTI PIC  X(0001).
  1284*    -------------------------------
  1285     05  CRTCARRL PIC S9(0004) COMP.
  1286     05  CRTCARRF PIC  X(0001).
  1287     05  FILLER REDEFINES CRTCARRF.
  1288         10  CRTCARRA PIC  X(0001).
  1289     05  CRTCARRI PIC  X(0001).
  1290*    -------------------------------
  1291     05  GROUPL PIC S9(0004) COMP.
  1292     05  GROUPF PIC  X(0001).
  1293     05  FILLER REDEFINES GROUPF.
  1294         10  GROUPA PIC  X(0001).
  1295     05  GROUPI PIC  X(0006).
  1296*    -------------------------------
  1297     05  STATEL PIC S9(0004) COMP.
  1298     05  STATEF PIC  X(0001).
  1299     05  FILLER REDEFINES STATEF.
  1300         10  STATEA PIC  X(0001).
  1301     05  STATEI PIC  X(0002).
  1302*    -------------------------------
  1303     05  ACCOUNTL PIC S9(0004) COMP.
  1304     05  ACCOUNTF PIC  X(0001).
  1305     05  FILLER REDEFINES ACCOUNTF.
  1306         10  ACCOUNTA PIC  X(0001).
  1307     05  ACCOUNTI PIC  X(0010).
  1308*    -------------------------------
  1309     05  EFFDTL PIC S9(0004) COMP.
  1310     05  EFFDTF PIC  X(0001).
  1311     05  FILLER REDEFINES EFFDTF.
  1312         10  EFFDTA PIC  X(0001).
  1313     05  EFFDTI PIC  X(0008).
  1314*    -------------------------------
  1315     05  CRTSSNL PIC S9(0004) COMP.
  1316     05  CRTSSNF PIC  X(0001).
  1317     05  FILLER REDEFINES CRTSSNF.
  1318         10  CRTSSNA PIC  X(0001).
  1319     05  CRTSSNI PIC  X(0011).
  1320*    -------------------------------
  1321     05  MEMCAPL PIC S9(0004) COMP.
  1322     05  MEMCAPF PIC  X(0001).
  1323     05  FILLER REDEFINES MEMCAPF.
  1324         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  28
* EL130.cbl
  1325     05  MEMCAPI PIC  X(0010).
  1326*    -------------------------------
  1327     05  MEMBERL PIC S9(0004) COMP.
  1328     05  MEMBERF PIC  X(0001).
  1329     05  FILLER REDEFINES MEMBERF.
  1330         10  MEMBERA PIC  X(0001).
  1331     05  MEMBERI PIC  X(0012).
  1332*    -------------------------------
  1333     05  REINCDL PIC S9(0004) COMP.
  1334     05  REINCDF PIC  X(0001).
  1335     05  FILLER REDEFINES REINCDF.
  1336         10  REINCDA PIC  X(0001).
  1337     05  REINCDI PIC  X(0001).
  1338*    -------------------------------
  1339     05  ISSAGEL PIC S9(0004) COMP.
  1340     05  ISSAGEF PIC  X(0001).
  1341     05  FILLER REDEFINES ISSAGEF.
  1342         10  ISSAGEA PIC  X(0001).
  1343     05  ISSAGEI PIC  X(0002).
  1344*    -------------------------------
  1345     05  APRL PIC S9(0004) COMP.
  1346     05  APRF PIC  X(0001).
  1347     05  FILLER REDEFINES APRF.
  1348         10  APRA PIC  X(0001).
  1349     05  APRI PIC  9(4)V9(4).
  1350*    -------------------------------
  1351     05  PMTFREQL PIC S9(0004) COMP.
  1352     05  PMTFREQF PIC  X(0001).
  1353     05  FILLER REDEFINES PMTFREQF.
  1354         10  PMTFREQA PIC  X(0001).
  1355     05  PMTFREQI PIC  99.
  1356*    -------------------------------
  1357     05  INDGRPL PIC S9(0004) COMP.
  1358     05  INDGRPF PIC  X(0001).
  1359     05  FILLER REDEFINES INDGRPF.
  1360         10  INDGRPA PIC  X(0001).
  1361     05  INDGRPI PIC  X(0001).
  1362*    -------------------------------
  1363     05  PREMTYPL PIC S9(0004) COMP.
  1364     05  PREMTYPF PIC  X(0001).
  1365     05  FILLER REDEFINES PREMTYPF.
  1366         10  PREMTYPA PIC  X(0001).
  1367     05  PREMTYPI PIC  X(0001).
  1368*    -------------------------------
  1369     05  ADDONDTL PIC S9(0004) COMP.
  1370     05  ADDONDTF PIC  X(0001).
  1371     05  FILLER REDEFINES ADDONDTF.
  1372         10  ADDONDTA PIC  X(0001).
  1373     05  ADDONDTI PIC  X(0008).
  1374*    -------------------------------
  1375     05  JNTLNMEL PIC S9(0004) COMP.
  1376     05  JNTLNMEF PIC  X(0001).
  1377     05  FILLER REDEFINES JNTLNMEF.
  1378         10  JNTLNMEA PIC  X(0001).
  1379     05  JNTLNMEI PIC  X(0015).
  1380*    -------------------------------
  1381     05  JNTFNMEL PIC S9(0004) COMP.
  1382     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  29
* EL130.cbl
  1383     05  FILLER REDEFINES JNTFNMEF.
  1384         10  JNTFNMEA PIC  X(0001).
  1385     05  JNTFNMEI PIC  X(0002).
  1386*    -------------------------------
  1387     05  JNTINITL PIC S9(0004) COMP.
  1388     05  JNTINITF PIC  X(0001).
  1389     05  FILLER REDEFINES JNTINITF.
  1390         10  JNTINITA PIC  X(0001).
  1391     05  JNTINITI PIC  X(0001).
  1392*    -------------------------------
  1393     05  JNTAGEL PIC S9(0004) COMP.
  1394     05  JNTAGEF PIC  X(0001).
  1395     05  FILLER REDEFINES JNTAGEF.
  1396         10  JNTAGEA PIC  X(0001).
  1397     05  JNTAGEI PIC  X(0002).
  1398*    -------------------------------
  1399     05  LCVDSCRL PIC S9(0004) COMP.
  1400     05  LCVDSCRF PIC  X(0001).
  1401     05  FILLER REDEFINES LCVDSCRF.
  1402         10  LCVDSCRA PIC  X(0001).
  1403     05  LCVDSCRI PIC  X(0006).
  1404*    -------------------------------
  1405     05  LCVKINDL PIC S9(0004) COMP.
  1406     05  LCVKINDF PIC  X(0001).
  1407     05  FILLER REDEFINES LCVKINDF.
  1408         10  LCVKINDA PIC  X(0001).
  1409     05  LCVKINDI PIC  X(0003).
  1410*    -------------------------------
  1411     05  LCVCDL PIC S9(0004) COMP.
  1412     05  LCVCDF PIC  X(0001).
  1413     05  FILLER REDEFINES LCVCDF.
  1414         10  LCVCDA PIC  X(0001).
  1415     05  LCVCDI PIC  X(0002).
  1416*    -------------------------------
  1417     05  LCVOTRML PIC S9(0004) COMP.
  1418     05  LCVOTRMF PIC  X(0001).
  1419     05  FILLER REDEFINES LCVOTRMF.
  1420         10  LCVOTRMA PIC  X(0001).
  1421     05  LCVOTRMI PIC  999.
  1422*    -------------------------------
  1423     05  LCVRTRML PIC S9(0004) COMP.
  1424     05  LCVRTRMF PIC  X(0001).
  1425     05  FILLER REDEFINES LCVRTRMF.
  1426         10  LCVRTRMA PIC  X(0001).
  1427     05  LCVRTRMI PIC  X(0003).
  1428*    -------------------------------
  1429     05  LCVRATEL PIC S9(0004) COMP.
  1430     05  LCVRATEF PIC  X(0001).
  1431     05  FILLER REDEFINES LCVRATEF.
  1432         10  LCVRATEA PIC  X(0001).
  1433     05  LCVRATEI PIC  9999V99.
  1434*    -------------------------------
  1435     05  LCVBENEL PIC S9(0004) COMP.
  1436     05  LCVBENEF PIC  X(0001).
  1437     05  FILLER REDEFINES LCVBENEF.
  1438         10  LCVBENEA PIC  X(0001).
  1439     05  LCVBENEI PIC  9(9)V99.
  1440*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  30
* EL130.cbl
  1441     05  LCVFORML PIC S9(0004) COMP.
  1442     05  LCVFORMF PIC  X(0001).
  1443     05  FILLER REDEFINES LCVFORMF.
  1444         10  LCVFORMA PIC  X(0001).
  1445     05  LCVFORMI PIC  X(0012).
  1446*    -------------------------------
  1447     05  LCVCNDTL PIC S9(0004) COMP.
  1448     05  LCVCNDTF PIC  X(0001).
  1449     05  FILLER REDEFINES LCVCNDTF.
  1450         10  LCVCNDTA PIC  X(0001).
  1451     05  LCVCNDTI PIC  X(0008).
  1452*    -------------------------------
  1453     05  LCVEXITL PIC S9(0004) COMP.
  1454     05  LCVEXITF PIC  X(0001).
  1455     05  FILLER REDEFINES LCVEXITF.
  1456         10  LCVEXITA PIC  X(0001).
  1457     05  LCVEXITI PIC  X(0008).
  1458*    -------------------------------
  1459     05  LCVSTATL PIC S9(0004) COMP.
  1460     05  LCVSTATF PIC  X(0001).
  1461     05  FILLER REDEFINES LCVSTATF.
  1462         10  LCVSTATA PIC  X(0001).
  1463     05  LCVSTATI PIC  X(0006).
  1464*    -------------------------------
  1465     05  ACVDSCRL PIC S9(0004) COMP.
  1466     05  ACVDSCRF PIC  X(0001).
  1467     05  FILLER REDEFINES ACVDSCRF.
  1468         10  ACVDSCRA PIC  X(0001).
  1469     05  ACVDSCRI PIC  X(0006).
  1470*    -------------------------------
  1471     05  ACVKINDL PIC S9(0004) COMP.
  1472     05  ACVKINDF PIC  X(0001).
  1473     05  FILLER REDEFINES ACVKINDF.
  1474         10  ACVKINDA PIC  X(0001).
  1475     05  ACVKINDI PIC  X(0003).
  1476*    -------------------------------
  1477     05  ACVCDL PIC S9(0004) COMP.
  1478     05  ACVCDF PIC  X(0001).
  1479     05  FILLER REDEFINES ACVCDF.
  1480         10  ACVCDA PIC  X(0001).
  1481     05  ACVCDI PIC  X(0002).
  1482*    -------------------------------
  1483     05  ACVOTRML PIC S9(0004) COMP.
  1484     05  ACVOTRMF PIC  X(0001).
  1485     05  FILLER REDEFINES ACVOTRMF.
  1486         10  ACVOTRMA PIC  X(0001).
  1487     05  ACVOTRMI PIC  999.
  1488*    -------------------------------
  1489     05  ACVRTRML PIC S9(0004) COMP.
  1490     05  ACVRTRMF PIC  X(0001).
  1491     05  FILLER REDEFINES ACVRTRMF.
  1492         10  ACVRTRMA PIC  X(0001).
  1493     05  ACVRTRMI PIC  X(0003).
  1494*    -------------------------------
  1495     05  ACVRATEL PIC S9(0004) COMP.
  1496     05  ACVRATEF PIC  X(0001).
  1497     05  FILLER REDEFINES ACVRATEF.
  1498         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  31
* EL130.cbl
  1499     05  ACVRATEI PIC  9999V99.
  1500*    -------------------------------
  1501     05  ACVBENEL PIC S9(0004) COMP.
  1502     05  ACVBENEF PIC  X(0001).
  1503     05  FILLER REDEFINES ACVBENEF.
  1504         10  ACVBENEA PIC  X(0001).
  1505     05  ACVBENEI PIC  9(9)V99.
  1506*    -------------------------------
  1507     05  ACVFORML PIC S9(0004) COMP.
  1508     05  ACVFORMF PIC  X(0001).
  1509     05  FILLER REDEFINES ACVFORMF.
  1510         10  ACVFORMA PIC  X(0001).
  1511     05  ACVFORMI PIC  X(0012).
  1512*    -------------------------------
  1513     05  ACVCNDTL PIC S9(0004) COMP.
  1514     05  ACVCNDTF PIC  X(0001).
  1515     05  FILLER REDEFINES ACVCNDTF.
  1516         10  ACVCNDTA PIC  X(0001).
  1517     05  ACVCNDTI PIC  X(0008).
  1518*    -------------------------------
  1519     05  ACVEXITL PIC S9(0004) COMP.
  1520     05  ACVEXITF PIC  X(0001).
  1521     05  FILLER REDEFINES ACVEXITF.
  1522         10  ACVEXITA PIC  X(0001).
  1523     05  ACVEXITI PIC  X(0008).
  1524*    -------------------------------
  1525     05  ACVSTATL PIC S9(0004) COMP.
  1526     05  ACVSTATF PIC  X(0001).
  1527     05  FILLER REDEFINES ACVSTATF.
  1528         10  ACVSTATA PIC  X(0001).
  1529     05  ACVSTATI PIC  X(0006).
  1530*    -------------------------------
  1531     05  ERRMSG1L PIC S9(0004) COMP.
  1532     05  ERRMSG1F PIC  X(0001).
  1533     05  FILLER REDEFINES ERRMSG1F.
  1534         10  ERRMSG1A PIC  X(0001).
  1535     05  ERRMSG1I PIC  X(0072).
  1536*    -------------------------------
  1537     05  ERRMSG2L PIC S9(0004) COMP.
  1538     05  ERRMSG2F PIC  X(0001).
  1539     05  FILLER REDEFINES ERRMSG2F.
  1540         10  ERRMSG2A PIC  X(0001).
  1541     05  ERRMSG2I PIC  X(0072).
  1542*    -------------------------------
  1543     05  BCERT1L PIC S9(0004) COMP.
  1544     05  BCERT1F PIC  X(0001).
  1545     05  FILLER REDEFINES BCERT1F.
  1546         10  BCERT1A PIC  X(0001).
  1547     05  BCERT1I PIC  X(0010).
  1548*    -------------------------------
  1549     05  BSUFX1L PIC S9(0004) COMP.
  1550     05  BSUFX1F PIC  X(0001).
  1551     05  FILLER REDEFINES BSUFX1F.
  1552         10  BSUFX1A PIC  X(0001).
  1553     05  BSUFX1I PIC  X(0001).
  1554*    -------------------------------
  1555     05  BCERT2L PIC S9(0004) COMP.
  1556     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  32
* EL130.cbl
  1557     05  FILLER REDEFINES BCERT2F.
  1558         10  BCERT2A PIC  X(0001).
  1559     05  BCERT2I PIC  X(0010).
  1560*    -------------------------------
  1561     05  BSUFX2L PIC S9(0004) COMP.
  1562     05  BSUFX2F PIC  X(0001).
  1563     05  FILLER REDEFINES BSUFX2F.
  1564         10  BSUFX2A PIC  X(0001).
  1565     05  BSUFX2I PIC  X(0001).
  1566*    -------------------------------
  1567     05  BCERT3L PIC S9(0004) COMP.
  1568     05  BCERT3F PIC  X(0001).
  1569     05  FILLER REDEFINES BCERT3F.
  1570         10  BCERT3A PIC  X(0001).
  1571     05  BCERT3I PIC  X(0010).
  1572*    -------------------------------
  1573     05  BSUFX3L PIC S9(0004) COMP.
  1574     05  BSUFX3F PIC  X(0001).
  1575     05  FILLER REDEFINES BSUFX3F.
  1576         10  BSUFX3A PIC  X(0001).
  1577     05  BSUFX3I PIC  X(0001).
  1578*    -------------------------------
  1579     05  BCERT4L PIC S9(0004) COMP.
  1580     05  BCERT4F PIC  X(0001).
  1581     05  FILLER REDEFINES BCERT4F.
  1582         10  BCERT4A PIC  X(0001).
  1583     05  BCERT4I PIC  X(0010).
  1584*    -------------------------------
  1585     05  BSUFX4L PIC S9(0004) COMP.
  1586     05  BSUFX4F PIC  X(0001).
  1587     05  FILLER REDEFINES BSUFX4F.
  1588         10  BSUFX4A PIC  X(0001).
  1589     05  BSUFX4I PIC  X(0001).
  1590*    -------------------------------
  1591     05  BCERT5L PIC S9(0004) COMP.
  1592     05  BCERT5F PIC  X(0001).
  1593     05  FILLER REDEFINES BCERT5F.
  1594         10  BCERT5A PIC  X(0001).
  1595     05  BCERT5I PIC  X(0010).
  1596*    -------------------------------
  1597     05  BSUFX5L PIC S9(0004) COMP.
  1598     05  BSUFX5F PIC  X(0001).
  1599     05  FILLER REDEFINES BSUFX5F.
  1600         10  BSUFX5A PIC  X(0001).
  1601     05  BSUFX5I PIC  X(0001).
  1602*    -------------------------------
  1603     05  ENTERPFL PIC S9(0004) COMP.
  1604     05  ENTERPFF PIC  X(0001).
  1605     05  FILLER REDEFINES ENTERPFF.
  1606         10  ENTERPFA PIC  X(0001).
  1607     05  ENTERPFI PIC  99.
  1608*    -------------------------------
  1609     05  PF5L PIC S9(0004) COMP.
  1610     05  PF5F PIC  X(0001).
  1611     05  FILLER REDEFINES PF5F.
  1612         10  PF5A PIC  X(0001).
  1613     05  PF5I PIC  X(0013).
  1614 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  33
* EL130.cbl
  1615     05  FILLER            PIC  X(0012).
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
  1618     05  RUNDTEO PIC  X(0008).
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  RUNTIMEO PIC  99.99.
  1622*    -------------------------------
  1623     05  FILLER            PIC  X(0003).
  1624     05  COMPO PIC  X(0003).
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  SEQUO PIC  X(0010).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  MAINTO PIC  X(0001).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  CLMNOO PIC  X(0007).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  CLMCARRO PIC  X(0001).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  CLMTYPEO PIC  X(0001).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  CERTNOO PIC  X(0010).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  SUFXO PIC  X(0001).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  PCERTNOO PIC  X(0010).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  PSUFXO PIC  X(0001).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  INCURO PIC  X(0008).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  REPORTO PIC  X(0008).
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  CAUSEO PIC  X(0006).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  ESTENDO PIC  X(0008).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  DIAGO PIC  X(0060).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  BENECDO PIC  X(0010).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  34
* EL130.cbl
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  SSNO PIC  X(0011).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  SEXO PIC  X(0001).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  OCCCDO PIC  X(0006).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  LSTNMEO PIC  X(0015).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  FSTNMEO PIC  X(0012).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  INITO PIC  X(0001).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  LOANNOO PIC  X(0008).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  CRTLNMEO PIC  X(0015).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  CRTFNMEO PIC  X(0012).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  CRTINITO PIC  X(0001).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  LOANBALO PIC  ZZZZZ9.99.
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  MANRSVO PIC  Z(5)9.99.
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  SUPVO PIC  X(0001).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  PRICDO PIC  X(0001).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  PRODO PIC  X(0008).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  PRODCDO PIC  X(0001).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  FILETOO PIC  X(0004).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  PROCCDO PIC  X(0004).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  RELCLMO PIC  X(0007).
  1730*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  35
* EL130.cbl
  1731     05  FILLER            PIC  X(0003).
  1732     05  PRTOPTO PIC  X(0001).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  ALTPRTO PIC  X(0004).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  CERTMTO PIC  X(0001).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  CRTCARRO PIC  X(0001).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  GROUPO PIC  X(0006).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  STATEO PIC  X(0002).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  ACCOUNTO PIC  X(0010).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  EFFDTO PIC  X(0008).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  CRTSSNO PIC  X(0011).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  MEMCAPO PIC  X(0010).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  MEMBERO PIC  X(0012).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  REINCDO PIC  X(0001).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  ISSAGEO PIC  X(0002).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  APRO PIC  9(3).9(4).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  PMTFREQO PIC  99.
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  INDGRPO PIC  X(0001).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  PREMTYPO PIC  X(0001).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  ADDONDTO PIC  X(0008).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  JNTLNMEO PIC  X(0015).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  36
* EL130.cbl
  1789     05  JNTFNMEO PIC  X(0002).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  JNTINITO PIC  X(0001).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  JNTAGEO PIC  X(0002).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  LCVDSCRO PIC  X(0006).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  LCVKINDO PIC  X(0003).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  LCVCDO PIC  X(0002).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  LCVOTRMO PIC  999.
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  LCVRTRMO PIC  ZZZ.
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  LCVRATEO PIC  ZZZ.ZZ.
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  LCVFORMO PIC  X(0012).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  LCVCNDTO PIC  X(0008).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  LCVEXITO PIC  X(0008).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  LCVSTATO PIC  X(0006).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  ACVDSCRO PIC  X(0006).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  ACVKINDO PIC  X(0003).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  ACVCDO PIC  X(0002).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  ACVOTRMO PIC  999.
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  ACVRTRMO PIC  ZZZ.
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  37
* EL130.cbl
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  ACVFORMO PIC  X(0012).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  ACVCNDTO PIC  X(0008).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  ACVEXITO PIC  X(0008).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  ACVSTATO PIC  X(0006).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  ERRMSG1O PIC  X(0072).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  ERRMSG2O PIC  X(0072).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  BCERT1O PIC  X(0010).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  BSUFX1O PIC  X(0001).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  BCERT2O PIC  X(0010).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  BSUFX2O PIC  X(0001).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  BCERT3O PIC  X(0010).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  BSUFX3O PIC  X(0001).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
  1888     05  BCERT4O PIC  X(0010).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  BSUFX4O PIC  X(0001).
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  BCERT5O PIC  X(0010).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  BSUFX5O PIC  X(0001).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  ENTERPFO PIC  X(0002).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  PF5O PIC  X(0013).
  1904*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  38
* EL130.cbl
  1906*    COPY ELCDATE.
  1907******************************************************************
  1908*                                                                *
  1909*                                                                *
  1910*                            ELCDATE.                            *
  1911*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1912*                            VMOD=2.003
  1913*                                                                *
  1914*                                                                *
  1915*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1916*                 LENGTH = 200                                   *
  1917******************************************************************
  1918
  1919 01  DATE-CONVERSION-DATA.
  1920     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1921     12  DC-OPTION-CODE                PIC X.
  1922         88  BIN-TO-GREG                VALUE ' '.
  1923         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1924         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1925         88  YMD-GREG-TO-BIN            VALUE '3'.
  1926         88  MDY-GREG-TO-BIN            VALUE '4'.
  1927         88  JULIAN-TO-BIN              VALUE '5'.
  1928         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1929         88  FIND-CENTURY               VALUE '7'.
  1930         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1931         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1932         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1933         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1934         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1935         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1936         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1937         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1938         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1939         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1940         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1941         88  BIN-3-TO-GREG              VALUE 'I'.
  1942         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1943         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1944         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1945         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1946         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1947         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1948         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1949         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1950         88  THREE-CHARACTER-BIN
  1951                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1952         88  GREGORIAN-TO-BIN
  1953                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1954         88  BIN-TO-GREGORIAN
  1955                  VALUES ' ' '1' 'I' '8' 'G'.
  1956         88  JULIAN-TO-BINARY
  1957                  VALUES '5' 'C' 'E' 'F'.
  1958     12  DC-ERROR-CODE                 PIC X.
  1959         88  NO-CONVERSION-ERROR        VALUE ' '.
  1960         88  DATE-CONVERSION-ERROR
  1961                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1962         88  DATE-IS-ZERO               VALUE '1'.
  1963         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  39
* EL130.cbl
  1964         88  DATE-IS-INVALID            VALUE '3'.
  1965         88  DATE1-GREATER-DATE2        VALUE '4'.
  1966         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1967         88  DATE-INVALID-OPTION        VALUE '9'.
  1968         88  INVALID-CENTURY            VALUE 'A'.
  1969         88  ONLY-CENTURY               VALUE 'B'.
  1970         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1971         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1972     12  DC-END-OF-MONTH               PIC X.
  1973         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1974     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1975         88  USE-NORMAL-PROCESS         VALUE ' '.
  1976         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1977         88  ADJUST-UP-100-YRS          VALUE '2'.
  1978     12  FILLER                        PIC X.
  1979     12  DC-CONVERSION-DATES.
  1980         16  DC-BIN-DATE-1             PIC XX.
  1981         16  DC-BIN-DATE-2             PIC XX.
  1982         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1983         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1984                       DC-GREG-DATE-1-EDIT.
  1985             20  DC-EDIT1-MONTH        PIC 99.
  1986             20  SLASH1-1              PIC X.
  1987             20  DC-EDIT1-DAY          PIC 99.
  1988             20  SLASH1-2              PIC X.
  1989             20  DC-EDIT1-YEAR         PIC 99.
  1990         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1991         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1992                     DC-GREG-DATE-2-EDIT.
  1993             20  DC-EDIT2-MONTH        PIC 99.
  1994             20  SLASH2-1              PIC X.
  1995             20  DC-EDIT2-DAY          PIC 99.
  1996             20  SLASH2-2              PIC X.
  1997             20  DC-EDIT2-YEAR         PIC 99.
  1998         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1999         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2000                     DC-GREG-DATE-1-YMD.
  2001             20  DC-YMD-YEAR           PIC 99.
  2002             20  DC-YMD-MONTH          PIC 99.
  2003             20  DC-YMD-DAY            PIC 99.
  2004         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2005         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2006                      DC-GREG-DATE-1-MDY.
  2007             20  DC-MDY-MONTH          PIC 99.
  2008             20  DC-MDY-DAY            PIC 99.
  2009             20  DC-MDY-YEAR           PIC 99.
  2010         16  DC-GREG-DATE-1-ALPHA.
  2011             20  DC-ALPHA-MONTH        PIC X(10).
  2012             20  DC-ALPHA-DAY          PIC 99.
  2013             20  FILLER                PIC XX.
  2014             20  DC-ALPHA-CENTURY.
  2015                 24 DC-ALPHA-CEN-N     PIC 99.
  2016             20  DC-ALPHA-YEAR         PIC 99.
  2017         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2018         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2019         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2020         16  DC-JULIAN-DATE            PIC 9(05).
  2021         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  40
* EL130.cbl
  2022                                       PIC 9(05).
  2023         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2024             20  DC-JULIAN-YEAR        PIC 99.
  2025             20  DC-JULIAN-DAYS        PIC 999.
  2026         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2027         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2028         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2029     12  DATE-CONVERSION-VARIBLES.
  2030         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2031         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2032             20  FILLER                PIC 9(3).
  2033             20  HOLD-CEN-1-CCYY.
  2034                 24  HOLD-CEN-1-CC     PIC 99.
  2035                 24  HOLD-CEN-1-YY     PIC 99.
  2036             20  HOLD-CEN-1-MO         PIC 99.
  2037             20  HOLD-CEN-1-DA         PIC 99.
  2038         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2039             20  HOLD-CEN-1-R-MO       PIC 99.
  2040             20  HOLD-CEN-1-R-DA       PIC 99.
  2041             20  HOLD-CEN-1-R-CCYY.
  2042                 24  HOLD-CEN-1-R-CC   PIC 99.
  2043                 24  HOLD-CEN-1-R-YY   PIC 99.
  2044             20  FILLER                PIC 9(3).
  2045         16  HOLD-CENTURY-1-X.
  2046             20  FILLER                PIC X(3)  VALUE SPACES.
  2047             20  HOLD-CEN-1-X-CCYY.
  2048                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2049                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2050             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2051             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2052         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2053             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2054             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2055             20  HOLD-CEN-1-R-X-CCYY.
  2056                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2057                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2058             20  FILLER                PIC XXX.
  2059         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2060         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2061         16  DC-JULIAN-DATE-1          PIC 9(07).
  2062         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2063             20  DC-JULIAN-1-CCYY.
  2064                 24  DC-JULIAN-1-CC    PIC 99.
  2065                 24  DC-JULIAN-1-YR    PIC 99.
  2066             20  DC-JULIAN-DA-1        PIC 999.
  2067         16  DC-JULIAN-DATE-2          PIC 9(07).
  2068         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2069             20  DC-JULIAN-2-CCYY.
  2070                 24  DC-JULIAN-2-CC    PIC 99.
  2071                 24  DC-JULIAN-2-YR    PIC 99.
  2072             20  DC-JULIAN-DA-2        PIC 999.
  2073         16  DC-GREG-DATE-A-EDIT.
  2074             20  DC-EDITA-MONTH        PIC 99.
  2075             20  SLASHA-1              PIC X VALUE '/'.
  2076             20  DC-EDITA-DAY          PIC 99.
  2077             20  SLASHA-2              PIC X VALUE '/'.
  2078             20  DC-EDITA-CCYY.
  2079                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  41
* EL130.cbl
  2080                 24  DC-EDITA-YEAR     PIC 99.
  2081         16  DC-GREG-DATE-B-EDIT.
  2082             20  DC-EDITB-MONTH        PIC 99.
  2083             20  SLASHB-1              PIC X VALUE '/'.
  2084             20  DC-EDITB-DAY          PIC 99.
  2085             20  SLASHB-2              PIC X VALUE '/'.
  2086             20  DC-EDITB-CCYY.
  2087                 24  DC-EDITB-CENT     PIC 99.
  2088                 24  DC-EDITB-YEAR     PIC 99.
  2089         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2090         16  DC-GREG-DATE-CYMD-R REDEFINES
  2091                              DC-GREG-DATE-CYMD.
  2092             20  DC-CYMD-CEN           PIC 99.
  2093             20  DC-CYMD-YEAR          PIC 99.
  2094             20  DC-CYMD-MONTH         PIC 99.
  2095             20  DC-CYMD-DAY           PIC 99.
  2096         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2097         16  DC-GREG-DATE-MDCY-R REDEFINES
  2098                              DC-GREG-DATE-MDCY.
  2099             20  DC-MDCY-MONTH         PIC 99.
  2100             20  DC-MDCY-DAY           PIC 99.
  2101             20  DC-MDCY-CEN           PIC 99.
  2102             20  DC-MDCY-YEAR          PIC 99.
  2103    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2104        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2105    12  DC-EL310-DATE                  PIC X(21).
  2106    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  42
* EL130.cbl
  2108*    COPY ELCCALC.
  2109******************************************************************
  2110*                                                                *
  2111*                           ELCCALC.                            *
  2112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2113*                            VMOD=2.025                          *
  2114*                                                                *
  2115*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2116*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2117*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2118*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2119*                                                                *
  2120*  PASSED TO ELRTRM                                              *
  2121*  -----------------                                             *
  2122*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2123*  ORIGINAL TERM                                                 *
  2124*  BEGINNING DATE                                                *
  2125*  ENDING DATE                                                   *
  2126*  COMPANY I.D.                                                  *
  2127*  ACCOUNT MASTER USER FIELD                                     *
  2128*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2129*  FREE LOOK DAYS                                                *
  2130*                                                                *
  2131*  RETURNED FROM ELRTRM                                          *
  2132*  ---------------------                                         *
  2133*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2134*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2135*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2136*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2137*----------------------------------------------------------------*
  2138*  PASSED TO ELRAMT                                              *
  2139*  ----------------                                              *
  2140*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2141*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2142*  ORIGINAL AMOUNT                                               *
  2143*  ALTERNATE BENEFIT (BALLON)                                    *
  2144*  A.P.R. - NET PAY ONLY                                         *
  2145*  METHOD
  2146*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2147*  COMPANY I.D.                                                  *
  2148*  BENEFIT TYPE                                                  *
  2149*                                                                *
  2150*  RETURNED FROM ELRAMT                                          *
  2151*  --------------------                                          *
  2152*  REMAINING AMOUNT 1 - CURRENT                                  *
  2153*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2154*  REMAINING AMOUNT FACTOR
  2155*----------------------------------------------------------------*
  2156*  PASSED TO ELRESV                                              *
  2157*  -----------------                                             *
  2158*  CERTIFICATE EFFECTIVE DATE                                    *
  2159*  VALUATION DATE                                                *
  2160*  PAID THRU DATE                                                *
  2161*  BENEFIT                                                       *
  2162*  INCURRED DATE                                                 *
  2163*  REPORTED DATE                                                 *
  2164*  ISSUE AGE                                                     *
  2165*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  43
* EL130.cbl
  2166*  CDT PERCENT                                                   *
  2167*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2168* *CLAIM TYPE (LIFE, A/H)                                        *
  2169* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2170* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2171*                                                                *
  2172*  RETURNED FROM ELRESV                                          *
  2173*  --------------------                                          *
  2174*  CDT TABLE USED                                                *
  2175*  CDT FACTOR USED                                               *
  2176*  PAY TO CURRENT RESERVE                                        *
  2177*  I.B.N.R. - A/H ONLY                                           *
  2178*  FUTURE (ACCRUED) AH ONLY                                      *
  2179*----------------------------------------------------------------*
  2180*  PASSED TO ELRATE                                              *
  2181*  ----------------                                              *
  2182*  CERT ISSUE DATE                                               *
  2183*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2184*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2185*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2186*  STATE CODE (CLIENT DEFINED)                                   *
  2187*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2188*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2189*  DEVIATION CODE                                                *
  2190*  ISSUE AGE                                                     *
  2191*  ORIGINAL BENEFIT AMOUNT                                       *
  2192*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2193*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2194*  BENEFIT KIND (LIFE OR A/H)                                    *
  2195*  A.P.R.                                                        *
  2196*  METHOD
  2197*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2198*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2199*  COMPANY I.D. (3 CHARACTER)                                    *
  2200*  BENEFIT CODE                                                  *
  2201*  BENEFIT OVERRIDE CODE                                         *
  2202*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2203*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2204*  JOINT INDICATOR (CSL ONLY)                                    *
  2205*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2206*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2207*                                                                *
  2208*  RETURNED FROM ELRATE                                          *
  2209*  --------------------                                          *
  2210*  CALCULATED PREMIUM                                            *
  2211*  PREMIUM RATE                                                  *
  2212*  MORTALITY CODE                                                *
  2213*  MAX ATTAINED AGE                                              *
  2214*  MAX AGE                                                       *
  2215*  MAX TERM                                                      *
  2216*  MAX MONTHLY BENEFIT                                           *
  2217*  MAX TOTAL BENIFIT                                             *
  2218*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2219*----------------------------------------------------------------*
  2220*  PASSED TO ELRFND                                              *
  2221*  ----------------                                              *
  2222*  CERT ISSUE DATE                                               *
  2223*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  44
* EL130.cbl
  2224*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2225*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2226*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2227*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2228*  STATE CODE (CLIENT DEFINED)                                   *
  2229*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2230*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2231*  DEVIATION CODE                                                *
  2232*  ISSUE AGE                                                     *
  2233*  ORIGINAL BENEFIT AMOUNT                                       *
  2234*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2235*  PROCESS TYPE (CANCEL)                                         *
  2236*  BENEFIT KIND (LIFE OR A/H)                                    *
  2237*  A.P.R.                                                        *
  2238*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2239*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2240*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2241*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2242*  COMPANY I.D. (3 CHARACTER)                                    *
  2243*  BENEFIT CODE                                                  *
  2244*  BENEFIT OVERRIDE CODE                                         *
  2245*                                                                *
  2246*  RETURNED FROM ELRFND                                          *
  2247*  --------------------                                          *
  2248*  CALCULATED REFUND                                             *
  2249*----------------------------------------------------------------*
  2250*  PASSED TO ELEARN                                              *
  2251*  ----------------                                              *
  2252*  CERT ISSUE DATE                                               *
  2253*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2254*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2255*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2256*  STATE CODE (CLIENT DEFINED)                                   *
  2257*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2258*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2259*  DEVIATION CODE                                                *
  2260*  ISSUE AGE                                                     *
  2261*  ORIGINAL BENEFIT AMOUNT                                       *
  2262*  BENEFIT KIND (LIFE OR A/H)                                    *
  2263*  A.P.R.                                                        *
  2264*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2265*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2266*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2267*  COMPANY I.D. (3 CHARACTER)                                    *
  2268*  BENEFIT CODE                                                  *
  2269*  BENEFIT OVERRIDE CODE                                         *
  2270*                                                                *
  2271*  RETURNED FROM ELEARN                                          *
  2272*  --------------------                                          *
  2273*  INDICATED  EARNINGS                                           *
  2274*----------------------------------------------------------------*
  2275*                 LENGTH = 450                                   *
  2276*                                                                *
  2277******************************************************************
  2278******************************************************************
  2279*                   C H A N G E   L O G
  2280*
  2281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  45
* EL130.cbl
  2282*-----------------------------------------------------------------
  2283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2284* EFFECTIVE    NUMBER
  2285*-----------------------------------------------------------------
  2286* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2287* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2288* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2289* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2290* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2291* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2292* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2293******************************************************************
  2294
  2295 01  CALCULATION-PASS-AREA.
  2296     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2297                                     COMP.
  2298
  2299     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2300       88  NO-CP-ERROR                             VALUE ZERO.
  2301       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2302                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2303       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2304       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2305       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2306       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2307       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2308       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2309       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2310       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2311       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2312       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2313       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2314       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2315       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2316       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2317       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2318       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2319       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2320
  2321     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2322       88  NO-CP-ERROR-2                           VALUE ZERO.
  2323***********************  INPUT AREAS ****************************
  2324
  2325     12  CP-CALCULATION-AREA.
  2326         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2327         16  CP-CERT-EFF-DT        PIC XX.
  2328         16  CP-VALUATION-DT       PIC XX.
  2329         16  CP-PAID-THRU-DT       PIC XX.
  2330         16  CP-BENEFIT-TYPE       PIC X.
  2331           88  CP-AH                               VALUE 'A' 'D'
  2332                                                   'I' 'U'.
  2333           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2334           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2335         16  CP-INCURRED-DT        PIC XX.
  2336         16  CP-REPORTED-DT        PIC XX.
  2337         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2338         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2339         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  46
* EL130.cbl
  2340                                     COMP-3.
  2341         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2342                                     COMP-3.
  2343         16  CP-CDT-METHOD         PIC X.
  2344           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2345           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2346           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2347         16  CP-CLAIM-TYPE         PIC X.
  2348           88  CP-AH-CLAIM                         VALUE 'A'.
  2349           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2350         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2351                                     COMP-3.
  2352         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2353                                     COMP-3.
  2354         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2355                                     COMP-3.
  2356         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2357                                     COMP-3.
  2358         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2359                                     COMP-3.
  2360         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2361                                     COMP-3.
  2362         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2363                                     COMP-3.
  2364         16  CP-REM-TERM-METHOD    PIC X.
  2365           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2366           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2367           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2368           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2369           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2370           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2371           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2372         16  CP-EARNING-METHOD     PIC X.
  2373           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2374           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2375           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2376           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2377           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2378           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2379           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2380           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2381           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2382           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2383           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2384           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2385         16  CP-PROCESS-TYPE       PIC X.
  2386           88  CP-CLAIM                            VALUE '1'.
  2387           88  CP-CANCEL                           VALUE '2'.
  2388           88  CP-ISSUE                            VALUE '3'.
  2389         16  CP-SPECIAL-CALC-CD    PIC X.
  2390           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2391           88  CP-1-MTH-INTEREST               VALUE ' '.
  2392           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2393           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2394           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2395           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2396           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2397           88  CP-FARM-PLAN                    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  47
* EL130.cbl
  2398           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2399           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2400           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2401           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2402           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2403           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2404           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2405           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2406           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2407           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2408                                                     'W' 'X'.
  2409           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2410           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2411           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2412           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2413           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2414           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2415           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2416           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2417           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2418           88  CP-CSL-METH-1                   VALUE '5'.
  2419           88  CP-CSL-METH-2                   VALUE '6'.
  2420           88  CP-CSL-METH-3                   VALUE '7'.
  2421           88  CP-CSL-METH-4                   VALUE '8'.
  2422
  2423         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2424                                     COMP-3.
  2425         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2426         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2427         16  CP-STATE              PIC XX          VALUE SPACE.
  2428         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2429         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2430           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2431               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2432         16  CP-R78-OPTION         PIC X.
  2433           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2434           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2435
  2436         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2437         16  CP-IBNR-RESERVE-SW    PIC X.
  2438         16  CP-CLAIM-STATUS       PIC X.
  2439         16  CP-RATE-FILE          PIC X.
  2440         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2441                                     COMP-3.
  2442
  2443         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2444         16  CP-AH-OVERRIDE-CODE   PIC X.
  2445
  2446         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2447                                     COMP-3.
  2448         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2449                                     COMP-3.
  2450         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2451                                     COMP-3.
  2452         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2453                                     COMP-3.
  2454
  2455         16  CP-PAID-FROM-DATE     PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  48
* EL130.cbl
  2456         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2457         16  CP-EXT-DAYS-CALC      PIC X.
  2458           88  CP-EXT-NO-CHG                   VALUE ' '.
  2459           88  CP-EXT-CHG-LF                   VALUE '1'.
  2460           88  CP-EXT-CHG-AH                   VALUE '2'.
  2461           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2462         16  CP-DOMICILE-STATE     PIC XX.
  2463         16  CP-CARRIER            PIC X.
  2464         16  CP-REIN-FLAG          PIC X.
  2465         16  CP-REM-TRM-CALC-OPTION PIC X.
  2466           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2467                      '2' '3' '4' '5'.
  2468           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2469           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2470           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2471           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2472           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2473           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2474           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2475           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2476         16  CP-SIG-SWITCH         PIC X.
  2477         16  CP-RATING-METHOD      PIC X.
  2478           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2479           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2480           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2481           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2482           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2483           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2484           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2485           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2486           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2487         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2488                                     COMP-3.
  2489         16  CP-BEN-CATEGORY       PIC X.
  2490         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2491         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2492                                   PIC S99V9(5) COMP-3.
  2493         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2494         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2495                                   PIC S99V9(5) COMP-3.
  2496         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2497         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2498         16  CP-EXPIRE-DT          PIC XX.
  2499         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2500         16  FILLER                PIC X(35).
  2501*        16  FILLER                PIC X(50).
  2502
  2503***************    OUTPUT FROM ELRESV   ************************
  2504
  2505         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2506
  2507         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2508                                     COMP-3.
  2509         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2510                                     COMP-3.
  2511         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2512                                     COMP-3.
  2513         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  49
* EL130.cbl
  2514                                     COMP-3.
  2515         16  FILLER                PIC X(09).
  2516***************    OUTPUT FROM ELRTRM   *************************
  2517
  2518         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2519                                     COMP-3.
  2520         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2521                                     COMP-3.
  2522         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2523                                     COMP-3.
  2524         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2525                                     COMP-3.
  2526         16  FILLER                PIC X(12).
  2527
  2528***************    OUTPUT FROM ELRAMT   *************************
  2529
  2530         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2531                                     COMP-3.
  2532         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2533                                     COMP-3.
  2534         16  FILLER                PIC X(12).
  2535
  2536***************    OUTPUT FROM ELRATE   *************************
  2537
  2538         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2539                                     COMP-3.
  2540         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2541                                     COMP-3.
  2542         16  CP-MORTALITY-CODE     PIC X(4).
  2543         16  CP-RATE-EDIT-FLAG     PIC X.
  2544             88  CP-RATES-NEED-APR                  VALUE '1'.
  2545         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2546                                     COMP-3.
  2547         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2548         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2549         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2550                                   PIC S9(7)V99 COMP-3.
  2551         16  FILLER                PIC X(07).
  2552
  2553***************    OUTPUT FROM ELRFND   *************************
  2554
  2555         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2556                                     COMP-3.
  2557         16  CP-REFUND-TYPE-USED   PIC X.
  2558           88  CP-R-AS-R78                         VALUE '1'.
  2559           88  CP-R-AS-PRORATA                     VALUE '2'.
  2560           88  CP-R-AS-CALIF                       VALUE '3'.
  2561           88  CP-R-AS-TEXAS                       VALUE '4'.
  2562           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2563           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2564           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2565           88  CP-R-AS-MEAN                        VALUE '8'.
  2566           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2567           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2568           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2569         16  FILLER                PIC X(12).
  2570
  2571***************    OUTPUT FROM ELEARN   *************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  50
* EL130.cbl
  2572
  2573         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2574                                     COMP-3.
  2575         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2576                                     COMP-3.
  2577         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2578                                     COMP-3.
  2579         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2580                                     COMP-3.
  2581         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2582                                     COMP-3.
  2583         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2584                                     COMP-3.
  2585         16  CP-EARNING-TYPE-USED  PIC X.
  2586           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2587           88  CP-E-AS-R78                         VALUE '1'.
  2588           88  CP-E-AS-PRORATA                     VALUE '2'.
  2589           88  CP-E-AS-TEXAS                       VALUE '4'.
  2590           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2591           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2592           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2593           88  CP-E-AS-MEAN                        VALUE '8'.
  2594           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2595         16  FILLER                PIC X(12).
  2596
  2597***************    OUTPUT FROM ELPMNT   *************************
  2598
  2599         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2600                                     COMP-3.
  2601         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2602                                     COMP-3.
  2603         16  FILLER                PIC X(12).
  2604
  2605***************   MISC WORK AREAS    *****************************
  2606         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2607                                     COMP-3.
  2608         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2609                                     COMP-3.
  2610         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2611                                     COMP-3.
  2612         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2613                                     COMP-3.
  2614         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2615                                     COMP-3.
  2616         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2617                                     COMP-3.
  2618         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2619             88  OPEN-RATE-FILE                   VALUE 'O'.
  2620             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2621             88  IO-ERROR                         VALUE 'E'.
  2622
  2623         16  CP-FIRST-PAY-DATE     PIC XX.
  2624
  2625         16  CP-JOINT-INDICATOR    PIC X.
  2626
  2627         16  CP-RESERVE-REMAINING-TERM
  2628                                   PIC S9(4)V9    VALUE ZERO
  2629                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  51
* EL130.cbl
  2630
  2631         16  CP-INSURED-BIRTH-DT   PIC XX.
  2632
  2633         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2634                                     COMP-3.
  2635
  2636         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2637                                     COMP-3.
  2638
  2639         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2640                                     COMP-3.
  2641
  2642         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2643                                     COMP-3.
  2644
  2645         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2646                                     COMP-3.
  2647
  2648         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2649                                     COMP-3.
  2650
  2651         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2652                                     COMP-3.
  2653
  2654         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2655             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2656
  2657         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2658                                     COMP-3.
  2659         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2660                                     COMP-3.
  2661         16  FILLER                PIC X(17).
  2662******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  52
* EL130.cbl
  2664*    COPY ELCLOGOF.
  2665******************************************************************
  2666*                                                                *
  2667*                                                                *
  2668*                            ELCLOGOF.                           *
  2669*                            VMOD=2.001                          *
  2670*                                                                *
  2671*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2672*                                                                *
  2673******************************************************************
  2674 01  CLASIC-LOGOFF.
  2675     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2676     12  LOGOFF-TEXT.
  2677         16  FILLER          PIC X(5)    VALUE SPACES.
  2678         16  LOGOFF-MSG.
  2679             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2680             20  FILLER      PIC X       VALUE SPACES.
  2681             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2682         16  FILLER          PIC X(80)
  2683           VALUE '* YOU ARE NOW LOGGED OFF'.
  2684         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2685         16  FILLER          PIC X       VALUE QUOTE.
  2686         16  LOGOFF-SYS-MSG  PIC X(17)
  2687           VALUE 'S CLAS-IC SYSTEM '.
  2688     12  TEXT-MESSAGES.
  2689         16  UNACCESS-MSG    PIC X(29)
  2690             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2691         16  PGMIDERR-MSG    PIC X(17)
  2692             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  53
* EL130.cbl
  2694*    COPY ELCATTR.
  2695******************************************************************
  2696*                                                                *
  2697*                            ELCATTR.                            *
  2698*                            VMOD=2.001                          *
  2699*                                                                *
  2700*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2701*                                                                *
  2702*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2703*                                                                *
  2704*                   POS 1   P=PROTECTED                          *
  2705*                           U=UNPROTECTED                        *
  2706*                           S=ASKIP                              *
  2707*                   POS 2   A=ALPHA/NUMERIC                      *
  2708*                           N=NUMERIC                            *
  2709*                   POS 3   N=NORMAL                             *
  2710*                           B=BRIGHT                             *
  2711*                           D=DARK                               *
  2712*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2713*                           OF=MODIFIED DATA TAG OFF             *
  2714*                                                                *
  2715*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2716******************************************************************
  2717 01  ATTRIBUTE-LIST.
  2718     12  AL-PABOF            PIC X       VALUE 'Y'.
  2719     12  AL-PABON            PIC X       VALUE 'Z'.
  2720     12  AL-PADOF            PIC X       VALUE '%'.
  2721     12  AL-PADON            PIC X       VALUE '_'.
  2722     12  AL-PANOF            PIC X       VALUE '-'.
  2723     12  AL-PANON            PIC X       VALUE '/'.
  2724     12  AL-SABOF            PIC X       VALUE '8'.
  2725     12  AL-SABON            PIC X       VALUE '9'.
  2726     12  AL-SADOF            PIC X       VALUE '@'.
  2727     12  AL-SADON            PIC X       VALUE QUOTE.
  2728     12  AL-SANOF            PIC X       VALUE '0'.
  2729     12  AL-SANON            PIC X       VALUE '1'.
  2730     12  AL-UABOF            PIC X       VALUE 'H'.
  2731     12  AL-UABON            PIC X       VALUE 'I'.
  2732     12  AL-UADOF            PIC X       VALUE '<'.
  2733     12  AL-UADON            PIC X       VALUE '('.
  2734     12  AL-UANOF            PIC X       VALUE ' '.
  2735     12  AL-UANON            PIC X       VALUE 'A'.
  2736     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2737     12  AL-UNBON            PIC X       VALUE 'R'.
  2738     12  AL-UNDOF            PIC X       VALUE '*'.
  2739     12  AL-UNDON            PIC X       VALUE ')'.
  2740     12  AL-UNNOF            PIC X       VALUE '&'.
  2741     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  54
* EL130.cbl
  2743*    COPY ELCEMIB.
  2744******************************************************************
  2745*                                                                *
  2746*                                                                *
  2747*                            ELCEMIB.                            *
  2748*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2749*                            VMOD=2.005                          *
  2750*                                                                *
  2751*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2752*                                                                *
  2753******************************************************************
  2754 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2755     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2756     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2757     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2758     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2759     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2760     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2761     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2762     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2763     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2764         88  EMI-NO-ERRORS                    VALUE '1'.
  2765         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2766         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2767     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2768         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2769     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2770         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2771         88  EMI-AREA1-FULL                   VALUE '2'.
  2772     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2773         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2774         88  EMI-AREA2-FULL                   VALUE '2'.
  2775     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2776         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2777         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2778         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2779         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2780         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2781     12  EMI-ERROR-LINES.
  2782         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2783         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2784         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2785         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2786             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2787                 24  EMI-ERR-NUM         PIC X(4).
  2788                 24  EMI-FILLER          PIC X.
  2789                 24  EMI-SEV             PIC X.
  2790                 24  FILLER              PIC X.
  2791             20  FILLER                  PIC X(02).
  2792     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2793         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2794             20  EMI-ERROR-NUMBER    PIC X(4).
  2795             20  EMI-FILL            PIC X.
  2796             20  EMI-SEVERITY        PIC X.
  2797             20  FILLER              PIC X.
  2798             20  EMI-ERROR-TEXT.
  2799                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2800                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  55
* EL130.cbl
  2801     12  EMI-SEVERITY-SAVE           PIC X.
  2802         88  EMI-NOTE                    VALUE 'N'.
  2803         88  EMI-WARNING                 VALUE 'W'.
  2804         88  EMI-FORCABLE                VALUE 'F'.
  2805         88  EMI-FATAL                   VALUE 'X'.
  2806     12  EMI-MESSAGE-FLAG            PIC X.
  2807         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2808         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2809     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2810     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2811         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2812         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2813         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2814     12  FILLER                      PIC X(137)  VALUE SPACES.
  2815     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2816     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2817     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2818     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  56
* EL130.cbl
  2820*    COPY ELCJPFX.
  2821******************************************************************
  2822*                                                                *
  2823*                                                                *
  2824*                            ELCJPFX.                            *
  2825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2826*                            VMOD=2.002                          *
  2827*                                                                *
  2828*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2829*                                                                *
  2830*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2831*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2832*        ELCNTL - CONTROL FILE                                   *
  2833*        ELMSTR - CLAIM MASTERS                                  *
  2834*        ELTRLR - ACTIVITY TRAILERS                              *
  2835*        ELCHKQ - CHECK QUE                                      *
  2836******************************************************************
  2837 01  JOURNAL-RECORD.
  2838     12  JP-USER-ID                  PIC X(4).
  2839     12  JP-FILE-ID                  PIC X(8).
  2840     12  JP-PROGRAM-ID               PIC X(8).
  2841     12  JP-RECORD-TYPE              PIC X.
  2842         88 JP-ADD              VALUE 'A'.
  2843         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2844         88 JP-AFTER-CHANGE     VALUE 'C'.
  2845         88 JP-DELETE           VALUE 'D'.
  2846         88 JP-GENERIC-DELETE   VALUE 'G'.
  2847         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2848         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2849     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2850     12  JP-RECORD-AREA
  2851
  2852
  2853         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  57
* EL130.cbl
  2855*    COPY ELCAID.
  2856******************************************************************
  2857*                                                                *
  2858*                            ELCAID.                             *
  2859*                            VMOD=2.001                          *
  2860*                                                                *
  2861*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2862*                                                                *
  2863*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2864*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2865******************************************************************
  2866
  2867 01  DFHAID.
  2868   02  DFHNULL   PIC  X  VALUE  ' '.
  2869   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2870   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2871   02  DFHPEN    PIC  X  VALUE  '='.
  2872   02  DFHOPID   PIC  X  VALUE  'W'.
  2873   02  DFHPA1    PIC  X  VALUE  '%'.
  2874   02  DFHPA2    PIC  X  VALUE  '>'.
  2875   02  DFHPA3    PIC  X  VALUE  ','.
  2876   02  DFHPF1    PIC  X  VALUE  '1'.
  2877   02  DFHPF2    PIC  X  VALUE  '2'.
  2878   02  DFHPF3    PIC  X  VALUE  '3'.
  2879   02  DFHPF4    PIC  X  VALUE  '4'.
  2880   02  DFHPF5    PIC  X  VALUE  '5'.
  2881   02  DFHPF6    PIC  X  VALUE  '6'.
  2882   02  DFHPF7    PIC  X  VALUE  '7'.
  2883   02  DFHPF8    PIC  X  VALUE  '8'.
  2884   02  DFHPF9    PIC  X  VALUE  '9'.
  2885   02  DFHPF10   PIC  X  VALUE  ':'.
  2886   02  DFHPF11   PIC  X  VALUE  '#'.
  2887   02  DFHPF12   PIC  X  VALUE  '@'.
  2888   02  DFHPF13   PIC  X  VALUE  'A'.
  2889   02  DFHPF14   PIC  X  VALUE  'B'.
  2890   02  DFHPF15   PIC  X  VALUE  'C'.
  2891   02  DFHPF16   PIC  X  VALUE  'D'.
  2892   02  DFHPF17   PIC  X  VALUE  'E'.
  2893   02  DFHPF18   PIC  X  VALUE  'F'.
  2894   02  DFHPF19   PIC  X  VALUE  'G'.
  2895   02  DFHPF20   PIC  X  VALUE  'H'.
  2896   02  DFHPF21   PIC  X  VALUE  'I'.
  2897*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2898   02  DFHPF22   PIC  X  VALUE  '['.
  2899   02  DFHPF23   PIC  X  VALUE  '.'.
  2900   02  DFHPF24   PIC  X  VALUE  '<'.
  2901   02  DFHMSRE   PIC  X  VALUE  'X'.
  2902   02  DFHSTRF   PIC  X  VALUE  'h'.
  2903   02  DFHTRIG   PIC  X  VALUE  '"'.
  2904
  2905 01  FILLER    REDEFINES DFHAID.
  2906     12  FILLER              PIC X(8).
  2907     12  PF-VALUES           PIC X       OCCURS 12.
  2908
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  58
* EL130.cbl
  2910****************************************************************
  2911*
  2912* Copyright (c) 2007 by Clerity Solutions, Inc.
  2913* All rights reserved.
  2914*
  2915****************************************************************
  2916 01  DFHEIV.
  2917   02  DFHEIV0               PIC X(35).
  2918   02  DFHEIV1               PIC X(08).
  2919   02  DFHEIV2               PIC X(08).
  2920   02  DFHEIV3               PIC X(08).
  2921   02  DFHEIV4               PIC X(06).
  2922   02  DFHEIV5               PIC X(04).
  2923   02  DFHEIV6               PIC X(04).
  2924   02  DFHEIV7               PIC X(02).
  2925   02  DFHEIV8               PIC X(02).
  2926   02  DFHEIV9               PIC X(01).
  2927   02  DFHEIV10              PIC S9(7) COMP-3.
  2928   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2929   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2930   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2931   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2932   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2933   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2934   02  DFHEIV17              PIC X(04).
  2935   02  DFHEIV18              PIC X(04).
  2936   02  DFHEIV19              PIC X(04).
  2937   02  DFHEIV20              USAGE IS POINTER.
  2938   02  DFHEIV21              USAGE IS POINTER.
  2939   02  DFHEIV22              USAGE IS POINTER.
  2940   02  DFHEIV23              USAGE IS POINTER.
  2941   02  DFHEIV24              USAGE IS POINTER.
  2942   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2943   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2944   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2945   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2946   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2947   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2948   02  FILLER                PIC X(02).
  2949   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2950   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2951   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2952   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2953   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2954 LINKAGE  SECTION.
  2955*****************************************************************
  2956*                                                               *
  2957* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2958* All rights reserved.                                          *
  2959*                                                               *
  2960*****************************************************************
  2961 01  dfheiblk.
  2962     02  eibtime          pic s9(7) comp-3.
  2963     02  eibdate          pic s9(7) comp-3.
  2964     02  eibtrnid         pic x(4).
  2965     02  eibtaskn         pic s9(7) comp-3.
  2966     02  eibtrmid         pic x(4).
  2967     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  59
* EL130.cbl
  2968     02  eibcposn         pic s9(4) comp.
  2969     02  eibcalen         pic s9(4) comp.
  2970     02  eibaid           pic x(1).
  2971     02  eibfiller1       pic x(1).
  2972     02  eibfn            pic x(2).
  2973     02  eibfiller2       pic x(2).
  2974     02  eibrcode         pic x(6).
  2975     02  eibfiller3       pic x(2).
  2976     02  eibds            pic x(8).
  2977     02  eibreqid         pic x(8).
  2978     02  eibrsrce         pic x(8).
  2979     02  eibsync          pic x(1).
  2980     02  eibfree          pic x(1).
  2981     02  eibrecv          pic x(1).
  2982     02  eibsend          pic x(1).
  2983     02  eibatt           pic x(1).
  2984     02  eibeoc           pic x(1).
  2985     02  eibfmh           pic x(1).
  2986     02  eibcompl         pic x(1).
  2987     02  eibsig           pic x(1).
  2988     02  eibconf          pic x(1).
  2989     02  eiberr           pic x(1).
  2990     02  eibrldbk         pic x(1).
  2991     02  eiberrcd         pic x(4).
  2992     02  eibsynrb         pic x(1).
  2993     02  eibnodat         pic x(1).
  2994     02  eibfiller5       pic x(2).
  2995     02  eibresp          pic 9(09) comp.
  2996     02  eibresp2         pic 9(09) comp.
  2997     02  dfheigdj         pic s9(4) comp.
  2998     02  dfheigdk         pic s9(4) comp.
  2999
  3000 01  DFHCOMMAREA             PIC X(1024).
  3001
  3002*01 PARMLIST .
  3003*    02  FILLER              PIC S9(8)   COMP.
  3004*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3005*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3006*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3007*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3008*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3009*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3010*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3011*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3012*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  60
* EL130.cbl
  3014*    COPY ELCMSTR.
  3015******************************************************************
  3016*                                                                *
  3017*                            ELCMSTR.                            *
  3018*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3019*                            VMOD=2.012                          *
  3020*                                                                *
  3021*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3022*                                                                *
  3023*   FILE TYPE = VSAM,KSDS                                        *
  3024*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3025*                                                                *
  3026*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3027*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3028*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3029*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3030*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3031*                                                 RKP=75,LEN=21  *
  3032*                                                                *
  3033*   **** NOTE ****                                               *
  3034*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3035*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3036*                                                                *
  3037*   LOG = YES                                                    *
  3038*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3039******************************************************************
  3040*                   C H A N G E   L O G
  3041*
  3042* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3043*-----------------------------------------------------------------
  3044*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3045* EFFECTIVE    NUMBER
  3046*-----------------------------------------------------------------
  3047* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3048* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3049******************************************************************
  3050 01  CLAIM-MASTER.
  3051     12  CL-RECORD-ID                PIC XX.
  3052         88  VALID-CL-ID         VALUE 'CL'.
  3053
  3054     12  CL-CONTROL-PRIMARY.
  3055         16  CL-COMPANY-CD           PIC X.
  3056         16  CL-CARRIER              PIC X.
  3057         16  CL-CLAIM-NO             PIC X(7).
  3058         16  CL-CERT-NO.
  3059             20  CL-CERT-PRIME       PIC X(10).
  3060             20  CL-CERT-SFX         PIC X.
  3061
  3062     12  CL-CONTROL-BY-NAME.
  3063         16  CL-COMPANY-CD-A1        PIC X.
  3064         16  CL-INSURED-LAST-NAME    PIC X(15).
  3065         16  CL-INSURED-NAME.
  3066             20  CL-INSURED-1ST-NAME PIC X(12).
  3067             20  CL-INSURED-MID-INIT PIC X.
  3068
  3069     12  CL-CONTROL-BY-SSN.
  3070         16  CL-COMPANY-CD-A2        PIC X.
  3071         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  61
* EL130.cbl
  3072             20  CL-SSN-STATE        PIC XX.
  3073             20  CL-SSN-ACCOUNT      PIC X(6).
  3074             20  CL-SSN-LN3          PIC X(3).
  3075
  3076     12  CL-CONTROL-BY-CERT-NO.
  3077         16  CL-COMPANY-CD-A4        PIC X.
  3078         16  CL-CERT-NO-A4.
  3079             20  CL-CERT-A4-PRIME    PIC X(10).
  3080             20  CL-CERT-A4-SFX      PIC X.
  3081
  3082     12  CL-CONTROL-BY-CCN.
  3083         16  CL-COMPANY-CD-A5        PIC X.
  3084         16  CL-CCN-A5.
  3085             20  CL-CCN.
  3086                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3087                 24  CL-CCN-PRIME-A5 PIC X(12).
  3088             20  CL-CCN-FILLER-A5    PIC X(4).
  3089
  3090     12  CL-INSURED-PROFILE-DATA.
  3091         16  CL-INSURED-BIRTH-DT     PIC XX.
  3092         16  CL-INSURED-SEX-CD       PIC X.
  3093             88  INSURED-IS-MALE        VALUE 'M'.
  3094             88  INSURED-IS-FEMALE      VALUE 'F'.
  3095             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3096         16  CL-INSURED-OCC-CD       PIC X(6).
  3097         16  FILLER                  PIC X(5).
  3098
  3099     12  CL-PROCESSING-INFO.
  3100         16  CL-PROCESSOR-ID         PIC X(4).
  3101         16  CL-CLAIM-STATUS         PIC X.
  3102             88  CLAIM-IS-OPEN          VALUE 'O'.
  3103             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3104         16  CL-CLAIM-TYPE           PIC X.
  3105*            88  AH-CLAIM               VALUE 'A'.
  3106*            88  LIFE-CLAIM             VALUE 'L'.
  3107*            88  PROPERTY-CLAIM         VALUE 'P'.
  3108*            88  IUI-CLAIM              VALUE 'I'.
  3109*            88  GAP-CLAIM              VALUE 'G'.
  3110         16  CL-CLAIM-PREM-TYPE      PIC X.
  3111             88  SINGLE-PREMIUM         VALUE '1'.
  3112             88  O-B-COVERAGE           VALUE '2'.
  3113             88  OPEN-END-COVERAGE      VALUE '3'.
  3114         16  CL-INCURRED-DT          PIC XX.
  3115         16  CL-REPORTED-DT          PIC XX.
  3116         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3117         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3118         16  CL-LAST-PMT-DT          PIC XX.
  3119         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3120         16  CL-PAID-THRU-DT         PIC XX.
  3121         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3122         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3123         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3124         16  CL-PMT-CALC-METHOD      PIC X.
  3125             88  CL-360-DAY-YR          VALUE '1'.
  3126             88  CL-365-DAY-YR          VALUE '2'.
  3127             88  CL-FULL-MONTHS         VALUE '3'.
  3128         16  CL-CAUSE-CD             PIC X(6).
  3129
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  62
* EL130.cbl
  3130         16  CL-PRIME-CERT-NO.
  3131             20  CL-PRIME-CERT-PRIME PIC X(10).
  3132             20  CL-PRIME-CERT-SFX   PIC X.
  3133
  3134         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3135             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3136             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3137
  3138         16  CL-MICROFILM-NO         PIC X(10).
  3139         16  CL-PROG-FORM-TYPE       PIC X.
  3140         16  CL-LAST-ADD-ON-DT       PIC XX.
  3141
  3142         16  CL-LAST-REOPEN-DT       PIC XX.
  3143         16  CL-LAST-CLOSE-DT        PIC XX.
  3144         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3145             88  FINAL-PAID             VALUE '1'.
  3146             88  CLAIM-DENIED           VALUE '2'.
  3147             88  AUTO-CLOSE             VALUE '3'.
  3148             88  MANUAL-CLOSE           VALUE '4'.
  3149             88  BENEFITS-CHANGED       VALUE 'C'.
  3150             88  SETUP-ERRORS           VALUE 'E'.
  3151         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3152         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3153         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3154             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3155         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3156         16  FILLER                  PIC X.
  3157
  3158     12  CL-CERTIFICATE-DATA.
  3159         16  CL-CERT-ORIGIN          PIC X.
  3160             88  CERT-WAS-ONLINE        VALUE '1'.
  3161             88  CERT-WAS-CREATED       VALUE '2'.
  3162             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3163         16  CL-CERT-KEY-DATA.
  3164             20  CL-CERT-CARRIER     PIC X.
  3165             20  CL-CERT-GROUPING    PIC X(6).
  3166             20  CL-CERT-STATE       PIC XX.
  3167             20  CL-CERT-ACCOUNT.
  3168                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3169                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3170             20  CL-CERT-EFF-DT      PIC XX.
  3171
  3172     12  CL-STATUS-CONTROLS.
  3173         16  CL-PRIORITY-CD          PIC X.
  3174             88  CONFIDENTIAL-DATA      VALUE '8'.
  3175             88  HIGHEST-PRIORITY       VALUE '9'.
  3176         16  CL-SUPV-ATTN-CD         PIC X.
  3177             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3178             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3179         16  CL-PURGED-DT            PIC XX.
  3180         16  CL-RESTORED-DT          PIC XX.
  3181         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3182         16  CL-NEXT-RESEND-DT       PIC XX.
  3183         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3184         16  FILLER                  PIC XX.
  3185         16  CL-LAST-MAINT-DT        PIC XX.
  3186         16  CL-LAST-MAINT-USER      PIC X(4).
  3187         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  63
* EL130.cbl
  3188         16  CL-LAST-MAINT-TYPE      PIC X.
  3189             88  CLAIM-SET-UP           VALUE ' '.
  3190             88  PAYMENT-MADE           VALUE '1'.
  3191             88  LETTER-SENT            VALUE '2'.
  3192             88  MASTER-WAS-ALTERED     VALUE '3'.
  3193             88  MASTER-WAS-RESTORED    VALUE '4'.
  3194             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3195             88  FILE-CONVERTED         VALUE '6'.
  3196             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3197             88  ERROR-CORRECTION       VALUE 'E'.
  3198         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3199         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3200         16  CL-BENEFICIARY          PIC X(10).
  3201         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3202         16  CL-DENIAL-TYPE          PIC X.
  3203             88  CL-TYPE-DENIAL          VALUE '1'.
  3204             88  CL-TYPE-RESCISSION      VALUE '2'.
  3205             88  CL-TYPE-REFORMATION     VALUE '3'.
  3206             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3207             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3208         16  FILLER                  PIC X(5).
  3209
  3210     12  CL-TRAILER-CONTROLS.
  3211         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3212             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3213             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3214             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3215         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3216         16  FILLER                  PIC XX.
  3217         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3218         16  CL-ADDRESS-TRAILER-CNT.
  3219             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3220                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3221             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3222                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3223             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3224                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3225             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3226                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3227             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3228                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3229             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3230                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3231             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3232                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3233
  3234     12  CL-CV-REFERENCE-NO.
  3235         16  CL-CV-REFNO-PRIME       PIC X(18).
  3236         16  CL-CV-REFNO-SFX         PIC XX.
  3237
  3238     12  CL-FILE-LOCATION            PIC X(4).
  3239
  3240     12  CL-PROCESS-ERRORS.
  3241         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3242             88  NO-FATAL-ERRORS        VALUE ZERO.
  3243         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3244             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3245
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  64
* EL130.cbl
  3246     12  CL-PRODUCT-CD               PIC X.
  3247
  3248     12  CL-CURRENT-KEY-DATA.
  3249         16  CL-CURRENT-CARRIER      PIC X.
  3250         16  CL-CURRENT-GROUPING     PIC X(6).
  3251         16  CL-CURRENT-STATE        PIC XX.
  3252         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3253
  3254     12  CL-ASSOCIATES               PIC X.
  3255         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3256         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3257         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3258         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3259
  3260     12  CL-ACTIVITY-CODE            PIC 99.
  3261     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3262     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3263
  3264     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3265     12  CL-LAG-REPORT-CODE          PIC 9.
  3266     12  CL-LOAN-TYPE                PIC XX.
  3267     12  CL-LEGAL-STATE              PIC XX.
  3268
  3269*    12  FILLER                      PIC X(5).
  3270     12  CL-YESNOSW                  PIC X.
  3271     12  FILLER                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  65
* EL130.cbl
  3273*    COPY ELCCNTL.
  3274******************************************************************
  3275*                                                                *
  3276*                                                                *
  3277*                            ELCCNTL.                            *
  3278*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3279*                            VMOD=2.059                          *
  3280*                                                                *
  3281*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3282*                                                                *
  3283*   FILE TYPE = VSAM,KSDS                                        *
  3284*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3285*                                                                *
  3286*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3287*       ALTERNATE INDEX = NONE                                   *
  3288*                                                                *
  3289*   LOG = YES                                                    *
  3290*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3291******************************************************************
  3292*                   C H A N G E   L O G
  3293*
  3294* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3295*-----------------------------------------------------------------
  3296*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3297* EFFECTIVE    NUMBER
  3298*-----------------------------------------------------------------
  3299* 082503                   PEMA  ADD BENEFIT GROUP
  3300* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3301* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3302* 092705    2005050300006  PEMA  ADD SPP LEASES
  3303* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3304* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3305* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3306* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3307******************************************************************
  3308*
  3309 01  CONTROL-FILE.
  3310     12  CF-RECORD-ID                       PIC XX.
  3311         88  VALID-CF-ID                        VALUE 'CF'.
  3312
  3313     12  CF-CONTROL-PRIMARY.
  3314         16  CF-COMPANY-ID                  PIC XXX.
  3315         16  CF-RECORD-TYPE                 PIC X.
  3316             88  CF-COMPANY-MASTER              VALUE '1'.
  3317             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3318             88  CF-STATE-MASTER                VALUE '3'.
  3319             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3320             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3321             88  CF-CARRIER-MASTER              VALUE '6'.
  3322             88  CF-MORTALITY-MASTER            VALUE '7'.
  3323             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3324             88  CF-TERMINAL-MASTER             VALUE '9'.
  3325             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3326             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3327             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3328             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3329             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3330             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  66
* EL130.cbl
  3331             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3332             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3333             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3334         16  CF-ACCESS-CD-GENL              PIC X(4).
  3335         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3336             20  CF-PROCESSOR               PIC X(4).
  3337         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3338             20  CF-STATE-CODE              PIC XX.
  3339             20  FILLER                     PIC XX.
  3340         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3341             20  FILLER                     PIC XX.
  3342             20  CF-HI-BEN-IN-REC           PIC XX.
  3343         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3344             20  FILLER                     PIC XXX.
  3345             20  CF-CARRIER-CNTL            PIC X.
  3346         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3347             20  FILLER                     PIC XX.
  3348             20  CF-HI-TYPE-IN-REC          PIC 99.
  3349         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3350             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3351                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3352             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3353             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3354         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3355             20  FILLER                     PIC X.
  3356             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3357         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3358             20  FILLER                     PIC XX.
  3359             20  CF-MORTGAGE-PLAN           PIC XX.
  3360         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3361
  3362     12  CF-LAST-MAINT-DT                   PIC XX.
  3363     12  CF-LAST-MAINT-BY                   PIC X(4).
  3364     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3365
  3366     12  CF-RECORD-BODY                     PIC X(728).
  3367
  3368
  3369****************************************************************
  3370*             COMPANY MASTER RECORD                            *
  3371****************************************************************
  3372
  3373     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3374         16  CF-COMPANY-ADDRESS.
  3375             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3376             20  CF-CL-IN-CARE-OF           PIC X(30).
  3377             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3378             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3379             20  CF-CL-CITY-STATE           PIC X(30).
  3380             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3381             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3382         16  CF-COMPANY-CD                  PIC X.
  3383         16  CF-COMPANY-PASSWORD            PIC X(8).
  3384         16  CF-SECURITY-OPTION             PIC X.
  3385             88  ALL-SECURITY                   VALUE '1'.
  3386             88  COMPANY-VERIFY                 VALUE '2'.
  3387             88  PROCESSOR-VERIFY               VALUE '3'.
  3388             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  67
* EL130.cbl
  3389             88  ALL-BUT-TERM                   VALUE '5'.
  3390         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3391             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3392         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3393             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3394         16  CF-INFORCE-LOCATION            PIC X.
  3395             88  CERTS-ARE-ONLINE               VALUE '1'.
  3396             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3397             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3398         16  CF-LOWER-CASE-LETTERS          PIC X.
  3399         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3400             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3401             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3402             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3403             88  CF-ACCNT-CNTL                  VALUE '3'.
  3404             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3405
  3406         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3407         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3408
  3409         16  CF-LGX-CREDIT-USER             PIC X.
  3410             88  CO-IS-NOT-USER                 VALUE 'N'.
  3411             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3412
  3413         16 CF-CREDIT-CALC-CODES.
  3414             20  CF-CR-REM-TERM-CALC PIC X.
  3415               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3416               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3417               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3418               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3419               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3420               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3421               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3422             20  CF-CR-R78-METHOD           PIC X.
  3423               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3424               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3425
  3426         16  CF-CLAIM-CONTROL-COUNTS.
  3427             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3428                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3429
  3430             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3431                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3432
  3433             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3434                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3435
  3436             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3437                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3438
  3439         16  CF-CURRENT-MONTH-END           PIC XX.
  3440
  3441         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3442             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3443             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3444             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3445             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3446                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  68
* EL130.cbl
  3447                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3448             20  CF-CO-PREM-REJECT-SW       PIC X.
  3449                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3450                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3451             20  CF-CO-REF-REJECT-SW        PIC X.
  3452                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3453                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3454
  3455         16  CF-CO-REPORTING-DT             PIC XX.
  3456         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3457         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3458           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3459           88  CF-CO-MONTH-END                  VALUE '1'.
  3460
  3461         16  CF-LGX-CLAIM-USER              PIC X.
  3462             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3463             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3464
  3465         16  CF-CREDIT-EDIT-CONTROLS.
  3466             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3467             20  CF-MIN-AGE                 PIC 99.
  3468             20  CF-DEFAULT-AGE             PIC 99.
  3469             20  CF-MIN-TERM                PIC S999      COMP-3.
  3470             20  CF-MAX-TERM                PIC S999      COMP-3.
  3471             20  CF-DEFAULT-SEX             PIC X.
  3472             20  CF-JOINT-AGE-INPUT         PIC X.
  3473                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3474             20  CF-BIRTH-DATE-INPUT        PIC X.
  3475                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3476             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3477                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3478                 88  CF-ZERO-CARRIER            VALUE '1'.
  3479                 88  CF-ZERO-GROUPING           VALUE '2'.
  3480                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3481             20  CF-EDIT-SW                 PIC X.
  3482                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3483             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3484             20  CF-CR-PR-METHOD            PIC X.
  3485               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3486               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3487             20  FILLER                     PIC X.
  3488
  3489         16  CF-CREDIT-MISC-CONTROLS.
  3490             20  CF-REIN-TABLE-SW           PIC X.
  3491                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3492             20  CF-COMP-TABLE-SW           PIC X.
  3493                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3494             20  CF-EXPERIENCE-RETENTION-AGE
  3495                                            PIC S9        COMP-3.
  3496             20  CF-CONVERSION-DT           PIC XX.
  3497             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3498             20  CF-RUN-FREQUENCY-SW        PIC X.
  3499                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3500                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3501
  3502             20  CF-CR-CHECK-NO-CONTROL.
  3503                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3504                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  69
* EL130.cbl
  3505                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3506                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3507                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3508                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3509
  3510                 24  CF-CR-CHECK-COUNT       REDEFINES
  3511                     CF-CR-CHECK-COUNTER      PIC X(4).
  3512
  3513                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3514                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3515
  3516                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3517                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3518                 24  CF-MAIL-PROCESSING       PIC X.
  3519                     88  MAIL-PROCESSING          VALUE 'Y'.
  3520
  3521         16  CF-MISC-SYSTEM-CONTROL.
  3522             20  CF-SYSTEM-C                 PIC X.
  3523                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3524             20  CF-SYSTEM-D                 PIC X.
  3525                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3526             20  CF-SOC-SEC-NO-SW            PIC X.
  3527                 88  SOC-SEC-NO-USED             VALUE '1'.
  3528             20  CF-MEMBER-NO-SW             PIC X.
  3529                 88  MEMBER-NO-USED              VALUE '1'.
  3530             20  CF-TAX-ID-NUMBER            PIC X(11).
  3531             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3532             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3533                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3534                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3535                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3536                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3537             20  CF-SYSTEM-E                 PIC X.
  3538                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3539
  3540         16  CF-LGX-LIFE-USER               PIC X.
  3541             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3542             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3543
  3544         16  CF-CR-MONTH-END-DT             PIC XX.
  3545
  3546         16  CF-FILE-MAINT-DATES.
  3547             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3548                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3549             20  CF-LAST-BATCH       REDEFINES
  3550                 CF-LAST-BATCH-NO               PIC X(4).
  3551             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3552             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3553             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3554             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3555             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3556             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3557             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3558             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3559             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3560             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3561
  3562         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  70
* EL130.cbl
  3563         16  FILLER                         PIC X.
  3564
  3565         16  CF-ALT-MORT-CODE               PIC X(4).
  3566         16  CF-MEMBER-CAPTION              PIC X(10).
  3567
  3568         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3569             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3570             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3571             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3572             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3573             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3574
  3575         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3576
  3577         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3578         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3579         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3580         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3581
  3582         16  CF-AH-OVERRIDE-L1              PIC X.
  3583         16  CF-AH-OVERRIDE-L2              PIC XX.
  3584         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3585         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3586
  3587         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3588         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3589
  3590         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3591         16  CF-AR-LAST-EL860-DT            PIC XX.
  3592         16  CF-MP-MONTH-END-DT             PIC XX.
  3593
  3594         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3595         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3596             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3597
  3598         16  CF-AR-MONTH-END-DT             PIC XX.
  3599
  3600         16  CF-CRDTCRD-USER                PIC X.
  3601             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3602             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3603
  3604         16  CF-CC-MONTH-END-DT             PIC XX.
  3605
  3606         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3607
  3608         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3609             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3610             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3611             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3612         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3613         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3614         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3615         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3616             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3617             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3618         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3619         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3620         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  71
* EL130.cbl
  3621             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3622         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3623
  3624         16  CF-CL-ZIP-CODE.
  3625             20  CF-CL-ZIP-PRIME.
  3626                 24  CF-CL-ZIP-1ST          PIC X.
  3627                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3628                 24  FILLER                 PIC X(4).
  3629             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3630         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3631             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3632             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3633             20  FILLER                     PIC XXX.
  3634
  3635         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3636         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3637         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3638         16  CF-CO-OPTION-START-DATE        PIC XX.
  3639         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3640           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3641                                                      '3' '4'.
  3642           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3643           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3644           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3645           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3646           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3647           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3648
  3649         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3650
  3651         16  CF-PAYMENT-APPROVAL-LEVELS.
  3652             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3653             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3654             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3655             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3656             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3657             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3658
  3659         16  CF-END-USER-REPORTING-USER     PIC X.
  3660             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3661             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3662
  3663         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3664             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3665             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3666
  3667         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3668
  3669         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3670         16  FILLER                         PIC X.
  3671
  3672         16  CF-CREDIT-ARCHIVE-CNTL.
  3673             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3674             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3675             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3676
  3677         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3678
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  72
* EL130.cbl
  3679         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3680             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3681             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3682
  3683         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3684             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3685             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3686
  3687         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3688
  3689         16  CF-CO-ACH-ID-CODE              PIC  X.
  3690             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3691             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3692             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3693         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3694         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3695         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3696         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3697         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3698         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3699         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3700         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3701         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3702                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3703         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3704                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3705
  3706         16  CF-CO-OVER-SHORT.
  3707             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3708             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3709
  3710*         16  FILLER                         PIC X(102).
  3711         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3712             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3713             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3714
  3715         16  CF-AH-APPROVAL-DAYS.
  3716             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3717             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3718             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3719             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3720
  3721         16  FILLER                         PIC X(82).
  3722****************************************************************
  3723*             PROCESSOR/USER RECORD                            *
  3724****************************************************************
  3725
  3726     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3727         16  CF-PROCESSOR-NAME              PIC X(30).
  3728         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3729         16  CF-PROCESSOR-TITLE             PIC X(26).
  3730         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3731                 88  MESSAGE-YES                VALUE 'Y'.
  3732                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3733
  3734*****************************************************
  3735****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3736****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  73
* EL130.cbl
  3737****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3738****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3739*****************************************************
  3740
  3741         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3742             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3743             20  CF-APPLICATION-FORCE       PIC X.
  3744             20  CF-INDIVIDUAL-APP.
  3745                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3746                     28  CF-BROWSE-APP      PIC X.
  3747                     28  CF-UPDATE-APP      PIC X.
  3748
  3749         16  CF-CURRENT-TERM-ON             PIC X(4).
  3750         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3751             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3752             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3753             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3754             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3755             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3756             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3757             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3758         16  CF-PROCESSOR-CARRIER           PIC X.
  3759             88  NO-CARRIER-SECURITY            VALUE ' '.
  3760         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3761             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3762         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3763             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3764         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3765             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3766
  3767         16  CF-PROC-SYS-ACCESS-SW.
  3768             20  CF-PROC-CREDIT-CLAIMS-SW.
  3769                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3770                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3771                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3772                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3773             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3774                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3775                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3776             20  CF-PROC-LIFE-GNRLDGR-SW.
  3777                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3778                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3779                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3780                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3781             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3782                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3783                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3784         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3785             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3786             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3787         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3788
  3789         16  CF-APPROVAL-LEVEL                  PIC X.
  3790             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3791             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3792             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3793             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3794
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  74
* EL130.cbl
  3795         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3796
  3797         16  CF-LANGUAGE-TYPE                   PIC X.
  3798             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3799             88  CF-LANG-IS-FR                      VALUE 'F'.
  3800         16  FILLER                             PIC  X(240).
  3801
  3802****************************************************************
  3803*             PROCESSOR/REMINDERS RECORD                       *
  3804****************************************************************
  3805
  3806     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3807         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3808             20  CF-START-REMIND-DT         PIC XX.
  3809             20  CF-END-REMIND-DT           PIC XX.
  3810             20  CF-REMINDER-TEXT           PIC X(50).
  3811         16  FILLER                         PIC X(296).
  3812
  3813
  3814****************************************************************
  3815*             STATE MASTER RECORD                              *
  3816****************************************************************
  3817
  3818     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3819         16  CF-STATE-ABBREVIATION          PIC XX.
  3820         16  CF-STATE-NAME                  PIC X(25).
  3821         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3822         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3823             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3824             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3825             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3826             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3827                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3828                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3829             20  CF-ST-PREM-REJECT-SW       PIC X.
  3830                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3831                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3832             20  CF-ST-REF-REJECT-SW        PIC X.
  3833                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3834                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3835         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3836         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3837         16  CF-ST-REFUND-RULES.
  3838             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3839             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3840             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3841         16  CF-ST-FST-PMT-EXTENSION.
  3842             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3843             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3844                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3845                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3846                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3847                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3848         16  CF-ST-STATE-CALL.
  3849             20  CF-ST-CALL-UNEARNED        PIC X.
  3850             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3851             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3852         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  75
* EL130.cbl
  3853             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3854             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3855         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3856         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3857         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3858         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3859         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3860         16  FILLER                         PIC X.
  3861         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3862             20  CF-ST-BENEFIT-CD           PIC XX.
  3863             20  CF-ST-BENEFIT-KIND         PIC X.
  3864                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3865                 88  CF-ST-AH-KIND              VALUE 'A'.
  3866             20  CF-ST-REM-TERM-CALC        PIC X.
  3867                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3868                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3869                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3870                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3871                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3872                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3873                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3874                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3875
  3876             20  CF-ST-REFUND-CALC          PIC X.
  3877                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3878                 88  ST-REFD-BY-R78             VALUE '1'.
  3879                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3880                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3881                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3882                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3883                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3884                 88  ST-REFD-UTAH               VALUE '7'.
  3885                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3886                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3887                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3888
  3889             20  CF-ST-EARNING-CALC         PIC X.
  3890                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3891                 88  ST-EARN-BY-R78             VALUE '1'.
  3892                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3893                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3894                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3895                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3896                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3897                 88  ST-EARN-MEAN               VALUE '8'.
  3898                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3899
  3900             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3901                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3902                 88  ST-OVRD-BY-R78             VALUE '1'.
  3903                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3904                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3905                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3906                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3907                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3908                 88  ST-OVRD-MEAN               VALUE '8'.
  3909                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3910             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  76
* EL130.cbl
  3911
  3912         16  CF-ST-COMMISSION-CAPS.
  3913             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3914             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3915             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3916             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3917         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3918                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3919
  3920         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3921
  3922         16  CF-ST-STATUTORY-INTEREST.
  3923             20  CF-ST-STAT-DATE-FROM       PIC X.
  3924                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3925                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3926             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3927             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3928             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3929             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3930             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3931
  3932         16  CF-ST-OVER-SHORT.
  3933             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3934             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3935
  3936         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3937
  3938         16  CF-ST-RT-CALC                  PIC X.
  3939
  3940         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3941         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3942         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3943         16  CF-ST-RF-LR-CALC               PIC X.
  3944         16  CF-ST-RF-LL-CALC               PIC X.
  3945         16  CF-ST-RF-LN-CALC               PIC X.
  3946         16  CF-ST-RF-AH-CALC               PIC X.
  3947         16  CF-ST-RF-CP-CALC               PIC X.
  3948*        16  FILLER                         PIC X(206).
  3949*CIDMOD         16  FILLER                         PIC X(192).
  3950         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3951             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3952         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3953         16  FILLER                         PIC X(187).
  3954
  3955****************************************************************
  3956*             BENEFIT MASTER RECORD                            *
  3957****************************************************************
  3958
  3959     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3960         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3961             20  CF-BENEFIT-CODE            PIC XX.
  3962             20  CF-BENEFIT-NUMERIC  REDEFINES
  3963                 CF-BENEFIT-CODE            PIC XX.
  3964             20  CF-BENEFIT-ALPHA           PIC XXX.
  3965             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3966             20  CF-BENEFIT-COMMENT         PIC X(10).
  3967
  3968             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  77
* EL130.cbl
  3969                 88  CF-REDUCING                VALUE 'R'.
  3970                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3971
  3972             20  CF-SPECIAL-CALC-CD         PIC X.
  3973                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3974                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3975                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3976                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3977                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3978                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3979                 88  CF-FARM-PLAN               VALUE 'F'.
  3980                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3981                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3982                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3983                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3984                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3985                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3986                 88  CF-PRUDENTIAL              VALUE 'P'.
  3987                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3988                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3989                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3990                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3991                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3992                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3993
  3994             20  CF-JOINT-INDICATOR         PIC X.
  3995                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3996
  3997*            20  FILLER                     PIC X(12).
  3998             20  FILLER                     PIC X(11).
  3999             20  CF-BENEFIT-CATEGORY        PIC X.
  4000             20  CF-LOAN-TYPE               PIC X(8).
  4001
  4002             20  CF-CO-REM-TERM-CALC        PIC X.
  4003                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4004                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4005                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4006                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4007                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4008
  4009             20  CF-CO-EARNINGS-CALC        PIC X.
  4010                 88  CO-EARN-BY-R78             VALUE '1'.
  4011                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4012                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4013                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4014                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4015                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4016                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4017                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4018
  4019             20  CF-CO-REFUND-CALC          PIC X.
  4020                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4021                 88  CO-REFD-BY-R78             VALUE '1'.
  4022                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4023                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4024                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4025                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4026                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  78
* EL130.cbl
  4027                 88  CO-REFD-MEAN               VALUE '8'.
  4028                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4029                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4030                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4031
  4032             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4033                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4034                 88  CO-OVRD-BY-R78             VALUE '1'.
  4035                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4036                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4037                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4038                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4039                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4040                 88  CO-OVRD-MEAN               VALUE '8'.
  4041                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4042
  4043             20  CF-CO-BEN-I-G-CD           PIC X.
  4044                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4045                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4046                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4047
  4048         16  FILLER                         PIC X(304).
  4049
  4050
  4051****************************************************************
  4052*             CARRIER MASTER RECORD                            *
  4053****************************************************************
  4054
  4055     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4056         16  CF-ADDRESS-DATA.
  4057             20  CF-MAIL-TO-NAME            PIC X(30).
  4058             20  CF-IN-CARE-OF              PIC X(30).
  4059             20  CF-ADDRESS-LINE-1          PIC X(30).
  4060             20  CF-ADDRESS-LINE-2          PIC X(30).
  4061             20  CF-CITY-STATE              PIC X(30).
  4062             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4063             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4064
  4065         16  CF-CLAIM-NO-CONTROL.
  4066             20  CF-CLAIM-NO-METHOD         PIC X.
  4067                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4068                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4069                 88  CLAIM-NO-SEQ               VALUE '3'.
  4070                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4071             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4072                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4073                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4074                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4075
  4076         16  CF-CHECK-NO-CONTROL.
  4077             20  CF-CHECK-NO-METHOD         PIC X.
  4078                 88  CHECK-NO-MANUAL            VALUE '1'.
  4079                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4080                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4081                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4082             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4083                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4084
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  79
* EL130.cbl
  4085         16  CF-DOMICILE-STATE              PIC XX.
  4086
  4087         16  CF-EXPENSE-CONTROLS.
  4088             20  CF-EXPENSE-METHOD          PIC X.
  4089                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4090                 88  DOLLARS-PER-PMT            VALUE '2'.
  4091                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4092                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4093             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4094             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4095
  4096         16  CF-CORRESPONDENCE-CONTROL.
  4097             20  CF-LETTER-RESEND-OPT       PIC X.
  4098                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4099                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4100             20  FILLER                     PIC X(4).
  4101
  4102         16  CF-RESERVE-CONTROLS.
  4103             20  CF-MANUAL-SW               PIC X.
  4104                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4105             20  CF-FUTURE-SW               PIC X.
  4106                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4107             20  CF-PTC-SW                  PIC X.
  4108                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4109             20  CF-IBNR-SW                 PIC X.
  4110                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4111             20  CF-PTC-LF-SW               PIC X.
  4112                 88  CF-LF-PTC-USED             VALUE '1'.
  4113             20  CF-CDT-ACCESS-METHOD       PIC X.
  4114                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4115                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4116                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4117             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4118
  4119         16  CF-CLAIM-CALC-METHOD           PIC X.
  4120             88  360-PLUS-MONTHS                VALUE '1'.
  4121             88  365-PLUS-MONTHS                VALUE '2'.
  4122             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4123             88  360-DAILY                      VALUE '4'.
  4124             88  365-DAILY                      VALUE '5'.
  4125
  4126         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4127         16  FILLER                         PIC X(11).
  4128
  4129         16  CF-LIMIT-AMOUNTS.
  4130             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4131             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4132             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4133             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4134             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4135             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4136             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4137             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4138             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4139             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4140
  4141         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4142         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  80
* EL130.cbl
  4143         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4144
  4145         16  CF-ZIP-CODE.
  4146             20  CF-ZIP-PRIME.
  4147                 24  CF-ZIP-1ST             PIC X.
  4148                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4149                 24  FILLER                 PIC X(4).
  4150             20  CF-ZIP-PLUS4               PIC X(4).
  4151         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4152             20  CF-CAN-POSTAL-1            PIC XXX.
  4153             20  CF-CAN-POSTAL-2            PIC XXX.
  4154             20  FILLER                     PIC XXX.
  4155
  4156         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4157         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4158         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4159
  4160         16  CF-RATING-SWITCH               PIC X.
  4161             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4162             88  CF-NO-RATING                   VALUE 'N'.
  4163
  4164         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4165
  4166         16  CF-CARRIER-OVER-SHORT.
  4167             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4168             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4169
  4170         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4171         16  CF-SECPAY-SWITCH               PIC X.
  4172             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4173             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4174         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4175         16  FILLER                         PIC X(448).
  4176*        16  FILLER                         PIC X(452).
  4177
  4178
  4179****************************************************************
  4180*             MORTALITY MASTER RECORD                          *
  4181****************************************************************
  4182
  4183     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4184         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4185                                INDEXED BY CF-MORT-NDX.
  4186             20  CF-MORT-TABLE              PIC X(5).
  4187             20  CF-MORT-TABLE-TYPE         PIC X.
  4188                 88  CF-MORT-JOINT              VALUE 'J'.
  4189                 88  CF-MORT-SINGLE             VALUE 'S'.
  4190                 88  CF-MORT-COMBINED           VALUE 'C'.
  4191                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4192                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4193             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4194             20  CF-MORT-AGE-METHOD         PIC XX.
  4195                 88  CF-AGE-LAST                VALUE 'AL'.
  4196                 88  CF-AGE-NEAR                VALUE 'AN'.
  4197             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4198             20  CF-MORT-ADJUSTMENT-DIRECTION
  4199                                            PIC X.
  4200                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  81
* EL130.cbl
  4201                 88  CF-PLUS                    VALUE '+'.
  4202             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4203             20  CF-MORT-JOINT-CODE         PIC X.
  4204                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4205             20  CF-MORT-PC-Q               PIC X.
  4206                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4207             20  CF-MORT-TABLE-CODE         PIC X(4).
  4208             20  CF-MORT-COMMENTS           PIC X(15).
  4209             20  FILLER                     PIC X(14).
  4210
  4211         16  FILLER                         PIC X(251).
  4212
  4213
  4214****************************************************************
  4215*             BUSSINESS TYPE MASTER RECORD                     *
  4216****************************************************************
  4217
  4218     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4219* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4220* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4221* AND RECORD 05 IS TYPES 81-99
  4222         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4223             20  CF-BUSINESS-TITLE          PIC  X(19).
  4224             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4225                                            PIC S9V9(4) COMP-3.
  4226             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4227             20  FILLER                     PIC  X.
  4228         16  FILLER                         PIC  X(248).
  4229
  4230
  4231****************************************************************
  4232*             TERMINAL MASTER RECORD                           *
  4233****************************************************************
  4234
  4235     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4236
  4237         16  CF-COMPANY-TERMINALS.
  4238             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4239                                  PIC X(4).
  4240         16  FILLER               PIC X(248).
  4241
  4242
  4243****************************************************************
  4244*             LIFE EDIT MASTER RECORD                          *
  4245****************************************************************
  4246
  4247     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4248         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4249             20  CF-LIFE-CODE-IN            PIC XX.
  4250             20  CF-LIFE-CODE-OUT           PIC XX.
  4251         16  FILLER                         PIC X(248).
  4252
  4253
  4254****************************************************************
  4255*             AH EDIT MASTER RECORD                            *
  4256****************************************************************
  4257
  4258     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  82
* EL130.cbl
  4259         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4260             20  CF-AH-CODE-IN              PIC XXX.
  4261             20  CF-AH-CODE-OUT             PIC XX.
  4262         16  FILLER                         PIC X(248).
  4263
  4264
  4265****************************************************************
  4266*             CREDIBILITY TABLES                               *
  4267****************************************************************
  4268
  4269     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4270         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4271                             INDEXED BY CF-CRDB-NDX.
  4272             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4273             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4274             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4275         16  FILLER                         PIC  X(332).
  4276
  4277
  4278****************************************************************
  4279*             REPORT CUSTOMIZATION RECORD                      *
  4280****************************************************************
  4281
  4282     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4283         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4284             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4285             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4286             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4287**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4288****       A T-TRANSFER.                                   ****
  4289             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4290
  4291         16  FILLER                         PIC XX.
  4292
  4293         16  CF-CARRIER-CNTL-OPT.
  4294             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4295                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4296                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4297             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4298                                            PIC X.
  4299         16  CF-GROUP-CNTL-OPT.
  4300             20  CF-GROUP-OPT-SEQ           PIC 9.
  4301                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4302                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4303             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4304                                            PIC X(6).
  4305         16  CF-STATE-CNTL-OPT.
  4306             20  CF-STATE-OPT-SEQ           PIC 9.
  4307                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4308                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4309             20  CF-STATE-SELECT OCCURS 3 TIMES
  4310                                            PIC XX.
  4311         16  CF-ACCOUNT-CNTL-OPT.
  4312             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4313                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4314                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4315             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4316                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  83
* EL130.cbl
  4317         16  CF-BUS-TYP-CNTL-OPT.
  4318             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4319                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4320                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4321             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4322                                            PIC XX.
  4323         16  CF-LF-TYP-CNTL-OPT.
  4324             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4325                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4326                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4327             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4328                                            PIC XX.
  4329         16  CF-AH-TYP-CNTL-OPT.
  4330             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4331                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4332                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4333             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4334                                            PIC XX.
  4335         16  CF-REPTCD1-CNTL-OPT.
  4336             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4337                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4338                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4339             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4340                                            PIC X(10).
  4341         16  CF-REPTCD2-CNTL-OPT.
  4342             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4343                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4344                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4345             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4346                                            PIC X(10).
  4347         16  CF-USER1-CNTL-OPT.
  4348             20  CF-USER1-OPT-SEQ           PIC 9.
  4349                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4350                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4351             20  CF-USER1-SELECT OCCURS 3 TIMES
  4352                                            PIC X(10).
  4353         16  CF-USER2-CNTL-OPT.
  4354             20  CF-USER2-OPT-SEQ           PIC 9.
  4355                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4356                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4357             20  CF-USER2-SELECT OCCURS 3 TIMES
  4358                                            PIC X(10).
  4359         16  CF-USER3-CNTL-OPT.
  4360             20  CF-USER3-OPT-SEQ           PIC 9.
  4361                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4362                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4363             20  CF-USER3-SELECT OCCURS 3 TIMES
  4364                                            PIC X(10).
  4365         16  CF-USER4-CNTL-OPT.
  4366             20  CF-USER4-OPT-SEQ           PIC 9.
  4367                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4368                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4369             20  CF-USER4-SELECT OCCURS 3 TIMES
  4370                                            PIC X(10).
  4371         16  CF-USER5-CNTL-OPT.
  4372             20  CF-USER5-OPT-SEQ           PIC 9.
  4373                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4374                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  84
* EL130.cbl
  4375             20  CF-USER5-SELECT OCCURS 3 TIMES
  4376                                            PIC X(10).
  4377         16  CF-REINS-CNTL-OPT.
  4378             20  CF-REINS-OPT-SEQ           PIC 9.
  4379                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4380                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4381             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4382                 24  CF-REINS-PRIME         PIC XXX.
  4383                 24  CF-REINS-SUB           PIC XXX.
  4384
  4385         16  CF-AGENT-CNTL-OPT.
  4386             20  CF-AGENT-OPT-SEQ           PIC 9.
  4387                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4388                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4389             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4390                                            PIC X(10).
  4391
  4392         16  FILLER                         PIC X(43).
  4393
  4394         16  CF-LOSS-RATIO-SELECT.
  4395             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4396             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4397         16  CF-ENTRY-DATE-SELECT.
  4398             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4399             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4400         16  CF-EFFECTIVE-DATE-SELECT.
  4401             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4402             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4403
  4404         16  CF-EXCEPTION-LIST-IND          PIC X.
  4405             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4406
  4407         16  FILLER                         PIC X(318).
  4408
  4409****************************************************************
  4410*                  EXCEPTION REPORTING RECORD                  *
  4411****************************************************************
  4412
  4413     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4414         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4415             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4416
  4417         16  CF-COMBINED-LIFE-AH-OPT.
  4418             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4419             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4420             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4421             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4422
  4423         16  CF-LIFE-OPT.
  4424             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4425             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4426             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4427             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4428             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4429             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4430             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4431             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4432             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  85
* EL130.cbl
  4433             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4434
  4435         16  CF-AH-OPT.
  4436             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4437             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4438             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4439             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4440             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4441             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4442             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4443             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4444             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4445             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4446
  4447         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4448             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4449             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4450             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4451
  4452         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4453
  4454         16  FILLER                         PIC X(673).
  4455
  4456
  4457****************************************************************
  4458*             MORTGAGE SYSTEM PLAN RECORD                      *
  4459****************************************************************
  4460
  4461     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4462         16  CF-PLAN-TYPE                   PIC X.
  4463             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4464             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4465             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4466         16  CF-PLAN-ABBREV                 PIC XXX.
  4467         16  CF-PLAN-DESCRIPT               PIC X(10).
  4468         16  CF-PLAN-NOTES                  PIC X(20).
  4469         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4470         16  CF-PLAN-UNDERWRITING.
  4471             20  CF-PLAN-TERM-DATA.
  4472                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4473                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4474             20  CF-PLAN-AGE-DATA.
  4475                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4476                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4477                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4478             20  CF-PLAN-BENEFIT-DATA.
  4479                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4480                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4481                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4482                                            PIC S9(7)V99  COMP-3.
  4483         16  CF-PLAN-POLICY-FORMS.
  4484             20  CF-POLICY-FORM             PIC X(12).
  4485             20  CF-MASTER-APPLICATION      PIC X(12).
  4486             20  CF-MASTER-POLICY           PIC X(12).
  4487         16  CF-PLAN-RATING.
  4488             20  CF-RATE-CODE               PIC X(5).
  4489             20  CF-SEX-RATING              PIC X.
  4490                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  86
* EL130.cbl
  4491                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4492             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4493             20  CF-SUB-STD-TYPE            PIC X.
  4494                 88  CF-PCT-OF-PREM            VALUE '1'.
  4495                 88  CF-PCT-OF-BENE            VALUE '2'.
  4496         16  CF-PLAN-PREM-TOLERANCES.
  4497             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4498             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4499         16  CF-PLAN-PYMT-TOLERANCES.
  4500             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4501             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4502         16  CF-PLAN-MISC-DATA.
  4503             20  FILLER                     PIC X.
  4504             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4505             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4506         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4507         16  CF-PLAN-IND-GRP                PIC X.
  4508             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4509                                                     '1'.
  4510             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4511                                                     '2'.
  4512         16  CF-MIB-SEARCH-SW               PIC X.
  4513             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4514             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4515             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4516             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4517         16  CF-ALPHA-SEARCH-SW             PIC X.
  4518             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4519             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4520             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4521             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4522             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4523             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4524             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4525             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4526             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4527             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4528                                                     'A' 'B' 'C'
  4529                                                     'X' 'Y' 'Z'.
  4530         16  CF-EFF-DT-RULE-SW              PIC X.
  4531             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4532             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4533             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4534             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4535             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4536         16  FILLER                         PIC X(4).
  4537         16  CF-HEALTH-QUESTIONS            PIC X.
  4538             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4539         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4540         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4541         16  CF-PLAN-SNGL-JNT               PIC X.
  4542             88  CF-COMBINED-PLAN              VALUE 'C'.
  4543             88  CF-JNT-PLAN                   VALUE 'J'.
  4544             88  CF-SNGL-PLAN                  VALUE 'S'.
  4545         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4546         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4547         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4548         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  87
* EL130.cbl
  4549         16  CF-RERATE-CNTL                 PIC  X.
  4550             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4551             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4552             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4553             88  CF-AUTO-RECALC                 VALUE '4'.
  4554         16  CF-BENEFIT-TYPE                PIC  X.
  4555             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4556             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4557         16  CF-POLICY-FEE                  PIC S999V99
  4558                                                    COMP-3.
  4559         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4560         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4561         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4562         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4563         16  FILLER                         PIC  X(32).
  4564         16  CF-TERMINATION-FORM            PIC  X(04).
  4565         16  FILLER                         PIC  X(08).
  4566         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4567                                                       COMP-3.
  4568         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4569         16  CF-ISSUE-LETTER                PIC  X(4).
  4570         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4571         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4572             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4573             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4574         16  CF-MP-REFUND-CALC              PIC X.
  4575             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4576             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4577             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4578             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4579             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4580             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4581             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4582             88  CF-MP-REFD-MEAN                VALUE '8'.
  4583         16  CF-ALT-RATE-CODE               PIC  X(5).
  4584
  4585
  4586         16  FILLER                         PIC X(498).
  4587****************************************************************
  4588*             MORTGAGE COMPANY MASTER RECORD                   *
  4589****************************************************************
  4590
  4591     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4592         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4593         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4594             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4595             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4596             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4597             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4598             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4599
  4600         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4601         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4602         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4603         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4604         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4605
  4606         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  88
* EL130.cbl
  4607             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4608         16  CF-MP-RECON-USE-IND            PIC X(1).
  4609             88  CF-MP-USE-RECON             VALUE 'Y'.
  4610         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4611             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4612         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4613             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4614             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4615         16  FILLER                         PIC X(1).
  4616         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4617             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4618         16  CF-MORTG-MIB-VERSION           PIC X.
  4619             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4620             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4621             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4622         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4623             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4624                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4625             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4626                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4627             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4628                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4629             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4630                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4631             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4632                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4633             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4634                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4635         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4636         16  FILLER                         PIC X(7).
  4637         16  CF-MORTG-DESTINATION-SYMBOL.
  4638             20  CF-MORTG-MIB-COMM          PIC X(5).
  4639             20  CF-MORTG-MIB-TERM          PIC X(5).
  4640         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4641             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4642         16  FILLER                         PIC X(03).
  4643         16  CF-MP-CHECK-NO-CONTROL.
  4644             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4645                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4646                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4647                                                ' ' LOW-VALUES.
  4648                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4649                                               VALUE '3'.
  4650         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4651         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4652         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4653             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4654                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4655             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4656                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4657             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4658                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4659             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4660                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4661             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4662                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4663             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4664                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  89
* EL130.cbl
  4665         16  CF-MORTG-BILLING-AREA.
  4666             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4667                                            PIC X.
  4668         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4669         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4670         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4671         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4672             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4673             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4674         16  FILLER                         PIC X.
  4675         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4676             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4677             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4678         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4679         16  FILLER                         PIC X(8).
  4680         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4681         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4682         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4683         16  CF-ACH-COMPANY-ID.
  4684             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4685                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4686                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4687                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4688             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4689         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4690             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4691         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4692             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4693             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4694         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4695         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4696         16  FILLER                         PIC X(536).
  4697
  4698****************************************************************
  4699*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4700****************************************************************
  4701
  4702     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4703         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4704             20  CF-FEMALE-HEIGHT.
  4705                 24  CF-FEMALE-FT           PIC 99.
  4706                 24  CF-FEMALE-IN           PIC 99.
  4707             20  CF-FEMALE-MIN-WT           PIC 999.
  4708             20  CF-FEMALE-MAX-WT           PIC 999.
  4709         16  FILLER                         PIC X(428).
  4710
  4711     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4712         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4713             20  CF-MALE-HEIGHT.
  4714                 24  CF-MALE-FT             PIC 99.
  4715                 24  CF-MALE-IN             PIC 99.
  4716             20  CF-MALE-MIN-WT             PIC 999.
  4717             20  CF-MALE-MAX-WT             PIC 999.
  4718         16  FILLER                         PIC X(428).
  4719******************************************************************
  4720*             AUTOMATIC ACTIVITY RECORD                          *
  4721******************************************************************
  4722     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  90
* EL130.cbl
  4723         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4724             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4725             20  CF-SYS-LETTER-ID           PIC X(04).
  4726             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4727             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4728             20  CF-SYS-RESET-SW            PIC X(01).
  4729             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4730             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4731
  4732         16  FILLER                         PIC X(50).
  4733
  4734         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4735             20  CF-USER-ACTIVE-SW          PIC X(01).
  4736             20  CF-USER-LETTER-ID          PIC X(04).
  4737             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4738             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4739             20  CF-USER-RESET-SW           PIC X(01).
  4740             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4741             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4742             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4743
  4744         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  91
* EL130.cbl
  4746*    COPY ELCCERT.
  4747******************************************************************
  4748*                                                                *
  4749*                            ELCCERT.                            *
  4750*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4751*                            VMOD=2.013                          *
  4752*                                                                *
  4753*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4754*                                                                *
  4755*   FILE TYPE = VSAM,KSDS                                        *
  4756*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4757*                                                                *
  4758*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4759*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4760*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4761*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4762*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4763*                                                                *
  4764*   LOG = YES                                                    *
  4765*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4766******************************************************************
  4767*                   C H A N G E   L O G
  4768*
  4769* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4770*-----------------------------------------------------------------
  4771*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4772* EFFECTIVE    NUMBER
  4773*-----------------------------------------------------------------
  4774* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4775* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4776* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4777* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4778* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4779* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4780* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4781******************************************************************
  4782
  4783 01  CERTIFICATE-MASTER.
  4784     12  CM-RECORD-ID                      PIC XX.
  4785         88  VALID-CM-ID                      VALUE 'CM'.
  4786
  4787     12  CM-CONTROL-PRIMARY.
  4788         16  CM-COMPANY-CD                 PIC X.
  4789         16  CM-CARRIER                    PIC X.
  4790         16  CM-GROUPING.
  4791             20  CM-GROUPING-PREFIX        PIC X(3).
  4792             20  CM-GROUPING-PRIME         PIC X(3).
  4793         16  CM-STATE                      PIC XX.
  4794         16  CM-ACCOUNT.
  4795             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4796             20  CM-ACCOUNT-PRIME          PIC X(6).
  4797         16  CM-CERT-EFF-DT                PIC XX.
  4798         16  CM-CERT-NO.
  4799             20  CM-CERT-PRIME             PIC X(10).
  4800             20  CM-CERT-SFX               PIC X.
  4801
  4802     12  CM-CONTROL-BY-NAME.
  4803         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  92
* EL130.cbl
  4804         16  CM-INSURED-LAST-NAME          PIC X(15).
  4805         16  CM-INSURED-INITIALS.
  4806             20  CM-INSURED-INITIAL1       PIC X.
  4807             20  CM-INSURED-INITIAL2       PIC X.
  4808
  4809     12  CM-CONTROL-BY-SSN.
  4810         16  CM-COMPANY-CD-A2              PIC X.
  4811         16  CM-SOC-SEC-NO.
  4812             20  CM-SSN-STATE              PIC XX.
  4813             20  CM-SSN-ACCOUNT            PIC X(6).
  4814             20  CM-SSN-LN3.
  4815                 25  CM-INSURED-INITIALS-A2.
  4816                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4817                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4818                 25 CM-PART-LAST-NAME-A2         PIC X.
  4819
  4820     12  CM-CONTROL-BY-CERT-NO.
  4821         16  CM-COMPANY-CD-A4              PIC X.
  4822         16  CM-CERT-NO-A4                 PIC X(11).
  4823
  4824     12  CM-CONTROL-BY-MEMB.
  4825         16  CM-COMPANY-CD-A5              PIC X.
  4826         16  CM-MEMBER-NO.
  4827             20  CM-MEMB-STATE             PIC XX.
  4828             20  CM-MEMB-ACCOUNT           PIC X(6).
  4829             20  CM-MEMB-LN4.
  4830                 25  CM-INSURED-INITIALS-A5.
  4831                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4832                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4833                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4834
  4835     12  CM-INSURED-PROFILE-DATA.
  4836         16  CM-INSURED-FIRST-NAME.
  4837             20  CM-INSURED-1ST-INIT       PIC X.
  4838             20  FILLER                    PIC X(9).
  4839         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4840         16  CM-INSURED-SEX                PIC X.
  4841             88  CM-SEX-MALE                  VALUE 'M'.
  4842             88  CM-SEX-FEMAL                 VALUE 'F'.
  4843         16  CM-INSURED-JOINT-AGE          PIC 99.
  4844         16  CM-JOINT-INSURED-NAME.
  4845             20  CM-JT-LAST-NAME           PIC X(15).
  4846             20  CM-JT-FIRST-NAME.
  4847                 24  CM-JT-1ST-INIT        PIC X.
  4848                 24  FILLER                PIC X(9).
  4849             20  CM-JT-INITIAL             PIC X.
  4850
  4851     12  CM-LIFE-DATA.
  4852         16  CM-LF-BENEFIT-CD              PIC XX.
  4853         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4854         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4855         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4856         16  CM-LF-DEV-CODE                PIC XXX.
  4857         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4858         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4859         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4860         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4861         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  93
* EL130.cbl
  4862         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4863         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4864         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4865         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4866         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4867         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4868         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4869         16  FILLER                        PIC XX.
  4870
  4871     12  CM-AH-DATA.
  4872         16  CM-AH-BENEFIT-CD              PIC XX.
  4873         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4874         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4875         16  CM-AH-DEV-CODE                PIC XXX.
  4876         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4877         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4878         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4879         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4880         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4881         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4882         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4883         16  CM-AH-PAID-THRU-DT            PIC XX.
  4884             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4885         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4886         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4887         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4888         16  FILLER                        PIC X.
  4889
  4890     12  CM-LOAN-INFORMATION.
  4891         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4892         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4893         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4894         16  CM-PAY-FREQUENCY              PIC S99.
  4895         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4896         16  CM-RATE-CLASS                 PIC XX.
  4897         16  CM-BENEFICIARY                PIC X(25).
  4898         16  CM-POLICY-FORM-NO             PIC X(12).
  4899         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4900         16  CM-LAST-ADD-ON-DT             PIC XX.
  4901         16  CM-DEDUCTIBLE-AMOUNTS.
  4902             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4903             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4904         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4905             20  CM-RESIDENT-STATE         PIC XX.
  4906             20  CM-RATE-CODE              PIC X(4).
  4907             20  FILLER                    PIC XX.
  4908         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4909             20  CM-LOAN-OFFICER           PIC X(5).
  4910             20  FILLER                    PIC XXX.
  4911         16  CM-CSR-CODE                   PIC XXX.
  4912         16  CM-UNDERWRITING-CODE          PIC X.
  4913             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4914         16  CM-POST-CARD-IND              PIC X.
  4915         16  CM-NH-INTERFACE-SW            PIC X.
  4916         16  CM-PREMIUM-TYPE               PIC X.
  4917             88  CM-SING-PRM                  VALUE '1'.
  4918             88  CM-O-B-COVERAGE              VALUE '2'.
  4919             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  94
* EL130.cbl
  4920         16  CM-IND-GRP-TYPE               PIC X.
  4921             88  CM-INDIVIDUAL                VALUE 'I'.
  4922             88  CM-GROUP                     VALUE 'G'.
  4923         16  CM-SKIP-CODE                  PIC X.
  4924             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4925             88  SKIP-JULY                    VALUE '1'.
  4926             88  SKIP-AUGUST                  VALUE '2'.
  4927             88  SKIP-SEPTEMBER               VALUE '3'.
  4928             88  SKIP-JULY-AUG                VALUE '4'.
  4929             88  SKIP-AUG-SEPT                VALUE '5'.
  4930             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4931             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4932             88  SKIP-JUNE                    VALUE '8'.
  4933             88  SKIP-JUNE-JULY               VALUE '9'.
  4934             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4935             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4936         16  CM-PAYMENT-MODE               PIC X.
  4937             88  PAY-MONTHLY                  VALUE SPACE.
  4938             88  PAY-WEEKLY                   VALUE '1'.
  4939             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4940             88  PAY-BI-WEEKLY                VALUE '3'.
  4941             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4942         16  CM-LOAN-NUMBER                PIC X(8).
  4943         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4944         16  CM-OLD-LOF                    PIC XXX.
  4945*        16  CM-LOAN-OFFICER               PIC XXX.
  4946         16  CM-REIN-TABLE                 PIC XXX.
  4947         16  CM-SPECIAL-REIN-CODE          PIC X.
  4948         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4949         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4950         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4951
  4952     12  CM-STATUS-DATA.
  4953         16  CM-ENTRY-STATUS               PIC X.
  4954         16  CM-ENTRY-DT                   PIC XX.
  4955
  4956         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4957         16  CM-LF-CANCEL-DT               PIC XX.
  4958         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4959
  4960         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4961         16  CM-LF-DEATH-DT                PIC XX.
  4962         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4963
  4964         16  CM-LF-CURRENT-STATUS          PIC X.
  4965             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4966                                                'M' '4' '5' '9'.
  4967             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4968             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4969             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4970             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4971             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4972             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4973             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4974             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4975             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4976             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4977             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  95
* EL130.cbl
  4978             88  CM-LF-VOIDED                 VALUE 'V'.
  4979
  4980         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4981         16  CM-AH-CANCEL-DT               PIC XX.
  4982         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4983
  4984         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4985         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4986         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4987
  4988         16  CM-AH-CURRENT-STATUS          PIC X.
  4989             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4990                                                'M' '4' '5' '9'.
  4991             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4992             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4993             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4994             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4995             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4996             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4997             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4998             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4999             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5000             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5001             88  CM-AH-DECLINED               VALUE 'D'.
  5002             88  CM-AH-VOIDED                 VALUE 'V'.
  5003
  5004         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5005             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5006             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5007             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5008         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5009
  5010         16  CM-ENTRY-BATCH                PIC X(6).
  5011         16  CM-LF-EXIT-BATCH              PIC X(6).
  5012         16  CM-AH-EXIT-BATCH              PIC X(6).
  5013         16  CM-LAST-MONTH-END             PIC XX.
  5014
  5015     12  CM-NOTE-SW                        PIC X.
  5016         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5017         88  CERT-NOTES-PRESENT               VALUE '1'.
  5018         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5019         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5020         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5021         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5022         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5023         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5024     12  CM-COMP-EXCP-SW                   PIC X.
  5025         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5026         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5027     12  CM-INSURED-ADDRESS-SW             PIC X.
  5028         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5029         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5030
  5031*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5032     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5033     12  FILLER                            PIC X.
  5034
  5035*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  96
* EL130.cbl
  5036     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5037     12  FILLER                            PIC X.
  5038*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5039     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5040
  5041     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5042         88  CERT-ADDED-BATCH                 VALUE ' '.
  5043         88  CERT-ADDED-ONLINE                VALUE '1'.
  5044         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5045         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5046         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5047     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5048         88  CERT-AS-LOADED                   VALUE ' '.
  5049         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5050         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5051         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5052         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5053         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5054         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5055         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5056
  5057     12  CM-ACCOUNT-COMM-PCTS.
  5058         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5059         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5060
  5061     12  CM-USER-FIELD                     PIC X.
  5062     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5063     12  CM-CLP-STATE                      PIC XX.
  5064     12  CM-USER-RESERVED                  PIC XXX.
  5065******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  97
* EL130.cbl
  5067*    COPY ERCACCT.
  5068******************************************************************
  5069*                                                                *
  5070*                                                                *
  5071*                            ERCACCT                             *
  5072*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5073*                            VMOD=2.031                          *
  5074*                                                                *
  5075*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5076*                                                                *
  5077*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5078*   VSAM ACCOUNT MASTER FILES.                                   *
  5079*                                                                *
  5080*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5081*                                                                *
  5082*   FILE TYPE = VSAM,KSDS                                        *
  5083*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5084*                                                                *
  5085*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5086*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5087*                                                                *
  5088*   LOG = NO                                                     *
  5089*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5090*                                                                *
  5091*                                                                *
  5092******************************************************************
  5093*                   C H A N G E   L O G
  5094*
  5095* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5096*-----------------------------------------------------------------
  5097*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5098* EFFECTIVE    NUMBER
  5099*-----------------------------------------------------------------
  5100* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5101* 092705    2005050300006  PEMA  ADD SPP LEASES
  5102* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5103* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5104******************************************************************
  5105
  5106 01  ACCOUNT-MASTER.
  5107     12  AM-RECORD-ID                      PIC XX.
  5108         88  VALID-AM-ID                      VALUE 'AM'.
  5109
  5110     12  AM-CONTROL-PRIMARY.
  5111         16  AM-COMPANY-CD                 PIC X.
  5112         16  AM-MSTR-CNTRL.
  5113             20  AM-CONTROL-A.
  5114                 24  AM-CARRIER            PIC X.
  5115                 24  AM-GROUPING.
  5116                     28 AM-GROUPING-PREFIX PIC XXX.
  5117                     28 AM-GROUPING-PRIME  PIC XXX.
  5118                 24  AM-STATE              PIC XX.
  5119                 24  AM-ACCOUNT.
  5120                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5121                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5122             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5123                                           PIC X(19).
  5124             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  98
* EL130.cbl
  5125                 24  AM-EXPIRATION-DT      PIC XX.
  5126                 24  FILLER                PIC X(4).
  5127             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5128                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5129
  5130     12  AM-CONTROL-BY-VAR-GRP.
  5131         16  AM-COMPANY-CD-A1              PIC X.
  5132         16  AM-VG-CARRIER                 PIC X.
  5133         16  AM-VG-GROUPING                PIC X(6).
  5134         16  AM-VG-STATE                   PIC XX.
  5135         16  AM-VG-ACCOUNT                 PIC X(10).
  5136         16  AM-VG-DATE.
  5137             20  AM-VG-EXPIRATION-DT       PIC XX.
  5138             20  FILLER                    PIC X(4).
  5139         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5140                                           PIC 9(11)      COMP-3.
  5141     12  AM-MAINT-INFORMATION.
  5142         16  AM-LAST-MAINT-DT              PIC XX.
  5143         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5144         16  AM-LAST-MAINT-USER            PIC X(4).
  5145         16  FILLER                        PIC XX.
  5146
  5147     12  AM-EFFECTIVE-DT                   PIC XX.
  5148     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5149
  5150     12  AM-PREV-DATES  COMP-3.
  5151         16  AM-PREV-EXP-DT                PIC 9(11).
  5152         16  AM-PREV-EFF-DT                PIC 9(11).
  5153
  5154     12  AM-REPORT-CODE-1                  PIC X(10).
  5155     12  AM-REPORT-CODE-2                  PIC X(10).
  5156
  5157     12  AM-CITY-CODE                      PIC X(4).
  5158     12  AM-COUNTY-PARISH                  PIC X(6).
  5159
  5160     12  AM-NAME                           PIC X(30).
  5161     12  AM-PERSON                         PIC X(30).
  5162     12  AM-ADDRS                          PIC X(30).
  5163     12  AM-CITY.
  5164         16  AM-ADDR-CITY                  PIC X(28).
  5165         16  AM-ADDR-STATE                 PIC XX.
  5166     12  AM-ZIP.
  5167         16  AM-ZIP-PRIME.
  5168             20  AM-ZIP-PRI-1ST            PIC X.
  5169                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5170             20  FILLER                    PIC X(4).
  5171         16  AM-ZIP-PLUS4                  PIC X(4).
  5172     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5173         16  AM-CAN-POSTAL-1               PIC XXX.
  5174         16  AM-CAN-POSTAL-2               PIC XXX.
  5175         16  FILLER                        PIC XXX.
  5176     12  AM-TEL-NO.
  5177         16  AM-AREA-CODE                  PIC 999.
  5178         16  AM-TEL-PRE                    PIC 999.
  5179         16  AM-TEL-NBR                    PIC 9(4).
  5180     12  AM-TEL-LOC                        PIC X.
  5181         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5182         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page  99
* EL130.cbl
  5183
  5184     12  AM-COMM-STRUCTURE.
  5185         16  AM-DEFN-1.
  5186             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5187                 24  AM-AGT.
  5188                     28  AM-AGT-PREFIX     PIC X(4).
  5189                     28  AM-AGT-PRIME      PIC X(6).
  5190                 24  AM-COM-TYP            PIC X.
  5191                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5192                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5193                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5194                 24  AM-RECALC-LV-INDIC    PIC X.
  5195                 24  AM-RETRO-LV-INDIC     PIC X.
  5196                 24  AM-GL-CODES           PIC X.
  5197                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5198                 24  FILLER                PIC X(01).
  5199         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5200             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5201                 24  FILLER                PIC X(11).
  5202                 24  AM-L-COMA             PIC XXX.
  5203                 24  AM-J-COMA             PIC XXX.
  5204                 24  AM-A-COMA             PIC XXX.
  5205                 24  FILLER                PIC X(6).
  5206
  5207     12  AM-COMM-CHANGE-STATUS             PIC X.
  5208         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5209
  5210     12  AM-CSR-CODE                       PIC X(4).
  5211
  5212     12  AM-BILLING-STATUS                 PIC X.
  5213         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5214         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5215     12  AM-AUTO-REFUND-SW                 PIC X.
  5216         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5217         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5218     12  AM-GPCD                           PIC 99.
  5219     12  AM-IG                             PIC X.
  5220         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5221         88  AM-HAS-GROUP                     VALUE '2'.
  5222     12  AM-STATUS                         PIC X.
  5223         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5224         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5225         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5226         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5227         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5228     12  AM-REMIT-TO                       PIC 99.
  5229     12  AM-ID-NO                          PIC X(11).
  5230
  5231     12  AM-CAL-TABLE                      PIC XX.
  5232     12  AM-LF-DEVIATION                   PIC XXX.
  5233     12  AM-AH-DEVIATION                   PIC XXX.
  5234     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5235     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5236     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5237     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5238     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5239     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5240
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 100
* EL130.cbl
  5241     12  AM-USER-FIELDS.
  5242         16  AM-FLD-1                      PIC XX.
  5243         16  AM-FLD-2                      PIC XX.
  5244         16  AM-FLD-3                      PIC XX.
  5245         16  AM-FLD-4                      PIC XX.
  5246         16  AM-FLD-5                      PIC XX.
  5247
  5248     12  AM-1ST-PROD-DATE.
  5249         16  AM-1ST-PROD-YR                PIC XX.
  5250         16  AM-1ST-PROD-MO                PIC XX.
  5251         16  AM-1ST-PROD-DA                PIC XX.
  5252     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5253     12  AM-CERTS-PURGED-DATE.
  5254         16  AM-PUR-YR                     PIC XX.
  5255         16  AM-PUR-MO                     PIC XX.
  5256         16  AM-PUR-DA                     PIC XX.
  5257     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5258     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5259     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5260     12  AM-INACTIVE-DATE.
  5261         16  AM-INA-MO                     PIC 99.
  5262         16  AM-INA-DA                     PIC 99.
  5263         16  AM-INA-YR                     PIC 99.
  5264     12  AM-AR-HI-CERT-DATE                PIC XX.
  5265
  5266     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5267     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5268
  5269     12  AM-OB-PAYMENT-MODE                PIC X.
  5270         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5271         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5272         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5273         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5274
  5275     12  AM-AH-ONLY-INDICATOR              PIC X.
  5276         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5277         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5278
  5279     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5280
  5281     12  AM-OVER-SHORT.
  5282         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5283         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5284
  5285     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5286     12  AM-DCC-CLP-STATE                  PIC XX.
  5287
  5288     12  AM-RECALC-COMM                    PIC X.
  5289     12  AM-RECALC-REIN                    PIC X.
  5290
  5291     12  AM-REI-TABLE                      PIC XXX.
  5292     12  AM-REI-ET-LF                      PIC X.
  5293     12  AM-REI-ET-AH                      PIC X.
  5294     12  AM-REI-PE-LF                      PIC X.
  5295     12  AM-REI-PE-AH                      PIC X.
  5296     12  AM-REI-PRT-ST                     PIC X.
  5297     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5298     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 101
* EL130.cbl
  5299     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5300     12  AM-REI-GROUP-A                    PIC X(6).
  5301     12  AM-REI-MORT                       PIC X(4).
  5302     12  AM-REI-PRT-OW                     PIC X.
  5303     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5304     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5305     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5306     12  AM-REI-GROUP-B                    PIC X(6).
  5307
  5308     12  AM-TRUST-TYPE                     PIC X(2).
  5309
  5310     12  AM-EMPLOYER-STMT-USED             PIC X.
  5311     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5312
  5313     12  AM-STD-AH-TYPE                    PIC XX.
  5314     12  AM-EARN-METHODS.
  5315         16  AM-EARN-METHOD-R              PIC X.
  5316             88 AM-REF-RL-R78                 VALUE 'R'.
  5317             88 AM-REF-RL-PR                  VALUE 'P'.
  5318             88 AM-REF-RL-MEAN                VALUE 'M'.
  5319             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5320         16  AM-EARN-METHOD-L              PIC X.
  5321             88 AM-REF-LL-R78                 VALUE 'R'.
  5322             88 AM-REF-LL-PR                  VALUE 'P'.
  5323             88 AM-REF-LL-MEAN                VALUE 'M'.
  5324             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5325         16  AM-EARN-METHOD-A              PIC X.
  5326             88 AM-REF-AH-R78                 VALUE 'R'.
  5327             88 AM-REF-AH-PR                  VALUE 'P'.
  5328             88 AM-REF-AH-MEAN                VALUE 'M'.
  5329             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5330             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5331             88 AM-REF-AH-NET                 VALUE 'N'.
  5332
  5333     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5334     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5335     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5336
  5337     12  AM-RET-Y-N                        PIC X.
  5338     12  AM-RET-P-E                        PIC X.
  5339     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5340     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5341     12  AM-RET-GRP                        PIC X(6).
  5342     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5343         16  AM-POOL-PRIME                 PIC XXX.
  5344         16  AM-POOL-SUB                   PIC XXX.
  5345     12  AM-RETRO-EARNINGS.
  5346         16  AM-RET-EARN-R                 PIC X.
  5347         16  AM-RET-EARN-L                 PIC X.
  5348         16  AM-RET-EARN-A                 PIC X.
  5349     12  AM-RET-ST-TAX-USE                 PIC X.
  5350         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5351         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5352     12  AM-RETRO-BEG-EARNINGS.
  5353         16  AM-RET-BEG-EARN-R             PIC X.
  5354         16  AM-RET-BEG-EARN-L             PIC X.
  5355         16  AM-RET-BEG-EARN-A             PIC X.
  5356     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 102
* EL130.cbl
  5357     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5358
  5359     12  AM-USER-SELECT-OPTIONS.
  5360         16  AM-USER-SELECT-1              PIC X(10).
  5361         16  AM-USER-SELECT-2              PIC X(10).
  5362         16  AM-USER-SELECT-3              PIC X(10).
  5363         16  AM-USER-SELECT-4              PIC X(10).
  5364         16  AM-USER-SELECT-5              PIC X(10).
  5365
  5366     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5367
  5368     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5369
  5370     12  AM-RPT045A-SWITCH                 PIC X.
  5371         88  RPT045A-OFF                   VALUE 'N'.
  5372
  5373     12  AM-INSURANCE-LIMITS.
  5374         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5375         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5376
  5377     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5378         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5379
  5380     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5381         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5382         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5383
  5384     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5385
  5386     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5387     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5388     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5389     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5390     12  FILLER                            PIC X(5).
  5391     12  AM-REPORT-CODE-3                  PIC X(10).
  5392*    12  FILLER                            PIC X(22).
  5393
  5394     12  AM-RESERVE-DATE.
  5395         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5396         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5397         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5398
  5399     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5400     12  AM-NOTIFICATION-TYPES.
  5401         16  AM-NOTIF-OF-LETTERS           PIC X.
  5402         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5403         16  AM-NOTIF-OF-REPORTS           PIC X.
  5404         16  AM-NOTIF-OF-STATUS            PIC X.
  5405
  5406     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5407         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5408         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5409         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5410         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5411
  5412     12  AM-BENEFIT-CONTROLS.
  5413         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5414             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 103
* EL130.cbl
  5415             20  AM-BENEFIT-TYPE           PIC X.
  5416             20  AM-BENEFIT-REVISION       PIC XXX.
  5417             20  AM-BENEFIT-REM-TERM       PIC X.
  5418             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5419             20  FILLER                    PIC XX.
  5420         16  FILLER                        PIC X(80).
  5421
  5422     12  AM-TRANSFER-DATA.
  5423         16  AM-TRANSFERRED-FROM.
  5424             20  AM-TRNFROM-CARRIER        PIC X.
  5425             20  AM-TRNFROM-GROUPING.
  5426                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5427                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5428             20  AM-TRNFROM-STATE          PIC XX.
  5429             20  AM-TRNFROM-ACCOUNT.
  5430                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5431                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5432             20  AM-TRNFROM-DTE            PIC XX.
  5433         16  AM-TRANSFERRED-TO.
  5434             20  AM-TRNTO-CARRIER          PIC X.
  5435             20  AM-TRNTO-GROUPING.
  5436                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5437                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5438             20  AM-TRNTO-STATE            PIC XX.
  5439             20  AM-TRNTO-ACCOUNT.
  5440                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5441                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5442             20  AM-TRNTO-DTE              PIC XX.
  5443         16  FILLER                        PIC X(10).
  5444
  5445     12  AM-SAVED-REMIT-TO                 PIC 99.
  5446
  5447     12  AM-COMM-STRUCTURE-SAVED.
  5448         16  AM-DEFN-1-SAVED.
  5449             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5450                 24  AM-AGT-SV             PIC X(10).
  5451                 24  AM-COM-TYP-SV         PIC X.
  5452                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5453                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5454                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5455                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5456                 24  FILLER                PIC X.
  5457                 24  AM-GL-CODES-SV        PIC X.
  5458                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5459                 24  FILLER                PIC X.
  5460         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5461             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5462                 24  FILLER                PIC X(11).
  5463                 24  AM-L-COMA-SV          PIC XXX.
  5464                 24  AM-J-COMA-SV          PIC XXX.
  5465                 24  AM-A-COMA-SV          PIC XXX.
  5466                 24  FILLER                PIC X(6).
  5467
  5468     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5469         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5470            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5471            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5472            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 104
* EL130.cbl
  5473
  5474     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5475     12  FILLER                            PIC X(120).
  5476
  5477     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5478         16  AM-CONTROL-NAME               PIC X(30).
  5479         16  AM-EXECUTIVE-ONE.
  5480             20  AM-EXEC1-NAME             PIC X(15).
  5481             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5482                                                          COMP-3.
  5483             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5484                                                          COMP-3.
  5485         16  AM-EXECUTIVE-TWO.
  5486             20  AM-EXEC2-NAME             PIC X(15).
  5487             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5488                                                          COMP-3.
  5489             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5490                                                          COMP-3.
  5491
  5492     12  AM-RETRO-ADDITIONAL-DATA.
  5493         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5494         16  AM-RETRO-PREM-P-E             PIC X.
  5495         16  AM-RETRO-CLMS-P-I             PIC X.
  5496         16  AM-RETRO-RET-BRACKET-LF.
  5497             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5498                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5499                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5500             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5501                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5502                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5503             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5504                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5505                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5506         16  AM-RETRO-RET-BRACKET-AH.
  5507             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5508                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5509                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5510                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5511             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5512                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5513                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5514             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5515                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5516                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5517
  5518     12  AM-COMMENTS.
  5519         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5520
  5521     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5522         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5523         16  AM-FLI-BILLING-CODE           PIC X.
  5524         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5525         16  AM-FLI-UNITED-IDENT           PIC X.
  5526         16  AM-FLI-INTEREST-LOST-DATA.
  5527             20  AM-FLI-BANK-NO            PIC X(5).
  5528             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5529             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5530             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 105
* EL130.cbl
  5531         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5532             20  AM-FLI-AGT                PIC X(9).
  5533             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5534             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5535         16  FILLER                        PIC X(102).
  5536
  5537     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5538         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5539             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5540             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5541             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5542             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5543             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5544         16  FILLER                          PIC X(10).
  5545******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 106
* EL130.cbl
  5547*    COPY ELCTRLR.
  5548******************************************************************
  5549*                                                                *
  5550*                            ELCTRLR.                            *
  5551*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5552*                            VMOD=2.014                          *
  5553*                                                                *
  5554*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5555*                                                                *
  5556*   FILE TYPE = VSAM,KSDS                                        *
  5557*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5558*                                                                *
  5559*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5560*       ALTERNATE INDEX = NONE                                   *
  5561*                                                                *
  5562*   LOG = YES                                                    *
  5563*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5564******************************************************************
  5565*                   C H A N G E   L O G
  5566*
  5567* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5568*-----------------------------------------------------------------
  5569*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5570* EFFECTIVE    NUMBER
  5571*-----------------------------------------------------------------
  5572* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5573* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5574* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5575* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5576* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5577* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5578* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5579* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5580* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5581* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5582* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5583* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5584******************************************************************
  5585 01  ACTIVITY-TRAILERS.
  5586     12  AT-RECORD-ID                    PIC XX.
  5587         88  VALID-AT-ID                       VALUE 'AT'.
  5588
  5589     12  AT-CONTROL-PRIMARY.
  5590         16  AT-COMPANY-CD               PIC X.
  5591         16  AT-CARRIER                  PIC X.
  5592         16  AT-CLAIM-NO                 PIC X(7).
  5593         16  AT-CERT-NO.
  5594             20  AT-CERT-PRIME           PIC X(10).
  5595             20  AT-CERT-SFX             PIC X.
  5596         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5597             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5598             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5599             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5600             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5601             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5602             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5603             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5604             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 107
* EL130.cbl
  5605             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5606             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5607             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5608             88  AT-BENEFICIARY-TRL           VALUE +91.
  5609             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5610
  5611     12  AT-TRAILER-TYPE                 PIC X.
  5612         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5613         88  PAYMENT-TR                       VALUE '2'.
  5614         88  AUTO-PAY-TR                      VALUE '3'.
  5615         88  CORRESPONDENCE-TR                VALUE '4'.
  5616         88  ADDRESS-TR                       VALUE '5'.
  5617         88  GENERAL-INFO-TR                  VALUE '6'.
  5618         88  AUTO-PROMPT-TR                   VALUE '7'.
  5619         88  DENIAL-TR                        VALUE '8'.
  5620         88  INCURRED-CHG-TR                  VALUE '9'.
  5621         88  FORM-CONTROL-TR                  VALUE 'A'.
  5622
  5623     12  AT-RECORDED-DT                  PIC XX.
  5624     12  AT-RECORDED-BY                  PIC X(4).
  5625     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5626
  5627     12  AT-TRAILER-BODY                 PIC X(165).
  5628
  5629     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5630         16  AT-RESERVE-CONTROLS.
  5631             20  AT-MANUAL-SW            PIC X.
  5632                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5633             20  AT-FUTURE-SW            PIC X.
  5634                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5635             20  AT-PTC-SW               PIC X.
  5636                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5637             20  AT-IBNR-SW              PIC X.
  5638                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5639             20  AT-PTC-LF-SW            PIC X.
  5640                 88  AT-LF-PTC-USED          VALUE '1'.
  5641             20  AT-CDT-ACCESS-METHOD    PIC X.
  5642                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5643                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5644                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5645             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5646         16  AT-LAST-COMPUTED-DT         PIC XX.
  5647         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5648         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5649         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5650         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5651         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5652         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5653         16  AT-EXPENSE-CONTROLS.
  5654             20  AT-EXPENSE-METHOD       PIC X.
  5655                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5656                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5657                 88  PERCENT-OF-PMT           VALUE '3'.
  5658                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5659             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5660             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5661         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5662         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 108
* EL130.cbl
  5663
  5664         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5665         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5666
  5667*        16  FILLER                      PIC X(53).
  5668         16  FILLER                      PIC X(47).
  5669
  5670         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5671         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5672
  5673         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5674             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5675             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5676*                    C = CLOSED
  5677*                    O = OPEN
  5678             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5679*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5680
  5681     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5682         16  AT-PAYMENT-TYPE             PIC X.
  5683             88  PARTIAL-PAYMENT                VALUE '1'.
  5684             88  FINAL-PAYMENT                  VALUE '2'.
  5685             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5686             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5687             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5688             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5689             88  VOIDED-PAYMENT                 VALUE '9'.
  5690             88  TRANSFER                       VALUE 'T'.
  5691             88  LIFE-INTEREST                  VALUE 'I'.
  5692
  5693         16  AT-CLAIM-TYPE               PIC X.
  5694             88  PAID-FOR-AH                    VALUE 'A'.
  5695             88  PAID-FOR-LIFE                  VALUE 'L'.
  5696             88  PAID-FOR-IUI                   VALUE 'I'.
  5697             88  PAID-FOR-GAP                   VALUE 'G'.
  5698         16  AT-CLAIM-PREM-TYPE          PIC X.
  5699             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5700             88  AT-O-B-COVERAGE                VALUE '2'.
  5701             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5702         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5703         16  AT-CHECK-NO                 PIC X(7).
  5704         16  AT-PAID-FROM-DT             PIC XX.
  5705         16  AT-PAID-THRU-DT             PIC XX.
  5706         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5707         16  FILLER                      PIC X.
  5708         16  AT-PAYEES-NAME              PIC X(30).
  5709         16  AT-PAYMENT-ORIGIN           PIC X.
  5710             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5711             88  ONLINE-AUTO-PMT                VALUE '2'.
  5712             88  OFFLINE-PMT                    VALUE '3'.
  5713         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5714         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5715         16  AT-VOID-DATA.
  5716             20  AT-VOID-DT              PIC XX.
  5717*00144       20  AT-VOID-REASON          PIC X(30).
  5718             20  AT-VOID-REASON          PIC X(26).
  5719         16  AT-PMT-APPROVED-BY          PIC X(04).
  5720         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 109
* EL130.cbl
  5721         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5722         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5723                                         PIC S99V9(5)  COMP-3.
  5724         16  AT-CREDIT-INTERFACE.
  5725             20  AT-PMT-SELECT-DT        PIC XX.
  5726                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5727             20  AT-PMT-ACCEPT-DT        PIC XX.
  5728                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5729             20  AT-VOID-SELECT-DT       PIC XX.
  5730                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5731             20  AT-VOID-ACCEPT-DT       PIC XX.
  5732                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5733
  5734         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5735                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5736                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5737         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5738
  5739         16  AT-FORCE-CONTROL            PIC X.
  5740             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5741         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5742         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5743         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5744         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5745         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5746         16  AT-BENEFIT-TYPE             PIC X.
  5747
  5748         16  AT-EXPENSE-TYPE             PIC X.
  5749         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5750
  5751         16  AT-PAYEE-TYPE-CD.
  5752             20  AT-PAYEE-TYPE           PIC X.
  5753                 88  INSURED-PAID           VALUE 'I'.
  5754                 88  BENEFICIARY-PAID       VALUE 'B'.
  5755                 88  ACCOUNT-PAID           VALUE 'A'.
  5756                 88  OTHER-1-PAID           VALUE 'O'.
  5757                 88  OTHER-2-PAID           VALUE 'Q'.
  5758                 88  DOCTOR-PAID            VALUE 'P'.
  5759                 88  EMPLOYER-PAID          VALUE 'E'.
  5760             20  AT-PAYEE-SEQ            PIC X.
  5761
  5762         16  AT-CASH-PAYMENT             PIC X.
  5763         16  AT-GROUPED-PAYMENT          PIC X.
  5764         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5765         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5766         16  AT-APPROVED-LEVEL           PIC X.
  5767         16  AT-VOID-TYPE                PIC X.
  5768             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5769             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5770         16  AT-AIG-UNEMP-IND            PIC X.
  5771             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5772         16  AT-ASSOCIATES               PIC X.
  5773             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5774             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5775
  5776         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5777         16  AT-CV-PMT-CODE              PIC X.
  5778             88  FULL-DEATH-PAYMENT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 110
* EL130.cbl
  5779             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5780             88  FULL-ADD-PAYMENT           VALUE '3'.
  5781             88  HALF-ADD-PAYMENT           VALUE '4'.
  5782             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5783             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5784             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5785             88  ADDL-PAYMENT               VALUE '8'.
  5786
  5787         16  AT-EOB-CODE1                PIC XXX.
  5788         16  AT-EOB-CODE2                PIC XXX.
  5789         16  AT-EOB-CODE3                PIC XXX.
  5790         16  AT-EOB-CODE4                PIC XXX.
  5791         16  FILLER REDEFINES AT-EOB-CODE4.
  5792             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5793             20  FILLER                  PIC X.
  5794         16  AT-EOB-CODE5                PIC XXX.
  5795         16  FILLER REDEFINES AT-EOB-CODE5.
  5796             20  AT-PMT-PROOF-DT         PIC XX.
  5797             20  FILLER                  PIC X.
  5798
  5799         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5800             88  AT-PRINT-EOB            VALUE 'Y'.
  5801
  5802         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5803         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5804
  5805     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5806         16  AT-SCHEDULE-START-DT        PIC XX.
  5807         16  AT-SCHEDULE-END-DT          PIC XX.
  5808         16  AT-TERMINATED-DT            PIC XX.
  5809         16  AT-LAST-PMT-TYPE            PIC X.
  5810             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5811             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5812         16  AT-FIRST-PMT-DATA.
  5813             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5814             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5815             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5816         16  AT-REGULAR-PMT-DATA.
  5817             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5818             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5819             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5820         16  AT-AUTO-PAYEE-CD.
  5821             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5822                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5823                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5824                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5825                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5826                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5827             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5828         16  AT-AUTO-PAY-DAY             PIC 99.
  5829         16  AT-AUTO-CASH                PIC X.
  5830             88  AT-CASH                      VALUE 'Y'.
  5831             88  AT-NON-CASH                  VALUE 'N'.
  5832*        16  FILLER                      PIC X(129).
  5833         16  AT-AUTO-END-LETTER          PIC X(4).
  5834         16  FILLER                      PIC X(125).
  5835
  5836         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 111
* EL130.cbl
  5837         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5838
  5839     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5840         16  AT-LETTER-SENT-DT           PIC XX.
  5841         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5842         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5843         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5844         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5845         16  AT-LETTER-ORIGIN            PIC X.
  5846             88  ONLINE-CREATION              VALUE '1' '3'.
  5847             88  OFFLINE-CREATION             VALUE '2' '4'.
  5848             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5849             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5850         16  AT-STD-LETTER-FORM          PIC X(4).
  5851         16  AT-REASON-TEXT              PIC X(70).
  5852         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5853         16  AT-ADDRESEE-TYPE            PIC X.
  5854              88  INSURED-ADDRESEE            VALUE 'I'.
  5855              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5856              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5857              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5858              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5859              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5860              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5861         16  AT-ADDRESSEE-NAME           PIC X(30).
  5862         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5863         16  AT-RESEND-PRINT-DATE        PIC XX.
  5864         16  AT-CORR-SOL-UNSOL           PIC X.
  5865         16  AT-LETTER-PURGED-DT         PIC XX.
  5866*
  5867*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5868*
  5869         16  AT-CSO-REDEFINITION.
  5870             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5871             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5872             20  AT-LETTER-TO-BENE       PIC X(1).
  5873             20  AT-STOP-LETTER-DT       PIC X(2).
  5874             20  FILLER                  PIC X(19).
  5875*             20  FILLER                  PIC X(27).
  5876             20  AT-CSO-LETTER-STATUS    PIC X.
  5877                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5878                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  5879                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5880             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5881             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5882*
  5883*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5884*
  5885*        16  FILLER                      PIC X(26).
  5886*
  5887*        16  AT-DMD-BSR-CODE             PIC X.
  5888*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  5889*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  5890*
  5891*        16  AT-DMD-LETTER-STATUS        PIC X.
  5892*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  5893*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  5894*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 112
* EL130.cbl
  5895*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  5896*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  5897
  5898         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  5899         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  5900
  5901     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  5902         16  AT-ADDRESS-TYPE             PIC X.
  5903             88  INSURED-ADDRESS               VALUE 'I'.
  5904             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  5905             88  ACCOUNT-ADDRESS               VALUE 'A'.
  5906             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  5907             88  EMPLOYER-ADDRESS              VALUE 'E'.
  5908             88  OTHER-ADDRESS-1               VALUE 'O'.
  5909             88  OTHER-ADDRESS-2               VALUE 'Q'.
  5910         16  AT-MAIL-TO-NAME             PIC X(30).
  5911         16  AT-ADDRESS-LINE-1           PIC X(30).
  5912         16  AT-ADDRESS-LINE-2           PIC X(30).
  5913         16  AT-CITY-STATE.
  5914             20  AT-CITY                 PIC X(28).
  5915             20  AT-STATE                PIC XX.
  5916         16  AT-ZIP.
  5917             20  AT-ZIP-CODE.
  5918                 24  AT-ZIP-1ST          PIC X.
  5919                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5920                 24  FILLER              PIC X(4).
  5921             20  AT-ZIP-PLUS4            PIC X(4).
  5922         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  5923             20  AT-CAN-POSTAL-1         PIC XXX.
  5924             20  AT-CAN-POSTAL-2         PIC XXX.
  5925             20  FILLER                  PIC XXX.
  5926         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  5927         16  FILLER                      PIC X(23).
  5928         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  5929         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  5930
  5931     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  5932         16  AT-INFO-LINE-1              PIC X(60).
  5933         16  AT-INFO-LINE-2              PIC X(60).
  5934         16  AT-INFO-TRAILER-TYPE        PIC X.
  5935             88  AT-PAYMENT-NOTE         VALUE 'P'.
  5936             88  AT-CALL-NOTE            VALUE 'C'.
  5937             88  AT-MAINT-NOTE           VALUE 'M'.
  5938             88  AT-CERT-CHANGE          VALUE 'X'.
  5939             88  AT-APPROVAL-NOTE        VALUE 'R'.
  5940             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  5941         16  AT-CALL-TYPE                PIC X.
  5942             88  AT-PHONE-CALL-IN        VALUE 'I'.
  5943             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  5944         16  AT-NOTE-CONTINUATION        PIC X.
  5945             88  AT-CONTINUED-NOTE       VALUE 'X'.
  5946         16  AT-EOB-CODES-EXIST          PIC X.
  5947             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  5948         16  FILLER                      PIC X(35).
  5949         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  5950         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  5951
  5952     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 113
* EL130.cbl
  5953         16  AT-PROMPT-LINE-1            PIC X(60).
  5954         16  AT-PROMPT-LINE-2            PIC X(60).
  5955         16  AT-PROMPT-START-DT          PIC XX.
  5956         16  AT-PROMPT-END-DT            PIC XX.
  5957         16  FILLER                      PIC X(35).
  5958         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  5959         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  5960
  5961     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  5962         16  AT-DENIAL-INFO-1            PIC X(60).
  5963         16  AT-DENIAL-INFO-2            PIC X(60).
  5964         16  AT-DENIAL-DT                PIC XX.
  5965         16  AT-RETRACTION-DT            PIC XX.
  5966         16  AT-DENIAL-REASON-CODE       PIC X(4).
  5967*         16  FILLER                      PIC X(31).
  5968         16  AT-DENIAL-PROOF-DT          PIC XX.
  5969         16  FILLER                      PIC X(29).
  5970         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  5971         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  5972
  5973     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  5974         16  AT-OLD-INCURRED-DT          PIC XX.
  5975         16  AT-OLD-REPORTED-DT          PIC XX.
  5976         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  5977         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  5978         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  5979         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  5980         16  AT-OLD-PAID-THRU-DT         PIC XX.
  5981         16  AT-LAST-PMT-MADE-DT         PIC XX.
  5982         16  FILLER                      PIC X(26).
  5983         16  AT-OLD-DIAG-CODE            PIC X(6).
  5984         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  5985         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  5986         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  5987         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  5988         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  5989         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  5990         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  5991         16  FILLER                      PIC X(25).
  5992         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  5993
  5994     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  5995         16  AT-FORM-SEND-ON-DT          PIC XX.
  5996         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  5997         16  AT-FORM-RE-SEND-DT          PIC XX.
  5998         16  AT-FORM-ANSWERED-DT         PIC XX.
  5999         16  AT-FORM-PRINTED-DT          PIC XX.
  6000         16  AT-FORM-REPRINT-DT          PIC XX.
  6001         16  AT-FORM-TYPE                PIC X.
  6002             88  INITIAL-FORM                  VALUE '1'.
  6003             88  PROGRESS-FORM                 VALUE '2'.
  6004         16  AT-INSTRUCT-LN-1            PIC X(28).
  6005         16  AT-INSTRUCT-LN-2            PIC X(28).
  6006         16  AT-INSTRUCT-LN-3            PIC X(28).
  6007         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6008         16  AT-FORM-ADDRESS             PIC X.
  6009             88  FORM-TO-INSURED              VALUE 'I'.
  6010             88  FORM-TO-ACCOUNT              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 114
* EL130.cbl
  6011             88  FORM-TO-OTHER-1              VALUE 'O'.
  6012             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6013         16  AT-RELATED-1.
  6014             20 AT-REL-CARR-1            PIC X.
  6015             20 AT-REL-CLAIM-1           PIC X(7).
  6016             20 AT-REL-CERT-1            PIC X(11).
  6017         16  AT-RELATED-2.
  6018             20 AT-REL-CARR-2            PIC X.
  6019             20 AT-REL-CLAIM-2           PIC X(7).
  6020             20 AT-REL-CERT-2            PIC X(11).
  6021         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6022         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6023         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6024         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6025         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6026         16  AT-STOP-FORM-DT             PIC X(2).
  6027
  6028         16  FILLER                      PIC X(09).
  6029         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6030         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6031******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 115
* EL130.cbl
  6033*    COPY ELCBENE.
  6034******************************************************************
  6035*                                                                *
  6036*                            ELCBENE.                            *
  6037*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6038*                            VMOD=2.006                          *
  6039*                                                                *
  6040*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6041*                                                                *
  6042*   FILE TYPE = VSAM,KSDS                                        *
  6043*   RECORD SIZE = 500   RECFORM = FIX                            *
  6044*                                                                *
  6045*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6046*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6047*                                                                *
  6048*   LOG = YES                                                    *
  6049*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6050*                                                                *
  6051*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6052******************************************************************
  6053
  6054 01  BENEFICIARY-MASTER.
  6055     12  BE-RECORD-ID                PIC XX.
  6056         88  VALID-BE-ID                VALUE 'BE'.
  6057
  6058     12  BE-CONTROL-PRIMARY.
  6059         16  BE-COMPANY-CD           PIC X.
  6060         16  BE-RECORD-TYPE          PIC X.
  6061             88  BENEFICIARY-RECORD  VALUE 'B'.
  6062             88  ADJUSTOR-RECORD     VALUE 'A'.
  6063         16  BE-BENEFICIARY          PIC X(10).
  6064     12  BE-CONTROL-BY-NAME.
  6065         16  BE-COMPANY-CD-A1        PIC X.
  6066         16  BE-RECORD-TYPE-A1       PIC X.
  6067         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6068         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6069
  6070     12  BE-LAST-MAINT-DT            PIC XX.
  6071     12  BE-LAST-MAINT-BY            PIC X(4).
  6072     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6073
  6074     12  BE-ADDRESS-DATA.
  6075         16  BE-MAIL-TO-NAME         PIC X(30).
  6076         16  BE-ADDRESS-LINE-1       PIC X(30).
  6077         16  BE-ADDRESS-LINE-2       PIC X(30).
  6078         16  BE-ADDRESS-LINE-3       PIC X(30).
  6079         16  BE-CITY-STATE.
  6080             20  BE-CITY             PIC X(28).
  6081             20  BE-STATE            PIC XX.
  6082         16  BE-ZIP-CODE.
  6083             20  BE-ZIP-PRIME.
  6084                 24  BE-ZIP-1ST      PIC X.
  6085                     88  BE-CANADIAN-POST-CODE
  6086                                         VALUE 'A' THRU 'Z'.
  6087                 24  FILLER          PIC X(4).
  6088             20  BE-ZIP-PLUS4        PIC X(4).
  6089         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6090             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 116
* EL130.cbl
  6091             20  BE-CAN-POSTAL-2     PIC XXX.
  6092             20  FILLER              PIC XXX.
  6093         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6094         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6095
  6096******************************************************************
  6097*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6098*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6099******************************************************************
  6100     12  BE-CARRIER                  PIC X.
  6101
  6102     12  BE-ADDRESS-DATA2.
  6103         16  BE-MAIL-TO-NAME2        PIC X(30).
  6104         16  BE-ADDRESS-LINE-12      PIC X(30).
  6105         16  BE-ADDRESS-LINE-22      PIC X(30).
  6106         16  BE-ADDRESS-LINE-32      PIC X(30).
  6107         16  BE-CITY-STATE2.
  6108             20  BE-CITY2            PIC X(28).
  6109             20  BE-STATE2           PIC XX.
  6110         16  BE-ZIP-CODE2.
  6111             20  BE-ZIP-PRIME2.
  6112                 24  BE-ZIP-1ST2     PIC X.
  6113                     88  BE-CANADIAN-POST-CODE2
  6114                                         VALUE 'A' THRU 'Z'.
  6115                 24  FILLER          PIC X(4).
  6116             20  BE-ZIP-PLUS42       PIC X(4).
  6117         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6118             20  BE-CAN-POSTAL-12    PIC XXX.
  6119             20  BE-CAN-POSTAL-22    PIC XXX.
  6120             20  FILLER              PIC XXX.
  6121         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6122         16  BE-BILLING-STMT-DATA.
  6123             20  BE-BSR              PIC X.
  6124                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6125                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6126             20  BE-BSR-FROM         PIC X(30).
  6127             20  BE-BSR-DEPT         PIC X(30).
  6128             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6129             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6130             20  BE-OUTPUT-TYPE      PIC X.
  6131                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6132                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6133
  6134     12  FILLER                      PIC X(28).
  6135******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 117
* EL130.cbl
  6137*    COPY ELCDAR.
  6138******************************************************************
  6139*                                                                *
  6140*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6141*   FILE TYPE = VSAM,KSDS                                        *
  6142*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6143*   BASE CLUSTER = DLYACTV                                       *
  6144*   LOG = YES                                                    *
  6145*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6146*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6147*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6148*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6149*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6150*               BY PROGRAM "LGINFCE".                            *
  6151*                                                                *
  6152******************************************************************
  6153 01  DAILY-ACTIVITY-RECORD.
  6154     05  DA-KEY.
  6155         10  DA-COMP-CD          PIC X.
  6156         10  DA-CARRIER          PIC X.
  6157         10  DA-CLAIM-NO         PIC X(7).
  6158         10  DA-CERT-NO.
  6159             15  DA-CERT-PRIME   PIC X(10).
  6160             15  DA-CERT-SFX     PIC X.
  6161     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6162     05  DA-RECORD-TYPE          PIC X.
  6163     05  FILLER                  PIC X(2).
  6164******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 118
* EL130.cbl
  6166*    COPY ELCACTQ.
  6167******************************************************************
  6168*                                                                *
  6169*                            ELCACTQ.                            *
  6170*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6171*                            VMOD=2.004                          *
  6172*                                                                *
  6173*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6174*                                                                *
  6175*   FILE TYPE = VSAM,KSDS                                        *
  6176*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6177*                                                                *
  6178*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6179*       ALTERNATE INDEX = NONE                                   *
  6180*                                                                *
  6181*   LOG = YES                                                    *
  6182*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6183*                                                                *
  6184*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6185******************************************************************
  6186
  6187 01  ACTIVITY-QUE.
  6188     12  AQ-RECORD-ID                PIC XX.
  6189         88  VALID-AQ-ID                VALUE 'AQ'.
  6190
  6191     12  AQ-CONTROL-PRIMARY.
  6192         16  AQ-COMPANY-CD           PIC X.
  6193         16  AQ-CARRIER              PIC X.
  6194         16  AQ-CLAIM-NO             PIC X(7).
  6195         16  AQ-CERT-NO.
  6196             20  AQ-CERT-PRIME       PIC X(10).
  6197             20  AQ-CERT-SFX         PIC X.
  6198
  6199     12  AQ-PENDING-ACTIVITY-FLAGS.
  6200         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6201         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6202             88  PENDING-PAYMENTS       VALUE '1'.
  6203         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6204             88  PENDING-FULL-PRINT     VALUE '1'.
  6205             88  PENDING-PART-PRINT     VALUE '2'.
  6206         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6207             88  PENDING-LETTERS        VALUE '1'.
  6208         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6209             88  PENDING-RESTORE        VALUE 'C'.
  6210             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6211
  6212     12  FILLER                      PIC X(20).
  6213
  6214     12  AQ-RESEND-DATE              PIC XX.
  6215     12  AQ-FOLLOWUP-DATE            PIC XX.
  6216     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6217     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6218     12  AQ-AUTO-LETTER              PIC X(4).
  6219     12  FILLER                      PIC XX.
  6220     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6221*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 119
* EL130.cbl
  6223*    COPY ELCARCH.
  6224******************************************************************
  6225*                                                                *
  6226*                            ELCARCH.                            *
  6227*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6228*                            VMOD=2.007                          *
  6229*                                                                *
  6230*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6231*                                                                *
  6232*   FILE TYPE = VSAM,KSDS                                        *
  6233*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6234*                                                                *
  6235*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6236*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6237*                                                                *
  6238*   LOG = NO                                                     *
  6239*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6240*                                                                *
  6241*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6242******************************************************************
  6243 01  LETTER-ARCHIVE.
  6244     12  LA-RECORD-ID                PIC XX.
  6245         88  VALID-LA-ID                VALUE 'LA'.
  6246
  6247     12  LA-CONTROL-PRIMARY.
  6248         16  LA-COMPANY-CD           PIC X.
  6249         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6250         16  LA-RECORD-TYPE          PIC X.
  6251             88  LA-HEADER-DATA         VALUE '1'.
  6252             88  LA-ADDRESS-DATA        VALUE '2'.
  6253             88  LA-TEXT-DATA           VALUE '3'.
  6254             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6255         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6256
  6257     12  LA-CONTROL-BY-TYPE.
  6258         16  LA-COMPANY-CD-A1        PIC X.
  6259         16  LA-RECORD-TYPE-A1       PIC X.
  6260         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6261         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6262
  6263     12  LA-TEXT-RECORD.
  6264         16  LA-SKIP-CONTROL         PIC XX.
  6265             88  NO-LINES-SKIPPED       VALUE SPACES.
  6266             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6267         16  LA-TEXT-LINE            PIC X(70).
  6268
  6269     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6270         16  FILLER                  PIC XX.
  6271         16  LA-ADDRESS-LINE         PIC X(30).
  6272         16  FILLER                  PIC X(40).
  6273
  6274     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6275         16  FILLER                  PIC XX.
  6276         16  LA-CARRIER              PIC X.
  6277         16  LA-CLAIM-NO             PIC X(7).
  6278         16  LA-CERT-NO.
  6279             20  LA-CERT-PRIME       PIC X(10).
  6280             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 120
* EL130.cbl
  6281         16  LA-NO-OF-COPIES         PIC S9.
  6282         16  LA-RESEND-DATE          PIC XX.
  6283         16  LA-PROCESSOR-CD         PIC X(4).
  6284         16  LA-CREATION-DT          PIC XX.
  6285         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6286         16  LA-RESEND-PRINT-DATE    PIC XX.
  6287         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6288         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6289*
  6290* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6291*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6292*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6293*   I        20  LA-DMD-RES-ST           PIC XX.
  6294*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6295*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6296*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6297*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6298*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6299*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6300*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6301*   I        20  LA-DMD-UND-CODE         PIC XX.
  6302*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6303*   V    16  FILLER                  PIC X(15).
  6304* -----
  6305*
  6306* REINSERTED  CSO  MODS
  6307*
  6308         16  FILLER.
  6309             20  FILLER                  PIC X(29).
  6310             20  LA-CSO-LETTER-STATUS    PIC X.
  6311                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6312                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6313                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6314             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6315             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6316*
  6317
  6318     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6319         16  FILLER                  PIC XX.
  6320         16  LA4-CARRIER             PIC X.
  6321         16  LA4-CLAIM-NO            PIC X(7).
  6322         16  LA4-CERT-NO.
  6323             20  LA4-CERT-PRIME      PIC X(10).
  6324             20  LA4-CERT-SFX        PIC X.
  6325         16  LA4-NO-OF-COPIES        PIC S9.
  6326         16  LA4-RESEND-DATE         PIC XX.
  6327         16  LA4-PROCESSOR-CD        PIC X(4).
  6328         16  LA4-CREATION-DT         PIC XX.
  6329         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6330         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6331         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6332         16  LA4-FORM-TYPE           PIC X.
  6333             88  LA4-INITIAL-FORM    VALUE '1'.
  6334             88  LA4-PROGRESS-FORM   VALUE '2'.
  6335         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6336         16  LA4-STATE               PIC X(02).
  6337         16  FILLER                  PIC X(31).
  6338******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 121
* EL130.cbl
  6340*    COPY ERCREIN.
  6341******************************************************************
  6342*                                                                *
  6343*                            ERCREIN                             *
  6344*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6345*                            VMOD=2.010                          *
  6346*                                                                *
  6347*   ONLINE CREDIT SYSTEM                                         *
  6348*                                                                *
  6349*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6350*                                                                *
  6351*   FILE TYPE = VSAM,KSDS                                        *
  6352*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6353*                                                                *
  6354*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6355*       ALTERNATE PATH = NONE                                    *
  6356*                                                                *
  6357*   LOG = NO                                                     *
  6358*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6359*                                                                *
  6360******************************************************************
  6361*                   C H A N G E   L O G
  6362*
  6363* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6364*-----------------------------------------------------------------
  6365*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6366* EFFECTIVE    NUMBER
  6367*-----------------------------------------------------------------
  6368* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6369* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6370******************************************************************
  6371 01  REINSURANCE-RECORD.
  6372     12  RE-RECORD-ID                      PIC XX.
  6373         88  VALID-RE-ID                      VALUE 'RE'.
  6374
  6375     12  RE-CONTROL-PRIMARY.
  6376         16  RE-COMPANY-CD                 PIC X.
  6377         16  RE-KEY.
  6378             20  RE-CODE                   PIC X.
  6379                 88  RE-TABLE-RECORD          VALUE 'A'.
  6380                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6381             20  RE-TABLE                  PIC XXX.
  6382             20  FILLER                    PIC XXX.
  6383         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6384             20  FILLER                    PIC X.
  6385             20  RE-COMPANY.
  6386                 24  RE-COMP-PRIME         PIC XXX.
  6387                 24  RE-COMP-SUB           PIC XXX.
  6388
  6389     12  RE-MAINT-INFORMATION.
  6390         16  RE-LAST-MAINT-DT              PIC XX.
  6391         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6392         16  RE-LAST-MAINT-USER            PIC X(4).
  6393         16  FILLER                        PIC X(10).
  6394
  6395     12  RE-TABLE-DATA.
  6396         16  RE-100-COMP                   PIC 99.
  6397
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 122
* EL130.cbl
  6398         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6399             20  RE-REI-COMP-NO.
  6400                 24  RE-REI-COMP           PIC XXX.
  6401                 24  RE-REI-COMP-SUB       PIC XXX.
  6402             20  RE-LF-QC                  PIC X.
  6403             20  RE-AH-QC                  PIC X.
  6404             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6405             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6406             20  RE-LFAGE-LO               PIC 99.
  6407             20  RE-LFAGE-HI               PIC 99.
  6408             20  RE-AHAGE-LO               PIC 99.
  6409             20  RE-AHAGE-HI               PIC 99.
  6410             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6411             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6412             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6413             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6414             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6415             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6416             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6417             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6418             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6419             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6420             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6421             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6422             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6423             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6424             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6425             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6426             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6427             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6428             20  RE-LF-BEN-CODE            PIC X.
  6429             20  RE-AH-BEN-CODE            PIC X.
  6430             20  RE-INTERACTIVE            PIC X.
  6431             20  RE-REMAINING              PIC X.
  6432             20  RE-LF-RUNOFF-SW           PIC X.
  6433             20  RE-AH-RUNOFF-SW           PIC X.
  6434             20  FILLER                    PIC X(19).
  6435
  6436         16  RE-COMP-INFO-END              PIC X(6).
  6437         16  RE-NSP-ST-CD-LF               PIC XX.
  6438         16  RE-NSP-ST-CD-AH               PIC XX.
  6439         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6440             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6441
  6442         16  FILLER                        PIC X(27).
  6443
  6444     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6445         16  RE-NAME                       PIC X(30).
  6446         16  RE-LF-PE                      PIC X.
  6447         16  RE-AH-PE                      PIC X.
  6448         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6449         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6450         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6451         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6452         16  RE-PRT-ST                     PIC X.
  6453         16  RE-PRT-OW                     PIC X.
  6454         16  RE-MORT-CODE                  PIC X(4).
  6455         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 123
* EL130.cbl
  6456         16  RE-ZERO-LF-FEE                PIC X.
  6457         16  RE-ZERO-AH-FEE                PIC X.
  6458         16  RE-CEDE-NAME                  PIC X(30).
  6459         16  RE-LF-COMM                    PIC X.
  6460         16  RE-AH-COMM                    PIC X.
  6461         16  RE-LF-TAX                     PIC X.
  6462         16  RE-AH-TAX                     PIC X.
  6463         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6464         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6465         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6466
  6467         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6468             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6469
  6470         16  RE-LF-CEDING-FEE-BRACKETS.
  6471             20  RE-LF-FEE-METHOD          PIC X.
  6472                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6473                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6474                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6475                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6476             20  RE-LF-FEE-BASIS           PIC X.
  6477                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6478                 88  RE-LF-NET-CEDED               VALUE '2'.
  6479                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6480                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6481                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6482                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6483                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6484                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6485             20  FILLER                    PIC XXX.
  6486             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6487                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6488                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6489
  6490         16  RE-AH-CEDING-FEE-BRACKETS.
  6491             20  RE-AH-FEE-METHOD          PIC X.
  6492                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6493                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6494                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6495                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6496             20  RE-AH-FEE-BASIS           PIC X.
  6497                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6498                 88  RE-AH-NET-CEDED               VALUE '2'.
  6499                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6500                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6501                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6502                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6503                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6504                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6505             20  FILLER                    PIC XXX.
  6506             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6507                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6508                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6509
  6510         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6511
  6512         16  RE-OLD-CEDING-STMT            PIC X.
  6513
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 124
* EL130.cbl
  6514         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6515         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6516         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6517         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6518         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6519         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6520         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6521         16  RE-MORT-SW                    PIC X.
  6522         16  RE-CEDING-TYPE-FLAG           PIC X.
  6523             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6524             88  RE-CEDED                          VALUE 'C'.
  6525             88  RE-ASSUMED                        VALUE 'A'.
  6526             88  RE-PHANTOM                        VALUE 'P'.
  6527
  6528         16  RE-CEDING-STMT-OPT-A          PIC X.
  6529             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6530         16  RE-CEDING-STMT-OPT-B          PIC X.
  6531             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6532         16  RE-CEDING-STMT-OPT-C          PIC X.
  6533             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6534         16  RE-CEDING-STMT-OPT-D          PIC X.
  6535             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6536         16  RE-CEDING-STMT-OPT-E          PIC X.
  6537             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6538
  6539         16  RE-PRT-CRSV                   PIC X.
  6540
  6541         16  RE-GL-CENTER                  PIC X(4).
  6542
  6543         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6544
  6545         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6546
  6547         16  RE-EARN-STOP-CODE             PIC X.
  6548             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6549             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6550
  6551         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6552             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6553
  6554         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6555         16  FILLER                        PIC X(2281).
  6556
  6557         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6558
  6559******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 125
* EL130.cbl
  6561*    COPY ERCMAIL.
  6562******************************************************************
  6563*                                                                *
  6564*                                                                *
  6565*                            ERCMAIL                             *
  6566*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6567*                            VMOD=2.003                          *
  6568*                                                                *
  6569*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6570*                                                                *
  6571*   FILE TYPE = VSAM,KSDS                                        *
  6572*   RECORD SIZE = 374   RECFORM = FIX                            *
  6573*                                                                *
  6574*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6575*   ALTERNATE PATH    = NOT USED                                 *
  6576*                                                                *
  6577*   LOG = YES                                                    *
  6578*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6579******************************************************************
  6580*                   C H A N G E   L O G
  6581*
  6582* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6583*-----------------------------------------------------------------
  6584*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6585* EFFECTIVE    NUMBER
  6586*-----------------------------------------------------------------
  6587* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6588* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6589* 111108                   PEMA  ADD CRED BENE ADDR2
  6590******************************************************************
  6591
  6592 01  MAILING-DATA.
  6593     12  MA-RECORD-ID                      PIC XX.
  6594         88  VALID-MA-ID                       VALUE 'MA'.
  6595
  6596     12  MA-CONTROL-PRIMARY.
  6597         16  MA-COMPANY-CD                 PIC X.
  6598         16  MA-CARRIER                    PIC X.
  6599         16  MA-GROUPING.
  6600             20  MA-GROUPING-PREFIX        PIC XXX.
  6601             20  MA-GROUPING-PRIME         PIC XXX.
  6602         16  MA-STATE                      PIC XX.
  6603         16  MA-ACCOUNT.
  6604             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6605             20  MA-ACCOUNT-PRIME          PIC X(6).
  6606         16  MA-CERT-EFF-DT                PIC XX.
  6607         16  MA-CERT-NO.
  6608             20  MA-CERT-PRIME             PIC X(10).
  6609             20  MA-CERT-SFX               PIC X.
  6610
  6611     12  FILLER                            PIC XX.
  6612
  6613     12  MA-ACCESS-CONTROL.
  6614         16  MA-SOURCE-SYSTEM              PIC XX.
  6615             88  MA-FROM-CREDIT                VALUE 'CR'.
  6616             88  MA-FROM-VSI                   VALUE 'VS'.
  6617             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6618             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 126
* EL130.cbl
  6619         16  MA-RECORD-ADD-DT              PIC XX.
  6620         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6621         16  MA-LAST-MAINT-DT              PIC XX.
  6622         16  MA-LAST-MAINT-BY              PIC XXXX.
  6623         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6624
  6625     12  MA-PROFILE-INFO.
  6626         16  MA-QUALIFY-CODE-1             PIC XX.
  6627         16  MA-QUALIFY-CODE-2             PIC XX.
  6628         16  MA-QUALIFY-CODE-3             PIC XX.
  6629         16  MA-QUALIFY-CODE-4             PIC XX.
  6630         16  MA-QUALIFY-CODE-5             PIC XX.
  6631
  6632         16  MA-INSURED-LAST-NAME          PIC X(15).
  6633         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6634         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6635         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6636         16  MA-INSURED-BIRTH-DT           PIC XX.
  6637         16  MA-INSURED-SEX                PIC X.
  6638             88  MA-SEX-MALE                   VALUE 'M'.
  6639             88  MA-SEX-FEMALE                 VALUE 'F'.
  6640         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6641
  6642         16  MA-ADDRESS-CORRECTED          PIC X.
  6643         16  MA-JOINT-BIRTH-DT             PIC XX.
  6644*        16  FILLER                        PIC X(12).
  6645
  6646         16  MA-ADDRESS-LINE-1             PIC X(30).
  6647         16  MA-ADDRESS-LINE-2             PIC X(30).
  6648         16  MA-CITY-STATE.
  6649             20  MA-CITY                   PIC X(28).
  6650             20  MA-ADDR-STATE             PIC XX.
  6651         16  MA-ZIP.
  6652             20  MA-ZIP-CODE.
  6653                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6654                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6655                 24  FILLER                PIC X(4).
  6656             20  MA-ZIP-PLUS4              PIC X(4).
  6657         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6658             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6659             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6660             20  FILLER                    PIC X(3).
  6661
  6662         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6663
  6664         16  FILLER                        PIC XXX.
  6665*        16  FILLER                        PIC X(10).
  6666
  6667     12  MA-CRED-BENE-INFO.
  6668         16  MA-CRED-BENE-NAME                 PIC X(25).
  6669         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6670         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6671         16  MA-CRED-BENE-CTYST.
  6672             20  MA-CRED-BENE-CITY             PIC X(28).
  6673             20  MA-CRED-BENE-STATE            PIC XX.
  6674         16  MA-CRED-BENE-ZIP.
  6675             20  MA-CB-ZIP-CODE.
  6676                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 127
* EL130.cbl
  6677                     88  MA-CB-CANADIAN-POST-CODE
  6678                                           VALUE 'A' THRU 'Z'.
  6679                 24  FILLER                    PIC X(4).
  6680             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6681         16  MA-CB-CANADIAN-POSTAL-CODE
  6682                            REDEFINES MA-CRED-BENE-ZIP.
  6683             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6684             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6685             20  FILLER                        PIC X(3).
  6686     12  MA-POST-CARD-MAIL-DATA.
  6687         16  MA-MAIL-DATA OCCURS 7.
  6688             20  MA-MAIL-TYPE              PIC X.
  6689                 88  MA-12MO-MAILING           VALUE '1'.
  6690                 88  MA-EXP-MAILING            VALUE '2'.
  6691             20  MA-MAIL-STATUS            PIC X.
  6692                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6693                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6694                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6695             20  MA-MAIL-DATE              PIC XX.
  6696     12  FILLER                            PIC XX.
  6697     12  FILLER                            PIC XX.
  6698*    12  FILLER                            PIC X(30).
  6699******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 128
* EL130.cbl
  6701*    COPY ELCCRTT.
  6702******************************************************************
  6703*                                                                *
  6704*                            ELCCRTT.                            *
  6705*                                                                *
  6706*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  6707*                                                                *
  6708*   FILE TYPE = VSAM,KSDS                                        *
  6709*   RECORD SIZE = 552  RECFORM = FIXED                           *
  6710*                                                                *
  6711*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  6712*                                                                *
  6713*   LOG = YES                                                    *
  6714*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6715******************************************************************
  6716*                   C H A N G E   L O G
  6717*
  6718* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6719*-----------------------------------------------------------------
  6720*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6721* EFFECTIVE    NUMBER
  6722*-----------------------------------------------------------------
  6723* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  6724* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  6725* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  6726******************************************************************
  6727
  6728 01  CERTIFICATE-TRAILERS.
  6729     12  CS-RECORD-ID                      PIC XX.
  6730         88  VALID-CS-ID                      VALUE 'CS'.
  6731
  6732     12  CS-CONTROL-PRIMARY.
  6733         16  CS-COMPANY-CD                 PIC X.
  6734         16  CS-CARRIER                    PIC X.
  6735         16  CS-GROUPING                   PIC X(6).
  6736         16  CS-STATE                      PIC XX.
  6737         16  CS-ACCOUNT                    PIC X(10).
  6738         16  CS-CERT-EFF-DT                PIC XX.
  6739         16  CS-CERT-NO.
  6740             20  CS-CERT-PRIME             PIC X(10).
  6741             20  CS-CERT-SFX               PIC X.
  6742         16  CS-TRAILER-TYPE               PIC X.
  6743             88  COMM-TRLR           VALUE 'A'.
  6744             88  FUTURE-TRLR         VALUE 'B'.
  6745             88  CERT-DATA-TRLR      VALUE 'C'.
  6746
  6747     12  CS-DATA-AREA                      PIC X(516).
  6748
  6749     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  6750         16  CS-BANK-COMMISSION-AREA.
  6751             20  CS-BANK-COMMS       OCCURS 10.
  6752                 24  CS-AGT                PIC X(10).
  6753                 24  CS-COM-TYP            PIC X.
  6754                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  6755                 24  CS-RECALC-LV-INDIC    PIC X.
  6756                 24  FILLER                PIC X(10).
  6757         16  FILLER                        PIC X(256).
  6758
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 129
* EL130.cbl
  6759     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  6760         16  CS-VIN-NUMBER                 PIC X(17).
  6761         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  6762         16  FILLER                        PIC X(498).
  6763******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 130
* EL130.cbl
  6765
  6766 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  6767                          CONTROL-FILE CERTIFICATE-MASTER
  6768                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  6769                          BENEFICIARY-MASTER
  6770                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  6771                          LETTER-ARCHIVE REINSURANCE-RECORD
  6772                          MAILING-DATA CERTIFICATE-TRAILERS.
  6773 0000-DFHEXIT SECTION.
  6774     MOVE '9#                    $   ' TO DFHEIV0.
  6775     MOVE 'EL130' TO DFHEIV1.
  6776     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  6777     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6778     MOVE '5'                    TO DC-OPTION-CODE.
  6779     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  6780     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  6781     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  6782
  6783     IF EIBCALEN = ZERO
  6784         GO TO 8800-UNAUTHORIZED-ACCESS
  6785     END-IF.
  6786
  6787     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  6788     MOVE EIBTRMID               TO QID-TERM.
  6789     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  6790     MOVE '2'                    TO EMI-SWITCH2.
  6791     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  6792     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  6793
  6794
  6795
  6796* EXEC CICS HANDLE CONDITION
  6797*        QIDERR     (0100-TEST-ENTRY)
  6798*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  6799*        PGMIDERR   (9600-PGMID-ERROR)
  6800*        TERMIDERR  (8820-TERM-ERROR)
  6801*        TRANSIDERR (8830-TRAN-ERROR)
  6802*        ERROR      (9990-ABEND)
  6803*    END-EXEC.
  6804*    MOVE '"$N?L[\.              ! " #00006791' TO DFHEIV0
  6805     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  6806     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6807     MOVE X'2220233030303036373931' TO DFHEIV0(25:11)
  6808     CALL 'kxdfhei1' USING DFHEIV0
  6809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6810
  6811
  6812     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  6813        PI-CALLING-PROGRAM   = XCTL-6592
  6814         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  6815     ELSE
  6816         MOVE SPACES             TO RETURNED-FROM
  6817     END-IF.
  6818
  6819     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  6820         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  6821             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  6822             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 131
* EL130.cbl
  6823             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  6824             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  6825             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  6826             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  6827             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  6828             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  6829         ELSE
  6830             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  6831             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  6832             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  6833             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  6834             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  6835             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  6836             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  6837             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  6838         END-IF
  6839     END-IF.
  6840
  6841     IF EIBTRNID = TRANS-ID
  6842         IF EIBAID = DFHCLEAR
  6843             GO TO 9400-CLEAR
  6844         ELSE
  6845             GO TO 0200-RECEIVE
  6846         END-IF
  6847     END-IF.
  6848
  6849     IF RETURNED-FROM NOT = SPACES
  6850         GO TO 0600-RECOVER-TEMP-STORAGE
  6851     END-IF.
  6852
  6853     MOVE LOW-VALUES TO EL130AO.
  6854
  6855
  6856
  6857* EXEC CICS DELETEQ TS
  6858*         QUEUE   (QID)
  6859*    END-EXEC.
  6860*    MOVE '*&                    #   #00006844' TO DFHEIV0
  6861     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  6862     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6863     MOVE X'2020233030303036383434' TO DFHEIV0(25:11)
  6864     CALL 'kxdfhei1' USING DFHEIV0,
  6865           QID,
  6866           DFHEIV99
  6867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6868
  6869
  6870 0100-TEST-ENTRY.
  6871     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  6872         GO TO 0650-FROM-EL127
  6873     ELSE
  6874         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  6875                                    PI-CERT-PROCESSED
  6876                                    PI-LETTER-ERROR-CODE
  6877     END-IF.
  6878
  6879     IF PI-RETURN-TO-PROGRAM = XCTL-132
  6880         GO TO 0640-FROM-EL132
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 132
* EL130.cbl
  6881     END-IF.
  6882
  6883     GO TO 8100-SEND-INITIAL-MAP.
  6884
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 133
* EL130.cbl
  6886 0200-RECEIVE.
  6887     MOVE LOW-VALUES             TO EL130AI.
  6888
  6889     IF PI-PROCESSOR-ID = 'LGXX'
  6890*        NEXT SENTENCE
  6891         CONTINUE
  6892     ELSE
  6893
  6894* EXEC CICS READQ TS
  6895*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  6896*            INTO    (SECURITY-CONTROL)
  6897*            LENGTH  (SC-COMM-LENGTH)
  6898*            ITEM    (SC-ITEM)
  6899*        END-EXEC
  6900*    MOVE '*$II   L              ''   #00006871' TO DFHEIV0
  6901     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  6902     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6903     MOVE X'2020233030303036383731' TO DFHEIV0(25:11)
  6904     CALL 'kxdfhei1' USING DFHEIV0,
  6905           PI-SECURITY-TEMP-STORE-ID,
  6906           SECURITY-CONTROL,
  6907           SC-COMM-LENGTH,
  6908           SC-ITEM,
  6909           DFHEIV99,
  6910           DFHEIV99
  6911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6912         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  6913         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  6914         IF NOT DISPLAY-CAP
  6915             MOVE 'READ'              TO  SM-READ
  6916             PERFORM 9995-SECURITY-VIOLATION
  6917             MOVE ER-0070             TO  EMI-ERROR
  6918             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6919             GO TO 8100-SEND-INITIAL-MAP
  6920         END-IF
  6921     END-IF.
  6922
  6923     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6924         MOVE ER-7008 TO EMI-ERROR
  6925         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6926         MOVE -1 TO MAINTL
  6927         GO TO 8200-SEND-DATAONLY
  6928     END-IF.
  6929
  6930
  6931
  6932* EXEC CICS RECEIVE
  6933*         MAP     (MAP-NAME)
  6934*         MAPSET  (MAPSET-NAME)
  6935*         INTO    (EL130AI)
  6936*    END-EXEC.
  6937     MOVE LENGTH OF
  6938      EL130AI
  6939       TO DFHEIV11
  6940*    MOVE '8"T I  L              ''   #00006896' TO DFHEIV0
  6941     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6942     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6943     MOVE X'2020233030303036383936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 134
* EL130.cbl
  6944     CALL 'kxdfhei1' USING DFHEIV0,
  6945           MAP-NAME,
  6946           EL130AI,
  6947           DFHEIV11,
  6948           MAPSET-NAME,
  6949           DFHEIV99,
  6950           DFHEIV99
  6951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6952
  6953
  6954     IF NOT PI-NO-CARRIER-SECURITY
  6955        MOVE +1                  TO CLMCARRL
  6956        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  6957     END-IF.
  6958
  6959     IF ENTERPFL = ZERO
  6960         GO TO 0300-CHECK-PFKEYS
  6961     END-IF.
  6962
  6963     IF EIBAID NOT = DFHENTER
  6964         MOVE ER-0004            TO EMI-ERROR
  6965         GO TO 0320-INPUT-ERROR
  6966     END-IF.
  6967
  6968     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  6969         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  6970     ELSE
  6971         MOVE ER-0029            TO EMI-ERROR
  6972         GO TO 0320-INPUT-ERROR
  6973     END-IF.
  6974
  6975 0300-CHECK-PFKEYS.
  6976     IF EIBAID = DFHPF23
  6977         GO TO 8810-PF23
  6978     END-IF.
  6979
  6980     IF EIBAID = DFHPF24
  6981         GO TO 9200-RETURN-MAIN-MENU
  6982     END-IF.
  6983
  6984     IF EIBAID = DFHPF12
  6985         GO TO 9500-PF12
  6986     END-IF.
  6987
  6988     IF EIBAID = DFHPF3
  6989         MOVE SPACES              TO MAINTI
  6990         MOVE ZEROS               TO MAINTL
  6991         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  6992         MOVE XCTL-127            TO PGM-NAME
  6993         GO TO 9300-XCTL
  6994     END-IF.
  6995
  6996     IF EIBAID = DFHPF4
  6997         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  6998         MOVE XCTL-132            TO PGM-NAME
  6999         GO TO 9300-XCTL
  7000     END-IF.
  7001
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 135
* EL130.cbl
  7002     IF EIBAID = DFHPF13
  7003         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7004             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7005             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7006             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7007             MOVE PI-STATE            TO  PI-CR-STATE
  7008             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7009             MOVE XCTL-650            TO  PGM-NAME
  7010             GO TO 9300-XCTL
  7011         ELSE
  7012             MOVE -1                  TO  ENTERPFL
  7013             MOVE ER-2566             TO  EMI-ERROR
  7014             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7015             GO TO 8100-SEND-INITIAL-MAP
  7016         END-IF
  7017     END-IF.
  7018
  7019     IF EIBAID = DFHPF5
  7020         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7021             ADD +1 TO PI-CERT-PROCESSED
  7022             GO TO 0650-FROM-EL127
  7023         ELSE
  7024             MOVE ER-7686         TO EMI-ERROR
  7025             GO TO 0320-INPUT-ERROR
  7026         END-IF
  7027     END-IF.
  7028
  7029     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7030         GO TO 0800-TEST-PREVIOUS-CONTROL
  7031     END-IF.
  7032
  7033     IF PI-HAS-CLAS-IC-CRDTCRD
  7034         IF EIBAID = DFHPF10
  7035             MOVE XCTL-725          TO PGM-NAME
  7036             GO TO 9300-XCTL
  7037         END-IF
  7038     END-IF.
  7039
  7040     IF EIBAID = DFHPF14
  7041         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7042         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7043         MOVE XCTL-659            TO PGM-NAME
  7044         GO TO 9300-XCTL
  7045     END-IF.
  7046
  7047     IF EIBAID = DFHPF15
  7048         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7049         MOVE XCTL-114            TO PGM-NAME
  7050         GO TO 9300-XCTL
  7051     END-IF.
  7052
  7053     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7054         GO TO 0330-EDIT-DATA
  7055     END-IF.
  7056
  7057     MOVE ER-0029                TO EMI-ERROR.
  7058
  7059 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 136
* EL130.cbl
  7060     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7061
  7062     MOVE AL-UNBON               TO ENTERPFA.
  7063
  7064     IF ENTERPFL = ZERO
  7065         MOVE -1                 TO MAINTL
  7066     ELSE
  7067         MOVE -1                 TO ENTERPFL
  7068     END-IF.
  7069
  7070     GO TO 8200-SEND-DATAONLY.
  7071
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 137
* EL130.cbl
  7073 0330-EDIT-DATA.
  7074
  7075     IF MAINTI = 'S'
  7076         IF PRTOPTL GREATER THAN 0
  7077             IF PRTOPTI NOT = 'N' AND 'L'
  7078                 MOVE AL-UABON   TO  PRTOPTA
  7079                 MOVE -1         TO  PRTOPTL
  7080                 MOVE ER-0334    TO  EMI-ERROR
  7081                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7082                 GO TO 8200-SEND-DATAONLY
  7083             ELSE
  7084                 IF PRTOPTI = 'L'
  7085                     GO TO 0400-CREATE-ELACTQ
  7086                 ELSE
  7087                     GO TO 0480-PRINT-NOW
  7088                 END-IF
  7089             END-IF
  7090         ELSE
  7091             GO TO 1000-SHOW-CLAIM
  7092         END-IF
  7093     END-IF.
  7094
  7095     IF NOT MODIFY-CAP
  7096         MOVE 'UPDATE'       TO  SM-READ
  7097         PERFORM 9995-SECURITY-VIOLATION
  7098         MOVE ER-0070        TO  EMI-ERROR
  7099         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7100         GO TO 8100-SEND-INITIAL-MAP
  7101     END-IF.
  7102
  7103     IF MAINTI = 'D'
  7104         GO TO 2000-DELETE-CLAIM
  7105     END-IF.
  7106
  7107     IF MAINTI = 'A'
  7108         GO TO 3000-ADD-CLAIM
  7109     END-IF.
  7110
  7111     IF MAINTI = 'I'
  7112         GO TO 5000-INCURRED-CHANGE
  7113     END-IF.
  7114
  7115     MOVE ER-0023                TO EMI-ERROR.
  7116     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7117     MOVE -1                     TO MAINTL.
  7118     MOVE AL-UABON               TO MAINTA.
  7119
  7120     GO TO 8200-SEND-DATAONLY.
  7121
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 138
* EL130.cbl
  7123 0400-CREATE-ELACTQ.
  7124     IF CLMNOI   = PI-LAST-CLAIM      AND
  7125        CLMCARRI = PI-LAST-CARR       AND
  7126        CERTNOI  = PI-LAST-CERT-PRIME AND
  7127        SUFXI    = PI-LAST-CERT-SUFX
  7128         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7129         MOVE PI-LAST-CARR       TO PI-CARRIER
  7130         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7131     ELSE
  7132         MOVE ER-0207            TO EMI-ERROR
  7133         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7134         MOVE -1                 TO MAINTL
  7135         GO TO 8200-SEND-DATAONLY
  7136     END-IF.
  7137
  7138     IF (NOT PI-NO-CARRIER-SECURITY OR
  7139         NOT PI-NO-ACCOUNT-SECURITY)
  7140         MOVE AL-UABON      TO  PRTOPTA
  7141         MOVE -1            TO  PRTOPTL
  7142         MOVE ER-2378       TO  EMI-ERROR
  7143         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7144         GO TO 8200-SEND-DATAONLY
  7145     END-IF.
  7146
  7147     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7148     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7149     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7150     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7151
  7152
  7153
  7154* EXEC CICS HANDLE CONDITION
  7155*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7156*    END-EXEC.
  7157*    MOVE '"$I                   ! # #00007101' TO DFHEIV0
  7158     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7160     MOVE X'2320233030303037313031' TO DFHEIV0(25:11)
  7161     CALL 'kxdfhei1' USING DFHEIV0
  7162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7163
  7164
  7165
  7166
  7167* EXEC CICS READ
  7168*         UPDATE
  7169*         DATASET    (ELACTQ-DSID)
  7170*         SET        (ADDRESS OF ACTIVITY-QUE)
  7171*         RIDFLD     (ELACTQ-KEY)
  7172*    END-EXEC.
  7173*    MOVE '&"S        EU         (   #00007106' TO DFHEIV0
  7174     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7175     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7176     MOVE X'2020233030303037313036' TO DFHEIV0(25:11)
  7177     CALL 'kxdfhei1' USING DFHEIV0,
  7178           ELACTQ-DSID,
  7179           DFHEIV20,
  7180           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 139
* EL130.cbl
  7181           ELACTQ-KEY,
  7182           DFHEIV99,
  7183           DFHEIV99,
  7184           DFHEIV99
  7185     SET ADDRESS OF ACTIVITY-QUE TO
  7186         DFHEIV20
  7187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7188
  7189
  7190     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7191     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7192
  7193
  7194
  7195* EXEC CICS REWRITE
  7196*         DATASET     (ELACTQ-DSID)
  7197*         FROM        (ACTIVITY-QUE)
  7198*    END-EXEC.
  7199     MOVE LENGTH OF
  7200      ACTIVITY-QUE
  7201       TO DFHEIV11
  7202*    MOVE '&& L                  %   #00007117' TO DFHEIV0
  7203     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7204     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7205     MOVE X'2020233030303037313137' TO DFHEIV0(25:11)
  7206     CALL 'kxdfhei1' USING DFHEIV0,
  7207           ELACTQ-DSID,
  7208           ACTIVITY-QUE,
  7209           DFHEIV11,
  7210           DFHEIV99
  7211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7212
  7213
  7214     GO TO 0470-STATUS-FINISH.
  7215
  7216 0450-ADD-ELACTQ-RECORD.
  7217
  7218
  7219* EXEC CICS GETMAIN
  7220*        SET     (ADDRESS OF ACTIVITY-QUE)
  7221*        LENGTH  (ELACTQ-LENGTH)
  7222*        INITIMG (GETMAIN-SPACE)
  7223*    END-EXEC.
  7224*    MOVE ',"IL                  $   #00007126' TO DFHEIV0
  7225     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7226     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7227     MOVE X'2020233030303037313236' TO DFHEIV0(25:11)
  7228     CALL 'kxdfhei1' USING DFHEIV0,
  7229           DFHEIV20,
  7230           ELACTQ-LENGTH,
  7231           GETMAIN-SPACE
  7232     SET ADDRESS OF ACTIVITY-QUE TO
  7233         DFHEIV20
  7234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7235
  7236
  7237     MOVE 'AQ'              TO AQ-RECORD-ID.
  7238     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 140
* EL130.cbl
  7239     MOVE +0                TO AQ-PAYMENT-COUNTER
  7240                               AQ-PMT-UNAPPROVED-COUNT.
  7241     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7242                               AQ-FOLLOWUP-DATE.
  7243     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7244     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7245
  7246
  7247
  7248* EXEC CICS WRITE
  7249*         DATASET     (ELACTQ-DSID)
  7250*         FROM        (ACTIVITY-QUE)
  7251*         RIDFLD      (ELACTQ-KEY)
  7252*    END-EXEC.
  7253     MOVE LENGTH OF
  7254      ACTIVITY-QUE
  7255       TO DFHEIV11
  7256*    MOVE '&$ L                  ''   #00007142' TO DFHEIV0
  7257     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7258     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7259     MOVE X'2020233030303037313432' TO DFHEIV0(25:11)
  7260     CALL 'kxdfhei1' USING DFHEIV0,
  7261           ELACTQ-DSID,
  7262           ACTIVITY-QUE,
  7263           DFHEIV11,
  7264           ELACTQ-KEY,
  7265           DFHEIV99,
  7266           DFHEIV99
  7267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7268
  7269
  7270 0470-STATUS-FINISH.
  7271     MOVE AL-UANOF               TO  PRTOPTA
  7272                                     ALTPRTA.
  7273
  7274     MOVE SPACES                 TO  PRTOPTO
  7275                                     ALTPRTO.
  7276
  7277     MOVE ER-0000                TO EMI-ERROR.
  7278     MOVE -1                     TO MAINTL.
  7279     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7280     GO TO 8100-SEND-INITIAL-MAP.
  7281
  7282 0480-PRINT-NOW.
  7283
  7284
  7285* EXEC CICS HANDLE CONDITION
  7286*        TERMIDERR   (8820-TERM-ERROR)
  7287*        TRANSIDERR  (8830-TRAN-ERROR)
  7288*    END-EXEC.
  7289*    MOVE '"$[\                  ! $ #00007162' TO DFHEIV0
  7290     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7291     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7292     MOVE X'2420233030303037313632' TO DFHEIV0(25:11)
  7293     CALL 'kxdfhei1' USING DFHEIV0
  7294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7295
  7296
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 141
* EL130.cbl
  7297     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7298     MOVE '1'                    TO  CNTL-REC-TYPE.
  7299     MOVE SPACES                 TO  CNTL-ACCESS.
  7300     MOVE +0                     TO  CNTL-SEQ-NO.
  7301     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7302
  7303     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7304
  7305     IF CF-FORMS-PRINTER-ID = SPACES
  7306         IF ALTPRTL NOT GREATER THAN 0
  7307             MOVE ER-0337        TO  EMI-ERROR
  7308             MOVE -1             TO  ALTPRTL
  7309             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7310             GO TO 8200-SEND-DATAONLY
  7311         END-IF
  7312     END-IF.
  7313
  7314     IF ALTPRTL GREATER THAN 0
  7315         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7316     END-IF.
  7317
  7318     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7319     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7320     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7321
  7322
  7323
  7324* EXEC CICS START
  7325*        TRANSID   (START-TRANS-ID)
  7326*        TERMID    (CF-FORMS-PRINTER-ID)
  7327*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7328*        LENGTH    (PI-COMM-LENGTH)
  7329*    END-EXEC.
  7330*    MOVE '0( LFT                0   #00007193' TO DFHEIV0
  7331     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7332     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  7333     MOVE X'2020233030303037313933' TO DFHEIV0(25:11)
  7334     CALL 'kxdfhei1' USING DFHEIV0,
  7335           DFHEIV99,
  7336           START-TRANS-ID,
  7337           DFHEIV99,
  7338           PROGRAM-INTERFACE-BLOCK,
  7339           PI-COMM-LENGTH,
  7340           CF-FORMS-PRINTER-ID,
  7341           DFHEIV99,
  7342           DFHEIV99,
  7343           DFHEIV99,
  7344           DFHEIV99,
  7345           DFHEIV99,
  7346           DFHEIV99,
  7347           DFHEIV99,
  7348           DFHEIV99,
  7349           DFHEIV99
  7350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7351
  7352
  7353     MOVE AL-UANOF               TO  PRTOPTA
  7354                                     ALTPRTA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 142
* EL130.cbl
  7355
  7356     MOVE SPACES                 TO  PRTOPTO
  7357                                     ALTPRTO.
  7358
  7359     MOVE ER-0000                TO  EMI-ERROR.
  7360     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7361     MOVE -1                     TO  MAINTL.
  7362     GO TO 8100-SEND-INITIAL-MAP.
  7363
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 143
* EL130.cbl
  7365 0500-CREATE-TEMP-STORAGE.
  7366     MOVE EIBCPOSN               TO PI-CURSOR.
  7367
  7368
  7369
  7370* EXEC CICS WRITEQ TS
  7371*        QUEUE   (QID)
  7372*        FROM    (EL130AI)
  7373*        LENGTH  (QID-MAP-LENGTH)
  7374*    END-EXEC.
  7375*    MOVE '*"                    ''   #00007216' TO DFHEIV0
  7376     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7378     MOVE X'2020233030303037323136' TO DFHEIV0(25:11)
  7379     CALL 'kxdfhei1' USING DFHEIV0,
  7380           QID,
  7381           EL130AI,
  7382           QID-MAP-LENGTH,
  7383           DFHEIV99,
  7384           DFHEIV99,
  7385           DFHEIV99
  7386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7387
  7388
  7389
  7390
  7391* EXEC CICS WRITEQ TS
  7392*        QUEUE    (QID)
  7393*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7394*        LENGTH   (PI-COMM-LENGTH)
  7395*    END-EXEC.
  7396*    MOVE '*"                    ''   #00007223' TO DFHEIV0
  7397     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  7398     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7399     MOVE X'2020233030303037323233' TO DFHEIV0(25:11)
  7400     CALL 'kxdfhei1' USING DFHEIV0,
  7401           QID,
  7402           PROGRAM-INTERFACE-BLOCK,
  7403           PI-COMM-LENGTH,
  7404           DFHEIV99,
  7405           DFHEIV99,
  7406           DFHEIV99
  7407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7408
  7409
  7410 0599-EXIT.
  7411      EXIT.
  7412
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 144
* EL130.cbl
  7414 0600-RECOVER-TEMP-STORAGE.
  7415     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7416     MOVE PI-EL127-TO-EL130-CNTRL
  7417                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7418     MOVE PI-EL659-TO-EL130-CNTRL
  7419                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7420     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7421     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7422     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7423     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7424     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7425     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7426     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7427     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7428     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7429     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7430     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7431     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7432     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7433     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7434     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7435     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7436                                 TO SAVE-BENEFICIARY
  7437
  7438
  7439
  7440* EXEC CICS HANDLE CONDITION
  7441*        NOTFND  (0660-NOT-FOUND)
  7442*        QIDERR  (0670-QIDERR)
  7443*    END-EXEC.
  7444*    MOVE '"$IN                  ! % #00007258' TO DFHEIV0
  7445     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7447     MOVE X'2520233030303037323538' TO DFHEIV0(25:11)
  7448     CALL 'kxdfhei1' USING DFHEIV0
  7449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7450
  7451
  7452
  7453
  7454* EXEC CICS READQ TS
  7455*        QUEUE    (QID)
  7456*        INTO     (EL130AI)
  7457*        LENGTH   (QID-MAP-LENGTH)
  7458*    END-EXEC.
  7459*    MOVE '*$I    L              ''   #00007264' TO DFHEIV0
  7460     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7461     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7462     MOVE X'2020233030303037323634' TO DFHEIV0(25:11)
  7463     CALL 'kxdfhei1' USING DFHEIV0,
  7464           QID,
  7465           EL130AI,
  7466           QID-MAP-LENGTH,
  7467           DFHEIV99,
  7468           DFHEIV99,
  7469           DFHEIV99
  7470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7471
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 145
* EL130.cbl
  7472
  7473     IF RETURNED-FROM = XCTL-131
  7474        IF CLAIM-DELETED-BY-EL131
  7475            MOVE LOW-VALUES      TO CERTNOI
  7476                                    SUFXI
  7477            MOVE ZEROS           TO CERTNOL
  7478                                    SUFXL
  7479         END-IF
  7480     END-IF.
  7481
  7482     IF RETURNED-FROM = XCTL-131
  7483         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7484         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7485                                    PI-CERT-PROCESSED
  7486     ELSE
  7487
  7488
  7489* EXEC CICS READQ TS
  7490*             QUEUE   (QID)
  7491*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7492*             LENGTH  (PI-COMM-LENGTH)
  7493*        END-EXEC
  7494*    MOVE '*$I    L              ''   #00007285' TO DFHEIV0
  7495     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7496     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7497     MOVE X'2020233030303037323835' TO DFHEIV0(25:11)
  7498     CALL 'kxdfhei1' USING DFHEIV0,
  7499           QID,
  7500           PROGRAM-INTERFACE-BLOCK,
  7501           PI-COMM-LENGTH,
  7502           DFHEIV99,
  7503           DFHEIV99,
  7504           DFHEIV99
  7505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7506     END-IF.
  7507
  7508
  7509* EXEC CICS DELETEQ TS
  7510*        QUEUE   (QID)
  7511*    END-EXEC.
  7512*    MOVE '*&                    #   #00007292' TO DFHEIV0
  7513     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7514     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7515     MOVE X'2020233030303037323932' TO DFHEIV0(25:11)
  7516     CALL 'kxdfhei1' USING DFHEIV0,
  7517           QID,
  7518           DFHEIV99
  7519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7520
  7521
  7522     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7523
  7524     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7525         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7526         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7527         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7528         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7529         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 146
* EL130.cbl
  7530         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7531         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7532         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7533         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7534         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7535         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7536         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7537         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7538         MOVE SAVE-CERT-ACCESS-CONTROL
  7539                                    TO PI-CERT-ACCESS-CONTROL
  7540         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7541                                    TO PI-CARRIER-CONTROL-LEVEL
  7542     END-IF.
  7543
  7544     IF RETURNED-FROM = XCTL-127
  7545         MOVE SAVE-EL127-TO-EL130-CNTRL
  7546                                 TO PI-EL127-TO-EL130-CNTRL
  7547     END-IF.
  7548
  7549     IF RETURNED-FROM = XCTL-6592
  7550        MOVE SAVE-EL659-TO-EL130-CNTRL
  7551                                 TO PI-EL659-TO-EL130-CNTRL
  7552     END-IF.
  7553
  7554     IF RETURNED-FROM = XCTL-114
  7555        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7556           MOVE SAVE-BENEFICIARY TO BENECDI
  7557           MOVE +10              TO BENECDL
  7558           MOVE -1               TO BIRTHDTL
  7559        END-IF
  7560     END-IF.
  7561     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7562
  7563     IF MAINTL NOT = ZERO
  7564         MOVE AL-UANON           TO MAINTA
  7565     END-IF.
  7566
  7567     IF ENTERPFL NOT = ZERO
  7568         MOVE AL-UNNON           TO ENTERPFA
  7569     END-IF.
  7570
  7571     IF RETURNED-FROM = XCTL-127
  7572         GO TO 0650-FROM-EL127
  7573     END-IF.
  7574
  7575     IF RETURNED-FROM = XCTL-132
  7576         GO TO 0640-FROM-EL132
  7577     END-IF.
  7578
  7579     IF RETURNED-FROM = XCTL-650
  7580         MOVE AL-SABON           TO PF5A
  7581         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
  7582     END-IF.
  7583
  7584     IF RETURNED-FROM = XCTL-6592
  7585         GO TO 0630-FROM-EL6592
  7586     END-IF.
  7587
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 147
* EL130.cbl
  7588     IF MAINTI = 'S' OR 'I'
  7589        GO TO 1000-SHOW-CLAIM
  7590     END-IF.
  7591
  7592     GO TO 8100-SEND-INITIAL-MAP.
  7593
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 148
* EL130.cbl
  7595 0630-FROM-EL6592.
  7596     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  7597     MOVE PI-EL659-GROUPING      TO GROUPO.
  7598     MOVE PI-EL659-STATE         TO STATEO.
  7599     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  7600
  7601     MOVE AL-UANON               TO CRTCARRA
  7602                                    GROUPA
  7603                                    STATEA
  7604                                    ACCOUNTA.
  7605     GO TO 8100-SEND-INITIAL-MAP.
  7606
  7607 0640-FROM-EL132.
  7608     IF PI-CLAIM-NO = SPACES
  7609         GO TO 0645-NO-CLAIM-SELECTED
  7610     END-IF.
  7611
  7612     MOVE LOW-VALUES             TO EL130AI.
  7613     MOVE 'MSTR'                 TO FILE-SWITCH.
  7614     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  7615     MOVE PI-CARRIER             TO MSTR-CARRIER.
  7616     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  7617                                    CLMNOO.
  7618     MOVE AL-UANON               TO CLMNOA.
  7619     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  7620
  7621
  7622
  7623* EXEC CICS HANDLE CONDITION
  7624*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  7625*    END-EXEC.
  7626*    MOVE '"$I                   ! & #00007396' TO DFHEIV0
  7627     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7628     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7629     MOVE X'2620233030303037333936' TO DFHEIV0(25:11)
  7630     CALL 'kxdfhei1' USING DFHEIV0
  7631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7632
  7633
  7634     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  7635     MOVE 'X'                    TO CLAIM-SWITCH.
  7636     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  7637     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  7638     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  7639     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7640
  7641     MOVE ER-0213                TO EMI-ERROR.
  7642     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7643     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  7644     GO TO 8100-SEND-INITIAL-MAP.
  7645
  7646 0645-NO-CLAIM-SELECTED.
  7647
  7648     IF MAINTI = 'S' OR 'I'
  7649        GO TO 1000-SHOW-CLAIM
  7650     END-IF.
  7651
  7652     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 149
* EL130.cbl
  7653
  7654 0650-FROM-EL127.
  7655
  7656     IF PI-CERT-SELECT-CNT GREATER THAN +6
  7657         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7658                                    PI-CERT-PROCESSED
  7659     END-IF.
  7660
  7661     IF PI-RETURN-TO-PROGRAM = XCTL-727
  7662         MOVE +1                 TO PI-CERT-SELECT-CNT
  7663                                    PI-CERT-PROCESSED
  7664         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  7665         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  7666         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  7667         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  7668         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  7669         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  7670     END-IF.
  7671
  7672     IF PI-CERT-SELECT-CNT = ZERO
  7673         IF CERTNOI NOT = SPACES AND LOW-VALUES
  7674             MOVE CERTNOI        TO PI-CERT-NO
  7675             MOVE SUFXI          TO PI-CERT-SFX
  7676             GO TO 3000-READ-CERT
  7677         ELSE
  7678             GO TO 8100-SEND-INITIAL-MAP
  7679         END-IF
  7680     END-IF.
  7681
  7682     MOVE AL-SABON               TO PF5A.
  7683
  7684     IF PI-CERT-PROCESSED = 1
  7685         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  7686     END-IF.
  7687
  7688     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  7689     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  7690
  7691     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  7692     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  7693                                 TO CERT-CARRIER
  7694                                    PI-CARRIER.
  7695     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  7696                                 TO CERT-GROUPING
  7697                                    PI-GROUPING.
  7698     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  7699                                 TO CERT-STATE
  7700                                    PI-STATE.
  7701     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  7702                                 TO CERT-ACCOUNT
  7703                                    PI-ACCOUNT.
  7704     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  7705                                 TO CERT-EFF-DT
  7706                                    PI-CERT-EFF-DT.
  7707     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  7708                                 TO CERT-CERT-NO
  7709                                    PI-CERT-NO.
  7710
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 150
* EL130.cbl
  7711     MOVE 'CERT'                 TO FILE-SWITCH.
  7712     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  7713
  7714     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  7715     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  7716     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  7717
  7718     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  7719         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  7720         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  7721         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  7722         IF INCURRED-DATE-MATCH
  7723             MOVE ER-7352        TO EMI-ERROR
  7724             MOVE -1             TO CERTNOL
  7725             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7726         ELSE
  7727             IF NO-CLAIMS-FOR-CERT
  7728                 MOVE ER-7353    TO EMI-ERROR
  7729                 MOVE -1         TO CERTNOL
  7730                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7731             ELSE
  7732                 MOVE ER-0558    TO EMI-ERROR
  7733                 MOVE -1         TO CERTNOL
  7734                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7735             END-IF
  7736         END-IF
  7737     END-IF.
  7738
  7739     MOVE SPACES                 TO PI-PRT-OPT
  7740                                    PI-ALT-PRT.
  7741
  7742     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  7743
  7744     IF LSTNMEL NOT GREATER ZERO
  7745        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  7746         MOVE CRTLNMEI           TO  LSTNMEO
  7747         MOVE CRTFNMEI           TO  FSTNMEO
  7748         MOVE CRTINITI           TO  INITO
  7749         MOVE AL-UANON           TO  LSTNMEA
  7750                                     FSTNMEA
  7751                                     INITA
  7752     END-IF.
  7753
  7754     IF SSNL GREATER ZERO
  7755         GO TO 0655-SKIP-SOCIAL-SECURITY
  7756     END-IF.
  7757
  7758     IF CRTSSNI = SPACES OR LOW-VALUES
  7759         GO TO 0655-SKIP-SOCIAL-SECURITY
  7760     END-IF.
  7761
  7762     IF CM-SSN-STATE   = CM-STATE AND
  7763        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  7764            GO TO 0655-SKIP-SOCIAL-SECURITY
  7765     END-IF.
  7766
  7767     MOVE CRTSSNI                TO SSNO
  7768     MOVE AL-UANON               TO SSNA.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 151
* EL130.cbl
  7769
  7770 0655-SKIP-SOCIAL-SECURITY.
  7771
  7772     IF CLMCARRL NOT = ZERO  AND
  7773        CLMCARRI NOT = CRTCARRI
  7774        MOVE ER-0562             TO EMI-ERROR
  7775        MOVE AL-UABON            TO CLMCARRA
  7776        MOVE -1                  TO CLMCARRL
  7777        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7778     END-IF.
  7779
  7780     IF CLMCARRL = ZERO
  7781        MOVE AL-UANON            TO CLMCARRA
  7782        MOVE CRTCARRI            TO CLMCARRI
  7783     END-IF.
  7784
  7785     MOVE 'A'                    TO MAINTO.
  7786     MOVE AL-UANON               TO MAINTA.
  7787
  7788     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7789        GO TO 8100-SEND-INITIAL-MAP
  7790     ELSE
  7791        GO TO 8150-SEND-MAP-CURSOR
  7792     END-IF.
  7793
  7794 0660-NOT-FOUND.
  7795     MOVE ER-0214                TO EMI-ERROR.
  7796     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7797     GO TO 8100-SEND-INITIAL-MAP.
  7798
  7799 0670-QIDERR.
  7800     MOVE ER-0033                TO EMI-ERROR.
  7801     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7802     GO TO 8100-SEND-INITIAL-MAP.
  7803
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 152
* EL130.cbl
  7805 0680-PLUG-SELECTED-CERTS.
  7806
  7807     MOVE AL-SANON               TO BCERT1A
  7808                                    BSUFX1A
  7809                                    BCERT2A
  7810                                    BSUFX2A
  7811                                    BCERT3A
  7812                                    BSUFX3A
  7813                                    BCERT4A
  7814                                    BSUFX4A
  7815                                    BCERT5A
  7816                                    BSUFX5A.
  7817
  7818     IF PCERTNOO = SPACES OR LOW-VALUES
  7819         MOVE PI-EL127-CERT-PRIME (1)
  7820                                 TO PCERTNOO
  7821         MOVE PI-EL127-CERT-SUFX  (1)
  7822                                 TO PSUFXO
  7823     END-IF.
  7824
  7825     MOVE PI-EL127-CERT-PRIME (1)
  7826                                 TO BCERT1O.
  7827     MOVE PI-EL127-CERT-SUFX  (1)
  7828                                 TO BSUFX1O.
  7829
  7830     IF PI-CERT-SELECT-CNT GREATER THAN 1
  7831         MOVE PI-EL127-CERT-PRIME (2)
  7832                                 TO BCERT2O
  7833         MOVE PI-EL127-CERT-SUFX  (2)
  7834                                 TO BSUFX2O
  7835     ELSE
  7836         MOVE LOW-VALUES         TO BCERT2O
  7837                                    BSUFX2O
  7838     END-IF.
  7839
  7840     IF PI-CERT-SELECT-CNT GREATER THAN 2
  7841         MOVE PI-EL127-CERT-PRIME (3)
  7842                                 TO BCERT3O
  7843         MOVE PI-EL127-CERT-SUFX  (3)
  7844                                 TO BSUFX3O
  7845     ELSE
  7846         MOVE LOW-VALUES         TO BCERT3O
  7847                                    BSUFX3O
  7848     END-IF.
  7849
  7850     IF PI-CERT-SELECT-CNT GREATER THAN 3
  7851         MOVE PI-EL127-CERT-PRIME (4)
  7852                                 TO BCERT4O
  7853         MOVE PI-EL127-CERT-SUFX  (4)
  7854                                 TO BSUFX4O
  7855     ELSE
  7856         MOVE LOW-VALUES         TO BCERT4O
  7857                                    BSUFX4O
  7858     END-IF.
  7859
  7860     IF PI-CERT-SELECT-CNT GREATER THAN 4
  7861         MOVE PI-EL127-CERT-PRIME (5)
  7862                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 153
* EL130.cbl
  7863         MOVE PI-EL127-CERT-SUFX  (5)
  7864                                 TO BSUFX5O
  7865     ELSE
  7866         MOVE LOW-VALUES         TO BCERT5O
  7867                                    BSUFX5O
  7868     END-IF.
  7869
  7870 0680-EXIT.
  7871     EXIT.
  7872
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 154
* EL130.cbl
  7874 0690-HIGHLIGHT-CERTS.
  7875
  7876     MOVE AL-UANON               TO PCERTNOA
  7877                                    PSUFXA.
  7878
  7879     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7880        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7881            MOVE AL-SABON        TO BCERT1A
  7882                                    BSUFX1A
  7883     ELSE
  7884         MOVE AL-SANON           TO BCERT1A
  7885                                    BSUFX1A
  7886     END-IF.
  7887
  7888     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7889        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7890            MOVE AL-SABON        TO BCERT2A
  7891                                    BSUFX2A
  7892     ELSE
  7893         MOVE AL-SANON           TO BCERT2A
  7894                                    BSUFX2A
  7895     END-IF.
  7896
  7897     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7898        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7899            MOVE AL-SABON        TO BCERT3A
  7900                                    BSUFX3A
  7901     ELSE
  7902         MOVE AL-SANON           TO BCERT3A
  7903                                    BSUFX3A
  7904     END-IF.
  7905
  7906     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7907        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7908            MOVE AL-SABON        TO BCERT4A
  7909                                    BSUFX4A
  7910     ELSE
  7911         MOVE AL-SANON           TO BCERT4A
  7912                                    BSUFX4A
  7913     END-IF.
  7914
  7915     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  7916        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  7917            MOVE AL-SABON        TO BCERT5A
  7918                                    BSUFX5A
  7919     ELSE
  7920         MOVE AL-SANON           TO BCERT5A
  7921                                    BSUFX5A
  7922     END-IF.
  7923
  7924 0690-EXIT.
  7925     EXIT.
  7926
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 155
* EL130.cbl
  7928 0800-TEST-PREVIOUS-CONTROL.
  7929     IF CLMNOI   = PI-LAST-CLAIM       AND
  7930        CLMCARRI = PI-LAST-CARR        AND
  7931        CERTNOI  = PI-LAST-CERT-PRIME  AND
  7932        SUFXI    = PI-LAST-CERT-SUFX
  7933*        NEXT SENTENCE
  7934         CONTINUE
  7935     ELSE
  7936         MOVE ER-0207            TO EMI-ERROR
  7937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7938         MOVE -1                 TO MAINTL
  7939         GO TO 8200-SEND-DATAONLY
  7940     END-IF.
  7941
  7942     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  7943
  7944     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  7945     MOVE PI-LAST-CARR           TO PI-CARRIER.
  7946     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  7947
  7948     IF EIBAID = DFHPF7
  7949         MOVE XCTL-157           TO PGM-NAME
  7950     END-IF.
  7951
  7952     IF EIBAID = DFHPF8
  7953         MOVE XCTL-141           TO PGM-NAME
  7954     END-IF.
  7955
  7956     IF EIBAID = DFHPF9
  7957        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  7958                                    PI-SAVED-PROGRAM-2
  7959                                    PI-SAVED-PROGRAM-3
  7960                                    PI-SAVED-PROGRAM-4
  7961                                    PI-SAVED-PROGRAM-5
  7962                                    PI-SAVED-PROGRAM-6
  7963        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  7964        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  7965        MOVE XCTL-150            TO PGM-NAME
  7966     END-IF.
  7967
  7968     GO TO 9300-XCTL.
  7969
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 156
* EL130.cbl
  7971 1000-SHOW-CLAIM.
  7972
  7973     IF CLMNOL = ZERO
  7974         MOVE -1                 TO CLMNOL
  7975         MOVE AL-UABON           TO CLMNOA
  7976         MOVE ER-0202            TO EMI-ERROR
  7977         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7978     ELSE
  7979         MOVE AL-UANON           TO CLMNOA
  7980     END-IF.
  7981
  7982     IF PI-NO-CARRIER-SECURITY
  7983        IF CLMCARRL = ZERO
  7984             MOVE -1             TO CLMCARRL
  7985             MOVE AL-UABON       TO CLMCARRA
  7986             MOVE ER-0194        TO EMI-ERROR
  7987             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7988         ELSE
  7989             MOVE AL-UANON       TO CLMCARRA
  7990         END-IF
  7991     END-IF.
  7992
  7993     IF SUFXL = ZERO
  7994         MOVE SPACES             TO SUFXI
  7995         MOVE AL-UANON           TO SUFXA
  7996     ELSE
  7997         MOVE AL-UANON           TO SUFXA
  7998     END-IF.
  7999
  8000     IF NOT EMI-NO-ERRORS
  8001         GO TO 1050-SEND-CHECK
  8002     END-IF.
  8003
  8004
  8005
  8006* EXEC CICS HANDLE CONDITION
  8007*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8008*    END-EXEC.
  8009*    MOVE '"$I                   ! '' #00007771' TO DFHEIV0
  8010     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8012     MOVE X'2720233030303037373731' TO DFHEIV0(25:11)
  8013     CALL 'kxdfhei1' USING DFHEIV0
  8014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8015
  8016
  8017     MOVE 'MSTR'                 TO FILE-SWITCH
  8018     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8019
  8020     MOVE CLMCARRI               TO MSTR-CARRIER.
  8021     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8022
  8023     IF CERTNOL = ZERO     OR
  8024        CERTNOI = SPACES   OR
  8025        CERTNOI = LOW-VALUES
  8026         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8027         MOVE AL-SANON        TO CERTNOA
  8028                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 157
* EL130.cbl
  8029     ELSE
  8030         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8031     END-IF.
  8032
  8033     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8034     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8035
  8036
  8037
  8038* EXEC CICS HANDLE CONDITION
  8039*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8040*    END-EXEC.
  8041*    MOVE '"$I                   ! ( #00007795' TO DFHEIV0
  8042     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8043     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8044     MOVE X'2820233030303037373935' TO DFHEIV0(25:11)
  8045     CALL 'kxdfhei1' USING DFHEIV0
  8046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8047
  8048
  8049     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8050
  8051     IF NOT PI-NO-ACCOUNT-SECURITY
  8052         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8053           MOVE ER-2371          TO EMI-ERROR
  8054           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8055           MOVE -1               TO MAINTL
  8056           GO TO 8200-SEND-DATAONLY
  8057         END-IF
  8058     END-IF.
  8059
  8060
  8061
  8062* EXEC CICS HANDLE CONDITION
  8063*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8064*    END-EXEC.
  8065*    MOVE '"$I                   ! ) #00007811' TO DFHEIV0
  8066     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8067     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8068     MOVE X'2920233030303037383131' TO DFHEIV0(25:11)
  8069     CALL 'kxdfhei1' USING DFHEIV0
  8070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8071
  8072
  8073     MOVE 'Y'                    TO CLAIM-SWITCH.
  8074     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8075     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8076     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8077
  8078 1000-SHOW-END-OF-PERFORM.
  8079
  8080     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8081     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8082     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8083     MOVE CL-CERT-STATE          TO CERT-STATE.
  8084     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8085     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8086     MOVE CL-CERT-NO             TO CERT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 158
* EL130.cbl
  8087
  8088     MOVE 'CERT'                 TO FILE-SWITCH.
  8089
  8090     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8091
  8092     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8093     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8094     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8095     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8096     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8097     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8098     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8099     MOVE CLMCARRI               TO PI-LAST-CARR.
  8100
  8101     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8102
  8103     IF MAINTI = 'I'
  8104         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8105                 BIRTHDTA  LSTNMEA   RELCLMA   OCCCDA
  8106                 LOANNOA   LOANBALA  BENECDA
  8107         MOVE AL-SANON TO  SSNA
  8108         MOVE SPACES   TO  INCURI    REPORTI  ESTENDI
  8109         MOVE 'Y'      TO PI-INCURR-SW
  8110         MOVE ER-0522  TO EMI-ERROR
  8111         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8112     ELSE
  8113         MOVE ' '      TO PI-INCURR-SW
  8114     END-IF.
  8115
  8116     MOVE -1                     TO MAINTL.
  8117     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8118     MOVE CERT-GROUPING          TO PI-GROUPING.
  8119     MOVE CERT-STATE             TO PI-STATE.
  8120     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8121     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8122     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8123     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8124
  8125     IF RETURNED-FROM NOT = SPACES
  8126         GO TO 8100-SEND-INITIAL-MAP
  8127     ELSE
  8128         GO TO 8200-SEND-DATAONLY
  8129     END-IF.
  8130
  8131 1025-SHOW-RECORD-NOT-FOUND.
  8132
  8133     IF FILE-SWITCH = 'MSTR'
  8134         MOVE ER-0204            TO EMI-ERROR
  8135     ELSE
  8136         IF FILE-SWITCH = 'TRLR'
  8137             MOVE ER-0205        TO EMI-ERROR
  8138         ELSE
  8139             MOVE ER-0206        TO EMI-ERROR
  8140         END-IF
  8141     END-IF.
  8142
  8143     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8144
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 159
* EL130.cbl
  8145 1050-SEND-CHECK.
  8146
  8147     IF RETURNED-FROM NOT = SPACES
  8148         GO TO 8100-SEND-INITIAL-MAP
  8149     ELSE
  8150         MOVE -1                 TO MAINTL
  8151         GO TO 8200-SEND-DATAONLY
  8152     END-IF.
  8153
  8154 2000-DELETE-CLAIM.
  8155     IF NOT MODIFY-CAP
  8156         MOVE ER-0070            TO EMI-ERROR
  8157         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8158         MOVE -1                 TO MAINTL
  8159         GO TO 8200-SEND-DATAONLY
  8160     END-IF.
  8161
  8162     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8163        CLMCARRI NOT = PI-LAST-CARR        OR
  8164        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8165        SUFXI    NOT = PI-LAST-CERT-SUFX
  8166         MOVE ER-0207            TO EMI-ERROR
  8167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8168         MOVE -1                 TO MAINTL
  8169         GO TO 8200-SEND-DATAONLY
  8170     END-IF.
  8171
  8172
  8173
  8174* EXEC CICS HANDLE CONDITION
  8175*        NOTFND   (2050-DELETE-NOT-FOUND)
  8176*    END-EXEC.
  8177*    MOVE '"$I                   ! * #00007915' TO DFHEIV0
  8178     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8180     MOVE X'2A20233030303037393135' TO DFHEIV0(25:11)
  8181     CALL 'kxdfhei1' USING DFHEIV0
  8182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8183
  8184
  8185     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8186
  8187     MOVE CLMCARRI               TO MSTR-CARRIER.
  8188     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8189     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8190     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8191
  8192     MOVE 'MSTR'                 TO FILE-SWITCH.
  8193     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8194
  8195     MOVE 'Y'                    TO CLAIM-SWITCH.
  8196
  8197     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8198        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8199         MOVE ER-0068        TO EMI-ERROR
  8200         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8201         MOVE -1             TO MAINTL
  8202         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 160
* EL130.cbl
  8203     END-IF.
  8204
  8205     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8206         MOVE ER-0569            TO EMI-ERROR
  8207         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8208         MOVE -1                 TO MAINTL
  8209         GO TO 8200-SEND-DATAONLY
  8210     END-IF.
  8211
  8212     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8213         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8214     END-IF.
  8215
  8216     IF CL-PURGED-DT NOT = LOW-VALUES
  8217         MOVE ER-7691            TO EMI-ERROR
  8218         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8219         MOVE -1                 TO MAINTL
  8220         GO TO 8200-SEND-DATAONLY
  8221     END-IF.
  8222
  8223     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8224     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8225     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8226     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8227     MOVE +0                     TO TRLR-SEQ-NO.
  8228     MOVE '1'                    TO TRLR-TYPE.
  8229
  8230     MOVE 'TRLR'                 TO FILE-SWITCH.
  8231
  8232
  8233
  8234* EXEC CICS READ
  8235*        UPDATE
  8236*        DATASET  (ELTRLR-DSID)
  8237*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8238*        RIDFLD   (ELTRLR-KEY)
  8239*    END-EXEC.
  8240*    MOVE '&"S        EU         (   #00007967' TO DFHEIV0
  8241     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8242     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8243     MOVE X'2020233030303037393637' TO DFHEIV0(25:11)
  8244     CALL 'kxdfhei1' USING DFHEIV0,
  8245           ELTRLR-DSID,
  8246           DFHEIV20,
  8247           DFHEIV99,
  8248           ELTRLR-KEY,
  8249           DFHEIV99,
  8250           DFHEIV99,
  8251           DFHEIV99
  8252     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8253         DFHEIV20
  8254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8255
  8256
  8257     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8258        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
  8259         MOVE ER-0068        TO EMI-ERROR
  8260         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 161
* EL130.cbl
  8261         MOVE -1             TO MAINTL
  8262         GO TO 8200-SEND-DATAONLY
  8263     END-IF.
  8264
  8265
  8266
  8267* EXEC CICS DELETE
  8268*        DATASET   (ELTRLR-DSID)
  8269*    END-EXEC.
  8270*    MOVE '&(                    &   #00007983' TO DFHEIV0
  8271     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8272     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8273     MOVE X'2020233030303037393833' TO DFHEIV0(25:11)
  8274     CALL 'kxdfhei1' USING DFHEIV0,
  8275           ELTRLR-DSID,
  8276           DFHEIV99,
  8277           DFHEIV99,
  8278           DFHEIV99,
  8279           DFHEIV99
  8280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8281
  8282
  8283     MOVE +90                    TO TRLR-SEQ-NO.
  8284     MOVE '6'                    TO TRLR-TYPE.
  8285
  8286
  8287
  8288* EXEC CICS READ
  8289*        UPDATE
  8290*        DATASET  (ELTRLR-DSID)
  8291*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8292*        RIDFLD   (ELTRLR-KEY)
  8293*    END-EXEC.
  8294*    MOVE '&"S        EU         (   #00007991' TO DFHEIV0
  8295     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8296     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8297     MOVE X'2020233030303037393931' TO DFHEIV0(25:11)
  8298     CALL 'kxdfhei1' USING DFHEIV0,
  8299           ELTRLR-DSID,
  8300           DFHEIV20,
  8301           DFHEIV99,
  8302           ELTRLR-KEY,
  8303           DFHEIV99,
  8304           DFHEIV99,
  8305           DFHEIV99
  8306     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8307         DFHEIV20
  8308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8309
  8310
  8311
  8312
  8313* EXEC CICS DELETE
  8314*        DATASET   (ELTRLR-DSID)
  8315*    END-EXEC.
  8316*    MOVE '&(                    &   #00007999' TO DFHEIV0
  8317     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8318     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 162
* EL130.cbl
  8319     MOVE X'2020233030303037393939' TO DFHEIV0(25:11)
  8320     CALL 'kxdfhei1' USING DFHEIV0,
  8321           ELTRLR-DSID,
  8322           DFHEIV99,
  8323           DFHEIV99,
  8324           DFHEIV99,
  8325           DFHEIV99
  8326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8327
  8328
  8329     MOVE +91                    TO TRLR-SEQ-NO.
  8330     MOVE '6'                    TO TRLR-TYPE.
  8331
  8332
  8333
  8334* EXEC CICS READ
  8335*        UPDATE
  8336*        DATASET  (ELTRLR-DSID)
  8337*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8338*        RIDFLD   (ELTRLR-KEY)
  8339*        RESP     (WS-RESPONSE)
  8340*    END-EXEC
  8341*    MOVE '&"S        EU         (  N#00008007' TO DFHEIV0
  8342     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8343     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8344     MOVE X'204E233030303038303037' TO DFHEIV0(25:11)
  8345     CALL 'kxdfhei1' USING DFHEIV0,
  8346           ELTRLR-DSID,
  8347           DFHEIV20,
  8348           DFHEIV99,
  8349           ELTRLR-KEY,
  8350           DFHEIV99,
  8351           DFHEIV99,
  8352           DFHEIV99
  8353     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8354         DFHEIV20
  8355     MOVE EIBRESP  TO WS-RESPONSE
  8356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8357
  8358     IF WS-RESP-NORMAL
  8359
  8360* EXEC CICS DELETE
  8361*          DATASET   (ELTRLR-DSID)
  8362*       END-EXEC
  8363*    MOVE '&(                    &   #00008016' TO DFHEIV0
  8364     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8365     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8366     MOVE X'2020233030303038303136' TO DFHEIV0(25:11)
  8367     CALL 'kxdfhei1' USING DFHEIV0,
  8368           ELTRLR-DSID,
  8369           DFHEIV99,
  8370           DFHEIV99,
  8371           DFHEIV99,
  8372           DFHEIV99
  8373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8374     END-IF.
  8375
  8376     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 163
* EL130.cbl
  8377     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8378     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8379     MOVE CL-CERT-STATE          TO CERT-STATE.
  8380     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8381     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8382     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8383
  8384     MOVE 'CERT'                 TO FILE-SWITCH.
  8385
  8386     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8387
  8388     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8389
  8390     IF WS-NUM-HOLD NOT = +0
  8391         GO TO 2005-REWRITE-CERT
  8392     END-IF.
  8393
  8394     IF NOT CERT-WAS-CREATED
  8395         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8396         GO TO 2005-REWRITE-CERT
  8397     END-IF.
  8398
  8399
  8400
  8401* EXEC CICS DELETE
  8402*        DATASET   (ELCERT-DSID)
  8403*    END-EXEC.
  8404*    MOVE '&(                    &   #00008045' TO DFHEIV0
  8405     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8406     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8407     MOVE X'2020233030303038303435' TO DFHEIV0(25:11)
  8408     CALL 'kxdfhei1' USING DFHEIV0,
  8409           ELCERT-DSID,
  8410           DFHEIV99,
  8411           DFHEIV99,
  8412           DFHEIV99,
  8413           DFHEIV99
  8414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8415
  8416
  8417     GO TO 2010-DELETE-CL.
  8418
  8419 2005-REWRITE-CERT.
  8420
  8421     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8422
  8423
  8424
  8425* EXEC CICS HANDLE CONDITION
  8426*         DUPKEY   (2010-DELETE-CL)
  8427*    END-EXEC.
  8428*    MOVE '"$$                   ! + #00008056' TO DFHEIV0
  8429     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8431     MOVE X'2B20233030303038303536' TO DFHEIV0(25:11)
  8432     CALL 'kxdfhei1' USING DFHEIV0
  8433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8434
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 164
* EL130.cbl
  8435
  8436
  8437
  8438* EXEC CICS REWRITE
  8439*        DATASET  (ELCERT-DSID)
  8440*        FROM     (CERTIFICATE-MASTER)
  8441*    END-EXEC.
  8442     MOVE LENGTH OF
  8443      CERTIFICATE-MASTER
  8444       TO DFHEIV11
  8445*    MOVE '&& L                  %   #00008061' TO DFHEIV0
  8446     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8447     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8448     MOVE X'2020233030303038303631' TO DFHEIV0(25:11)
  8449     CALL 'kxdfhei1' USING DFHEIV0,
  8450           ELCERT-DSID,
  8451           CERTIFICATE-MASTER,
  8452           DFHEIV11,
  8453           DFHEIV99
  8454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8455
  8456
  8457 2010-DELETE-CL.
  8458
  8459
  8460
  8461* EXEC CICS DELETE
  8462*        DATASET  (ELMSTR-DSID)
  8463*    END-EXEC.
  8464*    MOVE '&(                    &   #00008069' TO DFHEIV0
  8465     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8466     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8467     MOVE X'2020233030303038303639' TO DFHEIV0(25:11)
  8468     CALL 'kxdfhei1' USING DFHEIV0,
  8469           ELMSTR-DSID,
  8470           DFHEIV99,
  8471           DFHEIV99,
  8472           DFHEIV99,
  8473           DFHEIV99
  8474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8475
  8476
  8477     MOVE -1                     TO ONE-OR-MIN1.
  8478     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8479
  8480     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8481         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8482                                    WS-SAVE-CLAIM-KEY
  8483         MOVE +1                 TO ONE-OR-MIN1
  8484         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8485     END-IF.
  8486
  8487     MOVE ER-0000                TO EMI-ERROR.
  8488     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8489     MOVE LOW-VALUES             TO EL130AO.
  8490     MOVE -1                     TO MAINTL.
  8491     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8492     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 165
* EL130.cbl
  8493                                    PI-CERT-PROCESSED
  8494                                    PI-LETTER-ERROR-CODE.
  8495     GO TO 8100-SEND-INITIAL-MAP.
  8496
  8497 2050-DELETE-NOT-FOUND.
  8498     IF FILE-SWITCH = 'MSTR'
  8499         MOVE -1                 TO CLMNOL
  8500         MOVE ER-0204            TO EMI-ERROR
  8501     ELSE
  8502         IF FILE-SWITCH = 'TRLR'
  8503             MOVE -1             TO MAINTL
  8504             MOVE ER-0205        TO EMI-ERROR
  8505         ELSE
  8506             MOVE -1             TO CERTNOL
  8507             MOVE ER-0206        TO EMI-ERROR
  8508         END-IF
  8509     END-IF.
  8510
  8511     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8512     GO TO 8200-SEND-DATAONLY.
  8513
  8514 3000-ADD-CLAIM.
  8515     IF NOT MODIFY-CAP
  8516         MOVE ER-0070            TO EMI-ERROR
  8517         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8518         MOVE -1                 TO MAINTL
  8519         GO TO 8200-SEND-DATAONLY
  8520     END-IF.
  8521
  8522     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8523
  8524     IF CERTMTI = 'S'
  8525         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8526            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8527            WS-EFFDT = PI-SAVE-EFFDT       AND
  8528            ACCOUNTI = PI-SAVE-ACCOUNT
  8529             IF EMI-ERROR = 0
  8530                 GO TO 3010-TEST-FOR-ERRORS
  8531             ELSE
  8532                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8533                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8534                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8535                 MOVE PI-STATE         TO  CERT-STATE
  8536                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8537                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8538                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8539
  8540
  8541* EXEC CICS HANDLE CONDITION
  8542*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8543*                END-EXEC
  8544*    MOVE '"$I                   ! , #00008136' TO DFHEIV0
  8545     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8547     MOVE X'2C20233030303038313336' TO DFHEIV0(25:11)
  8548     CALL 'kxdfhei1' USING DFHEIV0
  8549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8550                 PERFORM 7940-READ-CERT THRU 7940-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 166
* EL130.cbl
  8551                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8552                 GO TO 3010-TEST-FOR-ERRORS
  8553             END-IF
  8554         END-IF
  8555     END-IF.
  8556
  8557     IF CERTMTI = 'A'
  8558         IF NOT PI-NO-CARRIER-SECURITY OR
  8559             NOT PI-NO-ACCOUNT-SECURITY
  8560             MOVE ER-2370          TO EMI-ERROR
  8561             MOVE -1               TO MAINTL
  8562             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8563             GO TO 8200-SEND-DATAONLY
  8564         ELSE
  8565             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8566             GO TO 3010-TEST-FOR-ERRORS
  8567         END-IF
  8568     END-IF.
  8569
  8570     IF CERTNOL = ZEROS
  8571        GO TO 3010-TEST-FOR-ERRORS
  8572     END-IF.
  8573
  8574 3000-READ-CERT.
  8575
  8576     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  8577                                    MSTR5-COMP-CD.
  8578     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  8579                                    MSTR5-CERT-NO-PRIME.
  8580     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  8581                                    MSTR5-CERT-NO-SUFX.
  8582
  8583
  8584
  8585* EXEC CICS HANDLE CONDITION
  8586*         DUPKEY   (3008-DUP-ERROR)
  8587*         NOTFND   (3009-NOT-FOUND)
  8588*    END-EXEC
  8589*    MOVE '"$$I                  ! - #00008173' TO DFHEIV0
  8590     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  8591     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8592     MOVE X'2D20233030303038313733' TO DFHEIV0(25:11)
  8593     CALL 'kxdfhei1' USING DFHEIV0
  8594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8595
  8596     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  8597
  8598     IF NOT PI-NO-ACCOUNT-SECURITY
  8599         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  8600             MOVE ER-2371          TO EMI-ERROR
  8601             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8602             MOVE -1               TO MAINTL
  8603             GO TO 8200-SEND-DATAONLY
  8604         END-IF
  8605     END-IF.
  8606
  8607     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  8608     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 167
* EL130.cbl
  8609     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  8610     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  8611     MOVE CM-CARRIER             TO PI-CARRIER.
  8612     MOVE CM-GROUPING            TO PI-GROUPING.
  8613     MOVE CM-STATE               TO PI-STATE.
  8614     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  8615     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  8616     MOVE CM-CERT-NO             TO PI-CERT-NO.
  8617     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  8618
  8619     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  8620         IF LSTNMEO = SPACES OR LOW-VALUES
  8621             MOVE CRTLNMEI       TO  LSTNMEO
  8622             MOVE AL-UANON       TO  LSTNMEA
  8623         END-IF
  8624     END-IF.
  8625
  8626     MOVE 'S'                    TO CERTMTO.
  8627*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  8628     MOVE AL-SANON               TO CERTNOA.
  8629     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  8630                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  8631     IF EMI-NO-ERRORS
  8632         MOVE -1                  TO MAINTL
  8633     END-IF.
  8634
  8635     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8636         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8637         IF INCURRED-DATE-MATCH
  8638             MOVE ER-7352         TO EMI-ERROR
  8639             MOVE -1              TO CERTNOL
  8640             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8641         ELSE
  8642             IF NO-CLAIMS-FOR-CERT
  8643                 MOVE ER-7353     TO EMI-ERROR
  8644                 MOVE -1          TO CERTNOL
  8645                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8646             ELSE
  8647                 MOVE ER-0558     TO EMI-ERROR
  8648                 MOVE -1          TO CERTNOL
  8649                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8650                 GO TO 3010-TEST-FOR-ERRORS
  8651             END-IF
  8652         END-IF
  8653     END-IF.
  8654
  8655 3007-SEND-SCREEN.
  8656     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8657         GO TO 8150-SEND-MAP-CURSOR
  8658     ELSE
  8659         GO TO 8200-SEND-DATAONLY
  8660     END-IF.
  8661
  8662 3008-DUP-ERROR.
  8663     MOVE ER-0560                TO EMI-ERROR.
  8664     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8665     MOVE -1                     TO CERTNOL.
  8666     GO TO 3007-SEND-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 168
* EL130.cbl
  8667
  8668 3009-NOT-FOUND.
  8669     MOVE ER-0214                TO EMI-ERROR.
  8670     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8671     MOVE -1                     TO CERTNOL.
  8672     GO TO 3007-SEND-SCREEN.
  8673
  8674 3010-TEST-FOR-ERRORS.
  8675
  8676     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  8677     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  8678
  8679     IF CERTMTI NOT = 'A'
  8680         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8681             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  8682             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  8683             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  8684             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8685             IF INCURRED-DATE-MATCH
  8686                 MOVE ER-7352         TO EMI-ERROR
  8687                 MOVE -1              TO CERTNOL
  8688                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8689             ELSE
  8690                 IF NO-CLAIMS-FOR-CERT
  8691                     MOVE ER-7353     TO EMI-ERROR
  8692                     MOVE -1          TO CERTNOL
  8693                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8694                 ELSE
  8695                     MOVE ER-0558     TO EMI-ERROR
  8696                     MOVE -1          TO CERTNOL
  8697                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8698                 END-IF
  8699             END-IF
  8700         END-IF
  8701     END-IF.
  8702
  8703     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  8704         MOVE ER-0433             TO EMI-ERROR
  8705         MOVE -1                  TO MAINTL
  8706         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8707         GO TO 8200-SEND-DATAONLY
  8708     END-IF.
  8709
  8710     IF EMI-NO-ERRORS
  8711         GO TO 3015-TRY-TO-BUILD
  8712     END-IF.
  8713
  8714     IF EIBAID = DFHPF6
  8715         IF EMI-FATAL-CTR NOT EQUAL ZERO
  8716             MOVE ER-0434         TO EMI-ERROR
  8717             MOVE -1              TO MAINTL
  8718             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8719             GO TO 8200-SEND-DATAONLY
  8720         ELSE
  8721             MOVE +1              TO INCURL
  8722             GO TO 3015-TRY-TO-BUILD
  8723         END-IF
  8724     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 169
* EL130.cbl
  8725
  8726     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  8727         GO TO 8150-SEND-MAP-CURSOR
  8728     ELSE
  8729         GO TO 8200-SEND-DATAONLY
  8730     END-IF.
  8731
  8732 3015-TRY-TO-BUILD.
  8733     IF CLMNOL EQUAL ZERO
  8734         GO TO 3030-BUILD-CONT
  8735     END-IF.
  8736
  8737
  8738
  8739* EXEC CICS HANDLE CONDITION
  8740*        NOTFND   (3030-BUILD-CONT)
  8741*    END-EXEC.
  8742*    MOVE '"$I                   ! . #00008320' TO DFHEIV0
  8743     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8745     MOVE X'2E20233030303038333230' TO DFHEIV0(25:11)
  8746     CALL 'kxdfhei1' USING DFHEIV0
  8747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8748
  8749
  8750     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8751
  8752     MOVE CLMCARRI               TO MSTR-CARRIER.
  8753     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8754     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8755     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8756
  8757     MOVE 'MSTR'                 TO FILE-SWITCH.
  8758
  8759     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8760
  8761     MOVE ER-0221                TO EMI-ERROR.
  8762
  8763     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8764     MOVE -1                     TO MAINTL.
  8765     GO TO 8200-SEND-DATAONLY.
  8766
  8767 3030-BUILD-CONT.
  8768     IF CERTMTI NOT = 'A'
  8769         GO TO 3060-BUILD-CONT
  8770     END-IF.
  8771
  8772
  8773
  8774* EXEC CICS HANDLE CONDITION
  8775*        NOTFND   (3033-ACCT-NOT-FOUND)
  8776*        ENDFILE  (3033-ACCT-NOT-FOUND)
  8777*    END-EXEC.
  8778*    MOVE '"$I''                  ! / #00008347' TO DFHEIV0
  8779     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8780     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8781     MOVE X'2F20233030303038333437' TO DFHEIV0(25:11)
  8782     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 170
* EL130.cbl
  8783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8784
  8785
  8786     MOVE SPACES                 TO ERACCT-KEY.
  8787
  8788     IF CARR-GROUP-ST-ACCNT-CNTL
  8789         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  8790         MOVE CRTCARRI           TO ACCT-CARRIER
  8791         MOVE GROUPI             TO ACCT-GROUPING
  8792         MOVE STATEI             TO ACCT-STATE
  8793         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  8794         GO TO 3031-MOVE-ACCT-KEY
  8795     END-IF.
  8796
  8797     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  8798     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  8799
  8800     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  8801         MOVE STATEI             TO ACCT-STATE
  8802     END-IF.
  8803
  8804     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  8805         MOVE CRTCARRI           TO ACCT-CARRIER
  8806     END-IF.
  8807
  8808 3031-MOVE-ACCT-KEY.
  8809     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  8810
  8811
  8812
  8813* EXEC CICS STARTBR
  8814*        DATASET     (ERACCT2-DSID)
  8815*        RIDFLD      (SAVE-ERACCT-KEY)
  8816*        GENERIC
  8817*        KEYLENGTH   (20)
  8818*    END-EXEC.
  8819     MOVE 20
  8820       TO DFHEIV11
  8821     MOVE 0
  8822       TO DFHEIV12
  8823*    MOVE '&,   KG    G          &   #00008378' TO DFHEIV0
  8824     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  8825     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8826     MOVE X'2020233030303038333738' TO DFHEIV0(25:11)
  8827     CALL 'kxdfhei1' USING DFHEIV0,
  8828           ERACCT2-DSID,
  8829           SAVE-ERACCT-KEY,
  8830           DFHEIV11,
  8831           DFHEIV12,
  8832           DFHEIV99
  8833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8834
  8835
  8836
  8837
  8838* EXEC CICS HANDLE CONDITION
  8839*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  8840*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 171
* EL130.cbl
  8841*    MOVE '"$''                   ! 0 #00008386' TO DFHEIV0
  8842     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8844     MOVE X'3020233030303038333836' TO DFHEIV0(25:11)
  8845     CALL 'kxdfhei1' USING DFHEIV0
  8846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8847
  8848
  8849 3031-READ-ACCT-LOOP.
  8850
  8851
  8852* EXEC CICS READNEXT
  8853*        DATASET   (ERACCT2-DSID)
  8854*        SET       (ADDRESS OF ACCOUNT-MASTER)
  8855*        RIDFLD    (SAVE-ERACCT-KEY)
  8856*    END-EXEC.
  8857     MOVE 0
  8858       TO DFHEIV11
  8859*    MOVE '&.S                   )   #00008392' TO DFHEIV0
  8860     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8861     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8862     MOVE X'2020233030303038333932' TO DFHEIV0(25:11)
  8863     CALL 'kxdfhei1' USING DFHEIV0,
  8864           ERACCT2-DSID,
  8865           DFHEIV20,
  8866           DFHEIV99,
  8867           SAVE-ERACCT-KEY,
  8868           DFHEIV99,
  8869           DFHEIV11,
  8870           DFHEIV99,
  8871           DFHEIV99
  8872     SET ADDRESS OF ACCOUNT-MASTER TO
  8873         DFHEIV20
  8874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8875
  8876
  8877     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  8878        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  8879        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  8880        ACCT-STATE    NOT = AM-VG-STATE       OR
  8881        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  8882         GO TO 3033-ACCT-NOT-FOUND
  8883     END-IF.
  8884
  8885     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  8886        WS-EFFDT LESS AM-EXPIRATION-DT
  8887         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  8888         MOVE AM-CARRIER       TO CERT-CARRIER
  8889         MOVE AM-GROUPING      TO CERT-GROUPING
  8890         MOVE AM-STATE         TO CERT-STATE
  8891         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  8892         MOVE WS-EFFDT         TO CERT-EFF-DT
  8893         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  8894         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  8895         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  8896         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  8897     END-IF.
  8898
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 172
* EL130.cbl
  8899     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  8900         GO TO 3031-READ-ACCT-LOOP
  8901     END-IF.
  8902
  8903 3032-NOT-IN-DT-RANGE.
  8904     MOVE ER-0226                TO EMI-ERROR.
  8905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8906     MOVE -1                     TO EFFDTL.
  8907     GO TO 8200-SEND-DATAONLY.
  8908
  8909 3033-ACCT-NOT-FOUND.
  8910     MOVE ER-0226 TO EMI-ERROR.
  8911     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8912     MOVE -1                     TO ACCOUNTL.
  8913     GO TO 8200-SEND-DATAONLY.
  8914
  8915 3034-CHECK-EMPLOYER-STATEMENT.
  8916
  8917     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  8918*        NEXT SENTENCE
  8919         CONTINUE
  8920     ELSE
  8921         GO TO  3034-CHECK-ACCOUNT-LIMITS
  8922     END-IF.
  8923
  8924     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  8925     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  8926     MOVE '1'                    TO  DC-OPTION-CODE.
  8927     MOVE +0                     TO  DC-ELAPSED-MONTHS
  8928                                     DC-ELAPSED-DAYS.
  8929     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8930
  8931     IF (AM-EMPLOYER-STMT-USED = '1' AND
  8932         DC-ELAPSED-DAYS LESS THAN +31)
  8933                      OR
  8934        (AM-EMPLOYER-STMT-USED = '2' AND
  8935         DC-ELAPSED-DAYS LESS THAN +61)
  8936                      OR
  8937        (AM-EMPLOYER-STMT-USED = '3' AND
  8938         DC-ELAPSED-DAYS LESS THAN +91)
  8939            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  8940     END-IF.
  8941
  8942 3034-CHECK-ACCOUNT-LIMITS.
  8943
  8944     IF CERTMTI NOT = 'A'
  8945         GO TO 3060-BUILD-CONT
  8946     END-IF.
  8947
  8948     IF AM-STATUS NOT = '0'
  8949         MOVE ER-0225                TO EMI-ERROR
  8950         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8951         MOVE -1                     TO ACCOUNTL
  8952     END-IF.
  8953
  8954     IF EIBAID = DFHPF6
  8955         IF EMI-FATAL-CTR NOT = ZERO
  8956             MOVE ER-0434         TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 173
* EL130.cbl
  8957             MOVE -1              TO MAINTL
  8958             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8959             GO TO 8200-SEND-DATAONLY
  8960         END-IF
  8961     END-IF.
  8962
  8963*    IF PI-COMPANY-ID NOT = 'CRI'
  8964*        GO TO 3035-END-BROWSE
  8965*    END-IF.
  8966
  8967 3035-END-BROWSE.
  8968
  8969
  8970* EXEC CICS ENDBR
  8971*        DATASET    (ERACCT2-DSID)
  8972*    END-EXEC.
  8973     MOVE 0
  8974       TO DFHEIV11
  8975*    MOVE '&2                    $   #00008490' TO DFHEIV0
  8976     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8977     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8978     MOVE X'2020233030303038343930' TO DFHEIV0(25:11)
  8979     CALL 'kxdfhei1' USING DFHEIV0,
  8980           ERACCT2-DSID,
  8981           DFHEIV11,
  8982           DFHEIV99
  8983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8984
  8985
  8986 3040-CHECK-CERT-ALREADY-ON.
  8987
  8988
  8989* EXEC CICS HANDLE CONDITION
  8990*        NOTFND   (3070-BUILD-CONT)
  8991*    END-EXEC.
  8992*    MOVE '"$I                   ! 1 #00008496' TO DFHEIV0
  8993     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8995     MOVE X'3120233030303038343936' TO DFHEIV0(25:11)
  8996     CALL 'kxdfhei1' USING DFHEIV0
  8997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8998
  8999
  9000     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9001
  9002     MOVE ER-0229                TO EMI-ERROR.
  9003     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9004     MOVE -1                     TO MAINTL.
  9005     GO TO 8200-SEND-DATAONLY.
  9006
  9007 3060-BUILD-CONT.
  9008     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9009     MOVE CRTCARRI               TO CERT-CARRIER.
  9010     MOVE GROUPI                 TO CERT-GROUPING.
  9011     MOVE STATEI                 TO CERT-STATE.
  9012     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9013     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9014     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 174
* EL130.cbl
  9015     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9016
  9017
  9018
  9019* EXEC CICS HANDLE CONDITION
  9020*        NOTFND  (3065-CERT-NOT-FOUND)
  9021*    END-EXEC.
  9022*    MOVE '"$I                   ! 2 #00008518' TO DFHEIV0
  9023     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9024     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9025     MOVE X'3220233030303038353138' TO DFHEIV0(25:11)
  9026     CALL 'kxdfhei1' USING DFHEIV0
  9027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9028
  9029
  9030     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9031
  9032     GO TO 3070-BUILD-CONT.
  9033
  9034 3065-CERT-NOT-FOUND.
  9035     MOVE ER-0244                TO EMI-ERROR.
  9036     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9037     MOVE -1                     TO CERTNOL.
  9038     GO TO 8200-SEND-DATAONLY.
  9039
  9040 3070-BUILD-CONT.
  9041     IF CLMNOL NOT = ZERO
  9042         GO TO 3200-BUILD-ZERO-TRAILER
  9043     END-IF.
  9044
  9045     MOVE SPACES                 TO ELCNTL-KEY.
  9046
  9047     IF CONTROL-IS-ACTUAL-CARRIER
  9048         MOVE PI-CARRIER         TO CNTL-CARRIER
  9049     ELSE
  9050         MOVE PI-CARRIER-CONTROL-LEVEL
  9051                                 TO CNTL-CARRIER
  9052     END-IF.
  9053
  9054     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9055     MOVE '6'                    TO CNTL-REC-TYPE.
  9056     MOVE +0                     TO CNTL-SEQ-NO.
  9057
  9058
  9059
  9060* EXEC CICS HANDLE CONDITION
  9061*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9062*    END-EXEC.
  9063*    MOVE '"$I                   ! 3 #00008551' TO DFHEIV0
  9064     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9065     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9066     MOVE X'3320233030303038353531' TO DFHEIV0(25:11)
  9067     CALL 'kxdfhei1' USING DFHEIV0
  9068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9069
  9070
  9071
  9072
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 175
* EL130.cbl
  9073* EXEC CICS READ
  9074*        UPDATE
  9075*        DATASET   (ELCNTL-DSID)
  9076*        SET       (ADDRESS OF CONTROL-FILE)
  9077*        RIDFLD    (ELCNTL-KEY)
  9078*    END-EXEC.
  9079*    MOVE '&"S        EU         (   #00008556' TO DFHEIV0
  9080     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9081     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9082     MOVE X'2020233030303038353536' TO DFHEIV0(25:11)
  9083     CALL 'kxdfhei1' USING DFHEIV0,
  9084           ELCNTL-DSID,
  9085           DFHEIV20,
  9086           DFHEIV99,
  9087           ELCNTL-KEY,
  9088           DFHEIV99,
  9089           DFHEIV99,
  9090           DFHEIV99
  9091     SET ADDRESS OF CONTROL-FILE TO
  9092         DFHEIV20
  9093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9094
  9095
  9096     IF CLAIM-NO-MANUAL
  9097         GO TO 3120-CLAIM-MUST-BE-INPUT
  9098     END-IF.
  9099
  9100     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9101     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9102
  9103     IF PI-COMPANY-ID = 'CID' OR 'DCC'
  9104         CONTINUE
  9105     ELSE
  9106         GO TO 3080-ASSIGN-LOOP
  9107     END-IF.
  9108
  9109
  9110
  9111* EXEC CICS UNLOCK
  9112*        DATASET   (ELCNTL-DSID)
  9113*    END-EXEC.
  9114*    MOVE '&*                    #   #00008577' TO DFHEIV0
  9115     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9116     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9117     MOVE X'2020233030303038353737' TO DFHEIV0(25:11)
  9118     CALL 'kxdfhei1' USING DFHEIV0,
  9119           ELCNTL-DSID,
  9120           DFHEIV99
  9121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9122
  9123
  9124     MOVE '1'                    TO CNTL-REC-TYPE.
  9125     MOVE SPACES                 TO CNTL-ACCESS.
  9126
  9127     IF PI-COMPANY-ID = 'CID'
  9128         MOVE 'CID'              TO CNTL-COMP-ID
  9129     ELSE
  9130         IF PI-COMPANY-ID = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 176
* EL130.cbl
  9131             MOVE 'DCC'          TO CNTL-COMP-ID
  9132         END-IF
  9133     END-IF.
  9134
  9135
  9136
  9137* EXEC CICS HANDLE CONDITION
  9138*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9139*    END-EXEC.
  9140*    MOVE '"$I                   ! 4 #00008593' TO DFHEIV0
  9141     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9142     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9143     MOVE X'3420233030303038353933' TO DFHEIV0(25:11)
  9144     CALL 'kxdfhei1' USING DFHEIV0
  9145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9146
  9147
  9148     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9149
  9150     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9151
  9152 3080-ASSIGN-LOOP.
  9153     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9154        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9155         MOVE +0                 TO SAVE-COUNTER
  9156     END-IF.
  9157
  9158     ADD +1 TO SAVE-COUNTER.
  9159
  9160     IF SAVE-METHOD  = '3'
  9161         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9162         GO TO 3090-SET-COMP
  9163     END-IF.
  9164
  9165     IF SAVE-METHOD  = '4'
  9166         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
  9167         MOVE CLMCARRI           TO WS-CN-PRF-A
  9168         GO TO 3090-SET-COMP
  9169     END-IF.
  9170
  9171     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9172     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9173     MOVE SAVE-DATE              TO CURR-DATE.
  9174
  9175     IF CURR-MM LESS '10'
  9176         MOVE CURR-M2             TO WS-CN-PRF-B
  9177     END-IF.
  9178
  9179     IF CURR-MM = '10'
  9180        MOVE 'A'                 TO WS-CN-PRF-B
  9181     END-IF.
  9182     IF CURR-MM = '11'
  9183        MOVE 'B'                 TO WS-CN-PRF-B
  9184     END-IF.
  9185     IF CURR-MM = '12'
  9186        MOVE 'C'                 TO WS-CN-PRF-B
  9187     END-IF.
  9188
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 177
* EL130.cbl
  9189     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9190
  9191 3090-SET-COMP.
  9192
  9193     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9194     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9195                                    CLMNOO.
  9196     MOVE AL-UANON               TO CLMNOA.
  9197     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9198     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9199     MOVE CLMCARRI               TO MSTR-CARRIER.
  9200
  9201
  9202
  9203* EXEC CICS HANDLE CONDITION
  9204*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9205*    END-EXEC.
  9206*    MOVE '"$I                   ! 5 #00008651' TO DFHEIV0
  9207     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9208     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9209     MOVE X'3520233030303038363531' TO DFHEIV0(25:11)
  9210     CALL 'kxdfhei1' USING DFHEIV0
  9211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9212
  9213
  9214     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9215
  9216     GO TO 3080-ASSIGN-LOOP.
  9217
  9218 3100-CARRIER-NOT-FOUND.
  9219     MOVE ER-0252                TO EMI-ERROR.
  9220     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9221     MOVE -1                     TO CLMCARRL.
  9222     GO TO 8200-SEND-DATAONLY.
  9223
  9224 3110-COMPANY-NOT-FOUND.
  9225     MOVE ER-0254                TO EMI-ERROR.
  9226     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9227     MOVE -1                     TO MAINTL.
  9228     GO TO 8200-SEND-DATAONLY.
  9229
  9230 3120-CLAIM-MUST-BE-INPUT.
  9231     MOVE ER-0264                TO EMI-ERROR.
  9232     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9233     MOVE -1                     TO CLMNOL.
  9234     GO TO 8200-SEND-DATAONLY.
  9235
  9236 3200-BUILD-ZERO-TRAILER.
  9237
  9238
  9239* EXEC CICS HANDLE CONDITION
  9240*        NOTFND
  9241*    END-EXEC.
  9242*    MOVE '"$                   ! 6 #00008679' TO DFHEIV0
  9243     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9245     MOVE X'3620233030303038363739' TO DFHEIV0(25:11)
  9246     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 178
* EL130.cbl
  9247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9248
  9249
  9250
  9251
  9252* EXEC CICS GETMAIN
  9253*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9254*        LENGTH  (ELTRLR-LENGTH)
  9255*    END-EXEC.
  9256*    MOVE '," L                  $   #00008684' TO DFHEIV0
  9257     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9258     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9259     MOVE X'2020233030303038363834' TO DFHEIV0(25:11)
  9260     CALL 'kxdfhei1' USING DFHEIV0,
  9261           DFHEIV20,
  9262           ELTRLR-LENGTH,
  9263           DFHEIV99
  9264     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9265         DFHEIV20
  9266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9267
  9268
  9269     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9270     MOVE 'AT'                   TO AT-RECORD-ID.
  9271
  9272     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9273     MOVE CLMCARRI               TO AT-CARRIER.
  9274     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9275     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9276     MOVE +0                     TO AT-SEQUENCE-NO.
  9277     MOVE '1'                    TO AT-TRAILER-TYPE.
  9278
  9279     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9280     MOVE '5'                    TO DC-OPTION-CODE.
  9281     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9282     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9283                                    AT-RESERVES-LAST-MAINT-DT.
  9284
  9285     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9286                                    AT-RESERVES-LAST-UPDATED-BY.
  9287
  9288     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9289
  9290     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9291
  9292     MOVE +0                     TO AT-FUTURE-RESERVE
  9293                                    AT-IBNR-RESERVE
  9294                                    AT-PAY-CURRENT-RESERVE
  9295                                    AT-INITIAL-MANUAL-RESERVE
  9296                                    AT-CURRENT-MANUAL-RESERVE
  9297                                    AT-ITD-LIFE-REFUNDS
  9298                                    AT-ITD-AH-REFUNDS
  9299                                    AT-ITD-ADDITIONAL-RESERVE.
  9300
  9301     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9302
  9303     IF MANRSVL NOT = ZERO
  9304         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 179
* EL130.cbl
  9305                                    AT-CURRENT-MANUAL-RESERVE
  9306     END-IF.
  9307
  9308     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9309
  9310     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9311                                    AT-ITD-CHARGEABLE-EXPENSE.
  9312
  9313     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9314     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9315     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9316
  9317
  9318
  9319* EXEC CICS WRITE
  9320*        DATASET   (ELTRLR-DSID)
  9321*        FROM      (ACTIVITY-TRAILERS)
  9322*        RIDFLD    (AT-CONTROL-PRIMARY)
  9323*    END-EXEC.
  9324     MOVE LENGTH OF
  9325      ACTIVITY-TRAILERS
  9326       TO DFHEIV11
  9327*    MOVE '&$ L                  ''   #00008738' TO DFHEIV0
  9328     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9329     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9330     MOVE X'2020233030303038373338' TO DFHEIV0(25:11)
  9331     CALL 'kxdfhei1' USING DFHEIV0,
  9332           ELTRLR-DSID,
  9333           ACTIVITY-TRAILERS,
  9334           DFHEIV11,
  9335           AT-CONTROL-PRIMARY,
  9336           DFHEIV99,
  9337           DFHEIV99
  9338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9339
  9340
  9341     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9342
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 180
* EL130.cbl
  9344
  9345 3250-BUILD-I1-ADDRESS-TRAILER.
  9346
  9347     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9348     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9349     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9350     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9351     MOVE GROUPI                 TO WS-MA-GROUPING.
  9352     MOVE STATEI                 TO WS-MA-STATE.
  9353     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9354     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9355     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9356     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9357
  9358
  9359* EXEC CICS HANDLE CONDITION
  9360*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9361*    END-EXEC.
  9362*    MOVE '"$I                   ! 7 #00008761' TO DFHEIV0
  9363     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9364     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9365     MOVE X'3720233030303038373631' TO DFHEIV0(25:11)
  9366     CALL 'kxdfhei1' USING DFHEIV0
  9367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9368
  9369
  9370
  9371* EXEC CICS READ
  9372*        EQUAL
  9373*        DATASET   (ERMAIL-DSID)
  9374*        SET       (ADDRESS OF MAILING-DATA)
  9375*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9376*    END-EXEC.
  9377*    MOVE '&"S        E          (   #00008765' TO DFHEIV0
  9378     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9379     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9380     MOVE X'2020233030303038373635' TO DFHEIV0(25:11)
  9381     CALL 'kxdfhei1' USING DFHEIV0,
  9382           ERMAIL-DSID,
  9383           DFHEIV20,
  9384           DFHEIV99,
  9385           WS-MA-CONTROL-PRIMARY,
  9386           DFHEIV99,
  9387           DFHEIV99,
  9388           DFHEIV99
  9389     SET ADDRESS OF MAILING-DATA TO
  9390         DFHEIV20
  9391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9392
  9393
  9394     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9395         GO TO 3290-NO-INSURED-ADDRESS
  9396     END-IF.
  9397
  9398     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9399     MOVE 'AT'                   TO AT-RECORD-ID.
  9400
  9401     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 181
* EL130.cbl
  9402     MOVE CLMCARRI               TO AT-CARRIER.
  9403     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9404     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9405     MOVE +1                     TO AT-SEQUENCE-NO.
  9406     MOVE '5'                    TO AT-TRAILER-TYPE.
  9407
  9408     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9409     IF MA-INSURED-MIDDLE-INIT > SPACES
  9410        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9411               ' ' DELIMITED BY SIZE
  9412               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9413               ' ' DELIMITED BY SIZE
  9414               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9415        INTO AT-MAIL-TO-NAME
  9416     ELSE
  9417        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9418               ' ' DELIMITED BY SIZE
  9419               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9420        INTO AT-MAIL-TO-NAME
  9421     END-IF.
  9422     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9423     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9424*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9425     MOVE MA-CITY                TO AT-CITY
  9426     MOVE MA-ADDR-STATE          TO AT-STATE
  9427     MOVE MA-ZIP                 TO AT-ZIP
  9428     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9429
  9430     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9431                                    AT-ADDRESS-LAST-MAINT-DT.
  9432
  9433     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9434                                    AT-ADDRESS-LAST-UPDATED-BY.
  9435
  9436     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9437
  9438
  9439* EXEC CICS WRITE
  9440*        DATASET   (ELTRLR-DSID)
  9441*        FROM      (ACTIVITY-TRAILERS)
  9442*        RIDFLD    (AT-CONTROL-PRIMARY)
  9443*    END-EXEC.
  9444     MOVE LENGTH OF
  9445      ACTIVITY-TRAILERS
  9446       TO DFHEIV11
  9447*    MOVE '&$ L                  ''   #00008816' TO DFHEIV0
  9448     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9449     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9450     MOVE X'2020233030303038383136' TO DFHEIV0(25:11)
  9451     CALL 'kxdfhei1' USING DFHEIV0,
  9452           ELTRLR-DSID,
  9453           ACTIVITY-TRAILERS,
  9454           DFHEIV11,
  9455           AT-CONTROL-PRIMARY,
  9456           DFHEIV99,
  9457           DFHEIV99
  9458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9459
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 182
* EL130.cbl
  9460
  9461     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9462     GO TO 3300-BUILD-NINETY-TRAILER.
  9463
  9464 3290-NO-INSURED-ADDRESS.
  9465      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9466
  9467 3300-BUILD-NINETY-TRAILER.
  9468
  9469     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9470     MOVE 'AT'                   TO AT-RECORD-ID.
  9471
  9472     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9473     MOVE CLMCARRI               TO AT-CARRIER.
  9474
  9475     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9476     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9477     MOVE +90                    TO AT-SEQUENCE-NO.
  9478     MOVE '6'                    TO AT-TRAILER-TYPE.
  9479
  9480     IF DIAGL NOT = ZERO
  9481         MOVE DIAGI              TO AT-INFO-LINE-1
  9482     END-IF.
  9483
  9484     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9485                                    AT-GEN-INFO-LAST-MAINT-DT.
  9486
  9487     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9488                                    AT-GEN-INFO-LAST-UPDATED-BY.
  9489     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9490
  9491
  9492
  9493* EXEC CICS WRITE
  9494*        DATASET   (ELTRLR-DSID)
  9495*        FROM      (ACTIVITY-TRAILERS)
  9496*        RIDFLD    (AT-CONTROL-PRIMARY)
  9497*    END-EXEC.
  9498     MOVE LENGTH OF
  9499      ACTIVITY-TRAILERS
  9500       TO DFHEIV11
  9501*    MOVE '&$ L                  ''   #00008853' TO DFHEIV0
  9502     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9503     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9504     MOVE X'2020233030303038383533' TO DFHEIV0(25:11)
  9505     CALL 'kxdfhei1' USING DFHEIV0,
  9506           ELTRLR-DSID,
  9507           ACTIVITY-TRAILERS,
  9508           DFHEIV11,
  9509           AT-CONTROL-PRIMARY,
  9510           DFHEIV99,
  9511           DFHEIV99
  9512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9513
  9514
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 183
* EL130.cbl
  9516 3400-CHECK-CERT-MAINT.
  9517
  9518     IF CERTMTI = 'A'
  9519         GO TO 3600-BUILD-NEW-CERT
  9520     END-IF.
  9521
  9522     IF NO-CLAIM-ATTACHED
  9523         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
  9524     END-IF.
  9525
  9526     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
  9527
  9528     IF CM-LF-CURRENT-STATUS = '2' OR
  9529        CM-AH-CURRENT-STATUS = '2'
  9530         GO TO 3400-REWRITE-CERT
  9531     END-IF.
  9532
  9533     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9534
  9535 3400-REWRITE-CERT.
  9536
  9537
  9538
  9539* EXEC CICS HANDLE CONDITION
  9540*        DUPKEY (3410-DUP-KEY)
  9541*    END-EXEC.
  9542*    MOVE '"$$                   ! 8 #00008882' TO DFHEIV0
  9543     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9545     MOVE X'3820233030303038383832' TO DFHEIV0(25:11)
  9546     CALL 'kxdfhei1' USING DFHEIV0
  9547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9548
  9549
  9550
  9551
  9552* EXEC CICS REWRITE
  9553*        DATASET   (ELCERT-DSID)
  9554*        FROM      (CERTIFICATE-MASTER)
  9555*    END-EXEC.
  9556     MOVE LENGTH OF
  9557      CERTIFICATE-MASTER
  9558       TO DFHEIV11
  9559*    MOVE '&& L                  %   #00008887' TO DFHEIV0
  9560     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9561     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9562     MOVE X'2020233030303038383837' TO DFHEIV0(25:11)
  9563     CALL 'kxdfhei1' USING DFHEIV0,
  9564           ELCERT-DSID,
  9565           CERTIFICATE-MASTER,
  9566           DFHEIV11,
  9567           DFHEIV99
  9568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9569
  9570
  9571 3410-DUP-KEY.
  9572     GO TO 3800-BUILD-NEW-CLAIM.
  9573
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 184
* EL130.cbl
  9574 3600-BUILD-NEW-CERT.
  9575
  9576
  9577* EXEC CICS GETMAIN
  9578*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  9579*        LENGTH   (ELCERT-LENGTH)
  9580*    END-EXEC.
  9581*    MOVE '," L                  $   #00008897' TO DFHEIV0
  9582     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9583     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9584     MOVE X'2020233030303038383937' TO DFHEIV0(25:11)
  9585     CALL 'kxdfhei1' USING DFHEIV0,
  9586           DFHEIV20,
  9587           ELCERT-LENGTH,
  9588           DFHEIV99
  9589     SET ADDRESS OF CERTIFICATE-MASTER TO
  9590         DFHEIV20
  9591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9592
  9593
  9594     MOVE SPACES                 TO CERTIFICATE-MASTER.
  9595
  9596     MOVE 'CM'                   TO CM-RECORD-ID.
  9597
  9598     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
  9599                                    CM-COMPANY-CD-A1
  9600                                    CM-COMPANY-CD-A2
  9601                                    CM-COMPANY-CD-A4
  9602                                    CM-COMPANY-CD-A5.
  9603
  9604     MOVE CERT-CARRIER           TO CM-CARRIER.
  9605     MOVE CERT-GROUPING          TO CM-GROUPING.
  9606     MOVE CERT-STATE             TO CM-STATE.
  9607     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
  9608     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
  9609     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
  9610
  9611     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
  9612                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
  9613                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
  9614                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
  9615                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
  9616                       CM-LIVES              CM-LOAN-TERM
  9617                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
  9618                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
  9619                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
  9620                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
  9621                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
  9622                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
  9623                       CM-LF-ALT-PREMIUM-RATE
  9624                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
  9625                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
  9626                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
  9627                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
  9628                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
  9629
  9630     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
  9631                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 185
* EL130.cbl
  9632                                    CM-AH-SETTLEMENT-DT
  9633                                    CM-AH-CANCEL-EXIT-DT
  9634                                    CM-AH-SETTLEMENT-EXIT-DT
  9635                                    CM-LF-LOAN-EXPIRE-DT
  9636                                    CM-LF-CANCEL-DT
  9637                                    CM-LF-DEATH-DT
  9638                                    CM-LF-CANCEL-EXIT-DT
  9639                                    CM-LF-DEATH-EXIT-DT
  9640                                    CM-LAST-ADD-ON-DT
  9641                                    CM-ENTRY-DT.
  9642
  9643     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
  9644     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
  9645     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
  9646
  9647     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
  9648                                    CM-PART-LAST-NAME-A2
  9649                                    CM-PART-LAST-NAME-A5.
  9650
  9651     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
  9652                                    CM-INSURED-INITIAL1-A2
  9653                                    CM-INSURED-INITIAL1-A5
  9654                                    CM-INSURED-FIRST-NAME.
  9655
  9656     IF CRTINITL GREATER ZERO
  9657         MOVE CRTINITI           TO CM-INSURED-INITIAL2
  9658                                    CM-INSURED-INITIAL2-A2
  9659                                    CM-INSURED-INITIAL2-A5
  9660     ELSE
  9661         MOVE SPACES             TO CM-INSURED-INITIAL2
  9662                                    CM-INSURED-INITIAL2-A2
  9663                                    CM-INSURED-INITIAL2-A5
  9664     END-IF.
  9665
  9666     IF CM-INSURED-INITIALS = SPACES
  9667         MOVE '**'               TO CM-INSURED-INITIALS
  9668     END-IF.
  9669
  9670     IF MEMBERL GREATER ZERO
  9671         MOVE MEMBERI              TO CM-MEMBER-NO
  9672     ELSE
  9673         MOVE CERT-STATE           TO CM-MEMB-STATE
  9674         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
  9675         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
  9676         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
  9677     END-IF.
  9678
  9679     IF JNTLNMEL GREATER ZERO
  9680         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
  9681     END-IF.
  9682
  9683     IF JNTFNMEL GREATER ZERO
  9684         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
  9685     END-IF.
  9686
  9687     IF JNTINITL GREATER ZERO
  9688         MOVE JNTINITI           TO CM-JT-INITIAL
  9689     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 186
* EL130.cbl
  9690
  9691     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
  9692
  9693
  9694
  9695* EXEC CICS HANDLE CONDITION
  9696*        DUPKEY   (3690-CERT-WRITTEN)
  9697*    END-EXEC.
  9698*    MOVE '"$$                   ! 9 #00009002' TO DFHEIV0
  9699     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9701     MOVE X'3920233030303039303032' TO DFHEIV0(25:11)
  9702     CALL 'kxdfhei1' USING DFHEIV0
  9703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9704
  9705
  9706
  9707
  9708* EXEC CICS WRITE
  9709*        DATASET   (ELCERT-DSID)
  9710*        FROM      (CERTIFICATE-MASTER)
  9711*        RIDFLD    (CM-CONTROL-PRIMARY)
  9712*    END-EXEC.
  9713     MOVE LENGTH OF
  9714      CERTIFICATE-MASTER
  9715       TO DFHEIV11
  9716*    MOVE '&$ L                  ''   #00009007' TO DFHEIV0
  9717     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9719     MOVE X'2020233030303039303037' TO DFHEIV0(25:11)
  9720     CALL 'kxdfhei1' USING DFHEIV0,
  9721           ELCERT-DSID,
  9722           CERTIFICATE-MASTER,
  9723           DFHEIV11,
  9724           CM-CONTROL-PRIMARY,
  9725           DFHEIV99,
  9726           DFHEIV99
  9727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9728
  9729
  9730 3690-CERT-WRITTEN.
  9731
  9732     GO TO 3800-BUILD-NEW-CLAIM.
  9733
  9734 3690-EXIT.
  9735      EXIT.
  9736
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 187
* EL130.cbl
  9738 3700-BUILD-CERT.
  9739
  9740     IF CERTMTI NOT = 'A'
  9741         GO TO 3700-FINISH-CERT-BUILD
  9742     END-IF.
  9743
  9744     IF CERTMTI = 'A'
  9745         IF LCVCDL = ZEROS
  9746             MOVE ZEROS          TO CM-LF-BENEFIT-CD
  9747                                    CM-LF-ORIG-TERM
  9748                                    CM-LF-BENEFIT-AMT
  9749                                    CM-LF-PREMIUM-RATE
  9750             GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9751         END-IF
  9752     END-IF.
  9753
  9754     IF LCVCDL GREATER ZERO
  9755         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
  9756     END-IF.
  9757
  9758     IF LCVOTRML GREATER ZERO
  9759         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
  9760     END-IF.
  9761
  9762     IF LCVBENEL GREATER ZERO
  9763         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
  9764     END-IF.
  9765
  9766     IF LCVRATEL GREATER ZERO
  9767         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
  9768     END-IF.
  9769
  9770     IF WS-EXPIRE NOT = LOW-VALUES
  9771         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
  9772     END-IF.
  9773
  9774     IF LCVFORML GREATER ZERO
  9775         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
  9776     END-IF.
  9777
  9778     IF LCVCNDTL = ZERO
  9779        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9780     END-IF.
  9781
  9782     IF WS-LCVCNDT NOT = LOW-VALUES
  9783        MOVE '8'                 TO CM-LF-CURRENT-STATUS
  9784        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
  9785        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9786     END-IF.
  9787
  9788     IF CM-LF-CURRENT-STATUS = '7'
  9789        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
  9790        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
  9791        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
  9792                                    CM-LF-DEATH-DT
  9793        GO TO 3700-BUILD-AH-COVERAGE-SIDE
  9794     END-IF.
  9795
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 188
* EL130.cbl
  9796     IF CM-LF-CURRENT-STATUS = '8'
  9797        MOVE '1'                 TO CM-LF-CURRENT-STATUS
  9798        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
  9799     END-IF.
  9800
  9801 3700-BUILD-AH-COVERAGE-SIDE.
  9802
  9803     IF CERTMTI = 'A'
  9804         IF ACVCDL = ZEROS
  9805             MOVE ZEROS          TO CM-AH-BENEFIT-CD
  9806                                    CM-AH-ORIG-TERM
  9807                                    CM-AH-BENEFIT-AMT
  9808                                    CM-AH-PREMIUM-RATE
  9809             GO TO 3700-COVERAGE-BUILT
  9810         END-IF
  9811     END-IF.
  9812
  9813     IF ACVCDL GREATER ZERO
  9814         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
  9815     END-IF.
  9816
  9817     IF ACVOTRML GREATER ZERO
  9818         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
  9819     END-IF.
  9820
  9821     IF ACVBENEL GREATER ZERO
  9822         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
  9823     END-IF.
  9824
  9825     IF ACVRATEL GREATER ZERO
  9826         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
  9827     END-IF.
  9828
  9829     IF WS-EXPIRE NOT = LOW-VALUES
  9830         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
  9831     END-IF.
  9832
  9833     IF ACVFORML GREATER ZERO
  9834         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
  9835     END-IF.
  9836
  9837     IF ACVCNDTL = ZERO
  9838        GO TO 3700-COVERAGE-BUILT
  9839     END-IF.
  9840
  9841     IF WS-ACVCNDT NOT = LOW-VALUES
  9842        MOVE '8'                 TO CM-AH-CURRENT-STATUS
  9843        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
  9844        GO TO 3700-COVERAGE-BUILT
  9845     END-IF.
  9846
  9847     IF CM-AH-CURRENT-STATUS = '6'
  9848        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
  9849        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
  9850        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
  9851        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
  9852        GO TO 3700-COVERAGE-BUILT
  9853     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 189
* EL130.cbl
  9854
  9855     IF CM-AH-CURRENT-STATUS = '8'
  9856        MOVE '1'                 TO CM-AH-CURRENT-STATUS
  9857        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
  9858     END-IF.
  9859
  9860 3700-COVERAGE-BUILT.
  9861     IF ISSAGEL GREATER ZERO
  9862         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
  9863     END-IF.
  9864
  9865     IF JNTAGEL GREATER ZERO
  9866         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
  9867     END-IF.
  9868
  9869     IF SEXL GREATER ZERO
  9870         MOVE SEXI               TO CM-INSURED-SEX
  9871     END-IF.
  9872
  9873     IF APRL GREATER ZERO
  9874         MOVE WS-APR             TO CM-LOAN-APR
  9875     END-IF.
  9876
  9877     IF PMTFREQL GREATER ZERO
  9878         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
  9879     END-IF.
  9880
  9881     IF INDGRPL GREATER ZERO
  9882         MOVE INDGRPI            TO CM-IND-GRP-TYPE
  9883     END-IF.
  9884
  9885     IF CERTMTI = 'A'
  9886         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9887     END-IF.
  9888
  9889     IF REINCDL GREATER ZERO
  9890         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
  9891                                    WS-REIN-1
  9892                                    WS-REIN-2
  9893                                    WS-REIN-3
  9894         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
  9895     END-IF.
  9896
  9897     IF WS-ADD-ON-DT NOT = LOW-VALUES
  9898         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
  9899     END-IF.
  9900
  9901     IF CRTSSNL GREATER ZERO
  9902         MOVE CRTSSNI            TO CM-SOC-SEC-NO
  9903     ELSE
  9904         IF SSNL GREATER ZERO
  9905             MOVE SSNI           TO CM-SOC-SEC-NO
  9906         END-IF
  9907     END-IF.
  9908
  9909     IF CRTSSNL = ZERO AND
  9910        SSNL    = ZERO
  9911         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 190
* EL130.cbl
  9912         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
  9913         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
  9914         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
  9915     END-IF.
  9916
  9917     IF CM-LF-CURRENT-STATUS = SPACES
  9918         MOVE '1'                TO CM-LF-CURRENT-STATUS
  9919     END-IF.
  9920
  9921     IF CM-AH-CURRENT-STATUS = SPACES
  9922         MOVE '1'                TO CM-AH-CURRENT-STATUS
  9923     END-IF.
  9924
  9925     IF CERTMTI = 'A'
  9926         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
  9927     END-IF.
  9928
  9929 3700-FINISH-CERT-BUILD.
  9930
  9931     IF LOANNOL GREATER ZERO
  9932         MOVE LOANNOI            TO CM-LOAN-NUMBER
  9933     END-IF.
  9934
  9935     IF LOANBALL GREATER ZERO
  9936         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
  9937     END-IF.
  9938
  9939     IF PREMTYPL GREATER ZERO
  9940         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
  9941     END-IF.
  9942
  9943 3700-EXIT.
  9944      EXIT.
  9945
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 191
* EL130.cbl
  9947 3800-BUILD-NEW-CLAIM.
  9948
  9949*************************************************************
  9950*****           START OF ACTIVITY FILE PROCESSING          **
  9951*************************************************************
  9952     IF PI-COMPANY-ID EQUAL 'CID'
  9953         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
  9954                 6700-EXIT
  9955     END-IF.
  9956*************************************************************
  9957*****            END OF ACTIVITY FILE PROCESSING           **
  9958*************************************************************
  9959
  9960
  9961
  9962
  9963* EXEC CICS GETMAIN
  9964*        SET     (ADDRESS OF CLAIM-MASTER)
  9965*        LENGTH  (ELMSTR-LENGTH)
  9966*    END-EXEC.
  9967*    MOVE '," L                  $   #00009245' TO DFHEIV0
  9968     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9969     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9970     MOVE X'2020233030303039323435' TO DFHEIV0(25:11)
  9971     CALL 'kxdfhei1' USING DFHEIV0,
  9972           DFHEIV20,
  9973           ELMSTR-LENGTH,
  9974           DFHEIV99
  9975     SET ADDRESS OF CLAIM-MASTER TO
  9976         DFHEIV20
  9977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9978
  9979
  9980     MOVE SPACES TO CLAIM-MASTER.
  9981
  9982     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
  9983         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
  9984         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
  9985         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
  9986         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
  9987         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
  9988         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
  9989         CL-ACTIVITY-MAINT-DT.
  9990
  9991     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
  9992             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
  9993             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
  9994             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
  9995             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
  9996             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
  9997             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
  9998             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
  9999             CL-FORCEABLE-ERROR-CNT.
 10000
 10001     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10002
 10003     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10004                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 192
* EL130.cbl
 10005                                    CL-LAG-REPORT-CODE.
 10006
 10007     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10008     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10009
 10010     IF BENECDL NOT = ZEROS
 10011        MOVE BENECDI             TO CL-BENEFICIARY
 10012     END-IF.
 10013
 10014     MOVE 'CL'                   TO CL-RECORD-ID.
 10015     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10016
 10017     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10018                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10019                             CL-COMPANY-CD-A5.
 10020
 10021     MOVE CLMCARRI               TO CL-CARRIER.
 10022
 10023     IF CLMNOL = ZERO
 10024         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10025     ELSE
 10026         MOVE CLMNOI             TO CL-CLAIM-NO
 10027     END-IF.
 10028
 10029     MOVE CERTNOI                TO CL-CERT-PRIME
 10030                                    CL-CERT-A4-PRIME.
 10031
 10032     MOVE SUFXI                  TO CL-CERT-SFX
 10033                                    CL-CERT-A4-SFX.
 10034
 10035     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10036
 10037     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10038
 10039     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10040
 10041     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10042
 10043     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10044     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10045
 10046     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10047
 10048     IF CERTMTI = 'A'
 10049         MOVE '2'                TO CL-CERT-ORIGIN
 10050     ELSE
 10051         MOVE '1'                TO CL-CERT-ORIGIN
 10052     END-IF.
 10053
 10054     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10055     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10056     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10057     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10058     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10059
 10060 3820-REWRITE-CONTROL-FILE.
 10061
 10062     IF CLMNOL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 193
* EL130.cbl
 10063         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10064     END-IF.
 10065
 10066     IF CF-RECORD-TYPE = '6'
 10067         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10068     ELSE
 10069         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10070     END-IF.
 10071
 10072
 10073
 10074* EXEC CICS REWRITE
 10075*        DATASET   (ELCNTL-DSID)
 10076*        FROM      (CONTROL-FILE)
 10077*    END-EXEC.
 10078     MOVE LENGTH OF
 10079      CONTROL-FILE
 10080       TO DFHEIV11
 10081*    MOVE '&& L                  %   #00009343' TO DFHEIV0
 10082     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10083     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10084     MOVE X'2020233030303039333433' TO DFHEIV0(25:11)
 10085     CALL 'kxdfhei1' USING DFHEIV0,
 10086           ELCNTL-DSID,
 10087           CONTROL-FILE,
 10088           DFHEIV11,
 10089           DFHEIV99
 10090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10091
 10092
 10093 3830-SEQUENCE-CLAIM-RECORDS.
 10094
 10095     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10096     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10097     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10098
 10099     IF WS-ASSOC-CERT-TOTAL = ZERO
 10100         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10101                                    CL-ASSOC-CERT-TOTAL
 10102         GO TO 3840-WRITE-CLAIM-MASTER
 10103     END-IF.
 10104
 10105     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10106         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10107     ELSE
 10108         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10109     END-IF.
 10110
 10111     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10112     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10113     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10114
 10115 3840-WRITE-CLAIM-MASTER.
 10116
 10117     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
 10118     IF WS-REC-FOUND-SW = 'Y'
 10119         MOVE 01                 TO  CL-ACTIVITY-CODE
 10120         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 194
* EL130.cbl
 10121         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10122     END-IF.
 10123
 10124
 10125
 10126* EXEC CICS HANDLE CONDITION
 10127*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10128*    END-EXEC.
 10129*    MOVE '"$$                   ! : #00009380' TO DFHEIV0
 10130     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10132     MOVE X'3A20233030303039333830' TO DFHEIV0(25:11)
 10133     CALL 'kxdfhei1' USING DFHEIV0
 10134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10135
 10136
 10137** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10138     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10139
 10140
 10141
 10142* EXEC CICS WRITE
 10143*        DATASET   (ELMSTR-DSID)
 10144*        FROM      (CLAIM-MASTER)
 10145*        RIDFLD    (CL-CONTROL-PRIMARY)
 10146*    END-EXEC.
 10147     MOVE LENGTH OF
 10148      CLAIM-MASTER
 10149       TO DFHEIV11
 10150*    MOVE '&$ L                  ''   #00009388' TO DFHEIV0
 10151     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10152     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10153     MOVE X'2020233030303039333838' TO DFHEIV0(25:11)
 10154     CALL 'kxdfhei1' USING DFHEIV0,
 10155           ELMSTR-DSID,
 10156           CLAIM-MASTER,
 10157           DFHEIV11,
 10158           CL-CONTROL-PRIMARY,
 10159           DFHEIV99,
 10160           DFHEIV99
 10161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10162
 10163
 10164 3850-CLAIM-MSTR-WRITTEN.
 10165
 10166     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10167         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10168     END-IF.
 10169
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 195
* EL130.cbl
 10171 3990-ADD-DONE.
 10172     MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10173                                   EMI-SUB      EMI-SWITCH-AREA-2.
 10174     MOVE SPACES                TO EMI-ACTION-SWITCH
 10175                                   EMI-ERROR-LINES.
 10176
 10177     IF CLMNOL = ZERO
 10178         MOVE ER-0265            TO EMI-ERROR
 10179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10180         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (1)
 10181                                    PI-LAST-CLAIM
 10182     ELSE
 10183         MOVE CLMNOI             TO PI-LAST-CLAIM
 10184         MOVE ER-0000            TO EMI-ERROR
 10185         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10186     END-IF.
 10187
 10188     IF WS-NO-INSURED-ADDRESS = 'Y'
 10189         MOVE ER-3548            TO EMI-ERROR
 10190         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10191     END-IF.
 10192
 10193     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10194     MOVE CLMCARRI                   TO  PI-CARRIER.
 10195     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10196     MOVE SUFXI                      TO  PI-CERT-SFX.
 10197
 10198     IF WS-LETTER-SW = 'Y'
 10199         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10200         IF W-1523-ERROR-CODE NOT = ZEROS
 10201             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10202             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10203         END-IF
 10204     END-IF.
 10205
 10206     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10207     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10208     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10209     MOVE CLMCARRI               TO PI-LAST-CARR.
 10210
 10211     IF PRTOPTL GREATER THAN 0
 10212         MOVE PRTOPTI            TO PI-PRT-OPT
 10213     END-IF.
 10214     IF ALTPRTL GREATER THAN 0
 10215         MOVE ALTPRTI            TO PI-ALT-PRT
 10216     END-IF.
 10217
 10218     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10219         MOVE LOW-VALUES         TO EL130AI
 10220         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10221         MOVE AL-SANON           TO CERTNOA
 10222         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10223         MOVE AL-SANON           TO SUFXA
 10224         MOVE PI-LAST-CARR       TO CLMCARRO
 10225         MOVE AL-UANON           TO CLMCARRA
 10226         MOVE PI-LAST-CLAIM      TO CLMNOO
 10227         MOVE AL-UANON           TO CLMNOA
 10228         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 196
* EL130.cbl
 10229         MOVE AL-UANON           TO CLMTYPEA
 10230     ELSE
 10231         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10232         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10233     END-IF.
 10234
 10235     IF PI-PRT-OPT = 'N' OR 'L'
 10236         MOVE PI-PRT-OPT         TO PRTOPTO
 10237         MOVE 1                  TO PRTOPTL
 10238     END-IF.
 10239
 10240     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10241         MOVE PI-ALT-PRT         TO ALTPRTO
 10242         MOVE 4                  TO ALTPRTL
 10243     END-IF.
 10244
 10245     IF PRTOPTL GREATER THAN 0
 10246         IF PRTOPTI = 'L'
 10247             GO TO 0400-CREATE-ELACTQ
 10248         ELSE
 10249             GO TO 0480-PRINT-NOW
 10250         END-IF
 10251     END-IF.
 10252
 10253     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10254         GO TO 8100-SEND-INITIAL-MAP
 10255     ELSE
 10256         MOVE LOW-VALUES         TO MAINTO
 10257         MOVE -1                 TO MAINTL
 10258         GO TO 8200-SEND-DATAONLY
 10259     END-IF.
 10260
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 197
* EL130.cbl
 10262 3993-MODIFY-SCREEN-ATTRB.
 10263
 10264     IF CERTMTL GREATER ZERO
 10265         MOVE AL-UANON           TO CERTMTA
 10266     END-IF.
 10267
 10268     IF EFFDTL GREATER ZERO
 10269         MOVE AL-UANON           TO EFFDTA
 10270     END-IF.
 10271
 10272     IF ACCOUNTL GREATER ZERO
 10273         MOVE AL-UANON           TO ACCOUNTA
 10274     END-IF.
 10275
 10276     IF STATEL GREATER ZERO
 10277         MOVE AL-UANON           TO STATEA
 10278     END-IF.
 10279
 10280     IF CRTCARRL GREATER ZERO
 10281         MOVE AL-UANON           TO CRTCARRA
 10282     END-IF.
 10283
 10284     IF GROUPL GREATER ZERO
 10285         MOVE AL-UANON           TO GROUPA
 10286     END-IF.
 10287
 10288     IF CRTLNMEL GREATER ZERO
 10289         MOVE AL-UANON           TO CRTLNMEA
 10290     END-IF.
 10291
 10292     IF CRTFNMEL GREATER ZERO
 10293         MOVE AL-UANON           TO CRTFNMEA
 10294     END-IF.
 10295
 10296     IF CRTINITL GREATER ZERO
 10297         MOVE AL-UANON           TO CRTINITA
 10298     END-IF.
 10299
 10300     IF ISSAGEL GREATER ZERO
 10301         MOVE AL-UNNON           TO ISSAGEA
 10302     END-IF.
 10303
 10304     IF JNTLNMEL GREATER ZERO
 10305         MOVE AL-UANON           TO JNTLNMEA
 10306     END-IF.
 10307
 10308     IF JNTFNMEL GREATER ZERO
 10309         MOVE AL-UANON           TO JNTFNMEA
 10310     END-IF.
 10311
 10312     IF JNTINITL GREATER ZERO
 10313         MOVE AL-UANON           TO JNTINITA
 10314     END-IF.
 10315
 10316     IF JNTAGEL GREATER ZERO
 10317         MOVE AL-UNNON           TO JNTAGEA
 10318     END-IF.
 10319
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 198
* EL130.cbl
 10320     IF CRTSSNL GREATER ZERO
 10321         MOVE AL-UANON           TO CRTSSNA
 10322     END-IF.
 10323
 10324     IF ACVDSCRL GREATER ZERO
 10325         MOVE AL-SANON           TO ACVDSCRA
 10326     END-IF.
 10327
 10328     IF ACVKINDL GREATER ZERO
 10329         MOVE AL-SANON           TO ACVKINDA
 10330     END-IF.
 10331
 10332     IF ACVCDL GREATER ZERO
 10333         MOVE AL-UANON           TO ACVCDA
 10334     END-IF.
 10335
 10336     IF ACVOTRML GREATER ZERO
 10337         MOVE AL-UNNON           TO ACVOTRMA
 10338     END-IF.
 10339
 10340     IF ACVRTRML GREATER ZERO
 10341         MOVE AL-UNNON           TO ACVRTRMA
 10342     END-IF.
 10343
 10344     IF ACVRATEL GREATER ZERO
 10345         MOVE AL-UNNON           TO ACVRATEA
 10346     END-IF.
 10347
 10348     IF ACVBENEL GREATER ZERO
 10349         MOVE AL-UNNON           TO ACVBENEA
 10350     END-IF.
 10351
 10352     IF ACVFORML GREATER ZERO
 10353         MOVE AL-UANON           TO ACVFORMA
 10354     END-IF.
 10355
 10356     IF ACVCNDTL GREATER ZERO
 10357         MOVE AL-UANON           TO ACVCNDTA
 10358     END-IF.
 10359
 10360     IF ACVEXITL GREATER ZERO
 10361         MOVE AL-UANON           TO ACVEXITA
 10362     END-IF.
 10363
 10364     IF ACVSTATL GREATER ZERO
 10365         MOVE AL-UANON           TO ACVSTATA
 10366     END-IF.
 10367
 10368     IF LCVDSCRL GREATER ZERO
 10369         MOVE AL-SANON           TO LCVDSCRA
 10370     END-IF.
 10371
 10372     IF LCVKINDL GREATER ZERO
 10373         MOVE AL-SANON           TO LCVKINDA
 10374     END-IF.
 10375
 10376     IF LCVCDL GREATER ZERO
 10377         MOVE AL-UANON           TO LCVCDA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 199
* EL130.cbl
 10378     END-IF.
 10379
 10380     IF LCVOTRML GREATER ZERO
 10381         MOVE AL-UNNON           TO LCVOTRMA
 10382     END-IF.
 10383
 10384     IF LCVRTRML GREATER ZERO
 10385         MOVE AL-UNNON           TO LCVRTRMA
 10386     END-IF.
 10387
 10388     IF LCVRATEL GREATER ZERO
 10389         MOVE AL-UNNON           TO LCVRATEA
 10390     END-IF.
 10391
 10392     IF LCVBENEL GREATER ZERO
 10393         MOVE AL-UNNON           TO LCVBENEA
 10394     END-IF.
 10395
 10396     IF LCVFORML GREATER ZERO
 10397         MOVE AL-UANON           TO LCVFORMA
 10398     END-IF.
 10399
 10400     IF LCVCNDTL GREATER ZERO
 10401         MOVE AL-UANON           TO LCVCNDTA
 10402     END-IF.
 10403
 10404     IF LCVEXITL GREATER ZERO
 10405         MOVE AL-UANON           TO LCVEXITA
 10406     END-IF.
 10407
 10408     IF LCVSTATL GREATER ZERO
 10409         MOVE AL-UANON           TO LCVSTATA
 10410     END-IF.
 10411
 10412     IF MEMCAPL GREATER ZERO
 10413         MOVE AL-UANON           TO MEMCAPA
 10414     END-IF.
 10415
 10416     IF APRL GREATER ZERO
 10417         MOVE AL-UNNON           TO APRA
 10418     END-IF.
 10419
 10420     IF PMTFREQL GREATER ZERO
 10421         MOVE AL-UNNON           TO PMTFREQA
 10422     END-IF.
 10423
 10424     IF INDGRPL GREATER ZERO
 10425         MOVE AL-UANON           TO INDGRPA
 10426     END-IF.
 10427
 10428     IF PREMTYPL GREATER ZERO
 10429         MOVE AL-UANON           TO PREMTYPA
 10430     END-IF.
 10431
 10432     IF REINCDL GREATER ZERO
 10433         MOVE AL-UANON           TO REINCDA
 10434     END-IF.
 10435
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 200
* EL130.cbl
 10436     IF ADDONDTL GREATER ZERO
 10437         MOVE AL-UANON           TO ADDONDTA
 10438     END-IF.
 10439
 10440     IF MEMBERL GREATER ZERO
 10441         MOVE AL-UANON           TO MEMBERA
 10442     END-IF.
 10443
 10444     IF BCERT1L GREATER ZERO
 10445         MOVE AL-SANON           TO BCERT1A
 10446                                    BSUFX1A
 10447     END-IF.
 10448
 10449     IF BCERT2L GREATER ZERO
 10450         MOVE AL-SANON           TO BCERT2A
 10451                                    BSUFX2A
 10452     END-IF.
 10453
 10454     IF BCERT3L GREATER ZERO
 10455         MOVE AL-SANON           TO BCERT3A
 10456                                    BSUFX3A
 10457     END-IF.
 10458
 10459     IF BCERT4L GREATER ZERO
 10460         MOVE AL-SANON           TO BCERT4A
 10461                                    BSUFX4A
 10462     END-IF.
 10463
 10464     IF BCERT5L GREATER ZERO
 10465         MOVE AL-SANON           TO BCERT5A
 10466                                    BSUFX5A
 10467     END-IF.
 10468
 10469 3993-MODIFY-CLAIM-ATTRB.
 10470
 10471     IF PCERTNOL GREATER ZERO
 10472         MOVE AL-UANON           TO PCERTNOA
 10473     END-IF.
 10474
 10475     IF PSUFXL GREATER ZERO
 10476         MOVE AL-UANON           TO PSUFXA
 10477     END-IF.
 10478
 10479     IF LSTNMEL GREATER ZERO
 10480         MOVE AL-UANON           TO LSTNMEA
 10481     END-IF.
 10482
 10483     IF FSTNMEL GREATER ZERO
 10484         MOVE AL-UANON           TO FSTNMEA
 10485     END-IF.
 10486
 10487     IF INITL GREATER ZERO
 10488         MOVE AL-UANON           TO INITA
 10489     END-IF.
 10490
 10491     IF SEXL GREATER ZERO
 10492         MOVE AL-UANON           TO SEXA
 10493     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 201
* EL130.cbl
 10494
 10495     IF OCCCDL GREATER ZERO
 10496         MOVE AL-UANON           TO OCCCDA
 10497     END-IF.
 10498
 10499     IF BIRTHDTL GREATER ZERO
 10500         MOVE AL-UANON           TO BIRTHDTA
 10501     END-IF.
 10502
 10503     IF SSNL GREATER ZERO
 10504         MOVE AL-UANON           TO SSNA
 10505     END-IF.
 10506
 10507     IF INCURL GREATER ZERO
 10508         MOVE AL-UANON           TO INCURA
 10509     END-IF.
 10510
 10511     IF REPORTL GREATER ZERO
 10512         MOVE AL-UANON           TO REPORTA
 10513     END-IF.
 10514
 10515     IF ESTENDL GREATER ZERO
 10516         MOVE AL-UANON           TO ESTENDA
 10517     END-IF.
 10518
 10519     IF DIAGL GREATER ZERO
 10520         MOVE AL-UANON           TO DIAGA
 10521     END-IF.
 10522
 10523     IF CAUSEL GREATER ZERO
 10524         MOVE AL-UANON           TO CAUSEA
 10525     END-IF.
 10526
 10527     IF MANRSVL GREATER ZERO
 10528         MOVE AL-UNNON           TO MANRSVA
 10529     END-IF.
 10530
 10531     IF RELCLML GREATER ZERO
 10532         MOVE AL-UANON           TO RELCLMA
 10533     END-IF.
 10534
 10535     IF LOANNOL GREATER ZERO
 10536         MOVE AL-UANON           TO LOANNOA
 10537     END-IF.
 10538
 10539     IF LOANBALL GREATER ZERO
 10540         MOVE AL-UNNON           TO LOANBALA
 10541     END-IF.
 10542
 10543     IF PROCCDL GREATER ZERO
 10544         MOVE AL-UANON           TO PROCCDA
 10545     END-IF.
 10546
 10547     IF BENECDL GREATER THAN ZERO
 10548         MOVE AL-UANON           TO  BENECDA
 10549     END-IF.
 10550
 10551     IF PRICDL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 202
* EL130.cbl
 10552         MOVE AL-UANON           TO PRICDA
 10553     END-IF.
 10554
 10555     IF SUPVL GREATER ZERO
 10556         MOVE AL-UANON           TO SUPVA
 10557     END-IF.
 10558
 10559     IF FILETOL GREATER ZERO
 10560         MOVE AL-UANON           TO FILETOA
 10561     END-IF.
 10562
 10563
 10564 3993-MODIFY-CLAIM-KEY-ATTRB.
 10565
 10566     IF CLMNOL GREATER ZERO
 10567         MOVE AL-UANON           TO CLMNOA
 10568     END-IF.
 10569
 10570     IF CLMCARRL GREATER ZERO
 10571         MOVE AL-UANON           TO CLMCARRA
 10572     END-IF.
 10573
 10574     IF CLMTYPEL GREATER ZERO
 10575         MOVE AL-UANON           TO CLMTYPEA
 10576     END-IF.
 10577
 10578     IF CERTNOL GREATER ZERO
 10579         MOVE AL-SANON           TO CERTNOA
 10580     END-IF.
 10581
 10582     IF SUFXL GREATER ZERO
 10583         MOVE AL-SANON           TO SUFXA
 10584     END-IF.
 10585
 10586 3993-EXIT.
 10587     EXIT.
 10588
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 203
* EL130.cbl
 10590 3995-BUILD-CLAIM-RECORD.
 10591
 10592     IF PROCCDL GREATER ZERO
 10593         MOVE PROCCDI            TO CL-PROCESSOR-ID
 10594     ELSE
 10595         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 10596     END-IF.
 10597
 10598     IF FSTNMEL GREATER ZERO
 10599         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 10600     END-IF.
 10601
 10602     IF INITL GREATER ZERO
 10603         MOVE INITI              TO CL-INSURED-MID-INIT
 10604     END-IF.
 10605
 10606     IF BIRTHDTL GREATER ZERO
 10607         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 10608     END-IF.
 10609
 10610     IF SEXL GREATER ZERO
 10611         MOVE SEXI               TO CL-INSURED-SEX-CD
 10612     END-IF.
 10613
 10614     IF OCCCDL GREATER ZERO
 10615         MOVE OCCCDI             TO CL-INSURED-OCC-CD
 10616     END-IF.
 10617
 10618     MOVE 'O'                    TO CL-CLAIM-STATUS.
 10619
 10620*    IF CLMTYPEL GREATER ZERO
 10621     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 10622*    END-IF.
 10623
 10624     IF PREMTYPL GREATER ZERO
 10625         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 10626     END-IF.
 10627
 10628     IF INCURL GREATER ZERO
 10629         MOVE WS-INCUR           TO CL-INCURRED-DT
 10630     END-IF.
 10631
 10632     IF REPORTL GREATER ZERO
 10633         MOVE WS-REPORT          TO CL-REPORTED-DT
 10634     END-IF.
 10635
 10636     IF EIBAID = DFHPF6
 10637         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
 10638             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 10639                 IF EMI-FORCABLE-CTR = +1
 10640                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 10641                 END-IF
 10642         END-IF
 10643     END-IF.
 10644
 10645     IF ESTENDL GREATER ZERO
 10646        MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 10647     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 204
* EL130.cbl
 10648
 10649     IF ADDONDTL GREATER ZERO
 10650         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 10651     END-IF.
 10652
 10653     IF CAUSEL GREATER ZERO
 10654         MOVE CAUSEI             TO CL-CAUSE-CD
 10655     END-IF.
 10656
 10657     IF SSNL GREATER ZERO
 10658         MOVE SSNI               TO CL-SOC-SEC-NO
 10659     ELSE
 10660         MOVE CERT-STATE         TO CL-SSN-STATE
 10661         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 10662         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 10663     END-IF.
 10664
 10665     IF PRICDL GREATER ZERO
 10666         MOVE PRICDI             TO CL-PRIORITY-CD
 10667     END-IF.
 10668
 10669     IF SUPVL GREATER ZERO
 10670         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 10671     END-IF.
 10672
 10673     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 10674     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 10675     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 10676
 10677     IF RELCLML GREATER ZERO
 10678         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 10679     END-IF.
 10680
 10681     IF FILETOL GREATER ZERO
 10682         MOVE FILETOI            TO CL-FILE-LOCATION
 10683     END-IF.
 10684
 10685 3995-EXIT.
 10686      EXIT.
 10687
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 205
* EL130.cbl
 10689 4000-CALCULATE-CERT-TERM.
 10690
 10691     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 10692
 10693     MOVE N                      TO WS-TERM.
 10694
 10695     IF WS-TERM GREATER 120
 10696         MOVE 120                TO WS-TERM
 10697     END-IF.
 10698
 10699 4000-CALC-TERM-EXIT.
 10700      EXIT.
 10701
 10702 4100-CALC-GROSS-TERM.
 10703     MOVE HOLD-LOAN-BAL           TO L.
 10704     MOVE WS-ACVBENE              TO M.
 10705     COMPUTE N = L / M.
 10706     IF N LESS 1
 10707         MOVE 1  TO N
 10708     END-IF.
 10709
 10710     IF LCVCDL GREATER ZERO
 10711         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 10712     ELSE
 10713         MOVE ZEROS               TO WS-LF-RATE
 10714     END-IF.
 10715
 10716     IF ACVCDL GREATER ZERO
 10717         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 10718     ELSE
 10719         MOVE ZEROS               TO WS-AH-RATE
 10720     END-IF.
 10721
 10722     COMPUTE I = WS-APR / +1200.
 10723
 10724 4105-LOOP.
 10725     IF N GREATER 240
 10726         GO TO 4200-EXIT
 10727     END-IF.
 10728
 10729     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 10730
 10731     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 10732         ADD 1 TO N
 10733         GO TO 4105-LOOP
 10734     END-IF.
 10735
 10736 4200-EXIT.
 10737      EXIT.
 10738
 10739 4210-CALC-LEFT-RIGHTONE.
 10740      MOVE L         TO LEFT-TOT-1.
 10741      SUBTRACT 1 FROM N.
 10742      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10743      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 10744      ADD 1 TO N.
 10745
 10746 4211-CALC-TERM1.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 206
* EL130.cbl
 10747      MOVE N         TO TERM1.
 10748      MULTIPLY M BY TERM1.
 10749
 10750 4212-LOOP.
 10751      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 10752      ADD 1 TO A-N.
 10753      MULTIPLY A-N BY TERM1.
 10754      SUBTRACT 1 FROM A-N.
 10755      ADD TERM1 TO LEFT-TOT-1.
 10756
 10757 4213-CALC-TERM2.
 10758      MOVE M         TO TERM2.
 10759      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 10760      MULTIPLY IA-N BY TERM2.
 10761      SUBTRACT TERM2 FROM LEFT-TOT-1.
 10762
 10763 4215-CALC-RIGHTONE.
 10764      MOVE M         TO RIGHT-TOT-1.
 10765      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 10766      MULTIPLY A-N BY RIGHT-TOT-1.
 10767
 10768 4220-EXIT.
 10769      EXIT.
 10770
 10771 4300-CALC-A-N.
 10772     IF N LESS 1
 10773         MOVE 0     TO A-N
 10774         GO TO 4300-EXIT
 10775     END-IF.
 10776
 10777     IF I = 0
 10778         MOVE .00001 TO I
 10779     END-IF.
 10780
 10781     ADD 1 TO I.
 10782     DIVIDE I INTO 1 GIVING V.
 10783     SUBTRACT 1 FROM I.
 10784     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 10785     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 10786     DIVIDE I INTO TERM3 GIVING A-N.
 10787
 10788 4300-EXIT.
 10789      EXIT.
 10790
 10791 4350-CALC-IA-N.
 10792     IF N LESS 1
 10793         MOVE 0      TO IA-N
 10794         GO TO 4400-EXIT
 10795     END-IF.
 10796
 10797     ADD 1 TO N.
 10798     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 10799     SUBTRACT 1 FROM N.
 10800     MULTIPLY N BY V-EX-N GIVING TERM3.
 10801     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 10802     SUBTRACT V FROM 1 GIVING TERM4.
 10803     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 10804
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 207
* EL130.cbl
 10805 4400-EXIT.
 10806      EXIT.
 10807
 10808 4450-CALC-V-EX-N.
 10809     IF N LESS 1
 10810         MOVE 1    TO V-EX-N
 10811         GO TO 4490-EXIT
 10812     END-IF.
 10813
 10814     MOVE N        TO NV-STORE.
 10815
 10816     IF V-EX-ONETIME = 1  OR
 10817        V NOT = V-EXPONENT (1)
 10818          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 10819     END-IF.
 10820
 10821 4460-LOOP.
 10822     IF N GREATER 248
 10823         MOVE 248 TO N
 10824     END-IF.
 10825
 10826     IF N = 1
 10827         MOVE V               TO V-EX-N
 10828     ELSE
 10829         MOVE V-EXPONENT (N)  TO V-EX-N
 10830     END-IF.
 10831
 10832     GO TO 4490-EXIT.
 10833
 10834 4470-BUILD-V-EX-TABLE.
 10835     MOVE 2      TO N.
 10836     MOVE V      TO V-EXPONENT (1)
 10837                    V-EX-N.
 10838
 10839 4471-LOOP.
 10840     MULTIPLY V BY V-EX-N.
 10841     MOVE V-EX-N   TO V-EXPONENT (N).
 10842
 10843     ADD 1 TO N.
 10844     IF N LESS 248
 10845         GO TO 4471-LOOP
 10846     END-IF.
 10847
 10848     MOVE NV-STORE     TO N.
 10849     MOVE ZERO         TO V-EX-ONETIME.
 10850
 10851 4480-EXIT.
 10852      EXIT.
 10853
 10854 4490-EXIT.
 10855      EXIT.
 10856
 10857 4500-CALC-NET-TERM.
 10858     MOVE HOLD-LOAN-BAL           TO L.
 10859     MOVE WS-ACVBENE              TO M.
 10860     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 10861
 10862     IF WS-REMAIN GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 208
* EL130.cbl
 10863         ADD 1 TO N
 10864     END-IF.
 10865
 10866     IF N = 0
 10867         MOVE 1 TO N
 10868     END-IF.
 10869
 10870 4700-EXIT.
 10871      EXIT.
 10872
 10873 4999-CALC-TERM-EXIT.
 10874     EXIT.
 10875
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 209
* EL130.cbl
 10877 5000-INCURRED-CHANGE.
 10878     IF NOT MODIFY-CAP
 10879         MOVE ER-0070            TO EMI-ERROR
 10880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10881         MOVE -1                 TO MAINTL
 10882         GO TO 8200-SEND-DATAONLY
 10883     END-IF.
 10884
 10885     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 10886        CLMCARRI     NOT = PI-LAST-CARR        OR
 10887        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 10888        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 10889        PI-INCURR-SW NOT = 'Y'
 10890          GO TO 1000-SHOW-CLAIM
 10891     END-IF.
 10892
 10893     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 10894     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 10895     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 10896
 10897     IF EMI-NO-ERRORS
 10898         GO TO 5000-TRY-TO-BUILD
 10899     END-IF.
 10900
 10901     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 10902        MOVE ER-0433             TO EMI-ERROR
 10903        MOVE -1                  TO MAINTL
 10904        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10905        GO TO 8200-SEND-DATAONLY
 10906     END-IF.
 10907
 10908     IF EIBAID = DFHPF6
 10909         IF EMI-FATAL-CTR NOT EQUAL ZERO
 10910            MOVE ER-0434         TO EMI-ERROR
 10911            MOVE -1              TO MAINTL
 10912            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10913            GO TO 8200-SEND-DATAONLY
 10914         ELSE
 10915            MOVE +1              TO INCURL
 10916            GO TO 5000-TRY-TO-BUILD
 10917         END-IF
 10918     END-IF.
 10919
 10920     GO TO 8200-SEND-DATAONLY.
 10921
 10922 5000-TRY-TO-BUILD.
 10923
 10924     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 10925
 10926     MOVE CLMCARRI               TO MSTR-CARRIER.
 10927
 10928     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 10929     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 10930     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 10931
 10932     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 10933
 10934     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 210
* EL130.cbl
 10935         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 10936     END-IF.
 10937
 10938     IF CL-PURGED-DT NOT = LOW-VALUES
 10939
 10940
 10941* EXEC CICS UNLOCK
 10942*            DATASET   (ELMSTR-DSID)
 10943*        END-EXEC
 10944*    MOVE '&*                    #   #00010170' TO DFHEIV0
 10945     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10946     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10947     MOVE X'2020233030303130313730' TO DFHEIV0(25:11)
 10948     CALL 'kxdfhei1' USING DFHEIV0,
 10949           ELMSTR-DSID,
 10950           DFHEIV99
 10951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10952         MOVE ER-7691            TO EMI-ERROR
 10953         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10954         MOVE -1                 TO MAINTL
 10955         GO TO 8200-SEND-DATAONLY
 10956     END-IF.
 10957
 10958     IF CL-AUTO-PAY-SEQ NOT = ZERO
 10959
 10960
 10961* EXEC CICS UNLOCK
 10962*            DATASET   (ELMSTR-DSID)
 10963*       END-EXEC
 10964*    MOVE '&*                    #   #00010181' TO DFHEIV0
 10965     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10966     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10967     MOVE X'2020233030303130313831' TO DFHEIV0(25:11)
 10968     CALL 'kxdfhei1' USING DFHEIV0,
 10969           ELMSTR-DSID,
 10970           DFHEIV99
 10971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10972         MOVE ER-0523             TO EMI-ERROR
 10973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10974         MOVE -1                  TO MAINTL
 10975         GO TO 8200-SEND-DATAONLY
 10976     END-IF.
 10977
 10978     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 10979
 10980     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 10981     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 10982     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 10983     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 10984     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 10985
 10986     IF MANRSVL GREATER ZERO
 10987        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 10988                                    AT-CURRENT-MANUAL-RESERVE
 10989     END-IF.
 10990     MOVE 1                      TO SUB.
 10991
 10992 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 211
* EL130.cbl
 10993     IF SUB = 1
 10994        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 10995        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 10996        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 10997     ELSE
 10998        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 10999        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 11000                                    AT-OPEN-CLOSE-REASON (SUB)
 11001     END-IF.
 11002
 11003     IF SUB NOT = 6
 11004        ADD 1                    TO SUB
 11005        GO TO 5010-LOOP
 11006     END-IF.
 11007
 11008 5020-UPDATE.
 11009
 11010     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11011
 11012     IF DIAGL = ZERO
 11013         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 11014         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 11015         GO TO 5025-BYPASS-UPDATE
 11016     END-IF.
 11017
 11018     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 11019
 11020     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 11021     MOVE DIAGI                  TO AT-INFO-LINE-1.
 11022
 11023     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 11024
 11025 5025-BYPASS-UPDATE.
 11026
 11027
 11028
 11029* EXEC CICS GETMAIN
 11030*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11031*        LENGTH   (ELTRLR-LENGTH)
 11032*    END-EXEC.
 11033*    MOVE '," L                  $   #00010240' TO DFHEIV0
 11034     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11035     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11036     MOVE X'2020233030303130323430' TO DFHEIV0(25:11)
 11037     CALL 'kxdfhei1' USING DFHEIV0,
 11038           DFHEIV20,
 11039           ELTRLR-LENGTH,
 11040           DFHEIV99
 11041     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11042         DFHEIV20
 11043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11044
 11045
 11046     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11047     MOVE 'AT'                   TO AT-RECORD-ID.
 11048
 11049     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11050     MOVE MSTR-CARRIER           TO AT-CARRIER.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 212
* EL130.cbl
 11051     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11052     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 11053     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 11054     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 11055     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11056     MOVE '9'                    TO AT-TRAILER-TYPE.
 11057     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11058     MOVE '5'                    TO DC-OPTION-CODE.
 11059     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11060     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 11061
 11062     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 11063     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11064
 11065     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 11066     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 11067     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 11068     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 11069     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 11070     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 11071     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 11072     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 11073     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 11074     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 11075
 11076     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 11077     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 11078     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 11079     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 11080     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 11081
 11082
 11083
 11084* EXEC CICS WRITE
 11085*        DATASET   (ELTRLR-DSID)
 11086*        FROM      (ACTIVITY-TRAILERS)
 11087*        RIDFLD    (AT-CONTROL-PRIMARY)
 11088*    END-EXEC.
 11089     MOVE LENGTH OF
 11090      ACTIVITY-TRAILERS
 11091       TO DFHEIV11
 11092*    MOVE '&$ L                  ''   #00010282' TO DFHEIV0
 11093     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11094     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11095     MOVE X'2020233030303130323832' TO DFHEIV0(25:11)
 11096     CALL 'kxdfhei1' USING DFHEIV0,
 11097           ELTRLR-DSID,
 11098           ACTIVITY-TRAILERS,
 11099           DFHEIV11,
 11100           AT-CONTROL-PRIMARY,
 11101           DFHEIV99,
 11102           DFHEIV99
 11103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11104
 11105
 11106     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 11107     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 11108     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 213
* EL130.cbl
 11109     MOVE CL-CERT-STATE          TO CERT-STATE.
 11110     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 11111     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 11112     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 11113
 11114
 11115
 11116* EXEC CICS HANDLE CONDITION
 11117*        NOTFND   (5050-CERT-NOT-FOUND)
 11118*    END-EXEC.
 11119*    MOVE '"$I                   ! ; #00010297' TO DFHEIV0
 11120     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11121     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11122     MOVE X'3B20233030303130323937' TO DFHEIV0(25:11)
 11123     CALL 'kxdfhei1' USING DFHEIV0
 11124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11125
 11126
 11127     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 11128
 11129     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 11130
 11131
 11132
 11133* EXEC CICS HANDLE CONDITION
 11134*         DUPKEY   (5030-CERT-WRITTEN)
 11135*    END-EXEC.
 11136*    MOVE '"$$                   ! < #00010306' TO DFHEIV0
 11137     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11139     MOVE X'3C20233030303130333036' TO DFHEIV0(25:11)
 11140     CALL 'kxdfhei1' USING DFHEIV0
 11141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11142
 11143
 11144
 11145
 11146* EXEC CICS REWRITE
 11147*        DATASET  (ELCERT-DSID)
 11148*        FROM     (CERTIFICATE-MASTER)
 11149*    END-EXEC.
 11150     MOVE LENGTH OF
 11151      CERTIFICATE-MASTER
 11152       TO DFHEIV11
 11153*    MOVE '&& L                  %   #00010311' TO DFHEIV0
 11154     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11155     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11156     MOVE X'2020233030303130333131' TO DFHEIV0(25:11)
 11157     CALL 'kxdfhei1' USING DFHEIV0,
 11158           ELCERT-DSID,
 11159           CERTIFICATE-MASTER,
 11160           DFHEIV11,
 11161           DFHEIV99
 11162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11163
 11164
 11165 5030-CERT-WRITTEN.
 11166
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 214
* EL130.cbl
 11167     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 11168                                    CL-INCURRED-DT
 11169                                    CL-REPORTED-DT
 11170                                    CL-EST-END-OF-DISAB-DT
 11171                                    CL-PAID-THRU-DT.
 11172
 11173     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 11174                                    CL-NO-OF-PMTS-MADE
 11175                                    CL-NO-OF-DAYS-PAID.
 11176
 11177     IF CLAIM-IS-CLOSED
 11178        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 11179        MOVE 'O'                 TO CL-CLAIM-STATUS
 11180     END-IF.
 11181
 11182     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 11183     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 11184     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 11185
 11186
 11187
 11188* EXEC CICS HANDLE CONDITION
 11189*         DUPKEY   (5035-CLAIM-WRITTEN)
 11190*    END-EXEC.
 11191*    MOVE '"$$                   ! = #00010338' TO DFHEIV0
 11192     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 11193     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11194     MOVE X'3D20233030303130333338' TO DFHEIV0(25:11)
 11195     CALL 'kxdfhei1' USING DFHEIV0
 11196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11197
 11198
 11199
 11200
 11201* EXEC CICS REWRITE
 11202*        DATASET   (ELMSTR-DSID)
 11203*        FROM      (CLAIM-MASTER)
 11204*    END-EXEC.
 11205     MOVE LENGTH OF
 11206      CLAIM-MASTER
 11207       TO DFHEIV11
 11208*    MOVE '&& L                  %   #00010343' TO DFHEIV0
 11209     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11210     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11211     MOVE X'2020233030303130333433' TO DFHEIV0(25:11)
 11212     CALL 'kxdfhei1' USING DFHEIV0,
 11213           ELMSTR-DSID,
 11214           CLAIM-MASTER,
 11215           DFHEIV11,
 11216           DFHEIV99
 11217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11218
 11219
 11220 5035-CLAIM-WRITTEN.
 11221
 11222     MOVE ER-0000                TO EMI-ERROR.
 11223     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11224
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 215
* EL130.cbl
 11225     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 11226     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 11227     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 11228     MOVE CLMCARRI               TO PI-LAST-CARR.
 11229
 11230     IF PRTOPTL GREATER ZERO
 11231         MOVE PRTOPTI            TO PI-PRT-OPT
 11232     END-IF.
 11233
 11234     IF ALTPRTL GREATER ZERO
 11235         MOVE ALTPRTI            TO PI-ALT-PRT
 11236     END-IF.
 11237
 11238     MOVE LOW-VALUES             TO EL130AI.
 11239
 11240     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 11241     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 11242     MOVE PI-LAST-CARR           TO CLMCARRO.
 11243     MOVE PI-LAST-CLAIM          TO CLMNOO.
 11244
 11245     IF PI-PRT-OPT = 'N' OR 'L'
 11246         MOVE PI-PRT-OPT         TO PRTOPTO
 11247         MOVE 1                  TO PRTOPTL
 11248     END-IF.
 11249
 11250     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 11251         MOVE PI-ALT-PRT         TO ALTPRTO
 11252         MOVE 4                  TO ALTPRTL
 11253     END-IF.
 11254
 11255     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 11256     MOVE AL-SANON               TO CERTNOA SUFXA.
 11257
 11258     MOVE SPACES                 TO PI-INCURR-SW.
 11259
 11260     IF PRTOPTL GREATER ZERO
 11261         IF PRTOPTI = 'L'
 11262             GO TO 0400-CREATE-ELACTQ
 11263         ELSE
 11264             GO TO 0480-PRINT-NOW
 11265         END-IF
 11266     END-IF.
 11267
 11268     GO TO 8100-SEND-INITIAL-MAP.
 11269
 11270 5050-CERT-NOT-FOUND.
 11271
 11272     MOVE ER-0244                TO EMI-ERROR.
 11273     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11274     MOVE -1                     TO CERTNOL.
 11275     GO TO 8200-SEND-DATAONLY.
 11276
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 216
* EL130.cbl
 11278 5500-BUILD-FORM-TRAILER.
 11279*************************************************************
 11280*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11281*************************************************************
 11282
 11283     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 11284
 11285     IF  WS-BEN-ALPHA-2 = '30'
 11286         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 11287         MOVE '6'                TO DC-OPTION-CODE
 11288         IF CL-CARRIER = 'C'
 11289             MOVE +14            TO DC-ELAPSED-DAYS
 11290             MOVE +0             TO DC-ELAPSED-MONTHS
 11291             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11292             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 11293         ELSE
 11294             MOVE +21            TO DC-ELAPSED-DAYS
 11295             MOVE +0             TO DC-ELAPSED-MONTHS
 11296             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11297             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 11298         END-IF
 11299     END-IF.
 11300
 11301
 11302
 11303* EXEC CICS GETMAIN
 11304*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11305*         LENGTH   (ELTRLR-LENGTH)
 11306*         INITIMG  (GETMAIN-SPACE)
 11307*    END-EXEC.
 11308*    MOVE ',"IL                  $   #00010430' TO DFHEIV0
 11309     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11310     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11311     MOVE X'2020233030303130343330' TO DFHEIV0(25:11)
 11312     CALL 'kxdfhei1' USING DFHEIV0,
 11313           DFHEIV20,
 11314           ELTRLR-LENGTH,
 11315           GETMAIN-SPACE
 11316     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11317         DFHEIV20
 11318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11319
 11320
 11321     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 11322     MOVE 'AT'                   TO AT-RECORD-ID.
 11323
 11324     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 11325     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 11326     MOVE 'A'                    TO AT-TRAILER-TYPE.
 11327     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 11328                                    AT-FORM-LAST-MAINT-DT.
 11329     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11330                                    AT-FORM-LAST-UPDATED-BY.
 11331     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11332     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 11333     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 11334                                    AT-FORM-RE-SEND-DT
 11335                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 217
* EL130.cbl
 11336                                    AT-EMP-FORM-ANSWERED-DT
 11337                                    AT-PHY-FORM-ANSWERED-DT
 11338                                    AT-EMP-FORM-SEND-ON-DT
 11339                                    AT-FORM-PRINTED-DT
 11340                                    AT-FORM-REPRINT-DT.
 11341     MOVE '1'                    TO AT-FORM-TYPE.
 11342
 11343     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 11344                                    AT-INSTRUCT-LN-2
 11345                                    AT-INSTRUCT-LN-3.
 11346
 11347     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 11348     MOVE 'I'                    TO AT-FORM-ADDRESS.
 11349
 11350     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 11351
 11352     IF AM-EMPLOYER-STMT-USED = 'Y'
 11353        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 11354     END-IF.
 11355
 11356
 11357
 11358* EXEC CICS WRITE
 11359*         DATASET  (ELTRLR-DSID)
 11360*         FROM     (ACTIVITY-TRAILERS)
 11361*         RIDFLD   (AT-CONTROL-PRIMARY)
 11362*    END-EXEC.
 11363     MOVE LENGTH OF
 11364      ACTIVITY-TRAILERS
 11365       TO DFHEIV11
 11366*    MOVE '&$ L                  ''   #00010472' TO DFHEIV0
 11367     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11368     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11369     MOVE X'2020233030303130343732' TO DFHEIV0(25:11)
 11370     CALL 'kxdfhei1' USING DFHEIV0,
 11371           ELTRLR-DSID,
 11372           ACTIVITY-TRAILERS,
 11373           DFHEIV11,
 11374           AT-CONTROL-PRIMARY,
 11375           DFHEIV99,
 11376           DFHEIV99
 11377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11378
 11379
 11380 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 218
* EL130.cbl
 11382*************************************************************
 11383*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 11384*************************************************************
 11385
 11386 5700-BUILD-ARCHIVE-HEADER.
 11387
 11388     MOVE '1'                    TO CNTL-REC-TYPE.
 11389     MOVE ZEROS                  TO CNTL-SEQ-NO.
 11390     MOVE SPACES                 TO CNTL-ACCESS.
 11391
 11392
 11393
 11394* EXEC CICS READ
 11395*         DATASET  (ELCNTL-DSID)
 11396*         SET      (ADDRESS OF CONTROL-FILE)
 11397*         RIDFLD   (ELCNTL-KEY)
 11398*         UPDATE
 11399*    END-EXEC.
 11400*    MOVE '&"S        EU         (   #00010491' TO DFHEIV0
 11401     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11402     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11403     MOVE X'2020233030303130343931' TO DFHEIV0(25:11)
 11404     CALL 'kxdfhei1' USING DFHEIV0,
 11405           ELCNTL-DSID,
 11406           DFHEIV20,
 11407           DFHEIV99,
 11408           ELCNTL-KEY,
 11409           DFHEIV99,
 11410           DFHEIV99,
 11411           DFHEIV99
 11412     SET ADDRESS OF CONTROL-FILE TO
 11413         DFHEIV20
 11414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11415
 11416
 11417     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 11418
 11419     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 11420
 11421
 11422
 11423* EXEC CICS REWRITE
 11424*         FROM     (CONTROL-FILE)
 11425*         DATASET  (ELCNTL-DSID)
 11426*    END-EXEC.
 11427     MOVE LENGTH OF
 11428      CONTROL-FILE
 11429       TO DFHEIV11
 11430*    MOVE '&& L                  %   #00010503' TO DFHEIV0
 11431     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11432     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11433     MOVE X'2020233030303130353033' TO DFHEIV0(25:11)
 11434     CALL 'kxdfhei1' USING DFHEIV0,
 11435           ELCNTL-DSID,
 11436           CONTROL-FILE,
 11437           DFHEIV11,
 11438           DFHEIV99
 11439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 219
* EL130.cbl
 11440
 11441
 11442
 11443
 11444* EXEC CICS HANDLE CONDITION
 11445*         NOTOPEN  (9990-ABEND)
 11446*         DUPKEY   (5799-EXIT)
 11447*    END-EXEC.
 11448*    MOVE '"$J$                  ! > #00010509' TO DFHEIV0
 11449     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 11450     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11451     MOVE X'3E20233030303130353039' TO DFHEIV0(25:11)
 11452     CALL 'kxdfhei1' USING DFHEIV0
 11453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11454
 11455
 11456
 11457
 11458* EXEC CICS GETMAIN
 11459*         SET     (ADDRESS OF LETTER-ARCHIVE)
 11460*         LENGTH  (ELARCH-LENGTH)
 11461*    END-EXEC.
 11462*    MOVE '," L                  $   #00010515' TO DFHEIV0
 11463     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 11464     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11465     MOVE X'2020233030303130353135' TO DFHEIV0(25:11)
 11466     CALL 'kxdfhei1' USING DFHEIV0,
 11467           DFHEIV20,
 11468           ELARCH-LENGTH,
 11469           DFHEIV99
 11470     SET ADDRESS OF LETTER-ARCHIVE TO
 11471         DFHEIV20
 11472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11473
 11474
 11475     MOVE SPACES                 TO LETTER-ARCHIVE.
 11476     MOVE 'LA'                   TO LA-RECORD-ID.
 11477     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 11478                                    LA-ARCHIVE-NO-A1.
 11479     MOVE '4'                    TO LA-RECORD-TYPE
 11480                                    LA-RECORD-TYPE-A1.
 11481     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 11482                                    LA-LINE-SEQ-NO-A1.
 11483     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 11484                                    LA-COMPANY-CD-A1.
 11485     MOVE CL-CARRIER             TO LA4-CARRIER.
 11486     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 11487     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 11488     MOVE CL-CERT-STATE          TO LA4-STATE.
 11489     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 11490     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 11491     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 11492     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 11493                                    LA4-RESEND-PRINT-DATE
 11494                                    LA4-FORM-REM-PRINT-DT
 11495                                    LA4-RESEND-DATE.
 11496     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 11497     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 220
* EL130.cbl
 11498
 11499
 11500
 11501* EXEC CICS WRITE
 11502*         DATASET  (ELARCH-DSID)
 11503*         FROM     (LETTER-ARCHIVE)
 11504*         RIDFLD   (LA-CONTROL-PRIMARY)
 11505*    END-EXEC.
 11506     MOVE LENGTH OF
 11507      LETTER-ARCHIVE
 11508       TO DFHEIV11
 11509*    MOVE '&$ L                  ''   #00010545' TO DFHEIV0
 11510     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11511     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11512     MOVE X'2020233030303130353435' TO DFHEIV0(25:11)
 11513     CALL 'kxdfhei1' USING DFHEIV0,
 11514           ELARCH-DSID,
 11515           LETTER-ARCHIVE,
 11516           DFHEIV11,
 11517           LA-CONTROL-PRIMARY,
 11518           DFHEIV99,
 11519           DFHEIV99
 11520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11521
 11522
 11523 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 221
* EL130.cbl
 11525 6000-EDIT-CLAIM-DATA.
 11526
 11527     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 11528     MOVE '2'                    TO DC-OPTION-CODE.
 11529     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11530     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 11531
 11532     IF CLMNOL GREATER ZERO
 11533         IF CLMNOI = SPACES OR LOW-VALUES
 11534             MOVE -1             TO CLMNOL
 11535             MOVE AL-UABON       TO CLMNOA
 11536             MOVE ER-7688        TO EMI-ERROR
 11537             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11538         ELSE
 11539             MOVE AL-UANON       TO CLMNOA
 11540         END-IF
 11541     END-IF.
 11542
 11543     IF CERTNOL = ZERO
 11544         MOVE -1                 TO CERTNOL
 11545         MOVE AL-SABON           TO CERTNOA
 11546         MOVE ER-0203            TO EMI-ERROR
 11547         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11548     ELSE
 11549         MOVE AL-SANON           TO CERTNOA
 11550     END-IF.
 11551
 11552     IF SUFXL = ZERO
 11553         MOVE SPACES             TO SUFXI
 11554         MOVE AL-SANON           TO SUFXA
 11555     ELSE
 11556         MOVE AL-SANON           TO SUFXA
 11557     END-IF.
 11558
 11559     IF CLMCARRL = ZERO
 11560         MOVE -1                 TO CLMCARRL
 11561         MOVE ER-0194            TO EMI-ERROR
 11562         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11563     ELSE
 11564         MOVE CLMCARRI           TO PI-CARRIER
 11565         IF PI-NO-CARRIER-SECURITY
 11566             MOVE AL-UANON       TO CLMCARRA
 11567         END-IF
 11568     END-IF.
 11569
 11570     IF CLMTYPEL > ZERO
 11571        IF ((PI-COMPANY-ID = 'DCC')
 11572           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11573              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G'))
 11574                        OR
 11575           ((PI-COMPANY-ID = 'CID')
 11576           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 11577              AND PI-AH-OVERRIDE-L1))
 11578              MOVE -1             TO CLMTYPEL
 11579              MOVE AL-UABON       TO CLMTYPEA
 11580              MOVE ER-7634        TO EMI-ERROR
 11581              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11582        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 222
* EL130.cbl
 11583           MOVE AL-UANON       TO CLMTYPEA
 11584        END-IF
 11585     ELSE
 11586        IF MAINTI = 'A'
 11587           MOVE -1             TO CLMTYPEL
 11588           MOVE AL-UABON       TO CLMTYPEA
 11589           MOVE ER-0546        TO EMI-ERROR
 11590           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11591        END-IF
 11592     END-IF
 11593
 11594     IF PCERTNOL = ZERO
 11595        MOVE CERTNOI             TO PCERTNOI
 11596        MOVE CERTNOL             TO PCERTNOL
 11597        MOVE AL-UANON            TO PCERTNOA
 11598     ELSE
 11599        MOVE AL-UANON            TO PCERTNOA
 11600     END-IF.
 11601
 11602     IF PSUFXL = ZERO
 11603        MOVE SUFXI               TO PSUFXI
 11604        MOVE SUFXL               TO PSUFXL
 11605        MOVE AL-UANON            TO PSUFXA
 11606     ELSE
 11607        MOVE AL-UANON            TO PSUFXA
 11608     END-IF.
 11609
 11610     IF MAINTI = 'I'
 11611         GO TO 6020-EDIT
 11612     END-IF.
 11613
 11614     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 11615         MOVE -1                 TO LSTNMEL
 11616         MOVE ER-0236            TO EMI-ERROR
 11617         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11618     ELSE
 11619         MOVE AL-UANON           TO LSTNMEA
 11620     END-IF.
 11621
 11622     IF SEXI NOT = 'M' AND 'F'
 11623         MOVE -1                 TO SEXL
 11624         MOVE AL-UABON           TO SEXA
 11625         MOVE ER-0219            TO EMI-ERROR
 11626         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11627     ELSE
 11628         MOVE AL-UANON           TO SEXA
 11629     END-IF.
 11630
 11631     IF SSNL GREATER THAN ZERO
 11632         MOVE SSNI TO WS-SOC-SEC-NUMBER
 11633         IF WS-SOC-SEC-NO NUMERIC AND
 11634           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 11635             NEXT SENTENCE
 11636         ELSE
 11637            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 11638               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 11639               WS-SSN-DASH2 = '-'
 11640                 NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 223
* EL130.cbl
 11641            ELSE
 11642                 MOVE ER-0887        TO  EMI-ERROR
 11643                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11644                 MOVE AL-UABON       TO  SSNA
 11645                 MOVE -1             TO  SSNL
 11646            END-IF
 11647        END-IF
 11648     END-IF.
 11649
 11650     IF BIRTHDTL = ZERO
 11651         GO TO 6020-EDIT
 11652     END-IF.
 11653
 11654     IF BIRTHDTL GREATER ZERO
 11655         MOVE BIRTHDTI           TO DATE-WORK
 11656         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11657         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11658         MOVE '4'                TO DC-OPTION-CODE
 11659         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11660         IF DATE-CONVERSION-ERROR
 11661             MOVE AL-UABON       TO BIRTHDTA
 11662             MOVE -1             TO BIRTHDTL
 11663             MOVE ER-0220        TO EMI-ERROR
 11664             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11665             GO TO 6020-EDIT
 11666         END-IF
 11667     END-IF.
 11668
 11669******************************************************************
 11670**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 11671**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 11672**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 11673******************************************************************
 11674
 11675     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 11676         MOVE BIRTHDTI           TO  DATE-WORK
 11677         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11678         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 11679         MOVE '4'                TO  DC-OPTION-CODE
 11680         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 11681         MOVE +0                 TO  DC-ELAPSED-MONTHS
 11682                                     DC-ELAPSED-DAYS
 11683         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11684         IF DATE-CONVERSION-ERROR
 11685             MOVE AL-UABON       TO  BIRTHDTA
 11686             MOVE -1             TO  BIRTHDTL
 11687             MOVE ER-0220        TO  EMI-ERROR
 11688             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11689             GO TO 6020-EDIT
 11690         END-IF
 11691     END-IF.
 11692
 11693     MOVE AL-UANON               TO  BIRTHDTA.
 11694     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 11695     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 11696     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 11697
 11698 6020-EDIT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 224
* EL130.cbl
 11699     IF INCURL GREATER ZERO
 11700         MOVE INCURI             TO DATE-WORK
 11701         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11702         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11703         MOVE '4'                TO DC-OPTION-CODE
 11704         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11705         IF DATE-CONVERSION-ERROR
 11706             MOVE AL-UABON       TO INCURA
 11707             MOVE -1             TO INCURL
 11708             MOVE ER-0222        TO EMI-ERROR
 11709             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11710         ELSE
 11711             MOVE AL-UANON       TO INCURA
 11712             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 11713             MOVE DC-BIN-DATE-1  TO WS-INCUR
 11714                                    PI-SAVE-INCUR-DT
 11715             IF WS-INCUR GREATER THAN WS-TODAY-DT
 11716                 MOVE ER-0511     TO EMI-ERROR
 11717                 MOVE -1          TO INCURL
 11718                 MOVE AL-UABON    TO INCURA
 11719                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11720             ELSE
 11721*                NEXT SENTENCE
 11722                 CONTINUE
 11723             END-IF
 11724         END-IF
 11725     ELSE
 11726         MOVE ER-0516         TO EMI-ERROR
 11727         MOVE AL-UABON        TO INCURA
 11728         MOVE -1              TO INCURL
 11729         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11730     END-IF.
 11731
 11732     IF REPORTL GREATER ZERO
 11733         MOVE REPORTI            TO DATE-WORK
 11734         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11735         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11736         MOVE '4'                TO DC-OPTION-CODE
 11737         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11738         IF DATE-CONVERSION-ERROR
 11739             MOVE AL-UABON       TO REPORTA
 11740             MOVE -1             TO REPORTL
 11741             MOVE ER-0223        TO EMI-ERROR
 11742             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11743         ELSE
 11744             MOVE AL-UANON       TO REPORTA
 11745             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 11746             MOVE DC-BIN-DATE-1  TO WS-REPORT
 11747             IF WS-REPORT GREATER THAN WS-TODAY-DT
 11748                 MOVE ER-0512     TO EMI-ERROR
 11749                 MOVE -1          TO REPORTL
 11750                 MOVE AL-UABON    TO REPORTA
 11751                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11752             ELSE
 11753*                NEXT SENTENCE
 11754                 CONTINUE
 11755             END-IF
 11756         END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 225
* EL130.cbl
 11757     ELSE
 11758         MOVE ER-0517         TO EMI-ERROR
 11759         MOVE -1              TO REPORTL
 11760         MOVE AL-UABON        TO REPORTA
 11761         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11762     END-IF.
 11763
 11764     IF WS-REPORT NOT = LOW-VALUES
 11765         IF WS-INCUR GREATER THAN WS-REPORT
 11766             MOVE AL-UABON       TO REPORTA
 11767             MOVE -1             TO REPORTL
 11768             MOVE ER-0509        TO EMI-ERROR
 11769             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11770         END-IF
 11771     END-IF.
 11772
 11773     IF ESTENDL GREATER ZERO
 11774         MOVE ESTENDI            TO DATE-WORK
 11775         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11776         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11777         MOVE '4'                TO DC-OPTION-CODE
 11778         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11779         IF DATE-CONVERSION-ERROR
 11780             MOVE AL-UABON       TO ESTENDA
 11781             MOVE -1             TO ESTENDL
 11782             MOVE ER-0224        TO EMI-ERROR
 11783             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11784         ELSE
 11785             MOVE AL-UANON       TO ESTENDA
 11786             MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 11787             MOVE DC-BIN-DATE-1  TO WS-ESTEND
 11788             IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11789                MOVE AL-UABON    TO ESTENDA
 11790                MOVE -1          TO ESTENDL
 11791                MOVE ER-0544     TO EMI-ERROR
 11792                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11793             END-IF
 11794         END-IF
 11795     END-IF.
 11796
 11797     IF WS-ESTEND NOT = LOW-VALUES
 11798         IF WS-INCUR GREATER THAN WS-ESTEND
 11799             MOVE AL-UABON       TO ESTENDA
 11800             MOVE -1             TO ESTENDL
 11801             MOVE ER-0510        TO EMI-ERROR
 11802             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11803         END-IF
 11804     END-IF.
 11805
 11806     IF PRTOPTL GREATER ZERO
 11807         IF PRTOPTI NOT = 'N' AND 'L'
 11808             MOVE AL-UABON       TO PRTOPTA
 11809             MOVE -1             TO PRTOPTL
 11810             MOVE ER-0334        TO EMI-ERROR
 11811             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11812         END-IF
 11813     END-IF.
 11814
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 226
* EL130.cbl
 11815     IF MANRSVL GREATER ZERO
 11816
 11817* EXEC CICS BIF DEEDIT
 11818*            FIELD   (MANRSVI)
 11819*            LENGTH  (9)
 11820*        END-EXEC
 11821     MOVE 9
 11822       TO DFHEIV11
 11823*    MOVE '@"L                   #   #00010844' TO DFHEIV0
 11824     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 11825     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11826     MOVE X'2020233030303130383434' TO DFHEIV0(25:11)
 11827     CALL 'kxdfhei1' USING DFHEIV0,
 11828           MANRSVI,
 11829           DFHEIV11
 11830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11831         IF MANRSVI NOT NUMERIC
 11832             MOVE AL-UNBON       TO MANRSVA
 11833             MOVE -1             TO MANRSVL
 11834             MOVE ER-0489        TO EMI-ERROR
 11835             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11836         ELSE
 11837             MOVE AL-UNNON       TO MANRSVA
 11838             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 11839         END-IF
 11840     END-IF.
 11841
 11842     MOVE SPACES                 TO ELCNTL-KEY.
 11843
 11844     IF CONTROL-IS-ACTUAL-CARRIER
 11845         MOVE PI-CARRIER         TO CNTL-CARRIER
 11846     ELSE
 11847         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 11848     END-IF.
 11849
 11850     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11851     MOVE '6'                    TO CNTL-REC-TYPE.
 11852     MOVE +0                     TO CNTL-SEQ-NO.
 11853
 11854
 11855
 11856* EXEC CICS HANDLE CONDITION
 11857*        NOTFND   (3100-CARRIER-NOT-FOUND)
 11858*    END-EXEC.
 11859*    MOVE '"$I                   ! ? #00010872' TO DFHEIV0
 11860     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11861     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11862     MOVE X'3F20233030303130383732' TO DFHEIV0(25:11)
 11863     CALL 'kxdfhei1' USING DFHEIV0
 11864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11865
 11866
 11867     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 11868
 11869     IF NOT CF-MANUAL-RESERVES-USED AND
 11870           WS-MANRSV GREATER ZERO
 11871         MOVE ER-0518             TO EMI-ERROR
 11872         MOVE -1                  TO MANRSVL
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 227
* EL130.cbl
 11873         MOVE AL-UNBON            TO MANRSVA
 11874         MOVE ZEROS               TO WS-MANRSV
 11875         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11876     END-IF.
 11877
 11878     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 11879     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
 11880
 11881     IF SUPVL GREATER ZERO
 11882         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 11883             MOVE -1             TO SUPVL
 11884             MOVE AL-UABON       TO SUPVA
 11885             MOVE ER-0230        TO EMI-ERROR
 11886             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11887         ELSE
 11888             MOVE AL-UANON       TO SUPVA
 11889         END-IF
 11890     END-IF.
 11891
 11892     IF PROCCDL = ZERO
 11893        GO TO 6050-CONTINUE-EDITS
 11894     END-IF.
 11895
 11896     MOVE SPACES                 TO ELCNTL-KEY.
 11897     MOVE PROCCDI                TO CNTL-ACCESS.
 11898
 11899     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11900     MOVE '2'                    TO CNTL-REC-TYPE.
 11901     MOVE +0                     TO CNTL-SEQ-NO.
 11902
 11903
 11904
 11905* EXEC CICS HANDLE CONDITION
 11906*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 11907*    END-EXEC.
 11908*    MOVE '"$I                   ! @ #00010913' TO DFHEIV0
 11909     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11910     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11911     MOVE X'4020233030303130393133' TO DFHEIV0(25:11)
 11912     CALL 'kxdfhei1' USING DFHEIV0
 11913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11914
 11915
 11916     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 11917
 11918     GO TO 6050-CONTINUE-EDITS.
 11919
 11920 6040-NO-PROCESSOR-RECORD.
 11921     MOVE ER-0019                TO EMI-ERROR.
 11922     MOVE -1                     TO PROCCDL.
 11923     MOVE AL-UABON               TO PROCCDA.
 11924     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11925
 11926 6050-CONTINUE-EDITS.
 11927     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 11928           GO TO 6070-CONTINUE-EDITS
 11929     END-IF.
 11930
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 228
* EL130.cbl
 11931     MOVE BENECDI                TO BENE-CODE.
 11932     MOVE 'B'                    TO BENE-RCD-TYPE.
 11933     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 11934
 11935
 11936
 11937* EXEC CICS HANDLE CONDITION
 11938*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 11939*    END-EXEC.
 11940*    MOVE '"$I                   ! A #00010937' TO DFHEIV0
 11941     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11942     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11943     MOVE X'4120233030303130393337' TO DFHEIV0(25:11)
 11944     CALL 'kxdfhei1' USING DFHEIV0
 11945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11946
 11947
 11948
 11949* EXEC CICS READ
 11950*         DATASET   (ELBENE-DSID)
 11951*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 11952*         RIDFLD    (ELBENE-KEY)
 11953*    END-EXEC.
 11954*    MOVE '&"S        E          (   #00010941' TO DFHEIV0
 11955     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11956     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11957     MOVE X'2020233030303130393431' TO DFHEIV0(25:11)
 11958     CALL 'kxdfhei1' USING DFHEIV0,
 11959           ELBENE-DSID,
 11960           DFHEIV20,
 11961           DFHEIV99,
 11962           ELBENE-KEY,
 11963           DFHEIV99,
 11964           DFHEIV99,
 11965           DFHEIV99
 11966     SET ADDRESS OF BENEFICIARY-MASTER TO
 11967         DFHEIV20
 11968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11969
 11970
 11971     GO TO 6070-CONTINUE-EDITS.
 11972
 11973 6060-NO-BENEFICIARY-RECORD.
 11974     MOVE ER-0565                TO EMI-ERROR.
 11975     MOVE -1                     TO BENECDL.
 11976     MOVE AL-UABON               TO BENECDA.
 11977     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11978
 11979
 11980 6070-CONTINUE-EDITS.
 11981     IF CERTMTL GREATER ZERO
 11982         IF CERTMTI NOT = 'A' AND 'S'
 11983             MOVE -1             TO CERTMTL
 11984             MOVE AL-UABON       TO CERTMTA
 11985             MOVE ER-0267        TO EMI-ERROR
 11986             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11987         ELSE
 11988             MOVE AL-UANON       TO CERTMTA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 229
* EL130.cbl
 11989         END-IF
 11990     ELSE
 11991         GO TO 6000-EXIT
 11992     END-IF.
 11993
 11994     IF EFFDTL GREATER ZERO
 11995         MOVE EFFDTI             TO DATE-WORK
 11996         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 11997         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 11998         MOVE '4'                TO DC-OPTION-CODE
 11999         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12000         IF DATE-CONVERSION-ERROR
 12001             MOVE AL-UABON       TO EFFDTA
 12002             MOVE -1             TO EFFDTL
 12003             MOVE ER-0231        TO EMI-ERROR
 12004             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12005         ELSE
 12006             MOVE AL-UANON       TO EFFDTA
 12007             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 12008             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 12009         END-IF
 12010     ELSE
 12011         MOVE ER-0231            TO EMI-ERROR
 12012         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12013         MOVE -1                 TO EFFDTL
 12014         MOVE AL-UABON           TO EFFDTA
 12015     END-IF.
 12016
 12017     IF ACCOUNTL = ZERO
 12018         MOVE ER-0232            TO EMI-ERROR
 12019         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12020         MOVE AL-UABON           TO ACCOUNTA
 12021         MOVE -1                 TO ACCOUNTL
 12022     ELSE
 12023         MOVE AL-UANON           TO ACCOUNTA
 12024     END-IF.
 12025
 12026     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 12027        (STATEL = ZERO)
 12028         MOVE ER-0233        TO EMI-ERROR
 12029         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12030         MOVE AL-UABON       TO STATEA
 12031         MOVE -1             TO STATEL
 12032     ELSE
 12033         MOVE AL-UANON       TO STATEA
 12034     END-IF.
 12035
 12036     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 12037        (CRTCARRL = ZERO)
 12038         MOVE ER-0234        TO EMI-ERROR
 12039         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12040         MOVE AL-UABON       TO CRTCARRA
 12041         MOVE -1             TO CRTCARRL
 12042     ELSE
 12043         MOVE AL-UANON       TO CRTCARRA
 12044     END-IF.
 12045
 12046     IF PI-CERT-ACCESS-CONTROL = '1' AND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 230
* EL130.cbl
 12047        GROUPL = ZERO
 12048         MOVE ER-0235            TO EMI-ERROR
 12049         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12050         MOVE AL-UABON           TO GROUPA
 12051         MOVE -1                 TO GROUPL
 12052     ELSE
 12053         MOVE AL-UANON           TO GROUPA
 12054     END-IF.
 12055
 12056     IF CRTLNMEL = ZERO
 12057         IF LSTNMEI = SPACES OR LOW-VALUES
 12058             MOVE ER-0236            TO  EMI-ERROR
 12059             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12060             MOVE AL-UABON           TO  CRTLNMEA
 12061             MOVE -1                 TO  CRTLNMEL
 12062         ELSE
 12063             MOVE LSTNMEI            TO  CRTLNMEI
 12064             MOVE AL-UANON           TO  CRTLNMEA
 12065         END-IF
 12066     ELSE
 12067         MOVE AL-UANON               TO  CRTLNMEA
 12068     END-IF.
 12069
 12070     IF CRTFNMEL = ZERO
 12071         IF FSTNMEI = SPACES OR LOW-VALUES
 12072*            NEXT SENTENCE
 12073             CONTINUE
 12074         ELSE
 12075             MOVE FSTNMEI            TO  CRTFNMEI
 12076             MOVE AL-UANON           TO  CRTFNMEA
 12077         END-IF
 12078     END-IF.
 12079
 12080     IF CRTINITL = ZERO
 12081         IF INITI = SPACES OR LOW-VALUES
 12082*            NEXT SENTENCE
 12083             CONTINUE
 12084         ELSE
 12085             MOVE INITI              TO  CRTINITI
 12086             MOVE AL-UANON           TO  CRTINITA
 12087         END-IF
 12088     END-IF.
 12089
 12090 6000-EXIT.
 12091     EXIT.
 12092
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 231
* EL130.cbl
 12094 6200-EDIT-CERT-DATA.
 12095     IF ISSAGEL GREATER ZERO
 12096         IF ISSAGEI NOT NUMERIC
 12097             MOVE ER-0237        TO EMI-ERROR
 12098             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12099             MOVE -1             TO ISSAGEL
 12100             MOVE AL-UNBON       TO ISSAGEA
 12101         ELSE
 12102             MOVE AL-UNNON       TO ISSAGEA
 12103         END-IF
 12104     END-IF.
 12105
 12106     IF JNTAGEL GREATER ZERO
 12107         IF JNTAGEI NOT NUMERIC
 12108             MOVE ER-0238        TO EMI-ERROR
 12109             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12110             MOVE -1             TO JNTAGEL
 12111             MOVE AL-UNBON       TO JNTAGEA
 12112         ELSE
 12113             MOVE AL-UNNON       TO JNTAGEA
 12114         END-IF
 12115     END-IF.
 12116
 12117     IF LCVCDL GREATER ZERO
 12118         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 12119         IF INVALID-BENEFIT-CODE
 12120             MOVE ER-7635        TO EMI-ERROR
 12121             MOVE -1             TO LCVCDL
 12122             MOVE AL-UABON       TO LCVCDA
 12123             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12124         ELSE
 12125             MOVE LCVCDI         TO WS-BEN-HOLD
 12126             MOVE '4'            TO WS-REC-TYPE
 12127             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12128             IF WS-BEN-ALPHA-HOLD = SPACES
 12129                MOVE ER-7635     TO EMI-ERROR
 12130                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12131                MOVE -1          TO LCVCDL
 12132                MOVE AL-UABON    TO LCVCDA
 12133             ELSE
 12134                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 12135                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 12136                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 12137                MOVE AL-UANON           TO LCVCDA
 12138             END-IF
 12139         END-IF
 12140     END-IF.
 12141
 12142     IF ACVCDL GREATER ZERO
 12143         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 12144         IF INVALID-BENEFIT-CODE
 12145             MOVE ER-7635        TO EMI-ERROR
 12146             MOVE -1             TO ACVCDL
 12147             MOVE AL-UABON       TO ACVCDA
 12148             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12149         ELSE
 12150             MOVE ACVCDI         TO WS-BEN-HOLD
 12151             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 232
* EL130.cbl
 12152             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 12153             IF WS-BEN-ALPHA-HOLD = SPACES
 12154                MOVE ER-7635     TO EMI-ERROR
 12155                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12156                MOVE -1          TO ACVCDL
 12157                MOVE AL-UABON    TO ACVCDA
 12158             ELSE
 12159                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 12160                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 12161                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 12162                MOVE AL-UANON           TO ACVCDA
 12163             END-IF
 12164         END-IF
 12165     END-IF.
 12166
 12167     IF LCVOTRML GREATER ZERO
 12168         IF LCVOTRMI NOT NUMERIC
 12169             MOVE ER-7636        TO EMI-ERROR
 12170             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12171             MOVE -1             TO LCVOTRML
 12172             MOVE AL-UNBON       TO LCVOTRMA
 12173         ELSE
 12174             MOVE AL-UNNON       TO LCVOTRMA
 12175         END-IF
 12176     END-IF.
 12177
 12178     IF ACVOTRML GREATER ZERO
 12179         IF ACVOTRMI NOT NUMERIC
 12180             MOVE ER-7636        TO EMI-ERROR
 12181             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12182             MOVE -1             TO ACVOTRML
 12183             MOVE AL-UNBON       TO ACVOTRMA
 12184         ELSE
 12185             MOVE AL-UNNON       TO ACVOTRMA
 12186         END-IF
 12187     END-IF.
 12188
 12189     IF LCVRATEL GREATER ZERO
 12190
 12191* EXEC CICS BIF DEEDIT
 12192*            FIELD    (LCVRATEI)
 12193*            LENGTH   (06)
 12194*        END-EXEC
 12195     MOVE 06
 12196       TO DFHEIV11
 12197*    MOVE '@"L                   #   #00011166' TO DFHEIV0
 12198     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12199     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12200     MOVE X'2020233030303131313636' TO DFHEIV0(25:11)
 12201     CALL 'kxdfhei1' USING DFHEIV0,
 12202           LCVRATEI,
 12203           DFHEIV11
 12204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12205         IF LCVRATEI NOT NUMERIC
 12206             MOVE AL-UNBON       TO LCVRATEA
 12207             MOVE -1             TO LCVRATEL
 12208             MOVE ER-2280        TO EMI-ERROR
 12209             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 233
* EL130.cbl
 12210         ELSE
 12211             MOVE AL-UNNON       TO LCVRATEA
 12212             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 12213         END-IF
 12214     END-IF.
 12215
 12216     IF ACVRATEL GREATER ZERO
 12217
 12218* EXEC CICS BIF DEEDIT
 12219*            FIELD    (ACVRATEI)
 12220*            LENGTH   (06)
 12221*        END-EXEC
 12222     MOVE 06
 12223       TO DFHEIV11
 12224*    MOVE '@"L                   #   #00011182' TO DFHEIV0
 12225     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12226     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12227     MOVE X'2020233030303131313832' TO DFHEIV0(25:11)
 12228     CALL 'kxdfhei1' USING DFHEIV0,
 12229           ACVRATEI,
 12230           DFHEIV11
 12231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12232         IF ACVRATEI NOT NUMERIC
 12233             MOVE AL-UNBON       TO ACVRATEA
 12234             MOVE -1             TO ACVRATEL
 12235             MOVE ER-2280        TO EMI-ERROR
 12236             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12237         ELSE
 12238             MOVE AL-UNNON       TO ACVRATEA
 12239             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 12240         END-IF
 12241     END-IF.
 12242
 12243     IF LCVBENEL GREATER ZERO
 12244
 12245* EXEC CICS BIF DEEDIT
 12246*            FIELD    (LCVBENEI)
 12247*            LENGTH   (11)
 12248*        END-EXEC
 12249     MOVE 11
 12250       TO DFHEIV11
 12251*    MOVE '@"L                   #   #00011198' TO DFHEIV0
 12252     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12253     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12254     MOVE X'2020233030303131313938' TO DFHEIV0(25:11)
 12255     CALL 'kxdfhei1' USING DFHEIV0,
 12256           LCVBENEI,
 12257           DFHEIV11
 12258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12259         IF LCVBENEI NOT NUMERIC
 12260             MOVE AL-UNBON       TO LCVBENEA
 12261             MOVE -1             TO LCVBENEL
 12262             MOVE ER-7637        TO EMI-ERROR
 12263             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12264         ELSE
 12265             MOVE AL-UNNON       TO LCVBENEA
 12266             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 12267         END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 234
* EL130.cbl
 12268     END-IF.
 12269
 12270     IF ACVBENEL GREATER ZERO
 12271
 12272* EXEC CICS BIF DEEDIT
 12273*            FIELD    (ACVBENEI)
 12274*            LENGTH   (11)
 12275*        END-EXEC
 12276     MOVE 11
 12277       TO DFHEIV11
 12278*    MOVE '@"L                   #   #00011214' TO DFHEIV0
 12279     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12280     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12281     MOVE X'2020233030303131323134' TO DFHEIV0(25:11)
 12282     CALL 'kxdfhei1' USING DFHEIV0,
 12283           ACVBENEI,
 12284           DFHEIV11
 12285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12286         IF ACVBENEI NOT NUMERIC
 12287             MOVE AL-UNBON       TO ACVBENEA
 12288             MOVE -1             TO ACVBENEL
 12289             MOVE ER-7637        TO EMI-ERROR
 12290             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12291         ELSE
 12292             MOVE AL-UNNON       TO ACVBENEA
 12293             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 12294         END-IF
 12295     END-IF.
 12296
 12297     IF LCVCNDTL GREATER ZERO
 12298         IF LCVCNDTI NOT = SPACES
 12299             MOVE LCVCNDTI        TO DATE-WORK
 12300             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12301             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12302             MOVE '4'             TO DC-OPTION-CODE
 12303             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12304             IF DATE-CONVERSION-ERROR
 12305                 MOVE AL-UABON    TO LCVCNDTA
 12306                 MOVE -1          TO LCVCNDTL
 12307                 MOVE ER-7638     TO EMI-ERROR
 12308                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12309             ELSE
 12310                 MOVE AL-UANON    TO LCVCNDTA
 12311                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 12312                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 12313             END-IF
 12314         END-IF
 12315     END-IF.
 12316
 12317     IF ACVCNDTL GREATER ZERO
 12318         IF ACVCNDTI NOT = SPACES
 12319             MOVE ACVCNDTI        TO DATE-WORK
 12320             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12321             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12322             MOVE '4'             TO DC-OPTION-CODE
 12323             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12324             IF DATE-CONVERSION-ERROR
 12325                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 235
* EL130.cbl
 12326                 MOVE -1          TO ACVCNDTL
 12327                 MOVE ER-7638     TO EMI-ERROR
 12328                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12329             ELSE
 12330                 MOVE AL-UANON    TO ACVCNDTA
 12331                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 12332                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 12333             END-IF
 12334         END-IF
 12335     END-IF.
 12336
 12337     IF ADDONDTL GREATER ZERO
 12338         MOVE ADDONDTI        TO DATE-WORK
 12339         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12340         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 12341         MOVE '4'             TO DC-OPTION-CODE
 12342         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12343         IF DATE-CONVERSION-ERROR
 12344             MOVE AL-UABON    TO ADDONDTA
 12345             MOVE -1          TO ADDONDTL
 12346             MOVE ER-7651     TO EMI-ERROR
 12347             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12348         ELSE
 12349             MOVE AL-UANON    TO ADDONDTA
 12350             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 12351             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 12352         END-IF
 12353     END-IF.
 12354
 12355     IF APRL GREATER ZERO
 12356
 12357* EXEC CICS BIF DEEDIT
 12358*            FIELD    (APRI)
 12359*            LENGTH   (8)
 12360*        END-EXEC
 12361     MOVE 8
 12362       TO DFHEIV11
 12363*    MOVE '@"L                   #   #00011288' TO DFHEIV0
 12364     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12365     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12366     MOVE X'2020233030303131323838' TO DFHEIV0(25:11)
 12367     CALL 'kxdfhei1' USING DFHEIV0,
 12368           APRI,
 12369           DFHEIV11
 12370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12371         IF APRI NOT NUMERIC
 12372             MOVE AL-UNBON       TO APRA
 12373             MOVE -1             TO APRL
 12374             MOVE ER-0248        TO EMI-ERROR
 12375             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12376         ELSE
 12377             MOVE AL-UNNON       TO APRA
 12378             MOVE APRI           TO WS-APR APRO
 12379         END-IF
 12380     END-IF.
 12381
 12382     IF PMTFREQL GREATER ZERO
 12383
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 236
* EL130.cbl
 12384* EXEC CICS BIF DEEDIT
 12385*            FIELD   (PMTFREQI)
 12386*            LENGTH  (2)
 12387*        END-EXEC
 12388     MOVE 2
 12389       TO DFHEIV11
 12390*    MOVE '@"L                   #   #00011304' TO DFHEIV0
 12391     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12392     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12393     MOVE X'2020233030303131333034' TO DFHEIV0(25:11)
 12394     CALL 'kxdfhei1' USING DFHEIV0,
 12395           PMTFREQI,
 12396           DFHEIV11
 12397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12398         IF PMTFREQI NOT NUMERIC
 12399             MOVE -1             TO PMTFREQL
 12400             MOVE AL-UNBON       TO PMTFREQA
 12401             MOVE ER-0258        TO EMI-ERROR
 12402             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12403         ELSE
 12404             MOVE AL-UNNON       TO PMTFREQA
 12405             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 12406         END-IF
 12407     END-IF.
 12408
 12409     IF INDGRPL GREATER ZERO
 12410         IF INDGRPI = 'I' OR 'G'
 12411             MOVE AL-UANON       TO INDGRPA
 12412         ELSE
 12413             MOVE -1 TO INDGRPL
 12414             MOVE AL-UABON       TO INDGRPA
 12415             MOVE ER-0260        TO EMI-ERROR
 12416             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12417         END-IF
 12418     END-IF.
 12419
 12420     IF LOANBALL GREATER ZERO
 12421         MOVE LOANBALI           TO DEEDIT-FIELD
 12422
 12423* EXEC CICS BIF DEEDIT
 12424*            FIELD   (DEEDIT-FIELD)
 12425*            LENGTH  (12)
 12426*        END-EXEC
 12427     MOVE 12
 12428       TO DFHEIV11
 12429*    MOVE '@"L                   #   #00011332' TO DFHEIV0
 12430     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 12431     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12432     MOVE X'2020233030303131333332' TO DFHEIV0(25:11)
 12433     CALL 'kxdfhei1' USING DFHEIV0,
 12434           DEEDIT-FIELD,
 12435           DFHEIV11
 12436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12437         IF DEEDIT-FIELD NOT NUMERIC
 12438             MOVE AL-UNBON       TO LOANBALA
 12439             MOVE -1             TO LOANBALL
 12440             MOVE ER-0247        TO EMI-ERROR
 12441             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 237
* EL130.cbl
 12442         ELSE
 12443             MOVE AL-UNNON       TO LOANBALA
 12444             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 12445         END-IF
 12446     END-IF.
 12447
 12448     IF PREMTYPL GREATER ZERO
 12449         IF (PREMTYPI = '1' OR '2' OR '3')
 12450             MOVE AL-UANON       TO PREMTYPA
 12451         ELSE
 12452             MOVE -1             TO PREMTYPL
 12453             MOVE AL-UABON       TO PREMTYPA
 12454             MOVE ER-0227        TO EMI-ERROR
 12455             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12456         END-IF
 12457     END-IF.
 12458
 12459     IF REINCDL GREATER ZERO
 12460         MOVE LOW-VALUES         TO  ERREIN-KEY
 12461         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 12462         MOVE REINCDI            TO  REIN-CODE-1
 12463                                     REIN-CODE-2
 12464                                     REIN-CODE-3
 12465         MOVE 'A'                TO  REIN-TYPE
 12466         PERFORM 7992-READ-REIN THRU 7992-EXIT
 12467         IF REIN-REC-NOT-FOUND
 12468             MOVE ER-0266        TO  EMI-ERROR
 12469             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12470             MOVE -1             TO  REINCDL
 12471             MOVE AL-UABON       TO  REINCDA
 12472         ELSE
 12473             MOVE AL-UANON       TO  REINCDA
 12474         END-IF
 12475     END-IF.
 12476
 12477     IF CERTMTI NOT = 'A'
 12478        GO TO 6200-EXIT
 12479     END-IF.
 12480
 12481     IF PREMTYPI = '1'
 12482         IF LCVCDL GREATER ZERO
 12483             IF WS-LF-SPECIAL-CALC-CD = 'O'
 12484                 MOVE ER-0841        TO  EMI-ERROR
 12485                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12486                 MOVE -1             TO  PREMTYPL
 12487                 MOVE AL-UABON       TO  PREMTYPA
 12488             END-IF
 12489         END-IF
 12490     END-IF.
 12491
 12492     IF PREMTYPI = '1'
 12493         IF ACVCDL GREATER ZERO
 12494             IF WS-AH-SPECIAL-CALC-CD = 'O'
 12495                 MOVE ER-0841        TO  EMI-ERROR
 12496                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12497                 MOVE -1             TO  PREMTYPL
 12498                 MOVE AL-UABON       TO  PREMTYPA
 12499             END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 238
* EL130.cbl
 12500         END-IF
 12501     END-IF.
 12502
 12503     IF PREMTYPI = '2'
 12504         IF LCVCDL GREATER ZERO
 12505             IF (PI-COMPANY-ID = 'HAN') AND
 12506                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 12507                        OR
 12508                 WS-LF-SPECIAL-CALC-CD = 'O'
 12509*                NEXT SENTENCE
 12510                 CONTINUE
 12511             ELSE
 12512                 MOVE ER-0840        TO  EMI-ERROR
 12513                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12514                 MOVE -1             TO  PREMTYPL
 12515                 MOVE AL-UABON       TO  PREMTYPA
 12516             END-IF
 12517         END-IF
 12518     END-IF.
 12519
 12520     IF PREMTYPI = '2'
 12521         IF ACVCDL GREATER ZERO
 12522             IF (PI-COMPANY-ID = 'HAN')  AND
 12523                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 12524                        OR
 12525                 WS-AH-SPECIAL-CALC-CD = 'O'
 12526*                NEXT SENTENCE
 12527                 CONTINUE
 12528             ELSE
 12529                 MOVE ER-0840        TO  EMI-ERROR
 12530                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12531                 MOVE -1             TO  PREMTYPL
 12532                 MOVE AL-UABON       TO  PREMTYPA
 12533             END-IF
 12534         END-IF
 12535     END-IF.
 12536
 12537     IF LCVCDL = ZEROS
 12538        GO TO 6200-EXIT
 12539     END-IF.
 12540
 12541     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 12542         IF PMTFREQI NOT = ZEROS
 12543             MOVE ER-0428        TO EMI-ERROR
 12544             MOVE -1             TO PMTFREQL
 12545             MOVE AL-UNBON       TO PMTFREQA
 12546             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12547             GO TO 6200-CHECK-APR
 12548         END-IF
 12549     END-IF.
 12550
 12551     IF PMTFREQL = ZEROS AND TEX-REG
 12552         MOVE ER-0429            TO EMI-ERROR
 12553         MOVE -1                 TO PMTFREQL
 12554         MOVE AL-UNBON           TO PMTFREQA
 12555         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12556         GO TO 6200-CHECK-APR
 12557     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 239
* EL130.cbl
 12558
 12559     IF LCVOTRMI NOT NUMERIC
 12560         GO TO 6200-CHECK-APR
 12561     END-IF.
 12562
 12563     IF WS-PMTFREQ NOT = ZERO
 12564         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 12565         GIVING DIVIDE-QUOT
 12566         REMAINDER DIVIDE-REM
 12567         IF DIVIDE-REM GREATER ZERO
 12568             MOVE ER-0430            TO EMI-ERROR
 12569             MOVE -1                 TO PMTFREQL
 12570             MOVE AL-UNBON           TO PMTFREQA
 12571             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12572         END-IF
 12573     END-IF.
 12574
 12575 6200-CHECK-APR.
 12576     IF NET-PAY AND APRL = ZEROS
 12577        MOVE ER-0257             TO EMI-ERROR
 12578        MOVE -1                  TO APRL
 12579        MOVE AL-UABON            TO APRA
 12580        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12581     END-IF.
 12582
 12583 6200-EXIT.
 12584     EXIT.
 12585
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 240
* EL130.cbl
 12587 6300-REQUIRED-CERT-EDIT.
 12588
 12589     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12590        GO TO 6300-REQUIRED-AH-EDIT
 12591     END-IF
 12592
 12593     IF LCVCDL = ZERO
 12594        MOVE ER-7639             TO EMI-ERROR
 12595        MOVE -1                  TO LCVCDL
 12596        MOVE AL-UABON            TO LCVCDA
 12597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12598     END-IF.
 12599
 12600     IF LCVOTRML = ZERO
 12601        MOVE ER-7670             TO EMI-ERROR
 12602        MOVE -1                  TO LCVOTRML
 12603        MOVE AL-UNBON            TO LCVOTRMA
 12604        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12605     END-IF.
 12606
 12607     IF LCVBENEL = ZERO
 12608        MOVE ER-7671             TO EMI-ERROR
 12609        MOVE -1                  TO LCVBENEL
 12610        MOVE AL-UNBON            TO LCVBENEA
 12611        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12612     END-IF.
 12613
 12614     GO TO 6399-EXIT.
 12615
 12616 6300-REQUIRED-AH-EDIT.
 12617
 12618     IF ACVCDL = ZERO
 12619        MOVE ER-7639             TO EMI-ERROR
 12620        MOVE -1                  TO ACVCDL
 12621        MOVE AL-UABON            TO ACVCDA
 12622        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12623     END-IF.
 12624
 12625     IF ACVOTRML = ZERO
 12626         MOVE ER-7670             TO EMI-ERROR
 12627         MOVE -1                  TO ACVOTRML
 12628         MOVE AL-UNBON            TO ACVOTRMA
 12629         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12630     END-IF.
 12631
 12632     IF ACVBENEL = ZERO
 12633        MOVE ER-7671             TO EMI-ERROR
 12634        MOVE -1                  TO ACVBENEL
 12635        MOVE AL-UNBON            TO ACVBENEA
 12636        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12637     END-IF.
 12638
 12639 6399-EXIT.
 12640      EXIT.
 12641
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 241
* EL130.cbl
 12643 6400-TEST-CLAIM-REASONABILITY.
 12644
 12645     IF WS-INCUR = LOW-VALUES
 12646        GO TO 6499-EXIT
 12647     END-IF.
 12648
 12649     IF WS-EFFDT NOT = LOW-VALUES
 12650         IF WS-INCUR LESS WS-EFFDT
 12651             MOVE ER-0458          TO EMI-ERROR
 12652             MOVE -1               TO INCURL
 12653             MOVE AL-UABON         TO INCURA
 12654             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12655         END-IF
 12656     END-IF.
 12657
 12658     IF CERTMTI = 'A'
 12659        GO TO 6460-TEST-NEW-CERT
 12660     END-IF.
 12661
 12662     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12663     MOVE CRTCARRI               TO CERT-CARRIER.
 12664     MOVE GROUPI                 TO CERT-GROUPING.
 12665     MOVE STATEI                 TO CERT-STATE.
 12666     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 12667     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 12668     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 12669
 12670
 12671
 12672* EXEC CICS HANDLE CONDITION
 12673*         DUPKEY   (6499-EXIT)
 12674*         NOTFND   (6499-EXIT)
 12675*    END-EXEC.
 12676*    MOVE '"$$I                  ! B #00011570' TO DFHEIV0
 12677     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 12678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12679     MOVE X'4220233030303131353730' TO DFHEIV0(25:11)
 12680     CALL 'kxdfhei1' USING DFHEIV0
 12681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12682
 12683
 12684     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 12685
 12686     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 12687        'I' OR 'G')
 12688        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12689     ELSE
 12690        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 12691     END-IF.
 12692
 12693     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12694     MOVE '6'                    TO DC-OPTION-CODE.
 12695     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12696
 12697     IF WS-INCUR GREATER THAN DC-BIN-DATE-2
 12698        MOVE ER-0519             TO EMI-ERROR
 12699        MOVE -1                  TO INCURL
 12700        MOVE AL-UABON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 242
* EL130.cbl
 12701        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12702     END-IF.
 12703
 12704     IF CLMCARRI NOT = CRTCARRI
 12705        MOVE ER-0562             TO EMI-ERROR
 12706        MOVE AL-UABON            TO CLMCARRA
 12707        MOVE -1                  TO CLMCARRL
 12708        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12709     END-IF.
 12710
 12711     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12712        CM-AH-BENEFIT-CD = '00')
 12713                  OR
 12714        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12715        CM-LF-BENEFIT-CD = '00')
 12716         MOVE ER-0521         TO EMI-ERROR
 12717         MOVE AL-UABON        TO CLMTYPEA
 12718         MOVE -1              TO CLMTYPEL
 12719         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12720     END-IF.
 12721*    IF CLMTYPEI = 'I' AND
 12722*       CM-AH-CRITICAL-PERIOD = +0
 12723*        MOVE ER-0521         TO EMI-ERROR
 12724*        MOVE AL-UABON        TO CLMTYPEA
 12725*        MOVE -1              TO CLMTYPEL
 12726*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12727*    END-IF
 12728
 12729*    IF PI-COMPANY-ID = 'CRI'
 12730*        IF MAINTI = 'A'
 12731*            IF CERT-PEND-ISSUE-ERROR  OR
 12732*               CERT-PEND-ISSUE-RETURNED
 12733*                MOVE -1                 TO CERTNOL
 12734*                MOVE AL-UABON           TO CERTNOA
 12735*                MOVE ER-7640            TO EMI-ERROR
 12736*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12737*            END-IF
 12738*        END-IF
 12739*    END-IF.
 12740
 12741     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 12742         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 12743         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 12744             GO TO 6450-DATE-ERROR
 12745         END-IF
 12746     END-IF.
 12747
 12748     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 12749         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 12750         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 12751             GO TO 6450-DATE-ERROR
 12752         END-IF
 12753     END-IF.
 12754
 12755     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 12756         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 12757             GO TO 6450-DATE-ERROR
 12758         END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 243
* EL130.cbl
 12759     END-IF.
 12760
 12761     GO TO 6499-EXIT.
 12762
 12763 6450-DATE-ERROR.
 12764     MOVE ER-0520                TO EMI-ERROR.
 12765     MOVE -1                     TO INCURL.
 12766     MOVE AL-UABON               TO INCURA.
 12767     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12768
 12769*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 12770*       (EMI-SEVERITY-SAVE = 'X')
 12771*        ADD 1                TO EMI-FORCABLE-CTR
 12772*        SUBTRACT 1 FROM EMI-FATAL-CTR
 12773*    END-IF.
 12774
 12775     GO TO 6499-EXIT.
 12776
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 244
* EL130.cbl
 12778 6460-TEST-NEW-CERT.
 12779
 12780     IF NOT EMI-NO-ERRORS
 12781        GO TO 6499-EXIT
 12782     END-IF.
 12783
 12784     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 12785
 12786     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12787         ACVOTRML GREATER ZERO)
 12788        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 12789     END-IF.
 12790
 12791     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12792         LCVOTRML GREATER ZERO
 12793        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 12794     END-IF.
 12795
 12796     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 12797
 12798*    IF PI-COMPANY-ID = 'HAN'
 12799*        IF ADDONDTL GREATER ZERO
 12800*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 12801*            IF CLMTYPEI = 'A'
 12802*                IF ACVOTRMI NOT = ZEROS
 12803*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 12804*                ELSE
 12805*                    NEXT SENTENCE
 12806*                    CONTINUE
 12807*                END-IF
 12808*            ELSE
 12809*                IF LCVOTRMI NOT = ZEROS
 12810*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 12811*                END-IF
 12812*            END-IF
 12813*        END-IF
 12814*    END-IF.
 12815
 12816     MOVE '6'                    TO DC-OPTION-CODE.
 12817     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12818
 12819     IF NO-CONVERSION-ERROR
 12820         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 12821     END-IF.
 12822
 12823     IF WS-INCUR GREATER THAN WS-EXPIRE
 12824        MOVE ER-0519             TO EMI-ERROR
 12825        MOVE -1                  TO INCURL
 12826        MOVE AL-UABON            TO INCURA
 12827        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12828     END-IF.
 12829
 12830     IF CLMCARRI NOT = CRTCARRI
 12831        MOVE ER-0562             TO EMI-ERROR
 12832        MOVE AL-UABON            TO CLMCARRA
 12833        MOVE -1                  TO CLMCARRL
 12834        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12835     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 245
* EL130.cbl
 12836
 12837     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G') AND
 12838         ACVCDL = ZEROS)
 12839             MOVE ER-0521        TO EMI-ERROR
 12840             MOVE AL-UABON       TO CLMTYPEA
 12841             MOVE -1             TO CLMTYPEL
 12842             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12843     END-IF.
 12844
 12845     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 12846         LCVCDL = ZEROS
 12847             MOVE ER-0521        TO EMI-ERROR
 12848             MOVE AL-UABON       TO CLMTYPEA
 12849             MOVE -1             TO CLMTYPEL
 12850             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12851     END-IF.
 12852
 12853     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 12854         IF LCVCNDTL GREATER ZERO
 12855             IF WS-INCUR GREATER THAN WS-LCVCNDT
 12856                 GO TO 6450-DATE-ERROR
 12857             END-IF
 12858         END-IF
 12859     END-IF.
 12860
 12861     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 12862         IF ACVCNDTL GREATER ZERO
 12863             IF WS-INCUR GREATER THAN WS-ACVCNDT
 12864                 GO TO 6450-DATE-ERROR
 12865             END-IF
 12866         END-IF
 12867     END-IF.
 12868
 12869 6499-EXIT.
 12870     EXIT.
 12871
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 246
* EL130.cbl
 12873 6600-CHECK-AUTO-ACTIVITY.
 12874
 12875
 12876* EXEC CICS HANDLE CONDITION
 12877*        NOTFND   (6600-NOT-FOUND)
 12878*    END-EXEC.
 12879*    MOVE '"$I                   ! C #00011766' TO DFHEIV0
 12880     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12882     MOVE X'4320233030303131373636' TO DFHEIV0(25:11)
 12883     CALL 'kxdfhei1' USING DFHEIV0
 12884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12885
 12886
 12887     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 12888     MOVE 'T'                        TO  CNTL-REC-TYPE.
 12889     MOVE SPACES                     TO  CNTL-ACCESS.
 12890     MOVE +0                         TO  CNTL-SEQ-NO.
 12891
 12892     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 12893
 12894     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 12895         MOVE 'N'                    TO  WS-REC-FOUND-SW
 12896                                         WS-LETTER-SW
 12897         GO TO 6600-EXIT
 12898     END-IF.
 12899
 12900     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 12901         MOVE 'N'                     TO  WS-LETTER-SW
 12902     ELSE
 12903         MOVE 'Y'                     TO  WS-LETTER-SW
 12904     END-IF.
 12905
 12906     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 12907     GO TO 6600-EXIT.
 12908
 12909 6600-START-AUTO-LETTER-WRITER.
 12910
 12911     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 12912     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 12913
 12914     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 12915
 12916     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 12917         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 12918         MOVE '6'                     TO  DC-OPTION-CODE
 12919         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 12920         MOVE +0                      TO  DC-ELAPSED-MONTHS
 12921         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12922         IF NO-CONVERSION-ERROR
 12923             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 12924         ELSE
 12925             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 12926         END-IF
 12927     END-IF.
 12928
 12929     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
 12930         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 247
* EL130.cbl
 12931         MOVE '6'                     TO  DC-OPTION-CODE
 12932         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 12933         MOVE +0                      TO  DC-ELAPSED-MONTHS
 12934         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12935         IF NO-CONVERSION-ERROR
 12936             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 12937         ELSE
 12938             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 12939         END-IF
 12940     END-IF.
 12941
 12942
 12943
 12944* EXEC CICS LINK
 12945*        PROGRAM    (LINK-1523)
 12946*        COMMAREA   (W-1523-LINKDATA)
 12947*        LENGTH     (W-1523-COMM-LENGTH)
 12948*    END-EXEC.
 12949*    MOVE '."C                   ''   #00011826' TO DFHEIV0
 12950     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12951     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12952     MOVE X'2020233030303131383236' TO DFHEIV0(25:11)
 12953     CALL 'kxdfhei1' USING DFHEIV0,
 12954           LINK-1523,
 12955           W-1523-LINKDATA,
 12956           W-1523-COMM-LENGTH,
 12957           DFHEIV99,
 12958           DFHEIV99,
 12959           DFHEIV99
 12960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12961
 12962
 12963     GO TO 6600-EXIT.
 12964
 12965 6600-NOT-FOUND.
 12966     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 12967
 12968 6600-EXIT.
 12969     EXIT.
 12970
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 248
* EL130.cbl
 12971/
 12972*************************************************************
 12973*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 12974*************************************************************
 12975
 12976 6700-OUTPUT-ACTIVITY-RECORD.
 12977
 12978
 12979
 12980* EXEC CICS GETMAIN
 12981*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 12982*        LENGTH (DLYACTV-LENGTH)
 12983*        INITIMG (WS-BLANK)
 12984*    END-EXEC.
 12985*    MOVE ',"IL                  $   #00011848' TO DFHEIV0
 12986     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12987     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12988     MOVE X'2020233030303131383438' TO DFHEIV0(25:11)
 12989     CALL 'kxdfhei1' USING DFHEIV0,
 12990           DFHEIV20,
 12991           DLYACTV-LENGTH,
 12992           WS-BLANK
 12993     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 12994         DFHEIV20
 12995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12996
 12997
 12998     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 12999     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 13000     MOVE CLMCARRI               TO DA-CARRIER.
 13001     IF CLMNOL EQUAL ZERO
 13002         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 13003     ELSE
 13004         MOVE CLMNOI             TO DA-CLAIM-NO
 13005     END-IF.
 13006     MOVE CERTNOI                TO DA-CERT-PRIME.
 13007     MOVE SUFXI                  TO DA-CERT-SFX.
 13008     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 13009     MOVE 'A'                    TO DA-RECORD-TYPE.
 13010
 13011
 13012* EXEC CICS HANDLE CONDITION
 13013*        NOTOPEN (6700-NOTOPEN-ERROR)
 13014*        DUPREC (6700-EXIT)
 13015*    END-EXEC.
 13016*    MOVE '"$J%                  ! D #00011867' TO DFHEIV0
 13017     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 13018     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13019     MOVE X'4420233030303131383637' TO DFHEIV0(25:11)
 13020     CALL 'kxdfhei1' USING DFHEIV0
 13021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13022
 13023
 13024
 13025* EXEC CICS WRITE
 13026*        DATASET (DLYACTV-DSID)
 13027*        RIDFLD (DA-KEY)
 13028*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 249
* EL130.cbl
 13029*        LENGTH (DLYACTV-LENGTH)
 13030*    END-EXEC.
 13031*    MOVE '&$ L                  ''   #00011872' TO DFHEIV0
 13032     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13033     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13034     MOVE X'2020233030303131383732' TO DFHEIV0(25:11)
 13035     CALL 'kxdfhei1' USING DFHEIV0,
 13036           DLYACTV-DSID,
 13037           DAILY-ACTIVITY-RECORD,
 13038           DLYACTV-LENGTH,
 13039           DA-KEY,
 13040           DFHEIV99,
 13041           DFHEIV99
 13042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13043
 13044     GO TO 6700-EXIT.
 13045
 13046 6700-NOTOPEN-ERROR.
 13047     MOVE '2955'                 TO EMI-ERROR.
 13048     MOVE -1                     TO MAINTL.
 13049     MOVE AL-UANON               TO MAINTA.
 13050     PERFORM 9900-ERROR-FORMAT THRU
 13051             9900-EXIT.
 13052     GO TO 8200-SEND-DATAONLY.
 13053
 13054 6700-EXIT.
 13055     EXIT.
 13056
 13057*************************************************************
 13058*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 13059*************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 250
* EL130.cbl
 13060/
 13061 6990-DEEDIT-DATE.
 13062
 13063
 13064* EXEC CICS BIF DEEDIT
 13065*        FIELD   (DATE-WORK)
 13066*        LENGTH  (8)
 13067*    END-EXEC.
 13068     MOVE 8
 13069       TO DFHEIV11
 13070*    MOVE '@"L                   #   #00011897' TO DFHEIV0
 13071     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13072     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13073     MOVE X'2020233030303131383937' TO DFHEIV0(25:11)
 13074     CALL 'kxdfhei1' USING DFHEIV0,
 13075           DATE-WORK,
 13076           DFHEIV11
 13077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13078
 13079 6990-EXIT.
 13080     EXIT.
 13081
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 251
* EL130.cbl
 13083 7000-BUILD-OUTPUT-MAP.
 13084
 13085     IF CLAIM-SWITCH = 'N'
 13086         GO TO 7050-BUILD-MAP-CERT-DATA
 13087     END-IF.
 13088
 13089     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 13090         MOVE SPACES                 TO SEQUO
 13091         MOVE AL-SABOF               TO SEQUA
 13092     ELSE
 13093         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 13094         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 13095         MOVE WS-CLAIM-SEQU          TO SEQUO
 13096         MOVE AL-SABON               TO SEQUA
 13097     END-IF.
 13098
 13099     MOVE CL-CARRIER             TO CLMCARRO.
 13100     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 13101     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13102     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13103     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 13104     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 13105     MOVE CL-INSURED-MID-INIT    TO INITO.
 13106     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13107     MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 13108
 13109     MOVE AL-UANON               TO CLMCARRA
 13110                                    CLMTYPEA
 13111                                    PCERTNOA
 13112                                    PSUFXA
 13113                                    LSTNMEA
 13114                                    FSTNMEA
 13115                                    INITA
 13116                                    SEXA
 13117                                    OCCCDA.
 13118
 13119     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 13120
 13121     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 13122         MOVE ' '                 TO DC-OPTION-CODE
 13123         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13124         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13125         IF NOT DATE-CONVERSION-ERROR
 13126             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 13127             MOVE AL-UANON            TO BIRTHDTA
 13128         END-IF
 13129     END-IF.
 13130
 13131     MOVE CL-SOC-SEC-NO          TO SSNO.
 13132     MOVE AL-UANON               TO SSNA.
 13133
 13134     IF CL-INCURRED-DT NOT = LOW-VALUES
 13135         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13136         MOVE ' '                TO DC-OPTION-CODE
 13137         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13138         IF NOT DATE-CONVERSION-ERROR
 13139             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 13140             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 252
* EL130.cbl
 13141         END-IF
 13142     END-IF.
 13143
 13144     IF CL-REPORTED-DT NOT = LOW-VALUES
 13145         MOVE ' '                TO DC-OPTION-CODE
 13146         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 13147         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13148         IF NOT DATE-CONVERSION-ERROR
 13149             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 13150             MOVE AL-UANON            TO REPORTA
 13151         END-IF
 13152     END-IF.
 13153
 13154     IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 13155         MOVE ' '                 TO DC-OPTION-CODE
 13156         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13157         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13158         IF NOT DATE-CONVERSION-ERROR
 13159             MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 13160             MOVE AL-UANON            TO ESTENDA
 13161         END-IF
 13162     END-IF.
 13163
 13164     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 13165     MOVE CL-CAUSE-CD            TO CAUSEO.
 13166     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 13167     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 13168     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 13169     MOVE CL-PRIORITY-CD         TO PRICDO.
 13170     MOVE AL-UANON               TO DIAGA
 13171                                    CAUSEA
 13172                                    RELCLMA
 13173                                    PROCCDA
 13174                                    PRICDA.
 13175     MOVE AL-UNNON               TO MANRSVA.
 13176
 13177*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 13178*        MOVE CL-PRODUCT-CD          TO PRODCDO
 13179*        MOVE AL-UANON               TO PRODCDA
 13180*    END-IF.
 13181
 13182     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 13183     MOVE CL-FILE-LOCATION       TO FILETOO.
 13184     MOVE CL-BENEFICIARY         TO BENECDO.
 13185     MOVE AL-UANON               TO SUPVA
 13186                                    FILETOA
 13187                                    BENECDA.
 13188
 13189     IF CLAIM-SWITCH = 'X'
 13190         GO TO 7099-EXIT
 13191     END-IF.
 13192
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 253
* EL130.cbl
 13194 7050-BUILD-MAP-CERT-DATA.
 13195     MOVE CM-CERT-PRIME          TO CERTNOO.
 13196     MOVE CM-CERT-SFX            TO SUFXO.
 13197     MOVE AL-SANON               TO CERTNOA
 13198                                    SUFXA.
 13199
 13200     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 13201         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 13202         MOVE ' '                TO DC-OPTION-CODE
 13203         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13204         IF NOT DATE-CONVERSION-ERROR
 13205             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 13206         END-IF
 13207     END-IF.
 13208
 13209     MOVE CM-ACCOUNT             TO ACCOUNTO.
 13210     MOVE CM-STATE               TO STATEO.
 13211     MOVE CM-CARRIER             TO CRTCARRO.
 13212     MOVE CM-GROUPING            TO GROUPO.
 13213     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 13214     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 13215     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 13216     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 13217     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 13218     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 13219     MOVE CM-JT-INITIAL          TO JNTINITO.
 13220     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 13221     MOVE AL-UANON               TO ACCOUNTA
 13222                                    STATEA
 13223                                    CRTCARRA
 13224                                    GROUPA
 13225                                    CRTLNMEA
 13226                                    CRTFNMEA
 13227                                    CRTINITA
 13228                                    JNTLNMEA
 13229                                    JNTFNMEA
 13230                                    JNTINITA.
 13231     MOVE AL-UNNON               TO ISSAGEA
 13232                                    JNTAGEA.
 13233
 13234     IF CM-SSN-STATE   = CM-STATE AND
 13235        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 13236*        NEXT SENTENCE
 13237         CONTINUE
 13238     ELSE
 13239         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 13240     END-IF.
 13241
 13242     MOVE AL-UANON               TO CRTSSNA.
 13243
 13244     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 13245     MOVE '2'                    TO DC-OPTION-CODE.
 13246     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13247     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 13248
 13249*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 13250     MOVE SPACES                 TO ELCNTL-KEY.
 13251     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 254
* EL130.cbl
 13252     MOVE '3'                    TO CNTL-REC-TYPE.
 13253     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13254     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13255
 13256
 13257
 13258* EXEC CICS READ
 13259*        DATASET  (ELCNTL-DSID)
 13260*        SET      (ADDRESS OF CONTROL-FILE)
 13261*        RIDFLD   (ELCNTL-KEY)
 13262*        RESP     (WS-RESPONSE)
 13263*    END-EXEC.
 13264*    MOVE '&"S        E          (  N#00012079' TO DFHEIV0
 13265     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13267     MOVE X'204E233030303132303739' TO DFHEIV0(25:11)
 13268     CALL 'kxdfhei1' USING DFHEIV0,
 13269           ELCNTL-DSID,
 13270           DFHEIV20,
 13271           DFHEIV99,
 13272           ELCNTL-KEY,
 13273           DFHEIV99,
 13274           DFHEIV99,
 13275           DFHEIV99
 13276     SET ADDRESS OF CONTROL-FILE TO
 13277         DFHEIV20
 13278     MOVE EIBRESP  TO WS-RESPONSE
 13279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13280
 13281
 13282     IF WS-RESP-NOTFND
 13283          MOVE ER-2848           TO EMI-ERROR
 13284          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13285          GO TO 8100-SEND-INITIAL-MAP
 13286     END-IF.
 13287
 13288     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 255
* EL130.cbl
 13290     IF CM-LF-BENEFIT-CD = '00'
 13291         MOVE ZEROS              TO LCVOTRMO
 13292                                    LCVRTRMO
 13293                                    LCVRATEO
 13294                                    LCVBENEO
 13295         MOVE SPACES             TO LCVDSCRO
 13296                                    LCVCDO
 13297                                    LCVKINDO
 13298                                    LCVFORMO
 13299                                    LCVCNDTO
 13300                                    LCVEXITO
 13301                                    LCVSTATO
 13302         IF CLMTYPEL GREATER THAN ZERO AND
 13303            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13304                MOVE ER-0521     TO EMI-ERROR
 13305                MOVE AL-UABON    TO CLMTYPEA
 13306                MOVE -1          TO CLMTYPEL
 13307                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13308                GO TO 7060-FILL-AH-COVERAGE
 13309         ELSE
 13310             GO TO 7060-FILL-AH-COVERAGE
 13311         END-IF
 13312     END-IF.
 13313
 13314     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 13315     MOVE AL-UANON               TO LCVDSCRA.
 13316     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 13317     MOVE '4'                    TO WS-REC-TYPE.
 13318     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13319     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 13320     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 13321     MOVE AL-UANON               TO LCVCDA.
 13322     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 13323                                    CP-ORIGINAL-TERM.
 13324     MOVE AL-UNNON               TO LCVOTRMA.
 13325     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13326     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13327     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13328     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13329     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13330     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13331
 13332     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13333     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 13334
 13335     IF CM-LF-PREMIUM-RATE NUMERIC
 13336         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 13337     ELSE
 13338         MOVE ZEROS              TO LCVRATEO
 13339     END-IF.
 13340
 13341     MOVE AL-UNNON               TO LCVRATEA.
 13342
 13343     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 13344         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 13345     END-IF.
 13346
 13347     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 256
* EL130.cbl
 13348
 13349     MOVE AL-UNNON               TO LCVBENEA.
 13350
 13351     IF CM-POLICY-FORM-NO NOT = SPACES
 13352         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 13353     ELSE
 13354         MOVE WS-FORM-HOLD       TO LCVFORMO
 13355     END-IF.
 13356
 13357     MOVE SPACES                 TO WS-FORM-HOLD.
 13358     MOVE 'L'                    TO WS-REC-TYPE.
 13359     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 13360
 13361     IF WS-FORM-HOLD NOT = SPACES
 13362         MOVE WS-FORM-HOLD       TO LCVFORMO
 13363         MOVE AL-UANON           TO LCVFORMA
 13364     END-IF.
 13365
 13366     IF CM-LF-CURRENT-STATUS = '8'
 13367         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 13368             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 13369             MOVE ' '             TO DC-OPTION-CODE
 13370             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13371             IF NOT DATE-CONVERSION-ERROR
 13372                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13373                 MOVE AL-UANON            TO LCVCNDTA
 13374             END-IF
 13375         END-IF
 13376     END-IF.
 13377
 13378     IF CM-LF-CURRENT-STATUS = '7'
 13379         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13380             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 13381             MOVE ' '            TO DC-OPTION-CODE
 13382             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13383             IF NOT DATE-CONVERSION-ERROR
 13384                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 13385                 MOVE AL-UANON   TO LCVCNDTA
 13386             END-IF
 13387         END-IF
 13388     END-IF.
 13389
 13390     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 13391         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 13392             MOVE ' '            TO DC-OPTION-CODE
 13393             MOVE CM-LF-DEATH-EXIT-DT
 13394                                 TO DC-BIN-DATE-1
 13395             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13396             IF NOT DATE-CONVERSION-ERROR
 13397                 MOVE DC-GREG-DATE-1-EDIT
 13398                                 TO LCVEXITO
 13399             END-IF
 13400         END-IF
 13401     END-IF.
 13402
 13403     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 13404         IF CP-REMAINING-TERM-3 = ZEROS
 13405             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 257
* EL130.cbl
 13406         ELSE
 13407             MOVE 'ACTIVE'       TO LCVSTATO
 13408         END-IF
 13409     END-IF.
 13410
 13411     IF CM-LF-CURRENT-STATUS = '2'
 13412        MOVE 'PEND  '            TO LCVSTATO
 13413     END-IF.
 13414     IF CM-LF-CURRENT-STATUS = '3'
 13415        MOVE 'RESTORE'           TO LCVSTATO
 13416     END-IF.
 13417     IF CM-LF-CURRENT-STATUS = '5'
 13418        MOVE 'REISSUE'           TO LCVSTATO
 13419     END-IF.
 13420     IF CM-LF-CURRENT-STATUS = '6'
 13421        MOVE 'LMP DIS'           TO LCVSTATO
 13422     END-IF.
 13423     IF CM-LF-CURRENT-STATUS = '7'
 13424        MOVE 'DEATH  '           TO LCVSTATO
 13425     END-IF.
 13426     IF CM-LF-CURRENT-STATUS = '8'
 13427        MOVE 'CANCEL '           TO LCVSTATO
 13428     END-IF.
 13429     IF CM-LF-CURRENT-STATUS = '9'
 13430        MOVE 'RE-ONLY'           TO LCVSTATO
 13431     END-IF.
 13432     IF CM-LF-CURRENT-STATUS = 'V'
 13433        MOVE 'VOID   '           TO LCVSTATO
 13434     END-IF.
 13435     IF CM-LF-CURRENT-STATUS = 'D'
 13436        MOVE 'DECLINE'           TO LCVSTATO
 13437     END-IF.
 13438
 13439     IF PI-COMPANY-ID = 'CID'
 13440         IF CM-LF-BENEFIT-CD >= '2O' AND
 13441            CM-LF-BENEFIT-CD <= '2V'
 13442             MOVE ER-0878       TO EMI-ERROR
 13443             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13444         END-IF
 13445     END-IF.
 13446
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 258
* EL130.cbl
 13448 7060-FILL-AH-COVERAGE.
 13449
 13450     IF CM-AH-BENEFIT-CD = '00'
 13451         MOVE ZEROS              TO ACVOTRMO
 13452                                    ACVRTRMO
 13453                                    ACVRATEO
 13454                                    ACVBENEO
 13455         MOVE SPACES             TO ACVDSCRO
 13456                                    ACVCDO
 13457                                    ACVKINDO
 13458                                    ACVFORMO
 13459                                    ACVCNDTO
 13460                                    ACVEXITO
 13461                                    ACVSTATO
 13462         IF (CLMTYPEL GREATER THAN ZERO AND
 13463             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'))
 13464             MOVE ER-0521     TO EMI-ERROR
 13465             MOVE AL-UABON    TO CLMTYPEA
 13466             MOVE -1          TO CLMTYPEL
 13467             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13468             GO TO 7070-BUILD-MAP-FINISH
 13469         ELSE
 13470             GO TO 7070-BUILD-MAP-FINISH
 13471         END-IF
 13472     END-IF.
 13473
 13474     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13475     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 13476     MOVE AL-UANON               TO ACVDSCRA
 13477                                    ACVCDA.
 13478     MOVE '5'                    TO WS-REC-TYPE.
 13479     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 13480     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 13481
 13482     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 13483                                    CP-ORIGINAL-TERM.
 13484     MOVE AL-UNNON               TO ACVOTRMA.
 13485
 13486     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13487     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13488     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 13489     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13490     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13491     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13492
 13493     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 13494     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13495
 13496     IF CM-AH-PREMIUM-RATE NUMERIC
 13497         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13498     ELSE
 13499         MOVE ZEROS              TO ACVRATEO
 13500     END-IF.
 13501
 13502     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 13503     MOVE AL-UNNON               TO ACVRATEA
 13504                                    ACVBENEA.
 13505
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 259
* EL130.cbl
 13506     IF CM-POLICY-FORM-NO NOT = SPACES
 13507         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 13508     ELSE
 13509         MOVE WS-FORM-HOLD       TO ACVFORMO
 13510         MOVE SPACES TO WS-FORM-HOLD
 13511         MOVE 'A'                TO WS-REC-TYPE
 13512         PERFORM 7400-READ-STATE THRU 7499-EXIT
 13513         IF WS-FORM-HOLD NOT = SPACES
 13514             MOVE WS-FORM-HOLD   TO ACVFORMO
 13515         END-IF
 13516     END-IF.
 13517
 13518     MOVE AL-UANON               TO ACVFORMA.
 13519
 13520     IF CM-AH-CURRENT-STATUS = '8'
 13521         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 13522             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13523             MOVE ' '             TO DC-OPTION-CODE
 13524             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13525             IF NOT DATE-CONVERSION-ERROR
 13526                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13527                MOVE AL-UANON    TO ACVCNDTA
 13528             END-IF
 13529         END-IF
 13530     END-IF.
 13531
 13532     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13533         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13534             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 13535             MOVE ' '             TO DC-OPTION-CODE
 13536             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13537             IF NOT DATE-CONVERSION-ERROR
 13538                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 13539                MOVE AL-UANON            TO ACVCNDTA
 13540             END-IF
 13541         END-IF
 13542     END-IF.
 13543
 13544     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13545         MOVE ' '                TO DC-OPTION-CODE
 13546         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13547         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13548         IF NOT DATE-CONVERSION-ERROR
 13549             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 13550         END-IF
 13551     END-IF.
 13552
 13553     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13554         IF CP-REMAINING-TERM-3 = ZEROS
 13555             MOVE 'EXPIRED'      TO ACVSTATO
 13556         ELSE
 13557             MOVE 'ACTIVE'       TO ACVSTATO
 13558         END-IF
 13559     END-IF.
 13560
 13561     IF CM-AH-CURRENT-STATUS = '2'
 13562         MOVE 'PEND  '           TO ACVSTATO
 13563     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 260
* EL130.cbl
 13564     IF CM-AH-CURRENT-STATUS = '3'
 13565         MOVE 'RESTORE'          TO ACVSTATO
 13566     END-IF.
 13567     IF CM-AH-CURRENT-STATUS = '5'
 13568         MOVE 'REISSUE'          TO ACVSTATO
 13569     END-IF.
 13570     IF CM-AH-CURRENT-STATUS = '6'
 13571         MOVE 'LMP DIS'          TO ACVSTATO
 13572     END-IF.
 13573     IF CM-AH-CURRENT-STATUS = '7'
 13574         MOVE 'DEATH  '          TO ACVSTATO
 13575     END-IF.
 13576     IF CM-AH-CURRENT-STATUS = '8'
 13577         MOVE 'CANCEL '          TO ACVSTATO
 13578     END-IF.
 13579     IF CM-AH-CURRENT-STATUS = '9'
 13580         MOVE 'RE-ONLY'          TO ACVSTATO
 13581     END-IF.
 13582     IF CM-AH-CURRENT-STATUS = 'V'
 13583         MOVE 'VOID   '          TO ACVSTATO
 13584     END-IF.
 13585     IF CM-AH-CURRENT-STATUS = 'D'
 13586         MOVE 'DECLINE'          TO ACVSTATO
 13587     END-IF.
 13588
 13589     IF PI-COMPANY-ID = 'DCC'
 13590        IF CM-ACCOUNT (9:2) = 'BI'
 13591           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 13592           MOVE CM-CARRIER       TO CTRLR-CARRIER
 13593           MOVE CM-GROUPING      TO CTRLR-GROUPING
 13594           MOVE CM-STATE         TO CTRLR-STATE
 13595           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 13596           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 13597           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 13598           MOVE 'C'              TO CTRLR-REC-TYPE
 13599
 13600* EXEC CICS READ
 13601*            DATASET  (ELCRTT-DSID)
 13602*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13603*            RIDFLD   (ELCRTT-KEY)
 13604*            RESP     (WS-RESPONSE)
 13605*          END-EXEC
 13606*    MOVE '&"S        E          (  N#00012403' TO DFHEIV0
 13607     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13608     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13609     MOVE X'204E233030303132343033' TO DFHEIV0(25:11)
 13610     CALL 'kxdfhei1' USING DFHEIV0,
 13611           ELCRTT-DSID,
 13612           DFHEIV20,
 13613           DFHEIV99,
 13614           ELCRTT-KEY,
 13615           DFHEIV99,
 13616           DFHEIV99,
 13617           DFHEIV99
 13618     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13619         DFHEIV20
 13620     MOVE EIBRESP  TO WS-RESPONSE
 13621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 261
* EL130.cbl
 13622           IF WS-RESP-NORMAL
 13623               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 13624               MOVE WS-DIAG-VIN-MSG TO DIAGO
 13625               MOVE AL-UANON        TO DIAGA
 13626           END-IF
 13627        END-IF
 13628     END-IF.
 13629
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 262
* EL130.cbl
 13631 7070-BUILD-MAP-FINISH.
 13632     MOVE CM-LOAN-APR            TO APRO.
 13633     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 13634     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 13635     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 13636     MOVE AL-UNNON               TO APRA
 13637                                    PMTFREQA.
 13638     MOVE AL-UANON               TO INDGRPA
 13639                                    PREMTYPA.
 13640
 13641     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 13642         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 13643         MOVE AL-UANON               TO REINCDA
 13644     END-IF.
 13645
 13646     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 13647*        NEXT SENTENCE
 13648         CONTINUE
 13649     ELSE
 13650         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 13651         MOVE ' '                TO DC-OPTION-CODE
 13652         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13653         IF NOT DATE-CONVERSION-ERROR
 13654             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 13655             MOVE AL-UANON            TO ADDONDTA
 13656         END-IF
 13657     END-IF.
 13658
 13659     IF CLAIM-SWITCH = 'N'
 13660         IF SEXL = ZEROS
 13661             MOVE CM-INSURED-SEX TO SEXO
 13662             MOVE AL-UANON       TO SEXA
 13663         END-IF
 13664     END-IF.
 13665
 13666     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 13667         MOVE CM-MEMBER-NO       TO MEMBERO
 13668         MOVE AL-UANON           TO MEMBERA
 13669     END-IF.
 13670
 13671     IF MAINTI = 'A'
 13672         IF (LOANNOL = ZEROS OR
 13673             EIBAID = DFHPF5)
 13674             MOVE CM-LOAN-NUMBER TO LOANNOO
 13675             MOVE AL-UANON       TO LOANNOA
 13676         ELSE
 13677*            NEXT SENTENCE
 13678             CONTINUE
 13679         END-IF
 13680     ELSE
 13681         MOVE CM-LOAN-NUMBER     TO LOANNOO
 13682         MOVE AL-UANON           TO LOANNOA
 13683     END-IF.
 13684
 13685     IF MAINTI = 'A'
 13686         IF (LOANBALL = ZEROS OR
 13687             EIBAID = DFHPF5)
 13688             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 263
* EL130.cbl
 13689             MOVE AL-UNNON       TO LOANBALA
 13690         ELSE
 13691*            NEXT SENTENCE
 13692             CONTINUE
 13693         END-IF
 13694     ELSE
 13695         MOVE CM-LOAN-BALANCE    TO LOANBALO
 13696         MOVE AL-UNNON           TO LOANBALA
 13697     END-IF.
 13698
 13699     IF CM-PREMIUM-TYPE NOT = '3'
 13700         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 13701             PERFORM 7200-PROTECT-CERT-FIELDS
 13702         ELSE
 13703             PERFORM 7300-RESET-KEY-ATTRBS
 13704         END-IF
 13705     ELSE
 13706         PERFORM 7300-RESET-KEY-ATTRBS
 13707     END-IF.
 13708
 13709*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 13710*        NEXT SENTENCE
 13711*        CONTINUE
 13712*    ELSE
 13713         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 13714*    END-IF.
 13715
 13716 7099-EXIT.
 13717     EXIT.
 13718
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 264
* EL130.cbl
 13720 7100-READ-BENEFIT.
 13721
 13722
 13723* EXEC CICS HANDLE CONDITION
 13724*         NOTFND   (7120-NOT-FOUND)
 13725*    END-EXEC.
 13726*    MOVE '"$I                   ! E #00012509' TO DFHEIV0
 13727     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13728     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13729     MOVE X'4520233030303132353039' TO DFHEIV0(25:11)
 13730     CALL 'kxdfhei1' USING DFHEIV0
 13731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13732
 13733
 13734     MOVE SPACES                 TO ELCNTL-KEY.
 13735     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 13736     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 13737     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13738     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13739
 13740 7105-READ-FILE.
 13741     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 13742
 13743     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 13744        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 13745          GO TO 7120-NOT-FOUND
 13746     END-IF.
 13747
 13748     MOVE 1                      TO SUB.
 13749 7110-LOOP.
 13750     IF SUB = 9
 13751         GO TO 7120-NOT-FOUND
 13752     END-IF.
 13753
 13754     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 13755         ADD 1                   TO SUB
 13756         GO TO 7110-LOOP
 13757     END-IF.
 13758
 13759     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 13760     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 13761     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 13762
 13763     GO TO 7199-EXIT.
 13764
 13765 7120-NOT-FOUND.
 13766     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 13767                                    WS-FORM-HOLD.
 13768
 13769 7199-EXIT.
 13770      EXIT.
 13771
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 265
* EL130.cbl
 13773 7200-PROTECT-CERT-FIELDS.
 13774     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 13775                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 13776                                LCVFORMA ACVFORMA JNTLNMEA
 13777                                JNTFNMEA JNTINITA.
 13778
 13779     IF CM-LF-CURRENT-STATUS = '2' OR
 13780        CM-AH-CURRENT-STATUS = '2'
 13781         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 13782     END-IF.
 13783
 13784     MOVE AL-SANOF TO
 13785            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 13786            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 13787            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 13788            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 13789            LCVRATEA   ACVRATEA.
 13790
 13791     MOVE 'S'                    TO CERTMTI.
 13792
 13793 7300-RESET-KEY-ATTRBS.
 13794     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 13795                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 13796                                LCVFORMA ACVFORMA JNTLNMEA
 13797                                JNTFNMEA JNTINITA.
 13798
 13799     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 13800         MOVE AL-SANOF           TO REINCDA
 13801     END-IF.
 13802
 13803     MOVE 'S'                    TO CERTMTI.
 13804
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 266
* EL130.cbl
 13806 7400-READ-STATE.
 13807
 13808
 13809* EXEC CICS HANDLE CONDITION
 13810*         NOTFND   (7499-EXIT)
 13811*    END-EXEC.
 13812*    MOVE '"$I                   ! F #00012587' TO DFHEIV0
 13813     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13814     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13815     MOVE X'4620233030303132353837' TO DFHEIV0(25:11)
 13816     CALL 'kxdfhei1' USING DFHEIV0
 13817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13818
 13819
 13820     MOVE SPACES                 TO ELCNTL-KEY.
 13821     MOVE CM-STATE               TO CNTL-ACCESS.
 13822     MOVE '3'                    TO CNTL-REC-TYPE.
 13823     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13824     MOVE ZEROS                  TO CNTL-SEQ-NO.
 13825
 13826     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13827
 13828     MOVE 1                      TO SUB.
 13829
 13830 7410-LOOP.
 13831     IF SUB = 21
 13832        GO TO 7499-EXIT
 13833     END-IF.
 13834
 13835*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 13836*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 13837*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 13838*        GO TO 7499-EXIT.
 13839
 13840     ADD 1                       TO SUB.
 13841     GO TO 7410-LOOP.
 13842
 13843 7499-EXIT.
 13844      EXIT.
 13845
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 267
* EL130.cbl
 13847 7500-BROWSE-FOR-DUPLICATE.
 13848
 13849     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 13850
 13851
 13852
 13853* EXEC CICS HANDLE CONDITION
 13854*        NOTFND   (7500-EXIT)
 13855*        DUPKEY   (7500-DUPLICATE-KEY)
 13856*        ENDFILE  (7500-EXIT)
 13857*    END-EXEC.
 13858*    MOVE '"$I$''                 ! G #00012623' TO DFHEIV0
 13859     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 13860     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13861     MOVE X'4720233030303132363233' TO DFHEIV0(25:11)
 13862     CALL 'kxdfhei1' USING DFHEIV0
 13863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13864
 13865
 13866
 13867
 13868* EXEC CICS STARTBR
 13869*        DATASET    (ELMSTR5-DSID)
 13870*        RIDFLD     (ELMSTR5-KEY)
 13871*    END-EXEC.
 13872     MOVE 0
 13873       TO DFHEIV11
 13874*    MOVE '&,         G          &   #00012630' TO DFHEIV0
 13875     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13876     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13877     MOVE X'2020233030303132363330' TO DFHEIV0(25:11)
 13878     CALL 'kxdfhei1' USING DFHEIV0,
 13879           ELMSTR5-DSID,
 13880           ELMSTR5-KEY,
 13881           DFHEIV99,
 13882           DFHEIV11,
 13883           DFHEIV99
 13884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13885
 13886
 13887
 13888
 13889* EXEC CICS HANDLE CONDITION
 13890*        ENDFILE  (7500-END-BROWSE)
 13891*    END-EXEC.
 13892*    MOVE '"$''                   ! H #00012636' TO DFHEIV0
 13893     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 13894     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13895     MOVE X'4820233030303132363336' TO DFHEIV0(25:11)
 13896     CALL 'kxdfhei1' USING DFHEIV0
 13897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13898
 13899
 13900 7500-READ-CLAIM-LOOP.
 13901
 13902
 13903
 13904* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 268
* EL130.cbl
 13905*        DATASET   (ELMSTR5-DSID)
 13906*        SET       (ADDRESS OF CLAIM-MASTER)
 13907*        RIDFLD    (ELMSTR5-KEY)
 13908*    END-EXEC.
 13909     MOVE 0
 13910       TO DFHEIV11
 13911*    MOVE '&.S                   )   #00012643' TO DFHEIV0
 13912     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13913     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13914     MOVE X'2020233030303132363433' TO DFHEIV0(25:11)
 13915     CALL 'kxdfhei1' USING DFHEIV0,
 13916           ELMSTR5-DSID,
 13917           DFHEIV20,
 13918           DFHEIV99,
 13919           ELMSTR5-KEY,
 13920           DFHEIV99,
 13921           DFHEIV11,
 13922           DFHEIV99,
 13923           DFHEIV99
 13924     SET ADDRESS OF CLAIM-MASTER TO
 13925         DFHEIV20
 13926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13927
 13928
 13929 7500-DUPLICATE-KEY.
 13930
 13931     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 13932        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 13933        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 13934        CL-CERT-STATE     NOT = CM-STATE       OR
 13935        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 13936        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 13937        CL-CERT-NO        NOT = CM-CERT-NO
 13938           GO TO 7500-CHECK-MATCH-COUNT
 13939     END-IF.
 13940
 13941     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 13942
 13943     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 13944        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 13945        GO TO 7500-END-BROWSE
 13946     ELSE
 13947        GO TO 7500-READ-CLAIM-LOOP
 13948     END-IF.
 13949
 13950 7500-CHECK-MATCH-COUNT.
 13951
 13952     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 13953        CL-CERT-NO    = CM-CERT-NO
 13954          GO TO 7500-READ-CLAIM-LOOP
 13955     END-IF.
 13956
 13957 7500-END-BROWSE.
 13958
 13959
 13960
 13961* EXEC CICS ENDBR
 13962*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 269
* EL130.cbl
 13963*    END-EXEC.
 13964     MOVE 0
 13965       TO DFHEIV11
 13966*    MOVE '&2                    $   #00012680' TO DFHEIV0
 13967     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13968     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13969     MOVE X'2020233030303132363830' TO DFHEIV0(25:11)
 13970     CALL 'kxdfhei1' USING DFHEIV0,
 13971           ELMSTR5-DSID,
 13972           DFHEIV11,
 13973           DFHEIV99
 13974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13975
 13976
 13977 7500-EXIT.
 13978     EXIT.
 13979
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 270
* EL130.cbl
 13981 7550-FALL-THRU-PARA.
 13982
 13983
 13984
 13985* EXEC CICS DUMP
 13986*         DUMPCODE ('E130')
 13987*         TASK
 13988*    END-EXEC.
 13989     MOVE 'E130' TO DFHEIV5
 13990*    MOVE '<"   T                $   #00012691' TO DFHEIV0
 13991     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 13992     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13993     MOVE X'2020233030303132363931' TO DFHEIV0(25:11)
 13994     CALL 'kxdfhei1' USING DFHEIV0,
 13995           DFHEIV5,
 13996           DFHEIV99,
 13997           DFHEIV99
 13998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13999
 14000
 14001
 14002
 14003* EXEC CICS RETURN
 14004*    END-EXEC.
 14005*    MOVE '.(                    &   #00012697' TO DFHEIV0
 14006     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 14007     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14008     MOVE X'2020233030303132363937' TO DFHEIV0(25:11)
 14009     CALL 'kxdfhei1' USING DFHEIV0,
 14010           DFHEIV99,
 14011           DFHEIV99,
 14012           DFHEIV99,
 14013           DFHEIV99,
 14014           DFHEIV99
 14015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14016
 14017
 14018 7600-BROWSE-CLAIM.
 14019
 14020
 14021
 14022* EXEC CICS READ
 14023*        DATASET(ELMSTR-DSID)
 14024*        SET    (ADDRESS OF CLAIM-MASTER)
 14025*        RIDFLD (ELMSTR-KEY)
 14026*        GENERIC
 14027*        EQUAL
 14028*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14029*    END-EXEC.
 14030*    MOVE '&"S  KG    E          (   #00012703' TO DFHEIV0
 14031     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14032     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14033     MOVE X'2020233030303132373033' TO DFHEIV0(25:11)
 14034     CALL 'kxdfhei1' USING DFHEIV0,
 14035           ELMSTR-DSID,
 14036           DFHEIV20,
 14037           DFHEIV99,
 14038           ELMSTR-KEY,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 271
* EL130.cbl
 14039           ELMSTR-GENERIC-LENGTH,
 14040           DFHEIV99,
 14041           DFHEIV99
 14042     SET ADDRESS OF CLAIM-MASTER TO
 14043         DFHEIV20
 14044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14045
 14046
 14047     MOVE CL-CERT-PRIME          TO CERTNOI.
 14048     MOVE CL-CERT-SFX            TO SUFXI.
 14049
 14050 7610-BROWSE-CLAIM-LOOP.
 14051
 14052     MOVE LOW-VALUES             TO BCERT1O
 14053                                    BSUFX1O
 14054                                    BCERT2O
 14055                                    BSUFX2O
 14056                                    BCERT3O
 14057                                    BSUFX3O
 14058                                    BCERT4O
 14059                                    BSUFX4O
 14060                                    BCERT5O
 14061                                    BSUFX5O.
 14062
 14063     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 14064
 14065
 14066
 14067* EXEC CICS HANDLE CONDITION
 14068*        ENDFILE  (7630-END-BROWSE)
 14069*    END-EXEC.
 14070*    MOVE '"$''                   ! I #00012731' TO DFHEIV0
 14071     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14073     MOVE X'4920233030303132373331' TO DFHEIV0(25:11)
 14074     CALL 'kxdfhei1' USING DFHEIV0
 14075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14076
 14077
 14078
 14079
 14080* EXEC CICS STARTBR
 14081*        DATASET    (ELMSTR-DSID)
 14082*        RIDFLD     (ELMSTR-KEY)
 14083*    END-EXEC.
 14084     MOVE 0
 14085       TO DFHEIV11
 14086*    MOVE '&,         G          &   #00012736' TO DFHEIV0
 14087     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14088     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14089     MOVE X'2020233030303132373336' TO DFHEIV0(25:11)
 14090     CALL 'kxdfhei1' USING DFHEIV0,
 14091           ELMSTR-DSID,
 14092           ELMSTR-KEY,
 14093           DFHEIV99,
 14094           DFHEIV11,
 14095           DFHEIV99
 14096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 272
* EL130.cbl
 14097
 14098
 14099     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14100
 14101 7620-READ-CLAIM-LOOP.
 14102
 14103
 14104
 14105* EXEC CICS READNEXT
 14106*        DATASET   (ELMSTR-DSID)
 14107*        SET       (ADDRESS OF CLAIM-MASTER)
 14108*        RIDFLD    (ELMSTR-KEY)
 14109*    END-EXEC.
 14110     MOVE 0
 14111       TO DFHEIV11
 14112*    MOVE '&.S                   )   #00012746' TO DFHEIV0
 14113     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14114     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14115     MOVE X'2020233030303132373436' TO DFHEIV0(25:11)
 14116     CALL 'kxdfhei1' USING DFHEIV0,
 14117           ELMSTR-DSID,
 14118           DFHEIV20,
 14119           DFHEIV99,
 14120           ELMSTR-KEY,
 14121           DFHEIV99,
 14122           DFHEIV11,
 14123           DFHEIV99,
 14124           DFHEIV99
 14125     SET ADDRESS OF CLAIM-MASTER TO
 14126         DFHEIV20
 14127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14128
 14129
 14130     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 14131        CL-CARRIER     NOT = CLMCARRI       OR
 14132        CL-CLAIM-NO    NOT = CLMNOI
 14133          GO TO 7630-END-BROWSE
 14134     END-IF.
 14135
 14136     IF WS-ASSOCIATED-CERTS = 1
 14137         MOVE CL-CERT-PRIME      TO BCERT1O
 14138         MOVE CL-CERT-SFX        TO BSUFX1O
 14139     END-IF.
 14140
 14141     IF WS-ASSOCIATED-CERTS = 2
 14142         MOVE CL-CERT-PRIME      TO BCERT2O
 14143         MOVE CL-CERT-SFX        TO BSUFX2O
 14144     END-IF.
 14145
 14146     IF WS-ASSOCIATED-CERTS = 3
 14147         MOVE CL-CERT-PRIME      TO BCERT3O
 14148         MOVE CL-CERT-SFX        TO BSUFX3O
 14149     END-IF.
 14150
 14151     IF WS-ASSOCIATED-CERTS = 4
 14152         MOVE CL-CERT-PRIME      TO BCERT4O
 14153         MOVE CL-CERT-SFX        TO BSUFX4O
 14154     END-IF.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 273
* EL130.cbl
 14155
 14156     IF WS-ASSOCIATED-CERTS = 5
 14157         MOVE CL-CERT-PRIME      TO BCERT5O
 14158         MOVE CL-CERT-SFX        TO BSUFX5O
 14159     ELSE
 14160         ADD +1                  TO WS-ASSOCIATED-CERTS
 14161         GO TO 7620-READ-CLAIM-LOOP
 14162     END-IF.
 14163
 14164 7630-END-BROWSE.
 14165
 14166
 14167
 14168* EXEC CICS ENDBR
 14169*        DATASET   (ELMSTR-DSID)
 14170*    END-EXEC.
 14171     MOVE 0
 14172       TO DFHEIV11
 14173*    MOVE '&2                    $   #00012789' TO DFHEIV0
 14174     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14175     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14176     MOVE X'2020233030303132373839' TO DFHEIV0(25:11)
 14177     CALL 'kxdfhei1' USING DFHEIV0,
 14178           ELMSTR-DSID,
 14179           DFHEIV11,
 14180           DFHEIV99
 14181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14182
 14183
 14184 7640-HIGHLIGHT-CERT-DISPLAYED.
 14185
 14186     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 14187     MOVE AL-SANON               TO BCERT1A
 14188                                    BSUFX1A
 14189                                    BCERT2A
 14190                                    BSUFX2A
 14191                                    BCERT3A
 14192                                    BSUFX3A
 14193                                    BCERT4A
 14194                                    BSUFX4A
 14195                                    BCERT5A
 14196                                    BSUFX5A.
 14197
 14198     IF BCERT1O = CERTNOI AND
 14199        BSUFX1O = SUFXI
 14200            MOVE AL-SABON        TO BCERT1A
 14201                                    BSUFX1A
 14202     END-IF.
 14203
 14204     IF BCERT2O = CERTNOI AND
 14205        BSUFX2O = SUFXI
 14206            MOVE AL-SABON        TO BCERT2A
 14207                                    BSUFX2A
 14208     END-IF.
 14209
 14210     IF BCERT3O = CERTNOI AND
 14211        BSUFX3O = SUFXI
 14212            MOVE AL-SABON        TO BCERT3A
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 274
* EL130.cbl
 14213                                    BSUFX3A
 14214     END-IF.
 14215
 14216     IF BCERT4O = CERTNOI AND
 14217        BSUFX4O = SUFXI
 14218            MOVE AL-SABON        TO BCERT4A
 14219                                    BSUFX4A
 14220     END-IF.
 14221
 14222     IF BCERT5O = CERTNOI AND
 14223        BSUFX5O = SUFXI
 14224            MOVE AL-SABON        TO BCERT5A
 14225                                    BSUFX5A
 14226     END-IF.
 14227
 14228 7699-EXIT.
 14229     EXIT.
 14230
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 275
* EL130.cbl
 14232 7700-CHECK-SEQUENCE.
 14233
 14234
 14235
 14236* EXEC CICS HANDLE CONDITION
 14237*        ENDFILE  (7799-EXIT)
 14238*        NOTFND   (7799-EXIT)
 14239*    END-EXEC.
 14240*    MOVE '"$''I                  ! J #00012844' TO DFHEIV0
 14241     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14243     MOVE X'4A20233030303132383434' TO DFHEIV0(25:11)
 14244     CALL 'kxdfhei1' USING DFHEIV0
 14245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14246
 14247
 14248
 14249
 14250* EXEC CICS READ
 14251*        DATASET(ELMSTR-DSID)
 14252*        SET    (ADDRESS OF CLAIM-MASTER)
 14253*        RIDFLD (ELMSTR-KEY)
 14254*        GENERIC
 14255*        EQUAL
 14256*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14257*    END-EXEC.
 14258*    MOVE '&"S  KG    E          (   #00012850' TO DFHEIV0
 14259     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14260     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14261     MOVE X'2020233030303132383530' TO DFHEIV0(25:11)
 14262     CALL 'kxdfhei1' USING DFHEIV0,
 14263           ELMSTR-DSID,
 14264           DFHEIV20,
 14265           DFHEIV99,
 14266           ELMSTR-KEY,
 14267           ELMSTR-GENERIC-LENGTH,
 14268           DFHEIV99,
 14269           DFHEIV99
 14270     SET ADDRESS OF CLAIM-MASTER TO
 14271         DFHEIV20
 14272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14273
 14274
 14275     COMPUTE WS-ASSOC-CERT-TOTAL =
 14276             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14277
 14278     GO TO 7799-EXIT.
 14279
 14280 7710-RESEQUENCE-CLAIMS.
 14281
 14282
 14283
 14284* EXEC CICS HANDLE CONDITION
 14285*        ENDFILE  (7790-END-BROWSE)
 14286*    END-EXEC.
 14287*    MOVE '"$''                   ! K #00012867' TO DFHEIV0
 14288     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 276
* EL130.cbl
 14290     MOVE X'4B20233030303132383637' TO DFHEIV0(25:11)
 14291     CALL 'kxdfhei1' USING DFHEIV0
 14292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14293
 14294
 14295
 14296
 14297* EXEC CICS STARTBR
 14298*        DATASET    (ELMSTR-DSID)
 14299*        RIDFLD     (ELMSTR-KEY)
 14300*    END-EXEC.
 14301     MOVE 0
 14302       TO DFHEIV11
 14303*    MOVE '&,         G          &   #00012872' TO DFHEIV0
 14304     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14305     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14306     MOVE X'2020233030303132383732' TO DFHEIV0(25:11)
 14307     CALL 'kxdfhei1' USING DFHEIV0,
 14308           ELMSTR-DSID,
 14309           ELMSTR-KEY,
 14310           DFHEIV99,
 14311           DFHEIV11,
 14312           DFHEIV99
 14313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14314
 14315
 14316     ADD +1 TO WS-ASSOC-CERT-SEQU
 14317               WS-READNEXT-SWITCH.
 14318
 14319 7720-READ-CLAIM-LOOP.
 14320
 14321
 14322
 14323* EXEC CICS READNEXT
 14324*        DATASET   (ELMSTR-DSID)
 14325*        SET       (ADDRESS OF CLAIM-MASTER)
 14326*        RIDFLD    (ELMSTR-KEY)
 14327*    END-EXEC.
 14328     MOVE 0
 14329       TO DFHEIV11
 14330*    MOVE '&.S                   )   #00012883' TO DFHEIV0
 14331     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14332     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14333     MOVE X'2020233030303132383833' TO DFHEIV0(25:11)
 14334     CALL 'kxdfhei1' USING DFHEIV0,
 14335           ELMSTR-DSID,
 14336           DFHEIV20,
 14337           DFHEIV99,
 14338           ELMSTR-KEY,
 14339           DFHEIV99,
 14340           DFHEIV11,
 14341           DFHEIV99,
 14342           DFHEIV99
 14343     SET ADDRESS OF CLAIM-MASTER TO
 14344         DFHEIV20
 14345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14346
 14347
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 277
* EL130.cbl
 14348     IF WS-READNEXT-SWITCH = 1
 14349         ADD 1 TO WS-READNEXT-SWITCH
 14350         GO TO 7720-READ-CLAIM-LOOP
 14351     END-IF.
 14352
 14353 7730-END-BROWSE.
 14354
 14355
 14356
 14357* EXEC CICS ENDBR
 14358*        DATASET   (ELMSTR-DSID)
 14359*    END-EXEC.
 14360     MOVE 0
 14361       TO DFHEIV11
 14362*    MOVE '&2                    $   #00012897' TO DFHEIV0
 14363     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14364     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14365     MOVE X'2020233030303132383937' TO DFHEIV0(25:11)
 14366     CALL 'kxdfhei1' USING DFHEIV0,
 14367           ELMSTR-DSID,
 14368           DFHEIV11,
 14369           DFHEIV99
 14370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14371
 14372
 14373 7740-READ-CLAIM-UPDATE.
 14374
 14375     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 14376        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 14377        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 14378          GO TO 7799-EXIT
 14379     ELSE
 14380          MOVE ZERO              TO WS-READNEXT-SWITCH
 14381     END-IF.
 14382
 14383
 14384
 14385* EXEC CICS READ
 14386*        DATASET(ELMSTR-DSID)
 14387*        SET    (ADDRESS OF CLAIM-MASTER)
 14388*        RIDFLD (ELMSTR-KEY)
 14389*        UPDATE
 14390*    END-EXEC.
 14391*    MOVE '&"S        EU         (   #00012912' TO DFHEIV0
 14392     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14393     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14394     MOVE X'2020233030303132393132' TO DFHEIV0(25:11)
 14395     CALL 'kxdfhei1' USING DFHEIV0,
 14396           ELMSTR-DSID,
 14397           DFHEIV20,
 14398           DFHEIV99,
 14399           ELMSTR-KEY,
 14400           DFHEIV99,
 14401           DFHEIV99,
 14402           DFHEIV99
 14403     SET ADDRESS OF CLAIM-MASTER TO
 14404         DFHEIV20
 14405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 278
* EL130.cbl
 14406
 14407
 14408     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 14409     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 14410
 14411
 14412
 14413* EXEC CICS REWRITE
 14414*         DATASET     (ELMSTR-DSID)
 14415*         FROM        (CLAIM-MASTER)
 14416*    END-EXEC.
 14417     MOVE LENGTH OF
 14418      CLAIM-MASTER
 14419       TO DFHEIV11
 14420*    MOVE '&& L                  %   #00012923' TO DFHEIV0
 14421     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14422     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14423     MOVE X'2020233030303132393233' TO DFHEIV0(25:11)
 14424     CALL 'kxdfhei1' USING DFHEIV0,
 14425           ELMSTR-DSID,
 14426           CLAIM-MASTER,
 14427           DFHEIV11,
 14428           DFHEIV99
 14429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14430
 14431
 14432     GO TO 7710-RESEQUENCE-CLAIMS.
 14433
 14434 7790-END-BROWSE.
 14435
 14436
 14437
 14438* EXEC CICS ENDBR
 14439*        DATASET   (ELMSTR-DSID)
 14440*    END-EXEC.
 14441     MOVE 0
 14442       TO DFHEIV11
 14443*    MOVE '&2                    $   #00012933' TO DFHEIV0
 14444     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14445     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14446     MOVE X'2020233030303132393333' TO DFHEIV0(25:11)
 14447     CALL 'kxdfhei1' USING DFHEIV0,
 14448           ELMSTR-DSID,
 14449           DFHEIV11,
 14450           DFHEIV99
 14451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14452
 14453
 14454 7799-EXIT.
 14455     EXIT.
 14456
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 279
* EL130.cbl
 14458************************************************
 14459*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 14460************************************************
 14461
 14462 7900-READ-ACTV-UPDATE.
 14463     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14464     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14465     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14466     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14467     MOVE +0                     TO TRLR-SEQ-NO.
 14468     MOVE '1'                    TO TRLR-TYPE.
 14469     GO TO 7900-READ-TRAILER-UPDATE.
 14470
 14471 7900-READ-NINETY-UPDATE.
 14472     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14473     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14474     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14475     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14476     MOVE +90                    TO TRLR-SEQ-NO.
 14477     MOVE '6'                    TO TRLR-TYPE.
 14478
 14479 7900-READ-TRAILER-UPDATE.
 14480
 14481
 14482* EXEC CICS READ  UPDATE
 14483*        DATASET    (ELTRLR-DSID)
 14484*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 14485*        RIDFLD     (ELTRLR-KEY)
 14486*    END-EXEC.
 14487*    MOVE '&"S        EU         (   #00012964' TO DFHEIV0
 14488     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14489     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14490     MOVE X'2020233030303132393634' TO DFHEIV0(25:11)
 14491     CALL 'kxdfhei1' USING DFHEIV0,
 14492           ELTRLR-DSID,
 14493           DFHEIV20,
 14494           DFHEIV99,
 14495           ELTRLR-KEY,
 14496           DFHEIV99,
 14497           DFHEIV99,
 14498           DFHEIV99
 14499     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14500         DFHEIV20
 14501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14502
 14503
 14504 7900-EXIT.
 14505      EXIT.
 14506
 14507 7910-READ-ACTV.
 14508     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14509     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14510     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14511     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14512     MOVE +0                     TO TRLR-SEQ-NO.
 14513     MOVE '1'                    TO TRLR-TYPE.
 14514     GO TO 7910-READ-TRAILER.
 14515
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 280
* EL130.cbl
 14516 7910-READ-NINETY.
 14517     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 14518     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 14519     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 14520     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 14521     MOVE +90                    TO TRLR-SEQ-NO.
 14522     MOVE '6'                    TO TRLR-TYPE.
 14523
 14524 7910-READ-TRAILER.
 14525     MOVE 'TRLR'                 TO FILE-SWITCH.
 14526
 14527
 14528
 14529* EXEC CICS READ
 14530*        DATASET   (ELTRLR-DSID)
 14531*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 14532*        RIDFLD    (ELTRLR-KEY)
 14533*    END-EXEC.
 14534*    MOVE '&"S        E          (   #00012994' TO DFHEIV0
 14535     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14537     MOVE X'2020233030303132393934' TO DFHEIV0(25:11)
 14538     CALL 'kxdfhei1' USING DFHEIV0,
 14539           ELTRLR-DSID,
 14540           DFHEIV20,
 14541           DFHEIV99,
 14542           ELTRLR-KEY,
 14543           DFHEIV99,
 14544           DFHEIV99,
 14545           DFHEIV99
 14546     SET ADDRESS OF ACTIVITY-TRAILERS TO
 14547         DFHEIV20
 14548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14549
 14550
 14551 7910-EXIT.
 14552      EXIT.
 14553
 14554 7915-REWRITE-TRAILER.
 14555
 14556
 14557* EXEC CICS REWRITE
 14558*        DATASET   (ELTRLR-DSID)
 14559*        FROM      (ACTIVITY-TRAILERS)
 14560*    END-EXEC.
 14561     MOVE LENGTH OF
 14562      ACTIVITY-TRAILERS
 14563       TO DFHEIV11
 14564*    MOVE '&& L                  %   #00013005' TO DFHEIV0
 14565     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14566     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14567     MOVE X'2020233030303133303035' TO DFHEIV0(25:11)
 14568     CALL 'kxdfhei1' USING DFHEIV0,
 14569           ELTRLR-DSID,
 14570           ACTIVITY-TRAILERS,
 14571           DFHEIV11,
 14572           DFHEIV99
 14573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 281
* EL130.cbl
 14574
 14575
 14576 7915-EXIT.
 14577      EXIT.
 14578
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 282
* EL130.cbl
 14580********************************************
 14581*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 14582********************************************
 14583
 14584 7920-READ-CLAIM-UPDATE.
 14585
 14586
 14587
 14588* EXEC CICS READ
 14589*        UPDATE
 14590*        DATASET   (ELMSTR-DSID)
 14591*        SET       (ADDRESS OF CLAIM-MASTER)
 14592*        RIDFLD    (ELMSTR-KEY)
 14593*    END-EXEC.
 14594*    MOVE '&"S        EU         (   #00013021' TO DFHEIV0
 14595     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14596     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14597     MOVE X'2020233030303133303231' TO DFHEIV0(25:11)
 14598     CALL 'kxdfhei1' USING DFHEIV0,
 14599           ELMSTR-DSID,
 14600           DFHEIV20,
 14601           DFHEIV99,
 14602           ELMSTR-KEY,
 14603           DFHEIV99,
 14604           DFHEIV99,
 14605           DFHEIV99
 14606     SET ADDRESS OF CLAIM-MASTER TO
 14607         DFHEIV20
 14608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14609
 14610
 14611 7920-EXIT.
 14612      EXIT.
 14613
 14614 7950-READ-CLAIM.
 14615
 14616
 14617* EXEC CICS READ
 14618*        DATASET   (ELMSTR-DSID)
 14619*        SET       (ADDRESS OF CLAIM-MASTER)
 14620*        RIDFLD    (ELMSTR-KEY)
 14621*    END-EXEC.
 14622*    MOVE '&"S        E          (   #00013033' TO DFHEIV0
 14623     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14624     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14625     MOVE X'2020233030303133303333' TO DFHEIV0(25:11)
 14626     CALL 'kxdfhei1' USING DFHEIV0,
 14627           ELMSTR-DSID,
 14628           DFHEIV20,
 14629           DFHEIV99,
 14630           ELMSTR-KEY,
 14631           DFHEIV99,
 14632           DFHEIV99,
 14633           DFHEIV99
 14634     SET ADDRESS OF CLAIM-MASTER TO
 14635         DFHEIV20
 14636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14637
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 283
* EL130.cbl
 14638
 14639 7950-EXIT.
 14640      EXIT.
 14641
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 284
* EL130.cbl
 14643***************************************
 14644*  I/O REQUESTS AGAINST CONTROL FILE  *
 14645***************************************
 14646
 14647 7960-READ-CNTL-UPDATE.
 14648
 14649
 14650* EXEC CICS READ
 14651*        UPDATE
 14652*        DATASET  (ELCNTL-DSID)
 14653*        SET      (ADDRESS OF CONTROL-FILE)
 14654*        RIDFLD   (ELCNTL-KEY)
 14655*    END-EXEC.
 14656*    MOVE '&"S        EU         (   #00013049' TO DFHEIV0
 14657     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14658     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14659     MOVE X'2020233030303133303439' TO DFHEIV0(25:11)
 14660     CALL 'kxdfhei1' USING DFHEIV0,
 14661           ELCNTL-DSID,
 14662           DFHEIV20,
 14663           DFHEIV99,
 14664           ELCNTL-KEY,
 14665           DFHEIV99,
 14666           DFHEIV99,
 14667           DFHEIV99
 14668     SET ADDRESS OF CONTROL-FILE TO
 14669         DFHEIV20
 14670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14671
 14672
 14673 7960-EXIT.
 14674      EXIT.
 14675
 14676 7970-READ-CNTL.
 14677
 14678
 14679* EXEC CICS READ
 14680*        DATASET  (ELCNTL-DSID)
 14681*        SET      (ADDRESS OF CONTROL-FILE)
 14682*        RIDFLD   (ELCNTL-KEY)
 14683*    END-EXEC.
 14684*    MOVE '&"S        E          (   #00013061' TO DFHEIV0
 14685     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14686     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14687     MOVE X'2020233030303133303631' TO DFHEIV0(25:11)
 14688     CALL 'kxdfhei1' USING DFHEIV0,
 14689           ELCNTL-DSID,
 14690           DFHEIV20,
 14691           DFHEIV99,
 14692           ELCNTL-KEY,
 14693           DFHEIV99,
 14694           DFHEIV99,
 14695           DFHEIV99
 14696     SET ADDRESS OF CONTROL-FILE TO
 14697         DFHEIV20
 14698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14699
 14700
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 285
* EL130.cbl
 14701 7970-EXIT.
 14702      EXIT.
 14703
 14704 7975-READ-CNTL-GTEQ.
 14705
 14706
 14707* EXEC CICS READ
 14708*         DATASET   (ELCNTL-DSID)
 14709*         SET       (ADDRESS OF CONTROL-FILE)
 14710*         RIDFLD    (ELCNTL-KEY)
 14711*         GTEQ
 14712*     END-EXEC.
 14713*    MOVE '&"S        G          (   #00013072' TO DFHEIV0
 14714     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14715     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14716     MOVE X'2020233030303133303732' TO DFHEIV0(25:11)
 14717     CALL 'kxdfhei1' USING DFHEIV0,
 14718           ELCNTL-DSID,
 14719           DFHEIV20,
 14720           DFHEIV99,
 14721           ELCNTL-KEY,
 14722           DFHEIV99,
 14723           DFHEIV99,
 14724           DFHEIV99
 14725     SET ADDRESS OF CONTROL-FILE TO
 14726         DFHEIV20
 14727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14728
 14729
 14730 7975-EXIT.
 14731      EXIT.
 14732
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 286
* EL130.cbl
 14734**************************************************
 14735*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 14736**************************************************
 14737
 14738 7980-READ-CERT5.
 14739
 14740
 14741* EXEC CICS READ
 14742*         DATASET  (ELCERT5-DSID)
 14743*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 14744*         RIDFLD   (ELCERT-KEY-5)
 14745*     END-EXEC.
 14746*    MOVE '&"S        E          (   #00013089' TO DFHEIV0
 14747     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14748     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14749     MOVE X'2020233030303133303839' TO DFHEIV0(25:11)
 14750     CALL 'kxdfhei1' USING DFHEIV0,
 14751           ELCERT5-DSID,
 14752           DFHEIV20,
 14753           DFHEIV99,
 14754           ELCERT-KEY-5,
 14755           DFHEIV99,
 14756           DFHEIV99,
 14757           DFHEIV99
 14758     SET ADDRESS OF CERTIFICATE-MASTER TO
 14759         DFHEIV20
 14760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14761
 14762
 14763 7980-EXIT.
 14764      EXIT.
 14765
 14766 7930-READ-CERT-UPDATE.
 14767
 14768
 14769* EXEC CICS READ
 14770*        DATASET  (ELCERT-DSID)
 14771*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 14772*        RIDFLD   (ELCERT-KEY)
 14773*        UPDATE
 14774*    END-EXEC.
 14775*    MOVE '&"S        EU         (   #00013100' TO DFHEIV0
 14776     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14777     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14778     MOVE X'2020233030303133313030' TO DFHEIV0(25:11)
 14779     CALL 'kxdfhei1' USING DFHEIV0,
 14780           ELCERT-DSID,
 14781           DFHEIV20,
 14782           DFHEIV99,
 14783           ELCERT-KEY,
 14784           DFHEIV99,
 14785           DFHEIV99,
 14786           DFHEIV99
 14787     SET ADDRESS OF CERTIFICATE-MASTER TO
 14788         DFHEIV20
 14789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14790
 14791
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 287
* EL130.cbl
 14792 7930-EXIT.
 14793      EXIT.
 14794
 14795 7940-READ-CERT.
 14796
 14797
 14798* EXEC CICS READ
 14799*        DATASET  (ELCERT-DSID)
 14800*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 14801*        RIDFLD   (ELCERT-KEY)
 14802*    END-EXEC.
 14803*    MOVE '&"S        E          (   #00013112' TO DFHEIV0
 14804     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14805     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14806     MOVE X'2020233030303133313132' TO DFHEIV0(25:11)
 14807     CALL 'kxdfhei1' USING DFHEIV0,
 14808           ELCERT-DSID,
 14809           DFHEIV20,
 14810           DFHEIV99,
 14811           ELCERT-KEY,
 14812           DFHEIV99,
 14813           DFHEIV99,
 14814           DFHEIV99
 14815     SET ADDRESS OF CERTIFICATE-MASTER TO
 14816         DFHEIV20
 14817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14818
 14819
 14820 7940-EXIT.
 14821      EXIT.
 14822
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 288
* EL130.cbl
 14824**************************************************
 14825*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 14826**************************************************
 14827
 14828 7991-READ-BENE.
 14829
 14830
 14831* EXEC CICS READ
 14832*         DATASET   (ELBENE-DSID)
 14833*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 14834*         RIDFLD    (ELBENE-KEY)
 14835*     END-EXEC.
 14836*    MOVE '&"S        E          (   #00013128' TO DFHEIV0
 14837     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14838     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14839     MOVE X'2020233030303133313238' TO DFHEIV0(25:11)
 14840     CALL 'kxdfhei1' USING DFHEIV0,
 14841           ELBENE-DSID,
 14842           DFHEIV20,
 14843           DFHEIV99,
 14844           ELBENE-KEY,
 14845           DFHEIV99,
 14846           DFHEIV99,
 14847           DFHEIV99
 14848     SET ADDRESS OF BENEFICIARY-MASTER TO
 14849         DFHEIV20
 14850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14851
 14852
 14853 7991-EXIT.
 14854      EXIT.
 14855
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 289
* EL130.cbl
 14857**************************************************
 14858*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 14859**************************************************
 14860
 14861 7992-READ-REIN.
 14862
 14863
 14864
 14865* EXEC CICS HANDLE CONDITION
 14866*        NOTFND   (7992-NOT-FOUND)
 14867*    END-EXEC.
 14868*    MOVE '"$I                   ! L #00013145' TO DFHEIV0
 14869     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14871     MOVE X'4C20233030303133313435' TO DFHEIV0(25:11)
 14872     CALL 'kxdfhei1' USING DFHEIV0
 14873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14874
 14875
 14876
 14877
 14878* EXEC CICS READ
 14879*        DATASET   (ERREIN-DSID)
 14880*        SET       (ADDRESS OF REINSURANCE-RECORD)
 14881*        RIDFLD    (ERREIN-KEY)
 14882*    END-EXEC.
 14883*    MOVE '&"S        E          (   #00013150' TO DFHEIV0
 14884     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14886     MOVE X'2020233030303133313530' TO DFHEIV0(25:11)
 14887     CALL 'kxdfhei1' USING DFHEIV0,
 14888           ERREIN-DSID,
 14889           DFHEIV20,
 14890           DFHEIV99,
 14891           ERREIN-KEY,
 14892           DFHEIV99,
 14893           DFHEIV99,
 14894           DFHEIV99
 14895     SET ADDRESS OF REINSURANCE-RECORD TO
 14896         DFHEIV20
 14897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14898
 14899
 14900     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 14901
 14902     GO TO 7992-EXIT.
 14903
 14904 7992-NOT-FOUND.
 14905     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 14906
 14907 7992-EXIT.
 14908     EXIT.
 14909
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 290
* EL130.cbl
 14911 8000-LOAD-ERROR-MESSAGES.
 14912     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 14913
 14914     IF EMI-NO-ERRORS
 14915         GO TO 8000-EXIT
 14916     END-IF.
 14917
 14918     IF EMI-NUMBER-OF-LINES = 1
 14919         MOVE EMI-LINE1          TO ERRMSG1O
 14920         GO TO 8000-EXIT
 14921     END-IF.
 14922
 14923     IF EMI-NUMBER-OF-LINES = 2
 14924          MOVE EMI-LINE1         TO ERRMSG1O
 14925          MOVE EMI-LINE2         TO ERRMSG2O
 14926          GO TO 8000-EXIT
 14927     END-IF.
 14928
 14929     MOVE EMI-LINE1              TO ERRMSG1O.
 14930
 14931 8000-EXIT.
 14932     EXIT.
 14933
 14934 8100-SEND-INITIAL-MAP.
 14935     MOVE SAVE-DATE              TO RUNDTEO.
 14936     MOVE EIBTIME                TO TIME-IN.
 14937     MOVE TIME-OUT               TO RUNTIMEO.
 14938     IF RETURNED-FROM = XCTL-114
 14939        CONTINUE
 14940     ELSE
 14941        MOVE -1                  TO MAINTL
 14942     END-IF.
 14943
 14944*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 14945         MOVE SPACES             TO PRODO.
 14946         MOVE AL-SANOF           TO PRODCDA.
 14947*    END-IF.
 14948
 14949     MOVE PI-COMPANY-ID          TO COMPO.
 14950     MOVE AL-PABOF               TO COMPA.
 14951     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 14952     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14953     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14954
 14955     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 14956
 14957     IF NOT PI-NO-CARRIER-SECURITY
 14958        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 14959        MOVE AL-SABOF            TO CLMCARRA
 14960     END-IF.
 14961
 14962     IF PI-PROCESSOR-ID = 'PEMA'
 14963        MOVE AL-UANON            TO CERTNOA
 14964                                    SUFXA
 14965     END-IF.
 14966*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 14967*        NEXT SENTENCE
 14968*        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 291
* EL130.cbl
 14969*    ELSE
 14970         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 14971*    END-IF.
 14972
 14973
 14974
 14975* EXEC CICS SEND
 14976*        MAP     (MAP-NAME)
 14977*        MAPSET  (MAPSET-NAME)
 14978*        FROM    (EL130AO)
 14979*        ERASE
 14980*        CURSOR
 14981*    END-EXEC.
 14982     MOVE LENGTH OF
 14983      EL130AO
 14984       TO DFHEIV12
 14985     MOVE -1
 14986       TO DFHEIV11
 14987*    MOVE '8$     CT  E    H L F ,   #00013230' TO DFHEIV0
 14988     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 14989     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 14990     MOVE X'2020233030303133323330' TO DFHEIV0(25:11)
 14991     CALL 'kxdfhei1' USING DFHEIV0,
 14992           MAP-NAME,
 14993           EL130AO,
 14994           DFHEIV12,
 14995           MAPSET-NAME,
 14996           DFHEIV99,
 14997           DFHEIV99,
 14998           DFHEIV99,
 14999           DFHEIV11,
 15000           DFHEIV99,
 15001           DFHEIV99,
 15002           DFHEIV99
 15003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15004
 15005
 15006     GO TO 9100-RETURN-TRAN.
 15007
 15008 8150-SEND-MAP-CURSOR.
 15009     MOVE SAVE-DATE              TO RUNDTEO.
 15010     MOVE EIBTIME                TO TIME-IN.
 15011     MOVE TIME-OUT               TO RUNTIMEO.
 15012     MOVE PI-COMPANY-ID          TO COMPO.
 15013     MOVE AL-PABOF               TO COMPA
 15014     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15015     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15016     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15017
 15018*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15019         MOVE SPACES             TO PRODO.
 15020         MOVE AL-SANOF           TO PRODCDA.
 15021*    END-IF.
 15022
 15023     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15024
 15025     IF NOT PI-NO-CARRIER-SECURITY
 15026         MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 292
* EL130.cbl
 15027         MOVE AL-SABOF            TO CLMCARRA
 15028     END-IF.
 15029
 15030     IF PI-PROCESSOR-ID = 'PEMA'
 15031        MOVE AL-UANON            TO CERTNOA
 15032                                    SUFXA
 15033     END-IF.
 15034*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15035*        NEXT SENTENCE
 15036*        CONTINUE
 15037*    ELSE
 15038         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15039*    END-IF.
 15040
 15041
 15042
 15043* EXEC CICS SEND
 15044*        MAP      (MAP-NAME)
 15045*        MAPSET   (MAPSET-NAME)
 15046*        FROM     (EL130AO)
 15047*        CURSOR   (PI-CURSOR)
 15048*        ERASE
 15049*    END-EXEC.
 15050     MOVE LENGTH OF
 15051      EL130AO
 15052       TO DFHEIV11
 15053*    MOVE '8$     CT  E    H L F ,   #00013274' TO DFHEIV0
 15054     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15055     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15056     MOVE X'2020233030303133323734' TO DFHEIV0(25:11)
 15057     CALL 'kxdfhei1' USING DFHEIV0,
 15058           MAP-NAME,
 15059           EL130AO,
 15060           DFHEIV11,
 15061           MAPSET-NAME,
 15062           DFHEIV99,
 15063           DFHEIV99,
 15064           DFHEIV99,
 15065           PI-CURSOR,
 15066           DFHEIV99,
 15067           DFHEIV99,
 15068           DFHEIV99
 15069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15070
 15071
 15072     GO TO 9100-RETURN-TRAN.
 15073
 15074 8200-SEND-DATAONLY.
 15075     IF EIBAID = DFHPF11
 15076        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 15077        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15078     END-IF.
 15079
 15080     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 15081
 15082 8200-BYPASS-ERROR.
 15083     MOVE SAVE-DATE              TO RUNDTEO.
 15084     MOVE EIBTIME                TO TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 293
* EL130.cbl
 15085     MOVE TIME-OUT               TO RUNTIMEO.
 15086     MOVE PI-COMPANY-ID          TO COMPO.
 15087     MOVE AL-PABOF               TO COMPA
 15088     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 15089
 15090*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 15091         MOVE SPACES             TO PRODO.
 15092         MOVE AL-SANOF           TO PRODCDA.
 15093*    END-IF.
 15094
 15095     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 15096     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 15097
 15098     IF PI-PROCESSOR-ID = 'PEMA'
 15099        MOVE AL-UANON            TO CERTNOA
 15100                                    SUFXA
 15101     END-IF.
 15102     IF NOT PI-NO-CARRIER-SECURITY
 15103        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 15104        MOVE AL-SABOF            TO CLMCARRA
 15105     END-IF.
 15106
 15107*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15108*        NEXT SENTENCE
 15109*        CONTINUE
 15110*    ELSE
 15111         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 15112*    END-IF.
 15113
 15114*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 15115         MOVE AL-SANOF           TO PRODCDA.
 15116*    END-IF.
 15117
 15118
 15119
 15120* EXEC CICS SEND
 15121*        MAP      (MAP-NAME)
 15122*        MAPSET   (MAPSET-NAME)
 15123*        FROM     (EL130AO)
 15124*        DATAONLY
 15125*        CURSOR
 15126*    END-EXEC.
 15127     MOVE LENGTH OF
 15128      EL130AO
 15129       TO DFHEIV12
 15130     MOVE -1
 15131       TO DFHEIV11
 15132*    MOVE '8$D    CT       H L F ,   #00013329' TO DFHEIV0
 15133     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15134     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15135     MOVE X'2020233030303133333239' TO DFHEIV0(25:11)
 15136     CALL 'kxdfhei1' USING DFHEIV0,
 15137           MAP-NAME,
 15138           EL130AO,
 15139           DFHEIV12,
 15140           MAPSET-NAME,
 15141           DFHEIV99,
 15142           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 294
* EL130.cbl
 15143           DFHEIV99,
 15144           DFHEIV11,
 15145           DFHEIV99,
 15146           DFHEIV99,
 15147           DFHEIV99
 15148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15149
 15150
 15151     GO TO 9100-RETURN-TRAN.
 15152
 15153 8300-SEND-TEXT.
 15154
 15155
 15156* EXEC CICS SEND TEXT
 15157*        FROM     (LOGOFF-TEXT)
 15158*        LENGTH   (LOGOFF-LENGTH)
 15159*        ERASE
 15160*        FREEKB
 15161*    END-EXEC.
 15162*    MOVE '8&      T  E F  H   F -   #00013341' TO DFHEIV0
 15163     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15164     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15165     MOVE X'2020233030303133333431' TO DFHEIV0(25:11)
 15166     CALL 'kxdfhei1' USING DFHEIV0,
 15167           LOGOFF-TEXT,
 15168           LOGOFF-LENGTH,
 15169           DFHEIV99,
 15170           DFHEIV99,
 15171           DFHEIV99,
 15172           DFHEIV99,
 15173           DFHEIV99,
 15174           DFHEIV99,
 15175           DFHEIV99,
 15176           DFHEIV99,
 15177           DFHEIV99,
 15178           DFHEIV99
 15179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15180
 15181
 15182
 15183
 15184* EXEC CICS RETURN
 15185*    END-EXEC.
 15186*    MOVE '.(                    &   #00013349' TO DFHEIV0
 15187     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15188     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15189     MOVE X'2020233030303133333439' TO DFHEIV0(25:11)
 15190     CALL 'kxdfhei1' USING DFHEIV0,
 15191           DFHEIV99,
 15192           DFHEIV99,
 15193           DFHEIV99,
 15194           DFHEIV99,
 15195           DFHEIV99
 15196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15197
 15198
 15199 8800-UNAUTHORIZED-ACCESS.
 15200     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 295
* EL130.cbl
 15201     GO TO 8300-SEND-TEXT.
 15202
 15203 8810-PF23.
 15204     MOVE EIBAID TO PI-ENTRY-CD-1.
 15205     MOVE XCTL-005               TO PGM-NAME.
 15206     GO TO 9300-XCTL.
 15207
 15208 8820-TERM-ERROR.
 15209     MOVE ER-0412                TO EMI-ERROR.
 15210     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15211     MOVE -1                     TO MAINTL.
 15212     GO TO 8200-SEND-DATAONLY.
 15213
 15214 8830-TRAN-ERROR.
 15215     MOVE ER-0413                TO EMI-ERROR.
 15216     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15217     MOVE -1                     TO MAINTL.
 15218     GO TO 8200-SEND-DATAONLY.
 15219
 15220 9000-RETURN-CICS.
 15221
 15222
 15223* EXEC CICS RETURN
 15224*    END-EXEC.
 15225*    MOVE '.(                    &   #00013375' TO DFHEIV0
 15226     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15227     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15228     MOVE X'2020233030303133333735' TO DFHEIV0(25:11)
 15229     CALL 'kxdfhei1' USING DFHEIV0,
 15230           DFHEIV99,
 15231           DFHEIV99,
 15232           DFHEIV99,
 15233           DFHEIV99,
 15234           DFHEIV99
 15235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15236
 15237
 15238 9100-RETURN-TRAN.
 15239     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15240     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 15241
 15242
 15243
 15244* EXEC CICS RETURN
 15245*        TRANSID   (TRANS-ID)
 15246*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15247*        LENGTH    (PI-COMM-LENGTH)
 15248*    END-EXEC.
 15249*    MOVE '.(CT                  &   #00013383' TO DFHEIV0
 15250     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15251     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15252     MOVE X'2020233030303133333833' TO DFHEIV0(25:11)
 15253     CALL 'kxdfhei1' USING DFHEIV0,
 15254           TRANS-ID,
 15255           PROGRAM-INTERFACE-BLOCK,
 15256           PI-COMM-LENGTH,
 15257           DFHEIV99,
 15258           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 296
* EL130.cbl
 15259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15260
 15261
 15262 9200-RETURN-MAIN-MENU.
 15263     MOVE XCTL-126               TO PGM-NAME.
 15264     GO TO 9300-XCTL.
 15265
 15266 9300-XCTL.
 15267
 15268
 15269* EXEC CICS XCTL
 15270*        PROGRAM   (PGM-NAME)
 15271*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15272*        LENGTH    (PI-COMM-LENGTH)
 15273*    END-EXEC.
 15274*    MOVE '.$C                   $   #00013395' TO DFHEIV0
 15275     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15276     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15277     MOVE X'2020233030303133333935' TO DFHEIV0(25:11)
 15278     CALL 'kxdfhei1' USING DFHEIV0,
 15279           PGM-NAME,
 15280           PROGRAM-INTERFACE-BLOCK,
 15281           PI-COMM-LENGTH
 15282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15283
 15284
 15285 9400-CLEAR.
 15286     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 15287     GO TO 9300-XCTL.
 15288
 15289 9500-PF12.
 15290     MOVE XCTL-010               TO PGM-NAME.
 15291     GO TO 9300-XCTL.
 15292
 15293 9600-PGMID-ERROR.
 15294
 15295
 15296* EXEC CICS HANDLE CONDITION
 15297*        PGMIDERR  (8300-SEND-TEXT)
 15298*    END-EXEC.
 15299*    MOVE '"$L                   ! M #00013411' TO DFHEIV0
 15300     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15301     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15302     MOVE X'4D20233030303133343131' TO DFHEIV0(25:11)
 15303     CALL 'kxdfhei1' USING DFHEIV0
 15304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15305
 15306
 15307     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 15308     MOVE ' '                    TO PI-ENTRY-CD-1.
 15309     MOVE XCTL-005               TO PGM-NAME.
 15310     MOVE PGM-NAME               TO LOGOFF-PGM.
 15311     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 15312     GO TO 9300-XCTL.
 15313
 15314 9700-LINK-DATE-CONVERT.
 15315     MOVE LINK-ELDATCV           TO PGM-NAME.
 15316
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 297
* EL130.cbl
 15317
 15318* EXEC CICS LINK
 15319*        PROGRAM    (PGM-NAME)
 15320*        COMMAREA   (DATE-CONVERSION-DATA)
 15321*        LENGTH     (DC-COMM-LENGTH)
 15322*    END-EXEC.
 15323*    MOVE '."C                   ''   #00013425' TO DFHEIV0
 15324     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15325     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15326     MOVE X'2020233030303133343235' TO DFHEIV0(25:11)
 15327     CALL 'kxdfhei1' USING DFHEIV0,
 15328           PGM-NAME,
 15329           DATE-CONVERSION-DATA,
 15330           DC-COMM-LENGTH,
 15331           DFHEIV99,
 15332           DFHEIV99,
 15333           DFHEIV99
 15334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15335
 15336
 15337 9700-EXIT.
 15338     EXIT.
 15339
 15340 9800-LINK-REM-TERM.
 15341     MOVE LINK-ELRTRM            TO PGM-NAME.
 15342
 15343
 15344* EXEC CICS LINK
 15345*        PROGRAM    (PGM-NAME)
 15346*        COMMAREA   (CALCULATION-PASS-AREA)
 15347*        LENGTH     (CP-COMM-LENGTH)
 15348*    END-EXEC.
 15349*    MOVE '."C                   ''   #00013437' TO DFHEIV0
 15350     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15351     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15352     MOVE X'2020233030303133343337' TO DFHEIV0(25:11)
 15353     CALL 'kxdfhei1' USING DFHEIV0,
 15354           PGM-NAME,
 15355           CALCULATION-PASS-AREA,
 15356           CP-COMM-LENGTH,
 15357           DFHEIV99,
 15358           DFHEIV99,
 15359           DFHEIV99
 15360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15361
 15362
 15363 9800-EXIT.
 15364     EXIT.
 15365
 15366 9900-ERROR-FORMAT.
 15367     IF NOT EMI-ERRORS-COMPLETE
 15368         MOVE LINK-001           TO PGM-NAME
 15369
 15370* EXEC CICS LINK
 15371*            PROGRAM   (PGM-NAME)
 15372*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 15373*            LENGTH    (EMI-COMM-LENGTH)
 15374*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 298
* EL130.cbl
 15375*    MOVE '."C                   ''   #00013449' TO DFHEIV0
 15376     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15377     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15378     MOVE X'2020233030303133343439' TO DFHEIV0(25:11)
 15379     CALL 'kxdfhei1' USING DFHEIV0,
 15380           PGM-NAME,
 15381           ERROR-MESSAGE-INTERFACE-BLOCK,
 15382           EMI-COMM-LENGTH,
 15383           DFHEIV99,
 15384           DFHEIV99,
 15385           DFHEIV99
 15386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15387     END-IF.
 15388
 15389 9900-EXIT.
 15390     EXIT.
 15391
 15392 9990-ABEND.
 15393     MOVE -1                     TO MAINTL.
 15394     MOVE LINK-004               TO PGM-NAME.
 15395     MOVE DFHEIBLK               TO EMI-LINE1.
 15396
 15397
 15398* EXEC CICS LINK
 15399*        PROGRAM   (PGM-NAME)
 15400*        COMMAREA  (EMI-LINE1)
 15401*        LENGTH    (72)
 15402*    END-EXEC.
 15403     MOVE 72
 15404       TO DFHEIV11
 15405*    MOVE '."C                   ''   #00013464' TO DFHEIV0
 15406     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15407     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15408     MOVE X'2020233030303133343634' TO DFHEIV0(25:11)
 15409     CALL 'kxdfhei1' USING DFHEIV0,
 15410           PGM-NAME,
 15411           EMI-LINE1,
 15412           DFHEIV11,
 15413           DFHEIV99,
 15414           DFHEIV99,
 15415           DFHEIV99
 15416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15417
 15418
 15419     MOVE EMI-LINE1              TO ERRMSG2O.
 15420
 15421     GO TO 8200-BYPASS-ERROR.
 15422
 15423
 15424
 15425* GOBACK.
 15426     MOVE '9%                    "   ' TO DFHEIV0
 15427     MOVE 'EL130' TO DFHEIV1
 15428     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15429     GOBACK.
 15430
 15431 9995-SECURITY-VIOLATION.
 15432*             COPY ELCSCTP.
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 299
* EL130.cbl
 15433******************************************************************
 15434*                                                                *
 15435*                            ELCSCTP                             *
 15436*                            VMOD=2.001                          *
 15437*                                                                *
 15438*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 15439******************************************************************
 15440
 15441
 15442     MOVE EIBDATE          TO SM-JUL-DATE.
 15443     MOVE EIBTRMID         TO SM-TERMID.
 15444     MOVE THIS-PGM         TO SM-PGM.
 15445     MOVE EIBTIME          TO TIME-IN.
 15446     MOVE TIME-OUT         TO SM-TIME.
 15447     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 15448
 15449
 15450* EXEC CICS LINK
 15451*         PROGRAM  ('EL003')
 15452*         COMMAREA (SECURITY-MESSAGE)
 15453*         LENGTH   (80)
 15454*    END-EXEC.
 15455     MOVE 'EL003' TO DFHEIV1
 15456     MOVE 80
 15457       TO DFHEIV11
 15458*    MOVE '."C                   ''   #00013495' TO DFHEIV0
 15459     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15460     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15461     MOVE X'2020233030303133343935' TO DFHEIV0(25:11)
 15462     CALL 'kxdfhei1' USING DFHEIV0,
 15463           DFHEIV1,
 15464           SECURITY-MESSAGE,
 15465           DFHEIV11,
 15466           DFHEIV99,
 15467           DFHEIV99,
 15468           DFHEIV99
 15469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15470
 15471
 15472******************************************************************
 15473
 15474
 15475 9995-EXIT.
 15476     EXIT.
 15477
 15478
 15479 9999-DFHBACK SECTION.
 15480     MOVE '9%                    "   ' TO DFHEIV0
 15481     MOVE 'EL130' TO DFHEIV1
 15482     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15483     GOBACK.
 15484 9999-DFHEXIT.
 15485     IF DFHEIGDJ EQUAL 0001
 15486         NEXT SENTENCE
 15487     ELSE IF DFHEIGDJ EQUAL 2
 15488         GO TO 0100-TEST-ENTRY,
 15489               8100-SEND-INITIAL-MAP,
 15490               9600-PGMID-ERROR,
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 300
* EL130.cbl
 15491               8820-TERM-ERROR,
 15492               8830-TRAN-ERROR,
 15493               9990-ABEND
 15494         DEPENDING ON DFHEIGDI
 15495     ELSE IF DFHEIGDJ EQUAL 3
 15496         GO TO 0450-ADD-ELACTQ-RECORD
 15497         DEPENDING ON DFHEIGDI
 15498     ELSE IF DFHEIGDJ EQUAL 4
 15499         GO TO 8820-TERM-ERROR,
 15500               8830-TRAN-ERROR
 15501         DEPENDING ON DFHEIGDI
 15502     ELSE IF DFHEIGDJ EQUAL 5
 15503         GO TO 0660-NOT-FOUND,
 15504               0670-QIDERR
 15505         DEPENDING ON DFHEIGDI
 15506     ELSE IF DFHEIGDJ EQUAL 6
 15507         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15508         DEPENDING ON DFHEIGDI
 15509     ELSE IF DFHEIGDJ EQUAL 7
 15510         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15511         DEPENDING ON DFHEIGDI
 15512     ELSE IF DFHEIGDJ EQUAL 8
 15513         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15514         DEPENDING ON DFHEIGDI
 15515     ELSE IF DFHEIGDJ EQUAL 9
 15516         GO TO 1025-SHOW-RECORD-NOT-FOUND
 15517         DEPENDING ON DFHEIGDI
 15518     ELSE IF DFHEIGDJ EQUAL 10
 15519         GO TO 2050-DELETE-NOT-FOUND
 15520         DEPENDING ON DFHEIGDI
 15521     ELSE IF DFHEIGDJ EQUAL 11
 15522         GO TO 2010-DELETE-CL
 15523         DEPENDING ON DFHEIGDI
 15524     ELSE IF DFHEIGDJ EQUAL 12
 15525         GO TO 3010-TEST-FOR-ERRORS
 15526         DEPENDING ON DFHEIGDI
 15527     ELSE IF DFHEIGDJ EQUAL 13
 15528         GO TO 3008-DUP-ERROR,
 15529               3009-NOT-FOUND
 15530         DEPENDING ON DFHEIGDI
 15531     ELSE IF DFHEIGDJ EQUAL 14
 15532         GO TO 3030-BUILD-CONT
 15533         DEPENDING ON DFHEIGDI
 15534     ELSE IF DFHEIGDJ EQUAL 15
 15535         GO TO 3033-ACCT-NOT-FOUND,
 15536               3033-ACCT-NOT-FOUND
 15537         DEPENDING ON DFHEIGDI
 15538     ELSE IF DFHEIGDJ EQUAL 16
 15539         GO TO 3032-NOT-IN-DT-RANGE
 15540         DEPENDING ON DFHEIGDI
 15541     ELSE IF DFHEIGDJ EQUAL 17
 15542         GO TO 3070-BUILD-CONT
 15543         DEPENDING ON DFHEIGDI
 15544     ELSE IF DFHEIGDJ EQUAL 18
 15545         GO TO 3065-CERT-NOT-FOUND
 15546         DEPENDING ON DFHEIGDI
 15547     ELSE IF DFHEIGDJ EQUAL 19
 15548         GO TO 3100-CARRIER-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 301
* EL130.cbl
 15549         DEPENDING ON DFHEIGDI
 15550     ELSE IF DFHEIGDJ EQUAL 20
 15551         GO TO 3110-COMPANY-NOT-FOUND
 15552         DEPENDING ON DFHEIGDI
 15553     ELSE IF DFHEIGDJ EQUAL 21
 15554         GO TO 3200-BUILD-ZERO-TRAILER
 15555         DEPENDING ON DFHEIGDI
 15556     ELSE IF DFHEIGDJ EQUAL 22
 15557         GO TO 9999-DFHBACK
 15558         DEPENDING ON DFHEIGDI
 15559     ELSE IF DFHEIGDJ EQUAL 23
 15560         GO TO 3290-NO-INSURED-ADDRESS
 15561         DEPENDING ON DFHEIGDI
 15562     ELSE IF DFHEIGDJ EQUAL 24
 15563         GO TO 3410-DUP-KEY
 15564         DEPENDING ON DFHEIGDI
 15565     ELSE IF DFHEIGDJ EQUAL 25
 15566         GO TO 3690-CERT-WRITTEN
 15567         DEPENDING ON DFHEIGDI
 15568     ELSE IF DFHEIGDJ EQUAL 26
 15569         GO TO 3850-CLAIM-MSTR-WRITTEN
 15570         DEPENDING ON DFHEIGDI
 15571     ELSE IF DFHEIGDJ EQUAL 27
 15572         GO TO 5050-CERT-NOT-FOUND
 15573         DEPENDING ON DFHEIGDI
 15574     ELSE IF DFHEIGDJ EQUAL 28
 15575         GO TO 5030-CERT-WRITTEN
 15576         DEPENDING ON DFHEIGDI
 15577     ELSE IF DFHEIGDJ EQUAL 29
 15578         GO TO 5035-CLAIM-WRITTEN
 15579         DEPENDING ON DFHEIGDI
 15580     ELSE IF DFHEIGDJ EQUAL 30
 15581         GO TO 9990-ABEND,
 15582               5799-EXIT
 15583         DEPENDING ON DFHEIGDI
 15584     ELSE IF DFHEIGDJ EQUAL 31
 15585         GO TO 3100-CARRIER-NOT-FOUND
 15586         DEPENDING ON DFHEIGDI
 15587     ELSE IF DFHEIGDJ EQUAL 32
 15588         GO TO 6040-NO-PROCESSOR-RECORD
 15589         DEPENDING ON DFHEIGDI
 15590     ELSE IF DFHEIGDJ EQUAL 33
 15591         GO TO 6060-NO-BENEFICIARY-RECORD
 15592         DEPENDING ON DFHEIGDI
 15593     ELSE IF DFHEIGDJ EQUAL 34
 15594         GO TO 6499-EXIT,
 15595               6499-EXIT
 15596         DEPENDING ON DFHEIGDI
 15597     ELSE IF DFHEIGDJ EQUAL 35
 15598         GO TO 6600-NOT-FOUND
 15599         DEPENDING ON DFHEIGDI
 15600     ELSE IF DFHEIGDJ EQUAL 36
 15601         GO TO 6700-NOTOPEN-ERROR,
 15602               6700-EXIT
 15603         DEPENDING ON DFHEIGDI
 15604     ELSE IF DFHEIGDJ EQUAL 37
 15605         GO TO 7120-NOT-FOUND
 15606         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 21-Feb-11 09:38 Page 302
* EL130.cbl
 15607     ELSE IF DFHEIGDJ EQUAL 38
 15608         GO TO 7499-EXIT
 15609         DEPENDING ON DFHEIGDI
 15610     ELSE IF DFHEIGDJ EQUAL 39
 15611         GO TO 7500-EXIT,
 15612               7500-DUPLICATE-KEY,
 15613               7500-EXIT
 15614         DEPENDING ON DFHEIGDI
 15615     ELSE IF DFHEIGDJ EQUAL 40
 15616         GO TO 7500-END-BROWSE
 15617         DEPENDING ON DFHEIGDI
 15618     ELSE IF DFHEIGDJ EQUAL 41
 15619         GO TO 7630-END-BROWSE
 15620         DEPENDING ON DFHEIGDI
 15621     ELSE IF DFHEIGDJ EQUAL 42
 15622         GO TO 7799-EXIT,
 15623               7799-EXIT
 15624         DEPENDING ON DFHEIGDI
 15625     ELSE IF DFHEIGDJ EQUAL 43
 15626         GO TO 7790-END-BROWSE
 15627         DEPENDING ON DFHEIGDI
 15628     ELSE IF DFHEIGDJ EQUAL 44
 15629         GO TO 7992-NOT-FOUND
 15630         DEPENDING ON DFHEIGDI
 15631     ELSE IF DFHEIGDJ EQUAL 45
 15632         GO TO 8300-SEND-TEXT
 15633         DEPENDING ON DFHEIGDI.
 15634     MOVE '9%                    "   ' TO DFHEIV0
 15635     MOVE 'EL130' TO DFHEIV1
 15636     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15637     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       10472     Code:       49358
