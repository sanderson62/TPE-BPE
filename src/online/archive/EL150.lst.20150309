* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page   1
* EL150.cbl
* Options: int("EL150.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL150.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL150.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL150.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL150 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/09/95 16:19:31.
     7*                            VMOD=2.053
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11*REMARKS.    TRANSACTION - EX23 - STATUS DISPLAY AND DISPOSITION
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page   2
* EL150.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    22*                              ADJUST REDEFINES EL150AI FILLER
    23* 062602    2002030700006  PEMA  Add note type of 'S'
    24*                                  (special review)
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    26* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    27* 050107    2007041300002  AJRA  PREVENT CHECK FOR NON COVERED CLA
    28* 080106    2006052500001  AJRA  ADD NOTE TYPE N
    29* 041807    2006032200004  AJRA  ADD NOTE TYPE R
    30* 082707    2007032100001  PEMA  ADDITIONAL INTEREST CHANGES
    31* 102809    2008100900003  AJRA  PF19 TO NEW CERT NOTES SCREEN
    32* 042110  CR2008100900001  PEMA  ADD DENIAL TYPE
    33* 113010    2009122800001  AJRA  DISPLAY STOP DATE
    34* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    35* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    36* 020613  CR2012092400007  AJRA  VERIFY CAUSAL STATE
    37* 041613  CR2013031200002  AJRA  ADD MAIL RECEIVED ACTION TYPE
    38* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    39* 031714    2014031200001  AJRA  ALLOW LEVEL 4 & 5 TO UPDATE TOT I
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    43******************************************************************
    44
    45 ENVIRONMENT DIVISION.
    46
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page   3
* EL150.cbl
    48 DATA DIVISION.
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    52 77  FILLER  PIC X(32)  VALUE '********************************'.
    53 77  FILLER  PIC X(32)  VALUE '*    EL150 WORKING STORAGE     *'.
    54 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.053 *********'.
    55 77  a1                          pic s999 comp-3 value +0.
    56 77  p1                          pic s999 comp-3 value +0.
    57 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
    58
    59*                            COPY ELCSCTM.
    60******************************************************************
    61*                                                                *
    62*                                                                *
    63*                            ELCSCTM                             *
    64*                            VMOD=2.001                          *
    65*                                                                *
    66*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    67*                                                                *
    68******************************************************************
    69 01  SECURITY-MESSAGE.
    70     12  FILLER                          PIC X(30)
    71            VALUE '** LOGIC SECURITY VIOLATION -'.
    72     12  SM-READ                         PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' PGM='.
    75     12  SM-PGM                          PIC X(6).
    76     12  FILLER                          PIC X(5)
    77            VALUE ' OPR='.
    78     12  SM-PROCESSOR-ID                 PIC X(4).
    79     12  FILLER                          PIC X(6)
    80            VALUE ' TERM='.
    81     12  SM-TERMID                       PIC X(4).
    82     12  FILLER                          PIC XX   VALUE SPACE.
    83     12  SM-JUL-DATE                     PIC 9(5).
    84     12  FILLER                          PIC X    VALUE SPACE.
    85     12  SM-TIME                         PIC 99.99.
    86
    87
    88*                            COPY ELCSCRTY.
    89******************************************************************
    90*                                                                *
    91*                                                                *
    92*                            ELCSCRTY                            *
    93*                            VMOD=2.001                          *
    94*                                                                *
    95*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    96*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    97*        SAVED IN PI-SECURITY-ADDRESS.                           *
    98*                                                                *
    99******************************************************************
   100 01  SECURITY-CONTROL.
   101     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   102     12  FILLER                       PIC XX    VALUE 'SC'.
   103     12  SC-CREDIT-CODES.
   104         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   105             20  SC-CREDIT-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page   4
* EL150.cbl
   106             20  SC-CREDIT-UPDATE     PIC X.
   107     12  SC-CLAIMS-CODES.
   108         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   109             20  SC-CLAIMS-DISPLAY    PIC X.
   110             20  SC-CLAIMS-UPDATE     PIC X.
   111
   112 01  TS-AREA.
   113     05  TS-PI-AREA          PIC X(1024) VALUE LOW-VALUES.
   114     05  TS-PI-SAVE-CLOAN    PIC X(25)   VALUE LOW-VALUES.
   115 01  WS-DATE-AREA.
   116     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   117     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   118
   119 01  ws-save-error-interface-block pic x(400) value low-values.
   120 01  STANDARD-AREAS.
   121     12  TS-LENGTH           PIC S9(4)  COMP VALUE +1049.
   122     12  WS-EARNING-METHOD   PIC X      VALUE SPACES.
   123     12  WS-INDEX            PIC S9(04) COMP VALUE +0.
   124     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   125     12  crtt-map            pic x(8)    value 'EL150T'.
   126     12  SAD-MAP             PIC X(8)    VALUE 'EL150A'.
   127     12  MAP-NAME            PIC X(8)    VALUE 'EL150A'.
   128     12  MAPSET-NAME         PIC X(8)    VALUE 'EL150S'.
   129     12  TRANS-ID            PIC X(4)    VALUE 'EX23'.
   130     12  THIS-PGM            PIC X(8)    VALUE 'EL150'.
   131     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   132     12  PGM-NAME            PIC X(8).
   133     12  TIME-IN             PIC S9(7).
   134     12  TIME-OUT-R  REDEFINES TIME-IN.
   135         16  FILLER          PIC X.
   136         16  TIME-OUT        PIC 99V99.
   137         16  FILLER          PIC XX.
   138     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   139     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   140     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   141     12  XCTL-1273           PIC X(8)    VALUE 'EL1273'.
   142     12  XCTL-EM1273         PIC X(8)    VALUE 'EM1273'.
   143     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   144     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   145     12  XCTL-EM131          PIC X(8)    VALUE 'EM131'.
   146     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   147     12  XCTL-142            PIC X(8)    VALUE 'EL142'.
   148     12  XCTL-1501           PIC X(8)    VALUE 'EL1501'.
   149     12  XCTL-1502           PIC X(8)    VALUE 'EL1502'.
   150     12  XCTL-151            PIC X(8)    VALUE 'EL151'.
   151     12  XCTL-152            PIC X(8)    VALUE 'EL152'.
   152     12  XCTL-153            PIC X(8)    VALUE 'EL153'.
   153     12  XCTL-154            PIC X(8)    VALUE 'EL154'.
   154     12  XCTL-156            PIC X(8)    VALUE 'EL156'.
   155     12  XCTL-EM156          PIC X(8)    VALUE 'EM156'.
   156     12  XCTL-EM1561         PIC X(8)    VALUE 'EM1561'.
   157     12  XCTL-1503           PIC X(8)    VALUE 'EL1503'.
   158     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   159     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   160     12  XCTL-158            PIC X(8)    VALUE 'EL158'.
   161     12  XCTL-162            PIC X(8)    VALUE 'EL162'.
   162     12  XCTL-1276           PIC X(8)    VALUE 'EL1276'.
   163     12  XCTL-EM1276         PIC X(8)    VALUE 'EM1276'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page   5
* EL150.cbl
   164     12  XCTL-1279           PIC X(8)    VALUE 'EL1279'.
   165     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   166     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   167     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   168     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   169     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   170     12  FILE-ID             PIC X(8).
   171     12  EMPHST-FILE-ID      PIC X(8)    VALUE 'MPPHST'.
   172     12  SC-ITEM             PIC S9(4)   VALUE +0001   COMP.
   173
   174 01  WS-HISTORY-AREA                 PIC X(50).
   175 01  WS-FLD1            REDEFINES WS-HISTORY-AREA.
   176     12  FILLER                 PIC X(38).
   177     12  WS-NUMERIC-FLD1        PIC S9(10)V99.
   178 01  WS-FLD2            REDEFINES WS-HISTORY-AREA.
   179     12  FILLER                 PIC X(45).
   180     12  WS-NUMERIC-FLD2        PIC S99V999.
   181 01  WS-FLD3            REDEFINES WS-HISTORY-AREA.
   182     12  FILLER                 PIC X(35).
   183     12  WS-NUMERIC-FLD3        PIC S9(15).
   184 01  WS-FLD4            REDEFINES WS-HISTORY-AREA.
   185     12  FILLER                 PIC X(36).
   186     12  WS-NUMERIC-FLD4        PIC S9(10)V9999.
   187
   188 01  MISC-WORK-AREAS.
   189     12  QID.
   190         16  QID-TERM        PIC X(4).
   191         16  FILLER          PIC X(4)    VALUE '150A'.
   192     12  MAP-LENGTH          PIC S9(4)   VALUE +1920   COMP.
   193     12  PASS-SWITCH         PIC X       VALUE 'A'.
   194     12  SV-LAST-BY          PIC X(4)    VALUE SPACES.
   195     12  SV-LAST-HHMMSS      PIC S9(6)   VALUE +0      COMP-3.
   196     12  SUB-1               PIC S9(4)   VALUE +0    COMP.
   197     12  DISPLAY-CNT         PIC S9(4)   VALUE +1    COMP.
   198     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   199     12  WS-SUB              PIC 9       VALUE 0.
   200     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   201     12  DIRECTION-SWITCH    PIC X       VALUE 'N'.
   202     12  WS-STATUS           PIC X.
   203     12  WS-LF-COVERAGE-TYPE PIC X       VALUE SPACE.
   204     12  WS-REMAINING-AMT    PIC S9(9)V99 VALUE +0.
   205     12  W-REMAINDER         PIC S9(3)    VALUE +0.
   206     12  WS-TERMS.
   207         16  WST-ORIG        PIC ZZ9.
   208         16  WST-ORIG-DAYS-GRP.
   209             20  WST-SLASH1  PIC X       VALUE '/'.
   210             20  WST-EXT-DAYS
   211                             PIC Z9.
   212         16  FILLER          PIC X       VALUE '/'.
   213         16  WST-REM         PIC ZZ9.
   214         16  WST-REM-DAYS-GRP.
   215             20  WST-SLASH2  PIC X       VALUE '/'.
   216             20  WST-REM-DAYS
   217                             PIC Z9.
   218     12  W-DAYS-PAID-X       PIC ZZZZ9.
   219     12  W-TOTAL-PAID-AMT-X  PIC ZZZZ,ZZZ.99.
   220     12  W-PAID-MONTHS       PIC S9(03)  COMP-3.
   221     12  W-PAID-DAYS         PIC S9(03)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page   6
* EL150.cbl
   222
   223     12  W-REM               PIC S999    COMP-3.
   224     12  W-REM-DAYS          PIC S999    COMP-3.
   225     12  W-TERM-IN-DAYS      PIC S9(4)   COMP-3.
   226     12  W-REM-TERM-IN-DAYS  PIC S9(4)   COMP-3.
   227
   228     12  W-PAYMENTS.
   229         16  W-PYMTS         PIC ZZ9.
   230         16  FILLER          PIC X       VALUE '/'.
   231         16  W-ADD-DAYS      PIC ZZ9.
   232     12  WS-ACCESS.
   233         16  FILLER          PIC XX      VALUE SPACES.
   234         16  WS-BEN-CD       PIC XX.
   235     12  WS-STATE-ACCESS.
   236         16  WS-ST-ACCESS    PIC XX.
   237         16  FILLER          PIC XX      VALUE SPACES.
   238     12  WS-CLAIM-SEQUENCE.
   239         16  FILLER          PIC X       VALUE '('.
   240         16  WS-CUR-SEQU     PIC Z9      VALUE ZEROS.
   241         16  FILLER          PIC X(04)   VALUE ' OF '.
   242         16  WS-OF-SEQU      PIC Z9      VALUE ZEROS.
   243         16  FILLER          PIC X       VALUE ')'.
   244
   245     12  WS-PURGED-MESSAGE.
   246         16  WS-PURGED-MSG       PIC X(18)    VALUE SPACES.
   247         16  WS-PURGED-DATE      PIC X(08)    VALUE SPACES.
   248
   249     12  SAVE-CONTROL        PIC X(39).
   250     12  WS-ERACCT-SAVE-KEY      PIC X(20) VALUE SPACES.
   251     12  WS-ERACCT-HOLD-RECORD   PIC X(2000) VALUE SPACES.
   252
   253     12  SUB                 PIC 99      VALUE ZEROS.
   254
   255     12  WS-ACTIVITY-CODE    PIC 99      VALUE ZEROS.
   256         88  VALID-ACTIVITY-CODE         VALUE 00, 10 THRU 17.
   257
   258     12  WS-ACT-REC-FOUND-SW PIC X       VALUE 'N'.
   259     12  WS-LETTER-SW        PIC X       VALUE 'N'.
   260     12  WS-BROWSE-SW        PIC X       VALUE 'N'.
   261     12  WS-BROWSE-START-SW  PIC X       VALUE ' '.
   262     12  WS-UPDATE-SW        PIC X       VALUE 'N'.
   263
   264     12  WS-ACT-USER-DESC.
   265         16  WS-DESC-1-3     PIC X(03)   VALUE SPACES.
   266         16  FILLER          PIC X(17)   VALUE SPACES.
   267
   268     12  WS-CERT-READ-SW     PIC X       VALUE 'N'.
   269     12  WS-LOAN-EXPIRE-DT   PIC X(08)   VALUE SPACES.
   270     12  W-CLAIM-MASTER-SAVE PIC X(350)  VALUE SPACES.
   271
   272     12  WS-PMT-AMTD.
   273         16  WS-PMT-AMT      PIC Z(4).99-.
   274
   275     12  WS-RESPONSE         PIC S9(8)   COMP.
   276         88  WS-RESP-NORMAL              VALUE +00.
   277         88  WS-RESP-NOTFND              VALUE +13.
   278
   279 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page   7
* EL150.cbl
   280     88  PDEF-FOUND                   VALUE 'Y'.
   281 01  ERPDEF-KEY-SAVE             PIC X(18).
   282 01  ERPDEF-KEY.
   283     12  ERPDEF-COMPANY-CD       PIC X.
   284     12  ERPDEF-STATE            PIC XX.
   285     12  ERPDEF-PROD-CD          PIC XXX.
   286     12  F                       PIC X(7).
   287     12  ERPDEF-BEN-TYPE         PIC X.
   288     12  ERPDEF-BEN-CODE         PIC XX.
   289     12  ERPDEF-EXP-DT           PIC XX.
   290
   291 01  ELCRTT-KEY.
   292     05  CTRLR-COMP-CD       PIC X.
   293     05  CTRLR-CARRIER       PIC X.
   294     05  CTRLR-GROUPING      PIC X(6).
   295     05  CTRLR-STATE         PIC X(2).
   296     05  CTRLR-ACCOUNT       PIC X(10).
   297     05  CTRLR-EFF-DT        PIC XX.
   298     05  CTRLR-CERT-NO       PIC X(11).
   299     05  CTRLR-REC-TYPE      PIC X.
   300 01  ACCESS-KEYS.
   301     12  ERACCT-KEY.
   302         16  ERACCT-PARTIAL-KEY.
   303             20  ACCT-COMP-CD    PIC X.
   304             20  ACCT-CARRIER    PIC X.
   305             20  ACCT-GROUPING   PIC X(6).
   306             20  ACCT-STATE      PIC XX.
   307             20  ACCT-ACCOUNT    PIC X(10).
   308         16  ACCT-EXP-DT         PIC XX.
   309         16  FILLER              PIC X(04).
   310     12  ELMSTR-KEY.
   311         16  MSTR-COMP-CD    PIC X.
   312         16  MSTR-CARRIER    PIC X.
   313         16  MSTR-CLAIM-NO   PIC X(7).
   314         16  MSTR-CERT-NO.
   315             20  MSTR-CERT-NO-PRIME  PIC X(10).
   316             20  MSTR-CERT-NO-SUFX   PIC X.
   317     12  W-ELRETR-KEY.
   318         16  W-RET-COMP-CD       PIC  X.
   319         16  W-RET-CARRIER       PIC  X.
   320         16  W-RET-CLAIM-NO      PIC  X(07).
   321         16  W-RET-CERT-NO.
   322             20  W-RET-CERT-PRIME
   323                                 PIC  X(10).
   324             20  W-RET-CERT-SUFX PIC  X.
   325     12  ELCNTL-KEY.
   326         16  CNTL-COMP-ID    PIC X(3).
   327         16  CNTL-REC-TYPE   PIC X.
   328         16  CNTL-ACCESS.
   329             20  FILLER      PIC XX.
   330             20  CNTL-BEN-NO PIC XX.
   331         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   332     12  ELCERT-KEY.
   333         16  CERT-COMP-CD    PIC X.
   334         16  CERT-CARRIER    PIC X.
   335         16  CERT-GROUPING   PIC X(6).
   336         16  CERT-STATE      PIC XX.
   337         16  CERT-ACCOUNT    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page   8
* EL150.cbl
   338         16  CERT-EFF-DT     PIC XX.
   339         16  CERT-CERT-NO.
   340             20  CERT-CERT-NO-PRIME PIC X(10).
   341             20  CERT-CERT-NO-SUFX  PIC X.
   342     12  ELTRLR-KEY.
   343         16  TRLR-COMP-CD    PIC X.
   344         16  TRLR-CARRIER    PIC X.
   345         16  TRLR-CLAIM-NO   PIC X(7).
   346         16  TRLR-CERT-NO.
   347             20  TRLR-CERT-NO-PRIME PIC X(10).
   348             20  TRLR-CERT-NO-SUFX  PIC X.
   349         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   350     12  ws-ELTRLR-KEY.
   351         16  ws-TRLR-COMP-CD    PIC X.
   352         16  ws-TRLR-CARRIER    PIC X.
   353         16  ws-TRLR-CLAIM-NO   PIC X(7).
   354         16  ws-TRLR-CERT-NO.
   355             20  ws-TRLR-CERT-NO-PRIME PIC X(10).
   356             20  ws-TRLR-CERT-NO-SUFX  PIC X.
   357         16  ws-TRLR-SEQ-NO     PIC S9(4)   COMP.
   358     12  ELACTQ-KEY.
   359         16  ACTQ-COMP-CD    PIC X.
   360         16  ACTQ-CARRIER    PIC X.
   361         16  ACTQ-CLAIM-NO   PIC X(7).
   362         16  ACTQ-CERT-NO.
   363             20  ACTQ-CERT-NO-PRIME PIC X(10).
   364             20  ACTQ-CERT-NO-SUFX  PIC X.
   365     12  ELARCH-KEY.
   366         16  ARCH-COMP-CD        PIC X.
   367         16  ARCH-ARCHIVE-NO     PIC S9(08)  COMP.
   368         16  ARCH-RECORD-TYPE    PIC X.
   369         16  ARCH-SEQ-NO         PIC S9(04)  COMP.
   370
   371     12  EMPLCY-KEY.
   372         16  PLCY-COMP-CD            PIC X.
   373         16  PLCY-CARRIER            PIC X.
   374         16  PLCY-GROUPING           PIC X(06).
   375         16  PLCY-STATE              PIC XX.
   376         16  PLCY-PRODUCER           PIC X(10).
   377         16  PLCY-EFF-DT             PIC XX.
   378         16  PLCY-REFERENCE-NO.
   379             20  PLCY-REFNO-PRIME    PIC X(18).
   380             20  PLCY-REFNO-SFX      PIC XX.
   381
   382     12  EMPHST-KEY.
   383         16  EMPHST-COMPANY-CD       PIC X.
   384         16  EMPHST-CARRIER          PIC X.
   385         16  EMPHST-GROUPING         PIC X(06).
   386         16  EMPHST-STATE            PIC XX.
   387         16  EMPHST-PRODUCER         PIC X(10).
   388         16  EMPHST-POLICY-EFF-DT    PIC XX.
   389         16  EMPHST-REFERENCE-NUMBER.
   390             20  EMPHST-REFNO-PRIME  PIC X(18).
   391             20  EMPHST-REFNO-SFX    PIC XX.
   392         16  EMPHST-RECORD-TYPE      PIC XX.
   393         16  EMPHST-FIELD-TYPE       PIC XX.
   394         16  EMPHST-SEQUENCE-NO      PIC S9(04) COMP.
   395
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page   9
* EL150.cbl
   396     12  EMPLAN-KEY.
   397         16  PLAN-COMP-CD            PIC X.
   398         16  PLAN-CARRIER            PIC X.
   399         16  PLAN-GROUPING           PIC X(06).
   400         16  PLAN-STATE              PIC XX.
   401         16  PLAN-PRODUCER           PIC X(10).
   402         16  PLAN-PLAN-CODE          PIC XX.
   403         16  PLAN-REV-NO             PIC 9(03).
   404
   405     12  EMPROD-KEY.
   406         16  EMPROD-PARTIAL-KEY.
   407             20  PROD-COMP-CD        PIC X.
   408             20  PROD-CARRIER        PIC X.
   409             20  PROD-GROUPING       PIC X(06).
   410             20  PROD-STATE          PIC XX.
   411             20  PROD-PRODUCER       PIC X(10).
   412         16  PROD-EXP-DT             PIC XX.
   413
   414 01  TRAILER-DISPLAY-WORK-AREA.
   415     12  DISPLAY-ACTION.
   416         16  DISP-ACT-A      PIC X(10).
   417         16  DISP-ACT-B      PIC X(4).
   418     12  FILLER              PIC X.
   419     12  DISPLAY-BY          PIC X(4).
   420     12  FILLER              PIC X.
   421     12  DISPLAY-DATE        PIC X(8).
   422     12  FILLER              PIC X.
   423     12  DISPLAY-SEQ         PIC Z(4).
   424     12  FILLER              PIC X.
   425     12  DISPLAY-TEXT        PIC X(45).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  10
* EL150.cbl
   427 01  ERROR-MESSAGES.
   428     05  ER-0000                 PIC X(4) VALUE '0000'.
   429     05  ER-0004                 PIC X(4) VALUE '0004'.
   430     05  ER-0008                 PIC X(4) VALUE '0008'.
   431     05  ER-0029                 PIC X(4) VALUE '0029'.
   432     05  ER-0033                 PIC X(4) VALUE '0033'.
   433     05  ER-0042                 PIC X(4) VALUE '0042'.
   434     05  ER-0068                 PIC X(4) VALUE '0068'.
   435     05  ER-0070                 PIC X(4) VALUE '0070'.
   436     05  ER-0130                 PIC X(4) VALUE '0130'.
   437     05  ER-0154                 PIC X(4) VALUE '0154'.
   438     05  ER-0168                 PIC X(4) VALUE '0168'.
   439     05  ER-0169                 PIC X(4) VALUE '0169'.
   440     05  ER-0172                 PIC X(4) VALUE '0172'.
   441     05  ER-0190                 PIC X(4) VALUE '0190'.
   442     05  ER-0204                 PIC X(4) VALUE '0204'.
   443     05  ER-0206                 PIC X(4) VALUE '0206'.
   444     05  ER-0303                 PIC X(4) VALUE '0303'.
   445     05  ER-0334                 PIC X(4) VALUE '0334'.
   446     05  ER-0335                 PIC X(4) VALUE '0335'.
   447     05  ER-0336                 PIC X(4) VALUE '0336'.
   448     05  ER-0337                 PIC X(4) VALUE '0337'.
   449     05  ER-0338                 PIC X(4) VALUE '0338'.
   450     05  ER-0376                 PIC X(4) VALUE '0376'.
   451     05  ER-0412                 PIC X(4) VALUE '0412'.
   452     05  ER-0413                 PIC X(4) VALUE '0413'.
   453     05  ER-0433                 PIC X(4) VALUE '0433'.
   454     05  ER-0500                 PIC X(4) VALUE '0500'.
   455     05  ER-0802                 PIC X(4) VALUE '0802'.
   456     05  ER-0803                 PIC X(4) VALUE '0803'.
   457     05  ER-0804                 PIC X(4) VALUE '0804'.
   458     05  ER-0926                 PIC X(4) VALUE '0926'.
   459     05  ER-0927                 PIC X(4) VALUE '0927'.
   460     05  ER-0928                 PIC X(4) VALUE '0928'.
   461     05  ER-0929                 PIC X(4) VALUE '0929'.
   462     05  ER-0931                 PIC X(4) VALUE '0931'.
   463     05  ER-0932                 PIC X(4) VALUE '0932'.
   464     05  ER-0933                 PIC X(4) VALUE '0933'.
   465     05  ER-0934                 PIC X(4) VALUE '0934'.
   466     05  ER-0935                 PIC X(4) VALUE '0935'.
   467     05  ER-0936                 PIC X(4) VALUE '0936'.
   468     05  ER-0937                 PIC X(4) VALUE '0937'.
   469     05  ER-2378                 PIC X(4) VALUE '2378'.
   470     05  ER-2379                 PIC X(4) VALUE '2379'.
   471     05  ER-2848                 PIC X(4) VALUE '2848'.
   472     05  ER-3516                 PIC X(4) VALUE '3516'.
   473     05  ER-3526                 PIC X(4) VALUE '3526'.
   474     05  ER-3545                 PIC X(4) VALUE '3545'.
   475     05  ER-3550                 PIC X(4) VALUE '3550'.
   476     05  ER-9483                 PIC X(4) VALUE '9483'.
   477     05  ER-9808                 PIC X(4) VALUE '9808'.
   478     05  ER-9883                 PIC X(4) VALUE '9883'.
   479     05  ER-9886                 PIC X(4) VALUE '9886'.
   480
   481 01  TEXT-WORK-AREAS.
   482     12  PAYMENT-TEXT.
   483         16  PMT-VAR         PIC X(8).
   484         16  PMT-PD-THRU     PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  11
* EL150.cbl
   485         16  FILLER          PIC X(7)    VALUE ' CHECK='.
   486         16  PMT-CHECK-NO    PIC X(7).
   487         16  FILLER          PIC X(5)    VALUE ' AMT='.
   488         16  PMT-AMOUNT      PIC Z(6).99-.
   489
   490     12  AUTO-PMT-TEXT.
   491         16  FILLER          PIC X(6)    VALUE 'START='.
   492         16  AUTO-START      PIC X(8).
   493         16  FILLER          PIC X(5)    VALUE ' END='.
   494         16  AUTO-END        PIC X(8).
   495         16  FILLER          PIC X(8)    VALUE ' AMOUNT='.
   496         16  AUTO-AMOUNT     PIC Z(6).99-.
   497
   498     12  AUTO-TERM-TEXT.
   499         16  FILLER          PIC X(11)   VALUE 'TERMINATED='.
   500         16  AUTO-TERMINATED PIC X(8).
   501         16  FILLER          PIC X(8)    VALUE SPACES.
   502         16  FILLER          PIC X(8)    VALUE ' AMOUNT='.
   503         16  AUTO-TERM-AMT   PIC Z(6).99-.
   504
   505     12  CORRESPONDENCE-TEXT.
   506         16  FILLER          PIC X(3)    VALUE 'TO='.
   507         16  CORR-TO         PIC X(8).
   508         16  CORR-RECVD-LIT  PIC X(8)    VALUE '  RECVD='.
   509         16  CORR-RECVD      PIC X(8).
   510         16  CORR-VAR        PIC X(9).
   511         16  CORR-RESENT     PIC X(8).
   512         16  CORR-ARCH-NO REDEFINES CORR-RESENT PIC 9(8).
   513
   514     12  PROMPT-TEXT.
   515         16  FILLER          PIC X(4)    VALUE 'END='.
   516         16  PROMPT-END      PIC X(8).
   517         16  FILLER          PIC XX      VALUE SPACES.
   518         16  PROMPT-MSG      PIC X(31).
   519
   520     12  DENIAL-TEXT.
   521         16  FILLER          PIC X(5)    VALUE 'DATE='.
   522         16  DENIAL-DATE     PIC X(8).
   523         16  FILLER          PIC X(6)    VALUE ' CODE='.
   524         16  DENIAL-CODE     PIC X(4).
   525         16  FILLER          PIC XX      VALUE SPACES.
   526         16  DENIAL-MSG      PIC X(20).
   527
   528     12  RECONSIDERED-TEXT.
   529         16  FILLER          PIC X(7)    VALUE 'DENIED '.
   530         16  DENIED-DATE     PIC X(8).
   531         16  FILLER          PIC X(15)   VALUE '  RECONSIDERED '.
   532         16  RECONSIDERED-DATE  PIC X(8).
   533
   534     12  INCUR-TEXT.
   535         16  FILLER          PIC X(6)    VALUE 'INCUR='.
   536         16  INCUR-DT        PIC X(8).
   537         16  PDTHRU-HEAD     PIC X(9)    VALUE ' PD THRU='.
   538         16  INCUR-PDTHRU    PIC X(8).
   539         16  FILLER          PIC X(4)    VALUE ' PD='.
   540         16  INCUR-PAID      PIC Z(6).99-.
   541
   542     12  LOAN-TEXT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  12
* EL150.cbl
   543         16  FILLER          PIC X(5)    VALUE 'LOAN='.
   544         16  LOAN-NUMBER     PIC X(8).
   545         16  FILLER          PIC X(5)    VALUE ' BAL='.
   546         16  LOAN-BALANCE    PIC Z(7).99-.
   547         16  FILLER          PIC X(4)    VALUE ' ME='.
   548         16  LOAN-MEMBER     PIC X(12).
   549
   550     12  ASSOC-LOAN-TEXT.
   551         16  FILLER          PIC X(11)   VALUE
   552                 'ORIG/CUR : '.
   553         16  ASSOC-ORIG-LOAN PIC X(08)   VALUE SPACES.
   554         16  FILLER          PIC X       VALUE SPACES.
   555         16  ASSOC-CUR-LOAN  PIC X(12)   VALUE SPACES.
   556         16  FILLER          PIC XX      VALUE SPACES.
   557         16  ASSOC-LOAN-TYPE PIC XX      VALUE SPACES.
   558         16  FILLER          PIC X(09)   VALUE SPACES.
   559
   560     12  ASSOC-CV-LOAN-TEXT.
   561         16  FILLER          PIC X(11)   VALUE
   562                 'LOAN NO. : '.
   563         16  ASSOC-CV-LOAN   PIC X(20)   VALUE SPACES.
   564         16  FILLER          PIC X(14)   VALUE SPACES.
   565
   566 01  PAYMENT-DESCRIPTION-TABLE.
   567     12  FILLER              PIC X(14)   VALUE 'PARTIAL PMT   '.
   568     12  FILLER              PIC X(14)   VALUE 'FINAL PMT     '.
   569     12  FILLER              PIC X(14)   VALUE 'LUMP SUM PMT  '.
   570     12  FILLER              PIC X(14)   VALUE 'ADDITIONAL PMT'.
   571     12  FILLER              PIC X(14)   VALUE 'CHARGEABLE EXP'.
   572     12  FILLER              PIC X(14)   VALUE 'NON-CHG EXP   '.
   573     12  FILLER              PIC X(14)   VALUE 'LIFE PRM RFND '.
   574     12  FILLER              PIC X(14)   VALUE 'A/H PRM RFND  '.
   575     12  FILLER              PIC X(14)   VALUE 'ENTRY CORRECT '.
   576 01  PAYMENT-DESC-R   REDEFINES PAYMENT-DESCRIPTION-TABLE.
   577     12  PAY-DESC            PIC X(14)   OCCURS 9.
   578
   579 01  CV-PAYMENT-DESCRIPTION-TABLE.
   580     12  FILLER              PIC X(14)   VALUE 'FULL DEATH    '.
   581     12  FILLER              PIC X(14)   VALUE 'HALF DEATH    '.
   582     12  FILLER              PIC X(14)   VALUE 'FULL AD&D     '.
   583     12  FILLER              PIC X(14)   VALUE 'HALF AD&D     '.
   584     12  FILLER              PIC X(14)   VALUE 'FULL RIDER    '.
   585     12  FILLER              PIC X(14)   VALUE 'HALF RIDER    '.
   586     12  FILLER              PIC X(14)   VALUE 'NON-CHG EXP   '.
   587     12  FILLER              PIC X(14)   VALUE 'ADDITIONAL    '.
   588 01  CV-PAYMENT-DESC-R REDEFINES CV-PAYMENT-DESCRIPTION-TABLE.
   589     12  CV-PAY-DESC         PIC X(14)   OCCURS 2.
   590
   591 01  CORRESPONDENCE-TO-DESCRIPTIONS.
   592     12  FILLER              PIC X(8)    VALUE 'INSURED '.
   593     12  FILLER              PIC X(8)    VALUE 'BENEF   '.
   594     12  FILLER              PIC X(8)    VALUE 'ACCOUNT '.
   595     12  FILLER              PIC X(8)    VALUE 'DOCTOR  '.
   596     12  FILLER              PIC X(8)    VALUE 'EMPLOYER'.
   597     12  FILLER              PIC X(8)    VALUE 'OTHER1  '.
   598     12  FILLER              PIC X(8)    VALUE 'OTHER2  '.
   599 01  CORR-TO-DESC   REDEFINES CORRESPONDENCE-TO-DESCRIPTIONS.
   600     12  CORR-DESC           PIC X(8)    OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  13
* EL150.cbl
   601
   602 01  W-CONFIDENTIAL-TEXT.
   603     12  W-CONF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   604     12  W-CONF-TEXT.
   605         16  FILLER.
   606             20  W-CONF-PGM  PIC X(8)    VALUE 'EL150'.
   607             20  FILLER      PIC X       VALUE SPACES.
   608             20  FILLER      PIC X(71)   VALUE
   609     '******THIS IS A CONFIDENTIAL CLAIM!!!!!*****'.
   610         16  FILLER          PIC X(8)    VALUE SPACES.
   611         16  FILLER          PIC X(71)   VALUE
   612      '******PRESS ENTER TO RETURN TO SCREEN.******'.
   613         16  FILLER          PIC X(26)   VALUE SPACES.
   614*        16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   615*        16  FILLER          PIC X       VALUE QUOTE.
   616*        16  W-CONF-SYS-MSG  PIC X(17)
   617*          VALUE 'S CLAS-IC SYSTEM '.
   618
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  14
* EL150.cbl
   620*                            copy ERCPDEF.
   621******************************************************************
   622*                                                                *
   623*                                                                *
   624*                            ERCPDEF.                            *
   625*                                                                *
   626*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   627*                                                                *
   628*    FILE TYPE = VSAM,KSDS                                       *
   629*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   630*                                                                *
   631*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   632*                                                                *
   633*    LOG = YES                                                   *
   634*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   635******************************************************************
   636*                   C H A N G E   L O G
   637*
   638* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   639*-----------------------------------------------------------------
   640*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   641* EFFECTIVE    NUMBER
   642*-----------------------------------------------------------------
   643* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   644* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   645* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   646******************************************************************
   647 01  PRODUCT-MASTER.
   648    12  PD-RECORD-ID                 PIC X(02).
   649        88  VALID-PD-ID                  VALUE 'PD'.
   650    12  PD-CONTROL-PRIMARY.
   651        16  PD-COMPANY-CD            PIC X.
   652        16  PD-STATE                 PIC XX.
   653        16  PD-PRODUCT-CD            PIC XXX.
   654        16  PD-FILLER                PIC X(7).
   655        16  PD-BEN-TYPE              PIC X.
   656        16  PD-BEN-CODE              PIC XX.
   657        16  PD-PROD-EXP-DT           PIC XX.
   658    12  FILLER                       PIC X(50).
   659    12  PD-PRODUCT-DATA OCCURS 8.
   660        16  PD-PROD-CODE             PIC X.
   661            88  PD-PROD-LIFE           VALUE 'L'.
   662            88  PD-PROD-PROP           VALUE 'P'.
   663            88  PD-PROD-AH             VALUE 'A'.
   664            88  PD-PROD-IU             VALUE 'I'.
   665            88  PD-PROD-GAP            VALUE 'G'.
   666            88  PD-PROD-FAML           VALUE 'F'.
   667        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   668        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   669        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   670        16  PD-MAX-TERM              PIC S999        COMP-3.
   671        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
   672        16  FILLER                   PIC X.
   673        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   674        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   675        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   676        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   677        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  15
* EL150.cbl
   678        16  PD-REC-CRIT-PERIOD       PIC 99.
   679        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   680            20  PD-RECURRING-YN      PIC X.
   681            20  FILLER               PIC X.
   682        16  PD-RTW-MOS               PIC 99.
   683        16  PD-MAX-EXTENSION         PIC 99.
   684        16  pd-ben-pct               pic sv999 comp-3.
   685*       16  FILLER                   PIC XX.
   686    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   687    12  PD-TERM-LIMITS OCCURS 15.
   688        16  PD-LOW-TERM              PIC S999        COMP-3.
   689        16  PD-HI-TERM               PIC S999        COMP-3.
   690*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   691    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   692        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   693        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   694    12  PD-EARN-FACTORS.
   695        16  FILLER OCCURS 15.
   696            20  FILLER OCCURS 15.
   697                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   698    12  PD-PRODUCT-DESC              PIC X(80).
   699    12  PD-TRUNCATED                 PIC X.
   700    12  FILLER                       PIC X(59).
   701    12  PD-MAINT-INFORMATION.
   702        16  PD-LAST-MAINT-DT         PIC X(02).
   703        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   704        16  PD-LAST-MAINT-BY         PIC X(04).
   705*                            COPY ELCNWA.
   706*****************************************************************
   707*                                                               *
   708*                                                               *
   709*                            ELCNWA.                            *
   710*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   711*                            VMOD=2.003                         *
   712*                                                               *
   713*            M O V E   N A M E   W O R K   A R E A.             *
   714*                                                               *
   715*****************************************************************.
   716
   717 01  WS-NAME-WORK-AREA.
   718     05  WS-INSURED-LAST-NAME        PIC X(15).
   719     05  WS-INSURED-1ST-NAME         PIC X(12).
   720     05  WS-INSURED-MID-INIT         PIC X.
   721
   722     05  WS-NAME-WORK.
   723         10  WS-NW                   PIC X
   724             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   725
   726     05  WS-NAME-WORK2.
   727         10  WS-NW2                  PIC X
   728             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   729                                        NWA-INDEX0.
   730
   731     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   732                                     COMP-3.
   733
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  16
* EL150.cbl
   735*                            COPY ELCDATE.
   736******************************************************************
   737*                                                                *
   738*                                                                *
   739*                            ELCDATE.                            *
   740*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   741*                            VMOD=2.003
   742*                                                                *
   743*                                                                *
   744*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   745*                 LENGTH = 200                                   *
   746******************************************************************
   747
   748 01  DATE-CONVERSION-DATA.
   749     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   750     12  DC-OPTION-CODE                PIC X.
   751         88  BIN-TO-GREG                VALUE ' '.
   752         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   753         88  EDIT-GREG-TO-BIN           VALUE '2'.
   754         88  YMD-GREG-TO-BIN            VALUE '3'.
   755         88  MDY-GREG-TO-BIN            VALUE '4'.
   756         88  JULIAN-TO-BIN              VALUE '5'.
   757         88  BIN-PLUS-ELAPSED           VALUE '6'.
   758         88  FIND-CENTURY               VALUE '7'.
   759         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   760         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   761         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   762         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   763         88  JULIAN-TO-BIN-3            VALUE 'C'.
   764         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   765         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   766         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   767         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   768         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   769         88  CHECK-LEAP-YEAR            VALUE 'H'.
   770         88  BIN-3-TO-GREG              VALUE 'I'.
   771         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   772         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   773         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   774         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   775         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   776         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   777         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   778         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   779         88  THREE-CHARACTER-BIN
   780                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   781         88  GREGORIAN-TO-BIN
   782                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   783         88  BIN-TO-GREGORIAN
   784                  VALUES ' ' '1' 'I' '8' 'G'.
   785         88  JULIAN-TO-BINARY
   786                  VALUES '5' 'C' 'E' 'F'.
   787     12  DC-ERROR-CODE                 PIC X.
   788         88  NO-CONVERSION-ERROR        VALUE ' '.
   789         88  DATE-CONVERSION-ERROR
   790                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   791         88  DATE-IS-ZERO               VALUE '1'.
   792         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  17
* EL150.cbl
   793         88  DATE-IS-INVALID            VALUE '3'.
   794         88  DATE1-GREATER-DATE2        VALUE '4'.
   795         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   796         88  DATE-INVALID-OPTION        VALUE '9'.
   797         88  INVALID-CENTURY            VALUE 'A'.
   798         88  ONLY-CENTURY               VALUE 'B'.
   799         88  ONLY-LEAP-YEAR             VALUE 'C'.
   800         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   801     12  DC-END-OF-MONTH               PIC X.
   802         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   803     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   804         88  USE-NORMAL-PROCESS         VALUE ' '.
   805         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   806         88  ADJUST-UP-100-YRS          VALUE '2'.
   807     12  FILLER                        PIC X.
   808     12  DC-CONVERSION-DATES.
   809         16  DC-BIN-DATE-1             PIC XX.
   810         16  DC-BIN-DATE-2             PIC XX.
   811         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   812         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   813                       DC-GREG-DATE-1-EDIT.
   814             20  DC-EDIT1-MONTH        PIC 99.
   815             20  SLASH1-1              PIC X.
   816             20  DC-EDIT1-DAY          PIC 99.
   817             20  SLASH1-2              PIC X.
   818             20  DC-EDIT1-YEAR         PIC 99.
   819         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   820         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   821                     DC-GREG-DATE-2-EDIT.
   822             20  DC-EDIT2-MONTH        PIC 99.
   823             20  SLASH2-1              PIC X.
   824             20  DC-EDIT2-DAY          PIC 99.
   825             20  SLASH2-2              PIC X.
   826             20  DC-EDIT2-YEAR         PIC 99.
   827         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   828         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   829                     DC-GREG-DATE-1-YMD.
   830             20  DC-YMD-YEAR           PIC 99.
   831             20  DC-YMD-MONTH          PIC 99.
   832             20  DC-YMD-DAY            PIC 99.
   833         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   834         16  DC-GREG-DATE-1-MDY-R REDEFINES
   835                      DC-GREG-DATE-1-MDY.
   836             20  DC-MDY-MONTH          PIC 99.
   837             20  DC-MDY-DAY            PIC 99.
   838             20  DC-MDY-YEAR           PIC 99.
   839         16  DC-GREG-DATE-1-ALPHA.
   840             20  DC-ALPHA-MONTH        PIC X(10).
   841             20  DC-ALPHA-DAY          PIC 99.
   842             20  FILLER                PIC XX.
   843             20  DC-ALPHA-CENTURY.
   844                 24 DC-ALPHA-CEN-N     PIC 99.
   845             20  DC-ALPHA-YEAR         PIC 99.
   846         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   847         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   848         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   849         16  DC-JULIAN-DATE            PIC 9(05).
   850         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  18
* EL150.cbl
   851                                       PIC 9(05).
   852         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   853             20  DC-JULIAN-YEAR        PIC 99.
   854             20  DC-JULIAN-DAYS        PIC 999.
   855         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   856         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   857         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   858     12  DATE-CONVERSION-VARIBLES.
   859         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   860         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   861             20  FILLER                PIC 9(3).
   862             20  HOLD-CEN-1-CCYY.
   863                 24  HOLD-CEN-1-CC     PIC 99.
   864                 24  HOLD-CEN-1-YY     PIC 99.
   865             20  HOLD-CEN-1-MO         PIC 99.
   866             20  HOLD-CEN-1-DA         PIC 99.
   867         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   868             20  HOLD-CEN-1-R-MO       PIC 99.
   869             20  HOLD-CEN-1-R-DA       PIC 99.
   870             20  HOLD-CEN-1-R-CCYY.
   871                 24  HOLD-CEN-1-R-CC   PIC 99.
   872                 24  HOLD-CEN-1-R-YY   PIC 99.
   873             20  FILLER                PIC 9(3).
   874         16  HOLD-CENTURY-1-X.
   875             20  FILLER                PIC X(3)  VALUE SPACES.
   876             20  HOLD-CEN-1-X-CCYY.
   877                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   878                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   879             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   880             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   881         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   882             20  HOLD-CEN-1-R-X-MO     PIC XX.
   883             20  HOLD-CEN-1-R-X-DA     PIC XX.
   884             20  HOLD-CEN-1-R-X-CCYY.
   885                 24  HOLD-CEN-1-R-X-CC PIC XX.
   886                 24  HOLD-CEN-1-R-X-YY PIC XX.
   887             20  FILLER                PIC XXX.
   888         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   889         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   890         16  DC-JULIAN-DATE-1          PIC 9(07).
   891         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   892             20  DC-JULIAN-1-CCYY.
   893                 24  DC-JULIAN-1-CC    PIC 99.
   894                 24  DC-JULIAN-1-YR    PIC 99.
   895             20  DC-JULIAN-DA-1        PIC 999.
   896         16  DC-JULIAN-DATE-2          PIC 9(07).
   897         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   898             20  DC-JULIAN-2-CCYY.
   899                 24  DC-JULIAN-2-CC    PIC 99.
   900                 24  DC-JULIAN-2-YR    PIC 99.
   901             20  DC-JULIAN-DA-2        PIC 999.
   902         16  DC-GREG-DATE-A-EDIT.
   903             20  DC-EDITA-MONTH        PIC 99.
   904             20  SLASHA-1              PIC X VALUE '/'.
   905             20  DC-EDITA-DAY          PIC 99.
   906             20  SLASHA-2              PIC X VALUE '/'.
   907             20  DC-EDITA-CCYY.
   908                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  19
* EL150.cbl
   909                 24  DC-EDITA-YEAR     PIC 99.
   910         16  DC-GREG-DATE-B-EDIT.
   911             20  DC-EDITB-MONTH        PIC 99.
   912             20  SLASHB-1              PIC X VALUE '/'.
   913             20  DC-EDITB-DAY          PIC 99.
   914             20  SLASHB-2              PIC X VALUE '/'.
   915             20  DC-EDITB-CCYY.
   916                 24  DC-EDITB-CENT     PIC 99.
   917                 24  DC-EDITB-YEAR     PIC 99.
   918         16  DC-GREG-DATE-CYMD         PIC 9(08).
   919         16  DC-GREG-DATE-CYMD-R REDEFINES
   920                              DC-GREG-DATE-CYMD.
   921             20  DC-CYMD-CEN           PIC 99.
   922             20  DC-CYMD-YEAR          PIC 99.
   923             20  DC-CYMD-MONTH         PIC 99.
   924             20  DC-CYMD-DAY           PIC 99.
   925         16  DC-GREG-DATE-MDCY         PIC 9(08).
   926         16  DC-GREG-DATE-MDCY-R REDEFINES
   927                              DC-GREG-DATE-MDCY.
   928             20  DC-MDCY-MONTH         PIC 99.
   929             20  DC-MDCY-DAY           PIC 99.
   930             20  DC-MDCY-CEN           PIC 99.
   931             20  DC-MDCY-YEAR          PIC 99.
   932    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   933        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   934    12  DC-EL310-DATE                  PIC X(21).
   935    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  20
* EL150.cbl
   937*                            COPY ELCCALC.
   938******************************************************************
   939*                                                                *
   940*                           ELCCALC.                            *
   941*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   942*                            VMOD=2.025                          *
   943*                                                                *
   944*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
   945*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
   946*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
   947*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
   948*                                                                *
   949*  PASSED TO ELRTRM                                              *
   950*  -----------------                                             *
   951*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
   952*  ORIGINAL TERM                                                 *
   953*  BEGINNING DATE                                                *
   954*  ENDING DATE                                                   *
   955*  COMPANY I.D.                                                  *
   956*  ACCOUNT MASTER USER FIELD                                     *
   957*  PROCESS SWITCH (CANCEL, CLAIM)                                *
   958*  FREE LOOK DAYS                                                *
   959*                                                                *
   960*  RETURNED FROM ELRTRM                                          *
   961*  ---------------------                                         *
   962*  REMAINING TERM 1 - USED FOR EARNINGS                          *
   963*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
   964*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
   965*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
   966*----------------------------------------------------------------*
   967*  PASSED TO ELRAMT                                              *
   968*  ----------------                                              *
   969*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
   970*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
   971*  ORIGINAL AMOUNT                                               *
   972*  ALTERNATE BENEFIT (BALLON)                                    *
   973*  A.P.R. - NET PAY ONLY                                         *
   974*  METHOD
   975*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
   976*  COMPANY I.D.                                                  *
   977*  BENEFIT TYPE                                                  *
   978*                                                                *
   979*  RETURNED FROM ELRAMT                                          *
   980*  --------------------                                          *
   981*  REMAINING AMOUNT 1 - CURRENT                                  *
   982*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
   983*  REMAINING AMOUNT FACTOR
   984*----------------------------------------------------------------*
   985*  PASSED TO ELRESV                                              *
   986*  -----------------                                             *
   987*  CERTIFICATE EFFECTIVE DATE                                    *
   988*  VALUATION DATE                                                *
   989*  PAID THRU DATE                                                *
   990*  BENEFIT                                                       *
   991*  INCURRED DATE                                                 *
   992*  REPORTED DATE                                                 *
   993*  ISSUE AGE                                                     *
   994*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  21
* EL150.cbl
   995*  CDT PERCENT                                                   *
   996*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
   997* *CLAIM TYPE (LIFE, A/H)                                        *
   998* *REMAINING BENEFIT (FROM ELRAMT)                               *
   999* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1000*                                                                *
  1001*  RETURNED FROM ELRESV                                          *
  1002*  --------------------                                          *
  1003*  CDT TABLE USED                                                *
  1004*  CDT FACTOR USED                                               *
  1005*  PAY TO CURRENT RESERVE                                        *
  1006*  I.B.N.R. - A/H ONLY                                           *
  1007*  FUTURE (ACCRUED) AH ONLY                                      *
  1008*----------------------------------------------------------------*
  1009*  PASSED TO ELRATE                                              *
  1010*  ----------------                                              *
  1011*  CERT ISSUE DATE                                               *
  1012*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1013*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1014*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1015*  STATE CODE (CLIENT DEFINED)                                   *
  1016*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1017*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1018*  DEVIATION CODE                                                *
  1019*  ISSUE AGE                                                     *
  1020*  ORIGINAL BENEFIT AMOUNT                                       *
  1021*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1022*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1023*  BENEFIT KIND (LIFE OR A/H)                                    *
  1024*  A.P.R.                                                        *
  1025*  METHOD
  1026*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1027*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1028*  COMPANY I.D. (3 CHARACTER)                                    *
  1029*  BENEFIT CODE                                                  *
  1030*  BENEFIT OVERRIDE CODE                                         *
  1031*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1032*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1033*  JOINT INDICATOR (CSL ONLY)                                    *
  1034*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1035*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1036*                                                                *
  1037*  RETURNED FROM ELRATE                                          *
  1038*  --------------------                                          *
  1039*  CALCULATED PREMIUM                                            *
  1040*  PREMIUM RATE                                                  *
  1041*  MORTALITY CODE                                                *
  1042*  MAX ATTAINED AGE                                              *
  1043*  MAX AGE                                                       *
  1044*  MAX TERM                                                      *
  1045*  MAX MONTHLY BENEFIT                                           *
  1046*  MAX TOTAL BENIFIT                                             *
  1047*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1048*----------------------------------------------------------------*
  1049*  PASSED TO ELRFND                                              *
  1050*  ----------------                                              *
  1051*  CERT ISSUE DATE                                               *
  1052*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  22
* EL150.cbl
  1053*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1054*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1055*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1056*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1057*  STATE CODE (CLIENT DEFINED)                                   *
  1058*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1059*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1060*  DEVIATION CODE                                                *
  1061*  ISSUE AGE                                                     *
  1062*  ORIGINAL BENEFIT AMOUNT                                       *
  1063*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1064*  PROCESS TYPE (CANCEL)                                         *
  1065*  BENEFIT KIND (LIFE OR A/H)                                    *
  1066*  A.P.R.                                                        *
  1067*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1068*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1069*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1070*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1071*  COMPANY I.D. (3 CHARACTER)                                    *
  1072*  BENEFIT CODE                                                  *
  1073*  BENEFIT OVERRIDE CODE                                         *
  1074*                                                                *
  1075*  RETURNED FROM ELRFND                                          *
  1076*  --------------------                                          *
  1077*  CALCULATED REFUND                                             *
  1078*----------------------------------------------------------------*
  1079*  PASSED TO ELEARN                                              *
  1080*  ----------------                                              *
  1081*  CERT ISSUE DATE                                               *
  1082*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1083*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1084*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1085*  STATE CODE (CLIENT DEFINED)                                   *
  1086*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1087*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1088*  DEVIATION CODE                                                *
  1089*  ISSUE AGE                                                     *
  1090*  ORIGINAL BENEFIT AMOUNT                                       *
  1091*  BENEFIT KIND (LIFE OR A/H)                                    *
  1092*  A.P.R.                                                        *
  1093*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1094*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1095*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1096*  COMPANY I.D. (3 CHARACTER)                                    *
  1097*  BENEFIT CODE                                                  *
  1098*  BENEFIT OVERRIDE CODE                                         *
  1099*                                                                *
  1100*  RETURNED FROM ELEARN                                          *
  1101*  --------------------                                          *
  1102*  INDICATED  EARNINGS                                           *
  1103*----------------------------------------------------------------*
  1104*                 LENGTH = 450                                   *
  1105*                                                                *
  1106******************************************************************
  1107******************************************************************
  1108*                   C H A N G E   L O G
  1109*
  1110* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  23
* EL150.cbl
  1111*-----------------------------------------------------------------
  1112*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1113* EFFECTIVE    NUMBER
  1114*-----------------------------------------------------------------
  1115* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1116* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1117* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1118* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1119* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1120* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1121* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1122* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1123* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1124******************************************************************
  1125
  1126 01  CALCULATION-PASS-AREA.
  1127     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1128                                     COMP.
  1129
  1130     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1131       88  NO-CP-ERROR                             VALUE ZERO.
  1132       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1133                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1134       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1135       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1136       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1137       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1138       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1139       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1140       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1141       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1142       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1143       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1144       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1145       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1146       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1147       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1148       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1149       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1150       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1151
  1152     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1153       88  NO-CP-ERROR-2                           VALUE ZERO.
  1154***********************  INPUT AREAS ****************************
  1155
  1156     12  CP-CALCULATION-AREA.
  1157         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1158         16  CP-CERT-EFF-DT        PIC XX.
  1159         16  CP-VALUATION-DT       PIC XX.
  1160         16  CP-PAID-THRU-DT       PIC XX.
  1161         16  CP-BENEFIT-TYPE       PIC X.
  1162           88  CP-AH                               VALUE 'A' 'D'
  1163                                                   'I' 'U'.
  1164           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1165           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1166         16  CP-INCURRED-DT        PIC XX.
  1167         16  CP-REPORTED-DT        PIC XX.
  1168         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  24
* EL150.cbl
  1169         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1170         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1171                                     COMP-3.
  1172         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1173                                     COMP-3.
  1174         16  CP-CDT-METHOD         PIC X.
  1175           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1176           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1177           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1178         16  CP-CLAIM-TYPE         PIC X.
  1179           88  CP-AH-CLAIM                         VALUE 'A'.
  1180           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1181         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1182                                     COMP-3.
  1183         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1184                                     COMP-3.
  1185         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1186                                     COMP-3.
  1187         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1188                                     COMP-3.
  1189         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1190                                     COMP-3.
  1191         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1192                                     COMP-3.
  1193         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1194                                     COMP-3.
  1195         16  CP-REM-TERM-METHOD    PIC X.
  1196           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1197           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1198           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1199           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1200           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1201           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1202           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1203         16  CP-EARNING-METHOD     PIC X.
  1204           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1205           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1206           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1207           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1208           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1209           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1210           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1211           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1212           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1213           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1214           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1215           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1216           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1217           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1218         16  CP-PROCESS-TYPE       PIC X.
  1219           88  CP-CLAIM                            VALUE '1'.
  1220           88  CP-CANCEL                           VALUE '2'.
  1221           88  CP-ISSUE                            VALUE '3'.
  1222         16  CP-SPECIAL-CALC-CD    PIC X.
  1223           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1224           88  CP-1-MTH-INTEREST               VALUE ' '.
  1225           88  CP-0-MTH-INTEREST               VALUE 'A'.
  1226           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  25
* EL150.cbl
  1227           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1228           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1229           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1230           88  CP-FARM-PLAN                    VALUE 'F'.
  1231           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1232           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1233           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1234           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1235           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1236           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1237           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1238           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1239           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1240           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1241                                                     'W' 'X'.
  1242           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1243           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1244           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1245           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1246           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1247           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1248           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1249           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1250           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1251           88  CP-CSL-METH-1                   VALUE '5'.
  1252           88  CP-CSL-METH-2                   VALUE '6'.
  1253           88  CP-CSL-METH-3                   VALUE '7'.
  1254           88  CP-CSL-METH-4                   VALUE '8'.
  1255
  1256         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1257                                     COMP-3.
  1258         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1259         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1260         16  CP-STATE              PIC XX          VALUE SPACE.
  1261         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1262         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1263           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1264               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1265         16  CP-R78-OPTION         PIC X.
  1266           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1267           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1268
  1269         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1270         16  CP-IBNR-RESERVE-SW    PIC X.
  1271         16  CP-CLAIM-STATUS       PIC X.
  1272         16  CP-RATE-FILE          PIC X.
  1273         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1274                                     COMP-3.
  1275
  1276         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1277         16  CP-AH-OVERRIDE-CODE   PIC X.
  1278
  1279         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1280                                     COMP-3.
  1281         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1282                                   PIC S9(5)V99 COMP-3.
  1283         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  1284                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  26
* EL150.cbl
  1285         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1286                                     COMP-3.
  1287         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1288                                     COMP-3.
  1289         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1290                                  PIC S9(7)V99 COMP-3.
  1291
  1292         16  CP-PAID-FROM-DATE     PIC X(02).
  1293         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1294         16  CP-EXT-DAYS-CALC      PIC X.
  1295           88  CP-EXT-NO-CHG                   VALUE ' '.
  1296           88  CP-EXT-CHG-LF                   VALUE '1'.
  1297           88  CP-EXT-CHG-AH                   VALUE '2'.
  1298           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1299         16  CP-DOMICILE-STATE     PIC XX.
  1300         16  CP-CARRIER            PIC X.
  1301         16  CP-REIN-FLAG          PIC X.
  1302         16  CP-REM-TRM-CALC-OPTION PIC X.
  1303           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1304                      '2' '3' '4' '5'.
  1305           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1306           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1307           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1308           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1309           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1310           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1311           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1312           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1313         16  CP-SIG-SWITCH         PIC X.
  1314         16  CP-RATING-METHOD      PIC X.
  1315           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1316           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1317           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1318           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1319           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1320           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1321           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1322           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1323           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1324         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1325                                     COMP-3.
  1326         16  CP-BEN-CATEGORY       PIC X.
  1327         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1328         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1329                                   PIC S99V9(5) COMP-3.
  1330         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1331         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1332                                   PIC S99V9(5) COMP-3.
  1333         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1334         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1335         16  CP-EXPIRE-DT          PIC XX.
  1336         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1337         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1338         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1339         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1340         16  CP-DDF-SPEC-CALC      PIC X.
  1341             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  1342             88  CP-CALC-CLP              VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  27
* EL150.cbl
  1343         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1344         16  CP-CANCEL-REASON      PIC X.
  1345         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1346         16  CP-PMT-MODE           PIC X.
  1347         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1348         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1349         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1350         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1351         16  FILLER                PIC X.
  1352
  1353***************    OUTPUT FROM ELRESV   ************************
  1354
  1355         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1356
  1357         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1358                                     COMP-3.
  1359         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1360                                     COMP-3.
  1361         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1362                                     COMP-3.
  1363         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1364                                     COMP-3.
  1365         16  FILLER                PIC X(09).
  1366***************    OUTPUT FROM ELRTRM   *************************
  1367
  1368         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1369                                     COMP-3.
  1370         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1371                                     COMP-3.
  1372         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1373                                     COMP-3.
  1374         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1375                                     COMP-3.
  1376         16  FILLER                PIC X(12).
  1377
  1378***************    OUTPUT FROM ELRAMT   *************************
  1379
  1380         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1381                                     COMP-3.
  1382         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1383                                     COMP-3.
  1384         16  FILLER                PIC X(12).
  1385
  1386***************    OUTPUT FROM ELRATE   *************************
  1387
  1388         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1389                                     COMP-3.
  1390         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1391                                     COMP-3.
  1392         16  CP-MORTALITY-CODE     PIC X(4).
  1393         16  CP-RATE-EDIT-FLAG     PIC X.
  1394             88  CP-RATES-NEED-APR                  VALUE '1'.
  1395         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1396                                     COMP-3.
  1397         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1398         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1399         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  1400                                   PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  28
* EL150.cbl
  1401         16  FILLER                PIC X(07).
  1402
  1403***************    OUTPUT FROM ELRFND   *************************
  1404
  1405         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1406                                     COMP-3.
  1407         16  CP-REFUND-TYPE-USED   PIC X.
  1408           88  CP-R-AS-R78                         VALUE '1'.
  1409           88  CP-R-AS-PRORATA                     VALUE '2'.
  1410           88  CP-R-AS-CALIF                       VALUE '3'.
  1411           88  CP-R-AS-TEXAS                       VALUE '4'.
  1412           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1413           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1414           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1415           88  CP-R-AS-MEAN                        VALUE '8'.
  1416           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1417           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1418           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1419           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1420           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1421           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1422         16  FILLER                PIC X(12).
  1423
  1424***************    OUTPUT FROM ELEARN   *************************
  1425
  1426         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1427                                     COMP-3.
  1428         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1429                                     COMP-3.
  1430         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1431                                     COMP-3.
  1432         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1433                                     COMP-3.
  1434         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1435                                     COMP-3.
  1436         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1437                                     COMP-3.
  1438         16  CP-EARNING-TYPE-USED  PIC X.
  1439           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1440           88  CP-E-AS-R78                         VALUE '1'.
  1441           88  CP-E-AS-PRORATA                     VALUE '2'.
  1442           88  CP-E-AS-TEXAS                       VALUE '4'.
  1443           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1444           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1445           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1446           88  CP-E-AS-MEAN                        VALUE '8'.
  1447           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1448         16  FILLER                PIC X(12).
  1449
  1450***************    OUTPUT FROM ELPMNT   *************************
  1451
  1452         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1453                                     COMP-3.
  1454         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1455                                     COMP-3.
  1456         16  FILLER                PIC X(12).
  1457
  1458***************   MISC WORK AREAS    *****************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  29
* EL150.cbl
  1459         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1460                                     COMP-3.
  1461         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1462                                     COMP-3.
  1463         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1464                                     COMP-3.
  1465         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1466                                     COMP-3.
  1467         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1468                                     COMP-3.
  1469         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1470                                     COMP-3.
  1471         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1472             88  OPEN-RATE-FILE                   VALUE 'O'.
  1473             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1474             88  IO-ERROR                         VALUE 'E'.
  1475
  1476         16  CP-FIRST-PAY-DATE     PIC XX.
  1477
  1478         16  CP-JOINT-INDICATOR    PIC X.
  1479
  1480         16  CP-RESERVE-REMAINING-TERM
  1481                                   PIC S9(4)V9    VALUE ZERO
  1482                                     COMP-3.
  1483
  1484         16  CP-INSURED-BIRTH-DT   PIC XX.
  1485
  1486         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1487                                     COMP-3.
  1488
  1489         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1490                                     COMP-3.
  1491
  1492         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1493                                     COMP-3.
  1494
  1495         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1496                                     COMP-3.
  1497
  1498         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1499                                     COMP-3.
  1500
  1501         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1502                                     COMP-3.
  1503
  1504         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1505                                     COMP-3.
  1506
  1507         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1508             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1509
  1510         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1511                                     COMP-3.
  1512         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1513                                     COMP-3.
  1514         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1515         16  FILLER                PIC X(15).
  1516******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  30
* EL150.cbl
  1518*                            COPY ELCLOGOF.
  1519******************************************************************
  1520*                                                                *
  1521*                                                                *
  1522*                            ELCLOGOF.                           *
  1523*                            VMOD=2.001                          *
  1524*                                                                *
  1525*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1526*                                                                *
  1527******************************************************************
  1528 01  CLASIC-LOGOFF.
  1529     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1530     12  LOGOFF-TEXT.
  1531         16  FILLER          PIC X(5)    VALUE SPACES.
  1532         16  LOGOFF-MSG.
  1533             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1534             20  FILLER      PIC X       VALUE SPACES.
  1535             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1536         16  FILLER          PIC X(80)
  1537           VALUE '* YOU ARE NOW LOGGED OFF'.
  1538         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1539         16  FILLER          PIC X       VALUE QUOTE.
  1540         16  LOGOFF-SYS-MSG  PIC X(17)
  1541           VALUE 'S CLAS-IC SYSTEM '.
  1542     12  TEXT-MESSAGES.
  1543         16  UNACCESS-MSG    PIC X(29)
  1544             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1545         16  PGMIDERR-MSG    PIC X(17)
  1546             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  31
* EL150.cbl
  1548*                            COPY ELCATTR.
  1549******************************************************************
  1550*                                                                *
  1551*                            ELCATTR.                            *
  1552*                            VMOD=2.001                          *
  1553*                                                                *
  1554*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1555*                                                                *
  1556*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1557*                                                                *
  1558*                   POS 1   P=PROTECTED                          *
  1559*                           U=UNPROTECTED                        *
  1560*                           S=ASKIP                              *
  1561*                   POS 2   A=ALPHA/NUMERIC                      *
  1562*                           N=NUMERIC                            *
  1563*                   POS 3   N=NORMAL                             *
  1564*                           B=BRIGHT                             *
  1565*                           D=DARK                               *
  1566*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1567*                           OF=MODIFIED DATA TAG OFF             *
  1568*                                                                *
  1569*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1570******************************************************************
  1571 01  ATTRIBUTE-LIST.
  1572     12  AL-PABOF            PIC X       VALUE 'Y'.
  1573     12  AL-PABON            PIC X       VALUE 'Z'.
  1574     12  AL-PADOF            PIC X       VALUE '%'.
  1575     12  AL-PADON            PIC X       VALUE '_'.
  1576     12  AL-PANOF            PIC X       VALUE '-'.
  1577     12  AL-PANON            PIC X       VALUE '/'.
  1578     12  AL-SABOF            PIC X       VALUE '8'.
  1579     12  AL-SABON            PIC X       VALUE '9'.
  1580     12  AL-SADOF            PIC X       VALUE '@'.
  1581     12  AL-SADON            PIC X       VALUE QUOTE.
  1582     12  AL-SANOF            PIC X       VALUE '0'.
  1583     12  AL-SANON            PIC X       VALUE '1'.
  1584     12  AL-UABOF            PIC X       VALUE 'H'.
  1585     12  AL-UABON            PIC X       VALUE 'I'.
  1586     12  AL-UADOF            PIC X       VALUE '<'.
  1587     12  AL-UADON            PIC X       VALUE '('.
  1588     12  AL-UANOF            PIC X       VALUE ' '.
  1589     12  AL-UANON            PIC X       VALUE 'A'.
  1590     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1591     12  AL-UNBON            PIC X       VALUE 'R'.
  1592     12  AL-UNDOF            PIC X       VALUE '*'.
  1593     12  AL-UNDON            PIC X       VALUE ')'.
  1594     12  AL-UNNOF            PIC X       VALUE '&'.
  1595     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  32
* EL150.cbl
  1597*                            COPY ELCMSTR.
  1598******************************************************************
  1599*                                                                *
  1600*                            ELCMSTR.                            *
  1601*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1602*                            VMOD=2.012                          *
  1603*                                                                *
  1604*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1605*                                                                *
  1606*   FILE TYPE = VSAM,KSDS                                        *
  1607*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1608*                                                                *
  1609*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1610*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1611*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1612*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1613*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1614*                                                 RKP=75,LEN=21  *
  1615*                                                                *
  1616*   **** NOTE ****                                               *
  1617*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1618*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1619*                                                                *
  1620*   LOG = YES                                                    *
  1621*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1622******************************************************************
  1623*                   C H A N G E   L O G
  1624*
  1625* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1626*-----------------------------------------------------------------
  1627*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1628* EFFECTIVE    NUMBER
  1629*-----------------------------------------------------------------
  1630* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1631* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1632* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1633* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1634* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1635******************************************************************
  1636 01  CLAIM-MASTER.
  1637     12  CL-RECORD-ID                PIC XX.
  1638         88  VALID-CL-ID         VALUE 'CL'.
  1639
  1640     12  CL-CONTROL-PRIMARY.
  1641         16  CL-COMPANY-CD           PIC X.
  1642         16  CL-CARRIER              PIC X.
  1643         16  CL-CLAIM-NO             PIC X(7).
  1644         16  CL-CERT-NO.
  1645             20  CL-CERT-PRIME       PIC X(10).
  1646             20  CL-CERT-SFX         PIC X.
  1647
  1648     12  CL-CONTROL-BY-NAME.
  1649         16  CL-COMPANY-CD-A1        PIC X.
  1650         16  CL-INSURED-LAST-NAME    PIC X(15).
  1651         16  CL-INSURED-NAME.
  1652             20  CL-INSURED-1ST-NAME PIC X(12).
  1653             20  CL-INSURED-MID-INIT PIC X.
  1654
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  33
* EL150.cbl
  1655     12  CL-CONTROL-BY-SSN.
  1656         16  CL-COMPANY-CD-A2        PIC X.
  1657         16  CL-SOC-SEC-NO.
  1658             20  CL-SSN-STATE        PIC XX.
  1659             20  CL-SSN-ACCOUNT      PIC X(6).
  1660             20  CL-SSN-LN3          PIC X(3).
  1661
  1662     12  CL-CONTROL-BY-CERT-NO.
  1663         16  CL-COMPANY-CD-A4        PIC X.
  1664         16  CL-CERT-NO-A4.
  1665             20  CL-CERT-A4-PRIME    PIC X(10).
  1666             20  CL-CERT-A4-SFX      PIC X.
  1667
  1668     12  CL-CONTROL-BY-CCN.
  1669         16  CL-COMPANY-CD-A5        PIC X.
  1670         16  CL-CCN-A5.
  1671             20  CL-CCN.
  1672                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1673                 24  CL-CCN-PRIME-A5 PIC X(12).
  1674             20  CL-CCN-FILLER-A5    PIC X(4).
  1675
  1676     12  CL-INSURED-PROFILE-DATA.
  1677         16  CL-INSURED-BIRTH-DT     PIC XX.
  1678         16  CL-INSURED-SEX-CD       PIC X.
  1679             88  INSURED-IS-MALE        VALUE 'M'.
  1680             88  INSURED-IS-FEMALE      VALUE 'F'.
  1681             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1682         16  CL-INSURED-OCC-CD       PIC X(6).
  1683         16  FILLER                  PIC X(5).
  1684
  1685     12  CL-PROCESSING-INFO.
  1686         16  CL-PROCESSOR-ID         PIC X(4).
  1687         16  CL-CLAIM-STATUS         PIC X.
  1688             88  CLAIM-IS-OPEN          VALUE 'O'.
  1689             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1690         16  CL-CLAIM-TYPE           PIC X.
  1691*            88  AH-CLAIM               VALUE 'A'.
  1692*            88  LIFE-CLAIM             VALUE 'L'.
  1693*            88  PROPERTY-CLAIM         VALUE 'P'.
  1694*            88  IUI-CLAIM              VALUE 'I'.
  1695*            88  GAP-CLAIM              VALUE 'G'.
  1696*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1697         16  CL-CLAIM-PREM-TYPE      PIC X.
  1698             88  SINGLE-PREMIUM         VALUE '1'.
  1699             88  O-B-COVERAGE           VALUE '2'.
  1700             88  OPEN-END-COVERAGE      VALUE '3'.
  1701         16  CL-INCURRED-DT          PIC XX.
  1702         16  CL-REPORTED-DT          PIC XX.
  1703         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1704         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1705         16  CL-LAST-PMT-DT          PIC XX.
  1706         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1707         16  CL-PAID-THRU-DT         PIC XX.
  1708         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1709         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  1710         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1711         16  CL-PMT-CALC-METHOD      PIC X.
  1712             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  34
* EL150.cbl
  1713             88  CL-365-DAY-YR          VALUE '2'.
  1714             88  CL-FULL-MONTHS         VALUE '3'.
  1715         16  CL-CAUSE-CD             PIC X(6).
  1716
  1717         16  CL-PRIME-CERT-NO.
  1718             20  CL-PRIME-CERT-PRIME PIC X(10).
  1719             20  CL-PRIME-CERT-SFX   PIC X.
  1720
  1721         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1722             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1723             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1724
  1725         16  CL-MICROFILM-NO         PIC X(10).
  1726         16  FILLER REDEFINES CL-MICROFILM-NO.
  1727             20  CL-BENEFIT-PERIOD   PIC 99.
  1728             20  FILLER              PIC X(8).
  1729         16  CL-PROG-FORM-TYPE       PIC X.
  1730         16  CL-LAST-ADD-ON-DT       PIC XX.
  1731
  1732         16  CL-LAST-REOPEN-DT       PIC XX.
  1733         16  CL-LAST-CLOSE-DT        PIC XX.
  1734         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1735             88  FINAL-PAID             VALUE '1'.
  1736             88  CLAIM-DENIED           VALUE '2'.
  1737             88  AUTO-CLOSE             VALUE '3'.
  1738             88  MANUAL-CLOSE           VALUE '4'.
  1739             88  BENEFITS-CHANGED       VALUE 'C'.
  1740             88  SETUP-ERRORS           VALUE 'E'.
  1741         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1742         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1743         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1744             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1745         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1746         16  FILLER                  PIC X.
  1747
  1748     12  CL-CERTIFICATE-DATA.
  1749         16  CL-CERT-ORIGIN          PIC X.
  1750             88  CERT-WAS-ONLINE        VALUE '1'.
  1751             88  CERT-WAS-CREATED       VALUE '2'.
  1752             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1753         16  CL-CERT-KEY-DATA.
  1754             20  CL-CERT-CARRIER     PIC X.
  1755             20  CL-CERT-GROUPING    PIC X(6).
  1756             20  CL-CERT-STATE       PIC XX.
  1757             20  CL-CERT-ACCOUNT.
  1758                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1759                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1760             20  CL-CERT-EFF-DT      PIC XX.
  1761
  1762     12  CL-STATUS-CONTROLS.
  1763         16  CL-PRIORITY-CD          PIC X.
  1764             88  CONFIDENTIAL-DATA      VALUE '8'.
  1765             88  HIGHEST-PRIORITY       VALUE '9'.
  1766         16  CL-SUPV-ATTN-CD         PIC X.
  1767             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  1768             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1769         16  CL-PURGED-DT            PIC XX.
  1770         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  35
* EL150.cbl
  1771         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1772         16  CL-NEXT-RESEND-DT       PIC XX.
  1773         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1774         16  CL-CRITICAL-PERIOD      PIC 99.
  1775*        16  FILLER                  PIC XX.
  1776         16  CL-LAST-MAINT-DT        PIC XX.
  1777         16  CL-LAST-MAINT-USER      PIC X(4).
  1778         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1779         16  CL-LAST-MAINT-TYPE      PIC X.
  1780             88  CLAIM-SET-UP           VALUE ' '.
  1781             88  PAYMENT-MADE           VALUE '1'.
  1782             88  LETTER-SENT            VALUE '2'.
  1783             88  MASTER-WAS-ALTERED     VALUE '3'.
  1784             88  MASTER-WAS-RESTORED    VALUE '4'.
  1785             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1786             88  FILE-CONVERTED         VALUE '6'.
  1787             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1788             88  ERROR-CORRECTION       VALUE 'E'.
  1789         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1790         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1791         16  CL-BENEFICIARY          PIC X(10).
  1792         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1793         16  CL-DENIAL-TYPE          PIC X.
  1794             88  CL-TYPE-DENIAL          VALUE '1'.
  1795             88  CL-TYPE-RESCISSION      VALUE '2'.
  1796             88  CL-TYPE-REFORMATION     VALUE '3'.
  1797             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1798             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1799         16  filler                  pic x(5).
  1800*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1801*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1802*        16  CL-RTW-DT               PIC XX.
  1803
  1804     12  CL-TRAILER-CONTROLS.
  1805         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1806             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1807             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1808             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1809         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1810         16  FILLER                  PIC XX.
  1811         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1812         16  CL-ADDRESS-TRAILER-CNT.
  1813             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1814                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1815             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1816                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1817             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1818                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1819             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1820                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1821             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1822                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1823             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1824                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  1825             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1826                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1827
  1828     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  36
* EL150.cbl
  1829         16  CL-CV-REFNO-PRIME       PIC X(18).
  1830         16  CL-CV-REFNO-SFX         PIC XX.
  1831
  1832     12  CL-FILE-LOCATION            PIC X(4).
  1833
  1834     12  CL-PROCESS-ERRORS.
  1835         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1836             88  NO-FATAL-ERRORS        VALUE ZERO.
  1837         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1838             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1839
  1840     12  CL-PRODUCT-CD               PIC X.
  1841
  1842     12  CL-CURRENT-KEY-DATA.
  1843         16  CL-CURRENT-CARRIER      PIC X.
  1844         16  CL-CURRENT-GROUPING     PIC X(6).
  1845         16  CL-CURRENT-STATE        PIC XX.
  1846         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1847
  1848     12  CL-ASSOCIATES               PIC X.
  1849         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1850         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1851         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1852         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1853
  1854     12  CL-ACTIVITY-CODE            PIC 99.
  1855     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1856     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1857
  1858     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1859     12  CL-LAG-REPORT-CODE          PIC 9.
  1860     12  CL-LOAN-TYPE                PIC XX.
  1861     12  CL-LEGAL-STATE              PIC XX.
  1862
  1863     12  CL-YESNOSW                  PIC X.
  1864     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1865         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1866         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1867         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1868     12  cl-insured-type             pic x.
  1869         88  cl-claim-on-primary         value 'P'.
  1870         88  cl-claim-on-co-borrower     value 'C'.
  1871     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  37
* EL150.cbl
  1873*                            COPY ELCEMIB.
  1874******************************************************************
  1875*                                                                *
  1876*                                                                *
  1877*                            ELCEMIB.                            *
  1878*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1879*                            VMOD=2.005                          *
  1880*                                                                *
  1881*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1882*                                                                *
  1883******************************************************************
  1884 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1885     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1886     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1887     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1888     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1889     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1890     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1891     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1892     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1893     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1894         88  EMI-NO-ERRORS                    VALUE '1'.
  1895         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1896         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1897     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1898         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1899     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1900         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1901         88  EMI-AREA1-FULL                   VALUE '2'.
  1902     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1903         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1904         88  EMI-AREA2-FULL                   VALUE '2'.
  1905     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1906         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1907         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1908         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1909         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1910         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1911     12  EMI-ERROR-LINES.
  1912         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1913         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1914         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1915         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1916             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1917                 24  EMI-ERR-NUM         PIC X(4).
  1918                 24  EMI-FILLER          PIC X.
  1919                 24  EMI-SEV             PIC X.
  1920                 24  FILLER              PIC X.
  1921             20  FILLER                  PIC X(02).
  1922     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1923         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1924             20  EMI-ERROR-NUMBER    PIC X(4).
  1925             20  EMI-FILL            PIC X.
  1926             20  EMI-SEVERITY        PIC X.
  1927             20  FILLER              PIC X.
  1928             20  EMI-ERROR-TEXT.
  1929                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1930                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  38
* EL150.cbl
  1931     12  EMI-SEVERITY-SAVE           PIC X.
  1932         88  EMI-NOTE                    VALUE 'N'.
  1933         88  EMI-WARNING                 VALUE 'W'.
  1934         88  EMI-FORCABLE                VALUE 'F'.
  1935         88  EMI-FATAL                   VALUE 'X'.
  1936     12  EMI-MESSAGE-FLAG            PIC X.
  1937         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1938         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1939     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1940     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1941         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1942         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1943         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1944     12  emi-claim-no                pic x(7).
  1945     12  emi-claim-type              pic x(6).
  1946     12  FILLER                      PIC X(124)  VALUE SPACES.
  1947     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1948     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1949     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1950     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  39
* EL150.cbl
  1952*                            COPY ELCLNKLT.
  1953******************************************************************
  1954*                                                                *
  1955*                                                                *
  1956*                           ELCLNKLT                             *
  1957*                            VMOD=2.003                          *
  1958*                                                                *
  1959*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1960*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1961*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1962*                                                                *
  1963*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1964*   COMPLETING THE REQUIRED FIELDS.                              *
  1965*                                                                *
  1966*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1967*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1968*                              9999 INDICATES AN UNKNOWN ABEND   *
  1969*                                   WAS DETECTED.                *
  1970*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1971*                              CODES FOUND IN THE ERROR FILE.    *
  1972******************************************************************
  1973 01  W-1523-LINKDATA.
  1974     12  W-1523-COMMON-PI-DATA.
  1975         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1976         16  FILLER              PIC  X(67).
  1977         16  W-1523-COMPANY-CD   PIC  X(01).
  1978         16  FILLER              PIC  X(10).
  1979         16  W-1523-CONTROL-IN-PROGRESS.
  1980             20  W-1523-CARRIER  PIC  X(01).
  1981             20  W-1523-GROUPING PIC  X(06).
  1982             20  W-1523-STATE    PIC  X(02).
  1983             20  W-1523-ACCOUNT  PIC  X(10).
  1984             20  W-1523-CLAIM-CERT-GRP.
  1985                 24  W-1523-CLAIM-NO
  1986                                 PIC  X(07).
  1987                 24  W-1523-CERT-NO.
  1988                     28  W-1523-CERT-PRIME
  1989                                 PIC  X(10).
  1990                     28  W-1523-CERT-SFX
  1991                                 PIC  X(01).
  1992                 24  W-1523-CERT-EFF-DT
  1993                                 PIC  X(02).
  1994         16  FILLER              PIC X(265).
  1995
  1996     12  W-1523-WORK-AREA.
  1997         16  W-1523-FORM-NUMBER  PIC  X(04).
  1998         16  W-1523-NUMBER-COPIES
  1999                                 PIC  9(01).
  2000         16  W-1523-ADDR-TYPE    PIC  X(02).
  2001         16  W-1523-FOLLOW-UP-DATE
  2002                                 PIC  X(02).
  2003         16  W-1523-RESEND-DATE  PIC  X(02).
  2004         16  W-1523-ERROR-CODE   PIC  9(04).
  2005             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  2006             88  W-1523-FATAL-ERROR
  2007                                    VALUES  0006 0013 0042
  2008                                            0154 0168 0169
  2009                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  40
* EL150.cbl
  2010                                            0179 0186 0281
  2011                                            0332 2055 3697
  2012                                            3698 3699 3770
  2013                                            3771 3772 7675
  2014                                            9106 9808 9883
  2015                                            9887.
  2016             88  W-1523-STOP-ERRORS
  2017                                    VALUES  0013 0042 0154
  2018                                            0168 0169 0172
  2019                                            0281 0332 2055
  2020                                            3698 3699 7675
  2021                                            9106 9808 9883
  2022                                            9999.
  2023         16  W-1523-REASON       PIC  X(70).
  2024         16  W-1523-ARCHIVE-NUMBER
  2025                                 PIC  9(08).
  2026     12  W-1523-POINTER-AREA.
  2027         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2028         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2029         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2030         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2031         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  41
* EL150.cbl
  2033*                            COPY ELCINTF.
  2034******************************************************************
  2035*                                                                *
  2036*                                                                *
  2037*                            ELCINTF.                            *
  2038*                            VMOD=2.017                          *
  2039*                                                                *
  2040*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2041*                                                                *
  2042*       LENGTH = 1024                                            *
  2043*                                                                *
  2044******************************************************************
  2045*                   C H A N G E   L O G
  2046*
  2047* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2048*-----------------------------------------------------------------
  2049*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2050* EFFECTIVE    NUMBER
  2051*-----------------------------------------------------------------
  2052* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2053******************************************************************
  2054 01  PROGRAM-INTERFACE-BLOCK.
  2055     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2056     12  PI-CALLING-PROGRAM              PIC X(8).
  2057     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2058     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2059     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2060     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2061     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2062     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2063     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2064     12  PI-COMPANY-ID                   PIC XXX.
  2065     12  PI-COMPANY-CD                   PIC X.
  2066
  2067     12  PI-COMPANY-PASSWORD             PIC X(8).
  2068
  2069     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2070
  2071     12  PI-CONTROL-IN-PROGRESS.
  2072         16  PI-CARRIER                  PIC X.
  2073         16  PI-GROUPING                 PIC X(6).
  2074         16  PI-STATE                    PIC XX.
  2075         16  PI-ACCOUNT                  PIC X(10).
  2076         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2077                                         PIC X(10).
  2078         16  PI-CLAIM-CERT-GRP.
  2079             20  PI-CLAIM-NO             PIC X(7).
  2080             20  PI-CERT-NO.
  2081                 25  PI-CERT-PRIME       PIC X(10).
  2082                 25  PI-CERT-SFX         PIC X.
  2083             20  PI-CERT-EFF-DT          PIC XX.
  2084         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2085             20  PI-PLAN-CODE            PIC X(2).
  2086             20  PI-REVISION-NUMBER      PIC X(3).
  2087             20  PI-PLAN-EFF-DT          PIC X(2).
  2088             20  PI-PLAN-EXP-DT          PIC X(2).
  2089             20  FILLER                  PIC X(11).
  2090         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  42
* EL150.cbl
  2091             20  PI-OE-REFERENCE-1.
  2092                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2093                 25  PI-OE-REF-1-SUFF    PIC XX.
  2094
  2095     12  PI-SESSION-IN-PROGRESS          PIC X.
  2096         88  CLAIM-SESSION                   VALUE '1'.
  2097         88  CREDIT-SESSION                  VALUE '2'.
  2098         88  WARRANTY-SESSION                VALUE '3'.
  2099         88  MORTGAGE-SESSION                VALUE '4'.
  2100         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2101
  2102
  2103*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2104
  2105     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2106     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2107
  2108     12  PI-CREDIT-USER                  PIC X.
  2109         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2110         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2111
  2112     12  PI-CLAIM-USER                   PIC X.
  2113         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2114         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2115
  2116     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2117         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2118         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2119         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2120         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2121         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2122
  2123     12  PI-PROCESSOR-ID                 PIC X(4).
  2124
  2125     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2126
  2127     12  PI-MEMBER-CAPTION               PIC X(10).
  2128
  2129     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2130         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2131
  2132     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2133     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2134     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2135     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2136
  2137     12  PI-AH-OVERRIDE-L1               PIC X.
  2138     12  PI-AH-OVERRIDE-L2               PIC XX.
  2139     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2140     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2141
  2142     12  PI-NEW-SYSTEM                   PIC X(2).
  2143
  2144     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2145     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2146         88  PI-USES-PAID-TO                 VALUE '1'.
  2147     12  PI-CRDTCRD-SYSTEM.
  2148         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  43
* EL150.cbl
  2149             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2150             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2151         16  PI-CC-MONTH-END-DT          PIC XX.
  2152     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2153
  2154     12  PI-OE-REFERENCE-2.
  2155         16  PI-OE-REF-2-PRIME           PIC X(10).
  2156         16  PI-OE-REF-2-SUFF            PIC X.
  2157
  2158     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2159
  2160     12  PI-LANGUAGE-TYPE                PIC X.
  2161             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2162             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2163             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2164
  2165     12  PI-POLICY-LINKAGE-IND           PIC X.
  2166         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2167         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2168                                                   LOW-VALUES.
  2169
  2170     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2171     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2172         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2173         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2174
  2175     12  PI-PROCESSOR-CSR-IND            PIC X.
  2176         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2177         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2178
  2179     12  FILLER                          PIC X(3).
  2180
  2181     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2182
  2183     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2184         PI-SYSTEM-LEVEL.
  2185
  2186         16  PI-ENTRY-CODES.
  2187             20  PI-ENTRY-CD-1           PIC X.
  2188             20  PI-ENTRY-CD-2           PIC X.
  2189
  2190         16  PI-RETURN-CODES.
  2191             20  PI-RETURN-CD-1          PIC X.
  2192             20  PI-RETURN-CD-2          PIC X.
  2193
  2194         16  PI-UPDATE-STATUS-SAVE.
  2195             20  PI-UPDATE-BY            PIC X(4).
  2196             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2197
  2198         16  PI-LOWER-CASE-LETTERS       PIC X.
  2199             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2200
  2201*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2202*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2203*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2204
  2205         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2206             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  44
* EL150.cbl
  2207             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2208             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2209             88  ACCNT-CNTL                  VALUE '3'.
  2210             88  CARR-ACCNT-CNTL             VALUE '4'.
  2211
  2212         16  PI-PROCESSOR-CAP-LIST.
  2213             20  PI-SYSTEM-CONTROLS.
  2214                24 PI-SYSTEM-DISPLAY     PIC X.
  2215                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2216                24 PI-SYSTEM-MODIFY      PIC X.
  2217                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2218             20  FILLER                  PIC XX.
  2219             20  PI-DISPLAY-CAP          PIC X.
  2220                 88  DISPLAY-CAP             VALUE 'Y'.
  2221             20  PI-MODIFY-CAP           PIC X.
  2222                 88  MODIFY-CAP              VALUE 'Y'.
  2223             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2224                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2225             20  PI-FORCE-CAP            PIC X.
  2226                 88  FORCE-CAP               VALUE 'Y'.
  2227
  2228         16  PI-PROGRAM-CONTROLS.
  2229             20  PI-PGM-PRINT-OPT        PIC X.
  2230             20  PI-PGM-FORMAT-OPT       PIC X.
  2231             20  PI-PGM-PROCESS-OPT      PIC X.
  2232             20  PI-PGM-TOTALS-OPT       PIC X.
  2233
  2234         16  PI-HELP-INTERFACE.
  2235             20  PI-LAST-ERROR-NO        PIC X(4).
  2236             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2237
  2238         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2239             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2240
  2241         16  PI-CR-CONTROL-IN-PROGRESS.
  2242             20  PI-CR-CARRIER           PIC X.
  2243             20  PI-CR-GROUPING          PIC X(6).
  2244             20  PI-CR-STATE             PIC XX.
  2245             20  PI-CR-ACCOUNT           PIC X(10).
  2246             20  PI-CR-FIN-RESP          PIC X(10).
  2247             20  PI-CR-TYPE              PIC X.
  2248
  2249         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2250
  2251         16  PI-CR-MONTH-END-DT          PIC XX.
  2252
  2253         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2254             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2255             88  PI-ZERO-CARRIER             VALUE '1'.
  2256             88  PI-ZERO-GROUPING            VALUE '2'.
  2257             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2258
  2259         16  PI-CARRIER-SECURITY         PIC X.
  2260             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2261
  2262         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2263             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2264             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  45
* EL150.cbl
  2265
  2266         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2267             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2268                                         INDEXED BY PI-ACCESS-NDX
  2269                                         PIC X.
  2270
  2271         16  PI-GA-BILLING-CONTROL       PIC X.
  2272             88  PI-GA-BILLING               VALUE '1'.
  2273
  2274         16  PI-MAIL-PROCESSING          PIC X.
  2275             88  PI-MAIL-YES                 VALUE 'Y'.
  2276
  2277         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2278
  2279         16  PI-AR-SYSTEM.
  2280             20  PI-AR-PROCESSING-CNTL   PIC X.
  2281                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2282             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2283             20  PI-AR-MONTH-END-DT      PIC XX.
  2284
  2285         16  PI-MP-SYSTEM.
  2286             20  PI-MORTGAGE-USER            PIC X.
  2287                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2288                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2289             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2290                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2291                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2292                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2293                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2294                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2295             20  PI-MP-MONTH-END-DT          PIC XX.
  2296             20  PI-MP-REFERENCE-NO.
  2297                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2298                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2299
  2300         16  PI-LABEL-CONTROL            PIC X(01).
  2301             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2302             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2303
  2304         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2305             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2306
  2307         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2308             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2309             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2310
  2311         16  FILLER                      PIC X(14).
  2312
  2313     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2314******************************************************************
  2315     12  PI-REDEF    REDEFINES PI-PROGRAM-WORK-AREA.
  2316         16  PI-PASS-AREA        PIC  S9(4) COMP.
  2317         16  PI-EL142-PRIORITY   PIC  X.
  2318         16  pi-save-map         pic x(8).
  2319         16  pi-max-benefit      pic s9(7)v99 comp-3.
  2320         16  PI-APPROVAL-LEVEL   PIC X.
  2321         16  f                   pic x(197).
  2322*        16  FILLER              PIC  X(211).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  46
* EL150.cbl
  2323         16  PI-CURRENT-FILE     PIC  X(08).
  2324         16  PI-ORIGINAL-ASS-CERT
  2325                                 PIC  X(20).
  2326         16  PI-TOTAL-PAID       PIC S9(07)V99 COMP-3.
  2327         16  PI-DAYS-PAID        PIC S9(05) COMP-3.
  2328         16  PI-LAST-SEQ-NO      PIC S9(03) COMP-3.
  2329         16  PI-LAST-PF-KEY-IND  PIC  X.
  2330             88  PI-PF15-LAST            VALUE 'F'.
  2331             88  PI-PF16-LAST            VALUE 'S'.
  2332         16  PI-ASSOCIATED-PROCESS-IND
  2333                                 PIC  X.
  2334             88  PI-ASS-PROCESSING       VALUE 'Y'.
  2335             88  PI-NOT-ASS-PROCESSING   VALUE SPACES LOW-VALUES.
  2336         16  PI-ASS-NDX          PIC S9(04) COMP.
  2337         16  PI-ASSOCIATED-CERTS-TABLE.
  2338             20  PI-ASS-CERTS OCCURS 24 TIMES
  2339                                 PIC  X(11).
  2340*00545          16  FILLER              PIC  X(10).
  2341         16  FILLER              PIC  X(05).
  2342         16  PI-FORCE-COUNT      PIC  99.
  2343         16  PI-PFKEY-USED       PIC  X.
  2344         16  PI-JOINT-COV-IND    PIC  X.
  2345             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2346             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2347         16  PI-JOINT-INSURED-IND PIC X.
  2348             88  PI-JOINT-INSURED        VALUE 'Y'.
  2349             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2350         16  PI-PRIORITY-CD      PIC  X.
  2351             88  PI-PRIORITY-9           VALUE '9'.
  2352         16  PI-STATUS-IND       PIC  X.
  2353             88  PI-CLOSED               VALUE 'C'.
  2354             88  PI-OPEN                 VALUE 'O'.
  2355         16  PI-LAST-CLOSE-REASON-IND
  2356                                 PIC  X.
  2357             88  PI-BENEFIT-CHANGE       VALUE 'C'.
  2358             88  PI-ERROR-CORRECTION     VALUE 'E'.
  2359         16  PI-PRIORITY-IND     PIC  X.
  2360             88  PI-SUPERVISOR-ONLY      VALUE 'S'.
  2361             88  PI-CONFIDENTIAL-UP      VALUE 'C'.
  2362         16  PI-RETRIEVED-DATA-IND
  2363                                 PIC  X.
  2364             88  PI-RETRIEVED-DATA       VALUE 'Y'.
  2365*        16  PI-SAVE             PIC  X(227).
  2366         16  PI-SAVE-TYPE        PIC  X.
  2367         16  PI-SAVE-FILETO      PIC  X(4).
  2368         16  PI-SAVE-PRTOPT      PIC  X.
  2369         16  PI-SAVE-FORMAT      PIC  X.
  2370         16  PI-SAVE-FORM        PIC  X(12).
  2371         16  PI-PREV-DISP        PIC  X.
  2372         16  PI-PREV-DIR         PIC  X.
  2373         16  PI-SAVE-CURSOR      PIC S9(04) COMP.
  2374         16  PI-SAVE-CNT         PIC S9(04) COMP.
  2375         16  PI-SAVE-LOW         PIC S9(04) COMP.
  2376         16  PI-SAVE-HIGH        PIC S9(04) COMP.
  2377         16  PI-PREV-CLAIM.
  2378             20  PI-PREV-COMP-CD PIC X.
  2379             20  PI-PREV-CARRIER PIC X.
  2380             20  PI-PREV-CLAIM-NO PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  47
* EL150.cbl
  2381             20  PI-PREV-CERT-NO.
  2382                 24  PI-PREV-CERT-NO-PRIME
  2383                                 PIC X(10).
  2384                 24  PI-CERT-NO-SUFX   PIC X.
  2385         16  PI-PREV-PRIME-CERT-NO
  2386                                 PIC X(11).
  2387         16  PI-PURGED-SW        PIC  X.
  2388             88  CLAIM-IS-PURGED         VALUE 'Y'.
  2389         16  PI-PREV-CLMNO       PIC  X(07).
  2390         16  PI-SAVE-MCRFLM      PIC  X(10).
  2391         16  PI-PREV-TRLR-KEY    PIC  X(22).
  2392         16  PI-SAVE-ACT-CD      PIC  XX.
  2393         16  PI-SAVE-ASSOC       PIC  X.
  2394         16  PI-SAVE-SYS-ID      PIC  XX.
  2395*        16  PI-SAVE-CLOAN       PIC  X(25).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  48
* EL150.cbl
  2397*                            COPY ELCJPFX.
  2398******************************************************************
  2399*                                                                *
  2400*                                                                *
  2401*                            ELCJPFX.                            *
  2402*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2403*                            VMOD=2.002                          *
  2404*                                                                *
  2405*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2406*                                                                *
  2407*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2408*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2409*        ELCNTL - CONTROL FILE                                   *
  2410*        ELMSTR - CLAIM MASTERS                                  *
  2411*        ELTRLR - ACTIVITY TRAILERS                              *
  2412*        ELCHKQ - CHECK QUE                                      *
  2413******************************************************************
  2414 01  JOURNAL-RECORD.
  2415     12  jp-date                     pic s9(5) comp-3.
  2416     12  jp-time                     pic s9(7) comp-3.
  2417     12  JP-USER-ID                  PIC X(4).
  2418     12  JP-FILE-ID                  PIC X(8).
  2419     12  JP-PROGRAM-ID               PIC X(8).
  2420     12  JP-RECORD-TYPE              PIC X.
  2421         88 JP-ADD              VALUE 'A'.
  2422         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2423         88 JP-AFTER-CHANGE     VALUE 'C'.
  2424         88 JP-DELETE           VALUE 'D'.
  2425         88 JP-GENERIC-DELETE   VALUE 'G'.
  2426         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2427         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2428     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2429     12  JP-RECORD-AREA
  2430
  2431
  2432                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  49
* EL150.cbl
  2434*                            COPY ELCAID.
  2435******************************************************************
  2436*                                                                *
  2437*                            ELCAID.                             *
  2438*                            VMOD=2.001                          *
  2439*                                                                *
  2440*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2441*                                                                *
  2442*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2443*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2444******************************************************************
  2445
  2446 01  DFHAID.
  2447   02  DFHNULL   PIC  X  VALUE  ' '.
  2448   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2449   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2450   02  DFHPEN    PIC  X  VALUE  '='.
  2451   02  DFHOPID   PIC  X  VALUE  'W'.
  2452   02  DFHPA1    PIC  X  VALUE  '%'.
  2453   02  DFHPA2    PIC  X  VALUE  '>'.
  2454   02  DFHPA3    PIC  X  VALUE  ','.
  2455   02  DFHPF1    PIC  X  VALUE  '1'.
  2456   02  DFHPF2    PIC  X  VALUE  '2'.
  2457   02  DFHPF3    PIC  X  VALUE  '3'.
  2458   02  DFHPF4    PIC  X  VALUE  '4'.
  2459   02  DFHPF5    PIC  X  VALUE  '5'.
  2460   02  DFHPF6    PIC  X  VALUE  '6'.
  2461   02  DFHPF7    PIC  X  VALUE  '7'.
  2462   02  DFHPF8    PIC  X  VALUE  '8'.
  2463   02  DFHPF9    PIC  X  VALUE  '9'.
  2464   02  DFHPF10   PIC  X  VALUE  ':'.
  2465   02  DFHPF11   PIC  X  VALUE  '#'.
  2466   02  DFHPF12   PIC  X  VALUE  '@'.
  2467   02  DFHPF13   PIC  X  VALUE  'A'.
  2468   02  DFHPF14   PIC  X  VALUE  'B'.
  2469   02  DFHPF15   PIC  X  VALUE  'C'.
  2470   02  DFHPF16   PIC  X  VALUE  'D'.
  2471   02  DFHPF17   PIC  X  VALUE  'E'.
  2472   02  DFHPF18   PIC  X  VALUE  'F'.
  2473   02  DFHPF19   PIC  X  VALUE  'G'.
  2474   02  DFHPF20   PIC  X  VALUE  'H'.
  2475   02  DFHPF21   PIC  X  VALUE  'I'.
  2476*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2477   02  DFHPF22   PIC  X  VALUE  '['.
  2478   02  DFHPF23   PIC  X  VALUE  '.'.
  2479   02  DFHPF24   PIC  X  VALUE  '<'.
  2480   02  DFHMSRE   PIC  X  VALUE  'X'.
  2481   02  DFHSTRF   PIC  X  VALUE  'h'.
  2482   02  DFHTRIG   PIC  X  VALUE  '"'.
  2483 01  FILLER    REDEFINES DFHAID.
  2484     12  FILLER              PIC X(8).
  2485     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  50
* EL150.cbl
  2487*                            COPY EL150S.
  2488 01  EL150AI.
  2489     05  FILLER            PIC  X(0012).
  2490*    -------------------------------
  2491     05  RUNDTEL PIC S9(0004) COMP.
  2492     05  RUNDTEF PIC  X(0001).
  2493     05  FILLER REDEFINES RUNDTEF.
  2494         10  RUNDTEA PIC  X(0001).
  2495     05  RUNDTEI PIC  X(0008).
  2496*    -------------------------------
  2497     05  RUNTIMEL PIC S9(0004) COMP.
  2498     05  RUNTIMEF PIC  X(0001).
  2499     05  FILLER REDEFINES RUNTIMEF.
  2500         10  RUNTIMEA PIC  X(0001).
  2501     05  RUNTIMEI PIC  X(0005).
  2502*    -------------------------------
  2503     05  SEQUL PIC S9(0004) COMP.
  2504     05  SEQUF PIC  X(0001).
  2505     05  FILLER REDEFINES SEQUF.
  2506         10  SEQUA PIC  X(0001).
  2507     05  SEQUI PIC  X(0010).
  2508*    -------------------------------
  2509     05  CMPNYIDL PIC S9(0004) COMP.
  2510     05  CMPNYIDF PIC  X(0001).
  2511     05  FILLER REDEFINES CMPNYIDF.
  2512         10  CMPNYIDA PIC  X(0001).
  2513     05  CMPNYIDI PIC  X(0003).
  2514*    -------------------------------
  2515     05  USERIDL PIC S9(0004) COMP.
  2516     05  USERIDF PIC  X(0001).
  2517     05  FILLER REDEFINES USERIDF.
  2518         10  USERIDA PIC  X(0001).
  2519     05  USERIDI PIC  X(0004).
  2520*    -------------------------------
  2521     05  RETMSTL PIC S9(0004) COMP.
  2522     05  RETMSTF PIC  X(0001).
  2523     05  FILLER REDEFINES RETMSTF.
  2524         10  RETMSTA PIC  X(0001).
  2525     05  RETMSTI PIC  X(0015).
  2526*    -------------------------------
  2527     05  CRDCARDL PIC S9(0004) COMP.
  2528     05  CRDCARDF PIC  X(0001).
  2529     05  FILLER REDEFINES CRDCARDF.
  2530         10  CRDCARDA PIC  X(0001).
  2531     05  CRDCARDI PIC  X(0016).
  2532*    -------------------------------
  2533     05  CLMNOL PIC S9(0004) COMP.
  2534     05  CLMNOF PIC  X(0001).
  2535     05  FILLER REDEFINES CLMNOF.
  2536         10  CLMNOA PIC  X(0001).
  2537     05  CLMNOI PIC  X(0007).
  2538*    -------------------------------
  2539     05  CARRL PIC S9(0004) COMP.
  2540     05  CARRF PIC  X(0001).
  2541     05  FILLER REDEFINES CARRF.
  2542         10  CARRA PIC  X(0001).
  2543     05  CARRI PIC  X(0001).
  2544*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  51
* EL150.cbl
  2545     05  CERTNOL PIC S9(0004) COMP.
  2546     05  CERTNOF PIC  X(0001).
  2547     05  FILLER REDEFINES CERTNOF.
  2548         10  CERTNOA PIC  X(0001).
  2549     05  CERTNOI PIC  X(0010).
  2550*    -------------------------------
  2551     05  SUFXL PIC S9(0004) COMP.
  2552     05  SUFXF PIC  X(0001).
  2553     05  FILLER REDEFINES SUFXF.
  2554         10  SUFXA PIC  X(0001).
  2555     05  SUFXI PIC  X(0001).
  2556*    -------------------------------
  2557     05  CLMTYPL PIC S9(0004) COMP.
  2558     05  CLMTYPF PIC  X(0001).
  2559     05  FILLER REDEFINES CLMTYPF.
  2560         10  CLMTYPA PIC  X(0001).
  2561     05  CLMTYPI PIC  X(0006).
  2562*    -------------------------------
  2563     05  CLMSTATL PIC S9(0004) COMP.
  2564     05  CLMSTATF PIC  X(0001).
  2565     05  FILLER REDEFINES CLMSTATF.
  2566         10  CLMSTATA PIC  X(0001).
  2567     05  CLMSTATI PIC  X(0006).
  2568*    -------------------------------
  2569     05  LSTNMEL PIC S9(0004) COMP.
  2570     05  LSTNMEF PIC  X(0001).
  2571     05  FILLER REDEFINES LSTNMEF.
  2572         10  LSTNMEA PIC  X(0001).
  2573     05  LSTNMEI PIC  X(0015).
  2574*    -------------------------------
  2575     05  FSTNMEL PIC S9(0004) COMP.
  2576     05  FSTNMEF PIC  X(0001).
  2577     05  FILLER REDEFINES FSTNMEF.
  2578         10  FSTNMEA PIC  X(0001).
  2579     05  FSTNMEI PIC  X(0012).
  2580*    -------------------------------
  2581     05  MINITL PIC S9(0004) COMP.
  2582     05  MINITF PIC  X(0001).
  2583     05  FILLER REDEFINES MINITF.
  2584         10  MINITA PIC  X(0001).
  2585     05  MINITI PIC  X(0001).
  2586*    -------------------------------
  2587     05  PRIMHDGL PIC S9(0004) COMP.
  2588     05  PRIMHDGF PIC  X(0001).
  2589     05  FILLER REDEFINES PRIMHDGF.
  2590         10  PRIMHDGA PIC  X(0001).
  2591     05  PRIMHDGI PIC  X(0012).
  2592*    -------------------------------
  2593     05  PRIMCRTL PIC S9(0004) COMP.
  2594     05  PRIMCRTF PIC  X(0001).
  2595     05  FILLER REDEFINES PRIMCRTF.
  2596         10  PRIMCRTA PIC  X(0001).
  2597     05  PRIMCRTI PIC  X(0010).
  2598*    -------------------------------
  2599     05  PRIMSFXL PIC S9(0004) COMP.
  2600     05  PRIMSFXF PIC  X(0001).
  2601     05  FILLER REDEFINES PRIMSFXF.
  2602         10  PRIMSFXA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  52
* EL150.cbl
  2603     05  PRIMSFXI PIC  X(0001).
  2604*    -------------------------------
  2605     05  NOTIFYL PIC S9(0004) COMP.
  2606     05  NOTIFYF PIC  X(0001).
  2607     05  FILLER REDEFINES NOTIFYF.
  2608         10  NOTIFYA PIC  X(0001).
  2609     05  NOTIFYI PIC  X(0013).
  2610*    -------------------------------
  2611     05  CLMTOTHL PIC S9(0004) COMP.
  2612     05  CLMTOTHF PIC  X(0001).
  2613     05  FILLER REDEFINES CLMTOTHF.
  2614         10  CLMTOTHA PIC  X(0001).
  2615     05  CLMTOTHI PIC  X(0027).
  2616*    -------------------------------
  2617     05  AMTPDL PIC S9(0004) COMP.
  2618     05  AMTPDF PIC  X(0001).
  2619     05  FILLER REDEFINES AMTPDF.
  2620         10  AMTPDA PIC  X(0001).
  2621     05  AMTPDI PIC  X(0011).
  2622*    -------------------------------
  2623     05  DAYSPDHL PIC S9(0004) COMP.
  2624     05  DAYSPDHF PIC  X(0001).
  2625     05  FILLER REDEFINES DAYSPDHF.
  2626         10  DAYSPDHA PIC  X(0001).
  2627     05  DAYSPDHI PIC  X(0010).
  2628*    -------------------------------
  2629     05  DAYSPDL PIC S9(0004) COMP.
  2630     05  DAYSPDF PIC  X(0001).
  2631     05  FILLER REDEFINES DAYSPDF.
  2632         10  DAYSPDA PIC  X(0001).
  2633     05  DAYSPDI PIC  X(0005).
  2634*    -------------------------------
  2635     05  YESNOSWL PIC S9(0004) COMP.
  2636     05  YESNOSWF PIC  X(0001).
  2637     05  FILLER REDEFINES YESNOSWF.
  2638         10  YESNOSWA PIC  X(0001).
  2639     05  YESNOSWI PIC  X(0001).
  2640*    -------------------------------
  2641     05  PDTHRHDL PIC S9(0004) COMP.
  2642     05  PDTHRHDF PIC  X(0001).
  2643     05  FILLER REDEFINES PDTHRHDF.
  2644         10  PDTHRHDA PIC  X(0001).
  2645     05  PDTHRHDI PIC  X(0014).
  2646*    -------------------------------
  2647     05  PDTHRUL PIC S9(0004) COMP.
  2648     05  PDTHRUF PIC  X(0001).
  2649     05  FILLER REDEFINES PDTHRUF.
  2650         10  PDTHRUA PIC  X(0001).
  2651     05  PDTHRUI PIC  X(0008).
  2652*    -------------------------------
  2653     05  TOTPAIDL PIC S9(0004) COMP.
  2654     05  TOTPAIDF PIC  X(0001).
  2655     05  FILLER REDEFINES TOTPAIDF.
  2656         10  TOTPAIDA PIC  X(0001).
  2657     05  TOTPAIDI PIC  X(0010).
  2658*    -------------------------------
  2659     05  COVERDL PIC S9(0004) COMP.
  2660     05  COVERDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  53
* EL150.cbl
  2661     05  FILLER REDEFINES COVERDF.
  2662         10  COVERDA PIC  X(0001).
  2663     05  COVERDI PIC  X(0012).
  2664*    -------------------------------
  2665     05  COVERL PIC S9(0004) COMP.
  2666     05  COVERF PIC  X(0001).
  2667     05  FILLER REDEFINES COVERF.
  2668         10  COVERA PIC  X(0001).
  2669     05  COVERI PIC  X(0010).
  2670*    -------------------------------
  2671     05  INCURL PIC S9(0004) COMP.
  2672     05  INCURF PIC  X(0001).
  2673     05  FILLER REDEFINES INCURF.
  2674         10  INCURA PIC  X(0001).
  2675     05  INCURI PIC  X(0008).
  2676*    -------------------------------
  2677     05  NOPMTSL PIC S9(0004) COMP.
  2678     05  NOPMTSF PIC  X(0001).
  2679     05  FILLER REDEFINES NOPMTSF.
  2680         10  NOPMTSA PIC  X(0001).
  2681     05  NOPMTSI PIC  X(0007).
  2682*    -------------------------------
  2683     05  PRMTYPDL PIC S9(0004) COMP.
  2684     05  PRMTYPDF PIC  X(0001).
  2685     05  FILLER REDEFINES PRMTYPDF.
  2686         10  PRMTYPDA PIC  X(0001).
  2687     05  PRMTYPDI PIC  X(0012).
  2688*    -------------------------------
  2689     05  PRMTYPEL PIC S9(0004) COMP.
  2690     05  PRMTYPEF PIC  X(0001).
  2691     05  FILLER REDEFINES PRMTYPEF.
  2692         10  PRMTYPEA PIC  X(0001).
  2693     05  PRMTYPEI PIC  X(0008).
  2694*    -------------------------------
  2695     05  NXTAUTOL PIC S9(0004) COMP.
  2696     05  NXTAUTOF PIC  X(0001).
  2697     05  FILLER REDEFINES NXTAUTOF.
  2698         10  NXTAUTOA PIC  X(0001).
  2699     05  NXTAUTOI PIC  X(0008).
  2700*    -------------------------------
  2701     05  ESTABDTL PIC S9(0004) COMP.
  2702     05  ESTABDTF PIC  X(0001).
  2703     05  FILLER REDEFINES ESTABDTF.
  2704         10  ESTABDTA PIC  X(0001).
  2705     05  ESTABDTI PIC  X(0008).
  2706*    -------------------------------
  2707     05  CRTSTADL PIC S9(0004) COMP.
  2708     05  CRTSTADF PIC  X(0001).
  2709     05  FILLER REDEFINES CRTSTADF.
  2710         10  CRTSTADA PIC  X(0001).
  2711     05  CRTSTADI PIC  X(0012).
  2712*    -------------------------------
  2713     05  CRTSTATL PIC S9(0004) COMP.
  2714     05  CRTSTATF PIC  X(0001).
  2715     05  FILLER REDEFINES CRTSTATF.
  2716         10  CRTSTATA PIC  X(0001).
  2717     05  CRTSTATI PIC  X(0010).
  2718*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  54
* EL150.cbl
  2719     05  EFFECTL PIC S9(0004) COMP.
  2720     05  EFFECTF PIC  X(0001).
  2721     05  FILLER REDEFINES EFFECTF.
  2722         10  EFFECTA PIC  X(0001).
  2723     05  EFFECTI PIC  X(0008).
  2724*    -------------------------------
  2725     05  TOTINTL PIC S9(0004) COMP.
  2726     05  TOTINTF PIC  X(0001).
  2727     05  FILLER REDEFINES TOTINTF.
  2728         10  TOTINTA PIC  X(0001).
  2729     05  TOTINTI PIC  S9(7)V99.
  2730*    -------------------------------
  2731     05  STATEL PIC S9(0004) COMP.
  2732     05  STATEF PIC  X(0001).
  2733     05  FILLER REDEFINES STATEF.
  2734         10  STATEA PIC  X(0001).
  2735     05  STATEI PIC  X(0003).
  2736*    -------------------------------
  2737     05  ACCTL PIC S9(0004) COMP.
  2738     05  ACCTF PIC  X(0001).
  2739     05  FILLER REDEFINES ACCTF.
  2740         10  ACCTA PIC  X(0001).
  2741     05  ACCTI PIC  X(0010).
  2742*    -------------------------------
  2743     05  EXPIREL PIC S9(0004) COMP.
  2744     05  EXPIREF PIC  X(0001).
  2745     05  FILLER REDEFINES EXPIREF.
  2746         10  EXPIREA PIC  X(0001).
  2747     05  EXPIREI PIC  X(0008).
  2748*    -------------------------------
  2749     05  BENECAPL PIC S9(0004) COMP.
  2750     05  BENECAPF PIC  X(0001).
  2751     05  FILLER REDEFINES BENECAPF.
  2752         10  BENECAPA PIC  X(0001).
  2753     05  BENECAPI PIC  X(0013).
  2754*    -------------------------------
  2755     05  BENEL PIC S9(0004) COMP.
  2756     05  BENEF PIC  X(0001).
  2757     05  FILLER REDEFINES BENEF.
  2758         10  BENEA PIC  X(0001).
  2759     05  BENEI PIC  X(0009).
  2760*    -------------------------------
  2761     05  TERMSL PIC S9(0004) COMP.
  2762     05  TERMSF PIC  X(0001).
  2763     05  FILLER REDEFINES TERMSF.
  2764         10  TERMSA PIC  X(0001).
  2765     05  TERMSI PIC  X(0013).
  2766*    -------------------------------
  2767     05  DIAGL PIC S9(0004) COMP.
  2768     05  DIAGF PIC  X(0001).
  2769     05  FILLER REDEFINES DIAGF.
  2770         10  DIAGA PIC  X(0001).
  2771     05  DIAGI PIC  X(0056).
  2772*    -------------------------------
  2773     05  FILETOL PIC S9(0004) COMP.
  2774     05  FILETOF PIC  X(0001).
  2775     05  FILLER REDEFINES FILETOF.
  2776         10  FILETOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  55
* EL150.cbl
  2777     05  FILETOI PIC  X(0004).
  2778*    -------------------------------
  2779     05  PRTOPTL PIC S9(0004) COMP.
  2780     05  PRTOPTF PIC  X(0001).
  2781     05  FILLER REDEFINES PRTOPTF.
  2782         10  PRTOPTA PIC  X(0001).
  2783     05  PRTOPTI PIC  X(0001).
  2784*    -------------------------------
  2785     05  FORMATL PIC S9(0004) COMP.
  2786     05  FORMATF PIC  X(0001).
  2787     05  FILLER REDEFINES FORMATF.
  2788         10  FORMATA PIC  X(0001).
  2789     05  FORMATI PIC  X(0001).
  2790*    -------------------------------
  2791     05  ALTPRTL PIC S9(0004) COMP.
  2792     05  ALTPRTF PIC  X(0001).
  2793     05  FILLER REDEFINES ALTPRTF.
  2794         10  ALTPRTA PIC  X(0001).
  2795     05  ALTPRTI PIC  X(0004).
  2796*    -------------------------------
  2797     05  CLOANL PIC S9(0004) COMP.
  2798     05  CLOANF PIC  X(0001).
  2799     05  FILLER REDEFINES CLOANF.
  2800         10  CLOANA PIC  X(0001).
  2801     05  CLOANI PIC  X(0025).
  2802*    -------------------------------
  2803     05  DENTYPL PIC S9(0004) COMP.
  2804     05  DENTYPF PIC  X(0001).
  2805     05  FILLER REDEFINES DENTYPF.
  2806         10  DENTYPA PIC  X(0001).
  2807     05  DENTYPI PIC  X(0029).
  2808*    -------------------------------
  2809     05  ACTCDL PIC S9(0004) COMP.
  2810     05  ACTCDF PIC  X(0001).
  2811     05  FILLER REDEFINES ACTCDF.
  2812         10  ACTCDA PIC  X(0001).
  2813     05  ACTCDI PIC  99.
  2814*    -------------------------------
  2815     05  ACTDTL PIC S9(0004) COMP.
  2816     05  ACTDTF PIC  X(0001).
  2817     05  FILLER REDEFINES ACTDTF.
  2818         10  ACTDTA PIC  X(0001).
  2819     05  ACTDTI PIC  X(0008).
  2820*    -------------------------------
  2821     05  ACTTYPL PIC S9(0004) COMP.
  2822     05  ACTTYPF PIC  X(0001).
  2823     05  FILLER REDEFINES ACTTYPF.
  2824         10  ACTTYPA PIC  X(0001).
  2825     05  ACTTYPI PIC  X(0004).
  2826*    -------------------------------
  2827     05  ASSHDGL PIC S9(0004) COMP.
  2828     05  ASSHDGF PIC  X(0001).
  2829     05  FILLER REDEFINES ASSHDGF.
  2830         10  ASSHDGA PIC  X(0001).
  2831     05  ASSHDGI PIC  X(0006).
  2832*    -------------------------------
  2833     05  ASSOCL PIC S9(0004) COMP.
  2834     05  ASSOCF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  56
* EL150.cbl
  2835     05  FILLER REDEFINES ASSOCF.
  2836         10  ASSOCA PIC  X(0001).
  2837     05  ASSOCI PIC  X(0001).
  2838*    -------------------------------
  2839     05  TRLR1L PIC S9(0004) COMP.
  2840     05  TRLR1F PIC  X(0001).
  2841     05  FILLER REDEFINES TRLR1F.
  2842         10  TRLR1A PIC  X(0001).
  2843     05  TRLR1I PIC  X(0079).
  2844*    -------------------------------
  2845     05  TRLR2L PIC S9(0004) COMP.
  2846     05  TRLR2F PIC  X(0001).
  2847     05  FILLER REDEFINES TRLR2F.
  2848         10  TRLR2A PIC  X(0001).
  2849     05  TRLR2I PIC  X(0079).
  2850*    -------------------------------
  2851     05  TRLR3L PIC S9(0004) COMP.
  2852     05  TRLR3F PIC  X(0001).
  2853     05  FILLER REDEFINES TRLR3F.
  2854         10  TRLR3A PIC  X(0001).
  2855     05  TRLR3I PIC  X(0079).
  2856*    -------------------------------
  2857     05  TRLR4L PIC S9(0004) COMP.
  2858     05  TRLR4F PIC  X(0001).
  2859     05  FILLER REDEFINES TRLR4F.
  2860         10  TRLR4A PIC  X(0001).
  2861     05  TRLR4I PIC  X(0079).
  2862*    -------------------------------
  2863     05  ERRMSG1L PIC S9(0004) COMP.
  2864     05  ERRMSG1F PIC  X(0001).
  2865     05  FILLER REDEFINES ERRMSG1F.
  2866         10  ERRMSG1A PIC  X(0001).
  2867     05  ERRMSG1I PIC  X(0079).
  2868*    -------------------------------
  2869     05  ENTERPFL PIC S9(0004) COMP.
  2870     05  ENTERPFF PIC  X(0001).
  2871     05  FILLER REDEFINES ENTERPFF.
  2872         10  ENTERPFA PIC  X(0001).
  2873     05  ENTERPFI PIC  99.
  2874*    -------------------------------
  2875     05  PFKEY11L PIC S9(0004) COMP.
  2876     05  PFKEY11F PIC  X(0001).
  2877     05  FILLER REDEFINES PFKEY11F.
  2878         10  PFKEY11A PIC  X(0001).
  2879     05  PFKEY11I PIC  X(0017).
  2880 01  EL150AO REDEFINES EL150AI.
  2881     05  FILLER            PIC  X(0012).
  2882*    -------------------------------
  2883     05  FILLER            PIC  X(0003).
  2884     05  RUNDTEO PIC  X(0008).
  2885*    -------------------------------
  2886     05  FILLER            PIC  X(0003).
  2887     05  RUNTIMEO PIC  99.99.
  2888*    -------------------------------
  2889     05  FILLER            PIC  X(0003).
  2890     05  SEQUO PIC  X(0010).
  2891*    -------------------------------
  2892     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  57
* EL150.cbl
  2893     05  CMPNYIDO PIC  X(0003).
  2894*    -------------------------------
  2895     05  FILLER            PIC  X(0003).
  2896     05  USERIDO PIC  X(0004).
  2897*    -------------------------------
  2898     05  FILLER            PIC  X(0003).
  2899     05  RETMSTO PIC  X(0015).
  2900*    -------------------------------
  2901     05  FILLER            PIC  X(0003).
  2902     05  CRDCARDO PIC  X(0016).
  2903*    -------------------------------
  2904     05  FILLER            PIC  X(0003).
  2905     05  CLMNOO PIC  X(0007).
  2906*    -------------------------------
  2907     05  FILLER            PIC  X(0003).
  2908     05  CARRO PIC  X(0001).
  2909*    -------------------------------
  2910     05  FILLER            PIC  X(0003).
  2911     05  CERTNOO PIC  X(0010).
  2912*    -------------------------------
  2913     05  FILLER            PIC  X(0003).
  2914     05  SUFXO PIC  X(0001).
  2915*    -------------------------------
  2916     05  FILLER            PIC  X(0003).
  2917     05  CLMTYPO PIC  X(0006).
  2918*    -------------------------------
  2919     05  FILLER            PIC  X(0003).
  2920     05  CLMSTATO PIC  X(0006).
  2921*    -------------------------------
  2922     05  FILLER            PIC  X(0003).
  2923     05  LSTNMEO PIC  X(0015).
  2924*    -------------------------------
  2925     05  FILLER            PIC  X(0003).
  2926     05  FSTNMEO PIC  X(0012).
  2927*    -------------------------------
  2928     05  FILLER            PIC  X(0003).
  2929     05  MINITO PIC  X(0001).
  2930*    -------------------------------
  2931     05  FILLER            PIC  X(0003).
  2932     05  PRIMHDGO PIC  X(0012).
  2933*    -------------------------------
  2934     05  FILLER            PIC  X(0003).
  2935     05  PRIMCRTO PIC  X(0010).
  2936*    -------------------------------
  2937     05  FILLER            PIC  X(0003).
  2938     05  PRIMSFXO PIC  X(0001).
  2939*    -------------------------------
  2940     05  FILLER            PIC  X(0003).
  2941     05  NOTIFYO PIC  X(0013).
  2942*    -------------------------------
  2943     05  FILLER            PIC  X(0003).
  2944     05  CLMTOTHO PIC  X(0027).
  2945*    -------------------------------
  2946     05  FILLER            PIC  X(0003).
  2947     05  AMTPDO PIC  X(0011).
  2948*    -------------------------------
  2949     05  FILLER            PIC  X(0003).
  2950     05  DAYSPDHO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  58
* EL150.cbl
  2951*    -------------------------------
  2952     05  FILLER            PIC  X(0003).
  2953     05  DAYSPDO PIC  X(0005).
  2954*    -------------------------------
  2955     05  FILLER            PIC  X(0003).
  2956     05  YESNOSWO PIC  X(0001).
  2957*    -------------------------------
  2958     05  FILLER            PIC  X(0003).
  2959     05  PDTHRHDO PIC  X(0014).
  2960*    -------------------------------
  2961     05  FILLER            PIC  X(0003).
  2962     05  PDTHRUO PIC  X(0008).
  2963*    -------------------------------
  2964     05  FILLER            PIC  X(0003).
  2965     05  TOTPAIDO PIC  Z(6).99-.
  2966*    -------------------------------
  2967     05  FILLER            PIC  X(0003).
  2968     05  COVERDO PIC  X(0012).
  2969*    -------------------------------
  2970     05  FILLER            PIC  X(0003).
  2971     05  COVERO PIC  X(0010).
  2972*    -------------------------------
  2973     05  FILLER            PIC  X(0003).
  2974     05  INCURO PIC  X(0008).
  2975*    -------------------------------
  2976     05  FILLER            PIC  X(0003).
  2977     05  NOPMTSO PIC  X(0007).
  2978*    -------------------------------
  2979     05  FILLER            PIC  X(0003).
  2980     05  PRMTYPDO PIC  X(0012).
  2981*    -------------------------------
  2982     05  FILLER            PIC  X(0003).
  2983     05  PRMTYPEO PIC  X(0008).
  2984*    -------------------------------
  2985     05  FILLER            PIC  X(0003).
  2986     05  NXTAUTOO PIC  X(0008).
  2987*    -------------------------------
  2988     05  FILLER            PIC  X(0003).
  2989     05  ESTABDTO PIC  X(0008).
  2990*    -------------------------------
  2991     05  FILLER            PIC  X(0003).
  2992     05  CRTSTADO PIC  X(0012).
  2993*    -------------------------------
  2994     05  FILLER            PIC  X(0003).
  2995     05  CRTSTATO PIC  X(0010).
  2996*    -------------------------------
  2997     05  FILLER            PIC  X(0003).
  2998     05  EFFECTO PIC  X(0008).
  2999*    -------------------------------
  3000     05  FILLER            PIC  X(0003).
  3001     05  TOTINTO PIC  -(6).99.
  3002*    -------------------------------
  3003     05  FILLER            PIC  X(0003).
  3004     05  STATEO PIC  X(0003).
  3005*    -------------------------------
  3006     05  FILLER            PIC  X(0003).
  3007     05  ACCTO PIC  X(0010).
  3008*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  59
* EL150.cbl
  3009     05  FILLER            PIC  X(0003).
  3010     05  EXPIREO PIC  X(0008).
  3011*    -------------------------------
  3012     05  FILLER            PIC  X(0003).
  3013     05  BENECAPO PIC  X(0013).
  3014*    -------------------------------
  3015     05  FILLER            PIC  X(0003).
  3016     05  BENEO PIC  Z(6).99.
  3017*    -------------------------------
  3018     05  FILLER            PIC  X(0003).
  3019     05  TERMSO PIC  X(0013).
  3020*    -------------------------------
  3021     05  FILLER            PIC  X(0003).
  3022     05  DIAGO PIC  X(0056).
  3023*    -------------------------------
  3024     05  FILLER            PIC  X(0003).
  3025     05  FILETOO PIC  X(0004).
  3026*    -------------------------------
  3027     05  FILLER            PIC  X(0003).
  3028     05  PRTOPTO PIC  X(0001).
  3029*    -------------------------------
  3030     05  FILLER            PIC  X(0003).
  3031     05  FORMATO PIC  X(0001).
  3032*    -------------------------------
  3033     05  FILLER            PIC  X(0003).
  3034     05  ALTPRTO PIC  X(0004).
  3035*    -------------------------------
  3036     05  FILLER            PIC  X(0003).
  3037     05  CLOANO PIC  X(0025).
  3038*    -------------------------------
  3039     05  FILLER            PIC  X(0003).
  3040     05  DENTYPO PIC  X(0029).
  3041*    -------------------------------
  3042     05  FILLER            PIC  X(0003).
  3043     05  ACTCDO PIC  X(0002).
  3044*    -------------------------------
  3045     05  FILLER            PIC  X(0003).
  3046     05  ACTDTO PIC  X(0008).
  3047*    -------------------------------
  3048     05  FILLER            PIC  X(0003).
  3049     05  ACTTYPO PIC  X(0004).
  3050*    -------------------------------
  3051     05  FILLER            PIC  X(0003).
  3052     05  ASSHDGO PIC  X(0006).
  3053*    -------------------------------
  3054     05  FILLER            PIC  X(0003).
  3055     05  ASSOCO PIC  X(0001).
  3056*    -------------------------------
  3057     05  FILLER            PIC  X(0003).
  3058     05  TRLR1O PIC  X(0079).
  3059*    -------------------------------
  3060     05  FILLER            PIC  X(0003).
  3061     05  TRLR2O PIC  X(0079).
  3062*    -------------------------------
  3063     05  FILLER            PIC  X(0003).
  3064     05  TRLR3O PIC  X(0079).
  3065*    -------------------------------
  3066     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  60
* EL150.cbl
  3067     05  TRLR4O PIC  X(0079).
  3068*    -------------------------------
  3069     05  FILLER            PIC  X(0003).
  3070     05  ERRMSG1O PIC  X(0079).
  3071*    -------------------------------
  3072     05  FILLER            PIC  X(0003).
  3073     05  ENTERPFO PIC  X(0002).
  3074*    -------------------------------
  3075     05  FILLER            PIC  X(0003).
  3076     05  PFKEY11O PIC  X(0017).
  3077*    -------------------------------
  3078 01  EL150TI REDEFINES EL150AI.
  3079     05  FILLER            PIC  X(0012).
  3080*    -------------------------------
  3081     05  RUNDTL PIC S9(0004) COMP.
  3082     05  RUNDTF PIC  X(0001).
  3083     05  FILLER REDEFINES RUNDTF.
  3084         10  RUNDTA PIC  X(0001).
  3085     05  RUNDTI PIC  X(0008).
  3086*    -------------------------------
  3087     05  RUNTIML PIC S9(0004) COMP.
  3088     05  RUNTIMF PIC  X(0001).
  3089     05  FILLER REDEFINES RUNTIMF.
  3090         10  RUNTIMA PIC  X(0001).
  3091     05  RUNTIMI PIC  X(0005).
  3092*    -------------------------------
  3093     05  CLMTYP1L PIC S9(0004) COMP.
  3094     05  CLMTYP1F PIC  X(0001).
  3095     05  FILLER REDEFINES CLMTYP1F.
  3096         10  CLMTYP1A PIC  X(0001).
  3097     05  CLMTYP1I PIC  X(0002).
  3098*    -------------------------------
  3099     05  BANK1L PIC S9(0004) COMP.
  3100     05  BANK1F PIC  X(0001).
  3101     05  FILLER REDEFINES BANK1F.
  3102         10  BANK1A PIC  X(0001).
  3103     05  BANK1I PIC  X(0003).
  3104*    -------------------------------
  3105     05  NOCLMS1L PIC S9(0004) COMP.
  3106     05  NOCLMS1F PIC  X(0001).
  3107     05  FILLER REDEFINES NOCLMS1F.
  3108         10  NOCLMS1A PIC  X(0001).
  3109     05  NOCLMS1I PIC  X(0003).
  3110*    -------------------------------
  3111     05  NODAYS1L PIC S9(0004) COMP.
  3112     05  NODAYS1F PIC  X(0001).
  3113     05  FILLER REDEFINES NODAYS1F.
  3114         10  NODAYS1A PIC  X(0001).
  3115     05  NODAYS1I PIC  X(0005).
  3116*    -------------------------------
  3117     05  TAMT1L PIC S9(0004) COMP.
  3118     05  TAMT1F PIC  X(0001).
  3119     05  FILLER REDEFINES TAMT1F.
  3120         10  TAMT1A PIC  X(0001).
  3121     05  TAMT1I PIC  X(0012).
  3122*    -------------------------------
  3123     05  CLMTYP2L PIC S9(0004) COMP.
  3124     05  CLMTYP2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  61
* EL150.cbl
  3125     05  FILLER REDEFINES CLMTYP2F.
  3126         10  CLMTYP2A PIC  X(0001).
  3127     05  CLMTYP2I PIC  X(0002).
  3128*    -------------------------------
  3129     05  BANK2L PIC S9(0004) COMP.
  3130     05  BANK2F PIC  X(0001).
  3131     05  FILLER REDEFINES BANK2F.
  3132         10  BANK2A PIC  X(0001).
  3133     05  BANK2I PIC  X(0003).
  3134*    -------------------------------
  3135     05  NOCLMS2L PIC S9(0004) COMP.
  3136     05  NOCLMS2F PIC  X(0001).
  3137     05  FILLER REDEFINES NOCLMS2F.
  3138         10  NOCLMS2A PIC  X(0001).
  3139     05  NOCLMS2I PIC  X(0003).
  3140*    -------------------------------
  3141     05  NODAYS2L PIC S9(0004) COMP.
  3142     05  NODAYS2F PIC  X(0001).
  3143     05  FILLER REDEFINES NODAYS2F.
  3144         10  NODAYS2A PIC  X(0001).
  3145     05  NODAYS2I PIC  X(0005).
  3146*    -------------------------------
  3147     05  TAMT2L PIC S9(0004) COMP.
  3148     05  TAMT2F PIC  X(0001).
  3149     05  FILLER REDEFINES TAMT2F.
  3150         10  TAMT2A PIC  X(0001).
  3151     05  TAMT2I PIC  X(0012).
  3152*    -------------------------------
  3153     05  CLMTYP3L PIC S9(0004) COMP.
  3154     05  CLMTYP3F PIC  X(0001).
  3155     05  FILLER REDEFINES CLMTYP3F.
  3156         10  CLMTYP3A PIC  X(0001).
  3157     05  CLMTYP3I PIC  X(0002).
  3158*    -------------------------------
  3159     05  BANK3L PIC S9(0004) COMP.
  3160     05  BANK3F PIC  X(0001).
  3161     05  FILLER REDEFINES BANK3F.
  3162         10  BANK3A PIC  X(0001).
  3163     05  BANK3I PIC  X(0003).
  3164*    -------------------------------
  3165     05  NOCLMS3L PIC S9(0004) COMP.
  3166     05  NOCLMS3F PIC  X(0001).
  3167     05  FILLER REDEFINES NOCLMS3F.
  3168         10  NOCLMS3A PIC  X(0001).
  3169     05  NOCLMS3I PIC  X(0003).
  3170*    -------------------------------
  3171     05  NODAYS3L PIC S9(0004) COMP.
  3172     05  NODAYS3F PIC  X(0001).
  3173     05  FILLER REDEFINES NODAYS3F.
  3174         10  NODAYS3A PIC  X(0001).
  3175     05  NODAYS3I PIC  X(0005).
  3176*    -------------------------------
  3177     05  TAMT3L PIC S9(0004) COMP.
  3178     05  TAMT3F PIC  X(0001).
  3179     05  FILLER REDEFINES TAMT3F.
  3180         10  TAMT3A PIC  X(0001).
  3181     05  TAMT3I PIC  X(0012).
  3182*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  62
* EL150.cbl
  3183     05  CLMTYP4L PIC S9(0004) COMP.
  3184     05  CLMTYP4F PIC  X(0001).
  3185     05  FILLER REDEFINES CLMTYP4F.
  3186         10  CLMTYP4A PIC  X(0001).
  3187     05  CLMTYP4I PIC  X(0002).
  3188*    -------------------------------
  3189     05  BANK4L PIC S9(0004) COMP.
  3190     05  BANK4F PIC  X(0001).
  3191     05  FILLER REDEFINES BANK4F.
  3192         10  BANK4A PIC  X(0001).
  3193     05  BANK4I PIC  X(0003).
  3194*    -------------------------------
  3195     05  NOCLMS4L PIC S9(0004) COMP.
  3196     05  NOCLMS4F PIC  X(0001).
  3197     05  FILLER REDEFINES NOCLMS4F.
  3198         10  NOCLMS4A PIC  X(0001).
  3199     05  NOCLMS4I PIC  X(0003).
  3200*    -------------------------------
  3201     05  NODAYS4L PIC S9(0004) COMP.
  3202     05  NODAYS4F PIC  X(0001).
  3203     05  FILLER REDEFINES NODAYS4F.
  3204         10  NODAYS4A PIC  X(0001).
  3205     05  NODAYS4I PIC  X(0005).
  3206*    -------------------------------
  3207     05  TAMT4L PIC S9(0004) COMP.
  3208     05  TAMT4F PIC  X(0001).
  3209     05  FILLER REDEFINES TAMT4F.
  3210         10  TAMT4A PIC  X(0001).
  3211     05  TAMT4I PIC  X(0012).
  3212*    -------------------------------
  3213     05  CLMTYP5L PIC S9(0004) COMP.
  3214     05  CLMTYP5F PIC  X(0001).
  3215     05  FILLER REDEFINES CLMTYP5F.
  3216         10  CLMTYP5A PIC  X(0001).
  3217     05  CLMTYP5I PIC  X(0002).
  3218*    -------------------------------
  3219     05  BANK5L PIC S9(0004) COMP.
  3220     05  BANK5F PIC  X(0001).
  3221     05  FILLER REDEFINES BANK5F.
  3222         10  BANK5A PIC  X(0001).
  3223     05  BANK5I PIC  X(0003).
  3224*    -------------------------------
  3225     05  NOCLMS5L PIC S9(0004) COMP.
  3226     05  NOCLMS5F PIC  X(0001).
  3227     05  FILLER REDEFINES NOCLMS5F.
  3228         10  NOCLMS5A PIC  X(0001).
  3229     05  NOCLMS5I PIC  X(0003).
  3230*    -------------------------------
  3231     05  NODAYS5L PIC S9(0004) COMP.
  3232     05  NODAYS5F PIC  X(0001).
  3233     05  FILLER REDEFINES NODAYS5F.
  3234         10  NODAYS5A PIC  X(0001).
  3235     05  NODAYS5I PIC  X(0005).
  3236*    -------------------------------
  3237     05  TAMT5L PIC S9(0004) COMP.
  3238     05  TAMT5F PIC  X(0001).
  3239     05  FILLER REDEFINES TAMT5F.
  3240         10  TAMT5A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  63
* EL150.cbl
  3241     05  TAMT5I PIC  X(0012).
  3242 01  EL150TO REDEFINES EL150AI.
  3243     05  FILLER            PIC  X(0012).
  3244*    -------------------------------
  3245     05  FILLER            PIC  X(0003).
  3246     05  RUNDTO PIC  X(0008).
  3247*    -------------------------------
  3248     05  FILLER            PIC  X(0003).
  3249     05  RUNTIMO PIC  99.99.
  3250*    -------------------------------
  3251     05  FILLER            PIC  X(0003).
  3252     05  CLMTYP1O PIC  X(0002).
  3253*    -------------------------------
  3254     05  FILLER            PIC  X(0003).
  3255     05  BANK1O PIC  999.
  3256*    -------------------------------
  3257     05  FILLER            PIC  X(0003).
  3258     05  NOCLMS1O PIC  999.
  3259*    -------------------------------
  3260     05  FILLER            PIC  X(0003).
  3261     05  NODAYS1O PIC  99999.
  3262*    -------------------------------
  3263     05  FILLER            PIC  X(0003).
  3264     05  TAMT1O PIC  9,999,999.99.
  3265*    -------------------------------
  3266     05  FILLER            PIC  X(0003).
  3267     05  CLMTYP2O PIC  X(0002).
  3268*    -------------------------------
  3269     05  FILLER            PIC  X(0003).
  3270     05  BANK2O PIC  999.
  3271*    -------------------------------
  3272     05  FILLER            PIC  X(0003).
  3273     05  NOCLMS2O PIC  999.
  3274*    -------------------------------
  3275     05  FILLER            PIC  X(0003).
  3276     05  NODAYS2O PIC  99999.
  3277*    -------------------------------
  3278     05  FILLER            PIC  X(0003).
  3279     05  TAMT2O PIC  9,999,999.99.
  3280*    -------------------------------
  3281     05  FILLER            PIC  X(0003).
  3282     05  CLMTYP3O PIC  X(0002).
  3283*    -------------------------------
  3284     05  FILLER            PIC  X(0003).
  3285     05  BANK3O PIC  999.
  3286*    -------------------------------
  3287     05  FILLER            PIC  X(0003).
  3288     05  NOCLMS3O PIC  999.
  3289*    -------------------------------
  3290     05  FILLER            PIC  X(0003).
  3291     05  NODAYS3O PIC  99999.
  3292*    -------------------------------
  3293     05  FILLER            PIC  X(0003).
  3294     05  TAMT3O PIC  9,999,999.99.
  3295*    -------------------------------
  3296     05  FILLER            PIC  X(0003).
  3297     05  CLMTYP4O PIC  X(0002).
  3298*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  64
* EL150.cbl
  3299     05  FILLER            PIC  X(0003).
  3300     05  BANK4O PIC  999.
  3301*    -------------------------------
  3302     05  FILLER            PIC  X(0003).
  3303     05  NOCLMS4O PIC  999.
  3304*    -------------------------------
  3305     05  FILLER            PIC  X(0003).
  3306     05  NODAYS4O PIC  99999.
  3307*    -------------------------------
  3308     05  FILLER            PIC  X(0003).
  3309     05  TAMT4O PIC  9,999,999.99.
  3310*    -------------------------------
  3311     05  FILLER            PIC  X(0003).
  3312     05  CLMTYP5O PIC  X(0002).
  3313*    -------------------------------
  3314     05  FILLER            PIC  X(0003).
  3315     05  BANK5O PIC  999.
  3316*    -------------------------------
  3317     05  FILLER            PIC  X(0003).
  3318     05  NOCLMS5O PIC  999.
  3319*    -------------------------------
  3320     05  FILLER            PIC  X(0003).
  3321     05  NODAYS5O PIC  99999.
  3322*    -------------------------------
  3323     05  FILLER            PIC  X(0003).
  3324     05  TAMT5O PIC  9,999,999.99.
  3325*    -------------------------------
  3326 01  EL150AI-R REDEFINES EL150AI.
  3327*    12  FILLER              PIC X(665).
  3328*    12  FILLER              PIC X(706).
  3329     12  FILLER              PIC X(738).
  3330     12  EL150AI-OCCURS         OCCURS 4 TIMES.
  3331         16  FILLER          PIC X(3).
  3332         16  MAP-DISPLAY     PIC X(79).
  3333     12  FILLER              PIC X(40).
  3334
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  65
* EL150.cbl
  3336****************************************************************
  3337*
  3338* Copyright (c) 2007 by Clerity Solutions, Inc.
  3339* All rights reserved.
  3340*
  3341****************************************************************
  3342 01  DFHEIV.
  3343   02  DFHEIV0               PIC X(35).
  3344   02  DFHEIV1               PIC X(08).
  3345   02  DFHEIV2               PIC X(08).
  3346   02  DFHEIV3               PIC X(08).
  3347   02  DFHEIV4               PIC X(06).
  3348   02  DFHEIV5               PIC X(04).
  3349   02  DFHEIV6               PIC X(04).
  3350   02  DFHEIV7               PIC X(02).
  3351   02  DFHEIV8               PIC X(02).
  3352   02  DFHEIV9               PIC X(01).
  3353   02  DFHEIV10              PIC S9(7) COMP-3.
  3354   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3355   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3356   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3357   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3358   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3359   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3360   02  DFHEIV17              PIC X(04).
  3361   02  DFHEIV18              PIC X(04).
  3362   02  DFHEIV19              PIC X(04).
  3363   02  DFHEIV20              USAGE IS POINTER.
  3364   02  DFHEIV21              USAGE IS POINTER.
  3365   02  DFHEIV22              USAGE IS POINTER.
  3366   02  DFHEIV23              USAGE IS POINTER.
  3367   02  DFHEIV24              USAGE IS POINTER.
  3368   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3369   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3370   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3371   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3372   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3373   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3374   02  FILLER                PIC X(02).
  3375   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3376   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3377   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3378   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3379   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3380 LINKAGE  SECTION.
  3381*****************************************************************
  3382*                                                               *
  3383* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3384* All rights reserved.                                          *
  3385*                                                               *
  3386*****************************************************************
  3387 01  dfheiblk.
  3388     02  eibtime          pic s9(7) comp-3.
  3389     02  eibdate          pic s9(7) comp-3.
  3390     02  eibtrnid         pic x(4).
  3391     02  eibtaskn         pic s9(7) comp-3.
  3392     02  eibtrmid         pic x(4).
  3393     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  66
* EL150.cbl
  3394     02  eibcposn         pic s9(4) comp.
  3395     02  eibcalen         pic s9(4) comp.
  3396     02  eibaid           pic x(1).
  3397     02  eibfiller1       pic x(1).
  3398     02  eibfn            pic x(2).
  3399     02  eibfiller2       pic x(2).
  3400     02  eibrcode         pic x(6).
  3401     02  eibfiller3       pic x(2).
  3402     02  eibds            pic x(8).
  3403     02  eibreqid         pic x(8).
  3404     02  eibrsrce         pic x(8).
  3405     02  eibsync          pic x(1).
  3406     02  eibfree          pic x(1).
  3407     02  eibrecv          pic x(1).
  3408     02  eibsend          pic x(1).
  3409     02  eibatt           pic x(1).
  3410     02  eibeoc           pic x(1).
  3411     02  eibfmh           pic x(1).
  3412     02  eibcompl         pic x(1).
  3413     02  eibsig           pic x(1).
  3414     02  eibconf          pic x(1).
  3415     02  eiberr           pic x(1).
  3416     02  eibrldbk         pic x(1).
  3417     02  eiberrcd         pic x(4).
  3418     02  eibsynrb         pic x(1).
  3419     02  eibnodat         pic x(1).
  3420     02  eibfiller5       pic x(2).
  3421     02  eibresp          pic 9(09) comp.
  3422     02  eibresp2         pic 9(09) comp.
  3423     02  dfheigdj         pic s9(4) comp.
  3424     02  dfheigdk         pic s9(4) comp.
  3425 01  DFHCOMMAREA             PIC X(1024).
  3426
  3427 01  CLAIM-MASTER-L          PIC X(350).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  67
* EL150.cbl
  3429*                            COPY ELCCNTL.
  3430******************************************************************
  3431*                                                                *
  3432*                                                                *
  3433*                            ELCCNTL.                            *
  3434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3435*                            VMOD=2.059                          *
  3436*                                                                *
  3437*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3438*                                                                *
  3439*   FILE TYPE = VSAM,KSDS                                        *
  3440*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3441*                                                                *
  3442*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3443*       ALTERNATE INDEX = NONE                                   *
  3444*                                                                *
  3445*   LOG = YES                                                    *
  3446*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3447******************************************************************
  3448*                   C H A N G E   L O G
  3449*
  3450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3451*-----------------------------------------------------------------
  3452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3453* EFFECTIVE    NUMBER
  3454*-----------------------------------------------------------------
  3455* 082503                   PEMA  ADD BENEFIT GROUP
  3456* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3457* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3458* 092705    2005050300006  PEMA  ADD SPP LEASES
  3459* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3460* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3461* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3462* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3463* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3464* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3465* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3466* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3467* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3468* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3469******************************************************************
  3470*
  3471 01  CONTROL-FILE.
  3472     12  CF-RECORD-ID                       PIC XX.
  3473         88  VALID-CF-ID                        VALUE 'CF'.
  3474
  3475     12  CF-CONTROL-PRIMARY.
  3476         16  CF-COMPANY-ID                  PIC XXX.
  3477         16  CF-RECORD-TYPE                 PIC X.
  3478             88  CF-COMPANY-MASTER              VALUE '1'.
  3479             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3480             88  CF-STATE-MASTER                VALUE '3'.
  3481             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3482             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3483             88  CF-CARRIER-MASTER              VALUE '6'.
  3484             88  CF-MORTALITY-MASTER            VALUE '7'.
  3485             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3486             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  68
* EL150.cbl
  3487             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3488             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3489             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3490             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3491             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3492             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3493             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3494             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3495             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3496         16  CF-ACCESS-CD-GENL              PIC X(4).
  3497         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3498             20  CF-PROCESSOR               PIC X(4).
  3499         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3500             20  CF-STATE-CODE              PIC XX.
  3501             20  FILLER                     PIC XX.
  3502         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3503             20  FILLER                     PIC XX.
  3504             20  CF-HI-BEN-IN-REC           PIC XX.
  3505         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3506             20  FILLER                     PIC XXX.
  3507             20  CF-CARRIER-CNTL            PIC X.
  3508         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3509             20  FILLER                     PIC XX.
  3510             20  CF-HI-TYPE-IN-REC          PIC 99.
  3511         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3512             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3513                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3514             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3515             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3516         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3517             20  FILLER                     PIC X.
  3518             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3519         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3520             20  FILLER                     PIC XX.
  3521             20  CF-MORTGAGE-PLAN           PIC XX.
  3522         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3523
  3524     12  CF-LAST-MAINT-DT                   PIC XX.
  3525     12  CF-LAST-MAINT-BY                   PIC X(4).
  3526     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3527
  3528     12  CF-RECORD-BODY                     PIC X(728).
  3529
  3530
  3531****************************************************************
  3532*             COMPANY MASTER RECORD                            *
  3533****************************************************************
  3534
  3535     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3536         16  CF-COMPANY-ADDRESS.
  3537             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3538             20  CF-CL-IN-CARE-OF           PIC X(30).
  3539             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3540             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3541             20  CF-CL-CITY-STATE           PIC X(30).
  3542             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3543             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3544         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  69
* EL150.cbl
  3545         16  CF-COMPANY-PASSWORD            PIC X(8).
  3546         16  CF-SECURITY-OPTION             PIC X.
  3547             88  ALL-SECURITY                   VALUE '1'.
  3548             88  COMPANY-VERIFY                 VALUE '2'.
  3549             88  PROCESSOR-VERIFY               VALUE '3'.
  3550             88  NO-SECURITY                    VALUE '4'.
  3551             88  ALL-BUT-TERM                   VALUE '5'.
  3552         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3553             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3554         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3555             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3556         16  CF-INFORCE-LOCATION            PIC X.
  3557             88  CERTS-ARE-ONLINE               VALUE '1'.
  3558             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3559             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3560         16  CF-LOWER-CASE-LETTERS          PIC X.
  3561         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3562             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3563             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3564             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3565             88  CF-ACCNT-CNTL                  VALUE '3'.
  3566             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3567
  3568         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3569         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3570
  3571         16  CF-LGX-CREDIT-USER             PIC X.
  3572             88  CO-IS-NOT-USER                 VALUE 'N'.
  3573             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3574
  3575         16 CF-CREDIT-CALC-CODES.
  3576             20  CF-CR-REM-TERM-CALC PIC X.
  3577               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3578               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3579               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3580               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3581               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3582               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3583               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3584             20  CF-CR-R78-METHOD           PIC X.
  3585               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3586               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3587
  3588         16  CF-CLAIM-CONTROL-COUNTS.
  3589             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3590                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3591
  3592             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3593                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3594
  3595             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3596                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3597
  3598             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3599                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3600
  3601         16  CF-CURRENT-MONTH-END           PIC XX.
  3602
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  70
* EL150.cbl
  3603         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3604             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3605             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3606             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3607             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3608                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3609                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3610             20  CF-CO-PREM-REJECT-SW       PIC X.
  3611                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3612                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3613             20  CF-CO-REF-REJECT-SW        PIC X.
  3614                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3615                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3616
  3617         16  CF-CO-REPORTING-DT             PIC XX.
  3618         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3619         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3620           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3621           88  CF-CO-MONTH-END                  VALUE '1'.
  3622
  3623         16  CF-LGX-CLAIM-USER              PIC X.
  3624             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3625             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3626
  3627         16  CF-CREDIT-EDIT-CONTROLS.
  3628             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3629             20  CF-MIN-AGE                 PIC 99.
  3630             20  CF-DEFAULT-AGE             PIC 99.
  3631             20  CF-MIN-TERM                PIC S999      COMP-3.
  3632             20  CF-MAX-TERM                PIC S999      COMP-3.
  3633             20  CF-DEFAULT-SEX             PIC X.
  3634             20  CF-JOINT-AGE-INPUT         PIC X.
  3635                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3636             20  CF-BIRTH-DATE-INPUT        PIC X.
  3637                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3638             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3639                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3640                 88  CF-ZERO-CARRIER            VALUE '1'.
  3641                 88  CF-ZERO-GROUPING           VALUE '2'.
  3642                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3643             20  CF-EDIT-SW                 PIC X.
  3644                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3645             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3646             20  CF-CR-PR-METHOD            PIC X.
  3647               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3648               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3649             20  FILLER                     PIC X.
  3650
  3651         16  CF-CREDIT-MISC-CONTROLS.
  3652             20  CF-REIN-TABLE-SW           PIC X.
  3653                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3654             20  CF-COMP-TABLE-SW           PIC X.
  3655                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3656             20  CF-EXPERIENCE-RETENTION-AGE
  3657                                            PIC S9        COMP-3.
  3658             20  CF-CONVERSION-DT           PIC XX.
  3659             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3660             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  71
* EL150.cbl
  3661                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3662                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3663
  3664             20  CF-CR-CHECK-NO-CONTROL.
  3665                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3666                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3667                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3668                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3669                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3670                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3671
  3672                 24  CF-CR-CHECK-COUNT       REDEFINES
  3673                     CF-CR-CHECK-COUNTER      PIC X(4).
  3674
  3675                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3676                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3677
  3678                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3679                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3680                 24  CF-MAIL-PROCESSING       PIC X.
  3681                     88  MAIL-PROCESSING          VALUE 'Y'.
  3682
  3683         16  CF-MISC-SYSTEM-CONTROL.
  3684             20  CF-SYSTEM-C                 PIC X.
  3685                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3686             20  CF-SYSTEM-D                 PIC X.
  3687                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3688             20  CF-SOC-SEC-NO-SW            PIC X.
  3689                 88  SOC-SEC-NO-USED             VALUE '1'.
  3690             20  CF-MEMBER-NO-SW             PIC X.
  3691                 88  MEMBER-NO-USED              VALUE '1'.
  3692             20  CF-TAX-ID-NUMBER            PIC X(11).
  3693             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3694             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3695                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3696                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3697                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3698                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3699             20  CF-SYSTEM-E                 PIC X.
  3700                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3701
  3702         16  CF-LGX-LIFE-USER               PIC X.
  3703             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3704             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3705
  3706         16  CF-CR-MONTH-END-DT             PIC XX.
  3707
  3708         16  CF-FILE-MAINT-DATES.
  3709             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3710                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3711             20  CF-LAST-BATCH       REDEFINES
  3712                 CF-LAST-BATCH-NO               PIC X(4).
  3713             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3714             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3715             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3716             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3717             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3718             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  72
* EL150.cbl
  3719             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3720             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3721             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3722             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3723
  3724         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3725         16  FILLER                         PIC X.
  3726
  3727         16  CF-ALT-MORT-CODE               PIC X(4).
  3728         16  CF-MEMBER-CAPTION              PIC X(10).
  3729
  3730         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3731             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3732             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3733             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3734             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3735             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3736
  3737         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3738
  3739         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3740         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3741         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3742         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3743
  3744         16  CF-AH-OVERRIDE-L1              PIC X.
  3745         16  CF-AH-OVERRIDE-L2              PIC XX.
  3746         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3747         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3748
  3749         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3750         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3751
  3752         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3753         16  CF-AR-LAST-EL860-DT            PIC XX.
  3754         16  CF-MP-MONTH-END-DT             PIC XX.
  3755
  3756         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3757         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3758             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3759
  3760         16  CF-AR-MONTH-END-DT             PIC XX.
  3761
  3762         16  CF-CRDTCRD-USER                PIC X.
  3763             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3764             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3765
  3766         16  CF-CC-MONTH-END-DT             PIC XX.
  3767
  3768         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3769
  3770         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3771             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3772             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3773             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3774         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3775         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3776         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  73
* EL150.cbl
  3777         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3778             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3779             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3780         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3781         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3782         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3783             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3784         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3785
  3786         16  CF-CL-ZIP-CODE.
  3787             20  CF-CL-ZIP-PRIME.
  3788                 24  CF-CL-ZIP-1ST          PIC X.
  3789                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3790                 24  FILLER                 PIC X(4).
  3791             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3792         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3793             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3794             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3795             20  FILLER                     PIC XXX.
  3796
  3797         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3798         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3799         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3800         16  CF-CO-OPTION-START-DATE        PIC XX.
  3801         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3802           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3803                                                      '3' '4'.
  3804           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3805           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3806           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3807           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3808           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3809           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3810
  3811         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3812
  3813         16  CF-PAYMENT-APPROVAL-LEVELS.
  3814             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3815             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3816             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3817             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3818             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3819             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3820
  3821         16  CF-END-USER-REPORTING-USER     PIC X.
  3822             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3823             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3824
  3825         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3826             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3827             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3828
  3829         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3830
  3831         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3832         16  FILLER                         PIC X.
  3833
  3834         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  74
* EL150.cbl
  3835             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3836             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3837             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3838
  3839         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3840
  3841         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3842             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3843             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3844
  3845         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3846             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3847             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3848
  3849         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3850
  3851         16  CF-CO-ACH-ID-CODE              PIC  X.
  3852             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3853             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3854             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3855         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3856         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3857         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3858         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3859         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3860         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3861         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3862         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3863         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3864                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3865         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3866                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3867
  3868         16  CF-CO-OVER-SHORT.
  3869             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3870             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3871
  3872*         16  FILLER                         PIC X(102).
  3873         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3874             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3875             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3876
  3877         16  CF-AH-APPROVAL-DAYS.
  3878             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3879             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3880             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3881             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3882
  3883         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3884
  3885         16  CF-APPROV-LEV-5.
  3886             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3887             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3888             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3889
  3890         16  FILLER                         PIC X(68).
  3891****************************************************************
  3892*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  75
* EL150.cbl
  3893****************************************************************
  3894
  3895     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3896         16  CF-PROCESSOR-NAME              PIC X(30).
  3897         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3898         16  CF-PROCESSOR-TITLE             PIC X(26).
  3899         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3900                 88  MESSAGE-YES                VALUE 'Y'.
  3901                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3902
  3903*****************************************************
  3904****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3905****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3906****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3907****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3908*****************************************************
  3909
  3910         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3911             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3912             20  CF-APPLICATION-FORCE       PIC X.
  3913             20  CF-INDIVIDUAL-APP.
  3914                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3915                     28  CF-BROWSE-APP      PIC X.
  3916                     28  CF-UPDATE-APP      PIC X.
  3917
  3918         16  CF-CURRENT-TERM-ON             PIC X(4).
  3919         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3920             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3921             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3922             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3923             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3924             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3925             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3926             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3927         16  CF-PROCESSOR-CARRIER           PIC X.
  3928             88  NO-CARRIER-SECURITY            VALUE ' '.
  3929         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3930             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3931         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3932             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3933         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3934             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3935
  3936         16  CF-PROC-SYS-ACCESS-SW.
  3937             20  CF-PROC-CREDIT-CLAIMS-SW.
  3938                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3939                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3940                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3941                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3942             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3943                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3944                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3945             20  CF-PROC-LIFE-GNRLDGR-SW.
  3946                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3947                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3948                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3949                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3950             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  76
* EL150.cbl
  3951                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3952                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3953         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3954             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3955             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3956         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3957
  3958         16  CF-APPROVAL-LEVEL                  PIC X.
  3959             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3960             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3961             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3962             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3963             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3964
  3965         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3966
  3967         16  CF-LANGUAGE-TYPE                   PIC X.
  3968             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3969             88  CF-LANG-IS-FR                      VALUE 'F'.
  3970
  3971         16  CF-CSR-IND                         PIC X.
  3972         16  FILLER                             PIC X(239).
  3973
  3974****************************************************************
  3975*             PROCESSOR/REMINDERS RECORD                       *
  3976****************************************************************
  3977
  3978     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3979         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3980             20  CF-START-REMIND-DT         PIC XX.
  3981             20  CF-END-REMIND-DT           PIC XX.
  3982             20  CF-REMINDER-TEXT           PIC X(50).
  3983         16  FILLER                         PIC X(296).
  3984
  3985
  3986****************************************************************
  3987*             STATE MASTER RECORD                              *
  3988****************************************************************
  3989
  3990     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3991         16  CF-STATE-ABBREVIATION          PIC XX.
  3992         16  CF-STATE-NAME                  PIC X(25).
  3993         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3994         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3995             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3996             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3997             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3998             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3999                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4000                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4001             20  CF-ST-PREM-REJECT-SW       PIC X.
  4002                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4003                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4004             20  CF-ST-REF-REJECT-SW        PIC X.
  4005                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4006                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4007         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4008         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  77
* EL150.cbl
  4009         16  CF-ST-REFUND-RULES.
  4010             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4011             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4012             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4013         16  CF-ST-FST-PMT-EXTENSION.
  4014             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4015             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4016                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4017                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4018                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4019                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4020         16  CF-ST-STATE-CALL.
  4021             20  CF-ST-CALL-UNEARNED        PIC X.
  4022             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4023             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4024         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4025             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4026             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4027         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4028         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4029         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4030         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4031         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4032         16  FILLER                         PIC X.
  4033         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4034             20  CF-ST-BENEFIT-CD           PIC XX.
  4035             20  CF-ST-BENEFIT-KIND         PIC X.
  4036                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4037                 88  CF-ST-AH-KIND              VALUE 'A'.
  4038             20  CF-ST-REM-TERM-CALC        PIC X.
  4039                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4040                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4041                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4042                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4043                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4044                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4045                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4046                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4047
  4048             20  CF-ST-REFUND-CALC          PIC X.
  4049                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4050                 88  ST-REFD-BY-R78             VALUE '1'.
  4051                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4052                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4053                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4054                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4055                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4056                 88  ST-REFD-UTAH               VALUE '7'.
  4057                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4058                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4059                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4060
  4061             20  CF-ST-EARNING-CALC         PIC X.
  4062                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4063                 88  ST-EARN-BY-R78             VALUE '1'.
  4064                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4065                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4066                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  78
* EL150.cbl
  4067                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4068                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4069                 88  ST-EARN-MEAN               VALUE '8'.
  4070                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4071
  4072             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4073                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4074                 88  ST-OVRD-BY-R78             VALUE '1'.
  4075                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4076                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4077                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4078                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4079                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4080                 88  ST-OVRD-MEAN               VALUE '8'.
  4081                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4082             20  FILLER                     PIC X.
  4083
  4084         16  CF-ST-COMMISSION-CAPS.
  4085             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4086             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4087             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4088             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4089         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4090                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4091
  4092         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4093
  4094         16  CF-ST-STATUTORY-INTEREST.
  4095             20  CF-ST-STAT-DATE-FROM       PIC X.
  4096                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4097                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4098             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4099             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4100             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4101             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4102             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4103
  4104         16  CF-ST-OVER-SHORT.
  4105             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4106             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4107
  4108         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4109
  4110         16  CF-ST-RT-CALC                  PIC X.
  4111
  4112         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4113         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4114         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4115         16  CF-ST-RF-LR-CALC               PIC X.
  4116         16  CF-ST-RF-LL-CALC               PIC X.
  4117         16  CF-ST-RF-LN-CALC               PIC X.
  4118         16  CF-ST-RF-AH-CALC               PIC X.
  4119         16  CF-ST-RF-CP-CALC               PIC X.
  4120*        16  FILLER                         PIC X(206).
  4121*CIDMOD         16  FILLER                         PIC X(192).
  4122         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4123             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4124         16  CF-ST-REF-AH-DEATH-IND         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  79
* EL150.cbl
  4125         16  CF-ST-VFY-2ND-BENE             PIC X.
  4126         16  CF-ST-CAUSAL-STATE             PIC X.
  4127         16  FILLER                         PIC X(185).
  4128
  4129****************************************************************
  4130*             BENEFIT MASTER RECORD                            *
  4131****************************************************************
  4132
  4133     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4134         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4135             20  CF-BENEFIT-CODE            PIC XX.
  4136             20  CF-BENEFIT-NUMERIC  REDEFINES
  4137                 CF-BENEFIT-CODE            PIC XX.
  4138             20  CF-BENEFIT-ALPHA           PIC XXX.
  4139             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4140             20  CF-BENEFIT-COMMENT         PIC X(10).
  4141
  4142             20  CF-LF-COVERAGE-TYPE        PIC X.
  4143                 88  CF-REDUCING                VALUE 'R'.
  4144                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4145
  4146             20  CF-SPECIAL-CALC-CD         PIC X.
  4147                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4148                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4149                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4150                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4151                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4152                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4153                 88  CF-FARM-PLAN               VALUE 'F'.
  4154                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4155                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4156                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4157                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4158                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4159                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4160                 88  CF-PRUDENTIAL              VALUE 'P'.
  4161                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4162                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4163                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4164                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4165                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4166                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4167
  4168             20  CF-JOINT-INDICATOR         PIC X.
  4169                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4170
  4171*            20  FILLER                     PIC X(12).
  4172             20  cf-maximum-benefits        pic s999 comp-3.
  4173             20  FILLER                     PIC X(09).
  4174             20  CF-BENEFIT-CATEGORY        PIC X.
  4175             20  CF-LOAN-TYPE               PIC X(8).
  4176
  4177             20  CF-CO-REM-TERM-CALC        PIC X.
  4178                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4179                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4180                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4181                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4182                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  80
* EL150.cbl
  4183
  4184             20  CF-CO-EARNINGS-CALC        PIC X.
  4185                 88  CO-EARN-BY-R78             VALUE '1'.
  4186                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4187                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4188                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4189                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4190                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4191                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4192                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4193
  4194             20  CF-CO-REFUND-CALC          PIC X.
  4195                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4196                 88  CO-REFD-BY-R78             VALUE '1'.
  4197                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4198                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4199                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4200                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4201                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4202                 88  CO-REFD-MEAN               VALUE '8'.
  4203                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4204                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4205                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4206
  4207             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4208                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4209                 88  CO-OVRD-BY-R78             VALUE '1'.
  4210                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4211                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4212                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4213                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4214                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4215                 88  CO-OVRD-MEAN               VALUE '8'.
  4216                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4217
  4218             20  CF-CO-BEN-I-G-CD           PIC X.
  4219                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4220                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4221                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4222
  4223         16  FILLER                         PIC X(304).
  4224
  4225
  4226****************************************************************
  4227*             CARRIER MASTER RECORD                            *
  4228****************************************************************
  4229
  4230     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4231         16  CF-ADDRESS-DATA.
  4232             20  CF-MAIL-TO-NAME            PIC X(30).
  4233             20  CF-IN-CARE-OF              PIC X(30).
  4234             20  CF-ADDRESS-LINE-1          PIC X(30).
  4235             20  CF-ADDRESS-LINE-2          PIC X(30).
  4236             20  CF-CITY-STATE              PIC X(30).
  4237             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4238             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4239
  4240         16  CF-CLAIM-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  81
* EL150.cbl
  4241             20  CF-CLAIM-NO-METHOD         PIC X.
  4242                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4243                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4244                 88  CLAIM-NO-SEQ               VALUE '3'.
  4245                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4246             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4247                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4248                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4249                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4250
  4251         16  CF-CHECK-NO-CONTROL.
  4252             20  CF-CHECK-NO-METHOD         PIC X.
  4253                 88  CHECK-NO-MANUAL            VALUE '1'.
  4254                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4255                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4256                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4257             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4258                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4259
  4260         16  CF-DOMICILE-STATE              PIC XX.
  4261
  4262         16  CF-EXPENSE-CONTROLS.
  4263             20  CF-EXPENSE-METHOD          PIC X.
  4264                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4265                 88  DOLLARS-PER-PMT            VALUE '2'.
  4266                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4267                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4268             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4269             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4270
  4271         16  CF-CORRESPONDENCE-CONTROL.
  4272             20  CF-LETTER-RESEND-OPT       PIC X.
  4273                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4274                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4275             20  FILLER                     PIC X(4).
  4276
  4277         16  CF-RESERVE-CONTROLS.
  4278             20  CF-MANUAL-SW               PIC X.
  4279                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4280             20  CF-FUTURE-SW               PIC X.
  4281                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4282             20  CF-PTC-SW                  PIC X.
  4283                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4284             20  CF-IBNR-SW                 PIC X.
  4285                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4286             20  CF-PTC-LF-SW               PIC X.
  4287                 88  CF-LF-PTC-USED             VALUE '1'.
  4288             20  CF-CDT-ACCESS-METHOD       PIC X.
  4289                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4290                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4291                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4292             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4293
  4294         16  CF-CLAIM-CALC-METHOD           PIC X.
  4295             88  360-PLUS-MONTHS                VALUE '1'.
  4296             88  365-PLUS-MONTHS                VALUE '2'.
  4297             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4298             88  360-DAILY                      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  82
* EL150.cbl
  4299             88  365-DAILY                      VALUE '5'.
  4300
  4301         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4302         16  FILLER                         PIC X(11).
  4303
  4304         16  CF-LIMIT-AMOUNTS.
  4305             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4306             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4307             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4308             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4309             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4310             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4311             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4312             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4313             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4314             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4315
  4316         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4317         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4318         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4319
  4320         16  CF-ZIP-CODE.
  4321             20  CF-ZIP-PRIME.
  4322                 24  CF-ZIP-1ST             PIC X.
  4323                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4324                 24  FILLER                 PIC X(4).
  4325             20  CF-ZIP-PLUS4               PIC X(4).
  4326         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4327             20  CF-CAN-POSTAL-1            PIC XXX.
  4328             20  CF-CAN-POSTAL-2            PIC XXX.
  4329             20  FILLER                     PIC XXX.
  4330
  4331         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4332         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4333         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4334
  4335         16  CF-RATING-SWITCH               PIC X.
  4336             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4337             88  CF-NO-RATING                   VALUE 'N'.
  4338
  4339         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4340
  4341         16  CF-CARRIER-OVER-SHORT.
  4342             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4343             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4344
  4345         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4346         16  CF-SECPAY-SWITCH               PIC X.
  4347             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4348             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4349         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4350         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4351         16  FILLER                         PIC X(444).
  4352*        16  FILLER                         PIC X(452).
  4353
  4354
  4355****************************************************************
  4356*             MORTALITY MASTER RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  83
* EL150.cbl
  4357****************************************************************
  4358
  4359     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4360         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4361                                INDEXED BY CF-MORT-NDX.
  4362             20  CF-MORT-TABLE              PIC X(5).
  4363             20  CF-MORT-TABLE-TYPE         PIC X.
  4364                 88  CF-MORT-JOINT              VALUE 'J'.
  4365                 88  CF-MORT-SINGLE             VALUE 'S'.
  4366                 88  CF-MORT-COMBINED           VALUE 'C'.
  4367                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4368                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4369             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4370             20  CF-MORT-AGE-METHOD         PIC XX.
  4371                 88  CF-AGE-LAST                VALUE 'AL'.
  4372                 88  CF-AGE-NEAR                VALUE 'AN'.
  4373             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4374             20  CF-MORT-ADJUSTMENT-DIRECTION
  4375                                            PIC X.
  4376                 88  CF-MINUS                   VALUE '-'.
  4377                 88  CF-PLUS                    VALUE '+'.
  4378             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4379             20  CF-MORT-JOINT-CODE         PIC X.
  4380                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4381             20  CF-MORT-PC-Q               PIC X.
  4382                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4383             20  CF-MORT-TABLE-CODE         PIC X(4).
  4384             20  CF-MORT-COMMENTS           PIC X(15).
  4385             20  FILLER                     PIC X(14).
  4386
  4387         16  FILLER                         PIC X(251).
  4388
  4389
  4390****************************************************************
  4391*             BUSSINESS TYPE MASTER RECORD                     *
  4392****************************************************************
  4393
  4394     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4395* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4396* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4397* AND RECORD 05 IS TYPES 81-99
  4398         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4399             20  CF-BUSINESS-TITLE          PIC  X(19).
  4400             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4401                                            PIC S9V9(4) COMP-3.
  4402             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4403             20  FILLER                     PIC  X.
  4404         16  FILLER                         PIC  X(248).
  4405
  4406
  4407****************************************************************
  4408*             TERMINAL MASTER RECORD                           *
  4409****************************************************************
  4410
  4411     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4412
  4413         16  CF-COMPANY-TERMINALS.
  4414             20  CF-TERMINAL-ID  OCCURS 120 TIMES
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  84
* EL150.cbl
  4415                                  PIC X(4).
  4416         16  FILLER               PIC X(248).
  4417
  4418
  4419****************************************************************
  4420*             LIFE EDIT MASTER RECORD                          *
  4421****************************************************************
  4422
  4423     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4424         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4425             20  CF-LIFE-CODE-IN            PIC XX.
  4426             20  CF-LIFE-CODE-OUT           PIC XX.
  4427         16  FILLER                         PIC X(248).
  4428
  4429
  4430****************************************************************
  4431*             AH EDIT MASTER RECORD                            *
  4432****************************************************************
  4433
  4434     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4435         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4436             20  CF-AH-CODE-IN              PIC XXX.
  4437             20  CF-AH-CODE-OUT             PIC XX.
  4438         16  FILLER                         PIC X(248).
  4439
  4440
  4441****************************************************************
  4442*             CREDIBILITY TABLES                               *
  4443****************************************************************
  4444
  4445     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4446         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4447                             INDEXED BY CF-CRDB-NDX.
  4448             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4449             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4450             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4451         16  FILLER                         PIC  X(332).
  4452
  4453
  4454****************************************************************
  4455*             REPORT CUSTOMIZATION RECORD                      *
  4456****************************************************************
  4457
  4458     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4459         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4460             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4461             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4462             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4463**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4464****       A T-TRANSFER.                                   ****
  4465             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4466
  4467         16  FILLER                         PIC XX.
  4468
  4469         16  CF-CARRIER-CNTL-OPT.
  4470             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4471                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4472                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  85
* EL150.cbl
  4473             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4474                                            PIC X.
  4475         16  CF-GROUP-CNTL-OPT.
  4476             20  CF-GROUP-OPT-SEQ           PIC 9.
  4477                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4478                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4479             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4480                                            PIC X(6).
  4481         16  CF-STATE-CNTL-OPT.
  4482             20  CF-STATE-OPT-SEQ           PIC 9.
  4483                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4484                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4485             20  CF-STATE-SELECT OCCURS 3 TIMES
  4486                                            PIC XX.
  4487         16  CF-ACCOUNT-CNTL-OPT.
  4488             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4489                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4490                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4491             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4492                                            PIC X(10).
  4493         16  CF-BUS-TYP-CNTL-OPT.
  4494             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4495                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4496                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4497             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4498                                            PIC XX.
  4499         16  CF-LF-TYP-CNTL-OPT.
  4500             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4501                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4502                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4503             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4504                                            PIC XX.
  4505         16  CF-AH-TYP-CNTL-OPT.
  4506             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4507                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4508                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4509             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4510                                            PIC XX.
  4511         16  CF-REPTCD1-CNTL-OPT.
  4512             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4513                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4514                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4515             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4516                                            PIC X(10).
  4517         16  CF-REPTCD2-CNTL-OPT.
  4518             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4519                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4520                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4521             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4522                                            PIC X(10).
  4523         16  CF-USER1-CNTL-OPT.
  4524             20  CF-USER1-OPT-SEQ           PIC 9.
  4525                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4526                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4527             20  CF-USER1-SELECT OCCURS 3 TIMES
  4528                                            PIC X(10).
  4529         16  CF-USER2-CNTL-OPT.
  4530             20  CF-USER2-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  86
* EL150.cbl
  4531                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4532                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4533             20  CF-USER2-SELECT OCCURS 3 TIMES
  4534                                            PIC X(10).
  4535         16  CF-USER3-CNTL-OPT.
  4536             20  CF-USER3-OPT-SEQ           PIC 9.
  4537                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4538                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4539             20  CF-USER3-SELECT OCCURS 3 TIMES
  4540                                            PIC X(10).
  4541         16  CF-USER4-CNTL-OPT.
  4542             20  CF-USER4-OPT-SEQ           PIC 9.
  4543                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4544                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4545             20  CF-USER4-SELECT OCCURS 3 TIMES
  4546                                            PIC X(10).
  4547         16  CF-USER5-CNTL-OPT.
  4548             20  CF-USER5-OPT-SEQ           PIC 9.
  4549                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4550                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4551             20  CF-USER5-SELECT OCCURS 3 TIMES
  4552                                            PIC X(10).
  4553         16  CF-REINS-CNTL-OPT.
  4554             20  CF-REINS-OPT-SEQ           PIC 9.
  4555                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4556                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4557             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4558                 24  CF-REINS-PRIME         PIC XXX.
  4559                 24  CF-REINS-SUB           PIC XXX.
  4560
  4561         16  CF-AGENT-CNTL-OPT.
  4562             20  CF-AGENT-OPT-SEQ           PIC 9.
  4563                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4564                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4565             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4566                                            PIC X(10).
  4567
  4568         16  FILLER                         PIC X(43).
  4569
  4570         16  CF-LOSS-RATIO-SELECT.
  4571             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4572             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4573         16  CF-ENTRY-DATE-SELECT.
  4574             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4575             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4576         16  CF-EFFECTIVE-DATE-SELECT.
  4577             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4578             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4579
  4580         16  CF-EXCEPTION-LIST-IND          PIC X.
  4581             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4582
  4583         16  FILLER                         PIC X(318).
  4584
  4585****************************************************************
  4586*                  EXCEPTION REPORTING RECORD                  *
  4587****************************************************************
  4588
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  87
* EL150.cbl
  4589     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4590         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4591             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4592
  4593         16  CF-COMBINED-LIFE-AH-OPT.
  4594             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4595             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4596             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4597             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4598
  4599         16  CF-LIFE-OPT.
  4600             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4601             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4602             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4603             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4604             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4605             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4606             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4607             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4608             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4609             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4610
  4611         16  CF-AH-OPT.
  4612             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4613             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4614             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4615             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4616             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4617             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4618             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4619             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4620             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4621             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4622
  4623         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4624             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4625             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4626             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4627
  4628         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4629
  4630         16  FILLER                         PIC X(673).
  4631
  4632
  4633****************************************************************
  4634*             MORTGAGE SYSTEM PLAN RECORD                      *
  4635****************************************************************
  4636
  4637     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4638         16  CF-PLAN-TYPE                   PIC X.
  4639             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4640             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4641             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4642         16  CF-PLAN-ABBREV                 PIC XXX.
  4643         16  CF-PLAN-DESCRIPT               PIC X(10).
  4644         16  CF-PLAN-NOTES                  PIC X(20).
  4645         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4646         16  CF-PLAN-UNDERWRITING.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  88
* EL150.cbl
  4647             20  CF-PLAN-TERM-DATA.
  4648                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4649                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4650             20  CF-PLAN-AGE-DATA.
  4651                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4652                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4653                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4654             20  CF-PLAN-BENEFIT-DATA.
  4655                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4656                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4657                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4658                                            PIC S9(7)V99  COMP-3.
  4659         16  CF-PLAN-POLICY-FORMS.
  4660             20  CF-POLICY-FORM             PIC X(12).
  4661             20  CF-MASTER-APPLICATION      PIC X(12).
  4662             20  CF-MASTER-POLICY           PIC X(12).
  4663         16  CF-PLAN-RATING.
  4664             20  CF-RATE-CODE               PIC X(5).
  4665             20  CF-SEX-RATING              PIC X.
  4666                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4667                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4668             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4669             20  CF-SUB-STD-TYPE            PIC X.
  4670                 88  CF-PCT-OF-PREM            VALUE '1'.
  4671                 88  CF-PCT-OF-BENE            VALUE '2'.
  4672         16  CF-PLAN-PREM-TOLERANCES.
  4673             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4674             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4675         16  CF-PLAN-PYMT-TOLERANCES.
  4676             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4677             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4678         16  CF-PLAN-MISC-DATA.
  4679             20  FILLER                     PIC X.
  4680             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4681             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4682         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4683         16  CF-PLAN-IND-GRP                PIC X.
  4684             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4685                                                     '1'.
  4686             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4687                                                     '2'.
  4688         16  CF-MIB-SEARCH-SW               PIC X.
  4689             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4690             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4691             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4692             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4693         16  CF-ALPHA-SEARCH-SW             PIC X.
  4694             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4695             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4696             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4697             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4698             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4699             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4700             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4701             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4702             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4703             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4704                                                     'A' 'B' 'C'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  89
* EL150.cbl
  4705                                                     'X' 'Y' 'Z'.
  4706         16  CF-EFF-DT-RULE-SW              PIC X.
  4707             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4708             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4709             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4710             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4711             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4712         16  FILLER                         PIC X(4).
  4713         16  CF-HEALTH-QUESTIONS            PIC X.
  4714             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4715         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4716         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4717         16  CF-PLAN-SNGL-JNT               PIC X.
  4718             88  CF-COMBINED-PLAN              VALUE 'C'.
  4719             88  CF-JNT-PLAN                   VALUE 'J'.
  4720             88  CF-SNGL-PLAN                  VALUE 'S'.
  4721         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4722         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4723         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4724         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4725         16  CF-RERATE-CNTL                 PIC  X.
  4726             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4727             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4728             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4729             88  CF-AUTO-RECALC                 VALUE '4'.
  4730         16  CF-BENEFIT-TYPE                PIC  X.
  4731             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4732             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4733         16  CF-POLICY-FEE                  PIC S999V99
  4734                                                    COMP-3.
  4735         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4736         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4737         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4738         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4739         16  FILLER                         PIC  X(32).
  4740         16  CF-TERMINATION-FORM            PIC  X(04).
  4741         16  FILLER                         PIC  X(08).
  4742         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4743                                                       COMP-3.
  4744         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4745         16  CF-ISSUE-LETTER                PIC  X(4).
  4746         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4747         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4748             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4749             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4750         16  CF-MP-REFUND-CALC              PIC X.
  4751             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4752             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4753             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4754             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4755             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4756             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4757             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4758             88  CF-MP-REFD-MEAN                VALUE '8'.
  4759         16  CF-ALT-RATE-CODE               PIC  X(5).
  4760
  4761
  4762         16  FILLER                         PIC X(498).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  90
* EL150.cbl
  4763****************************************************************
  4764*             MORTGAGE COMPANY MASTER RECORD                   *
  4765****************************************************************
  4766
  4767     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4768         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4769         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4770             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4771             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4772             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4773             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4774             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4775
  4776         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4777         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4778         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4779         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4780         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4781
  4782         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4783             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4784         16  CF-MP-RECON-USE-IND            PIC X(1).
  4785             88  CF-MP-USE-RECON             VALUE 'Y'.
  4786         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4787             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4788         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4789             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4790             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4791         16  FILLER                         PIC X(1).
  4792         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4793             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4794         16  CF-MORTG-MIB-VERSION           PIC X.
  4795             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4796             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4797             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4798         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4799             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4800                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4801             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4802                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4803             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4804                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4805             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4806                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4807             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4808                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4809             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4810                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4811         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4812         16  FILLER                         PIC X(7).
  4813         16  CF-MORTG-DESTINATION-SYMBOL.
  4814             20  CF-MORTG-MIB-COMM          PIC X(5).
  4815             20  CF-MORTG-MIB-TERM          PIC X(5).
  4816         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4817             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4818         16  FILLER                         PIC X(03).
  4819         16  CF-MP-CHECK-NO-CONTROL.
  4820             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  91
* EL150.cbl
  4821                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4822                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4823                                                ' ' LOW-VALUES.
  4824                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4825                                               VALUE '3'.
  4826         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4827         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4828         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4829             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4830                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4831             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4832                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4833             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4834                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4835             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4836                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4837             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4838                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4839             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4840                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4841         16  CF-MORTG-BILLING-AREA.
  4842             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4843                                            PIC X.
  4844         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4845         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4846         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4847         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4848             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4849             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4850         16  FILLER                         PIC X.
  4851         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4852             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4853             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4854         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4855         16  FILLER                         PIC X(8).
  4856         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4857         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4858         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4859         16  CF-ACH-COMPANY-ID.
  4860             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4861                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4862                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4863                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4864             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4865         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4866             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4867         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4868             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4869             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4870         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4871         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4872         16  FILLER                         PIC X(536).
  4873
  4874****************************************************************
  4875*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4876****************************************************************
  4877
  4878     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  92
* EL150.cbl
  4879         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4880             20  CF-FEMALE-HEIGHT.
  4881                 24  CF-FEMALE-FT           PIC 99.
  4882                 24  CF-FEMALE-IN           PIC 99.
  4883             20  CF-FEMALE-MIN-WT           PIC 999.
  4884             20  CF-FEMALE-MAX-WT           PIC 999.
  4885         16  FILLER                         PIC X(428).
  4886
  4887     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4888         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4889             20  CF-MALE-HEIGHT.
  4890                 24  CF-MALE-FT             PIC 99.
  4891                 24  CF-MALE-IN             PIC 99.
  4892             20  CF-MALE-MIN-WT             PIC 999.
  4893             20  CF-MALE-MAX-WT             PIC 999.
  4894         16  FILLER                         PIC X(428).
  4895******************************************************************
  4896*             AUTOMATIC ACTIVITY RECORD                          *
  4897******************************************************************
  4898     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4899         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4900             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4901             20  CF-SYS-LETTER-ID           PIC X(04).
  4902             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4903             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4904             20  CF-SYS-RESET-SW            PIC X(01).
  4905             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4906             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4907
  4908         16  FILLER                         PIC X(50).
  4909
  4910         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4911             20  CF-USER-ACTIVE-SW          PIC X(01).
  4912             20  CF-USER-LETTER-ID          PIC X(04).
  4913             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4914             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4915             20  CF-USER-RESET-SW           PIC X(01).
  4916             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4917             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4918             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4919
  4920         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  93
* EL150.cbl
  4922*                            COPY ELCCERT.
  4923******************************************************************
  4924*                                                                *
  4925*                            ELCCERT.                            *
  4926*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4927*                            VMOD=2.013                          *
  4928*                                                                *
  4929*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4930*                                                                *
  4931*   FILE TYPE = VSAM,KSDS                                        *
  4932*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4933*                                                                *
  4934*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4935*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4936*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4937*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4938*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4939*                                                                *
  4940*   LOG = YES                                                    *
  4941*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4942******************************************************************
  4943*                   C H A N G E   L O G
  4944*
  4945* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4946*-----------------------------------------------------------------
  4947*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4948* EFFECTIVE    NUMBER
  4949*-----------------------------------------------------------------
  4950* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4951* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4952* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4953* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4954* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4955* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4956* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4957* 032612  CR2011110200001  PEMA  AHL CHANGES
  4958* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4959******************************************************************
  4960
  4961 01  CERTIFICATE-MASTER.
  4962     12  CM-RECORD-ID                      PIC XX.
  4963         88  VALID-CM-ID                      VALUE 'CM'.
  4964
  4965     12  CM-CONTROL-PRIMARY.
  4966         16  CM-COMPANY-CD                 PIC X.
  4967         16  CM-CARRIER                    PIC X.
  4968         16  CM-GROUPING.
  4969             20  CM-GROUPING-PREFIX        PIC X(3).
  4970             20  CM-GROUPING-PRIME         PIC X(3).
  4971         16  CM-STATE                      PIC XX.
  4972         16  CM-ACCOUNT.
  4973             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4974             20  CM-ACCOUNT-PRIME          PIC X(6).
  4975         16  CM-CERT-EFF-DT                PIC XX.
  4976         16  CM-CERT-NO.
  4977             20  CM-CERT-PRIME             PIC X(10).
  4978             20  CM-CERT-SFX               PIC X.
  4979
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  94
* EL150.cbl
  4980     12  CM-CONTROL-BY-NAME.
  4981         16  CM-COMPANY-CD-A1              PIC X.
  4982         16  CM-INSURED-LAST-NAME          PIC X(15).
  4983         16  CM-INSURED-INITIALS.
  4984             20  CM-INSURED-INITIAL1       PIC X.
  4985             20  CM-INSURED-INITIAL2       PIC X.
  4986
  4987     12  CM-CONTROL-BY-SSN.
  4988         16  CM-COMPANY-CD-A2              PIC X.
  4989         16  CM-SOC-SEC-NO.
  4990             20  CM-SSN-STATE              PIC XX.
  4991             20  CM-SSN-ACCOUNT            PIC X(6).
  4992             20  CM-SSN-LN3.
  4993                 25  CM-INSURED-INITIALS-A2.
  4994                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4995                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4996                 25 CM-PART-LAST-NAME-A2         PIC X.
  4997
  4998     12  CM-CONTROL-BY-CERT-NO.
  4999         16  CM-COMPANY-CD-A4              PIC X.
  5000         16  CM-CERT-NO-A4                 PIC X(11).
  5001
  5002     12  CM-CONTROL-BY-MEMB.
  5003         16  CM-COMPANY-CD-A5              PIC X.
  5004         16  CM-MEMBER-NO.
  5005             20  CM-MEMB-STATE             PIC XX.
  5006             20  CM-MEMB-ACCOUNT           PIC X(6).
  5007             20  CM-MEMB-LN4.
  5008                 25  CM-INSURED-INITIALS-A5.
  5009                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5010                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5011                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5012
  5013     12  CM-INSURED-PROFILE-DATA.
  5014         16  CM-INSURED-FIRST-NAME.
  5015             20  CM-INSURED-1ST-INIT       PIC X.
  5016             20  FILLER                    PIC X(9).
  5017         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5018         16  CM-INSURED-SEX                PIC X.
  5019             88  CM-SEX-MALE                  VALUE 'M'.
  5020             88  CM-SEX-FEMAL                 VALUE 'F'.
  5021         16  CM-INSURED-JOINT-AGE          PIC 99.
  5022         16  CM-JOINT-INSURED-NAME.
  5023             20  CM-JT-LAST-NAME           PIC X(15).
  5024             20  CM-JT-FIRST-NAME.
  5025                 24  CM-JT-1ST-INIT        PIC X.
  5026                 24  FILLER                PIC X(9).
  5027             20  CM-JT-INITIAL             PIC X.
  5028
  5029     12  CM-LIFE-DATA.
  5030         16  CM-LF-BENEFIT-CD              PIC XX.
  5031         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5032         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5033         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5034         16  CM-LF-DEV-CODE                PIC XXX.
  5035         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5036         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5037         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  95
* EL150.cbl
  5038         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5039         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5040         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5041         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5042         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5043         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5044         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5045         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5046         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5047         16  cm-temp-epiq                  pic xx.
  5048             88  EPIQ-CLASS                  value 'EQ'.
  5049*        16  FILLER                        PIC XX.
  5050
  5051     12  CM-AH-DATA.
  5052         16  CM-AH-BENEFIT-CD              PIC XX.
  5053         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5054         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5055         16  CM-AH-DEV-CODE                PIC XXX.
  5056         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5057         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5058         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5059         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5060         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5061         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5062         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5063         16  CM-AH-PAID-THRU-DT            PIC XX.
  5064             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5065         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5066         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5067         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5068         16  FILLER                        PIC X.
  5069
  5070     12  CM-LOAN-INFORMATION.
  5071         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5072         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5073                                           PIC S9(5)V99  COMP-3.
  5074         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5075         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5076         16  CM-PAY-FREQUENCY              PIC S99.
  5077         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5078         16  CM-RATE-CLASS                 PIC XX.
  5079         16  CM-BENEFICIARY                PIC X(25).
  5080         16  CM-POLICY-FORM-NO             PIC X(12).
  5081         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5082         16  CM-LAST-ADD-ON-DT             PIC XX.
  5083         16  CM-DEDUCTIBLE-AMOUNTS.
  5084             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5085             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5086         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5087             20  CM-RESIDENT-STATE         PIC XX.
  5088             20  CM-RATE-CODE              PIC X(4).
  5089             20  FILLER                    PIC XX.
  5090         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5091             20  CM-LOAN-OFFICER           PIC X(5).
  5092             20  FILLER                    PIC XXX.
  5093         16  CM-CSR-CODE                   PIC XXX.
  5094         16  CM-UNDERWRITING-CODE          PIC X.
  5095             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  96
* EL150.cbl
  5096         16  CM-POST-CARD-IND              PIC X.
  5097         16  CM-NH-INTERFACE-SW            PIC X.
  5098         16  CM-PREMIUM-TYPE               PIC X.
  5099             88  CM-SING-PRM                  VALUE '1'.
  5100             88  CM-O-B-COVERAGE              VALUE '2'.
  5101             88  CM-OPEN-END                  VALUE '3'.
  5102         16  CM-IND-GRP-TYPE               PIC X.
  5103             88  CM-INDIVIDUAL                VALUE 'I'.
  5104             88  CM-GROUP                     VALUE 'G'.
  5105         16  CM-SKIP-CODE                  PIC X.
  5106             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5107             88  SKIP-JULY                    VALUE '1'.
  5108             88  SKIP-AUGUST                  VALUE '2'.
  5109             88  SKIP-SEPTEMBER               VALUE '3'.
  5110             88  SKIP-JULY-AUG                VALUE '4'.
  5111             88  SKIP-AUG-SEPT                VALUE '5'.
  5112             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5113             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5114             88  SKIP-JUNE                    VALUE '8'.
  5115             88  SKIP-JUNE-JULY               VALUE '9'.
  5116             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5117             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5118         16  CM-PAYMENT-MODE               PIC X.
  5119             88  PAY-MONTHLY                  VALUE SPACE.
  5120             88  PAY-WEEKLY                   VALUE '1'.
  5121             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5122             88  PAY-BI-WEEKLY                VALUE '3'.
  5123             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5124         16  CM-LOAN-NUMBER                PIC X(8).
  5125         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5126         16  CM-OLD-LOF                    PIC XXX.
  5127*        16  CM-LOAN-OFFICER               PIC XXX.
  5128         16  CM-REIN-TABLE                 PIC XXX.
  5129         16  CM-SPECIAL-REIN-CODE          PIC X.
  5130         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5131         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5132         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5133
  5134     12  CM-STATUS-DATA.
  5135         16  CM-ENTRY-STATUS               PIC X.
  5136         16  CM-ENTRY-DT                   PIC XX.
  5137
  5138         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5139         16  CM-LF-CANCEL-DT               PIC XX.
  5140         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5141
  5142         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5143         16  CM-LF-DEATH-DT                PIC XX.
  5144         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5145
  5146         16  CM-LF-CURRENT-STATUS          PIC X.
  5147             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5148                                                'M' '4' '5' '9'.
  5149             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5150             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5151             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5152             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5153             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  97
* EL150.cbl
  5154             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5155             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5156             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5157             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5158             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5159             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5160             88  CM-LF-DECLINED               VALUE 'D'.
  5161             88  CM-LF-VOIDED                 VALUE 'V'.
  5162
  5163         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5164         16  CM-AH-CANCEL-DT               PIC XX.
  5165         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5166
  5167         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5168         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5169         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5170
  5171         16  CM-AH-CURRENT-STATUS          PIC X.
  5172             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5173                                                'M' '4' '5' '9'.
  5174             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5175             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5176             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5177             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5178             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5179             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5180             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5181             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5182             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5183             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5184             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5185             88  CM-AH-DECLINED               VALUE 'D'.
  5186             88  CM-AH-VOIDED                 VALUE 'V'.
  5187
  5188         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5189             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5190             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5191             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5192         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5193
  5194         16  CM-ENTRY-BATCH                PIC X(6).
  5195         16  CM-LF-EXIT-BATCH              PIC X(6).
  5196         16  CM-AH-EXIT-BATCH              PIC X(6).
  5197         16  CM-LAST-MONTH-END             PIC XX.
  5198
  5199     12  CM-NOTE-SW                        PIC X.
  5200         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5201         88  CERT-NOTES-PRESENT               VALUE '1'.
  5202         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5203         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5204         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5205         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5206         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5207         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5208     12  CM-COMP-EXCP-SW                   PIC X.
  5209         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5210         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5211     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  98
* EL150.cbl
  5212         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5213         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5214
  5215*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5216     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5217     12  FILLER                            PIC X.
  5218
  5219*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5220     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5221     12  FILLER                            PIC X.
  5222*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5223     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5224
  5225     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5226         88  CERT-ADDED-BATCH                 VALUE ' '.
  5227         88  CERT-ADDED-ONLINE                VALUE '1'.
  5228         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5229         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5230         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5231     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5232         88  CERT-AS-LOADED                   VALUE ' '.
  5233         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5234         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5235         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5236         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5237         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5238         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5239         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5240
  5241     12  CM-ACCOUNT-COMM-PCTS.
  5242         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5243         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5244
  5245     12  CM-USER-FIELD                     PIC X.
  5246     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5247     12  CM-CLP-STATE                      PIC XX.
  5248     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5249     12  CM-USER-RESERVED                  PIC XXX.
  5250     12  FILLER REDEFINES CM-USER-RESERVED.
  5251         16  CM-AH-CLASS-CD                PIC XX.
  5252         16  F                             PIC X.
  5253******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page  99
* EL150.cbl
  5255*                            COPY ELCTRLR.
  5256******************************************************************
  5257*                                                                *
  5258*                            ELCTRLR.                            *
  5259*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5260*                            VMOD=2.014                          *
  5261*                                                                *
  5262*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5263*                                                                *
  5264*   FILE TYPE = VSAM,KSDS                                        *
  5265*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5266*                                                                *
  5267*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5268*       ALTERNATE INDEX = NONE                                   *
  5269*                                                                *
  5270*   LOG = YES                                                    *
  5271*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5272******************************************************************
  5273*                   C H A N G E   L O G
  5274*
  5275* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5276*-----------------------------------------------------------------
  5277*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5278* EFFECTIVE    NUMBER
  5279*-----------------------------------------------------------------
  5280* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5281* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5282* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5283* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5284* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5285* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5286* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5287* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5288* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5289* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5290* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5291* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5292* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5293* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5294* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5295* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5296* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5297* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5298* 040814    2014030500002  AJRA  ADD ICD CODES
  5299* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5300******************************************************************
  5301 01  ACTIVITY-TRAILERS.
  5302     12  AT-RECORD-ID                    PIC XX.
  5303         88  VALID-AT-ID                       VALUE 'AT'.
  5304
  5305     12  AT-CONTROL-PRIMARY.
  5306         16  AT-COMPANY-CD               PIC X.
  5307         16  AT-CARRIER                  PIC X.
  5308         16  AT-CLAIM-NO                 PIC X(7).
  5309         16  AT-CERT-NO.
  5310             20  AT-CERT-PRIME           PIC X(10).
  5311             20  AT-CERT-SFX             PIC X.
  5312         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 100
* EL150.cbl
  5313             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5314             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5315             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5316             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5317             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5318             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5319             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5320             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5321             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5322             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5323             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5324             88  AT-BENEFICIARY-TRL           VALUE +91.
  5325             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5326             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5327             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5328             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5329
  5330     12  AT-TRAILER-TYPE                 PIC X.
  5331         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5332         88  PAYMENT-TR                       VALUE '2'.
  5333         88  AUTO-PAY-TR                      VALUE '3'.
  5334         88  CORRESPONDENCE-TR                VALUE '4'.
  5335         88  ADDRESS-TR                       VALUE '5'.
  5336         88  GENERAL-INFO-TR                  VALUE '6'.
  5337         88  AUTO-PROMPT-TR                   VALUE '7'.
  5338         88  DENIAL-TR                        VALUE '8'.
  5339         88  INCURRED-CHG-TR                  VALUE '9'.
  5340         88  FORM-CONTROL-TR                  VALUE 'A'.
  5341
  5342     12  AT-RECORDED-DT                  PIC XX.
  5343     12  AT-RECORDED-BY                  PIC X(4).
  5344     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5345
  5346     12  AT-TRAILER-BODY                 PIC X(165).
  5347
  5348     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5349         16  AT-RESERVE-CONTROLS.
  5350             20  AT-MANUAL-SW            PIC X.
  5351                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5352             20  AT-FUTURE-SW            PIC X.
  5353                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5354             20  AT-PTC-SW               PIC X.
  5355                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5356             20  AT-IBNR-SW              PIC X.
  5357                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5358             20  AT-PTC-LF-SW            PIC X.
  5359                 88  AT-LF-PTC-USED          VALUE '1'.
  5360             20  AT-CDT-ACCESS-METHOD    PIC X.
  5361                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5362                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5363                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5364             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5365         16  AT-LAST-COMPUTED-DT         PIC XX.
  5366         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5367         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5368         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  5369         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5370         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 101
* EL150.cbl
  5371         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5372         16  AT-EXPENSE-CONTROLS.
  5373             20  AT-EXPENSE-METHOD       PIC X.
  5374                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5375                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5376                 88  PERCENT-OF-PMT           VALUE '3'.
  5377                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5378             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5379             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5380         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5381         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5382
  5383         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5384         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5385
  5386*        16  FILLER                      PIC X(53).
  5387         16  FILLER                      PIC X(47).
  5388
  5389         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5390         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5391
  5392         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5393             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5394             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5395*                    C = CLOSED
  5396*                    O = OPEN
  5397             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5398*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5399
  5400     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5401         16  AT-PAYMENT-TYPE             PIC X.
  5402             88  PARTIAL-PAYMENT                VALUE '1'.
  5403             88  FINAL-PAYMENT                  VALUE '2'.
  5404             88  LUMP-SUM-PAYMENT               VALUE '3'.
  5405             88  ADDITIONAL-PAYMENT             VALUE '4'.
  5406             88  CHARGEABLE-EXPENSE             VALUE '5'.
  5407             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  5408             88  VOIDED-PAYMENT                 VALUE '9'.
  5409             88  TRANSFER                       VALUE 'T'.
  5410             88  LIFE-INTEREST                  VALUE 'I'.
  5411
  5412         16  AT-CLAIM-TYPE               PIC X.
  5413             88  PAID-FOR-AH                    VALUE 'A'.
  5414             88  PAID-FOR-LIFE                  VALUE 'L'.
  5415             88  PAID-FOR-IUI                   VALUE 'I'.
  5416             88  PAID-FOR-GAP                   VALUE 'G'.
  5417             88  PAID-FOR-FAM                   VALUE 'F'.
  5418         16  AT-CLAIM-PREM-TYPE          PIC X.
  5419             88  AT-SINGLE-PREMIUM              VALUE '1'.
  5420             88  AT-O-B-COVERAGE                VALUE '2'.
  5421             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  5422         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  5423         16  AT-CHECK-NO                 PIC X(7).
  5424         16  AT-PAID-FROM-DT             PIC XX.
  5425         16  AT-PAID-THRU-DT             PIC XX.
  5426         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  5427         16  FILLER                      PIC X.
  5428         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 102
* EL150.cbl
  5429         16  AT-PAYMENT-ORIGIN           PIC X.
  5430             88  ONLINE-MANUAL-PMT              VALUE '1'.
  5431             88  ONLINE-AUTO-PMT                VALUE '2'.
  5432             88  OFFLINE-PMT                    VALUE '3'.
  5433         16  AT-CHECK-WRITTEN-DT         PIC XX.
  5434         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  5435         16  AT-VOID-DATA.
  5436             20  AT-VOID-DT              PIC XX.
  5437*00144       20  AT-VOID-REASON          PIC X(30).
  5438             20  AT-VOID-REASON          PIC X(26).
  5439         16  AT-PMT-APPROVED-BY          PIC X(04).
  5440         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  5441         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  5442         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  5443                                         PIC S99V9(5)  COMP-3.
  5444         16  AT-CREDIT-INTERFACE.
  5445             20  AT-PMT-SELECT-DT        PIC XX.
  5446                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  5447             20  AT-PMT-ACCEPT-DT        PIC XX.
  5448                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  5449             20  AT-VOID-SELECT-DT       PIC XX.
  5450                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  5451             20  AT-VOID-ACCEPT-DT       PIC XX.
  5452                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  5453
  5454         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  5455                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5456                 88  CONVERSION-PAYMENT           VALUE +99999999.
  5457         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  5458
  5459         16  AT-FORCE-CONTROL            PIC X.
  5460             88  PAYMENT-WAS-FORCED           VALUE '1'.
  5461         16  AT-PREV-LAST-PMT-DT         PIC XX.
  5462         16  AT-PREV-PAID-THRU-DT        PIC XX.
  5463         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5464         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  5465         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  5466         16  AT-BENEFIT-TYPE             PIC X.
  5467
  5468         16  AT-EXPENSE-TYPE             PIC X.
  5469         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  5470
  5471         16  AT-PAYEE-TYPE-CD.
  5472             20  AT-PAYEE-TYPE           PIC X.
  5473                 88  INSURED-PAID           VALUE 'I'.
  5474                 88  BENEFICIARY-PAID       VALUE 'B'.
  5475                 88  ACCOUNT-PAID           VALUE 'A'.
  5476                 88  OTHER-1-PAID           VALUE 'O'.
  5477                 88  OTHER-2-PAID           VALUE 'Q'.
  5478                 88  DOCTOR-PAID            VALUE 'P'.
  5479                 88  EMPLOYER-PAID          VALUE 'E'.
  5480             20  AT-PAYEE-SEQ            PIC X.
  5481
  5482         16  AT-CASH-PAYMENT             PIC X.
  5483         16  AT-GROUPED-PAYMENT          PIC X.
  5484         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  5485         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  5486         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 103
* EL150.cbl
  5487         16  AT-VOID-TYPE                PIC X.
  5488             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  5489             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  5490         16  AT-AIG-UNEMP-IND            PIC X.
  5491             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  5492         16  AT-ASSOCIATES               PIC X.
  5493             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  5494             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  5495
  5496         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  5497         16  AT-CV-PMT-CODE              PIC X.
  5498             88  FULL-DEATH-PAYMENT         VALUE '1'.
  5499             88  HALF-DEATH-PAYMENT         VALUE '2'.
  5500             88  FULL-ADD-PAYMENT           VALUE '3'.
  5501             88  HALF-ADD-PAYMENT           VALUE '4'.
  5502             88  FULL-RIDER-PAYMENT         VALUE '5'.
  5503             88  HALF-RIDER-PAYMENT         VALUE '6'.
  5504             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  5505             88  ADDL-PAYMENT               VALUE '8'.
  5506
  5507         16  AT-EOB-CODE1                PIC XXX.
  5508         16  AT-EOB-CODE2                PIC XXX.
  5509         16  AT-EOB-CODE3                PIC XXX.
  5510         16  FILLER REDEFINES AT-EOB-CODE3.
  5511             20  AT-PRINT-CLM-FORM       PIC X.
  5512             20  AT-PRINT-SURVEY         PIC X.
  5513             20  AT-SPECIAL-RELEASE      PIC X.
  5514         16  AT-EOB-CODE4                PIC XXX.
  5515         16  FILLER REDEFINES AT-EOB-CODE4.
  5516             20  AT-INT-PMT-SELECT-DT    PIC XX.
  5517             20  FILLER                  PIC X.
  5518         16  AT-EOB-CODE5                PIC XXX.
  5519         16  FILLER REDEFINES AT-EOB-CODE5.
  5520             20  AT-PMT-PROOF-DT         PIC XX.
  5521             20  FILLER                  PIC X.
  5522
  5523         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  5524             88  AT-PRINT-EOB            VALUE 'Y'.
  5525
  5526         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  5527         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  5528
  5529     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  5530         16  AT-SCHEDULE-START-DT        PIC XX.
  5531         16  AT-SCHEDULE-END-DT          PIC XX.
  5532         16  AT-TERMINATED-DT            PIC XX.
  5533         16  AT-LAST-PMT-TYPE            PIC X.
  5534             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  5535             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  5536         16  AT-FIRST-PMT-DATA.
  5537             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  5538             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  5539             20  AT-1ST-PAY-THRU-DT      PIC XX.
  5540         16  AT-REGULAR-PMT-DATA.
  5541             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  5542             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  5543             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  5544         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 104
* EL150.cbl
  5545             20  AT-AUTO-PAYEE-TYPE      PIC X.
  5546                 88  INSURED-PAID-AUTO      VALUE 'I'.
  5547                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  5548                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  5549                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  5550                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  5551             20  AT-AUTO-PAYEE-SEQ       PIC X.
  5552         16  AT-AUTO-PAY-DAY             PIC 99.
  5553         16  AT-AUTO-CASH                PIC X.
  5554             88  AT-CASH                      VALUE 'Y'.
  5555             88  AT-NON-CASH                  VALUE 'N'.
  5556*        16  FILLER                      PIC X(129).
  5557         16  AT-AUTO-END-LETTER          PIC X(4).
  5558         16  FILLER                      PIC X(125).
  5559
  5560         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  5561         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  5562
  5563     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  5564         16  AT-LETTER-SENT-DT           PIC XX.
  5565         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  5566         16  AT-AUTO-RE-SEND-DT          PIC XX.
  5567         16  AT-LETTER-ANSWERED-DT       PIC XX.
  5568         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  5569         16  AT-LETTER-ORIGIN            PIC X.
  5570             88  ONLINE-CREATION              VALUE '1' '3'.
  5571             88  OFFLINE-CREATION             VALUE '2' '4'.
  5572             88  NAPER-ONLINE-CREATION        VALUE '3'.
  5573             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  5574         16  AT-STD-LETTER-FORM          PIC X(4).
  5575         16  AT-REASON-TEXT              PIC X(70).
  5576         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  5577         16  AT-ADDRESEE-TYPE            PIC X.
  5578              88  INSURED-ADDRESEE            VALUE 'I'.
  5579              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  5580              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  5581              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  5582              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  5583              88  OTHER-ADDRESEE-1            VALUE 'O'.
  5584              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  5585         16  AT-ADDRESSEE-NAME           PIC X(30).
  5586         16  AT-INITIAL-PRINT-DATE       PIC XX.
  5587         16  AT-RESEND-PRINT-DATE        PIC XX.
  5588         16  AT-CORR-SOL-UNSOL           PIC X.
  5589         16  AT-LETTER-PURGED-DT         PIC XX.
  5590*
  5591*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  5592*
  5593         16  AT-CSO-REDEFINITION.
  5594             20  AT-RESEND-LETTER-FORM   PIC X(4).
  5595             20  AT-AUTO-CLOSE-IND       PIC X(1).
  5596             20  AT-LETTER-TO-BENE       PIC X(1).
  5597             20  AT-STOP-LETTER-DT       PIC X(2).
  5598             20  FILLER                  PIC X(19).
  5599*             20  FILLER                  PIC X(27).
  5600             20  AT-CSO-LETTER-STATUS    PIC X.
  5601                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  5602                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 105
* EL150.cbl
  5603                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  5604             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  5605             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  5606*
  5607*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  5608*
  5609*        16  FILLER                      PIC X(26).
  5610*
  5611*        16  AT-DMD-BSR-CODE             PIC X.
  5612*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  5613*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  5614*
  5615*        16  AT-DMD-LETTER-STATUS        PIC X.
  5616*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  5617*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  5618*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  5619*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  5620*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  5621
  5622         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  5623         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  5624
  5625     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  5626         16  AT-ADDRESS-TYPE             PIC X.
  5627             88  INSURED-ADDRESS               VALUE 'I'.
  5628             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  5629             88  ACCOUNT-ADDRESS               VALUE 'A'.
  5630             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  5631             88  EMPLOYER-ADDRESS              VALUE 'E'.
  5632             88  OTHER-ADDRESS-1               VALUE 'O'.
  5633             88  OTHER-ADDRESS-2               VALUE 'Q'.
  5634         16  AT-MAIL-TO-NAME             PIC X(30).
  5635         16  AT-ADDRESS-LINE-1           PIC X(30).
  5636         16  AT-ADDRESS-LINE-2           PIC X(30).
  5637         16  AT-CITY-STATE.
  5638             20  AT-CITY                 PIC X(28).
  5639             20  AT-STATE                PIC XX.
  5640         16  AT-ZIP.
  5641             20  AT-ZIP-CODE.
  5642                 24  AT-ZIP-1ST          PIC X.
  5643                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5644                 24  FILLER              PIC X(4).
  5645             20  AT-ZIP-PLUS4            PIC X(4).
  5646         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  5647             20  AT-CAN-POSTAL-1         PIC XXX.
  5648             20  AT-CAN-POSTAL-2         PIC XXX.
  5649             20  FILLER                  PIC XXX.
  5650         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  5651*         16  FILLER                      PIC X(23).
  5652         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  5653         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  5654         16  FILLER                      PIC X(13).
  5655         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  5656         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  5657
  5658     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  5659         16  AT-INFO-LINE-1              PIC X(60).
  5660         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 106
* EL150.cbl
  5661             20  AT-NOTE-ERROR-NO OCCURS 15
  5662                                         PIC X(4).
  5663         16  AT-INFO-LINE-2              PIC X(60).
  5664         16  FILLER REDEFINES AT-INFO-LINE-2.
  5665             20  AT-ICD-CODE-1           PIC X(8).
  5666             20  AT-ICD-CODE-2           PIC X(8).
  5667             20  FILLER                  PIC X(44).
  5668         16  AT-INFO-TRAILER-TYPE        PIC X.
  5669             88  AT-ERRORS-NOTE          VALUE 'E'.
  5670             88  AT-PAYMENT-NOTE         VALUE 'P'.
  5671             88  AT-CALL-NOTE            VALUE 'C'.
  5672             88  AT-MAINT-NOTE           VALUE 'M'.
  5673             88  AT-CERT-CHANGE          VALUE 'X'.
  5674             88  AT-APPROVAL-NOTE        VALUE 'R'.
  5675             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  5676             88  AT-CERT-CANCELLED       VALUE 'T'.
  5677         16  AT-CALL-TYPE                PIC X.
  5678             88  AT-PHONE-CALL-IN        VALUE 'I'.
  5679             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  5680         16  AT-NOTE-CONTINUATION        PIC X.
  5681             88  AT-CONTINUED-NOTE       VALUE 'X'.
  5682         16  AT-EOB-CODES-EXIST          PIC X.
  5683             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  5684         16  FILLER                      PIC X(35).
  5685         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  5686         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  5687
  5688     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  5689         16  AT-PROMPT-LINE-1            PIC X(60).
  5690         16  AT-PROMPT-LINE-2            PIC X(60).
  5691         16  AT-PROMPT-START-DT          PIC XX.
  5692         16  AT-PROMPT-END-DT            PIC XX.
  5693         16  FILLER                      PIC X(35).
  5694         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  5695         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  5696
  5697     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  5698         16  AT-DENIAL-INFO-1            PIC X(60).
  5699         16  AT-DENIAL-INFO-2            PIC X(60).
  5700         16  AT-DENIAL-DT                PIC XX.
  5701         16  AT-RETRACTION-DT            PIC XX.
  5702         16  AT-DENIAL-REASON-CODE       PIC X(4).
  5703*         16  FILLER                      PIC X(31).
  5704         16  AT-DENIAL-PROOF-DT          PIC XX.
  5705         16  FILLER                      PIC X(29).
  5706         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  5707         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  5708
  5709     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  5710         16  AT-OLD-INCURRED-DT          PIC XX.
  5711         16  AT-OLD-REPORTED-DT          PIC XX.
  5712         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  5713         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  5714         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  5715         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  5716         16  AT-OLD-PAID-THRU-DT         PIC XX.
  5717         16  AT-LAST-PMT-MADE-DT         PIC XX.
  5718         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 107
* EL150.cbl
  5719         16  AT-OLD-DIAG-CODE            PIC X(6).
  5720         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  5721         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  5722         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  5723         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  5724         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  5725         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  5726         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  5727         16  AT-OLD-ICD-CODE-1           PIC X(8).
  5728         16  AT-OLD-ICD-CODE-2           PIC X(8).
  5729         16  FILLER                      PIC X(9).
  5730         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  5731
  5732     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  5733         16  AT-FORM-SEND-ON-DT          PIC XX.
  5734         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  5735         16  AT-FORM-RE-SEND-DT          PIC XX.
  5736         16  AT-FORM-ANSWERED-DT         PIC XX.
  5737         16  AT-FORM-PRINTED-DT          PIC XX.
  5738         16  AT-FORM-REPRINT-DT          PIC XX.
  5739         16  AT-FORM-TYPE                PIC X.
  5740             88  INITIAL-FORM                  VALUE '1'.
  5741             88  PROGRESS-FORM                 VALUE '2'.
  5742         16  AT-INSTRUCT-LN-1            PIC X(28).
  5743         16  AT-INSTRUCT-LN-2            PIC X(28).
  5744         16  AT-INSTRUCT-LN-3            PIC X(28).
  5745         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  5746         16  AT-FORM-ADDRESS             PIC X.
  5747             88  FORM-TO-INSURED              VALUE 'I'.
  5748             88  FORM-TO-ACCOUNT              VALUE 'A'.
  5749             88  FORM-TO-OTHER-1              VALUE 'O'.
  5750             88  FORM-TO-OTHER-2              VALUE 'Q'.
  5751         16  AT-RELATED-1.
  5752             20 AT-REL-CARR-1            PIC X.
  5753             20 AT-REL-CLAIM-1           PIC X(7).
  5754             20 AT-REL-CERT-1            PIC X(11).
  5755         16  AT-RELATED-2.
  5756             20 AT-REL-CARR-2            PIC X.
  5757             20 AT-REL-CLAIM-2           PIC X(7).
  5758             20 AT-REL-CERT-2            PIC X(11).
  5759         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  5760         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  5761         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  5762         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  5763         16  AT-FORM-REM-PRINT-DT        PIC XX.
  5764         16  AT-STOP-FORM-DT             PIC X(2).
  5765
  5766         16  FILLER                      PIC X(09).
  5767         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  5768         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  5769******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 108
* EL150.cbl
  5771*                            COPY ELCACTQ.
  5772******************************************************************
  5773*                                                                *
  5774*                            ELCACTQ.                            *
  5775*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  5776*                            VMOD=2.004                          *
  5777*                                                                *
  5778*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  5779*                                                                *
  5780*   FILE TYPE = VSAM,KSDS                                        *
  5781*   RECORD SIZE = 60     RECFORM = FIXED                         *
  5782*                                                                *
  5783*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  5784*       ALTERNATE INDEX = NONE                                   *
  5785*                                                                *
  5786*   LOG = YES                                                    *
  5787*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5788*                                                                *
  5789*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  5790******************************************************************
  5791
  5792 01  ACTIVITY-QUE.
  5793     12  AQ-RECORD-ID                PIC XX.
  5794         88  VALID-AQ-ID                VALUE 'AQ'.
  5795
  5796     12  AQ-CONTROL-PRIMARY.
  5797         16  AQ-COMPANY-CD           PIC X.
  5798         16  AQ-CARRIER              PIC X.
  5799         16  AQ-CLAIM-NO             PIC X(7).
  5800         16  AQ-CERT-NO.
  5801             20  AQ-CERT-PRIME       PIC X(10).
  5802             20  AQ-CERT-SFX         PIC X.
  5803
  5804     12  AQ-PENDING-ACTIVITY-FLAGS.
  5805         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  5806         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  5807             88  PENDING-PAYMENTS       VALUE '1'.
  5808         16  AQ-PENDING-STATUS-FLAG  PIC X.
  5809             88  PENDING-FULL-PRINT     VALUE '1'.
  5810             88  PENDING-PART-PRINT     VALUE '2'.
  5811         16  AQ-PENDING-LETTER-FLAG  PIC X.
  5812             88  PENDING-LETTERS        VALUE '1'.
  5813         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  5814             88  PENDING-RESTORE        VALUE 'C'.
  5815             88  PENDING-RESTORE-LETTER VALUE 'L'.
  5816
  5817     12  FILLER                      PIC X(20).
  5818
  5819     12  AQ-RESEND-DATE              PIC XX.
  5820     12  AQ-FOLLOWUP-DATE            PIC XX.
  5821     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  5822     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  5823     12  AQ-AUTO-LETTER              PIC X(4).
  5824     12  FILLER                      PIC XX.
  5825     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  5826*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 109
* EL150.cbl
  5828*                            COPY ERCACCT.
  5829******************************************************************
  5830*                                                                *
  5831*                                                                *
  5832*                            ERCACCT                             *
  5833*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5834*                            VMOD=2.031                          *
  5835*                                                                *
  5836*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5837*                                                                *
  5838*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5839*   VSAM ACCOUNT MASTER FILES.                                   *
  5840*                                                                *
  5841*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5842*                                                                *
  5843*   FILE TYPE = VSAM,KSDS                                        *
  5844*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5845*                                                                *
  5846*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5847*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5848*                                                                *
  5849*   LOG = NO                                                     *
  5850*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5851*                                                                *
  5852*                                                                *
  5853******************************************************************
  5854*                   C H A N G E   L O G
  5855*
  5856* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5857*-----------------------------------------------------------------
  5858*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5859* EFFECTIVE    NUMBER
  5860*-----------------------------------------------------------------
  5861* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5862* 092705    2005050300006  PEMA  ADD SPP LEASES
  5863* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5864* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5865* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5866* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5867* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5868******************************************************************
  5869
  5870 01  ACCOUNT-MASTER.
  5871     12  AM-RECORD-ID                      PIC XX.
  5872         88  VALID-AM-ID                      VALUE 'AM'.
  5873
  5874     12  AM-CONTROL-PRIMARY.
  5875         16  AM-COMPANY-CD                 PIC X.
  5876         16  AM-MSTR-CNTRL.
  5877             20  AM-CONTROL-A.
  5878                 24  AM-CARRIER            PIC X.
  5879                 24  AM-GROUPING.
  5880                     28 AM-GROUPING-PREFIX PIC XXX.
  5881                     28 AM-GROUPING-PRIME  PIC XXX.
  5882                 24  AM-STATE              PIC XX.
  5883                 24  AM-ACCOUNT.
  5884                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5885                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 110
* EL150.cbl
  5886             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5887                                           PIC X(19).
  5888             20  AM-CNTRL-B.
  5889                 24  AM-EXPIRATION-DT      PIC XX.
  5890                 24  FILLER                PIC X(4).
  5891             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5892                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5893
  5894     12  AM-CONTROL-BY-VAR-GRP.
  5895         16  AM-COMPANY-CD-A1              PIC X.
  5896         16  AM-VG-CARRIER                 PIC X.
  5897         16  AM-VG-GROUPING                PIC X(6).
  5898         16  AM-VG-STATE                   PIC XX.
  5899         16  AM-VG-ACCOUNT                 PIC X(10).
  5900         16  AM-VG-DATE.
  5901             20  AM-VG-EXPIRATION-DT       PIC XX.
  5902             20  FILLER                    PIC X(4).
  5903         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5904                                           PIC 9(11)      COMP-3.
  5905     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5906         16  FILLER                        PIC X(10).
  5907         16  AM-VG-KEY3.
  5908             20  AM-VG3-ACCOUNT            PIC X(10).
  5909             20  AM-VG3-EXP-DT             PIC XX.
  5910         16  FILLER                        PIC X(4).
  5911     12  AM-MAINT-INFORMATION.
  5912         16  AM-LAST-MAINT-DT              PIC XX.
  5913         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5914         16  AM-LAST-MAINT-USER            PIC X(4).
  5915         16  FILLER                        PIC XX.
  5916
  5917     12  AM-EFFECTIVE-DT                   PIC XX.
  5918     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5919
  5920     12  AM-PREV-DATES  COMP-3.
  5921         16  AM-PREV-EXP-DT                PIC 9(11).
  5922         16  AM-PREV-EFF-DT                PIC 9(11).
  5923
  5924     12  AM-REPORT-CODE-1                  PIC X(10).
  5925     12  AM-REPORT-CODE-2                  PIC X(10).
  5926
  5927     12  AM-CITY-CODE                      PIC X(4).
  5928     12  AM-COUNTY-PARISH                  PIC X(6).
  5929
  5930     12  AM-NAME                           PIC X(30).
  5931     12  AM-PERSON                         PIC X(30).
  5932     12  AM-ADDRS                          PIC X(30).
  5933     12  AM-CITY.
  5934         16  AM-ADDR-CITY                  PIC X(28).
  5935         16  AM-ADDR-STATE                 PIC XX.
  5936     12  AM-ZIP.
  5937         16  AM-ZIP-PRIME.
  5938             20  AM-ZIP-PRI-1ST            PIC X.
  5939                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5940             20  FILLER                    PIC X(4).
  5941         16  AM-ZIP-PLUS4                  PIC X(4).
  5942     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5943         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 111
* EL150.cbl
  5944         16  AM-CAN-POSTAL-2               PIC XXX.
  5945         16  FILLER                        PIC XXX.
  5946     12  AM-TEL-NO.
  5947         16  AM-AREA-CODE                  PIC 999.
  5948         16  AM-TEL-PRE                    PIC 999.
  5949         16  AM-TEL-NBR                    PIC 9(4).
  5950     12  AM-TEL-LOC                        PIC X.
  5951         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5952         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5953
  5954     12  AM-COMM-STRUCTURE.
  5955         16  AM-DEFN-1.
  5956             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5957                 24  AM-AGT.
  5958                     28  AM-AGT-PREFIX     PIC X(4).
  5959                     28  AM-AGT-PRIME      PIC X(6).
  5960                 24  AM-COM-TYP            PIC X.
  5961                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5962                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5963                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5964                 24  AM-RECALC-LV-INDIC    PIC X.
  5965                 24  AM-RETRO-LV-INDIC     PIC X.
  5966                 24  AM-GL-CODES           PIC X.
  5967                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5968                 24  FILLER                PIC X(01).
  5969         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5970             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5971                 24  FILLER                PIC X(11).
  5972                 24  AM-L-COMA             PIC XXX.
  5973                 24  AM-J-COMA             PIC XXX.
  5974                 24  AM-A-COMA             PIC XXX.
  5975                 24  FILLER                PIC X(6).
  5976
  5977     12  AM-COMM-CHANGE-STATUS             PIC X.
  5978         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5979
  5980     12  AM-CSR-CODE                       PIC X(4).
  5981
  5982     12  AM-BILLING-STATUS                 PIC X.
  5983         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5984         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5985     12  AM-AUTO-REFUND-SW                 PIC X.
  5986         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5987         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5988     12  AM-GPCD                           PIC 99.
  5989     12  AM-IG                             PIC X.
  5990         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5991         88  AM-HAS-GROUP                     VALUE '2'.
  5992     12  AM-STATUS                         PIC X.
  5993         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5994         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5995         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5996         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5997         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5998         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5999     12  AM-REMIT-TO                       PIC 99.
  6000     12  AM-ID-NO                          PIC X(11).
  6001
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 112
* EL150.cbl
  6002     12  AM-CAL-TABLE                      PIC XX.
  6003     12  AM-LF-DEVIATION                   PIC XXX.
  6004     12  AM-AH-DEVIATION                   PIC XXX.
  6005     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6006     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6007     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6008     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6009     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6010     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6011
  6012     12  AM-USER-FIELDS.
  6013         16  AM-FLD-1                      PIC XX.
  6014         16  AM-FLD-2                      PIC XX.
  6015         16  AM-FLD-3                      PIC XX.
  6016         16  AM-FLD-4                      PIC XX.
  6017         16  AM-FLD-5                      PIC XX.
  6018
  6019     12  AM-1ST-PROD-DATE.
  6020         16  AM-1ST-PROD-YR                PIC XX.
  6021         16  AM-1ST-PROD-MO                PIC XX.
  6022         16  AM-1ST-PROD-DA                PIC XX.
  6023     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6024     12  AM-CERTS-PURGED-DATE.
  6025         16  AM-PUR-YR                     PIC XX.
  6026         16  AM-PUR-MO                     PIC XX.
  6027         16  AM-PUR-DA                     PIC XX.
  6028     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6029     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6030     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6031     12  AM-INACTIVE-DATE.
  6032         16  AM-INA-MO                     PIC 99.
  6033         16  AM-INA-DA                     PIC 99.
  6034         16  AM-INA-YR                     PIC 99.
  6035     12  AM-AR-HI-CERT-DATE                PIC XX.
  6036
  6037     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6038     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6039
  6040     12  AM-OB-PAYMENT-MODE                PIC X.
  6041         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6042         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6043         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6044         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6045
  6046     12  AM-AH-ONLY-INDICATOR              PIC X.
  6047         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6048         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6049
  6050     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6051
  6052     12  AM-OVER-SHORT.
  6053         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6054         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6055
  6056     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6057     12  AM-DCC-CLP-STATE                  PIC XX.
  6058
  6059     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 113
* EL150.cbl
  6060     12  AM-RECALC-REIN                    PIC X.
  6061
  6062     12  AM-REI-TABLE                      PIC XXX.
  6063     12  AM-REI-ET-LF                      PIC X.
  6064     12  AM-REI-ET-AH                      PIC X.
  6065     12  AM-REI-PE-LF                      PIC X.
  6066     12  AM-REI-PE-AH                      PIC X.
  6067     12  AM-REI-PRT-ST                     PIC X.
  6068     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6069     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6070     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6071     12  AM-REI-GROUP-A                    PIC X(6).
  6072     12  AM-REI-MORT                       PIC X(4).
  6073     12  AM-REI-PRT-OW                     PIC X.
  6074     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6075     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6076     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6077     12  AM-REI-GROUP-B                    PIC X(6).
  6078
  6079     12  AM-TRUST-TYPE                     PIC X(2).
  6080
  6081     12  AM-EMPLOYER-STMT-USED             PIC X.
  6082     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6083
  6084     12  AM-STD-AH-TYPE                    PIC XX.
  6085     12  AM-EARN-METHODS.
  6086         16  AM-EARN-METHOD-R              PIC X.
  6087             88 AM-REF-RL-R78                 VALUE 'R'.
  6088             88 AM-REF-RL-PR                  VALUE 'P'.
  6089             88 AM-REF-RL-MEAN                VALUE 'M'.
  6090             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6091         16  AM-EARN-METHOD-L              PIC X.
  6092             88 AM-REF-LL-R78                 VALUE 'R'.
  6093             88 AM-REF-LL-PR                  VALUE 'P'.
  6094             88 AM-REF-LL-MEAN                VALUE 'M'.
  6095             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6096         16  AM-EARN-METHOD-A              PIC X.
  6097             88 AM-REF-AH-R78                 VALUE 'R'.
  6098             88 AM-REF-AH-PR                  VALUE 'P'.
  6099             88 AM-REF-AH-MEAN                VALUE 'M'.
  6100             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6101             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6102             88 AM-REF-AH-NET                 VALUE 'N'.
  6103
  6104     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6105     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6106     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6107
  6108     12  AM-RET-Y-N                        PIC X.
  6109     12  AM-RET-P-E                        PIC X.
  6110     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6111     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6112     12  AM-RET-GRP                        PIC X(6).
  6113     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6114         16  AM-POOL-PRIME                 PIC XXX.
  6115         16  AM-POOL-SUB                   PIC XXX.
  6116     12  AM-RETRO-EARNINGS.
  6117         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 114
* EL150.cbl
  6118         16  AM-RET-EARN-L                 PIC X.
  6119         16  AM-RET-EARN-A                 PIC X.
  6120     12  AM-RET-ST-TAX-USE                 PIC X.
  6121         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6122         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6123     12  AM-RETRO-BEG-EARNINGS.
  6124         16  AM-RET-BEG-EARN-R             PIC X.
  6125         16  AM-RET-BEG-EARN-L             PIC X.
  6126         16  AM-RET-BEG-EARN-A             PIC X.
  6127     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6128     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6129
  6130     12  AM-USER-SELECT-OPTIONS.
  6131         16  AM-USER-SELECT-1              PIC X(10).
  6132         16  AM-USER-SELECT-2              PIC X(10).
  6133         16  AM-USER-SELECT-3              PIC X(10).
  6134         16  AM-USER-SELECT-4              PIC X(10).
  6135         16  AM-USER-SELECT-5              PIC X(10).
  6136
  6137     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6138
  6139     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6140
  6141     12  AM-RPT045A-SWITCH                 PIC X.
  6142         88  RPT045A-OFF                   VALUE 'N'.
  6143
  6144     12  AM-INSURANCE-LIMITS.
  6145         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6146         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6147
  6148     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6149         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6150
  6151     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6152         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6153         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6154
  6155     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6156
  6157     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6158     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6159     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6160     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6161     12  AM-DCC-UEF-STATE                  PIC XX.
  6162     12  FILLER                            PIC XXX.
  6163     12  AM-REPORT-CODE-3                  PIC X(10).
  6164*    12  FILLER                            PIC X(22).
  6165
  6166     12  AM-RESERVE-DATE.
  6167         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6168         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6169         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6170
  6171     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6172     12  AM-NOTIFICATION-TYPES.
  6173         16  AM-NOTIF-OF-LETTERS           PIC X.
  6174         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6175         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 115
* EL150.cbl
  6176         16  AM-NOTIF-OF-STATUS            PIC X.
  6177
  6178     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6179         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6180         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6181         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6182         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6183
  6184     12  AM-BENEFIT-CONTROLS.
  6185         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6186             20  AM-BENEFIT-CODE           PIC XX.
  6187             20  AM-BENEFIT-TYPE           PIC X.
  6188             20  AM-BENEFIT-REVISION       PIC XXX.
  6189             20  AM-BENEFIT-REM-TERM       PIC X.
  6190             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6191             20  FILLER                    PIC XX.
  6192         16  FILLER                        PIC X(80).
  6193
  6194     12  AM-TRANSFER-DATA.
  6195         16  AM-TRANSFERRED-FROM.
  6196             20  AM-TRNFROM-CARRIER        PIC X.
  6197             20  AM-TRNFROM-GROUPING.
  6198                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6199                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6200             20  AM-TRNFROM-STATE          PIC XX.
  6201             20  AM-TRNFROM-ACCOUNT.
  6202                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6203                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6204             20  AM-TRNFROM-DTE            PIC XX.
  6205         16  AM-TRANSFERRED-TO.
  6206             20  AM-TRNTO-CARRIER          PIC X.
  6207             20  AM-TRNTO-GROUPING.
  6208                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6209                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6210             20  AM-TRNTO-STATE            PIC XX.
  6211             20  AM-TRNTO-ACCOUNT.
  6212                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6213                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6214             20  AM-TRNTO-DTE              PIC XX.
  6215         16  FILLER                        PIC X(10).
  6216
  6217     12  AM-SAVED-REMIT-TO                 PIC 99.
  6218
  6219     12  AM-COMM-STRUCTURE-SAVED.
  6220         16  AM-DEFN-1-SAVED.
  6221             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6222                 24  AM-AGT-SV             PIC X(10).
  6223                 24  AM-COM-TYP-SV         PIC X.
  6224                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6225                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6226                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6227                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6228                 24  FILLER                PIC X.
  6229                 24  AM-GL-CODES-SV        PIC X.
  6230                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6231                 24  FILLER                PIC X.
  6232         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6233             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 116
* EL150.cbl
  6234                 24  FILLER                PIC X(11).
  6235                 24  AM-L-COMA-SV          PIC XXX.
  6236                 24  AM-J-COMA-SV          PIC XXX.
  6237                 24  AM-A-COMA-SV          PIC XXX.
  6238                 24  FILLER                PIC X(6).
  6239
  6240     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6241         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6242            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6243            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6244            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6245
  6246     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6247     12  FILLER                            PIC X(120).
  6248
  6249     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6250         16  AM-CONTROL-NAME               PIC X(30).
  6251         16  AM-EXECUTIVE-ONE.
  6252             20  AM-EXEC1-NAME             PIC X(15).
  6253             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6254                                                          COMP-3.
  6255             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6256                                                          COMP-3.
  6257         16  AM-EXECUTIVE-TWO.
  6258             20  AM-EXEC2-NAME             PIC X(15).
  6259             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6260                                                          COMP-3.
  6261             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6262                                                          COMP-3.
  6263
  6264     12  AM-RETRO-ADDITIONAL-DATA.
  6265         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6266         16  AM-RETRO-PREM-P-E             PIC X.
  6267         16  AM-RETRO-CLMS-P-I             PIC X.
  6268         16  AM-RETRO-RET-BRACKET-LF.
  6269             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6270                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6271                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6272             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6273                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6274                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6275             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6276                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6277                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6278         16  AM-RETRO-RET-BRACKET-AH.
  6279             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6280                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6281                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6282                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6283             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6284                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6285                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6286             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6287                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6288                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6289
  6290     12  AM-COMMENTS.
  6291         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 117
* EL150.cbl
  6292
  6293     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6294         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6295         16  AM-FLI-BILLING-CODE           PIC X.
  6296         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6297         16  AM-FLI-UNITED-IDENT           PIC X.
  6298         16  AM-FLI-INTEREST-LOST-DATA.
  6299             20  AM-FLI-BANK-NO            PIC X(5).
  6300             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6301             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6302             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6303         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6304             20  AM-FLI-AGT                PIC X(9).
  6305             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6306             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6307         16  FILLER                        PIC X(102).
  6308
  6309     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6310         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6311             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6312             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6313             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6314             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6315             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6316         16  FILLER                          PIC X(10).
  6317******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 118
* EL150.cbl
  6319*                            COPY ELCARCH.
  6320******************************************************************
  6321*                                                                *
  6322*                            ELCARCH.                            *
  6323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6324*                            VMOD=2.007                          *
  6325*                                                                *
  6326*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6327*                                                                *
  6328*   FILE TYPE = VSAM,KSDS                                        *
  6329*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6330*                                                                *
  6331*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6332*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6333*                                                                *
  6334*   LOG = NO                                                     *
  6335*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6336*                                                                *
  6337*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6338******************************************************************
  6339 01  LETTER-ARCHIVE.
  6340     12  LA-RECORD-ID                PIC XX.
  6341         88  VALID-LA-ID                VALUE 'LA'.
  6342
  6343     12  LA-CONTROL-PRIMARY.
  6344         16  LA-COMPANY-CD           PIC X.
  6345         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6346         16  LA-RECORD-TYPE          PIC X.
  6347             88  LA-HEADER-DATA         VALUE '1'.
  6348             88  LA-ADDRESS-DATA        VALUE '2'.
  6349             88  LA-TEXT-DATA           VALUE '3'.
  6350             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6351         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6352
  6353     12  LA-CONTROL-BY-TYPE.
  6354         16  LA-COMPANY-CD-A1        PIC X.
  6355         16  LA-RECORD-TYPE-A1       PIC X.
  6356         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6357         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6358
  6359     12  LA-TEXT-RECORD.
  6360         16  LA-SKIP-CONTROL         PIC XX.
  6361             88  NO-LINES-SKIPPED       VALUE SPACES.
  6362             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6363         16  LA-TEXT-LINE            PIC X(70).
  6364
  6365     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6366         16  FILLER                  PIC XX.
  6367         16  LA-ADDRESS-LINE         PIC X(30).
  6368         16  FILLER                  PIC X(40).
  6369
  6370     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6371         16  FILLER                  PIC XX.
  6372         16  LA-CARRIER              PIC X.
  6373         16  LA-CLAIM-NO             PIC X(7).
  6374         16  LA-CERT-NO.
  6375             20  LA-CERT-PRIME       PIC X(10).
  6376             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 119
* EL150.cbl
  6377         16  LA-NO-OF-COPIES         PIC S9.
  6378         16  LA-RESEND-DATE          PIC XX.
  6379         16  LA-PROCESSOR-CD         PIC X(4).
  6380         16  LA-CREATION-DT          PIC XX.
  6381         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6382         16  LA-RESEND-PRINT-DATE    PIC XX.
  6383         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6384         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6385*
  6386* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6387*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6388*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6389*   I        20  LA-DMD-RES-ST           PIC XX.
  6390*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6391*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6392*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6393*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6394*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6395*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6396*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6397*   I        20  LA-DMD-UND-CODE         PIC XX.
  6398*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6399*   V    16  FILLER                  PIC X(15).
  6400* -----
  6401*
  6402* REINSERTED  CSO  MODS
  6403*
  6404         16  FILLER.
  6405             20  FILLER                  PIC X(29).
  6406             20  LA-CSO-LETTER-STATUS    PIC X.
  6407                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6408                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6409                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6410             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6411             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6412*
  6413
  6414     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6415         16  FILLER                  PIC XX.
  6416         16  LA4-CARRIER             PIC X.
  6417         16  LA4-CLAIM-NO            PIC X(7).
  6418         16  LA4-CERT-NO.
  6419             20  LA4-CERT-PRIME      PIC X(10).
  6420             20  LA4-CERT-SFX        PIC X.
  6421         16  LA4-NO-OF-COPIES        PIC S9.
  6422         16  LA4-RESEND-DATE         PIC XX.
  6423         16  LA4-PROCESSOR-CD        PIC X(4).
  6424         16  LA4-CREATION-DT         PIC XX.
  6425         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6426         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6427         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6428         16  LA4-FORM-TYPE           PIC X.
  6429             88  LA4-INITIAL-FORM    VALUE '1'.
  6430             88  LA4-PROGRESS-FORM   VALUE '2'.
  6431         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6432         16  LA4-STATE               PIC X(02).
  6433         16  FILLER                  PIC X(31).
  6434******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 120
* EL150.cbl
  6435*                            copy ELCCRTT.
  6436******************************************************************
  6437*                                                                *
  6438*                            ELCCRTT.                            *
  6439*                                                                *
  6440*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  6441*                                                                *
  6442*   FILE TYPE = VSAM,KSDS                                        *
  6443*   RECORD SIZE = 552  RECFORM = FIXED                           *
  6444*                                                                *
  6445*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  6446*                                                                *
  6447*   LOG = YES                                                    *
  6448*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6449******************************************************************
  6450*                   C H A N G E   L O G
  6451*
  6452* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6453*-----------------------------------------------------------------
  6454*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6455* EFFECTIVE    NUMBER
  6456*-----------------------------------------------------------------
  6457* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  6458* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  6459* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  6460* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  6461* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  6462* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  6463* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  6464******************************************************************
  6465
  6466 01  CERTIFICATE-TRAILERS.
  6467     12  CS-RECORD-ID                      PIC XX.
  6468         88  VALID-CS-ID                      VALUE 'CS'.
  6469
  6470     12  CS-CONTROL-PRIMARY.
  6471         16  CS-COMPANY-CD                 PIC X.
  6472         16  CS-CARRIER                    PIC X.
  6473         16  CS-GROUPING                   PIC X(6).
  6474         16  CS-STATE                      PIC XX.
  6475         16  CS-ACCOUNT                    PIC X(10).
  6476         16  CS-CERT-EFF-DT                PIC XX.
  6477         16  CS-CERT-NO.
  6478             20  CS-CERT-PRIME             PIC X(10).
  6479             20  CS-CERT-SFX               PIC X.
  6480         16  CS-TRAILER-TYPE               PIC X.
  6481             88  COMM-TRLR           VALUE 'A'.
  6482             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  6483             88  CERT-DATA-TRLR      VALUE 'C'.
  6484
  6485     12  CS-DATA-AREA                      PIC X(516).
  6486
  6487     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  6488         16  CS-BANK-COMMISSION-AREA.
  6489             20  CS-BANK-COMMS       OCCURS 10.
  6490                 24  CS-AGT                PIC X(10).
  6491                 24  CS-COM-TYP            PIC X.
  6492                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 121
* EL150.cbl
  6493                 24  CS-RECALC-LV-INDIC    PIC X.
  6494                 24  FILLER                PIC X(10).
  6495         16  FILLER                        PIC X(256).
  6496
  6497     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  6498****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  6499         16  CS-MB-CLAIM-DATA OCCURS 24.
  6500             20  CS-CLAIM-NO               PIC X(7).
  6501             20  CS-CLAIM-TYPE             PIC X.
  6502                 88  CS-AH-CLM               VALUE 'A'.
  6503                 88  CS-IU-CLM               VALUE 'I'.
  6504                 88  CS-GP-CLM               VALUE 'G'.
  6505                 88  CS-LF-CLM               VALUE 'L'.
  6506                 88  CS-PR-CLM               VALUE 'P'.
  6507                 88  CS-FL-CLM               VALUE 'F'.
  6508             20  CS-INSURED-TYPE           PIC X.
  6509                 88  CS-PRIM-INSURED          VALUE 'P'.
  6510                 88  CS-CO-BORROWER           VALUE 'C'.
  6511             20  CS-BENEFIT-PERIOD         PIC 99.
  6512             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  6513             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  6514             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  6515         16  FILLER                        PIC X(12).
  6516     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  6517         16  CS-VIN-NUMBER                 PIC X(17).
  6518         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  6519         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  6520         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  6521         16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 122
* EL150.cbl
  6523*                COPY MTCPLCY REPLACING ==:TAG:== BY ==PM==.
  6524******************************************************************
  6525*                                                                *
  6526*                           MTCPLCY                              *
  6527*                            VMOD=1.003                          *
  6528*                                                                *
  6529*   FILE DESCRIPTION = POLICY MASTER                             *
  6530*                                                                *
  6531*   FILE TYPE = VSAM,KSDS                                        *
  6532*   RECORD SIZE = 1200 RECFORM = FIXED                           *
  6533*                                                                *
  6534*   BASE CLUSTER = MPPLCY                         RKP=2,LEN=42   *
  6535*       ALTERNATE PATH2 = ** NOT USED **                         *
  6536*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  6537*       ALTERNATE PATH4 = MPPLCY4 (BY REF. NO.)   RKP=60,LEN=25  *
  6538*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT )   RKP=85,LEN=27  *
  6539*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT )   RKP=112,LEN=15 *
  6540*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO.)   RKP=127,LEN=27 *
  6541*                                                                *
  6542*   LOG = YES                                                    *
  6543*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6544******************************************************************
  6545**WARNING*********************************************************
  6546**ANY CHANGES TO THIS COPY BOOK MAY NEED CORRESPONDING CHANGES****
  6547**TO THE FOLLOWING COPY BOOKS: MPCPOLUP                          *
  6548**                             MPCPHSTD                          *
  6549**                             MPCPHSTC                          *
  6550**                             MPCPHSTT                          *
  6551**                                                               *
  6552******************************************************************
  6553
  6554 01  POLICY-MASTER.
  6555     12  PM-RECORD-ID                   PIC XX.
  6556         88  VALID-PM-ID                      VALUE 'PM'.
  6557
  6558******************************************************************
  6559*   BASE CLUSTER = MPPLCY         (BASE KEY)      RKP=2,LEN=42   *
  6560******************************************************************
  6561
  6562     12  PM-CONTROL-PRIMARY.
  6563         16  PM-PRODUCER-PRIMARY.
  6564             20  PM-PROD-PRIMARY.
  6565                 24  PM-COMPANY-CD      PIC X.
  6566                 24  PM-CGSP-KEY.
  6567                     28  PM-CARRIER     PIC X.
  6568                     28  PM-GROUPING.
  6569                         32  PM-GROUPING-PREFIX
  6570                                           PIC X(3).
  6571                         32  PM-GROUPING-PRIME
  6572                                           PIC X(3).
  6573                     28  PM-STATE       PIC XX.
  6574                     28  PM-PRODUCER.
  6575                         32  PM-PRODUCER-PREFIX
  6576                                           PIC X(4).
  6577                         32  PM-PRODUCER-PRIME
  6578                                           PIC X(6).
  6579             20  PM-POLICY-EFF-DT       PIC XX.
  6580         16  PM-REFERENCE-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 123
* EL150.cbl
  6581             20  PM-REFNO-PRIME         PIC X(18).
  6582             20  PM-REFNO-SFX           PIC XX.
  6583
  6584******************************************************************
  6585*       ALTERNATE PATH3 = MPPLCY3 (BY INSD SS NO) RKP=44,LEN=16  *
  6586******************************************************************
  6587
  6588     12  PM-CONTROL-BY-SSN.
  6589         16  PM-COMPANY-CD-A3           PIC X.
  6590         16  PM-SOC-SEC-NO.
  6591             20  PM-SSN-STATE           PIC XX.
  6592             20  PM-SSN-PRODUCER        PIC X(6).
  6593             20  PM-SSN-LN3.
  6594                 25  PM-INSURED-INITIALS-A3.
  6595                     30 PM-INSURED-INITIAL1-A3 PIC X.
  6596                     30 PM-INSURED-INITIAL2-A3 PIC X.
  6597                 25 PM-PART-LAST-NAME-A3      PIC X.
  6598         16  PM-DATE-A3                  PIC XX.
  6599         16  PM-TIME-A3                  PIC S9(04)   COMP.
  6600
  6601******************************************************************
  6602*       ALTERNATE PATH4 = MPPLCY4 (BY REFRENCE)   RKP=60,LEN=25  *
  6603******************************************************************
  6604
  6605     12  PM-CONTROL-BY-POLICY-NO.
  6606         16  PM-COMPANY-CD-A4           PIC X.
  6607         16  PM-POLICY-NO-A4.
  6608             20  PM-POLICY-PRIME-A4     PIC X(18).
  6609             20  PM-POLICY-SFX-A4       PIC XX.
  6610         16  PM-DATE-A4                 PIC XX.
  6611         16  PM-TIME-A4                 PIC S9(04)   COMP.
  6612
  6613******************************************************************
  6614*       ALTERNATE PATH5 = MPPLCY5 (BY ACCOUNT NO) RKP=85,LEN=27  *
  6615******************************************************************
  6616
  6617     12  PM-CONTROL-BY-ACCOUNT.
  6618         16  PM-COMPANY-CD-A5           PIC X.
  6619         16  PM-BANK-ACCOUNT-NUMBER     PIC X(20).
  6620         16  PM-DATE-A5                 PIC XX.
  6621         16  PM-TIME-A5                 PIC S9(07)   COMP.
  6622
  6623******************************************************************
  6624*       ALTERNATE PATH6 = MPPLCY6 (BY TRANSIT NO) RKP=112,LEN=15 *
  6625******************************************************************
  6626
  6627     12  PM-CONTROL-BY-TRANSIT.
  6628         16  PM-COMPANY-CD-A6           PIC X.
  6629         16  PM-BANK-TRANSIT-NUMBER.
  6630             20  PM-FEDERAL-NUMBER      PIC X(4).
  6631             20  PM-BANK-NUMBER         PIC X(4).
  6632         16  PM-DATE-A6                 PIC XX.
  6633         16  PM-TIME-A6                 PIC S9(07)   COMP.
  6634
  6635******************************************************************
  6636*       ALTERNATE PATH7 = MPPLCY7 (BY LOAN NO)    RKP=127,LEN=27 *
  6637******************************************************************
  6638
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 124
* EL150.cbl
  6639     12  PM-CONTROL-BY-LOAN-NO.
  6640         16  PM-COMPANY-CD-A7           PIC X.
  6641         16  PM-LOAN-NUMBER             PIC X(20).
  6642         16  PM-DATE-A7                 PIC XX.
  6643         16  PM-TIME-A7                 PIC S9(07)   COMP.
  6644
  6645******************************************************************
  6646*                 FILE SYNCHRONIZATION DATA                      *
  6647******************************************************************
  6648
  6649     12  FILLER                            PIC X(05).
  6650     12  PM-FILE-SYNCH-DATA.
  6651         16  PM-LAST-CHANGE-DT          PIC XX.
  6652         16  PM-LAST-CHANGE-TIME        PIC S9(7)    COMP.
  6653         16  PM-LAST-CHANGE-PROCESSOR   PIC X(4).
  6654     12  FILLER                            PIC X(05).
  6655
  6656******************************************************************
  6657*                    INSUREDS PROFILE DATA                       *
  6658******************************************************************
  6659
  6660     12  PM-INSURED-PROFILE-DATA.
  6661         16  PM-INSURED-NAME.
  6662             20  PM-INSURED-LAST-NAME  PIC X(15).
  6663             20  PM-INSURED-FIRST-NAME.
  6664                 24  PM-INSURED-1ST-INIT PIC X.
  6665                 24  FILLER               PIC X(9).
  6666             20  PM-INSURED-MIDDLE-INIT PIC X.
  6667         16  PM-INSURED-ADDRESS.
  6668             20  PM-ADDRESS-LINE-1      PIC X(30).
  6669             20  PM-ADDRESS-LINE-2      PIC X(30).
  6670             20  PM-CITY                PIC X(25).
  6671             20  PM-RESIDENT-STATE      PIC XX.
  6672             20  PM-ZIP-CD.
  6673                 24  PM-ZIP-FIRST-FIVE  PIC X(5).
  6674                 24  PM-ZIP-PLUS-FOUR   PIC X(4).
  6675         16  PM-INSURED-PERSONAL.
  6676             20  PM-INSURED-OCC-CLASS   PIC X.
  6677                 88  PM-PREFERRED         VALUE '1'.
  6678                 88  PM-STANDARD          VALUE '2'.
  6679                 88  PM-HAZARDOUS         VALUE '3'.
  6680                 88  PM-VERY-HAZARDOUS    VALUE '4'.
  6681                 88  PM-EXTREME-HAZARDOUS VALUE '5'.
  6682                 88  PM-NOT-OCC           VALUE '6'.
  6683                 88  PM-OCC-UNKNOWN       VALUE '9'.
  6684             20  PM-INSURED-OCC-CD      PIC X(3).
  6685             20  PM-INSURED-OCC-CD-NUM REDEFINES
  6686                 PM-INSURED-OCC-CD      PIC 9(3).
  6687             20  PM-INSURED-SEX         PIC X.
  6688                 88  PM-INSURED-SEX-MALE   VALUE 'M'.
  6689                 88  PM-INSURED-SEX-FEMALE VALUE 'F'.
  6690             20  PM-INSURED-BIRTH-DT    PIC XX.
  6691             20  PM-INSURED-ISSUE-AGE   PIC S9(3)     COMP-3.
  6692             20  PM-INSURED-HEIGHT-FT   PIC S9(3)     COMP-3.
  6693             20  PM-INSURED-HEIGHT-IN   PIC S9(3)     COMP-3.
  6694             20  PM-INSURED-WEIGHT      PIC S9(3)     COMP-3.
  6695             20  PM-INSURED-BIRTH-STATE PIC XX.
  6696             20  PM-INSURED-PHONE-NO    PIC X(13).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 125
* EL150.cbl
  6697             20  PM-INSURED-RATED-AGE   PIC S9(3)     COMP-3.
  6698         16  PM-INS-LANGUAGE-IND        PIC X(01).
  6699             88  PM-ENGLISH                        VALUE 'E'.
  6700             88  PM-FRENCH                         VALUE 'F'.
  6701             88  PM-SPANISH                        VALUE 'S'.
  6702         16  PM-INSURED-TOT-BENEFIT     PIC S9(7)V99  COMP-3.
  6703
  6704         16  PM-INSURED-AGE-IND         PIC X(01).
  6705             88  PM-INSURED-AGE-75-REACHED         VALUE 'Y'.
  6706     12  FILLER                            PIC X(13).
  6707
  6708******************************************************************
  6709*                JOINT INSUREDS PROFILE DATA                     *
  6710******************************************************************
  6711
  6712     12  PM-JOINT-PROFILE-DATA.
  6713         16  PM-JOINT-NAME.
  6714             20  PM-JOINT-LAST-NAME     PIC X(15).
  6715             20  PM-JOINT-FIRST-NAME.
  6716                 24  PM-JOINT-1ST-INIT  PIC X.
  6717                 24  FILLER                PIC X(9).
  6718             20  PM-JOINT-MIDDLE-INIT   PIC X.
  6719         16  PM-JOINT-SOC-SEC-NO.
  6720             20  PM-JT-SSN-STATE        PIC XX.
  6721             20  PM-JT-SSN-PRODUCER     PIC X(6).
  6722             20  PM-JT-SSN-LN3.
  6723                 25  PM-JT-INSURED-INITIALS-A3.
  6724                     30 PM-JT-INSURED-INITIAL1-A3 PIC X.
  6725                     30 PM-JT-INSURED-INITIAL2-A3 PIC X.
  6726                 25 PM-JT-PART-LAST-NAME-A3     PIC X.
  6727         16  PM-JOINT-PERSONAL.
  6728             20  PM-JOINT-OCC-CLASS     PIC X.
  6729                 88 PM-JNT-PREFERRED       VALUE '1'.
  6730                 88 PM-JNT-STANDARD        VALUE '2'.
  6731                 88 PM-JNT-HAZARDOUS       VALUE '3'.
  6732                 88 PM-JNT-VERY-HAZARDOUS  VALUE '4'.
  6733                 88 PM-JNT-EXTREME-HAZARDOUS VALUE '5'.
  6734                 88 PM-JNT-NOT-OCC         VALUE '6'.
  6735                 88 PM-JNT-OCC-UNKNOWN     VALUE '9'.
  6736             20  PM-JOINT-OCC-CD        PIC X(3).
  6737             20  PM-JOINT-SEX           PIC X.
  6738                 88  PM-JOINT-SEX-MALE     VALUE 'M'.
  6739                 88  PM-JOINT-SEX-FEMALE   VALUE 'F'.
  6740             20  PM-JOINT-BIRTH-DT      PIC XX.
  6741             20  PM-JOINT-ISSUE-AGE     PIC S9(3)     COMP-3.
  6742             20  PM-JOINT-HEIGHT-FT     PIC S9(3)     COMP-3.
  6743             20  PM-JOINT-HEIGHT-IN     PIC S9(3)     COMP-3.
  6744             20  PM-JOINT-WEIGHT        PIC S9(3)     COMP-3.
  6745             20  PM-JOINT-BIRTH-STATE   PIC XX.
  6746             20  PM-JOINT-RATED-AGE     PIC S9(3)     COMP-3.
  6747         16  PM-JOINT-TOT-BENEFIT       PIC S9(7)V99  COMP-3.
  6748         16  PM-JOINT-AGE-IND           PIC X(01).
  6749             88  PM-JOINT-AGE-75-REACHED           VALUE 'Y'.
  6750
  6751     12  FILLER                            PIC X(12).
  6752
  6753******************************************************************
  6754*                  INSURANCE COVERAGE DATA                       *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 126
* EL150.cbl
  6755******************************************************************
  6756
  6757     12  PM-INS-COVERAGE-DATA.
  6758         16  PM-FREE-PERIOD             PIC S9(03)    COMP-3.
  6759         16  PM-LOAN-TERM               PIC S9(3)     COMP-3.
  6760         16  PM-LOAN-APR                PIC S9V9999   COMP-3.
  6761         16  PM-LOAN-DT                 PIC XX.
  6762         16  PM-LOAN-PYMT               PIC S9(5)V99  COMP-3.
  6763         16  PM-LOAN-BALC               PIC S9(7)V99  COMP-3.
  6764         16  PM-INS-BENEFIT-MONTHS      PIC S9(3)     COMP-3.
  6765         16  PM-INS-MONTH-BENEFIT       PIC S9(7)V99  COMP-3.
  6766         16  PM-INS-TOTAL-BENEFIT       PIC S9(7)V99  COMP-3.
  6767         16  PM-INS-PLAN-TYPE           PIC X.
  6768             88  PM-AH-MORT-PLAN           VALUE 'A'.
  6769             88  PM-AD-D-MORT-PLAN         VALUE 'E'.
  6770             88  PM-DISMEM-MORT-PLAN       VALUE 'D'.
  6771             88  PM-LIFE-MORT-PLAN         VALUE 'L'.
  6772         16  PM-INS-PLAN-CD             PIC XX.
  6773         16  PM-INS-PLAN-REVISION       PIC X(3).
  6774         16  PM-INS-POLICY-FORM         PIC X(12).
  6775         16  PM-INS-MSTR-POLICY.
  6776             20  PM-FREE-TYPE           PIC X(04).
  6777             20  FILLER                    PIC X(08).
  6778         16  PM-INS-MSTR-APP.
  6779             20  FILLER                    PIC X(11).
  6780             20  PM-INS-B-C-TYPE        PIC X(01).
  6781         16  PM-INS-RATE-CD             PIC X(5).
  6782         16  PM-INS-SEX-RATING          PIC X.
  6783             88  PM-NOT-SEX-RATED           VALUE '1'.
  6784             88  PM-SEX-RATED               VALUE '2'.
  6785         16  PM-INS-SUBSTANDARD-PCT     PIC S9V9999   COMP-3.
  6786         16  PM-INS-SUBSTANDARD-TYPE    PIC X.
  6787         16  PM-INS-TERMINATION-DT      PIC XX.
  6788         16  PM-INS-MONTH-PREMIUM   PIC S9(5)V999999  COMP-3.
  6789         16  PM-INS-CALC-MO-PREM    PIC S9(5)V999999  COMP-3.
  6790         16  PM-REINSURANCE-TABLE       PIC X(3).
  6791         16  PM-MORTALITY-CD            PIC X(4).
  6792         16  PM-INS-TYPE                PIC X.
  6793             88  PM-INDIVIDUAL             VALUES ARE '1' 'I'.
  6794             88  PM-GROUP                  VALUES ARE '2' 'G'.
  6795         16  PM-LOAN-OFFICER            PIC X(5).
  6796         16  PM-POLICY-FEE              PIC S9(3)V99 COMP-3.
  6797         16  PM-DEPENDENT-COUNT         PIC S99      COMP-3.
  6798         16  PM-CWA-AMOUNT              PIC S9(5)V99  COMP-3.
  6799         16  PM-LAST-AUTO-RERATE-DT     PIC XX.
  6800         16  PM-PREM-FINANCED-SW        PIC X.
  6801             88  PM-PREM-FINANCED           VALUE 'Y'.
  6802             88  PM-PREM-NOT-FINANCED       VALUE 'N'.
  6803
  6804         16  PM-INS-TERM-LETTER-IND     PIC X.
  6805             88  PM-TERM-INITIALIZED        VALUE 'Y'.
  6806         16  PM-INS-UNDERWRITER-MAX-BEN PIC S9(7)V99  COMP-3.
  6807     12  FILLER                            PIC X(11).
  6808
  6809******************************************************************
  6810*                    POLICY BILLING DATA                         *
  6811******************************************************************
  6812
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 127
* EL150.cbl
  6813     12  PM-BILLING-DATA.
  6814         16  PM-BILLING-MODE            PIC X(1).
  6815             88  PM-ANNUAL                 VALUE '1'.
  6816             88  PM-SEMI-ANNUAL            VALUE '2'.
  6817             88  PM-QUARTERLY              VALUE '3'.
  6818             88  PM-MONTHLY                VALUE '4'.
  6819             88  PM-BI-MONTHLY             VALUE '5'.
  6820             88  PM-SINGLE-PREM            VALUE '6'.
  6821         16  PM-BILLING-SCHEDULE        PIC X(1).
  6822         16  PM-BILLING-SW              PIC X(1).
  6823             88  PM-FIRST-BILLING          VALUE 'Y'.
  6824             88  PM-PAID-IN-ADVANCE        VALUE 'A'.
  6825             88  PM-POLICY-FEE-REFUNDED    VALUE 'F'.
  6826         16  PM-BILLING-TYPE            PIC X(1).
  6827             88  PM-LIST-BILL              VALUE '1'.
  6828             88  PM-TAPE-BILL              VALUE '2'.
  6829             88  PM-TAPE-LIST-BILL         VALUE '3'.
  6830             88  PM-GROUP-BILL       VALUE ARE '1' '2' '3'.
  6831             88  PM-DIRECT-BILL            VALUE '4'.
  6832             88  PM-PAC-BILL         VALUE ARE '5' 'C' 'S'.
  6833             88  PM-CHARGE-CARD-BILL       VALUE '6'.
  6834             88  PM-INDIV-BILL
  6835                                  VALUE ARE '4' '5' '6' 'C' 'S'.
  6836             88  PM-GRP-PLCY-BILL          VALUE '7'.
  6837             88  PM-GRP-PLCY-PAC           VALUE '8'.
  6838             88  PM-GRP-PLCY-CR-CRD        VALUE '9'.
  6839             88  PM-GRP-PLCY         VALUE ARE '7' '8' '9'.
  6840             88  PM-GRP-PROD               VALUE 'A'.
  6841             88  PM-EFT-CHECKING           VALUE 'C'.
  6842             88  PM-EFT-SAVINGS            VALUE 'S'.
  6843         16  PM-PAYMENT-AMT             PIC S9(5)V99  COMP-3.
  6844         16  PM-OVER-SHORT-AMT          PIC S9(5)V99  COMP-3.
  6845         16  PM-LAST-BILL-DT            PIC XX.
  6846         16  PM-LAST-BILL-AMT           PIC S9(5)V99  COMP-3.
  6847         16  PM-BILL-TO-DT              PIC XX.
  6848         16  PM-LAST-PYMT-DT            PIC XX.
  6849         16  PM-PAID-TO-DT              PIC XX.
  6850         16  PM-PYMT-INVOICE-NUMBER     PIC X(6).
  6851         16  PM-MONTHS-PAID             PIC S9(3)     COMP-3.
  6852         16  PM-TOTAL-PREM-RECVD        PIC S9(7)V99  COMP-3.
  6853         16  PM-BILLING-GROUPING-CODE   PIC X(6).
  6854         16  PM-CHARGE-CARD-EXP-DT      PIC X(2).
  6855         16  PM-CHARGE-CARD-TYPE        PIC X(2).
  6856             88  PM-VISA                   VALUE 'VI'.
  6857             88  PM-MSTR-CARD              VALUE 'MC'.
  6858             88  PM-DINERS-CLUB            VALUE 'DN'.
  6859             88  PM-DISCOVER               VALUE 'DS'.
  6860             88  PM-CARTE-BLANCHE          VALUE 'CB'.
  6861             88  PM-AMERICAN-EXPRESS       VALUE 'AE'.
  6862         16  PM-BILL-INVOICE-NUMBER     PIC X(6).
  6863         16  PM-BILL-DAY                PIC S99       COMP-3.
  6864         16  PM-RES-PREM-TAX        PIC S9(3)V999999  COMP-3.
  6865     12  FILLER                            PIC X(15).
  6866
  6867******************************************************************
  6868*                     CLAIM PAYMENT DATA                         *
  6869******************************************************************
  6870
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 128
* EL150.cbl
  6871     12  PM-CLAIM-PAYMENT-DATA.
  6872         16  PM-CLAIM-BENEFICIARY-NAME  PIC X(25).
  6873         16  PM-CLAIM-INTERFACE-SW      PIC X.
  6874             88  PM-NO-CLAIM-ATTACHED      VALUE SPACE.
  6875             88  PM-POLICY-AND-CLAIM-ONLINE VALUE '1'.
  6876             88  PM-POLICY-CREATED-FOR-CLAIM VALUE '2'.
  6877             88  PM-CLAIM-CLOSED           VALUE '3'.
  6878             88  PM-ACTIVE-CLAIM           VALUE '1' '2'.
  6879             88  PM-CLAIM-ATTACHED         VALUE '1' '2' '3'.
  6880         16  PM-CLAIM-INCURRED-DT       PIC XX.
  6881         16  PM-CLAIM-PAID-TO-DT        PIC XX.
  6882         16  PM-CLAIM-PAYMENT-CNT       PIC S9(3)     COMP-3.
  6883         16  PM-CLAIM-LAST-PAYMENT-AMT  PIC S9(7)V99  COMP-3.
  6884         16  PM-CLAIM-EXPENSES-ITD      PIC S9(7)V99  COMP-3.
  6885         16  PM-CLAIM-PAYMENTS-ITD      PIC S9(7)V99  COMP-3.
  6886         16  PM-CLAIM-ACCUMULATOR       PIC S9(7)V99  COMP-3.
  6887         16  PM-CLAIM-ATTACH-CNT        PIC S9(3)     COMP-3.
  6888         16  PM-CLAIM-LIFE-ITD          PIC S9(7)V99  COMP-3.
  6889         16  PM-CLAIM-AH-ITD            PIC S9(7)V99  COMP-3.
  6890         16  PM-CLAIM-RIDER-ITD         PIC S9(7)V99  COMP-3.
  6891
  6892     12  FILLER                            PIC X(03).
  6893
  6894******************************************************************
  6895*                POLICY STATUS AND DISPOSITION                   *
  6896******************************************************************
  6897
  6898     12  PM-STATUS-DISPOSITION-DATA.
  6899         16  PM-ISSUE-EOM-DT            PIC XX.
  6900         16  PM-REPLACEMENT-SWITCH      PIC X.
  6901         16  PM-APPL-SIGN-DT            PIC XX.
  6902         16  PM-UNDERWRITER             PIC X(3).
  6903         16  PM-ENTRY-PROCESSOR         PIC X(4).
  6904         16  PM-ENTRY-STATUS            PIC X.
  6905             88  PM-NORMAL                 VALUE '1'.
  6906             88  PM-TAKE-OVER              VALUE '2'.
  6907             88  PM-CONVERSION             VALUE '4'.
  6908             88  PM-RE-ISSUE               VALUE '5'.
  6909             88  PM-REINSURANCE-ONLY       VALUE '9'.
  6910         16  PM-ENTRY-DT                PIC XX.
  6911         16  PM-ENTRY-TIME              PIC S9(7) COMP-3.
  6912         16  PM-EXIT-DT                 PIC XX.
  6913         16  PM-CURRENT-STATUS          PIC X.
  6914             88  PM-LAPSE                  VALUE '0'.
  6915             88  PM-ACTIVE                 VALUE '1'.
  6916             88  PM-PENDING-ISSUE          VALUE '2'.
  6917             88  PM-DECLINED               VALUE '3'.
  6918             88  PM-PENDING-CANCEL         VALUE '4'.
  6919             88  PM-PENDING-ISSUE-ERROR    VALUE '5'.
  6920             88  PM-CLAIM-APPLIED          VALUE '6'.
  6921             88  PM-CANCEL                 VALUE '7'.
  6922             88  PM-PENDING-UNWTR-REVW     VALUE '8'.
  6923             88  PM-PENDING-CANCEL-ERROR   VALUE '9'.
  6924             88  PM-CANCEL-TRANSFER        VALUE 'C'.
  6925             88  PM-CLAIM-SETTLEMENT       VALUE 'F'.
  6926             88  PM-TERMINATE              VALUE 'T'.
  6927** NOTE TYPE 1 IS ANYTHING THAT IS OR HAS BEEN ACTIVE.  TYPE 2 IS
  6928** EVERYTHING ELSE.  IF YOU ADD A STATUS ADD THE VALUE TO ONE OF
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 129
* EL150.cbl
  6929** THESE GROUPS.
  6930             88  PM-TYPE-STAT-1
  6931                     VALUES ARE '0' '1' '4' '6' '7' '9'
  6932                                'C' 'F' 'T'.
  6933             88  PM-TYPE-STAT-2
  6934                     VALUES ARE '2' '3' '5' '8'.
  6935             88  PM-BILLABLE-STATUS VALUES ARE '0' '1' '6'.
  6936             88  PM-PENDING-STATUS
  6937                                VALUES ARE '2' '4' '5' '8' '9'.
  6938             88  PM-PENDING-ISSUE-STATUS
  6939                                VALUES ARE '2' '5' '8'.
  6940             88  PM-CANCEL-STATUS
  6941                                VALUES ARE '4' '7' '9' 'C'.
  6942         16  PM-CANCEL-CAUSE-CD         PIC X(3).
  6943         16  PM-CANCEL-DT               PIC XX.
  6944         16  PM-REFUND-AMT              PIC S9(5)V99  COMP-3.
  6945         16  PM-CALC-REFUND-AMT         PIC S9(5)V99  COMP-3.
  6946         16  PM-DECLINE-CD              PIC X(3).
  6947         16  PM-DECLINE-DT              PIC XX.
  6948         16  PM-LAST-LAPSE-DT           PIC XX.
  6949         16  PM-LAST-REINSTATE-DT       PIC XX.
  6950         16  PM-SECURITY-ACCESS-CODE    PIC X.
  6951         16  PM-PREV-CONTROL-PRIMARY.
  6952             20  PM-PREV-COMPANY-CD          PIC X.
  6953             20  PM-PREV-CARRIER             PIC X.
  6954             20  PM-PREV-GROUPING.
  6955                 24  PM-PREV-GROUPING-PREFIX PIC X(3).
  6956                 24  PM-PREV-GROUPING-PRIME  PIC X(3).
  6957             20  PM-PREV-STATE               PIC XX.
  6958             20  PM-PREV-PRODUCER.
  6959                 24  PM-PREV-PRODUCER-PREFIX PIC X(4).
  6960                 24  PM-PREV-PRODUCER-PRIME  PIC X(6).
  6961             20  PM-PREV-POLICY-EFF-DT       PIC XX.
  6962             20  PM-PREV-REFERENCE-NUMBER.
  6963                 24  PM-PREV-REFNO-PRIME     PIC X(18).
  6964                 24  PM-PREV-REFNO-SFX       PIC XX.
  6965         16  PM-ACTION-DT               PIC XX.
  6966         16  PM-ACTION-CODE             PIC X(3).
  6967         16  PM-ACTION-DT-2             PIC XX.
  6968         16  PM-ACTION-CODE-2           PIC X(3).
  6969         16  PM-ACTION-DT-3             PIC XX.
  6970         16  PM-ACTION-CODE-3           PIC X(3).
  6971         16  PM-ACTION-DT-4             PIC XX.
  6972         16  PM-ACTION-CODE-4           PIC X(3).
  6973         16  PM-ACTION-DT-5             PIC XX.
  6974         16  PM-ACTION-CODE-5           PIC X(3).
  6975
  6976         16  PM-KEY-CHANGE              PIC X.
  6977                 88  PM-NO-KEY-CHG   VALUES ARE ' ' 'N'.
  6978                 88  PM-KEY-CHG           VALUE 'Y'.
  6979         16  PM-KEY-CHANGE-DT           PIC XX.
  6980
  6981         16  PM-RTI-INDICATOR           PIC X.
  6982         16  PM-REASON-CODE             PIC X(3).
  6983         16  PM-IN-OUT-PROCESSING-IND   PIC X(1).
  6984             88  PM-IN-OUT-PROCESSING   VALUE 'Y'.
  6985             88  PM-NOT-IN-OUT-PROCESSING
  6986                                           VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 130
* EL150.cbl
  6987
  6988     12  FILLER                            PIC X(12).
  6989
  6990******************************************************************
  6991*                 AGENT AND COMMISSION DATA                      *
  6992******************************************************************
  6993
  6994     12  PM-COMMISSION-DATA.
  6995         16  PM-REMIT-TO                PIC S9(3) COMP-3.
  6996         16  PM-COMM-CHANGE-SW          PIC X.
  6997                 88  PM-COMMISSION-CHANGE  VALUE 'Y'.
  6998         16  PM-AGENT-INFORMATION OCCURS  5 TIMES.
  6999             20  PM-AGENT-NUMBER        PIC X(10).
  7000             20  PM-AGENT-TYPE          PIC X.
  7001                 88  PM-PRODUCER-LEVEL-AGENT
  7002                                              VALUES ARE 'C' 'D'.
  7003                 88  PM-AGENT-GROSS        VALUE 'C'.
  7004                 88  PM-AGENT-REINS        VALUE 'R'.
  7005                 88  PM-AGENT-GROSS-REINS  VALUE 'D'.
  7006                 88  PM-OVERWRITE-GROSS    VALUE 'O'.
  7007                 88  PM-OVERWRITE-GROSS-REINS VALUE 'P'.
  7008                 88  PM-OVERWRITE-REINS    VALUE 'T'.
  7009                 88  PM-REINS-ONLY         VALUE 'W'.
  7010             20  PM-COMMISSION-BILL-PAID PIC X(1).
  7011                 88  PM-GENERATE-BILL      VALUE 'B'.
  7012                 88  PM-GENERATE-PAID      VALUE 'P'.
  7013             20  PM-AGENT-COMP-1ST-YEAR PIC S99V999.
  7014             20  PM-COMP-1ST-YEAR-TYPE  PIC X(1).
  7015                 88  PM-COMP-1ST-YEAR-PERCENT VALUE '1'.
  7016                 88  PM-COMP-1ST-YEAR-DOLLARS VALUE '2'.
  7017                 88  PM-COMP-1ST-YEAR-NOT-USED VALUE '3'.
  7018             20  PM-RENEWAL-DATA.
  7019                 24  PM-AGENT-RENEWAL-DATA OCCURS 6 TIMES.
  7020                     28  PM-RENEW-MONTHS  PIC S999    COMP-3.
  7021                     28  PM-RENEW-COMMISSION
  7022                                             PIC S99V999 COMP-3.
  7023                     28  PM-RENEW-TYPE    PIC X(1).
  7024                         88  PM-COMP-RENEW-PERCENT   VALUE '1'.
  7025                         88  PM-COMP-RENEW-DOLLARS   VALUE '2'.
  7026                         88  PM-COMP-RENEW-NOT-USED  VALUE '3'.
  7027             20  PM-COMP-RECALC-FLAG    PIC X(1).
  7028                 88  PM-BYPASS-RECALC      VALUE 'N'.
  7029     12  FILLER                            PIC X(20).
  7030******************************************************************
  7031*             CUSTOMER DATA                                      *
  7032******************************************************************
  7033     12  PM-CUSTOMER-ID                 PIC X(20).
  7034******************************************************************
  7035     12  FILLER                            PIC X(43).
  7036******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 131
* EL150.cbl
  7038*                COPY MTCPLAN REPLACING ==:TAG:== BY ==PP==.
  7039******************************************************************
  7040*                                                                *
  7041*                            MTCPLAN                             *
  7042*                            VMOD=1.001                          *
  7043*                                                                *
  7044*   MORTGAGE SYSTEM PRODUCER PLAN MASTER FILE.                   *
  7045*                                                                *
  7046*   THIS COPYBOOK IS USED FOR THE ONLINE                         *
  7047*   PLAN CODE MASTER FILE.                                       *
  7048*                                                                *
  7049*   FILE DESCRIPTION = PRODUCER PLAN MASTER                      *
  7050*                                                                *
  7051*   FILE TYPE = VSAM,KSDS                                        *
  7052*   RECORD SIZE = 450  RECFORM = FIX                             *
  7053*                                                                *
  7054*   BASE CLUSTER NAME = MPPLAN                    RKP=2,LEN=25   *
  7055*       ALTERNATE PATH1 = MPPLAN2 (ALT GROUPING) RKP=47,LEN=25   *
  7056*                                                                *
  7057*   LOG = NO                                                     *
  7058*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7059*                                                                *
  7060*                                                                *
  7061******************************************************************
  7062
  7063 01  PRODUCER-PLANS.
  7064     12  PP-RECORD-ID                   PIC  X(02).
  7065         88  VALID-PP-ID                      VALUE 'PP'.
  7066
  7067******************************************************************
  7068*   BASE CLUSTER NAME = MPPLAN                    RKP=2,LEN=25   *
  7069******************************************************************
  7070
  7071     12  PP-CONTROL-PRIMARY.
  7072         16  PP-PROD-PRIMARY.
  7073             20  PP-COMPANY-CD          PIC  X(01).
  7074             20  PP-CONTROL-A.
  7075                 24  PP-CARRIER         PIC  X(01).
  7076                 24  PP-GROUPING.
  7077                     28  PP-GROUPING-PREFIX
  7078                                           PIC  X(03).
  7079                     28  PP-GROUPING-PRIME PIC X(03).
  7080                 24  PP-STATE           PIC  X(02).
  7081                 24  PP-PRODUCER.
  7082                     28  PP-PRODUCER-PREFIX
  7083                                           PIC  X(04).
  7084                     28  PP-PRODUCER-PRIME PIC X(06).
  7085         16  PP-PRODUCER-PLAN.
  7086             20  PP-PLAN-CODE           PIC  X(02).
  7087             20  PP-PLAN-REVISION       PIC  9(03).
  7088     12  FILLER                            PIC  X(20).
  7089
  7090******************************************************************
  7091*      ALTERNATE PATH1 = MPPLAN2 (ALT GROUPING) RKP=47,LEN=25    *
  7092******************************************************************
  7093
  7094     12  PP-CONTROL-BY-VAR-GRP.
  7095         16  PP-COMPANY-CD-A1           PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 132
* EL150.cbl
  7096         16  PP-VG-CARRIER              PIC  X(01).
  7097         16  PP-VG-GROUPING             PIC  X(06).
  7098         16  PP-VG-STATE                PIC  X(02).
  7099         16  PP-VG-PRODUCER             PIC  X(10).
  7100         16  PP-VG-PLAN-CODE            PIC  X(02).
  7101         16  PP-VG-PLAN-REVISION        PIC  X(03).
  7102     12  FILLER                            PIC  X(20).
  7103
  7104******************************************************************
  7105*                PRODUCER SECURITY DATA                          *
  7106******************************************************************
  7107
  7108     12  PP-SECURITY-ACCESS-CODE        PIC  X(01).
  7109     12  PP-POLICY-CNT                  PIC S9(07)    COMP-3.
  7110
  7111******************************************************************
  7112*                FILE SYNCHRONIZATION DATA                       *
  7113******************************************************************
  7114
  7115     12  PP-MAINT-INFORMATION.
  7116         16  PP-LAST-MAINT-DATE         PIC  X(02).
  7117         16  PP-LAST-MAINT-HHMMSS       PIC S9(07)    COMP-3.
  7118         16  PP-LAST-MAINT-USER         PIC  X(04).
  7119     12  FILLER                            PIC  X(10).
  7120
  7121******************************************************************
  7122*                   CRITICAL FILE DATES                          *
  7123******************************************************************
  7124
  7125     12  PP-PLAN-DATES.
  7126         16  PP-PLAN-EFFECT-DATE        PIC  X(02).
  7127         16  PP-PLAN-EXPIRE-DATE        PIC  X(02).
  7128
  7129     12  FILLER                            PIC  X(10).
  7130
  7131******************************************************************
  7132*                GENERAL INFORMATION                             *
  7133******************************************************************
  7134
  7135     12  PP-GENERAL-INFORMATION.
  7136         16  PP-ALPHA-SEARCH-SW         PIC  X(01).
  7137             88  PP-MIB-ALPHA-ALL           VALUE '1'.
  7138             88  PP-MIB-ALPHA-NONE          VALUE '2'.
  7139             88  PP-MIB-ALPHA-EXCEEDED      VALUE '3'.
  7140             88  PP-CLIENT-ALPHA-ALL        VALUE 'A'.
  7141             88  PP-CLIENT-ALPHA-NONE       VALUE 'B'.
  7142             88  PP-CLIENT-ALPHA-EXCEEDED   VALUE 'C'.
  7143             88  PP-BOTH-ALPHA-ALL          VALUE 'X'.
  7144             88  PP-BOTH-ALPHA-NONE         VALUE 'Y'.
  7145             88  PP-BOTH-ALPHA-EXCEEDED     VALUE 'Z'.
  7146             88  PP-ALPHA-SEARCH-VALID VALUES ARE '1' '2' '3'
  7147                                                     'A' 'B' 'C'
  7148                                                     'X' 'Y' 'Z'.
  7149         16  PP-BENEFIT-TYPE            PIC  X(01).
  7150             88  PP-BENEFIT-IS-LEVEL         VALUE '1'.
  7151             88  PP-BENEFIT-REDUCES          VALUE '2'.
  7152         16  PP-DAYS-TO-1ST-NOTICE      PIC  9(02).
  7153         16  PP-DAYS-TO-2ND-NOTICE      PIC  9(02).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 133
* EL150.cbl
  7154         16  PP-DAYS-TO-3RD-NOTICE      PIC  9(02).
  7155         16  PP-DAYS-TO-4TH-NOTICE      PIC  9(02).
  7156         16  PP-EFF-DT-RULE-SW          PIC  X(01).
  7157             88  PP-EFF-DT-ENTER            VALUE 'E'.
  7158             88  PP-EFF-DT-MONTH            VALUE 'M'.
  7159             88  PP-EFF-DT-QTR              VALUE 'Q'.
  7160             88  PP-EFF-DT-SEMI             VALUE 'S'.
  7161             88  PP-EFF-DT-ANN              VALUE 'A'.
  7162         16  PP-FREE-EXAM-DAYS          PIC S9(03)   COMP-3.
  7163         16  PP-GRACE-PERIOD            PIC S9(03)   COMP-3.
  7164         16  PP-HEALTH-QUESTIONS        PIC  9(01).
  7165         16  PP-NUMBER-LAPSE-NOTICES    PIC S9(03)   COMP-3.
  7166         16  PP-MIB-SEARCH-SW           PIC  X(01).
  7167             88  PP-MIB-SEARCH-ALL          VALUE '1'.
  7168             88  PP-MIB-SEARCH-NONE         VALUE '2'.
  7169             88  PP-MIB-SEARCH-EXCEEDED     VALUE '3'.
  7170             88  PP-MIB-SEARCH-VALID   VALUES ARE '1' '2' '3'.
  7171         16  PP-PLAN-ABBREV             PIC  X(03).
  7172         16  PP-PLAN-AGES.
  7173             20  PP-MINIMUM-AGE         PIC S9(03)   COMP-3.
  7174             20  PP-MAXIMUM-AGE         PIC S9(03)   COMP-3.
  7175             20  PP-MAXIMUM-ATTAIN-AGE  PIC S9(03)   COMP-3.
  7176         16  PP-PLAN-BENEFITS.
  7177             20  PP-CLAIM-CAP           PIC S9(07)V99 COMP-3.
  7178             20  PP-MINIMUM-BENEFIT     PIC S9(07)V99 COMP-3.
  7179             20  PP-MAXIMUM-BENEFIT     PIC S9(07)V99 COMP-3.
  7180             20  PP-MAXIMUM-MONTHLY-BENEFIT
  7181                                           PIC S9(07)V99 COMP-3.
  7182         16  PP-PLAN-DESCRIPTION        PIC  X(10).
  7183         16  PP-POLICY-FEE              PIC S9(03)V9(02)
  7184                                                        COMP-3.
  7185         16  PP-PLAN-IND-GRP            PIC  X(01).
  7186         16  PP-PLAN-SNGL-JNT           PIC  X(01).
  7187             88  PP-COMBINED-PLAN          VALUE 'C'.
  7188             88  PP-JNT-PLAN               VALUE 'J'.
  7189             88  PP-SNGL-PLAN              VALUE 'S'.
  7190         16  PP-PLAN-TERMS.
  7191             20  PP-MINIMUM-TERM        PIC S9(03)   COMP-3.
  7192             20  PP-MAXIMUM-TERM        PIC S9(03)   COMP-3.
  7193         16  PP-PLAN-TYPE               PIC  X(01).
  7194             88  PP-AH-MORT-PLAN           VALUE 'A'.
  7195             88  PP-AD-D-MORT-PLAN         VALUE 'E'.
  7196             88  PP-DISMEM-MORT-PLAN       VALUE 'D'.
  7197             88  PP-LIFE-MORT-PLAN         VALUE 'L'.
  7198         16  PP-PREMIUM-TOLERANCES.
  7199             20  PP-PREM-TOLERANCE      PIC S9(03)   COMP-3.
  7200             20  PP-PREM-TOLERANCE-PCT  PIC SV9(03)  COMP-3.
  7201         16  PP-RATE-CODE               PIC  X(05).
  7202         16  PP-REOCCURRING-DISABILITY-PRD PIC S9(03) COMP-3.
  7203         16  PP-REPLACEMENT-LAW-SW      PIC  X(01).
  7204             88  PP-NO-REPLACE             VALUE '1'.
  7205             88  PP-REPLACE-APPLIES        VALUE '2'.
  7206             88  PP-VALID-REPLACEMENT-LAW  VALUE '1' '2'.
  7207         16  PP-RETRO-RETENTION         PIC S9V9(04) COMP-3.
  7208         16  PP-RERATE-CNTL             PIC  X(01).
  7209             88  PP-RERATE-WITH-ISSUE-AGE    VALUE '1'.
  7210             88  PP-RERATE-WITH-CURRENT-AGE  VALUE '2'.
  7211             88  PP-DO-NOT-RERATE            VALUE '3' ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 134
* EL150.cbl
  7212             88  PP-AUTO-RECALC              VALUE '4'.
  7213         16  PP-SEX-RATING              PIC  X(01).
  7214             88  PP-NOT-SEX-RATED          VALUE '1'.
  7215             88  PP-SEX-RATED              VALUE '2'.
  7216         16  PP-SUBSTANDARD-DATA.
  7217             20  PP-SUBSTANDARD-PERCENT PIC S9(01)V9(04).
  7218             20  PP-SUBSTANDARD-TYPE    PIC  X(01).
  7219                 88  PP-PCT-OF-BENEFIT     VALUE '1'.
  7220                 88  PP-PCT-OF-PREMIUM     VALUE '2'.
  7221                 88  PP-NOT-APPLICABLE     VALUE '3'.
  7222         16  PP-YEARS-TO-NEXT-RERATE    PIC  9(02).
  7223         16  PP-DEPENDANT-COVERAGE      PIC  X(01).
  7224             88  PP-DEP-COVERED            VALUE 'Y'.
  7225             88  PP-DEP-NOT-COVERED        VALUE 'N' ' '.
  7226         16  PP-REFUND-CALC             PIC  X(01).
  7227             88  PP-RFND-MP-REFUND  VALUES ARE ' ' LOW-VALUES.
  7228             88  PP-RFND-BY-R78            VALUE '1'.
  7229             88  PP-RFND-BY-PRO-RATA       VALUE '2'.
  7230             88  PP-RFND-AS-CALIF          VALUE '3'.
  7231             88  PP-RFND-AS-TEXAS          VALUE '4'.
  7232             88  PP-RFND-IS-NET-PAY        VALUE '5'.
  7233             88  PP-RFND-ANTICIPATION      VALUE '6'.
  7234             88  PP-RFND-MEAN              VALUE '8'.
  7235             88  PP-VALID-REFUND    VALUES ARE ' ' '1' '2' '3'
  7236                                                  '4' '5' '6' '8'
  7237                                                  LOW-VALUES.
  7238         16  PP-ALT-RATE-CODE           PIC  X(05).
  7239
  7240     12  FILLER                            PIC  X(39).
  7241
  7242******************************************************************
  7243*                     PLAN FORMS AND LETTERS                     *
  7244******************************************************************
  7245
  7246     12  PP-PLAN-MASTER-FORMS.
  7247         16  PP-POLICY-FORM             PIC  X(12).
  7248         16  PP-MASTER-APPLICATION      PIC  X(12).
  7249         16  PP-MASTER-POLICY           PIC  X(12).
  7250     12  PP-DELINQUENCY-NOTICE-FORMS.
  7251         16  PP-1ST-NOTICE-FORM         PIC  X(04).
  7252         16  PP-2ND-NOTICE-FORM         PIC  X(04).
  7253         16  PP-3RD-NOTICE-FORM         PIC  X(04).
  7254         16  PP-4TH-NOTICE-FORM         PIC  X(04).
  7255     12  FILLER                            PIC  X(32).
  7256     12  PP-TERMINATION-FORM            PIC  X(04).
  7257     12  FILLER                            PIC  X(08).
  7258     12  PP-ISSUE-LETTER                PIC  X(04).
  7259
  7260     12  FILLER                            PIC  X(80).
  7261******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 135
* EL150.cbl
  7263*                COPY MTCPROD REPLACING ==:TAG:== BY ==PDM==.
  7264******************************************************************
  7265*                                                                *
  7266*                            MTCPROD                             *
  7267*                            VMOD=1.001                          *
  7268*                                                                *
  7269*   MORTGAGE SYSTEM PRODUCER MASTER FILE                         *
  7270*                                                                *
  7271*   THIS COPYBOOK IS USED FOR THE ONLINE                         *
  7272*   VSAM PRODUCER MASTER FILE.                                   *
  7273*                                                                *
  7274*   FILE DESCRIPTION = PRODUCER MASTER FILE                      *
  7275*                                                                *
  7276*   FILE TYPE = VSAM,KSDS                                        *
  7277*   RECORD SIZE = 2000 RECFORM = FIXED                           *
  7278*                                                                *
  7279*   BASE CLUSTER NAME = MPPROD                    RKP=02,LEN=22  *
  7280*       ALTERNATE PATH1 = MPPROD2 (ALT GROUPING)  RKP=48,LEN=22  *
  7281*       ALTERNATE PATH2 = MPPROD3 (PRODUCER NAME) RKP=90,LEN=56  *
  7282*                                                                *
  7283*   LOG = NO                                                     *
  7284*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7285*                                                                *
  7286*                                                                *
  7287******************************************************************
  7288
  7289 01  PRODUCER-MASTER.
  7290     12  PDM-RECORD-ID              PIC  X(02).
  7291         88  PDM-VALID-ID                VALUE 'PD'.
  7292
  7293******************************************************************
  7294*   BASE CLUSTER NAME = MPPROD                    RKP=2,LEN=22   *
  7295******************************************************************
  7296
  7297     12  PDM-CONTROL-PRIMARY-BATCH.
  7298         16  FILLER                   PIC  X(20).
  7299         16  PDM-EXPIRE-DT.
  7300             20  PDM-EXPIRE-DT-YY   PIC  9(02).
  7301             20  PDM-EXPIRE-DT-MM   PIC  9(02).
  7302             20  PDM-EXPIRE-DT-DD   PIC  9(02).
  7303     12  FILLER REDEFINES PDM-CONTROL-PRIMARY-BATCH.
  7304         16  PDM-CONTROL-PRIMARY.
  7305             20  PDM-COMPANY-CD     PIC  X(01).
  7306             20  PDM-MSTR-CNTRL.
  7307                 24  PDM-CONTROL-A.
  7308                     28  PDM-CARRIER PIC X(01).
  7309                     28  PDM-GROUPING.
  7310                         32 PDM-GROUPING-PREFIX
  7311                                      PIC  X(03).
  7312                         32 PDM-GROUPING-PRIME
  7313                                      PIC  X(03).
  7314                     28  PDM-STATE  PIC  X(02).
  7315                     28  PDM-PRODUCER.
  7316                         32  PDM-PRODUCER-PREFIX
  7317                                      PIC  X(04).
  7318                         32  PDM-PRODUCER-PRIME
  7319                                      PIC  X(06).
  7320                 24  PDM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 136
* EL150.cbl
  7321                     28  PDM-EXPIRE-DATE
  7322                                      PIC  X(02).
  7323         16  FILLER REDEFINES PDM-CONTROL-PRIMARY.
  7324             20  FILLER               PIC  X(01).
  7325             20  PDM-CGSPE-KEY      PIC  X(21).
  7326         16  FILLER                   PIC  X(04).
  7327     12  FILLER                       PIC  X(20).
  7328
  7329******************************************************************
  7330*      ALTERNATE PATH1 = MPPROD2 (ALT GROUPING) RKP=48,LEN=22    *
  7331******************************************************************
  7332
  7333     12  PDM-CONTROL-BY-VAR-GRP.
  7334         16  PDM-VG-CCGSP-KEYLET.
  7335             20  PDM-COMPANY-CD-A1  PIC  X(01).
  7336             20  PDM-VG-CARRIER     PIC  X(01).
  7337             20  PDM-VG-GROUPING    PIC  X(06).
  7338             20  PDM-VG-STATE       PIC  X(02).
  7339             20  PDM-VG-PRODUCER    PIC  X(10).
  7340         16  PDM-VG-DATE.
  7341             24  PDM-VG-EXPIRE-DATE PIC  X(02).
  7342     12  FILLER                       PIC  X(20).
  7343
  7344
  7345******************************************************************
  7346*      ALTERNATE PATH2 = MPPROD3 (NAME)         RKP=90,LEN=56    *
  7347******************************************************************
  7348
  7349     12  PDM-CONTROL-BY-NAME.
  7350         16  PDM-COMPANY-CD-A2      PIC  X(01).
  7351         16  PDM-NAME-A2            PIC  X(30).
  7352         16  PDM-CGSPE-KEY-A2.
  7353             20  PDM-CARRIER-A2     PIC  X(01).
  7354             20  PDM-GROUPING-A2    PIC  X(06).
  7355             20  PDM-STATE-A2       PIC  X(02).
  7356             20  PDM-PRODUCER-A2    PIC  X(10).
  7357             20  PDM-EXPIRE-DATE-A2 PIC  X(02).
  7358         16  PDM-CURRENT-DATE-BIN-A2 PIC X(02).
  7359         16  PDM-CURRENT-TIME-BIN-A2 PIC S9(04) COMP.
  7360     12  FILLER                       PIC  X(20).
  7361
  7362******************************************************************
  7363*                FILE SYNCHRONIZATION DATA                       *
  7364******************************************************************
  7365
  7366     12  PDM-MAINT-INFORMATION.
  7367         16  PDM-LAST-MAINT-DATE    PIC  X(02).
  7368         16  PDM-LAST-MAINT-HHMMSS  PIC S9(07) COMP-3.
  7369         16  PDM-LAST-MAINT-USER    PIC  X(04).
  7370
  7371******************************************************************
  7372*                PRODUCER SECURITY DATA                          *
  7373******************************************************************
  7374
  7375     12  PDM-SECURITY-ACCESS-CODE   PIC  X(01).
  7376
  7377******************************************************************
  7378*                DATES                                           *
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 137
* EL150.cbl
  7379******************************************************************
  7380
  7381     12  PDM-ANNIVERSARY-DATE       PIC  X(02).
  7382
  7383     12  PDM-AR-HI-DATE.
  7384         16  PDM-AR-HI-POLICY-DATE  PIC  X(02).
  7385         16  FILLER                   PIC  X(04).
  7386     12  PDM-AR-HI-POLICY-DT REDEFINES PDM-AR-HI-DATE.
  7387         16  PDM-AR-HI-POLICY-DT-YY PIC  9(02).
  7388         16  PDM-AR-HI-POLICY-DT-MM PIC  9(02).
  7389         16  PDM-AR-HI-POLICY-DT-DD PIC  9(02).
  7390
  7391     12  PDM-ENTRY-DATE             PIC  X(02).
  7392
  7393     12  PDM-EFFECT-DTE.
  7394         16  PDM-EFFECT-DATE        PIC  X(02).
  7395         16  FILLER                   PIC  X(04).
  7396     12  PDM-EFFECT-DT REDEFINES PDM-EFFECT-DTE.
  7397         16  PDM-EFFECT-DT-YY       PIC  9(02).
  7398         16  PDM-EFFECT-DT-MM       PIC  9(02).
  7399         16  PDM-EFFECT-DT-DD       PIC  9(02).
  7400
  7401     12  PDM-HI-DATE.
  7402         16  PDM-HI-POLICY-DATE     PIC  X(02).
  7403         16  FILLER                   PIC  X(04).
  7404     12  PDM-HI-POLICY-DT REDEFINES PDM-HI-DATE.
  7405         16  PDM-HI-POLICY-DT-YY    PIC  9(02).
  7406         16  PDM-HI-POLICY-DT-MM    PIC  9(02).
  7407         16  PDM-HI-POLICY-DT-DD    PIC  9(02).
  7408
  7409     12  PDM-INACTIVE-DATE          PIC  X(02).
  7410
  7411     12  PDM-LO-DATE.
  7412         16  PDM-LO-POLICY-DATE     PIC  X(02).
  7413         16  FILLER                   PIC  X(04).
  7414     12  PDM-LO-POLICY-DT REDEFINES PDM-LO-DATE.
  7415         16  PDM-LO-POLICY-DT-YY    PIC  9(02).
  7416         16  PDM-LO-POLICY-DT-MM    PIC  9(02).
  7417         16  PDM-LO-POLICY-DT-DD    PIC  9(02).
  7418
  7419     12  PDM-POLICIES-PURGED-DATE   PIC  X(02).
  7420
  7421     12  PDM-PREV-DATES.
  7422         16  PDM-PREV-EFF-DATE      PIC  X(02).
  7423         16  FILLER                   PIC  X(04).
  7424         16  PDM-PREV-EXP-DATE      PIC  X(02).
  7425         16  FILLER                   PIC  X(04).
  7426     12  PDM-PREV-DTS REDEFINES PDM-PREV-DATES.
  7427         16  PDM-PREV-EFF-DT.
  7428             20  PDM-PREV-EFF-DT-YY PIC  9(02).
  7429             20  PDM-PREV-EFF-DT-MM PIC  9(02).
  7430             20  PDM-PREV-EFF-DT-DD PIC  9(02).
  7431         16  PDM-PREV-EXP-DT.
  7432             20  PDM-PREV-EXP-DT-YY PIC  9(02).
  7433             20  PDM-PREV-EXP-DT-MM PIC  9(02).
  7434             20  PDM-PREV-EXP-DT-DD PIC  9(02).
  7435
  7436     12  PDM-1ST-PROD-DATE          PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 138
* EL150.cbl
  7437
  7438     12  FILLER                       PIC  X(20).
  7439
  7440******************************************************************
  7441*                MORTGAGE BILLING DATA                           *
  7442******************************************************************
  7443
  7444     12  PDM-CONTACT                PIC  X(30).
  7445     12  PDM-BILLING-MONTHS.
  7446         16  PDM-BILLING-MONTH-ANNUAL PIC 9(02).
  7447         16  PDM-BILLING-MONTH-SEMIANN PIC 9(02).
  7448     12  PDM-BILLING-ADVANCE-ARREARS PIC X(01).
  7449         88  PDM-BILL-ADVANCE           VALUE '1'.
  7450         88  PDM-BILL-ARREARS           VALUE '2'.
  7451     12  PDM-BILLING-MODE           PIC  X(01).
  7452         88  PDM-ANNUAL-BILL            VALUE '1'.
  7453         88  PDM-SEMI-ANNUAL-BILL       VALUE '2'.
  7454         88  PDM-QUARTERLY-BILL         VALUE '3'.
  7455         88  PDM-MONTHLY-BILL           VALUE '4'.
  7456         88  PDM-BI-MONTHLY-BILL        VALUE '5'.
  7457         88  PDM-SINGLE-PREM-BILL       VALUE '6'.
  7458     12  PDM-BILLING-GROUPING-CODE  PIC  X(06).
  7459     12  PDM-BILLING-SCHEDULE       PIC  X(01).
  7460         88  PDM-BILL-1ST-WEEK          VALUE '1'.
  7461         88  PDM-BILL-2ND-WEEK          VALUE '2'.
  7462         88  PDM-BILL-3RD-WEEK          VALUE '3'.
  7463         88  PDM-BILL-4TH-WEEK          VALUE '4'.
  7464         88  PDM-BILL-5TH-WEEK          VALUE '5'.
  7465         88  PDM-HOLD-BILL              VALUE '6'.
  7466         88  PDM-NO-BILL                VALUE '7'.
  7467     12  PDM-BILLING-SEQUENCE       PIC  X(01).
  7468         88  PDM-BILL-NAME-SEQU         VALUE '1'.
  7469         88  PDM-BILL-LOAN-SEQU         VALUE '2'.
  7470         88  PDM-BILL-PLCY-SEQU         VALUE '3'.
  7471     12  PDM-BILLING-TYPE           PIC  X(01).
  7472         88  PDM-LIST-BILL              VALUE '1'.
  7473         88  PDM-TAPE-BILL              VALUE '2'.
  7474         88  PDM-TAPE-LIST-BILL         VALUE '3'.
  7475         88  PDM-GROUP-BILL         VALUES ARE '1' '2' '3'.
  7476         88  PDM-DIRECT-BILL            VALUE '4'.
  7477         88  PDM-PAC                VALUES ARE '5' 'C' 'S'.
  7478         88  PDM-CREDIT-CARD            VALUE '6'.
  7479         88  PDM-INDIV-BILL
  7480                              VALUES ARE '4' '5' '6' 'C' 'S'.
  7481         88  PDM-GROUP-BY-POLICY        VALUE '7'.
  7482         88  PDM-GROUP-BY-POLICY-PAC    VALUE '8'.
  7483         88  PDM-GROUP-BY-POLICY-CRDC   VALUE '9'.
  7484         88  PDM-GROUP-BY-BILL          VALUE '7' '8' '9'.
  7485         88  PDM-GROUP-BY-PROD          VALUE 'A'.
  7486         88  PDM-EFT-CHECKING           VALUE 'C'.
  7487         88  PDM-EFT-SAVINGS            VALUE 'S'.
  7488     12  PDM-DATE-PAID              PIC  X(02).
  7489     12  PDM-LAST-BILLING-DATE      PIC  X(02).
  7490     12  PDM-LAST-BILL-TO-DATE      PIC  X(02).
  7491     12  PDM-MAX-MONTHS-BILL        PIC S9(03)  COMP-3.
  7492     12  PDM-PAID-TO-DATE           PIC  X(02).
  7493     12  PDM-PREV-BILLING-DATE      PIC  X(02).
  7494     12  PDM-PREV-BILL-TO-DATE      PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 139
* EL150.cbl
  7495
  7496     12  FILLER                       PIC  X(20).
  7497
  7498******************************************************************
  7499*                PERSONAL DATA                                   *
  7500******************************************************************
  7501
  7502     12  PDM-ADDRS                  PIC  X(30).
  7503     12  PDM-CITY                   PIC  X(30).
  7504     12  PDM-CITY-CODE              PIC  X(04).
  7505     12  PDM-COUNTY-CODE            PIC  X(03).
  7506     12  PDM-NAME                   PIC  X(30).
  7507     12  PDM-PARRISH-CODE           PIC  X(03).
  7508     12  PDM-PERSON                 PIC  X(30).
  7509     12  PDM-TEL-NO.
  7510         16  PDM-AREA-CODE          PIC  9(03).
  7511         16  PDM-TEL-PRE            PIC  9(03).
  7512         16  PDM-TEL-NBR            PIC  9(04).
  7513     12  PDM-ZIP.
  7514         16  PDM-ZIP-PRIME          PIC  X(05).
  7515         16  PDM-ZIP-PLUS4          PIC  X(04).
  7516     12  PDM-LANGUAGE-IND           PIC  X(01).
  7517         88  PDM-ENGLISH                       VALUE 'E'.
  7518         88  PDM-FRENCH                        VALUE 'F'.
  7519         88  PDM-SPANISH                       VALUE 'S'.
  7520
  7521     12  FILLER                       PIC  X(19).
  7522
  7523******************************************************************
  7524*                REINSURANCE DATA                                *
  7525******************************************************************
  7526
  7527     12  PDM-REINS-TBL-CODE         PIC  X(03).
  7528     12  PDM-REIN-RECALC            PIC  X(01).
  7529
  7530     12  PDM-REI-AH-FEE             PIC S9(01)V9(04) COMP-3.
  7531     12  PDM-REI-AH-PE              PIC  X(01).
  7532     12  PDM-REI-AH-TAX             PIC S9(01)V9(04) COMP-3.
  7533
  7534     12  PDM-REI-GROUP-A            PIC  X(06).
  7535     12  PDM-REI-GROUP-B            PIC  X(06).
  7536
  7537     12  PDM-REI-LF-FEE             PIC S9(01)V9(04) COMP-3.
  7538     12  PDM-REI-LF-PE              PIC  X(01).
  7539     12  PDM-REI-LF-TAX             PIC S9(01)V9(04) COMP-3.
  7540
  7541     12  PDM-REI-MORT               PIC  X(04).
  7542     12  PDM-REI-PRT-OW             PIC  X(01).
  7543     12  PDM-REI-PRT-ST             PIC  X(01).
  7544
  7545     12  PDM-REI-ADD-FEE            PIC S9(01)V9(04) COMP-3.
  7546     12  PDM-REI-ADD-PE             PIC  X(01).
  7547     12  PDM-REI-ADD-TAX            PIC S9(01)V9(04) COMP-3.
  7548
  7549     12  PDM-REI-DIS-FEE            PIC S9(01)V9(04) COMP-3.
  7550     12  PDM-REI-DIS-PE             PIC  X(01).
  7551     12  PDM-REI-DIS-TAX            PIC S9(01)V9(04) COMP-3.
  7552
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 140
* EL150.cbl
  7553     12  FILLER                       PIC  X(10).
  7554******************************************************************
  7555*                RETRO DATA                                      *
  7556******************************************************************
  7557
  7558     12  PDM-RET-AH                 PIC S9(01)V9(04) COMP-3.
  7559     12  PDM-RET-GRP                PIC  X(06).
  7560     12  PDM-RET-LF                 PIC S9(01)V9(04) COMP-3.
  7561     12  PDM-RET-MIN-LOSS-A         PIC SV9(03)      COMP-3.
  7562     12  PDM-RET-MIN-LOSS-L         PIC SV9(03)      COMP-3.
  7563     12  PDM-RET-P-E                PIC  X(01).
  7564     12  PDM-RET-ST-TAX-USE         PIC  X(01).
  7565         88  PDM-CHARGE-ST-TAXES-ON-RETRO   VALUE 'Y' 'E' 'P'.
  7566         88  PDM-TAXES-NOT-IN-RETRO         VALUE 'N' ' '.
  7567     12  PDM-RET-Y-N                PIC  X(01).
  7568     12  PDM-RET-ADD                PIC S9(01)V9(04) COMP-3.
  7569     12  PDM-RET-MIN-LOSS-ADD       PIC SV9(03)      COMP-3.
  7570     12  PDM-RET-DIS                PIC S9(01)V9(04) COMP-3.
  7571     12  PDM-RET-MIN-LOSS-DIS       PIC SV9(03)      COMP-3.
  7572
  7573     12  FILLER                       PIC  X(10).
  7574
  7575******************************************************************
  7576*                     MANAGEMENT OPTIONS                         *
  7577******************************************************************
  7578
  7579     12  PDM-DEFAULT-UNWTR-CODE     PIC  X(03).
  7580     12  PDM-LAPSE-NOTICE-CNTL      PIC  X(01).
  7581     12  PDM-CORRESPONDENCE-CNTL    PIC  X(01).
  7582     12  PDM-RETAIN-BILLING-DATA-MTHS PIC S9(03) COMP-3.
  7583     12  PDM-RETAIN-CLAIM-DATA-MTHS PIC S9(03)  COMP-3.
  7584     12  PDM-RETAIN-COMMISSION-MTHS PIC S9(03)  COMP-3.
  7585     12  PDM-RETAIN-DELINQUENCY-MTHS PIC S9(03) COMP-3.
  7586     12  PDM-RETAIN-INSD-PROFILE-MTHS PIC S9(03) COMP-3.
  7587     12  PDM-RETAIN-INS-COVERAGE-MTHS PIC S9(03) COMP-3.
  7588     12  PDM-RETAIN-STATUS-DISP-MTHS PIC S9(03) COMP-3.
  7589     12  PDM-NUM-BILLING-CYCLES-RETAINED
  7590                                      PIC S9(03)  COMP-3.
  7591     12  PDM-RETAIN-UNDERWRITER-HST-MTHS
  7592                                      PIC S9(03)  COMP-3.
  7593
  7594     12  FILLER                       PIC X(098).
  7595
  7596
  7597******************************************************************
  7598*                MISCELLANEOUS DATA                              *
  7599******************************************************************
  7600
  7601     12  PDM-AH-RPT021-EXP-PCT      PIC S9(03)V9(04) COMP-3.
  7602     12  PDM-AUTO-REFUND-SW         PIC  X(01).
  7603         88  PDM-AUTO-REFUNDS-USED          VALUE 'Y'.
  7604         88  PDM-AUTO-REFUNDS-NOT-USED      VALUE 'N' ' '.
  7605     12  PDM-BUSINESS-TYPE          PIC  9(02).
  7606     12  PDM-CAL-TABLE              PIC  X(02).
  7607     12  PDM-COMMENTS.
  7608         16  PDM-COMMENT-LINE       PIC  X(50)
  7609                                           OCCURS 5 TIMES.
  7610     12  PDM-EMPLOYER-STMT-USED     PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 141
* EL150.cbl
  7611     12  PDM-GROUPED-CHECKS-Y-N     PIC  X(01).
  7612     12  PDM-IG                     PIC  X(01).
  7613         88  PDM-HAS-INDIVIDUAL             VALUE 'I'
  7614                                                    '1'.
  7615         88  PDM-HAS-GROUP                  VALUE 'G'
  7616                                                    '2'.
  7617     12  PDM-LF-RPT021-EXP-PCT      PIC S9(03)V9(04) COMP-3.
  7618     12  PDM-REPORT-CODE-1          PIC  X(10).
  7619     12  PDM-REPORT-CODE-2          PIC  X(10).
  7620     12  PDM-RPT045A-SWITCH         PIC  X(01).
  7621         88  PDM-RPT045A-OFF             VALUE 'N'.
  7622     12  PDM-SPECIAL-BILLING-FREQ   PIC  X(01).
  7623         88  PDM-HAS-SPECIAL-BILL-FREQ      VALUE 'Y'.
  7624         88  PDM-NO-SPECIAL-BILL-FREQ       VALUE 'N' ' '.
  7625     12  PDM-STATUS                 PIC  X(01).
  7626         88  PDM-STATUS-ACTIVE              VALUE '0'.
  7627         88  PDM-STATUS-INACTIVE            VALUE '1'.
  7628     12  PDM-STD-AH-TYPE            PIC  X(02).
  7629     12  PDM-TAX-NUMBER             PIC  X(11).
  7630     12  PDM-TOL-CLM                PIC S9(03)V9(02) COMP-3.
  7631     12  PDM-USER-FIELDS.
  7632         16  PDM-USER-FLD-1         PIC  X(02).
  7633         16  PDM-USER-FLD-2         PIC  X(02).
  7634         16  PDM-USER-FLD-3         PIC  X(02).
  7635         16  PDM-USER-FLD-4         PIC  X(02).
  7636         16  PDM-USER-FLD-5         PIC  X(02).
  7637     12  PDM-USER-SELECT-OPTIONS.
  7638         16  PDM-USER-SELECT-1      PIC  X(10).
  7639         16  PDM-USER-SELECT-2      PIC  X(10).
  7640         16  PDM-USER-SELECT-3      PIC  X(10).
  7641         16  PDM-USER-SELECT-4      PIC  X(10).
  7642         16  PDM-USER-SELECT-5      PIC  X(10).
  7643     12  PDM-DIS-RPT021-EXP-PCT     PIC S9(03)V9(04) COMP-3.
  7644     12  PDM-ADD-RPT021-EXP-PCT     PIC S9(03)V9(04) COMP-3.
  7645     12  FILLER                       PIC  X(20).
  7646
  7647******************************************************************
  7648*                CLIENT USE AREAS                                *
  7649******************************************************************
  7650
  7651     12  PDM-CLIENT-USE-AREA-1      PIC  X(30).
  7652     12  PDM-CLIENT-USE-AREA-2      PIC  X(30).
  7653     12  PDM-CLIENT-USE-AREA-3      PIC  X(11).
  7654     12  PDM-CLIENT-USE-AREA-4      PIC  X(30).
  7655     12  PDM-CLIENT-USE-AREA-5      PIC  X(30).
  7656     12  PDM-CLIENT-USE-AREA-6      PIC  X(11).
  7657     12  PDM-CLIENT-USE-AREA-7      PIC  X(30).
  7658     12  PDM-CLIENT-USE-AREA-8      PIC  X(30).
  7659     12  PDM-CLIENT-USE-AREA-9      PIC  X(11).
  7660
  7661******************************************************************
  7662*                TRANSFER DATA                                   *
  7663******************************************************************
  7664     12  PDM-TRANSFERRED-FROM.
  7665         16  PDM-TRNFROM-CARRIER    PIC  X(01).
  7666         16  PDM-TRNFROM-GROUPING.
  7667             20  PDM-TRNFROM-GRP-PREFIX
  7668                                      PIC  X(03).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 142
* EL150.cbl
  7669             20  PDM-TRNFROM-GRP-PRIME PIC X(03).
  7670         16  PDM-TRNFROM-STATE      PIC  X(02).
  7671         16  PDM-TRNFROM-PRODUCER.
  7672             20  PDM-TRNFROM-PROD-PREFIX
  7673                                      PIC  X(04).
  7674             20  PDM-TRNFROM-PROD-PRIME
  7675                                      PIC  X(06).
  7676         16  PDM-TRNFROM-DATE       PIC  X(02).
  7677     12  PDM-TRANSFERRED-TO.
  7678         16  PDM-TRNTO-CARRIER      PIC  X(01).
  7679         16  PDM-TRNTO-GROUPING.
  7680             20  PDM-TRNTO-GRP-PREFIX PIC X(03).
  7681             20  PDM-TRNTO-GRP-PRIME PIC X(03).
  7682         16  PDM-TRNTO-STATE        PIC  X(02).
  7683         16  PDM-TRNTO-PRODUCER.
  7684             20  PDM-TRNTO-PROD-PREFIX PIC X(04).
  7685             20  PDM-TRNTO-PROD-PRIME PIC X(06).
  7686         16  PDM-TRNTO-DATE         PIC  X(02).
  7687     12  FILLER                       PIC  X(20).
  7688
  7689******************************************************************
  7690*                MORTGAGE PLANS SOLD                             *
  7691******************************************************************
  7692
  7693     12  PDM-PLANS-SOLD.
  7694         16  PDM-PRODUCER-PLANS OCCURS 40 TIMES
  7695                                INDEXED BY PDM-PLAN-NDX
  7696                                           PDM-PLAN-NDX2.
  7697             20  PDM-INDIVIDUAL-PLAN.
  7698                 24  PDM-PLAN-CODE  PIC  X(02).
  7699                 24  PDM-PLAN-REVISION PIC X(03).
  7700             20  PDM-IBNR-PERCENT   PIC S9(01)V9(04) COMP-3.
  7701     12  FILLER                       PIC  X(54).
  7702
  7703******************************************************************
  7704*                 AGENT AND COMMISSION DATA                      *
  7705******************************************************************
  7706
  7707     12  PDM-COMMISSION-INFORMATION.
  7708         16  PDM-REMIT-TO           PIC S9(03)   COMP-3.
  7709         16  PDM-RECALCULATION-SW   PIC  X(01).
  7710             88  PDM-RECALC-DETAIL          VALUE 'Y'.
  7711             88  PDM-RECALC-NO-DETAIL       VALUE 'I'.
  7712             88  PDM-IGNORE-RECALC          VALUE 'N'.
  7713             88  PDM-VALID-RECALCULATION-SW VALUE 'Y' 'I' 'N'.
  7714         16  PDM-AGENT-DATA.
  7715             20  PDM-AGENT-ENTRY    OCCURS 5 TIMES
  7716                                    INDEXED BY PDM-AGENT-NDX
  7717                                               PDM-AGENT-NDX2.
  7718                 24  PDM-AGENT-NUMBER PIC X(10).
  7719                 24  PDM-AGENT-TYPE PIC  X(01).
  7720                     88  PDM-AGENT-TYPE-A   VALUE 'C' 'D'.
  7721                     88  PDM-AGENT-TYPE-G   VALUE 'O' 'R'
  7722                                                    'P' 'T'
  7723                                                    'W'.
  7724                     88  PDM-AGENT-GROSS    VALUE 'C'.
  7725                     88  PDM-AGENT-REINS    VALUE 'R'.
  7726                     88  PDM-AGENT-GROSS-REINS VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 143
* EL150.cbl
  7727                     88  PDM-OVERWRITE-GROSS VALUE 'O'.
  7728                     88  PDM-OVERWRITE-GROSS-REINS
  7729                                          VALUE 'P'.
  7730                     88  PDM-OVERWRITE-REINS VALUE 'T'.
  7731                     88  PDM-REINS-ONLY     VALUE 'W'.
  7732                     88  PDM-VALID-AGENT-TYPE VALUE 'C' 'R'
  7733                                                'D' 'O' 'P'
  7734                                                'T' 'W'.
  7735                 24  PDM-COMMISSION-BILLED-PAID
  7736                                      PIC  X(01).
  7737                     88  PDM-AGENT-BILLED   VALUE 'B'.
  7738                     88  PDM-AGENT-PAID     VALUE 'P'.
  7739                 24  PDM-COMP-RECALC-FLAG
  7740                                      PIC  X(01).
  7741                     88  PDM-BYPASS-RECALC  VALUE 'N'.
  7742                     88  PDM-VALID-RECALC-FLAG VALUE ' ' 'N'.
  7743     12  FILLER                       PIC  X(55).
  7744
  7745******************************************************************
  7746*                BANK DATA                                       *
  7747******************************************************************
  7748
  7749     12  PDM-BANK-ACCOUNT-NUMBER    PIC  X(20).
  7750     12  PDM-BANK-TRANSIT-NUMBER.
  7751         16  PDM-FEDERAL-NUMBER     PIC  X(04).
  7752         16  PDM-BANK-NUMBER        PIC  X(04).
  7753     12  PDM-CHARGE-CARD-EXP-DT     PIC  X(02).
  7754     12  PDM-CHARGE-CARD-TYPE       PIC  X(02).
  7755         88  PDM-AMERICAN-EXPRESS              VALUE 'AE'.
  7756         88  PDM-CARTE-BLANCHE                 VALUE 'CB'.
  7757         88  PDM-DINERS-CLUB                   VALUE 'DN'.
  7758         88  PDM-DISCOVER                      VALUE 'DS'.
  7759         88  PDM-MASTER-CARD                   VALUE 'MC'.
  7760         88  PDM-VISA                          VALUE 'VI'.
  7761     12  PDM-SIGNATURE-NAME         PIC  X(25).
  7762     12  PDM-AUTHORIZATION-SW       PIC  X(01).
  7763******************************************************************
  7764*                GENERIC FILLER                                  *
  7765******************************************************************
  7766
  7767     12  FILLER                       PIC  X(66).
  7768
  7769******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 144
* EL150.cbl
  7771*                            COPY ELCRETR.
  7772******************************************************************
  7773*                                                                *
  7774*                                                                *
  7775*                            ELCRETR.                            *
  7776*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7777*                            VMOD=2.002                          *
  7778*                                                                *
  7779*   FILE DESCRIPTION = CLAIM MASTER RETRIEVE FILE                *
  7780*                                                                *
  7781*   **** NOTE -- THIS FILE IS IDENTICAL TO CLAIM MASTER (ELMSTR) *
  7782*   ****      ANY CHANGES TO THIS COPYBOOK OR ELCMSTR MUST BE    *
  7783*   ****      DUPLICATED IN THE OTHER.                           *
  7784*                                                                *
  7785*   FILE TYPE = VSAM,KSDS                                        *
  7786*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7787*                                                                *
  7788*   BASE CLUSTER = ELRETR                         RKP=2,LEN=20   *
  7789*       ALTERNATE PATH1 = ELRETR2 (BY NAME)       RKP=22,LEN=29  *
  7790*       ALTERNATE PATH2 = ELRETR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7791*       ALTERNATE PATH3 = ELRETR5 (BY CERT NO)    RKP=63,LEN=12  *
  7792*       ALTERNATE PATH4 = ELRETR6 (BY CREDIT CARD NO)
  7793*                                                 RKP=75,LEN=21  *
  7794*                                                                *
  7795*   LOG = YES                                                    *
  7796*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7797******************************************************************
  7798 01  RETRIEVE-MASTER.
  7799     12  RL-RECORD-ID                PIC XX.
  7800         88  VALID-RL-ID         VALUE 'RL'.
  7801
  7802     12  RL-CONTROL-PRIMARY.
  7803         16  RL-COMPANY-CD           PIC X.
  7804         16  RL-CARRIER              PIC X.
  7805         16  RL-CLAIM-NO             PIC X(7).
  7806         16  RL-CERT-NO.
  7807             20  RL-CERT-PRIME       PIC X(10).
  7808             20  RL-CERT-SFX         PIC X.
  7809
  7810     12  RL-CONTROL-BY-NAME.
  7811         16  RL-COMPANY-CD-A1        PIC X.
  7812         16  RL-INSURED-LAST-NAME    PIC X(15).
  7813         16  RL-INSURED-NAME.
  7814             20  RL-INSURED-1ST-NAME PIC X(12).
  7815             20  RL-INSURED-MID-INIT PIC X.
  7816
  7817     12  RL-CONTROL-BY-SSN.
  7818         16  RL-COMPANY-CD-A2        PIC X.
  7819         16  RL-SOC-SEC-NO.
  7820             20  RL-SSN-STATE        PIC XX.
  7821             20  RL-SSN-ACCOUNT      PIC X(6).
  7822             20  RL-SSN-LN3          PIC X(3).
  7823
  7824     12  RL-CONTROL-BY-CERT-NO.
  7825         16  RL-COMPANY-CD-A4        PIC X.
  7826         16  RL-CERT-NO-A4.
  7827             20  RL-CERT-A4-PRIME    PIC X(10).
  7828             20  RL-CERT-A4-SFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 145
* EL150.cbl
  7829
  7830     12  RL-CONTROL-BY-CCN.
  7831         16  RL-COMPANY-CD-A5        PIC X.
  7832         16  RL-CCN-A5.
  7833             20  RL-CCN-NO.
  7834                 24  RL-CCN-PREFIX-A5 PIC X(4).
  7835                 24  RL-CCN-PRIME-A5 PIC X(12).
  7836             20  RL-CCN-FILLER-A5    PIC X(4).
  7837
  7838     12  RL-INSURED-PROFILE-DATA.
  7839         16  RL-INSURED-BIRTH-DT     PIC XX.
  7840         16  RL-INSURED-SEX-CD       PIC X.
  7841             88  RL-INSURED-IS-MALE     VALUE 'M'.
  7842             88  RL-INSURED-IS-FEMALE   VALUE 'F'.
  7843             88  RL-INSURED-SEX-UNKNOWN VALUE ' '.
  7844         16  RL-INSURED-OCC-CD       PIC X(6).
  7845         16  FILLER                  PIC X(5).
  7846
  7847     12  RL-PROCESSING-INFO.
  7848         16  RL-PROCESSOR-ID         PIC X(4).
  7849         16  RL-CLAIM-STATUS         PIC X.
  7850             88  RL-CLAIM-IS-OPEN       VALUE 'O'.
  7851             88  RL-CLAIM-IS-CLOSED     VALUE 'C'.
  7852         16  RL-CLAIM-TYPE           PIC X.
  7853*            88  RL-AH-CLAIM            VALUE 'A'.
  7854*            88  RL-LIFE-CLAIM          VALUE 'L'.
  7855*            88  RL-PROPERTY-CLAIM      VALUE 'P'.
  7856*            88  RL-UNEMPLOYMENT-CLAIM  VALUE 'U'.
  7857         16  RL-CLAIM-PREM-TYPE      PIC X.
  7858             88  RL-SINGLE-PREMIUM         VALUE '1'.
  7859             88  RL-O-B-COVERAGE           VALUE '2'.
  7860             88  RL-OPEN-END-COVERAGE      VALUE '3'.
  7861         16  RL-INCURRED-DT          PIC XX.
  7862         16  RL-REPORTED-DT          PIC XX.
  7863         16  RL-FILE-ESTABLISH-DT    PIC XX.
  7864         16  RL-EST-END-OF-DISAB-DT  PIC XX.
  7865         16  RL-LAST-PMT-DT          PIC XX.
  7866         16  RL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7867         16  RL-PAID-THRU-DT         PIC XX.
  7868         16  RL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7869         16  RL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7870         16  RL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7871         16  RL-PMT-CALC-METHOD      PIC X.
  7872             88  RL-360-DAY-YR          VALUE '1'.
  7873             88  RL-365-DAY-YR          VALUE '2'.
  7874             88  RL-FULL-MONTHS         VALUE '3'.
  7875         16  RL-CAUSE-CD             PIC X(6).
  7876
  7877         16  RL-PRIME-CERT-NO.
  7878             20  RL-PRIME-CERT-PRIME PIC X(10).
  7879             20  RL-PRIME-CERT-SFX   PIC X.
  7880
  7881         16  RL-SYSTEM-IDENTIFIER    PIC XX.
  7882             88  RL-CREDIT-CLAIM        VALUE 'CR'.
  7883             88  RL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7884
  7885         16  RL-MICROFILM-NO         PIC X(10).
  7886         16  RL-PROG-FORM-TYPE       PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 146
* EL150.cbl
  7887         16  RL-LAST-ADD-ON-DT       PIC XX.
  7888
  7889         16  RL-LAST-REOPEN-DT       PIC XX.
  7890         16  RL-LAST-CLOSE-DT        PIC XX.
  7891         16  RL-LAST-CLOSE-REASON    PIC X.
  7892             88  RL-FINAL-PAID          VALUE '1'.
  7893             88  RL-CLAIM-DENIED        VALUE '2'.
  7894             88  RL-AUTO-CLOSE          VALUE '3'.
  7895             88  RL-MANUAL-CLOSE        VALUE '4'.
  7896         16  RL-ASSOC-CERT-SEQU      PIC S99.
  7897         16  RL-ASSOC-CERT-TOTAL     PIC S99.
  7898         16  RL-CLAIM-PAYMENT-STATUS PIC 9.
  7899             88  RL-PAYMENT-IN-PREP     VALUE 1 THRU 9.
  7900         16  FILLER                  PIC X(5).
  7901
  7902     12  RL-CERTIFICATE-DATA.
  7903         16  RL-CERT-ORIGIN          PIC X.
  7904             88  RL-CERT-WAS-ONLINE     VALUE '1'.
  7905             88  RL-CERT-WAS-CREATED    VALUE '2'.
  7906             88  RL-COVERAGE-WAS-ADDED  VALUE '3'.
  7907         16  RL-CERT-KEY-DATA.
  7908             20  RL-CERT-CARRIER     PIC X.
  7909             20  RL-CERT-GROUPING    PIC X(6).
  7910             20  RL-CERT-STATE       PIC XX.
  7911             20  RL-CERT-ACCOUNT.
  7912                 24  RL-CERT-ACCOUNT-PREFIX PIC X(4).
  7913                 24  RL-CERT-ACCOUNT-PRIME  PIC X(6).
  7914             20  RL-CERT-EFF-DT      PIC XX.
  7915
  7916     12  RL-STATUS-CONTROLS.
  7917         16  RL-PRIORITY-CD          PIC X.
  7918             88  RL-HIGHEST-PRIORITY    VALUE '9'.
  7919         16  RL-SUPV-ATTN-CD         PIC X.
  7920             88  RL-SUPV-NOT-REQUIRED   VALUE ' ' 'N'.
  7921             88  RL-SUPV-IS-REQUIRED    VALUE 'Y'.
  7922         16  RL-PURGED-DT            PIC XX.
  7923         16  RL-RESTORED-DT          PIC XX.
  7924         16  RL-NEXT-AUTO-PAY-DT     PIC XX.
  7925         16  RL-NEXT-RESEND-DT       PIC XX.
  7926         16  RL-NEXT-FOLLOWUP-DT     PIC XX.
  7927         16  FILLER                  PIC XX.
  7928         16  RL-LAST-MAINT-DT        PIC XX.
  7929         16  RL-LAST-MAINT-USER      PIC X(4).
  7930         16  RL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7931         16  RL-LAST-MAINT-TYPE      PIC X.
  7932             88  RL-CLAIM-SET-UP           VALUE ' '.
  7933             88  RL-PAYMENT-MADE           VALUE '1'.
  7934             88  RL-LETTER-SENT            VALUE '2'.
  7935             88  RL-MASTER-WAS-ALTERED     VALUE '3'.
  7936             88  RL-MASTER-WAS-RESTORED    VALUE '4'.
  7937             88  RL-INCURRED-DATE-CHANGED  VALUE '5'.
  7938             88  RL-FILE-CONVERTED         VALUE '6'.
  7939         16  RL-RELATED-CLAIM-NO     PIC X(7).
  7940         16  RL-HISTORY-ARCHIVE-DT   PIC XX.
  7941         16  RL-BENEFICIARY          PIC X(10).
  7942         16  RL-FILE-ESTABLISHED-BY  PIC X(4).
  7943         16  FILLER                  PIC X(6).
  7944
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 147
* EL150.cbl
  7945     12  RL-TRAILER-CONTROLS.
  7946         16  RL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7947             88  RL-1ST-TRL-AVAIL       VALUE +4095.
  7948             88  RL-LAST-TRL-AVAIL      VALUE +100.
  7949             88  RL-RESV-EXP-HIST-TRLR  VALUE +0.
  7950         16  RL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7951         16  FILLER                  PIC XX.
  7952         16  RL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7953         16  RL-ADDRESS-TRAILER-CNT.
  7954             20  RL-INSURED-ADDR-CNT  PIC S9.
  7955                 88  RL-NO-INSURED-AVAILABLE VALUE ZERO.
  7956             20  RL-ACCOUNT-ADDR-CNT  PIC S9.
  7957                 88  RL-ACCOUNT-IS-ONLINE    VALUE ZERO.
  7958             20  RL-BENIF-ADDR-CNT    PIC S9.
  7959                 88  RL-BENEFICIARY-IS-ONLINE VALUE ZERO.
  7960             20  RL-EMPLOYER-ADDR-CNT PIC S9.
  7961                 88  RL-NO-EMPLOY-AVAILABLE   VALUE ZERO.
  7962             20  RL-DOCTOR-ADDR-CNT   PIC S9.
  7963                 88  RL-NO-DOCTOR-AVAILABLE   VALUE ZERO.
  7964             20  RL-OTHER-1-ADDR-CNT  PIC S9.
  7965                 88  RL-NO-OTHER-1-ADDRESSES  VALUE ZERO.
  7966             20  RL-OTHER-2-ADDR-CNT  PIC S9.
  7967                 88  RL-NO-OTHER-2-ADDRESSES  VALUE ZERO.
  7968
  7969     12  RL-CV-REFERENCE-NO.
  7970         16  RL-CV-REFNO-PRIME       PIC X(18).
  7971         16  RL-CV-REFNO-SFX         PIC XX.
  7972
  7973     12  RL-FILE-LOCATION            PIC X(4).
  7974
  7975     12  RL-PROCESS-ERRORS.
  7976         16  RL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7977             88  RL-NO-FATAL-ERRORS     VALUE ZERO.
  7978         16  RL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7979             88  RL-NO-FORCABLE-ERRORS  VALUE ZERO.
  7980
  7981     12  RL-PRODUCT-CD               PIC X.
  7982
  7983     12  RL-CURRENT-KEY-DATA.
  7984         16  RL-CURRENT-CARRIER      PIC X.
  7985         16  RL-CURRENT-GROUPING     PIC X(6).
  7986         16  RL-CURRENT-STATE        PIC XX.
  7987         16  RL-CURRENT-ACCOUNT      PIC X(10).
  7988
  7989     12  RL-ASSOCIATES               PIC X.
  7990         88  RL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7991         88  RL-ASSOC-INTERFACE         VALUE 'I'.
  7992         88  RL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7993         88  RL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7994
  7995     12  RL-ACTIVITY-CODE            PIC 99.
  7996     12  RL-ACTIVITY-MAINT-DT        PIC XX.
  7997     12  RL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7998
  7999     12  RL-LAPSE-REPORT-CODE        PIC 9.
  8000     12  RL-LAG-REPORT-CODE          PIC 9.
  8001     12  RL-LOAN-TYPE                PIC XX.
  8002     12  RL-LEGAL-STATE              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 148
* EL150.cbl
  8003
  8004     12  FILLER                      PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 149
* EL150.cbl
  8006*                COPY MTCPHST REPLACING ==:TAG:== BY ==PH==.
  8007******************************************************************
  8008*                                                                *
  8009*                           MTCPHST                              *
  8010*                            VMOD=1.001                          *
  8011*                                                                *
  8012*   FILE DESCRIPTION = POLICY HISTORY FILE                       *
  8013*                                                                *
  8014*   FILE TYPE = VSAM,KSDS                                        *
  8015*   RECORD SIZE = 132  RECFORM = FIXED                           *
  8016*                                                                *
  8017*   BASE CLUSTER = MPPHST                         RKP=2,LEN=46   *
  8018*       ALTERNATE (NONE)                                         *
  8019*                                                                *
  8020*   LOG = YES                                                    *
  8021*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8022******************************************************************
  8023
  8024 01  POLICY-HISTORY.
  8025     12 PH-RECORD-ID                    PIC XX.
  8026         88  VALID-PH-ID                      VALUE 'PH'.
  8027
  8028******************************************************************
  8029*   BASE CLUSTER = MPPHST         (BASE KEY)      RKP=2,LEN=46   *
  8030******************************************************************
  8031
  8032     12 PH-CONTROL-PRIMARY.
  8033         16 PH-COMPANY-CD               PIC X.
  8034         16 PH-CARRIER                  PIC X.
  8035         16 PH-GROUPING.
  8036             20 PH-GROUPING-PREFIX      PIC X(3).
  8037             20 PH-GROUPING-PRIME       PIC X(3).
  8038         16 PH-STATE                    PIC XX.
  8039         16 PH-PRODUCER.
  8040             20 PH-PRODUCER-PREFIX      PIC X(4).
  8041             20 PH-PRODUCER-PRIME       PIC X(6).
  8042         16 PH-POLICY-EFF-DT            PIC XX.
  8043         16 PH-POLICY-NO.
  8044             20 PH-POLICY-PRIME         PIC X(18).
  8045             20 PH-POLICY-SFX           PIC XX.
  8046         16 PH-RECORD-TYPE              PIC X(2).
  8047         16 PH-FIELD-TYPE               PIC X(2).
  8048         16 PH-SEQUENCE-NO              PIC S9(4)    COMP.
  8049             88 PH-1ST-HISTORY-REC         VALUE +4095.
  8050     12  FILLER                            PIC X(16).
  8051
  8052******************************************************************
  8053*                 FILE SYNCHRONIZATION DATA                      *
  8054******************************************************************
  8055
  8056     12 PH-FILE-SYNCH-DATA.
  8057         16 PH-TRANSACTION-ID           PIC X(4).
  8058         16 PH-CHANGE-DT                PIC XX.
  8059         16 PH-CHANGE-TIME              PIC S9(7)  COMP-3.
  8060         16 PH-CHANGE-PROCESSOR         PIC X(4).
  8061         16 PH-MONTH-END-DT             PIC XX.
  8062
  8063******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 150
* EL150.cbl
  8064*                 POLICY HISTORY RECORD BODY                     *
  8065******************************************************************
  8066
  8067     12 PH-RECORD-BODY                  PIC X(50).
  8068
  8069******************************************************************
  8070*                       NUMERIC DATA                             *
  8071******************************************************************
  8072     12  FILLER           REDEFINES PH-RECORD-BODY.
  8073         20 PH-NUMERIC-FLD1             PIC S9(10)V99.
  8074         20  FILLER                        PIC X(38).
  8075
  8076     12  FILLER           REDEFINES PH-RECORD-BODY.
  8077         20 PH-NUMERIC-FLD2             PIC S9(2)V999.
  8078         20  FILLER                        PIC X(45).
  8079
  8080     12  FILLER           REDEFINES PH-RECORD-BODY.
  8081         20 PH-NUMERIC-FLD3             PIC S9(15).
  8082         20  FILLER                        PIC X(35).
  8083
  8084******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 151
* EL150.cbl
  8086 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER-L
  8087                          CONTROL-FILE CERTIFICATE-MASTER
  8088                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8089                          ACCOUNT-MASTER LETTER-ARCHIVE
  8090                          CERTIFICATE-TRAILERS POLICY-MASTER
  8091                          PRODUCER-PLANS PRODUCER-MASTER
  8092                          RETRIEVE-MASTER POLICY-HISTORY.
  8093 0000-DFHEXIT SECTION.
  8094     MOVE '9#                    $   ' TO DFHEIV0.
  8095     MOVE 'EL150' TO DFHEIV1.
  8096     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8097
  8098     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8099     MOVE '5'                    TO DC-OPTION-CODE.
  8100     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8101     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  8102     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  8103
  8104     IF EIBCALEN = 0
  8105         GO TO 8800-UNAUTHORIZED-ACCESS.
  8106
  8107     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8108
  8109     IF PI-COMPANY-ID NOT = 'DMD'
  8110         MOVE SPACES             TO WST-REM-DAYS-GRP
  8111                                    WST-ORIG-DAYS-GRP.
  8112
  8113     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8114     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8115
  8116     MOVE EIBTRMID               TO QID-TERM.
  8117
  8118
  8119* EXEC CICS HANDLE CONDITION
  8120*        QIDERR   (1000-SHOW-CLAIM)
  8121*        MAPFAIL  (0100-FIRST-TIME-IN)
  8122*        NOTOPEN  (8500-FILE-NOTOPEN)
  8123*        PGMIDERR (9600-PGMID-ERROR)
  8124*        ERROR    (9990-ABEND)
  8125*    END-EXEC.
  8126*    MOVE '"$N?JL.               ! " #00008114' TO DFHEIV0
  8127     MOVE X'22244E3F4A4C2E2020202020' TO DFHEIV0(1:12)
  8128     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8129     MOVE X'2220233030303038313134' TO DFHEIV0(25:11)
  8130     CALL 'kxdfhei1' USING DFHEIV0
  8131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8132
  8133
  8134     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8135         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8136
  8137     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8138         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8139             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8140             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8141             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8142             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8143             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 152
* EL150.cbl
  8144             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8145             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8146             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8147         ELSE
  8148             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8149             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8150             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8151             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8152             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8153             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8154             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8155             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8156
  8157     IF (RETURNED-FROM NOT = SPACES)
  8158        and (pi-save-map not = crtt-map)
  8159         GO TO 0600-RECOVER-TEMP-STORAGE.
  8160
  8161     IF EIBAID = DFHCLEAR
  8162         GO TO 9400-CLEAR.
  8163
  8164     IF PI-PROCESSOR-ID = 'LGXX'
  8165         NEXT SENTENCE
  8166     ELSE
  8167
  8168* EXEC CICS READQ TS
  8169*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8170*            INTO    (SECURITY-CONTROL)
  8171*            LENGTH  (SC-COMM-LENGTH)
  8172*            ITEM    (SC-ITEM)
  8173*        END-EXEC
  8174*    MOVE '*$II   L              ''   #00008155' TO DFHEIV0
  8175     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8176     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8177     MOVE X'2020233030303038313535' TO DFHEIV0(25:11)
  8178     CALL 'kxdfhei1' USING DFHEIV0,
  8179           PI-SECURITY-TEMP-STORE-ID,
  8180           SECURITY-CONTROL,
  8181           SC-COMM-LENGTH,
  8182           SC-ITEM,
  8183           DFHEIV99,
  8184           DFHEIV99
  8185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8186         MOVE SC-CLAIMS-DISPLAY (16)  TO  PI-DISPLAY-CAP
  8187         MOVE SC-CLAIMS-UPDATE  (16)  TO  PI-MODIFY-CAP
  8188         IF NOT DISPLAY-CAP
  8189             MOVE 'READ'              TO  SM-READ
  8190             PERFORM 9995-SECURITY-VIOLATION
  8191             MOVE ER-0070             TO  EMI-ERROR
  8192             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8193             GO TO 8100-SEND-INITIAL-MAP.
  8194
  8195     IF EIBTRNID = TRANS-ID
  8196         GO TO 0200-RECEIVE.
  8197
  8198 0100-FIRST-TIME-IN.
  8199
  8200     MOVE LOW-VALUES             TO EL150AO.
  8201
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 153
* EL150.cbl
  8202     IF NOT PI-CONFIDENTIAL-UP
  8203         MOVE LOW-VALUES         TO PI-REDEF.
  8204
  8205     MOVE 'ELMSTR'               TO PI-CURRENT-FILE.
  8206     MOVE ZEROS                  TO PI-TOTAL-PAID
  8207                                    PI-DAYS-PAID
  8208                                    PI-LAST-SEQ-NO.
  8209
  8210     MOVE 0                      TO PI-FORCE-COUNT.
  8211
  8212     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  8213     MOVE '2'                    TO CNTL-REC-TYPE.
  8214     MOVE +0                     TO CNTL-SEQ-NO.
  8215     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
  8216     MOVE 'CNTL'                 TO FILE-SWITCH.
  8217
  8218
  8219* EXEC CICS READ
  8220*         DATASET  ('ELCNTL')
  8221*         SET      (ADDRESS OF CONTROL-FILE)
  8222*         RIDFLD   (ELCNTL-KEY)
  8223*         RESP     (WS-RESPONSE)
  8224*    END-EXEC.
  8225     MOVE 'ELCNTL' TO DFHEIV1
  8226*    MOVE '&"S        E          (  N#00008193' TO DFHEIV0
  8227     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8228     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8229     MOVE X'204E233030303038313933' TO DFHEIV0(25:11)
  8230     CALL 'kxdfhei1' USING DFHEIV0,
  8231           DFHEIV1,
  8232           DFHEIV20,
  8233           DFHEIV99,
  8234           ELCNTL-KEY,
  8235           DFHEIV99,
  8236           DFHEIV99,
  8237           DFHEIV99
  8238     SET ADDRESS OF CONTROL-FILE TO
  8239         DFHEIV20
  8240     MOVE EIBRESP  TO WS-RESPONSE
  8241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8242
  8243
  8244     IF WS-RESP-NORMAL
  8245        MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL
  8246     END-IF.
  8247
  8248
  8249
  8250* EXEC CICS DELETEQ TS
  8251*        QUEUE(QID)
  8252*    END-EXEC.
  8253*    MOVE '*&                    #   #00008205' TO DFHEIV0
  8254     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8255     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8256     MOVE X'2020233030303038323035' TO DFHEIV0(25:11)
  8257     CALL 'kxdfhei1' USING DFHEIV0,
  8258           QID,
  8259           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 154
* EL150.cbl
  8260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8261
  8262
  8263     GO TO 1000-SHOW-CLAIM.
  8264
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 155
* EL150.cbl
  8266 0200-RECEIVE.
  8267     MOVE 'B'                    TO PASS-SWITCH.
  8268
  8269     MOVE LOW-VALUES             TO EL150AI.
  8270
  8271     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8272         MOVE ER-0008            TO EMI-ERROR
  8273         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8274         MOVE -1                 TO FILETOL
  8275         GO TO 8200-SEND-DATAONLY.
  8276
  8277     if pi-save-map = crtt-map
  8278        move pi-save-map to map-name
  8279     end-if
  8280
  8281* EXEC CICS RECEIVE
  8282*        MAP      (MAP-NAME)
  8283*        MAPSET   (MAPSET-NAME)
  8284*        INTO     (EL150AI)
  8285*    END-EXEC.
  8286     MOVE LENGTH OF
  8287      EL150AI
  8288       TO DFHEIV11
  8289*    MOVE '8"T I  L              ''   #00008226' TO DFHEIV0
  8290     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8291     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8292     MOVE X'2020233030303038323236' TO DFHEIV0(25:11)
  8293     CALL 'kxdfhei1' USING DFHEIV0,
  8294           MAP-NAME,
  8295           EL150AI,
  8296           DFHEIV11,
  8297           MAPSET-NAME,
  8298           DFHEIV99,
  8299           DFHEIV99
  8300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8301
  8302
  8303     if pi-save-map = crtt-map
  8304        move spaces              to pi-save-map
  8305        move sad-map             to map-name
  8306        go to 0100-first-time-in
  8307     end-if
  8308     IF ENTERPFL = 0
  8309         GO TO 0300-CHECK-PFKEYS.
  8310
  8311     IF EIBAID NOT = DFHENTER
  8312         MOVE ER-0004            TO EMI-ERROR
  8313         GO TO 0320-INPUT-ERROR.
  8314
  8315     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8316         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8317     ELSE
  8318         MOVE ER-0029            TO EMI-ERROR
  8319         GO TO 0320-INPUT-ERROR.
  8320
  8321 0300-CHECK-PFKEYS.
  8322     IF EIBAID = DFHPF23
  8323         GO TO 8810-PF23.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 156
* EL150.cbl
  8324
  8325     IF EIBAID = DFHPF24
  8326         GO TO 9200-RETURN-MAIN-MENU.
  8327
  8328     IF EIBAID = DFHPF12
  8329         GO TO 9500-PF12.
  8330
  8331     IF (EIBAID = DFHPF22) AND (NOT FORCE-CAP)
  8332         MOVE ER-0433            TO EMI-ERROR
  8333         GO TO 0320-INPUT-ERROR.
  8334
  8335     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF22)
  8336         MOVE ER-0500            TO EMI-ERROR
  8337         GO TO 0320-INPUT-ERROR.
  8338
  8339     IF PI-RETRIEVED-DATA
  8340         IF EIBAID = DFHPF1  OR DFHPF2 OR DFHPF15 OR
  8341                     DFHPF16 OR DFHPF21
  8342             NEXT SENTENCE
  8343         ELSE
  8344             MOVE ER-0926        TO EMI-ERROR
  8345             GO TO 0320-INPUT-ERROR.
  8346
  8347     IF EIBAID = DFHPF21
  8348         IF NOT PI-RETRIEVED-DATA
  8349             PERFORM 7650-CREATE-ACTQ THRU 7650-EXIT
  8350             MOVE ER-0927        TO EMI-ERROR
  8351             GO TO 0320-INPUT-ERROR
  8352         ELSE
  8353             GO TO 7700-CREATE-CLAIM.
  8354
  8355     IF CLAIM-IS-PURGED
  8356         IF EIBAID = DFHPF1  OR DFHPF2  OR DFHPF3  OR DFHPF4  OR
  8357                     DFHPF6  OR DFHPF7  OR DFHPF8  OR DFHPF9  OR
  8358                     DFHPF10 OR DFHPF11 OR DFHPF13 OR DFHPF14 OR
  8359                     DFHPF17 OR DFHPF18 OR DFHPF20
  8360                       MOVE -1            TO  ENTERPFL
  8361                       MOVE 'CLAIM IS PURGED, PFKEYS ARE INVALID'
  8362                                          TO  MAP-DISPLAY (1)
  8363                         GO TO 8200-SEND-DATAONLY.
  8364
  8365     IF (PI-SUPERVISOR-ONLY)
  8366        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  8367             AND 'AMWA')
  8368*       NOT SYSTEM-MODIFY-CAP
  8369*        IF EIBAID = DFHPF3  OR DFHPF6  OR DFHPF7  OR DFHPF8  OR
  8370         IF EIBAID = DFHPF4  OR DFHPF6  OR DFHPF7  OR DFHPF8  OR
  8371                     DFHPF9  or
  8372                     DFHPF11 OR DFHPF13 OR DFHPF14 OR DFHPF17 OR
  8373                     DFHPF21 OR DFHENTER
  8374             MOVE -1             TO ENTERPFL
  8375             MOVE ER-0931        TO EMI-ERROR
  8376             GO TO 0320-INPUT-ERROR.
  8377
  8378     IF EIBAID = DFHPF13 OR DFHPF19 OR DFHPF20
  8379         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  8380             MOVE ER-0029            TO  EMI-ERROR
  8381             GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 157
* EL150.cbl
  8382
  8383     IF EIBAID = DFHPF5 OR DFHPF18 OR DFHPF19 OR DFHPF20
  8384         IF PI-COMPANY-ID = 'DMD'
  8385             AND
  8386            NOT SYSTEM-MODIFY-CAP
  8387            IF PI-PRIORITY-9
  8388               MOVE ER-0931            TO  EMI-ERROR
  8389               GO TO 0320-INPUT-ERROR.
  8390
  8391     IF EIBAID = DFHPF7 OR DFHPF6
  8392         IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
  8393            AND PI-TOTAL-PAID NOT GREATER THAN +0
  8394             MOVE EIBAID             TO PI-PFKEY-USED
  8395             MOVE ER-3550            TO  EMI-ERROR
  8396             GO TO 0320-INPUT-ERROR.
  8397
  8398     IF EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF7
  8399                 GO TO 0500-CREATE-TEMP-STORAGE.
  8400     IF EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF6
  8401         IF PI-SAVE-TYPE = 'L'
  8402             MOVE ER-0376        TO EMI-ERROR
  8403             GO TO 0320-INPUT-ERROR
  8404         ELSE
  8405             GO TO 0500-CREATE-TEMP-STORAGE.
  8406
  8407     IF EIBAID = DFHPF3  OR DFHPF4  OR DFHPF5  OR DFHPF7  OR
  8408                 DFHPF8  OR DFHPF9  OR DFHPF10 OR DFHPF13 OR
  8409                 DFHPF14 OR DFHPF17 OR DFHPF18 OR DFHPF19 OR
  8410                 DFHPF20 or dfhpf11
  8411                 GO TO 0500-CREATE-TEMP-STORAGE.
  8412
  8413     IF EIBAID = DFHPF6
  8414         IF PI-SAVE-TYPE = 'L'
  8415             MOVE ER-0376        TO EMI-ERROR
  8416             GO TO 0320-INPUT-ERROR
  8417         ELSE
  8418             GO TO 0500-CREATE-TEMP-STORAGE.
  8419
  8420     MOVE SPACES                 TO ERRMSG1O.
  8421
  8422     IF EIBAID = DFHPF15
  8423         GO TO 7000-START-BROWSE.
  8424
  8425     IF EIBAID = DFHPF16
  8426         GO TO 7500-START-BROWSE.
  8427
  8428     IF EIBAID = DFHPF1
  8429         MOVE 'F'                TO DIRECTION-SWITCH
  8430         GO TO 1600-ROLL-TRAILERS.
  8431
  8432     IF EIBAID = DFHPF2
  8433         MOVE 'B'                TO DIRECTION-SWITCH
  8434         GO TO 1600-ROLL-TRAILERS.
  8435
  8436     IF EIBAID = DFHENTER
  8437         GO TO 0330-EDIT-DATA.
  8438
  8439*      string "EIBAID = " eibaid into map-display (1)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 158
* EL150.cbl
  8440*      GO TO 8200-SEND-DATAONLY.
  8441     MOVE ER-0029                TO EMI-ERROR.
  8442
  8443 0320-INPUT-ERROR.
  8444     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8445
  8446     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT.
  8447
  8448     IF ENTERPFL = 0
  8449         MOVE -1                 TO FILETOL
  8450     ELSE
  8451         MOVE AL-UNBON           TO ENTERPFA
  8452         MOVE -1                 TO ENTERPFL.
  8453
  8454     GO TO 8200-SEND-DATAONLY.
  8455
  8456 0330-EDIT-DATA.
  8457
  8458     MOVE 0                      TO PI-FORCE-COUNT.
  8459
  8460     IF NOT MODIFY-CAP
  8461         MOVE 'UPDATE'           TO  SM-READ
  8462         PERFORM 9995-SECURITY-VIOLATION
  8463         MOVE ER-0070            TO  EMI-ERROR
  8464         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8465         GO TO 8100-SEND-INITIAL-MAP.
  8466
  8467     IF CLMNOL  > 0 OR
  8468        CARRL   > 0 OR
  8469        CERTNOL > 0 OR
  8470        SUFXL   > 0
  8471            GO TO 1000-SHOW-CLAIM.
  8472
  8473     IF YESNOSWL > 0
  8474         MOVE AL-UANON           TO YESNOSWA.
  8475
  8476*    IF MCRFLML > 0
  8477*        MOVE AL-UANON           TO MCRFLMA.
  8478
  8479     IF FILETOL > 0
  8480         MOVE AL-UANON           TO FILETOA.
  8481
  8482     IF CLOANL > 0
  8483        MOVE AL-UANON            TO CLOANA
  8484     END-IF
  8485
  8486     IF TOTINTL > 0
  8487         MOVE AL-UNNON           TO TOTINTA
  8488     END-IF
  8489
  8490     IF PRTOPTL > 0
  8491        IF PRTOPTI NOT = 'N' AND 'L'
  8492           MOVE AL-UABON         TO PRTOPTA
  8493           MOVE -1               TO PRTOPTL
  8494           MOVE ER-0334 TO EMI-ERROR
  8495           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8496        ELSE
  8497           MOVE AL-UANON         TO PRTOPTA.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 159
* EL150.cbl
  8498
  8499     IF PRTOPTL > 0
  8500         IF (NOT PI-NO-CARRIER-SECURITY OR
  8501             NOT PI-NO-ACCOUNT-SECURITY)
  8502             IF PRTOPTI NOT = 'N'
  8503                 MOVE AL-UABON   TO PRTOPTA
  8504                 MOVE -1         TO PRTOPTL
  8505                 MOVE ER-2378    TO EMI-ERROR
  8506                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8507
  8508     IF FORMATL > 0
  8509         IF FORMATI NOT = 'F' AND 'P'
  8510             MOVE AL-UABON       TO FORMATA
  8511             MOVE -1             TO FORMATL
  8512             MOVE ER-0335        TO EMI-ERROR
  8513             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8514         ELSE
  8515             MOVE AL-UANON       TO FORMATA.
  8516
  8517     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  8518         IF ASSOCL > +0
  8519             IF ASSOCI = 'A' OR 'I' OR 'N' OR 'M'
  8520                 MOVE AL-UANON   TO  ASSOCA
  8521             ELSE
  8522                 MOVE AL-UABON   TO  ASSOCA
  8523                 MOVE -1         TO  ASSOCL
  8524                 MOVE ER-0804    TO  EMI-ERROR
  8525                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8526
  8527 0335-EDIT-ACTIVITY-CODE.
  8528******************************************************************
  8529*    THIS PARAGRAPH DETERMINES IF THE COMPANY IS CURRENTLY USING *
  8530*    THE AUTOMATIC ACTIVITY FUNCTIONS OF THE SYSTEM AND, IF SO,  *
  8531*    WHAT FUNCTIONS ARE TO BE PERFORMED BASED ON THE CODES SET   *
  8532*    IN THE AUTOMATIC ACTIVITY RECORD.                           *
  8533******************************************************************
  8534
  8535     IF ACTCDL = +0
  8536         GO TO 0340-EDIT-DATA.
  8537
  8538     IF ACTCDI IS NOT NUMERIC
  8539         MOVE ZEROS              TO  ACTCDI
  8540         MOVE AL-UABON           TO  ACTCDA
  8541         MOVE -1                 TO  ACTCDL
  8542         MOVE ER-3526            TO  EMI-ERROR
  8543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8544         GO TO 0340-EDIT-DATA.
  8545
  8546     MOVE ACTCDI                 TO  WS-ACTIVITY-CODE.
  8547     IF NOT VALID-ACTIVITY-CODE
  8548         MOVE AL-UABON           TO  ACTCDA
  8549         MOVE -1                 TO  ACTCDL
  8550         MOVE ER-3526            TO  EMI-ERROR
  8551         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8552         GO TO 0340-EDIT-DATA.
  8553
  8554     MOVE 'CNTL'                 TO  FILE-SWITCH.
  8555     PERFORM 6000-CHECK-AUTO-ACTIVITY THRU 6000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 160
* EL150.cbl
  8556
  8557     IF WS-ACT-REC-FOUND-SW = 'N'
  8558          MOVE +0                TO  ACTCDL
  8559          GO TO 0340-EDIT-DATA.
  8560
  8561     IF ACTCDI = ZEROS
  8562         NEXT SENTENCE
  8563     ELSE
  8564         MOVE ACTCDI             TO  SUB
  8565         SUBTRACT +9 FROM SUB
  8566         IF CF-USER-ACTIVE-SW (SUB) = ' ' OR 'N'
  8567             MOVE AL-UABON       TO  ACTCDA
  8568             MOVE -1             TO  ACTCDL
  8569             MOVE ER-3545        TO  EMI-ERROR
  8570             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8571             GO TO 0340-EDIT-DATA.
  8572
  8573     IF ACTCDI = ZEROS
  8574         IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CIG' OR 'CUK'
  8575             PERFORM 6100-RESET-AUTO-ACTIVITY THRU 6100-EXIT
  8576             MOVE AL-UANOF       TO  ACTCDA
  8577             GO TO 0340-EDIT-DATA.
  8578
  8579     MOVE 'Y'                    TO  WS-LETTER-SW.
  8580     MOVE AL-UANOF               TO  ACTCDA.
  8581
  8582 0340-EDIT-DATA.
  8583
  8584     IF EMI-NO-ERRORS
  8585         IF PRTOPTL NOT = FORMATL
  8586             MOVE AL-UABON       TO PRTOPTA  FORMATA
  8587             MOVE -1             TO PRTOPTL
  8588             MOVE ER-0336 TO EMI-ERROR
  8589             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8590
  8591     IF PRTOPTL > 0
  8592        IF (NOT PI-NO-CARRIER-SECURITY OR
  8593            NOT PI-NO-ACCOUNT-SECURITY)
  8594           IF ALTPRTL NOT > 0
  8595              MOVE AL-UABON      TO ALTPRTA
  8596              MOVE -1            TO ALTPRTL
  8597              MOVE ER-2379       TO EMI-ERROR
  8598              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8599
  8600     IF NOT EMI-NO-ERRORS
  8601         IF EMI-FORCABLE-CTR = ZEROS AND
  8602            EMI-FATAL-CTR = ZEROS
  8603             NEXT SENTENCE
  8604         ELSE
  8605             GO TO 8200-SEND-DATAONLY.
  8606
  8607     IF FILETOL NOT > 0        AND
  8608*       MCRFLML NOT > 0        AND
  8609        ACTCDL  NOT > 0        AND
  8610        ASSOCL  NOT > 0        AND
  8611        CLOANL  NOT > 0        AND
  8612        TOTINTL NOT > 0        AND
  8613        YESNOSWL NOT > 0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 161
* EL150.cbl
  8614         GO TO 0350-PROCESS-OPTIONS.
  8615
  8616
  8617* EXEC CICS HANDLE CONDITION
  8618*        NOTFND   (0450-NOT-FOUND)
  8619*    END-EXEC.
  8620*    MOVE '"$I                   ! # #00008545' TO DFHEIV0
  8621     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8622     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8623     MOVE X'2320233030303038353435' TO DFHEIV0(25:11)
  8624     CALL 'kxdfhei1' USING DFHEIV0
  8625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8626
  8627
  8628     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8629     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8630     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  8631     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8632     MOVE 'MSTR'                 TO FILE-SWITCH.
  8633
  8634
  8635* EXEC CICS READ
  8636*        UPDATE
  8637*        DATASET   ('ELMSTR')
  8638*        RIDFLD    (ELMSTR-KEY)
  8639*        INTO      (CLAIM-MASTER)
  8640*    END-EXEC.
  8641     MOVE LENGTH OF
  8642      CLAIM-MASTER
  8643       TO DFHEIV11
  8644     MOVE 'ELMSTR' TO DFHEIV1
  8645*    MOVE '&"IL       EU         (   #00008555' TO DFHEIV0
  8646     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8647     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8648     MOVE X'2020233030303038353535' TO DFHEIV0(25:11)
  8649     CALL 'kxdfhei1' USING DFHEIV0,
  8650           DFHEIV1,
  8651           CLAIM-MASTER,
  8652           DFHEIV11,
  8653           ELMSTR-KEY,
  8654           DFHEIV99,
  8655           DFHEIV99,
  8656           DFHEIV99
  8657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8658
  8659
  8660     IF ACTCDL > +0
  8661         IF CL-LAST-MAINT-USER NOT = PI-UPDATE-BY
  8662             MOVE ER-0068        TO  EMI-ERROR
  8663             MOVE -1             TO  ACTCDL
  8664             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8665             GO TO 8200-SEND-DATAONLY
  8666         ELSE
  8667             NEXT SENTENCE
  8668     ELSE
  8669         IF (CL-LAST-MAINT-USER NOT = PI-UPDATE-BY) OR
  8670            (CL-LAST-MAINT-HHMMSS NOT = PI-UPDATE-HHMMSS)
  8671               MOVE ER-0068      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 162
* EL150.cbl
  8672               MOVE -1           TO FILETOL
  8673               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8674               GO TO 8200-SEND-DATAONLY.
  8675
  8676     MOVE 'ELMSTR  '             TO FILE-ID.
  8677
  8678*    IF MCRFLML > 0
  8679*        MOVE MCRFLMI            TO CL-MICROFILM-NO.
  8680
  8681     IF FILETOL > 0
  8682         IF FILETOI  = CL-FILE-LOCATION
  8683             MOVE ZEROS          TO FILETOL
  8684         ELSE
  8685             MOVE FILETOI        TO CL-FILE-LOCATION.
  8686
  8687     IF TOTINTL > 0
  8688
  8689* EXEC CICS BIF DEEDIT
  8690*            FIELD(TOTINTI)
  8691*            LENGTH(9)
  8692*        END-EXEC
  8693     MOVE 9
  8694       TO DFHEIV11
  8695*    MOVE '@"L                   #   #00008590' TO DFHEIV0
  8696     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8697     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8698     MOVE X'2020233030303038353930' TO DFHEIV0(25:11)
  8699     CALL 'kxdfhei1' USING DFHEIV0,
  8700           TOTINTI,
  8701           DFHEIV11
  8702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8703         IF TOTINTI  = CL-TOTAL-INT-PAID
  8704             MOVE ZEROS          TO TOTINTL
  8705         ELSE
  8706             MOVE TOTINTI        TO CL-TOTAL-INT-PAID
  8707     END-IF.
  8708
  8709     IF CLOANL > 0
  8710        IF CLOANI NOT = SPACES
  8711           MOVE CL-CONTROL-PRIMARY
  8712                                 TO ELTRLR-KEY
  8713           MOVE +91              TO TRLR-SEQ-NO
  8714           MOVE 'TRLR'           TO FILE-SWITCH
  8715
  8716* EXEC CICS READ
  8717*             UPDATE
  8718*             DATASET   ('ELTRLR')
  8719*             RIDFLD    (ELTRLR-KEY)
  8720*             SET       (ADDRESS OF ACTIVITY-TRAILERS)
  8721*             RESP      (WS-RESPONSE)
  8722*          END-EXEC
  8723     MOVE 'ELTRLR' TO DFHEIV1
  8724*    MOVE '&"S        EU         (  N#00008606' TO DFHEIV0
  8725     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8726     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8727     MOVE X'204E233030303038363036' TO DFHEIV0(25:11)
  8728     CALL 'kxdfhei1' USING DFHEIV0,
  8729           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 163
* EL150.cbl
  8730           DFHEIV20,
  8731           DFHEIV99,
  8732           ELTRLR-KEY,
  8733           DFHEIV99,
  8734           DFHEIV99,
  8735           DFHEIV99
  8736     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8737         DFHEIV20
  8738     MOVE EIBRESP  TO WS-RESPONSE
  8739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8740           IF WS-RESP-NORMAL
  8741              MOVE CLOANI        TO AT-INFO-LINE-1
  8742              MOVE PI-PROCESSOR-ID
  8743                                 TO AT-GEN-INFO-LAST-UPDATED-BY
  8744              MOVE SAVE-BIN-DATE TO AT-GEN-INFO-LAST-MAINT-DT
  8745              MOVE EIBTIME       TO AT-LAST-MAINT-HHMMSS
  8746
  8747* EXEC CICS REWRITE
  8748*                DATASET   ('ELTRLR')
  8749*                FROM      (ACTIVITY-TRAILERS)
  8750*             END-EXEC
  8751     MOVE LENGTH OF
  8752      ACTIVITY-TRAILERS
  8753       TO DFHEIV11
  8754     MOVE 'ELTRLR' TO DFHEIV1
  8755*    MOVE '&& L                  %   #00008619' TO DFHEIV0
  8756     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8757     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8758     MOVE X'2020233030303038363139' TO DFHEIV0(25:11)
  8759     CALL 'kxdfhei1' USING DFHEIV0,
  8760           DFHEIV1,
  8761           ACTIVITY-TRAILERS,
  8762           DFHEIV11,
  8763           DFHEIV99
  8764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8765           ELSE
  8766              IF WS-RESP-NOTFND
  8767
  8768* EXEC CICS GETMAIN
  8769*                   SET       (ADDRESS OF ACTIVITY-TRAILERS)
  8770*                   LENGTH    (200)
  8771*                   INITIMG   (GETMAIN-SPACE)
  8772*                END-EXEC
  8773     MOVE 200
  8774       TO DFHEIV11
  8775*    MOVE ',"IL                  $   #00008625' TO DFHEIV0
  8776     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8777     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8778     MOVE X'2020233030303038363235' TO DFHEIV0(25:11)
  8779     CALL 'kxdfhei1' USING DFHEIV0,
  8780           DFHEIV20,
  8781           DFHEIV11,
  8782           GETMAIN-SPACE
  8783     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8784         DFHEIV20
  8785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8786                 MOVE 'AT'       TO AT-RECORD-ID
  8787                 MOVE CL-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 164
* EL150.cbl
  8788                                 TO AT-CONTROL-PRIMARY
  8789                 MOVE +91        TO AT-SEQUENCE-NO
  8790                 MOVE CLOANI     TO AT-INFO-LINE-1
  8791                 MOVE '6'        TO AT-TRAILER-TYPE
  8792                 MOVE PI-PROCESSOR-ID
  8793                                 TO AT-RECORDED-BY
  8794                                    AT-GEN-INFO-LAST-UPDATED-BY
  8795                 MOVE SAVE-BIN-DATE
  8796                                 TO AT-RECORDED-DT
  8797                                    AT-GEN-INFO-LAST-MAINT-DT
  8798                 MOVE EIBTIME    TO AT-LAST-MAINT-HHMMSS
  8799
  8800* EXEC CICS WRITE
  8801*                   DATASET   ('ELTRLR')
  8802*                   FROM      (ACTIVITY-TRAILERS)
  8803*                   RIDFLD    (AT-CONTROL-PRIMARY)
  8804*                END-EXEC
  8805     MOVE LENGTH OF
  8806      ACTIVITY-TRAILERS
  8807       TO DFHEIV11
  8808     MOVE 'ELTRLR' TO DFHEIV1
  8809*    MOVE '&$ L                  ''   #00008643' TO DFHEIV0
  8810     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8811     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8812     MOVE X'2020233030303038363433' TO DFHEIV0(25:11)
  8813     CALL 'kxdfhei1' USING DFHEIV0,
  8814           DFHEIV1,
  8815           ACTIVITY-TRAILERS,
  8816           DFHEIV11,
  8817           AT-CONTROL-PRIMARY,
  8818           DFHEIV99,
  8819           DFHEIV99
  8820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8821              END-IF
  8822           END-IF
  8823        END-IF
  8824     END-IF
  8825
  8826     IF YESNOSWI EQUAL TO CL-YESNOSW
  8827         MOVE ZEROS    TO YESNOSWL
  8828     ELSE
  8829         MOVE YESNOSWI TO CL-YESNOSW
  8830     END-IF.
  8831
  8832     IF WS-ACT-REC-FOUND-SW = 'Y'
  8833         IF ACTCDL > +0
  8834             MOVE ACTCDI             TO  CL-ACTIVITY-CODE
  8835             MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
  8836                                         DC-BIN-DATE-1
  8837             MOVE ' '                TO  DC-OPTION-CODE
  8838             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  8839             MOVE DC-GREG-DATE-1-EDIT    TO  ACTDTO.
  8840
  8841     IF WS-ACT-REC-FOUND-SW = 'Y'
  8842         IF ACTCDL > +0
  8843             IF ACTCDI = ZEROS
  8844                 MOVE SPACES         TO  CL-ACTIVITY-MAINT-TYPE
  8845                                         ACTTYPO
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 165
* EL150.cbl
  8846             ELSE
  8847                 MOVE WS-ACTIVITY-CODE   TO  SUB
  8848                 SUBTRACT 9 FROM SUB
  8849                 MOVE CF-USER-ACTIVITY-DESC (SUB)
  8850                                     TO  WS-ACT-USER-DESC
  8851                 MOVE WS-DESC-1-3    TO  CL-ACTIVITY-MAINT-TYPE
  8852                                         ACTTYPO.
  8853
  8854     IF WS-ACT-REC-FOUND-SW = 'Y'
  8855         IF ACTCDL > +0
  8856             IF WS-UPDATE-SW = 'Y'
  8857                 MOVE LOW-VALUES     TO  CL-NEXT-RESEND-DT
  8858                                         CL-NEXT-FOLLOWUP-DT.
  8859
  8860     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  8861         IF ASSOCL > +0
  8862             MOVE ASSOCI         TO  CL-ASSOCIATES.
  8863
  8864     IF PI-COMPANY-ID = 'FLA'
  8865         NEXT SENTENCE
  8866     ELSE
  8867         MOVE '3'                TO  CL-LAST-MAINT-TYPE
  8868         MOVE PI-PROCESSOR-ID    TO  CL-LAST-MAINT-USER
  8869                                     SV-LAST-BY
  8870         MOVE EIBTIME            TO  CL-LAST-MAINT-HHMMSS
  8871                                     SV-LAST-HHMMSS
  8872         MOVE SAVE-BIN-DATE      TO  CL-LAST-MAINT-DT.
  8873
  8874 0350-PROCESS-OPTIONS.
  8875     IF PRTOPTL NOT > 0
  8876         GO TO 0400-WRITE-CLAIM.
  8877
  8878     IF PRTOPTI = 'N'
  8879         GO TO 0380-START-PRINTER.
  8880
  8881
  8882* EXEC CICS HANDLE CONDITION
  8883*        NOTFND(0360-CREATE-NEW-ACTQ)
  8884*    END-EXEC.
  8885*    MOVE '"$I                   ! $ #00008708' TO DFHEIV0
  8886     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8887     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8888     MOVE X'2420233030303038373038' TO DFHEIV0(25:11)
  8889     CALL 'kxdfhei1' USING DFHEIV0
  8890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8891
  8892
  8893     MOVE PI-COMPANY-CD          TO ACTQ-COMP-CD.
  8894     MOVE PI-CARRIER             TO ACTQ-CARRIER.
  8895     MOVE PI-CLAIM-NO            TO ACTQ-CLAIM-NO.
  8896     MOVE PI-CERT-NO             TO ACTQ-CERT-NO.
  8897
  8898     MOVE 'ACTQ'                 TO FILE-SWITCH.
  8899     MOVE 'ELACTQ  '             TO FILE-ID.
  8900
  8901
  8902* EXEC CICS READ
  8903*        UPDATE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 166
* EL150.cbl
  8904*        DATASET   ('ELACTQ')
  8905*        SET       (ADDRESS OF ACTIVITY-QUE)
  8906*        RIDFLD    (ELACTQ-KEY)
  8907*    END-EXEC.
  8908     MOVE 'ELACTQ' TO DFHEIV1
  8909*    MOVE '&"S        EU         (   #00008720' TO DFHEIV0
  8910     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8911     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8912     MOVE X'2020233030303038373230' TO DFHEIV0(25:11)
  8913     CALL 'kxdfhei1' USING DFHEIV0,
  8914           DFHEIV1,
  8915           DFHEIV20,
  8916           DFHEIV99,
  8917           ELACTQ-KEY,
  8918           DFHEIV99,
  8919           DFHEIV99,
  8920           DFHEIV99
  8921     SET ADDRESS OF ACTIVITY-QUE TO
  8922         DFHEIV20
  8923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8924
  8925
  8926     IF FORMATI = 'F'
  8927         MOVE '1'                TO AQ-PENDING-STATUS-FLAG
  8928     ELSE
  8929         MOVE '2'                TO AQ-PENDING-STATUS-FLAG.
  8930
  8931     MOVE +150                   TO AQ-LAST-UPDATED-BY.
  8932
  8933     MOVE 'ELACTQ  '             TO FILE-ID.
  8934
  8935
  8936* EXEC CICS REWRITE
  8937*        DATASET   ('ELACTQ')
  8938*        FROM      (ACTIVITY-QUE)
  8939*    END-EXEC.
  8940     MOVE LENGTH OF
  8941      ACTIVITY-QUE
  8942       TO DFHEIV11
  8943     MOVE 'ELACTQ' TO DFHEIV1
  8944*    MOVE '&& L                  %   #00008736' TO DFHEIV0
  8945     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8946     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8947     MOVE X'2020233030303038373336' TO DFHEIV0(25:11)
  8948     CALL 'kxdfhei1' USING DFHEIV0,
  8949           DFHEIV1,
  8950           ACTIVITY-QUE,
  8951           DFHEIV11,
  8952           DFHEIV99
  8953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8954
  8955
  8956     GO TO 0400-WRITE-CLAIM.
  8957
  8958 0360-CREATE-NEW-ACTQ.
  8959
  8960* EXEC CICS GETMAIN
  8961*        SET       (ADDRESS OF ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 167
* EL150.cbl
  8962*        LENGTH    (60)
  8963*        INITIMG   (GETMAIN-SPACE)
  8964*    END-EXEC.
  8965     MOVE 60
  8966       TO DFHEIV11
  8967*    MOVE ',"IL                  $   #00008744' TO DFHEIV0
  8968     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8969     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8970     MOVE X'2020233030303038373434' TO DFHEIV0(25:11)
  8971     CALL 'kxdfhei1' USING DFHEIV0,
  8972           DFHEIV20,
  8973           DFHEIV11,
  8974           GETMAIN-SPACE
  8975     SET ADDRESS OF ACTIVITY-QUE TO
  8976         DFHEIV20
  8977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8978
  8979
  8980     MOVE 'AQ'                   TO AQ-RECORD-ID.
  8981     MOVE PI-COMPANY-CD          TO AQ-COMPANY-CD.
  8982     MOVE PI-CARRIER             TO AQ-CARRIER.
  8983     MOVE PI-CLAIM-NO            TO AQ-CLAIM-NO.
  8984     MOVE PI-CERT-NO             TO AQ-CERT-NO.
  8985
  8986     IF FORMATI = 'F'
  8987         MOVE '1'                TO AQ-PENDING-STATUS-FLAG
  8988     ELSE
  8989         MOVE '2'                TO AQ-PENDING-STATUS-FLAG.
  8990
  8991     MOVE +0                     TO AQ-PAYMENT-COUNTER
  8992                                    AQ-PMT-UNAPPROVED-COUNT.
  8993
  8994     MOVE LOW-VALUES             TO AQ-RESEND-DATE
  8995                                    AQ-FOLLOWUP-DATE.
  8996
  8997     MOVE +150                   TO AQ-LAST-UPDATED-BY.
  8998
  8999     MOVE 'ACTQ'                 TO FILE-SWITCH.
  9000
  9001     MOVE 'ELACTQ  '             TO FILE-ID.
  9002
  9003
  9004* EXEC CICS WRITE
  9005*        DATASET   ('ELACTQ')
  9006*        FROM      (ACTIVITY-QUE)
  9007*        RIDFLD    (AQ-CONTROL-PRIMARY)
  9008*    END-EXEC.
  9009     MOVE LENGTH OF
  9010      ACTIVITY-QUE
  9011       TO DFHEIV11
  9012     MOVE 'ELACTQ' TO DFHEIV1
  9013*    MOVE '&$ L                  ''   #00008773' TO DFHEIV0
  9014     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9015     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9016     MOVE X'2020233030303038373733' TO DFHEIV0(25:11)
  9017     CALL 'kxdfhei1' USING DFHEIV0,
  9018           DFHEIV1,
  9019           ACTIVITY-QUE,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 168
* EL150.cbl
  9020           DFHEIV11,
  9021           AQ-CONTROL-PRIMARY,
  9022           DFHEIV99,
  9023           DFHEIV99
  9024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9025
  9026
  9027     GO TO 0400-WRITE-CLAIM.
  9028
  9029 0380-START-PRINTER.
  9030
  9031* EXEC CICS HANDLE CONDITION
  9032*         TERMIDERR    (0385-TERMID-ERROR)
  9033*         TRANSIDERR   (0390-TRANS-ERROR)
  9034*    END-EXEC.
  9035*    MOVE '"$[\                  ! % #00008782' TO DFHEIV0
  9036     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  9037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9038     MOVE X'2520233030303038373832' TO DFHEIV0(25:11)
  9039     CALL 'kxdfhei1' USING DFHEIV0
  9040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9041
  9042
  9043     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9044     MOVE '1'                    TO CNTL-REC-TYPE.
  9045     MOVE SPACES                 TO CNTL-ACCESS.
  9046     MOVE +0                     TO CNTL-SEQ-NO.
  9047     MOVE 'CNTL'                 TO FILE-SWITCH.
  9048
  9049
  9050* EXEC CICS READ
  9051*        DATASET   ('ELCNTL')
  9052*        SET       (ADDRESS OF CONTROL-FILE)
  9053*        RIDFLD    (ELCNTL-KEY)
  9054*    END-EXEC.
  9055     MOVE 'ELCNTL' TO DFHEIV1
  9056*    MOVE '&"S        E          (   #00008793' TO DFHEIV0
  9057     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9058     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9059     MOVE X'2020233030303038373933' TO DFHEIV0(25:11)
  9060     CALL 'kxdfhei1' USING DFHEIV0,
  9061           DFHEIV1,
  9062           DFHEIV20,
  9063           DFHEIV99,
  9064           ELCNTL-KEY,
  9065           DFHEIV99,
  9066           DFHEIV99,
  9067           DFHEIV99
  9068     SET ADDRESS OF CONTROL-FILE TO
  9069         DFHEIV20
  9070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9071
  9072
  9073     IF CF-FORMS-PRINTER-ID = SPACES
  9074         MOVE ER-0337            TO EMI-ERROR
  9075         MOVE -1                 TO FILETOL
  9076         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9077         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 169
* EL150.cbl
  9078
  9079     IF FORMATI = 'F'
  9080         MOVE '2'                TO PI-ENTRY-CD-1
  9081     ELSE
  9082         MOVE '1'                TO PI-ENTRY-CD-1.
  9083
  9084     IF PI-PROCESSOR-PRINTER NOT = SPACES
  9085         MOVE PI-PROCESSOR-PRINTER  TO  CF-FORMS-PRINTER-ID.
  9086
  9087     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  9088
  9089     IF ALTPRTL > 0
  9090        MOVE ALTPRTI             TO CF-FORMS-PRINTER-ID
  9091                                    PI-ALT-DMD-PRT-ID.
  9092
  9093     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  9094*       MOVE EIBTRMID            TO CF-FORMS-PRINTER-ID
  9095
  9096* EXEC CICS START
  9097*            TRANSID   (START-TRANS-ID)
  9098*            FROM      (PROGRAM-INTERFACE-BLOCK)
  9099*            LENGTH    (PI-COMM-LENGTH)
  9100*            TERMID    ('A155')
  9101*            TERMID    (CF-FORMS-PRINTER-ID)
  9102*        END-EXEC
  9103*    MOVE '0( LF                 1   #00008821' TO DFHEIV0
  9104     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  9105     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  9106     MOVE X'2020233030303038383231' TO DFHEIV0(25:11)
  9107     CALL 'kxdfhei1' USING DFHEIV0,
  9108           DFHEIV99,
  9109           START-TRANS-ID,
  9110           DFHEIV99,
  9111           PROGRAM-INTERFACE-BLOCK,
  9112           PI-COMM-LENGTH,
  9113           DFHEIV99,
  9114           DFHEIV99,
  9115           DFHEIV99,
  9116           DFHEIV99,
  9117           DFHEIV99,
  9118           DFHEIV99,
  9119           DFHEIV99,
  9120           DFHEIV99,
  9121           DFHEIV99,
  9122           DFHEIV99,
  9123           DFHEIV99
  9124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9125     ELSE
  9126
  9127* EXEC CICS START
  9128*            TRANSID   (START-TRANS-ID)
  9129*            TERMID    (CF-FORMS-PRINTER-ID)
  9130*            TERMID    ('PRN1')
  9131*            FROM      (PROGRAM-INTERFACE-BLOCK)
  9132*            LENGTH    (PI-COMM-LENGTH)
  9133*        END-EXEC.
  9134*    MOVE '0( LFT                1   #00008829' TO DFHEIV0
  9135     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 170
* EL150.cbl
  9136     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  9137     MOVE X'2020233030303038383239' TO DFHEIV0(25:11)
  9138     CALL 'kxdfhei1' USING DFHEIV0,
  9139           DFHEIV99,
  9140           START-TRANS-ID,
  9141           DFHEIV99,
  9142           PROGRAM-INTERFACE-BLOCK,
  9143           PI-COMM-LENGTH,
  9144           CF-FORMS-PRINTER-ID,
  9145           DFHEIV99,
  9146           DFHEIV99,
  9147           DFHEIV99,
  9148           DFHEIV99,
  9149           DFHEIV99,
  9150           DFHEIV99,
  9151           DFHEIV99,
  9152           DFHEIV99,
  9153           DFHEIV99,
  9154           DFHEIV99
  9155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9156
  9157
  9158      GO TO 0400-WRITE-CLAIM.
  9159
  9160 0385-TERMID-ERROR.
  9161     MOVE ER-0412                TO EMI-ERROR.
  9162     MOVE -1                     TO ALTPRTL.
  9163     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9164     GO TO 8200-SEND-DATAONLY.
  9165
  9166 0390-TRANS-ERROR.
  9167     MOVE ER-0413                TO EMI-ERROR.
  9168     MOVE -1                     TO FILETOL.
  9169     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9170     GO TO 8200-SEND-DATAONLY.
  9171
  9172 0400-WRITE-CLAIM.
  9173     IF FILETOL = 0  AND
  9174*       MCRFLML = 0  AND
  9175        ACTCDL  = 0  AND
  9176        ASSOCL  = 0  AND
  9177        CLOANL  = 0  AND
  9178        TOTINTL = 0  AND
  9179        YESNOSWL = 0
  9180         GO TO 0440-UPDATE-DONE.
  9181
  9182
  9183* EXEC CICS HANDLE CONDITION
  9184*        NOTFND (0450-NOT-FOUND)
  9185*        DUPKEY (0440-UPDATE-DONE)
  9186*    END-EXEC.
  9187*    MOVE '"$I$                  ! & #00008861' TO DFHEIV0
  9188     MOVE X'222449242020202020202020' TO DFHEIV0(1:12)
  9189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9190     MOVE X'2620233030303038383631' TO DFHEIV0(25:11)
  9191     CALL 'kxdfhei1' USING DFHEIV0
  9192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9193
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 171
* EL150.cbl
  9194
  9195     MOVE 'ELMSTR  '             TO FILE-ID.
  9196
  9197
  9198* EXEC CICS REWRITE
  9199*        DATASET   ('ELMSTR')
  9200*        FROM      (CLAIM-MASTER)
  9201*    END-EXEC.
  9202     MOVE LENGTH OF
  9203      CLAIM-MASTER
  9204       TO DFHEIV11
  9205     MOVE 'ELMSTR' TO DFHEIV1
  9206*    MOVE '&& L                  %   #00008868' TO DFHEIV0
  9207     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9208     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9209     MOVE X'2020233030303038383638' TO DFHEIV0(25:11)
  9210     CALL 'kxdfhei1' USING DFHEIV0,
  9211           DFHEIV1,
  9212           CLAIM-MASTER,
  9213           DFHEIV11,
  9214           DFHEIV99
  9215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9216
  9217
  9218 0440-UPDATE-DONE.
  9219     IF FILETOL  > 0 OR
  9220*       MCRFLML  > 0 OR
  9221        PRTOPTL  > 0 OR
  9222        FORMATL  > 0 OR
  9223        YESNOSWL > 0 OR
  9224        CLOANL   > 0 OR
  9225        TOTINTL  > 0 OR
  9226        ACTCDL   > 0
  9227            MOVE SV-LAST-BY             TO PI-UPDATE-BY
  9228            MOVE SV-LAST-HHMMSS         TO PI-UPDATE-HHMMSS.
  9229
  9230     PERFORM 6050-AUTO-LETTER-WRITER THRU 6050-EXIT.
  9231
  9232     MOVE ER-0000                TO EMI-ERROR.
  9233     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9234
  9235     IF CLAIM-IS-PURGED
  9236        CONTINUE
  9237*        MOVE -1                 TO  MCRFLML
  9238     ELSE
  9239         MOVE -1                 TO  FILETOL
  9240     END-IF
  9241
  9242     GO TO 8200-SEND-DATAONLY.
  9243
  9244 0450-NOT-FOUND.
  9245     IF FILE-SWITCH = 'MSTR'
  9246         MOVE ER-0204            TO EMI-ERROR
  9247     ELSE
  9248         MOVE ER-0190            TO EMI-ERROR.
  9249
  9250     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9251
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 172
* EL150.cbl
  9252     MOVE -1                     TO FILETOL.
  9253     GO TO 8200-SEND-DATAONLY.
  9254
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 173
* EL150.cbl
  9256 0500-CREATE-TEMP-STORAGE.
  9257
  9258     IF PI-SAVE-SYS-ID = 'CR'
  9259        IF PI-CLOSED
  9260           IF PI-BENEFIT-CHANGE OR PI-ERROR-CORRECTION
  9261              IF EIBAID = DFHPF7
  9262                 MOVE ER-0934            TO EMI-ERROR
  9263                 MOVE -1                 TO FILETOL
  9264                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9265                 GO TO 8200-SEND-DATAONLY
  9266              ELSE
  9267              IF EIBAID = DFHPF8
  9268                 MOVE ER-0935            TO EMI-ERROR
  9269                 MOVE -1                 TO FILETOL
  9270                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9271                 GO TO 8200-SEND-DATAONLY.
  9272
  9273     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  9274
  9275     MOVE LOW-VALUES TO PI-SAVE-FILETO  PI-SAVE-PRTOPT
  9276                        PI-SAVE-FORMAT  PI-SAVE-MCRFLM
  9277                        PI-SAVE-ACT-CD  PI-SAVE-ASSOC
  9278                        TS-PI-SAVE-CLOAN.
  9279
  9280     MOVE FILETOI                TO PI-SAVE-FILETO.
  9281*    MOVE MCRFLMI                TO PI-SAVE-MCRFLM.
  9282     MOVE PRTOPTI                TO PI-SAVE-PRTOPT.
  9283     MOVE FORMATI                TO PI-SAVE-FORMAT.
  9284     MOVE ACTCDI                 TO PI-SAVE-ACT-CD.
  9285     MOVE CLOANI                 TO TS-PI-SAVE-CLOAN
  9286
  9287     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9288         MOVE ASSOCI             TO PI-SAVE-ASSOC.
  9289
  9290     MOVE PROGRAM-INTERFACE-BLOCK TO TS-PI-AREA
  9291
  9292
  9293* EXEC CICS WRITEQ TS
  9294*        QUEUE    (QID)
  9295*        FROM     (PROGRAM-INTERFACE-BLOCK)
  9296*        FROM     (TS-AREA)
  9297*        LENGTH   (PI-COMM-LENGTH)
  9298*        LENGTH   (TS-LENGTH)
  9299*    END-EXEC.
  9300*    MOVE '*"                    ''   #00008947' TO DFHEIV0
  9301     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  9302     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9303     MOVE X'2020233030303038393437' TO DFHEIV0(25:11)
  9304     CALL 'kxdfhei1' USING DFHEIV0,
  9305           QID,
  9306           TS-AREA,
  9307           TS-LENGTH,
  9308           DFHEIV99,
  9309           DFHEIV99,
  9310           DFHEIV99
  9311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9312
  9313
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 174
* EL150.cbl
  9314 0500-PF-CHECKS.
  9315
  9316     IF EIBAID = DFHPF3
  9317         IF PI-SAVE-SYS-ID = 'CV'
  9318             MOVE XCTL-EM131     TO PGM-NAME
  9319             GO TO 9300-XCTL
  9320         ELSE
  9321             MOVE XCTL-131       TO PGM-NAME
  9322             GO TO 9300-XCTL.
  9323
  9324     IF EIBAID = DFHPF4
  9325         MOVE XCTL-153           TO PGM-NAME
  9326         GO TO 9300-XCTL.
  9327
  9328     IF EIBAID = DFHPF5
  9329         IF PI-SAVE-SYS-ID = 'CV'
  9330             MOVE THIS-PGM       TO PI-RETURN-TO-PROGRAM
  9331             MOVE XCTL-EM1273    TO PGM-NAME
  9332             GO TO 9300-XCTL
  9333         ELSE
  9334             MOVE XCTL-1273      TO PGM-NAME
  9335             GO TO 9300-XCTL.
  9336
  9337     IF EIBAID = DFHPF6
  9338       OR (EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF6)
  9339         MOVE XCTL-154           TO PGM-NAME
  9340         GO TO 9300-XCTL.
  9341
  9342     IF EIBAID = DFHPF7
  9343       OR (EIBAID = DFHPF22 AND PI-PFKEY-USED = DFHPF7)
  9344         IF PI-SAVE-SYS-ID = 'CV'
  9345             IF PI-SAVE-TYPE = PI-LIFE-OVERRIDE-L1
  9346                 MOVE XCTL-EM156    TO  PGM-NAME
  9347                 GO TO 9300-XCTL
  9348             ELSE
  9349                 MOVE XCTL-EM1561   TO  PGM-NAME
  9350                 GO TO 9300-XCTL
  9351         ELSE
  9352             MOVE XCTL-156          TO PGM-NAME
  9353             GO TO 9300-XCTL.
  9354
  9355     IF EIBAID = DFHPF8
  9356         MOVE XCTL-151           TO PGM-NAME
  9357         GO TO 9300-XCTL.
  9358
  9359     IF EIBAID = DFHPF9
  9360         MOVE XCTL-152           TO PGM-NAME
  9361         GO TO 9300-XCTL.
  9362
  9363     IF EIBAID = DFHPF10
  9364         MOVE PI-SAVE-LOW        TO PI-PASS-AREA
  9365         MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
  9366         MOVE XCTL-142           TO PGM-NAME
  9367         GO TO 9300-XCTL.
  9368
  9369     IF EIBAID = DFHPF11
  9370        IF PI-COMPANY-ID = 'DMD'
  9371           MOVE XCTL-155           TO PGM-NAME
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 175
* EL150.cbl
  9372           GO TO 9300-XCTL
  9373         ELSE
  9374           MOVE XCTL-1503          TO PGM-NAME
  9375           GO TO 9300-XCTL.
  9376
  9377     IF EIBAID = DFHPF13
  9378         MOVE PI-SAVE-FORM       TO PI-PASS-AREA
  9379         MOVE XCTL-155           TO PGM-NAME
  9380         GO TO 9300-XCTL.
  9381
  9382     IF EIBAID = DFHPF14
  9383         MOVE XCTL-141           TO PGM-NAME
  9384         GO TO 9300-XCTL.
  9385
  9386     IF EIBAID = DFHPF17
  9387         MOVE XCTL-162           TO PGM-NAME
  9388         GO TO 9300-XCTL.
  9389
  9390     IF EIBAID = DFHPF18
  9391         MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
  9392         MOVE XCTL-1501          TO PGM-NAME
  9393         GO TO 9300-XCTL.
  9394
  9395     IF EIBAID = DFHPF19
  9396         IF PI-SAVE-SYS-ID = 'CV'
  9397             MOVE THIS-PGM       TO PI-RETURN-TO-PROGRAM
  9398             MOVE XCTL-EM1276    TO PGM-NAME
  9399             GO TO 9300-XCTL
  9400         ELSE
  9401         IF PI-COMPANY-ID = 'DMD'
  9402             MOVE 'EL401DMD'     TO PGM-NAME
  9403             GO TO 9300-XCTL
  9404          ELSE
  9405             MOVE XCTL-1279      TO PGM-NAME
  9406             GO TO 9300-XCTL.
  9407
  9408     IF EIBAID = DFHPF20
  9409         MOVE PI-PRIORITY-CD     TO PI-EL142-PRIORITY
  9410         MOVE XCTL-1502          TO PGM-NAME
  9411         GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 176
* EL150.cbl
  9413 0600-RECOVER-TEMP-STORAGE.
  9414     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  9415
  9416
  9417* EXEC CICS HANDLE CONDITION
  9418*        QIDERR   (0690-QIDERR)
  9419*    END-EXEC
  9420*    MOVE '"$N                   ! '' #00009057' TO DFHEIV0
  9421     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9422     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9423     MOVE X'2720233030303039303537' TO DFHEIV0(25:11)
  9424     CALL 'kxdfhei1' USING DFHEIV0
  9425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9426
  9427
  9428* EXEC CICS READQ TS
  9429*        QUEUE    (QID)
  9430*        INTO     (PROGRAM-INTERFACE-BLOCK)
  9431*        INTO     (TS-AREA)
  9432*        LENGTH   (PI-COMM-LENGTH)
  9433*        LENGTH   (TS-LENGTH)
  9434*    END-EXEC
  9435*    MOVE '*$I    L              ''   #00009061' TO DFHEIV0
  9436     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  9437     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9438     MOVE X'2020233030303039303631' TO DFHEIV0(25:11)
  9439     CALL 'kxdfhei1' USING DFHEIV0,
  9440           QID,
  9441           TS-AREA,
  9442           TS-LENGTH,
  9443           DFHEIV99,
  9444           DFHEIV99,
  9445           DFHEIV99
  9446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9447
  9448     MOVE TS-PI-AREA        TO PROGRAM-INTERFACE-BLOCK
  9449
  9450
  9451* EXEC CICS DELETEQ TS
  9452*        QUEUE   (QID)
  9453*    END-EXEC.
  9454*    MOVE '*&                    #   #00009071' TO DFHEIV0
  9455     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9456     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9457     MOVE X'2020233030303039303731' TO DFHEIV0(25:11)
  9458     CALL 'kxdfhei1' USING DFHEIV0,
  9459           QID,
  9460           DFHEIV99
  9461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9462
  9463
  9464     IF RETURNED-FROM NOT = XCTL-EM1273
  9465         MOVE SAVE-CONTROL       TO PI-CONTROL-IN-PROGRESS.
  9466
  9467     MOVE LOW-VALUES             TO EL150AO.
  9468
  9469*    IF PI-SAVE-MCRFLM NOT = LOW-VALUES
  9470*        MOVE PI-SAVE-MCRFLM     TO MCRFLMO.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 177
* EL150.cbl
  9471
  9472     IF PI-SAVE-FILETO NOT = LOW-VALUES
  9473         MOVE PI-SAVE-FILETO     TO FILETOO.
  9474
  9475     IF TS-PI-SAVE-CLOAN NOT = LOW-VALUES
  9476        MOVE TS-PI-SAVE-CLOAN   TO CLOANO
  9477     END-IF
  9478
  9479     IF PI-SAVE-PRTOPT NOT = LOW-VALUES
  9480         MOVE PI-SAVE-PRTOPT     TO PRTOPTO
  9481         MOVE AL-UANON           TO PRTOPTA.
  9482
  9483     IF PI-SAVE-FORMAT NOT = LOW-VALUES
  9484         MOVE PI-SAVE-FORMAT     TO FORMATO
  9485         MOVE AL-UANON           TO FORMATA.
  9486
  9487     IF PI-SAVE-ACT-CD NOT = LOW-VALUES
  9488         MOVE PI-SAVE-ACT-CD     TO ACTCDO.
  9489
  9490     IF PI-SAVE-ASSOC  NOT = LOW-VALUES
  9491         MOVE PI-SAVE-ASSOC      TO ASSOCO.
  9492
  9493     MOVE 'N'                    TO DIRECTION-SWITCH.
  9494
  9495     MOVE SPACES TO PI-PFKEY-USED.
  9496     MOVE 0      TO PI-FORCE-COUNT.
  9497
  9498     GO TO 1000-SHOW-CLAIM.
  9499
  9500 0690-QIDERR.
  9501     MOVE ER-0033                TO EMI-ERROR.
  9502     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9503     MOVE LOW-VALUES             TO EL150AO.
  9504     MOVE -1                     TO FILETOL.
  9505     GO TO 8100-SEND-INITIAL-MAP.
  9506
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 178
* EL150.cbl
  9508 1000-SHOW-CLAIM.
  9509
  9510     IF CLMNOL > 0
  9511         MOVE CLMNOI             TO PI-CLAIM-NO.
  9512
  9513     IF CARRL > 0
  9514         MOVE CARRI              TO PI-CARRIER.
  9515
  9516     IF CERTNOL > 0
  9517         MOVE CERTNOI            TO PI-CERT-PRIME.
  9518
  9519     IF SUFXL > 0
  9520         MOVE SUFXI              TO PI-CERT-SFX.
  9521
  9522     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9523     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9524     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9525     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9526     MOVE 'MSTR'                 TO FILE-SWITCH.
  9527
  9528 1000-READ-CLAIM.
  9529
  9530
  9531* EXEC CICS HANDLE CONDITION
  9532*        NOTFND   (1100-SHOW-RECORD-NOT-FOUND)
  9533*    END-EXEC.
  9534*    MOVE '"$I                   ! ( #00009141' TO DFHEIV0
  9535     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9537     MOVE X'2820233030303039313431' TO DFHEIV0(25:11)
  9538     CALL 'kxdfhei1' USING DFHEIV0
  9539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9540
  9541
  9542
  9543* EXEC CICS READ
  9544*        DATASET   (PI-CURRENT-FILE)
  9545*        RIDFLD    (ELMSTR-KEY)
  9546*        INTO      (CLAIM-MASTER)
  9547*    END-EXEC.
  9548     MOVE LENGTH OF
  9549      CLAIM-MASTER
  9550       TO DFHEIV11
  9551*    MOVE '&"IL       E          (   #00009145' TO DFHEIV0
  9552     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9553     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9554     MOVE X'2020233030303039313435' TO DFHEIV0(25:11)
  9555     CALL 'kxdfhei1' USING DFHEIV0,
  9556           PI-CURRENT-FILE,
  9557           CLAIM-MASTER,
  9558           DFHEIV11,
  9559           ELMSTR-KEY,
  9560           DFHEIV99,
  9561           DFHEIV99,
  9562           DFHEIV99
  9563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9564
  9565
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 179
* EL150.cbl
  9566 1000-CONTINUE-WITH-RETRIEVED.
  9567
  9568     if (pi-company-id = 'CID' OR 'DCC' OR 'AHL')
  9569        and (cl-priority-cd = '8')
  9570        move 'S'                 to pi-priority-ind
  9571     end-if
  9572
  9573     IF PI-COMPANY-ID = 'DMD'
  9574         IF HIGHEST-PRIORITY
  9575             MOVE 'S'            TO PI-PRIORITY-IND
  9576             MOVE ER-0933        TO EMI-ERROR
  9577             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9578         ELSE
  9579             IF NOT CONFIDENTIAL-DATA
  9580                 MOVE LOW-VALUES TO PI-PRIORITY-IND.
  9581
  9582     IF PI-COMPANY-ID = 'DMD'
  9583             AND
  9584        PI-ASS-PROCESSING
  9585             AND
  9586        PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
  9587         NEXT SENTENCE
  9588     ELSE
  9589         MOVE ELMSTR-KEY         TO PI-PREV-CLAIM
  9590         MOVE CL-PRIME-CERT-NO   TO PI-PREV-PRIME-CERT-NO.
  9591
  9592     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
  9593     MOVE CL-PRIORITY-CD         TO PI-PRIORITY-CD.
  9594
  9595     IF CL-LAST-MAINT-HHMMSS IS NOT NUMERIC
  9596         MOVE EIBTIME            TO PI-UPDATE-HHMMSS
  9597     ELSE
  9598         MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  9599
  9600     MOVE CL-TRAILER-SEQ-CNT     TO PI-SAVE-CNT.
  9601
  9602     IF CL-YESNOSW = 'Y' OR 'N'
  9603         MOVE CL-YESNOSW         TO YESNOSWO
  9604     ELSE
  9605         MOVE 'Y'                TO YESNOSWO
  9606     END-IF.
  9607
  9608     MOVE CL-CLAIM-NO            TO CLMNOO
  9609                                    PI-CLAIM-NO.
  9610     MOVE CL-CARRIER             TO CARRO
  9611                                    PI-CARRIER.
  9612     MOVE CL-CERT-PRIME          TO CERTNOO
  9613                                    PI-CERT-PRIME.
  9614     MOVE CL-CERT-SFX            TO SUFXO
  9615                                    PI-CERT-SFX.
  9616     MOVE CL-CCN                 TO CRDCARDO
  9617
  9618     MOVE CL-SYSTEM-IDENTIFIER   TO PI-SAVE-SYS-ID.
  9619
  9620     IF CL-SYSTEM-IDENTIFIER = 'CV'
  9621         MOVE CL-CV-REFERENCE-NO TO PI-MP-REFERENCE-NO.
  9622
  9623     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 180
* EL150.cbl
  9624         MOVE SPACES                 TO PRIMCRTO
  9625                                        PRIMSFXO
  9626                                        PRIMHDGO
  9627                                        SEQUO
  9628         MOVE AL-SADOF               TO PRIMCRTA
  9629                                        PRIMSFXA
  9630                                        PRIMHDGA
  9631                                        SEQUA
  9632     ELSE
  9633         MOVE CL-ASSOC-CERT-SEQU     TO WS-CUR-SEQU
  9634         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
  9635         MOVE WS-CLAIM-SEQUENCE      TO SEQUO
  9636         MOVE CL-PRIME-CERT-PRIME    TO PRIMCRTO
  9637         MOVE CL-PRIME-CERT-SFX      TO PRIMSFXO
  9638         MOVE 'PRIME CERT :'         TO PRIMHDGO
  9639         MOVE AL-SABON               TO PRIMCRTA
  9640                                        PRIMSFXA
  9641                                        PRIMHDGA
  9642                                        SEQUA.
  9643
  9644     MOVE CL-CLAIM-TYPE          TO PI-SAVE-TYPE.
  9645     MOVE CL-CERT-GROUPING       TO PI-GROUPING.
  9646     MOVE CL-CERT-STATE          TO PI-STATE.
  9647
  9648     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9649         MOVE CL-CERT-ACCOUNT    TO  PI-ACCOUNT
  9650         MOVE CL-CURRENT-ACCOUNT TO  ACCTO
  9651     ELSE
  9652         MOVE CL-CERT-ACCOUNT    TO  PI-ACCOUNT
  9653                                     ACCTO.
  9654
  9655     MOVE CL-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  9656
  9657     EVALUATE TRUE
  9658        WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
  9659           MOVE PI-AH-OVERRIDE-L6
  9660                                 TO CLMTYPO
  9661
  9662        WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9663           MOVE PI-LIFE-OVERRIDE-L6
  9664                                 TO CLMTYPO
  9665
  9666        WHEN CL-CLAIM-TYPE = 'I'
  9667           MOVE '  IU  '         TO CLMTYPO
  9668
  9669        WHEN CL-CLAIM-TYPE = 'G'
  9670           MOVE ' GAP  '         TO CLMTYPO
  9671
  9672        WHEN CL-CLAIM-TYPE = 'F'
  9673           MOVE ' FAM  '         TO CLMTYPO
  9674
  9675     END-EVALUATE
  9676     IF CLAIM-IS-OPEN
  9677         MOVE ' OPEN'            TO CLMSTATO
  9678     ELSE
  9679         MOVE 'CLOSED'           TO CLMSTATO.
  9680
  9681*    IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'CIG' OR 'CUK'
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 181
* EL150.cbl
  9682*        IF (CLAIM-IS-CLOSED)  AND
  9683*           (CL-LAST-CLOSE-REASON = '2')
  9684*            MOVE 'DENIED'       TO CLMSTATO.
  9685
  9686     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
  9687     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
  9688     MOVE CL-INSURED-MID-INIT    TO MINITO.
  9689
  9690     IF CL-NO-OF-PMTS-MADE = +0 AND
  9691        CL-TOTAL-PAID-AMT = +0
  9692         NEXT SENTENCE
  9693     ELSE
  9694         IF CL-PAID-THRU-DT NOT = LOW-VALUES
  9695             MOVE CL-PAID-THRU-DT        TO  DC-BIN-DATE-1
  9696             MOVE ' '                    TO  DC-OPTION-CODE
  9697             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9698             MOVE DC-GREG-DATE-1-EDIT    TO  PDTHRUO
  9699             IF PI-USES-PAID-TO
  9700                 MOVE CL-PAID-THRU-DT    TO  DC-BIN-DATE-1
  9701                 MOVE '6'                TO  DC-OPTION-CODE
  9702                 MOVE +1                 TO  DC-ELAPSED-DAYS
  9703                 MOVE +0                 TO  DC-ELAPSED-MONTHS
  9704                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9705                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
  9706
  9707     IF CL-INCURRED-DT NOT = LOW-VALUES
  9708         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
  9709         MOVE ' '                TO DC-OPTION-CODE
  9710         MOVE +0                 TO DC-ELAPSED-DAYS
  9711                                    DC-ELAPSED-MONTHS
  9712         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9713         MOVE DC-GREG-DATE-1-EDIT TO INCURO.
  9714
  9715     IF CL-DENIAL-TYPE NOT = SPACES AND LOW-VALUES
  9716        EVALUATE CL-DENIAL-TYPE
  9717           WHEN '1'
  9718              MOVE 'DENIAL STATUS - DENIAL       '
  9719                                 TO DENTYPO
  9720           WHEN '2'
  9721              MOVE 'DENIAL STATUS - RESCISSION   '
  9722                                 TO DENTYPO
  9723           WHEN '3'
  9724              MOVE 'DENIAL STATUS - REFORMATION  '
  9725                                 TO DENTYPO
  9726           WHEN '4'
  9727              MOVE 'DENIAL STATUS - REF TO RESC  '
  9728                                 TO DENTYPO
  9729           WHEN '5'
  9730              MOVE 'DENIAL STATUS - RECONSIDERED '
  9731                                 TO DENTYPO
  9732        END-EVALUATE
  9733        MOVE AL-SANOF            TO DENTYPA
  9734     END-IF
  9735     IF CL-NEXT-AUTO-PAY-DT NOT = LOW-VALUES
  9736         MOVE CL-NEXT-AUTO-PAY-DT TO DC-BIN-DATE-1
  9737         MOVE ' '                TO DC-OPTION-CODE
  9738         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9739         MOVE DC-GREG-DATE-1-EDIT TO NXTAUTOO
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 182
* EL150.cbl
  9740         IF PI-USES-PAID-TO
  9741             MOVE CL-NEXT-AUTO-PAY-DT   TO  DC-BIN-DATE-1
  9742             MOVE '6'                   TO  DC-OPTION-CODE
  9743             MOVE +1                    TO  DC-ELAPSED-DAYS
  9744             MOVE +0                    TO  DC-ELAPSED-MONTHS
  9745             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9746             IF NO-CONVERSION-ERROR
  9747                 MOVE DC-GREG-DATE-1-EDIT   TO  NXTAUTOO
  9748             ELSE
  9749                 MOVE LOW-VALUES            TO  NXTAUTOO.
  9750
  9751     IF CL-FILE-ESTABLISH-DT NOT = LOW-VALUES
  9752         MOVE CL-FILE-ESTABLISH-DT      TO  DC-BIN-DATE-1
  9753         MOVE ' '                       TO  DC-OPTION-CODE
  9754         MOVE +0                        TO  DC-ELAPSED-DAYS
  9755                                            DC-ELAPSED-MONTHS
  9756         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9757         IF NO-CONVERSION-ERROR
  9758             MOVE DC-GREG-DATE-1-EDIT   TO  ESTABDTO
  9759         ELSE
  9760             MOVE SPACES                TO  ESTABDTO.
  9761
  9762*    MOVE CL-MICROFILM-NO        TO MCRFLMO.
  9763     MOVE CL-FILE-LOCATION       TO FILETOO.
  9764
  9765     IF CL-CERT-EFF-DT NOT = LOW-VALUES
  9766         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
  9767         MOVE ' '                TO DC-OPTION-CODE
  9768         MOVE +0                 TO DC-ELAPSED-DAYS
  9769                                    DC-ELAPSED-MONTHS
  9770         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9771         MOVE DC-GREG-DATE-1-EDIT TO EFFECTO.
  9772
  9773     IF CL-TOTAL-INT-PAID NOT NUMERIC
  9774        MOVE +0                  TO CL-TOTAL-INT-PAID
  9775     END-IF
  9776     MOVE CL-TOTAL-INT-PAID      TO TOTINTO
  9777     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
  9778     MOVE CL-TOTAL-PAID-AMT      TO PI-TOTAL-PAID.
  9779
  9780     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9781         MOVE CL-CURRENT-STATE   TO  STATEO
  9782     ELSE
  9783     IF PI-COMPANY-ID = 'DMD'
  9784         MOVE PI-COMPANY-CD          TO CERT-COMP-CD
  9785         MOVE CL-CERT-CARRIER        TO CERT-CARRIER
  9786         MOVE CL-CERT-GROUPING       TO CERT-GROUPING
  9787         MOVE CL-CERT-STATE          TO CERT-STATE
  9788         MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
  9789         MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT
  9790         MOVE CL-CERT-NO             TO CERT-CERT-NO
  9791         MOVE 'CERT'                 TO FILE-SWITCH
  9792
  9793* EXEC CICS READ
  9794*            DATASET   ('ELCERT')
  9795*            SET       (ADDRESS OF CERTIFICATE-MASTER)
  9796*            RIDFLD    (ELCERT-KEY)
  9797*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 183
* EL150.cbl
  9798     MOVE 'ELCERT' TO DFHEIV1
  9799*    MOVE '&"S        E          (   #00009377' TO DFHEIV0
  9800     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9801     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9802     MOVE X'2020233030303039333737' TO DFHEIV0(25:11)
  9803     CALL 'kxdfhei1' USING DFHEIV0,
  9804           DFHEIV1,
  9805           DFHEIV20,
  9806           DFHEIV99,
  9807           ELCERT-KEY,
  9808           DFHEIV99,
  9809           DFHEIV99,
  9810           DFHEIV99
  9811     SET ADDRESS OF CERTIFICATE-MASTER TO
  9812         DFHEIV20
  9813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9814         MOVE CM-RESIDENT-STATE  TO  STATEO
  9815     ELSE
  9816         MOVE CL-CERT-STATE      TO  STATEO.
  9817
  9818     MOVE CL-ACTIVITY-CODE       TO  ACTCDO.
  9819     MOVE CL-ACTIVITY-MAINT-TYPE TO  ACTTYPO.
  9820
  9821     IF CL-ACTIVITY-MAINT-DT = SPACES OR LOW-VALUES
  9822         MOVE SPACES                     TO  ACTDTO
  9823     ELSE
  9824         MOVE CL-ACTIVITY-MAINT-DT       TO  DC-BIN-DATE-1
  9825         MOVE ' '                        TO  DC-OPTION-CODE
  9826         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9827         IF NO-CONVERSION-ERROR
  9828             MOVE DC-GREG-DATE-1-EDIT    TO  ACTDTO
  9829         ELSE
  9830             MOVE SPACES                 TO  ACTDTO.
  9831
  9832     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9833         MOVE 'ASSOC:'               TO  ASSHDGO
  9834         MOVE AL-SABON               TO  ASSHDGA
  9835         MOVE CL-ASSOCIATES          TO  ASSOCO
  9836     ELSE
  9837         MOVE SPACES                 TO  ASSHDGO
  9838         MOVE AL-SADOF               TO  ASSOCA.
  9839
  9840     MOVE CL-CLAIM-STATUS        TO PI-STATUS-IND.
  9841     MOVE CL-LAST-CLOSE-REASON   TO PI-LAST-CLOSE-REASON-IND.
  9842
  9843     IF PI-COMPANY-ID = 'DMD'
  9844             AND
  9845         ((PI-ASS-PROCESSING  AND
  9846           PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO)
  9847                 OR
  9848         ((PI-CLOSED AND
  9849          (PI-BENEFIT-CHANGE OR PI-ERROR-CORRECTION))
  9850                 OR
  9851           CL-CERT-NO NOT = CL-PRIME-CERT-NO))
  9852         PERFORM 1200-GET-ASS-TOTALS THRU 1200-EXIT
  9853     ELSE
  9854         MOVE LOW-VALUES             TO PI-LAST-PF-KEY-IND
  9855                                        PI-ASSOCIATED-CERTS-TABLE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 184
* EL150.cbl
  9856                                        PI-ASSOCIATED-PROCESS-IND
  9857         MOVE SPACES                 TO AMTPDO
  9858                                        DAYSPDO
  9859                                        CLMTOTHO
  9860                                        DAYSPDHO
  9861*01745          MOVE ZEROS                  TO PI-TOTAL-PAID
  9862         MOVE ZEROS                  TO
  9863                                        PI-DAYS-PAID
  9864                                        PI-LAST-SEQ-NO
  9865                                        PI-ASS-NDX.
  9866
  9867
  9868* EXEC CICS HANDLE CONDITION
  9869*        NOTFND    (1005-END-BUILD-DIAGNOSIS)
  9870*    END-EXEC.
  9871*    MOVE '"$I                   ! ) #00009435' TO DFHEIV0
  9872     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9874     MOVE X'2920233030303039343335' TO DFHEIV0(25:11)
  9875     CALL 'kxdfhei1' USING DFHEIV0
  9876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9877
  9878
  9879     MOVE CL-CONTROL-PRIMARY  TO ELTRLR-KEY.
  9880     MOVE +90                 TO TRLR-SEQ-NO.
  9881     MOVE 'TRLR'              TO FILE-SWITCH.
  9882
  9883
  9884* EXEC CICS READ
  9885*        DATASET   ('ELTRLR')
  9886*        RIDFLD    (ELTRLR-KEY)
  9887*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  9888*    END-EXEC.
  9889     MOVE 'ELTRLR' TO DFHEIV1
  9890*    MOVE '&"S        E          (   #00009443' TO DFHEIV0
  9891     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9892     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9893     MOVE X'2020233030303039343433' TO DFHEIV0(25:11)
  9894     CALL 'kxdfhei1' USING DFHEIV0,
  9895           DFHEIV1,
  9896           DFHEIV20,
  9897           DFHEIV99,
  9898           ELTRLR-KEY,
  9899           DFHEIV99,
  9900           DFHEIV99,
  9901           DFHEIV99
  9902     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9903         DFHEIV20
  9904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9905
  9906
  9907     MOVE AT-INFO-LINE-1         TO DIAGO.
  9908
  9909 1005-END-BUILD-DIAGNOSIS.
  9910
  9911     MOVE CL-CONTROL-PRIMARY  TO ELTRLR-KEY.
  9912     MOVE +91                 TO TRLR-SEQ-NO.
  9913     MOVE 'TRLR'              TO FILE-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 185
* EL150.cbl
  9914
  9915
  9916* EXEC CICS READ
  9917*        DATASET   ('ELTRLR')
  9918*        RIDFLD    (ELTRLR-KEY)
  9919*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
  9920*        RESP      (WS-RESPONSE)
  9921*    END-EXEC.
  9922     MOVE 'ELTRLR' TO DFHEIV1
  9923*    MOVE '&"S        E          (  N#00009457' TO DFHEIV0
  9924     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9925     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9926     MOVE X'204E233030303039343537' TO DFHEIV0(25:11)
  9927     CALL 'kxdfhei1' USING DFHEIV0,
  9928           DFHEIV1,
  9929           DFHEIV20,
  9930           DFHEIV99,
  9931           ELTRLR-KEY,
  9932           DFHEIV99,
  9933           DFHEIV99,
  9934           DFHEIV99
  9935     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9936         DFHEIV20
  9937     MOVE EIBRESP  TO WS-RESPONSE
  9938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9939
  9940
  9941     IF WS-RESP-NORMAL
  9942        MOVE AT-INFO-LINE-1      TO CLOANO
  9943     ELSE
  9944        MOVE SPACES              TO CLOANO
  9945     END-IF
  9946
  9947     IF CL-SYSTEM-IDENTIFIER = 'CV'
  9948         PERFORM 1500-READ-CONVENIENCE-FILES THRU 1500-EXIT
  9949         GO TO 1050-SHOW-CONTINUE.
  9950
  9951
  9952* EXEC CICS HANDLE CONDITION
  9953*        NOTFND   (1100-SHOW-RECORD-NOT-FOUND)
  9954*    END-EXEC.
  9955*    MOVE '"$I                   ! * #00009474' TO DFHEIV0
  9956     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9957     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9958     MOVE X'2A20233030303039343734' TO DFHEIV0(25:11)
  9959     CALL 'kxdfhei1' USING DFHEIV0
  9960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9961
  9962
  9963     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9964     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9965     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9966     MOVE CL-CERT-STATE          TO CERT-STATE.
  9967     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9968     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9969     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9970     MOVE 'CERT'                 TO FILE-SWITCH.
  9971
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 186
* EL150.cbl
  9972
  9973* EXEC CICS READ
  9974*        DATASET   ('ELCERT')
  9975*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  9976*        RIDFLD    (ELCERT-KEY)
  9977*    END-EXEC.
  9978     MOVE 'ELCERT' TO DFHEIV1
  9979*    MOVE '&"S        E          (   #00009487' TO DFHEIV0
  9980     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9981     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9982     MOVE X'2020233030303039343837' TO DFHEIV0(25:11)
  9983     CALL 'kxdfhei1' USING DFHEIV0,
  9984           DFHEIV1,
  9985           DFHEIV20,
  9986           DFHEIV99,
  9987           ELCERT-KEY,
  9988           DFHEIV99,
  9989           DFHEIV99,
  9990           DFHEIV99
  9991     SET ADDRESS OF CERTIFICATE-MASTER TO
  9992         DFHEIV20
  9993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9994
  9995
  9996     MOVE 'Y'                    TO WS-CERT-READ-SW.
  9997     MOVE LOW-VALUES             TO ERACCT-KEY.
  9998     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9999     MOVE CL-CERT-CARRIER        TO ACCT-CARRIER.
 10000     MOVE CL-CERT-GROUPING       TO ACCT-GROUPING.
 10001     MOVE CL-CERT-STATE          TO ACCT-STATE.
 10002     MOVE CL-CERT-ACCOUNT        TO ACCT-ACCOUNT.
 10003     MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT.
 10004     MOVE 'ACCT'                 TO FILE-SWITCH.
 10005
 10006     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10007     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10008
 10009
 10010* EXEC CICS HANDLE CONDITION
 10011*         NOTFND   (1005-NO-ERACCT)
 10012*         ENDFILE  (1005-NO-ERACCT)
 10013*    END-EXEC.
 10014*    MOVE '"$I''                  ! + #00009506' TO DFHEIV0
 10015     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10016     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10017     MOVE X'2B20233030303039353036' TO DFHEIV0(25:11)
 10018     CALL 'kxdfhei1' USING DFHEIV0
 10019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10020
 10021
 10022
 10023* EXEC CICS STARTBR
 10024*         DATASET   ('ERACCT')
 10025*         RIDFLD    (ERACCT-KEY)
 10026*         GTEQ
 10027*    END-EXEC.
 10028     MOVE 'ERACCT' TO DFHEIV1
 10029     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 187
* EL150.cbl
 10030       TO DFHEIV11
 10031*    MOVE '&,         G          &   #00009511' TO DFHEIV0
 10032     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10033     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10034     MOVE X'2020233030303039353131' TO DFHEIV0(25:11)
 10035     CALL 'kxdfhei1' USING DFHEIV0,
 10036           DFHEIV1,
 10037           ERACCT-KEY,
 10038           DFHEIV99,
 10039           DFHEIV11,
 10040           DFHEIV99
 10041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10042
 10043
 10044 1005-READ-NEXT-ACCOUNT.
 10045
 10046
 10047* EXEC CICS READNEXT
 10048*         DATASET   ('ERACCT')
 10049*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10050*         RIDFLD    (ERACCT-KEY)
 10051*    END-EXEC.
 10052     MOVE 'ERACCT' TO DFHEIV1
 10053     MOVE 0
 10054       TO DFHEIV11
 10055*    MOVE '&.S                   )   #00009519' TO DFHEIV0
 10056     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10057     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10058     MOVE X'2020233030303039353139' TO DFHEIV0(25:11)
 10059     CALL 'kxdfhei1' USING DFHEIV0,
 10060           DFHEIV1,
 10061           DFHEIV20,
 10062           DFHEIV99,
 10063           ERACCT-KEY,
 10064           DFHEIV99,
 10065           DFHEIV11,
 10066           DFHEIV99,
 10067           DFHEIV99
 10068     SET ADDRESS OF ACCOUNT-MASTER TO
 10069         DFHEIV20
 10070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10071
 10072
 10073     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10074        IF WS-ERACCT-HOLD-RECORD = SPACES
 10075           GO TO 1005-NO-ERACCT
 10076        ELSE
 10077           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10078           GO TO 1005-CONTINUE.
 10079
 10080     IF ACCT-EXP-DT = HIGH-VALUES
 10081        NEXT SENTENCE
 10082     ELSE
 10083        MOVE ACCOUNT-MASTER      TO WS-ERACCT-HOLD-RECORD
 10084        GO TO 1005-READ-NEXT-ACCOUNT.
 10085
 10086 1005-CONTINUE.
 10087
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 188
* EL150.cbl
 10088     IF AM-3RD-PARTY-NOTIF-LEVEL NOT NUMERIC
 10089        MOVE ZEROS               TO AM-3RD-PARTY-NOTIF-LEVEL.
 10090
 10091     IF AM-3RD-PARTY-NOTIF-LEVEL > ZERO
 10092        MOVE 'THIRD PARTY'       TO NOTIFYO.
 10093
 10094 1005-NO-ERACCT.
 10095
 10096     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 10097        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 10098        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 10099            MOVE 'N' TO PI-JOINT-INSURED-IND
 10100     ELSE
 10101            MOVE 'Y' TO PI-JOINT-INSURED-IND
 10102     END-IF.
 10103
 10104     IF CM-SING-PRM
 10105         MOVE 'SING PRM'         TO PRMTYPEO
 10106     ELSE
 10107         IF CM-O-B-COVERAGE
 10108             MOVE 'OUT BAL'      TO PRMTYPEO
 10109         ELSE
 10110             MOVE 'OPEN END'     TO PRMTYPEO.
 10111
 10112     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10113        GO TO 1006-CALC-LIFE.
 10114
 10115     MOVE 'MO. BENEFIT :'       TO BENECAPO.
 10116     MOVE CM-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 10117     MOVE CM-LOAN-1ST-PMT-DT    TO CP-FIRST-PAY-DATE.
 10118
 10119     IF PI-COMPANY-ID = 'DMD'
 10120         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 10121         MOVE W-PAYMENTS         TO NOPMTSO
 10122         GO TO 1005-RTRM-CONT
 10123     ELSE
 10124         MOVE SAVE-BIN-DATE      TO CP-VALUATION-DT
 10125         MOVE SPACES             TO W-PAYMENTS
 10126         MOVE CL-NO-OF-PMTS-MADE TO W-PYMTS
 10127         MOVE W-PAYMENTS         TO NOPMTSO.
 10128
 10129     IF CM-AH-ORIG-TERM = +0
 10130        MOVE +1                 TO CP-ORIGINAL-TERM
 10131     ELSE
 10132        MOVE CM-AH-ORIG-TERM    TO CP-ORIGINAL-TERM.
 10133
 10134     MOVE PI-REM-TRM-CALC-OPTION
 10135                                TO CP-REM-TRM-CALC-OPTION.
 10136     MOVE '4'                   TO CP-REM-TERM-METHOD.
 10137     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID
 10138     PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
 10139     PERFORM 9800-LINK-REM-TERM.
 10140     MOVE CP-REMAINING-TERM-3   TO WST-REM.
 10141
 10142 1005-RTRM-CONT.
 10143     move zeros                  to pi-max-benefit
 10144     if pi-company-id = 'DCC'
 10145        and am-dcc-product-code not = '   '
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 189
* EL150.cbl
 10146        move ' '                 to ws-pdef-record-sw
 10147        perform 3997-get-erpdef  thru 3997-exit
 10148        if pdef-found
 10149           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10150              (P1 > +8)
 10151              OR (PD-PROD-CODE (P1) = cl-claim-type)
 10152           END-PERFORM
 10153           IF P1 < +9
 10154              if pd-ben-pct (p1) not numeric
 10155                 move zeros      to pd-ben-pct (p1)
 10156              end-if
 10157              if pd-ben-pct (p1) = zeros
 10158                 move +1         to ws-work-ben-pct
 10159              else
 10160                 move pd-ben-pct (p1)
 10161                                 to ws-work-ben-pct
 10162              end-if
 10163              compute cm-ah-benefit-amt =
 10164                 cm-ah-benefit-amt * ws-work-ben-pct
 10165              MOVE PD-MAX-AMT (P1)
 10166                                 TO pi-max-benefit
 10167           END-IF
 10168        end-if
 10169     end-if
 10170     if (pi-max-benefit not = zeros)
 10171        and (cm-ah-benefit-amt > pi-max-benefit)
 10172        move pi-max-benefit      to beneo
 10173     else
 10174        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 10175     end-if
 10176     MOVE CM-POLICY-FORM-NO     TO PI-SAVE-FORM.
 10177     MOVE CM-STATE              TO PI-CR-STATE.
 10178     MOVE WS-TERMS              TO TERMSO.
 10179     MOVE CM-AH-ORIG-TERM       TO WST-ORIG
 10180                                   DC-ELAPSED-MONTHS
 10181     MOVE WS-TERMS              TO TERMSO.
 10182     MOVE CM-AH-CURRENT-STATUS TO WS-STATUS.
 10183
 10184     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10185         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
 10186         MOVE '6'                    TO  DC-OPTION-CODE
 10187         MOVE '1'                    TO  DC-END-OF-MONTH
 10188         MOVE +0                     TO  DC-ELAPSED-DAYS
 10189                                         DC-ODD-DAYS-OVER
 10190         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1
 10191         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10192         IF NO-CONVERSION-ERROR
 10193             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
 10194         ELSE
 10195             MOVE SPACES                 TO  EXPIREO
 10196     ELSE
 10197         MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
 10198         MOVE ' '                    TO  DC-OPTION-CODE
 10199         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10200         IF NO-CONVERSION-ERROR
 10201             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
 10202         ELSE
 10203             MOVE SPACES                 TO  EXPIREO.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 190
* EL150.cbl
 10204
 10205     GO TO 1009-CONTINUE-BUILD.
 10206
 10207 1006-CALC-LIFE.
 10208
 10209     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10210     MOVE '4'                    TO CNTL-REC-TYPE.
 10211     MOVE SPACES                 TO CNTL-ACCESS.
 10212     MOVE CM-LF-BENEFIT-CD       TO CNTL-BEN-NO.
 10213     MOVE +0                     TO CNTL-SEQ-NO.
 10214     MOVE 'CNTL'                 TO FILE-SWITCH.
 10215
 10216
 10217* EXEC CICS HANDLE CONDITION
 10218*         NOTFND    (1008-NOTFND)
 10219*         ENDFILE   (1008-NOTFND)
 10220*    END-EXEC.
 10221*    MOVE '"$I''                  ! , #00009668' TO DFHEIV0
 10222     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10224     MOVE X'2C20233030303039363638' TO DFHEIV0(25:11)
 10225     CALL 'kxdfhei1' USING DFHEIV0
 10226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10227
 10228
 10229
 10230* EXEC CICS READ
 10231*        DATASET   ('ELCNTL')
 10232*        SET       (ADDRESS OF CONTROL-FILE)
 10233*        RIDFLD    (ELCNTL-KEY)
 10234*        GTEQ
 10235*    END-EXEC.
 10236     MOVE 'ELCNTL' TO DFHEIV1
 10237*    MOVE '&"S        G          (   #00009673' TO DFHEIV0
 10238     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10240     MOVE X'2020233030303039363733' TO DFHEIV0(25:11)
 10241     CALL 'kxdfhei1' USING DFHEIV0,
 10242           DFHEIV1,
 10243           DFHEIV20,
 10244           DFHEIV99,
 10245           ELCNTL-KEY,
 10246           DFHEIV99,
 10247           DFHEIV99,
 10248           DFHEIV99
 10249     SET ADDRESS OF CONTROL-FILE TO
 10250         DFHEIV20
 10251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10252
 10253
 10254     IF PI-COMPANY-ID NOT = CF-COMPANY-ID OR
 10255        CF-RECORD-TYPE NOT = '4'
 10256          GO TO 1008-NOTFND.
 10257
 10258     MOVE +1 TO WS-INDEX.
 10259
 10260 1007-TABLE-LOOKUP.
 10261
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 191
* EL150.cbl
 10262     IF CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (WS-INDEX)
 10263        MOVE CF-LF-COVERAGE-TYPE (WS-INDEX) TO CP-BENEFIT-TYPE
 10264                                               WS-LF-COVERAGE-TYPE
 10265        MOVE CF-CO-EARNINGS-CALC (WS-INDEX) TO WS-EARNING-METHOD
 10266        MOVE CF-SPECIAL-CALC-CD (WS-INDEX)  TO CP-SPECIAL-CALC-CD
 10267        GO TO 1008-CONTINUE.
 10268
 10269     IF CF-BENEFIT-CODE (WS-INDEX) NOT < CF-HI-BEN-IN-REC
 10270        GO TO 1008-NOTFND.
 10271
 10272     IF WS-INDEX < +8
 10273        ADD +1 TO WS-INDEX
 10274        GO TO 1007-TABLE-LOOKUP.
 10275
 10276 1008-NOTFND.
 10277
 10278     MOVE ZEROS TO BENEO.
 10279     GO TO 1009-CONTINUE-BUILD.
 10280
 10281 1008-CONTINUE.
 10282
 10283     MOVE CM-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 10284     MOVE CM-LOAN-1ST-PMT-DT    TO CP-FIRST-PAY-DATE.
 10285     MOVE CL-INCURRED-DT        TO CP-VALUATION-DT.
 10286
 10287     IF CM-LF-ORIG-TERM = +0
 10288        MOVE +1                TO CP-ORIGINAL-TERM
 10289     ELSE
 10290        MOVE CM-LF-ORIG-TERM   TO CP-ORIGINAL-TERM.
 10291
 10292     MOVE CM-LF-ORIG-TERM      TO WST-ORIG
 10293                                  DC-ELAPSED-MONTHS.
 10294     MOVE CM-LF-CURRENT-STATUS TO WS-STATUS.
 10295
 10296     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10297         MOVE CM-LOAN-1ST-PMT-DT     TO  DC-BIN-DATE-1
 10298         MOVE '6'                    TO  DC-OPTION-CODE
 10299         MOVE '1'                    TO  DC-END-OF-MONTH
 10300         MOVE +0                     TO  DC-ELAPSED-DAYS
 10301                                         DC-ODD-DAYS-OVER
 10302         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 10303         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10304         IF NO-CONVERSION-ERROR
 10305             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
 10306         ELSE
 10307             MOVE SPACES                 TO  EXPIREO
 10308     ELSE
 10309         MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
 10310         MOVE ' '                    TO  DC-OPTION-CODE
 10311         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10312         IF NO-CONVERSION-ERROR
 10313             MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
 10314         ELSE
 10315             MOVE SPACES                 TO  EXPIREO.
 10316
 10317     MOVE PI-REM-TRM-CALC-OPTION
 10318                                TO CP-REM-TRM-CALC-OPTION.
 10319     MOVE '4'                   TO CP-REM-TERM-METHOD.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 192
* EL150.cbl
 10320     MOVE WS-EARNING-METHOD     TO CP-EARNING-METHOD.
 10321     MOVE PI-COMPANY-ID         TO CP-COMPANY-ID.
 10322     PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
 10323     PERFORM 9800-LINK-REM-TERM.
 10324
 10325     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 10326     MOVE SPACES                 TO WST-REM-DAYS-GRP
 10327                                    WST-ORIG-DAYS-GRP.
 10328     MOVE WS-TERMS               TO TERMSO.
 10329
 10330     MOVE SPACES                 TO W-PAYMENTS
 10331     MOVE CL-NO-OF-PMTS-MADE     TO W-PYMTS
 10332     MOVE W-PAYMENTS             TO NOPMTSO.
 10333
 10334 1009-CALC-REM-AMT.
 10335
 10336     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10337     MOVE PI-STATE               TO WS-ST-ACCESS.
 10338     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 10339     MOVE '3'                    TO CNTL-REC-TYPE.
 10340     MOVE +0                     TO CNTL-SEQ-NO.
 10341     MOVE 'CNTL'                 TO  FILE-SWITCH.
 10342
 10343
 10344* EXEC CICS HANDLE CONDITION
 10345*        NOTFND   (1009-CONTINUE-BUILD)
 10346*        ENDFILE  (1009-CONTINUE-BUILD)
 10347*    END-EXEC.
 10348*    MOVE '"$I''                  ! - #00009769' TO DFHEIV0
 10349     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10350     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10351     MOVE X'2D20233030303039373639' TO DFHEIV0(25:11)
 10352     CALL 'kxdfhei1' USING DFHEIV0
 10353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10354
 10355
 10356
 10357* EXEC CICS READ
 10358*        DATASET   ('ELCNTL')
 10359*        SET       (ADDRESS OF CONTROL-FILE)
 10360*        RIDFLD    (ELCNTL-KEY)
 10361*    END-EXEC.
 10362     MOVE 'ELCNTL' TO DFHEIV1
 10363*    MOVE '&"S        E          (   #00009774' TO DFHEIV0
 10364     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10365     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10366     MOVE X'2020233030303039373734' TO DFHEIV0(25:11)
 10367     CALL 'kxdfhei1' USING DFHEIV0,
 10368           DFHEIV1,
 10369           DFHEIV20,
 10370           DFHEIV99,
 10371           ELCNTL-KEY,
 10372           DFHEIV99,
 10373           DFHEIV99,
 10374           DFHEIV99
 10375     SET ADDRESS OF CONTROL-FILE TO
 10376         DFHEIV20
 10377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 193
* EL150.cbl
 10378
 10379
 10380     MOVE CF-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 10381     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 10382
 10383     IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 10384        MOVE ZEROS                 TO BENEO
 10385     ELSE
 10386        MOVE CP-REMAINING-TERM-3   TO CP-REMAINING-TERM
 10387        MOVE CM-LF-BENEFIT-AMT     TO CP-ORIGINAL-BENEFIT
 10388        MOVE CM-LF-ALT-BENEFIT-AMT TO CP-ALTERNATE-BENEFIT
 10389        MOVE CM-LOAN-APR           TO CP-LOAN-APR
 10390        MOVE CM-LOAN-TERM          TO CP-LOAN-TERM
 10391        MOVE CM-PAY-FREQUENCY      TO CP-PAY-FREQUENCY
 10392        if pi-company-id = 'DCC'
 10393           and am-dcc-product-code not = '   '
 10394           move ' '              to ws-pdef-record-sw
 10395           perform 3997-get-erpdef
 10396                                 thru 3997-exit
 10397           if pdef-found
 10398              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10399                 (P1 > +8)
 10400                 OR (PD-PROD-CODE (P1) = 'L')
 10401              END-PERFORM
 10402              IF P1 < +9
 10403                 MOVE PD-MAX-AMT (P1)
 10404                                 TO CP-R-MAX-TOT-BEN
 10405              END-IF
 10406           end-if
 10407        end-if
 10408        PERFORM 9850-LINK-REM-AMT THRU 9850-EXIT
 10409        MOVE CP-REMAINING-AMT      TO BENEO.
 10410
 10411     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10412        WS-LF-COVERAGE-TYPE = 'P'
 10413         COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 10414                                    CM-LF-ITD-DEATH-AMT
 10415         MOVE WS-REMAINING-AMT    TO  BENEO.
 10416
 10417 1009-CONTINUE-BUILD.
 10418
 10419     MOVE CM-POLICY-FORM-NO  TO PI-SAVE-FORM.
 10420
 10421     IF WS-STATUS = '6' OR '7' OR '8'
 10422        MOVE AL-SABOF              TO CRTSTATA.
 10423
 10424     IF WS-STATUS = '1' OR '4'
 10425        IF CP-REMAINING-TERM-3 = ZEROS
 10426           MOVE 'EXPIRED'        TO CRTSTATO
 10427        ELSE
 10428           MOVE 'ACTIVE  '       TO CRTSTATO.
 10429
 10430     IF WS-STATUS = '2'
 10431         MOVE 'PEND    '         TO CRTSTATO.
 10432
 10433     IF WS-STATUS = '3'
 10434         MOVE 'RESTORE '         TO CRTSTATO.
 10435
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 194
* EL150.cbl
 10436     IF WS-STATUS = '5'
 10437         MOVE 'REISSUE '         TO CRTSTATO.
 10438
 10439     IF WS-STATUS = '6'
 10440         MOVE 'LMP DIS'          TO CRTSTATO.
 10441
 10442     IF WS-STATUS = '7'
 10443         MOVE 'DEATH'            TO CRTSTATO.
 10444
 10445     IF WS-STATUS = '8'
 10446         MOVE 'CANCEL'           TO CRTSTATO.
 10447
 10448     IF WS-STATUS = '9'
 10449         MOVE 'RE-ONLY '         TO CRTSTATO.
 10450
 10451     IF WS-STATUS = 'D'
 10452         MOVE 'DECLINE'          TO CRTSTATO.
 10453
 10454     IF WS-STATUS = 'V'
 10455         MOVE 'VOID'             TO CRTSTATO.
 10456
 10457     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 10458        MOVE CM-AH-BENEFIT-CD    TO WS-BEN-CD
 10459        MOVE '5'                 TO CNTL-REC-TYPE
 10460     END-IF
 10461
 10462     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10463         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 10464         MOVE '4'                TO CNTL-REC-TYPE.
 10465
 10466     MOVE '** NONE **'           TO COVERO.
 10467
 10468     IF WS-BEN-CD = ZERO
 10469         MOVE AL-SABOF           TO COVERA
 10470         MOVE SPACES             TO CRTSTATO
 10471         GO TO 1050-SHOW-CONTINUE.
 10472
 10473 1010-SHOW-CONTINUE.
 10474     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10475     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10476     MOVE +0                     TO CNTL-SEQ-NO.
 10477     MOVE 'CNTL'                 TO FILE-SWITCH.
 10478
 10479
 10480* EXEC CICS HANDLE CONDITION
 10481*        ENDFILE   (1050-SHOW-CONTINUE)
 10482*        NOTFND    (1050-SHOW-CONTINUE)
 10483*    END-EXEC.
 10484*    MOVE '"$''I                  ! . #00009879' TO DFHEIV0
 10485     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10486     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10487     MOVE X'2E20233030303039383739' TO DFHEIV0(25:11)
 10488     CALL 'kxdfhei1' USING DFHEIV0
 10489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10490
 10491
 10492
 10493* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 195
* EL150.cbl
 10494*        DATASET   ('ELCNTL')
 10495*        SET       (ADDRESS OF CONTROL-FILE)
 10496*        RIDFLD    (ELCNTL-KEY)
 10497*        GTEQ
 10498*    END-EXEC.
 10499     MOVE 'ELCNTL' TO DFHEIV1
 10500*    MOVE '&"S        G          (   #00009884' TO DFHEIV0
 10501     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 10502     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10503     MOVE X'2020233030303039383834' TO DFHEIV0(25:11)
 10504     CALL 'kxdfhei1' USING DFHEIV0,
 10505           DFHEIV1,
 10506           DFHEIV20,
 10507           DFHEIV99,
 10508           ELCNTL-KEY,
 10509           DFHEIV99,
 10510           DFHEIV99,
 10511           DFHEIV99
 10512     SET ADDRESS OF CONTROL-FILE TO
 10513         DFHEIV20
 10514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10515
 10516
 10517     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID) OR
 10518        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
 10519           GO TO 1050-SHOW-CONTINUE.
 10520
 10521     PERFORM 1030-BENEFIT-DUMMY THRU 1030-EXIT
 10522         VARYING SUB-1 FROM 1 BY 1 UNTIL
 10523            ((SUB-1 > 8) OR
 10524            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 10525
 10526     IF SUB-1 NOT = 9
 10527         MOVE CF-BENEFIT-DESCRIP (SUB-1) TO COVERO
 10528         MOVE CF-JOINT-INDICATOR (SUB-1) TO PI-JOINT-COV-IND
 10529       ELSE
 10530         IF CRTSTATO = 'ACTIVE'
 10531             MOVE SPACES         TO  CRTSTATO.
 10532
 10533     GO TO 1050-SHOW-CONTINUE.
 10534
 10535 1030-BENEFIT-DUMMY.
 10536 1030-EXIT.
 10537     EXIT.
 10538
 10539 1050-SHOW-CONTINUE.
 10540
 10541     IF CL-PURGED-DT NOT = LOW-VALUES
 10542         MOVE 'Y'                        TO  PI-PURGED-SW
 10543         MOVE AL-SANOF                   TO  FILETOA    PRTOPTA
 10544                                             FORMATA    ALTPRTA
 10545                                             ACTCDA     ASSOCA
 10546                                             CLOANA
 10547         MOVE 'CLAIM IS PURGED - '       TO  WS-PURGED-MSG
 10548         MOVE CL-PURGED-DT               TO  DC-BIN-DATE-1
 10549         MOVE ' '                        TO  DC-OPTION-CODE
 10550         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10551         IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 196
* EL150.cbl
 10552             MOVE DC-GREG-DATE-1-EDIT    TO  WS-PURGED-DATE
 10553             MOVE WS-PURGED-MESSAGE      TO  MAP-DISPLAY (1)
 10554         ELSE
 10555             MOVE SPACES                 TO  WS-PURGED-DATE
 10556             MOVE WS-PURGED-MESSAGE      TO  MAP-DISPLAY (1)
 10557     ELSE
 10558         MOVE 'N'                        TO  PI-PURGED-SW
 10559         PERFORM 2000-BUILD-TRAILER-DISPLAY THRU 2999-EXIT.
 10560
 10561     IF PI-COMPANY-ID = 'DMD'
 10562        MOVE COVERO                  TO  CRTSTATO
 10563        IF CL-LAST-PMT-AMT NOT = ZERO
 10564           MOVE CL-LAST-PMT-DT       TO  DC-BIN-DATE-1
 10565           MOVE ' '                  TO  DC-OPTION-CODE
 10566           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10567           MOVE DC-GREG-DATE-1-EDIT  TO  PRMTYPEO
 10568           MOVE CL-LAST-PMT-AMT      TO  WS-PMT-AMT
 10569           MOVE WS-PMT-AMTD          TO  COVERO
 10570         ELSE
 10571           MOVE SPACES               TO  COVERO
 10572                                         PRMTYPEO.
 10573
 10574     IF RETURNED-FROM NOT = SPACES
 10575         GO TO 8250-SEND-WITH-CURSOR.
 10576
 10577     IF CLAIM-IS-PURGED
 10578        CONTINUE
 10579*        MOVE -1                 TO  MCRFLML
 10580     ELSE
 10581         MOVE -1                 TO  FILETOL
 10582     END-IF
 10583
 10584     IF PI-COMPANY-ID = 'DMD'
 10585         IF CONFIDENTIAL-DATA
 10586             IF PI-CONFIDENTIAL-UP
 10587                 MOVE LOW-VALUE  TO PI-PRIORITY-IND
 10588                 MOVE ER-0932    TO EMI-ERROR
 10589                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10590             ELSE
 10591                 MOVE 'C'        TO PI-PRIORITY-IND
 10592
 10593* EXEC CICS SEND TEXT
 10594*                    FROM     (W-CONF-TEXT)
 10595*                    LENGTH   (W-CONF-LENGTH)
 10596*                    ERASE
 10597*                    FREEKB
 10598*                END-EXEC
 10599*    MOVE '8&      T  E F  H   F -   #00009966' TO DFHEIV0
 10600     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10601     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10602     MOVE X'2020233030303039393636' TO DFHEIV0(25:11)
 10603     CALL 'kxdfhei1' USING DFHEIV0,
 10604           W-CONF-TEXT,
 10605           W-CONF-LENGTH,
 10606           DFHEIV99,
 10607           DFHEIV99,
 10608           DFHEIV99,
 10609           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 197
* EL150.cbl
 10610           DFHEIV99,
 10611           DFHEIV99,
 10612           DFHEIV99,
 10613           DFHEIV99,
 10614           DFHEIV99,
 10615           DFHEIV99
 10616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10617                 GO TO 9100-RETURN-TRAN.
 10618
 10619     GO TO 8100-SEND-INITIAL-MAP.
 10620
 10621 1100-SHOW-RECORD-NOT-FOUND.
 10622
 10623     IF FILE-SWITCH = 'MSTR'
 10624         IF PI-CURRENT-FILE = 'ELRETR'
 10625             MOVE ER-0204        TO EMI-ERROR
 10626         ELSE
 10627             MOVE 'Y'            TO PI-RETRIEVED-DATA-IND
 10628             MOVE 'ELRETR'       TO PI-CURRENT-FILE
 10629             GO TO 1000-READ-CLAIM
 10630     ELSE
 10631         MOVE ER-0206            TO EMI-ERROR.
 10632
 10633     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10634
 10635     IF FILE-SWITCH = 'CERT' AND
 10636      (PI-COMPANY-ID = 'CID' OR 'AHL')
 10637        GO TO 1050-SHOW-CONTINUE.
 10638
 10639     MOVE -1                     TO CLMNOL.
 10640
 10641     MOVE PI-CARRIER             TO CARRO.
 10642     MOVE PI-CLAIM-NO            TO CLMNOO.
 10643     MOVE PI-CERT-PRIME          TO CERTNOO.
 10644     MOVE PI-CERT-SFX            TO SUFXO.
 10645
 10646     MOVE AL-UABON               TO CLMNOA   CARRA
 10647                                    YESNOSWA
 10648                                    CERTNOA  SUFXA.
 10649
 10650     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 198
* EL150.cbl
 10652 1200-GET-ASS-TOTALS.
 10653
 10654     MOVE CL-ASSOC-CERT-SEQU     TO PI-ASS-NDX.
 10655
 10656     IF RETURNED-FROM NOT = 'EL156' AND 'EL1501' AND 'EL1502'
 10657         IF PI-ASS-PROCESSING
 10658                 AND
 10659            PI-ASS-CERTS (PI-ASS-NDX) = CL-CERT-NO
 10660                 AND
 10661            PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
 10662             GO TO 1200-SET-UP-FIELDS.
 10663
 10664     MOVE CL-ASSOC-CERT-SEQU      TO PI-LAST-SEQ-NO.
 10665
 10666     IF EIBAID = DFHPF15 OR DFHPF16
 10667
 10668* EXEC CICS ENDBR
 10669*            DATASET   (PI-CURRENT-FILE)
 10670*        END-EXEC.
 10671     MOVE 0
 10672       TO DFHEIV11
 10673*    MOVE '&2                    $   #00010022' TO DFHEIV0
 10674     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10675     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10676     MOVE X'2020233030303130303232' TO DFHEIV0(25:11)
 10677     CALL 'kxdfhei1' USING DFHEIV0,
 10678           PI-CURRENT-FILE,
 10679           DFHEIV11,
 10680           DFHEIV99
 10681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10682
 10683
 10684     MOVE CLAIM-MASTER           TO W-CLAIM-MASTER-SAVE.
 10685     MOVE ZEROS                  TO PI-DAYS-PAID
 10686                                    PI-TOTAL-PAID.
 10687     MOVE LOW-VALUES             TO PI-ASSOCIATED-CERTS-TABLE
 10688                                    PI-LAST-PF-KEY-IND
 10689                                    PI-ASSOCIATED-PROCESS-IND
 10690     MOVE SPACES                 TO MSTR-CERT-NO.
 10691
 10692     IF RETURNED-FROM = 'EL156'
 10693             AND
 10694        PI-PREV-PRIME-CERT-NO = CL-PRIME-CERT-NO
 10695         MOVE SPACES             TO RETURNED-FROM
 10696     ELSE
 10697         MOVE SPACES             TO RETURNED-FROM
 10698         MOVE CL-CONTROL-PRIMARY TO PI-ORIGINAL-ASS-CERT.
 10699
 10700
 10701* EXEC CICS HANDLE CONDITION
 10702*        NOTFND   (1220-NO-CLAIM-RECORD-FND)
 10703*        ENDFILE  (1200-ENDBR)
 10704*    END-EXEC.
 10705*    MOVE '"$I''                  ! / #00010042' TO DFHEIV0
 10706     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10708     MOVE X'2F20233030303130303432' TO DFHEIV0(25:11)
 10709     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 199
* EL150.cbl
 10710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10711
 10712
 10713
 10714* EXEC CICS STARTBR
 10715*         DATASET   (PI-CURRENT-FILE)
 10716*         RIDFLD    (ELMSTR-KEY)
 10717*    END-EXEC.
 10718     MOVE 0
 10719       TO DFHEIV11
 10720*    MOVE '&,         G          &   #00010047' TO DFHEIV0
 10721     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10722     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10723     MOVE X'2020233030303130303437' TO DFHEIV0(25:11)
 10724     CALL 'kxdfhei1' USING DFHEIV0,
 10725           PI-CURRENT-FILE,
 10726           ELMSTR-KEY,
 10727           DFHEIV99,
 10728           DFHEIV11,
 10729           DFHEIV99
 10730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10731
 10732
 10733 1200-GET-NEXT-RECORD.
 10734
 10735
 10736* EXEC CICS READNEXT
 10737*         DATASET   (PI-CURRENT-FILE)
 10738*         RIDFLD    (ELMSTR-KEY)
 10739*         INTO      (CLAIM-MASTER)
 10740*    END-EXEC.
 10741     MOVE LENGTH OF
 10742      CLAIM-MASTER
 10743       TO DFHEIV12
 10744     MOVE 0
 10745       TO DFHEIV11
 10746*    MOVE '&.IL                  )   #00010054' TO DFHEIV0
 10747     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 10748     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10749     MOVE X'2020233030303130303534' TO DFHEIV0(25:11)
 10750     CALL 'kxdfhei1' USING DFHEIV0,
 10751           PI-CURRENT-FILE,
 10752           CLAIM-MASTER,
 10753           DFHEIV12,
 10754           ELMSTR-KEY,
 10755           DFHEIV99,
 10756           DFHEIV11,
 10757           DFHEIV99,
 10758           DFHEIV99
 10759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10760
 10761
 10762     IF PI-PREV-COMP-CD  NOT = CL-COMPANY-CD  OR
 10763        PI-PREV-CARRIER  NOT = CL-CARRIER     OR
 10764        PI-PREV-CLAIM-NO NOT = CL-CLAIM-NO
 10765         GO TO 1200-ENDBR.
 10766
 10767     IF CL-PRIME-CERT-NO NOT = PI-PREV-PRIME-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 200
* EL150.cbl
 10768         GO TO 1200-GET-NEXT-RECORD.
 10769
 10770     ADD CL-TOTAL-PAID-AMT       TO PI-TOTAL-PAID.
 10771     ADD CL-NO-OF-DAYS-PAID      TO PI-DAYS-PAID.
 10772
 10773     MOVE CL-ASSOC-CERT-SEQU     TO PI-ASS-NDX.
 10774     MOVE CL-CERT-NO             TO PI-ASS-CERTS (PI-ASS-NDX).
 10775
 10776     GO TO 1200-GET-NEXT-RECORD.
 10777
 10778 1200-ENDBR.
 10779
 10780
 10781* EXEC CICS ENDBR
 10782*        DATASET   (PI-CURRENT-FILE)
 10783*    END-EXEC.
 10784     MOVE 0
 10785       TO DFHEIV11
 10786*    MOVE '&2                    $   #00010078' TO DFHEIV0
 10787     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10788     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10789     MOVE X'2020233030303130303738' TO DFHEIV0(25:11)
 10790     CALL 'kxdfhei1' USING DFHEIV0,
 10791           PI-CURRENT-FILE,
 10792           DFHEIV11,
 10793           DFHEIV99
 10794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10795
 10796
 10797     MOVE W-CLAIM-MASTER-SAVE    TO CLAIM-MASTER.
 10798     MOVE PI-LAST-SEQ-NO         TO PI-ASS-NDX.
 10799
 10800 1200-SET-UP-FIELDS.
 10801
 10802     MOVE 'Y'                    TO PI-ASSOCIATED-PROCESS-IND.
 10803     MOVE PI-DAYS-PAID           TO W-DAYS-PAID-X.
 10804     MOVE PI-TOTAL-PAID          TO W-TOTAL-PAID-AMT-X.
 10805     MOVE W-TOTAL-PAID-AMT-X     TO AMTPDO.
 10806     MOVE W-DAYS-PAID-X          TO DAYSPDO.
 10807     MOVE 'CLAIM TOTALS...AMOUNT PD:'
 10808                                 TO CLMTOTHO.
 10809     MOVE 'DAYS PAID:'           TO DAYSPDHO.
 10810
 10811 1200-EXIT.
 10812     EXIT.
 10813
 10814 1220-NO-CLAIM-RECORD-FND.
 10815
 10816     MOVE ER-0204                TO EMI-ERROR.
 10817
 10818     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10819
 10820     IF FILE-SWITCH = 'CERT' AND
 10821       (PI-COMPANY-ID = 'CID' OR 'AHL')
 10822         GO TO 1050-SHOW-CONTINUE.
 10823
 10824     MOVE -1                     TO CLMNOL.
 10825
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 201
* EL150.cbl
 10826     MOVE PI-CARRIER             TO CARRO.
 10827     MOVE PI-CLAIM-NO            TO CLMNOO.
 10828     MOVE PI-CERT-PRIME          TO CERTNOO.
 10829     MOVE PI-CERT-SFX            TO SUFXO.
 10830
 10831     MOVE AL-UABON               TO CLMNOA   CARRA
 10832                                    CERTNOA  SUFXA.
 10833
 10834     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 202
* EL150.cbl
 10836 1500-READ-CONVENIENCE-FILES.
 10837
 10838
 10839* EXEC CICS HANDLE CONDITION
 10840*        NOTFND   (1500-SHOW-RECORD-NOT-FOUND)
 10841*    END-EXEC.
 10842*    MOVE '"$I                   ! 0 #00010123' TO DFHEIV0
 10843     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10844     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10845     MOVE X'3020233030303130313233' TO DFHEIV0(25:11)
 10846     CALL 'kxdfhei1' USING DFHEIV0
 10847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10848
 10849
 10850     MOVE PI-COMPANY-CD              TO  PLCY-COMP-CD.
 10851     MOVE CL-CERT-CARRIER            TO  PLCY-CARRIER.
 10852     MOVE CL-CERT-GROUPING           TO  PLCY-GROUPING.
 10853     MOVE CL-CERT-STATE              TO  PLCY-STATE.
 10854     MOVE CL-CERT-ACCOUNT            TO  PLCY-PRODUCER.
 10855     MOVE CL-CERT-EFF-DT             TO  PLCY-EFF-DT.
 10856     MOVE CL-CV-REFERENCE-NO         TO  PLCY-REFERENCE-NO.
 10857     MOVE 'PLCY'                     TO  FILE-SWITCH.
 10858
 10859
 10860* EXEC CICS READ
 10861*        DATASET   ('MPPLCY')
 10862*        SET       (ADDRESS OF POLICY-MASTER)
 10863*        RIDFLD    (EMPLCY-KEY)
 10864*    END-EXEC.
 10865     MOVE 'MPPLCY' TO DFHEIV1
 10866*    MOVE '&"S        E          (   #00010136' TO DFHEIV0
 10867     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10869     MOVE X'2020233030303130313336' TO DFHEIV0(25:11)
 10870     CALL 'kxdfhei1' USING DFHEIV0,
 10871           DFHEIV1,
 10872           DFHEIV20,
 10873           DFHEIV99,
 10874           EMPLCY-KEY,
 10875           DFHEIV99,
 10876           DFHEIV99,
 10877           DFHEIV99
 10878     SET ADDRESS OF POLICY-MASTER TO
 10879         DFHEIV20
 10880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10881
 10882
 10883     MOVE 'Y'                        TO  WS-CERT-READ-SW.
 10884
 10885     PERFORM 1700-READ-EMPHST THRU 1700-EXIT.
 10886
 10887 1500-READ-EMPLAN.
 10888
 10889     MOVE PM-COMPANY-CD              TO  PLAN-COMP-CD.
 10890     MOVE PM-CARRIER                 TO  PLAN-CARRIER.
 10891     MOVE PM-GROUPING                TO  PLAN-GROUPING.
 10892     MOVE PM-STATE                   TO  PLAN-STATE.
 10893     MOVE PM-PRODUCER                TO  PLAN-PRODUCER.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 203
* EL150.cbl
 10894     MOVE PM-INS-PLAN-CD             TO  PLAN-PLAN-CODE.
 10895     MOVE PM-INS-PLAN-REVISION       TO  PLAN-REV-NO.
 10896     MOVE 'PLAN'                     TO  FILE-SWITCH.
 10897
 10898
 10899* EXEC CICS HANDLE CONDITION
 10900*        NOTFND   (1500-NO-PLAN-RECORD)
 10901*    END-EXEC.
 10902*    MOVE '"$I                   ! 1 #00010157' TO DFHEIV0
 10903     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10904     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10905     MOVE X'3120233030303130313537' TO DFHEIV0(25:11)
 10906     CALL 'kxdfhei1' USING DFHEIV0
 10907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10908
 10909
 10910
 10911* EXEC CICS READ
 10912*        DATASET   ('MPPLAN')
 10913*        RIDFLD    (EMPLAN-KEY)
 10914*        SET       (ADDRESS OF PRODUCER-PLANS)
 10915*    END-EXEC.
 10916     MOVE 'MPPLAN' TO DFHEIV1
 10917*    MOVE '&"S        E          (   #00010161' TO DFHEIV0
 10918     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10919     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10920     MOVE X'2020233030303130313631' TO DFHEIV0(25:11)
 10921     CALL 'kxdfhei1' USING DFHEIV0,
 10922           DFHEIV1,
 10923           DFHEIV20,
 10924           DFHEIV99,
 10925           EMPLAN-KEY,
 10926           DFHEIV99,
 10927           DFHEIV99,
 10928           DFHEIV99
 10929     SET ADDRESS OF PRODUCER-PLANS TO
 10930         DFHEIV20
 10931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10932
 10933
 10934     MOVE PP-PLAN-ABBREV             TO  COVERO.
 10935     MOVE PP-REFUND-CALC             TO  CP-EARNING-METHOD
 10936                                         CP-RATING-METHOD.
 10937     IF PP-BENEFIT-IS-LEVEL
 10938         MOVE 'L'                    TO  CP-BENEFIT-TYPE
 10939     ELSE
 10940         MOVE 'R'                    TO  CP-BENEFIT-TYPE.
 10941
 10942     MOVE PM-LOAN-TERM               TO  CP-ORIGINAL-TERM
 10943                                         CP-LOAN-TERM.
 10944     MOVE SAVE-BIN-DATE              TO  CP-VALUATION-DT.
 10945     MOVE PM-POLICY-EFF-DT           TO  CP-CERT-EFF-DT.
 10946     MOVE PM-STATE                   TO  CP-STATE.
 10947     MOVE 'A'                        TO  CP-SPECIAL-CALC-CD.
 10948     MOVE '2'                        TO  CP-PROCESS-TYPE.
 10949     MOVE PI-COMPANY-ID              TO  CP-COMPANY-ID.
 10950     MOVE PI-COMPANY-CD              TO  CP-COMPANY-CD.
 10951     MOVE '1'                        TO  CP-REM-TRM-CALC-OPTION.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 204
* EL150.cbl
 10952
 10953     IF PM-AH-MORT-PLAN
 10954         MOVE '3'                    TO  CP-REM-TERM-METHOD
 10955         MOVE PM-LOAN-DT             TO  CP-FIRST-PAY-DATE
 10956     ELSE
 10957         MOVE '2'                    TO  CP-REM-TERM-METHOD
 10958         MOVE PM-POLICY-EFF-DT       TO  CP-FIRST-PAY-DATE.
 10959
 10960     PERFORM 8900-GET-FREE-LOOK THRU 8900-EXIT.
 10961     PERFORM 9800-LINK-REM-TERM.
 10962
 10963     IF PM-AH-MORT-PLAN
 10964       MOVE CP-REMAINING-TERM-1    TO  WST-REM
 10965     ELSE
 10966       IF PI-COMPANY-ID = 'CIG' OR 'CUK'
 10967         COMPUTE CP-REMAINING-TERM-3 = CP-REMAINING-TERM-3 + 1
 10968         MOVE CP-REMAINING-TERM-3    TO  WST-REM
 10969       ELSE
 10970         MOVE CP-REMAINING-TERM-3    TO  WST-REM.
 10971
 10972     GO TO 1500-SHOW-CONTINUE.
 10973
 10974 1500-NO-PLAN-RECORD.
 10975
 10976     MOVE ZEROS                      TO  WST-REM.
 10977     MOVE '** NONE **'               TO  COVERO.
 10978
 10979 1500-SHOW-CONTINUE.
 10980
 10981     MOVE PM-LOAN-TERM               TO  WST-ORIG.
 10982     MOVE WS-TERMS                   TO  TERMSO.
 10983
 10984     IF PM-AH-MORT-PLAN
 10985         MOVE 'MO. BENEFIT :'        TO  BENECAPO
 10986         MOVE PM-INS-MONTH-BENEFIT   TO  BENEO
 10987     ELSE
 10988         MOVE PM-INS-TOTAL-BENEFIT   TO  BENEO.
 10989
 10990     IF PM-ANNUAL
 10991         MOVE 'ANNUAL'              TO  PRMTYPEO
 10992       ELSE
 10993     IF PM-SEMI-ANNUAL
 10994         MOVE 'SEMI ANL'            TO  PRMTYPEO
 10995       ELSE
 10996     IF PM-QUARTERLY
 10997         MOVE 'QTRLY'               TO  PRMTYPEO
 10998       ELSE
 10999     IF PM-BI-MONTHLY
 11000         MOVE 'BI MONTH'            TO  PRMTYPEO
 11001       ELSE
 11002     IF PM-SINGLE-PREM
 11003         MOVE 'SING PRM'            TO  PRMTYPEO.
 11004
 11005     MOVE PM-POLICY-EFF-DT           TO  DC-BIN-DATE-1.
 11006     MOVE '6'                        TO  DC-OPTION-CODE.
 11007     MOVE PM-LOAN-TERM               TO  DC-ELAPSED-MONTHS.
 11008     MOVE +0                         TO  DC-ELAPSED-DAYS.
 11009     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 205
* EL150.cbl
 11010     IF NO-CONVERSION-ERROR
 11011         MOVE DC-GREG-DATE-1-EDIT    TO  EXPIREO
 11012     ELSE
 11013         MOVE SPACES                 TO  EXPIREO.
 11014
 11015     IF PM-CURRENT-STATUS = '0'
 11016         MOVE 'LAPSED'               TO  CRTSTATO.
 11017     IF PM-CURRENT-STATUS = '1'
 11018         MOVE 'ACTIVE'               TO  CRTSTATO.
 11019     IF PM-CURRENT-STATUS = '2'
 11020         MOVE 'PENDING'              TO  CRTSTATO.
 11021     IF PM-CURRENT-STATUS = '3'
 11022         MOVE 'DECLINE'              TO  CRTSTATO.
 11023     IF PM-CURRENT-STATUS = '4' OR '9'
 11024         MOVE 'PND CANC'             TO  CRTSTATO.
 11025     IF PM-CURRENT-STATUS = '5'
 11026         MOVE 'PND ISS'              TO  CRTSTATO.
 11027     IF PM-CURRENT-STATUS = '6'
 11028         MOVE 'CLAIM'                TO  CRTSTATO.
 11029     IF PM-CURRENT-STATUS = '7'
 11030         MOVE 'CANCEL'               TO  CRTSTATO.
 11031     IF PM-CURRENT-STATUS = '8'
 11032         MOVE 'PND UNDW'             TO  CRTSTATO.
 11033     IF PM-CURRENT-STATUS = 'C'
 11034         MOVE 'TRANSFER'             TO  CRTSTATO.
 11035     IF PM-CURRENT-STATUS = 'F'
 11036         MOVE 'SETTLE'               TO  CRTSTATO.
 11037     IF PM-CURRENT-STATUS = 'T'
 11038         MOVE 'TRMNAT'               TO  CRTSTATO.
 11039
 11040     GO TO 1500-EXIT.
 11041
 11042 1500-SHOW-RECORD-NOT-FOUND.
 11043
 11044     IF FILE-SWITCH = 'PLCY'
 11045         MOVE ER-9483            TO  EMI-ERROR.
 11046
 11047     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11048     MOVE -1                     TO  CLMNOL.
 11049     MOVE PI-CARRIER             TO  CARRO.
 11050     MOVE PI-CLAIM-NO            TO  CLMNOL.
 11051     MOVE PI-CERT-PRIME          TO  CERTNOO.
 11052     MOVE PI-CERT-SFX            TO  SUFXO.
 11053
 11054     MOVE AL-UABON               TO  CLMNOA    CARRA
 11055                                     CERTNOA   SUFXA.
 11056     GO TO 8100-SEND-INITIAL-MAP.
 11057
 11058 1500-EXIT.
 11059     EXIT.
 11060
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 206
* EL150.cbl
 11062 1600-ROLL-TRAILERS.
 11063     MOVE SPACES                 TO MAP-DISPLAY (1)
 11064                                    MAP-DISPLAY (2)
 11065                                    MAP-DISPLAY (3)
 11066                                    MAP-DISPLAY (4).
 11067
 11068     PERFORM 2000-BUILD-TRAILER-DISPLAY THRU 2999-EXIT.
 11069
 11070     MOVE -1                     TO FILETOL.
 11071     GO TO 8200-SEND-DATAONLY.
 11072
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 207
* EL150.cbl
 11074***************************************************************
 11075*    I/O REQUESTS AGAINST THE CONVENIENCE POLICY HISTORY FILE *
 11076***************************************************************
 11077 1700-READ-EMPHST.
 11078
 11079
 11080* EXEC CICS HANDLE CONDITION
 11081*        ENDFILE  (1700-ENDBROWSE)
 11082*        NOTFND   (1700-ENDBROWSE)
 11083*    END-EXEC.
 11084*    MOVE '"$''I                  ! 2 #00010312' TO DFHEIV0
 11085     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11086     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11087     MOVE X'3220233030303130333132' TO DFHEIV0(25:11)
 11088     CALL 'kxdfhei1' USING DFHEIV0
 11089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11090
 11091
 11092     MOVE PM-COMPANY-CD          TO  EMPHST-COMPANY-CD.
 11093     MOVE PM-CARRIER             TO  EMPHST-CARRIER.
 11094     MOVE PM-GROUPING            TO  EMPHST-GROUPING.
 11095     MOVE PM-STATE               TO  EMPHST-STATE.
 11096     MOVE PM-PRODUCER            TO  EMPHST-PRODUCER.
 11097     MOVE PM-POLICY-EFF-DT       TO  EMPHST-POLICY-EFF-DT.
 11098     MOVE PM-REFERENCE-NUMBER    TO  EMPHST-REFERENCE-NUMBER.
 11099     MOVE ZEROS                  TO  EMPHST-SEQUENCE-NO.
 11100
 11101     IF PM-LIFE-MORT-PLAN
 11102         MOVE '02'                   TO  EMPHST-RECORD-TYPE
 11103         MOVE '21'                   TO  EMPHST-FIELD-TYPE
 11104     ELSE
 11105         MOVE '04'                   TO  EMPHST-RECORD-TYPE
 11106         MOVE '07'                   TO  EMPHST-FIELD-TYPE.
 11107
 11108
 11109* EXEC CICS STARTBR
 11110*        DATASET   (EMPHST-FILE-ID)
 11111*        RIDFLD    (EMPHST-KEY)
 11112*        GTEQ
 11113*    END-EXEC.
 11114     MOVE 0
 11115       TO DFHEIV11
 11116*    MOVE '&,         G          &   #00010333' TO DFHEIV0
 11117     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11118     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11119     MOVE X'2020233030303130333333' TO DFHEIV0(25:11)
 11120     CALL 'kxdfhei1' USING DFHEIV0,
 11121           EMPHST-FILE-ID,
 11122           EMPHST-KEY,
 11123           DFHEIV99,
 11124           DFHEIV11,
 11125           DFHEIV99
 11126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11127
 11128
 11129     MOVE 'Y'                    TO  WS-BROWSE-START-SW.
 11130
 11131 1700-READ-NEXT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 208
* EL150.cbl
 11132
 11133
 11134* EXEC CICS READNEXT
 11135*        DATASET   (EMPHST-FILE-ID)
 11136*        SET       (ADDRESS OF POLICY-HISTORY)
 11137*        RIDFLD    (EMPHST-KEY)
 11138*    END-EXEC.
 11139     MOVE 0
 11140       TO DFHEIV11
 11141*    MOVE '&.S                   )   #00010343' TO DFHEIV0
 11142     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11143     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11144     MOVE X'2020233030303130333433' TO DFHEIV0(25:11)
 11145     CALL 'kxdfhei1' USING DFHEIV0,
 11146           EMPHST-FILE-ID,
 11147           DFHEIV20,
 11148           DFHEIV99,
 11149           EMPHST-KEY,
 11150           DFHEIV99,
 11151           DFHEIV11,
 11152           DFHEIV99,
 11153           DFHEIV99
 11154     SET ADDRESS OF POLICY-HISTORY TO
 11155         DFHEIV20
 11156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11157
 11158
 11159     IF PM-COMPANY-CD       = PH-COMPANY-CD         AND
 11160        PM-CARRIER          = PH-CARRIER            AND
 11161        PM-GROUPING         = EMPHST-GROUPING       AND
 11162        PM-STATE            = EMPHST-STATE          AND
 11163        PM-PRODUCER         = EMPHST-PRODUCER       AND
 11164        PM-POLICY-EFF-DT    = EMPHST-POLICY-EFF-DT  AND
 11165        PM-REFERENCE-NUMBER = EMPHST-REFERENCE-NUMBER
 11166         NEXT SENTENCE
 11167     ELSE
 11168         GO TO 1700-ENDBROWSE.
 11169
 11170     IF PM-LIFE-MORT-PLAN
 11171         IF PH-RECORD-TYPE = '02' AND
 11172            PH-FIELD-TYPE  = '21'
 11173             NEXT SENTENCE
 11174         ELSE
 11175             GO TO 1700-ENDBROWSE.
 11176
 11177     IF NOT PM-LIFE-MORT-PLAN
 11178         IF PH-RECORD-TYPE = '04' AND
 11179            PH-FIELD-TYPE  = '07'
 11180             NEXT SENTENCE
 11181         ELSE
 11182             GO TO 1700-ENDBROWSE.
 11183
 11184     IF PH-CHANGE-DT > CL-INCURRED-DT
 11185         GO TO 1700-READ-NEXT.
 11186
 11187     MOVE PH-RECORD-BODY         TO  WS-HISTORY-AREA.
 11188
 11189
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 209
* EL150.cbl
 11190* EXEC CICS BIF
 11191*        DEEDIT
 11192*        FIELD (WS-HISTORY-AREA)
 11193*        LENGTH ('50')
 11194*    END-EXEC.
 11195     MOVE '50'
 11196       TO DFHEIV11
 11197*    MOVE '@"L                   #   #00010379' TO DFHEIV0
 11198     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 11199     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11200     MOVE X'2020233030303130333739' TO DFHEIV0(25:11)
 11201     CALL 'kxdfhei1' USING DFHEIV0,
 11202           WS-HISTORY-AREA,
 11203           DFHEIV11
 11204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11205
 11206
 11207     IF PM-LIFE-MORT-PLAN
 11208         MOVE WS-NUMERIC-FLD1    TO  PM-INSURED-TOT-BENEFIT
 11209     ELSE
 11210         MOVE WS-NUMERIC-FLD1    TO  PM-INS-MONTH-BENEFIT.
 11211
 11212 1700-ENDBROWSE.
 11213
 11214
 11215* EXEC CICS ENDBR
 11216*        DATASET   (EMPHST-FILE-ID)
 11217*    END-EXEC.
 11218     MOVE 0
 11219       TO DFHEIV11
 11220*    MOVE '&2                    $   #00010392' TO DFHEIV0
 11221     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11222     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11223     MOVE X'2020233030303130333932' TO DFHEIV0(25:11)
 11224     CALL 'kxdfhei1' USING DFHEIV0,
 11225           EMPHST-FILE-ID,
 11226           DFHEIV11,
 11227           DFHEIV99
 11228     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11229
 11230
 11231 1700-EXIT.
 11232      EXIT.
 11233
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 210
* EL150.cbl
 11235 2000-BUILD-TRAILER-DISPLAY.
 11236
 11237     IF DIRECTION-SWITCH = 'F'
 11238        IF PI-PREV-DIR = 'B' AND PI-PREV-DISP = 'N'
 11239           MOVE PI-SAVE-LOW    TO TRLR-SEQ-NO
 11240        ELSE
 11241           MOVE PI-SAVE-HIGH   TO TRLR-SEQ-NO
 11242           ADD +1              TO TRLR-SEQ-NO
 11243     ELSE
 11244        IF DIRECTION-SWITCH = 'B'
 11245           IF PI-PREV-DIR = 'F' AND PI-PREV-DISP = 'N'
 11246              MOVE PI-SAVE-HIGH TO TRLR-SEQ-NO
 11247           ELSE
 11248              MOVE PI-SAVE-LOW TO TRLR-SEQ-NO
 11249        ELSE
 11250           IF DIRECTION-SWITCH = 'R'
 11251              MOVE PI-SAVE-LOW TO TRLR-SEQ-NO
 11252              MOVE 'F'        TO DIRECTION-SWITCH
 11253           ELSE
 11254              IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11255                  MOVE +95     TO  TRLR-SEQ-NO
 11256                  MOVE +0      TO  PI-SAVE-LOW
 11257                                   PI-SAVE-HIGH
 11258                  MOVE 'N'     TO  PI-PREV-DISP
 11259                  MOVE 'F'     TO  DIRECTION-SWITCH
 11260              ELSE
 11261                  MOVE +93     TO  TRLR-SEQ-NO
 11262                  MOVE +0      TO  PI-SAVE-LOW
 11263                                   PI-SAVE-HIGH
 11264                  MOVE 'N'     TO  PI-PREV-DISP
 11265                  MOVE 'F'     TO  DIRECTION-SWITCH.
 11266
 11267     IF DIRECTION-SWITCH = 'F'
 11268         MOVE +1                 TO DISPLAY-CNT
 11269     ELSE
 11270         MOVE +4                 TO DISPLAY-CNT.
 11271
 11272     MOVE PI-COMPANY-CD          TO TRLR-COMP-CD.
 11273     MOVE PI-CARRIER             TO TRLR-CARRIER.
 11274     MOVE PI-CLAIM-NO            TO TRLR-CLAIM-NO.
 11275     MOVE PI-CERT-NO             TO TRLR-CERT-NO.
 11276     MOVE 'TRLR'                 TO FILE-SWITCH.
 11277
 11278     IF PI-SAVE-SYS-ID = 'CV'
 11279         NEXT SENTENCE
 11280     ELSE
 11281         GO TO 2005-BUILD-CR-LOAN-DATA.
 11282
 11283     IF WS-CERT-READ-SW = 'Y'
 11284       IF PI-COMPANY-ID = 'CIG' OR 'CUK'
 11285         IF CL-SYSTEM-IDENTIFIER = 'CV'
 11286           MOVE PM-INS-TERMINATION-DT    TO  DC-BIN-DATE-1
 11287           MOVE ' '                      TO  DC-OPTION-CODE
 11288           MOVE +0                       TO  DC-ELAPSED-MONTHS
 11289                                             DC-ELAPSED-DAYS
 11290           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11291           IF NO-CONVERSION-ERROR
 11292               MOVE DC-GREG-DATE-1-EDIT  TO  WS-LOAN-EXPIRE-DT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 211
* EL150.cbl
 11293           ELSE
 11294               MOVE SPACES               TO  WS-LOAN-EXPIRE-DT.
 11295
 11296     IF WS-CERT-READ-SW = 'Y'
 11297       IF PI-COMPANY-ID = 'CIG' OR 'CUK'
 11298         MOVE SPACES                 TO  TRAILER-DISPLAY-WORK-AREA
 11299         MOVE 'LOAN INFO'            TO  DISPLAY-ACTION
 11300         MOVE ZEROS                  TO  DISPLAY-SEQ
 11301         MOVE WS-LOAN-EXPIRE-DT      TO  DISPLAY-DATE
 11302         MOVE PM-LOAN-NUMBER         TO  ASSOC-CV-LOAN
 11303         MOVE ASSOC-CV-LOAN-TEXT     TO  DISPLAY-TEXT
 11304         MOVE TRAILER-DISPLAY-WORK-AREA
 11305                                     TO  MAP-DISPLAY (DISPLAY-CNT)
 11306         ADD +1                      TO  DISPLAY-CNT.
 11307
 11308     GO TO 2010-CONTINUE-TRAILER-DISPLAY.
 11309
 11310 2005-BUILD-CR-LOAN-DATA.
 11311
 11312     IF WS-CERT-READ-SW = 'Y'
 11313        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11314          IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11315            MOVE CM-LF-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 11316            MOVE ' '                     TO  DC-OPTION-CODE
 11317            MOVE +0                      TO  DC-ELAPSED-MONTHS
 11318                                             DC-ELAPSED-DAYS
 11319            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11320            IF NO-CONVERSION-ERROR
 11321              MOVE DC-GREG-DATE-1-EDIT   TO  WS-LOAN-EXPIRE-DT
 11322            ELSE
 11323              MOVE SPACES                TO  WS-LOAN-EXPIRE-DT
 11324          ELSE
 11325            MOVE CM-AH-LOAN-EXPIRE-DT    TO  DC-BIN-DATE-1
 11326            MOVE ' '                     TO  DC-OPTION-CODE
 11327            MOVE +0                      TO  DC-ELAPSED-MONTHS
 11328                                             DC-ELAPSED-DAYS
 11329            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11330            IF NO-CONVERSION-ERROR
 11331              MOVE DC-GREG-DATE-1-EDIT   TO  WS-LOAN-EXPIRE-DT
 11332            ELSE
 11333              MOVE SPACES                TO  WS-LOAN-EXPIRE-DT.
 11334
 11335     IF WS-CERT-READ-SW = 'Y'
 11336       IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11337         MOVE SPACES             TO  TRAILER-DISPLAY-WORK-AREA
 11338         MOVE ZEROS              TO  DISPLAY-SEQ
 11339         MOVE 'LOAN DATA'        TO  DISPLAY-ACTION
 11340         MOVE WS-LOAN-EXPIRE-DT  TO  DISPLAY-DATE
 11341         MOVE CM-LOAN-NUMBER     TO  ASSOC-ORIG-LOAN
 11342         MOVE CM-MEMBER-NO       TO  ASSOC-CUR-LOAN
 11343         MOVE CL-LOAN-TYPE       TO  ASSOC-LOAN-TYPE
 11344         MOVE ASSOC-LOAN-TEXT    TO  DISPLAY-TEXT
 11345         MOVE TRAILER-DISPLAY-WORK-AREA
 11346                                 TO  MAP-DISPLAY (DISPLAY-CNT)
 11347         ADD +1                  TO  DISPLAY-CNT
 11348       ELSE
 11349         IF CM-OPEN-END
 11350           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 212
* EL150.cbl
 11351           MOVE 'LOAN INFO'      TO DISPLAY-ACTION
 11352           MOVE CM-LOAN-NUMBER   TO LOAN-NUMBER
 11353           MOVE CM-LOAN-BALANCE  TO LOAN-BALANCE
 11354           MOVE CM-MEMBER-NO     TO LOAN-MEMBER
 11355           MOVE LOAN-TEXT        TO DISPLAY-TEXT
 11356           MOVE TRAILER-DISPLAY-WORK-AREA
 11357                                 TO MAP-DISPLAY (DISPLAY-CNT)
 11358           ADD +1                TO DISPLAY-CNT.
 11359
 11360     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 11361        PERFORM 6150-READ-TRLR92 THRU 6150-EXIT
 11362        if ws-resp-normal
 11363           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
 11364           MOVE 'SPECIAL REVIEW' TO DISPLAY-ACTION
 11365           move at-recorded-by   to display-by
 11366           move at-recorded-dt   to dc-bin-date-1
 11367           MOVE ' '              TO DC-OPTION-CODE
 11368           PERFORM 9700-LINK-DATE-CONVERT
 11369                                 THRU 9700-EXIT
 11370           MOVE DC-GREG-DATE-1-EDIT
 11371                                 TO DISPLAY-DATE
 11372           MOVE ws-TRLR-SEQ-NO   TO DISPLAY-SEQ
 11373           MOVE AT-INFO-LINE-1   TO DISPLAY-TEXT
 11374           MOVE TRAILER-DISPLAY-WORK-AREA
 11375                                 TO MAP-DISPLAY (1)
 11376           if direction-switch = 'F'
 11377              ADD +1             TO  DISPLAY-CNT
 11378           end-if
 11379        end-if
 11380        PERFORM 6160-READ-TRLR93 THRU 6160-EXIT
 11381        if ws-resp-normal
 11382           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
 11383           MOVE 'VERIFY SSN    ' TO DISPLAY-ACTION
 11384           move at-recorded-by   to display-by
 11385           move at-recorded-dt   to dc-bin-date-1
 11386           MOVE ' '              TO DC-OPTION-CODE
 11387           PERFORM 9700-LINK-DATE-CONVERT
 11388                                 THRU 9700-EXIT
 11389           MOVE DC-GREG-DATE-1-EDIT
 11390                                 TO DISPLAY-DATE
 11391           MOVE ws-TRLR-SEQ-NO   TO DISPLAY-SEQ
 11392           MOVE AT-INFO-LINE-1   TO DISPLAY-TEXT
 11393           IF MAP-DISPLAY (1) (1:14) = 'SPECIAL REVIEW'
 11394               MOVE TRAILER-DISPLAY-WORK-AREA
 11395                                 TO MAP-DISPLAY (2)
 11396           ELSE
 11397               MOVE TRAILER-DISPLAY-WORK-AREA
 11398                                 TO MAP-DISPLAY (1)
 11399           END-IF
 11400           if direction-switch = 'F'
 11401              ADD +1             TO  DISPLAY-CNT
 11402           end-if
 11403        end-if
 11404        PERFORM 6170-READ-TRLR94 THRU 6170-EXIT
 11405        if ws-resp-normal
 11406           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
 11407           MOVE 'CAUSAL STATE  ' TO DISPLAY-ACTION
 11408           MOVE AT-RECORDED-BY   TO DISPLAY-BY
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 213
* EL150.cbl
 11409           MOVE AT-RECORDED-DT   TO DC-BIN-DATE-1
 11410           MOVE ' '              TO DC-OPTION-CODE
 11411           PERFORM 9700-LINK-DATE-CONVERT
 11412                                 THRU 9700-EXIT
 11413           MOVE DC-GREG-DATE-1-EDIT
 11414                                 TO DISPLAY-DATE
 11415           MOVE WS-TRLR-SEQ-NO   TO DISPLAY-SEQ
 11416           MOVE AT-INFO-LINE-1   TO DISPLAY-TEXT
 11417           IF MAP-DISPLAY (1) (1:14) = 'SPECIAL REVIEW'
 11418            OR 'VERIFY SSN    '
 11419               IF MAP-DISPLAY (2) (1:14) = 'VERIFY SSN    '
 11420                   MOVE TRAILER-DISPLAY-WORK-AREA
 11421                                 TO MAP-DISPLAY (3)
 11422               ELSE
 11423                  MOVE TRAILER-DISPLAY-WORK-AREA
 11424                                 TO MAP-DISPLAY (2)
 11425               END-IF
 11426           ELSE
 11427               MOVE TRAILER-DISPLAY-WORK-AREA
 11428                                 TO MAP-DISPLAY (1)
 11429           END-IF
 11430           IF DIRECTION-SWITCH = 'F'
 11431              ADD +1             TO  DISPLAY-CNT
 11432           END-IF
 11433        END-IF
 11434     end-if
 11435     IF PI-COMPANY-ID = 'DCC'
 11436        PERFORM 6180-READ-TRLR95 THRU 6180-EXIT
 11437        if ws-resp-normal
 11438           move error-message-interface-block
 11439                                 to ws-save-error-interface-block
 11440           MOVE SPACES           TO TRAILER-DISPLAY-WORK-AREA
 11441           MOVE 'NOTE'           TO DISPLAY-ACTION
 11442           move at-recorded-by   to display-by
 11443           move at-recorded-dt   to dc-bin-date-1
 11444           MOVE ' '              TO DC-OPTION-CODE
 11445           PERFORM 9700-LINK-DATE-CONVERT
 11446                                 THRU 9700-EXIT
 11447           MOVE DC-GREG-DATE-1-EDIT
 11448                                 TO DISPLAY-DATE
 11449           MOVE ws-TRLR-SEQ-NO   TO DISPLAY-SEQ
 11450           perform varying a1 from +1 by +1 until
 11451              at-note-error-no (a1) = spaces
 11452              or display-cnt > +4
 11453              move at-note-error-no (a1)
 11454                                 to emi-error
 11455              if at-note-error-no (a1) = '1653'
 11456                 evaluate true
 11457                    when pi-save-type = 'L'
 11458                       move '  LF  '
 11459                              to emi-claim-type
 11460                    when pi-save-type = 'I'
 11461                       move '  IU  '
 11462                              to emi-claim-type
 11463                    when pi-save-type = 'F'
 11464                       move '  FL  '
 11465                              to emi-claim-type
 11466                    when other
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 214
* EL150.cbl
 11467                       move '  AH  '
 11468                              to emi-claim-type
 11469                 end-evaluate
 11470              end-if
 11471              PERFORM 9900-ERROR-FORMAT
 11472                                 THRU 9900-EXIT
 11473              move emi-line1 (8:64)
 11474                             to TRAILER-DISPLAY-WORK-AREA (16:64)
 11475              move trailer-display-work-area
 11476                                 to map-display (display-cnt)
 11477              if direction-switch = 'F'
 11478                 ADD +1          TO  DISPLAY-CNT
 11479              end-if
 11480              move ws-save-error-interface-block
 11481                                 to error-message-interface-block
 11482           end-perform
 11483        end-if
 11484     end-if
 11485     .
 11486 2010-CONTINUE-TRAILER-DISPLAY.
 11487
 11488
 11489* EXEC CICS HANDLE CONDITION
 11490*        ENDFILE   (2950-NO-MORE-TRAILERS)
 11491*        NOTFND    (2950-NO-MORE-TRAILERS)
 11492*    END-EXEC.
 11493*    MOVE '"$''I                  ! 3 #00010653' TO DFHEIV0
 11494     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11495     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11496     MOVE X'3320233030303130363533' TO DFHEIV0(25:11)
 11497     CALL 'kxdfhei1' USING DFHEIV0
 11498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11499
 11500
 11501
 11502* EXEC CICS STARTBR
 11503*        DATASET   ('ELTRLR')
 11504*        GTEQ
 11505*        RIDFLD    (ELTRLR-KEY)
 11506*    END-EXEC.
 11507     MOVE 'ELTRLR' TO DFHEIV1
 11508     MOVE 0
 11509       TO DFHEIV11
 11510*    MOVE '&,         G          &   #00010658' TO DFHEIV0
 11511     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11512     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11513     MOVE X'2020233030303130363538' TO DFHEIV0(25:11)
 11514     CALL 'kxdfhei1' USING DFHEIV0,
 11515           DFHEIV1,
 11516           ELTRLR-KEY,
 11517           DFHEIV99,
 11518           DFHEIV11,
 11519           DFHEIV99
 11520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11521
 11522
 11523     IF DIRECTION-SWITCH = 'B'
 11524         IF (PI-PREV-DISP = 'Y') OR (PI-PREV-DIR = 'B')
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 215
* EL150.cbl
 11525
 11526* EXEC CICS READPREV
 11527*                DATASET ('ELTRLR')
 11528*                RIDFLD  (ELTRLR-KEY)
 11529*                SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11530*            END-EXEC.
 11531     MOVE 'ELTRLR' TO DFHEIV1
 11532     MOVE 0
 11533       TO DFHEIV11
 11534*    MOVE '&0S                   )   #00010666' TO DFHEIV0
 11535     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 11536     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11537     MOVE X'2020233030303130363636' TO DFHEIV0(25:11)
 11538     CALL 'kxdfhei1' USING DFHEIV0,
 11539           DFHEIV1,
 11540           DFHEIV20,
 11541           DFHEIV99,
 11542           ELTRLR-KEY,
 11543           DFHEIV99,
 11544           DFHEIV11,
 11545           DFHEIV99,
 11546           DFHEIV99
 11547     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11548         DFHEIV20
 11549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11550
 11551
 11552     MOVE 'N'                    TO PI-PREV-DISP.
 11553
 11554     MOVE DIRECTION-SWITCH       TO PI-PREV-DIR.
 11555
 11556 2020-READ-TRAILER-LOOP.
 11557     IF DIRECTION-SWITCH = 'F'
 11558
 11559* EXEC CICS READNEXT
 11560*            DATASET   ('ELTRLR')
 11561*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11562*            RIDFLD    (ELTRLR-KEY)
 11563*        END-EXEC
 11564     MOVE 'ELTRLR' TO DFHEIV1
 11565     MOVE 0
 11566       TO DFHEIV11
 11567*    MOVE '&.S                   )   #00010678' TO DFHEIV0
 11568     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11569     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11570     MOVE X'2020233030303130363738' TO DFHEIV0(25:11)
 11571     CALL 'kxdfhei1' USING DFHEIV0,
 11572           DFHEIV1,
 11573           DFHEIV20,
 11574           DFHEIV99,
 11575           ELTRLR-KEY,
 11576           DFHEIV99,
 11577           DFHEIV11,
 11578           DFHEIV99,
 11579           DFHEIV99
 11580     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11581         DFHEIV20
 11582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 216
* EL150.cbl
 11583     ELSE
 11584
 11585* EXEC CICS READPREV
 11586*            DATASET   ('ELTRLR')
 11587*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11588*            RIDFLD    (ELTRLR-KEY)
 11589*        END-EXEC.
 11590     MOVE 'ELTRLR' TO DFHEIV1
 11591     MOVE 0
 11592       TO DFHEIV11
 11593*    MOVE '&0S                   )   #00010684' TO DFHEIV0
 11594     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 11595     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11596     MOVE X'2020233030303130363834' TO DFHEIV0(25:11)
 11597     CALL 'kxdfhei1' USING DFHEIV0,
 11598           DFHEIV1,
 11599           DFHEIV20,
 11600           DFHEIV99,
 11601           ELTRLR-KEY,
 11602           DFHEIV99,
 11603           DFHEIV11,
 11604           DFHEIV99,
 11605           DFHEIV99
 11606     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11607         DFHEIV20
 11608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11609
 11610
 11611     IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)  OR
 11612        (PI-CARRIER    NOT = TRLR-CARRIER)  OR
 11613        (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO) OR
 11614        (PI-CERT-NO    NOT = TRLR-CERT-NO)
 11615            GO TO 2950-NO-MORE-TRAILERS.
 11616
 11617*    IF TRLR-SEQ-NO = 90
 11618     IF TRLR-SEQ-NO = 90 or 91 or 92 or 93
 11619       OR 94 or 95
 11620         GO TO 2020-READ-TRAILER-LOOP.
 11621
 11622     IF PI-COMPANY-ID = 'LAP'
 11623         IF TRLR-SEQ-NO > +100 AND < +301
 11624             GO TO 2020-READ-TRAILER-LOOP.
 11625
 11626     IF RESERVE-EXPENSE-TR OR ADDRESS-TR
 11627         GO TO 2020-READ-TRAILER-LOOP.
 11628
 11629     IF PAYMENT-TR
 11630         GO TO 2100-PAYMENT-TRAILER.
 11631
 11632     IF AUTO-PAY-TR
 11633        GO TO 2200-AUTO-PAYMENT-TRAILER.
 11634
 11635     IF CORRESPONDENCE-TR
 11636         GO TO 2300-CORRESPONDENCE-TRAILER.
 11637
 11638     IF GENERAL-INFO-TR
 11639         GO TO 2400-GENERAL-INFO-TRAILER.
 11640
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 217
* EL150.cbl
 11641     IF AUTO-PROMPT-TR
 11642         GO TO 2500-AUTO-PROMPT-TRAILER.
 11643
 11644     IF DENIAL-TR
 11645         GO TO 2600-DENIAL-TRAILER.
 11646
 11647     IF INCURRED-CHG-TR
 11648         GO TO 2700-INCURRED-CHANGE-TRAILER.
 11649
 11650     IF FORM-CONTROL-TR
 11651         GO TO 2710-FORM-CONTROL-TRAILER.
 11652
 11653     GO TO 2020-READ-TRAILER-LOOP.
 11654
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 218
* EL150.cbl
 11656 2100-PAYMENT-TRAILER.
 11657
 11658     IF AT-PAYMENT-NOTE
 11659         GO TO 2020-READ-TRAILER-LOOP.
 11660
 11661     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11662
 11663     IF AT-PAYMENT-TYPE = 'T'
 11664         MOVE 'TRANSFER PMT'     TO DISPLAY-ACTION
 11665         GO TO 2100-CONT.
 11666
 11667     IF PI-SAVE-SYS-ID = 'CV'
 11668         IF AT-CLAIM-TYPE = 'L'
 11669             MOVE AT-CV-PMT-CODE             TO  WS-SUB
 11670             IF WS-SUB < 1 OR > 8
 11671                 MOVE 1                      TO  WS-SUB
 11672                 MOVE CV-PAY-DESC (WS-SUB)   TO  DISPLAY-ACTION
 11673             ELSE
 11674                 MOVE CV-PAY-DESC (WS-SUB)   TO  DISPLAY-ACTION.
 11675
 11676     IF AT-PAYMENT-TYPE = 'I'
 11677        MOVE 'INTEREST PMT'      TO DISPLAY-ACTION
 11678     ELSE
 11679     IF (PI-SAVE-SYS-ID = 'CV' AND AT-CLAIM-TYPE = 'A')
 11680                  OR
 11681         PI-SAVE-SYS-ID NOT = 'CV'
 11682         MOVE AT-PAYMENT-TYPE           TO  WS-SUB
 11683         IF WS-SUB < 1 OR > 6
 11684             MOVE 2                     TO  WS-SUB
 11685             MOVE PAY-DESC (WS-SUB)     TO  DISPLAY-ACTION
 11686         ELSE
 11687             MOVE PAY-DESC (WS-SUB)     TO  DISPLAY-ACTION.
 11688
 11689 2100-CONT.
 11690
 11691     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11692     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11693     MOVE ' '                    TO DC-OPTION-CODE.
 11694     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11695     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11696     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11697
 11698     IF AT-VOID-DT NOT = LOW-VALUES
 11699        MOVE AT-VOID-DT         TO DC-BIN-DATE-1
 11700        MOVE ' '                TO DC-OPTION-CODE
 11701        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11702        MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
 11703        IF AT-VOID-TYPE = 'S'
 11704            MOVE 'STOP DT='     TO PMT-VAR
 11705        ELSE
 11706            MOVE 'VOIDED ='     TO PMT-VAR
 11707     ELSE
 11708        IF AT-PAID-THRU-DT NOT = LOW-VALUES
 11709           MOVE AT-PAID-THRU-DT TO DC-BIN-DATE-1
 11710           MOVE ' '             TO DC-OPTION-CODE
 11711           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11712           MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
 11713           MOVE 'PD THRU='     TO PMT-VAR
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 219
* EL150.cbl
 11714           IF PI-USES-PAID-TO
 11715              MOVE AT-PAID-THRU-DT TO DC-BIN-DATE-1
 11716              MOVE '6'             TO DC-OPTION-CODE
 11717              MOVE +1              TO DC-ELAPSED-DAYS
 11718              MOVE +0              TO DC-ELAPSED-MONTHS
 11719              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11720              MOVE DC-GREG-DATE-1-EDIT TO PMT-PD-THRU
 11721              MOVE 'PAID TO='      TO PMT-VAR
 11722           ELSE
 11723              NEXT SENTENCE
 11724        ELSE
 11725           IF CHARGEABLE-EXPENSE OR NON-CHARGEABLE-EXPENSE
 11726              MOVE 'EXP TYP='       TO PMT-VAR
 11727              MOVE AT-EXPENSE-TYPE  TO PMT-PD-THRU
 11728           ELSE
 11729              MOVE SPACES      TO PMT-VAR  PMT-PD-THRU.
 11730
 11731     MOVE AT-CHECK-NO               TO PMT-CHECK-NO.
 11732     MOVE AT-AMOUNT-PAID            TO PMT-AMOUNT.
 11733     MOVE PAYMENT-TEXT              TO DISPLAY-TEXT.
 11734     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11735
 11736     GO TO 2800-INCR-DISPLAY-CNT.
 11737
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 220
* EL150.cbl
 11739 2200-AUTO-PAYMENT-TRAILER.
 11740     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11741     MOVE 'AUTO PMT SETUP'       TO DISPLAY-ACTION.
 11742     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11743
 11744     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11745     MOVE ' '                    TO DC-OPTION-CODE.
 11746     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11747     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11748
 11749     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11750
 11751     IF PI-COMPANY-ID = 'DMD'
 11752        IF AT-TERMINATED-DT NOT = SPACES AND ZEROS
 11753                                         AND LOW-VALUES
 11754           MOVE AT-TERMINATED-DT          TO DC-BIN-DATE-1
 11755           MOVE ' '                       TO DC-OPTION-CODE
 11756           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11757           MOVE DC-GREG-DATE-1-EDIT       TO AUTO-TERMINATED
 11758           MOVE AT-REGULAR-PMT-AMT        TO AUTO-TERM-AMT
 11759           MOVE AUTO-TERM-TEXT            TO DISPLAY-TEXT
 11760           MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY
 11761                                            (DISPLAY-CNT)
 11762           GO TO 2800-INCR-DISPLAY-CNT.
 11763
 11764     MOVE AT-SCHEDULE-START-DT   TO DC-BIN-DATE-1.
 11765     MOVE ' '                    TO DC-OPTION-CODE.
 11766     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11767     MOVE DC-GREG-DATE-1-EDIT    TO AUTO-START.
 11768
 11769     IF PI-USES-PAID-TO
 11770         MOVE AT-SCHEDULE-END-DT        TO  DC-BIN-DATE-1
 11771         MOVE '6'                       TO  DC-OPTION-CODE
 11772         MOVE +1                        TO  DC-ELAPSED-DAYS
 11773         MOVE +0                        TO  DC-ELAPSED-MONTHS
 11774         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11775         IF NO-CONVERSION-ERROR
 11776             MOVE DC-GREG-DATE-1-EDIT   TO  AUTO-END
 11777         ELSE
 11778             MOVE SPACES                TO  AUTO-END
 11779     ELSE
 11780         MOVE AT-SCHEDULE-END-DT        TO  DC-BIN-DATE-1
 11781         MOVE ' '                       TO  DC-OPTION-CODE
 11782         MOVE +0                        TO  DC-ELAPSED-DAYS
 11783                                            DC-ELAPSED-MONTHS
 11784         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11785         IF NO-CONVERSION-ERROR
 11786             MOVE DC-GREG-DATE-1-EDIT   TO  AUTO-END
 11787         ELSE
 11788             MOVE SPACES                TO  AUTO-END.
 11789
 11790     MOVE AT-REGULAR-PMT-AMT        TO AUTO-AMOUNT.
 11791     MOVE AUTO-PMT-TEXT             TO DISPLAY-TEXT.
 11792     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11793
 11794     GO TO 2800-INCR-DISPLAY-CNT.
 11795
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 221
* EL150.cbl
 11797 2300-CORRESPONDENCE-TRAILER.
 11798     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11799     MOVE 'LETTER'               TO DISP-ACT-A.
 11800     MOVE AT-STD-LETTER-FORM     TO DISP-ACT-B.
 11801     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11802
 11803     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11804     MOVE ' '                    TO DC-OPTION-CODE.
 11805     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11806     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11807
 11808     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11809
 11810     IF AT-ADDRESEE-TYPE = 'I'
 11811         MOVE 1                  TO WS-SUB
 11812      ELSE
 11813     IF AT-ADDRESEE-TYPE = 'B'
 11814         MOVE 2                  TO WS-SUB
 11815      ELSE
 11816     IF AT-ADDRESEE-TYPE = 'A'
 11817         MOVE 3                  TO WS-SUB
 11818      ELSE
 11819     IF AT-ADDRESEE-TYPE = 'P'
 11820         MOVE 4                  TO WS-SUB
 11821      ELSE
 11822     IF AT-ADDRESEE-TYPE = 'E'
 11823         MOVE 5                  TO WS-SUB
 11824      ELSE
 11825     IF AT-ADDRESEE-TYPE = 'O'
 11826         MOVE 6                  TO WS-SUB
 11827      ELSE
 11828     IF AT-ADDRESEE-TYPE = 'Q'
 11829         MOVE 7                  TO WS-SUB
 11830      ELSE
 11831         MOVE 0                  TO WS-SUB.
 11832
 11833     IF WS-SUB = 0
 11834         MOVE SPACES             TO  CORR-TO
 11835     ELSE
 11836         MOVE CORR-DESC (WS-SUB) TO  CORR-TO.
 11837
 11838     IF AT-STOP-LETTER-DT NOT = LOW-VALUES AND SPACES
 11839        AND (AT-LETTER-ANSWERED-DT = LOW-VALUES  OR
 11840             AT-LETTER-ANSWERED-DT > AT-STOP-LETTER-DT)
 11841          MOVE '   STOP='         TO CORR-RECVD-LIT
 11842          MOVE AT-STOP-LETTER-DT  TO DC-BIN-DATE-1
 11843          MOVE ' '                TO DC-OPTION-CODE
 11844          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11845          MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
 11846     ELSE
 11847        IF AT-LETTER-SENT-DT = LOW-VALUES OR SPACES
 11848            MOVE 'MAIL RCVD'    TO DISP-ACT-A
 11849        END-IF
 11850        MOVE '  RECVD='         TO CORR-RECVD-LIT
 11851        IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES
 11852            MOVE AT-LETTER-ANSWERED-DT TO DC-BIN-DATE-1
 11853            MOVE ' '                TO DC-OPTION-CODE
 11854            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 222
* EL150.cbl
 11855            MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
 11856        ELSE
 11857            MOVE SPACES             TO CORR-RECVD
 11858        END-IF
 11859     END-IF.
 11860
 11861     IF AT-RESEND-PRINT-DATE NOT = LOW-VALUES
 11862         MOVE '  RESENT='          TO CORR-VAR
 11863         MOVE AT-RESEND-PRINT-DATE TO DC-BIN-DATE-1
 11864         MOVE ' '                  TO DC-OPTION-CODE
 11865         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11866         MOVE DC-GREG-DATE-1-EDIT  TO CORR-RESENT
 11867     ELSE
 11868         IF AT-AUTO-RE-SEND-DT NOT = LOW-VALUES
 11869             MOVE '  RESEND='         TO CORR-VAR
 11870             MOVE AT-AUTO-RE-SEND-DT  TO DC-BIN-DATE-1
 11871             MOVE ' '                 TO DC-OPTION-CODE
 11872             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11873             MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
 11874         ELSE
 11875            IF AT-LETTER-ARCHIVE-NO NOT = ZEROS
 11876               MOVE 'ARCH. NO='          TO CORR-VAR
 11877               MOVE AT-LETTER-ARCHIVE-NO TO CORR-ARCH-NO
 11878            ELSE
 11879               MOVE SPACES       TO CORR-RESENT  CORR-VAR.
 11880
 11881*    IF PI-COMPANY-ID = 'DMD'
 11882*        IF AT-DMD-LETTER-PURGE-DT NOT = SPACES AND LOW-VALUES
 11883*            MOVE '  PURGED='             TO CORR-VAR
 11884*            MOVE AT-DMD-LETTER-PURGE-DT  TO DC-BIN-DATE-1
 11885*            MOVE ' '                     TO DC-OPTION-CODE
 11886*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11887*            MOVE DC-GREG-DATE-1-EDIT     TO CORR-RESENT.
 11888
 11889     MOVE CORRESPONDENCE-TEXT       TO DISPLAY-TEXT.
 11890     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11891
 11892     GO TO 2800-INCR-DISPLAY-CNT.
 11893
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 223
* EL150.cbl
 11895 2400-GENERAL-INFO-TRAILER.
 11896
 11897     IF AT-PAYMENT-NOTE
 11898         GO TO 2020-READ-TRAILER-LOOP.
 11899
 11900     IF AT-CONTINUED-NOTE
 11901         GO TO 2020-READ-TRAILER-LOOP.
 11902
 11903     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11904
 11905     IF AT-MAINT-NOTE
 11906         MOVE 'MAINT NOTES'      TO DISPLAY-ACTION
 11907     ELSE
 11908         IF AT-CALL-NOTE
 11909             MOVE 'CALL'         TO DISP-ACT-A
 11910             IF AT-PHONE-CALL-IN
 11911                 MOVE 'IN'       TO DISP-ACT-B
 11912             ELSE
 11913                 MOVE 'OUT'      TO DISP-ACT-B
 11914         ELSE
 11915             IF AT-CERT-CHANGE
 11916                 MOVE 'CERT CHANGE'
 11917                                 TO DISPLAY-ACTION
 11918             ELSE IF AT-APPROVAL-NOTE
 11919                 MOVE 'APPROVL REVIEW' TO DISPLAY-ACTION
 11920             ELSE IF AT-NOTE-FILE-NOTE
 11921                 MOVE 'NOTE & FILE' TO DISPLAY-ACTION
 11922             ELSE
 11923                 MOVE 'NOTE'     TO DISPLAY-ACTION.
 11924
 11925     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11926     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11927     MOVE ' '                    TO DC-OPTION-CODE.
 11928     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11929     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11930
 11931     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11932     MOVE AT-INFO-LINE-1         TO DISPLAY-TEXT.
 11933     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11934     GO TO 2800-INCR-DISPLAY-CNT.
 11935
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 224
* EL150.cbl
 11937 2500-AUTO-PROMPT-TRAILER.
 11938     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11939     MOVE '5'                    TO DC-OPTION-CODE.
 11940     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11941
 11942     IF DC-BIN-DATE-1 > AT-PROMPT-END-DT
 11943         GO TO 2020-READ-TRAILER-LOOP.
 11944
 11945     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11946     MOVE 'REMINDER'             TO DISPLAY-ACTION.
 11947     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11948
 11949     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11950     MOVE ' '                    TO DC-OPTION-CODE.
 11951     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11952     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11953
 11954     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11955
 11956     MOVE AT-PROMPT-END-DT       TO DC-BIN-DATE-1.
 11957     MOVE ' '                    TO DC-OPTION-CODE.
 11958     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11959     MOVE DC-GREG-DATE-1-EDIT    TO PROMPT-END.
 11960
 11961     MOVE AT-PROMPT-LINE-1       TO PROMPT-MSG.
 11962     MOVE PROMPT-TEXT            TO DISPLAY-TEXT.
 11963     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 11964     GO TO 2800-INCR-DISPLAY-CNT.
 11965
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 225
* EL150.cbl
 11967 2600-DENIAL-TRAILER.
 11968     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 11969     MOVE 'DENIAL'               TO DISPLAY-ACTION.
 11970     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 11971
 11972     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 11973     MOVE ' '                    TO DC-OPTION-CODE.
 11974     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11975     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 11976
 11977     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 11978
 11979     IF AT-RETRACTION-DT NOT = LOW-VALUES
 11980         MOVE AT-DENIAL-DT       TO DC-BIN-DATE-1
 11981         MOVE ' '                TO DC-OPTION-CODE
 11982         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11983         MOVE DC-GREG-DATE-1-EDIT TO DENIED-DATE
 11984         MOVE AT-RETRACTION-DT   TO DC-BIN-DATE-1
 11985         MOVE ' '                TO DC-OPTION-CODE
 11986         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11987         MOVE DC-GREG-DATE-1-EDIT TO RECONSIDERED-DATE
 11988         MOVE RECONSIDERED-TEXT   TO DISPLAY-TEXT
 11989         MOVE TRAILER-DISPLAY-WORK-AREA
 11990                                 TO MAP-DISPLAY (DISPLAY-CNT)
 11991         GO TO 2800-INCR-DISPLAY-CNT.
 11992
 11993     MOVE AT-DENIAL-DT           TO DC-BIN-DATE-1.
 11994     MOVE ' '                    TO DC-OPTION-CODE.
 11995     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11996     MOVE DC-GREG-DATE-1-EDIT    TO DENIAL-DATE.
 11997
 11998     MOVE AT-DENIAL-REASON-CODE  TO DENIAL-CODE.
 11999     MOVE AT-DENIAL-INFO-1       TO DENIAL-MSG.
 12000     IF CL-DENIAL-TYPE NOT = SPACES AND LOW-VALUES
 12001        EVALUATE CL-DENIAL-TYPE
 12002           WHEN '1'
 12003              MOVE 'DENIAL STATUS - DENIAL       '
 12004                                 TO DENTYPO
 12005           WHEN '2'
 12006              MOVE 'DENIAL STATUS - RESCISSION   '
 12007                                 TO DENTYPO
 12008           WHEN '3'
 12009              MOVE 'DENIAL STATUS - REFORMATION  '
 12010                                 TO DENTYPO
 12011           WHEN '4'
 12012              MOVE 'DENIAL STATUS - REF TO RESC  '
 12013                                 TO DENTYPO
 12014           WHEN '5'
 12015              MOVE 'DENIAL STATUS - RECONSIDERED '
 12016                                 TO DENTYPO
 12017        END-EVALUATE
 12018        MOVE AL-SANOF            TO DENTYPA
 12019     END-IF
 12020     MOVE DENIAL-TEXT            TO DISPLAY-TEXT.
 12021     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 12022     GO TO 2800-INCR-DISPLAY-CNT.
 12023
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 226
* EL150.cbl
 12025 2700-INCURRED-CHANGE-TRAILER.
 12026     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 12027     MOVE 'INCUR DATE CHG'       TO DISPLAY-ACTION.
 12028     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 12029
 12030     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 12031     MOVE ' '                    TO DC-OPTION-CODE.
 12032     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12033     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 12034
 12035     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 12036
 12037     IF AT-OLD-INCURRED-DT NOT = LOW-VALUES
 12038        MOVE AT-OLD-INCURRED-DT  TO DC-BIN-DATE-1
 12039        MOVE ' '                 TO DC-OPTION-CODE
 12040        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12041        IF DATE-CONVERSION-ERROR
 12042           MOVE SPACES           TO INCUR-DT
 12043        ELSE
 12044           MOVE DC-GREG-DATE-1-EDIT  TO INCUR-DT
 12045     ELSE
 12046        MOVE SPACES              TO INCUR-DT.
 12047
 12048     IF PI-USES-PAID-TO
 12049        MOVE ' PD  TO ='         TO PDTHRU-HEAD.
 12050
 12051     IF AT-OLD-PAID-THRU-DT NOT = LOW-VALUES
 12052        MOVE AT-OLD-PAID-THRU-DT TO DC-BIN-DATE-1
 12053        MOVE ' '                 TO DC-OPTION-CODE
 12054        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12055        IF DATE-CONVERSION-ERROR
 12056           MOVE SPACES           TO INCUR-PDTHRU
 12057        ELSE
 12058           MOVE DC-GREG-DATE-1-EDIT  TO INCUR-PDTHRU
 12059           IF PI-USES-PAID-TO
 12060              MOVE AT-OLD-PAID-THRU-DT TO DC-BIN-DATE-1
 12061              MOVE '6'                 TO DC-OPTION-CODE
 12062              MOVE +1                  TO DC-ELAPSED-DAYS
 12063              MOVE +0                  TO DC-ELAPSED-MONTHS
 12064              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12065              IF NO-CONVERSION-ERROR
 12066                 MOVE DC-GREG-DATE-1-EDIT  TO INCUR-PDTHRU
 12067              ELSE
 12068                 NEXT SENTENCE
 12069           ELSE
 12070              NEXT SENTENCE
 12071     ELSE
 12072        MOVE SPACES              TO INCUR-PDTHRU.
 12073
 12074     MOVE AT-OLD-TOTAL-PAID      TO INCUR-PAID.
 12075     MOVE INCUR-TEXT             TO DISPLAY-TEXT.
 12076     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 12077     GO TO 2800-INCR-DISPLAY-CNT.
 12078
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 227
* EL150.cbl
 12080 2710-FORM-CONTROL-TRAILER.
 12081     MOVE SPACES                 TO TRAILER-DISPLAY-WORK-AREA.
 12082     MOVE 'FORM CTL'             TO DISP-ACT-A.
 12083     IF INITIAL-FORM
 12084        MOVE 'INIT'              TO DISP-ACT-B
 12085     ELSE
 12086        MOVE 'PROG'              TO DISP-ACT-B.
 12087
 12088     MOVE AT-RECORDED-BY         TO DISPLAY-BY.
 12089
 12090     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1.
 12091     MOVE ' '                    TO DC-OPTION-CODE.
 12092     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12093     MOVE DC-GREG-DATE-1-EDIT    TO DISPLAY-DATE.
 12094
 12095     MOVE TRLR-SEQ-NO            TO DISPLAY-SEQ.
 12096
 12097     IF AT-FORM-ADDRESS = 'I'
 12098         MOVE 1                  TO WS-SUB
 12099      ELSE
 12100     IF AT-FORM-ADDRESS = 'A'
 12101         MOVE 3                  TO WS-SUB
 12102      ELSE
 12103     IF AT-FORM-ADDRESS = 'O'
 12104         MOVE 6                  TO WS-SUB
 12105      ELSE
 12106     IF AT-FORM-ADDRESS = 'Q'
 12107         MOVE 7                  TO WS-SUB
 12108      ELSE
 12109         MOVE 0                  TO WS-SUB.
 12110
 12111     IF WS-SUB = 0
 12112         MOVE SPACES             TO  CORR-TO
 12113     ELSE
 12114         MOVE CORR-DESC (WS-SUB) TO  CORR-TO.
 12115
 12116     IF AT-FORM-ANSWERED-DT NOT = LOW-VALUES
 12117         MOVE AT-FORM-ANSWERED-DT TO DC-BIN-DATE-1
 12118         MOVE ' '                 TO DC-OPTION-CODE
 12119         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12120         MOVE DC-GREG-DATE-1-EDIT TO CORR-RECVD
 12121     ELSE
 12122         MOVE SPACES              TO CORR-RECVD.
 12123
 12124     IF AT-FORM-PRINTED-DT  = LOW-VALUES
 12125         MOVE '    SEND='         TO CORR-VAR
 12126         MOVE AT-FORM-SEND-ON-DT  TO DC-BIN-DATE-1
 12127         MOVE ' '                 TO DC-OPTION-CODE
 12128         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12129         MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
 12130     ELSE
 12131         MOVE '    SENT='        TO CORR-VAR
 12132         IF AT-FORM-REPRINT-DT  = LOW-VALUES
 12133            MOVE AT-FORM-PRINTED-DT TO DC-BIN-DATE-1
 12134            MOVE ' '                TO DC-OPTION-CODE
 12135            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12136            MOVE DC-GREG-DATE-1-EDIT TO CORR-RESENT
 12137         ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 228
* EL150.cbl
 12138            MOVE AT-FORM-REPRINT-DT TO DC-BIN-DATE-1
 12139            MOVE ' '                TO DC-OPTION-CODE
 12140            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12141            MOVE DC-GREG-DATE-1-EDIT    TO CORR-RESENT.
 12142
 12143     MOVE CORRESPONDENCE-TEXT       TO DISPLAY-TEXT.
 12144     MOVE TRAILER-DISPLAY-WORK-AREA TO MAP-DISPLAY (DISPLAY-CNT).
 12145
 12146     GO TO 2800-INCR-DISPLAY-CNT.
 12147
 12148 2800-INCR-DISPLAY-CNT.
 12149     IF LCP-ONCTR-01 =  0
 12150         ADD 1 TO LCP-ONCTR-01
 12151         MOVE 'Y'                TO PI-PREV-DISP
 12152         MOVE TRLR-SEQ-NO        TO PI-SAVE-LOW  PI-SAVE-HIGH.
 12153
 12154     IF DIRECTION-SWITCH = 'F'
 12155         MOVE TRLR-SEQ-NO        TO PI-SAVE-HIGH
 12156         ADD +1                  TO DISPLAY-CNT
 12157         IF DISPLAY-CNT > +4
 12158             GO TO 2999-EXIT
 12159         ELSE
 12160             NEXT SENTENCE
 12161     ELSE
 12162         MOVE TRLR-SEQ-NO        TO PI-SAVE-LOW
 12163         SUBTRACT +1 FROM DISPLAY-CNT
 12164         if map-display (1) (1:14) = 'SPECIAL REVIEW'
 12165           OR MAP-DISPLAY (1) (1:14) = 'VERIFY SSN    '
 12166           OR MAP-DISPLAY (1) (1:14) = 'CAUSAL STATE  '
 12167            IF MAP-DISPLAY (2) (1:14) = 'VERIFY SSN    '
 12168              OR MAP-DISPLAY (2) (1:14) = 'CAUSAL STATE  '
 12169                 IF MAP-DISPLAY (3) (1:14) = 'CAUSAL STATE  '
 12170                     IF DISPLAY-CNT < +4
 12171                        GO TO 2999-EXIT
 12172                     END-IF
 12173                 END-IF
 12174                 IF DISPLAY-CNT < +3
 12175                   GO TO 2999-EXIT
 12176                 END-IF
 12177            END-IF
 12178            IF DISPLAY-CNT < +2
 12179               GO TO 2999-EXIT
 12180            END-IF
 12181         ELSE
 12182            IF DISPLAY-CNT < +1
 12183               GO TO 2999-EXIT.
 12184
 12185     GO TO 2020-READ-TRAILER-LOOP.
 12186
 12187 2950-NO-MORE-TRAILERS.
 12188     MOVE ER-0303                TO EMI-ERROR.
 12189     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12190
 12191 2999-EXIT.
 12192     EXIT.
 12193
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 229
* EL150.cbl
 12195 3997-GET-ERPDEF.
 12196
 12197     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 12198     MOVE CM-STATE               TO ERPDEF-STATE
 12199     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 12200     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 12201     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
 12202     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 12203     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 12204
 12205
 12206* EXEC CICS STARTBR
 12207*        DATASET  ('ERPDEF')
 12208*        RIDFLD   (ERPDEF-KEY)
 12209*        GTEQ
 12210*        RESP     (WS-RESPONSE)
 12211*    END-EXEC
 12212     MOVE 'ERPDEF' TO DFHEIV1
 12213     MOVE 0
 12214       TO DFHEIV11
 12215*    MOVE '&,         G          &  N#00011284' TO DFHEIV0
 12216     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12217     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12218     MOVE X'204E233030303131323834' TO DFHEIV0(25:11)
 12219     CALL 'kxdfhei1' USING DFHEIV0,
 12220           DFHEIV1,
 12221           ERPDEF-KEY,
 12222           DFHEIV99,
 12223           DFHEIV11,
 12224           DFHEIV99
 12225     MOVE EIBRESP  TO WS-RESPONSE
 12226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12227
 12228     IF NOT WS-RESP-NORMAL
 12229        GO TO 3997-EXIT
 12230     END-IF
 12231
 12232     IF WS-RESP-NORMAL
 12233
 12234* EXEC CICS READNEXT
 12235*          DATASET  ('ERPDEF')
 12236*          INTO     (PRODUCT-MASTER)
 12237*          RIDFLD   (ERPDEF-KEY)
 12238*          RESP     (WS-RESPONSE)
 12239*       END-EXEC
 12240     MOVE LENGTH OF
 12241      PRODUCT-MASTER
 12242       TO DFHEIV12
 12243     MOVE 'ERPDEF' TO DFHEIV1
 12244     MOVE 0
 12245       TO DFHEIV11
 12246*    MOVE '&.IL                  )  N#00011296' TO DFHEIV0
 12247     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12248     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12249     MOVE X'204E233030303131323936' TO DFHEIV0(25:11)
 12250     CALL 'kxdfhei1' USING DFHEIV0,
 12251           DFHEIV1,
 12252           PRODUCT-MASTER,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 230
* EL150.cbl
 12253           DFHEIV12,
 12254           ERPDEF-KEY,
 12255           DFHEIV99,
 12256           DFHEIV11,
 12257           DFHEIV99,
 12258           DFHEIV99
 12259     MOVE EIBRESP  TO WS-RESPONSE
 12260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12261        IF WS-RESP-NORMAL
 12262           IF (ERPDEF-KEY-SAVE (1:16) =
 12263              PD-CONTROL-PRIMARY (1:16))
 12264              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 12265              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 12266                 (A1 > +8)
 12267                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 12268              END-PERFORM
 12269              IF A1 < +9
 12270                 SET PDEF-FOUND TO TRUE
 12271              end-if
 12272           END-IF
 12273        END-IF
 12274     END-IF
 12275
 12276     .
 12277 3997-ENDBR.
 12278
 12279
 12280* EXEC CICS ENDBR
 12281*       DATASET  ('ERPDEF')
 12282*    END-EXEC
 12283     MOVE 'ERPDEF' TO DFHEIV1
 12284     MOVE 0
 12285       TO DFHEIV11
 12286*    MOVE '&2                    $   #00011320' TO DFHEIV0
 12287     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12288     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12289     MOVE X'2020233030303131333230' TO DFHEIV0(25:11)
 12290     CALL 'kxdfhei1' USING DFHEIV0,
 12291           DFHEIV1,
 12292           DFHEIV11,
 12293           DFHEIV99
 12294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12295
 12296     .
 12297 3997-EXIT.
 12298     EXIT.
 12299 6000-CHECK-AUTO-ACTIVITY.
 12300******************************************************************
 12301*    READ THE CONTROL FILE TO VERIFY THAT AN AUTOMATIC           *
 12302*    ACTIVITY RECORD EXISTS.                                     *
 12303******************************************************************
 12304
 12305
 12306* EXEC CICS HANDLE CONDITION
 12307*        NOTFND   (6000-NOT-FOUND)
 12308*    END-EXEC.
 12309*    MOVE '"$I                   ! 4 #00011333' TO DFHEIV0
 12310     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 231
* EL150.cbl
 12311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12312     MOVE X'3420233030303131333333' TO DFHEIV0(25:11)
 12313     CALL 'kxdfhei1' USING DFHEIV0
 12314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12315
 12316
 12317     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
 12318     MOVE 'T'                    TO  CNTL-REC-TYPE
 12319     MOVE SPACES                 TO  CNTL-ACCESS
 12320     MOVE +0                     TO  CNTL-SEQ-NO
 12321     MOVE 'CNTL'                 TO  FILE-SWITCH.
 12322
 12323
 12324* EXEC CICS READ
 12325*        DATASET   ('ELCNTL')
 12326*        RIDFLD    (ELCNTL-KEY)
 12327*        SET       (ADDRESS OF CONTROL-FILE)
 12328*    END-EXEC.
 12329     MOVE 'ELCNTL' TO DFHEIV1
 12330*    MOVE '&"S        E          (   #00011343' TO DFHEIV0
 12331     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12332     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12333     MOVE X'2020233030303131333433' TO DFHEIV0(25:11)
 12334     CALL 'kxdfhei1' USING DFHEIV0,
 12335           DFHEIV1,
 12336           DFHEIV20,
 12337           DFHEIV99,
 12338           ELCNTL-KEY,
 12339           DFHEIV99,
 12340           DFHEIV99,
 12341           DFHEIV99
 12342     SET ADDRESS OF CONTROL-FILE TO
 12343         DFHEIV20
 12344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12345
 12346
 12347     MOVE 'Y'                    TO  WS-ACT-REC-FOUND-SW.
 12348     GO TO 6000-EXIT.
 12349
 12350 6000-NOT-FOUND.
 12351     MOVE 'N'                    TO  WS-ACT-REC-FOUND-SW.
 12352     MOVE AL-UABON               TO  ACTCDA.
 12353     MOVE -1                     TO  ACTCDL.
 12354     MOVE ER-3516                TO  EMI-ERROR
 12355     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12356
 12357 6000-EXIT.
 12358     EXIT.
 12359
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 232
* EL150.cbl
 12361 6050-AUTO-LETTER-WRITER.
 12362******************************************************************
 12363*    THE FOLLOWING ACTIVITIES WILL BE PERFORMED BASED ON THE     *
 12364*    CODES ENTERED IN THE AUTOMATIC ACTIVITY RECORD.             *
 12365*       1.  IF SPECIFIED, THE AUTOMATIC LETTER WRITER PROGRAM    *
 12366*           WILL BE LINKED TO AND A LETTER WILL BE GENERATED.    *
 12367*           A.  ANY RESEND OR FOLLOW UP DATES SPECIFIED IN THE   *
 12368*               ACTIVITY RECORD WILL BE STORED IN THE LETTER     *
 12369******************************************************************
 12370
 12371     IF WS-ACTIVITY-CODE = ZERO
 12372         GO TO 6050-EXIT.
 12373
 12374     MOVE WS-ACTIVITY-CODE       TO  SUB.
 12375     SUBTRACT 9 FROM SUB.
 12376
 12377 6050-EDIT-USER-ACTIVITY-LOOP.
 12378
 12379     IF (CF-USER-ACTIVE-SW (SUB) = ' ' OR 'N') OR
 12380        (CF-USER-LETTER-ID (SUB) = SPACES OR LOW-VALUES)
 12381             GO TO 6050-EXIT.
 12382
 12383 6050-START-AUTO-LETTER-WRITER.
 12384
 12385     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 12386     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 12387
 12388     MOVE CF-USER-LETTER-ID (SUB)    TO W-1523-FORM-NUMBER.
 12389
 12390     IF CF-USER-RESEND-DAYS (SUB) NOT = ZEROS
 12391         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 12392         MOVE '6'                    TO  DC-OPTION-CODE
 12393         MOVE CF-USER-RESEND-DAYS (SUB)  TO  DC-ELAPSED-DAYS
 12394         MOVE +0                     TO  DC-ELAPSED-MONTHS
 12395         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12396         IF NO-CONVERSION-ERROR
 12397             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 12398         ELSE
 12399             MOVE LOW-VALUES         TO  W-1523-RESEND-DATE.
 12400
 12401     IF CF-USER-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 12402         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 12403         MOVE '6'                    TO  DC-OPTION-CODE
 12404         MOVE CF-USER-FOLLOW-UP-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 12405         MOVE +0                     TO  DC-ELAPSED-MONTHS
 12406         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12407         IF NO-CONVERSION-ERROR
 12408             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 12409         ELSE
 12410             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
 12411
 12412******************************************************************
 12413*    LINK TO THE AUTOMATIC LETTER WRITER PROGRAM.                *
 12414******************************************************************
 12415
 12416
 12417* EXEC CICS LINK
 12418*        PROGRAM    (LINK-1523)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 233
* EL150.cbl
 12419*        COMMAREA   (W-1523-LINKDATA)
 12420*        LENGTH     (W-1523-COMM-LENGTH)
 12421*    END-EXEC.
 12422*    MOVE '."C                   (   #00011418' TO DFHEIV0
 12423     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12424     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12425     MOVE X'2020233030303131343138' TO DFHEIV0(25:11)
 12426     CALL 'kxdfhei1' USING DFHEIV0,
 12427           LINK-1523,
 12428           W-1523-LINKDATA,
 12429           W-1523-COMM-LENGTH,
 12430           DFHEIV99,
 12431           DFHEIV99,
 12432           DFHEIV99,
 12433           DFHEIV99
 12434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12435
 12436
 12437******************************************************************
 12438*    CHECK THE ERROR CODES FROM THE AUTOMATIC LETTER WRITER      *
 12439*    PROGRAM.                                                    *
 12440*        1.  IF FATAL ERRORS ARE DETECTED BY THE AUTO LETTER     *
 12441*            WRITER PROGRAM, THE LETTER IS NOT CREATED AND AN    *
 12442*            ERROR MESSAGE (#0802) IS DISPLAYED INDICATING THAT  *
 12443*            THE LETTER WAS NOT CREATED.                         *
 12444*        2.  IF THE AUTO LETTER WRITER PROGRAM IS UNABLE TO      *
 12445*            RESOLVE A VARIABLE, THE LETTER IS CREATED AND AN    *
 12446*            ERROR MESSAGE (#0803) INDICATING THAT THE LETTER    *
 12447*            WAS CREATED WITH ERRORS IS DISPLAYED.               *
 12448******************************************************************
 12449
 12450     IF W-1523-ERROR-CODE = ZEROS
 12451         GO TO 6050-EXIT.
 12452
 12453     IF W-1523-FATAL-ERROR
 12454         MOVE ER-0802                TO  EMI-ERROR
 12455         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12456
 12457     IF W-1523-ERROR-CODE = 0191
 12458         MOVE ER-0803                TO  EMI-ERROR
 12459         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12460
 12461 6050-EXIT.
 12462     EXIT.
 12463
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 234
* EL150.cbl
 12465 6100-RESET-AUTO-ACTIVITY.
 12466******************************************************************
 12467*    RESET ALL LETTER ACTIVITY AWAITING FURTHER ACTION (RESEND,  *
 12468*    FOLLOW-UP, ETC) IF THE AUTOMATIC ACTIVITY CODE IS SET       *
 12469*    TO ZEROS.                                                   *
 12470******************************************************************
 12471
 12472     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 12473     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 12474     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 12475     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 12476     MOVE +100                   TO  TRLR-SEQ-NO.
 12477     MOVE 'TRLR'                 TO  FILE-SWITCH.
 12478
 12479 6100-STARTBR-TRLR.
 12480
 12481
 12482* EXEC CICS HANDLE CONDITION
 12483*        ENDFILE  (6100-END-RESET)
 12484*        NOTFND   (6100-END-RESET)
 12485*    END-EXEC.
 12486*    MOVE '"$''I                  ! 5 #00011468' TO DFHEIV0
 12487     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 12488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12489     MOVE X'3520233030303131343638' TO DFHEIV0(25:11)
 12490     CALL 'kxdfhei1' USING DFHEIV0
 12491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12492
 12493
 12494
 12495* EXEC CICS STARTBR
 12496*        DATASET   ('ELTRLR')
 12497*        RIDFLD    (ELTRLR-KEY)
 12498*        GTEQ
 12499*    END-EXEC.
 12500     MOVE 'ELTRLR' TO DFHEIV1
 12501     MOVE 0
 12502       TO DFHEIV11
 12503*    MOVE '&,         G          &   #00011473' TO DFHEIV0
 12504     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12505     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12506     MOVE X'2020233030303131343733' TO DFHEIV0(25:11)
 12507     CALL 'kxdfhei1' USING DFHEIV0,
 12508           DFHEIV1,
 12509           ELTRLR-KEY,
 12510           DFHEIV99,
 12511           DFHEIV11,
 12512           DFHEIV99
 12513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12514
 12515
 12516     MOVE 'Y'                        TO  WS-BROWSE-SW.
 12517
 12518 6100-READ-NEXT.
 12519
 12520
 12521* EXEC CICS READNEXT
 12522*        DATASET   ('ELTRLR')
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 235
* EL150.cbl
 12523*        RIDFLD    (ELTRLR-KEY)
 12524*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12525*    END-EXEC.
 12526     MOVE 'ELTRLR' TO DFHEIV1
 12527     MOVE 0
 12528       TO DFHEIV11
 12529*    MOVE '&.S                   )   #00011483' TO DFHEIV0
 12530     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12531     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12532     MOVE X'2020233030303131343833' TO DFHEIV0(25:11)
 12533     CALL 'kxdfhei1' USING DFHEIV0,
 12534           DFHEIV1,
 12535           DFHEIV20,
 12536           DFHEIV99,
 12537           ELTRLR-KEY,
 12538           DFHEIV99,
 12539           DFHEIV11,
 12540           DFHEIV99,
 12541           DFHEIV99
 12542     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12543         DFHEIV20
 12544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12545
 12546
 12547     IF (PI-COMPANY-CD NOT = TRLR-COMP-CD)   OR
 12548        (PI-CARRIER    NOT = TRLR-CARRIER)   OR
 12549        (PI-CLAIM-NO   NOT = TRLR-CLAIM-NO)  OR
 12550        (PI-CERT-NO    NOT = TRLR-CERT-NO)
 12551         GO TO 6100-END-RESET.
 12552
 12553     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 12554         GO TO 6100-READ-NEXT.
 12555
 12556     IF AT-TRAILER-TYPE NOT = '4'
 12557         GO TO 6100-READ-NEXT.
 12558
 12559     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 12560         GO TO 6100-READ-NEXT.
 12561
 12562     IF (AT-AUTO-RE-SEND-DT = LOW-VALUES OR SPACES)
 12563       AND
 12564        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 12565         GO TO 6100-READ-NEXT.
 12566
 12567     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 12568        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 12569        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 12570         GO TO 6100-READ-NEXT.
 12571
 12572     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 12573       AND
 12574        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 12575       AND
 12576        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 12577         GO TO 6100-READ-NEXT.
 12578
 12579 6100-END-BROWSE.
 12580
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 236
* EL150.cbl
 12581     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 12582
 12583
 12584* EXEC CICS ENDBR
 12585*        DATASET   ('ELTRLR')
 12586*    END-EXEC.
 12587     MOVE 'ELTRLR' TO DFHEIV1
 12588     MOVE 0
 12589       TO DFHEIV11
 12590*    MOVE '&2                    $   #00011525' TO DFHEIV0
 12591     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12592     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12593     MOVE X'2020233030303131353235' TO DFHEIV0(25:11)
 12594     CALL 'kxdfhei1' USING DFHEIV0,
 12595           DFHEIV1,
 12596           DFHEIV11,
 12597           DFHEIV99
 12598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12599
 12600
 12601     MOVE 'N'                        TO  WS-BROWSE-SW.
 12602
 12603 6100-READ-TRLR-UPDATE.
 12604
 12605
 12606* EXEC CICS READ
 12607*        DATASET   ('ELTRLR')
 12608*        RIDFLD    (ELTRLR-KEY)
 12609*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12610*        UPDATE
 12611*    END-EXEC.
 12612     MOVE 'ELTRLR' TO DFHEIV1
 12613*    MOVE '&"S        EU         (   #00011533' TO DFHEIV0
 12614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12615     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12616     MOVE X'2020233030303131353333' TO DFHEIV0(25:11)
 12617     CALL 'kxdfhei1' USING DFHEIV0,
 12618           DFHEIV1,
 12619           DFHEIV20,
 12620           DFHEIV99,
 12621           ELTRLR-KEY,
 12622           DFHEIV99,
 12623           DFHEIV99,
 12624           DFHEIV99
 12625     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12626         DFHEIV20
 12627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12628
 12629
 12630     MOVE 'Y'                        TO  WS-UPDATE-SW.
 12631
 12632     IF AT-AUTO-RE-SEND-DT IS NOT < SAVE-BIN-DATE
 12633         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 12634         MOVE PI-COMPANY-CD          TO  ARCH-COMP-CD
 12635         MOVE AT-LETTER-ARCHIVE-NO   TO  ARCH-ARCHIVE-NO
 12636         MOVE '1'                    TO  ARCH-RECORD-TYPE
 12637         MOVE +0                     TO  ARCH-SEQ-NO
 12638         PERFORM 6200-READ-ARCH-UPDATE THRU 6200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 237
* EL150.cbl
 12639
 12640     IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 12641         MOVE LOW-VALUES             TO  AT-RECEIPT-FOLLOW-UP.
 12642
 12643 6100-REWRITE-TRLR.
 12644
 12645
 12646* EXEC CICS REWRITE
 12647*        DATASET   ('ELTRLR')
 12648*        FROM      (ACTIVITY-TRAILERS)
 12649*    END-EXEC.
 12650     MOVE LENGTH OF
 12651      ACTIVITY-TRAILERS
 12652       TO DFHEIV11
 12653     MOVE 'ELTRLR' TO DFHEIV1
 12654*    MOVE '&& L                  %   #00011555' TO DFHEIV0
 12655     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12656     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12657     MOVE X'2020233030303131353535' TO DFHEIV0(25:11)
 12658     CALL 'kxdfhei1' USING DFHEIV0,
 12659           DFHEIV1,
 12660           ACTIVITY-TRAILERS,
 12661           DFHEIV11,
 12662           DFHEIV99
 12663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12664
 12665
 12666     GO TO 6100-STARTBR-TRLR.
 12667
 12668 6100-END-RESET.
 12669
 12670     IF WS-BROWSE-SW = 'Y'
 12671         MOVE 'N'                    TO  WS-BROWSE-SW
 12672
 12673* EXEC CICS ENDBR
 12674*            DATASET   ('ELTRLR')
 12675*        END-EXEC.
 12676     MOVE 'ELTRLR' TO DFHEIV1
 12677     MOVE 0
 12678       TO DFHEIV11
 12679*    MOVE '&2                    $   #00011566' TO DFHEIV0
 12680     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12681     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12682     MOVE X'2020233030303131353636' TO DFHEIV0(25:11)
 12683     CALL 'kxdfhei1' USING DFHEIV0,
 12684           DFHEIV1,
 12685           DFHEIV11,
 12686           DFHEIV99
 12687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12688
 12689
 12690 6100-EXIT.
 12691     EXIT.
 12692
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 238
* EL150.cbl
 12694 6150-READ-TRLR92.
 12695
 12696     MOVE PI-COMPANY-CD          TO  WS-TRLR-COMP-CD.
 12697     MOVE PI-CARRIER             TO  WS-TRLR-CARRIER.
 12698     MOVE PI-CLAIM-NO            TO  WS-TRLR-CLAIM-NO.
 12699     MOVE PI-CERT-NO             TO  WS-TRLR-CERT-NO.
 12700     MOVE +092                   TO  WS-TRLR-SEQ-NO.
 12701     MOVE 'TRLR'                 TO  FILE-SWITCH.
 12702
 12703
 12704* EXEC CICS READ
 12705*        DATASET   ('ELTRLR')
 12706*        RIDFLD    (WS-ELTRLR-KEY)
 12707*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12708*        RESP      (WS-RESPONSE)
 12709*    END-EXEC.
 12710     MOVE 'ELTRLR' TO DFHEIV1
 12711*    MOVE '&"S        E          (  N#00011583' TO DFHEIV0
 12712     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12713     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12714     MOVE X'204E233030303131353833' TO DFHEIV0(25:11)
 12715     CALL 'kxdfhei1' USING DFHEIV0,
 12716           DFHEIV1,
 12717           DFHEIV20,
 12718           DFHEIV99,
 12719           WS-ELTRLR-KEY,
 12720           DFHEIV99,
 12721           DFHEIV99,
 12722           DFHEIV99
 12723     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12724         DFHEIV20
 12725     MOVE EIBRESP  TO WS-RESPONSE
 12726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12727
 12728
 12729     .
 12730 6150-EXIT.
 12731     EXIT.
 12732
 12733 6160-READ-TRLR93.
 12734
 12735     MOVE PI-COMPANY-CD          TO  WS-TRLR-COMP-CD.
 12736     MOVE PI-CARRIER             TO  WS-TRLR-CARRIER.
 12737     MOVE PI-CLAIM-NO            TO  WS-TRLR-CLAIM-NO.
 12738     MOVE PI-CERT-NO             TO  WS-TRLR-CERT-NO.
 12739     MOVE +093                   TO  WS-TRLR-SEQ-NO.
 12740     MOVE 'TRLR'                 TO  FILE-SWITCH.
 12741
 12742
 12743* EXEC CICS READ
 12744*        DATASET   ('ELTRLR')
 12745*        RIDFLD    (WS-ELTRLR-KEY)
 12746*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12747*        RESP      (WS-RESPONSE)
 12748*    END-EXEC.
 12749     MOVE 'ELTRLR' TO DFHEIV1
 12750*    MOVE '&"S        E          (  N#00011603' TO DFHEIV0
 12751     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 239
* EL150.cbl
 12752     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12753     MOVE X'204E233030303131363033' TO DFHEIV0(25:11)
 12754     CALL 'kxdfhei1' USING DFHEIV0,
 12755           DFHEIV1,
 12756           DFHEIV20,
 12757           DFHEIV99,
 12758           WS-ELTRLR-KEY,
 12759           DFHEIV99,
 12760           DFHEIV99,
 12761           DFHEIV99
 12762     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12763         DFHEIV20
 12764     MOVE EIBRESP  TO WS-RESPONSE
 12765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12766
 12767
 12768     .
 12769 6160-EXIT.
 12770     EXIT.
 12771
 12772 6170-READ-TRLR94.
 12773
 12774     MOVE PI-COMPANY-CD          TO  WS-TRLR-COMP-CD.
 12775     MOVE PI-CARRIER             TO  WS-TRLR-CARRIER.
 12776     MOVE PI-CLAIM-NO            TO  WS-TRLR-CLAIM-NO.
 12777     MOVE PI-CERT-NO             TO  WS-TRLR-CERT-NO.
 12778     MOVE +094                   TO  WS-TRLR-SEQ-NO.
 12779     MOVE 'TRLR'                 TO  FILE-SWITCH.
 12780
 12781
 12782* EXEC CICS READ
 12783*        DATASET   ('ELTRLR')
 12784*        RIDFLD    (WS-ELTRLR-KEY)
 12785*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12786*        RESP      (WS-RESPONSE)
 12787*    END-EXEC.
 12788     MOVE 'ELTRLR' TO DFHEIV1
 12789*    MOVE '&"S        E          (  N#00011623' TO DFHEIV0
 12790     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12791     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12792     MOVE X'204E233030303131363233' TO DFHEIV0(25:11)
 12793     CALL 'kxdfhei1' USING DFHEIV0,
 12794           DFHEIV1,
 12795           DFHEIV20,
 12796           DFHEIV99,
 12797           WS-ELTRLR-KEY,
 12798           DFHEIV99,
 12799           DFHEIV99,
 12800           DFHEIV99
 12801     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12802         DFHEIV20
 12803     MOVE EIBRESP  TO WS-RESPONSE
 12804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12805
 12806
 12807     .
 12808 6170-EXIT.
 12809     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 240
* EL150.cbl
 12810
 12811 6180-READ-TRLR95.
 12812
 12813     MOVE PI-COMPANY-CD          TO  WS-TRLR-COMP-CD.
 12814     MOVE PI-CARRIER             TO  WS-TRLR-CARRIER.
 12815     MOVE PI-CLAIM-NO            TO  WS-TRLR-CLAIM-NO.
 12816     MOVE PI-CERT-NO             TO  WS-TRLR-CERT-NO.
 12817     MOVE +095                   TO  WS-TRLR-SEQ-NO.
 12818     MOVE 'TRLR'                 TO  FILE-SWITCH.
 12819
 12820
 12821* EXEC CICS READ
 12822*        DATASET   ('ELTRLR')
 12823*        RIDFLD    (WS-ELTRLR-KEY)
 12824*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 12825*        RESP      (WS-RESPONSE)
 12826*    END-EXEC.
 12827     MOVE 'ELTRLR' TO DFHEIV1
 12828*    MOVE '&"S        E          (  N#00011643' TO DFHEIV0
 12829     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12830     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12831     MOVE X'204E233030303131363433' TO DFHEIV0(25:11)
 12832     CALL 'kxdfhei1' USING DFHEIV0,
 12833           DFHEIV1,
 12834           DFHEIV20,
 12835           DFHEIV99,
 12836           WS-ELTRLR-KEY,
 12837           DFHEIV99,
 12838           DFHEIV99,
 12839           DFHEIV99
 12840     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12841         DFHEIV20
 12842     MOVE EIBRESP  TO WS-RESPONSE
 12843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12844
 12845
 12846     .
 12847 6180-EXIT.
 12848     EXIT.
 12849
 12850 6200-READ-ARCH-UPDATE.
 12851******************************************************************
 12852*  READ AND UPDATE THE RESEND DATE ON THE LETTER ARCHIVE RECORD  *
 12853******************************************************************
 12854
 12855
 12856* EXEC CICS HANDLE CONDITION
 12857*        NOTFND   (6200-EXIT)
 12858*    END-EXEC.
 12859*    MOVE '"$I                   ! 6 #00011659' TO DFHEIV0
 12860     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12861     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12862     MOVE X'3620233030303131363539' TO DFHEIV0(25:11)
 12863     CALL 'kxdfhei1' USING DFHEIV0
 12864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12865
 12866
 12867
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 241
* EL150.cbl
 12868* EXEC CICS READ
 12869*        DATASET   ('ELARCH')
 12870*        RIDFLD    (ELARCH-KEY)
 12871*        SET       (ADDRESS OF LETTER-ARCHIVE)
 12872*        UPDATE
 12873*    END-EXEC.
 12874     MOVE 'ELARCH' TO DFHEIV1
 12875*    MOVE '&"S        EU         (   #00011663' TO DFHEIV0
 12876     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12877     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12878     MOVE X'2020233030303131363633' TO DFHEIV0(25:11)
 12879     CALL 'kxdfhei1' USING DFHEIV0,
 12880           DFHEIV1,
 12881           DFHEIV20,
 12882           DFHEIV99,
 12883           ELARCH-KEY,
 12884           DFHEIV99,
 12885           DFHEIV99,
 12886           DFHEIV99
 12887     SET ADDRESS OF LETTER-ARCHIVE TO
 12888         DFHEIV20
 12889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12890
 12891
 12892     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 12893
 12894 6200-REWRITE-ARCH.
 12895
 12896* EXEC CICS REWRITE
 12897*        DATASET   ('ELARCH')
 12898*        FROM      (LETTER-ARCHIVE)
 12899*    END-EXEC.
 12900     MOVE LENGTH OF
 12901      LETTER-ARCHIVE
 12902       TO DFHEIV11
 12903     MOVE 'ELARCH' TO DFHEIV1
 12904*    MOVE '&& L                  %   #00011673' TO DFHEIV0
 12905     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12906     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12907     MOVE X'2020233030303131363733' TO DFHEIV0(25:11)
 12908     CALL 'kxdfhei1' USING DFHEIV0,
 12909           DFHEIV1,
 12910           LETTER-ARCHIVE,
 12911           DFHEIV11,
 12912           DFHEIV99
 12913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12914
 12915
 12916 6200-EXIT.
 12917     EXIT.
 12918
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 242
* EL150.cbl
 12920 7000-START-BROWSE.
 12921
 12922     IF PI-COMPANY-ID = 'DMD'
 12923             AND
 12924        PI-ASS-PROCESSING
 12925         GO TO 7200-BROWSING-ASS-FWRD.
 12926
 12927     MOVE LOW-VALUES             TO  ELMSTR-KEY.
 12928     MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
 12929
 12930     IF CLMNOL > 0
 12931         MOVE CLMNOI             TO  MSTR-CLAIM-NO.
 12932     IF CARRL > 0
 12933         MOVE CARRI              TO  MSTR-CARRIER.
 12934     IF CERTNOL > 0
 12935         MOVE CERTNOI            TO  MSTR-CERT-NO-PRIME.
 12936     IF SUFXL > 0
 12937         MOVE SUFXI              TO  MSTR-CERT-NO-SUFX.
 12938
 12939     IF PI-PREV-CLAIM = LOW-VALUES
 12940         NEXT SENTENCE
 12941     ELSE
 12942         IF CLMNOL  = 0 AND
 12943            CARRL   = 0 AND
 12944            CERTNOL = 0 AND
 12945            SUFXL   = 0
 12946                 MOVE PI-PREV-CLAIM  TO  ELMSTR-KEY.
 12947
 12948 7000-START-READING.
 12949
 12950
 12951* EXEC CICS HANDLE CONDITION
 12952*        ENDFILE  (8700-END-FILE)
 12953*        NOTFND   (8600-NOT-FOUND)
 12954*    END-EXEC.
 12955*    MOVE '"$''I                  ! 7 #00011712' TO DFHEIV0
 12956     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 12957     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12958     MOVE X'3720233030303131373132' TO DFHEIV0(25:11)
 12959     CALL 'kxdfhei1' USING DFHEIV0
 12960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12961
 12962
 12963     IF YESNOSWL > 0
 12964         MOVE YESNOSWI TO CL-YESNOSW
 12965     END-IF.
 12966
 12967     MOVE 'MSTR'                 TO FILE-SWITCH.
 12968
 12969
 12970* EXEC CICS STARTBR
 12971*        DATASET   (PI-CURRENT-FILE)
 12972*        RIDFLD    (ELMSTR-KEY)
 12973*    END-EXEC.
 12974     MOVE 0
 12975       TO DFHEIV11
 12976*    MOVE '&,         G          &   #00011723' TO DFHEIV0
 12977     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 243
* EL150.cbl
 12978     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12979     MOVE X'2020233030303131373233' TO DFHEIV0(25:11)
 12980     CALL 'kxdfhei1' USING DFHEIV0,
 12981           PI-CURRENT-FILE,
 12982           ELMSTR-KEY,
 12983           DFHEIV99,
 12984           DFHEIV11,
 12985           DFHEIV99
 12986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12987
 12988
 12989 7000-READ-NEXT.
 12990
 12991
 12992* EXEC CICS READNEXT
 12993*        DATASET   (PI-CURRENT-FILE)
 12994*        RIDFLD    (ELMSTR-KEY)
 12995*        INTO      (CLAIM-MASTER)
 12996*    END-EXEC.
 12997     MOVE LENGTH OF
 12998      CLAIM-MASTER
 12999       TO DFHEIV12
 13000     MOVE 0
 13001       TO DFHEIV11
 13002*    MOVE '&.IL                  )   #00011730' TO DFHEIV0
 13003     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13004     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13005     MOVE X'2020233030303131373330' TO DFHEIV0(25:11)
 13006     CALL 'kxdfhei1' USING DFHEIV0,
 13007           PI-CURRENT-FILE,
 13008           CLAIM-MASTER,
 13009           DFHEIV12,
 13010           ELMSTR-KEY,
 13011           DFHEIV99,
 13012           DFHEIV11,
 13013           DFHEIV99,
 13014           DFHEIV99
 13015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13016
 13017
 13018     IF ELMSTR-KEY = PI-PREV-CLAIM
 13019         MOVE CL-CLAIM-NO        TO  PI-PREV-CLMNO
 13020         GO TO 7000-READ-NEXT.
 13021
 13022     IF PI-COMPANY-CD NOT = CL-COMPANY-CD
 13023         GO TO 8700-END-FILE.
 13024
 13025 7000-PICK-UP-LOGIC.
 13026
 13027     IF PI-COMPANY-ID  =  'CRI'
 13028         IF CL-CLAIM-NO NOT = PI-PREV-CLMNO
 13029             GO TO 8700-END-FILE.
 13030
 13031     IF PI-CARRIER-SECURITY > SPACES
 13032         IF CL-CARRIER = PI-CARRIER-SECURITY
 13033             NEXT SENTENCE
 13034         ELSE
 13035             GO TO 7000-READ-NEXT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 244
* EL150.cbl
 13036
 13037     IF PI-ACCOUNT-SECURITY > SPACES
 13038         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
 13039             NEXT SENTENCE
 13040         ELSE
 13041             GO TO 7000-READ-NEXT.
 13042
 13043     GO TO 1000-READ-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 245
* EL150.cbl
 13045 7200-BROWSING-ASS-FWRD.
 13046
 13047     COMPUTE PI-ASS-NDX = PI-ASS-NDX + 1.
 13048
 13049     IF PI-ASS-NDX > +24
 13050             OR
 13051        PI-ASS-CERTS (PI-ASS-NDX) NOT > LOW-VALUE
 13052         IF PI-PF15-LAST
 13053             MOVE PI-ORIGINAL-ASS-CERT
 13054                                 TO ELMSTR-KEY
 13055             MOVE ZEROS          TO PI-DAYS-PAID
 13056                                    PI-TOTAL-PAID
 13057             MOVE LOW-VALUES     TO PI-ASSOCIATED-CERTS-TABLE
 13058                                    PI-LAST-PF-KEY-IND
 13059                                    PI-ASSOCIATED-PROCESS-IND
 13060             GO TO 7000-START-READING
 13061         ELSE
 13062             COMPUTE PI-ASS-NDX = PI-ASS-NDX - 1
 13063             MOVE 'F'            TO PI-LAST-PF-KEY-IND
 13064             MOVE -1             TO ENTERPFL
 13065             MOVE ER-0936        TO EMI-ERROR
 13066             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13067             GO TO 8200-SEND-DATAONLY.
 13068
 13069     MOVE PI-PREV-CLAIM          TO ELMSTR-KEY.
 13070     MOVE PI-ASS-CERTS (PI-ASS-NDX)
 13071                                 TO MSTR-CERT-NO.
 13072     MOVE 'MSTR'                 TO FILE-SWITCH.
 13073
 13074
 13075* EXEC CICS HANDLE CONDITION
 13076*        NOTFND   (0450-NOT-FOUND)
 13077*    END-EXEC.
 13078*    MOVE '"$I                   ! 8 #00011792' TO DFHEIV0
 13079     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13081     MOVE X'3820233030303131373932' TO DFHEIV0(25:11)
 13082     CALL 'kxdfhei1' USING DFHEIV0
 13083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13084
 13085
 13086
 13087* EXEC CICS READ
 13088*        DATASET   (PI-CURRENT-FILE)
 13089*        RIDFLD    (ELMSTR-KEY)
 13090*        INTO      (CLAIM-MASTER)
 13091*    END-EXEC.
 13092     MOVE LENGTH OF
 13093      CLAIM-MASTER
 13094       TO DFHEIV11
 13095*    MOVE '&"IL       E          (   #00011796' TO DFHEIV0
 13096     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13097     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13098     MOVE X'2020233030303131373936' TO DFHEIV0(25:11)
 13099     CALL 'kxdfhei1' USING DFHEIV0,
 13100           PI-CURRENT-FILE,
 13101           CLAIM-MASTER,
 13102           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 246
* EL150.cbl
 13103           ELMSTR-KEY,
 13104           DFHEIV99,
 13105           DFHEIV99,
 13106           DFHEIV99
 13107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13108
 13109
 13110     GO TO 7000-PICK-UP-LOGIC.
 13111
 13112 7200-EXIT.
 13113     EXIT.
 13114
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 247
* EL150.cbl
 13116 7500-START-BROWSE.
 13117
 13118     IF PI-COMPANY-ID = 'DMD'
 13119             AND
 13120        PI-ASS-PROCESSING
 13121         GO TO 7600-BROWSING-ASS-BWRD.
 13122
 13123     MOVE LOW-VALUES             TO  ELMSTR-KEY.
 13124     MOVE PI-COMPANY-CD          TO  MSTR-COMP-CD.
 13125
 13126     IF CLMNOL > 0
 13127         MOVE CLMNOI             TO  MSTR-CLAIM-NO.
 13128     IF CARRL > 0
 13129         MOVE CARRI              TO  MSTR-CARRIER.
 13130     IF CERTNOL > 0
 13131         MOVE CERTNOI            TO  MSTR-CERT-NO-PRIME.
 13132     IF SUFXL > 0
 13133         MOVE SUFXI              TO  MSTR-CERT-NO-SUFX.
 13134
 13135     IF PI-PREV-CLAIM = LOW-VALUES
 13136         NEXT SENTENCE
 13137     ELSE
 13138         IF CLMNOL  = 0 AND
 13139            CARRL   = 0 AND
 13140            CERTNOL = 0 AND
 13141            SUFXL   = 0
 13142                 MOVE PI-PREV-CLAIM  TO  ELMSTR-KEY.
 13143
 13144 7500-START-READING.
 13145
 13146
 13147* EXEC CICS HANDLE CONDITION
 13148*        ENDFILE  (8700-END-FILE)
 13149*        NOTFND   (8600-NOT-FOUND)
 13150*    END-EXEC.
 13151*    MOVE '"$''I                  ! 9 #00011838' TO DFHEIV0
 13152     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 13153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13154     MOVE X'3920233030303131383338' TO DFHEIV0(25:11)
 13155     CALL 'kxdfhei1' USING DFHEIV0
 13156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13157
 13158
 13159     MOVE 'MSTR'                 TO  FILE-SWITCH.
 13160
 13161
 13162* EXEC CICS STARTBR
 13163*        DATASET   (PI-CURRENT-FILE)
 13164*        RIDFLD    (ELMSTR-KEY)
 13165*    END-EXEC.
 13166     MOVE 0
 13167       TO DFHEIV11
 13168*    MOVE '&,         G          &   #00011845' TO DFHEIV0
 13169     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13170     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13171     MOVE X'2020233030303131383435' TO DFHEIV0(25:11)
 13172     CALL 'kxdfhei1' USING DFHEIV0,
 13173           PI-CURRENT-FILE,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 248
* EL150.cbl
 13174           ELMSTR-KEY,
 13175           DFHEIV99,
 13176           DFHEIV11,
 13177           DFHEIV99
 13178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13179
 13180
 13181 7500-READ-PREV.
 13182
 13183
 13184* EXEC CICS READPREV
 13185*        DATASET   (PI-CURRENT-FILE)
 13186*        RIDFLD    (ELMSTR-KEY)
 13187*        INTO      (CLAIM-MASTER)
 13188*    END-EXEC.
 13189     MOVE LENGTH OF
 13190      CLAIM-MASTER
 13191       TO DFHEIV12
 13192     MOVE 0
 13193       TO DFHEIV11
 13194*    MOVE '&0IL                  )   #00011852' TO DFHEIV0
 13195     MOVE X'2630494C2020202020202020' TO DFHEIV0(1:12)
 13196     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13197     MOVE X'2020233030303131383532' TO DFHEIV0(25:11)
 13198     CALL 'kxdfhei1' USING DFHEIV0,
 13199           PI-CURRENT-FILE,
 13200           CLAIM-MASTER,
 13201           DFHEIV12,
 13202           ELMSTR-KEY,
 13203           DFHEIV99,
 13204           DFHEIV11,
 13205           DFHEIV99,
 13206           DFHEIV99
 13207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13208
 13209
 13210     IF ELMSTR-KEY = PI-PREV-CLAIM
 13211         MOVE CL-CLAIM-NO        TO  PI-PREV-CLMNO
 13212         GO TO 7500-READ-PREV.
 13213
 13214     IF PI-COMPANY-CD NOT = CL-COMPANY-CD
 13215         GO TO 8700-END-FILE.
 13216
 13217 7500-PICK-UP-LOGIC.
 13218
 13219     IF PI-COMPANY-ID  =  'CRI'
 13220         IF CL-CLAIM-NO NOT = PI-PREV-CLMNO
 13221             GO TO 8700-END-FILE.
 13222
 13223     IF PI-CARRIER-SECURITY > SPACES
 13224         IF CL-CARRIER = PI-CARRIER-SECURITY
 13225             NEXT SENTENCE
 13226         ELSE
 13227             GO TO 7500-READ-PREV.
 13228
 13229     IF PI-ACCOUNT-SECURITY > SPACES
 13230         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
 13231             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 249
* EL150.cbl
 13232         ELSE
 13233             GO TO 7500-READ-PREV.
 13234
 13235     GO TO 1000-READ-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 250
* EL150.cbl
 13237 7600-BROWSING-ASS-BWRD.
 13238
 13239     COMPUTE PI-ASS-NDX = PI-ASS-NDX - 1.
 13240
 13241     IF PI-ASS-NDX < +1
 13242         IF PI-PF16-LAST
 13243             MOVE PI-ORIGINAL-ASS-CERT
 13244                                 TO ELMSTR-KEY
 13245             MOVE ZEROS          TO PI-DAYS-PAID
 13246                                    PI-TOTAL-PAID
 13247             MOVE LOW-VALUES     TO PI-ASSOCIATED-CERTS-TABLE
 13248                                    PI-LAST-PF-KEY-IND
 13249                                    PI-ASSOCIATED-PROCESS-IND
 13250             GO TO 7500-START-READING
 13251         ELSE
 13252             COMPUTE PI-ASS-NDX = PI-ASS-NDX + 1
 13253             MOVE 'S'            TO PI-LAST-PF-KEY-IND
 13254             MOVE -1             TO ENTERPFL
 13255             MOVE ER-0937        TO EMI-ERROR
 13256             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13257             GO TO 8200-SEND-DATAONLY.
 13258
 13259     MOVE PI-PREV-CLAIM          TO ELMSTR-KEY.
 13260     MOVE PI-ASS-CERTS (PI-ASS-NDX)
 13261                                 TO MSTR-CERT-NO.
 13262     MOVE 'MSTR'                 TO FILE-SWITCH.
 13263
 13264
 13265* EXEC CICS HANDLE CONDITION
 13266*        NOTFND   (0450-NOT-FOUND)
 13267*    END-EXEC.
 13268*    MOVE '"$I                   ! : #00011912' TO DFHEIV0
 13269     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13271     MOVE X'3A20233030303131393132' TO DFHEIV0(25:11)
 13272     CALL 'kxdfhei1' USING DFHEIV0
 13273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13274
 13275
 13276
 13277* EXEC CICS READ
 13278*        DATASET   (PI-CURRENT-FILE)
 13279*        RIDFLD    (ELMSTR-KEY)
 13280*        INTO      (CLAIM-MASTER)
 13281*    END-EXEC.
 13282     MOVE LENGTH OF
 13283      CLAIM-MASTER
 13284       TO DFHEIV11
 13285*    MOVE '&"IL       E          (   #00011916' TO DFHEIV0
 13286     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13287     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13288     MOVE X'2020233030303131393136' TO DFHEIV0(25:11)
 13289     CALL 'kxdfhei1' USING DFHEIV0,
 13290           PI-CURRENT-FILE,
 13291           CLAIM-MASTER,
 13292           DFHEIV11,
 13293           ELMSTR-KEY,
 13294           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 251
* EL150.cbl
 13295           DFHEIV99,
 13296           DFHEIV99
 13297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13298
 13299
 13300     GO TO 7500-PICK-UP-LOGIC.
 13301
 13302 7600-EXIT.
 13303     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 252
* EL150.cbl
 13305 7650-CREATE-ACTQ.
 13306
 13307
 13308* EXEC CICS HANDLE CONDITION
 13309*        NOTFND(7650-CREATE-NEW-ACTQ)
 13310*    END-EXEC.
 13311*    MOVE '"$I                   ! ; #00011929' TO DFHEIV0
 13312     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13314     MOVE X'3B20233030303131393239' TO DFHEIV0(25:11)
 13315     CALL 'kxdfhei1' USING DFHEIV0
 13316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13317
 13318
 13319     MOVE PI-COMPANY-CD          TO ACTQ-COMP-CD.
 13320     MOVE PI-CARRIER             TO ACTQ-CARRIER.
 13321     MOVE PI-CLAIM-NO            TO ACTQ-CLAIM-NO.
 13322     MOVE PI-CERT-NO             TO ACTQ-CERT-NO.
 13323
 13324     MOVE 'ACTQ'                 TO FILE-SWITCH.
 13325     MOVE 'ELACTQ  '             TO FILE-ID.
 13326
 13327
 13328* EXEC CICS READ
 13329*        UPDATE
 13330*        DATASET   ('ELACTQ')
 13331*        SET       (ADDRESS OF ACTIVITY-QUE)
 13332*        RIDFLD    (ELACTQ-KEY)
 13333*    END-EXEC.
 13334     MOVE 'ELACTQ' TO DFHEIV1
 13335*    MOVE '&"S        EU         (   #00011941' TO DFHEIV0
 13336     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13337     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13338     MOVE X'2020233030303131393431' TO DFHEIV0(25:11)
 13339     CALL 'kxdfhei1' USING DFHEIV0,
 13340           DFHEIV1,
 13341           DFHEIV20,
 13342           DFHEIV99,
 13343           ELACTQ-KEY,
 13344           DFHEIV99,
 13345           DFHEIV99,
 13346           DFHEIV99
 13347     SET ADDRESS OF ACTIVITY-QUE TO
 13348         DFHEIV20
 13349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13350
 13351
 13352     MOVE 'L'                    TO AQ-PENDING-CLAIM-RESTORE.
 13353
 13354     MOVE +150                   TO AQ-LAST-UPDATED-BY.
 13355
 13356     MOVE 'ELACTQ  '             TO FILE-ID.
 13357
 13358
 13359* EXEC CICS REWRITE
 13360*        DATASET   ('ELACTQ')
 13361*        FROM      (ACTIVITY-QUE)
 13362*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 253
* EL150.cbl
 13363     MOVE LENGTH OF
 13364      ACTIVITY-QUE
 13365       TO DFHEIV11
 13366     MOVE 'ELACTQ' TO DFHEIV1
 13367*    MOVE '&& L                  %   #00011954' TO DFHEIV0
 13368     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13369     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13370     MOVE X'2020233030303131393534' TO DFHEIV0(25:11)
 13371     CALL 'kxdfhei1' USING DFHEIV0,
 13372           DFHEIV1,
 13373           ACTIVITY-QUE,
 13374           DFHEIV11,
 13375           DFHEIV99
 13376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13377
 13378
 13379     GO TO 7650-EXIT.
 13380
 13381 7650-CREATE-NEW-ACTQ.
 13382
 13383
 13384* EXEC CICS GETMAIN
 13385*        SET       (ADDRESS OF ACTIVITY-QUE)
 13386*        LENGTH    (60)
 13387*        INITIMG   (GETMAIN-SPACE)
 13388*    END-EXEC.
 13389     MOVE 60
 13390       TO DFHEIV11
 13391*    MOVE ',"IL                  $   #00011963' TO DFHEIV0
 13392     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13393     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13394     MOVE X'2020233030303131393633' TO DFHEIV0(25:11)
 13395     CALL 'kxdfhei1' USING DFHEIV0,
 13396           DFHEIV20,
 13397           DFHEIV11,
 13398           GETMAIN-SPACE
 13399     SET ADDRESS OF ACTIVITY-QUE TO
 13400         DFHEIV20
 13401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13402
 13403
 13404     MOVE 'AQ'                   TO AQ-RECORD-ID.
 13405     MOVE PI-COMPANY-CD          TO AQ-COMPANY-CD.
 13406     MOVE PI-CARRIER             TO AQ-CARRIER.
 13407     MOVE PI-CLAIM-NO            TO AQ-CLAIM-NO.
 13408     MOVE PI-CERT-NO             TO AQ-CERT-NO.
 13409
 13410     MOVE 'L'                    TO AQ-PENDING-CLAIM-RESTORE.
 13411
 13412     MOVE +0                     TO AQ-PAYMENT-COUNTER
 13413                                    AQ-PMT-UNAPPROVED-COUNT.
 13414
 13415     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 13416                                    AQ-FOLLOWUP-DATE.
 13417
 13418     MOVE +150                   TO AQ-LAST-UPDATED-BY.
 13419
 13420     MOVE 'ACTQ'                 TO FILE-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 254
* EL150.cbl
 13421
 13422     MOVE 'ELACTQ  '             TO FILE-ID.
 13423
 13424
 13425* EXEC CICS WRITE
 13426*        DATASET   ('ELACTQ')
 13427*        FROM      (ACTIVITY-QUE)
 13428*        RIDFLD    (AQ-CONTROL-PRIMARY)
 13429*    END-EXEC.
 13430     MOVE LENGTH OF
 13431      ACTIVITY-QUE
 13432       TO DFHEIV11
 13433     MOVE 'ELACTQ' TO DFHEIV1
 13434*    MOVE '&$ L                  ''   #00011989' TO DFHEIV0
 13435     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13436     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13437     MOVE X'2020233030303131393839' TO DFHEIV0(25:11)
 13438     CALL 'kxdfhei1' USING DFHEIV0,
 13439           DFHEIV1,
 13440           ACTIVITY-QUE,
 13441           DFHEIV11,
 13442           AQ-CONTROL-PRIMARY,
 13443           DFHEIV99,
 13444           DFHEIV99
 13445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13446
 13447
 13448 7650-EXIT.
 13449     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 255
* EL150.cbl
 13451 7700-CREATE-CLAIM.
 13452
 13453
 13454* EXEC CICS HANDLE CONDITION
 13455*        NOTFND   (7700-RETR-RECORD-NOT-FOUND)
 13456*        DUPREC   (7700-DUPLICATE-CLAIM)
 13457*    END-EXEC.
 13458*    MOVE '"$I%                  ! < #00012000' TO DFHEIV0
 13459     MOVE X'222449252020202020202020' TO DFHEIV0(1:12)
 13460     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13461     MOVE X'3C20233030303132303030' TO DFHEIV0(25:11)
 13462     CALL 'kxdfhei1' USING DFHEIV0
 13463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13464
 13465
 13466     IF CLMNOL > 0
 13467         MOVE CLMNOI             TO PI-CLAIM-NO.
 13468
 13469     IF CARRL > 0
 13470         MOVE CARRI              TO PI-CARRIER.
 13471
 13472     IF CERTNOL > 0
 13473         MOVE CERTNOI            TO PI-CERT-PRIME.
 13474
 13475     IF SUFXL > 0
 13476         MOVE SUFXI              TO PI-CERT-SFX.
 13477
 13478     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 13479     MOVE PI-CARRIER             TO MSTR-CARRIER.
 13480     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 13481     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 13482     MOVE +1                     TO PI-ASS-NDX.
 13483
 13484 7700-CONT-MOVE.
 13485
 13486     IF PI-ASS-PROCESSING
 13487         MOVE PI-ASS-CERTS (PI-ASS-NDX)
 13488                                 TO MSTR-CERT-NO.
 13489
 13490     MOVE ELMSTR-KEY             TO W-ELRETR-KEY.
 13491
 13492
 13493* EXEC CICS READ
 13494*        DATASET   ('ELRETR')
 13495*        SET       (ADDRESS OF RETRIEVE-MASTER)
 13496*        RIDFLD    (W-ELRETR-KEY)
 13497*    END-EXEC.
 13498     MOVE 'ELRETR' TO DFHEIV1
 13499*    MOVE '&"S        E          (   #00012031' TO DFHEIV0
 13500     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13501     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13502     MOVE X'2020233030303132303331' TO DFHEIV0(25:11)
 13503     CALL 'kxdfhei1' USING DFHEIV0,
 13504           DFHEIV1,
 13505           DFHEIV20,
 13506           DFHEIV99,
 13507           W-ELRETR-KEY,
 13508           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 256
* EL150.cbl
 13509           DFHEIV99,
 13510           DFHEIV99
 13511     SET ADDRESS OF RETRIEVE-MASTER TO
 13512         DFHEIV20
 13513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13514
 13515
 13516
 13517* EXEC CICS GETMAIN
 13518*        SET       (ADDRESS OF CLAIM-MASTER-L)
 13519*        LENGTH    (350)
 13520*        INITIMG   (GETMAIN-SPACE)
 13521*    END-EXEC.
 13522     MOVE 350
 13523       TO DFHEIV11
 13524*    MOVE ',"IL                  $   #00012037' TO DFHEIV0
 13525     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13526     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13527     MOVE X'2020233030303132303337' TO DFHEIV0(25:11)
 13528     CALL 'kxdfhei1' USING DFHEIV0,
 13529           DFHEIV20,
 13530           DFHEIV11,
 13531           GETMAIN-SPACE
 13532     SET ADDRESS OF CLAIM-MASTER-L TO
 13533         DFHEIV20
 13534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13535
 13536
 13537     MOVE RETRIEVE-MASTER        TO CLAIM-MASTER.
 13538     MOVE 'CL'                   TO CL-RECORD-ID.
 13539     MOVE SAVE-BIN-DATE          TO CL-RESTORED-DT.
 13540
 13541
 13542* EXEC CICS WRITE
 13543*        DATASET   ('ELMSTR')
 13544*        FROM      (CLAIM-MASTER)
 13545*        RIDFLD    (CL-CONTROL-PRIMARY)
 13546*    END-EXEC.
 13547     MOVE LENGTH OF
 13548      CLAIM-MASTER
 13549       TO DFHEIV11
 13550     MOVE 'ELMSTR' TO DFHEIV1
 13551*    MOVE '&$ L                  ''   #00012047' TO DFHEIV0
 13552     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13553     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13554     MOVE X'2020233030303132303437' TO DFHEIV0(25:11)
 13555     CALL 'kxdfhei1' USING DFHEIV0,
 13556           DFHEIV1,
 13557           CLAIM-MASTER,
 13558           DFHEIV11,
 13559           CL-CONTROL-PRIMARY,
 13560           DFHEIV99,
 13561           DFHEIV99
 13562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13563
 13564
 13565
 13566* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 257
* EL150.cbl
 13567*        FILE      ('ELRETR')
 13568*        RIDFLD    (RL-CONTROL-PRIMARY)
 13569*    END-EXEC.
 13570     MOVE 'ELRETR' TO DFHEIV1
 13571*    MOVE '&(  R                 &   #00012053' TO DFHEIV0
 13572     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13573     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13574     MOVE X'2020233030303132303533' TO DFHEIV0(25:11)
 13575     CALL 'kxdfhei1' USING DFHEIV0,
 13576           DFHEIV1,
 13577           RL-CONTROL-PRIMARY,
 13578           DFHEIV99,
 13579           DFHEIV99,
 13580           DFHEIV99
 13581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13582
 13583
 13584     IF PI-ASS-PROCESSING
 13585         ADD +1                  TO PI-ASS-NDX
 13586         IF PI-ASS-NDX < +25
 13587                 AND
 13588            PI-ASS-CERTS (PI-ASS-NDX) > SPACES
 13589             GO TO 7700-CONT-MOVE.
 13590
 13591     MOVE 'MSTR'                 TO FILE-SWITCH.
 13592     MOVE 'ELMSTR'               TO PI-CURRENT-FILE.
 13593     MOVE LOW-VALUES             TO PI-RETRIEVED-DATA-IND.
 13594     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 13595     MOVE XCTL-132               TO PGM-NAME.
 13596     GO TO 9300-XCTL.
 13597
 13598 7700-RETR-RECORD-NOT-FOUND.
 13599
 13600     MOVE ER-0929                TO EMI-ERROR.
 13601     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13602     MOVE -1                     TO CLMNOL.
 13603     MOVE PI-CARRIER             TO CARRO.
 13604     MOVE PI-CLAIM-NO            TO CLMNOO.
 13605     MOVE PI-CERT-PRIME          TO CERTNOO.
 13606     MOVE PI-CERT-SFX            TO SUFXO.
 13607     MOVE AL-UABON               TO CLMNOA   CARRA
 13608                                    CERTNOA  SUFXA.
 13609     GO TO 8100-SEND-INITIAL-MAP.
 13610
 13611 7700-DUPLICATE-CLAIM.
 13612
 13613     MOVE ER-0928                TO EMI-ERROR.
 13614     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13615     MOVE -1                     TO CLMNOL.
 13616     MOVE PI-CARRIER             TO CARRO.
 13617     MOVE PI-CLAIM-NO            TO CLMNOO.
 13618     MOVE PI-CERT-PRIME          TO CERTNOO.
 13619     MOVE PI-CERT-SFX            TO SUFXO.
 13620     MOVE AL-UABON               TO CLMNOA   CARRA
 13621                                    CERTNOA  SUFXA.
 13622     GO TO 8100-SEND-INITIAL-MAP.
 13623
 13624 7700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 258
* EL150.cbl
 13625     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 259
* EL150.cbl
 13627 8000-LOAD-ERROR-MESSAGES.
 13628     IF EMI-NO-ERRORS
 13629         GO TO 8000-EXIT.
 13630
 13631     IF EMI-NUMBER-OF-LINES = 1
 13632         MOVE EMI-LINE1          TO ERRMSG1O
 13633         GO TO 8000-EXIT.
 13634
 13635     MOVE EMI-LINE1              TO ERRMSG1O.
 13636
 13637 8000-EXIT.
 13638     EXIT.
 13639
 13640 8100-SEND-INITIAL-MAP.
 13641
 13642     MOVE SAVE-DATE              TO RUNDTEO.
 13643     MOVE EIBTIME                TO TIME-IN.
 13644     MOVE TIME-OUT               TO RUNTIMEO.
 13645     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 13646     MOVE PI-PROCESSOR-ID        TO USERIDO.
 13647     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 13648
 13649     IF PI-USES-PAID-TO
 13650        MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
 13651
 13652     IF PI-RETRIEVED-DATA
 13653         MOVE 'RETRIEVE MASTER'  TO RETMSTO.
 13654
 13655     IF PI-COMPANY-ID = 'DMD'
 13656         MOVE 'PF11=FORM REF'    TO PFKEY11O
 13657         MOVE 'LST PMT AMT:'     TO COVERDO
 13658         MOVE 'LST PMT DT :'     TO PRMTYPDO
 13659         MOVE 'COVERAGE   :'     TO CRTSTADO.
 13660
 13661     IF PI-APPROVAL-LEVEL = '4' OR '5'
 13662         MOVE AL-UNNOF         TO TOTINTA
 13663     END-IF
 13664
 13665
 13666* EXEC CICS SEND
 13667*        MAP      (MAP-NAME)
 13668*        MAPSET   (MAPSET-NAME)
 13669*        FROM     (EL150AO)
 13670*        ERASE
 13671*        CURSOR
 13672*    END-EXEC.
 13673     MOVE LENGTH OF
 13674      EL150AO
 13675       TO DFHEIV12
 13676     MOVE -1
 13677       TO DFHEIV11
 13678*    MOVE '8$     CT  E    H L F ,   #00012139' TO DFHEIV0
 13679     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 13680     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13681     MOVE X'2020233030303132313339' TO DFHEIV0(25:11)
 13682     CALL 'kxdfhei1' USING DFHEIV0,
 13683           MAP-NAME,
 13684           EL150AO,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 260
* EL150.cbl
 13685           DFHEIV12,
 13686           MAPSET-NAME,
 13687           DFHEIV99,
 13688           DFHEIV99,
 13689           DFHEIV99,
 13690           DFHEIV11,
 13691           DFHEIV99,
 13692           DFHEIV99,
 13693           DFHEIV99
 13694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13695
 13696
 13697     GO TO 9100-RETURN-TRAN.
 13698
 13699     .
 13700 8200-SEND-DATAONLY.
 13701     MOVE SAVE-DATE              TO RUNDTEO.
 13702     MOVE EIBTIME                TO TIME-IN.
 13703     MOVE TIME-OUT               TO RUNTIMEO.
 13704     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 13705     MOVE PI-PROCESSOR-ID        TO USERIDO.
 13706     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 13707
 13708     MOVE PI-CARRIER             TO CARRO.
 13709     MOVE PI-CLAIM-NO            TO CLMNOO.
 13710     MOVE PI-CERT-PRIME          TO CERTNOO.
 13711     MOVE PI-CERT-SFX            TO SUFXO.
 13712
 13713     IF PI-USES-PAID-TO
 13714        MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
 13715
 13716     IF PI-RETRIEVED-DATA
 13717         MOVE 'RETRIEVE MASTER'  TO RETMSTO.
 13718
 13719     IF PI-COMPANY-ID = 'DMD'
 13720         MOVE 'PF11=FORM REF'    TO PFKEY11O
 13721         MOVE 'LST PMT AMT:'     TO COVERDO
 13722         MOVE 'LST PMT DT :'     TO PRMTYPDO
 13723         MOVE 'COVERAGE   :'     TO CRTSTADO.
 13724
 13725     IF PI-APPROVAL-LEVEL = '4' OR '5'
 13726         MOVE AL-UNNOF         TO TOTINTA
 13727     END-IF
 13728
 13729
 13730* EXEC CICS SEND
 13731*        MAP      (MAP-NAME)
 13732*        MAPSET   (MAPSET-NAME)
 13733*        FROM     (EL150AO)
 13734*        DATAONLY
 13735*        CURSOR
 13736*    END-EXEC.
 13737     MOVE LENGTH OF
 13738      EL150AO
 13739       TO DFHEIV12
 13740     MOVE -1
 13741       TO DFHEIV11
 13742*    MOVE '8$D    CT       H L F ,   #00012179' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 261
* EL150.cbl
 13743     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 13744     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13745     MOVE X'2020233030303132313739' TO DFHEIV0(25:11)
 13746     CALL 'kxdfhei1' USING DFHEIV0,
 13747           MAP-NAME,
 13748           EL150AO,
 13749           DFHEIV12,
 13750           MAPSET-NAME,
 13751           DFHEIV99,
 13752           DFHEIV99,
 13753           DFHEIV99,
 13754           DFHEIV11,
 13755           DFHEIV99,
 13756           DFHEIV99,
 13757           DFHEIV99
 13758     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13759
 13760
 13761     GO TO 9100-RETURN-TRAN.
 13762
 13763 8250-SEND-WITH-CURSOR.
 13764     MOVE SAVE-DATE              TO RUNDTEO.
 13765     MOVE EIBTIME                TO TIME-IN.
 13766     MOVE TIME-OUT               TO RUNTIMEO.
 13767     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 13768     MOVE PI-PROCESSOR-ID        TO USERIDO.
 13769     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 13770
 13771     IF PI-USES-PAID-TO
 13772        MOVE 'PAID  TO  DT :'     TO PDTHRHDO.
 13773
 13774     IF PI-COMPANY-ID = 'DMD'
 13775         MOVE 'PF11=FORM REF'    TO PFKEY11O
 13776         MOVE 'LST PMT AMT:'     TO COVERDO
 13777         MOVE 'LST PMT DT :'     TO PRMTYPDO
 13778         MOVE 'COVERAGE   :'     TO CRTSTADO.
 13779
 13780     IF PI-APPROVAL-LEVEL = '4' OR '5'
 13781         MOVE AL-UNNOF         TO TOTINTA
 13782     END-IF
 13783
 13784
 13785* EXEC CICS SEND
 13786*        MAP      (MAP-NAME)
 13787*        MAPSET   (MAPSET-NAME)
 13788*        FROM     (EL150AO)
 13789*        ERASE
 13790*        CURSOR   (PI-SAVE-CURSOR)
 13791*    END-EXEC.
 13792     MOVE LENGTH OF
 13793      EL150AO
 13794       TO DFHEIV11
 13795*    MOVE '8$     CT  E    H L F ,   #00012210' TO DFHEIV0
 13796     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 13797     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 13798     MOVE X'2020233030303132323130' TO DFHEIV0(25:11)
 13799     CALL 'kxdfhei1' USING DFHEIV0,
 13800           MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 262
* EL150.cbl
 13801           EL150AO,
 13802           DFHEIV11,
 13803           MAPSET-NAME,
 13804           DFHEIV99,
 13805           DFHEIV99,
 13806           DFHEIV99,
 13807           PI-SAVE-CURSOR,
 13808           DFHEIV99,
 13809           DFHEIV99,
 13810           DFHEIV99
 13811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13812
 13813
 13814     GO TO 9100-RETURN-TRAN.
 13815
 13816 8300-SEND-TEXT.
 13817
 13818* EXEC CICS SEND TEXT
 13819*        FROM     (LOGOFF-TEXT)
 13820*        LENGTH   (LOGOFF-LENGTH)
 13821*        ERASE
 13822*        FREEKB
 13823*    END-EXEC.
 13824*    MOVE '8&      T  E F  H   F -   #00012221' TO DFHEIV0
 13825     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 13826     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 13827     MOVE X'2020233030303132323231' TO DFHEIV0(25:11)
 13828     CALL 'kxdfhei1' USING DFHEIV0,
 13829           LOGOFF-TEXT,
 13830           LOGOFF-LENGTH,
 13831           DFHEIV99,
 13832           DFHEIV99,
 13833           DFHEIV99,
 13834           DFHEIV99,
 13835           DFHEIV99,
 13836           DFHEIV99,
 13837           DFHEIV99,
 13838           DFHEIV99,
 13839           DFHEIV99,
 13840           DFHEIV99
 13841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13842
 13843
 13844
 13845* EXEC CICS RETURN
 13846*    END-EXEC.
 13847*    MOVE '.(                    ''   #00012228' TO DFHEIV0
 13848     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 13849     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13850     MOVE X'2020233030303132323238' TO DFHEIV0(25:11)
 13851     CALL 'kxdfhei1' USING DFHEIV0,
 13852           DFHEIV99,
 13853           DFHEIV99,
 13854           DFHEIV99,
 13855           DFHEIV99,
 13856           DFHEIV99,
 13857           DFHEIV99
 13858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 263
* EL150.cbl
 13859
 13860
 13861 8500-FILE-NOTOPEN.
 13862     IF FILE-SWITCH = 'MSTR'
 13863         MOVE ER-0154            TO EMI-ERROR.
 13864
 13865     IF FILE-SWITCH = 'TRLR'
 13866         MOVE ER-0172            TO EMI-ERROR.
 13867
 13868     IF FILE-SWITCH = 'CERT'
 13869         MOVE ER-0169            TO EMI-ERROR.
 13870
 13871     IF FILE-SWITCH = 'CNTL'
 13872         MOVE ER-0042            TO EMI-ERROR.
 13873
 13874     IF FILE-SWITCH = 'ACTQ'
 13875         MOVE ER-0338            TO EMI-ERROR.
 13876
 13877     IF FILE-SWITCH = 'ACCT'
 13878         MOVE ER-0168            TO EMI-ERROR.
 13879
 13880     IF FILE-SWITCH = 'PLCY'
 13881         MOVE ER-9883            TO EMI-ERROR.
 13882
 13883     IF FILE-SWITCH = 'PLAN'
 13884         MOVE ER-9808            TO EMI-ERROR.
 13885
 13886     IF FILE-SWITCH = 'PROD'
 13887         MOVE ER-9886            TO EMI-ERROR.
 13888
 13889     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13890
 13891     IF FILE-SWITCH = 'CERT' AND
 13892       (PI-COMPANY-ID = 'CID' OR 'AHL')
 13893        GO TO 1050-SHOW-CONTINUE.
 13894
 13895     MOVE -1                     TO FILETOL.
 13896
 13897     IF PASS-SWITCH = 'A'
 13898         GO TO 8100-SEND-INITIAL-MAP
 13899     ELSE
 13900         GO TO 8200-SEND-DATAONLY.
 13901
 13902 8600-NOT-FOUND.
 13903     MOVE AL-UABON               TO CLMNOA    CARRA
 13904                                    CERTNOA   SUFXA.
 13905     MOVE -1                     TO ENTERPFL.
 13906     MOVE ER-0204                TO EMI-ERROR.
 13907     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13908     GO TO 8200-SEND-DATAONLY.
 13909
 13910 8700-END-FILE.
 13911
 13912     MOVE -1                     TO ENTERPFL.
 13913     MOVE ER-0130                TO EMI-ERROR.
 13914     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13915     GO TO 8200-SEND-DATAONLY.
 13916
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 264
* EL150.cbl
 13917 8800-UNAUTHORIZED-ACCESS.
 13918     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 13919     GO TO 8300-SEND-TEXT.
 13920
 13921 8810-PF23.
 13922     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 13923     MOVE XCTL-005               TO PGM-NAME.
 13924     GO TO 9300-XCTL.
 13925
 13926 8900-GET-FREE-LOOK.
 13927     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13928     MOVE SPACES                 TO CNTL-ACCESS.
 13929     MOVE PI-STATE               TO CNTL-ACCESS.
 13930     MOVE '3'                    TO CNTL-REC-TYPE.
 13931     MOVE +0                     TO CNTL-SEQ-NO.
 13932
 13933
 13934* EXEC CICS READ
 13935*        DATASET   ('ELCNTL')
 13936*        SET       (ADDRESS OF CONTROL-FILE)
 13937*        RIDFLD    (ELCNTL-KEY)
 13938*        RESP      (WS-RESPONSE)
 13939*    END-EXEC.
 13940     MOVE 'ELCNTL' TO DFHEIV1
 13941*    MOVE '&"S        E          (  N#00012303' TO DFHEIV0
 13942     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13943     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13944     MOVE X'204E233030303132333033' TO DFHEIV0(25:11)
 13945     CALL 'kxdfhei1' USING DFHEIV0,
 13946           DFHEIV1,
 13947           DFHEIV20,
 13948           DFHEIV99,
 13949           ELCNTL-KEY,
 13950           DFHEIV99,
 13951           DFHEIV99,
 13952           DFHEIV99
 13953     SET ADDRESS OF CONTROL-FILE TO
 13954         DFHEIV20
 13955     MOVE EIBRESP  TO WS-RESPONSE
 13956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13957
 13958
 13959     IF WS-RESP-NOTFND
 13960        MOVE ER-2848             TO EMI-ERROR
 13961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13962        GO TO 8100-SEND-INITIAL-MAP
 13963     ELSE
 13964        MOVE CF-ST-FREE-LOOK-PERIOD
 13965                                 TO CP-FREE-LOOK.
 13966
 13967 8900-EXIT.
 13968     EXIT.
 13969
 13970 9100-RETURN-TRAN.
 13971     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 13972     MOVE '150A'                 TO PI-CURRENT-SCREEN-NO.
 13973
 13974
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 265
* EL150.cbl
 13975* EXEC CICS RETURN
 13976*        TRANSID    (TRANS-ID)
 13977*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 13978*        LENGTH     (PI-COMM-LENGTH)
 13979*    END-EXEC.
 13980*    MOVE '.(CT                  ''   #00012325' TO DFHEIV0
 13981     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 13982     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13983     MOVE X'2020233030303132333235' TO DFHEIV0(25:11)
 13984     CALL 'kxdfhei1' USING DFHEIV0,
 13985           TRANS-ID,
 13986           PROGRAM-INTERFACE-BLOCK,
 13987           PI-COMM-LENGTH,
 13988           DFHEIV99,
 13989           DFHEIV99,
 13990           DFHEIV99
 13991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13992
 13993
 13994 9200-RETURN-MAIN-MENU.
 13995     MOVE XCTL-126               TO PGM-NAME.
 13996     GO TO 9300-XCTL.
 13997
 13998 9300-XCTL.
 13999
 14000* EXEC CICS XCTL
 14001*        PROGRAM    (PGM-NAME)
 14002*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 14003*        LENGTH     (PI-COMM-LENGTH)
 14004*    END-EXEC.
 14005*    MOVE '.$C                   %   #00012336' TO DFHEIV0
 14006     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 14007     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14008     MOVE X'2020233030303132333336' TO DFHEIV0(25:11)
 14009     CALL 'kxdfhei1' USING DFHEIV0,
 14010           PGM-NAME,
 14011           PROGRAM-INTERFACE-BLOCK,
 14012           PI-COMM-LENGTH,
 14013           DFHEIV99
 14014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14015
 14016
 14017 9400-CLEAR.
 14018     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 14019     GO TO 9300-XCTL.
 14020
 14021 9500-PF12.
 14022     MOVE XCTL-010               TO PGM-NAME.
 14023     GO TO 9300-XCTL.
 14024
 14025 9600-PGMID-ERROR.
 14026
 14027* EXEC CICS HANDLE CONDITION
 14028*        PGMIDERR   (8300-SEND-TEXT)
 14029*    END-EXEC.
 14030*    MOVE '"$L                   ! = #00012351' TO DFHEIV0
 14031     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 14032     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 266
* EL150.cbl
 14033     MOVE X'3D20233030303132333531' TO DFHEIV0(25:11)
 14034     CALL 'kxdfhei1' USING DFHEIV0
 14035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14036
 14037
 14038     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 14039     MOVE ' '                    TO PI-ENTRY-CD-1.
 14040     MOVE XCTL-005               TO PGM-NAME.
 14041     MOVE PGM-NAME               TO LOGOFF-PGM.
 14042     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 14043     GO TO 9300-XCTL.
 14044
 14045 9700-LINK-DATE-CONVERT.
 14046     MOVE LINK-ELDATCV           TO PGM-NAME.
 14047
 14048
 14049* EXEC CICS LINK
 14050*        PROGRAM    (PGM-NAME)
 14051*        COMMAREA   (DATE-CONVERSION-DATA)
 14052*        LENGTH     (DC-COMM-LENGTH)
 14053*    END-EXEC.
 14054*    MOVE '."C                   (   #00012365' TO DFHEIV0
 14055     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14056     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14057     MOVE X'2020233030303132333635' TO DFHEIV0(25:11)
 14058     CALL 'kxdfhei1' USING DFHEIV0,
 14059           PGM-NAME,
 14060           DATE-CONVERSION-DATA,
 14061           DC-COMM-LENGTH,
 14062           DFHEIV99,
 14063           DFHEIV99,
 14064           DFHEIV99,
 14065           DFHEIV99
 14066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14067
 14068
 14069 9700-EXIT.
 14070     EXIT.
 14071
 14072 9800-LINK-REM-TERM.
 14073     MOVE LINK-ELRTRM            TO PGM-NAME.
 14074
 14075
 14076* EXEC CICS LINK
 14077*        PROGRAM    (PGM-NAME)
 14078*        COMMAREA   (CALCULATION-PASS-AREA)
 14079*        LENGTH     (CP-COMM-LENGTH)
 14080*    END-EXEC.
 14081*    MOVE '."C                   (   #00012377' TO DFHEIV0
 14082     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14083     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14084     MOVE X'2020233030303132333737' TO DFHEIV0(25:11)
 14085     CALL 'kxdfhei1' USING DFHEIV0,
 14086           PGM-NAME,
 14087           CALCULATION-PASS-AREA,
 14088           CP-COMM-LENGTH,
 14089           DFHEIV99,
 14090           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 267
* EL150.cbl
 14091           DFHEIV99,
 14092           DFHEIV99
 14093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14094
 14095
 14096 9800-EXIT.
 14097     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 268
* EL150.cbl
 14099 9830-DMD-REMAINING-TERM.
 14100
 14101     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 14102         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 14103
 14104     MOVE W-PAID-MONTHS          TO W-PYMTS.
 14105     MOVE W-PAID-DAYS            TO W-ADD-DAYS.
 14106
 14107     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30
 14108                            + CM-PMT-EXTENSION-DAYS.
 14109
 14110     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS
 14111                                - CL-NO-OF-DAYS-PAID.
 14112
 14113     DIVIDE W-REM-TERM-IN-DAYS BY +30
 14114         GIVING W-REM REMAINDER W-REM-DAYS.
 14115
 14116     MOVE W-REM                  TO WST-REM.
 14117
 14118     IF CM-PMT-EXTENSION-DAYS > ZEROS
 14119         MOVE '/'                TO WST-SLASH1
 14120         MOVE CM-PMT-EXTENSION-DAYS TO WST-EXT-DAYS
 14121     ELSE
 14122         MOVE SPACES             TO WST-ORIG-DAYS-GRP.
 14123
 14124     IF W-REM-DAYS > ZEROS
 14125         MOVE '/'                TO WST-SLASH2
 14126         MOVE W-REM-DAYS         TO WST-REM-DAYS
 14127     ELSE
 14128         MOVE SPACES             TO WST-REM-DAYS-GRP.
 14129
 14130 9830-EXIT.
 14131     EXIT.
 14132
 14133 9850-LINK-REM-AMT.
 14134     MOVE 'ELRAMT  '             TO PGM-NAME.
 14135
 14136
 14137* EXEC CICS LINK
 14138*        PROGRAM    (PGM-NAME)
 14139*        COMMAREA   (CALCULATION-PASS-AREA)
 14140*        LENGTH     (CP-COMM-LENGTH)
 14141*    END-EXEC.
 14142*    MOVE '."C                   (   #00012423' TO DFHEIV0
 14143     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14144     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14145     MOVE X'2020233030303132343233' TO DFHEIV0(25:11)
 14146     CALL 'kxdfhei1' USING DFHEIV0,
 14147           PGM-NAME,
 14148           CALCULATION-PASS-AREA,
 14149           CP-COMM-LENGTH,
 14150           DFHEIV99,
 14151           DFHEIV99,
 14152           DFHEIV99,
 14153           DFHEIV99
 14154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14155
 14156
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 269
* EL150.cbl
 14157 9850-EXIT.
 14158     EXIT.
 14159
 14160 9900-ERROR-FORMAT.
 14161     IF NOT EMI-ERRORS-COMPLETE
 14162         MOVE LINK-001           TO PGM-NAME
 14163
 14164* EXEC CICS LINK
 14165*            PROGRAM    (PGM-NAME)
 14166*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 14167*            LENGTH     (EMI-COMM-LENGTH)
 14168*        END-EXEC.
 14169*    MOVE '."C                   (   #00012435' TO DFHEIV0
 14170     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14171     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14172     MOVE X'2020233030303132343335' TO DFHEIV0(25:11)
 14173     CALL 'kxdfhei1' USING DFHEIV0,
 14174           PGM-NAME,
 14175           ERROR-MESSAGE-INTERFACE-BLOCK,
 14176           EMI-COMM-LENGTH,
 14177           DFHEIV99,
 14178           DFHEIV99,
 14179           DFHEIV99,
 14180           DFHEIV99
 14181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14182
 14183
 14184 9900-EXIT.
 14185     EXIT.
 14186
 14187 9990-ABEND.
 14188     MOVE -1 TO FILETOL.
 14189     MOVE LINK-004 TO PGM-NAME.
 14190
 14191     MOVE DFHEIBLK               TO EMI-LINE1
 14192
 14193* EXEC CICS LINK
 14194*        PROGRAM   (PGM-NAME)
 14195*        COMMAREA  (EMI-LINE1)
 14196*        LENGTH    (72)
 14197*    END-EXEC.
 14198     MOVE 72
 14199       TO DFHEIV11
 14200*    MOVE '."C                   (   #00012449' TO DFHEIV0
 14201     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14202     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14203     MOVE X'2020233030303132343439' TO DFHEIV0(25:11)
 14204     CALL 'kxdfhei1' USING DFHEIV0,
 14205           PGM-NAME,
 14206           EMI-LINE1,
 14207           DFHEIV11,
 14208           DFHEIV99,
 14209           DFHEIV99,
 14210           DFHEIV99,
 14211           DFHEIV99
 14212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14213
 14214
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 270
* EL150.cbl
 14215     MOVE EMI-LINE1              TO ERRMSG1O.
 14216     GO TO 8200-SEND-DATAONLY.
 14217
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 271
* EL150.cbl
 14219 9995-SECURITY-VIOLATION.
 14220*                            COPY ELCSCTP.
 14221******************************************************************
 14222*                                                                *
 14223*                            ELCSCTP                             *
 14224*                            VMOD=2.001                          *
 14225*                                                                *
 14226*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 14227******************************************************************
 14228
 14229
 14230     MOVE EIBDATE          TO SM-JUL-DATE.
 14231     MOVE EIBTRMID         TO SM-TERMID.
 14232     MOVE THIS-PGM         TO SM-PGM.
 14233     MOVE EIBTIME          TO TIME-IN.
 14234     MOVE TIME-OUT         TO SM-TIME.
 14235     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 14236
 14237
 14238* EXEC CICS LINK
 14239*         PROGRAM  ('EL003')
 14240*         COMMAREA (SECURITY-MESSAGE)
 14241*         LENGTH   (80)
 14242*    END-EXEC.
 14243     MOVE 'EL003' TO DFHEIV1
 14244     MOVE 80
 14245       TO DFHEIV11
 14246*    MOVE '."C                   (   #00012477' TO DFHEIV0
 14247     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14248     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14249     MOVE X'2020233030303132343737' TO DFHEIV0(25:11)
 14250     CALL 'kxdfhei1' USING DFHEIV0,
 14251           DFHEIV1,
 14252           SECURITY-MESSAGE,
 14253           DFHEIV11,
 14254           DFHEIV99,
 14255           DFHEIV99,
 14256           DFHEIV99,
 14257           DFHEIV99
 14258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14259
 14260
 14261******************************************************************
 14262
 14263
 14264
 14265 9999-DFHBACK SECTION.
 14266     MOVE '9%                    "   ' TO DFHEIV0
 14267     MOVE 'EL150' TO DFHEIV1
 14268     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 14269     GOBACK.
 14270 9999-DFHEXIT.
 14271     IF DFHEIGDJ EQUAL 0001
 14272         NEXT SENTENCE
 14273     ELSE IF DFHEIGDJ EQUAL 2
 14274         GO TO 1000-SHOW-CLAIM,
 14275               0100-FIRST-TIME-IN,
 14276               8500-FILE-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 272
* EL150.cbl
 14277               9600-PGMID-ERROR,
 14278               9990-ABEND
 14279         DEPENDING ON DFHEIGDI
 14280     ELSE IF DFHEIGDJ EQUAL 3
 14281         GO TO 0450-NOT-FOUND
 14282         DEPENDING ON DFHEIGDI
 14283     ELSE IF DFHEIGDJ EQUAL 4
 14284         GO TO 0360-CREATE-NEW-ACTQ
 14285         DEPENDING ON DFHEIGDI
 14286     ELSE IF DFHEIGDJ EQUAL 5
 14287         GO TO 0385-TERMID-ERROR,
 14288               0390-TRANS-ERROR
 14289         DEPENDING ON DFHEIGDI
 14290     ELSE IF DFHEIGDJ EQUAL 6
 14291         GO TO 0450-NOT-FOUND,
 14292               0440-UPDATE-DONE
 14293         DEPENDING ON DFHEIGDI
 14294     ELSE IF DFHEIGDJ EQUAL 7
 14295         GO TO 0690-QIDERR
 14296         DEPENDING ON DFHEIGDI
 14297     ELSE IF DFHEIGDJ EQUAL 8
 14298         GO TO 1100-SHOW-RECORD-NOT-FOUND
 14299         DEPENDING ON DFHEIGDI
 14300     ELSE IF DFHEIGDJ EQUAL 9
 14301         GO TO 1005-END-BUILD-DIAGNOSIS
 14302         DEPENDING ON DFHEIGDI
 14303     ELSE IF DFHEIGDJ EQUAL 10
 14304         GO TO 1100-SHOW-RECORD-NOT-FOUND
 14305         DEPENDING ON DFHEIGDI
 14306     ELSE IF DFHEIGDJ EQUAL 11
 14307         GO TO 1005-NO-ERACCT,
 14308               1005-NO-ERACCT
 14309         DEPENDING ON DFHEIGDI
 14310     ELSE IF DFHEIGDJ EQUAL 12
 14311         GO TO 1008-NOTFND,
 14312               1008-NOTFND
 14313         DEPENDING ON DFHEIGDI
 14314     ELSE IF DFHEIGDJ EQUAL 13
 14315         GO TO 1009-CONTINUE-BUILD,
 14316               1009-CONTINUE-BUILD
 14317         DEPENDING ON DFHEIGDI
 14318     ELSE IF DFHEIGDJ EQUAL 14
 14319         GO TO 1050-SHOW-CONTINUE,
 14320               1050-SHOW-CONTINUE
 14321         DEPENDING ON DFHEIGDI
 14322     ELSE IF DFHEIGDJ EQUAL 15
 14323         GO TO 1220-NO-CLAIM-RECORD-FND,
 14324               1200-ENDBR
 14325         DEPENDING ON DFHEIGDI
 14326     ELSE IF DFHEIGDJ EQUAL 16
 14327         GO TO 1500-SHOW-RECORD-NOT-FOUND
 14328         DEPENDING ON DFHEIGDI
 14329     ELSE IF DFHEIGDJ EQUAL 17
 14330         GO TO 1500-NO-PLAN-RECORD
 14331         DEPENDING ON DFHEIGDI
 14332     ELSE IF DFHEIGDJ EQUAL 18
 14333         GO TO 1700-ENDBROWSE,
 14334               1700-ENDBROWSE
* Micro Focus Server Express         V5.1 revision 000 16-Oct-14 12:22 Page 273
* EL150.cbl
 14335         DEPENDING ON DFHEIGDI
 14336     ELSE IF DFHEIGDJ EQUAL 19
 14337         GO TO 2950-NO-MORE-TRAILERS,
 14338               2950-NO-MORE-TRAILERS
 14339         DEPENDING ON DFHEIGDI
 14340     ELSE IF DFHEIGDJ EQUAL 20
 14341         GO TO 6000-NOT-FOUND
 14342         DEPENDING ON DFHEIGDI
 14343     ELSE IF DFHEIGDJ EQUAL 21
 14344         GO TO 6100-END-RESET,
 14345               6100-END-RESET
 14346         DEPENDING ON DFHEIGDI
 14347     ELSE IF DFHEIGDJ EQUAL 22
 14348         GO TO 6200-EXIT
 14349         DEPENDING ON DFHEIGDI
 14350     ELSE IF DFHEIGDJ EQUAL 23
 14351         GO TO 8700-END-FILE,
 14352               8600-NOT-FOUND
 14353         DEPENDING ON DFHEIGDI
 14354     ELSE IF DFHEIGDJ EQUAL 24
 14355         GO TO 0450-NOT-FOUND
 14356         DEPENDING ON DFHEIGDI
 14357     ELSE IF DFHEIGDJ EQUAL 25
 14358         GO TO 8700-END-FILE,
 14359               8600-NOT-FOUND
 14360         DEPENDING ON DFHEIGDI
 14361     ELSE IF DFHEIGDJ EQUAL 26
 14362         GO TO 0450-NOT-FOUND
 14363         DEPENDING ON DFHEIGDI
 14364     ELSE IF DFHEIGDJ EQUAL 27
 14365         GO TO 7650-CREATE-NEW-ACTQ
 14366         DEPENDING ON DFHEIGDI
 14367     ELSE IF DFHEIGDJ EQUAL 28
 14368         GO TO 7700-RETR-RECORD-NOT-FOUND,
 14369               7700-DUPLICATE-CLAIM
 14370         DEPENDING ON DFHEIGDI
 14371     ELSE IF DFHEIGDJ EQUAL 29
 14372         GO TO 8300-SEND-TEXT
 14373         DEPENDING ON DFHEIGDI.
 14374     MOVE '9%                    "   ' TO DFHEIV0
 14375     MOVE 'EL150' TO DFHEIV1
 14376     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 14377     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14208     Code:       38543
