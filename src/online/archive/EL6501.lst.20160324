* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   1
* EL6501.cbl
* Options: int("EL6501.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6501.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6501.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6501.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6501.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/11/94 14:25:07.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.060.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   2
* EL6501.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC5 - ACCOUNT MAINT (GENERAL)
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    36*                                ADJUSTED MAP-R REDEFINES FILLER
    37* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    38*                          SMVA  ADD CLP TOL PCT CODE
    39* 102004                   PEMA  ADD STATUS OF CANCEL
    40* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    41* 021506  CR2006021400002  PEMA  DARKEN DCC FIELDS FOR CID
    42* 052306  CR2006050800002  PEMA  ADD COMM TYPE J
    43* 111606  CR2002061800017  PEMA  FIX ERCOMP UPDATE ROUTINE
    44* 110706  CR2006071700002  PEMA  FIX NAME LOOK UP
    45* 031607                   PEMA  PER TRWA AND KLSC DEFAULT TO P
    46* 062707  CR2007010300002  PEMA  REMOVE LEV 5 RESTRICTION FOR DCC
    47* 071207                   PEMA  ADD NEW TYPE 'M'
    48* 080807  CR2006062900001  PEMA  AUTOMATE STEPS TO CANCEL ACCT
    49* 022808  CR2007083100002  PEMA  ADD 'F' ACCT STATUS
    50* 042809    2007070200004  PEMA  ADD EDIT FOR KY ACCOUNTS
    51* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    52* 020210  CR2020010400006  PEMA  REMOVE CHANGES MADE ON 09/09
    53* 031811  CR2011012700001  PEMA  ADD 'S' ACCT STATUS
    54* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    55* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    56* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    57* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    58* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    59* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    60******************************************************************
    61
    62 ENVIRONMENT DIVISION.
    63 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   3
* EL6501.cbl
    65 WORKING-STORAGE SECTION.
    66 01  DFH-START PIC X(04).
    67 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    68 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    69                                   USAGE POINTER.
    70 77  FILLER  PIC X(32)  VALUE '********************************'.
    71 77  FILLER  PIC X(32)  VALUE '*    EL6501 WORKING STORAGE    *'.
    72 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.060 ***********'.
    73 77  WS-LAST-DATE-RANGE-SW       PIC X    VALUE SPACES.
    74     88  ON-LAST-DATE-RANGE             VALUE 'Y'.
    75 77  WS-AUTO-CANCEL-SW           PIC X  VALUE ' '.
    76     88  AUTO-CANCEL-ACCOUNT            VALUE 'Y'.
    77 77  WS-DELAY-INT                PIC S9(7) VALUE +2.
    78 77  WS-CHANGE-ALL-CNT           PIC S999  VALUE +0.
    79 01  WS-DEGUG-AREA.
    80     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    81     05  FILLER PIC X(20) VALUE '  PAGE NUMBER HERE  '.
    82     05  WS-PAGE-NUMBER PIC 99 VALUE ZEROS.
    83     05  FILLER PIC X(20) VALUE '  TOTAL LINES HERE  '.
    84     05  WS-TOTAL-LINES PIC 99 VALUE ZEROS.
    85     05  FILLER PIC X(20) VALUE ' LINE SELECTED HERE '.
    86     05  WS-LINE-SELECTED PIC 99 VALUE ZEROS.
    87     05  FILLER PIC X(20) VALUE '&&&&&& DEBUG &&&&&&&'.
    88 01  S1                          PIC S999   VALUE +0    COMP.
    89 01  WS-WORK-FIELD.
    90     12  WS-WORK-NUM                 PIC 9(5)    VALUE ZEROS.
    91 01  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1500.
    92 01  WS-DATE-AREA.
    93     12  SAVE-DATE               PIC X(8)    VALUE SPACES.
    94     12  SAVE-BIN-DATE           PIC XX      VALUE SPACES.
    95
    96***DMD CUSTOM CODE *****START
    97     12  WS-DMD-EXPR-DATE        PIC 9(8) COMP-3.
    98     12  WS-DMD-AGENT            PIC X(10).
    99     12  WS-YYYYMMDD             PIC X(8).
   100     12  WS-COMP-DATE REDEFINES WS-YYYYMMDD
   101                                 PIC 9(8).
   102***DMD CUSTOM CODE *****END
   103
   104 01  WS-ACCOUNT-NUM-AREA.
   105     12  WS-ACCOUNT-FILLER       PIC X(06).
   106     12  WS-ACCT-BRANCH-CD       PIC X(04).
   107
   108 01  WS-NAME-AREA.
   109     12  WS-NAME-1-4             PIC X(04).
   110     12  WS-NAME-FILLER          PIC X(26).
   111
   112 01  STANDARD-AREAS.
   113     12  WS-STATE-MAX-SW         PIC X       VALUE ' '.
   114         88  EXCEEDS-STATE-MAX      VALUE 'Y'.
   115     12  WS-RESPONSE             PIC S9(8)   COMP.
   116         88  RESP-NORMAL                  VALUE +00.
   117         88  RESP-NOTFND                  VALUE +13.
   118         88  RESP-DUPREC                  VALUE +14.
   119         88  RESP-DUPKEY                  VALUE +15.
   120         88  RESP-NOTOPEN                 VALUE +19.
   121         88  RESP-ENDFILE                 VALUE +20.
   122
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   4
* EL6501.cbl
   123     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   124     12  MAP-NAME                PIC X(8)    VALUE 'EL6501A'.
   125     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6501S'.
   126     12  SCREEN-NUMBER           PIC X(4)    VALUE '650B'.
   127     12  TRANS-ID                PIC X(4)    VALUE 'EXC5'.
   128     12  THIS-PGM                PIC X(8)    VALUE 'EL6501'.
   129     12  PGM-NAME                PIC X(8).
   130     12  TIME-IN                 PIC S9(7).
   131     12  TIME-OUT-R REDEFINES TIME-IN.
   132         16  FILLER              PIC X.
   133         16  TIME-OUT            PIC 99V99.
   134         16  FILLER              PIC XX.
   135     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   136     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   137     12  XCTL-126                PIC X(8)    VALUE 'EL126'.
   138     12  XCTL-601                PIC X(8)    VALUE 'EL601'.
   139     12  XCTL-608                PIC X(8)    VALUE 'EL608'.
   140     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   141     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   142     12  XCTL-6502               PIC X(8)    VALUE 'EL6502'.
   143     12  XCTL-6503               PIC X(8)    VALUE 'EL6503'.
   144     12  XCTL-6504               PIC X(8)    VALUE 'EL6504'.
   145     12  XCTL-6505               PIC X(8)    VALUE 'EL6505'.
   146     12  XCTL-6506               PIC X(8)    VALUE 'EL6506'.
   147     12  XCTL-652                PIC X(8)    VALUE 'EL652'.
   148     12  XCTL-689                PIC X(8)    VALUE 'EL689'.
   149     12  XCTL-690                PIC X(8)    VALUE 'EL690'.
   150     12  XCTL-653                PIC X(8)    VALUE 'EL653'.
   151     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   152     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   153     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   154     12  FILE-ID                 PIC X(8).
   155     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   156     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   157     12  ERACNT-FILE-ID          PIC X(8)    VALUE 'ERACNT'.
   158     12  REIN-FILE-ID            PIC X(8)    VALUE 'ERREIN'.
   159     12  COMM-FILE-ID            PIC X(8)    VALUE 'ERCTBL'.
   160     12  COMP-FILE-ID            PIC X(8)    VALUE 'ERCOMP'.
   161     12  NAME-FILE-ID            PIC X(8)    VALUE 'ERNAME'.
   162     12  RQST-FILE-ID            PIC X(8)    VALUE 'ERRQST'.
   163     12  RQST3-FILE-ID           PIC X(8)    VALUE 'ERRQST3'.
   164     12  ERGXRF-FILE-ID          PIC X(8)    VALUE 'ERGXRF'.
   165     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   166     12  ERACNT-REC-LEN          PIC S9(4)   VALUE +120   COMP.
   167     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   168     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   169     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   170     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   171     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   172     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   173     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   174     12  CNTL-REC-LEN            PIC S9(4)   VALUE +750   COMP.
   175     12  JRNL-REC-LEN            PIC S9(4)   VALUE ZERO   COMP.
   176*                                copy ERCGXRF.
   177******************************************************************
   178*                                                                *
   179*                                                                *
   180*                            ERCGXRF                             *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   5
* EL6501.cbl
   181*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   182*                            VMOD=2.002                          *
   183*                                                                *
   184*   ONLINE CREDIT SYSTEM                                         *
   185*                                                                *
   186*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   187*                                                                *
   188*   FILE TYPE = VSAM,KSDS                                        *
   189*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   190*                                                                *
   191*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   192*       ALTERNATE PATH = NONE                                    *
   193*                                                                *
   194*   LOG = NO                                                     *
   195*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   196*                                                                *
   197******************************************************************
   198
   199 01  AGENT-CROSS-REFERENCE.
   200     12  GX-RECORD-ID                PIC XX.
   201         88  VALID-GX-ID             VALUE 'GX'.
   202
   203     12  GX-CONTROL-PRIMARY.
   204         16  GX-COMPANY-CD           PIC X.
   205         16  GX-CARRIER              PIC X.
   206         16  GX-GROUPING             PIC X(6).
   207         16  GX-AGENT-NO             PIC X(10).
   208
   209     12  GX-MAINT-INFORMATION.
   210         16  GX-LAST-MAINT-DT        PIC XX.
   211         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   212         16  GX-LAST-MAINT-USER      PIC X(4).
   213         16  FILLER                  PIC X(9).
   214
   215     12  FILLER                      PIC X(37).
   216
   217     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   218
   219     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   220                            DEPENDING ON GX-AGENT-POINTER-CNT.
   221         16  GX-AM-CARRIER           PIC X.
   222         16  GX-AM-GROUPING          PIC X(6).
   223         16  GX-AM-STATE             PIC XX.
   224         16  GX-AM-ACCOUNT           PIC X(10).
   225         16  GX-AM-EXPIRATION-DT     PIC XX.
   226         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   227         16  GX-LAST-BILL-DT         PIC XX.
   228         16  GX-AM-EFF-DT            PIC XX.
   229         16  FILLER                  PIC X(4).
   230
   231******************************************************************
   232 01  ERPDEF-KEY-SAVE             PIC X(18).
   233 01  ERPDEF-KEY.
   234     12  ERPDEF-COMPANY-CD       PIC X.
   235     12  ERPDEF-STATE            PIC XX.
   236     12  ERPDEF-PROD-CD          PIC XXX.
   237     12  F                       PIC X(7).
   238     12  ERPDEF-BEN-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   6
* EL6501.cbl
   239     12  ERPDEF-BEN-CODE         PIC XX.
   240     12  ERPDEF-EXP-DT           PIC XX.
   241 01  WORK-AREAS-AND-SWITCHES.
   242     12  ws-comp-cd-dis          pic s9(4) comp value +0.
   243     12  filler redefines ws-comp-cd-dis.
   244         16  filler              pic x.
   245         16  ws-comp-cd          pic x.
   246     12  W-ONE                   PIC S9(04)  COMP   VALUE +1.
   247     12  WS-TABLE-MAX            PIC S9V9(4) COMP-3 VALUE +0.
   248     12  WS-ST-COMMISSION-CAPS.
   249         16  WS-ST-COMM-CAP-SL   PIC S9V9(4) COMP-3 VALUE +0.
   250         16  WS-ST-COMM-CAP-JL   PIC S9V9(4) COMP-3 VALUE +0.
   251         16  WS-ST-COMM-CAP-SA   PIC S9V9(4) COMP-3 VALUE +0.
   252         16  WS-ST-COMM-CAP-JA   PIC S9V9(4) COMP-3 VALUE +0.
   253     12  WS-DCC-MAX-MARKET-FEE   PIC S9(5)   COMP-3 VALUE +100.
   254     12  WS-COMM-CAP-LIMIT-TO    PIC X.
   255         88  WS-LIMIT-TO-ACCOUNT             VALUE 'A'.
   256
   257     12  COMMISSION-ACCUMS.
   258         16  COMM-SL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   259         16  COMM-JL-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   260         16  COMM-AH-ACCUM       PIC S9V9(4) COMP-3 VALUE ZERO.
   261         16  COMM-MFEE-ACCUM     PIC S9(5)   COMP-3 VALUE ZERO.
   262
   263     12  SAVE-FIN-RESP           PIC X(10)   VALUE SPACES.
   264     12  SAVE-ACCT-AGENT         PIC X(10)   VALUE SPACES.
   265     12  SAVE-NEW-ACCT-AGENT     PIC X(10)   VALUE SPACES.
   266     12  SUB1                    PIC S9(4)   VALUE +0 COMP.
   267     12  WS-NDX                  PIC S9(5)   VALUE +0 COMP-3.
   268     12  CURRENT-SAVE            PIC 9(8).
   269     12  BIN-CURRENT-SAVE        PIC XX.
   270     12  CYMD-CURRENT-SAVE       PIC 9(8).
   271     12  SUB                     PIC 99.
   272     12  AGT-SUB                 PIC 99      VALUE ZEROS.
   273     12  VALID-AGT-SW            PIC X       VALUE 'N'.
   274     12  CHANGE-WAS-MADE-SW      PIC X       VALUE 'N'.
   275         88  CHANGE-WAS-MADE                 VALUE 'Y'.
   276
   277     12  WS-EDIT-BEN-CODE        PIC XX.
   278         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   279                                          '90' THRU '99'.
   280
   281     12  WS-KEY-SAVE.
   282           18  WS-ACCT-CCGSA-KEY.
   283             20  WS-ACCT-CO             PIC X.
   284             20  WS-ACCT-CARRIER        PIC X.
   285             20  WS-ACCT-GROUPING       PIC X(6).
   286             20  WS-ACCT-STATE          PIC XX.
   287             20  WS-ACCT-ACCOUNT        PIC X(10).
   288           18  WS-ACCT-EXP-DT           PIC XX.
   289           18  WS-ACCT-REST-OF-EXP      PIC X(4).
   290
   291     12  DEEDIT-FIELD                   PIC X(15).
   292     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   293     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(14)V9.
   294     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
   295     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD   PIC S9(10)V9(5).
   296     12  DEEDIT-FIELD-V6 REDEFINES DEEDIT-FIELD   PIC S9(9)V9(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   7
* EL6501.cbl
   297
   298     12  ELCNTL-KEY.
   299         16  CNTL-COMP-ID        PIC XXX.
   300         16  CNTL-REC-TYPE       PIC X.
   301         16  CNTL-ACCESS.
   302             20  FILLER          PIC X(4).
   303         16  CNTL-BUS REDEFINES CNTL-ACCESS.
   304             20  FILLER          PIC XX.
   305             20  CNTL-BUS-TYPE   PIC XX.
   306         16  CNTL-BEN REDEFINES CNTL-ACCESS.
   307             20  FILLER          PIC XX.
   308             20  CNTL-BEN-TYPE   PIC XX.
   309         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   310
   311     12  REIN-KEY.
   312         16  REIN-COMP-CD        PIC X.
   313         16  REIN-CODE           PIC X.
   314         16  REIN-TABLE          PIC X(3).
   315         16  FILLER              PIC X(3).
   316
   317     12  WS-HOLD-COMM-KEY        PIC X(7) VALUE LOW-VALUES.
   318     12  COMM-KEY.
   319         16  COMM-COMP-CD        PIC X.
   320         16  COMM-TABLE          PIC XXX.
   321         16  COMM-LF-AH          PIC X.
   322         16  COMM-FILLER         PIC XX    VALUE LOW-VALUES.
   323
   324     12  RQST-KEY.
   325         16  RQST-COMPANY-CD     PIC X     VALUE SPACES.
   326         16  RQST-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   327
   328     12  RQST3-KEY.
   329         16  RQST3-COMPANY-CD    PIC X     VALUE SPACES.
   330         16  RQST3-CARRIER       PIC X     VALUE SPACES.
   331         16  RQST3-GROUPING      PIC X(6)  VALUE SPACES.
   332         16  RQST3-FIN-RESP      PIC X(10) VALUE SPACES.
   333         16  RQST3-ACCT-AGENT    PIC X(10) VALUE SPACES.
   334         16  RQST3-REFERENCE     PIC X(12) VALUE SPACES.
   335         16  RQST3-BATCH         PIC X(6)  VALUE SPACES.
   336
   337     12  SAVE-RQST3-KEY.
   338         16  FILLER              PIC X     VALUE SPACES.
   339         16  FILLER              PIC X     VALUE SPACES.
   340         16  FILLER              PIC X(6)  VALUE SPACES.
   341         16  FILLER              PIC X(10) VALUE SPACES.
   342         16  FILLER              PIC X(10) VALUE SPACES.
   343         16  FILLER              PIC X(12) VALUE SPACES.
   344         16  FILLER              PIC X(6)  VALUE SPACES.
   345
   346     12  COMP-KEY.
   347         16  COMP-COMPANY-CD     PIC X.
   348         16  COMP-CARRIER        PIC X.
   349         16  COMP-GROUPING       PIC X(6).
   350         16  COMP-RESP-NO        PIC X(10).
   351         16  COMP-ACCOUNT        PIC X(10).
   352         16  COMP-TYPE           PIC X.
   353
   354     12  WS-AXRF-KEY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   8
* EL6501.cbl
   355         16  WS-AXRF-COMPANY-CD  PIC X.
   356         16  WS-AXRF-CARRIER     PIC X.
   357         16  WS-AXRF-GROUPING    PIC X(6).
   358         16  WS-AXRF-AGENT-NO    PIC X(10).
   359
   360     12  GX-AM-CONTROL-PRIMARY.
   361         16  GX-AM-COMPANY-CD    PIC X.
   362         16  GX-REST-OF-KEY      PIC X(20).
   363
   364     12  QID.
   365         16  QID-TERM            PIC X(4).
   366         16  FILLER              PIC X(4)    VALUE '6501'.
   367
   368     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   369         88  BROWSE-STARTED         VALUE 'Y'.
   370     12  FIRST-TIME-SW           PIC X       VALUE ' '.
   371         88  FIRST-TIME             VALUE 'Y'.
   372
   373     12  AXRF-SUB                PIC S9(4)  COMP VALUE ZEROS.
   374     12  GX-AGENT-SUB            PIC S9(4)  COMP VALUE ZEROS.
   375     12  COMM-WORK-SUB           PIC S9(4)  COMP VALUE ZEROS.
   376     12  FIND-AGENT-SUB1         PIC S9(4)  COMP VALUE ZEROS.
   377     12  FIND-AGENT-SUB2         PIC S9(4)  COMP VALUE ZEROS.
   378     12  FIND-AGENT-SUB3         PIC S9(4)  COMP VALUE ZEROS.
   379     12  GETMAIN-SW              PIC X       VALUE SPACES.
   380     12  COMMISSION-GETMAIN-SW   PIC X       VALUE SPACES.
   381         88  GETMAIN-ACQUIRED                VALUE 'X'.
   382
   383     12  ER-0000                 PIC X(4)    VALUE '0000'.
   384     12  ER-0002                 PIC X(4)    VALUE '0002'.
   385     12  ER-0004                 PIC X(4)    VALUE '0004'.
   386     12  ER-0008                 PIC X(4)    VALUE '0008'.
   387     12  ER-0023                 PIC X(4)    VALUE '0023'.
   388     12  ER-0029                 PIC X(4)    VALUE '0029'.
   389     12  ER-0033                 PIC X(4)    VALUE '0033'.
   390     12  ER-0144                 PIC X(4)    VALUE '0144'.
   391     12  ER-0070                 PIC X(4)    VALUE '0070'.
   392     12  ER-0250                 PIC X(4)    VALUE '0250'.
   393     12  ER-0348                 PIC X(4)    VALUE '0348'.
   394     12  ER-0454                 PIC X(4)    VALUE '0454'.
   395     12  ER-0625                 PIC X(4)    VALUE '0625'.
   396     12  ER-0759                 PIC X(4)    VALUE '0759'.
   397     12  ER-0788                 PIC X(4)    VALUE '0788'.
   398     12  ER-0852                 PIC X(4)    VALUE '0852'.
   399     12  ER-0899                 PIC X(4)    VALUE '0899'.
   400     12  ER-1778                 PIC X(4)    VALUE '1778'.
   401     12  ER-1817                 PIC X(4)    VALUE '1817'.
   402     12  ER-1883                 PIC X(4)    VALUE '1883'.
   403     12  ER-1884                 PIC X(4)    VALUE '1884'.
   404     12  ER-1885                 PIC X(4)    VALUE '1885'.
   405     12  ER-1886                 PIC X(4)    VALUE '1886'.
   406     12  ER-1887                 PIC X(4)    VALUE '1887'.
   407     12  ER-2045                 PIC X(4)    VALUE '2045'.
   408     12  ER-2071                 PIC X(4)    VALUE '2071'.
   409     12  ER-2131                 PIC X(4)    VALUE '2131'.
   410*    12  ER-3057                 PIC X(4)    VALUE '3057'.
   411     12  ER-2151                 PIC X(4)    VALUE '2151'.
   412     12  ER-2152                 PIC X(4)    VALUE '2152'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page   9
* EL6501.cbl
   413     12  ER-2153                 PIC X(4)    VALUE '2153'.
   414     12  ER-2154                 PIC X(4)    VALUE '2154'.
   415     12  ER-2155                 PIC X(4)    VALUE '2155'.
   416     12  ER-2156                 PIC X(4)    VALUE '2156'.
   417     12  ER-2157                 PIC X(4)    VALUE '2157'.
   418     12  ER-2158                 PIC X(4)    VALUE '2158'.
   419     12  ER-2159                 PIC X(4)    VALUE '2159'.
   420     12  ER-2160                 PIC X(4)    VALUE '2160'.
   421     12  ER-2165                 PIC X(4)    VALUE '2165'.
   422     12  ER-2168                 PIC X(4)    VALUE '2168'.
   423     12  ER-2169                 PIC X(4)    VALUE '2169'.
   424     12  ER-2170                 PIC X(4)    VALUE '2170'.
   425     12  ER-2172                 PIC X(4)    VALUE '2172'.
   426     12  ER-2173                 PIC X(4)    VALUE '2173'.
   427     12  ER-2174                 PIC X(4)    VALUE '2174'.
   428     12  ER-2175                 PIC X(4)    VALUE '2175'.
   429     12  ER-2176                 PIC X(4)    VALUE '2176'.
   430     12  ER-2177                 PIC X(4)    VALUE '2177'.
   431     12  ER-2178                 PIC X(4)    VALUE '2178'.
   432     12  ER-2179                 PIC X(4)    VALUE '2179'.
   433     12  ER-2180                 PIC X(4)    VALUE '2180'.
   434     12  ER-2181                 PIC X(4)    VALUE '2181'.
   435     12  ER-2182                 PIC X(4)    VALUE '2182'.
   436     12  ER-2183                 PIC X(4)    VALUE '2183'.
   437     12  ER-2189                 PIC X(4)    VALUE '2189'.
   438     12  ER-2572                 PIC X(4)    VALUE '2572'.
   439     12  ER-2615                 PIC X(4)    VALUE '2615'.
   440     12  ER-2949                 PIC X(4)    VALUE '2949'.
   441     12  ER-2970                 PIC X(4)    VALUE '2970'.
   442     12  ER-4009                 PIC X(4)    VALUE '4009'.
   443     12  ER-4010                 PIC X(4)    VALUE '4010'.
   444     12  ER-4011                 PIC X(4)    VALUE '4011'.
   445     12  ER-4012                 PIC X(4)    VALUE '4012'.
   446     12  ER-7717                 PIC X(4)    VALUE '7717'.
   447     12  er-8156                 pic x(4)    value '8156'.
   448     12  ER-9999                 PIC X(4)    VALUE '9999'.
   449     12  ER-XXXX                 PIC X(4)    VALUE 'XXXX'.
   450
   451     12  WSS-LINE-LIAB-LIMITS.
   452         16  WSS-LF-LIMITS.
   453             20  WSS-L-TYPE          PIC  XX    VALUE SPACES.
   454             20  WSS-LF-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   455             20  WSS-L-LIMITS        OCCURS 4 TIMES.
   456                 24  WSS-LF-LM-AGE   PIC S99     COMP-3.
   457                 24  WSS-LF-LM-DUR   PIC S999    COMP-3.
   458                 24  WSS-LF-LM-AMT   PIC S9(6)   COMP-3.
   459         16  WSS-AH-LIMITS.
   460             20  WSS-A-TYPE          PIC  XX    VALUE SPACES.
   461             20  WSS-AH-ATT-AGE      PIC S99    VALUE +0 COMP-3.
   462             20  WSS-A-LIMITS        OCCURS 4 TIMES.
   463                 24  WSS-AH-LM-AGE   PIC S99     COMP-3.
   464                 24  WSS-AH-LM-DUR   PIC S999    COMP-3.
   465                 24  WSS-AH-LM-MOA   PIC S9(4)   COMP-3.
   466                 24  WSS-AH-LM-AMT   PIC S9(6)   COMP-3.
   467
   468     12  WSS-COMM-STRUCTURE.
   469         16  WSS-DEFN-1.
   470             20  WSS-AGT-COMMS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  10
* EL6501.cbl
   471                 24  WSS-AGT     PIC  X(10)   VALUE SPACES.
   472                 24  WSS-COM-TYP PIC  X       VALUE SPACES.
   473                 24  WSS-L-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   474                 24  WSS-J-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   475                 24  WSS-A-COM   PIC SV9(5)   VALUE ZEROS COMP-3.
   476                 24  FILLER      PIC X(6)     VALUE SPACES.
   477
   478     12  WS-PHONE.
   479         16  WS-PH1              PIC XXX.
   480         16  WS-PH2              PIC XXX.
   481         16  WS-PH3              PIC XXXX.
   482     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   483
   484     12  WS-LIFE-PSI             PIC S9V9(6)  VALUE +0    COMP-3.
   485     12  WS-AH-PSI               PIC S9V9(6)  VALUE +0    COMP-3.
   486     12  WS-ACCOUNT-CTR-C        PIC 99       VALUE ZEROS COMP-3.
   487     12  WS-ACCOUNT-CTR-R        PIC 99       VALUE ZEROS COMP-3.
   488     12  WS-ACCOUNT-CTR-D        PIC 99       VALUE ZEROS COMP-3.
   489     12  WS-BUS-TYPE             PIC 99.
   490     12  WS-BUS-ENTRY            PIC 99.
   491     12  WS-ANVR-DT              PIC 9(11)    VALUE ZEROS.
   492     12  WS-PEFF-DT              PIC 9(11)    VALUE ZEROS.
   493     12  WS-PEXP-DT              PIC 9(11)    VALUE ZEROS.
   494     12  WS-TOL-PREM             PIC S999V99  VALUE ZEROS.
   495     12  WS-TOL-REF              PIC S999V99  VALUE ZEROS.
   496     12  WS-TOL-CLM              PIC S999V99  VALUE ZEROS.
   497     12  WS-COMM-ERROR-SW        PIC 9   COMP-3.
   498         88  COMMISSION-ERROR    VALUE 1.
   499     12  WS-JTYPEID              PIC XX       VALUE SPACES.
   500     12  AGENT-FIND              PIC X        VALUE SPACES.
   501         88  AGENT-RECORD-NOT-FOUND           VALUE 'X'.
   502         88  ACCT-RECORD-NOT-FOUND            VALUE 'Y'.
   503         88  ACCT-LEVEL-DIFFERENT             VALUE 'Z'.
   504
   505     12  WS-ZIP-CODE.
   506         16  WS-ZIP-1            PIC X.
   507             88  WS-CANADIAN-ZIP    VALUE 'A' THRU 'Z'.
   508         16  WS-ZIP-2-3          PIC XX.
   509         16  WS-ZIP-4            PIC X.
   510         16  WS-ZIP-5            PIC X.
   511         16  WS-ZIP-6            PIC X.
   512         16  FILLER              PIC X(4).
   513     12  WS-ZIP-AM-1  REDEFINES  WS-ZIP-CODE.
   514         16  WS-ZIP-AM-1-CODE    PIC X(5).
   515         16  WS-ZIP-AM-1-PLUS4   PIC X(4).
   516         16  FILLER              PIC X.
   517     12  WS-ZIP-AM-2  REDEFINES  WS-ZIP-CODE.
   518         16  WS-ZIP-AM-2-CODE    PIC X(5).
   519         16  WS-ZIP-AM-2-DASH    PIC X.
   520         16  WS-ZIP-AM-2-PLUS4   PIC X(4).
   521     12  WS-ZIP-CAN-1  REDEFINES  WS-ZIP-CODE.
   522         16  WS-ZIP-CAN-1-POST1  PIC XXX.
   523         16  WS-ZIP-CAN-1-POST2  PIC XXX.
   524         16  FILLER              PIC X(4).
   525     12  WS-ZIP-CAN-2  REDEFINES  WS-ZIP-CODE.
   526         16  WS-ZIP-CAN-2-POST1  PIC XXX.
   527         16  FILLER              PIC X.
   528         16  WS-ZIP-CAN-2-POST2  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  11
* EL6501.cbl
   529         16  FILLER              PIC XXX.
   530     12  WS-SOC-SEC-WORK.
   531         16  WS-SS-TYPE          PIC X.
   532         16  WS-SOC-SEC          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  12
* EL6501.cbl
   534*    COPY ELCSCTM.
   535******************************************************************
   536*                                                                *
   537*                                                                *
   538*                            ELCSCTM                             *
   539*                            VMOD=2.001                          *
   540*                                                                *
   541*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   542*                                                                *
   543******************************************************************
   544 01  SECURITY-MESSAGE.
   545     12  FILLER                          PIC X(30)
   546            VALUE '** LOGIC SECURITY VIOLATION -'.
   547     12  SM-READ                         PIC X(6).
   548     12  FILLER                          PIC X(5)
   549            VALUE ' PGM='.
   550     12  SM-PGM                          PIC X(6).
   551     12  FILLER                          PIC X(5)
   552            VALUE ' OPR='.
   553     12  SM-PROCESSOR-ID                 PIC X(4).
   554     12  FILLER                          PIC X(6)
   555            VALUE ' TERM='.
   556     12  SM-TERMID                       PIC X(4).
   557     12  FILLER                          PIC XX   VALUE SPACE.
   558     12  SM-JUL-DATE                     PIC 9(5).
   559     12  FILLER                          PIC X    VALUE SPACE.
   560     12  SM-TIME                         PIC 99.99.
   561
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  13
* EL6501.cbl
   563*    COPY ELCSCRTY.
   564******************************************************************
   565*                                                                *
   566*                                                                *
   567*                            ELCSCRTY                            *
   568*                            VMOD=2.001                          *
   569*                                                                *
   570*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   571*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   572*        SAVED IN PI-SECURITY-ADDRESS.                           *
   573*                                                                *
   574******************************************************************
   575 01  SECURITY-CONTROL.
   576     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   577     12  FILLER                       PIC XX    VALUE 'SC'.
   578     12  SC-CREDIT-CODES.
   579         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   580             20  SC-CREDIT-DISPLAY    PIC X.
   581             20  SC-CREDIT-UPDATE     PIC X.
   582     12  SC-CLAIMS-CODES.
   583         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   584             20  SC-CLAIMS-DISPLAY    PIC X.
   585             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  14
* EL6501.cbl
   587*    COPY ELCLOGOF.
   588******************************************************************
   589*                                                                *
   590*                                                                *
   591*                            ELCLOGOF.                           *
   592*                            VMOD=2.001                          *
   593*                                                                *
   594*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   595*                                                                *
   596******************************************************************
   597 01  CLASIC-LOGOFF.
   598     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   599     12  LOGOFF-TEXT.
   600         16  FILLER          PIC X(5)    VALUE SPACES.
   601         16  LOGOFF-MSG.
   602             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   603             20  FILLER      PIC X       VALUE SPACES.
   604             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   605         16  FILLER          PIC X(80)
   606           VALUE '* YOU ARE NOW LOGGED OFF'.
   607         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   608         16  FILLER          PIC X       VALUE QUOTE.
   609         16  LOGOFF-SYS-MSG  PIC X(17)
   610           VALUE 'S CLAS-IC SYSTEM '.
   611     12  TEXT-MESSAGES.
   612         16  UNACCESS-MSG    PIC X(29)
   613             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   614         16  PGMIDERR-MSG    PIC X(17)
   615             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  15
* EL6501.cbl
   617*    COPY ELCDATE.
   618******************************************************************
   619*                                                                *
   620*                                                                *
   621*                            ELCDATE.                            *
   622*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   623*                            VMOD=2.003
   624*                                                                *
   625*                                                                *
   626*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   627*                 LENGTH = 200                                   *
   628******************************************************************
   629
   630 01  DATE-CONVERSION-DATA.
   631     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   632     12  DC-OPTION-CODE                PIC X.
   633         88  BIN-TO-GREG                VALUE ' '.
   634         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   635         88  EDIT-GREG-TO-BIN           VALUE '2'.
   636         88  YMD-GREG-TO-BIN            VALUE '3'.
   637         88  MDY-GREG-TO-BIN            VALUE '4'.
   638         88  JULIAN-TO-BIN              VALUE '5'.
   639         88  BIN-PLUS-ELAPSED           VALUE '6'.
   640         88  FIND-CENTURY               VALUE '7'.
   641         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   642         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   643         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   644         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   645         88  JULIAN-TO-BIN-3            VALUE 'C'.
   646         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   647         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   648         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   649         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   650         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   651         88  CHECK-LEAP-YEAR            VALUE 'H'.
   652         88  BIN-3-TO-GREG              VALUE 'I'.
   653         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   654         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   655         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   656         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   657         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   658         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   659         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   660         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   661         88  THREE-CHARACTER-BIN
   662                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   663         88  GREGORIAN-TO-BIN
   664                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   665         88  BIN-TO-GREGORIAN
   666                  VALUES ' ' '1' 'I' '8' 'G'.
   667         88  JULIAN-TO-BINARY
   668                  VALUES '5' 'C' 'E' 'F'.
   669     12  DC-ERROR-CODE                 PIC X.
   670         88  NO-CONVERSION-ERROR        VALUE ' '.
   671         88  DATE-CONVERSION-ERROR
   672                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   673         88  DATE-IS-ZERO               VALUE '1'.
   674         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  16
* EL6501.cbl
   675         88  DATE-IS-INVALID            VALUE '3'.
   676         88  DATE1-GREATER-DATE2        VALUE '4'.
   677         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   678         88  DATE-INVALID-OPTION        VALUE '9'.
   679         88  INVALID-CENTURY            VALUE 'A'.
   680         88  ONLY-CENTURY               VALUE 'B'.
   681         88  ONLY-LEAP-YEAR             VALUE 'C'.
   682         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   683     12  DC-END-OF-MONTH               PIC X.
   684         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   685     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   686         88  USE-NORMAL-PROCESS         VALUE ' '.
   687         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   688         88  ADJUST-UP-100-YRS          VALUE '2'.
   689     12  FILLER                        PIC X.
   690     12  DC-CONVERSION-DATES.
   691         16  DC-BIN-DATE-1             PIC XX.
   692         16  DC-BIN-DATE-2             PIC XX.
   693         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   694         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   695                       DC-GREG-DATE-1-EDIT.
   696             20  DC-EDIT1-MONTH        PIC 99.
   697             20  SLASH1-1              PIC X.
   698             20  DC-EDIT1-DAY          PIC 99.
   699             20  SLASH1-2              PIC X.
   700             20  DC-EDIT1-YEAR         PIC 99.
   701         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   702         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   703                     DC-GREG-DATE-2-EDIT.
   704             20  DC-EDIT2-MONTH        PIC 99.
   705             20  SLASH2-1              PIC X.
   706             20  DC-EDIT2-DAY          PIC 99.
   707             20  SLASH2-2              PIC X.
   708             20  DC-EDIT2-YEAR         PIC 99.
   709         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   710         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   711                     DC-GREG-DATE-1-YMD.
   712             20  DC-YMD-YEAR           PIC 99.
   713             20  DC-YMD-MONTH          PIC 99.
   714             20  DC-YMD-DAY            PIC 99.
   715         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   716         16  DC-GREG-DATE-1-MDY-R REDEFINES
   717                      DC-GREG-DATE-1-MDY.
   718             20  DC-MDY-MONTH          PIC 99.
   719             20  DC-MDY-DAY            PIC 99.
   720             20  DC-MDY-YEAR           PIC 99.
   721         16  DC-GREG-DATE-1-ALPHA.
   722             20  DC-ALPHA-MONTH        PIC X(10).
   723             20  DC-ALPHA-DAY          PIC 99.
   724             20  FILLER                PIC XX.
   725             20  DC-ALPHA-CENTURY.
   726                 24 DC-ALPHA-CEN-N     PIC 99.
   727             20  DC-ALPHA-YEAR         PIC 99.
   728         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   729         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   730         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   731         16  DC-JULIAN-DATE            PIC 9(05).
   732         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  17
* EL6501.cbl
   733                                       PIC 9(05).
   734         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   735             20  DC-JULIAN-YEAR        PIC 99.
   736             20  DC-JULIAN-DAYS        PIC 999.
   737         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   738         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   739         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   740     12  DATE-CONVERSION-VARIBLES.
   741         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   742         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   743             20  FILLER                PIC 9(3).
   744             20  HOLD-CEN-1-CCYY.
   745                 24  HOLD-CEN-1-CC     PIC 99.
   746                 24  HOLD-CEN-1-YY     PIC 99.
   747             20  HOLD-CEN-1-MO         PIC 99.
   748             20  HOLD-CEN-1-DA         PIC 99.
   749         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   750             20  HOLD-CEN-1-R-MO       PIC 99.
   751             20  HOLD-CEN-1-R-DA       PIC 99.
   752             20  HOLD-CEN-1-R-CCYY.
   753                 24  HOLD-CEN-1-R-CC   PIC 99.
   754                 24  HOLD-CEN-1-R-YY   PIC 99.
   755             20  FILLER                PIC 9(3).
   756         16  HOLD-CENTURY-1-X.
   757             20  FILLER                PIC X(3)  VALUE SPACES.
   758             20  HOLD-CEN-1-X-CCYY.
   759                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   760                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   761             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   762             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   763         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   764             20  HOLD-CEN-1-R-X-MO     PIC XX.
   765             20  HOLD-CEN-1-R-X-DA     PIC XX.
   766             20  HOLD-CEN-1-R-X-CCYY.
   767                 24  HOLD-CEN-1-R-X-CC PIC XX.
   768                 24  HOLD-CEN-1-R-X-YY PIC XX.
   769             20  FILLER                PIC XXX.
   770         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   771         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   772         16  DC-JULIAN-DATE-1          PIC 9(07).
   773         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   774             20  DC-JULIAN-1-CCYY.
   775                 24  DC-JULIAN-1-CC    PIC 99.
   776                 24  DC-JULIAN-1-YR    PIC 99.
   777             20  DC-JULIAN-DA-1        PIC 999.
   778         16  DC-JULIAN-DATE-2          PIC 9(07).
   779         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   780             20  DC-JULIAN-2-CCYY.
   781                 24  DC-JULIAN-2-CC    PIC 99.
   782                 24  DC-JULIAN-2-YR    PIC 99.
   783             20  DC-JULIAN-DA-2        PIC 999.
   784         16  DC-GREG-DATE-A-EDIT.
   785             20  DC-EDITA-MONTH        PIC 99.
   786             20  SLASHA-1              PIC X VALUE '/'.
   787             20  DC-EDITA-DAY          PIC 99.
   788             20  SLASHA-2              PIC X VALUE '/'.
   789             20  DC-EDITA-CCYY.
   790                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  18
* EL6501.cbl
   791                 24  DC-EDITA-YEAR     PIC 99.
   792         16  DC-GREG-DATE-B-EDIT.
   793             20  DC-EDITB-MONTH        PIC 99.
   794             20  SLASHB-1              PIC X VALUE '/'.
   795             20  DC-EDITB-DAY          PIC 99.
   796             20  SLASHB-2              PIC X VALUE '/'.
   797             20  DC-EDITB-CCYY.
   798                 24  DC-EDITB-CENT     PIC 99.
   799                 24  DC-EDITB-YEAR     PIC 99.
   800         16  DC-GREG-DATE-CYMD         PIC 9(08).
   801         16  DC-GREG-DATE-CYMD-R REDEFINES
   802                              DC-GREG-DATE-CYMD.
   803             20  DC-CYMD-CEN           PIC 99.
   804             20  DC-CYMD-YEAR          PIC 99.
   805             20  DC-CYMD-MONTH         PIC 99.
   806             20  DC-CYMD-DAY           PIC 99.
   807         16  DC-GREG-DATE-MDCY         PIC 9(08).
   808         16  DC-GREG-DATE-MDCY-R REDEFINES
   809                              DC-GREG-DATE-MDCY.
   810             20  DC-MDCY-MONTH         PIC 99.
   811             20  DC-MDCY-DAY           PIC 99.
   812             20  DC-MDCY-CEN           PIC 99.
   813             20  DC-MDCY-YEAR          PIC 99.
   814    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   815        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   816    12  DC-EL310-DATE                  PIC X(21).
   817    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  19
* EL6501.cbl
   819*    COPY ELCATTR.
   820******************************************************************
   821*                                                                *
   822*                            ELCATTR.                            *
   823*                            VMOD=2.001                          *
   824*                                                                *
   825*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   826*                                                                *
   827*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   828*                                                                *
   829*                   POS 1   P=PROTECTED                          *
   830*                           U=UNPROTECTED                        *
   831*                           S=ASKIP                              *
   832*                   POS 2   A=ALPHA/NUMERIC                      *
   833*                           N=NUMERIC                            *
   834*                   POS 3   N=NORMAL                             *
   835*                           B=BRIGHT                             *
   836*                           D=DARK                               *
   837*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   838*                           OF=MODIFIED DATA TAG OFF             *
   839*                                                                *
   840*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   841******************************************************************
   842 01  ATTRIBUTE-LIST.
   843     12  AL-PABOF            PIC X       VALUE 'Y'.
   844     12  AL-PABON            PIC X       VALUE 'Z'.
   845     12  AL-PADOF            PIC X       VALUE '%'.
   846     12  AL-PADON            PIC X       VALUE '_'.
   847     12  AL-PANOF            PIC X       VALUE '-'.
   848     12  AL-PANON            PIC X       VALUE '/'.
   849     12  AL-SABOF            PIC X       VALUE '8'.
   850     12  AL-SABON            PIC X       VALUE '9'.
   851     12  AL-SADOF            PIC X       VALUE '@'.
   852     12  AL-SADON            PIC X       VALUE QUOTE.
   853     12  AL-SANOF            PIC X       VALUE '0'.
   854     12  AL-SANON            PIC X       VALUE '1'.
   855     12  AL-UABOF            PIC X       VALUE 'H'.
   856     12  AL-UABON            PIC X       VALUE 'I'.
   857     12  AL-UADOF            PIC X       VALUE '<'.
   858     12  AL-UADON            PIC X       VALUE '('.
   859     12  AL-UANOF            PIC X       VALUE ' '.
   860     12  AL-UANON            PIC X       VALUE 'A'.
   861     12  AL-UNBOF            PIC X       VALUE 'Q'.
   862     12  AL-UNBON            PIC X       VALUE 'R'.
   863     12  AL-UNDOF            PIC X       VALUE '*'.
   864     12  AL-UNDON            PIC X       VALUE ')'.
   865     12  AL-UNNOF            PIC X       VALUE '&'.
   866     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  20
* EL6501.cbl
   868*    COPY ELCEMIB.
   869******************************************************************
   870*                                                                *
   871*                                                                *
   872*                            ELCEMIB.                            *
   873*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   874*                            VMOD=2.005                          *
   875*                                                                *
   876*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   877*                                                                *
   878******************************************************************
   879 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   880     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   881     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   882     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   883     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   884     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   885     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   886     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   887     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   888     12  EMI-SWITCH1             PIC X        VALUE '1'.
   889         88  EMI-NO-ERRORS                    VALUE '1'.
   890         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   891         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   892     12  EMI-SWITCH2             PIC X        VALUE '1'.
   893         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   894     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   895         88  EMI-AREA1-EMPTY                  VALUE '1'.
   896         88  EMI-AREA1-FULL                   VALUE '2'.
   897     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   898         88  EMI-AREA2-EMPTY                  VALUE '1'.
   899         88  EMI-AREA2-FULL                   VALUE '2'.
   900     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   901         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   902         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   903         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   904         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   905         88  EMI-BYPASS-FATALS                VALUE 'X'.
   906     12  EMI-ERROR-LINES.
   907         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   908         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   909         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   910         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   911             20  EMI-ERR-CODES OCCURS 10 TIMES.
   912                 24  EMI-ERR-NUM         PIC X(4).
   913                 24  EMI-FILLER          PIC X.
   914                 24  EMI-SEV             PIC X.
   915                 24  FILLER              PIC X.
   916             20  FILLER                  PIC X(02).
   917     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   918         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   919             20  EMI-ERROR-NUMBER    PIC X(4).
   920             20  EMI-FILL            PIC X.
   921             20  EMI-SEVERITY        PIC X.
   922             20  FILLER              PIC X.
   923             20  EMI-ERROR-TEXT.
   924                 24  EMI-TEXT-VARIABLE   PIC X(10).
   925                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  21
* EL6501.cbl
   926     12  EMI-SEVERITY-SAVE           PIC X.
   927         88  EMI-NOTE                    VALUE 'N'.
   928         88  EMI-WARNING                 VALUE 'W'.
   929         88  EMI-FORCABLE                VALUE 'F'.
   930         88  EMI-FATAL                   VALUE 'X'.
   931     12  EMI-MESSAGE-FLAG            PIC X.
   932         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   933         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   934     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   935     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   936         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   937         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   938         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   939     12  emi-claim-no                pic x(7).
   940     12  emi-claim-type              pic x(6).
   941     12  FILLER                      PIC X(124)  VALUE SPACES.
   942     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   943     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   944     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   945     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  22
* EL6501.cbl
   947*    COPY ELCINTF.
   948******************************************************************
   949*                                                                *
   950*                                                                *
   951*                            ELCINTF.                            *
   952*                            VMOD=2.017                          *
   953*                                                                *
   954*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   955*                                                                *
   956*       LENGTH = 1024                                            *
   957*                                                                *
   958******************************************************************
   959*                   C H A N G E   L O G
   960*
   961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   962*-----------------------------------------------------------------
   963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   964* EFFECTIVE    NUMBER
   965*-----------------------------------------------------------------
   966* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   967******************************************************************
   968 01  PROGRAM-INTERFACE-BLOCK.
   969     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   970     12  PI-CALLING-PROGRAM              PIC X(8).
   971     12  PI-SAVED-PROGRAM-1              PIC X(8).
   972     12  PI-SAVED-PROGRAM-2              PIC X(8).
   973     12  PI-SAVED-PROGRAM-3              PIC X(8).
   974     12  PI-SAVED-PROGRAM-4              PIC X(8).
   975     12  PI-SAVED-PROGRAM-5              PIC X(8).
   976     12  PI-SAVED-PROGRAM-6              PIC X(8).
   977     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   978     12  PI-COMPANY-ID                   PIC XXX.
   979     12  PI-COMPANY-CD                   PIC X.
   980
   981     12  PI-COMPANY-PASSWORD             PIC X(8).
   982
   983     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   984
   985     12  PI-CONTROL-IN-PROGRESS.
   986         16  PI-CARRIER                  PIC X.
   987         16  PI-GROUPING                 PIC X(6).
   988         16  PI-STATE                    PIC XX.
   989         16  PI-ACCOUNT                  PIC X(10).
   990         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   991                                         PIC X(10).
   992         16  PI-CLAIM-CERT-GRP.
   993             20  PI-CLAIM-NO             PIC X(7).
   994             20  PI-CERT-NO.
   995                 25  PI-CERT-PRIME       PIC X(10).
   996                 25  PI-CERT-SFX         PIC X.
   997             20  PI-CERT-EFF-DT          PIC XX.
   998         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   999             20  PI-PLAN-CODE            PIC X(2).
  1000             20  PI-REVISION-NUMBER      PIC X(3).
  1001             20  PI-PLAN-EFF-DT          PIC X(2).
  1002             20  PI-PLAN-EXP-DT          PIC X(2).
  1003             20  FILLER                  PIC X(11).
  1004         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  23
* EL6501.cbl
  1005             20  PI-OE-REFERENCE-1.
  1006                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1007                 25  PI-OE-REF-1-SUFF    PIC XX.
  1008
  1009     12  PI-SESSION-IN-PROGRESS          PIC X.
  1010         88  CLAIM-SESSION                   VALUE '1'.
  1011         88  CREDIT-SESSION                  VALUE '2'.
  1012         88  WARRANTY-SESSION                VALUE '3'.
  1013         88  MORTGAGE-SESSION                VALUE '4'.
  1014         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1015
  1016
  1017*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1018
  1019     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1020     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1021
  1022     12  PI-CREDIT-USER                  PIC X.
  1023         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1024         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1025
  1026     12  PI-CLAIM-USER                   PIC X.
  1027         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1028         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1029
  1030     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1031         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1032         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1033         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1034         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1035         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1036
  1037     12  PI-PROCESSOR-ID                 PIC X(4).
  1038
  1039     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1040
  1041     12  PI-MEMBER-CAPTION               PIC X(10).
  1042
  1043     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1044         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1045
  1046     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1047     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1048     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1049     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1050
  1051     12  PI-AH-OVERRIDE-L1               PIC X.
  1052     12  PI-AH-OVERRIDE-L2               PIC XX.
  1053     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1054     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1055
  1056     12  PI-NEW-SYSTEM                   PIC X(2).
  1057
  1058     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1059     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1060         88  PI-USES-PAID-TO                 VALUE '1'.
  1061     12  PI-CRDTCRD-SYSTEM.
  1062         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  24
* EL6501.cbl
  1063             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1064             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1065         16  PI-CC-MONTH-END-DT          PIC XX.
  1066     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1067
  1068     12  PI-OE-REFERENCE-2.
  1069         16  PI-OE-REF-2-PRIME           PIC X(10).
  1070         16  PI-OE-REF-2-SUFF            PIC X.
  1071
  1072     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1073
  1074     12  PI-LANGUAGE-TYPE                PIC X.
  1075             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1076             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1077             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1078
  1079     12  PI-POLICY-LINKAGE-IND           PIC X.
  1080         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1081         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1082                                                   LOW-VALUES.
  1083
  1084     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1085     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1086         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1087         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1088
  1089     12  PI-PROCESSOR-CSR-IND            PIC X.
  1090         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1091         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1092
  1093     12  FILLER                          PIC X(3).
  1094
  1095     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1096
  1097     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1098         PI-SYSTEM-LEVEL.
  1099
  1100         16  PI-ENTRY-CODES.
  1101             20  PI-ENTRY-CD-1           PIC X.
  1102             20  PI-ENTRY-CD-2           PIC X.
  1103
  1104         16  PI-RETURN-CODES.
  1105             20  PI-RETURN-CD-1          PIC X.
  1106             20  PI-RETURN-CD-2          PIC X.
  1107
  1108         16  PI-UPDATE-STATUS-SAVE.
  1109             20  PI-UPDATE-BY            PIC X(4).
  1110             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1111
  1112         16  PI-LOWER-CASE-LETTERS       PIC X.
  1113             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1114
  1115*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1116*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1117*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1118
  1119         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1120             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  25
* EL6501.cbl
  1121             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1122             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1123             88  ACCNT-CNTL                  VALUE '3'.
  1124             88  CARR-ACCNT-CNTL             VALUE '4'.
  1125
  1126         16  PI-PROCESSOR-CAP-LIST.
  1127             20  PI-SYSTEM-CONTROLS.
  1128                24 PI-SYSTEM-DISPLAY     PIC X.
  1129                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1130                24 PI-SYSTEM-MODIFY      PIC X.
  1131                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1132             20  FILLER                  PIC XX.
  1133             20  PI-DISPLAY-CAP          PIC X.
  1134                 88  DISPLAY-CAP             VALUE 'Y'.
  1135             20  PI-MODIFY-CAP           PIC X.
  1136                 88  MODIFY-CAP              VALUE 'Y'.
  1137             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1138                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1139             20  PI-FORCE-CAP            PIC X.
  1140                 88  FORCE-CAP               VALUE 'Y'.
  1141
  1142         16  PI-PROGRAM-CONTROLS.
  1143             20  PI-PGM-PRINT-OPT        PIC X.
  1144             20  PI-PGM-FORMAT-OPT       PIC X.
  1145             20  PI-PGM-PROCESS-OPT      PIC X.
  1146             20  PI-PGM-TOTALS-OPT       PIC X.
  1147
  1148         16  PI-HELP-INTERFACE.
  1149             20  PI-LAST-ERROR-NO        PIC X(4).
  1150             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1151
  1152         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1153             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1154
  1155         16  PI-CR-CONTROL-IN-PROGRESS.
  1156             20  PI-CR-CARRIER           PIC X.
  1157             20  PI-CR-GROUPING          PIC X(6).
  1158             20  PI-CR-STATE             PIC XX.
  1159             20  PI-CR-ACCOUNT           PIC X(10).
  1160             20  PI-CR-FIN-RESP          PIC X(10).
  1161             20  PI-CR-TYPE              PIC X.
  1162
  1163         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1164
  1165         16  PI-CR-MONTH-END-DT          PIC XX.
  1166
  1167         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1168             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1169             88  PI-ZERO-CARRIER             VALUE '1'.
  1170             88  PI-ZERO-GROUPING            VALUE '2'.
  1171             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1172
  1173         16  PI-CARRIER-SECURITY         PIC X.
  1174             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1175
  1176         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1177             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1178             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  26
* EL6501.cbl
  1179
  1180         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1181             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1182                                         INDEXED BY PI-ACCESS-NDX
  1183                                         PIC X.
  1184
  1185         16  PI-GA-BILLING-CONTROL       PIC X.
  1186             88  PI-GA-BILLING               VALUE '1'.
  1187
  1188         16  PI-MAIL-PROCESSING          PIC X.
  1189             88  PI-MAIL-YES                 VALUE 'Y'.
  1190
  1191         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1192
  1193         16  PI-AR-SYSTEM.
  1194             20  PI-AR-PROCESSING-CNTL   PIC X.
  1195                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1196             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1197             20  PI-AR-MONTH-END-DT      PIC XX.
  1198
  1199         16  PI-MP-SYSTEM.
  1200             20  PI-MORTGAGE-USER            PIC X.
  1201                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1202                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1203             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1204                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1205                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1206                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1207                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1208                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1209             20  PI-MP-MONTH-END-DT          PIC XX.
  1210             20  PI-MP-REFERENCE-NO.
  1211                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1212                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1213
  1214         16  PI-LABEL-CONTROL            PIC X(01).
  1215             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1216             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1217
  1218         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1219             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1220
  1221         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1222             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1223             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1224
  1225         16  FILLER                      PIC X(14).
  1226
  1227     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1228******************************************************************
  1229*    COPY ELC650PI.
  1230******************************************************************
  1231*
  1232*                            ELC650PI.
  1233*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1234*                            VMOD=2.007
  1235*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1236*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  27
* EL6501.cbl
  1237* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1238*
  1239******************************************************************
  1240
  1241     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1242         16  PI-MAINT                   PIC X.
  1243         16  PI-PREV-ACCOUNT            PIC X(20).
  1244         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1245         16  PI-ACCT-KEY.
  1246             20  PI-ACCT-CCGSA-KEY.
  1247                 24  PI-ACCT-CO             PIC X.
  1248                 24  PI-ACCT-CARRIER        PIC X.
  1249                 24  PI-ACCT-GROUPING       PIC X(6).
  1250                 24  PI-ACCT-STATE          PIC XX.
  1251                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1252             20  PI-ACCT-EXP-DT           PIC XX.
  1253             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1254         16  PI-ACCT-ID                 PIC X(8).
  1255         16  PI-PLAN-KEY.
  1256             20  PI-PLAN-ACCT-KEY.
  1257                 24  PI-PLAN-COMPANY-CD PIC X.
  1258                 24  PI-PLAN-CARRIER    PIC X.
  1259                 24  PI-PLAN-GROUP      PIC X(6).
  1260                 24  PI-PLAN-STATE      PIC X(2).
  1261                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1262             20  PI-PLAN-BEN-TYPE       PIC X.
  1263             20  PI-PLAN-BEN            PIC XX.
  1264             20  PI-PLAN-REVISION       PIC X(3).
  1265         16  PI-WS-STATE                PIC XX.
  1266         16  PI-WS-CLASS                PIC XX.
  1267         16  PI-WS-DEV                  PIC X(3).
  1268         16  PI-WS-TYPE                 PIC X.
  1269         16  PI-WS-PLAN                 PIC XX.
  1270
  1271         16  PI-ERPNDB-ALT-KEY.
  1272             20  PI-PB-COMPANY-CD-A1    PIC X.
  1273             20  PI-PB-CARRIER          PIC X.
  1274             20  PI-PB-GROUPING         PIC X(6).
  1275             20  PI-PB-STATE            PIC XX.
  1276             20  PI-PB-ACCOUNT          PIC X(10).
  1277             20  PI-PB-CERT-EFF-DT      PIC XX.
  1278             20  PI-PB-CERT-NO          PIC X(10).
  1279             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1280             20  PI-PB-RECORD-TYPE      PIC X.
  1281
  1282         16  PI-DATE-RANGE-TABLE.
  1283             20  PI-TABLE-ENT OCCURS 32 TIMES
  1284                            INDEXED BY T-INDEX.
  1285                 24  PI-BIN-EFF-DT          PIC XX.
  1286                 24  PI-BIN-EXP-DT          PIC XX.
  1287                 24  PI-BIN-MAINT-DT        PIC XX.
  1288                 24  PI-BIN-LO-CERT         PIC XX.
  1289                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1290                 24  PI-BIN-HI-CERT         PIC XX.
  1291         16  PI-PAGE-NUMBER             PIC S9.
  1292             88  PI-FST-PAGE               VALUE +1.
  1293             88  PI-2ND-PAGE               VALUE +2.
  1294             88  PI-3RD-PAGE               VALUE +3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  28
* EL6501.cbl
  1295             88  PI-LST-PAGE               VALUE +4.
  1296         16  PI-TOTAL-LINES             PIC S99.
  1297         16  PI-LINE-SELECTED    PIC S9.
  1298***  Y2K PROJ 7744
  1299         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1300         16  BIN-EFFCHG-SAVE     PIC XX.
  1301         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1302***  Y2K PROJ 7744
  1303         16  BIN-EXPCHG-SAVE     PIC XX.
  1304         16  PI-RECORD-ADDED-SW  PIC X.
  1305             88  PI-RECORD-ADDED            VALUE '1'.
  1306             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1307         16  PI-ACCNAME          PIC X(30).
  1308         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1309         16  PI-SV-MAINT         PIC X.
  1310         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1311         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1312         16  PI-UPDATE-SW        PIC X.
  1313             88  PI-CHANGES-MADE             VALUE '1'.
  1314         16  PI-NOTE-TYPE        PIC X.
  1315             88  PI-ACCT-NOTE                VALUE '1'.
  1316         16  PI-DMD-FILE-SW      PIC X.
  1317             88  END-OF-FILE                 VALUE 'E'.
  1318             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1319             88  FIRST-OCCURS                VALUE 'F'.
  1320         16  PI-DMD-OCCURS       PIC S999.
  1321         16  PI-DMD-SCREEN       PIC X.
  1322             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1323             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1324             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1325         16  PI-NAMEFLG          PIC X.
  1326         16  PI-EL650-DEL-SW     PIC X.
  1327         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1328         16  PI-DCC-PROD-CODE    PIC XXX.
  1329         16  FILLER              PIC X(35).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  29
* EL6501.cbl
  1331
  1332*    COPY ELCJPFX.
  1333******************************************************************
  1334*                                                                *
  1335*                                                                *
  1336*                            ELCJPFX.                            *
  1337*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1338*                            VMOD=2.002                          *
  1339*                                                                *
  1340*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1341*                                                                *
  1342*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1343*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1344*        ELCNTL - CONTROL FILE                                   *
  1345*        ELMSTR - CLAIM MASTERS                                  *
  1346*        ELTRLR - ACTIVITY TRAILERS                              *
  1347*        ELCHKQ - CHECK QUE                                      *
  1348******************************************************************
  1349 01  JOURNAL-RECORD.
  1350     12  jp-date                     pic s9(5) comp-3.
  1351     12  jp-time                     pic s9(7) comp-3.
  1352     12  JP-USER-ID                  PIC X(4).
  1353     12  JP-FILE-ID                  PIC X(8).
  1354     12  JP-PROGRAM-ID               PIC X(8).
  1355     12  JP-RECORD-TYPE              PIC X.
  1356         88 JP-ADD              VALUE 'A'.
  1357         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1358         88 JP-AFTER-CHANGE     VALUE 'C'.
  1359         88 JP-DELETE           VALUE 'D'.
  1360         88 JP-GENERIC-DELETE   VALUE 'G'.
  1361         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1362         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1363     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1364     12  JP-RECORD-AREA
  1365
  1366
  1367         PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  30
* EL6501.cbl
  1369*    COPY ELCAID.
  1370******************************************************************
  1371*                                                                *
  1372*                            ELCAID.                             *
  1373*                            VMOD=2.001                          *
  1374*                                                                *
  1375*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1376*                                                                *
  1377*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1378*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1379******************************************************************
  1380
  1381 01  DFHAID.
  1382   02  DFHNULL   PIC  X  VALUE  ' '.
  1383   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1384   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1385   02  DFHPEN    PIC  X  VALUE  '='.
  1386   02  DFHOPID   PIC  X  VALUE  'W'.
  1387   02  DFHPA1    PIC  X  VALUE  '%'.
  1388   02  DFHPA2    PIC  X  VALUE  '>'.
  1389   02  DFHPA3    PIC  X  VALUE  ','.
  1390   02  DFHPF1    PIC  X  VALUE  '1'.
  1391   02  DFHPF2    PIC  X  VALUE  '2'.
  1392   02  DFHPF3    PIC  X  VALUE  '3'.
  1393   02  DFHPF4    PIC  X  VALUE  '4'.
  1394   02  DFHPF5    PIC  X  VALUE  '5'.
  1395   02  DFHPF6    PIC  X  VALUE  '6'.
  1396   02  DFHPF7    PIC  X  VALUE  '7'.
  1397   02  DFHPF8    PIC  X  VALUE  '8'.
  1398   02  DFHPF9    PIC  X  VALUE  '9'.
  1399   02  DFHPF10   PIC  X  VALUE  ':'.
  1400   02  DFHPF11   PIC  X  VALUE  '#'.
  1401   02  DFHPF12   PIC  X  VALUE  '@'.
  1402   02  DFHPF13   PIC  X  VALUE  'A'.
  1403   02  DFHPF14   PIC  X  VALUE  'B'.
  1404   02  DFHPF15   PIC  X  VALUE  'C'.
  1405   02  DFHPF16   PIC  X  VALUE  'D'.
  1406   02  DFHPF17   PIC  X  VALUE  'E'.
  1407   02  DFHPF18   PIC  X  VALUE  'F'.
  1408   02  DFHPF19   PIC  X  VALUE  'G'.
  1409   02  DFHPF20   PIC  X  VALUE  'H'.
  1410   02  DFHPF21   PIC  X  VALUE  'I'.
  1411*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1412   02  DFHPF22   PIC  X  VALUE  '['.
  1413   02  DFHPF23   PIC  X  VALUE  '.'.
  1414   02  DFHPF24   PIC  X  VALUE  '<'.
  1415   02  DFHMSRE   PIC  X  VALUE  'X'.
  1416   02  DFHSTRF   PIC  X  VALUE  'h'.
  1417   02  DFHTRIG   PIC  X  VALUE  '"'.
  1418 01  FILLER    REDEFINES DFHAID.
  1419     12  FILLER                  PIC X(8).
  1420     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  31
* EL6501.cbl
  1422*    COPY EL6501S.
  1423 01  EL6501AI.
  1424     05  FILLER            PIC  X(0012).
  1425*    -------------------------------
  1426     05  DATEL PIC S9(0004) COMP.
  1427     05  DATEF PIC  X(0001).
  1428     05  FILLER REDEFINES DATEF.
  1429         10  DATEA PIC  X(0001).
  1430     05  DATEI PIC  X(0008).
  1431*    -------------------------------
  1432     05  TIMEL PIC S9(0004) COMP.
  1433     05  TIMEF PIC  X(0001).
  1434     05  FILLER REDEFINES TIMEF.
  1435         10  TIMEA PIC  X(0001).
  1436     05  TIMEI PIC  X(0005).
  1437*    -------------------------------
  1438     05  CMPNYIDL PIC S9(0004) COMP.
  1439     05  CMPNYIDF PIC  X(0001).
  1440     05  FILLER REDEFINES CMPNYIDF.
  1441         10  CMPNYIDA PIC  X(0001).
  1442     05  CMPNYIDI PIC  X(0003).
  1443*    -------------------------------
  1444     05  USERIDL PIC S9(0004) COMP.
  1445     05  USERIDF PIC  X(0001).
  1446     05  FILLER REDEFINES USERIDF.
  1447         10  USERIDA PIC  X(0001).
  1448     05  USERIDI PIC  X(0004).
  1449*    -------------------------------
  1450     05  MAINTL PIC S9(0004) COMP.
  1451     05  MAINTF PIC  X(0001).
  1452     05  FILLER REDEFINES MAINTF.
  1453         10  MAINTA PIC  X(0001).
  1454     05  MAINTI PIC  X(0001).
  1455*    -------------------------------
  1456     05  CARRL PIC S9(0004) COMP.
  1457     05  CARRF PIC  X(0001).
  1458     05  FILLER REDEFINES CARRF.
  1459         10  CARRA PIC  X(0001).
  1460     05  CARRI PIC  X(0001).
  1461*    -------------------------------
  1462     05  GROUPINL PIC S9(0004) COMP.
  1463     05  GROUPINF PIC  X(0001).
  1464     05  FILLER REDEFINES GROUPINF.
  1465         10  GROUPINA PIC  X(0001).
  1466     05  GROUPINI PIC  X(0006).
  1467*    -------------------------------
  1468     05  STATEL PIC S9(0004) COMP.
  1469     05  STATEF PIC  X(0001).
  1470     05  FILLER REDEFINES STATEF.
  1471         10  STATEA PIC  X(0001).
  1472     05  STATEI PIC  X(0002).
  1473*    -------------------------------
  1474     05  ACCOUNTL PIC S9(0004) COMP.
  1475     05  ACCOUNTF PIC  X(0001).
  1476     05  FILLER REDEFINES ACCOUNTF.
  1477         10  ACCOUNTA PIC  X(0001).
  1478     05  ACCOUNTI PIC  X(0010).
  1479*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  32
* EL6501.cbl
  1480     05  EFFDTEL PIC S9(0004) COMP.
  1481     05  EFFDTEF PIC  X(0001).
  1482     05  FILLER REDEFINES EFFDTEF.
  1483         10  EFFDTEA PIC  X(0001).
  1484     05  EFFDTEI PIC  X(0008).
  1485*    -------------------------------
  1486     05  EXPDTEL PIC S9(0004) COMP.
  1487     05  EXPDTEF PIC  X(0001).
  1488     05  FILLER REDEFINES EXPDTEF.
  1489         10  EXPDTEA PIC  X(0001).
  1490     05  EXPDTEI PIC  X(0008).
  1491*    -------------------------------
  1492     05  MAINTBYL PIC S9(0004) COMP.
  1493     05  MAINTBYF PIC  X(0001).
  1494     05  FILLER REDEFINES MAINTBYF.
  1495         10  MAINTBYA PIC  X(0001).
  1496     05  MAINTBYI PIC  X(0004).
  1497*    -------------------------------
  1498     05  PCONTL PIC S9(0004) COMP.
  1499     05  PCONTF PIC  X(0001).
  1500     05  FILLER REDEFINES PCONTF.
  1501         10  PCONTA PIC  X(0001).
  1502     05  PCONTI PIC  X(0030).
  1503*    -------------------------------
  1504     05  CSRL PIC S9(0004) COMP.
  1505     05  CSRF PIC  X(0001).
  1506     05  FILLER REDEFINES CSRF.
  1507         10  CSRA PIC  X(0001).
  1508     05  CSRI PIC  X(0004).
  1509*    -------------------------------
  1510     05  PDSPLYL PIC S9(0004) COMP.
  1511     05  PDSPLYF PIC  X(0001).
  1512     05  FILLER REDEFINES PDSPLYF.
  1513         10  PDSPLYA PIC  X(0001).
  1514     05  PDSPLYI PIC  X(0006).
  1515*    -------------------------------
  1516     05  PEFFDTEL PIC S9(0004) COMP.
  1517     05  PEFFDTEF PIC  X(0001).
  1518     05  FILLER REDEFINES PEFFDTEF.
  1519         10  PEFFDTEA PIC  X(0001).
  1520     05  PEFFDTEI PIC  X(0008).
  1521*    -------------------------------
  1522     05  PEXPDTEL PIC S9(0004) COMP.
  1523     05  PEXPDTEF PIC  X(0001).
  1524     05  FILLER REDEFINES PEXPDTEF.
  1525         10  PEXPDTEA PIC  X(0001).
  1526     05  PEXPDTEI PIC  X(0008).
  1527*    -------------------------------
  1528     05  NAMEL PIC S9(0004) COMP.
  1529     05  NAMEF PIC  X(0001).
  1530     05  FILLER REDEFINES NAMEF.
  1531         10  NAMEA PIC  X(0001).
  1532     05  NAMEI PIC  X(0030).
  1533*    -------------------------------
  1534     05  TAXNOL PIC S9(0004) COMP.
  1535     05  TAXNOF PIC  X(0001).
  1536     05  FILLER REDEFINES TAXNOF.
  1537         10  TAXNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  33
* EL6501.cbl
  1538     05  TAXNOI PIC  X(0011).
  1539*    -------------------------------
  1540     05  STATUSL PIC S9(0004) COMP.
  1541     05  STATUSF PIC  X(0001).
  1542     05  FILLER REDEFINES STATUSF.
  1543         10  STATUSA PIC  X(0001).
  1544     05  STATUSI PIC  X(0001).
  1545*    -------------------------------
  1546     05  INCAREL PIC S9(0004) COMP.
  1547     05  INCAREF PIC  X(0001).
  1548     05  FILLER REDEFINES INCAREF.
  1549         10  INCAREA PIC  X(0001).
  1550     05  INCAREI PIC  X(0030).
  1551*    -------------------------------
  1552     05  PHONEL PIC S9(0004) COMP.
  1553     05  PHONEF PIC  X(0001).
  1554     05  FILLER REDEFINES PHONEF.
  1555         10  PHONEA PIC  X(0001).
  1556     05  PHONEI PIC  X(0012).
  1557*    -------------------------------
  1558     05  INDGRPL PIC S9(0004) COMP.
  1559     05  INDGRPF PIC  X(0001).
  1560     05  FILLER REDEFINES INDGRPF.
  1561         10  INDGRPA PIC  X(0001).
  1562     05  INDGRPI PIC  X(0001).
  1563*    -------------------------------
  1564     05  ADDR1L PIC S9(0004) COMP.
  1565     05  ADDR1F PIC  X(0001).
  1566     05  FILLER REDEFINES ADDR1F.
  1567         10  ADDR1A PIC  X(0001).
  1568     05  ADDR1I PIC  X(0030).
  1569*    -------------------------------
  1570     05  CONTRL PIC S9(0004) COMP.
  1571     05  CONTRF PIC  X(0001).
  1572     05  FILLER REDEFINES CONTRF.
  1573         10  CONTRA PIC  X(0001).
  1574     05  CONTRI PIC  X(0008).
  1575*    -------------------------------
  1576     05  TYPEL PIC S9(0004) COMP.
  1577     05  TYPEF PIC  X(0001).
  1578     05  FILLER REDEFINES TYPEF.
  1579         10  TYPEA PIC  X(0001).
  1580     05  TYPEI PIC  99.
  1581*    -------------------------------
  1582     05  ACITYL PIC S9(0004) COMP.
  1583     05  ACITYF PIC  X(0001).
  1584     05  FILLER REDEFINES ACITYF.
  1585         10  ACITYA PIC  X(0001).
  1586     05  ACITYI PIC  X(0028).
  1587*    -------------------------------
  1588     05  ASTATEL PIC S9(0004) COMP.
  1589     05  ASTATEF PIC  X(0001).
  1590     05  FILLER REDEFINES ASTATEF.
  1591         10  ASTATEA PIC  X(0001).
  1592     05  ASTATEI PIC  X(0002).
  1593*    -------------------------------
  1594     05  PRODATEL PIC S9(0004) COMP.
  1595     05  PRODATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  34
* EL6501.cbl
  1596     05  FILLER REDEFINES PRODATEF.
  1597         10  PRODATEA PIC  X(0001).
  1598     05  PRODATEI PIC  X(0008).
  1599*    -------------------------------
  1600     05  STDBENL PIC S9(0004) COMP.
  1601     05  STDBENF PIC  X(0001).
  1602     05  FILLER REDEFINES STDBENF.
  1603         10  STDBENA PIC  X(0001).
  1604     05  STDBENI PIC  X(0002).
  1605*    -------------------------------
  1606     05  ZIPL PIC S9(0004) COMP.
  1607     05  ZIPF PIC  X(0001).
  1608     05  FILLER REDEFINES ZIPF.
  1609         10  ZIPA PIC  X(0001).
  1610     05  ZIPI PIC  X(0010).
  1611*    -------------------------------
  1612     05  CTPLABLL PIC S9(0004) COMP.
  1613     05  CTPLABLF PIC  X(0001).
  1614     05  FILLER REDEFINES CTPLABLF.
  1615         10  CTPLABLA PIC  X(0001).
  1616     05  CTPLABLI PIC  X(0010).
  1617*    -------------------------------
  1618     05  CLPTOLPL PIC S9(0004) COMP.
  1619     05  CLPTOLPF PIC  X(0001).
  1620     05  FILLER REDEFINES CLPTOLPF.
  1621         10  CLPTOLPA PIC  X(0001).
  1622     05  CLPTOLPI PIC  S9(02)V9999.
  1623*    -------------------------------
  1624     05  RETROCDL PIC S9(0004) COMP.
  1625     05  RETROCDF PIC  X(0001).
  1626     05  FILLER REDEFINES RETROCDF.
  1627         10  RETROCDA PIC  X(0001).
  1628     05  RETROCDI PIC  X(0003).
  1629*    -------------------------------
  1630     05  BILLCDL PIC S9(0004) COMP.
  1631     05  BILLCDF PIC  X(0001).
  1632     05  FILLER REDEFINES BILLCDF.
  1633         10  BILLCDA PIC  X(0001).
  1634     05  BILLCDI PIC  X(0003).
  1635*    -------------------------------
  1636     05  LCLABLL PIC S9(0004) COMP.
  1637     05  LCLABLF PIC  X(0001).
  1638     05  FILLER REDEFINES LCLABLF.
  1639         10  LCLABLA PIC  X(0001).
  1640     05  LCLABLI PIC  X(0011).
  1641*    -------------------------------
  1642     05  LCOMML PIC S9(0004) COMP.
  1643     05  LCOMMF PIC  X(0001).
  1644     05  FILLER REDEFINES LCOMMF.
  1645         10  LCOMMA PIC  X(0001).
  1646     05  LCOMMI PIC  S9(6)V9(2).
  1647*    -------------------------------
  1648     05  MAXFEEHL PIC S9(0004) COMP.
  1649     05  MAXFEEHF PIC  X(0001).
  1650     05  FILLER REDEFINES MAXFEEHF.
  1651         10  MAXFEEHA PIC  X(0001).
  1652     05  MAXFEEHI PIC  X(0013).
  1653*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  35
* EL6501.cbl
  1654     05  MAXMFEEL PIC S9(0004) COMP.
  1655     05  MAXMFEEF PIC  X(0001).
  1656     05  FILLER REDEFINES MAXMFEEF.
  1657         10  MAXMFEEA PIC  X(0001).
  1658     05  MAXMFEEI PIC  X(0005).
  1659*    -------------------------------
  1660     05  CLPSTHL PIC S9(0004) COMP.
  1661     05  CLPSTHF PIC  X(0001).
  1662     05  FILLER REDEFINES CLPSTHF.
  1663         10  CLPSTHA PIC  X(0001).
  1664     05  CLPSTHI PIC  X(0010).
  1665*    -------------------------------
  1666     05  CLPSTL PIC S9(0004) COMP.
  1667     05  CLPSTF PIC  X(0001).
  1668     05  FILLER REDEFINES CLPSTF.
  1669         10  CLPSTA PIC  X(0001).
  1670     05  CLPSTI PIC  X(0002).
  1671*    -------------------------------
  1672     05  PRODCDHL PIC S9(0004) COMP.
  1673     05  PRODCDHF PIC  X(0001).
  1674     05  FILLER REDEFINES PRODCDHF.
  1675         10  PRODCDHA PIC  X(0001).
  1676     05  PRODCDHI PIC  X(0012).
  1677*    -------------------------------
  1678     05  PRODCDL PIC S9(0004) COMP.
  1679     05  PRODCDF PIC  X(0001).
  1680     05  FILLER REDEFINES PRODCDF.
  1681         10  PRODCDA PIC  X(0001).
  1682     05  PRODCDI PIC  X(0003).
  1683*    -------------------------------
  1684     05  REMITL PIC S9(0004) COMP.
  1685     05  REMITF PIC  X(0001).
  1686     05  FILLER REDEFINES REMITF.
  1687         10  REMITA PIC  X(0001).
  1688     05  REMITI PIC  99.
  1689*    -------------------------------
  1690     05  COMMCALL PIC S9(0004) COMP.
  1691     05  COMMCALF PIC  X(0001).
  1692     05  FILLER REDEFINES COMMCALF.
  1693         10  COMMCALA PIC  X(0001).
  1694     05  COMMCALI PIC  X(0001).
  1695*    -------------------------------
  1696     05  REINTABL PIC S9(0004) COMP.
  1697     05  REINTABF PIC  X(0001).
  1698     05  FILLER REDEFINES REINTABF.
  1699         10  REINTABA PIC  X(0001).
  1700     05  REINTABI PIC  X(0003).
  1701*    -------------------------------
  1702     05  REINCALL PIC S9(0004) COMP.
  1703     05  REINCALF PIC  X(0001).
  1704     05  FILLER REDEFINES REINCALF.
  1705         10  REINCALA PIC  X(0001).
  1706     05  REINCALI PIC  X(0001).
  1707*    -------------------------------
  1708     05  AHHEADL PIC S9(0004) COMP.
  1709     05  AHHEADF PIC  X(0001).
  1710     05  FILLER REDEFINES AHHEADF.
  1711         10  AHHEADA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  36
* EL6501.cbl
  1712     05  AHHEADI PIC  X(0006).
  1713*    -------------------------------
  1714     05  AGNT1L PIC S9(0004) COMP.
  1715     05  AGNT1F PIC  X(0001).
  1716     05  FILLER REDEFINES AGNT1F.
  1717         10  AGNT1A PIC  X(0001).
  1718     05  AGNT1I PIC  X(0010).
  1719*    -------------------------------
  1720     05  TYPE1L PIC S9(0004) COMP.
  1721     05  TYPE1F PIC  X(0001).
  1722     05  FILLER REDEFINES TYPE1F.
  1723         10  TYPE1A PIC  X(0001).
  1724     05  TYPE1I PIC  X(0001).
  1725*    -------------------------------
  1726     05  SINRT1L PIC S9(0004) COMP.
  1727     05  SINRT1F PIC  X(0001).
  1728     05  FILLER REDEFINES SINRT1F.
  1729         10  SINRT1A PIC  X(0001).
  1730     05  SINRT1I PIC  X(0006).
  1731*    -------------------------------
  1732     05  JNTRT1L PIC S9(0004) COMP.
  1733     05  JNTRT1F PIC  X(0001).
  1734     05  FILLER REDEFINES JNTRT1F.
  1735         10  JNTRT1A PIC  X(0001).
  1736     05  JNTRT1I PIC  X(0006).
  1737*    -------------------------------
  1738     05  AHRT1L PIC S9(0004) COMP.
  1739     05  AHRT1F PIC  X(0001).
  1740     05  FILLER REDEFINES AHRT1F.
  1741         10  AHRT1A PIC  X(0001).
  1742     05  AHRT1I PIC  X(0006).
  1743*    -------------------------------
  1744     05  RECAL1L PIC S9(0004) COMP.
  1745     05  RECAL1F PIC  X(0001).
  1746     05  FILLER REDEFINES RECAL1F.
  1747         10  RECAL1A PIC  X(0001).
  1748     05  RECAL1I PIC  X(0001).
  1749*    -------------------------------
  1750     05  COMM1L PIC S9(0004) COMP.
  1751     05  COMM1F PIC  X(0001).
  1752     05  FILLER REDEFINES COMM1F.
  1753         10  COMM1A PIC  X(0001).
  1754     05  COMM1I PIC  X(0001).
  1755*    -------------------------------
  1756     05  CHGBK1L PIC S9(0004) COMP.
  1757     05  CHGBK1F PIC  X(0001).
  1758     05  FILLER REDEFINES CHGBK1F.
  1759         10  CHGBK1A PIC  X(0001).
  1760     05  CHGBK1I PIC  X(0002).
  1761*    -------------------------------
  1762     05  GLCDE1L PIC S9(0004) COMP.
  1763     05  GLCDE1F PIC  X(0001).
  1764     05  FILLER REDEFINES GLCDE1F.
  1765         10  GLCDE1A PIC  X(0001).
  1766     05  GLCDE1I PIC  X(0001).
  1767*    -------------------------------
  1768     05  AGNT2L PIC S9(0004) COMP.
  1769     05  AGNT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  37
* EL6501.cbl
  1770     05  FILLER REDEFINES AGNT2F.
  1771         10  AGNT2A PIC  X(0001).
  1772     05  AGNT2I PIC  X(0010).
  1773*    -------------------------------
  1774     05  TYPE2L PIC S9(0004) COMP.
  1775     05  TYPE2F PIC  X(0001).
  1776     05  FILLER REDEFINES TYPE2F.
  1777         10  TYPE2A PIC  X(0001).
  1778     05  TYPE2I PIC  X(0001).
  1779*    -------------------------------
  1780     05  SINRT2L PIC S9(0004) COMP.
  1781     05  SINRT2F PIC  X(0001).
  1782     05  FILLER REDEFINES SINRT2F.
  1783         10  SINRT2A PIC  X(0001).
  1784     05  SINRT2I PIC  X(0006).
  1785*    -------------------------------
  1786     05  JNTRT2L PIC S9(0004) COMP.
  1787     05  JNTRT2F PIC  X(0001).
  1788     05  FILLER REDEFINES JNTRT2F.
  1789         10  JNTRT2A PIC  X(0001).
  1790     05  JNTRT2I PIC  X(0006).
  1791*    -------------------------------
  1792     05  AHRT2L PIC S9(0004) COMP.
  1793     05  AHRT2F PIC  X(0001).
  1794     05  FILLER REDEFINES AHRT2F.
  1795         10  AHRT2A PIC  X(0001).
  1796     05  AHRT2I PIC  X(0006).
  1797*    -------------------------------
  1798     05  RECAL2L PIC S9(0004) COMP.
  1799     05  RECAL2F PIC  X(0001).
  1800     05  FILLER REDEFINES RECAL2F.
  1801         10  RECAL2A PIC  X(0001).
  1802     05  RECAL2I PIC  X(0001).
  1803*    -------------------------------
  1804     05  COMM2L PIC S9(0004) COMP.
  1805     05  COMM2F PIC  X(0001).
  1806     05  FILLER REDEFINES COMM2F.
  1807         10  COMM2A PIC  X(0001).
  1808     05  COMM2I PIC  X(0001).
  1809*    -------------------------------
  1810     05  CHGBK2L PIC S9(0004) COMP.
  1811     05  CHGBK2F PIC  X(0001).
  1812     05  FILLER REDEFINES CHGBK2F.
  1813         10  CHGBK2A PIC  X(0001).
  1814     05  CHGBK2I PIC  X(0002).
  1815*    -------------------------------
  1816     05  GLCDE2L PIC S9(0004) COMP.
  1817     05  GLCDE2F PIC  X(0001).
  1818     05  FILLER REDEFINES GLCDE2F.
  1819         10  GLCDE2A PIC  X(0001).
  1820     05  GLCDE2I PIC  X(0001).
  1821*    -------------------------------
  1822     05  AGNT3L PIC S9(0004) COMP.
  1823     05  AGNT3F PIC  X(0001).
  1824     05  FILLER REDEFINES AGNT3F.
  1825         10  AGNT3A PIC  X(0001).
  1826     05  AGNT3I PIC  X(0010).
  1827*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  38
* EL6501.cbl
  1828     05  TYPE3L PIC S9(0004) COMP.
  1829     05  TYPE3F PIC  X(0001).
  1830     05  FILLER REDEFINES TYPE3F.
  1831         10  TYPE3A PIC  X(0001).
  1832     05  TYPE3I PIC  X(0001).
  1833*    -------------------------------
  1834     05  SINRT3L PIC S9(0004) COMP.
  1835     05  SINRT3F PIC  X(0001).
  1836     05  FILLER REDEFINES SINRT3F.
  1837         10  SINRT3A PIC  X(0001).
  1838     05  SINRT3I PIC  X(0006).
  1839*    -------------------------------
  1840     05  JNTRT3L PIC S9(0004) COMP.
  1841     05  JNTRT3F PIC  X(0001).
  1842     05  FILLER REDEFINES JNTRT3F.
  1843         10  JNTRT3A PIC  X(0001).
  1844     05  JNTRT3I PIC  X(0006).
  1845*    -------------------------------
  1846     05  AHRT3L PIC S9(0004) COMP.
  1847     05  AHRT3F PIC  X(0001).
  1848     05  FILLER REDEFINES AHRT3F.
  1849         10  AHRT3A PIC  X(0001).
  1850     05  AHRT3I PIC  X(0006).
  1851*    -------------------------------
  1852     05  RECAL3L PIC S9(0004) COMP.
  1853     05  RECAL3F PIC  X(0001).
  1854     05  FILLER REDEFINES RECAL3F.
  1855         10  RECAL3A PIC  X(0001).
  1856     05  RECAL3I PIC  X(0001).
  1857*    -------------------------------
  1858     05  COMM3L PIC S9(0004) COMP.
  1859     05  COMM3F PIC  X(0001).
  1860     05  FILLER REDEFINES COMM3F.
  1861         10  COMM3A PIC  X(0001).
  1862     05  COMM3I PIC  X(0001).
  1863*    -------------------------------
  1864     05  CHGBK3L PIC S9(0004) COMP.
  1865     05  CHGBK3F PIC  X(0001).
  1866     05  FILLER REDEFINES CHGBK3F.
  1867         10  CHGBK3A PIC  X(0001).
  1868     05  CHGBK3I PIC  X(0002).
  1869*    -------------------------------
  1870     05  GLCDE3L PIC S9(0004) COMP.
  1871     05  GLCDE3F PIC  X(0001).
  1872     05  FILLER REDEFINES GLCDE3F.
  1873         10  GLCDE3A PIC  X(0001).
  1874     05  GLCDE3I PIC  X(0001).
  1875*    -------------------------------
  1876     05  AGNT4L PIC S9(0004) COMP.
  1877     05  AGNT4F PIC  X(0001).
  1878     05  FILLER REDEFINES AGNT4F.
  1879         10  AGNT4A PIC  X(0001).
  1880     05  AGNT4I PIC  X(0010).
  1881*    -------------------------------
  1882     05  TYPE4L PIC S9(0004) COMP.
  1883     05  TYPE4F PIC  X(0001).
  1884     05  FILLER REDEFINES TYPE4F.
  1885         10  TYPE4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  39
* EL6501.cbl
  1886     05  TYPE4I PIC  X(0001).
  1887*    -------------------------------
  1888     05  SINRT4L PIC S9(0004) COMP.
  1889     05  SINRT4F PIC  X(0001).
  1890     05  FILLER REDEFINES SINRT4F.
  1891         10  SINRT4A PIC  X(0001).
  1892     05  SINRT4I PIC  X(0006).
  1893*    -------------------------------
  1894     05  JNTRT4L PIC S9(0004) COMP.
  1895     05  JNTRT4F PIC  X(0001).
  1896     05  FILLER REDEFINES JNTRT4F.
  1897         10  JNTRT4A PIC  X(0001).
  1898     05  JNTRT4I PIC  X(0006).
  1899*    -------------------------------
  1900     05  AHRT4L PIC S9(0004) COMP.
  1901     05  AHRT4F PIC  X(0001).
  1902     05  FILLER REDEFINES AHRT4F.
  1903         10  AHRT4A PIC  X(0001).
  1904     05  AHRT4I PIC  X(0006).
  1905*    -------------------------------
  1906     05  RECAL4L PIC S9(0004) COMP.
  1907     05  RECAL4F PIC  X(0001).
  1908     05  FILLER REDEFINES RECAL4F.
  1909         10  RECAL4A PIC  X(0001).
  1910     05  RECAL4I PIC  X(0001).
  1911*    -------------------------------
  1912     05  COMM4L PIC S9(0004) COMP.
  1913     05  COMM4F PIC  X(0001).
  1914     05  FILLER REDEFINES COMM4F.
  1915         10  COMM4A PIC  X(0001).
  1916     05  COMM4I PIC  X(0001).
  1917*    -------------------------------
  1918     05  CHGBK4L PIC S9(0004) COMP.
  1919     05  CHGBK4F PIC  X(0001).
  1920     05  FILLER REDEFINES CHGBK4F.
  1921         10  CHGBK4A PIC  X(0001).
  1922     05  CHGBK4I PIC  X(0002).
  1923*    -------------------------------
  1924     05  GLCDE4L PIC S9(0004) COMP.
  1925     05  GLCDE4F PIC  X(0001).
  1926     05  FILLER REDEFINES GLCDE4F.
  1927         10  GLCDE4A PIC  X(0001).
  1928     05  GLCDE4I PIC  X(0001).
  1929*    -------------------------------
  1930     05  AGNT5L PIC S9(0004) COMP.
  1931     05  AGNT5F PIC  X(0001).
  1932     05  FILLER REDEFINES AGNT5F.
  1933         10  AGNT5A PIC  X(0001).
  1934     05  AGNT5I PIC  X(0010).
  1935*    -------------------------------
  1936     05  TYPE5L PIC S9(0004) COMP.
  1937     05  TYPE5F PIC  X(0001).
  1938     05  FILLER REDEFINES TYPE5F.
  1939         10  TYPE5A PIC  X(0001).
  1940     05  TYPE5I PIC  X(0001).
  1941*    -------------------------------
  1942     05  SINRT5L PIC S9(0004) COMP.
  1943     05  SINRT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  40
* EL6501.cbl
  1944     05  FILLER REDEFINES SINRT5F.
  1945         10  SINRT5A PIC  X(0001).
  1946     05  SINRT5I PIC  X(0006).
  1947*    -------------------------------
  1948     05  JNTRT5L PIC S9(0004) COMP.
  1949     05  JNTRT5F PIC  X(0001).
  1950     05  FILLER REDEFINES JNTRT5F.
  1951         10  JNTRT5A PIC  X(0001).
  1952     05  JNTRT5I PIC  X(0006).
  1953*    -------------------------------
  1954     05  AHRT5L PIC S9(0004) COMP.
  1955     05  AHRT5F PIC  X(0001).
  1956     05  FILLER REDEFINES AHRT5F.
  1957         10  AHRT5A PIC  X(0001).
  1958     05  AHRT5I PIC  X(0006).
  1959*    -------------------------------
  1960     05  RECAL5L PIC S9(0004) COMP.
  1961     05  RECAL5F PIC  X(0001).
  1962     05  FILLER REDEFINES RECAL5F.
  1963         10  RECAL5A PIC  X(0001).
  1964     05  RECAL5I PIC  X(0001).
  1965*    -------------------------------
  1966     05  COMM5L PIC S9(0004) COMP.
  1967     05  COMM5F PIC  X(0001).
  1968     05  FILLER REDEFINES COMM5F.
  1969         10  COMM5A PIC  X(0001).
  1970     05  COMM5I PIC  X(0001).
  1971*    -------------------------------
  1972     05  CHGBK5L PIC S9(0004) COMP.
  1973     05  CHGBK5F PIC  X(0001).
  1974     05  FILLER REDEFINES CHGBK5F.
  1975         10  CHGBK5A PIC  X(0001).
  1976     05  CHGBK5I PIC  X(0002).
  1977*    -------------------------------
  1978     05  GLCDE5L PIC S9(0004) COMP.
  1979     05  GLCDE5F PIC  X(0001).
  1980     05  FILLER REDEFINES GLCDE5F.
  1981         10  GLCDE5A PIC  X(0001).
  1982     05  GLCDE5I PIC  X(0001).
  1983*    -------------------------------
  1984     05  AGNT6L PIC S9(0004) COMP.
  1985     05  AGNT6F PIC  X(0001).
  1986     05  FILLER REDEFINES AGNT6F.
  1987         10  AGNT6A PIC  X(0001).
  1988     05  AGNT6I PIC  X(0010).
  1989*    -------------------------------
  1990     05  TYPE6L PIC S9(0004) COMP.
  1991     05  TYPE6F PIC  X(0001).
  1992     05  FILLER REDEFINES TYPE6F.
  1993         10  TYPE6A PIC  X(0001).
  1994     05  TYPE6I PIC  X(0001).
  1995*    -------------------------------
  1996     05  SINRT6L PIC S9(0004) COMP.
  1997     05  SINRT6F PIC  X(0001).
  1998     05  FILLER REDEFINES SINRT6F.
  1999         10  SINRT6A PIC  X(0001).
  2000     05  SINRT6I PIC  X(0006).
  2001*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  41
* EL6501.cbl
  2002     05  JNTRT6L PIC S9(0004) COMP.
  2003     05  JNTRT6F PIC  X(0001).
  2004     05  FILLER REDEFINES JNTRT6F.
  2005         10  JNTRT6A PIC  X(0001).
  2006     05  JNTRT6I PIC  X(0006).
  2007*    -------------------------------
  2008     05  AHRT6L PIC S9(0004) COMP.
  2009     05  AHRT6F PIC  X(0001).
  2010     05  FILLER REDEFINES AHRT6F.
  2011         10  AHRT6A PIC  X(0001).
  2012     05  AHRT6I PIC  X(0006).
  2013*    -------------------------------
  2014     05  RECAL6L PIC S9(0004) COMP.
  2015     05  RECAL6F PIC  X(0001).
  2016     05  FILLER REDEFINES RECAL6F.
  2017         10  RECAL6A PIC  X(0001).
  2018     05  RECAL6I PIC  X(0001).
  2019*    -------------------------------
  2020     05  COMM6L PIC S9(0004) COMP.
  2021     05  COMM6F PIC  X(0001).
  2022     05  FILLER REDEFINES COMM6F.
  2023         10  COMM6A PIC  X(0001).
  2024     05  COMM6I PIC  X(0001).
  2025*    -------------------------------
  2026     05  CHGBK6L PIC S9(0004) COMP.
  2027     05  CHGBK6F PIC  X(0001).
  2028     05  FILLER REDEFINES CHGBK6F.
  2029         10  CHGBK6A PIC  X(0001).
  2030     05  CHGBK6I PIC  X(0002).
  2031*    -------------------------------
  2032     05  GLCDE6L PIC S9(0004) COMP.
  2033     05  GLCDE6F PIC  X(0001).
  2034     05  FILLER REDEFINES GLCDE6F.
  2035         10  GLCDE6A PIC  X(0001).
  2036     05  GLCDE6I PIC  X(0001).
  2037*    -------------------------------
  2038     05  AGNT7L PIC S9(0004) COMP.
  2039     05  AGNT7F PIC  X(0001).
  2040     05  FILLER REDEFINES AGNT7F.
  2041         10  AGNT7A PIC  X(0001).
  2042     05  AGNT7I PIC  X(0010).
  2043*    -------------------------------
  2044     05  TYPE7L PIC S9(0004) COMP.
  2045     05  TYPE7F PIC  X(0001).
  2046     05  FILLER REDEFINES TYPE7F.
  2047         10  TYPE7A PIC  X(0001).
  2048     05  TYPE7I PIC  X(0001).
  2049*    -------------------------------
  2050     05  SINRT7L PIC S9(0004) COMP.
  2051     05  SINRT7F PIC  X(0001).
  2052     05  FILLER REDEFINES SINRT7F.
  2053         10  SINRT7A PIC  X(0001).
  2054     05  SINRT7I PIC  X(0006).
  2055*    -------------------------------
  2056     05  JNTRT7L PIC S9(0004) COMP.
  2057     05  JNTRT7F PIC  X(0001).
  2058     05  FILLER REDEFINES JNTRT7F.
  2059         10  JNTRT7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  42
* EL6501.cbl
  2060     05  JNTRT7I PIC  X(0006).
  2061*    -------------------------------
  2062     05  AHRT7L PIC S9(0004) COMP.
  2063     05  AHRT7F PIC  X(0001).
  2064     05  FILLER REDEFINES AHRT7F.
  2065         10  AHRT7A PIC  X(0001).
  2066     05  AHRT7I PIC  X(0006).
  2067*    -------------------------------
  2068     05  RECAL7L PIC S9(0004) COMP.
  2069     05  RECAL7F PIC  X(0001).
  2070     05  FILLER REDEFINES RECAL7F.
  2071         10  RECAL7A PIC  X(0001).
  2072     05  RECAL7I PIC  X(0001).
  2073*    -------------------------------
  2074     05  COMM7L PIC S9(0004) COMP.
  2075     05  COMM7F PIC  X(0001).
  2076     05  FILLER REDEFINES COMM7F.
  2077         10  COMM7A PIC  X(0001).
  2078     05  COMM7I PIC  X(0001).
  2079*    -------------------------------
  2080     05  CHGBK7L PIC S9(0004) COMP.
  2081     05  CHGBK7F PIC  X(0001).
  2082     05  FILLER REDEFINES CHGBK7F.
  2083         10  CHGBK7A PIC  X(0001).
  2084     05  CHGBK7I PIC  X(0002).
  2085*    -------------------------------
  2086     05  GLCDE7L PIC S9(0004) COMP.
  2087     05  GLCDE7F PIC  X(0001).
  2088     05  FILLER REDEFINES GLCDE7F.
  2089         10  GLCDE7A PIC  X(0001).
  2090     05  GLCDE7I PIC  X(0001).
  2091*    -------------------------------
  2092     05  AGNT8L PIC S9(0004) COMP.
  2093     05  AGNT8F PIC  X(0001).
  2094     05  FILLER REDEFINES AGNT8F.
  2095         10  AGNT8A PIC  X(0001).
  2096     05  AGNT8I PIC  X(0010).
  2097*    -------------------------------
  2098     05  TYPE8L PIC S9(0004) COMP.
  2099     05  TYPE8F PIC  X(0001).
  2100     05  FILLER REDEFINES TYPE8F.
  2101         10  TYPE8A PIC  X(0001).
  2102     05  TYPE8I PIC  X(0001).
  2103*    -------------------------------
  2104     05  SINRT8L PIC S9(0004) COMP.
  2105     05  SINRT8F PIC  X(0001).
  2106     05  FILLER REDEFINES SINRT8F.
  2107         10  SINRT8A PIC  X(0001).
  2108     05  SINRT8I PIC  X(0006).
  2109*    -------------------------------
  2110     05  JNTRT8L PIC S9(0004) COMP.
  2111     05  JNTRT8F PIC  X(0001).
  2112     05  FILLER REDEFINES JNTRT8F.
  2113         10  JNTRT8A PIC  X(0001).
  2114     05  JNTRT8I PIC  X(0006).
  2115*    -------------------------------
  2116     05  AHRT8L PIC S9(0004) COMP.
  2117     05  AHRT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  43
* EL6501.cbl
  2118     05  FILLER REDEFINES AHRT8F.
  2119         10  AHRT8A PIC  X(0001).
  2120     05  AHRT8I PIC  X(0006).
  2121*    -------------------------------
  2122     05  RECAL8L PIC S9(0004) COMP.
  2123     05  RECAL8F PIC  X(0001).
  2124     05  FILLER REDEFINES RECAL8F.
  2125         10  RECAL8A PIC  X(0001).
  2126     05  RECAL8I PIC  X(0001).
  2127*    -------------------------------
  2128     05  COMM8L PIC S9(0004) COMP.
  2129     05  COMM8F PIC  X(0001).
  2130     05  FILLER REDEFINES COMM8F.
  2131         10  COMM8A PIC  X(0001).
  2132     05  COMM8I PIC  X(0001).
  2133*    -------------------------------
  2134     05  CHGBK8L PIC S9(0004) COMP.
  2135     05  CHGBK8F PIC  X(0001).
  2136     05  FILLER REDEFINES CHGBK8F.
  2137         10  CHGBK8A PIC  X(0001).
  2138     05  CHGBK8I PIC  X(0002).
  2139*    -------------------------------
  2140     05  GLCDE8L PIC S9(0004) COMP.
  2141     05  GLCDE8F PIC  X(0001).
  2142     05  FILLER REDEFINES GLCDE8F.
  2143         10  GLCDE8A PIC  X(0001).
  2144     05  GLCDE8I PIC  X(0001).
  2145*    -------------------------------
  2146     05  AGNT9L PIC S9(0004) COMP.
  2147     05  AGNT9F PIC  X(0001).
  2148     05  FILLER REDEFINES AGNT9F.
  2149         10  AGNT9A PIC  X(0001).
  2150     05  AGNT9I PIC  X(0010).
  2151*    -------------------------------
  2152     05  TYPE9L PIC S9(0004) COMP.
  2153     05  TYPE9F PIC  X(0001).
  2154     05  FILLER REDEFINES TYPE9F.
  2155         10  TYPE9A PIC  X(0001).
  2156     05  TYPE9I PIC  X(0001).
  2157*    -------------------------------
  2158     05  SINRT9L PIC S9(0004) COMP.
  2159     05  SINRT9F PIC  X(0001).
  2160     05  FILLER REDEFINES SINRT9F.
  2161         10  SINRT9A PIC  X(0001).
  2162     05  SINRT9I PIC  X(0006).
  2163*    -------------------------------
  2164     05  JNTRT9L PIC S9(0004) COMP.
  2165     05  JNTRT9F PIC  X(0001).
  2166     05  FILLER REDEFINES JNTRT9F.
  2167         10  JNTRT9A PIC  X(0001).
  2168     05  JNTRT9I PIC  X(0006).
  2169*    -------------------------------
  2170     05  AHRT9L PIC S9(0004) COMP.
  2171     05  AHRT9F PIC  X(0001).
  2172     05  FILLER REDEFINES AHRT9F.
  2173         10  AHRT9A PIC  X(0001).
  2174     05  AHRT9I PIC  X(0006).
  2175*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  44
* EL6501.cbl
  2176     05  RECAL9L PIC S9(0004) COMP.
  2177     05  RECAL9F PIC  X(0001).
  2178     05  FILLER REDEFINES RECAL9F.
  2179         10  RECAL9A PIC  X(0001).
  2180     05  RECAL9I PIC  X(0001).
  2181*    -------------------------------
  2182     05  COMM9L PIC S9(0004) COMP.
  2183     05  COMM9F PIC  X(0001).
  2184     05  FILLER REDEFINES COMM9F.
  2185         10  COMM9A PIC  X(0001).
  2186     05  COMM9I PIC  X(0001).
  2187*    -------------------------------
  2188     05  CHGBK9L PIC S9(0004) COMP.
  2189     05  CHGBK9F PIC  X(0001).
  2190     05  FILLER REDEFINES CHGBK9F.
  2191         10  CHGBK9A PIC  X(0001).
  2192     05  CHGBK9I PIC  X(0002).
  2193*    -------------------------------
  2194     05  GLCDE9L PIC S9(0004) COMP.
  2195     05  GLCDE9F PIC  X(0001).
  2196     05  FILLER REDEFINES GLCDE9F.
  2197         10  GLCDE9A PIC  X(0001).
  2198     05  GLCDE9I PIC  X(0001).
  2199*    -------------------------------
  2200     05  AGNT10L PIC S9(0004) COMP.
  2201     05  AGNT10F PIC  X(0001).
  2202     05  FILLER REDEFINES AGNT10F.
  2203         10  AGNT10A PIC  X(0001).
  2204     05  AGNT10I PIC  X(0010).
  2205*    -------------------------------
  2206     05  TYPE10L PIC S9(0004) COMP.
  2207     05  TYPE10F PIC  X(0001).
  2208     05  FILLER REDEFINES TYPE10F.
  2209         10  TYPE10A PIC  X(0001).
  2210     05  TYPE10I PIC  X(0001).
  2211*    -------------------------------
  2212     05  SINRT10L PIC S9(0004) COMP.
  2213     05  SINRT10F PIC  X(0001).
  2214     05  FILLER REDEFINES SINRT10F.
  2215         10  SINRT10A PIC  X(0001).
  2216     05  SINRT10I PIC  X(0006).
  2217*    -------------------------------
  2218     05  JNTRT10L PIC S9(0004) COMP.
  2219     05  JNTRT10F PIC  X(0001).
  2220     05  FILLER REDEFINES JNTRT10F.
  2221         10  JNTRT10A PIC  X(0001).
  2222     05  JNTRT10I PIC  X(0006).
  2223*    -------------------------------
  2224     05  AHRT10L PIC S9(0004) COMP.
  2225     05  AHRT10F PIC  X(0001).
  2226     05  FILLER REDEFINES AHRT10F.
  2227         10  AHRT10A PIC  X(0001).
  2228     05  AHRT10I PIC  X(0006).
  2229*    -------------------------------
  2230     05  RECAL10L PIC S9(0004) COMP.
  2231     05  RECAL10F PIC  X(0001).
  2232     05  FILLER REDEFINES RECAL10F.
  2233         10  RECAL10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  45
* EL6501.cbl
  2234     05  RECAL10I PIC  X(0001).
  2235*    -------------------------------
  2236     05  COMM10L PIC S9(0004) COMP.
  2237     05  COMM10F PIC  X(0001).
  2238     05  FILLER REDEFINES COMM10F.
  2239         10  COMM10A PIC  X(0001).
  2240     05  COMM10I PIC  X(0001).
  2241*    -------------------------------
  2242     05  CHGBK10L PIC S9(0004) COMP.
  2243     05  CHGBK10F PIC  X(0001).
  2244     05  FILLER REDEFINES CHGBK10F.
  2245         10  CHGBK10A PIC  X(0001).
  2246     05  CHGBK10I PIC  X(0002).
  2247*    -------------------------------
  2248     05  GLCDE10L PIC S9(0004) COMP.
  2249     05  GLCDE10F PIC  X(0001).
  2250     05  FILLER REDEFINES GLCDE10F.
  2251         10  GLCDE10A PIC  X(0001).
  2252     05  GLCDE10I PIC  X(0001).
  2253*    -------------------------------
  2254     05  ERRMSG1L PIC S9(0004) COMP.
  2255     05  ERRMSG1F PIC  X(0001).
  2256     05  FILLER REDEFINES ERRMSG1F.
  2257         10  ERRMSG1A PIC  X(0001).
  2258     05  ERRMSG1I PIC  X(0075).
  2259*    -------------------------------
  2260     05  PFENTERL PIC S9(0004) COMP.
  2261     05  PFENTERF PIC  X(0001).
  2262     05  FILLER REDEFINES PFENTERF.
  2263         10  PFENTERA PIC  X(0001).
  2264     05  PFENTERI PIC  9(2).
  2265*    -------------------------------
  2266     05  PF1PF2L PIC S9(0004) COMP.
  2267     05  PF1PF2F PIC  X(0001).
  2268     05  FILLER REDEFINES PF1PF2F.
  2269         10  PF1PF2A PIC  X(0001).
  2270     05  PF1PF2I PIC  X(0035).
  2271 01  EL6501AO REDEFINES EL6501AI.
  2272     05  FILLER            PIC  X(0012).
  2273*    -------------------------------
  2274     05  FILLER            PIC  X(0003).
  2275     05  DATEO PIC  X(0008).
  2276*    -------------------------------
  2277     05  FILLER            PIC  X(0003).
  2278     05  TIMEO PIC  99.99.
  2279*    -------------------------------
  2280     05  FILLER            PIC  X(0003).
  2281     05  CMPNYIDO PIC  X(0003).
  2282*    -------------------------------
  2283     05  FILLER            PIC  X(0003).
  2284     05  USERIDO PIC  X(0004).
  2285*    -------------------------------
  2286     05  FILLER            PIC  X(0003).
  2287     05  MAINTO PIC  X(0001).
  2288*    -------------------------------
  2289     05  FILLER            PIC  X(0003).
  2290     05  CARRO PIC  X(0001).
  2291*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  46
* EL6501.cbl
  2292     05  FILLER            PIC  X(0003).
  2293     05  GROUPINO PIC  X(0006).
  2294*    -------------------------------
  2295     05  FILLER            PIC  X(0003).
  2296     05  STATEO PIC  X(0002).
  2297*    -------------------------------
  2298     05  FILLER            PIC  X(0003).
  2299     05  ACCOUNTO PIC  X(0010).
  2300*    -------------------------------
  2301     05  FILLER            PIC  X(0003).
  2302     05  EFFDTEO PIC  X(0008).
  2303*    -------------------------------
  2304     05  FILLER            PIC  X(0003).
  2305     05  EXPDTEO PIC  99B99B99.
  2306*    -------------------------------
  2307     05  FILLER            PIC  X(0003).
  2308     05  MAINTBYO PIC  X(0004).
  2309*    -------------------------------
  2310     05  FILLER            PIC  X(0003).
  2311     05  PCONTO PIC  X(0030).
  2312*    -------------------------------
  2313     05  FILLER            PIC  X(0003).
  2314     05  CSRO PIC  X(0004).
  2315*    -------------------------------
  2316     05  FILLER            PIC  X(0003).
  2317     05  PDSPLYO PIC  X(0006).
  2318*    -------------------------------
  2319     05  FILLER            PIC  X(0003).
  2320     05  PEFFDTEO PIC  X(0008).
  2321*    -------------------------------
  2322     05  FILLER            PIC  X(0003).
  2323     05  PEXPDTEO PIC  X(0008).
  2324*    -------------------------------
  2325     05  FILLER            PIC  X(0003).
  2326     05  NAMEO PIC  X(0030).
  2327*    -------------------------------
  2328     05  FILLER            PIC  X(0003).
  2329     05  TAXNOO PIC  X(0011).
  2330*    -------------------------------
  2331     05  FILLER            PIC  X(0003).
  2332     05  STATUSO PIC  X(0001).
  2333*    -------------------------------
  2334     05  FILLER            PIC  X(0003).
  2335     05  INCAREO PIC  X(0030).
  2336*    -------------------------------
  2337     05  FILLER            PIC  X(0003).
  2338     05  PHONEO PIC  999B999B9999.
  2339*    -------------------------------
  2340     05  FILLER            PIC  X(0003).
  2341     05  INDGRPO PIC  X(0001).
  2342*    -------------------------------
  2343     05  FILLER            PIC  X(0003).
  2344     05  ADDR1O PIC  X(0030).
  2345*    -------------------------------
  2346     05  FILLER            PIC  X(0003).
  2347     05  CONTRO PIC  X(0008).
  2348*    -------------------------------
  2349     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  47
* EL6501.cbl
  2350     05  TYPEO PIC  X(0002).
  2351*    -------------------------------
  2352     05  FILLER            PIC  X(0003).
  2353     05  ACITYO PIC  X(0028).
  2354*    -------------------------------
  2355     05  FILLER            PIC  X(0003).
  2356     05  ASTATEO PIC  X(0002).
  2357*    -------------------------------
  2358     05  FILLER            PIC  X(0003).
  2359     05  PRODATEO PIC  X(0008).
  2360*    -------------------------------
  2361     05  FILLER            PIC  X(0003).
  2362     05  STDBENO PIC  X(0002).
  2363*    -------------------------------
  2364     05  FILLER            PIC  X(0003).
  2365     05  ZIPO PIC  X(0010).
  2366*    -------------------------------
  2367     05  FILLER            PIC  X(0003).
  2368     05  CTPLABLO PIC  X(0010).
  2369*    -------------------------------
  2370     05  FILLER            PIC  X(0003).
  2371     05  CLPTOLPO PIC  Z.9999.
  2372*    -------------------------------
  2373     05  FILLER            PIC  X(0003).
  2374     05  RETROCDO PIC  X(0003).
  2375*    -------------------------------
  2376     05  FILLER            PIC  X(0003).
  2377     05  BILLCDO PIC  X(0003).
  2378*    -------------------------------
  2379     05  FILLER            PIC  X(0003).
  2380     05  LCLABLO PIC  X(0011).
  2381*    -------------------------------
  2382     05  FILLER            PIC  X(0003).
  2383     05  LCOMMO PIC  ZZ99.99-.
  2384*    -------------------------------
  2385     05  FILLER            PIC  X(0003).
  2386     05  MAXFEEHO PIC  X(0013).
  2387*    -------------------------------
  2388     05  FILLER            PIC  X(0003).
  2389     05  MAXMFEEO PIC  Z,Z99.
  2390*    -------------------------------
  2391     05  FILLER            PIC  X(0003).
  2392     05  CLPSTHO PIC  X(0010).
  2393*    -------------------------------
  2394     05  FILLER            PIC  X(0003).
  2395     05  CLPSTO PIC  X(0002).
  2396*    -------------------------------
  2397     05  FILLER            PIC  X(0003).
  2398     05  PRODCDHO PIC  X(0012).
  2399*    -------------------------------
  2400     05  FILLER            PIC  X(0003).
  2401     05  PRODCDO PIC  X(0003).
  2402*    -------------------------------
  2403     05  FILLER            PIC  X(0003).
  2404     05  REMITO PIC  X(0002).
  2405*    -------------------------------
  2406     05  FILLER            PIC  X(0003).
  2407     05  COMMCALO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  48
* EL6501.cbl
  2408*    -------------------------------
  2409     05  FILLER            PIC  X(0003).
  2410     05  REINTABO PIC  X(0003).
  2411*    -------------------------------
  2412     05  FILLER            PIC  X(0003).
  2413     05  REINCALO PIC  X(0001).
  2414*    -------------------------------
  2415     05  FILLER            PIC  X(0003).
  2416     05  AHHEADO PIC  X(0006).
  2417*    -------------------------------
  2418     05  FILLER            PIC  X(0003).
  2419     05  AGNT1O PIC  X(0010).
  2420*    -------------------------------
  2421     05  FILLER            PIC  X(0003).
  2422     05  TYPE1O PIC  X(0001).
  2423*    -------------------------------
  2424     05  FILLER            PIC  X(0003).
  2425     05  SINRT1O PIC  X(0006).
  2426*    -------------------------------
  2427     05  FILLER            PIC  X(0003).
  2428     05  JNTRT1O PIC  X(0006).
  2429*    -------------------------------
  2430     05  FILLER            PIC  X(0003).
  2431     05  AHRT1O PIC  X(0006).
  2432*    -------------------------------
  2433     05  FILLER            PIC  X(0003).
  2434     05  RECAL1O PIC  X(0001).
  2435*    -------------------------------
  2436     05  FILLER            PIC  X(0003).
  2437     05  COMM1O PIC  X(0001).
  2438*    -------------------------------
  2439     05  FILLER            PIC  X(0003).
  2440     05  CHGBK1O PIC  X(0002).
  2441*    -------------------------------
  2442     05  FILLER            PIC  X(0003).
  2443     05  GLCDE1O PIC  X(0001).
  2444*    -------------------------------
  2445     05  FILLER            PIC  X(0003).
  2446     05  AGNT2O PIC  X(0010).
  2447*    -------------------------------
  2448     05  FILLER            PIC  X(0003).
  2449     05  TYPE2O PIC  X(0001).
  2450*    -------------------------------
  2451     05  FILLER            PIC  X(0003).
  2452     05  SINRT2O PIC  X(0006).
  2453*    -------------------------------
  2454     05  FILLER            PIC  X(0003).
  2455     05  JNTRT2O PIC  X(0006).
  2456*    -------------------------------
  2457     05  FILLER            PIC  X(0003).
  2458     05  AHRT2O PIC  X(0006).
  2459*    -------------------------------
  2460     05  FILLER            PIC  X(0003).
  2461     05  RECAL2O PIC  X(0001).
  2462*    -------------------------------
  2463     05  FILLER            PIC  X(0003).
  2464     05  COMM2O PIC  X(0001).
  2465*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  49
* EL6501.cbl
  2466     05  FILLER            PIC  X(0003).
  2467     05  CHGBK2O PIC  X(0002).
  2468*    -------------------------------
  2469     05  FILLER            PIC  X(0003).
  2470     05  GLCDE2O PIC  X(0001).
  2471*    -------------------------------
  2472     05  FILLER            PIC  X(0003).
  2473     05  AGNT3O PIC  X(0010).
  2474*    -------------------------------
  2475     05  FILLER            PIC  X(0003).
  2476     05  TYPE3O PIC  X(0001).
  2477*    -------------------------------
  2478     05  FILLER            PIC  X(0003).
  2479     05  SINRT3O PIC  X(0006).
  2480*    -------------------------------
  2481     05  FILLER            PIC  X(0003).
  2482     05  JNTRT3O PIC  X(0006).
  2483*    -------------------------------
  2484     05  FILLER            PIC  X(0003).
  2485     05  AHRT3O PIC  X(0006).
  2486*    -------------------------------
  2487     05  FILLER            PIC  X(0003).
  2488     05  RECAL3O PIC  X(0001).
  2489*    -------------------------------
  2490     05  FILLER            PIC  X(0003).
  2491     05  COMM3O PIC  X(0001).
  2492*    -------------------------------
  2493     05  FILLER            PIC  X(0003).
  2494     05  CHGBK3O PIC  X(0002).
  2495*    -------------------------------
  2496     05  FILLER            PIC  X(0003).
  2497     05  GLCDE3O PIC  X(0001).
  2498*    -------------------------------
  2499     05  FILLER            PIC  X(0003).
  2500     05  AGNT4O PIC  X(0010).
  2501*    -------------------------------
  2502     05  FILLER            PIC  X(0003).
  2503     05  TYPE4O PIC  X(0001).
  2504*    -------------------------------
  2505     05  FILLER            PIC  X(0003).
  2506     05  SINRT4O PIC  X(0006).
  2507*    -------------------------------
  2508     05  FILLER            PIC  X(0003).
  2509     05  JNTRT4O PIC  X(0006).
  2510*    -------------------------------
  2511     05  FILLER            PIC  X(0003).
  2512     05  AHRT4O PIC  X(0006).
  2513*    -------------------------------
  2514     05  FILLER            PIC  X(0003).
  2515     05  RECAL4O PIC  X(0001).
  2516*    -------------------------------
  2517     05  FILLER            PIC  X(0003).
  2518     05  COMM4O PIC  X(0001).
  2519*    -------------------------------
  2520     05  FILLER            PIC  X(0003).
  2521     05  CHGBK4O PIC  X(0002).
  2522*    -------------------------------
  2523     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  50
* EL6501.cbl
  2524     05  GLCDE4O PIC  X(0001).
  2525*    -------------------------------
  2526     05  FILLER            PIC  X(0003).
  2527     05  AGNT5O PIC  X(0010).
  2528*    -------------------------------
  2529     05  FILLER            PIC  X(0003).
  2530     05  TYPE5O PIC  X(0001).
  2531*    -------------------------------
  2532     05  FILLER            PIC  X(0003).
  2533     05  SINRT5O PIC  X(0006).
  2534*    -------------------------------
  2535     05  FILLER            PIC  X(0003).
  2536     05  JNTRT5O PIC  X(0006).
  2537*    -------------------------------
  2538     05  FILLER            PIC  X(0003).
  2539     05  AHRT5O PIC  X(0006).
  2540*    -------------------------------
  2541     05  FILLER            PIC  X(0003).
  2542     05  RECAL5O PIC  X(0001).
  2543*    -------------------------------
  2544     05  FILLER            PIC  X(0003).
  2545     05  COMM5O PIC  X(0001).
  2546*    -------------------------------
  2547     05  FILLER            PIC  X(0003).
  2548     05  CHGBK5O PIC  X(0002).
  2549*    -------------------------------
  2550     05  FILLER            PIC  X(0003).
  2551     05  GLCDE5O PIC  X(0001).
  2552*    -------------------------------
  2553     05  FILLER            PIC  X(0003).
  2554     05  AGNT6O PIC  X(0010).
  2555*    -------------------------------
  2556     05  FILLER            PIC  X(0003).
  2557     05  TYPE6O PIC  X(0001).
  2558*    -------------------------------
  2559     05  FILLER            PIC  X(0003).
  2560     05  SINRT6O PIC  X(0006).
  2561*    -------------------------------
  2562     05  FILLER            PIC  X(0003).
  2563     05  JNTRT6O PIC  X(0006).
  2564*    -------------------------------
  2565     05  FILLER            PIC  X(0003).
  2566     05  AHRT6O PIC  X(0006).
  2567*    -------------------------------
  2568     05  FILLER            PIC  X(0003).
  2569     05  RECAL6O PIC  X(0001).
  2570*    -------------------------------
  2571     05  FILLER            PIC  X(0003).
  2572     05  COMM6O PIC  X(0001).
  2573*    -------------------------------
  2574     05  FILLER            PIC  X(0003).
  2575     05  CHGBK6O PIC  X(0002).
  2576*    -------------------------------
  2577     05  FILLER            PIC  X(0003).
  2578     05  GLCDE6O PIC  X(0001).
  2579*    -------------------------------
  2580     05  FILLER            PIC  X(0003).
  2581     05  AGNT7O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  51
* EL6501.cbl
  2582*    -------------------------------
  2583     05  FILLER            PIC  X(0003).
  2584     05  TYPE7O PIC  X(0001).
  2585*    -------------------------------
  2586     05  FILLER            PIC  X(0003).
  2587     05  SINRT7O PIC  X(0006).
  2588*    -------------------------------
  2589     05  FILLER            PIC  X(0003).
  2590     05  JNTRT7O PIC  X(0006).
  2591*    -------------------------------
  2592     05  FILLER            PIC  X(0003).
  2593     05  AHRT7O PIC  X(0006).
  2594*    -------------------------------
  2595     05  FILLER            PIC  X(0003).
  2596     05  RECAL7O PIC  X(0001).
  2597*    -------------------------------
  2598     05  FILLER            PIC  X(0003).
  2599     05  COMM7O PIC  X(0001).
  2600*    -------------------------------
  2601     05  FILLER            PIC  X(0003).
  2602     05  CHGBK7O PIC  X(0002).
  2603*    -------------------------------
  2604     05  FILLER            PIC  X(0003).
  2605     05  GLCDE7O PIC  X(0001).
  2606*    -------------------------------
  2607     05  FILLER            PIC  X(0003).
  2608     05  AGNT8O PIC  X(0010).
  2609*    -------------------------------
  2610     05  FILLER            PIC  X(0003).
  2611     05  TYPE8O PIC  X(0001).
  2612*    -------------------------------
  2613     05  FILLER            PIC  X(0003).
  2614     05  SINRT8O PIC  X(0006).
  2615*    -------------------------------
  2616     05  FILLER            PIC  X(0003).
  2617     05  JNTRT8O PIC  X(0006).
  2618*    -------------------------------
  2619     05  FILLER            PIC  X(0003).
  2620     05  AHRT8O PIC  X(0006).
  2621*    -------------------------------
  2622     05  FILLER            PIC  X(0003).
  2623     05  RECAL8O PIC  X(0001).
  2624*    -------------------------------
  2625     05  FILLER            PIC  X(0003).
  2626     05  COMM8O PIC  X(0001).
  2627*    -------------------------------
  2628     05  FILLER            PIC  X(0003).
  2629     05  CHGBK8O PIC  X(0002).
  2630*    -------------------------------
  2631     05  FILLER            PIC  X(0003).
  2632     05  GLCDE8O PIC  X(0001).
  2633*    -------------------------------
  2634     05  FILLER            PIC  X(0003).
  2635     05  AGNT9O PIC  X(0010).
  2636*    -------------------------------
  2637     05  FILLER            PIC  X(0003).
  2638     05  TYPE9O PIC  X(0001).
  2639*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  52
* EL6501.cbl
  2640     05  FILLER            PIC  X(0003).
  2641     05  SINRT9O PIC  X(0006).
  2642*    -------------------------------
  2643     05  FILLER            PIC  X(0003).
  2644     05  JNTRT9O PIC  X(0006).
  2645*    -------------------------------
  2646     05  FILLER            PIC  X(0003).
  2647     05  AHRT9O PIC  X(0006).
  2648*    -------------------------------
  2649     05  FILLER            PIC  X(0003).
  2650     05  RECAL9O PIC  X(0001).
  2651*    -------------------------------
  2652     05  FILLER            PIC  X(0003).
  2653     05  COMM9O PIC  X(0001).
  2654*    -------------------------------
  2655     05  FILLER            PIC  X(0003).
  2656     05  CHGBK9O PIC  X(0002).
  2657*    -------------------------------
  2658     05  FILLER            PIC  X(0003).
  2659     05  GLCDE9O PIC  X(0001).
  2660*    -------------------------------
  2661     05  FILLER            PIC  X(0003).
  2662     05  AGNT10O PIC  X(0010).
  2663*    -------------------------------
  2664     05  FILLER            PIC  X(0003).
  2665     05  TYPE10O PIC  X(0001).
  2666*    -------------------------------
  2667     05  FILLER            PIC  X(0003).
  2668     05  SINRT10O PIC  X(0006).
  2669*    -------------------------------
  2670     05  FILLER            PIC  X(0003).
  2671     05  JNTRT10O PIC  X(0006).
  2672*    -------------------------------
  2673     05  FILLER            PIC  X(0003).
  2674     05  AHRT10O PIC  X(0006).
  2675*    -------------------------------
  2676     05  FILLER            PIC  X(0003).
  2677     05  RECAL10O PIC  X(0001).
  2678*    -------------------------------
  2679     05  FILLER            PIC  X(0003).
  2680     05  COMM10O PIC  X(0001).
  2681*    -------------------------------
  2682     05  FILLER            PIC  X(0003).
  2683     05  CHGBK10O PIC  X(0002).
  2684*    -------------------------------
  2685     05  FILLER            PIC  X(0003).
  2686     05  GLCDE10O PIC  X(0001).
  2687*    -------------------------------
  2688     05  FILLER            PIC  X(0003).
  2689     05  ERRMSG1O PIC  X(0075).
  2690*    -------------------------------
  2691     05  FILLER            PIC  X(0003).
  2692     05  PFENTERO PIC  X(0002).
  2693*    -------------------------------
  2694     05  FILLER            PIC  X(0003).
  2695     05  PF1PF2O PIC  X(0035).
  2696*    -------------------------------
  2697 01  MAP-R REDEFINES EL6501AI.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  53
* EL6501.cbl
  2698*    12  FILLER                  PIC X(518).
  2699*    12  FILLER                  PIC X(543).
  2700     12  FILLER                  PIC X(546).
  2701     12  MAP-AGENT-AREA.
  2702         16  AGENT-AREA OCCURS 10 TIMES INDEXED BY M-INDEX.
  2703             20  AGENTL          PIC S9(4) COMP.
  2704             20  AGENTA          PIC X.
  2705             20  AGENT           PIC X(10).
  2706             20  ATYPEL          PIC S9(4) COMP.
  2707             20  ATYPEA          PIC X.
  2708             20  ATYPE           PIC X.
  2709             20  SINGLEL         PIC S9(4) COMP.
  2710             20  SINGLEA         PIC X.
  2711             20  SINGLE-COMM-T   PIC X(6).
  2712             20  SINGLE-COMM-N REDEFINES SINGLE-COMM-T.
  2713                 24  SINGLE-COMM-R PIC V9(5).
  2714                 24  SINGLE-DASH   PIC X.
  2715             20  SINGLE-COMM-O REDEFINES SINGLE-COMM-T
  2716                                 PIC V9(5)-.
  2717             20  JOINTL          PIC S9(4) COMP.
  2718             20  JOINTA          PIC X.
  2719             20  JOINT-COMM-T    PIC X(6).
  2720             20  JOINT-COMM-N REDEFINES JOINT-COMM-T.
  2721                 24  JOINT-COMM-R PIC V9(5).
  2722                 24  JOINT-DASH   PIC X.
  2723             20  JOINT-COMM-O REDEFINES JOINT-COMM-T
  2724                                 PIC V9(5)-.
  2725             20  A-HL            PIC S9(4) COMP.
  2726             20  A-HA            PIC X.
  2727             20  A-H-COMM-T      PIC X(6).
  2728             20  A-H-COMM-N  REDEFINES A-H-COMM-T.
  2729                 24  A-H-COMM-R  PIC V9(5).
  2730                 24  A-H-DASH    PIC X.
  2731             20  A-H-COMM-O  REDEFINES A-H-COMM-T
  2732                                 PIC V9(5)-.
  2733             20  RECALL          PIC S9(4) COMP.
  2734             20  RECALA          PIC X.
  2735             20  RECAL           PIC X.
  2736             20  RCOMML          PIC S9(4) COMP.
  2737             20  RCOMMA          PIC X.
  2738             20  RCOMM           PIC X.
  2739             20  CHGBCKL         PIC S9(4) COMP.
  2740             20  CHGBCKA         PIC X.
  2741             20  CHGBCK          PIC X(02).
  2742             20  GLCODEL         PIC S9(4) COMP.
  2743             20  GLCODEA         PIC X.
  2744             20  GLCODE          PIC X.
  2745****************************************************************
  2746*
  2747* Copyright (c) 2007 by Clerity Solutions, Inc.
  2748* All rights reserved.
  2749*
  2750****************************************************************
  2751 01  DFHEIV.
  2752   02  DFHEIV0               PIC X(35).
  2753   02  DFHEIV1               PIC X(08).
  2754   02  DFHEIV2               PIC X(08).
  2755   02  DFHEIV3               PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  54
* EL6501.cbl
  2756   02  DFHEIV4               PIC X(06).
  2757   02  DFHEIV5               PIC X(04).
  2758   02  DFHEIV6               PIC X(04).
  2759   02  DFHEIV7               PIC X(02).
  2760   02  DFHEIV8               PIC X(02).
  2761   02  DFHEIV9               PIC X(01).
  2762   02  DFHEIV10              PIC S9(7) COMP-3.
  2763   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2764   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2765   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2766   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2767   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2768   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2769   02  DFHEIV17              PIC X(04).
  2770   02  DFHEIV18              PIC X(04).
  2771   02  DFHEIV19              PIC X(04).
  2772   02  DFHEIV20              USAGE IS POINTER.
  2773   02  DFHEIV21              USAGE IS POINTER.
  2774   02  DFHEIV22              USAGE IS POINTER.
  2775   02  DFHEIV23              USAGE IS POINTER.
  2776   02  DFHEIV24              USAGE IS POINTER.
  2777   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2778   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2779   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2780   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2781   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2782   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2783   02  FILLER                PIC X(02).
  2784   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2785   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2786   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2787   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2788   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2789 LINKAGE  SECTION.
  2790*****************************************************************
  2791*                                                               *
  2792* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2793* All rights reserved.                                          *
  2794*                                                               *
  2795*****************************************************************
  2796 01  dfheiblk.
  2797     02  eibtime          pic s9(7) comp-3.
  2798     02  eibdate          pic s9(7) comp-3.
  2799     02  eibtrnid         pic x(4).
  2800     02  eibtaskn         pic s9(7) comp-3.
  2801     02  eibtrmid         pic x(4).
  2802     02  dfheigdi         pic s9(4) comp.
  2803     02  eibcposn         pic s9(4) comp.
  2804     02  eibcalen         pic s9(4) comp.
  2805     02  eibaid           pic x(1).
  2806     02  eibfiller1       pic x(1).
  2807     02  eibfn            pic x(2).
  2808     02  eibfiller2       pic x(2).
  2809     02  eibrcode         pic x(6).
  2810     02  eibfiller3       pic x(2).
  2811     02  eibds            pic x(8).
  2812     02  eibreqid         pic x(8).
  2813     02  eibrsrce         pic x(8).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  55
* EL6501.cbl
  2814     02  eibsync          pic x(1).
  2815     02  eibfree          pic x(1).
  2816     02  eibrecv          pic x(1).
  2817     02  eibsend          pic x(1).
  2818     02  eibatt           pic x(1).
  2819     02  eibeoc           pic x(1).
  2820     02  eibfmh           pic x(1).
  2821     02  eibcompl         pic x(1).
  2822     02  eibsig           pic x(1).
  2823     02  eibconf          pic x(1).
  2824     02  eiberr           pic x(1).
  2825     02  eibrldbk         pic x(1).
  2826     02  eiberrcd         pic x(4).
  2827     02  eibsynrb         pic x(1).
  2828     02  eibnodat         pic x(1).
  2829     02  eibfiller5       pic x(2).
  2830     02  eibresp          pic 9(09) comp.
  2831     02  eibresp2         pic 9(09) comp.
  2832     02  dfheigdj         pic s9(4) comp.
  2833     02  dfheigdk         pic s9(4) comp.
  2834 01  DFHCOMMAREA                 PIC X(1500).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  56
* EL6501.cbl
  2836*01 PARMLIST .
  2837*    02  FILLER                  PIC S9(8)   COMP.
  2838*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  2839*    02  ELCNTL-POINTER          PIC S9(8)   COMP.
  2840*    02  REIN-POINTER            PIC S9(8)   COMP.
  2841*    02  CTBL-POINTER            PIC S9(8)   COMP.
  2842*    02  COMM-POINTER            PIC S9(8)   COMP.
  2843*    02  COMP-POINTER            PIC S9(8)   COMP.
  2844*    02  NAME-POINTER            PIC S9(8)   COMP.
  2845*    02  RQST-POINTER            PIC S9(8)   COMP.
  2846*    02  AXRF-POINTER            PIC S9(8)   COMP.
  2847*    02  AXRF2-POINTER           PIC S9(8)   COMP.
  2848*    02  AXRF3-POINTER           PIC S9(8)   COMP.
  2849*    02  AXRF4-POINTER           PIC S9(8)   COMP.
  2850*    02  AXRF5-POINTER           PIC S9(8)   COMP.
  2851*    02  AXRF6-POINTER           PIC S9(8)   COMP.
  2852*    02  AXRF7-POINTER           PIC S9(8)   COMP.
  2853*    02  AXRF8-POINTER           PIC S9(8)   COMP.
  2854*    COPY ERCACCT.
  2855******************************************************************
  2856*                                                                *
  2857*                                                                *
  2858*                            ERCACCT                             *
  2859*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2860*                            VMOD=2.031                          *
  2861*                                                                *
  2862*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2863*                                                                *
  2864*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2865*   VSAM ACCOUNT MASTER FILES.                                   *
  2866*                                                                *
  2867*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2868*                                                                *
  2869*   FILE TYPE = VSAM,KSDS                                        *
  2870*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2871*                                                                *
  2872*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2873*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2874*                                                                *
  2875*   LOG = NO                                                     *
  2876*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2877*                                                                *
  2878*                                                                *
  2879******************************************************************
  2880*                   C H A N G E   L O G
  2881*
  2882* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2883*-----------------------------------------------------------------
  2884*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2885* EFFECTIVE    NUMBER
  2886*-----------------------------------------------------------------
  2887* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2888* 092705    2005050300006  PEMA  ADD SPP LEASES
  2889* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2890* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2891* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2892* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2893* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  57
* EL6501.cbl
  2894******************************************************************
  2895
  2896 01  ACCOUNT-MASTER.
  2897     12  AM-RECORD-ID                      PIC XX.
  2898         88  VALID-AM-ID                      VALUE 'AM'.
  2899
  2900     12  AM-CONTROL-PRIMARY.
  2901         16  AM-COMPANY-CD                 PIC X.
  2902         16  AM-MSTR-CNTRL.
  2903             20  AM-CONTROL-A.
  2904                 24  AM-CARRIER            PIC X.
  2905                 24  AM-GROUPING.
  2906                     28 AM-GROUPING-PREFIX PIC XXX.
  2907                     28 AM-GROUPING-PRIME  PIC XXX.
  2908                 24  AM-STATE              PIC XX.
  2909                 24  AM-ACCOUNT.
  2910                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2911                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2912             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2913                                           PIC X(19).
  2914             20  AM-CNTRL-B.
  2915                 24  AM-EXPIRATION-DT      PIC XX.
  2916                 24  FILLER                PIC X(4).
  2917             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2918                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2919
  2920     12  AM-CONTROL-BY-VAR-GRP.
  2921         16  AM-COMPANY-CD-A1              PIC X.
  2922         16  AM-VG-CARRIER                 PIC X.
  2923         16  AM-VG-GROUPING                PIC X(6).
  2924         16  AM-VG-STATE                   PIC XX.
  2925         16  AM-VG-ACCOUNT                 PIC X(10).
  2926         16  AM-VG-DATE.
  2927             20  AM-VG-EXPIRATION-DT       PIC XX.
  2928             20  FILLER                    PIC X(4).
  2929         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2930                                           PIC 9(11)      COMP-3.
  2931     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2932         16  FILLER                        PIC X(10).
  2933         16  AM-VG-KEY3.
  2934             20  AM-VG3-ACCOUNT            PIC X(10).
  2935             20  AM-VG3-EXP-DT             PIC XX.
  2936         16  FILLER                        PIC X(4).
  2937     12  AM-MAINT-INFORMATION.
  2938         16  AM-LAST-MAINT-DT              PIC XX.
  2939         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2940         16  AM-LAST-MAINT-USER            PIC X(4).
  2941         16  FILLER                        PIC XX.
  2942
  2943     12  AM-EFFECTIVE-DT                   PIC XX.
  2944     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2945
  2946     12  AM-PREV-DATES  COMP-3.
  2947         16  AM-PREV-EXP-DT                PIC 9(11).
  2948         16  AM-PREV-EFF-DT                PIC 9(11).
  2949
  2950     12  AM-REPORT-CODE-1                  PIC X(10).
  2951     12  AM-REPORT-CODE-2                  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  58
* EL6501.cbl
  2952
  2953     12  AM-CITY-CODE                      PIC X(4).
  2954     12  AM-COUNTY-PARISH                  PIC X(6).
  2955
  2956     12  AM-NAME                           PIC X(30).
  2957     12  AM-PERSON                         PIC X(30).
  2958     12  AM-ADDRS                          PIC X(30).
  2959     12  AM-CITY.
  2960         16  AM-ADDR-CITY                  PIC X(28).
  2961         16  AM-ADDR-STATE                 PIC XX.
  2962     12  AM-ZIP.
  2963         16  AM-ZIP-PRIME.
  2964             20  AM-ZIP-PRI-1ST            PIC X.
  2965                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2966             20  FILLER                    PIC X(4).
  2967         16  AM-ZIP-PLUS4                  PIC X(4).
  2968     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2969         16  AM-CAN-POSTAL-1               PIC XXX.
  2970         16  AM-CAN-POSTAL-2               PIC XXX.
  2971         16  FILLER                        PIC XXX.
  2972     12  AM-TEL-NO.
  2973         16  AM-AREA-CODE                  PIC 999.
  2974         16  AM-TEL-PRE                    PIC 999.
  2975         16  AM-TEL-NBR                    PIC 9(4).
  2976     12  AM-TEL-LOC                        PIC X.
  2977         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2978         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2979
  2980     12  AM-COMM-STRUCTURE.
  2981         16  AM-DEFN-1.
  2982             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2983                 24  AM-AGT.
  2984                     28  AM-AGT-PREFIX     PIC X(4).
  2985                     28  AM-AGT-PRIME      PIC X(6).
  2986                 24  AM-COM-TYP            PIC X.
  2987                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2988                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2989                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2990                 24  AM-RECALC-LV-INDIC    PIC X.
  2991                 24  AM-RETRO-LV-INDIC     PIC X.
  2992                 24  AM-GL-CODES           PIC X.
  2993                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2994                 24  FILLER                PIC X(01).
  2995         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2996             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2997                 24  FILLER                PIC X(11).
  2998                 24  AM-L-COMA             PIC XXX.
  2999                 24  AM-J-COMA             PIC XXX.
  3000                 24  AM-A-COMA             PIC XXX.
  3001                 24  FILLER                PIC X(6).
  3002
  3003     12  AM-COMM-CHANGE-STATUS             PIC X.
  3004         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3005
  3006     12  AM-CSR-CODE                       PIC X(4).
  3007
  3008     12  AM-BILLING-STATUS                 PIC X.
  3009         88  AM-ACCOUNT-BILLED                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  59
* EL6501.cbl
  3010         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3011     12  AM-AUTO-REFUND-SW                 PIC X.
  3012         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3013         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3014     12  AM-GPCD                           PIC 99.
  3015     12  AM-IG                             PIC X.
  3016         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3017         88  AM-HAS-GROUP                     VALUE '2'.
  3018     12  AM-STATUS                         PIC X.
  3019         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3020         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3021         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3022         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3023         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3024         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3025     12  AM-REMIT-TO                       PIC 99.
  3026     12  AM-ID-NO                          PIC X(11).
  3027
  3028     12  AM-CAL-TABLE                      PIC XX.
  3029     12  AM-LF-DEVIATION                   PIC XXX.
  3030     12  AM-AH-DEVIATION                   PIC XXX.
  3031     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3032     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3033     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3034     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3035     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3036     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3037
  3038     12  AM-USER-FIELDS.
  3039         16  AM-FLD-1                      PIC XX.
  3040         16  AM-FLD-2                      PIC XX.
  3041         16  AM-FLD-3                      PIC XX.
  3042         16  AM-FLD-4                      PIC XX.
  3043         16  AM-FLD-5                      PIC XX.
  3044
  3045     12  AM-1ST-PROD-DATE.
  3046         16  AM-1ST-PROD-YR                PIC XX.
  3047         16  AM-1ST-PROD-MO                PIC XX.
  3048         16  AM-1ST-PROD-DA                PIC XX.
  3049     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3050     12  AM-CERTS-PURGED-DATE.
  3051         16  AM-PUR-YR                     PIC XX.
  3052         16  AM-PUR-MO                     PIC XX.
  3053         16  AM-PUR-DA                     PIC XX.
  3054     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3055     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3056     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3057     12  AM-INACTIVE-DATE.
  3058         16  AM-INA-MO                     PIC 99.
  3059         16  AM-INA-DA                     PIC 99.
  3060         16  AM-INA-YR                     PIC 99.
  3061     12  AM-AR-HI-CERT-DATE                PIC XX.
  3062
  3063     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3064     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3065
  3066     12  AM-OB-PAYMENT-MODE                PIC X.
  3067         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  60
* EL6501.cbl
  3068         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3069         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3070         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3071
  3072     12  AM-AH-ONLY-INDICATOR              PIC X.
  3073         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3074         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3075
  3076     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3077
  3078     12  AM-OVER-SHORT.
  3079         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3080         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3081
  3082     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3083     12  AM-DCC-CLP-STATE                  PIC XX.
  3084
  3085     12  AM-RECALC-COMM                    PIC X.
  3086     12  AM-RECALC-REIN                    PIC X.
  3087
  3088     12  AM-REI-TABLE                      PIC XXX.
  3089     12  AM-REI-ET-LF                      PIC X.
  3090     12  AM-REI-ET-AH                      PIC X.
  3091     12  AM-REI-PE-LF                      PIC X.
  3092     12  AM-REI-PE-AH                      PIC X.
  3093     12  AM-REI-PRT-ST                     PIC X.
  3094     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3095     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3096     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3097     12  AM-REI-GROUP-A                    PIC X(6).
  3098     12  AM-REI-MORT                       PIC X(4).
  3099     12  AM-REI-PRT-OW                     PIC X.
  3100     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3101     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3102     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3103     12  AM-REI-GROUP-B                    PIC X(6).
  3104
  3105     12  AM-TRUST-TYPE                     PIC X(2).
  3106
  3107     12  AM-EMPLOYER-STMT-USED             PIC X.
  3108     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3109
  3110     12  AM-STD-AH-TYPE                    PIC XX.
  3111     12  AM-EARN-METHODS.
  3112         16  AM-EARN-METHOD-R              PIC X.
  3113             88 AM-REF-RL-R78                 VALUE 'R'.
  3114             88 AM-REF-RL-PR                  VALUE 'P'.
  3115             88 AM-REF-RL-MEAN                VALUE 'M'.
  3116             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3117         16  AM-EARN-METHOD-L              PIC X.
  3118             88 AM-REF-LL-R78                 VALUE 'R'.
  3119             88 AM-REF-LL-PR                  VALUE 'P'.
  3120             88 AM-REF-LL-MEAN                VALUE 'M'.
  3121             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3122         16  AM-EARN-METHOD-A              PIC X.
  3123             88 AM-REF-AH-R78                 VALUE 'R'.
  3124             88 AM-REF-AH-PR                  VALUE 'P'.
  3125             88 AM-REF-AH-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  61
* EL6501.cbl
  3126             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3127             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3128             88 AM-REF-AH-NET                 VALUE 'N'.
  3129
  3130     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3131     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3132     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3133
  3134     12  AM-RET-Y-N                        PIC X.
  3135     12  AM-RET-P-E                        PIC X.
  3136     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3137     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3138     12  AM-RET-GRP                        PIC X(6).
  3139     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3140         16  AM-POOL-PRIME                 PIC XXX.
  3141         16  AM-POOL-SUB                   PIC XXX.
  3142     12  AM-RETRO-EARNINGS.
  3143         16  AM-RET-EARN-R                 PIC X.
  3144         16  AM-RET-EARN-L                 PIC X.
  3145         16  AM-RET-EARN-A                 PIC X.
  3146     12  AM-RET-ST-TAX-USE                 PIC X.
  3147         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3148         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3149     12  AM-RETRO-BEG-EARNINGS.
  3150         16  AM-RET-BEG-EARN-R             PIC X.
  3151         16  AM-RET-BEG-EARN-L             PIC X.
  3152         16  AM-RET-BEG-EARN-A             PIC X.
  3153     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3154     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3155
  3156     12  AM-USER-SELECT-OPTIONS.
  3157         16  AM-USER-SELECT-1              PIC X(10).
  3158         16  AM-USER-SELECT-2              PIC X(10).
  3159         16  AM-USER-SELECT-3              PIC X(10).
  3160         16  AM-USER-SELECT-4              PIC X(10).
  3161         16  AM-USER-SELECT-5              PIC X(10).
  3162
  3163     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3164
  3165     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3166
  3167     12  AM-RPT045A-SWITCH                 PIC X.
  3168         88  RPT045A-OFF                   VALUE 'N'.
  3169
  3170     12  AM-INSURANCE-LIMITS.
  3171         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3172         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3173
  3174     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3175         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3176
  3177     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3178         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3179         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3180
  3181     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3182
  3183     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  62
* EL6501.cbl
  3184     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3185     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3186     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  3187     12  AM-DCC-UEF-STATE                  PIC XX.
  3188     12  FILLER                            PIC XXX.
  3189     12  AM-REPORT-CODE-3                  PIC X(10).
  3190*    12  FILLER                            PIC X(22).
  3191
  3192     12  AM-RESERVE-DATE.
  3193         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  3194         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  3195         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  3196
  3197     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  3198     12  AM-NOTIFICATION-TYPES.
  3199         16  AM-NOTIF-OF-LETTERS           PIC X.
  3200         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  3201         16  AM-NOTIF-OF-REPORTS           PIC X.
  3202         16  AM-NOTIF-OF-STATUS            PIC X.
  3203
  3204     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  3205         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  3206         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  3207         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  3208         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  3209
  3210     12  AM-BENEFIT-CONTROLS.
  3211         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  3212             20  AM-BENEFIT-CODE           PIC XX.
  3213             20  AM-BENEFIT-TYPE           PIC X.
  3214             20  AM-BENEFIT-REVISION       PIC XXX.
  3215             20  AM-BENEFIT-REM-TERM       PIC X.
  3216             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  3217             20  FILLER                    PIC XX.
  3218         16  FILLER                        PIC X(80).
  3219
  3220     12  AM-TRANSFER-DATA.
  3221         16  AM-TRANSFERRED-FROM.
  3222             20  AM-TRNFROM-CARRIER        PIC X.
  3223             20  AM-TRNFROM-GROUPING.
  3224                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  3225                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  3226             20  AM-TRNFROM-STATE          PIC XX.
  3227             20  AM-TRNFROM-ACCOUNT.
  3228                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  3229                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  3230             20  AM-TRNFROM-DTE            PIC XX.
  3231         16  AM-TRANSFERRED-TO.
  3232             20  AM-TRNTO-CARRIER          PIC X.
  3233             20  AM-TRNTO-GROUPING.
  3234                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  3235                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  3236             20  AM-TRNTO-STATE            PIC XX.
  3237             20  AM-TRNTO-ACCOUNT.
  3238                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  3239                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  3240             20  AM-TRNTO-DTE              PIC XX.
  3241         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  63
* EL6501.cbl
  3242
  3243     12  AM-SAVED-REMIT-TO                 PIC 99.
  3244
  3245     12  AM-COMM-STRUCTURE-SAVED.
  3246         16  AM-DEFN-1-SAVED.
  3247             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  3248                 24  AM-AGT-SV             PIC X(10).
  3249                 24  AM-COM-TYP-SV         PIC X.
  3250                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  3251                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  3252                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  3253                 24  AM-RECALC-LV-INDIC-SV PIC X.
  3254                 24  FILLER                PIC X.
  3255                 24  AM-GL-CODES-SV        PIC X.
  3256                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  3257                 24  FILLER                PIC X.
  3258         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  3259             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  3260                 24  FILLER                PIC X(11).
  3261                 24  AM-L-COMA-SV          PIC XXX.
  3262                 24  AM-J-COMA-SV          PIC XXX.
  3263                 24  AM-A-COMA-SV          PIC XXX.
  3264                 24  FILLER                PIC X(6).
  3265
  3266     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  3267         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  3268            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  3269            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  3270            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  3271
  3272     12  AM-ORIG-DEALER-NO                 PIC X(10).
  3273     12  FILLER                            PIC X(120).
  3274
  3275     12  AM-ACCOUNT-EXECUTIVE-DATA.
  3276         16  AM-CONTROL-NAME               PIC X(30).
  3277         16  AM-EXECUTIVE-ONE.
  3278             20  AM-EXEC1-NAME             PIC X(15).
  3279             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  3280                                                          COMP-3.
  3281             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  3282                                                          COMP-3.
  3283         16  AM-EXECUTIVE-TWO.
  3284             20  AM-EXEC2-NAME             PIC X(15).
  3285             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  3286                                                          COMP-3.
  3287             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  3288                                                          COMP-3.
  3289
  3290     12  AM-RETRO-ADDITIONAL-DATA.
  3291         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  3292         16  AM-RETRO-PREM-P-E             PIC X.
  3293         16  AM-RETRO-CLMS-P-I             PIC X.
  3294         16  AM-RETRO-RET-BRACKET-LF.
  3295             20  AM-RETRO-RET-METHOD-LF    PIC X.
  3296                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  3297                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  3298             20  AM-RETRO-RET-BASIS-LF     PIC X.
  3299                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  64
* EL6501.cbl
  3300                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  3301             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  3302                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  3303                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  3304         16  AM-RETRO-RET-BRACKET-AH.
  3305             20  AM-RETRO-RET-METHOD-AH    PIC X.
  3306                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  3307                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  3308                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  3309             20  AM-RETRO-RET-BASIS-AH     PIC X.
  3310                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  3311                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  3312             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  3313                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  3314                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  3315
  3316     12  AM-COMMENTS.
  3317         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  3318
  3319     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  3320         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  3321         16  AM-FLI-BILLING-CODE           PIC X.
  3322         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  3323         16  AM-FLI-UNITED-IDENT           PIC X.
  3324         16  AM-FLI-INTEREST-LOST-DATA.
  3325             20  AM-FLI-BANK-NO            PIC X(5).
  3326             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  3327             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  3328             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  3329         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  3330             20  AM-FLI-AGT                PIC X(9).
  3331             20  AM-FLI-AGT-COMM-ACC       PIC X.
  3332             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  3333         16  FILLER                        PIC X(102).
  3334
  3335     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  3336         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  3337             20  AM-BENEFIT-DMD-CODE         PIC XX.
  3338             20  AM-BENEFIT-DMD-TYPE         PIC X.
  3339             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  3340             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  3341             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  3342         16  FILLER                          PIC X(10).
  3343******************************************************************
  3344*    copy ERCPDEF.
  3345******************************************************************
  3346*                                                                *
  3347*                                                                *
  3348*                            ERCPDEF.                            *
  3349*                                                                *
  3350*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3351*                                                                *
  3352*    FILE TYPE = VSAM,KSDS                                       *
  3353*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3354*                                                                *
  3355*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3356*                                                                *
  3357*    LOG = YES                                                   *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  65
* EL6501.cbl
  3358*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3359******************************************************************
  3360*                   C H A N G E   L O G
  3361*
  3362* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3363*-----------------------------------------------------------------
  3364*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3365* EFFECTIVE    NUMBER
  3366*-----------------------------------------------------------------
  3367* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3368* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3369* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  3370******************************************************************
  3371 01  PRODUCT-MASTER.
  3372    12  PD-RECORD-ID                 PIC X(02).
  3373        88  VALID-PD-ID                  VALUE 'PD'.
  3374    12  PD-CONTROL-PRIMARY.
  3375        16  PD-COMPANY-CD            PIC X.
  3376        16  PD-STATE                 PIC XX.
  3377        16  PD-PRODUCT-CD            PIC XXX.
  3378        16  PD-FILLER                PIC X(7).
  3379        16  PD-BEN-TYPE              PIC X.
  3380        16  PD-BEN-CODE              PIC XX.
  3381        16  PD-PROD-EXP-DT           PIC XX.
  3382    12  FILLER                       PIC X(50).
  3383    12  PD-PRODUCT-DATA OCCURS 8.
  3384        16  PD-PROD-CODE             PIC X.
  3385            88  PD-PROD-LIFE           VALUE 'L'.
  3386            88  PD-PROD-PROP           VALUE 'P'.
  3387            88  PD-PROD-AH             VALUE 'A'.
  3388            88  PD-PROD-IU             VALUE 'I'.
  3389            88  PD-PROD-GAP            VALUE 'G'.
  3390            88  PD-PROD-FAML           VALUE 'F'.
  3391        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3392        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3393        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3394        16  PD-MAX-TERM              PIC S999        COMP-3.
  3395        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3396        16  FILLER                   PIC X.
  3397        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3398        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3399        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3400        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3401        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3402        16  PD-REC-CRIT-PERIOD       PIC 99.
  3403        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  3404            20  PD-RECURRING-YN      PIC X.
  3405            20  FILLER               PIC X.
  3406        16  PD-RTW-MOS               PIC 99.
  3407        16  PD-MAX-EXTENSION         PIC 99.
  3408        16  pd-ben-pct               pic sv999 comp-3.
  3409*       16  FILLER                   PIC XX.
  3410    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3411    12  PD-TERM-LIMITS OCCURS 15.
  3412        16  PD-LOW-TERM              PIC S999        COMP-3.
  3413        16  PD-HI-TERM               PIC S999        COMP-3.
  3414*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3415    12  PD-LOAN-AMT-LIMITS OCCURS 15.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  66
* EL6501.cbl
  3416        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3417        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3418    12  PD-EARN-FACTORS.
  3419        16  FILLER OCCURS 15.
  3420            20  FILLER OCCURS 15.
  3421                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3422    12  PD-PRODUCT-DESC              PIC X(80).
  3423    12  PD-TRUNCATED                 PIC X.
  3424    12  FILLER                       PIC X(59).
  3425    12  PD-MAINT-INFORMATION.
  3426        16  PD-LAST-MAINT-DT         PIC X(02).
  3427        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3428        16  PD-LAST-MAINT-BY         PIC X(04).
  3429*    COPY ELCCNTL.
  3430******************************************************************
  3431*                                                                *
  3432*                                                                *
  3433*                            ELCCNTL.                            *
  3434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3435*                            VMOD=2.059                          *
  3436*                                                                *
  3437*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3438*                                                                *
  3439*   FILE TYPE = VSAM,KSDS                                        *
  3440*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3441*                                                                *
  3442*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3443*       ALTERNATE INDEX = NONE                                   *
  3444*                                                                *
  3445*   LOG = YES                                                    *
  3446*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3447******************************************************************
  3448*                   C H A N G E   L O G
  3449*
  3450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3451*-----------------------------------------------------------------
  3452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3453* EFFECTIVE    NUMBER
  3454*-----------------------------------------------------------------
  3455* 082503                   PEMA  ADD BENEFIT GROUP
  3456* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3457* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3458* 092705    2005050300006  PEMA  ADD SPP LEASES
  3459* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3460* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3461* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3462* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3463* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3464* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3465* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3466* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3467* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3468* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3469******************************************************************
  3470*
  3471 01  CONTROL-FILE.
  3472     12  CF-RECORD-ID                       PIC XX.
  3473         88  VALID-CF-ID                        VALUE 'CF'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  67
* EL6501.cbl
  3474
  3475     12  CF-CONTROL-PRIMARY.
  3476         16  CF-COMPANY-ID                  PIC XXX.
  3477         16  CF-RECORD-TYPE                 PIC X.
  3478             88  CF-COMPANY-MASTER              VALUE '1'.
  3479             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3480             88  CF-STATE-MASTER                VALUE '3'.
  3481             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3482             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3483             88  CF-CARRIER-MASTER              VALUE '6'.
  3484             88  CF-MORTALITY-MASTER            VALUE '7'.
  3485             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3486             88  CF-TERMINAL-MASTER             VALUE '9'.
  3487             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3488             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3489             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3490             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3491             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3492             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3493             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3494             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3495             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3496         16  CF-ACCESS-CD-GENL              PIC X(4).
  3497         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3498             20  CF-PROCESSOR               PIC X(4).
  3499         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3500             20  CF-STATE-CODE              PIC XX.
  3501             20  FILLER                     PIC XX.
  3502         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3503             20  FILLER                     PIC XX.
  3504             20  CF-HI-BEN-IN-REC           PIC XX.
  3505         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3506             20  FILLER                     PIC XXX.
  3507             20  CF-CARRIER-CNTL            PIC X.
  3508         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3509             20  FILLER                     PIC XX.
  3510             20  CF-HI-TYPE-IN-REC          PIC 99.
  3511         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3512             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3513                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3514             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3515             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3516         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3517             20  FILLER                     PIC X.
  3518             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3519         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3520             20  FILLER                     PIC XX.
  3521             20  CF-MORTGAGE-PLAN           PIC XX.
  3522         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3523
  3524     12  CF-LAST-MAINT-DT                   PIC XX.
  3525     12  CF-LAST-MAINT-BY                   PIC X(4).
  3526     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3527
  3528     12  CF-RECORD-BODY                     PIC X(728).
  3529
  3530
  3531****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  68
* EL6501.cbl
  3532*             COMPANY MASTER RECORD                            *
  3533****************************************************************
  3534
  3535     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3536         16  CF-COMPANY-ADDRESS.
  3537             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3538             20  CF-CL-IN-CARE-OF           PIC X(30).
  3539             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3540             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3541             20  CF-CL-CITY-STATE           PIC X(30).
  3542             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3543             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3544         16  CF-COMPANY-CD                  PIC X.
  3545         16  CF-COMPANY-PASSWORD            PIC X(8).
  3546         16  CF-SECURITY-OPTION             PIC X.
  3547             88  ALL-SECURITY                   VALUE '1'.
  3548             88  COMPANY-VERIFY                 VALUE '2'.
  3549             88  PROCESSOR-VERIFY               VALUE '3'.
  3550             88  NO-SECURITY                    VALUE '4'.
  3551             88  ALL-BUT-TERM                   VALUE '5'.
  3552         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3553             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3554         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3555             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3556         16  CF-INFORCE-LOCATION            PIC X.
  3557             88  CERTS-ARE-ONLINE               VALUE '1'.
  3558             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3559             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3560         16  CF-LOWER-CASE-LETTERS          PIC X.
  3561         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3562             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3563             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3564             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3565             88  CF-ACCNT-CNTL                  VALUE '3'.
  3566             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3567
  3568         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3569         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3570
  3571         16  CF-LGX-CREDIT-USER             PIC X.
  3572             88  CO-IS-NOT-USER                 VALUE 'N'.
  3573             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3574
  3575         16 CF-CREDIT-CALC-CODES.
  3576             20  CF-CR-REM-TERM-CALC PIC X.
  3577               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3578               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3579               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3580               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3581               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3582               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3583               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3584             20  CF-CR-R78-METHOD           PIC X.
  3585               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3586               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3587
  3588         16  CF-CLAIM-CONTROL-COUNTS.
  3589             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  69
* EL6501.cbl
  3590                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3591
  3592             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3593                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3594
  3595             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3596                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3597
  3598             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3599                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3600
  3601         16  CF-CURRENT-MONTH-END           PIC XX.
  3602
  3603         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3604             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3605             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3606             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3607             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3608                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3609                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3610             20  CF-CO-PREM-REJECT-SW       PIC X.
  3611                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3612                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3613             20  CF-CO-REF-REJECT-SW        PIC X.
  3614                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3615                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3616
  3617         16  CF-CO-REPORTING-DT             PIC XX.
  3618         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3619         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3620           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3621           88  CF-CO-MONTH-END                  VALUE '1'.
  3622
  3623         16  CF-LGX-CLAIM-USER              PIC X.
  3624             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3625             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3626
  3627         16  CF-CREDIT-EDIT-CONTROLS.
  3628             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3629             20  CF-MIN-AGE                 PIC 99.
  3630             20  CF-DEFAULT-AGE             PIC 99.
  3631             20  CF-MIN-TERM                PIC S999      COMP-3.
  3632             20  CF-MAX-TERM                PIC S999      COMP-3.
  3633             20  CF-DEFAULT-SEX             PIC X.
  3634             20  CF-JOINT-AGE-INPUT         PIC X.
  3635                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3636             20  CF-BIRTH-DATE-INPUT        PIC X.
  3637                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3638             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3639                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3640                 88  CF-ZERO-CARRIER            VALUE '1'.
  3641                 88  CF-ZERO-GROUPING           VALUE '2'.
  3642                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3643             20  CF-EDIT-SW                 PIC X.
  3644                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3645             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3646             20  CF-CR-PR-METHOD            PIC X.
  3647               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  70
* EL6501.cbl
  3648               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3649             20  FILLER                     PIC X.
  3650
  3651         16  CF-CREDIT-MISC-CONTROLS.
  3652             20  CF-REIN-TABLE-SW           PIC X.
  3653                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3654             20  CF-COMP-TABLE-SW           PIC X.
  3655                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3656             20  CF-EXPERIENCE-RETENTION-AGE
  3657                                            PIC S9        COMP-3.
  3658             20  CF-CONVERSION-DT           PIC XX.
  3659             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3660             20  CF-RUN-FREQUENCY-SW        PIC X.
  3661                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3662                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3663
  3664             20  CF-CR-CHECK-NO-CONTROL.
  3665                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3666                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3667                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3668                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3669                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3670                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3671
  3672                 24  CF-CR-CHECK-COUNT       REDEFINES
  3673                     CF-CR-CHECK-COUNTER      PIC X(4).
  3674
  3675                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3676                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3677
  3678                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3679                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3680                 24  CF-MAIL-PROCESSING       PIC X.
  3681                     88  MAIL-PROCESSING          VALUE 'Y'.
  3682
  3683         16  CF-MISC-SYSTEM-CONTROL.
  3684             20  CF-SYSTEM-C                 PIC X.
  3685                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3686             20  CF-SYSTEM-D                 PIC X.
  3687                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3688             20  CF-SOC-SEC-NO-SW            PIC X.
  3689                 88  SOC-SEC-NO-USED             VALUE '1'.
  3690             20  CF-MEMBER-NO-SW             PIC X.
  3691                 88  MEMBER-NO-USED              VALUE '1'.
  3692             20  CF-TAX-ID-NUMBER            PIC X(11).
  3693             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3694             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3695                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3696                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3697                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3698                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3699             20  CF-SYSTEM-E                 PIC X.
  3700                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3701
  3702         16  CF-LGX-LIFE-USER               PIC X.
  3703             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3704             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3705
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  71
* EL6501.cbl
  3706         16  CF-CR-MONTH-END-DT             PIC XX.
  3707
  3708         16  CF-FILE-MAINT-DATES.
  3709             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3710                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3711             20  CF-LAST-BATCH       REDEFINES
  3712                 CF-LAST-BATCH-NO               PIC X(4).
  3713             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3714             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3715             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3716             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3717             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3718             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3719             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3720             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3721             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3722             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3723
  3724         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3725         16  FILLER                         PIC X.
  3726
  3727         16  CF-ALT-MORT-CODE               PIC X(4).
  3728         16  CF-MEMBER-CAPTION              PIC X(10).
  3729
  3730         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3731             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3732             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3733             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3734             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3735             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3736
  3737         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3738
  3739         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3740         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3741         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3742         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3743
  3744         16  CF-AH-OVERRIDE-L1              PIC X.
  3745         16  CF-AH-OVERRIDE-L2              PIC XX.
  3746         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3747         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3748
  3749         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3750         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3751
  3752         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3753         16  CF-AR-LAST-EL860-DT            PIC XX.
  3754         16  CF-MP-MONTH-END-DT             PIC XX.
  3755
  3756         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3757         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3758             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3759
  3760         16  CF-AR-MONTH-END-DT             PIC XX.
  3761
  3762         16  CF-CRDTCRD-USER                PIC X.
  3763             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  72
* EL6501.cbl
  3764             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3765
  3766         16  CF-CC-MONTH-END-DT             PIC XX.
  3767
  3768         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3769
  3770         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3771             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3772             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3773             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3774         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3775         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3776         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3777         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3778             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3779             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3780         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3781         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3782         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3783             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3784         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3785
  3786         16  CF-CL-ZIP-CODE.
  3787             20  CF-CL-ZIP-PRIME.
  3788                 24  CF-CL-ZIP-1ST          PIC X.
  3789                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3790                 24  FILLER                 PIC X(4).
  3791             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3792         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3793             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3794             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3795             20  FILLER                     PIC XXX.
  3796
  3797         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3798         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3799         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3800         16  CF-CO-OPTION-START-DATE        PIC XX.
  3801         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3802           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3803                                                      '3' '4'.
  3804           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3805           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3806           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3807           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3808           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3809           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3810
  3811         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3812
  3813         16  CF-PAYMENT-APPROVAL-LEVELS.
  3814             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3815             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3816             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3817             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3818             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3819             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3820
  3821         16  CF-END-USER-REPORTING-USER     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  73
* EL6501.cbl
  3822             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3823             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3824
  3825         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3826             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3827             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3828
  3829         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3830
  3831         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3832         16  FILLER                         PIC X.
  3833
  3834         16  CF-CREDIT-ARCHIVE-CNTL.
  3835             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3836             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3837             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3838
  3839         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3840
  3841         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3842             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3843             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3844
  3845         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3846             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3847             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3848
  3849         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3850
  3851         16  CF-CO-ACH-ID-CODE              PIC  X.
  3852             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3853             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3854             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3855         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3856         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3857         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3858         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3859         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3860         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3861         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3862         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3863         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3864                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3865         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3866                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3867
  3868         16  CF-CO-OVER-SHORT.
  3869             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3870             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3871
  3872*         16  FILLER                         PIC X(102).
  3873         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3874             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3875             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3876
  3877         16  CF-AH-APPROVAL-DAYS.
  3878             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3879             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  74
* EL6501.cbl
  3880             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3881             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3882
  3883         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3884
  3885         16  CF-APPROV-LEV-5.
  3886             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3887             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3888             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3889
  3890         16  FILLER                         PIC X(68).
  3891****************************************************************
  3892*             PROCESSOR/USER RECORD                            *
  3893****************************************************************
  3894
  3895     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3896         16  CF-PROCESSOR-NAME              PIC X(30).
  3897         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3898         16  CF-PROCESSOR-TITLE             PIC X(26).
  3899         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3900                 88  MESSAGE-YES                VALUE 'Y'.
  3901                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3902
  3903*****************************************************
  3904****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3905****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3906****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3907****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3908*****************************************************
  3909
  3910         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3911             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3912             20  CF-APPLICATION-FORCE       PIC X.
  3913             20  CF-INDIVIDUAL-APP.
  3914                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3915                     28  CF-BROWSE-APP      PIC X.
  3916                     28  CF-UPDATE-APP      PIC X.
  3917
  3918         16  CF-CURRENT-TERM-ON             PIC X(4).
  3919         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3920             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3921             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3922             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3923             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3924             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3925             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3926             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3927         16  CF-PROCESSOR-CARRIER           PIC X.
  3928             88  NO-CARRIER-SECURITY            VALUE ' '.
  3929         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3930             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3931         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3932             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3933         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3934             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3935
  3936         16  CF-PROC-SYS-ACCESS-SW.
  3937             20  CF-PROC-CREDIT-CLAIMS-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  75
* EL6501.cbl
  3938                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3939                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3940                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3941                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3942             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3943                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3944                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3945             20  CF-PROC-LIFE-GNRLDGR-SW.
  3946                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3947                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3948                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3949                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3950             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3951                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3952                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3953         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3954             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3955             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3956         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3957
  3958         16  CF-APPROVAL-LEVEL                  PIC X.
  3959             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3960             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3961             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3962             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3963             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3964
  3965         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3966
  3967         16  CF-LANGUAGE-TYPE                   PIC X.
  3968             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3969             88  CF-LANG-IS-FR                      VALUE 'F'.
  3970
  3971         16  CF-CSR-IND                         PIC X.
  3972         16  FILLER                             PIC X(239).
  3973
  3974****************************************************************
  3975*             PROCESSOR/REMINDERS RECORD                       *
  3976****************************************************************
  3977
  3978     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3979         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3980             20  CF-START-REMIND-DT         PIC XX.
  3981             20  CF-END-REMIND-DT           PIC XX.
  3982             20  CF-REMINDER-TEXT           PIC X(50).
  3983         16  FILLER                         PIC X(296).
  3984
  3985
  3986****************************************************************
  3987*             STATE MASTER RECORD                              *
  3988****************************************************************
  3989
  3990     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3991         16  CF-STATE-ABBREVIATION          PIC XX.
  3992         16  CF-STATE-NAME                  PIC X(25).
  3993         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3994         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3995             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  76
* EL6501.cbl
  3996             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3997             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3998             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3999                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4000                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4001             20  CF-ST-PREM-REJECT-SW       PIC X.
  4002                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4003                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4004             20  CF-ST-REF-REJECT-SW        PIC X.
  4005                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4006                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4007         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4008         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  4009         16  CF-ST-REFUND-RULES.
  4010             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4011             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4012             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4013         16  CF-ST-FST-PMT-EXTENSION.
  4014             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4015             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4016                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4017                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4018                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4019                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4020         16  CF-ST-STATE-CALL.
  4021             20  CF-ST-CALL-UNEARNED        PIC X.
  4022             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4023             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4024         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4025             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4026             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4027         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4028         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4029         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4030         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4031         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4032         16  FILLER                         PIC X.
  4033         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4034             20  CF-ST-BENEFIT-CD           PIC XX.
  4035             20  CF-ST-BENEFIT-KIND         PIC X.
  4036                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4037                 88  CF-ST-AH-KIND              VALUE 'A'.
  4038             20  CF-ST-REM-TERM-CALC        PIC X.
  4039                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4040                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4041                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4042                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4043                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4044                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4045                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4046                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4047
  4048             20  CF-ST-REFUND-CALC          PIC X.
  4049                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4050                 88  ST-REFD-BY-R78             VALUE '1'.
  4051                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4052                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4053                 88  ST-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  77
* EL6501.cbl
  4054                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4055                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4056                 88  ST-REFD-UTAH               VALUE '7'.
  4057                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4058                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4059                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4060
  4061             20  CF-ST-EARNING-CALC         PIC X.
  4062                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4063                 88  ST-EARN-BY-R78             VALUE '1'.
  4064                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4065                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4066                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  4067                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4068                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4069                 88  ST-EARN-MEAN               VALUE '8'.
  4070                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4071
  4072             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4073                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4074                 88  ST-OVRD-BY-R78             VALUE '1'.
  4075                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4076                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4077                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4078                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4079                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4080                 88  ST-OVRD-MEAN               VALUE '8'.
  4081                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4082             20  cf-st-extra-periods        pic 9.
  4083*            20  FILLER                     PIC X.
  4084
  4085         16  CF-ST-COMMISSION-CAPS.
  4086             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4087             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4088             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4089             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4090         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4091                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4092
  4093         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4094
  4095         16  CF-ST-STATUTORY-INTEREST.
  4096             20  CF-ST-STAT-DATE-FROM       PIC X.
  4097                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4098                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4099             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4100             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4101             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4102             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4103             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4104
  4105         16  CF-ST-OVER-SHORT.
  4106             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4107             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4108
  4109         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4110
  4111         16  CF-ST-RT-CALC                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  78
* EL6501.cbl
  4112
  4113         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4114         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4115         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4116         16  CF-ST-RF-LR-CALC               PIC X.
  4117         16  CF-ST-RF-LL-CALC               PIC X.
  4118         16  CF-ST-RF-LN-CALC               PIC X.
  4119         16  CF-ST-RF-AH-CALC               PIC X.
  4120         16  CF-ST-RF-CP-CALC               PIC X.
  4121*        16  FILLER                         PIC X(206).
  4122*CIDMOD         16  FILLER                         PIC X(192).
  4123         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4124             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4125         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4126         16  CF-ST-VFY-2ND-BENE             PIC X.
  4127         16  CF-ST-CAUSAL-STATE             PIC X.
  4128         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4129         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4130         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4131             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4132         16  CF-ST-NET-ONLY-STATE           PIC X.
  4133             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4134         16  FILLER                         PIC X(181).
  4135
  4136****************************************************************
  4137*             BENEFIT MASTER RECORD                            *
  4138****************************************************************
  4139
  4140     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4141         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4142             20  CF-BENEFIT-CODE            PIC XX.
  4143             20  CF-BENEFIT-NUMERIC  REDEFINES
  4144                 CF-BENEFIT-CODE            PIC XX.
  4145             20  CF-BENEFIT-ALPHA           PIC XXX.
  4146             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4147             20  CF-BENEFIT-COMMENT         PIC X(10).
  4148
  4149             20  CF-LF-COVERAGE-TYPE        PIC X.
  4150                 88  CF-REDUCING                VALUE 'R'.
  4151                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4152
  4153             20  CF-SPECIAL-CALC-CD         PIC X.
  4154                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4155                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4156                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4157                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4158                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4159                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4160                 88  CF-FARM-PLAN               VALUE 'F'.
  4161                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4162                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4163                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4164                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4165                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4166                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4167                 88  CF-PRUDENTIAL              VALUE 'P'.
  4168                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4169                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  79
* EL6501.cbl
  4170                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4171                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4172                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4173                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4174
  4175             20  CF-JOINT-INDICATOR         PIC X.
  4176                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4177
  4178*            20  FILLER                     PIC X(12).
  4179             20  cf-maximum-benefits        pic s999 comp-3.
  4180             20  FILLER                     PIC X(09).
  4181             20  CF-BENEFIT-CATEGORY        PIC X.
  4182             20  CF-LOAN-TYPE               PIC X(8).
  4183
  4184             20  CF-CO-REM-TERM-CALC        PIC X.
  4185                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4186                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4187                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4188                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4189                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4190
  4191             20  CF-CO-EARNINGS-CALC        PIC X.
  4192                 88  CO-EARN-BY-R78             VALUE '1'.
  4193                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4194                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4195                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4196                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4197                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4198                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4199                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4200
  4201             20  CF-CO-REFUND-CALC          PIC X.
  4202                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4203                 88  CO-REFD-BY-R78             VALUE '1'.
  4204                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4205                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4206                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4207                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4208                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4209                 88  CO-REFD-MEAN               VALUE '8'.
  4210                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4211                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4212                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4213
  4214             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4215                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4216                 88  CO-OVRD-BY-R78             VALUE '1'.
  4217                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4218                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4219                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4220                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4221                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4222                 88  CO-OVRD-MEAN               VALUE '8'.
  4223                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4224
  4225             20  CF-CO-BEN-I-G-CD           PIC X.
  4226                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4227                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  80
* EL6501.cbl
  4228                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4229
  4230         16  FILLER                         PIC X(304).
  4231
  4232
  4233****************************************************************
  4234*             CARRIER MASTER RECORD                            *
  4235****************************************************************
  4236
  4237     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4238         16  CF-ADDRESS-DATA.
  4239             20  CF-MAIL-TO-NAME            PIC X(30).
  4240             20  CF-IN-CARE-OF              PIC X(30).
  4241             20  CF-ADDRESS-LINE-1          PIC X(30).
  4242             20  CF-ADDRESS-LINE-2          PIC X(30).
  4243             20  CF-CITY-STATE              PIC X(30).
  4244             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4245             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4246
  4247         16  CF-CLAIM-NO-CONTROL.
  4248             20  CF-CLAIM-NO-METHOD         PIC X.
  4249                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4250                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4251                 88  CLAIM-NO-SEQ               VALUE '3'.
  4252                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4253             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4254                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4255                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4256                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4257
  4258         16  CF-CHECK-NO-CONTROL.
  4259             20  CF-CHECK-NO-METHOD         PIC X.
  4260                 88  CHECK-NO-MANUAL            VALUE '1'.
  4261                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4262                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4263                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4264             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4265                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4266
  4267         16  CF-DOMICILE-STATE              PIC XX.
  4268
  4269         16  CF-EXPENSE-CONTROLS.
  4270             20  CF-EXPENSE-METHOD          PIC X.
  4271                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4272                 88  DOLLARS-PER-PMT            VALUE '2'.
  4273                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4274                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4275             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4276             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4277
  4278         16  CF-CORRESPONDENCE-CONTROL.
  4279             20  CF-LETTER-RESEND-OPT       PIC X.
  4280                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4281                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4282             20  FILLER                     PIC X(4).
  4283
  4284         16  CF-RESERVE-CONTROLS.
  4285             20  CF-MANUAL-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  81
* EL6501.cbl
  4286                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4287             20  CF-FUTURE-SW               PIC X.
  4288                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4289             20  CF-PTC-SW                  PIC X.
  4290                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4291             20  CF-IBNR-SW                 PIC X.
  4292                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4293             20  CF-PTC-LF-SW               PIC X.
  4294                 88  CF-LF-PTC-USED             VALUE '1'.
  4295             20  CF-CDT-ACCESS-METHOD       PIC X.
  4296                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4297                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4298                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4299             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4300
  4301         16  CF-CLAIM-CALC-METHOD           PIC X.
  4302             88  360-PLUS-MONTHS                VALUE '1'.
  4303             88  365-PLUS-MONTHS                VALUE '2'.
  4304             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4305             88  360-DAILY                      VALUE '4'.
  4306             88  365-DAILY                      VALUE '5'.
  4307
  4308         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4309         16  FILLER                         PIC X(11).
  4310
  4311         16  CF-LIMIT-AMOUNTS.
  4312             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4313             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4314             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4315             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4316             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4317             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4318             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4319             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4320             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4321             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4322
  4323         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4324         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4325         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4326
  4327         16  CF-ZIP-CODE.
  4328             20  CF-ZIP-PRIME.
  4329                 24  CF-ZIP-1ST             PIC X.
  4330                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4331                 24  FILLER                 PIC X(4).
  4332             20  CF-ZIP-PLUS4               PIC X(4).
  4333         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4334             20  CF-CAN-POSTAL-1            PIC XXX.
  4335             20  CF-CAN-POSTAL-2            PIC XXX.
  4336             20  FILLER                     PIC XXX.
  4337
  4338         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4339         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4340         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4341
  4342         16  CF-RATING-SWITCH               PIC X.
  4343             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  82
* EL6501.cbl
  4344             88  CF-NO-RATING                   VALUE 'N'.
  4345
  4346         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4347
  4348         16  CF-CARRIER-OVER-SHORT.
  4349             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4350             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4351
  4352         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4353         16  CF-SECPAY-SWITCH               PIC X.
  4354             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4355             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4356         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4357         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4358         16  FILLER                         PIC X(444).
  4359*        16  FILLER                         PIC X(452).
  4360
  4361
  4362****************************************************************
  4363*             MORTALITY MASTER RECORD                          *
  4364****************************************************************
  4365
  4366     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4367         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4368                                INDEXED BY CF-MORT-NDX.
  4369             20  CF-MORT-TABLE              PIC X(5).
  4370             20  CF-MORT-TABLE-TYPE         PIC X.
  4371                 88  CF-MORT-JOINT              VALUE 'J'.
  4372                 88  CF-MORT-SINGLE             VALUE 'S'.
  4373                 88  CF-MORT-COMBINED           VALUE 'C'.
  4374                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4375                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4376             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4377             20  CF-MORT-AGE-METHOD         PIC XX.
  4378                 88  CF-AGE-LAST                VALUE 'AL'.
  4379                 88  CF-AGE-NEAR                VALUE 'AN'.
  4380             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4381             20  CF-MORT-ADJUSTMENT-DIRECTION
  4382                                            PIC X.
  4383                 88  CF-MINUS                   VALUE '-'.
  4384                 88  CF-PLUS                    VALUE '+'.
  4385             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4386             20  CF-MORT-JOINT-CODE         PIC X.
  4387                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4388             20  CF-MORT-PC-Q               PIC X.
  4389                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4390             20  CF-MORT-TABLE-CODE         PIC X(4).
  4391             20  CF-MORT-COMMENTS           PIC X(15).
  4392             20  FILLER                     PIC X(14).
  4393
  4394         16  FILLER                         PIC X(251).
  4395
  4396
  4397****************************************************************
  4398*             BUSSINESS TYPE MASTER RECORD                     *
  4399****************************************************************
  4400
  4401     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  83
* EL6501.cbl
  4402* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4403* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4404* AND RECORD 05 IS TYPES 81-99
  4405         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4406             20  CF-BUSINESS-TITLE          PIC  X(19).
  4407             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4408                                            PIC S9V9(4) COMP-3.
  4409             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4410             20  FILLER                     PIC  X.
  4411         16  FILLER                         PIC  X(248).
  4412
  4413
  4414****************************************************************
  4415*             TERMINAL MASTER RECORD                           *
  4416****************************************************************
  4417
  4418     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4419
  4420         16  CF-COMPANY-TERMINALS.
  4421             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4422                                  PIC X(4).
  4423         16  FILLER               PIC X(248).
  4424
  4425
  4426****************************************************************
  4427*             LIFE EDIT MASTER RECORD                          *
  4428****************************************************************
  4429
  4430     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4431         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4432             20  CF-LIFE-CODE-IN            PIC XX.
  4433             20  CF-LIFE-CODE-OUT           PIC XX.
  4434         16  FILLER                         PIC X(248).
  4435
  4436
  4437****************************************************************
  4438*             AH EDIT MASTER RECORD                            *
  4439****************************************************************
  4440
  4441     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4442         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4443             20  CF-AH-CODE-IN              PIC XXX.
  4444             20  CF-AH-CODE-OUT             PIC XX.
  4445         16  FILLER                         PIC X(248).
  4446
  4447
  4448****************************************************************
  4449*             CREDIBILITY TABLES                               *
  4450****************************************************************
  4451
  4452     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4453         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4454                             INDEXED BY CF-CRDB-NDX.
  4455             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4456             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4457             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4458         16  FILLER                         PIC  X(332).
  4459
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  84
* EL6501.cbl
  4460
  4461****************************************************************
  4462*             REPORT CUSTOMIZATION RECORD                      *
  4463****************************************************************
  4464
  4465     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4466         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4467             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4468             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4469             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4470**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4471****       A T-TRANSFER.                                   ****
  4472             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4473
  4474         16  FILLER                         PIC XX.
  4475
  4476         16  CF-CARRIER-CNTL-OPT.
  4477             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4478                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4479                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4480             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4481                                            PIC X.
  4482         16  CF-GROUP-CNTL-OPT.
  4483             20  CF-GROUP-OPT-SEQ           PIC 9.
  4484                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4485                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4486             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4487                                            PIC X(6).
  4488         16  CF-STATE-CNTL-OPT.
  4489             20  CF-STATE-OPT-SEQ           PIC 9.
  4490                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4491                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4492             20  CF-STATE-SELECT OCCURS 3 TIMES
  4493                                            PIC XX.
  4494         16  CF-ACCOUNT-CNTL-OPT.
  4495             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4496                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4497                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4498             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4499                                            PIC X(10).
  4500         16  CF-BUS-TYP-CNTL-OPT.
  4501             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4502                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4503                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4504             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4505                                            PIC XX.
  4506         16  CF-LF-TYP-CNTL-OPT.
  4507             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4508                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4509                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4510             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4511                                            PIC XX.
  4512         16  CF-AH-TYP-CNTL-OPT.
  4513             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4514                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4515                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4516             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4517                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  85
* EL6501.cbl
  4518         16  CF-REPTCD1-CNTL-OPT.
  4519             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4520                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4521                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4522             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4523                                            PIC X(10).
  4524         16  CF-REPTCD2-CNTL-OPT.
  4525             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4526                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4527                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4528             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4529                                            PIC X(10).
  4530         16  CF-USER1-CNTL-OPT.
  4531             20  CF-USER1-OPT-SEQ           PIC 9.
  4532                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4533                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4534             20  CF-USER1-SELECT OCCURS 3 TIMES
  4535                                            PIC X(10).
  4536         16  CF-USER2-CNTL-OPT.
  4537             20  CF-USER2-OPT-SEQ           PIC 9.
  4538                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4539                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4540             20  CF-USER2-SELECT OCCURS 3 TIMES
  4541                                            PIC X(10).
  4542         16  CF-USER3-CNTL-OPT.
  4543             20  CF-USER3-OPT-SEQ           PIC 9.
  4544                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4545                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4546             20  CF-USER3-SELECT OCCURS 3 TIMES
  4547                                            PIC X(10).
  4548         16  CF-USER4-CNTL-OPT.
  4549             20  CF-USER4-OPT-SEQ           PIC 9.
  4550                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4551                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4552             20  CF-USER4-SELECT OCCURS 3 TIMES
  4553                                            PIC X(10).
  4554         16  CF-USER5-CNTL-OPT.
  4555             20  CF-USER5-OPT-SEQ           PIC 9.
  4556                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4557                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4558             20  CF-USER5-SELECT OCCURS 3 TIMES
  4559                                            PIC X(10).
  4560         16  CF-REINS-CNTL-OPT.
  4561             20  CF-REINS-OPT-SEQ           PIC 9.
  4562                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4563                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4564             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4565                 24  CF-REINS-PRIME         PIC XXX.
  4566                 24  CF-REINS-SUB           PIC XXX.
  4567
  4568         16  CF-AGENT-CNTL-OPT.
  4569             20  CF-AGENT-OPT-SEQ           PIC 9.
  4570                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4571                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4572             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4573                                            PIC X(10).
  4574
  4575         16  FILLER                         PIC X(43).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  86
* EL6501.cbl
  4576
  4577         16  CF-LOSS-RATIO-SELECT.
  4578             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4579             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4580         16  CF-ENTRY-DATE-SELECT.
  4581             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4582             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4583         16  CF-EFFECTIVE-DATE-SELECT.
  4584             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4585             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4586
  4587         16  CF-EXCEPTION-LIST-IND          PIC X.
  4588             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4589
  4590         16  FILLER                         PIC X(318).
  4591
  4592****************************************************************
  4593*                  EXCEPTION REPORTING RECORD                  *
  4594****************************************************************
  4595
  4596     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4597         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4598             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4599
  4600         16  CF-COMBINED-LIFE-AH-OPT.
  4601             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4602             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4603             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4604             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4605
  4606         16  CF-LIFE-OPT.
  4607             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4608             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4609             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4610             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4611             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4612             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4613             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4614             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4615             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4616             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4617
  4618         16  CF-AH-OPT.
  4619             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4620             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4621             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4622             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4623             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4624             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4625             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4626             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4627             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4628             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4629
  4630         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4631             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4632             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4633             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  87
* EL6501.cbl
  4634
  4635         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4636
  4637         16  FILLER                         PIC X(673).
  4638
  4639
  4640****************************************************************
  4641*             MORTGAGE SYSTEM PLAN RECORD                      *
  4642****************************************************************
  4643
  4644     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4645         16  CF-PLAN-TYPE                   PIC X.
  4646             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4647             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4648             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4649         16  CF-PLAN-ABBREV                 PIC XXX.
  4650         16  CF-PLAN-DESCRIPT               PIC X(10).
  4651         16  CF-PLAN-NOTES                  PIC X(20).
  4652         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4653         16  CF-PLAN-UNDERWRITING.
  4654             20  CF-PLAN-TERM-DATA.
  4655                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4656                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4657             20  CF-PLAN-AGE-DATA.
  4658                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4659                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4660                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4661             20  CF-PLAN-BENEFIT-DATA.
  4662                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4663                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4664                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4665                                            PIC S9(7)V99  COMP-3.
  4666         16  CF-PLAN-POLICY-FORMS.
  4667             20  CF-POLICY-FORM             PIC X(12).
  4668             20  CF-MASTER-APPLICATION      PIC X(12).
  4669             20  CF-MASTER-POLICY           PIC X(12).
  4670         16  CF-PLAN-RATING.
  4671             20  CF-RATE-CODE               PIC X(5).
  4672             20  CF-SEX-RATING              PIC X.
  4673                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4674                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4675             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4676             20  CF-SUB-STD-TYPE            PIC X.
  4677                 88  CF-PCT-OF-PREM            VALUE '1'.
  4678                 88  CF-PCT-OF-BENE            VALUE '2'.
  4679         16  CF-PLAN-PREM-TOLERANCES.
  4680             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4681             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4682         16  CF-PLAN-PYMT-TOLERANCES.
  4683             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4684             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4685         16  CF-PLAN-MISC-DATA.
  4686             20  FILLER                     PIC X.
  4687             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4688             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4689         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4690         16  CF-PLAN-IND-GRP                PIC X.
  4691             88  CF-MORT-INDIV-PLAN            VALUE 'I'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  88
* EL6501.cbl
  4692                                                     '1'.
  4693             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4694                                                     '2'.
  4695         16  CF-MIB-SEARCH-SW               PIC X.
  4696             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4697             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4698             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4699             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4700         16  CF-ALPHA-SEARCH-SW             PIC X.
  4701             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4702             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4703             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4704             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4705             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4706             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4707             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4708             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4709             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4710             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4711                                                     'A' 'B' 'C'
  4712                                                     'X' 'Y' 'Z'.
  4713         16  CF-EFF-DT-RULE-SW              PIC X.
  4714             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4715             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4716             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4717             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4718             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4719         16  FILLER                         PIC X(4).
  4720         16  CF-HEALTH-QUESTIONS            PIC X.
  4721             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4722         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4723         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4724         16  CF-PLAN-SNGL-JNT               PIC X.
  4725             88  CF-COMBINED-PLAN              VALUE 'C'.
  4726             88  CF-JNT-PLAN                   VALUE 'J'.
  4727             88  CF-SNGL-PLAN                  VALUE 'S'.
  4728         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4729         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4730         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4731         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4732         16  CF-RERATE-CNTL                 PIC  X.
  4733             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4734             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4735             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4736             88  CF-AUTO-RECALC                 VALUE '4'.
  4737         16  CF-BENEFIT-TYPE                PIC  X.
  4738             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4739             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4740         16  CF-POLICY-FEE                  PIC S999V99
  4741                                                    COMP-3.
  4742         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4743         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4744         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4745         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4746         16  FILLER                         PIC  X(32).
  4747         16  CF-TERMINATION-FORM            PIC  X(04).
  4748         16  FILLER                         PIC  X(08).
  4749         16  CF-CLAIM-CAP                   PIC S9(7)V99
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  89
* EL6501.cbl
  4750                                                       COMP-3.
  4751         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4752         16  CF-ISSUE-LETTER                PIC  X(4).
  4753         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4754         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4755             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4756             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4757         16  CF-MP-REFUND-CALC              PIC X.
  4758             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4759             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4760             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4761             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4762             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4763             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4764             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4765             88  CF-MP-REFD-MEAN                VALUE '8'.
  4766         16  CF-ALT-RATE-CODE               PIC  X(5).
  4767
  4768
  4769         16  FILLER                         PIC X(498).
  4770****************************************************************
  4771*             MORTGAGE COMPANY MASTER RECORD                   *
  4772****************************************************************
  4773
  4774     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4775         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4776         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4777             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4778             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4779             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4780             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4781             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4782
  4783         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4784         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4785         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4786         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4787         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4788
  4789         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4790             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4791         16  CF-MP-RECON-USE-IND            PIC X(1).
  4792             88  CF-MP-USE-RECON             VALUE 'Y'.
  4793         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4794             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4795         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4796             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4797             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4798         16  FILLER                         PIC X(1).
  4799         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4800             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4801         16  CF-MORTG-MIB-VERSION           PIC X.
  4802             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4803             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4804             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4805         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4806             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4807                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  90
* EL6501.cbl
  4808             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4809                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4810             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4811                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4812             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4813                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4814             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4815                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4816             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4817                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4818         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4819         16  FILLER                         PIC X(7).
  4820         16  CF-MORTG-DESTINATION-SYMBOL.
  4821             20  CF-MORTG-MIB-COMM          PIC X(5).
  4822             20  CF-MORTG-MIB-TERM          PIC X(5).
  4823         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4824             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4825         16  FILLER                         PIC X(03).
  4826         16  CF-MP-CHECK-NO-CONTROL.
  4827             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4828                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4829                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4830                                                ' ' LOW-VALUES.
  4831                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4832                                               VALUE '3'.
  4833         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4834         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4835         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4836             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4837                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4838             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4839                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4840             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4841                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4842             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4843                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4844             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4845                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4846             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4847                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4848         16  CF-MORTG-BILLING-AREA.
  4849             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4850                                            PIC X.
  4851         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4852         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4853         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4854         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4855             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4856             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4857         16  FILLER                         PIC X.
  4858         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4859             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4860             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4861         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4862         16  FILLER                         PIC X(8).
  4863         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4864         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4865         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  91
* EL6501.cbl
  4866         16  CF-ACH-COMPANY-ID.
  4867             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4868                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4869                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4870                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4871             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4872         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4873             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4874         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4875             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4876             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4877         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4878         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4879         16  FILLER                         PIC X(536).
  4880
  4881****************************************************************
  4882*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4883****************************************************************
  4884
  4885     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4886         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4887             20  CF-FEMALE-HEIGHT.
  4888                 24  CF-FEMALE-FT           PIC 99.
  4889                 24  CF-FEMALE-IN           PIC 99.
  4890             20  CF-FEMALE-MIN-WT           PIC 999.
  4891             20  CF-FEMALE-MAX-WT           PIC 999.
  4892         16  FILLER                         PIC X(428).
  4893
  4894     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4895         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4896             20  CF-MALE-HEIGHT.
  4897                 24  CF-MALE-FT             PIC 99.
  4898                 24  CF-MALE-IN             PIC 99.
  4899             20  CF-MALE-MIN-WT             PIC 999.
  4900             20  CF-MALE-MAX-WT             PIC 999.
  4901         16  FILLER                         PIC X(428).
  4902******************************************************************
  4903*             AUTOMATIC ACTIVITY RECORD                          *
  4904******************************************************************
  4905     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4906         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4907             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4908             20  CF-SYS-LETTER-ID           PIC X(04).
  4909             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4910             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4911             20  CF-SYS-RESET-SW            PIC X(01).
  4912             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4913             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4914
  4915         16  FILLER                         PIC X(50).
  4916
  4917         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4918             20  CF-USER-ACTIVE-SW          PIC X(01).
  4919             20  CF-USER-LETTER-ID          PIC X(04).
  4920             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4921             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4922             20  CF-USER-RESET-SW           PIC X(01).
  4923             20  CF-USER-REPORT-DAYS        PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  92
* EL6501.cbl
  4924             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4925             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4926
  4927         16  FILLER                         PIC X(246).
  4928*    COPY ERCREIN.
  4929******************************************************************
  4930*                                                                *
  4931*                            ERCREIN                             *
  4932*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4933*                            VMOD=2.010                          *
  4934*                                                                *
  4935*   ONLINE CREDIT SYSTEM                                         *
  4936*                                                                *
  4937*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  4938*                                                                *
  4939*   FILE TYPE = VSAM,KSDS                                        *
  4940*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  4941*                                                                *
  4942*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  4943*       ALTERNATE PATH = NONE                                    *
  4944*                                                                *
  4945*   LOG = NO                                                     *
  4946*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4947*                                                                *
  4948******************************************************************
  4949*                   C H A N G E   L O G
  4950*
  4951* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4952*-----------------------------------------------------------------
  4953*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4954* EFFECTIVE    NUMBER
  4955*-----------------------------------------------------------------
  4956* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  4957* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  4958******************************************************************
  4959 01  REINSURANCE-RECORD.
  4960     12  RE-RECORD-ID                      PIC XX.
  4961         88  VALID-RE-ID                      VALUE 'RE'.
  4962
  4963     12  RE-CONTROL-PRIMARY.
  4964         16  RE-COMPANY-CD                 PIC X.
  4965         16  RE-KEY.
  4966             20  RE-CODE                   PIC X.
  4967                 88  RE-TABLE-RECORD          VALUE 'A'.
  4968                 88  RE-COMPANY-RECORD        VALUE 'B'.
  4969             20  RE-TABLE                  PIC XXX.
  4970             20  FILLER                    PIC XXX.
  4971         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  4972             20  FILLER                    PIC X.
  4973             20  RE-COMPANY.
  4974                 24  RE-COMP-PRIME         PIC XXX.
  4975                 24  RE-COMP-SUB           PIC XXX.
  4976
  4977     12  RE-MAINT-INFORMATION.
  4978         16  RE-LAST-MAINT-DT              PIC XX.
  4979         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4980         16  RE-LAST-MAINT-USER            PIC X(4).
  4981         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  93
* EL6501.cbl
  4982
  4983     12  RE-TABLE-DATA.
  4984         16  RE-100-COMP                   PIC 99.
  4985
  4986         16  RE-COMP-INFO    OCCURS 30 TIMES.
  4987             20  RE-REI-COMP-NO.
  4988                 24  RE-REI-COMP           PIC XXX.
  4989                 24  RE-REI-COMP-SUB       PIC XXX.
  4990             20  RE-LF-QC                  PIC X.
  4991             20  RE-AH-QC                  PIC X.
  4992             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  4993             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  4994             20  RE-LFAGE-LO               PIC 99.
  4995             20  RE-LFAGE-HI               PIC 99.
  4996             20  RE-AHAGE-LO               PIC 99.
  4997             20  RE-AHAGE-HI               PIC 99.
  4998             20  RE-LFTRM-LO               PIC S999       COMP-3.
  4999             20  RE-LFTRM-HI               PIC S999       COMP-3.
  5000             20  RE-AHTRM-LO               PIC S999       COMP-3.
  5001             20  RE-AHTRM-HI               PIC S999       COMP-3.
  5002             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  5003             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  5004             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  5005             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  5006             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  5007             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  5008             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  5009             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  5010             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  5011             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  5012             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  5013             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  5014             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  5015             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  5016             20  RE-LF-BEN-CODE            PIC X.
  5017             20  RE-AH-BEN-CODE            PIC X.
  5018             20  RE-INTERACTIVE            PIC X.
  5019             20  RE-REMAINING              PIC X.
  5020             20  RE-LF-RUNOFF-SW           PIC X.
  5021             20  RE-AH-RUNOFF-SW           PIC X.
  5022             20  FILLER                    PIC X(19).
  5023
  5024         16  RE-COMP-INFO-END              PIC X(6).
  5025         16  RE-NSP-ST-CD-LF               PIC XX.
  5026         16  RE-NSP-ST-CD-AH               PIC XX.
  5027         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  5028             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  5029
  5030         16  FILLER                        PIC X(27).
  5031
  5032     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  5033         16  RE-NAME                       PIC X(30).
  5034         16  RE-LF-PE                      PIC X.
  5035         16  RE-AH-PE                      PIC X.
  5036         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  5037         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  5038         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  5039         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  94
* EL6501.cbl
  5040         16  RE-PRT-ST                     PIC X.
  5041         16  RE-PRT-OW                     PIC X.
  5042         16  RE-MORT-CODE                  PIC X(4).
  5043         16  RE-CLAIM-CODE                 PIC X.
  5044         16  RE-ZERO-LF-FEE                PIC X.
  5045         16  RE-ZERO-AH-FEE                PIC X.
  5046         16  RE-CEDE-NAME                  PIC X(30).
  5047         16  RE-LF-COMM                    PIC X.
  5048         16  RE-AH-COMM                    PIC X.
  5049         16  RE-LF-TAX                     PIC X.
  5050         16  RE-AH-TAX                     PIC X.
  5051         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  5052         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  5053         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  5054
  5055         16  RE-COMP-CARRIER-SECURITY      PIC X.
  5056             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  5057
  5058         16  RE-LF-CEDING-FEE-BRACKETS.
  5059             20  RE-LF-FEE-METHOD          PIC X.
  5060                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  5061                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  5062                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  5063                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  5064             20  RE-LF-FEE-BASIS           PIC X.
  5065                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  5066                 88  RE-LF-NET-CEDED               VALUE '2'.
  5067                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  5068                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  5069                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  5070                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  5071                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5072                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  5073             20  FILLER                    PIC XXX.
  5074             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  5075                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5076                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5077
  5078         16  RE-AH-CEDING-FEE-BRACKETS.
  5079             20  RE-AH-FEE-METHOD          PIC X.
  5080                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  5081                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  5082                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  5083                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  5084             20  RE-AH-FEE-BASIS           PIC X.
  5085                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  5086                 88  RE-AH-NET-CEDED               VALUE '2'.
  5087                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  5088                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  5089                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  5090                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  5091                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  5092                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  5093             20  FILLER                    PIC XXX.
  5094             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  5095                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  5096                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  5097
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  95
* EL6501.cbl
  5098         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  5099
  5100         16  RE-OLD-CEDING-STMT            PIC X.
  5101
  5102         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  5103         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  5104         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5105         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  5106         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  5107         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  5108         16  RE-REINS-GROUPING-CODE        PIC X(6).
  5109         16  RE-MORT-SW                    PIC X.
  5110         16  RE-CEDING-TYPE-FLAG           PIC X.
  5111             88  RE-NO-CESSION-TYPE                VALUE ' '.
  5112             88  RE-CEDED                          VALUE 'C'.
  5113             88  RE-ASSUMED                        VALUE 'A'.
  5114             88  RE-PHANTOM                        VALUE 'P'.
  5115
  5116         16  RE-CEDING-STMT-OPT-A          PIC X.
  5117             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  5118         16  RE-CEDING-STMT-OPT-B          PIC X.
  5119             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  5120         16  RE-CEDING-STMT-OPT-C          PIC X.
  5121             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  5122         16  RE-CEDING-STMT-OPT-D          PIC X.
  5123             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  5124         16  RE-CEDING-STMT-OPT-E          PIC X.
  5125             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  5126
  5127         16  RE-PRT-CRSV                   PIC X.
  5128
  5129         16  RE-GL-CENTER                  PIC X(4).
  5130
  5131         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  5132
  5133         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  5134
  5135         16  RE-EARN-STOP-CODE             PIC X.
  5136             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  5137             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  5138
  5139         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  5140             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  5141
  5142         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  5143         16  FILLER                        PIC X(2281).
  5144
  5145         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  5146
  5147******************************************************************
  5148*    COPY ERCCTBL.
  5149******************************************************************
  5150*                                                                *
  5151*                                                                *
  5152*                            ERCCTBL                             *
  5153*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5154*                            VMOD=2.003
  5155*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  96
* EL6501.cbl
  5156*   ONLINE CREDIT SYSTEM                                         *
  5157*                                                                *
  5158*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  5159*                                                                *
  5160*   FILE TYPE = VSAM,KSDS                                        *
  5161*   RECORD SIZE = 200   RECFORM = FIXED                          *
  5162*                                                                *
  5163*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  5164*       ALTERNATE PATH = NONE                                    *
  5165*                                                                *
  5166*   LOG = NO                                                     *
  5167*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5168*                                                                *
  5169*                                                                *
  5170******************************************************************
  5171
  5172 01  COMM-TABLE-RECORD.
  5173     12  CT-RECORD-ID                      PIC XX.
  5174         88  VALID-CT-ID                      VALUE 'CT'.
  5175
  5176     12  CT-CONTROL-PRIMARY.
  5177         16  CT-COMPANY-CD                 PIC X.
  5178         16  CT-TABLE                      PIC XXX.
  5179         16  CT-CNTRL-2.
  5180             20  CT-BEN-TYPE               PIC X.
  5181             20  CT-BEN-CODE               PIC XX.
  5182
  5183     12  CT-MAINT-INFORMATION.
  5184         16  CT-LAST-MAINT-DT              PIC XX.
  5185         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5186         16  CT-LAST-MAINT-USER            PIC X(4).
  5187         16  FILLER                        PIC X(31).
  5188
  5189     12  CT-LIMITS.
  5190         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  5191
  5192         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  5193
  5194         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  5195
  5196     12  CT-RATES.
  5197         16  CT-RTX          OCCURS 27 TIMES.
  5198             20  CT-RT                     PIC SV9(5)     COMP-3.
  5199             20  CT-RT-R   REDEFINES
  5200                 CT-RT                     PIC XXX.
  5201
  5202     12  FILLER                            PIC  X(42).
  5203
  5204******************************************************************
  5205*                                COPY ERCACNT.
  5206******************************************************************
  5207*                                                                *
  5208*                                                                *
  5209*                            ERCACNT.                            *
  5210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5211*                            VMOD=2.002                          *
  5212*                                                                *
  5213*   FILE DESCRIPTION = NOTE FILE FOR RECORDING OF ACCOUNT NOTES  *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  97
* EL6501.cbl
  5214*                                                                *
  5215*   FILE TYPE = VSAM,KSDS                                        *
  5216*   RECORD SIZE = 120   RECFORM = FIXED                          *
  5217*                                                                *
  5218*   BASE CLUSTER NAME = ERACNT             RKP=2,LEN=23          *
  5219*       ALTERNATE INDEX = NONE                                   *
  5220*                                                                *
  5221*                                                                *
  5222*   LOG = YES                                                    *
  5223*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5224******************************************************************
  5225*                   C H A N G E   L O G
  5226*
  5227* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5228*-----------------------------------------------------------------
  5229*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5230* EFFECTIVE    NUMBER
  5231*-----------------------------------------------------------------
  5232* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
  5233*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
  5234******************************************************************
  5235 01  NOTE-FILE.
  5236     12  NT-FILE-ID                  PIC XX.
  5237         88  VALID-NOTE-ID              VALUE 'NT'.
  5238
  5239     12  NT-CONTROL-PRIMARY.
  5240         16  NT-COMPANY-CD           PIC X.
  5241         16  NT-ACCT-NOTE-KEY.
  5242             18  NT-CARRIER              PIC X.
  5243             18  NT-GROUPING             PIC X(06).
  5244             18  NT-STATE                PIC XX.
  5245             18  NT-ACCOUNT              PIC X(10).
  5246         16  NT-RECORD-TYPE          PIC X.
  5247              88  ACCT-NOTE          VALUE '1'.
  5248              88  ACCT-BRANCH-LOC    VALUE '2'.
  5249              88  ACCT-SHIPPING-ADDR VALUE '3'.
  5250         16  NT-LINE-SEQUENCE        PIC S9(4)     COMP.
  5251
  5252     12  NT-LAST-MAINT-DT            PIC XX.
  5253     12  NT-LAST-MAINT-BY            PIC X(4).
  5254     12  NT-LAST-MAINT-HHMMSS        PIC S9(7) COMP-3.
  5255
  5256*  ALL NOTE LINES ARE RECORD TYPE '1' WITH ALMOST UNLIMITED
  5257*     SEQUENCE NUMBERS
  5258     12  NT-NOTE-INFORMATION.
  5259         16  NT-NOTE-LINE            PIC X(60).
  5260         16  FILLER                  PIC X(25).
  5261*  BOTH BRANCH LOCATION LINES ARE RECORD TYPE '2' SEQ 1 AND 2
  5262     12  NT-LOCATION-INFORMATION REDEFINES
  5263                         NT-NOTE-INFORMATION.
  5264         16  NT-BRANCH-LOC-LINE      PIC X(60).
  5265         16  FILLER                  PIC X(25).
  5266*  ALL SHIPPING ADDRESS LINES ARE RECORD TYPE '3'AND
  5267*     SEQUENCE NUMBER 1 IS NAME LINE 1
  5268*     SEQUENCE NUMBER 2 IS NAME LINE 2
  5269*     SEQUENCE NUMBER 3 IS ADDR LINE 1
  5270*     SEQUENCE NUMBER 4 IS ADDR LINE 2
  5271*     SEQUENCE NUMBER 5 IS ADDR LINE 3
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  98
* EL6501.cbl
  5272*     SEQUENCE NUMBER 6 IS CITY, ST AND ZIP
  5273     12  NT-SHIPPING-INFORMATION REDEFINES
  5274                         NT-NOTE-INFORMATION.
  5275         16  NT-SHIPPING-LINE        PIC X(60).
  5276         16  NT-SHIP-STATE           PIC XX.
  5277         16  NT-SHIP-ZIP             PIC X(10).
  5278         16  FILLER                  PIC X(13).
  5279*****************************************************************
  5280
  5281 01  COMMISSION-WORK-AREA.
  5282     05  WK-AGT-COMMS   OCCURS 10 TIMES.
  5283         10  WK-AM-AGT           PIC X(10).
  5284         10  WK-AM-TYPE          PIC X.
  5285         10  WK-FILLER           PIC X(13).
  5286         10  WK-GA-BILL-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page  99
* EL6501.cbl
  5288*    COPY ERCCOMP.
  5289******************************************************************
  5290*                                                                *
  5291*                                                                *
  5292*                            ERCCOMP                             *
  5293*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5294*                            VMOD=2.019                          *
  5295*                                                                *
  5296*   ONLINE CREDIT SYSTEM                                         *
  5297*                                                                *
  5298*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  5299*                                                                *
  5300*   FILE TYPE = VSAM,KSDS                                        *
  5301*   RECORD SIZE = 700   RECFORM = FIXED                          *
  5302*                                                                *
  5303*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  5304*       ALTERNATE PATH = NONE                                    *
  5305*                                                                *
  5306*   LOG = NO                                                     *
  5307*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5308*                                                                *
  5309******************************************************************
  5310*                   C H A N G E   L O G
  5311*
  5312* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5313*-----------------------------------------------------------------
  5314*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5315* EFFECTIVE    NUMBER
  5316*-----------------------------------------------------------------
  5317* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5318* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  5319* 092205    2005050300006  PEMA  ADD LEASE FEE
  5320* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  5321* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  5322* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  5323* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5324* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  5325* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  5326******************************************************************
  5327
  5328 01  COMPENSATION-MASTER.
  5329     12  CO-RECORD-ID                          PIC XX.
  5330         88  VALID-CO-ID                          VALUE 'CO'.
  5331
  5332     12  CO-CONTROL-PRIMARY.
  5333         16  CO-COMPANY-CD                     PIC X.
  5334         16  CO-CONTROL.
  5335             20  CO-CTL-1.
  5336                 24  CO-CARR-GROUP.
  5337                     28  CO-CARRIER            PIC X.
  5338                     28  CO-GROUPING.
  5339                         32  CO-GROUP-PREFIX   PIC XXX.
  5340                         32  CO-GROUP-PRIME    PIC XXX.
  5341                 24  CO-RESP-NO.
  5342                     28  CO-RESP-PREFIX        PIC X(4).
  5343                     28  CO-RESP-PRIME         PIC X(6).
  5344             20  CO-CTL-2.
  5345                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 100
* EL6501.cbl
  5346                     28  CO-ACCT-PREFIX        PIC X(4).
  5347                     28  CO-ACCT-PRIME         PIC X(6).
  5348         16  CO-TYPE                           PIC X.
  5349             88  CO-COMPANY-TYPE                  VALUE 'C'.
  5350             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  5351             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  5352
  5353     12  CO-MAINT-INFORMATION.
  5354         16  CO-LAST-MAINT-DT                  PIC XX.
  5355         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  5356         16  CO-LAST-MAINT-USER                PIC X(4).
  5357     12  FILLER                                PIC XX.
  5358     12  CO-STMT-TYPE                          PIC XXX.
  5359     12  CO-COMP-TYPE                          PIC X.
  5360         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  5361     12  CO-STMT-OWNER                         PIC X(4).
  5362     12  CO-BALANCE-CONTROL                    PIC X.
  5363         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  5364         88  CO-NO-BALANCE                        VALUE 'N'.
  5365
  5366     12  CO-INTERNAL-CONTROL-1                 PIC X.
  5367         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  5368         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  5369         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  5370
  5371     12  CO-INTERNAL-CONTROL-2                 PIC X.
  5372         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  5373         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  5374
  5375     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  5376     12  CO-GA-DIRECT-DEP                      PIC X.
  5377     12  CO-FUTURE-SPACE                       PIC X.
  5378         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  5379
  5380     12  CO-ACCT-NAME                          PIC X(30).
  5381     12  CO-MAIL-NAME                          PIC X(30).
  5382     12  CO-ADDR-1                             PIC X(30).
  5383     12  CO-ADDR-2                             PIC X(30).
  5384     12  CO-ADDR-3.
  5385         16  CO-ADDR-CITY                      PIC X(27).
  5386         16  CO-ADDR-STATE                     PIC XX.
  5387     12  CO-CSO-1099                           PIC X.
  5388     12  CO-ZIP.
  5389         16  CO-ZIP-PRIME.
  5390             20  CO-ZIP-PRI-1ST                PIC X.
  5391                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5392             20  FILLER                        PIC X(4).
  5393         16  CO-ZIP-PLUS4                      PIC X(4).
  5394     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  5395         16  CO-CAN-POSTAL-1                   PIC XXX.
  5396         16  CO-CAN-POSTAL-2                   PIC XXX.
  5397         16  FILLER                            PIC XXX.
  5398     12  CO-SOC-SEC                            PIC X(13).
  5399     12  CO-TELEPHONE.
  5400         16  CO-AREA-CODE                      PIC XXX.
  5401         16  CO-PREFIX                         PIC XXX.
  5402         16  CO-PHONE                          PIC X(4).
  5403
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 101
* EL6501.cbl
  5404     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  5405
  5406     12  CO-AR-BAL-LEVEL                       PIC X.
  5407         88  CO-AR-REF-LVL                        VALUE '1'.
  5408         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  5409         88  CO-AR-BILL-LVL                       VALUE '2'.
  5410         88  CO-AR-AGT-LVL                        VALUE '3'.
  5411         88  CO-AR-FR-LVL                         VALUE '4'.
  5412
  5413     12  CO-AR-NORMAL-PRINT                    PIC X.
  5414         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  5415         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  5416
  5417     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  5418
  5419     12  CO-AR-REPORTING                       PIC X.
  5420         88  CO-AR-NET-REPORT                     VALUE 'N'.
  5421         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  5422
  5423     12  CO-AR-PULL-CHECK                      PIC X.
  5424         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  5425         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  5426
  5427     12  CO-AR-BALANCE-PRINT                   PIC X.
  5428         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  5429
  5430     12  CO-AR-LAST-RUN-CODE                   PIC X.
  5431         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  5432         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  5433         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  5434
  5435     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  5436
  5437     12  CO-USER-CODE                          PIC X.
  5438     12  CO-REPORT-GROUP-ID                    PIC X(12).
  5439
  5440******************************************************************
  5441*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  5442*    THE LAST MONTH END RUN.
  5443******************************************************************
  5444
  5445     12  CO-LAST-ACTIVITY-DATE.
  5446         16  CO-ACT-YEAR                       PIC 99.
  5447         16  CO-ACT-MONTH                      PIC 99.
  5448         16  CO-ACT-DAY                        PIC 99.
  5449
  5450     12  CO-LAST-STMT-DT.
  5451         16  CO-LAST-STMT-YEAR                 PIC 99.
  5452         16  CO-LAST-STMT-MONTH                PIC 99.
  5453         16  CO-LAST-STMT-DAY                  PIC 99.
  5454
  5455     12  CO-MO-END-TOTALS.
  5456         16  CO-MONTHLY-TOTALS.
  5457             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  5458             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  5459             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  5460             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  5461             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 102
* EL6501.cbl
  5462
  5463         16  CO-AGING-TOTALS.
  5464             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  5465             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  5466             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  5467             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  5468
  5469         16  CO-YTD-TOTALS.
  5470             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  5471             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  5472
  5473         16  CO-OVER-UNDER-TOTALS.
  5474             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5475             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  5476
  5477     12  CO-MISCELLANEOUS-TOTALS.
  5478         16  CO-FICA-TOTALS.
  5479             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  5480             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  5481
  5482         16  CO-CLAIM-TOTALS.
  5483             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  5484             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  5485
  5486******************************************************************
  5487*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  5488*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  5489******************************************************************
  5490
  5491     12  CO-CURRENT-TOTALS.
  5492         16  CO-CURRENT-LAST-STMT-DT.
  5493             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  5494             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  5495             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  5496
  5497         16  CO-CURRENT-MONTHLY-TOTALS.
  5498             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  5499             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  5500             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  5501             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  5502             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  5503
  5504         16  CO-CURRENT-AGING-TOTALS.
  5505             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  5506             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  5507             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  5508             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  5509
  5510         16  CO-CURRENT-YTD-TOTALS.
  5511             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  5512             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  5513
  5514     12  CO-PAID-COMM-TOTALS.
  5515         16  CO-YTD-PAID-COMMS.
  5516             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  5517             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  5518
  5519     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 103
* EL6501.cbl
  5520         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  5521         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  5522
  5523     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  5524         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  5525         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  5526         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  5527         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  5528         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  5529         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  5530         88  CO-FINAL-LETTER                  VALUE 'F'.
  5531         88  CO-RECONCILING                   VALUE 'R'.
  5532         88  CO-PHONE-CALL                    VALUE 'P'.
  5533         88  CO-LEGAL                         VALUE 'L'.
  5534         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  5535         88  CO-WRITE-OFF                     VALUE 'W'.
  5536         88  CO-NO-ACTION                     VALUE 'N' ' '.
  5537
  5538     12  CO-CSR-CODE                       PIC X(4).
  5539
  5540     12  CO-GA-STATUS-INFO.
  5541         16  CO-GA-EFFECTIVE-DT            PIC XX.
  5542         16  CO-GA-TERMINATION-DT          PIC XX.
  5543         16  CO-GA-STATUS-CODE             PIC X.
  5544             88  CO-GA-ACTIVE                 VALUE 'A'.
  5545             88  CO-GA-INACTIVE               VALUE 'I'.
  5546             88  CO-GA-PENDING                VALUE 'P'.
  5547         16  CO-GA-COMMENTS.
  5548             20  CO-GA-COMMENT-1           PIC X(40).
  5549             20  CO-GA-COMMENT-2           PIC X(40).
  5550             20  CO-GA-COMMENT-3           PIC X(40).
  5551             20  CO-GA-COMMENT-4           PIC X(40).
  5552
  5553     12  CO-RPTCD2                         PIC X(10).
  5554     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  5555         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  5556         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  5557
  5558     12  CO-TYPE-AGENT                     PIC X(01).
  5559         88  CO-CORPORATION                   VALUE 'C'.
  5560         88  CO-PARTNERSHIP                   VALUE 'P'.
  5561         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  5562         88  CO-TRUST                         VALUE 'T'.
  5563         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  5564
  5565     12  CO-FAXNO.
  5566         16  CO-FAX-AREA-CODE                  PIC XXX.
  5567         16  CO-FAX-PREFIX                     PIC XXX.
  5568         16  CO-FAX-PHONE                      PIC X(4).
  5569
  5570     12  CO-BANK-INFORMATION.
  5571         16  CO-BANK-TRANSIT-NO                PIC X(8).
  5572         16  CO-BANK-TRANSIT-NON REDEFINES
  5573             CO-BANK-TRANSIT-NO                PIC 9(8).
  5574
  5575         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  5576     12  CO-MISC-DEDUCT-INFO REDEFINES
  5577                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 104
* EL6501.cbl
  5578         16  CO-MD-GL-ACCT                     PIC X(10).
  5579         16  CO-MD-DIV                         PIC XX.
  5580         16  CO-MD-CENTER                      PIC X(4).
  5581         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  5582         16  CO-CREATE-AP-CHECK                PIC X.
  5583         16  CO-DELIVER-CK-TO-MEL              PIC X.
  5584         16  FILLER                            PIC XXX.
  5585     12  CO-ACH-STATUS                         PIC X.
  5586         88  CO-ACH-ACTIVE                         VALUE 'A'.
  5587         88  CO-ACH-PENDING                        VALUE 'P'.
  5588
  5589     12  CO-BILL-SW                            PIC X.
  5590     12  CO-CONTROL-NAME                       PIC X(30).
  5591     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  5592     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  5593     12  CO-CLP-STATE                          PIC XX.
  5594     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  5595     12  CO-SPP-REFUND-EDIT                    PIC X.
  5596
  5597******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 105
* EL6501.cbl
  5599*    COPY ERCNAME.
  5600******************************************************************
  5601*                                                                *
  5602*                                                                *
  5603*                            ERCNAME                             *
  5604*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5605*                            VMOD=2.003                          *
  5606*                                                                *
  5607*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  5608*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  5609*                                                                *
  5610*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  5611*                                                                *
  5612*   FILE TYPE = VSAM,KSDS                                        *
  5613*   RECORD SIZE = 160   RECFORM = FIX                            *
  5614*                                                                *
  5615*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  5616*                                                                *
  5617*   LOG = NO                                                     *
  5618*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5619*                                                                *
  5620*                                                                *
  5621******************************************************************
  5622
  5623 01  NAME-LOOKUP-MASTER.
  5624     12  NL-RECORD-ID                PIC  X(02).
  5625         88  VALID-NL-ID                         VALUE 'NL'.
  5626
  5627     12  NL-RECORD-KEY.
  5628         16  NL-CONTROL-PRIMARY.
  5629             20  NL-COMPANY-CD       PIC  X(01).
  5630             20  NL-NAME             PIC  X(30).
  5631             20  NL-RECORD-TYPE      PIC  X(01).
  5632                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  5633                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  5634                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  5635
  5636         16  NL-ACCOUNT-MASTER.
  5637             20  NL-AM-COMPANY-CD    PIC  X(01).
  5638             20  NL-AM-CARRIER       PIC  X(01).
  5639             20  NL-AM-GROUPING      PIC  X(06).
  5640             20  NL-AM-STATE         PIC  X(02).
  5641             20  NL-AM-ACCOUNT       PIC  X(10).
  5642             20  FILLER              PIC  X(09).
  5643
  5644         16  NL-COMPENSATION-MASTER
  5645                                 REDEFINES  NL-ACCOUNT-MASTER.
  5646             20  NL-CO-COMPANY-CD    PIC  X(01).
  5647             20  NL-CO-CARRIER       PIC  X(01).
  5648             20  NL-CO-GROUPING      PIC  X(06).
  5649             20  NL-CO-RESP-NO       PIC  X(10).
  5650             20  NL-CO-ACCOUNT       PIC  X(10).
  5651             20  NL-CO-TYPE          PIC  X(01).
  5652
  5653         16  NL-REINSURANCE-RECORD
  5654                                 REDEFINES  NL-ACCOUNT-MASTER.
  5655             20  NL-RE-COMPANY-CD    PIC  X(01).
  5656             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 106
* EL6501.cbl
  5657             20  NL-RE-COMPANY.
  5658                 24  NL-RE-COMP      PIC  X(03).
  5659                 24  NL-RE-CO-SUB    PIC  X(03).
  5660             20  NL-RE-TABLE         PIC  X(03).
  5661             20  FILLER              PIC  X(18).
  5662
  5663     12  NL-MAINT-INFORMATION.
  5664         16  NL-LAST-MAINT-DT        PIC  X(02).
  5665         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  5666         16  NL-LAST-MAINT-USER      PIC  X(04).
  5667         16  FILLER                  PIC  X(10).
  5668
  5669     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  5670         16  NL-RE-LEVEL             PIC  9(02).
  5671
  5672     12  NL-CITY                     PIC  X(15).
  5673     12  NL-ST                       PIC  XX.
  5674
  5675******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 107
* EL6501.cbl
  5677*    COPY ERCRQST.
  5678******************************************************************
  5679*                                                                *
  5680*                                                                *
  5681*                            ERCRQST.                            *
  5682*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5683*                            VMOD=2.002                          *
  5684*                                                                *
  5685*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  5686*                                                                *
  5687*   FILE TYPE = VSAM,KSDS                                        *
  5688*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5689*                                                                *
  5690*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  5691*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  5692*                                   ACCOUNT, REF, BATCH)         *
  5693*                                                RKP=9, LEN=38   *
  5694*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  5695*                                   ACCOUNT, REF, BATCH)         *
  5696*                                                RKP=47, LEN=46  *
  5697*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  5698*                                   BATCH)                       *
  5699*                                                RKP=93, LEN=24  *
  5700*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  5701*                                   REF, BATCH)                  *
  5702*                                                RKP=117, LEN=35 *
  5703*   LOG = NO                                                     *
  5704*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5705******************************************************************
  5706
  5707 01  AR-REQUEST-RECORD.
  5708     12  RQ-RECORD-ID                     PIC XX.
  5709         88  VALID-RQ-ID                        VALUE 'RQ'.
  5710
  5711     12  RQ-CONTROL-PRIMARY.
  5712         16  RQ-COMPANY-CD                PIC X.
  5713         16  RQ-ENTRY-BATCH               PIC X(6).
  5714
  5715     12  RQ-CONTROL-BY-ACCT-REF.
  5716         16  RQ-COMPANY-CD-A1             PIC X.
  5717         16  RQ-CARRIER-A1                PIC X.
  5718         16  RQ-GROUPING-A1               PIC X(6).
  5719         16  RQ-STATE-A1                  PIC XX.
  5720         16  RQ-ACCOUNT-A1                PIC X(10).
  5721         16  RQ-REFERENCE-A1              PIC X(12).
  5722         16  RQ-BATCH-A1                  PIC X(6).
  5723
  5724     12  RQ-CONTROL-BY-FIN-RESP.
  5725         16  RQ-COMPANY-CD-A2             PIC X.
  5726         16  RQ-CARRIER-A2                PIC X.
  5727         16  RQ-GROUPING-A2               PIC X(6).
  5728         16  RQ-FIN-RESP-A2               PIC X(10).
  5729         16  RQ-ACCT-AGENT-A2             PIC X(10).
  5730         16  RQ-REFERENCE-A2              PIC X(12).
  5731         16  RQ-BATCH-A2                  PIC X(6).
  5732
  5733     12  RQ-CONTROL-BY-ACCT-AGENT.
  5734         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 108
* EL6501.cbl
  5735         16  RQ-CARRIER-A3                PIC X.
  5736         16  RQ-GROUPING-A3               PIC X(6).
  5737         16  RQ-ACCT-AGENT-A3             PIC X(10).
  5738         16  RQ-BATCH-A3                  PIC X(6).
  5739
  5740     12  RQ-CONTROL-BY-SUMMARY.
  5741         16  RQ-COMPANY-CD-A4             PIC X.
  5742         16  RQ-SUMMARY-CODE              PIC X(6).
  5743         16  RQ-ACCOUNT-A4                PIC X(10).
  5744         16  RQ-REFERENCE-A4              PIC X(12).
  5745         16  RQ-BATCH-A4                  PIC X(6).
  5746
  5747     12  RQ-REQUEST-METHOD                PIC X.
  5748         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  5749         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  5750         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  5751         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  5752     12  FILLER                           PIC X.
  5753     12  RQ-STATUS                        PIC X.
  5754         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  5755         88  RQ-RESUBMIT                      VALUE 'R'.
  5756     12  RQ-PROCESSOR-ID                  PIC X(4).
  5757     12  RQ-ENTRY-DT                      PIC XX.
  5758     12  RQ-MO-END-DT                     PIC XX.
  5759     12  RQ-REQUEST-DT                    PIC XX.
  5760     12  RQ-STMT-DT                       PIC XX.
  5761     12  RQ-REVERSAL-DT                   PIC XX.
  5762     12  RQ-CREDIT-SELECT-DT              PIC XX.
  5763     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  5764
  5765     12  FILLER                           PIC X(27).
  5766
  5767******************************************************************
  5768
  5769*EJECT
  5770*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 109
* EL6501.cbl
  5772 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  5773                          PRODUCT-MASTER CONTROL-FILE
  5774                          REINSURANCE-RECORD COMM-TABLE-RECORD
  5775                          NOTE-FILE COMMISSION-WORK-AREA
  5776                          COMPENSATION-MASTER
  5777                          NAME-LOOKUP-MASTER AR-REQUEST-RECORD.
  5778 0000-DFHEXIT SECTION.
  5779     MOVE '9#                    $   ' TO DFHEIV0.
  5780     MOVE 'EL6501' TO DFHEIV1.
  5781     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5782     MOVE EIBTRMID              TO QID-TERM.
  5783
  5784     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  5785     MOVE '5'                   TO DC-OPTION-CODE.
  5786     PERFORM 9700-DATE-LINK.
  5787     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  5788     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  5789
  5790***  Y2K PROJ 7744
  5791     MOVE DC-GREG-DATE-1-YMD    TO  CYMD-CURRENT-SAVE
  5792                                    CURRENT-SAVE
  5793     MOVE DC-ALPHA-CENTURY      TO  CYMD-CURRENT-SAVE(1:2)
  5794                                    CURRENT-SAVE(1:2)
  5795***  Y2K PROJ 7744
  5796
  5797     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5798     IF EIBCALEN = 0
  5799         GO TO 8800-UNAUTHORIZED-ACCESS.
  5800
  5801     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  5802     MOVE LOW-VALUES             TO EL6501AI.
  5803
  5804
  5805* EXEC CICS HANDLE CONDITION
  5806*        PGMIDERR  (9600-PGMID-ERROR)
  5807*        ERROR     (9990-ABEND)
  5808*        QIDERR    (0500-CHECK-MAINT-TYPE)
  5809*    END-EXEC.
  5810*    MOVE '"$L.N                 ! " #00005800' TO DFHEIV0
  5811     MOVE X'22244C2E4E20202020202020' TO DFHEIV0(1:12)
  5812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5813     MOVE X'2220233030303035383030' TO DFHEIV0(25:11)
  5814     CALL 'kxdfhei1' USING DFHEIV0
  5815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5816
  5817
  5818     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5819         IF PI-CALLING-PROGRAM = XCTL-650
  5820             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5821             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5822             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5823             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5824             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5825             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5826             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5827             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5828             PERFORM 5200-DELETE-TS THRU 5299-EXIT
  5829             GO TO 0500-CHECK-MAINT-TYPE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 110
* EL6501.cbl
  5830         ELSE
  5831             PERFORM 5200-RECOVER-TS  THRU  5299-EXIT
  5832             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5833             GO TO 0600-DISPLAY-RECORD.
  5834
  5835     IF EIBAID = DFHCLEAR
  5836         GO TO 9400-CLEAR.
  5837
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 111
* EL6501.cbl
  5839 0200-RECEIVE.
  5840     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5841         MOVE ER-0008            TO EMI-ERROR
  5842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5843         MOVE -1                 TO PFENTERL
  5844         GO TO 8200-SEND-DATAONLY.
  5845
  5846
  5847* EXEC CICS RECEIVE
  5848*        MAP      (MAP-NAME)
  5849*        MAPSET   (MAPSET-NAME)
  5850*        INTO     (EL6501AI)
  5851*    END-EXEC.
  5852     MOVE LENGTH OF
  5853      EL6501AI
  5854       TO DFHEIV11
  5855*    MOVE '8"T I  L              ''   #00005834' TO DFHEIV0
  5856     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5857     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5858     MOVE X'2020233030303035383334' TO DFHEIV0(25:11)
  5859     CALL 'kxdfhei1' USING DFHEIV0,
  5860           MAP-NAME,
  5861           EL6501AI,
  5862           DFHEIV11,
  5863           MAPSET-NAME,
  5864           DFHEIV99,
  5865           DFHEIV99
  5866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5867
  5868
  5869     IF PFENTERL = 0
  5870         GO TO 0300-CHECK-PFKEYS.
  5871     IF EIBAID NOT = DFHENTER
  5872         MOVE ER-0004            TO EMI-ERROR
  5873         GO TO 0320-INPUT-ERROR.
  5874     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  5875         MOVE PF-VALUES (PFENTERI) TO EIBAID
  5876     ELSE
  5877         MOVE ER-0029            TO EMI-ERROR
  5878         GO TO 0320-INPUT-ERROR.
  5879
  5880 0300-CHECK-PFKEYS.
  5881     IF EIBAID = DFHPF23
  5882         GO TO 8810-PF23.
  5883     IF EIBAID = DFHPF24
  5884         GO TO 9200-RETURN-MAIN-MENU.
  5885     IF EIBAID = DFHPF12
  5886         GO TO 9500-PF12.
  5887
  5888* CHECK PF10 KEY FOR A CALL TO EL608 TO BROWSE RESIDENT STATE TAX
  5889*             MASTER(ERRESC)
  5890*
  5891*    IF  EIBAID = DFHPF10
  5892*        IF PI-COMPANY-ID = 'DMD'
  5893*           PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5894*           MOVE LOW-VALUES TO WS-DMD-AGENT
  5895*           PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5896*           PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 112
* EL6501.cbl
  5897*           PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5898*           MOVE EIBAID       TO PI-ENTRY-CD-1
  5899*           MOVE WS-COMP-DATE TO PI-PREV-VG-ACCOUNT (11:5)
  5900*           MOVE WS-DMD-AGENT TO PI-PREV-VG-ACCOUNT (1:10)
  5901*           MOVE XCTL-608           TO PGM-NAME
  5902*                                      PI-RETURN-TO-PROGRAM
  5903*                                      PI-CALLING-PROGRAM
  5904*           MOVE '106E'             TO PI-CURRENT-SCREEN-NO
  5905*           GO TO 9300-XCTL.
  5906
  5907     IF (EIBAID = DFHPF1  OR  DFHPF2  OR DFHPF3 OR
  5908                  DFHPF4  OR  DFHPF5  OR DFHPF7 OR
  5909                  DFHPF8  OR  DFHPF9 OR DFHPF10)
  5910         IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  5911             MOVE ER-0029        TO  EMI-ERROR
  5912             GO TO 0320-INPUT-ERROR
  5913         ELSE
  5914             GO TO 0800-CHECK-MAINT.
  5915
  5916     IF EIBAID = DFHENTER
  5917         GO TO 0330-EDIT-DATA.
  5918
  5919     MOVE ER-0029                TO EMI-ERROR.
  5920
  5921 0320-INPUT-ERROR.
  5922     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5923     MOVE AL-UNBON               TO PFENTERA.
  5924     MOVE -1                     TO PFENTERL.
  5925     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 113
* EL6501.cbl
  5927 0330-EDIT-DATA.
  5928     IF MAINTI  = 'S'
  5929        PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT
  5930        PERFORM 6500-READ-ACCT       THRU 6599-EXIT
  5931        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5932        PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT
  5933        MOVE -1                  TO MAINTL
  5934        GO TO 8100-SEND-INITIAL-MAP.
  5935
  5936     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  5937     PERFORM 6800-COMPANY-REC-READ THRU 6899-EXIT.
  5938
  5939     IF EMI-ERROR NOT = ZEROS
  5940         MOVE -1                 TO MAINTL
  5941         GO TO 8200-SEND-DATAONLY.
  5942
  5943     IF NOT MODIFY-CAP
  5944         MOVE 'UPDATE'           TO SM-READ
  5945         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5946         MOVE ER-0070            TO EMI-ERROR
  5947         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5948         GO TO 8100-SEND-INITIAL-MAP.
  5949
  5950     MOVE SAVE-BIN-DATE          TO BIN-CURRENT-SAVE.
  5951
  5952     IF MAINTI = 'A'
  5953        GO TO 1000-ADD-A-RECORD.
  5954
  5955     IF MAINTI = 'C'
  5956        IF PI-SV-MAINT  =  'L'
  5957            MOVE -1             TO MAINTL
  5958            MOVE AL-UABON       TO MAINTA
  5959            MOVE ER-0899        TO EMI-ERROR
  5960            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5961            GO TO 8200-SEND-DATAONLY
  5962        ELSE
  5963            GO TO 2000-CHANGE-A-RECORD.
  5964
  5965     IF MAINTI = 'L'
  5966        MOVE 'L'                TO PI-SV-MAINT
  5967        GO TO 3000-CHANGE-ALL-RECORDS.
  5968
  5969     MOVE ER-0023                TO EMI-ERROR.
  5970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5971     MOVE -1                     TO MAINTL.
  5972     MOVE AL-UABON               TO MAINTA.
  5973     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 114
* EL6501.cbl
  5975 0500-CHECK-MAINT-TYPE.
  5976     IF PI-MAINT = 'A'
  5977        PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT
  5978        PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT
  5979        MOVE -1                  TO NAMEL
  5980        GO TO 8100-SEND-INITIAL-MAP.
  5981
  5982 0600-DISPLAY-RECORD.
  5983     PERFORM 0700-FORMAT-KEYDATA  THRU 0700-EXIT.
  5984     PERFORM 6500-READ-ACCT       THRU 6599-EXIT.
  5985     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  5986     PERFORM 6000-MOVE-TO-SCREEN  THRU 6099-EXIT.
  5987
  5988     IF PI-MAINT = 'A'
  5989        MOVE -1                  TO NAMEL
  5990     ELSE
  5991        MOVE -1                  TO MAINTL.
  5992
  5993     GO TO 8100-SEND-INITIAL-MAP.
  5994
  5995 0700-FORMAT-KEYDATA.
  5996     MOVE PI-MAINT               TO MAINTI.
  5997
  5998     IF PI-MAINT = 'A'
  5999        MOVE AL-PANON            TO MAINTA
  6000        SET T-INDEX TO 1
  6001     ELSE
  6002        SET T-INDEX              TO PI-LINE-SELECTED
  6003        MOVE AL-UANON            TO MAINTA.
  6004
  6005     IF PI-2ND-PAGE
  6006         SET T-INDEX UP BY 8
  6007     ELSE
  6008     IF PI-3RD-PAGE
  6009         SET T-INDEX UP BY 16
  6010     ELSE
  6011     IF PI-LST-PAGE
  6012         SET T-INDEX UP BY 24.
  6013
  6014     MOVE PI-ACCT-CARRIER        TO CARRI.
  6015     MOVE PI-ACCT-GROUPING       TO GROUPINI.
  6016     MOVE PI-ACCT-STATE          TO STATEI.
  6017     MOVE PI-ACCT-ACCOUNT        TO ACCOUNTI.
  6018
  6019     IF PI-ACCT-EXP-DT = LOW-VALUES
  6020        MOVE SPACES              TO EXPDTEI
  6021     ELSE
  6022        IF PI-ACCT-EXP-DT NOT = HIGH-VALUES
  6023           MOVE PI-ACCT-EXP-DT      TO DC-BIN-DATE-1
  6024           MOVE SPACE               TO DC-OPTION-CODE
  6025           PERFORM 9700-DATE-LINK
  6026           MOVE DC-GREG-DATE-1-EDIT TO EXPDTEI
  6027        ELSE
  6028           MOVE 999999              TO EXPDTEO
  6029           INSPECT EXPDTEI CONVERTING SPACES TO '/'.
  6030
  6031***DMD CUSTOM CODE *****START
  6032     MOVE EXPDTEI (1:2)             TO WS-YYYYMMDD (5:2).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 115
* EL6501.cbl
  6033     MOVE EXPDTEI (4:2)             TO WS-YYYYMMDD (7:2).
  6034     MOVE EXPDTEI (6:2)             TO WS-YYYYMMDD (3:2).
  6035     IF EXPDTEI (7:1) IS NOT EQUAL TO '9'
  6036        MOVE '20'                 TO WS-YYYYMMDD (1:2)
  6037     ELSE
  6038        MOVE '19'                 TO WS-YYYYMMDD (1:2).
  6039***DMD CUSTOM CODE *****END
  6040
  6041     MOVE PI-BIN-EFF-DT (T-INDEX) TO DC-BIN-DATE-1.
  6042     MOVE SPACE                   TO DC-OPTION-CODE.
  6043     PERFORM 9700-DATE-LINK.
  6044     MOVE DC-GREG-DATE-1-EDIT     TO EFFDTEI.
  6045
  6046 0700-EXIT.
  6047      EXIT.
  6048
  6049 0800-CHECK-MAINT.
  6050     IF PI-MAINT = 'A'
  6051        IF PI-RECORD-NOT-CREATED
  6052           MOVE ER-2071          TO EMI-ERROR
  6053           MOVE  -1              TO NAMEL
  6054           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6055           GO TO 8200-SEND-DATAONLY.
  6056
  6057     IF  EIBAID = DFHPF1
  6058             AND
  6059         CREDIT-SESSION
  6060         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6061         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6062         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6063         MOVE PI-ACCT-STATE      TO PI-STATE
  6064         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6065         MOVE PI-ACCT-EXP-DT     TO PI-CERT-EFF-DT
  6066         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6067         MOVE XCTL-689           TO PGM-NAME
  6068         GO TO 9300-XCTL.
  6069
  6070     IF  EIBAID = DFHPF2 AND CREDIT-SESSION
  6071         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6072         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6073         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6074         MOVE PI-ACCT-STATE      TO PI-STATE
  6075         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6076         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
  6077         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  6078         MOVE XCTL-690           TO PGM-NAME
  6079         GO TO 9300-XCTL
  6080     END-IF.
  6081
  6082     IF EIBAID = DFHPF3
  6083             AND
  6084         CREDIT-SESSION
  6085         PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6086         MOVE PI-ACCT-CARRIER    TO PI-CARRIER
  6087         MOVE PI-ACCT-GROUPING   TO PI-GROUPING
  6088         MOVE PI-ACCT-STATE      TO PI-STATE
  6089         MOVE PI-ACCT-ACCOUNT    TO PI-ACCOUNT
  6090         MOVE LOW-VALUES         TO PI-CERT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 116
* EL6501.cbl
  6091         MOVE XCTL-653           TO PGM-NAME
  6092         GO TO 9300-XCTL.
  6093
  6094     IF EIBAID = DFHPF4
  6095         PERFORM 5100-WRITE-TS  THRU  5199-EXIT
  6096         MOVE XCTL-652           TO PGM-NAME
  6097         GO TO 9300-XCTL.
  6098
  6099     IF EIBAID = DFHPF5
  6100         MOVE XCTL-6502          TO PGM-NAME
  6101         GO TO 9300-XCTL.
  6102
  6103     IF EIBAID = DFHPF7
  6104         MOVE XCTL-6504          TO PGM-NAME
  6105         GO TO 9300-XCTL.
  6106
  6107     IF EIBAID = DFHPF8
  6108         MOVE XCTL-6506          TO PGM-NAME
  6109         GO TO 9300-XCTL.
  6110
  6111     IF EIBAID = DFHPF9
  6112        MOVE XCTL-6505           TO PGM-NAME
  6113        GO TO 9300-XCTL.
  6114
  6115     IF EIBAID = DFHPF10
  6116        IF PI-COMPANY-ID = 'DMD'
  6117           PERFORM 5100-WRITE-TS THRU 5199-EXIT
  6118           MOVE XCTL-608         TO PGM-NAME
  6119           GO TO 9300-XCTL.
  6120
  6121     MOVE ER-0029                TO EMI-ERROR.
  6122     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6123     MOVE AL-UNBON               TO PFENTERA.
  6124     MOVE -1                     TO PFENTERL.
  6125     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 117
* EL6501.cbl
  6127 1000-ADD-A-RECORD.
  6128     IF PI-MAINT = 'A'
  6129        PERFORM 4000-EDITS THRU 4900-EXIT
  6130     ELSE
  6131        MOVE ER-2180             TO EMI-ERROR
  6132        MOVE -1                  TO MAINTL
  6133        MOVE AL-UABON            TO MAINTA
  6134        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6135
  6136     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6137        EMI-FATAL-CTR    GREATER ZERO
  6138         GO TO 8200-SEND-DATAONLY.
  6139
  6140
  6141* EXEC CICS GETMAIN
  6142*         LENGTH   (ACCT-REC-LEN)
  6143*         SET      (ADDRESS OF ACCOUNT-MASTER)
  6144*         INITIMG  (GETMAIN-SPACE)
  6145*    END-EXEC.
  6146*    MOVE ',"IL                  $   #00006111' TO DFHEIV0
  6147     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6148     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6149     MOVE X'2020233030303036313131' TO DFHEIV0(25:11)
  6150     CALL 'kxdfhei1' USING DFHEIV0,
  6151           DFHEIV20,
  6152           ACCT-REC-LEN,
  6153           GETMAIN-SPACE
  6154     SET ADDRESS OF ACCOUNT-MASTER TO
  6155         DFHEIV20
  6156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6157
  6158
  6159     MOVE ZEROS          TO WSS-LF-LM-AGE (1) WSS-LF-LM-AGE (2)
  6160                            WSS-LF-LM-AGE (3) WSS-LF-LM-AGE (4)
  6161                            WSS-LF-LM-DUR (1) WSS-LF-LM-DUR (2)
  6162                            WSS-LF-LM-DUR (3) WSS-LF-LM-DUR (4)
  6163                            WSS-LF-LM-AMT (1) WSS-LF-LM-AMT (2)
  6164                            WSS-LF-LM-AMT (3) WSS-LF-LM-AMT (4).
  6165
  6166     MOVE ZEROS          TO WSS-AH-LM-AGE (1) WSS-LF-LM-AGE (2)
  6167                            WSS-AH-LM-AGE (3) WSS-LF-LM-AGE (4)
  6168                            WSS-AH-LM-DUR (1) WSS-LF-LM-DUR (2)
  6169                            WSS-AH-LM-DUR (3) WSS-LF-LM-DUR (4)
  6170                            WSS-AH-LM-AMT (1) WSS-LF-LM-AMT (2)
  6171                            WSS-AH-LM-AMT (3) WSS-LF-LM-AMT (4)
  6172                            WSS-AH-LM-MOA (1) WSS-AH-LM-MOA (2)
  6173                            WSS-AH-LM-MOA (3) WSS-AH-LM-MOA (4).
  6174
  6175     MOVE WSS-AGT-COMMS          TO AM-AGT-COMMS (1)
  6176                                    AM-AGT-COMMS (2)
  6177                                    AM-AGT-COMMS (3)
  6178                                    AM-AGT-COMMS (4)
  6179                                    AM-AGT-COMMS (5)
  6180                                    AM-AGT-COMMS (6)
  6181                                    AM-AGT-COMMS (7)
  6182                                    AM-AGT-COMMS (8)
  6183                                    AM-AGT-COMMS (9)
  6184                                    AM-AGT-COMMS (10).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 118
* EL6501.cbl
  6185
  6186     IF PI-COMPANY-ID = 'FLI'
  6187         MOVE ZEROS              TO AM-FLI-BANK-BALANCE
  6188                                    AM-FLI-BANK-1ST-6-PREM
  6189                                    AM-FLI-BANK-CAP-AMT
  6190                                    AM-FLI-AGT-SHARE-PCT (1)
  6191                                    AM-FLI-AGT-SHARE-PCT (2)
  6192                                    AM-FLI-AGT-SHARE-PCT (3)
  6193                                    AM-FLI-AGT-SHARE-PCT (4)
  6194                                    AM-FLI-AGT-SHARE-PCT (5)
  6195                                    AM-FLI-AGT-SHARE-PCT (6)
  6196                                    AM-FLI-AGT-SHARE-PCT (7)
  6197                                    AM-FLI-AGT-SHARE-PCT (8)
  6198                                    AM-FLI-AGT-SHARE-PCT (9)
  6199                                    AM-FLI-AGT-SHARE-PCT (10).
  6200
  6201     MOVE ZEROS                  TO AM-GPCD
  6202                                    AM-LF-RET
  6203                                    AM-AH-RET
  6204                                    AM-LF-OB-RATE
  6205                                    AM-LF-OB-RATE-JNT
  6206                                    AM-AH-OB-RATE
  6207                                    AM-AH-OB-RATE-JNT
  6208                                    AM-REI-FEE-LF
  6209                                    AM-REI-FEE-AH
  6210                                    AM-REI-LF-TAX
  6211                                    AM-REI-PR-PCT
  6212                                    AM-REI-78-PCT
  6213                                    AM-REI-AH-TAX
  6214                                    AM-TOL-PREM
  6215                                    AM-TOL-REF
  6216                                    AM-CLP-TOL-PCT
  6217                                    AM-TOL-CLM
  6218                                    AM-CERTS-PURGED-DATE
  6219                                    AM-HI-CERT-DATE
  6220                                    AM-LO-CERT-DATE
  6221                                    AM-1ST-PROD-DATE
  6222                                    AM-GPCD
  6223                                    AM-CAL-TABLE
  6224                                    AM-LF-DEVIATION
  6225                                    AM-LF-DEVIATION-PCT
  6226                                    AM-AH-DEVIATION
  6227                                    AM-AH-DEVIATION-PCT
  6228                                    AM-ANNIVERSARY-DATE
  6229                                    AM-TEL-NO
  6230                                    AM-ENTRY-DATE
  6231                                    AM-INACTIVE-DATE
  6232                                    AM-RET-MIN-LOSS-L
  6233                                    AM-RET-MIN-LOSS-A
  6234                                    AM-LF-RPT021-EXP-PCT
  6235                                    AM-AH-RPT021-EXP-PCT
  6236                                    AM-MAX-MON-BEN
  6237                                    AM-MAX-TOT-BEN
  6238                                    AM-DCC-MAX-MARKETING-FEE
  6239                                    AM-SPP-LEASE-COMM
  6240                                    AM-RETRO-QUALIFY-LIMIT
  6241                                    AM-RETRO-RET-PCT-LF (1)
  6242                                    AM-RETRO-RET-PCT-LF (2)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 119
* EL6501.cbl
  6243                                    AM-RETRO-RET-PCT-LF (3)
  6244                                    AM-RETRO-RET-THRU-LF (1)
  6245                                    AM-RETRO-RET-THRU-LF (2)
  6246                                    AM-RETRO-RET-THRU-LF (3)
  6247                                    AM-RETRO-RET-PCT-AH (1)
  6248                                    AM-RETRO-RET-PCT-AH (2)
  6249                                    AM-RETRO-RET-PCT-AH (3)
  6250                                    AM-RETRO-RET-THRU-AH (1)
  6251                                    AM-RETRO-RET-THRU-AH (2)
  6252                                    AM-RETRO-RET-THRU-AH (3).
  6253
  6254     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  6255        MOVE +100                TO AM-DCC-MAX-MARKETING-FEE
  6256     END-IF
  6257     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP
  6258                                    AM-AR-HI-CERT-DATE.
  6259
  6260     MOVE 'AM'                   TO AM-RECORD-ID.
  6261     MOVE PI-ACCT-KEY            TO AM-CONTROL-PRIMARY
  6262                                    AM-CONTROL-BY-VAR-GRP.
  6263
  6264     IF ST-ACCNT-CNTL
  6265        MOVE SPACES              TO AM-VG-CARRIER
  6266                                    AM-VG-GROUPING.
  6267     IF CARR-ST-ACCNT-CNTL
  6268        MOVE SPACES              TO AM-VG-GROUPING.
  6269
  6270     IF ACCNT-CNTL
  6271        MOVE SPACES              TO AM-VG-CARRIER
  6272                                    AM-VG-STATE
  6273                                    AM-VG-GROUPING.
  6274
  6275     IF CARR-ACCNT-CNTL
  6276        MOVE SPACES              TO AM-VG-STATE
  6277                                    AM-VG-GROUPING.
  6278
  6279     MOVE CURRENT-SAVE           TO AM-ENTRY-DATE.
  6280     MOVE BIN-EXPCHG-SAVE        TO AM-VG-EXPIRATION-DT.
  6281     MOVE PI-BIN-EFF-DT (1)      TO AM-EFFECTIVE-DT.
  6282
  6283     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6284     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6285     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6286
  6287     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6288
  6289     IF PI-COMPANY-ID = 'NCL'
  6290         MOVE 'N'                TO AM-AH-ONLY-INDICATOR.
  6291
  6292     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6293        EMI-FATAL-CTR    GREATER ZERO
  6294         GO TO 8200-SEND-DATAONLY.
  6295
  6296     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  6297        IF CLPSTL <= ZEROS
  6298           MOVE ER-0144          TO  EMI-ERROR
  6299           MOVE -1               TO  CLPSTL
  6300           MOVE AL-UABON         TO  CLPSTA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 120
* EL6501.cbl
  6301           PERFORM 9900-ERROR-FORMAT
  6302                                 THRU  9900-EXIT
  6303           GO TO 8200-SEND-DATAONLY
  6304        END-IF
  6305     END-IF
  6306     MOVE AM-COMM-STRUCTURE      TO AM-COMM-STRUCTURE-SAVED.
  6307     MOVE SPACE                  TO AM-COMM-CHANGE-STATUS.
  6308
  6309     MOVE +1 TO AXRF-SUB
  6310                COMM-WORK-SUB.
  6311
  6312     PERFORM 6700-BUILD-COMM-WORK     THRU 6799-EXIT.
  6313     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6314
  6315     PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6316
  6317     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6318         NEXT SENTENCE
  6319     ELSE
  6320         PERFORM 1500-ADD-COMP     THRU 1500-EXIT.
  6321
  6322
  6323* EXEC CICS WRITE
  6324*        FROM      (ACCOUNT-MASTER)
  6325*        RIDFLD    (AM-CONTROL-PRIMARY)
  6326*        DATASET   (ACCT-FILE-ID)
  6327*    END-EXEC.
  6328     MOVE LENGTH OF
  6329      ACCOUNT-MASTER
  6330       TO DFHEIV11
  6331*    MOVE '&$ L                  ''   #00006280' TO DFHEIV0
  6332     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6333     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6334     MOVE X'2020233030303036323830' TO DFHEIV0(25:11)
  6335     CALL 'kxdfhei1' USING DFHEIV0,
  6336           ACCT-FILE-ID,
  6337           ACCOUNT-MASTER,
  6338           DFHEIV11,
  6339           AM-CONTROL-PRIMARY,
  6340           DFHEIV99,
  6341           DFHEIV99
  6342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6343
  6344
  6345     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6346
  6347     MOVE PI-MAINT               TO PI-SV-MAINT.
  6348     MOVE 'C'                    TO PI-MAINT.
  6349     MOVE LOW-VALUES             TO EL6501AI.
  6350
  6351     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6352     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6353     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6354
  6355     IF PI-COMPANY-ID = 'NCL'
  6356         MOVE ER-4011            TO EMI-ERROR
  6357      ELSE
  6358         MOVE ER-0000            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 121
* EL6501.cbl
  6359
  6360     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6361
  6362     MOVE -1                     TO MAINTL.
  6363     MOVE AL-UANON               TO MAINTA.
  6364     MOVE '1'                    TO PI-RECORD-ADDED-SW.
  6365     GO TO 8100-SEND-INITIAL-MAP.
  6366
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 122
* EL6501.cbl
  6368 1500-ADD-COMP.
  6369
  6370* EXEC CICS GETMAIN
  6371*         LENGTH   (COMP-REC-LEN)
  6372*         SET      (ADDRESS OF COMPENSATION-MASTER)
  6373*         INITIMG  (GETMAIN-SPACE)
  6374*    END-EXEC.
  6375*    MOVE ',"IL                  $   #00006310' TO DFHEIV0
  6376     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6377     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6378     MOVE X'2020233030303036333130' TO DFHEIV0(25:11)
  6379     CALL 'kxdfhei1' USING DFHEIV0,
  6380           DFHEIV20,
  6381           COMP-REC-LEN,
  6382           GETMAIN-SPACE
  6383     SET ADDRESS OF COMPENSATION-MASTER TO
  6384         DFHEIV20
  6385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6386
  6387
  6388     MOVE SPACES                 TO COMPENSATION-MASTER.
  6389     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  6390                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  6391                   CO-OV30         CO-OV60      CO-OV90
  6392                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  6393                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  6394                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  6395                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  6396                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  6397                   CO-CURRENT-CUR     CO-CURRENT-OV30
  6398                   CO-CURRENT-OV60    CO-CURRENT-OV90
  6399                   CO-CURRENT-CUR-PMT
  6400                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  6401                   CO-ACT-YEAR        CO-ACT-MONTH
  6402                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  6403                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  6404                   CO-CURRENT-LAST-STMT-YEAR
  6405                   CO-CURRENT-LAST-STMT-MONTH
  6406                   CO-CURRENT-LAST-STMT-DAY
  6407                   CO-YTD-PAID-COM
  6408                   CO-YTD-PAID-OV
  6409                   co-ov120 co-current-ov120
  6410
  6411     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  6412     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  6413     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  6414     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  6415     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  6416
  6417     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  6418         MOVE ZEROS              TO CO-CARRIER
  6419     ELSE
  6420         MOVE AM-CARRIER         TO CO-CARRIER.
  6421
  6422     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  6423         MOVE ZEROS              TO CO-GROUPING
  6424     ELSE
  6425         MOVE AM-GROUPING        TO CO-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 123
* EL6501.cbl
  6426
  6427     MOVE 'CO'                   TO CO-RECORD-ID
  6428     MOVE 'A'                    TO CO-TYPE.
  6429     MOVE AM-NAME                TO CO-ACCT-NAME.
  6430     MOVE AM-PERSON              TO CO-MAIL-NAME.
  6431     MOVE AM-ADDRS               TO CO-ADDR-1.
  6432*    MOVE AM-CITY                TO CO-ADDR-3.
  6433     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  6434     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  6435     MOVE AM-ZIP                 TO CO-ZIP.
  6436     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  6437     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  6438
  6439     IF PI-COMPANY-ID = 'NCL'
  6440         MOVE AM-ID-NO           TO  WS-SOC-SEC-WORK
  6441         IF WS-SS-TYPE = 'C' OR 'P' OR 'S' OR 'T' OR
  6442                         'X' OR 'I'
  6443             MOVE WS-SS-TYPE     TO  CO-TYPE-AGENT
  6444             MOVE WS-SOC-SEC     TO  CO-SOC-SEC
  6445         ELSE
  6446             MOVE SPACE          TO  CO-TYPE-AGENT
  6447             MOVE AM-ID-NO       TO  CO-SOC-SEC
  6448     ELSE
  6449         MOVE AM-ID-NO           TO CO-SOC-SEC.
  6450
  6451     IF AM-REMIT-TO NOT = ZERO
  6452         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  6453       ELSE
  6454         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  6455
  6456     MOVE +0                      TO AGT-SUB.
  6457
  6458     PERFORM 1600-FIND-C-AGT THRU 1600-EXIT.
  6459
  6460     IF VALID-AGT-SW = 'Y'
  6461         NEXT SENTENCE
  6462     ELSE
  6463         GO TO 1500-EXIT.
  6464
  6465     IF CO-RESP-NO = CO-ACCOUNT
  6466         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  6467     ELSE
  6468         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  6469
  6470     IF PI-AR-PROCESSING
  6471        MOVE 'G'                   TO CO-AR-REPORTING
  6472        MOVE '1'                   TO CO-AR-BAL-LEVEL
  6473        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  6474        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  6475
  6476     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  6477        MOVE 'N'                   TO CO-AR-REPORTING.
  6478
  6479     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  6480        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  6481
  6482     PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6483
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 124
* EL6501.cbl
  6484
  6485* EXEC CICS HANDLE CONDITION
  6486*         DUPREC   (1500-EXIT)
  6487*    END-EXEC.
  6488*    MOVE '"$%                   ! # #00006412' TO DFHEIV0
  6489     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6490     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6491     MOVE X'2320233030303036343132' TO DFHEIV0(25:11)
  6492     CALL 'kxdfhei1' USING DFHEIV0
  6493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6494
  6495
  6496
  6497* EXEC CICS WRITE
  6498*        FROM      (COMPENSATION-MASTER)
  6499*        RIDFLD    (CO-CONTROL-PRIMARY)
  6500*        DATASET   (COMP-FILE-ID)
  6501*    END-EXEC.
  6502     MOVE LENGTH OF
  6503      COMPENSATION-MASTER
  6504       TO DFHEIV11
  6505*    MOVE '&$ L                  ''   #00006416' TO DFHEIV0
  6506     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6507     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6508     MOVE X'2020233030303036343136' TO DFHEIV0(25:11)
  6509     CALL 'kxdfhei1' USING DFHEIV0,
  6510           COMP-FILE-ID,
  6511           COMPENSATION-MASTER,
  6512           DFHEIV11,
  6513           CO-CONTROL-PRIMARY,
  6514           DFHEIV99,
  6515           DFHEIV99
  6516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6517
  6518
  6519 1500-EXIT.
  6520      EXIT.
  6521
  6522 1600-FIND-C-AGT.
  6523     ADD 1 TO  AGT-SUB.
  6524     IF AGT-SUB GREATER 10
  6525         MOVE 'N'                TO  VALID-AGT-SW
  6526         GO TO 1600-EXIT.
  6527
  6528************************************************************
  6529**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6530************************************************************
  6531
  6532     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6533         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  6534         MOVE 'Y'                TO  VALID-AGT-SW
  6535         GO TO 1600-EXIT
  6536     ELSE
  6537         GO TO 1600-FIND-C-AGT.
  6538
  6539 1600-EXIT.
  6540     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 125
* EL6501.cbl
  6542 1700-CHANGE-COMP.
  6543     MOVE 'N'                    TO CHANGE-WAS-MADE-SW.
  6544     MOVE PI-COMPANY-CD          TO COMP-COMPANY-CD.
  6545
  6546     IF PI-ZERO-CARRIER
  6547       OR PI-ZERO-CAR-GROUP
  6548         MOVE ZEROS              TO COMP-CARRIER
  6549     ELSE
  6550         MOVE AM-CARRIER         TO COMP-CARRIER.
  6551
  6552     IF PI-ZERO-GROUPING
  6553       OR PI-ZERO-CAR-GROUP
  6554         MOVE ZEROS              TO COMP-GROUPING
  6555     ELSE
  6556         MOVE AM-GROUPING        TO COMP-GROUPING.
  6557
  6558     IF AM-REMIT-TO NOT = ZERO
  6559         MOVE AM-AGT (AM-REMIT-TO)
  6560                                 TO COMP-RESP-NO
  6561     ELSE
  6562         MOVE AM-ACCOUNT         TO COMP-RESP-NO.
  6563
  6564     MOVE ZERO                   TO AGT-SUB.
  6565
  6566     PERFORM 1800-FIND-C-AGT THRU 1899-EXIT.
  6567
  6568     IF VALID-AGT-SW = 'Y'
  6569         NEXT SENTENCE
  6570     ELSE
  6571         GO TO 1799-EXIT.
  6572
  6573     MOVE 'A'                    TO COMP-TYPE.
  6574
  6575
  6576* EXEC CICS HANDLE CONDITION
  6577*         ENDFILE     (1799-EXIT)
  6578*         NOTFND      (1799-EXIT)
  6579*    END-EXEC.
  6580*    MOVE '"$''I                  ! $ #00006478' TO DFHEIV0
  6581     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  6582     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6583     MOVE X'2420233030303036343738' TO DFHEIV0(25:11)
  6584     CALL 'kxdfhei1' USING DFHEIV0
  6585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6586
  6587
  6588
  6589* EXEC CICS READ
  6590*        UPDATE
  6591*        DATASET   (COMP-FILE-ID)
  6592*        SET       (ADDRESS OF COMPENSATION-MASTER)
  6593*        RIDFLD    (COMP-KEY)
  6594*    END-EXEC.
  6595*    MOVE '&"S        EU         (   #00006483' TO DFHEIV0
  6596     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6597     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6598     MOVE X'2020233030303036343833' TO DFHEIV0(25:11)
  6599     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 126
* EL6501.cbl
  6600           COMP-FILE-ID,
  6601           DFHEIV20,
  6602           DFHEIV99,
  6603           COMP-KEY,
  6604           DFHEIV99,
  6605           DFHEIV99,
  6606           DFHEIV99
  6607     SET ADDRESS OF COMPENSATION-MASTER TO
  6608         DFHEIV20
  6609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6610
  6611
  6612     IF (ON-LAST-DATE-RANGE)
  6613        IF NAMEL GREATER ZEROS
  6614           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6615           MOVE AM-NAME          TO CO-ACCT-NAME
  6616        END-IF
  6617        IF INCAREL GREATER ZEROS
  6618           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6619           MOVE AM-PERSON        TO CO-MAIL-NAME
  6620        END-IF
  6621        IF ADDR1L GREATER ZEROS
  6622           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6623           MOVE AM-ADDRS         TO CO-ADDR-1
  6624        END-IF
  6625        IF ACITYL  GREATER ZEROS
  6626           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6627           MOVE AM-ADDR-CITY     TO CO-ADDR-CITY
  6628        END-IF
  6629        IF ASTATEL  GREATER ZEROS
  6630           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6631           MOVE AM-ADDR-STATE    TO CO-ADDR-STATE
  6632        END-IF
  6633        IF ZIPL GREATER ZEROS
  6634           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6635           MOVE AM-ZIP           TO CO-ZIP
  6636        END-IF
  6637        IF CSRL GREATER ZEROS
  6638           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6639           MOVE AM-CSR-CODE      TO CO-CSR-CODE
  6640        END-IF
  6641        IF PHONEL GREATER ZEROS
  6642           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6643           MOVE AM-TEL-NO        TO CO-TELEPHONE
  6644        END-IF
  6645        IF TAXNOL GREATER ZEROS
  6646           MOVE 'Y'              TO CHANGE-WAS-MADE-SW
  6647           MOVE AM-ID-NO         TO CO-SOC-SEC
  6648        END-IF
  6649        IF AUTO-CANCEL-ACCOUNT
  6650           IF CO-BILL-SW = ' '
  6651              MOVE 'B'           TO CO-BILL-SW
  6652              MOVE 'Y'           TO CHANGE-WAS-MADE-SW
  6653           END-IF
  6654        END-IF
  6655     END-IF
  6656
  6657     IF PCONTL > 0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 127
* EL6501.cbl
  6658         MOVE 'Y'                TO CHANGE-WAS-MADE-SW
  6659         MOVE AM-CONTROL-NAME    TO CO-CONTROL-NAME
  6660     END-IF
  6661
  6662     IF CHANGE-WAS-MADE
  6663         MOVE BIN-CURRENT-SAVE   TO CO-LAST-MAINT-DT
  6664         MOVE PI-PROCESSOR-ID    TO CO-LAST-MAINT-USER
  6665         MOVE EIBTIME            TO CO-LAST-MAINT-HHMMSS.
  6666
  6667     IF NAMEL GREATER THAN ZERO
  6668         PERFORM 2200-ADD-COMPENSATION-NAME THRU 2200-EXIT.
  6669
  6670
  6671* EXEC CICS REWRITE
  6672*        FROM      (COMPENSATION-MASTER)
  6673*        DATASET   (COMP-FILE-ID)
  6674*    END-EXEC.
  6675     MOVE LENGTH OF
  6676      COMPENSATION-MASTER
  6677       TO DFHEIV11
  6678*    MOVE '&& L                  %   #00006548' TO DFHEIV0
  6679     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6680     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6681     MOVE X'2020233030303036353438' TO DFHEIV0(25:11)
  6682     CALL 'kxdfhei1' USING DFHEIV0,
  6683           COMP-FILE-ID,
  6684           COMPENSATION-MASTER,
  6685           DFHEIV11,
  6686           DFHEIV99
  6687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6688
  6689
  6690 1799-EXIT.
  6691     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 128
* EL6501.cbl
  6693 1800-FIND-C-AGT.
  6694     ADD 1                       TO  AGT-SUB.
  6695
  6696     IF AGT-SUB GREATER 10
  6697         MOVE 'N'                TO  VALID-AGT-SW
  6698         GO TO 1899-EXIT.
  6699
  6700************************************************************
  6701**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  6702************************************************************
  6703
  6704     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F'
  6705         MOVE AM-AGT (AGT-SUB)   TO  COMP-ACCOUNT
  6706         MOVE 'Y'                TO  VALID-AGT-SW
  6707         GO TO 1899-EXIT
  6708     ELSE
  6709         GO TO 1800-FIND-C-AGT.
  6710
  6711 1899-EXIT.
  6712     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 129
* EL6501.cbl
  6714 2000-CHANGE-A-RECORD.
  6715     PERFORM 4000-EDITS THRU 4900-EXIT.
  6716
  6717     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6718        EMI-FATAL-CTR    GREATER ZERO
  6719         GO TO 8200-SEND-DATAONLY.
  6720
  6721
  6722* EXEC CICS READ
  6723*        UPDATE
  6724*        DATASET   (ACCT-FILE-ID)
  6725*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6726*        RIDFLD    (PI-ACCT-KEY)
  6727*    END-EXEC.
  6728*    MOVE '&"S        EU         (   #00006584' TO DFHEIV0
  6729     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6730     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6731     MOVE X'2020233030303036353834' TO DFHEIV0(25:11)
  6732     CALL 'kxdfhei1' USING DFHEIV0,
  6733           ACCT-FILE-ID,
  6734           DFHEIV20,
  6735           DFHEIV99,
  6736           PI-ACCT-KEY,
  6737           DFHEIV99,
  6738           DFHEIV99,
  6739           DFHEIV99
  6740     SET ADDRESS OF ACCOUNT-MASTER TO
  6741         DFHEIV20
  6742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6743
  6744
  6745     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  6746
  6747     IF NOT PI-AR-PROCESSING
  6748        GO TO 2075-PROCESS-CHANGE.
  6749
  6750     MOVE AM-AGT (AM-REMIT-TO)   TO SAVE-FIN-RESP.
  6751     MOVE +0                     TO SUB1.
  6752
  6753 2075-PROCESS-CHANGE.
  6754     PERFORM 5000-MOVE-TO-RECORD THRU 5000-EXIT.
  6755
  6756     IF PI-AR-PROCESSING
  6757        PERFORM 5300-UPDATE-REQUEST-FILE THRU 5399-EXIT.
  6758
  6759     IF PI-COMPANY-ID = 'DMD'
  6760     IF AM-ANNIVERSARY-DATE = ZEROS
  6761           MOVE ER-0852             TO EMI-ERROR
  6762           MOVE -1                  TO CONTRL
  6763           MOVE AL-UABON            TO CONTRA
  6764           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6765
  6766     IF EMI-FORCABLE-CTR GREATER ZERO  OR
  6767        EMI-FATAL-CTR    GREATER ZERO
  6768         GO TO 8200-SEND-DATAONLY.
  6769
  6770     MOVE +1                     TO AXRF-SUB
  6771                                    COMM-WORK-SUB.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 130
* EL6501.cbl
  6772     PERFORM 6900-READ-AND-CHECK-AXRF THRU 6999-EXIT.
  6773
  6774     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  6775     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  6776     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  6777
  6778     IF ((PI-FST-PAGE)
  6779        AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  6780                      OR
  6781        ((PI-2ND-PAGE)
  6782        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  6783                      OR
  6784        ((PI-3RD-PAGE)
  6785        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  6786                      OR
  6787        ((PI-LST-PAGE)
  6788        AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  6789        SET ON-LAST-DATE-RANGE   TO TRUE
  6790     END-IF
  6791     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  6792         NEXT SENTENCE
  6793     ELSE
  6794         IF (ON-LAST-DATE-RANGE)
  6795                          OR
  6796            ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  6797             (PCONTL > ZERO))
  6798             PERFORM 1700-CHANGE-COMP THRU 1799-EXIT.
  6799
  6800     IF NAMEL GREATER THAN ZERO
  6801         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
  6802
  6803
  6804* EXEC CICS REWRITE
  6805*        FROM      (ACCOUNT-MASTER)
  6806*        DATASET   (ACCT-FILE-ID)
  6807*    END-EXEC.
  6808     MOVE LENGTH OF
  6809      ACCOUNT-MASTER
  6810       TO DFHEIV11
  6811*    MOVE '&& L                  %   #00006649' TO DFHEIV0
  6812     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6813     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6814     MOVE X'2020233030303036363439' TO DFHEIV0(25:11)
  6815     CALL 'kxdfhei1' USING DFHEIV0,
  6816           ACCT-FILE-ID,
  6817           ACCOUNT-MASTER,
  6818           DFHEIV11,
  6819           DFHEIV99
  6820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6821
  6822
  6823     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  6824
  6825     IF CSRL GREATER ZEROS
  6826         GO TO 3500-CHANGE-ALL-CSR.
  6827
  6828     MOVE ER-0000                TO EMI-ERROR.
  6829     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 131
* EL6501.cbl
  6830     MOVE LOW-VALUES             TO EL6501AI.
  6831
  6832     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  6833     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  6834     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  6835
  6836     MOVE ER-0000                TO EMI-ERROR.
  6837     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6838
  6839     MOVE -1                     TO MAINTL.
  6840     MOVE AL-UANON               TO MAINTA.
  6841     GO TO 8100-SEND-INITIAL-MAP.
  6842
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 132
* EL6501.cbl
  6844 2100-ADD-ACCOUNT-NAME.
  6845
  6846* EXEC CICS HANDLE CONDITION
  6847*         DUPREC   (2100-EXIT)
  6848*    END-EXEC.
  6849*    MOVE '"$%                   ! % #00006676' TO DFHEIV0
  6850     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6852     MOVE X'2520233030303036363736' TO DFHEIV0(25:11)
  6853     CALL 'kxdfhei1' USING DFHEIV0
  6854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6855
  6856
  6857
  6858* EXEC CICS GETMAIN
  6859*         LENGTH   (NAME-REC-LEN)
  6860*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6861*         INITIMG  (GETMAIN-SPACE)
  6862*    END-EXEC.
  6863*    MOVE ',"IL                  $   #00006680' TO DFHEIV0
  6864     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6865     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6866     MOVE X'2020233030303036363830' TO DFHEIV0(25:11)
  6867     CALL 'kxdfhei1' USING DFHEIV0,
  6868           DFHEIV20,
  6869           NAME-REC-LEN,
  6870           GETMAIN-SPACE
  6871     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6872         DFHEIV20
  6873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6874
  6875
  6876     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6877     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6878     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6879     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6880     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6881     MOVE AM-NAME                TO  NL-NAME.
  6882     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6883        MOVE NL-NAME (5:26)      TO NL-NAME
  6884     END-IF
  6885     MOVE AM-ADDR-CITY           TO  NL-CITY.
  6886     MOVE AM-ADDR-STATE          TO  NL-ST.
  6887     MOVE 'A'                    TO  NL-RECORD-TYPE.
  6888     MOVE PI-COMPANY-CD          TO  NL-AM-COMPANY-CD.
  6889     MOVE AM-CARRIER             TO  NL-AM-CARRIER.
  6890     MOVE AM-GROUPING            TO  NL-AM-GROUPING.
  6891     MOVE AM-STATE               TO  NL-AM-STATE.
  6892     MOVE AM-ACCOUNT             TO  NL-AM-ACCOUNT.
  6893
  6894
  6895* EXEC CICS WRITE
  6896*        FROM      (NAME-LOOKUP-MASTER)
  6897*        RIDFLD    (NL-CONTROL-PRIMARY)
  6898*        DATASET   (NAME-FILE-ID)
  6899*    END-EXEC.
  6900     MOVE LENGTH OF
  6901      NAME-LOOKUP-MASTER
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 133
* EL6501.cbl
  6902       TO DFHEIV11
  6903*    MOVE '&$ L                  ''   #00006704' TO DFHEIV0
  6904     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6905     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6906     MOVE X'2020233030303036373034' TO DFHEIV0(25:11)
  6907     CALL 'kxdfhei1' USING DFHEIV0,
  6908           NAME-FILE-ID,
  6909           NAME-LOOKUP-MASTER,
  6910           DFHEIV11,
  6911           NL-CONTROL-PRIMARY,
  6912           DFHEIV99,
  6913           DFHEIV99
  6914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6915
  6916
  6917 2100-EXIT.
  6918     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 134
* EL6501.cbl
  6920 2200-ADD-COMPENSATION-NAME.
  6921
  6922* EXEC CICS HANDLE CONDITION
  6923*         DUPREC   (2200-EXIT)
  6924*    END-EXEC.
  6925*    MOVE '"$%                   ! & #00006714' TO DFHEIV0
  6926     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  6927     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6928     MOVE X'2620233030303036373134' TO DFHEIV0(25:11)
  6929     CALL 'kxdfhei1' USING DFHEIV0
  6930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6931
  6932
  6933
  6934* EXEC CICS GETMAIN
  6935*         LENGTH   (NAME-REC-LEN)
  6936*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
  6937*         INITIMG  (GETMAIN-SPACE)
  6938*    END-EXEC.
  6939*    MOVE ',"IL                  $   #00006718' TO DFHEIV0
  6940     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6941     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6942     MOVE X'2020233030303036373138' TO DFHEIV0(25:11)
  6943     CALL 'kxdfhei1' USING DFHEIV0,
  6944           DFHEIV20,
  6945           NAME-REC-LEN,
  6946           GETMAIN-SPACE
  6947     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  6948         DFHEIV20
  6949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6950
  6951
  6952     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  6953     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  6954     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  6955     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  6956     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  6957     MOVE CO-ACCT-NAME           TO  NL-NAME.
  6958     IF NL-NAME (1:4) = 'THE ' OR 'The ' OR 'the '
  6959        MOVE NL-NAME (5:26)      TO NL-NAME
  6960     END-IF
  6961     MOVE CO-ADDR-CITY           TO  NL-CITY.
  6962     MOVE CO-ADDR-STATE          TO  NL-ST
  6963     MOVE 'C'                    TO  NL-RECORD-TYPE.
  6964     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  6965     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  6966     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  6967     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  6968     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  6969     MOVE CO-TYPE                TO  NL-CO-TYPE.
  6970
  6971
  6972* EXEC CICS WRITE
  6973*        FROM      (NAME-LOOKUP-MASTER)
  6974*        RIDFLD    (NL-CONTROL-PRIMARY)
  6975*        DATASET   (NAME-FILE-ID)
  6976*    END-EXEC.
  6977     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 135
* EL6501.cbl
  6978      NAME-LOOKUP-MASTER
  6979       TO DFHEIV11
  6980*    MOVE '&$ L                  ''   #00006743' TO DFHEIV0
  6981     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6982     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6983     MOVE X'2020233030303036373433' TO DFHEIV0(25:11)
  6984     CALL 'kxdfhei1' USING DFHEIV0,
  6985           NAME-FILE-ID,
  6986           NAME-LOOKUP-MASTER,
  6987           DFHEIV11,
  6988           NL-CONTROL-PRIMARY,
  6989           DFHEIV99,
  6990           DFHEIV99
  6991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6992
  6993
  6994 2200-EXIT.
  6995     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 136
* EL6501.cbl
  6997 3000-CHANGE-ALL-RECORDS.
  6998     MOVE LOW-VALUES             TO PI-ACCT-REST-OF-EXP.
  6999     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7000
  7001
  7002* EXEC CICS HANDLE CONDITION
  7003*         ENDFILE     (3030-END-FILE)
  7004*    END-EXEC.
  7005*    MOVE '"$''                   ! '' #00006756' TO DFHEIV0
  7006     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7007     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7008     MOVE X'2720233030303036373536' TO DFHEIV0(25:11)
  7009     CALL 'kxdfhei1' USING DFHEIV0
  7010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7011
  7012
  7013     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7014
  7015 3010-READ-NEXT.
  7016     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7017
  7018     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7019        GO TO 3030-END-FILE.
  7020
  7021
  7022* EXEC CICS ENDBR
  7023*        DATASET   (ACCT-FILE-ID)
  7024*    END-EXEC.
  7025     MOVE 0
  7026       TO DFHEIV11
  7027*    MOVE '&2                    $   #00006768' TO DFHEIV0
  7028     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7029     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7030     MOVE X'2020233030303036373638' TO DFHEIV0(25:11)
  7031     CALL 'kxdfhei1' USING DFHEIV0,
  7032           ACCT-FILE-ID,
  7033           DFHEIV11,
  7034           DFHEIV99
  7035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7036
  7037     ADD +1                      TO WS-CHANGE-ALL-CNT
  7038
  7039* EXEC CICS READ
  7040*        UPDATE
  7041*        DATASET   (ACCT-FILE-ID)
  7042*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7043*        RIDFLD    (WS-KEY-SAVE)
  7044*    END-EXEC.
  7045*    MOVE '&"S        EU         (   #00006772' TO DFHEIV0
  7046     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7047     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7048     MOVE X'2020233030303036373732' TO DFHEIV0(25:11)
  7049     CALL 'kxdfhei1' USING DFHEIV0,
  7050           ACCT-FILE-ID,
  7051           DFHEIV20,
  7052           DFHEIV99,
  7053           WS-KEY-SAVE,
  7054           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 137
* EL6501.cbl
  7055           DFHEIV99,
  7056           DFHEIV99
  7057     SET ADDRESS OF ACCOUNT-MASTER TO
  7058         DFHEIV20
  7059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7060
  7061
  7062     IF NAMEL    GREATER THAN ZERO  OR
  7063        INCAREL  GREATER THAN ZERO  OR
  7064        ADDR1L   GREATER THAN ZERO  OR
  7065        ACITYL   GREATER THAN ZERO  OR
  7066        ASTATEL  GREATER THAN ZERO  OR
  7067        ZIPL     GREATER THAN ZERO  OR
  7068        CLPTOLPL GREATER THAN ZERO  OR
  7069        PHONEL   GREATER THAN ZERO
  7070         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  7071
  7072     IF STATUSL > ZERO
  7073        EVALUATE TRUE
  7074           WHEN STATUSI = 'A'
  7075              MOVE '0'           TO AM-STATUS
  7076           WHEN STATUSI = 'I'
  7077              MOVE '1'           TO AM-STATUS
  7078           WHEN (STATUSI = 'C')
  7079              AND (AM-STATUS NOT = '3' AND 'C')
  7080              MOVE '3'           TO AM-STATUS
  7081              SET AUTO-CANCEL-ACCOUNT
  7082                                 TO TRUE
  7083           WHEN (STATUSI = 'C')
  7084              MOVE '3'           TO AM-STATUS
  7085           WHEN STATUSI = 'F'
  7086              MOVE '4'           TO AM-STATUS
  7087           WHEN STATUSI = 'S'
  7088              MOVE '5'           TO AM-STATUS
  7089           WHEN OTHER
  7090              MOVE -1            TO STATUSL
  7091              MOVE AL-UABON      TO STATUSA
  7092              MOVE ER-2153       TO EMI-ERROR
  7093              PERFORM 9900-ERROR-FORMAT
  7094                                 THRU 9900-EXIT
  7095        END-EVALUATE
  7096     END-IF
  7097*    IF STATUSL > ZERO
  7098*       IF STATUSI = 'A'
  7099*          MOVE '0'              TO AM-STATUS
  7100*       ELSE
  7101*          IF STATUSI = 'I'
  7102*             MOVE '1'           TO AM-STATUS
  7103*          ELSE
  7104*             IF STATUSI = 'C'
  7105*                IF AM-STATUS NOT = '3' AND 'C'
  7106*                   SET AUTO-CANCEL-ACCOUNT
  7107*                                TO TRUE
  7108*                END-IF
  7109*                MOVE '3'        TO AM-STATUS
  7110*             ELSE
  7111*                IF STATUSI = 'F'
  7112*                   MOVE '4'     TO AM-STATUS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 138
* EL6501.cbl
  7113*                ELSE
  7114*                   MOVE -1         TO STATUSL
  7115*                   MOVE AL-UABON   TO STATUSA
  7116*                   MOVE ER-2153    TO EMI-ERROR
  7117*                   PERFORM 9900-ERROR-FORMAT
  7118*                                THRU 9900-EXIT
  7119*                END-IF
  7120*             END-IF
  7121*          END-IF
  7122*       END-IF
  7123*    END-IF
  7124
  7125     IF CSRL GREATER ZERO
  7126        MOVE CSRI                TO AM-CSR-CODE.
  7127     IF NAMEL GREATER THAN ZERO
  7128        MOVE NAMEI               TO AM-NAME.
  7129     IF PCONTL GREATER THAN ZERO
  7130        MOVE PCONTI              TO AM-CONTROL-NAME
  7131     END-IF
  7132     IF INCAREL GREATER ZEROS
  7133        MOVE INCAREI             TO AM-PERSON.
  7134     IF ADDR1L GREATER ZEROS
  7135        MOVE ADDR1I              TO AM-ADDRS.
  7136     IF ACITYL GREATER ZEROS
  7137        MOVE ACITYI             TO AM-ADDR-CITY.
  7138     IF ASTATEL GREATER ZEROS
  7139        MOVE ASTATEI            TO AM-ADDR-STATE.
  7140     IF ZIPL NOT GREATER ZEROS
  7141         GO TO 3015-CONT-CHANGING.
  7142
  7143     MOVE ZIPI                   TO WS-ZIP-CODE.
  7144
  7145     IF WS-CANADIAN-ZIP
  7146         IF WS-ZIP-4 = SPACE  OR  '-'
  7147             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  7148             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  7149         ELSE
  7150             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  7151             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  7152     ELSE
  7153         IF WS-ZIP-6 = SPACE  OR  '-'
  7154             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  7155             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  7156         ELSE
  7157             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  7158             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  7159
  7160 3015-CONT-CHANGING.
  7161
  7162     IF CLPTOLPL GREATER ZEROS
  7163
  7164* EXEC CICS BIF
  7165*            DEEDIT
  7166*            FIELD    (CLPTOLPI)
  7167*            LENGTH   (6)
  7168*        END-EXEC
  7169     MOVE 6
  7170       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 139
* EL6501.cbl
  7171*    MOVE '@"L                   #   #00006880' TO DFHEIV0
  7172     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7173     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7174     MOVE X'2020233030303036383830' TO DFHEIV0(25:11)
  7175     CALL 'kxdfhei1' USING DFHEIV0,
  7176           CLPTOLPI,
  7177           DFHEIV11
  7178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7179         IF CLPTOLPI NUMERIC
  7180             MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  7181         ELSE
  7182             MOVE -1                  TO CLPTOLPL
  7183             MOVE AL-UNBON            TO CLPTOLPA
  7184             MOVE ER-1778             TO EMI-ERROR
  7185             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7186         END-IF
  7187     END-IF
  7188
  7189     IF LCOMML > ZEROS
  7190
  7191* EXEC CICS BIF
  7192*            DEEDIT
  7193*            FIELD    (LCOMMI)
  7194*            LENGTH   (8)
  7195*        END-EXEC
  7196     MOVE 8
  7197       TO DFHEIV11
  7198*    MOVE '@"L                   #   #00006896' TO DFHEIV0
  7199     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7200     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7201     MOVE X'2020233030303036383936' TO DFHEIV0(25:11)
  7202     CALL 'kxdfhei1' USING DFHEIV0,
  7203           LCOMMI,
  7204           DFHEIV11
  7205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7206         IF LCOMMI NUMERIC
  7207            MOVE LCOMMI          TO AM-SPP-LEASE-COMM
  7208         ELSE
  7209            MOVE -1              TO LCOMML
  7210            MOVE AL-UNBON        TO LCOMMA
  7211            MOVE ER-1778         TO EMI-ERROR
  7212            PERFORM 9900-ERROR-FORMAT
  7213                                 THRU 9900-EXIT
  7214         END-IF
  7215     END-IF
  7216
  7217     IF PHONEL GREATER ZEROS
  7218        MOVE PHONEI              TO DEEDIT-FIELD
  7219        PERFORM 8600-DEEDIT
  7220        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  7221        MOVE WS-PH1              TO AM-AREA-CODE
  7222        MOVE WS-PH2              TO AM-TEL-PRE
  7223        MOVE WS-PH3              TO AM-TEL-NBR.
  7224
  7225*    IF PSILFFL GREATER +0
  7226*       MOVE PSILFFI             TO DEEDIT-FIELD
  7227*       PERFORM 8600-DEEDIT
  7228*       IF DEEDIT-FIELD NUMERIC
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 140
* EL6501.cbl
  7229*          MOVE DEEDIT-FIELD-V5  TO AM-LF-PSI-FACTOR.
  7230*
  7231*    IF PSIAHFL GREATER +0
  7232*       MOVE PSIAHFI             TO DEEDIT-FIELD
  7233*       PERFORM 8600-DEEDIT
  7234*       IF DEEDIT-FIELD NUMERIC
  7235*          MOVE DEEDIT-FIELD-V5  TO AM-AH-PSI-FACTOR.
  7236
  7237     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7238     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7239     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7240
  7241     IF ((PI-FST-PAGE)
  7242        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT))
  7243                      OR
  7244        ((PI-2ND-PAGE)
  7245        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 8))
  7246                      OR
  7247        ((PI-3RD-PAGE)
  7248        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 16))
  7249                      OR
  7250        ((PI-LST-PAGE)
  7251        AND (PI-TOTAL-LINES = WS-CHANGE-ALL-CNT + 24))
  7252        SET ON-LAST-DATE-RANGE   TO TRUE
  7253     END-IF
  7254*    IF ((PI-FST-PAGE)
  7255*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED))
  7256*                     OR
  7257*       ((PI-2ND-PAGE)
  7258*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 8))
  7259*                     OR
  7260*       ((PI-3RD-PAGE)
  7261*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 16))
  7262*                     OR
  7263*       ((PI-LST-PAGE)
  7264*       AND (PI-TOTAL-LINES = PI-LINE-SELECTED + 24))
  7265*       SET ON-LAST-DATE-RANGE   TO TRUE
  7266*    END-IF
  7267     MOVE PI-PAGE-NUMBER TO WS-PAGE-NUMBER
  7268     MOVE PI-TOTAL-LINES TO WS-TOTAL-LINES
  7269     MOVE PI-LINE-SELECTED TO WS-LINE-SELECTED
  7270*    EXEC CICS DELAY
  7271*       INTERVAL (WS-DELAY-INT)
  7272*    END-EXEC
  7273     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7274        CONTINUE
  7275     ELSE
  7276        IF (ON-LAST-DATE-RANGE)
  7277                   OR
  7278           ((PI-COMPANY-ID = 'CID' OR 'AHL') AND
  7279           (PCONTL > ZERO))
  7280           PERFORM 1700-CHANGE-COMP
  7281                                 THRU 1799-EXIT
  7282        END-IF
  7283     END-IF
  7284
  7285     IF NAMEL GREATER THAN ZERO
  7286         PERFORM 2100-ADD-ACCOUNT-NAME THRU 2100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 141
* EL6501.cbl
  7287
  7288
  7289* EXEC CICS REWRITE
  7290*        FROM      (ACCOUNT-MASTER)
  7291*        DATASET   (ACCT-FILE-ID)
  7292*    END-EXEC.
  7293     MOVE LENGTH OF
  7294      ACCOUNT-MASTER
  7295       TO DFHEIV11
  7296*    MOVE '&& L                  %   #00006983' TO DFHEIV0
  7297     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7298     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7299     MOVE X'2020233030303036393833' TO DFHEIV0(25:11)
  7300     CALL 'kxdfhei1' USING DFHEIV0,
  7301           ACCT-FILE-ID,
  7302           ACCOUNT-MASTER,
  7303           DFHEIV11,
  7304           DFHEIV99
  7305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7306
  7307
  7308     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7309     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7310
  7311     GO TO 3010-READ-NEXT.
  7312
  7313 3030-END-FILE.
  7314     IF BROWSE-STARTED
  7315        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7316
  7317     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7318
  7319     IF AUTO-CANCEL-ACCOUNT
  7320
  7321* EXEC CICS GETMAIN
  7322*          LENGTH   (ERACNT-REC-LEN)
  7323*          SET      (ADDRESS OF NOTE-FILE)
  7324*          INITIMG  (GETMAIN-SPACE)
  7325*          RESP     (WS-RESPONSE)
  7326*       END-EXEC
  7327*    MOVE ',"IL                  $  N#00007000' TO DFHEIV0
  7328     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7329     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7330     MOVE X'204E233030303037303030' TO DFHEIV0(25:11)
  7331     CALL 'kxdfhei1' USING DFHEIV0,
  7332           DFHEIV20,
  7333           ERACNT-REC-LEN,
  7334           GETMAIN-SPACE
  7335     SET ADDRESS OF NOTE-FILE TO
  7336         DFHEIV20
  7337     MOVE EIBRESP  TO WS-RESPONSE
  7338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7339        MOVE PI-ACCT-CCGSA-KEY   TO NT-CONTROL-PRIMARY
  7340        MOVE '1'                 TO NT-RECORD-TYPE
  7341        MOVE +1                  TO NT-LINE-SEQUENCE
  7342        MOVE SAVE-BIN-DATE       TO NT-LAST-MAINT-DT
  7343        MOVE PI-PROCESSOR-ID     TO NT-LAST-MAINT-BY
  7344        MOVE EIBTIME             TO NT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 142
* EL6501.cbl
  7345        MOVE 'CANCELLED DUE TO LOW PRODUCTION'
  7346                                 TO NT-NOTE-LINE
  7347        PERFORM WITH TEST AFTER UNTIL
  7348           (NOT RESP-DUPKEY)
  7349           AND (NOT RESP-DUPREC)
  7350
  7351* EXEC CICS WRITE
  7352*             FROM      (NOTE-FILE)
  7353*             RIDFLD    (NT-CONTROL-PRIMARY)
  7354*             DATASET   (ERACNT-FILE-ID)
  7355*             RESP      (WS-RESPONSE)
  7356*          END-EXEC
  7357     MOVE LENGTH OF
  7358      NOTE-FILE
  7359       TO DFHEIV11
  7360*    MOVE '&$ L                  ''  N#00007017' TO DFHEIV0
  7361     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7362     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7363     MOVE X'204E233030303037303137' TO DFHEIV0(25:11)
  7364     CALL 'kxdfhei1' USING DFHEIV0,
  7365           ERACNT-FILE-ID,
  7366           NOTE-FILE,
  7367           DFHEIV11,
  7368           NT-CONTROL-PRIMARY,
  7369           DFHEIV99,
  7370           DFHEIV99
  7371     MOVE EIBRESP  TO WS-RESPONSE
  7372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7373           IF RESP-DUPKEY OR RESP-DUPREC
  7374              ADD +1             TO NT-LINE-SEQUENCE
  7375           END-IF
  7376        END-PERFORM
  7377     END-IF
  7378     IF NOT EMI-NO-ERRORS
  7379         GO TO 8200-SEND-DATAONLY.
  7380
  7381     MOVE -1                     TO NAMEL.
  7382     MOVE ER-0000                TO EMI-ERROR.
  7383     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7384     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 143
* EL6501.cbl
  7386 3500-CHANGE-ALL-CSR.
  7387     MOVE PI-ACCT-KEY            TO WS-KEY-SAVE.
  7388     MOVE LOW-VALUES             TO WS-ACCT-EXP-DT
  7389                                    WS-ACCT-REST-OF-EXP.
  7390
  7391
  7392* EXEC CICS HANDLE CONDITION
  7393*         ENDFILE     (3530-END-FILE)
  7394*    END-EXEC.
  7395*    MOVE '"$''                   ! ( #00007041' TO DFHEIV0
  7396     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  7397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7398     MOVE X'2820233030303037303431' TO DFHEIV0(25:11)
  7399     CALL 'kxdfhei1' USING DFHEIV0
  7400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7401
  7402
  7403     PERFORM 6300-STARTBR THRU 6300-EXIT.
  7404
  7405 3510-READ-NEXT.
  7406     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7407
  7408     IF PI-ACCT-CCGSA-KEY NOT = WS-ACCT-CCGSA-KEY
  7409        GO TO 3530-END-FILE.
  7410
  7411
  7412* EXEC CICS ENDBR
  7413*        DATASET   (ACCT-FILE-ID)
  7414*    END-EXEC.
  7415     MOVE 0
  7416       TO DFHEIV11
  7417*    MOVE '&2                    $   #00007053' TO DFHEIV0
  7418     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7419     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7420     MOVE X'2020233030303037303533' TO DFHEIV0(25:11)
  7421     CALL 'kxdfhei1' USING DFHEIV0,
  7422           ACCT-FILE-ID,
  7423           DFHEIV11,
  7424           DFHEIV99
  7425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7426
  7427
  7428
  7429* EXEC CICS READ
  7430*        UPDATE
  7431*        DATASET   (ACCT-FILE-ID)
  7432*        SET       (ADDRESS OF ACCOUNT-MASTER)
  7433*        RIDFLD    (WS-KEY-SAVE)
  7434*    END-EXEC.
  7435*    MOVE '&"S        EU         (   #00007057' TO DFHEIV0
  7436     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7437     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7438     MOVE X'2020233030303037303537' TO DFHEIV0(25:11)
  7439     CALL 'kxdfhei1' USING DFHEIV0,
  7440           ACCT-FILE-ID,
  7441           DFHEIV20,
  7442           DFHEIV99,
  7443           WS-KEY-SAVE,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 144
* EL6501.cbl
  7444           DFHEIV99,
  7445           DFHEIV99,
  7446           DFHEIV99
  7447     SET ADDRESS OF ACCOUNT-MASTER TO
  7448         DFHEIV20
  7449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7450
  7451
  7452     MOVE BIN-CURRENT-SAVE       TO AM-LAST-MAINT-DT.
  7453     MOVE PI-PROCESSOR-ID        TO AM-LAST-MAINT-USER.
  7454     MOVE EIBTIME                TO AM-LAST-MAINT-HHMMSS.
  7455
  7456     MOVE CSRI                   TO AM-CSR-CODE.
  7457
  7458
  7459* EXEC CICS REWRITE
  7460*        FROM      (ACCOUNT-MASTER)
  7461*        DATASET   (ACCT-FILE-ID)
  7462*    END-EXEC.
  7463     MOVE LENGTH OF
  7464      ACCOUNT-MASTER
  7465       TO DFHEIV11
  7466*    MOVE '&& L                  %   #00007070' TO DFHEIV0
  7467     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7468     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7469     MOVE X'2020233030303037303730' TO DFHEIV0(25:11)
  7470     CALL 'kxdfhei1' USING DFHEIV0,
  7471           ACCT-FILE-ID,
  7472           ACCOUNT-MASTER,
  7473           DFHEIV11,
  7474           DFHEIV99
  7475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7476
  7477
  7478     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  7479     PERFORM 6310-READNEXT THRU 6310-EXIT.
  7480
  7481     GO TO 3510-READ-NEXT.
  7482
  7483 3530-END-FILE.
  7484     IF BROWSE-STARTED
  7485        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7486
  7487     MOVE ER-4009                TO EMI-ERROR.
  7488     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7489     MOVE LOW-VALUES             TO EL6501AI.
  7490
  7491     PERFORM 0700-FORMAT-KEYDATA THRU 0700-EXIT.
  7492     PERFORM 6500-READ-ACCT      THRU 6599-EXIT.
  7493     PERFORM 6000-MOVE-TO-SCREEN THRU 6099-EXIT.
  7494
  7495     PERFORM 6600-UPDATE-MAINT-DT THRU 6699-EXIT.
  7496
  7497     MOVE -1                     TO MAINTL.
  7498     MOVE AL-UANON               TO MAINTA.
  7499     GO TO 8100-SEND-INITIAL-MAP.
  7500
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 145
* EL6501.cbl
  7502 4000-EDITS.
  7503     IF PI-COMPANY-ID = 'NCL'
  7504      IF MAINTI = 'A' OR 'C'
  7505        IF CSRL GREATER ZEROS
  7506            PERFORM 8050-USER-REC-READ THRU 8060-EXIT
  7507          ELSE
  7508            IF MAINTI = 'A'
  7509                MOVE ER-1883         TO EMI-ERROR
  7510                MOVE -1              TO CSRL
  7511                MOVE AL-UABON        TO CSRA
  7512                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7513
  7514     IF PI-COMPANY-ID  =  'AIG' OR 'AUK'
  7515        IF NAMEL NOT GREATER ZEROS
  7516           IF MAINTI = 'C'
  7517              GO TO 4070-CHECK-STATUS
  7518           ELSE
  7519              MOVE -1               TO  NAMEL
  7520              MOVE AL-UABON         TO  NAMEA
  7521              MOVE ER-2045          TO  EMI-ERROR
  7522              PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  7523        ELSE
  7524            GO TO 4065-CHECK-ASSOCIATES.
  7525
  7526     IF TYPEL NOT GREATER ZEROS
  7527        IF MAINTI = 'C'
  7528           GO TO 4050-CONTINUE
  7529        ELSE
  7530           GO TO 4020-BUS-TYPE-ERROR.
  7531
  7532     IF TYPEI NOT NUMERIC
  7533        GO TO 4020-BUS-TYPE-ERROR
  7534     ELSE
  7535        IF TYPEI LESS 1 OR GREATER 99
  7536           GO TO 4020-BUS-TYPE-ERROR.
  7537
  7538     MOVE SPACES                 TO ELCNTL-KEY.
  7539
  7540     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7541     MOVE TYPEI                  TO CNTL-BUS-TYPE.
  7542     MOVE '8'                    TO CNTL-REC-TYPE.
  7543     MOVE +0                     TO CNTL-SEQ-NO.
  7544
  7545
  7546* EXEC CICS HANDLE CONDITION
  7547*        NOTFND   (4020-BUS-TYPE-ERROR)
  7548*    END-EXEC.
  7549*    MOVE '"$I                   ! ) #00007142' TO DFHEIV0
  7550     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7551     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7552     MOVE X'2920233030303037313432' TO DFHEIV0(25:11)
  7553     CALL 'kxdfhei1' USING DFHEIV0
  7554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7555
  7556
  7557
  7558* EXEC CICS READ
  7559*        GTEQ
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 146
* EL6501.cbl
  7560*        DATASET   (CNTL-FILE-ID)
  7561*        SET       (ADDRESS OF CONTROL-FILE)
  7562*        RIDFLD    (ELCNTL-KEY)
  7563*    END-EXEC.
  7564*    MOVE '&"S        G          (   #00007146' TO DFHEIV0
  7565     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7566     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7567     MOVE X'2020233030303037313436' TO DFHEIV0(25:11)
  7568     CALL 'kxdfhei1' USING DFHEIV0,
  7569           CNTL-FILE-ID,
  7570           DFHEIV20,
  7571           DFHEIV99,
  7572           ELCNTL-KEY,
  7573           DFHEIV99,
  7574           DFHEIV99,
  7575           DFHEIV99
  7576     SET ADDRESS OF CONTROL-FILE TO
  7577         DFHEIV20
  7578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7579
  7580
  7581     IF TYPEI LESS 21
  7582        MOVE TYPEI               TO WS-BUS-ENTRY
  7583     ELSE
  7584        DIVIDE TYPEI BY 20
  7585            GIVING WS-BUS-TYPE REMAINDER WS-BUS-ENTRY
  7586        IF WS-BUS-ENTRY = ZEROS
  7587           MOVE 20               TO WS-BUS-ENTRY.
  7588
  7589     IF CF-BUSINESS-TITLE (WS-BUS-ENTRY) NOT = SPACES
  7590        GO TO 4050-CONTINUE.
  7591
  7592 4020-BUS-TYPE-ERROR.
  7593     MOVE -1                     TO TYPEL.
  7594     MOVE AL-UNBON               TO TYPEA.
  7595     MOVE ER-2178                TO EMI-ERROR.
  7596     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7597
  7598 4050-CONTINUE.
  7599     IF ASTATEL > 0
  7600        MOVE SPACES                 TO  ELCNTL-KEY
  7601        MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID
  7602        MOVE '3'                    TO  CNTL-REC-TYPE
  7603        MOVE ASTATEI                TO  CNTL-ACCESS (1:2)
  7604        MOVE +0                     TO  CNTL-SEQ-NO
  7605
  7606* EXEC CICS  READ
  7607*           DATASET  ('ELCNTL')
  7608*           SET      (ADDRESS OF CONTROL-FILE)
  7609*           RIDFLD   (ELCNTL-KEY)
  7610*           RESP     (WS-RESPONSE)
  7611*       END-EXEC
  7612     MOVE 'ELCNTL' TO DFHEIV1
  7613*    MOVE '&"S        E          (  N#00007177' TO DFHEIV0
  7614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7616     MOVE X'204E233030303037313737' TO DFHEIV0(25:11)
  7617     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 147
* EL6501.cbl
  7618           DFHEIV1,
  7619           DFHEIV20,
  7620           DFHEIV99,
  7621           ELCNTL-KEY,
  7622           DFHEIV99,
  7623           DFHEIV99,
  7624           DFHEIV99
  7625     SET ADDRESS OF CONTROL-FILE TO
  7626         DFHEIV20
  7627     MOVE EIBRESP  TO WS-RESPONSE
  7628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7629        IF NOT RESP-NORMAL
  7630           MOVE ER-0144                TO  EMI-ERROR
  7631           MOVE -1                     TO  ASTATEL
  7632           MOVE AL-UABON               TO  ASTATEA
  7633           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7634        END-IF
  7635     ELSE
  7636        IF MAINTI = 'A'
  7637           MOVE ER-0144                TO  EMI-ERROR
  7638           MOVE -1                     TO  ASTATEL
  7639           MOVE AL-UABON               TO  ASTATEA
  7640           PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7641        END-IF
  7642     END-IF
  7643     IF INDGRPL NOT GREATER ZEROS
  7644        IF MAINTI = 'C'
  7645           GO TO 4070-CHECK-STATUS
  7646        ELSE
  7647           GO TO 4060-IG-ERROR.
  7648
  7649     IF INDGRPI = 'I' OR 'G'
  7650        GO TO 4070-CHECK-STATUS.
  7651
  7652 4060-IG-ERROR.
  7653     MOVE -1                     TO INDGRPL.
  7654     MOVE AL-UABON               TO INDGRPA.
  7655     MOVE ER-2152                TO EMI-ERROR.
  7656     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7657
  7658 4065-CHECK-ASSOCIATES.
  7659     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  7660        MOVE  PI-ACCT-ACCOUNT    TO  WS-ACCOUNT-NUM-AREA
  7661        MOVE  NAMEI              TO  WS-NAME-AREA
  7662     ELSE
  7663        GO TO 4070-CHECK-STATUS.
  7664
  7665     IF WS-NAME-1-4  =  WS-ACCT-BRANCH-CD
  7666        NEXT SENTENCE
  7667     ELSE
  7668        MOVE -1                  TO  NAMEL
  7669        MOVE AL-UABON            TO  NAMEA
  7670        MOVE ER-0788             TO  EMI-ERROR
  7671        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7672
  7673 4070-CHECK-STATUS.
  7674     IF STATUSL NOT GREATER ZEROS
  7675        IF MAINTI = 'C'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 148
* EL6501.cbl
  7676           GO TO 4090-CHECK-STD-AH-TYPE
  7677        ELSE
  7678           MOVE 'A'              TO STATUSI
  7679           MOVE AL-UANON         TO STATUSA
  7680           GO TO 4090-CHECK-STD-AH-TYPE.
  7681
  7682     IF STATUSI = 'A' OR 'I' OR 'C' OR 'F' OR 'S'
  7683        GO TO 4090-CHECK-STD-AH-TYPE.
  7684
  7685 4080-STATUS-ERROR.
  7686     MOVE -1                     TO STATUSL.
  7687     MOVE AL-UABON               TO STATUSA.
  7688     MOVE ER-2153                TO EMI-ERROR.
  7689     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7690
  7691 4090-CHECK-STD-AH-TYPE.
  7692
  7693     IF PI-COMPANY-ID  = 'AIG' OR 'AUK'
  7694         GO TO 4900-EXIT.
  7695
  7696     IF STDBENL NOT GREATER ZEROS
  7697        IF MAINTI = 'C'
  7698*          GO TO 4110-CHECK-REMIT
  7699           GO TO 4100-CHECK-CLPTOLP
  7700        ELSE
  7701           MOVE ZEROS            TO STDBENI
  7702           MOVE AL-UANON         TO STDBENA
  7703*          GO TO 4110-CHECK-REMIT.
  7704           GO TO 4100-CHECK-CLPTOLP.
  7705
  7706     IF STDBENI = SPACES
  7707         MOVE ZEROS               TO STDBENI.
  7708     IF STDBENI = ZEROS
  7709*        GO TO 4110-CHECK-REMIT.
  7710         GO TO 4100-CHECK-CLPTOLP.
  7711
  7712     MOVE STDBENI                TO WS-EDIT-BEN-CODE.
  7713     IF INVALID-BENEFIT-CODE
  7714        GO TO 4099-STD-BEN-ERROR.
  7715
  7716     MOVE SPACES                 TO ELCNTL-KEY.
  7717
  7718     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  7719     MOVE STDBENI                TO CNTL-BEN-TYPE.
  7720     MOVE '5'                    TO CNTL-REC-TYPE.
  7721     MOVE +0                     TO CNTL-SEQ-NO.
  7722
  7723
  7724* EXEC CICS HANDLE CONDITION
  7725*        NOTFND   (4099-STD-BEN-ERROR)
  7726*    END-EXEC.
  7727*    MOVE '"$I                   ! * #00007277' TO DFHEIV0
  7728     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7729     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7730     MOVE X'2A20233030303037323737' TO DFHEIV0(25:11)
  7731     CALL 'kxdfhei1' USING DFHEIV0
  7732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7733
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 149
* EL6501.cbl
  7734
  7735
  7736* EXEC CICS READ
  7737*        GTEQ
  7738*        DATASET   (CNTL-FILE-ID)
  7739*        SET       (ADDRESS OF CONTROL-FILE)
  7740*        RIDFLD    (ELCNTL-KEY)
  7741*    END-EXEC.
  7742*    MOVE '&"S        G          (   #00007281' TO DFHEIV0
  7743     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7744     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7745     MOVE X'2020233030303037323831' TO DFHEIV0(25:11)
  7746     CALL 'kxdfhei1' USING DFHEIV0,
  7747           CNTL-FILE-ID,
  7748           DFHEIV20,
  7749           DFHEIV99,
  7750           ELCNTL-KEY,
  7751           DFHEIV99,
  7752           DFHEIV99,
  7753           DFHEIV99
  7754     SET ADDRESS OF CONTROL-FILE TO
  7755         DFHEIV20
  7756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7757
  7758
  7759     IF CNTL-COMP-ID  = CF-COMPANY-ID  AND
  7760        CNTL-REC-TYPE = CF-RECORD-TYPE
  7761         MOVE 1                  TO SUB
  7762     ELSE
  7763         GO TO 4099-STD-BEN-ERROR.
  7764
  7765 4095-CHECK-BEN-TYPE.
  7766     IF STDBENI = CF-BENEFIT-CODE (SUB)
  7767*       GO TO 4110-CHECK-REMIT.
  7768        GO TO 4100-CHECK-CLPTOLP.
  7769
  7770     IF SUB LESS 8
  7771         ADD 1 TO SUB
  7772         GO TO 4095-CHECK-BEN-TYPE.
  7773
  7774 4099-STD-BEN-ERROR.
  7775     MOVE -1                     TO STDBENL.
  7776     MOVE AL-UABON               TO STDBENA.
  7777     MOVE ER-0250                TO EMI-ERROR.
  7778     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7779
  7780 4100-CHECK-CLPTOLP.
  7781
  7782     IF CLPTOLPL > ZERO
  7783
  7784* EXEC CICS BIF
  7785*            DEEDIT
  7786*            FIELD    (CLPTOLPI)
  7787*            LENGTH   (6)
  7788*        END-EXEC
  7789     MOVE 6
  7790       TO DFHEIV11
  7791*    MOVE '@"L                   #   #00007312' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 150
* EL6501.cbl
  7792     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7793     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7794     MOVE X'2020233030303037333132' TO DFHEIV0(25:11)
  7795     CALL 'kxdfhei1' USING DFHEIV0,
  7796           CLPTOLPI,
  7797           DFHEIV11
  7798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7799         IF CLPTOLPI NOT NUMERIC
  7800             MOVE ER-1778        TO EMI-ERROR
  7801             MOVE -1             TO CLPTOLPL
  7802             MOVE AL-UNBON       TO CLPTOLPA
  7803             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7804         END-IF
  7805     END-IF.
  7806     IF LCOMML > ZERO
  7807
  7808* EXEC CICS BIF
  7809*            DEEDIT
  7810*            FIELD    (LCOMMI)
  7811*            LENGTH   (8)
  7812*        END-EXEC
  7813     MOVE 8
  7814       TO DFHEIV11
  7815*    MOVE '@"L                   #   #00007325' TO DFHEIV0
  7816     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7817     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7818     MOVE X'2020233030303037333235' TO DFHEIV0(25:11)
  7819     CALL 'kxdfhei1' USING DFHEIV0,
  7820           LCOMMI,
  7821           DFHEIV11
  7822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7823         IF LCOMMI NOT NUMERIC
  7824             MOVE ER-1778        TO EMI-ERROR
  7825             MOVE -1             TO LCOMML
  7826             MOVE AL-UNBON       TO LCOMMA
  7827             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7828         END-IF
  7829     END-IF
  7830     IF MAXMFEEL > ZEROS
  7831
  7832* EXEC CICS BIF DEEDIT
  7833*          FIELD   (MAXMFEEI)
  7834*          LENGTH  (5)
  7835*       END-EXEC
  7836     MOVE 5
  7837       TO DFHEIV11
  7838*    MOVE '@"L                   #   #00007338' TO DFHEIV0
  7839     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  7840     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7841     MOVE X'2020233030303037333338' TO DFHEIV0(25:11)
  7842     CALL 'kxdfhei1' USING DFHEIV0,
  7843           MAXMFEEI,
  7844           DFHEIV11
  7845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7846        IF MAXMFEEI NUMERIC
  7847           MOVE MAXMFEEI         TO WS-WORK-FIELD
  7848           MOVE WS-WORK-NUM      TO MAXMFEEO
  7849        ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 151
* EL6501.cbl
  7850           MOVE -1               TO MAXMFEEL
  7851           MOVE AL-UABON         TO MAXMFEEA
  7852           MOVE ER-7717          TO EMI-ERROR
  7853           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7854        END-IF
  7855     END-IF
  7856     IF (CLPSTL > 0)
  7857         MOVE AL-UANON           TO CLPSTA
  7858        IF (CLPSTI NOT = SPACES)
  7859           MOVE SPACES           TO ELCNTL-KEY
  7860           MOVE PI-COMPANY-ID    TO CNTL-COMP-ID
  7861           MOVE '3'              TO CNTL-REC-TYPE
  7862           MOVE CLPSTI           TO CNTL-ACCESS (1:2)
  7863           MOVE +0               TO CNTL-SEQ-NO
  7864
  7865* EXEC CICS  READ
  7866*              DATASET  ('ELCNTL')
  7867*              SET      (ADDRESS OF CONTROL-FILE)
  7868*              RIDFLD   (ELCNTL-KEY)
  7869*              RESP     (WS-RESPONSE)
  7870*          END-EXEC
  7871     MOVE 'ELCNTL' TO DFHEIV1
  7872*    MOVE '&"S        E          (  N#00007360' TO DFHEIV0
  7873     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7874     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7875     MOVE X'204E233030303037333630' TO DFHEIV0(25:11)
  7876     CALL 'kxdfhei1' USING DFHEIV0,
  7877           DFHEIV1,
  7878           DFHEIV20,
  7879           DFHEIV99,
  7880           ELCNTL-KEY,
  7881           DFHEIV99,
  7882           DFHEIV99,
  7883           DFHEIV99
  7884     SET ADDRESS OF CONTROL-FILE TO
  7885         DFHEIV20
  7886     MOVE EIBRESP  TO WS-RESPONSE
  7887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7888           IF NOT RESP-NORMAL
  7889              MOVE ER-0144       TO EMI-ERROR
  7890              MOVE -1            TO CLPSTL
  7891              MOVE AL-UABON      TO CLPSTA
  7892              PERFORM 9900-ERROR-FORMAT
  7893                                 THRU  9900-EXIT
  7894           END-IF
  7895        ELSE
  7896           MOVE ER-0144          TO EMI-ERROR
  7897           MOVE -1               TO CLPSTL
  7898           MOVE AL-UABON         TO CLPSTA
  7899           PERFORM 9900-ERROR-FORMAT
  7900                                 THRU  9900-EXIT
  7901        END-IF
  7902     END-IF
  7903     IF (PRODCDL > ZEROS)
  7904        and (emi-error not = er-0144)
  7905        if prodcdi = spaces
  7906           continue
  7907        else
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 152
* EL6501.cbl
  7908           move low-values       to erpdef-key
  7909           move pi-company-cd    to erpdef-company-cd
  7910           move clpsti           to erpdef-state
  7911           move prodcdi          to erpdef-prod-cd
  7912           move erpdef-key       to erpdef-key-save
  7913
  7914* exec cics read
  7915*             dataset ('ERPDEF')
  7916*             set     (address of product-master)
  7917*             ridfld  (erpdef-key)
  7918*             length  (6)
  7919*             gteq
  7920*             resp    (ws-response)
  7921*          end-exec
  7922     MOVE 'ERPDEF' TO DFHEIV1
  7923*    MOVE '&"S        G          (  N#00007391' TO DFHEIV0
  7924     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7925     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7926     MOVE X'204E233030303037333931' TO DFHEIV0(25:11)
  7927     CALL 'kxdfhei1' USING DFHEIV0,
  7928           DFHEIV1,
  7929           DFHEIV20,
  7930           DFHEIV99,
  7931           erpdef-key,
  7932           DFHEIV99,
  7933           DFHEIV99,
  7934           DFHEIV99
  7935     SET ADDRESS OF product-master TO
  7936         DFHEIV20
  7937     MOVE EIBRESP  TO ws-response
  7938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7939           if (resp-normal)
  7940              and (pd-control-primary (1:6) =
  7941                           erpdef-key-save (1:6))
  7942              continue
  7943           else
  7944              move er-8156       to emi-error
  7945              MOVE -1            TO PRODCDL
  7946              MOVE AL-UABON      TO PRODCDA
  7947              PERFORM 9900-ERROR-FORMAT
  7948                                 THRU  9900-EXIT
  7949           end-if
  7950        end-if
  7951     end-if
  7952     .
  7953 4110-CHECK-REMIT.
  7954     IF REMITL NOT GREATER ZEROS
  7955        MOVE 1                   TO REMITI
  7956        MOVE AL-UNNON            TO REMITA
  7957        GO TO 4120-REMIT-ERROR.
  7958
  7959     IF (REMITI NOT NUMERIC)  OR
  7960        (REMITI LESS 1 OR GREATER 10)
  7961           GO TO 4120-REMIT-ERROR.
  7962
  7963 4115-CHECK-AGENT.
  7964     SET M-INDEX                 TO REMITI.
  7965
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 153
* EL6501.cbl
  7966     IF AGENTL (M-INDEX)  NOT GREATER ZEROS
  7967        MOVE ER-2156             TO EMI-ERROR
  7968        GO TO 4120-R-ERROR.
  7969
  7970     GO TO 4130-CHECK-CONTRACT.
  7971
  7972 4120-REMIT-ERROR.
  7973     MOVE ER-2155                TO EMI-ERROR.
  7974
  7975 4120-R-ERROR.
  7976     MOVE -1                     TO REMITL.
  7977     MOVE AL-UABON               TO REMITA.
  7978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7979
  7980 4130-CHECK-CONTRACT.
  7981     IF CONTRL NOT = ZEROS AND CONTRI NOT = SPACES
  7982        MOVE CONTRI                TO DEEDIT-FIELD
  7983        PERFORM 8600-DEEDIT
  7984        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  7985        MOVE '4'                    TO DC-OPTION-CODE
  7986        PERFORM 9700-DATE-LINK
  7987        IF DATE-CONVERSION-ERROR
  7988           MOVE ER-2157             TO EMI-ERROR
  7989           MOVE -1                  TO CONTRL
  7990           MOVE AL-UABON            TO CONTRA
  7991           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7992        ELSE
  7993***  Y2K PROJ 7744
  7994           MOVE DC-GREG-DATE-1-EDIT TO CONTRI
  7995           MOVE AL-UANON            TO CONTRA
  7996           MOVE DC-GREG-DATE-1-YMD  TO WS-ANVR-DT
  7997           MOVE DC-ALPHA-CENTURY    TO WS-ANVR-DT(4:2)
  7998        END-IF
  7999     END-IF.
  8000***  Y2K PROJ 7744
  8001
  8002     IF PI-COMPANY-ID = 'DMD'
  8003       IF PI-MAINT = 'A'
  8004        IF CONTRL = ZERO
  8005           MOVE ER-0852             TO EMI-ERROR
  8006           MOVE -1                  TO CONTRL
  8007           MOVE AL-UABON            TO CONTRA
  8008           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8009
  8010*4131-CHECK-PSI-FACTOR.
  8011*    IF PSILFFL GREATER +0
  8012*       MOVE PSILFFI             TO DEEDIT-FIELD
  8013*       PERFORM 8600-DEEDIT
  8014*       IF DEEDIT-FIELD NUMERIC
  8015*          MOVE DEEDIT-FIELD-V5  TO WS-LIFE-PSI
  8016*                                   PSILFFO
  8017*       ELSE
  8018*          MOVE ER-9999          TO EMI-ERROR
  8019*          MOVE -1               TO PSILFFL
  8020*          MOVE AL-UABON         TO PSILFFA
  8021*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8022*
  8023*    IF PSIAHFL GREATER +0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 154
* EL6501.cbl
  8024*       MOVE PSIAHFI             TO DEEDIT-FIELD
  8025*       PERFORM 8600-DEEDIT
  8026*       IF DEEDIT-FIELD NUMERIC
  8027*          MOVE DEEDIT-FIELD-V5  TO WS-AH-PSI
  8028*                                   PSIAHFO
  8029*       ELSE
  8030*          MOVE ER-9999          TO EMI-ERROR
  8031*          MOVE -1               TO PSIAHFL
  8032*          MOVE AL-UABON         TO PSIAHFA
  8033*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8034
  8035 4135-CHECK-PREVIOUS-DATES.
  8036     IF PEFFDTEL NOT = ZEROS AND PEFFDTEI NOT = SPACES
  8037        MOVE PEFFDTEI              TO DEEDIT-FIELD
  8038        PERFORM 8600-DEEDIT
  8039        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8040        MOVE '4'                    TO DC-OPTION-CODE
  8041        PERFORM 9700-DATE-LINK
  8042        IF DATE-CONVERSION-ERROR
  8043           MOVE ER-0348             TO EMI-ERROR
  8044           MOVE -1                  TO PEFFDTEL
  8045           MOVE AL-UABON            TO PEFFDTEA
  8046           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8047        ELSE
  8048***  Y2K PROJ 7744
  8049           MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEI
  8050           MOVE AL-UANON            TO PEFFDTEA
  8051           MOVE DC-GREG-DATE-1-YMD  TO WS-PEFF-DT
  8052           MOVE DC-ALPHA-CENTURY    TO WS-PEFF-DT(4:2)
  8053        END-IF
  8054     END-IF.
  8055
  8056     IF PEXPDTEL NOT = ZEROS AND PEXPDTEI NOT = SPACES
  8057        MOVE PEXPDTEI              TO DEEDIT-FIELD
  8058        PERFORM 8600-DEEDIT
  8059        IF DEEDIT-FIELD-V0 NOT LESS 999999
  8060           MOVE '99/99/99'             TO PEXPDTEO
  8061           MOVE 99999999999            TO WS-PEXP-DT
  8062           MOVE AL-UANON               TO PEXPDTEA
  8063        ELSE
  8064           MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8065           MOVE '4'                    TO DC-OPTION-CODE
  8066           PERFORM 9700-DATE-LINK
  8067           IF DATE-CONVERSION-ERROR
  8068              MOVE ER-0454             TO EMI-ERROR
  8069              MOVE -1                  TO PEXPDTEL
  8070              MOVE AL-UABON            TO PEXPDTEA
  8071              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8072           ELSE
  8073              MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEI
  8074              MOVE AL-UANON            TO PEXPDTEA
  8075              MOVE DC-GREG-DATE-1-YMD  TO WS-PEXP-DT
  8076              MOVE DC-ALPHA-CENTURY    TO WS-PEXP-DT(4:2)
  8077           END-IF
  8078        END-IF
  8079     END-IF.
  8080***  Y2K PROJ 7744
  8081
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 155
* EL6501.cbl
  8082     IF COMMCALL NOT GREATER ZEROS
  8083         GO TO 4150-CHECK-REINCAL.
  8084
  8085     IF (PI-COMPANY-ID = 'ADL' OR 'DEF') AND
  8086         (EFFCHG-SAVE LESS 841101)       AND
  8087         (COMMCALI = 'Y' OR '1')         AND
  8088         (NOT MODIFY-CAP)
  8089           MOVE -1               TO COMMCALL
  8090           MOVE AL-UABON         TO COMMCALA
  8091           MOVE ER-2189          TO EMI-ERROR
  8092           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8093
  8094     IF COMMCALI = 'Y' OR 'N' OR '1' OR ' '
  8095         GO TO 4150-CHECK-REINCAL.
  8096
  8097 4140-COMMCAL-ERROR.
  8098     MOVE -1                     TO COMMCALL.
  8099     MOVE AL-UABON               TO COMMCALA.
  8100     MOVE ER-2158                TO EMI-ERROR.
  8101     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8102
  8103 4150-CHECK-REINCAL.
  8104     IF REINCALL NOT GREATER ZEROS
  8105         GO TO 4170-CHECK-REINTAB.
  8106
  8107     IF REINCALI = 'Y' OR 'N'
  8108        GO TO 4170-CHECK-REINTAB.
  8109
  8110 4160-REINCAL-ERROR.
  8111     MOVE -1                     TO REINCALL.
  8112     MOVE AL-UABON               TO REINCALA.
  8113     MOVE ER-2179                TO EMI-ERROR.
  8114     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8115
  8116 4170-CHECK-REINTAB.
  8117     IF REINTABL NOT GREATER ZEROS
  8118        IF PI-COMPANY-ID = 'NCL' AND
  8119           MAINTI = 'A'
  8120                MOVE ER-4010         TO EMI-ERROR
  8121                MOVE -1              TO REINTABL
  8122                MOVE AL-UABON        TO REINTABA
  8123                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8124
  8125     IF REINTABL NOT GREATER ZEROS OR REINTABI = SPACES
  8126         GO TO 4410-CHECK-AGENTS.
  8127     IF PI-COMPANY-ID = 'CID'
  8128        IF PI-ACCT-STATE = 'KY'
  8129           IF REINTABI NOT = 'K98' AND 'K99' AND 'KYA'
  8130              MOVE -1            TO REINTABL
  8131              MOVE AL-UABON      TO REINTABA
  8132              MOVE ER-2159       TO EMI-ERROR
  8133              PERFORM 9900-ERROR-FORMAT
  8134                                 THRU 9900-EXIT
  8135           END-IF
  8136        END-IF
  8137     END-IF
  8138     MOVE LOW-VALUES             TO REIN-KEY.
  8139
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 156
* EL6501.cbl
  8140     MOVE PI-COMPANY-CD          TO REIN-COMP-CD.
  8141     MOVE 'A'                    TO REIN-CODE.
  8142     MOVE REINTABI               TO REIN-TABLE.
  8143
  8144
  8145* EXEC CICS HANDLE CONDITION
  8146*        NOTFND   (4180-REIN-ERROR)
  8147*    END-EXEC.
  8148*    MOVE '"$I                   ! + #00007604' TO DFHEIV0
  8149     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8150     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8151     MOVE X'2B20233030303037363034' TO DFHEIV0(25:11)
  8152     CALL 'kxdfhei1' USING DFHEIV0
  8153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8154
  8155
  8156
  8157* EXEC CICS READ
  8158*        DATASET   (REIN-FILE-ID)
  8159*        SET       (ADDRESS OF REINSURANCE-RECORD)
  8160*        RIDFLD    (REIN-KEY)
  8161*    END-EXEC.
  8162*    MOVE '&"S        E          (   #00007608' TO DFHEIV0
  8163     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8165     MOVE X'2020233030303037363038' TO DFHEIV0(25:11)
  8166     CALL 'kxdfhei1' USING DFHEIV0,
  8167           REIN-FILE-ID,
  8168           DFHEIV20,
  8169           DFHEIV99,
  8170           REIN-KEY,
  8171           DFHEIV99,
  8172           DFHEIV99,
  8173           DFHEIV99
  8174     SET ADDRESS OF REINSURANCE-RECORD TO
  8175         DFHEIV20
  8176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8177
  8178
  8179     GO TO 4410-CHECK-AGENTS.
  8180
  8181 4180-REIN-ERROR.
  8182     MOVE -1                     TO REINTABL.
  8183     MOVE AL-UABON               TO REINTABA.
  8184     MOVE ER-2615                TO EMI-ERROR.
  8185     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8186
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 157
* EL6501.cbl
  8188 4410-CHECK-AGENTS.
  8189     MOVE PI-COMPANY-CD          TO COMM-COMP-CD.
  8190     SET M-INDEX TO 1.
  8191
  8192     IF PI-COMPANY-ID = 'NCL'
  8193       IF AGENTL (M-INDEX) GREATER ZEROS
  8194         MOVE PI-ACCT-ACCOUNT    TO AGENT  (M-INDEX).
  8195
  8196 4420-LOOP.
  8197     IF AGENTL (M-INDEX) NOT GREATER ZEROS
  8198        IF (ATYPEL (M-INDEX)  GREATER ZEROS AND
  8199            ATYPE  (M-INDEX) NOT = SPACES)  OR
  8200           SINGLEL (M-INDEX) GREATER ZEROS  OR
  8201           JOINTL  (M-INDEX) GREATER ZEROS  OR
  8202           A-HL    (M-INDEX) GREATER ZEROS  OR
  8203           RECALL  (M-INDEX) GREATER ZEROS  OR
  8204           RCOMML  (M-INDEX) GREATER ZEROS  OR
  8205           CHGBCKL (M-INDEX) GREATER ZEROS  OR
  8206           GLCODEL (M-INDEX) GREATER ZEROS
  8207           MOVE ER-2172          TO EMI-ERROR
  8208           MOVE -1               TO AGENTL (M-INDEX)
  8209           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8210           GO TO 4450-BUMP-INDEX
  8211        ELSE
  8212           GO TO 4450-BUMP-INDEX.
  8213
  8214     IF AGENT (M-INDEX) = ZEROS
  8215         MOVE ER-2970            TO  EMI-ERROR
  8216         MOVE -1                 TO  AGENTL (M-INDEX)
  8217         MOVE AL-UABON           TO  AGENTA (M-INDEX)
  8218         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8219         GO TO 4450-BUMP-INDEX.
  8220
  8221     IF ATYPEL (M-INDEX) = ZEROS
  8222        MOVE -1                  TO ATYPEL (M-INDEX)
  8223        MOVE ER-2173             TO EMI-ERROR
  8224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8225        GO TO 4430-CHECK-SINGLE.
  8226
  8227     IF ATYPE (M-INDEX) = 'C'
  8228        ADD 1                    TO WS-ACCOUNT-CTR-C
  8229       ELSE
  8230        IF ATYPE (M-INDEX) = 'R'
  8231           ADD 1                 TO WS-ACCOUNT-CTR-R
  8232          ELSE
  8233           IF ATYPE (M-INDEX) = 'D'
  8234              ADD 1                 TO WS-ACCOUNT-CTR-D
  8235             ELSE
  8236              IF ATYPE (M-INDEX) = 'O' OR 'P' OR 'T' OR 'W'
  8237                                OR 'B' OR 'I' OR 'K' OR 'L'
  8238                                OR 'J' OR 'M' OR 'A' OR 'N'
  8239                                OR 'S'
  8240                 NEXT SENTENCE
  8241                ELSE
  8242                 IF ATYPE (M-INDEX) = SPACES
  8243                    NEXT SENTENCE
  8244                   ELSE
  8245                    MOVE ER-2175       TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 158
* EL6501.cbl
  8246                    MOVE -1            TO ATYPEL (M-INDEX)
  8247                    MOVE AL-UABON      TO ATYPEA (M-INDEX)
  8248                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8249
  8250 4430-CHECK-SINGLE.
  8251     IF SINGLEL (M-INDEX) GREATER ZEROS
  8252        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8253           MOVE SINGLE-COMM-T (M-INDEX)    TO COMM-TABLE
  8254           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8255           MOVE LOW-VALUES                 TO COMM-FILLER
  8256           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8257           IF COMMISSION-ERROR
  8258              MOVE AL-UABON      TO SINGLEA (M-INDEX)
  8259              MOVE -1            TO SINGLEL (M-INDEX)
  8260           ELSE
  8261            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8262              MOVE -1            TO MAINTL
  8263              MOVE ER-1884       TO EMI-ERROR
  8264              PERFORM 9900-ERROR-FORMAT
  8265                                 THRU 9900-EXIT
  8266            END-IF
  8267           END-IF
  8268        END-IF
  8269     END-IF
  8270
  8271     IF JOINTL (M-INDEX) GREATER ZEROS
  8272        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8273           MOVE JOINT-COMM-T (M-INDEX)     TO COMM-TABLE
  8274           MOVE PI-LIFE-OVERRIDE-L1        TO COMM-LF-AH
  8275           MOVE LOW-VALUES                 TO COMM-FILLER
  8276           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8277           IF COMMISSION-ERROR
  8278              MOVE AL-UABON      TO JOINTA (M-INDEX)
  8279              MOVE -1            TO JOINTL (M-INDEX)
  8280           ELSE
  8281            IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  8282              MOVE -1            TO MAINTL
  8283              MOVE ER-1885       TO EMI-ERROR
  8284              PERFORM 9900-ERROR-FORMAT
  8285                                 THRU 9900-EXIT
  8286            END-IF
  8287           END-IF
  8288        END-IF
  8289     END-IF
  8290
  8291     IF A-HL (M-INDEX) GREATER ZEROS
  8292        IF A-H-COMM-R (M-INDEX)  NOT NUMERIC
  8293           MOVE A-H-COMM-T (M-INDEX)      TO COMM-TABLE
  8294           MOVE PI-AH-OVERRIDE-L1         TO COMM-LF-AH
  8295           MOVE LOW-VALUES                 TO COMM-FILLER
  8296           PERFORM 6400-READ-COMMISSION THRU 6459-EXIT
  8297           IF COMMISSION-ERROR
  8298              MOVE AL-UABON      TO A-HA (M-INDEX)
  8299              MOVE -1            TO A-HL (M-INDEX)
  8300           ELSE
  8301            IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  8302              MOVE -1            TO MAINTL
  8303              MOVE ER-1886       TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 159
* EL6501.cbl
  8304              PERFORM 9900-ERROR-FORMAT
  8305                                 THRU 9900-EXIT
  8306            END-IF
  8307           END-IF
  8308        END-IF
  8309     END-IF
  8310
  8311     IF RECALL (M-INDEX) GREATER ZEROS
  8312         IF RECAL (M-INDEX) = 'Y' OR 'N' OR '1' OR SPACE
  8313             MOVE AL-UANON       TO RECALA (M-INDEX)
  8314         ELSE
  8315             MOVE -1             TO RECALL (M-INDEX)
  8316             MOVE AL-UABON       TO RECALA (M-INDEX)
  8317             MOVE ER-2158        TO EMI-ERROR
  8318             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8319
  8320     IF RCOMML (M-INDEX) GREATER ZEROS
  8321         IF RCOMM (M-INDEX) = 'Y' OR 'N' OR 'A' OR SPACE
  8322             MOVE AL-UANON       TO RCOMMA (M-INDEX)
  8323         ELSE
  8324             MOVE -1             TO RCOMML (M-INDEX)
  8325             MOVE AL-UABON       TO RCOMMA (M-INDEX)
  8326             MOVE ER-0625        TO EMI-ERROR
  8327             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8328
  8329     IF  CHGBCKL (M-INDEX)  GREATER THAN  ZEROS
  8330         IF  CHGBCK (M-INDEX)    NUMERIC
  8331             MOVE  AL-UNNON        TO  CHGBCKA (M-INDEX)
  8332         ELSE
  8333             MOVE  -1              TO  CHGBCKL (M-INDEX)
  8334             MOVE  AL-UNBON        TO  CHGBCKA (M-INDEX)
  8335             MOVE  ER-0759         TO  EMI-ERROR
  8336             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8337
  8338     IF  GLCODEL (M-INDEX)  GREATER THAN  ZEROS
  8339         IF  GLCODE (M-INDEX)    NUMERIC
  8340             MOVE  AL-UNNON        TO  GLCODEA (M-INDEX)
  8341         ELSE
  8342             MOVE  -1              TO  GLCODEL (M-INDEX)
  8343             MOVE  AL-UNBON        TO  GLCODEA (M-INDEX)
  8344             MOVE  ER-0759         TO  EMI-ERROR
  8345             PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
  8346
  8347     IF ATYPE (M-INDEX) NOT = 'C' AND 'D' AND 'O' AND 'P'
  8348        AND 'J'
  8349         GO TO 4450-BUMP-INDEX.
  8350
  8351     IF SINGLE-COMM-R (M-INDEX) NUMERIC
  8352         ADD SINGLE-COMM-R (M-INDEX) TO COMM-SL-ACCUM.
  8353
  8354     IF JOINT-COMM-R (M-INDEX) NUMERIC
  8355         ADD JOINT-COMM-R (M-INDEX)  TO COMM-JL-ACCUM.
  8356
  8357     IF A-H-COMM-R (M-INDEX) NUMERIC
  8358        ADD A-H-COMM-R (M-INDEX)    TO COMM-AH-ACCUM
  8359     END-IF
  8360     .
  8361 4450-BUMP-INDEX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 160
* EL6501.cbl
  8362     SET M-INDEX UP BY 1.
  8363
  8364     IF M-INDEX NOT = 11
  8365        GO TO 4420-LOOP.
  8366
  8367     IF WS-ACCOUNT-CTR-C = ZEROS AND
  8368        WS-ACCOUNT-CTR-D = ZEROS AND
  8369        WS-ACCOUNT-CTR-R = ZEROS
  8370          MOVE ER-2177             TO EMI-ERROR
  8371          MOVE -1                  TO AGENTL (1)
  8372          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8373          GO TO 4900-EXIT.
  8374
  8375     IF (WS-ACCOUNT-CTR-C  GREATER 0 AND
  8376         WS-ACCOUNT-CTR-D  GREATER 0) OR
  8377        (WS-ACCOUNT-CTR-R  GREATER 0 AND
  8378         WS-ACCOUNT-CTR-D  GREATER 0)
  8379           MOVE ER-2174             TO EMI-ERROR
  8380           MOVE -1                  TO AGENTL (1)
  8381           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8382           GO TO 4900-EXIT.
  8383
  8384     IF WS-ACCOUNT-CTR-C GREATER 1 OR
  8385        WS-ACCOUNT-CTR-R GREATER 1 OR
  8386        WS-ACCOUNT-CTR-D GREATER 1
  8387          MOVE ER-2182             TO EMI-ERROR
  8388          MOVE -1                  TO AGENTL (1)
  8389          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8390          GO TO 4900-EXIT.
  8391
  8392
  8393     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  8394         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  8395
  8396     IF WS-ST-COMM-CAP-SL = ZEROS
  8397        CONTINUE
  8398     ELSE
  8399      IF SINGLE-COMM-R (1) NUMERIC
  8400        IF (WS-LIMIT-TO-ACCOUNT AND
  8401           SINGLE-COMM-R (1) > WS-ST-COMM-CAP-SL)
  8402                       OR
  8403           (NOT WS-LIMIT-TO-ACCOUNT AND
  8404           COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  8405           MOVE -1               TO MAINTL
  8406           MOVE ER-1884          TO EMI-ERROR
  8407           PERFORM 9900-ERROR-FORMAT
  8408                                 THRU 9900-EXIT
  8409        END-IF
  8410*     ELSE
  8411*       MOVE PI-COMPANY-CD       TO COMM-COMP-CD
  8412*       MOVE SINGLE-COMM-T (1)   TO COMM-TABLE
  8413*       MOVE PI-LIFE-OVERRIDE-L1 TO COMM-LF-AH
  8414*       MOVE LOW-VALUES          TO COMM-FILLER
  8415*       PERFORM 6400-READ-COMMISSION
  8416*                                THRU 6459-EXIT
  8417*       IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  8418*          MOVE -1               TO MAINTL
  8419*          MOVE ER-1884          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 161
* EL6501.cbl
  8420*          PERFORM 9900-ERROR-FORMAT
  8421*                                THRU 9900-EXIT
  8422*       END-IF
  8423      END-IF
  8424     END-IF
  8425
  8426     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  8427        MOVE ZEROS               TO WS-ST-COMM-CAP-JL
  8428     END-IF
  8429
  8430     IF WS-ST-COMM-CAP-JL = ZEROS
  8431        CONTINUE
  8432     ELSE
  8433        IF JOINT-COMM-R (1) NUMERIC
  8434           IF (WS-LIMIT-TO-ACCOUNT AND
  8435              JOINT-COMM-R (1) > WS-ST-COMM-CAP-JL)
  8436                       OR
  8437              (NOT WS-LIMIT-TO-ACCOUNT AND
  8438               COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  8439               MOVE -1           TO MAINTL
  8440               MOVE ER-1885      TO EMI-ERROR
  8441               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8442           END-IF
  8443*       ELSE
  8444*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8445*          MOVE JOINT-COMM-T (1) TO COMM-TABLE
  8446*          MOVE PI-LIFE-OVERRIDE-L1
  8447*                                TO COMM-LF-AH
  8448*          MOVE LOW-VALUES       TO COMM-FILLER
  8449*          PERFORM 6400-READ-COMMISSION
  8450*                                THRU 6459-EXIT
  8451*          IF EXCEEDS-STATE-MAX
  8452*             MOVE ER-1885       TO EMI-ERROR
  8453*             PERFORM 9900-ERROR-FORMAT
  8454*                                THRU 9900-EXIT
  8455*          END-IF
  8456        END-IF
  8457     END-IF
  8458
  8459     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  8460        MOVE ZEROS               TO WS-ST-COMM-CAP-SA
  8461     END-IF
  8462
  8463     IF WS-ST-COMM-CAP-SA = ZEROS
  8464        CONTINUE
  8465     ELSE
  8466        IF A-H-COMM-R (1) NUMERIC
  8467           IF (WS-LIMIT-TO-ACCOUNT AND
  8468              A-H-COMM-R (1) > WS-ST-COMM-CAP-SA)
  8469                           OR
  8470              (NOT WS-LIMIT-TO-ACCOUNT AND
  8471              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  8472              MOVE -1            TO MAINTL
  8473              MOVE ER-1886       TO EMI-ERROR
  8474              PERFORM 9900-ERROR-FORMAT
  8475                                 THRU 9900-EXIT
  8476           END-IF
  8477*       ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 162
* EL6501.cbl
  8478*          MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  8479*          MOVE A-H-COMM-T (1)   TO COMM-TABLE
  8480*          MOVE PI-AH-OVERRIDE-L1
  8481*                                TO COMM-LF-AH
  8482*          MOVE LOW-VALUES       TO COMM-FILLER
  8483*          PERFORM 6400-READ-COMMISSION
  8484*                                THRU 6459-EXIT
  8485*          IF EXCEEDS-STATE-MAX
  8486*             MOVE ER-1886       TO EMI-ERROR
  8487*             PERFORM 9900-ERROR-FORMAT
  8488*                                THRU 9900-EXIT
  8489*          END-IF
  8490        END-IF
  8491     END-IF
  8492
  8493     IF MAINTI NOT = 'C'
  8494        GO TO 4900-EXIT.
  8495
  8496     IF NOT PI-GA-BILLING
  8497        GO TO 4900-EXIT.
  8498
  8499 4460-CHECK-IF-GA-BILLED.
  8500     PERFORM 6700-BUILD-COMM-WORK THRU 6799-EXIT.
  8501
  8502     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  8503     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  8504     SET M-INDEX TO +1.
  8505     MOVE +1 TO AXRF-SUB.
  8506
  8507 4470-GA-LOOP.
  8508     IF ((AGENT (M-INDEX) NOT = WK-AM-AGT (AXRF-SUB)  OR
  8509        ATYPE  (M-INDEX) NOT = WK-AM-TYPE (AXRF-SUB)) OR
  8510        SINGLEL (M-INDEX) GREATER ZERO                OR
  8511        JOINTL  (M-INDEX) GREATER ZERO                OR
  8512        A-HL    (M-INDEX) GREATER ZERO                OR
  8513        RCOMML  (M-INDEX) GREATER ZERO                OR
  8514        CHGBCKL (M-INDEX) GREATER ZERO                OR
  8515        GLCODEL (M-INDEX) GREATER ZERO)               AND
  8516        (WK-GA-BILL-DT (AXRF-SUB) NOT = LOW-VALUES AND SPACES)
  8517           MOVE ER-2131   TO EMI-ERROR
  8518           MOVE -1        TO AGENTL (M-INDEX)
  8519           MOVE AL-UABON  TO AGENTA (M-INDEX)
  8520           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8521
  8522     ADD +1 TO AXRF-SUB.
  8523     SET M-INDEX UP BY +1.
  8524
  8525     IF AXRF-SUB NOT = +11
  8526        GO TO 4470-GA-LOOP.
  8527
  8528 4900-EXIT.
  8529      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 163
* EL6501.cbl
  8531 5000-MOVE-TO-RECORD.
  8532
  8533     IF NAMEL   GREATER THAN ZERO  OR
  8534        INCAREL GREATER THAN ZERO  OR
  8535        ADDR1L  GREATER THAN ZERO  OR
  8536        ACITYL  GREATER THAN ZERO  OR
  8537        ASTATEL GREATER THAN ZERO  OR
  8538        ZIPL    GREATER THAN ZERO  OR
  8539        PHONEL  GREATER THAN ZERO  OR
  8540        TAXNOL  GREATER THAN ZERO
  8541         MOVE '*'                TO AM-PROFILE-CHANGE-SWITCH.
  8542
  8543     IF CSRL GREATER ZEROS
  8544        MOVE CSRI                TO AM-CSR-CODE.
  8545     IF NAMEL GREATER ZEROS
  8546        MOVE NAMEI               TO AM-NAME.
  8547     IF PCONTL GREATER ZEROS
  8548        MOVE PCONTI              TO AM-CONTROL-NAME
  8549     END-IF
  8550     IF INCAREL GREATER ZEROS
  8551        MOVE INCAREI             TO AM-PERSON.
  8552     IF ADDR1L GREATER ZEROS
  8553        MOVE ADDR1I              TO AM-ADDRS.
  8554     IF TAXNOL GREATER ZEROS
  8555        MOVE TAXNOI              TO AM-ID-NO.
  8556     IF PHONEL GREATER ZEROS
  8557        MOVE PHONEI              TO DEEDIT-FIELD
  8558        PERFORM 8600-DEEDIT
  8559        MOVE DEEDIT-FIELD-V0     TO WS-PHONE-NUM
  8560        MOVE WS-PH1              TO AM-AREA-CODE
  8561        MOVE WS-PH2              TO AM-TEL-PRE
  8562        MOVE WS-PH3              TO AM-TEL-NBR.
  8563
  8564     IF ACITYL GREATER ZEROS
  8565        MOVE ACITYI             TO AM-ADDR-CITY.
  8566     IF ASTATEL GREATER ZEROS
  8567        MOVE ASTATEI            TO AM-ADDR-STATE.
  8568
  8569     IF ZIPL NOT GREATER ZEROS
  8570         GO TO 5010-CONT-MOVING.
  8571
  8572     MOVE ZIPI                   TO WS-ZIP-CODE.
  8573
  8574     IF WS-CANADIAN-ZIP
  8575         IF WS-ZIP-4 = SPACE  OR  '-'
  8576             MOVE WS-ZIP-CAN-2-POST1  TO AM-CAN-POSTAL-1
  8577             MOVE WS-ZIP-CAN-2-POST2  TO AM-CAN-POSTAL-2
  8578         ELSE
  8579             MOVE WS-ZIP-CAN-1-POST1  TO AM-CAN-POSTAL-1
  8580             MOVE WS-ZIP-CAN-1-POST2  TO AM-CAN-POSTAL-2
  8581     ELSE
  8582         IF WS-ZIP-6 = SPACE  OR  '-'
  8583             MOVE WS-ZIP-AM-2-CODE    TO AM-ZIP-PRIME
  8584             MOVE WS-ZIP-AM-2-PLUS4   TO AM-ZIP-PLUS4
  8585         ELSE
  8586             MOVE WS-ZIP-AM-1-CODE    TO AM-ZIP-PRIME
  8587             MOVE WS-ZIP-AM-1-PLUS4   TO AM-ZIP-PLUS4.
  8588
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 164
* EL6501.cbl
  8589 5010-CONT-MOVING.
  8590     IF TYPEL GREATER ZEROS
  8591        MOVE TYPEI               TO AM-GPCD.
  8592
  8593     IF STDBENL GREATER ZEROS
  8594        MOVE STDBENI             TO AM-STD-AH-TYPE.
  8595
  8596     IF INDGRPL GREATER ZEROS
  8597        MOVE INDGRPI             TO AM-IG
  8598        INSPECT AM-IG CONVERTING 'IG' TO '12'.
  8599
  8600     IF STATUSL GREATER ZEROS
  8601        MOVE STATUSI             TO AM-STATUS
  8602        INSPECT AM-STATUS CONVERTING 'SFCTIA' TO '543210'
  8603     END-IF
  8604
  8605     IF CLPTOLPL GREATER ZEROS
  8606        MOVE CLPTOLPI            TO AM-CLP-TOL-PCT
  8607     END-IF.
  8608
  8609     IF PRODCDL > 0
  8610        MOVE PRODCDI             TO AM-DCC-PRODUCT-CODE
  8611     END-IF
  8612     IF CLPSTL > 0
  8613        MOVE CLPSTI              TO AM-DCC-CLP-STATE
  8614     END-IF
  8615     IF MAXMFEEL > ZEROS
  8616        MOVE WS-WORK-NUM         TO AM-DCC-MAX-MARKETING-FEE
  8617     END-IF
  8618     IF LCOMML > ZEROS
  8619        MOVE LCOMMI              TO AM-SPP-LEASE-COMM
  8620     END-IF
  8621
  8622     IF REMITL GREATER ZEROS
  8623        MOVE REMITI              TO AM-REMIT-TO.
  8624     IF CONTRL GREATER ZEROS
  8625        MOVE WS-ANVR-DT          TO AM-ANNIVERSARY-DATE.
  8626*    IF PSILFFL GREATER +0
  8627*       MOVE WS-LIFE-PSI         TO AM-LF-PSI-FACTOR.
  8628*    IF PSIAHFL GREATER +0
  8629*       MOVE WS-AH-PSI           TO AM-AH-PSI-FACTOR.
  8630     IF PEFFDTEL GREATER ZEROS
  8631        MOVE WS-PEFF-DT          TO AM-PREV-EFF-DT.
  8632     IF PEXPDTEL GREATER ZEROS
  8633        MOVE WS-PEXP-DT          TO AM-PREV-EXP-DT.
  8634     IF COMMCALL GREATER ZEROS
  8635        MOVE COMMCALI            TO AM-RECALC-COMM
  8636        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8637     ELSE
  8638         IF MAINTI = 'A'
  8639             MOVE 'N'            TO AM-RECALC-COMM.
  8640
  8641     IF REINCALL GREATER ZEROS
  8642        MOVE REINCALI            TO AM-RECALC-REIN
  8643     ELSE
  8644         IF MAINTI = 'A'
  8645             MOVE 'N'            TO AM-RECALC-REIN.
  8646
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 165
* EL6501.cbl
  8647     IF REINTABL GREATER ZEROS
  8648        MOVE REINTABI            TO AM-REI-TABLE.
  8649
  8650     IF PI-MAINT = 'A'
  8651        MOVE 'P'                 TO AM-RET-ST-TAX-USE
  8652     END-IF
  8653
  8654     MOVE 1                      TO SUB.
  8655     SET M-INDEX                 TO 1.
  8656
  8657
  8658* EXEC CICS
  8659*         ASKTIME
  8660*    END-EXEC.
  8661*    MOVE '0"                    "   #00008092' TO DFHEIV0
  8662     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  8663     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  8664     MOVE X'2020233030303038303932' TO DFHEIV0(25:11)
  8665     CALL 'kxdfhei1' USING DFHEIV0,
  8666           DFHEIV99
  8667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8668
  8669
  8670 5000-LOOP.
  8671*    IF PI-COMPANY-ID = 'DCC'
  8672*       IF (M-INDEX = +5)
  8673*          AND ((AGENTL (5) > ZEROS)
  8674*              OR (ATYPEL (5) > ZEROS))
  8675*             MOVE ER-3057         TO EMI-ERROR
  8676*             MOVE -1              TO AGENTL (5)
  8677*             MOVE AL-UABON        TO AGENTA (5)
  8678*             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8679*             GO TO 5000-EXIT
  8680*       END-IF
  8681*    END-IF
  8682     IF MAINTI = 'C'
  8683        IF ((AM-AGT (SUB) NOT = ZEROS AND AGENT (M-INDEX)) AND
  8684           (COMMCALI NOT = 'Y' AND '1')                    AND
  8685            AM-HI-CERT-DATE NOT = ZEROS)                    OR
  8686           ((AM-AGT (SUB) = ZEROS AND
  8687             (AGENT (M-INDEX)) NOT = LOW-VALUES AND SPACES AND
  8688                                     ZEROS) AND
  8689           (COMMCALI NOT = 'Y' AND '1')  AND
  8690            AM-HI-CERT-DATE NOT = ZEROS)
  8691              MOVE ER-2181         TO EMI-ERROR
  8692              MOVE -1              TO COMMCALL
  8693              MOVE AL-UABON        TO COMMCALA
  8694              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8695              GO TO 5000-EXIT.
  8696
  8697     IF MAINTI = 'C'
  8698        IF ((AM-COM-TYP (SUB) NOT = SPACES AND
  8699             ATYPE (M-INDEX)) AND
  8700           (COMMCALI NOT = 'Y' AND '1') AND
  8701            AM-HI-CERT-DATE NOT = ZEROS)
  8702            OR
  8703           ((AM-COM-TYP (SUB) = SPACES AND
  8704             (ATYPE (M-INDEX)) NOT = LOW-VALUES AND SPACES) AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 166
* EL6501.cbl
  8705           (COMMCALI NOT = 'Y' AND '1')  AND
  8706            AM-HI-CERT-DATE NOT = ZEROS)
  8707              MOVE ER-2181         TO EMI-ERROR
  8708              MOVE -1              TO COMMCALL
  8709              MOVE AL-UABON        TO COMMCALA
  8710              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8711              GO TO 5000-EXIT.
  8712
  8713     IF AM-ACCOUNT-BILLED
  8714        IF COMMCALI = 'Y' OR '1'
  8715            MOVE ER-2183         TO EMI-ERROR
  8716            MOVE -1              TO COMMCALL
  8717            MOVE AL-UABON        TO COMMCALA
  8718            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8719            GO TO 5000-EXIT.
  8720
  8721     IF (AGENTL (M-INDEX) NOT GREATER ZEROS AND
  8722        ATYPEL  (M-INDEX) NOT GREATER ZEROS)
  8723        OR
  8724        ((AGENT (M-INDEX) = ZEROS OR SPACES) AND
  8725         ATYPE  (M-INDEX) = SPACES)
  8726           MOVE ZEROS              TO AM-AGT   (SUB)
  8727                                      AM-L-COM (SUB)
  8728                                      AM-J-COM (SUB)
  8729                                      AM-A-COM (SUB)
  8730           MOVE SPACE TO AM-COM-TYP (SUB)
  8731           SET M-INDEX UP BY 1
  8732           ADD 1 TO SUB
  8733           IF SUB = 11
  8734              GO TO 5000-CHECK-MAX-FEES
  8735            ELSE
  8736              GO TO 5000-LOOP.
  8737
  8738     MOVE AGENT (M-INDEX)        TO AM-AGT (SUB).
  8739     MOVE ATYPE (M-INDEX)        TO AM-COM-TYP (SUB).
  8740
  8741     IF SINGLEL (M-INDEX) GREATER ZEROS
  8742        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8743        IF SINGLE-COMM-R (M-INDEX) NOT NUMERIC
  8744           MOVE SINGLE-COMM-T (M-INDEX) TO AM-L-COMA (SUB)
  8745          ELSE
  8746           MOVE SINGLE-COMM-R (M-INDEX) TO AM-L-COM  (SUB)
  8747           IF SINGLE-DASH (M-INDEX) = '-'
  8748               MULTIPLY AM-L-COM (SUB) BY -1
  8749                     GIVING AM-L-COM (SUB).
  8750
  8751     IF JOINTL (M-INDEX) GREATER ZEROS
  8752        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
  8753        IF JOINT-COMM-R (M-INDEX) NOT NUMERIC
  8754           MOVE JOINT-COMM-T (M-INDEX)  TO AM-J-COMA (SUB)
  8755          ELSE
  8756           MOVE JOINT-COMM-R (M-INDEX)  TO AM-J-COM (SUB)
  8757           IF JOINT-DASH (M-INDEX) = '-'
  8758               MULTIPLY AM-J-COM (SUB) BY -1
  8759                     GIVING AM-J-COM (SUB).
  8760
  8761     IF A-HL (M-INDEX) GREATER ZEROS
  8762        MOVE '*'                 TO AM-COMM-CHANGE-STATUS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 167
* EL6501.cbl
  8763        IF A-H-COMM-R (M-INDEX) NOT NUMERIC
  8764           MOVE A-H-COMM-T (M-INDEX)  TO AM-A-COMA (SUB)
  8765          ELSE
  8766           MOVE A-H-COMM-R (M-INDEX)  TO AM-A-COM (SUB)
  8767           IF A-H-DASH (M-INDEX) = '-'
  8768               MULTIPLY AM-A-COM (SUB) BY -1
  8769                     GIVING AM-A-COM (SUB).
  8770
  8771     IF RECALL (M-INDEX) GREATER ZEROS
  8772         MOVE RECAL  (M-INDEX)   TO AM-RECALC-LV-INDIC (SUB).
  8773
  8774     IF RCOMML (M-INDEX) GREATER ZEROS
  8775         MOVE RCOMM  (M-INDEX)   TO AM-RETRO-LV-INDIC (SUB).
  8776
  8777     IF CHGBCKL (M-INDEX) GREATER ZEROS
  8778         MOVE CHGBCK (M-INDEX)   TO AM-COMM-CHARGEBACK (SUB).
  8779
  8780     IF GLCODEL (M-INDEX) GREATER ZEROS
  8781         MOVE GLCODE (M-INDEX)   TO AM-GL-CODES (SUB).
  8782
  8783     SET M-INDEX UP BY 1.
  8784     ADD 1 TO SUB.
  8785     IF M-INDEX NOT = 11
  8786        GO TO 5000-LOOP.
  8787
  8788 5000-CHECK-MAX-FEES.
  8789     IF (AM-DCC-PRODUCT-CODE = 'DDF')
  8790        MOVE +1                     TO S1
  8791        PERFORM UNTIL S1 > +10
  8792           IF (AM-A-COM (S1) NUMERIC)
  8793              AND (AM-A-COMA (S1) (3:1) NOT = 'L' AND 'M'
  8794                     AND 'O')
  8795              AND (AM-COM-TYP (S1) = 'J')
  8796                 COMPUTE COMM-MFEE-ACCUM = COMM-MFEE-ACCUM
  8797                    + (AM-A-COM (S1) * +1000)
  8798           END-IF
  8799           ADD +1             TO S1
  8800        END-PERFORM
  8801        IF COMM-MFEE-ACCUM > AM-DCC-MAX-MARKETING-FEE
  8802           MOVE -1               TO MAXMFEEL
  8803           MOVE AL-UABON         TO MAXMFEEA
  8804           MOVE ER-1817          TO EMI-ERROR
  8805           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8806        END-IF
  8807     END-IF
  8808     .
  8809 5000-EXIT.
  8810      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 168
* EL6501.cbl
  8812
  8813 5100-WRITE-TS.
  8814     PERFORM 6500-READ-ACCT THRU 6599-EXIT.
  8815
  8816     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  8817         MOVE ZEROS              TO PI-CR-CARRIER
  8818     ELSE
  8819         MOVE AM-CARRIER         TO PI-CR-CARRIER.
  8820
  8821     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  8822         MOVE ZEROS              TO PI-CR-GROUPING
  8823     ELSE
  8824         MOVE AM-GROUPING        TO PI-CR-GROUPING.
  8825
  8826     IF AM-REMIT-TO NOT = ZERO
  8827         MOVE AM-AGT (AM-REMIT-TO)
  8828                                 TO PI-CR-FIN-RESP
  8829       ELSE
  8830         MOVE AM-ACCOUNT         TO PI-CR-FIN-RESP.
  8831
  8832     MOVE 'A'                    TO PI-CR-TYPE.
  8833 5110-AGT-LOOP.
  8834     ADD 1                       TO  AGT-SUB.
  8835     IF AGT-SUB GREATER 10
  8836         MOVE LOW-VALUES         TO PI-CR-CONTROL-IN-PROGRESS
  8837         GO TO 5120-WRITE.
  8838
  8839************************************************************
  8840**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8841************************************************************
  8842
  8843     IF AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'R'
  8844                  OR 'F' OR 'U'
  8845         MOVE AM-AGT (AGT-SUB)   TO  PI-CR-ACCOUNT
  8846         GO TO 5120-WRITE
  8847     ELSE
  8848         GO TO 5110-AGT-LOOP.
  8849
  8850 5120-WRITE.
  8851
  8852* EXEC CICS WRITEQ TS
  8853*         QUEUE    (QID)
  8854*         FROM     (PROGRAM-INTERFACE-BLOCK)
  8855*         LENGTH   (WS-COMM-LENGTH)
  8856*         ITEM     (W-ONE)
  8857*    END-EXEC.
  8858*    MOVE '*" I                  ''   #00008277' TO DFHEIV0
  8859     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  8860     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8861     MOVE X'2020233030303038323737' TO DFHEIV0(25:11)
  8862     CALL 'kxdfhei1' USING DFHEIV0,
  8863           QID,
  8864           PROGRAM-INTERFACE-BLOCK,
  8865           WS-COMM-LENGTH,
  8866           W-ONE,
  8867           DFHEIV99,
  8868           DFHEIV99
  8869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 169
* EL6501.cbl
  8870
  8871
  8872 5199-EXIT.
  8873     EXIT.
  8874
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 170
* EL6501.cbl
  8876
  8877 5200-RECOVER-TS.
  8878
  8879     IF PI-CALLING-PROGRAM NOT = XCTL-652 AND
  8880                                 XCTL-653 AND
  8881                                 XCTL-689 AND
  8882                                 XCTL-608 AND
  8883                                 XCTL-690
  8884         GO TO 5299-EXIT.
  8885
  8886
  8887* EXEC CICS HANDLE CONDITION
  8888*        QIDERR  (5250-QID-ERROR)
  8889*    END-EXEC.
  8890*    MOVE '"$N                   ! , #00008298' TO DFHEIV0
  8891     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  8892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8893     MOVE X'2C20233030303038323938' TO DFHEIV0(25:11)
  8894     CALL 'kxdfhei1' USING DFHEIV0
  8895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8896
  8897
  8898
  8899* EXEC CICS READQ TS
  8900*        QUEUE    (QID)
  8901*        INTO     (PROGRAM-INTERFACE-BLOCK)
  8902*        LENGTH   (WS-COMM-LENGTH)
  8903*        ITEM     (W-ONE)
  8904*    END-EXEC.
  8905*    MOVE '*$II   L              ''   #00008302' TO DFHEIV0
  8906     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8907     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8908     MOVE X'2020233030303038333032' TO DFHEIV0(25:11)
  8909     CALL 'kxdfhei1' USING DFHEIV0,
  8910           QID,
  8911           PROGRAM-INTERFACE-BLOCK,
  8912           WS-COMM-LENGTH,
  8913           W-ONE,
  8914           DFHEIV99,
  8915           DFHEIV99
  8916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8917
  8918
  8919 5200-DELETE-TS.
  8920
  8921
  8922* EXEC CICS DELETEQ TS
  8923*        QUEUE    (QID)
  8924*    END-EXEC.
  8925*    MOVE '*&                    #   #00008311' TO DFHEIV0
  8926     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8927     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8928     MOVE X'2020233030303038333131' TO DFHEIV0(25:11)
  8929     CALL 'kxdfhei1' USING DFHEIV0,
  8930           QID,
  8931           DFHEIV99
  8932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8933
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 171
* EL6501.cbl
  8934
  8935     GO TO 5299-EXIT.
  8936
  8937 5250-QID-ERROR.
  8938     MOVE ER-0033                TO  EMI-ERROR.
  8939     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8940
  8941 5299-EXIT.
  8942     EXIT.
  8943
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 172
* EL6501.cbl
  8945
  8946 5300-UPDATE-REQUEST-FILE.
  8947     MOVE +0                     TO SUB1.
  8948
  8949 5300-FIND-ACCOUNT-AGENT.
  8950     ADD +1                      TO SUB1.
  8951
  8952     IF SUB1 GREATER THAN +10
  8953        MOVE ER-2949             TO EMI-ERROR
  8954        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8955        MOVE -1                  TO AGENTL (1)
  8956
  8957* EXEC CICS SYNCPOINT ROLLBACK
  8958*       END-EXEC
  8959*    MOVE '6"R                   !   #00008336' TO DFHEIV0
  8960     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  8961     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8962     MOVE X'2020233030303038333336' TO DFHEIV0(25:11)
  8963     CALL 'kxdfhei1' USING DFHEIV0
  8964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8965        GO TO 8200-SEND-DATAONLY.
  8966
  8967     MOVE SAVE-ACCT-AGENT      TO SAVE-NEW-ACCT-AGENT.
  8968
  8969************************************************************
  8970**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  8971************************************************************
  8972
  8973     IF AM-COM-TYP  (SUB1) = 'C' OR 'D' OR 'F'
  8974        IF AM-AGT   (SUB1) NOT = SAVE-ACCT-AGENT
  8975           MOVE AM-AGT (SUB1)  TO SAVE-NEW-ACCT-AGENT.
  8976
  8977     IF AM-AGT (AM-REMIT-TO) NOT = SAVE-FIN-RESP
  8978        GO TO 5325-PROCESS-RQST-FILE.
  8979
  8980     IF SAVE-ACCT-AGENT NOT = SAVE-NEW-ACCT-AGENT
  8981        GO TO 5325-PROCESS-RQST-FILE.
  8982
  8983     GO TO 5399-EXIT.
  8984
  8985 5325-PROCESS-RQST-FILE.
  8986     MOVE LOW-VALUES             TO RQST3-KEY.
  8987     MOVE AM-COMPANY-CD          TO RQST3-COMPANY-CD.
  8988     MOVE AM-CARRIER             TO RQST3-CARRIER.
  8989     MOVE AM-GROUPING            TO RQST3-GROUPING.
  8990     MOVE SAVE-FIN-RESP          TO RQST3-FIN-RESP.
  8991     MOVE SAVE-ACCT-AGENT        TO RQST3-ACCT-AGENT.
  8992
  8993
  8994* EXEC CICS HANDLE CONDITION
  8995*        NOTFND(5399-EXIT)
  8996*        ENDFILE(5399-EXIT)
  8997*    END-EXEC.
  8998*    MOVE '"$I''                  ! - #00008366' TO DFHEIV0
  8999     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9000     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9001     MOVE X'2D20233030303038333636' TO DFHEIV0(25:11)
  9002     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 173
* EL6501.cbl
  9003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9004
  9005
  9006 5325-PROCESS-REQUEST-FILE.
  9007
  9008* EXEC CICS STARTBR
  9009*         DATASET   (RQST3-FILE-ID)
  9010*         RIDFLD    (RQST3-KEY)
  9011*    END-EXEC.
  9012     MOVE 0
  9013       TO DFHEIV11
  9014*    MOVE '&,         G          &   #00008372' TO DFHEIV0
  9015     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9016     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9017     MOVE X'2020233030303038333732' TO DFHEIV0(25:11)
  9018     CALL 'kxdfhei1' USING DFHEIV0,
  9019           RQST3-FILE-ID,
  9020           RQST3-KEY,
  9021           DFHEIV99,
  9022           DFHEIV11,
  9023           DFHEIV99
  9024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9025
  9026
  9027 5330-READNEXT-REQUEST.
  9028
  9029* EXEC CICS READNEXT
  9030*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9031*        DATASET(RQST3-FILE-ID)
  9032*        RIDFLD (RQST3-KEY)
  9033*    END-EXEC.
  9034     MOVE 0
  9035       TO DFHEIV11
  9036*    MOVE '&.S                   )   #00008378' TO DFHEIV0
  9037     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9038     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9039     MOVE X'2020233030303038333738' TO DFHEIV0(25:11)
  9040     CALL 'kxdfhei1' USING DFHEIV0,
  9041           RQST3-FILE-ID,
  9042           DFHEIV20,
  9043           DFHEIV99,
  9044           RQST3-KEY,
  9045           DFHEIV99,
  9046           DFHEIV11,
  9047           DFHEIV99,
  9048           DFHEIV99
  9049     SET ADDRESS OF AR-REQUEST-RECORD TO
  9050         DFHEIV20
  9051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9052
  9053
  9054     IF RQST3-KEY = SAVE-RQST3-KEY
  9055        GO TO 5330-READNEXT-REQUEST.
  9056
  9057     MOVE RQST3-KEY              TO SAVE-RQST3-KEY.
  9058
  9059     IF RQ-COMPANY-CD-A2 NOT = PI-COMPANY-CD
  9060        GO TO 5350-REQUESTS-FINISHED.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 174
* EL6501.cbl
  9061
  9062     IF RQ-FIN-RESP-A2 NOT = SAVE-FIN-RESP
  9063        GO TO 5350-REQUESTS-FINISHED.
  9064
  9065     IF RQ-ACCT-AGENT-A2 NOT = SAVE-ACCT-AGENT
  9066        GO TO 5350-REQUESTS-FINISHED.
  9067
  9068     MOVE RQ-CONTROL-PRIMARY     TO RQST-KEY.
  9069
  9070
  9071* EXEC CICS ENDBR
  9072*        DATASET(RQST3-FILE-ID)
  9073*    END-EXEC.
  9074     MOVE 0
  9075       TO DFHEIV11
  9076*    MOVE '&2                    $   #00008400' TO DFHEIV0
  9077     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9078     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9079     MOVE X'2020233030303038343030' TO DFHEIV0(25:11)
  9080     CALL 'kxdfhei1' USING DFHEIV0,
  9081           RQST3-FILE-ID,
  9082           DFHEIV11,
  9083           DFHEIV99
  9084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9085
  9086
  9087
  9088* EXEC CICS READ
  9089*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  9090*        DATASET(RQST-FILE-ID)
  9091*        RIDFLD (RQST-KEY)
  9092*        UPDATE
  9093*    END-EXEC.
  9094*    MOVE '&"S        EU         (   #00008404' TO DFHEIV0
  9095     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9096     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9097     MOVE X'2020233030303038343034' TO DFHEIV0(25:11)
  9098     CALL 'kxdfhei1' USING DFHEIV0,
  9099           RQST-FILE-ID,
  9100           DFHEIV20,
  9101           DFHEIV99,
  9102           RQST-KEY,
  9103           DFHEIV99,
  9104           DFHEIV99,
  9105           DFHEIV99
  9106     SET ADDRESS OF AR-REQUEST-RECORD TO
  9107         DFHEIV20
  9108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9109
  9110
  9111     MOVE AM-AGT (AM-REMIT-TO)   TO RQ-FIN-RESP-A2.
  9112     MOVE SAVE-NEW-ACCT-AGENT    TO RQ-ACCT-AGENT-A2.
  9113
  9114
  9115* EXEC CICS REWRITE
  9116*        DATASET   (RQST-FILE-ID)
  9117*        FROM      (AR-REQUEST-RECORD)
  9118*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 175
* EL6501.cbl
  9119     MOVE LENGTH OF
  9120      AR-REQUEST-RECORD
  9121       TO DFHEIV11
  9122*    MOVE '&& L                  %   #00008414' TO DFHEIV0
  9123     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9124     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9125     MOVE X'2020233030303038343134' TO DFHEIV0(25:11)
  9126     CALL 'kxdfhei1' USING DFHEIV0,
  9127           RQST-FILE-ID,
  9128           AR-REQUEST-RECORD,
  9129           DFHEIV11,
  9130           DFHEIV99
  9131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9132
  9133
  9134     GO TO  5325-PROCESS-REQUEST-FILE.
  9135
  9136 5350-REQUESTS-FINISHED.
  9137
  9138* EXEC CICS ENDBR
  9139*        DATASET(RQST3-FILE-ID)
  9140*    END-EXEC.
  9141     MOVE 0
  9142       TO DFHEIV11
  9143*    MOVE '&2                    $   #00008422' TO DFHEIV0
  9144     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9145     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9146     MOVE X'2020233030303038343232' TO DFHEIV0(25:11)
  9147     CALL 'kxdfhei1' USING DFHEIV0,
  9148           RQST3-FILE-ID,
  9149           DFHEIV11,
  9150           DFHEIV99
  9151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9152
  9153
  9154 5399-EXIT.
  9155     EXIT.
  9156
  9157
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 176
* EL6501.cbl
  9159
  9160 6000-MOVE-TO-SCREEN.
  9161     PERFORM 8000-STATE-REC-READ   THRU 8010-EXIT.
  9162
  9163     MOVE AM-LAST-MAINT-USER     TO MAINTBYO.
  9164     MOVE AM-NAME                TO NAMEO.
  9165     MOVE AM-CONTROL-NAME        TO PCONTO.
  9166     MOVE AM-CSR-CODE            TO CSRO.
  9167     MOVE AM-PERSON              TO INCAREO.
  9168     MOVE AM-ADDRS               TO ADDR1O.
  9169     MOVE AM-ID-NO               TO TAXNOO.
  9170     MOVE AM-TEL-NO              TO WS-PHONE.
  9171     MOVE WS-PHONE-NUM           TO PHONEO.
  9172     INSPECT PHONEI CONVERTING SPACES TO '-'.
  9173     MOVE AM-ADDR-CITY           TO ACITYO
  9174     MOVE AM-ADDR-STATE          TO ASTATEO
  9175
  9176     MOVE SPACES                 TO WS-ZIP-CODE.
  9177     IF AM-CANADIAN-POST-CODE
  9178         MOVE AM-CAN-POSTAL-1    TO WS-ZIP-CAN-2-POST1
  9179         MOVE AM-CAN-POSTAL-2    TO WS-ZIP-CAN-2-POST2
  9180     ELSE
  9181         MOVE AM-ZIP-PRIME       TO WS-ZIP-AM-2-CODE
  9182         IF AM-ZIP-PLUS4 NOT = SPACES  AND  ZEROS
  9183             MOVE '-'            TO WS-ZIP-AM-2-DASH
  9184             MOVE AM-ZIP-PLUS4   TO WS-ZIP-AM-2-PLUS4.
  9185
  9186     MOVE WS-ZIP-CODE            TO ZIPO.
  9187
  9188     MOVE AM-GPCD                TO TYPEO.
  9189     MOVE AM-STD-AH-TYPE         TO STDBENO.
  9190
  9191     MOVE AM-IG                  TO INDGRPO.
  9192     INSPECT INDGRPO CONVERTING '12' TO 'IG'.
  9193
  9194     MOVE AM-STATUS              TO STATUSO.
  9195     INSPECT STATUSO CONVERTING '543210' TO 'SFCTIA'
  9196
  9197     MOVE AM-REMIT-TO            TO REMITO.
  9198
  9199     IF PI-AR-PROCESSING
  9200        IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9201           MOVE AL-UNNON         TO REMITA
  9202        ELSE
  9203           MOVE AL-SANON         TO REMITA
  9204     ELSE
  9205        MOVE AL-UNNON            TO REMITA.
  9206
  9207***  Y2K PROJ 7744
  9208     MOVE AM-ANNIVERSARY-DATE    TO DC-GREG-DATE-1-YMD.
  9209     MOVE '3'                    TO DC-OPTION-CODE.
  9210     PERFORM 9700-DATE-LINK.
  9211     IF DATE-CONVERSION-ERROR
  9212        MOVE SPACES              TO CONTRO
  9213     ELSE
  9214        MOVE DC-GREG-DATE-1-EDIT TO CONTRO
  9215     END-IF.
  9216***  Y2K PROJ 7744
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 177
* EL6501.cbl
  9217
  9218*    MOVE PI-LIFE-OVERRIDE-L6    TO PSILFTO
  9219*    MOVE PI-AH-OVERRIDE-L6      TO PSIAHTO.
  9220
  9221*    IF AM-LF-PSI-FACTOR NUMERIC
  9222*       MOVE AM-LF-PSI-FACTOR    TO PSILFFO.
  9223*
  9224*    IF AM-AH-PSI-FACTOR NUMERIC
  9225*       MOVE AM-AH-PSI-FACTOR    TO PSIAHFO.
  9226
  9227     MOVE AM-RECALC-COMM         TO COMMCALO.
  9228     MOVE AL-UANON               TO COMMCALA.
  9229     MOVE AM-RECALC-REIN         TO REINCALO.
  9230     MOVE AM-REI-TABLE           TO REINTABO.
  9231     MOVE AM-1ST-PROD-DATE       TO DC-GREG-DATE-1-YMD.
  9232     MOVE '3'                    TO DC-OPTION-CODE.
  9233     PERFORM 9700-DATE-LINK.
  9234     IF DATE-CONVERSION-ERROR
  9235        MOVE SPACES              TO PRODATEO
  9236     ELSE
  9237        MOVE DC-GREG-DATE-1-EDIT TO PRODATEO.
  9238
  9239     IF PI-COMPANY-ID = 'DCC' or 'VPP'
  9240        IF AM-CLP-TOL-PCT NOT NUMERIC
  9241           MOVE ZEROS            TO AM-CLP-TOL-PCT
  9242        END-IF
  9243        IF AM-SPP-LEASE-COMM NOT NUMERIC
  9244           MOVE ZEROS            TO AM-SPP-LEASE-COMM
  9245        END-IF
  9246        MOVE AM-CLP-TOL-PCT      TO CLPTOLPO
  9247        MOVE AM-SPP-LEASE-COMM   TO LCOMMO
  9248        MOVE AM-DCC-PRODUCT-CODE TO PRODCDO
  9249        MOVE AM-DCC-CLP-STATE    TO CLPSTO
  9250        MOVE AL-UANON            TO CLPSTA
  9251        IF AM-DCC-MAX-MARKETING-FEE NOT NUMERIC
  9252           MOVE ZEROS            TO AM-DCC-MAX-MARKETING-FEE
  9253        END-IF
  9254        MOVE AM-DCC-MAX-MARKETING-FEE
  9255                                 TO MAXMFEEO
  9256     ELSE
  9257        MOVE AL-SADOF            TO CTPLABLA
  9258                                    CLPTOLPA
  9259                                    LCLABLA
  9260                                    LCOMMA
  9261     END-IF
  9262
  9263     IF AM-RET-Y-N = ' '  OR  'N'
  9264         MOVE 'NO '              TO RETROCDO
  9265     ELSE
  9266         MOVE 'YES'              TO RETROCDO.
  9267
  9268     IF AM-ACCOUNT-BILLED
  9269         MOVE 'YES'              TO BILLCDO
  9270     ELSE
  9271         MOVE 'NO '              TO BILLCDO.
  9272
  9273     MOVE AL-UANON               TO RETROCDA.
  9274     MOVE AL-SANON               TO PRODATEA
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 178
* EL6501.cbl
  9275                                    BILLCDA.
  9276     MOVE AM-PREV-EFF-DT TO DC-GREG-DATE-1-YMD.
  9277     MOVE '3' TO DC-OPTION-CODE.
  9278     PERFORM 9700-DATE-LINK.
  9279     IF DATE-CONVERSION-ERROR
  9280        MOVE SPACES TO PEFFDTEO
  9281     ELSE
  9282        MOVE DC-GREG-DATE-1-EDIT TO PEFFDTEO.
  9283
  9284     IF AM-PREV-EXP-DT NOT = 99999999999
  9285        MOVE AM-PREV-EXP-DT TO DC-GREG-DATE-1-YMD
  9286        MOVE '3' TO DC-OPTION-CODE
  9287        PERFORM 9700-DATE-LINK
  9288        IF DATE-CONVERSION-ERROR
  9289           MOVE SPACES TO PEXPDTEO
  9290        ELSE
  9291           MOVE DC-GREG-DATE-1-EDIT TO PEXPDTEO
  9292     ELSE
  9293        MOVE '99/99/99' TO PEXPDTEO.
  9294
  9295     IF PI-PROCESSOR-ID = 'LGXX' OR 'PEMA'
  9296        MOVE AL-UANON            TO PEXPDTEA
  9297                                    PEFFDTEA
  9298        MOVE AL-SANOF TO            PDSPLYA.
  9299
  9300     MOVE LOW-VALUES             TO MAP-AGENT-AREA.
  9301     MOVE PI-COMM-POINTER        TO LCP-WS-ADDR-COMP
  9302     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9303
  9304     MOVE 1  TO SUB.
  9305     SET M-INDEX TO 1.
  9306
  9307 6005-LOOP.
  9308     IF AM-AGT (SUB) = SPACES  OR ZEROS
  9309        IF PI-AR-PROCESSING
  9310           IF AM-AR-HI-CERT-DATE GREATER THAN LOW-VALUES
  9311              MOVE AL-SANOF     TO AGENTA  (M-INDEX)
  9312                                   ATYPEA (M-INDEX)
  9313                                   SINGLEA (M-INDEX)
  9314                                   JOINTA (M-INDEX)
  9315                                   A-HA    (M-INDEX)
  9316              GO TO 6010-BUMP-SUB
  9317           ELSE
  9318              GO TO 6010-BUMP-SUB
  9319        ELSE
  9320           GO TO 6010-BUMP-SUB.
  9321
  9322     MOVE AM-AGT (SUB)           TO AGENT (M-INDEX).
  9323
  9324***DMD CUSTOM CODE - CAPTURE THE FIRST AGENT TO BE DISPLAYED
  9325     IF WS-DMD-AGENT = LOW-VALUES
  9326        MOVE AM-AGT (SUB)        TO WS-DMD-AGENT.
  9327***DMD ******************************************************
  9328
  9329     IF PI-GA-BILLING
  9330        MOVE AM-AGT (SUB)        TO WK-AM-AGT (SUB).
  9331     MOVE AL-UANON               TO AGENTA (M-INDEX).
  9332
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 179
* EL6501.cbl
  9333     MOVE AM-COM-TYP (SUB)       TO ATYPE (M-INDEX).
  9334     IF PI-GA-BILLING
  9335        MOVE AM-COM-TYP (SUB)    TO WK-AM-TYPE (SUB).
  9336     MOVE AL-UANON               TO ATYPEA (M-INDEX).
  9337
  9338     IF (AM-L-COM (SUB) NOT NUMERIC)
  9339        OR (AM-L-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9340        MOVE AM-L-COMA (SUB)     TO SINGLE-COMM-T (M-INDEX)
  9341     ELSE
  9342        IF AM-L-COM (SUB) NOT = ZEROS
  9343           MOVE AM-L-COM  (SUB)  TO SINGLE-COMM-O (M-INDEX).
  9344
  9345     IF (AM-J-COM (SUB) NOT NUMERIC)
  9346        OR (AM-J-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9347        MOVE AM-J-COMA (SUB)     TO JOINT-COMM-T (M-INDEX)
  9348     ELSE
  9349        IF AM-J-COM (SUB) NOT = ZEROS
  9350           MOVE AM-J-COM  (SUB)  TO JOINT-COMM-O (M-INDEX).
  9351
  9352     IF (AM-A-COM (SUB) NOT NUMERIC)
  9353        OR (AM-A-COMA (SUB) (3:1) = 'L' OR 'M' OR 'O')
  9354        MOVE AM-A-COMA (SUB)     TO A-H-COMM-T (M-INDEX)
  9355     ELSE
  9356        IF AM-A-COM (SUB) NOT = ZEROS
  9357           MOVE AM-A-COM  (SUB)  TO A-H-COMM-O (M-INDEX).
  9358
  9359************************************************************
  9360**  MODIFICATION MADE TO ADD SERVICE FEES                 **
  9361************************************************************
  9362
  9363     IF (AM-COM-TYP (SUB) NOT = 'C' AND 'D' AND 'O' AND 'P'
  9364            AND 'F' AND 'S' AND 'G' AND 'B' AND 'I'
  9365            AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N')
  9366         GO TO 6006-CONTINUE.
  9367
  9368     IF (AM-L-COM (SUB) NUMERIC)
  9369        AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9370         ADD AM-L-COM (SUB) TO COMM-SL-ACCUM.
  9371
  9372     IF (AM-J-COM (SUB) NUMERIC)
  9373        AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9374         ADD AM-J-COM (SUB) TO COMM-JL-ACCUM.
  9375
  9376     IF (AM-A-COM (SUB) NUMERIC)
  9377        AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9378        ADD AM-A-COM (SUB) TO COMM-AH-ACCUM
  9379     END-IF
  9380     .
  9381 6006-CONTINUE.
  9382     IF WS-ST-COMM-CAP-SL NOT NUMERIC
  9383         MOVE ZEROS        TO WS-ST-COMM-CAP-SL.
  9384
  9385     IF WS-ST-COMM-CAP-SL = ZEROS
  9386        CONTINUE
  9387     ELSE
  9388        IF (AM-L-COM (SUB) NUMERIC)
  9389           AND (AM-L-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9390           IF (WS-LIMIT-TO-ACCOUNT AND
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 180
* EL6501.cbl
  9391              AM-L-COM (SUB) > WS-ST-COMM-CAP-SL)
  9392                       OR
  9393              (NOT WS-LIMIT-TO-ACCOUNT AND
  9394              COMM-SL-ACCUM > WS-ST-COMM-CAP-SL)
  9395              MOVE -1            TO MAINTL
  9396              MOVE ER-1884       TO EMI-ERROR
  9397              PERFORM 9900-ERROR-FORMAT
  9398                                 THRU 9900-EXIT
  9399           END-IF
  9400        ELSE
  9401           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9402           MOVE AM-L-COMA (SUB)  TO COMM-TABLE
  9403           MOVE PI-LIFE-OVERRIDE-L1
  9404                                 TO COMM-LF-AH
  9405           MOVE LOW-VALUES       TO COMM-FILLER
  9406           PERFORM 6400-READ-COMMISSION
  9407                                 THRU 6459-EXIT
  9408           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SL
  9409              MOVE -1            TO MAINTL
  9410              MOVE ER-1884       TO EMI-ERROR
  9411              PERFORM 9900-ERROR-FORMAT
  9412                                 THRU 9900-EXIT
  9413           END-IF
  9414        END-IF
  9415     END-IF
  9416
  9417     IF WS-ST-COMM-CAP-JL NOT NUMERIC
  9418         MOVE ZEROS        TO WS-ST-COMM-CAP-JL.
  9419
  9420     IF WS-ST-COMM-CAP-JL = ZEROS
  9421        CONTINUE
  9422     ELSE
  9423        IF (AM-J-COM (SUB) NUMERIC)
  9424           AND (AM-J-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9425           IF (WS-LIMIT-TO-ACCOUNT AND
  9426              AM-J-COM (SUB) > WS-ST-COMM-CAP-JL)
  9427                       OR
  9428              (NOT WS-LIMIT-TO-ACCOUNT AND
  9429              COMM-JL-ACCUM > WS-ST-COMM-CAP-JL)
  9430              MOVE -1            TO MAINTL
  9431              MOVE ER-1885       TO EMI-ERROR
  9432              PERFORM 9900-ERROR-FORMAT
  9433                                 THRU 9900-EXIT
  9434           END-IF
  9435        ELSE
  9436           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9437           MOVE AM-J-COMA (SUB)  TO COMM-TABLE
  9438           MOVE PI-LIFE-OVERRIDE-L1
  9439                                 TO COMM-LF-AH
  9440           MOVE LOW-VALUES       TO COMM-FILLER
  9441           PERFORM 6400-READ-COMMISSION
  9442                                 THRU 6459-EXIT
  9443           IF WS-TABLE-MAX > WS-ST-COMM-CAP-JL
  9444              MOVE -1            TO MAINTL
  9445              MOVE ER-1885       TO EMI-ERROR
  9446              PERFORM 9900-ERROR-FORMAT
  9447                                 THRU 9900-EXIT
  9448           END-IF
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 181
* EL6501.cbl
  9449        END-IF
  9450     END-IF
  9451
  9452     IF WS-ST-COMM-CAP-SA NOT NUMERIC
  9453         MOVE ZEROS        TO WS-ST-COMM-CAP-SA.
  9454
  9455     IF WS-ST-COMM-CAP-SA = ZEROS
  9456        CONTINUE
  9457     ELSE
  9458        IF (AM-A-COM (SUB) NUMERIC)
  9459           AND (AM-A-COMA (SUB) (3:1) NOT = 'L' AND 'M' AND 'O')
  9460           IF (WS-LIMIT-TO-ACCOUNT AND
  9461              AM-A-COM (SUB) > WS-ST-COMM-CAP-SA)
  9462                       OR
  9463              (NOT WS-LIMIT-TO-ACCOUNT AND
  9464              COMM-AH-ACCUM > WS-ST-COMM-CAP-SA)
  9465              MOVE -1            TO MAINTL
  9466              MOVE ER-1886       TO EMI-ERROR
  9467              PERFORM 9900-ERROR-FORMAT
  9468                                 THRU 9900-EXIT
  9469           END-IF
  9470        ELSE
  9471           MOVE PI-COMPANY-CD    TO COMM-COMP-CD
  9472           MOVE AM-A-COMA (SUB)  TO COMM-TABLE
  9473           MOVE PI-AH-OVERRIDE-L1
  9474                                 TO COMM-LF-AH
  9475           MOVE LOW-VALUES       TO COMM-FILLER
  9476           PERFORM 6400-READ-COMMISSION
  9477                                 THRU 6459-EXIT
  9478           IF WS-TABLE-MAX > WS-ST-COMM-CAP-SA
  9479              MOVE -1            TO MAINTL
  9480              MOVE ER-1886       TO EMI-ERROR
  9481              PERFORM 9900-ERROR-FORMAT
  9482                                 THRU 9900-EXIT
  9483           END-IF
  9484        END-IF
  9485     END-IF
  9486
  9487     IF AM-RECALC-LV-INDIC (SUB) NOT = SPACE
  9488         MOVE AM-RECALC-LV-INDIC (SUB) TO RECAL (M-INDEX).
  9489
  9490     IF AM-RETRO-LV-INDIC (SUB) NOT = SPACE
  9491         MOVE AM-RETRO-LV-INDIC (SUB) TO RCOMM (M-INDEX).
  9492
  9493     IF AM-COMM-CHARGEBACK (SUB)  NUMERIC
  9494        NEXT SENTENCE
  9495     ELSE
  9496        MOVE ZEROS              TO  AM-COMM-CHARGEBACK (SUB).
  9497
  9498     IF AM-COMM-CHARGEBACK (SUB)   NOT  =    ZEROS
  9499         MOVE AM-COMM-CHARGEBACK (SUB) TO CHGBCK (M-INDEX).
  9500
  9501     IF AM-GL-CODES (SUB)   NOT  =    ZEROS
  9502         MOVE AM-GL-CODES (SUB)  TO  GLCODE (M-INDEX).
  9503
  9504     IF NOT PI-AR-PROCESSING
  9505        GO TO 6010-BUMP-SUB.
  9506
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 182
* EL6501.cbl
  9507     IF AM-AR-HI-CERT-DATE = LOW-VALUES
  9508        GO TO 6010-BUMP-SUB.
  9509
  9510     MOVE AL-SANON              TO AGENTA  (M-INDEX)
  9511                                   ATYPEA  (M-INDEX)
  9512                                   SINGLEA (M-INDEX)
  9513                                   JOINTA  (M-INDEX)
  9514                                   A-HA    (M-INDEX).
  9515
  9516 6010-BUMP-SUB.
  9517     ADD 1  TO SUB.
  9518     SET M-INDEX UP BY 1.
  9519     IF SUB LESS 11
  9520        GO TO 6005-LOOP.
  9521
  9522 6099-EXIT.
  9523      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 183
* EL6501.cbl
  9525 6300-STARTBR.
  9526
  9527* EXEC CICS STARTBR
  9528*         DATASET   (ACCT-FILE-ID)
  9529*         RIDFLD    (WS-KEY-SAVE)
  9530*    END-EXEC.
  9531     MOVE 0
  9532       TO DFHEIV11
  9533*    MOVE '&,         G          &   #00008798' TO DFHEIV0
  9534     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9535     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9536     MOVE X'2020233030303038373938' TO DFHEIV0(25:11)
  9537     CALL 'kxdfhei1' USING DFHEIV0,
  9538           ACCT-FILE-ID,
  9539           WS-KEY-SAVE,
  9540           DFHEIV99,
  9541           DFHEIV11,
  9542           DFHEIV99
  9543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9544
  9545
  9546     MOVE 'Y'                    TO BROWSE-STARTED-SW.
  9547
  9548 6300-EXIT.
  9549      EXIT.
  9550
  9551 6310-READNEXT.
  9552
  9553* EXEC CICS READNEXT
  9554*         DATASET    (ACCT-FILE-ID)
  9555*         SET        (ADDRESS OF ACCOUNT-MASTER)
  9556*         RIDFLD     (WS-KEY-SAVE)
  9557*    END-EXEC.
  9558     MOVE 0
  9559       TO DFHEIV11
  9560*    MOVE '&.S                   )   #00008809' TO DFHEIV0
  9561     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9562     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9563     MOVE X'2020233030303038383039' TO DFHEIV0(25:11)
  9564     CALL 'kxdfhei1' USING DFHEIV0,
  9565           ACCT-FILE-ID,
  9566           DFHEIV20,
  9567           DFHEIV99,
  9568           WS-KEY-SAVE,
  9569           DFHEIV99,
  9570           DFHEIV11,
  9571           DFHEIV99,
  9572           DFHEIV99
  9573     SET ADDRESS OF ACCOUNT-MASTER TO
  9574         DFHEIV20
  9575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9576
  9577
  9578 6310-EXIT.
  9579      EXIT.
  9580
  9581 6320-ENDBR.
  9582     MOVE SPACE               TO BROWSE-STARTED-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 184
* EL6501.cbl
  9583
  9584* EXEC CICS ENDBR
  9585*        DATASET(ACCT-FILE-ID)
  9586*    END-EXEC.
  9587     MOVE 0
  9588       TO DFHEIV11
  9589*    MOVE '&2                    $   #00008820' TO DFHEIV0
  9590     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9591     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9592     MOVE X'2020233030303038383230' TO DFHEIV0(25:11)
  9593     CALL 'kxdfhei1' USING DFHEIV0,
  9594           ACCT-FILE-ID,
  9595           DFHEIV11,
  9596           DFHEIV99
  9597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9598
  9599
  9600 6320-EXIT.
  9601      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 185
* EL6501.cbl
  9603 6400-READ-COMMISSION.
  9604     MOVE ZEROS                  TO WS-COMM-ERROR-SW
  9605
  9606* EXEC CICS HANDLE CONDITION
  9607*         NOTFND   (6450-NOT-FOUND)
  9608*    END-EXEC
  9609*    MOVE '"$I                   ! . #00008829' TO DFHEIV0
  9610     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9611     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9612     MOVE X'2E20233030303038383239' TO DFHEIV0(25:11)
  9613     CALL 'kxdfhei1' USING DFHEIV0
  9614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9615
  9616
  9617* EXEC CICS READ
  9618*        GTEQ
  9619*        DATASET   (COMM-FILE-ID)
  9620*        SET       (ADDRESS OF COMM-TABLE-RECORD)
  9621*        RIDFLD    (COMM-KEY)
  9622*    END-EXEC
  9623*    MOVE '&"S        G          (   #00008833' TO DFHEIV0
  9624     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9625     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9626     MOVE X'2020233030303038383333' TO DFHEIV0(25:11)
  9627     CALL 'kxdfhei1' USING DFHEIV0,
  9628           COMM-FILE-ID,
  9629           DFHEIV20,
  9630           DFHEIV99,
  9631           COMM-KEY,
  9632           DFHEIV99,
  9633           DFHEIV99,
  9634           DFHEIV99
  9635     SET ADDRESS OF COMM-TABLE-RECORD TO
  9636         DFHEIV20
  9637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9638
  9639     IF CT-COMPANY-CD = PI-COMPANY-CD AND
  9640        CT-TABLE      = COMM-TABLE    AND
  9641        CT-BEN-TYPE   = COMM-LF-AH
  9642        PERFORM 6460-CHECK-MAX THRU 6460-EXIT
  9643        GO TO 6459-EXIT
  9644     END-IF
  9645     .
  9646 6450-NOT-FOUND.
  9647     MOVE ER-2176                TO EMI-ERROR.
  9648     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9649     MOVE 1  TO WS-COMM-ERROR-SW.
  9650
  9651 6459-EXIT.
  9652      EXIT.
  9653
  9654 6460-CHECK-MAX.
  9655
  9656
  9657* EXEC CICS STARTBR
  9658*         DATASET   (COMM-FILE-ID)
  9659*         RIDFLD    (COMM-KEY)
  9660*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 186
* EL6501.cbl
  9661*    END-EXEC
  9662     MOVE 0
  9663       TO DFHEIV11
  9664*    MOVE '&,         G          &  N#00008857' TO DFHEIV0
  9665     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9666     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9667     MOVE X'204E233030303038383537' TO DFHEIV0(25:11)
  9668     CALL 'kxdfhei1' USING DFHEIV0,
  9669           COMM-FILE-ID,
  9670           COMM-KEY,
  9671           DFHEIV99,
  9672           DFHEIV11,
  9673           DFHEIV99
  9674     MOVE EIBRESP  TO WS-RESPONSE
  9675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9676
  9677     MOVE SPACES          TO WS-STATE-MAX-SW
  9678
  9679     IF RESP-NORMAL
  9680        MOVE LOW-VALUES          TO COMM-FILLER
  9681        MOVE COMM-KEY            TO WS-HOLD-COMM-KEY
  9682        MOVE ZEROS               TO WS-TABLE-MAX
  9683        PERFORM UNTIL
  9684              (NOT RESP-NORMAL) OR
  9685              (COMM-KEY (1:5) NOT = WS-HOLD-COMM-KEY (1:5))
  9686
  9687* EXEC CICS READNEXT
  9688*             DATASET   (COMM-FILE-ID)
  9689*             SET       (ADDRESS OF COMM-TABLE-RECORD)
  9690*             RIDFLD    (COMM-KEY)
  9691*             RESP      (WS-RESPONSE)
  9692*           END-EXEC
  9693     MOVE 0
  9694       TO DFHEIV11
  9695*    MOVE '&.S                   )  N#00008872' TO DFHEIV0
  9696     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9697     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9698     MOVE X'204E233030303038383732' TO DFHEIV0(25:11)
  9699     CALL 'kxdfhei1' USING DFHEIV0,
  9700           COMM-FILE-ID,
  9701           DFHEIV20,
  9702           DFHEIV99,
  9703           COMM-KEY,
  9704           DFHEIV99,
  9705           DFHEIV11,
  9706           DFHEIV99,
  9707           DFHEIV99
  9708     SET ADDRESS OF COMM-TABLE-RECORD TO
  9709         DFHEIV20
  9710     MOVE EIBRESP  TO WS-RESPONSE
  9711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9712            IF (RESP-NORMAL) AND
  9713               (COMM-KEY (1:5) = WS-HOLD-COMM-KEY (1:5))
  9714               PERFORM VARYING WS-NDX FROM +1 BY +1 UNTIL
  9715                   (WS-NDX > +27)
  9716                   IF CT-RT (WS-NDX) > WS-TABLE-MAX
  9717                      MOVE CT-RT (WS-NDX)
  9718                                 TO WS-TABLE-MAX
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 187
* EL6501.cbl
  9719                   END-IF
  9720               END-PERFORM
  9721            END-IF
  9722        END-PERFORM
  9723
  9724* EXEC CICS ENDBR
  9725*            DATASET   (COMM-FILE-ID)
  9726*       END-EXEC
  9727     MOVE 0
  9728       TO DFHEIV11
  9729*    MOVE '&2                    $   #00008889' TO DFHEIV0
  9730     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9731     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9732     MOVE X'2020233030303038383839' TO DFHEIV0(25:11)
  9733     CALL 'kxdfhei1' USING DFHEIV0,
  9734           COMM-FILE-ID,
  9735           DFHEIV11,
  9736           DFHEIV99
  9737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9738     END-IF
  9739
  9740     .
  9741 6460-EXIT.
  9742      EXIT.
  9743
  9744
  9745 6500-READ-ACCT.
  9746
  9747* EXEC CICS READ
  9748*        GTEQ
  9749*        DATASET   (ACCT-FILE-ID)
  9750*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9751*        RIDFLD    (PI-ACCT-KEY)
  9752*    END-EXEC.
  9753*    MOVE '&"S        G          (   #00008900' TO DFHEIV0
  9754     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9756     MOVE X'2020233030303038393030' TO DFHEIV0(25:11)
  9757     CALL 'kxdfhei1' USING DFHEIV0,
  9758           ACCT-FILE-ID,
  9759           DFHEIV20,
  9760           DFHEIV99,
  9761           PI-ACCT-KEY,
  9762           DFHEIV99,
  9763           DFHEIV99,
  9764           DFHEIV99
  9765     SET ADDRESS OF ACCOUNT-MASTER TO
  9766         DFHEIV20
  9767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9768
  9769
  9770 6599-EXIT.
  9771      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 188
* EL6501.cbl
  9773 6600-UPDATE-MAINT-DT.
  9774     MOVE SPACES                 TO ELCNTL-KEY.
  9775
  9776     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9777     MOVE '1'                    TO CNTL-REC-TYPE.
  9778     MOVE +0                     TO CNTL-SEQ-NO.
  9779
  9780
  9781* EXEC CICS HANDLE CONDITION
  9782*        NOTFND   (6699-EXIT)
  9783*    END-EXEC.
  9784*    MOVE '"$I                   ! / #00008917' TO DFHEIV0
  9785     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9786     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9787     MOVE X'2F20233030303038393137' TO DFHEIV0(25:11)
  9788     CALL 'kxdfhei1' USING DFHEIV0
  9789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9790
  9791
  9792
  9793* EXEC CICS READ
  9794*        UPDATE
  9795*        DATASET   (CNTL-FILE-ID)
  9796*        SET       (ADDRESS OF CONTROL-FILE)
  9797*        RIDFLD    (ELCNTL-KEY)
  9798*    END-EXEC.
  9799*    MOVE '&"S        EU         (   #00008921' TO DFHEIV0
  9800     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9801     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9802     MOVE X'2020233030303038393231' TO DFHEIV0(25:11)
  9803     CALL 'kxdfhei1' USING DFHEIV0,
  9804           CNTL-FILE-ID,
  9805           DFHEIV20,
  9806           DFHEIV99,
  9807           ELCNTL-KEY,
  9808           DFHEIV99,
  9809           DFHEIV99,
  9810           DFHEIV99
  9811     SET ADDRESS OF CONTROL-FILE TO
  9812         DFHEIV20
  9813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9814
  9815
  9816     MOVE BIN-CURRENT-SAVE       TO CF-ACCOUNT-MSTR-MAINT-DT.
  9817
  9818
  9819* EXEC CICS REWRITE
  9820*        DATASET   (CNTL-FILE-ID)
  9821*        FROM      (CONTROL-FILE)
  9822*    END-EXEC.
  9823     MOVE LENGTH OF
  9824      CONTROL-FILE
  9825       TO DFHEIV11
  9826*    MOVE '&& L                  %   #00008930' TO DFHEIV0
  9827     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9828     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9829     MOVE X'2020233030303038393330' TO DFHEIV0(25:11)
  9830     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 189
* EL6501.cbl
  9831           CNTL-FILE-ID,
  9832           CONTROL-FILE,
  9833           DFHEIV11,
  9834           DFHEIV99
  9835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9836
  9837
  9838 6699-EXIT.
  9839      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 190
* EL6501.cbl
  9841 6700-BUILD-COMM-WORK.
  9842     IF NOT PI-GA-BILLING
  9843         GO TO 6799-EXIT.
  9844
  9845
  9846* EXEC CICS GETMAIN
  9847*         LENGTH   (260)
  9848*         SET      (ADDRESS OF COMMISSION-WORK-AREA)
  9849*         INITIMG  (GETMAIN-SPACE)
  9850*     END-EXEC.
  9851     MOVE 260
  9852       TO DFHEIV11
  9853*    MOVE ',"IL                  $   #00008942' TO DFHEIV0
  9854     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9855     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9856     MOVE X'2020233030303038393432' TO DFHEIV0(25:11)
  9857     CALL 'kxdfhei1' USING DFHEIV0,
  9858           DFHEIV20,
  9859           DFHEIV11,
  9860           GETMAIN-SPACE
  9861     SET ADDRESS OF COMMISSION-WORK-AREA TO
  9862         DFHEIV20
  9863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9864
  9865     SET LCP-WS-ADDR-PNTR TO ADDRESS OF COMMISSION-WORK-AREA
  9866
  9867     MOVE LCP-WS-ADDR-COMP TO PI-COMM-POINTER.
  9868     MOVE SPACES             TO COMMISSION-WORK-AREA.
  9869     MOVE 'X'                TO COMMISSION-GETMAIN-SW.
  9870
  9871     IF PI-MAINT = 'A'
  9872         GO TO 6799-EXIT.
  9873
  9874     MOVE AM-COMM-STRUCTURE TO COMMISSION-WORK-AREA.
  9875     MOVE +1                TO AXRF-SUB.
  9876
  9877 6710-AXRF-LOOP.
  9878     MOVE SPACES         TO AGENT-FIND.
  9879     MOVE ERGXRF-MAX-LEN TO ERGXRF-REC-LEN.
  9880
  9881     PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT.
  9882
  9883     IF AGENT-FIND = SPACES
  9884        MOVE GX-LAST-BILL-DT (GX-AGENT-SUB) TO
  9885             WK-GA-BILL-DT (AXRF-SUB)
  9886     ELSE
  9887        MOVE LOW-VALUES TO WK-GA-BILL-DT (AXRF-SUB).
  9888
  9889     ADD +1 TO AXRF-SUB.
  9890
  9891     IF AXRF-SUB NOT = +11
  9892        GO TO 6710-AXRF-LOOP.
  9893
  9894 6799-EXIT.
  9895     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 191
* EL6501.cbl
  9897 6800-COMPANY-REC-READ.
  9898     MOVE SPACES                 TO ELCNTL-KEY.
  9899     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9900     MOVE '1'                    TO CNTL-REC-TYPE.
  9901     MOVE +0                     TO CNTL-SEQ-NO.
  9902
  9903* EXEC CICS HANDLE CONDITION
  9904*        NOTFND   (6880-NO-COMP)
  9905*    END-EXEC.
  9906*    MOVE '"$I                   ! 0 #00008984' TO DFHEIV0
  9907     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9909     MOVE X'3020233030303038393834' TO DFHEIV0(25:11)
  9910     CALL 'kxdfhei1' USING DFHEIV0
  9911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9912
  9913
  9914
  9915* EXEC CICS READ
  9916*        DATASET   (CNTL-FILE-ID)
  9917*        SET       (ADDRESS OF CONTROL-FILE)
  9918*        RIDFLD    (ELCNTL-KEY)
  9919*    END-EXEC.
  9920*    MOVE '&"S        E          (   #00008988' TO DFHEIV0
  9921     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9922     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9923     MOVE X'2020233030303038393838' TO DFHEIV0(25:11)
  9924     CALL 'kxdfhei1' USING DFHEIV0,
  9925           CNTL-FILE-ID,
  9926           DFHEIV20,
  9927           DFHEIV99,
  9928           ELCNTL-KEY,
  9929           DFHEIV99,
  9930           DFHEIV99,
  9931           DFHEIV99
  9932     SET ADDRESS OF CONTROL-FILE TO
  9933         DFHEIV20
  9934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9935
  9936
  9937     IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES
  9938         MOVE ER-2572               TO EMI-ERROR
  9939         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9940
  9941     GO TO 6899-EXIT.
  9942
  9943 6880-NO-COMP.
  9944     MOVE ER-0002                TO EMI-ERROR.
  9945     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9946
  9947 6899-EXIT.
  9948     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 192
* EL6501.cbl
  9950 6900-READ-AND-CHECK-AXRF.
  9951     IF NOT PI-GA-BILLING
  9952        GO TO 6999-EXIT.
  9953
  9954     MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
  9955     SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR.
  9956
  9957 6905-AGENT-LEVEL-LOOP.
  9958     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
  9959     MOVE SPACES TO AGENT-FIND.
  9960     IF ((AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB))
  9961      OR
  9962        (AM-COM-TYP (AXRF-SUB) NOT = WK-AM-TYPE (AXRF-SUB)))
  9963      AND
  9964        ((AM-COM-TYP (AXRF-SUB) = 'O' OR 'P' OR 'G'
  9965                             OR 'B' OR 'I'
  9966                             OR 'K' OR 'L' OR 'J' OR 'M'
  9967                             OR 'S' OR 'A' OR 'N')
  9968                            OR
  9969        (WK-AM-TYPE (AXRF-SUB) = 'O' OR 'P' OR 'G' OR
  9970                'B' OR 'I' OR 'K' OR 'L' OR 'J' OR 'M'
  9971                                  OR 'S' OR 'A' OR 'N'))
  9972            PERFORM 6920-READ-AXRF-FILE THRU 6929-EXIT
  9973            IF AGENT-RECORD-NOT-FOUND
  9974               PERFORM 6950-ADD-AGENT-RECORD THRU 6959-EXIT
  9975           ELSE
  9976            IF ACCT-RECORD-NOT-FOUND OR ACCT-LEVEL-DIFFERENT
  9977               PERFORM 6970-REWRITE-AGENT-RECORD THRU 6979-EXIT
  9978           ELSE
  9979        IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'G'
  9980              AND 'B' AND 'I' AND 'S'
  9981              AND 'K' AND 'L' AND 'J' AND 'M' AND 'A' AND 'N') OR
  9982           (AM-AGT (AXRF-SUB) NOT =
  9983                   WK-AM-AGT (AXRF-SUB))
  9984           PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT
  9985           GO TO 6910-INC-SUB.
  9986
  9987     MOVE SPACES TO AGENT-FIND.
  9988     IF (AM-AGT (AXRF-SUB) NOT = WK-AM-AGT (AXRF-SUB)) AND
  9989        (WK-AM-AGT (AXRF-SUB) NOT = LOW-VALUES AND
  9990                               SPACES AND ZEROS)
  9991          MOVE WK-AM-AGT (AXRF-SUB)   TO WS-AXRF-AGENT-NO
  9992          MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN
  9993          PERFORM 6921-READ-AXRF THRU 6929-EXIT
  9994          IF AGENT-FIND = SPACES
  9995              PERFORM 7000-DELETE-AXRF-REC THRU 7999-EXIT.
  9996
  9997 6910-INC-SUB.
  9998     ADD +1                      TO AXRF-SUB.
  9999     IF AXRF-SUB NOT = +11
 10000        GO TO 6905-AGENT-LEVEL-LOOP.
 10001
 10002     GO TO 6999-EXIT.
 10003
 10004 6920-READ-AXRF-FILE.
 10005*    IF GETMAIN-SW = 'X'
 10006*       GO TO 6920-BUILD-KEY.
 10007*
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 193
* EL6501.cbl
 10008*    EXEC CICS GETMAIN
 10009*         LENGTH   (ERGXRF-REC-LEN)
 10010*         SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
 10011*         INITIMG  (GETMAIN-SPACE)
 10012*    END-EXEC.
 10013*
 10014*    MOVE 'X' TO GETMAIN-SW.
 10015
 10016 6920-BUILD-KEY.
 10017     MOVE PI-COMPANY-CD          TO WS-AXRF-COMPANY-CD.
 10018
 10019     IF PI-ZERO-CARRIER
 10020       OR PI-ZERO-CAR-GROUP
 10021         MOVE ZERO               TO WS-AXRF-CARRIER
 10022     ELSE
 10023         MOVE AM-CARRIER         TO WS-AXRF-CARRIER.
 10024
 10025     IF PI-ZERO-GROUPING
 10026       OR PI-ZERO-CAR-GROUP
 10027         MOVE ZEROS              TO WS-AXRF-GROUPING
 10028     ELSE
 10029         MOVE AM-GROUPING        TO WS-AXRF-GROUPING.
 10030
 10031     IF AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10032                                              LOW-VALUES
 10033        MOVE AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10034     ELSE
 10035     IF WK-AM-AGT (AXRF-SUB) NOT = SPACES AND ZEROS AND
 10036                                              LOW-VALUES
 10037        MOVE WK-AM-AGT (AXRF-SUB) TO WS-AXRF-AGENT-NO
 10038     ELSE
 10039        MOVE 'X' TO AGENT-FIND
 10040        GO TO 6929-EXIT.
 10041
 10042     MOVE +1 TO GX-AGENT-SUB.
 10043
 10044 6921-READ-AXRF.
 10045
 10046* EXEC CICS HANDLE CONDITION
 10047*         ENDFILE     (6925-NOT-FIND)
 10048*         NOTFND      (6925-NOT-FIND)
 10049*    END-EXEC.
 10050*    MOVE '"$''I                  ! 1 #00009102' TO DFHEIV0
 10051     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10052     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10053     MOVE X'3120233030303039313032' TO DFHEIV0(25:11)
 10054     CALL 'kxdfhei1' USING DFHEIV0
 10055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10056
 10057
 10058
 10059* EXEC CICS READ
 10060*        DATASET   (ERGXRF-FILE-ID)
 10061*        LENGTH    (ERGXRF-REC-LEN)
 10062*        INTO      (AGENT-CROSS-REFERENCE)
 10063*        RIDFLD    (WS-AXRF-KEY)
 10064*        EQUAL
 10065*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 194
* EL6501.cbl
 10066*    MOVE '&"IL       E          (   #00009107' TO DFHEIV0
 10067     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10068     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10069     MOVE X'2020233030303039313037' TO DFHEIV0(25:11)
 10070     CALL 'kxdfhei1' USING DFHEIV0,
 10071           ERGXRF-FILE-ID,
 10072           AGENT-CROSS-REFERENCE,
 10073           ERGXRF-REC-LEN,
 10074           WS-AXRF-KEY,
 10075           DFHEIV99,
 10076           DFHEIV99,
 10077           DFHEIV99
 10078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10079
 10080
 10081     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10082
 10083     PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10084             FROM +1 BY +1 UNTIL
 10085         (GX-AGENT-SUB GREATER THAN GX-AGENT-POINTER-CNT) OR
 10086         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT      AND
 10087         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10088         AND
 10089         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10090         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10091         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10092         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10093
 10094     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10095        MOVE 'Y' TO AGENT-FIND
 10096        GO TO 6929-EXIT.
 10097
 10098     IF GX-AM-LEVEL-NO (GX-AGENT-SUB) NOT = AXRF-SUB
 10099        MOVE 'Z' TO AGENT-FIND.
 10100
 10101     GO TO 6929-EXIT.
 10102
 10103 6921-FIND-ACCT-LOOP.
 10104***  DUMMY PARAGRAPH  ***
 10105
 10106 6925-NOT-FIND.
 10107     MOVE 'X' TO AGENT-FIND.
 10108
 10109 6929-EXIT.
 10110     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 195
* EL6501.cbl
 10112 6950-ADD-AGENT-RECORD.
 10113     IF AM-AGT (AXRF-SUB) = SPACES OR ZEROS
 10114        GO TO 6959-EXIT.
 10115
 10116     MOVE +109                   TO ERGXRF-REC-LEN.
 10117
 10118     MOVE +1                     TO GX-AGENT-POINTER-CNT.
 10119     MOVE 'GX'                   TO GX-RECORD-ID.
 10120     MOVE AM-COMPANY-CD          TO GX-COMPANY-CD.
 10121
 10122     IF PI-ZERO-CARRIER
 10123       OR PI-ZERO-CAR-GROUP
 10124         MOVE ZERO               TO GX-CARRIER
 10125     ELSE
 10126         MOVE AM-CARRIER         TO GX-CARRIER.
 10127
 10128     IF PI-ZERO-GROUPING
 10129       OR PI-ZERO-CAR-GROUP
 10130         MOVE ZERO               TO GX-GROUPING
 10131     ELSE
 10132         MOVE AM-GROUPING        TO GX-GROUPING.
 10133
 10134     MOVE AM-AGT (AXRF-SUB)      TO GX-AGENT-NO.
 10135
 10136     MOVE AM-CARRIER             TO GX-AM-CARRIER (1).
 10137     MOVE AM-GROUPING            TO GX-AM-GROUPING (1).
 10138     MOVE AM-STATE               TO GX-AM-STATE (1).
 10139     MOVE AM-ACCOUNT             TO GX-AM-ACCOUNT (1).
 10140     MOVE AM-EXPIRATION-DT       TO GX-AM-EXPIRATION-DT (1).
 10141     MOVE AM-EFFECTIVE-DT        TO GX-AM-EFF-DT (1).
 10142     MOVE AXRF-SUB               TO GX-AM-LEVEL-NO (1).
 10143     MOVE LOW-VALUES             TO GX-LAST-BILL-DT (1).
 10144
 10145     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10146     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10147     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10148
 10149
 10150* EXEC CICS WRITE
 10151*        FROM      (AGENT-CROSS-REFERENCE)
 10152*        LENGTH    (ERGXRF-REC-LEN)
 10153*        RIDFLD    (GX-CONTROL-PRIMARY)
 10154*        DATASET   (ERGXRF-FILE-ID)
 10155*    END-EXEC.
 10156*    MOVE '&$ L                  ''   #00009183' TO DFHEIV0
 10157     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10158     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10159     MOVE X'2020233030303039313833' TO DFHEIV0(25:11)
 10160     CALL 'kxdfhei1' USING DFHEIV0,
 10161           ERGXRF-FILE-ID,
 10162           AGENT-CROSS-REFERENCE,
 10163           ERGXRF-REC-LEN,
 10164           GX-CONTROL-PRIMARY,
 10165           DFHEIV99,
 10166           DFHEIV99
 10167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10168
 10169
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 196
* EL6501.cbl
 10170 6959-EXIT.
 10171      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 197
* EL6501.cbl
 10173 6970-REWRITE-AGENT-RECORD.
 10174     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10175
 10176
 10177* EXEC CICS READ
 10178*        DATASET   (ERGXRF-FILE-ID)
 10179*        INTO      (AGENT-CROSS-REFERENCE)
 10180*        LENGTH    (ERGXRF-REC-LEN)
 10181*        RIDFLD    (WS-AXRF-KEY)
 10182*        EQUAL
 10183*        UPDATE
 10184*    END-EXEC.
 10185*    MOVE '&"IL       EU         (   #00009196' TO DFHEIV0
 10186     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10187     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10188     MOVE X'2020233030303039313936' TO DFHEIV0(25:11)
 10189     CALL 'kxdfhei1' USING DFHEIV0,
 10190           ERGXRF-FILE-ID,
 10191           AGENT-CROSS-REFERENCE,
 10192           ERGXRF-REC-LEN,
 10193           WS-AXRF-KEY,
 10194           DFHEIV99,
 10195           DFHEIV99,
 10196           DFHEIV99
 10197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10198
 10199
 10200     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10201
 10202     IF ACCT-LEVEL-DIFFERENT
 10203        GO TO 6975-UPDATE-LEVEL-NO.
 10204
 10205     IF GX-AGENT-POINTER-CNT = +1006
 10206         GO TO 6979-EXIT.
 10207
 10208     MOVE +1 TO FIND-AGENT-SUB1.
 10209
 10210 6972-FIND-REC-LOCATION.
 10211     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO GX-REST-OF-KEY.
 10212     MOVE AM-COMPANY-CD TO GX-AM-COMPANY-CD.
 10213
 10214     IF (GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY)  OR
 10215        (FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT)
 10216        NEXT SENTENCE
 10217     ELSE
 10218        ADD +1 TO FIND-AGENT-SUB1
 10219        GO TO 6972-FIND-REC-LOCATION.
 10220
 10221     MOVE GX-AGENT-POINTER-CNT TO FIND-AGENT-SUB2
 10222                                  FIND-AGENT-SUB3.
 10223     ADD +1 TO FIND-AGENT-SUB3.
 10224
 10225     IF FIND-AGENT-SUB1 GREATER GX-AGENT-POINTER-CNT
 10226        NEXT SENTENCE
 10227     ELSE
 10228        PERFORM 6977-BUMP-AXRF-REC VARYING FIND-AGENT-SUB2
 10229        FROM FIND-AGENT-SUB2 BY -1 UNTIL
 10230        FIND-AGENT-SUB3 = FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 198
* EL6501.cbl
 10231
 10232     ADD ERGXRF-INC-LEN          TO ERGXRF-REC-LEN.
 10233     ADD  +1                     TO GX-AGENT-POINTER-CNT.
 10234
 10235     MOVE AM-CARRIER  TO GX-AM-CARRIER (FIND-AGENT-SUB3).
 10236     MOVE AM-GROUPING TO GX-AM-GROUPING (FIND-AGENT-SUB3).
 10237
 10238     MOVE AM-STATE    TO GX-AM-STATE (FIND-AGENT-SUB3).
 10239     MOVE AM-ACCOUNT  TO GX-AM-ACCOUNT (FIND-AGENT-SUB3).
 10240     MOVE AM-EXPIRATION-DT TO
 10241                  GX-AM-EXPIRATION-DT (FIND-AGENT-SUB3).
 10242     MOVE AM-EFFECTIVE-DT  TO
 10243                  GX-AM-EFF-DT (FIND-AGENT-SUB3).
 10244     MOVE AXRF-SUB    TO GX-AM-LEVEL-NO (FIND-AGENT-SUB3).
 10245     MOVE LOW-VALUES  TO GX-LAST-BILL-DT (FIND-AGENT-SUB3).
 10246
 10247 6975-UPDATE-LEVEL-NO.
 10248     MOVE AXRF-SUB TO GX-AM-LEVEL-NO (GX-AGENT-SUB).
 10249     MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT.
 10250     MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS.
 10251     MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER.
 10252     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
 10253     if ergxrf-rec-len > +31264
 10254        move +31264               to ergxrf-rec-len
 10255        move +1006                to gx-agent-pointer-cnt
 10256     end-if
 10257
 10258
 10259* EXEC CICS REWRITE
 10260*        FROM      (AGENT-CROSS-REFERENCE)
 10261*        LENGTH    (ERGXRF-REC-LEN)
 10262*        DATASET   (ERGXRF-FILE-ID)
 10263*    END-EXEC.
 10264*    MOVE '&& L                  %   #00009263' TO DFHEIV0
 10265     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10266     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10267     MOVE X'2020233030303039323633' TO DFHEIV0(25:11)
 10268     CALL 'kxdfhei1' USING DFHEIV0,
 10269           ERGXRF-FILE-ID,
 10270           AGENT-CROSS-REFERENCE,
 10271           ERGXRF-REC-LEN,
 10272           DFHEIV99
 10273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10274
 10275
 10276     GO TO 6979-EXIT.
 10277
 10278 6977-BUMP-AXRF-REC.
 10279     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB2) TO
 10280          GX-AGENT-POINTER (FIND-AGENT-SUB3).
 10281
 10282     SUBTRACT +1 FROM FIND-AGENT-SUB3.
 10283
 10284 6979-EXIT.
 10285     EXIT.
 10286
 10287 6999-EXIT.
 10288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 199
* EL6501.cbl
 10290 7000-DELETE-AXRF-REC.
 10291     MOVE ERGXRF-MAX-LEN         TO ERGXRF-REC-LEN.
 10292
 10293
 10294* EXEC CICS HANDLE CONDITION
 10295*         ENDFILE     (7999-EXIT)
 10296*         NOTFND      (7999-EXIT)
 10297*    END-EXEC.
 10298*    MOVE '"$''I                  ! 2 #00009286' TO DFHEIV0
 10299     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 10300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10301     MOVE X'3220233030303039323836' TO DFHEIV0(25:11)
 10302     CALL 'kxdfhei1' USING DFHEIV0
 10303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10304
 10305
 10306
 10307* EXEC CICS READ
 10308*        DATASET   (ERGXRF-FILE-ID)
 10309*        INTO      (AGENT-CROSS-REFERENCE)
 10310*        LENGTH    (ERGXRF-REC-LEN)
 10311*        RIDFLD    (WS-AXRF-KEY)
 10312*        EQUAL
 10313*        UPDATE
 10314*    END-EXEC.
 10315*    MOVE '&"IL       EU         (   #00009291' TO DFHEIV0
 10316     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10317     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10318     MOVE X'2020233030303039323931' TO DFHEIV0(25:11)
 10319     CALL 'kxdfhei1' USING DFHEIV0,
 10320           ERGXRF-FILE-ID,
 10321           AGENT-CROSS-REFERENCE,
 10322           ERGXRF-REC-LEN,
 10323           WS-AXRF-KEY,
 10324           DFHEIV99,
 10325           DFHEIV99,
 10326           DFHEIV99
 10327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10328
 10329
 10330     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
 10331
 10332     IF GX-AGENT-SUB = +0
 10333        PERFORM 6921-FIND-ACCT-LOOP VARYING GX-AGENT-SUB
 10334        FROM +1 BY +1 UNTIL
 10335         (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT) OR
 10336         (GX-AM-ACCOUNT (GX-AGENT-SUB) = AM-ACCOUNT  AND
 10337         GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = AM-EXPIRATION-DT
 10338         AND
 10339         GX-AM-EFF-DT (GX-AGENT-SUB)   = AM-EFFECTIVE-DT AND
 10340         GX-AM-CARRIER (GX-AGENT-SUB)  = AM-CARRIER      AND
 10341         GX-AM-GROUPING (GX-AGENT-SUB) = AM-GROUPING     AND
 10342         GX-AM-STATE (GX-AGENT-SUB)    = AM-STATE).
 10343
 10344     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
 10345        GO TO 7999-EXIT.
 10346
 10347     MOVE GX-AGENT-SUB TO FIND-AGENT-SUB1.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 200
* EL6501.cbl
 10348     PERFORM 7010-BUMP-RECORDS VARYING GX-AGENT-SUB
 10349                                  FROM GX-AGENT-SUB BY +1 UNTIL
 10350                            GX-AGENT-SUB = GX-AGENT-POINTER-CNT.
 10351     SUBTRACT ERGXRF-INC-LEN FROM ERGXRF-REC-LEN.
 10352     SUBTRACT +1             FROM GX-AGENT-POINTER-CNT.
 10353     GO TO 7020-REWRITE-AXRF-RECORD.
 10354
 10355 7010-BUMP-RECORDS.
 10356     ADD +1 TO FIND-AGENT-SUB1.
 10357     MOVE GX-AGENT-POINTER (FIND-AGENT-SUB1) TO
 10358          GX-AGENT-POINTER (GX-AGENT-SUB).
 10359
 10360 7020-REWRITE-AXRF-RECORD.
 10361     IF GX-AGENT-POINTER-CNT = +0
 10362
 10363* EXEC CICS DELETE
 10364*            DATASET   (ERGXRF-FILE-ID)
 10365*       END-EXEC
 10366*    MOVE '&(                    &   #00009332' TO DFHEIV0
 10367     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10368     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10369     MOVE X'2020233030303039333332' TO DFHEIV0(25:11)
 10370     CALL 'kxdfhei1' USING DFHEIV0,
 10371           ERGXRF-FILE-ID,
 10372           DFHEIV99,
 10373           DFHEIV99,
 10374           DFHEIV99,
 10375           DFHEIV99
 10376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10377     ELSE
 10378        MOVE BIN-CURRENT-SAVE       TO GX-LAST-MAINT-DT
 10379        MOVE EIBTIME                TO GX-LAST-MAINT-HHMMSS
 10380        MOVE PI-PROCESSOR-ID        TO GX-LAST-MAINT-USER
 10381        compute ergxrf-rec-len =
 10382            (gx-agent-pointer-cnt * +31) + +78
 10383        if ergxrf-rec-len > +31264
 10384           move +31264               to ergxrf-rec-len
 10385           move +1006                to gx-agent-pointer-cnt
 10386        end-if
 10387
 10388* EXEC CICS REWRITE
 10389*            FROM      (AGENT-CROSS-REFERENCE)
 10390*            LENGTH    (ERGXRF-REC-LEN)
 10391*            DATASET   (ERGXRF-FILE-ID)
 10392*       END-EXEC.
 10393*    MOVE '&& L                  %   #00009345' TO DFHEIV0
 10394     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10395     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10396     MOVE X'2020233030303039333435' TO DFHEIV0(25:11)
 10397     CALL 'kxdfhei1' USING DFHEIV0,
 10398           ERGXRF-FILE-ID,
 10399           AGENT-CROSS-REFERENCE,
 10400           ERGXRF-REC-LEN,
 10401           DFHEIV99
 10402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10403
 10404
 10405 7999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 201
* EL6501.cbl
 10406     EXIT.
 10407
 10408*************************************
 10409 8000-STATE-REC-READ.
 10410     MOVE SPACES                 TO ELCNTL-KEY.
 10411     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10412     MOVE '3'                    TO CNTL-REC-TYPE.
 10413     MOVE PI-ACCT-STATE          TO CNTL-ACCESS.
 10414     MOVE +0                     TO CNTL-SEQ-NO.
 10415
 10416* EXEC CICS HANDLE CONDITION
 10417*        NOTFND  (8010-EXIT)
 10418*    END-EXEC.
 10419*    MOVE '"$I                   ! 3 #00009361' TO DFHEIV0
 10420     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10422     MOVE X'3320233030303039333631' TO DFHEIV0(25:11)
 10423     CALL 'kxdfhei1' USING DFHEIV0
 10424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10425
 10426
 10427
 10428* EXEC CICS READ
 10429*        DATASET   (CNTL-FILE-ID)
 10430*        SET       (ADDRESS OF CONTROL-FILE)
 10431*        RIDFLD    (ELCNTL-KEY)
 10432*    END-EXEC.
 10433*    MOVE '&"S        E          (   #00009365' TO DFHEIV0
 10434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10436     MOVE X'2020233030303039333635' TO DFHEIV0(25:11)
 10437     CALL 'kxdfhei1' USING DFHEIV0,
 10438           CNTL-FILE-ID,
 10439           DFHEIV20,
 10440           DFHEIV99,
 10441           ELCNTL-KEY,
 10442           DFHEIV99,
 10443           DFHEIV99,
 10444           DFHEIV99
 10445     SET ADDRESS OF CONTROL-FILE TO
 10446         DFHEIV20
 10447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10448
 10449
 10450     MOVE CF-ST-COMMISSION-CAPS   TO WS-ST-COMMISSION-CAPS.
 10451     MOVE CF-COMM-CAP-LIMIT-TO    TO WS-COMM-CAP-LIMIT-TO.
 10452
 10453 8010-EXIT.
 10454      EXIT.
 10455
 10456 8050-USER-REC-READ.
 10457     MOVE SPACES                 TO ELCNTL-KEY.
 10458     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10459     MOVE '2'                    TO CNTL-REC-TYPE.
 10460     MOVE CSRI                   TO CNTL-ACCESS.
 10461     MOVE +0                     TO CNTL-SEQ-NO.
 10462
 10463* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 202
* EL6501.cbl
 10464*        NOTFND  (8055-NOTFND)
 10465*    END-EXEC.
 10466*    MOVE '"$I                   ! 4 #00009383' TO DFHEIV0
 10467     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10468     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10469     MOVE X'3420233030303039333833' TO DFHEIV0(25:11)
 10470     CALL 'kxdfhei1' USING DFHEIV0
 10471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10472
 10473
 10474
 10475* EXEC CICS READ
 10476*        DATASET   (CNTL-FILE-ID)
 10477*        SET       (ADDRESS OF CONTROL-FILE)
 10478*        RIDFLD    (ELCNTL-KEY)
 10479*    END-EXEC.
 10480*    MOVE '&"S        E          (   #00009387' TO DFHEIV0
 10481     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10482     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10483     MOVE X'2020233030303039333837' TO DFHEIV0(25:11)
 10484     CALL 'kxdfhei1' USING DFHEIV0,
 10485           CNTL-FILE-ID,
 10486           DFHEIV20,
 10487           DFHEIV99,
 10488           ELCNTL-KEY,
 10489           DFHEIV99,
 10490           DFHEIV99,
 10491           DFHEIV99
 10492     SET ADDRESS OF CONTROL-FILE TO
 10493         DFHEIV20
 10494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10495
 10496
 10497     GO TO 8060-EXIT.
 10498
 10499 8055-NOTFND.
 10500     MOVE ER-1883             TO EMI-ERROR.
 10501     MOVE -1                  TO CSRL.
 10502     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10503
 10504 8060-EXIT.
 10505      EXIT.
 10506
 10507*************************************
 10508
 10509 8100-SEND-INITIAL-MAP.
 10510     MOVE SAVE-DATE              TO DATEO.
 10511     MOVE EIBTIME                TO TIME-IN.
 10512     MOVE TIME-OUT               TO TIMEO.
 10513     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10514     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10515     MOVE -1                     TO PFENTERL.
 10516     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10517
 10518     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10519
 10520*    IF PI-COMPANY-ID = 'HAN' OR 'LGX' OR 'BNE'
 10521*       NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 203
* EL6501.cbl
 10522*    ELSE
 10523*       MOVE AL-SADOF            TO PSIHEADA
 10524*                                   PSILFTA
 10525*                                   PSILFCA
 10526*                                   PSIAHTA
 10527*                                   PSIAHCA
 10528*                                   PSILFFA
 10529*                                   PSIAHFA.
 10530
 10531*    IF PI-COMPANY-ID = 'DMD'
 10532*         MOVE AL-SANOF          TO KEY10A.
 10533
 10534     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 10535        CONTINUE
 10536     ELSE
 10537        MOVE AL-SADOF            TO CTPLABLA
 10538                                    CLPTOLPA
 10539                                    LCLABLA
 10540                                    LCOMMA
 10541                                    MAXFEEHA
 10542                                    CLPSTHA
 10543                                    PRODCDHA
 10544     END-IF
 10545     IF PI-COMPANY-ID = 'NCL' OR 'LGX'
 10546        MOVE -1                  TO CSRL.
 10547
 10548     IF  CLAIM-SESSION
 10549         MOVE SPACES             TO PF1PF2O
 10550         MOVE AL-SANOF           TO PF1PF2A.
 10551
 10552
 10553* EXEC CICS SEND
 10554*        MAP      (MAP-NAME)
 10555*        MAPSET   (MAPSET-NAME)
 10556*        FROM     (EL6501AO)
 10557*        ERASE
 10558*        CURSOR
 10559*    END-EXEC.
 10560     MOVE LENGTH OF
 10561      EL6501AO
 10562       TO DFHEIV12
 10563     MOVE -1
 10564       TO DFHEIV11
 10565*    MOVE '8$     CT  E    H L F ,   #00009448' TO DFHEIV0
 10566     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10567     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10568     MOVE X'2020233030303039343438' TO DFHEIV0(25:11)
 10569     CALL 'kxdfhei1' USING DFHEIV0,
 10570           MAP-NAME,
 10571           EL6501AO,
 10572           DFHEIV12,
 10573           MAPSET-NAME,
 10574           DFHEIV99,
 10575           DFHEIV99,
 10576           DFHEIV99,
 10577           DFHEIV11,
 10578           DFHEIV99,
 10579           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 204
* EL6501.cbl
 10580           DFHEIV99
 10581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10582
 10583
 10584     GO TO 9100-RETURN-TRAN.
 10585
 10586 8200-SEND-DATAONLY.
 10587     MOVE SAVE-DATE              TO DATEO.
 10588     MOVE EIBTIME                TO TIME-IN.
 10589     MOVE TIME-OUT               TO TIMEO.
 10590     MOVE PI-COMPANY-ID          TO CMPNYIDO.
 10591     MOVE PI-PROCESSOR-ID        TO USERIDO.
 10592     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
 10593
 10594     MOVE PI-AH-OVERRIDE-L6      TO AHHEADO.
 10595
 10596     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 10597        CONTINUE
 10598     ELSE
 10599        MOVE AL-SADOF            TO CTPLABLA
 10600                                    CLPTOLPA
 10601                                    LCLABLA
 10602                                    LCOMMA
 10603                                    MAXFEEHA
 10604                                    CLPSTHA
 10605                                    PRODCDHA
 10606     END-IF
 10607     IF  CLAIM-SESSION
 10608         MOVE SPACES             TO PF1PF2O
 10609         MOVE AL-SANOF           TO PF1PF2A.
 10610
 10611
 10612* EXEC CICS SEND
 10613*        MAP      (MAP-NAME)
 10614*        MAPSET   (MAPSET-NAME)
 10615*        FROM     (EL6501AO)
 10616*        DATAONLY
 10617*        CURSOR
 10618*    END-EXEC.
 10619     MOVE LENGTH OF
 10620      EL6501AO
 10621       TO DFHEIV12
 10622     MOVE -1
 10623       TO DFHEIV11
 10624*    MOVE '8$D    CT       H L F ,   #00009483' TO DFHEIV0
 10625     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10626     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10627     MOVE X'2020233030303039343833' TO DFHEIV0(25:11)
 10628     CALL 'kxdfhei1' USING DFHEIV0,
 10629           MAP-NAME,
 10630           EL6501AO,
 10631           DFHEIV12,
 10632           MAPSET-NAME,
 10633           DFHEIV99,
 10634           DFHEIV99,
 10635           DFHEIV99,
 10636           DFHEIV11,
 10637           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 205
* EL6501.cbl
 10638           DFHEIV99,
 10639           DFHEIV99
 10640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10641
 10642
 10643     GO TO 9100-RETURN-TRAN.
 10644
 10645 8300-SEND-TEXT.
 10646
 10647* EXEC CICS SEND TEXT
 10648*        FROM     (LOGOFF-TEXT)
 10649*        LENGTH   (LOGOFF-LENGTH)
 10650*        ERASE
 10651*        FREEKB
 10652*    END-EXEC.
 10653*    MOVE '8&      T  E F  H   F -   #00009494' TO DFHEIV0
 10654     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10655     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10656     MOVE X'2020233030303039343934' TO DFHEIV0(25:11)
 10657     CALL 'kxdfhei1' USING DFHEIV0,
 10658           LOGOFF-TEXT,
 10659           LOGOFF-LENGTH,
 10660           DFHEIV99,
 10661           DFHEIV99,
 10662           DFHEIV99,
 10663           DFHEIV99,
 10664           DFHEIV99,
 10665           DFHEIV99,
 10666           DFHEIV99,
 10667           DFHEIV99,
 10668           DFHEIV99,
 10669           DFHEIV99
 10670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10671
 10672
 10673
 10674* EXEC CICS RETURN
 10675*    END-EXEC.
 10676*    MOVE '.(                    ''   #00009501' TO DFHEIV0
 10677     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10678     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10679     MOVE X'2020233030303039353031' TO DFHEIV0(25:11)
 10680     CALL 'kxdfhei1' USING DFHEIV0,
 10681           DFHEIV99,
 10682           DFHEIV99,
 10683           DFHEIV99,
 10684           DFHEIV99,
 10685           DFHEIV99,
 10686           DFHEIV99
 10687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10688
 10689
 10690 8600-DEEDIT.
 10691
 10692* EXEC CICS BIF DEEDIT
 10693*         FIELD(DEEDIT-FIELD)
 10694*         LENGTH(15)
 10695*     END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 206
* EL6501.cbl
 10696     MOVE 15
 10697       TO DFHEIV11
 10698*    MOVE '@"L                   #   #00009505' TO DFHEIV0
 10699     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10700     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10701     MOVE X'2020233030303039353035' TO DFHEIV0(25:11)
 10702     CALL 'kxdfhei1' USING DFHEIV0,
 10703           DEEDIT-FIELD,
 10704           DFHEIV11
 10705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10706
 10707
 10708 8800-UNAUTHORIZED-ACCESS.
 10709     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 10710     GO TO 8300-SEND-TEXT.
 10711
 10712 8810-PF23.
 10713     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 10714     MOVE XCTL-005               TO PGM-NAME.
 10715     GO TO 9300-XCTL.
 10716
 10717 9100-RETURN-TRAN.
 10718     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 10719     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 10720
 10721* EXEC CICS RETURN
 10722*        TRANSID    (TRANS-ID)
 10723*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10724*        LENGTH     (WS-COMM-LENGTH)
 10725*    END-EXEC.
 10726*    MOVE '.(CT                  ''   #00009522' TO DFHEIV0
 10727     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10728     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10729     MOVE X'2020233030303039353232' TO DFHEIV0(25:11)
 10730     CALL 'kxdfhei1' USING DFHEIV0,
 10731           TRANS-ID,
 10732           PROGRAM-INTERFACE-BLOCK,
 10733           WS-COMM-LENGTH,
 10734           DFHEIV99,
 10735           DFHEIV99,
 10736           DFHEIV99
 10737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10738
 10739
 10740 9200-RETURN-MAIN-MENU.
 10741     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10742         MOVE XCTL-126           TO  PGM-NAME
 10743     ELSE
 10744         MOVE XCTL-626           TO  PGM-NAME.
 10745
 10746     GO TO 9300-XCTL.
 10747
 10748 9300-XCTL.
 10749
 10750* EXEC CICS XCTL
 10751*        PROGRAM    (PGM-NAME)
 10752*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10753*        LENGTH     (WS-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 207
* EL6501.cbl
 10754*    END-EXEC.
 10755*    MOVE '.$C                   %   #00009537' TO DFHEIV0
 10756     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10757     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10758     MOVE X'2020233030303039353337' TO DFHEIV0(25:11)
 10759     CALL 'kxdfhei1' USING DFHEIV0,
 10760           PGM-NAME,
 10761           PROGRAM-INTERFACE-BLOCK,
 10762           WS-COMM-LENGTH,
 10763           DFHEIV99
 10764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10765
 10766
 10767 9400-CLEAR.
 10768     IF PI-GA-BILLING
 10769        IF GETMAIN-ACQUIRED
 10770           MOVE PI-COMM-POINTER TO LCP-WS-ADDR-COMP
 10771           SET ADDRESS OF COMMISSION-WORK-AREA TO LCP-WS-ADDR-PNTR
 10772
 10773* EXEC CICS FREEMAIN
 10774*               DATA     (COMMISSION-WORK-AREA)
 10775*          END-EXEC.
 10776*    MOVE ',$D                   "   #00009548' TO DFHEIV0
 10777     MOVE X'2C2444202020202020202020' TO DFHEIV0(1:12)
 10778     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 10779     MOVE X'2020233030303039353438' TO DFHEIV0(25:11)
 10780     CALL 'kxdfhei1' USING DFHEIV0,
 10781           COMMISSION-WORK-AREA
 10782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10783
 10784
 10785     MOVE SPACES                 TO PI-SV-MAINT.
 10786     MOVE XCTL-650               TO PGM-NAME.
 10787     MOVE XCTL-650               TO PI-RETURN-TO-PROGRAM.
 10788     GO TO 9300-XCTL.
 10789
 10790 9500-PF12.
 10791     MOVE XCTL-010               TO PGM-NAME.
 10792     GO TO 9300-XCTL.
 10793
 10794 9600-PGMID-ERROR.
 10795
 10796* EXEC CICS HANDLE CONDITION
 10797*        PGMIDERR    (8300-SEND-TEXT)
 10798*    END-EXEC.
 10799*    MOVE '"$L                   ! 5 #00009562' TO DFHEIV0
 10800     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10802     MOVE X'3520233030303039353632' TO DFHEIV0(25:11)
 10803     CALL 'kxdfhei1' USING DFHEIV0
 10804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10805
 10806
 10807     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 10808     MOVE ' '                    TO PI-ENTRY-CD-1.
 10809     MOVE XCTL-005               TO PGM-NAME.
 10810     MOVE PGM-NAME               TO LOGOFF-PGM.
 10811     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 208
* EL6501.cbl
 10812     GO TO 9300-XCTL.
 10813
 10814 9700-DATE-LINK.
 10815     MOVE LINK-ELDATCV           TO PGM-NAME.
 10816
 10817* EXEC CICS LINK
 10818*        PROGRAM    (PGM-NAME)
 10819*        COMMAREA   (DATE-CONVERSION-DATA)
 10820*        LENGTH     (DC-COMM-LENGTH)
 10821*    END-EXEC.
 10822*    MOVE '."C                   (   #00009575' TO DFHEIV0
 10823     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10824     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10825     MOVE X'2020233030303039353735' TO DFHEIV0(25:11)
 10826     CALL 'kxdfhei1' USING DFHEIV0,
 10827           PGM-NAME,
 10828           DATE-CONVERSION-DATA,
 10829           DC-COMM-LENGTH,
 10830           DFHEIV99,
 10831           DFHEIV99,
 10832           DFHEIV99,
 10833           DFHEIV99
 10834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10835
 10836
 10837 9900-ERROR-FORMAT.
 10838     IF NOT EMI-ERRORS-COMPLETE
 10839         MOVE LINK-001           TO PGM-NAME
 10840
 10841* EXEC CICS LINK
 10842*            PROGRAM    (PGM-NAME)
 10843*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10844*            LENGTH     (EMI-COMM-LENGTH)
 10845*        END-EXEC.
 10846*    MOVE '."C                   (   #00009584' TO DFHEIV0
 10847     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10848     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10849     MOVE X'2020233030303039353834' TO DFHEIV0(25:11)
 10850     CALL 'kxdfhei1' USING DFHEIV0,
 10851           PGM-NAME,
 10852           ERROR-MESSAGE-INTERFACE-BLOCK,
 10853           EMI-COMM-LENGTH,
 10854           DFHEIV99,
 10855           DFHEIV99,
 10856           DFHEIV99,
 10857           DFHEIV99
 10858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10859
 10860
 10861 9900-EXIT.
 10862     EXIT.
 10863
 10864 9990-ABEND.
 10865     MOVE LINK-004               TO PGM-NAME.
 10866     MOVE DFHEIBLK               TO EMI-LINE1.
 10867
 10868* EXEC CICS LINK
 10869*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 209
* EL6501.cbl
 10870*        COMMAREA  (EMI-LINE1)
 10871*        LENGTH    (72)
 10872*    END-EXEC.
 10873     MOVE 72
 10874       TO DFHEIV11
 10875*    MOVE '."C                   (   #00009596' TO DFHEIV0
 10876     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10877     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10878     MOVE X'2020233030303039353936' TO DFHEIV0(25:11)
 10879     CALL 'kxdfhei1' USING DFHEIV0,
 10880           PGM-NAME,
 10881           EMI-LINE1,
 10882           DFHEIV11,
 10883           DFHEIV99,
 10884           DFHEIV99,
 10885           DFHEIV99,
 10886           DFHEIV99
 10887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10888
 10889
 10890     MOVE -1                     TO PFENTERL.
 10891     GO TO 8200-SEND-DATAONLY.
 10892
 10893
 10894* GOBACK.
 10895     MOVE '9%                    "   ' TO DFHEIV0
 10896     MOVE 'EL6501' TO DFHEIV1
 10897     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10898     GOBACK.
 10899
 10900 9995-SECURITY-VIOLATION.
 10901*                            COPY ELCSCTP.
 10902******************************************************************
 10903*                                                                *
 10904*                            ELCSCTP                             *
 10905*                            VMOD=2.001                          *
 10906*                                                                *
 10907*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10908******************************************************************
 10909
 10910
 10911     MOVE EIBDATE          TO SM-JUL-DATE.
 10912     MOVE EIBTRMID         TO SM-TERMID.
 10913     MOVE THIS-PGM         TO SM-PGM.
 10914     MOVE EIBTIME          TO TIME-IN.
 10915     MOVE TIME-OUT         TO SM-TIME.
 10916     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10917
 10918
 10919* EXEC CICS LINK
 10920*         PROGRAM  ('EL003')
 10921*         COMMAREA (SECURITY-MESSAGE)
 10922*         LENGTH   (80)
 10923*    END-EXEC.
 10924     MOVE 'EL003' TO DFHEIV1
 10925     MOVE 80
 10926       TO DFHEIV11
 10927*    MOVE '."C                   (   #00009625' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 210
* EL6501.cbl
 10928     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10929     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10930     MOVE X'2020233030303039363235' TO DFHEIV0(25:11)
 10931     CALL 'kxdfhei1' USING DFHEIV0,
 10932           DFHEIV1,
 10933           SECURITY-MESSAGE,
 10934           DFHEIV11,
 10935           DFHEIV99,
 10936           DFHEIV99,
 10937           DFHEIV99,
 10938           DFHEIV99
 10939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10940
 10941
 10942******************************************************************
 10943
 10944
 10945 9995-EXIT.
 10946     EXIT.
 10947
 10948 9999-DFHBACK SECTION.
 10949     MOVE '9%                    "   ' TO DFHEIV0
 10950     MOVE 'EL6501' TO DFHEIV1
 10951     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10952     GOBACK.
 10953 9999-DFHEXIT.
 10954     IF DFHEIGDJ EQUAL 0001
 10955         NEXT SENTENCE
 10956     ELSE IF DFHEIGDJ EQUAL 2
 10957         GO TO 9600-PGMID-ERROR,
 10958               9990-ABEND,
 10959               0500-CHECK-MAINT-TYPE
 10960         DEPENDING ON DFHEIGDI
 10961     ELSE IF DFHEIGDJ EQUAL 3
 10962         GO TO 1500-EXIT
 10963         DEPENDING ON DFHEIGDI
 10964     ELSE IF DFHEIGDJ EQUAL 4
 10965         GO TO 1799-EXIT,
 10966               1799-EXIT
 10967         DEPENDING ON DFHEIGDI
 10968     ELSE IF DFHEIGDJ EQUAL 5
 10969         GO TO 2100-EXIT
 10970         DEPENDING ON DFHEIGDI
 10971     ELSE IF DFHEIGDJ EQUAL 6
 10972         GO TO 2200-EXIT
 10973         DEPENDING ON DFHEIGDI
 10974     ELSE IF DFHEIGDJ EQUAL 7
 10975         GO TO 3030-END-FILE
 10976         DEPENDING ON DFHEIGDI
 10977     ELSE IF DFHEIGDJ EQUAL 8
 10978         GO TO 3530-END-FILE
 10979         DEPENDING ON DFHEIGDI
 10980     ELSE IF DFHEIGDJ EQUAL 9
 10981         GO TO 4020-BUS-TYPE-ERROR
 10982         DEPENDING ON DFHEIGDI
 10983     ELSE IF DFHEIGDJ EQUAL 10
 10984         GO TO 4099-STD-BEN-ERROR
 10985         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:15 Page 211
* EL6501.cbl
 10986     ELSE IF DFHEIGDJ EQUAL 11
 10987         GO TO 4180-REIN-ERROR
 10988         DEPENDING ON DFHEIGDI
 10989     ELSE IF DFHEIGDJ EQUAL 12
 10990         GO TO 5250-QID-ERROR
 10991         DEPENDING ON DFHEIGDI
 10992     ELSE IF DFHEIGDJ EQUAL 13
 10993         GO TO 5399-EXIT,
 10994               5399-EXIT
 10995         DEPENDING ON DFHEIGDI
 10996     ELSE IF DFHEIGDJ EQUAL 14
 10997         GO TO 6450-NOT-FOUND
 10998         DEPENDING ON DFHEIGDI
 10999     ELSE IF DFHEIGDJ EQUAL 15
 11000         GO TO 6699-EXIT
 11001         DEPENDING ON DFHEIGDI
 11002     ELSE IF DFHEIGDJ EQUAL 16
 11003         GO TO 6880-NO-COMP
 11004         DEPENDING ON DFHEIGDI
 11005     ELSE IF DFHEIGDJ EQUAL 17
 11006         GO TO 6925-NOT-FIND,
 11007               6925-NOT-FIND
 11008         DEPENDING ON DFHEIGDI
 11009     ELSE IF DFHEIGDJ EQUAL 18
 11010         GO TO 7999-EXIT,
 11011               7999-EXIT
 11012         DEPENDING ON DFHEIGDI
 11013     ELSE IF DFHEIGDJ EQUAL 19
 11014         GO TO 8010-EXIT
 11015         DEPENDING ON DFHEIGDI
 11016     ELSE IF DFHEIGDJ EQUAL 20
 11017         GO TO 8055-NOTFND
 11018         DEPENDING ON DFHEIGDI
 11019     ELSE IF DFHEIGDJ EQUAL 21
 11020         GO TO 8300-SEND-TEXT
 11021         DEPENDING ON DFHEIGDI.
 11022     MOVE '9%                    "   ' TO DFHEIV0
 11023     MOVE 'EL6501' TO DFHEIV1
 11024     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11025     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       39340     Code:       35016
